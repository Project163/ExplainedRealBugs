diff --git a/ql/src/java/org/apache/hadoop/hive/ql/Driver.java b/ql/src/java/org/apache/hadoop/hive/ql/Driver.java
index 9aefff8292..2a0696200e 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/Driver.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/Driver.java
@@ -594,7 +594,7 @@ private String getExplainOutput(BaseSemanticAnalyzer sem, QueryPlan plan,
     PrintStream ps = new PrintStream(baos);
     try {
       List<Task<?>> rootTasks = sem.getAllRootTasks();
-      task.getJSONPlan(ps, astTree, rootTasks, sem.getFetchTask(), false, true, true);
+      task.getJSONPlan(ps, rootTasks, sem.getFetchTask(), false, true, true);
       ret = baos.toString();
     } catch (Exception e) {
       LOG.warn("Exception generating explain output: " + e, e);
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/ExplainTask.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/ExplainTask.java
index 4116141948..4ce086483c 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/ExplainTask.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/ExplainTask.java
@@ -39,8 +39,6 @@
 import java.util.Set;
 import java.util.TreeMap;
 
-import org.slf4j.Logger;
-import org.slf4j.LoggerFactory;
 import org.apache.hadoop.fs.Path;
 import org.apache.hadoop.hive.common.jsonexplain.JsonParser;
 import org.apache.hadoop.hive.common.jsonexplain.JsonParserFactory;
@@ -50,7 +48,6 @@
 import org.apache.hadoop.hive.ql.hooks.ReadEntity;
 import org.apache.hadoop.hive.ql.metadata.Table;
 import org.apache.hadoop.hive.ql.optimizer.physical.StageIDsRearranger;
-import org.apache.hadoop.hive.ql.parse.ASTNode;
 import org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer;
 import org.apache.hadoop.hive.ql.plan.Explain;
 import org.apache.hadoop.hive.ql.plan.Explain.Level;
@@ -68,6 +65,8 @@
 import org.json.JSONArray;
 import org.json.JSONException;
 import org.json.JSONObject;
+import org.slf4j.Logger;
+import org.slf4j.LoggerFactory;
 
 /**
  * ExplainTask implementation.
@@ -139,18 +138,6 @@ public JSONObject getJSONLogicalPlan(PrintStream out, ExplainWork work) throws E
       out = null;
     }
 
-    // Print out the parse AST
-    if (work.getAstStringTree() != null) {
-      String jsonAST = outputAST(work.getAstStringTree(), out, jsonOutput, 0);
-      if (out != null) {
-        out.println();
-      }
-
-      if (jsonOutput) {
-        outJSONObject.put("ABSTRACT SYNTAX TREE", jsonAST);
-      }
-    }
-
     if (work.getParseContext() != null) {
       if (out != null) {
         out.print("LOGICAL PLAN:");
@@ -172,11 +159,11 @@ public JSONObject getJSONLogicalPlan(PrintStream out, ExplainWork work) throws E
 
   public JSONObject getJSONPlan(PrintStream out, ExplainWork work)
       throws Exception {
-    return getJSONPlan(out, work.getAstTree(), work.getRootTasks(), work.getFetchTask(),
+    return getJSONPlan(out, work.getRootTasks(), work.getFetchTask(),
                        work.isFormatted(), work.getExtended(), work.isAppendTaskType());
   }
 
-  public JSONObject getJSONPlan(PrintStream out, ASTNode ast, List<Task<?>> tasks, Task<?> fetchTask,
+  public JSONObject getJSONPlan(PrintStream out, List<Task<?>> tasks, Task<?> fetchTask,
       boolean jsonOutput, boolean isExtended, boolean appendTaskType) throws Exception {
 
     // If the user asked for a formatted output, dump the json output
@@ -187,18 +174,6 @@ public JSONObject getJSONPlan(PrintStream out, ASTNode ast, List<Task<?>> tasks,
       out = null;
     }
 
-    // Print out the parse AST
-    if (ast != null && isExtended) {
-      String jsonAST = outputAST(ast.dump(), out, jsonOutput, 0);
-      if (out != null) {
-        out.println();
-      }
-
-      if (jsonOutput) {
-        outJSONObject.put("ABSTRACT SYNTAX TREE", jsonAST);
-      }
-    }
-
     List<Task> ordered = StageIDsRearranger.getExplainOrder(conf, tasks);
 
     if (fetchTask != null) {
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/hooks/ATSHook.java b/ql/src/java/org/apache/hadoop/hive/ql/hooks/ATSHook.java
index f4901611cc..b7e70be013 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/hooks/ATSHook.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/hooks/ATSHook.java
@@ -22,11 +22,8 @@
 import java.util.concurrent.Executors;
 import java.util.concurrent.TimeUnit;
 
-import org.slf4j.Logger;
-import org.slf4j.LoggerFactory;
 import org.apache.hadoop.conf.Configuration;
 import org.apache.hadoop.hive.conf.HiveConf;
-import org.apache.hadoop.hive.conf.HiveConf.ConfVars;
 import org.apache.hadoop.hive.ql.QueryPlan;
 import org.apache.hadoop.hive.ql.exec.ExplainTask;
 import org.apache.hadoop.hive.ql.exec.TaskFactory;
@@ -39,6 +36,8 @@
 import org.apache.hadoop.yarn.client.api.TimelineClient;
 import org.apache.hadoop.yarn.conf.YarnConfiguration;
 import org.json.JSONObject;
+import org.slf4j.Logger;
+import org.slf4j.LoggerFactory;
 
 import com.google.common.util.concurrent.ThreadFactoryBuilder;
 
@@ -124,7 +123,6 @@ public void run() {
                 null,// pCtx
                 plan.getRootTasks(),// RootTasks
                 plan.getFetchTask(),// FetchTask
-                null,// astStringTree
                 null,// analyzer
                 false,// extended
                 true,// formatted
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/CalcitePlanner.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/CalcitePlanner.java
index b59347da8c..c069dc4a05 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/CalcitePlanner.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/CalcitePlanner.java
@@ -297,8 +297,8 @@ Operator genOPTree(ASTNode ast, PlannerContext plannerCtx) throws SemanticExcept
             LOG.info("CBO Succeeded; optimized logical plan.");
             this.ctx.setCboInfo("Plan optimized by CBO.");
             this.ctx.setCboSucceeded(true);
-            if (LOG.isDebugEnabled()) {
-              LOG.debug(newAST.dump());
+            if (LOG.isTraceEnabled()) {
+              LOG.trace(newAST.dump());
             }
           }
         } catch (Exception e) {
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/ExplainSemanticAnalyzer.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/ExplainSemanticAnalyzer.java
index e393be21e7..eefc14547a 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/ExplainSemanticAnalyzer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/ExplainSemanticAnalyzer.java
@@ -24,8 +24,8 @@
 
 import org.apache.hadoop.hive.conf.HiveConf;
 import org.apache.hadoop.hive.metastore.api.FieldSchema;
-import org.apache.hadoop.hive.ql.exec.FetchTask;
 import org.apache.hadoop.hive.ql.exec.ExplainTask;
+import org.apache.hadoop.hive.ql.exec.FetchTask;
 import org.apache.hadoop.hive.ql.exec.Task;
 import org.apache.hadoop.hive.ql.exec.TaskFactory;
 import org.apache.hadoop.hive.ql.plan.ExplainWork;
@@ -102,7 +102,6 @@ public void analyzeInternal(ASTNode ast) throws SemanticException {
         pCtx,
         tasks,
         fetchTask,
-        input,
         sem,
         extended,
         formatted,
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/plan/ExplainWork.java b/ql/src/java/org/apache/hadoop/hive/ql/plan/ExplainWork.java
index 132cb8d3e6..a213c83380 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/plan/ExplainWork.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/plan/ExplainWork.java
@@ -26,7 +26,6 @@
 import org.apache.hadoop.fs.Path;
 import org.apache.hadoop.hive.ql.exec.Task;
 import org.apache.hadoop.hive.ql.hooks.ReadEntity;
-import org.apache.hadoop.hive.ql.parse.ASTNode;
 import org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer;
 import org.apache.hadoop.hive.ql.parse.ParseContext;
 
@@ -40,8 +39,6 @@ public class ExplainWork implements Serializable {
   private Path resFile;
   private ArrayList<Task<? extends Serializable>> rootTasks;
   private Task<? extends Serializable> fetchTask;
-  private ASTNode astTree;
-  private String astStringTree;
   private HashSet<ReadEntity> inputs;
   private ParseContext pCtx;
 
@@ -65,7 +62,6 @@ public ExplainWork(Path resFile,
       ParseContext pCtx,
       List<Task<? extends Serializable>> rootTasks,
       Task<? extends Serializable> fetchTask,
-      ASTNode astTree,
       BaseSemanticAnalyzer analyzer,
       boolean extended,
       boolean formatted,
@@ -77,7 +73,6 @@ public ExplainWork(Path resFile,
     this.resFile = resFile;
     this.rootTasks = new ArrayList<Task<? extends Serializable>>(rootTasks);
     this.fetchTask = fetchTask;
-    this.astTree = astTree;
     this.analyzer = analyzer;
     if (analyzer != null) {
       this.inputs = analyzer.getInputs();
@@ -116,17 +111,6 @@ public void setFetchTask(Task<? extends Serializable> fetchTask) {
     this.fetchTask = fetchTask;
   }
 
-  public ASTNode getAstTree() {
-    return astTree;
-  }
-
-  public String getAstStringTree() {
-    if (astStringTree == null) {
-      astStringTree = astTree.dump();
-    }
-    return astStringTree;
-  }
-
   public HashSet<ReadEntity> getInputs() {
     return inputs;
   }
diff --git a/ql/src/test/org/apache/hadoop/hive/ql/parse/TestUpdateDeleteSemanticAnalyzer.java b/ql/src/test/org/apache/hadoop/hive/ql/parse/TestUpdateDeleteSemanticAnalyzer.java
index d795324c2c..8614d402bc 100644
--- a/ql/src/test/org/apache/hadoop/hive/ql/parse/TestUpdateDeleteSemanticAnalyzer.java
+++ b/ql/src/test/org/apache/hadoop/hive/ql/parse/TestUpdateDeleteSemanticAnalyzer.java
@@ -23,8 +23,6 @@
 import java.util.HashMap;
 import java.util.Map;
 
-import org.slf4j.Logger;
-import org.slf4j.LoggerFactory;
 import org.apache.hadoop.fs.FSDataInputStream;
 import org.apache.hadoop.fs.FileSystem;
 import org.apache.hadoop.fs.Path;
@@ -42,6 +40,8 @@
 import org.apache.hadoop.hive.ql.session.SessionState;
 import org.junit.Before;
 import org.junit.Test;
+import org.slf4j.Logger;
+import org.slf4j.LoggerFactory;
 
 public class TestUpdateDeleteSemanticAnalyzer {
 
@@ -59,7 +59,7 @@ public void testInsertSelect() throws Exception {
     try {
       ReturnInfo rc = parseAndAnalyze("insert into table T select a, b from U", "testInsertSelect");
 
-      LOG.info(explain((SemanticAnalyzer)rc.sem, rc.plan, rc.ast));
+      LOG.info(explain((SemanticAnalyzer)rc.sem, rc.plan));
 
     } finally {
       cleanupTables();
@@ -70,7 +70,7 @@ public void testInsertSelect() throws Exception {
   public void testDeleteAllNonPartitioned() throws Exception {
     try {
       ReturnInfo rc = parseAndAnalyze("delete from T", "testDeleteAllNonPartitioned");
-      LOG.info(explain((SemanticAnalyzer)rc.sem, rc.plan, rc.ast));
+      LOG.info(explain((SemanticAnalyzer)rc.sem, rc.plan));
     } finally {
       cleanupTables();
     }
@@ -80,7 +80,7 @@ public void testDeleteAllNonPartitioned() throws Exception {
   public void testDeleteWhereNoPartition() throws Exception {
     try {
       ReturnInfo rc = parseAndAnalyze("delete from T where a > 5", "testDeleteWhereNoPartition");
-      LOG.info(explain((SemanticAnalyzer)rc.sem, rc.plan, rc.ast));
+      LOG.info(explain((SemanticAnalyzer)rc.sem, rc.plan));
     } finally {
       cleanupTables();
     }
@@ -90,7 +90,7 @@ public void testDeleteWhereNoPartition() throws Exception {
   public void testDeleteAllPartitioned() throws Exception {
     try {
       ReturnInfo rc = parseAndAnalyze("delete from U", "testDeleteAllPartitioned");
-      LOG.info(explain((SemanticAnalyzer)rc.sem, rc.plan, rc.ast));
+      LOG.info(explain((SemanticAnalyzer)rc.sem, rc.plan));
     } finally {
       cleanupTables();
     }
@@ -100,7 +100,7 @@ public void testDeleteAllPartitioned() throws Exception {
   public void testDeleteAllWherePartitioned() throws Exception {
     try {
       ReturnInfo rc = parseAndAnalyze("delete from U where a > 5", "testDeleteAllWherePartitioned");
-      LOG.info(explain((SemanticAnalyzer)rc.sem, rc.plan, rc.ast));
+      LOG.info(explain((SemanticAnalyzer)rc.sem, rc.plan));
     } finally {
       cleanupTables();
     }
@@ -111,7 +111,7 @@ public void testDeleteOnePartition() throws Exception {
     try {
       ReturnInfo rc = parseAndAnalyze("delete from U where ds = 'today'",
           "testDeleteFromPartitionOnly");
-      LOG.info(explain((SemanticAnalyzer)rc.sem, rc.plan, rc.ast));
+      LOG.info(explain((SemanticAnalyzer)rc.sem, rc.plan));
     } finally {
       cleanupTables();
     }
@@ -122,7 +122,7 @@ public void testDeleteOnePartitionWhere() throws Exception {
     try {
       ReturnInfo rc = parseAndAnalyze("delete from U where ds = 'today' and a > 5",
           "testDeletePartitionWhere");
-      LOG.info(explain((SemanticAnalyzer)rc.sem, rc.plan, rc.ast));
+      LOG.info(explain((SemanticAnalyzer)rc.sem, rc.plan));
     } finally {
       cleanupTables();
     }
@@ -132,7 +132,7 @@ public void testDeleteOnePartitionWhere() throws Exception {
   public void testUpdateAllNonPartitioned() throws Exception {
     try {
       ReturnInfo rc = parseAndAnalyze("update T set b = 5", "testUpdateAllNonPartitioned");
-      LOG.info(explain((SemanticAnalyzer)rc.sem, rc.plan, rc.ast));
+      LOG.info(explain((SemanticAnalyzer)rc.sem, rc.plan));
     } finally {
       cleanupTables();
     }
@@ -143,7 +143,7 @@ public void testUpdateAllNonPartitionedWhere() throws Exception {
     try {
       ReturnInfo rc = parseAndAnalyze("update T set b = 5 where b > 5",
           "testUpdateAllNonPartitionedWhere");
-      LOG.info(explain((SemanticAnalyzer)rc.sem, rc.plan, rc.ast));
+      LOG.info(explain((SemanticAnalyzer)rc.sem, rc.plan));
     } finally {
       cleanupTables();
     }
@@ -153,7 +153,7 @@ public void testUpdateAllNonPartitionedWhere() throws Exception {
   public void testUpdateAllPartitioned() throws Exception {
     try {
       ReturnInfo rc = parseAndAnalyze("update U set b = 5", "testUpdateAllPartitioned");
-      LOG.info(explain((SemanticAnalyzer)rc.sem, rc.plan, rc.ast));
+      LOG.info(explain((SemanticAnalyzer)rc.sem, rc.plan));
     } finally {
       cleanupTables();
     }
@@ -164,7 +164,7 @@ public void testUpdateAllPartitionedWhere() throws Exception {
     try {
       ReturnInfo rc = parseAndAnalyze("update U set b = 5 where b > 5",
           "testUpdateAllPartitionedWhere");
-      LOG.info(explain((SemanticAnalyzer)rc.sem, rc.plan, rc.ast));
+      LOG.info(explain((SemanticAnalyzer)rc.sem, rc.plan));
     } finally {
       cleanupTables();
     }
@@ -175,7 +175,7 @@ public void testUpdateOnePartition() throws Exception {
     try {
       ReturnInfo rc = parseAndAnalyze("update U set b = 5 where ds = 'today'",
           "testUpdateOnePartition");
-      LOG.info(explain((SemanticAnalyzer)rc.sem, rc.plan, rc.ast));
+      LOG.info(explain((SemanticAnalyzer)rc.sem, rc.plan));
     } finally {
       cleanupTables();
     }
@@ -186,7 +186,7 @@ public void testUpdateOnePartitionWhere() throws Exception {
     try {
       ReturnInfo rc = parseAndAnalyze("update U set b = 5 where ds = 'today' and b > 5",
           "testUpdateOnePartitionWhere");
-      LOG.info(explain((SemanticAnalyzer)rc.sem, rc.plan, rc.ast));
+      LOG.info(explain((SemanticAnalyzer)rc.sem, rc.plan));
     } finally {
       cleanupTables();
     }
@@ -198,7 +198,7 @@ public void testInsertValues() throws Exception {
       ReturnInfo rc = parseAndAnalyze("insert into table T values ('abc', 3), ('ghi', null)",
           "testInsertValues");
 
-      LOG.info(explain((SemanticAnalyzer)rc.sem, rc.plan, rc.ast));
+      LOG.info(explain((SemanticAnalyzer)rc.sem, rc.plan));
 
     } finally {
       cleanupTables();
@@ -212,7 +212,7 @@ public void testInsertValuesPartitioned() throws Exception {
               "('abc', 3, 'today'), ('ghi', 5, 'tomorrow')",
           "testInsertValuesPartitioned");
 
-      LOG.info(explain((SemanticAnalyzer) rc.sem, rc.plan, rc.ast));
+      LOG.info(explain((SemanticAnalyzer) rc.sem, rc.plan));
 
     } finally {
       cleanupTables();
@@ -235,12 +235,10 @@ public void cleanupTables() throws HiveException {
   }
 
   private class ReturnInfo {
-    ASTNode ast;
     BaseSemanticAnalyzer sem;
     QueryPlan plan;
 
-    ReturnInfo(ASTNode a, BaseSemanticAnalyzer s, QueryPlan p) {
-      ast = a;
+    ReturnInfo(BaseSemanticAnalyzer s, QueryPlan p) {
       sem = s;
       plan = p;
     }
@@ -283,10 +281,10 @@ private ReturnInfo parseAndAnalyze(String query, String testName)
 
     QueryPlan plan = new QueryPlan(query, sem, 0L, testName, null, null);
 
-    return new ReturnInfo(tree, sem, plan);
+    return new ReturnInfo(sem, plan);
   }
 
-  private String explain(SemanticAnalyzer sem, QueryPlan plan, ASTNode astTree) throws
+  private String explain(SemanticAnalyzer sem, QueryPlan plan) throws
       IOException {
     FileSystem fs = FileSystem.get(conf);
     File f = File.createTempFile("TestSemanticAnalyzer", "explain");
@@ -294,7 +292,7 @@ private String explain(SemanticAnalyzer sem, QueryPlan plan, ASTNode astTree) th
     fs.create(tmp);
     fs.deleteOnExit(tmp);
     ExplainWork work = new ExplainWork(tmp, sem.getParseContext(), sem.getRootTasks(),
-        sem.getFetchTask(), astTree, sem, true, false, false, false, false, false, null);
+        sem.getFetchTask(), sem, true, false, false, false, false, false, null);
     ExplainTask task = new ExplainTask();
     task.setWork(work);
     task.initialize(conf, plan, null, null);
diff --git a/ql/src/test/results/clientpositive/alter_partition_coltype.q.out b/ql/src/test/results/clientpositive/alter_partition_coltype.q.out
index a184372285..d6f607c4dc 100644
--- a/ql/src/test/results/clientpositive/alter_partition_coltype.q.out
+++ b/ql/src/test/results/clientpositive/alter_partition_coltype.q.out
@@ -89,28 +89,6 @@ PREHOOK: query: explain extended select count(*) from alter_coltype where dt = '
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select count(*) from alter_coltype where dt = '100'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            alter_coltype
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-      TOK_WHERE
-         =
-            TOK_TABLE_OR_COL
-               dt
-            '100'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -316,28 +294,6 @@ PREHOOK: query: explain extended select count(*) from alter_coltype where ts = '
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select count(*) from alter_coltype where ts = '6.30'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            alter_coltype
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-      TOK_WHERE
-         =
-            TOK_TABLE_OR_COL
-               ts
-            '6.30'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -470,33 +426,6 @@ PREHOOK: query: explain extended select count(*) from alter_coltype where ts = 3
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select count(*) from alter_coltype where ts = 3.0 and dt=100
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            alter_coltype
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-      TOK_WHERE
-         and
-            =
-               TOK_TABLE_OR_COL
-                  ts
-               3.0
-            =
-               TOK_TABLE_OR_COL
-                  dt
-               100
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -678,37 +607,6 @@ PREHOOK: query: explain extended select key, value, dt, ts from alter_coltype wh
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select key, value, dt, ts from alter_coltype where dt is not null
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            alter_coltype
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               dt
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ts
-      TOK_WHERE
-         TOK_FUNCTION
-            TOK_ISNOTNULL
-            TOK_TABLE_OR_COL
-               dt
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
@@ -950,34 +848,6 @@ PREHOOK: query: explain extended select intcol from pt.alterdynamic_part_table w
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select intcol from pt.alterdynamic_part_table where partcol1='1' and partcol2='1'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            pt
-            alterdynamic_part_table
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               intcol
-      TOK_WHERE
-         and
-            =
-               TOK_TABLE_OR_COL
-                  partcol1
-               '1'
-            =
-               TOK_TABLE_OR_COL
-                  partcol2
-               '1'
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
@@ -1045,44 +915,6 @@ PREHOOK: query: explain extended select intcol from pt.alterdynamic_part_table w
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select intcol from pt.alterdynamic_part_table where (partcol1='2' and partcol2='1')or (partcol1='1' and partcol2='__HIVE_DEFAULT_PARTITION__')
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            pt
-            alterdynamic_part_table
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               intcol
-      TOK_WHERE
-         or
-            and
-               =
-                  TOK_TABLE_OR_COL
-                     partcol1
-                  '2'
-               =
-                  TOK_TABLE_OR_COL
-                     partcol2
-                  '1'
-            and
-               =
-                  TOK_TABLE_OR_COL
-                     partcol1
-                  '1'
-               =
-                  TOK_TABLE_OR_COL
-                     partcol2
-                  '__HIVE_DEFAULT_PARTITION__'
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
diff --git a/ql/src/test/results/clientpositive/ambiguitycheck.q.out b/ql/src/test/results/clientpositive/ambiguitycheck.q.out
index 5ee28c6bd5..3c0f3aae3b 100644
--- a/ql/src/test/results/clientpositive/ambiguitycheck.q.out
+++ b/ql/src/test/results/clientpositive/ambiguitycheck.q.out
@@ -709,26 +709,6 @@ PREHOOK: query: explain extended select int(1.2) from src limit 1
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select int(1.2) from src limit 1
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            src
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTION
-               int
-               1.2
-      TOK_LIMIT
-         1
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
@@ -837,16 +817,6 @@ PREHOOK: query: explain extended desc default.src key
 PREHOOK: type: DESCTABLE
 POSTHOOK: query: explain extended desc default.src key
 POSTHOOK: type: DESCTABLE
-ABSTRACT SYNTAX TREE:
-  
-TOK_DESCTABLE
-   TOK_TABTYPE
-      TOK_TABNAME
-         default
-         src
-      key
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
   Stage-1 depends on stages: Stage-0
diff --git a/ql/src/test/results/clientpositive/analyze_table_null_partition.q.out b/ql/src/test/results/clientpositive/analyze_table_null_partition.q.out
index 72a24d5d4d..1cca288e09 100644
--- a/ql/src/test/results/clientpositive/analyze_table_null_partition.q.out
+++ b/ql/src/test/results/clientpositive/analyze_table_null_partition.q.out
@@ -92,22 +92,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: -- Another way to show stats.
 EXPLAIN EXTENDED select * from test2
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            test2
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
diff --git a/ql/src/test/results/clientpositive/auto_join_reordering_values.q.out b/ql/src/test/results/clientpositive/auto_join_reordering_values.q.out
index db79fa5bf8..f3f445bdd2 100644
--- a/ql/src/test/results/clientpositive/auto_join_reordering_values.q.out
+++ b/ql/src/test/results/clientpositive/auto_join_reordering_values.q.out
@@ -84,89 +84,6 @@ JOIN `orderpayment_small` `order_city` ON `order_city`.`cityid` = `orderpayment`
 JOIN `user_small` `user` ON `user`.`userid` = `orderpayment`.`userid`
 limit 5
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_JOIN
-            TOK_JOIN
-               TOK_JOIN
-                  TOK_TABREF
-                     TOK_TABNAME
-                        orderpayment_small
-                     orderpayment
-                  TOK_TABREF
-                     TOK_TABNAME
-                        orderpayment_small
-                     dim_pay_date
-                  =
-                     .
-                        TOK_TABLE_OR_COL
-                           dim_pay_date
-                        date
-                     .
-                        TOK_TABLE_OR_COL
-                           orderpayment
-                        date
-               TOK_TABREF
-                  TOK_TABNAME
-                     orderpayment_small
-                  deal
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        deal
-                     dealid
-                  .
-                     TOK_TABLE_OR_COL
-                        orderpayment
-                     dealid
-            TOK_TABREF
-               TOK_TABNAME
-                  orderpayment_small
-               order_city
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     order_city
-                  cityid
-               .
-                  TOK_TABLE_OR_COL
-                     orderpayment
-                  cityid
-         TOK_TABREF
-            TOK_TABNAME
-               user_small
-            user
-         =
-            .
-               TOK_TABLE_OR_COL
-                  user
-               userid
-            .
-               TOK_TABLE_OR_COL
-                  orderpayment
-               userid
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  dim_pay_date
-               date
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  deal
-               dealid
-      TOK_LIMIT
-         5
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/auto_sortmerge_join_1.q.out b/ql/src/test/results/clientpositive/auto_sortmerge_join_1.q.out
index f768ea469e..09025566e5 100644
--- a/ql/src/test/results/clientpositive/auto_sortmerge_join_1.q.out
+++ b/ql/src/test/results/clientpositive/auto_sortmerge_join_1.q.out
@@ -109,38 +109,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: -- Since size is being used to find the big table, the order of the tables in the join does not matter
 explain extended select count(*) FROM bucket_small a JOIN bucket_big b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -330,38 +298,6 @@ PREHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_s
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_small b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -551,38 +487,6 @@ PREHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_s
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_small b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-5 is a root stage , consists of Stage-6, Stage-7, Stage-1
   Stage-6 has a backup stage: Stage-1
diff --git a/ql/src/test/results/clientpositive/auto_sortmerge_join_11.q.out b/ql/src/test/results/clientpositive/auto_sortmerge_join_11.q.out
index f4bbfd083d..81de2b0453 100644
--- a/ql/src/test/results/clientpositive/auto_sortmerge_join_11.q.out
+++ b/ql/src/test/results/clientpositive/auto_sortmerge_join_11.q.out
@@ -105,38 +105,6 @@ PREHOOK: query: explain extended select count(*) FROM bucket_small a JOIN bucket
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select count(*) FROM bucket_small a JOIN bucket_big b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-5 is a root stage
   Stage-2 depends on stages: Stage-5
@@ -453,38 +421,6 @@ POSTHOOK: query: -- Since size is being used to find the big table, the order of
 -- bucketized mapjoin is not done
 explain extended select count(*) FROM bucket_small a JOIN bucket_big b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-5 is a root stage
   Stage-2 depends on stages: Stage-5
@@ -795,43 +731,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: -- The join is converted to a bucketed mapjoin with a mapjoin hint
 explain extended select /*+ mapjoin(a) */ count(*) FROM bucket_small a JOIN bucket_big b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  a
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
@@ -1097,58 +996,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: -- HIVE-7023
 explain extended select /* + MAPJOIN(a,b) */ count(*) FROM bucket_small a JOIN bucket_big b ON a.key = b.key JOIN bucket_big c ON a.key = c.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_JOIN
-            TOK_TABREF
-               TOK_TABNAME
-                  bucket_small
-               a
-            TOK_TABREF
-               TOK_TABNAME
-                  bucket_big
-               b
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            c
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  c
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  a
-                  b
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-4 is a root stage
   Stage-1 depends on stages: Stage-4
diff --git a/ql/src/test/results/clientpositive/auto_sortmerge_join_12.q.out b/ql/src/test/results/clientpositive/auto_sortmerge_join_12.q.out
index e5ff904c8d..26a11a79e6 100644
--- a/ql/src/test/results/clientpositive/auto_sortmerge_join_12.q.out
+++ b/ql/src/test/results/clientpositive/auto_sortmerge_join_12.q.out
@@ -143,66 +143,6 @@ PREHOOK: query: explain extended select count(*) FROM bucket_small a JOIN bucket
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select count(*) FROM bucket_small a JOIN bucket_medium b ON a.key = b.key JOIN bucket_big c ON c.key = b.key JOIN bucket_medium d ON c.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_JOIN
-            TOK_JOIN
-               TOK_TABREF
-                  TOK_TABNAME
-                     bucket_small
-                  a
-               TOK_TABREF
-                  TOK_TABNAME
-                     bucket_medium
-                  b
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     key
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-            TOK_TABREF
-               TOK_TABNAME
-                  bucket_big
-               c
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     c
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_medium
-            d
-         =
-            .
-               TOK_TABLE_OR_COL
-                  c
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-9 is a root stage
   Stage-3 depends on stages: Stage-9
diff --git a/ql/src/test/results/clientpositive/auto_sortmerge_join_2.q.out b/ql/src/test/results/clientpositive/auto_sortmerge_join_2.q.out
index 0de079d7d0..78cd03ddcf 100644
--- a/ql/src/test/results/clientpositive/auto_sortmerge_join_2.q.out
+++ b/ql/src/test/results/clientpositive/auto_sortmerge_join_2.q.out
@@ -89,38 +89,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: -- Since the leftmost table is assumed as the big table, arrange the tables in the join accordingly
 explain extended select count(*) FROM bucket_big a JOIN bucket_small b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -312,38 +280,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: -- The mapjoin should fail resulting in the sort-merge join
 explain extended select count(*) FROM bucket_big a JOIN bucket_small b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-5 is a root stage , consists of Stage-6, Stage-7, Stage-1
   Stage-6 has a backup stage: Stage-1
diff --git a/ql/src/test/results/clientpositive/auto_sortmerge_join_3.q.out b/ql/src/test/results/clientpositive/auto_sortmerge_join_3.q.out
index a161f1c389..7ddf6b3282 100644
--- a/ql/src/test/results/clientpositive/auto_sortmerge_join_3.q.out
+++ b/ql/src/test/results/clientpositive/auto_sortmerge_join_3.q.out
@@ -89,38 +89,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: -- Since size is being used to find the big table, the order of the tables in the join does not matter
 explain extended select count(*) FROM bucket_small a JOIN bucket_big b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -264,38 +232,6 @@ PREHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_s
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_small b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -439,38 +375,6 @@ PREHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_s
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_small b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-5 is a root stage , consists of Stage-6, Stage-7, Stage-1
   Stage-6 has a backup stage: Stage-1
diff --git a/ql/src/test/results/clientpositive/auto_sortmerge_join_4.q.out b/ql/src/test/results/clientpositive/auto_sortmerge_join_4.q.out
index 3421ab1183..5b68da2eb4 100644
--- a/ql/src/test/results/clientpositive/auto_sortmerge_join_4.q.out
+++ b/ql/src/test/results/clientpositive/auto_sortmerge_join_4.q.out
@@ -105,38 +105,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: -- Since size is being used to find the big table, the order of the tables in the join does not matter
 explain extended select count(*) FROM bucket_small a JOIN bucket_big b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -280,38 +248,6 @@ PREHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_s
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_small b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -455,38 +391,6 @@ PREHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_s
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_small b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-5 is a root stage , consists of Stage-6, Stage-7, Stage-1
   Stage-6 has a backup stage: Stage-1
diff --git a/ql/src/test/results/clientpositive/auto_sortmerge_join_5.q.out b/ql/src/test/results/clientpositive/auto_sortmerge_join_5.q.out
index 9c2663cd05..07bcb89c37 100644
--- a/ql/src/test/results/clientpositive/auto_sortmerge_join_5.q.out
+++ b/ql/src/test/results/clientpositive/auto_sortmerge_join_5.q.out
@@ -76,38 +76,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: -- Since size is being used to find the big table, the order of the tables in the join does not matter
 explain extended select count(*) FROM bucket_small a JOIN bucket_big b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -242,38 +210,6 @@ PREHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_s
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_small b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -408,38 +344,6 @@ PREHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_s
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_small b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-5 is a root stage , consists of Stage-6, Stage-7, Stage-1
   Stage-6 has a backup stage: Stage-1
diff --git a/ql/src/test/results/clientpositive/auto_sortmerge_join_7.q.out b/ql/src/test/results/clientpositive/auto_sortmerge_join_7.q.out
index a25db01548..d12c1ca90e 100644
--- a/ql/src/test/results/clientpositive/auto_sortmerge_join_7.q.out
+++ b/ql/src/test/results/clientpositive/auto_sortmerge_join_7.q.out
@@ -122,38 +122,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: -- Since size is being used to find the big table, the order of the tables in the join does not matter
 explain extended select count(*) FROM bucket_small a JOIN bucket_big b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -345,38 +313,6 @@ PREHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_s
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_small b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -568,38 +504,6 @@ PREHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_s
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_small b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-5 is a root stage , consists of Stage-6, Stage-7, Stage-1
   Stage-6 has a backup stage: Stage-1
diff --git a/ql/src/test/results/clientpositive/auto_sortmerge_join_8.q.out b/ql/src/test/results/clientpositive/auto_sortmerge_join_8.q.out
index d22ba3bce6..ce0590ceb6 100644
--- a/ql/src/test/results/clientpositive/auto_sortmerge_join_8.q.out
+++ b/ql/src/test/results/clientpositive/auto_sortmerge_join_8.q.out
@@ -122,38 +122,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: -- Since size is being used to find the big table, the order of the tables in the join does not matter
 explain extended select count(*) FROM bucket_small a JOIN bucket_big b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -345,38 +313,6 @@ PREHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_s
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_small b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -570,38 +506,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: -- The mapjoin should fail resulting in the sort-merge join
 explain extended select count(*) FROM bucket_big a JOIN bucket_small b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-5 is a root stage , consists of Stage-6, Stage-7, Stage-1
   Stage-6 has a backup stage: Stage-1
diff --git a/ql/src/test/results/clientpositive/binary_output_format.q.out b/ql/src/test/results/clientpositive/binary_output_format.q.out
index 32b2feb8f8..608d475b38 100644
--- a/ql/src/test/results/clientpositive/binary_output_format.q.out
+++ b/ql/src/test/results/clientpositive/binary_output_format.q.out
@@ -52,42 +52,6 @@ SELECT TRANSFORM(*)
     RECORDREADER 'org.apache.hadoop.hive.ql.exec.BinaryRecordReader'
 FROM src
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            src
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dest1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TRANSFORM
-               TOK_EXPLIST
-                  TOK_ALLCOLREF
-               TOK_SERDE
-               TOK_RECORDWRITER
-               'cat'
-               TOK_SERDE
-                  TOK_SERDENAME
-                     'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
-                     TOK_TABLEPROPERTIES
-                        TOK_TABLEPROPLIST
-                           TOK_TABLEPROPERTY
-                              'serialization.last.column.takes.rest'
-                              'true'
-               TOK_RECORDREADER
-                  'org.apache.hadoop.hive.ql.exec.BinaryRecordReader'
-               TOK_TABCOLLIST
-                  TOK_TABCOL
-                     mydata
-                     TOK_STRING
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-7 depends on stages: Stage-1 , consists of Stage-4, Stage-3, Stage-5
diff --git a/ql/src/test/results/clientpositive/bucket1.q.out b/ql/src/test/results/clientpositive/bucket1.q.out
index 0680176cb3..96b8d4e34c 100644
--- a/ql/src/test/results/clientpositive/bucket1.q.out
+++ b/ql/src/test/results/clientpositive/bucket1.q.out
@@ -18,23 +18,6 @@ POSTHOOK: query: explain extended
 insert overwrite table bucket1_1
 select * from src
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            src
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucket1_1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/bucket2.q.out b/ql/src/test/results/clientpositive/bucket2.q.out
index 958e55696a..b5572fd58e 100644
--- a/ql/src/test/results/clientpositive/bucket2.q.out
+++ b/ql/src/test/results/clientpositive/bucket2.q.out
@@ -18,23 +18,6 @@ POSTHOOK: query: explain extended
 insert overwrite table bucket2_1
 select * from src
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            src
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucket2_1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/bucket3.q.out b/ql/src/test/results/clientpositive/bucket3.q.out
index eca9ba54dd..29afaeac19 100644
--- a/ql/src/test/results/clientpositive/bucket3.q.out
+++ b/ql/src/test/results/clientpositive/bucket3.q.out
@@ -18,27 +18,6 @@ POSTHOOK: query: explain extended
 insert overwrite table bucket3_1 partition (ds='1')
 select * from src
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            src
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucket3_1
-            TOK_PARTSPEC
-               TOK_PARTVAL
-                  ds
-                  '1'
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/bucket4.q.out b/ql/src/test/results/clientpositive/bucket4.q.out
index dd9ef005d5..c4baf728fd 100644
--- a/ql/src/test/results/clientpositive/bucket4.q.out
+++ b/ql/src/test/results/clientpositive/bucket4.q.out
@@ -14,23 +14,6 @@ POSTHOOK: query: explain extended
 insert overwrite table bucket4_1
 select * from src
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            src
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucket4_1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/bucket5.q.out b/ql/src/test/results/clientpositive/bucket5.q.out
index fa926aaa0a..dee79f936d 100644
--- a/ql/src/test/results/clientpositive/bucket5.q.out
+++ b/ql/src/test/results/clientpositive/bucket5.q.out
@@ -30,42 +30,6 @@ FROM src
 INSERT OVERWRITE TABLE bucketed_table SELECT key, value
 INSERT OVERWRITE TABLE unbucketed_table SELECT key, value cluster by key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            src
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucketed_table
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               unbucketed_table
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-      TOK_CLUSTERBY
-         TOK_TABLE_OR_COL
-            key
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-0 depends on stages: Stage-2
diff --git a/ql/src/test/results/clientpositive/bucket_many.q.out b/ql/src/test/results/clientpositive/bucket_many.q.out
index a9e2f0bd10..90d9fb8dae 100644
--- a/ql/src/test/results/clientpositive/bucket_many.q.out
+++ b/ql/src/test/results/clientpositive/bucket_many.q.out
@@ -14,23 +14,6 @@ POSTHOOK: query: explain extended
 insert overwrite table bucket_many
 select * from src
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            src
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucket_many
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/bucket_map_join_1.q.out b/ql/src/test/results/clientpositive/bucket_map_join_1.q.out
index 05fb43492f..49bf2ca172 100644
--- a/ql/src/test/results/clientpositive/bucket_map_join_1.q.out
+++ b/ql/src/test/results/clientpositive/bucket_map_join_1.q.out
@@ -56,53 +56,6 @@ POSTHOOK: query: -- The tables are bucketed in same columns in different order,
 explain extended
 select /*+ mapjoin(b) */ count(*) from table1 a join table2 b on a.key=b.key and a.value=b.value
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               table1
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               table2
-            b
-         and
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  value
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  value
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
diff --git a/ql/src/test/results/clientpositive/bucket_map_join_2.q.out b/ql/src/test/results/clientpositive/bucket_map_join_2.q.out
index 1173c93480..9ec7033c3d 100644
--- a/ql/src/test/results/clientpositive/bucket_map_join_2.q.out
+++ b/ql/src/test/results/clientpositive/bucket_map_join_2.q.out
@@ -56,53 +56,6 @@ POSTHOOK: query: -- The tables are bucketed in same columns in different order,
 explain extended
 select /*+ mapjoin(b) */ count(*) from table1 a join table2 b on a.key=b.key and a.value=b.value
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               table1
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               table2
-            b
-         and
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  value
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  value
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
diff --git a/ql/src/test/results/clientpositive/bucket_map_join_spark1.q.out b/ql/src/test/results/clientpositive/bucket_map_join_spark1.q.out
index 3b1912a8ec..19937cb98c 100644
--- a/ql/src/test/results/clientpositive/bucket_map_join_spark1.q.out
+++ b/ql/src/test/results/clientpositive/bucket_map_join_spark1.q.out
@@ -116,58 +116,6 @@ select a.key, a.value, b.value
 from srcbucket_mapjoin_part a join srcbucket_mapjoin_part_2 b
 on a.key=b.key and b.ds="2008-04-08"
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            b
-         and
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  ds
-               "2008-04-08"
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucketmapjoin_tmp_result
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-5 is a root stage
   Stage-4 depends on stages: Stage-5
@@ -478,58 +426,6 @@ select a.key, a.value, b.value
 from srcbucket_mapjoin_part a join srcbucket_mapjoin_part_2 b
 on a.key=b.key and b.ds="2008-04-08"
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            b
-         and
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  ds
-               "2008-04-08"
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucketmapjoin_tmp_result
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-5 is a root stage
   Stage-4 depends on stages: Stage-5
diff --git a/ql/src/test/results/clientpositive/bucket_map_join_spark2.q.out b/ql/src/test/results/clientpositive/bucket_map_join_spark2.q.out
index 9a6aef761c..90528be870 100644
--- a/ql/src/test/results/clientpositive/bucket_map_join_spark2.q.out
+++ b/ql/src/test/results/clientpositive/bucket_map_join_spark2.q.out
@@ -100,58 +100,6 @@ select a.key, a.value, b.value
 from srcbucket_mapjoin_part a join srcbucket_mapjoin_part_2 b
 on a.key=b.key and b.ds="2008-04-08"
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            b
-         and
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  ds
-               "2008-04-08"
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucketmapjoin_tmp_result
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-5 is a root stage
   Stage-4 depends on stages: Stage-5
@@ -462,58 +410,6 @@ select a.key, a.value, b.value
 from srcbucket_mapjoin_part a join srcbucket_mapjoin_part_2 b
 on a.key=b.key and b.ds="2008-04-08"
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            b
-         and
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  ds
-               "2008-04-08"
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucketmapjoin_tmp_result
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-5 is a root stage
   Stage-4 depends on stages: Stage-5
diff --git a/ql/src/test/results/clientpositive/bucket_map_join_spark3.q.out b/ql/src/test/results/clientpositive/bucket_map_join_spark3.q.out
index 1d2166f812..aede979fa2 100644
--- a/ql/src/test/results/clientpositive/bucket_map_join_spark3.q.out
+++ b/ql/src/test/results/clientpositive/bucket_map_join_spark3.q.out
@@ -100,58 +100,6 @@ select a.key, a.value, b.value
 from srcbucket_mapjoin_part a join srcbucket_mapjoin_part_2 b
 on a.key=b.key and b.ds="2008-04-08"
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            b
-         and
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  ds
-               "2008-04-08"
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucketmapjoin_tmp_result
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-5 is a root stage
   Stage-4 depends on stages: Stage-5
@@ -462,58 +410,6 @@ select a.key, a.value, b.value
 from srcbucket_mapjoin_part a join srcbucket_mapjoin_part_2 b
 on a.key=b.key and b.ds="2008-04-08"
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            b
-         and
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  ds
-               "2008-04-08"
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucketmapjoin_tmp_result
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-5 is a root stage
   Stage-4 depends on stages: Stage-5
diff --git a/ql/src/test/results/clientpositive/bucket_map_join_spark4.q.out b/ql/src/test/results/clientpositive/bucket_map_join_spark4.q.out
index 7d323765c9..662ad0e6f8 100644
--- a/ql/src/test/results/clientpositive/bucket_map_join_spark4.q.out
+++ b/ql/src/test/results/clientpositive/bucket_map_join_spark4.q.out
@@ -70,73 +70,6 @@ POSTHOOK: query: explain extended
 select a.key as key, a.value as val1, b.value as val2, c.value as val3
 from tbl1 a join tbl2 b on a.key = b.key join tbl3 c on a.value = c.value
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_JOIN
-            TOK_TABREF
-               TOK_TABNAME
-                  tbl1
-               a
-            TOK_TABREF
-               TOK_TABNAME
-                  tbl2
-               b
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-         TOK_TABREF
-            TOK_TABNAME
-               tbl3
-            c
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-            .
-               TOK_TABLE_OR_COL
-                  c
-               value
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-            val1
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-            val2
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  c
-               value
-            val3
-
-
 STAGE DEPENDENCIES:
   Stage-7 is a root stage
   Stage-5 depends on stages: Stage-7
@@ -487,73 +420,6 @@ POSTHOOK: query: explain extended
 select a.key as key, a.value as val1, b.value as val2, c.value as val3
 from tbl1 a join tbl2 b on a.key = b.key join tbl3 c on a.value = c.value
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_JOIN
-            TOK_TABREF
-               TOK_TABNAME
-                  tbl1
-               a
-            TOK_TABREF
-               TOK_TABNAME
-                  tbl2
-               b
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-         TOK_TABREF
-            TOK_TABNAME
-               tbl3
-            c
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-            .
-               TOK_TABLE_OR_COL
-                  c
-               value
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-            val1
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-            val2
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  c
-               value
-            val3
-
-
 STAGE DEPENDENCIES:
   Stage-7 is a root stage
   Stage-5 depends on stages: Stage-7
diff --git a/ql/src/test/results/clientpositive/bucketcontext_1.q.out b/ql/src/test/results/clientpositive/bucketcontext_1.q.out
index 78a0c8c285..d1b77444d5 100644
--- a/ql/src/test/results/clientpositive/bucketcontext_1.q.out
+++ b/ql/src/test/results/clientpositive/bucketcontext_1.q.out
@@ -103,43 +103,6 @@ PREHOOK: query: explain extended select /* + MAPJOIN(a) */ count(*) FROM bucket_
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select /* + MAPJOIN(a) */ count(*) FROM bucket_small a JOIN bucket_big b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  a
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
@@ -406,43 +369,6 @@ PREHOOK: query: explain extended select /* + MAPJOIN(a) */ count(*) FROM bucket_
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select /* + MAPJOIN(a) */ count(*) FROM bucket_small a JOIN bucket_big b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  a
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/bucketcontext_2.q.out b/ql/src/test/results/clientpositive/bucketcontext_2.q.out
index bc08fd24d2..60c021c913 100644
--- a/ql/src/test/results/clientpositive/bucketcontext_2.q.out
+++ b/ql/src/test/results/clientpositive/bucketcontext_2.q.out
@@ -87,43 +87,6 @@ PREHOOK: query: explain extended select /* + MAPJOIN(a) */ count(*) FROM bucket_
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select /* + MAPJOIN(a) */ count(*) FROM bucket_small a JOIN bucket_big b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  a
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
@@ -390,43 +353,6 @@ PREHOOK: query: explain extended select /* + MAPJOIN(a) */ count(*) FROM bucket_
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select /* + MAPJOIN(a) */ count(*) FROM bucket_small a JOIN bucket_big b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  a
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/bucketcontext_3.q.out b/ql/src/test/results/clientpositive/bucketcontext_3.q.out
index 0cba2ca809..12eaddff85 100644
--- a/ql/src/test/results/clientpositive/bucketcontext_3.q.out
+++ b/ql/src/test/results/clientpositive/bucketcontext_3.q.out
@@ -87,43 +87,6 @@ PREHOOK: query: explain extended select /* + MAPJOIN(a) */ count(*) FROM bucket_
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select /* + MAPJOIN(a) */ count(*) FROM bucket_small a JOIN bucket_big b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  a
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
@@ -387,43 +350,6 @@ PREHOOK: query: explain extended select /* + MAPJOIN(a) */ count(*) FROM bucket_
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select /* + MAPJOIN(a) */ count(*) FROM bucket_small a JOIN bucket_big b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  a
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/bucketcontext_4.q.out b/ql/src/test/results/clientpositive/bucketcontext_4.q.out
index 652b377f02..25735641bb 100644
--- a/ql/src/test/results/clientpositive/bucketcontext_4.q.out
+++ b/ql/src/test/results/clientpositive/bucketcontext_4.q.out
@@ -103,43 +103,6 @@ PREHOOK: query: explain extended select /* + MAPJOIN(a) */ count(*) FROM bucket_
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select /* + MAPJOIN(a) */ count(*) FROM bucket_small a JOIN bucket_big b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  a
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
@@ -403,43 +366,6 @@ PREHOOK: query: explain extended select /* + MAPJOIN(a) */ count(*) FROM bucket_
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select /* + MAPJOIN(a) */ count(*) FROM bucket_small a JOIN bucket_big b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  a
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/bucketcontext_5.q.out b/ql/src/test/results/clientpositive/bucketcontext_5.q.out
index ee4532a342..e1c6a8049e 100644
--- a/ql/src/test/results/clientpositive/bucketcontext_5.q.out
+++ b/ql/src/test/results/clientpositive/bucketcontext_5.q.out
@@ -68,43 +68,6 @@ PREHOOK: query: explain extended select /* + MAPJOIN(a) */ count(*) FROM bucket_
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select /* + MAPJOIN(a) */ count(*) FROM bucket_small a JOIN bucket_big b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  a
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
@@ -272,43 +235,6 @@ PREHOOK: query: explain extended select /* + MAPJOIN(a) */ count(*) FROM bucket_
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select /* + MAPJOIN(a) */ count(*) FROM bucket_small a JOIN bucket_big b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  a
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/bucketcontext_6.q.out b/ql/src/test/results/clientpositive/bucketcontext_6.q.out
index e280b95ea6..9deb64d58e 100644
--- a/ql/src/test/results/clientpositive/bucketcontext_6.q.out
+++ b/ql/src/test/results/clientpositive/bucketcontext_6.q.out
@@ -86,43 +86,6 @@ PREHOOK: query: explain extended select /* + MAPJOIN(a) */ count(*) FROM bucket_
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select /* + MAPJOIN(a) */ count(*) FROM bucket_small a JOIN bucket_big b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  a
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
@@ -343,43 +306,6 @@ PREHOOK: query: explain extended select /* + MAPJOIN(a) */ count(*) FROM bucket_
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select /* + MAPJOIN(a) */ count(*) FROM bucket_small a JOIN bucket_big b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  a
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/bucketcontext_7.q.out b/ql/src/test/results/clientpositive/bucketcontext_7.q.out
index b44ae95cce..621844e8fd 100644
--- a/ql/src/test/results/clientpositive/bucketcontext_7.q.out
+++ b/ql/src/test/results/clientpositive/bucketcontext_7.q.out
@@ -120,43 +120,6 @@ PREHOOK: query: explain extended select /* + MAPJOIN(a) */ count(*) FROM bucket_
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select /* + MAPJOIN(a) */ count(*) FROM bucket_small a JOIN bucket_big b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  a
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
@@ -468,43 +431,6 @@ PREHOOK: query: explain extended select /* + MAPJOIN(a) */ count(*) FROM bucket_
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select /* + MAPJOIN(a) */ count(*) FROM bucket_small a JOIN bucket_big b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  a
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/bucketcontext_8.q.out b/ql/src/test/results/clientpositive/bucketcontext_8.q.out
index eee7b57e5d..7f3e50a63f 100644
--- a/ql/src/test/results/clientpositive/bucketcontext_8.q.out
+++ b/ql/src/test/results/clientpositive/bucketcontext_8.q.out
@@ -120,43 +120,6 @@ PREHOOK: query: explain extended select /* + MAPJOIN(a) */ count(*) FROM bucket_
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select /* + MAPJOIN(a) */ count(*) FROM bucket_small a JOIN bucket_big b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  a
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
@@ -468,43 +431,6 @@ PREHOOK: query: explain extended select /* + MAPJOIN(a) */ count(*) FROM bucket_
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select /* + MAPJOIN(a) */ count(*) FROM bucket_small a JOIN bucket_big b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  a
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/bucketmapjoin1.q.out b/ql/src/test/results/clientpositive/bucketmapjoin1.q.out
index ac8a76ff58..9956fa76c7 100644
--- a/ql/src/test/results/clientpositive/bucketmapjoin1.q.out
+++ b/ql/src/test/results/clientpositive/bucketmapjoin1.q.out
@@ -34,62 +34,6 @@ select /*+mapjoin(b)*/ a.key, a.value, b.value
 from srcbucket_mapjoin_part a join srcbucket_mapjoin_part_2 b
 on a.key=b.key where b.ds="2008-04-08"
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-      TOK_WHERE
-         =
-            .
-               TOK_TABLE_OR_COL
-                  b
-               ds
-            "2008-04-08"
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
@@ -203,62 +147,6 @@ select /*+mapjoin(a)*/ a.key, a.value, b.value
 from srcbucket_mapjoin_part a join srcbucket_mapjoin_part_2 b
 on a.key=b.key where b.ds="2008-04-08"
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  a
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-      TOK_WHERE
-         =
-            .
-               TOK_TABLE_OR_COL
-                  b
-               ds
-            "2008-04-08"
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
@@ -464,63 +352,6 @@ select /*+mapjoin(b)*/ a.key, a.value, b.value
 from srcbucket_mapjoin a join srcbucket_mapjoin_part b 
 on a.key=b.key where b.ds="2008-04-08"
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucketmapjoin_tmp_result
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-      TOK_WHERE
-         =
-            .
-               TOK_TABLE_OR_COL
-                  b
-               ds
-            "2008-04-08"
-
-
 STAGE DEPENDENCIES:
   Stage-9 is a root stage
   Stage-1 depends on stages: Stage-9
@@ -996,63 +827,6 @@ select /*+mapjoin(a)*/ a.key, a.value, b.value
 from srcbucket_mapjoin a join srcbucket_mapjoin_part b 
 on a.key=b.key where b.ds="2008-04-08"
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucketmapjoin_tmp_result
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  a
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-      TOK_WHERE
-         =
-            .
-               TOK_TABLE_OR_COL
-                  b
-               ds
-            "2008-04-08"
-
-
 STAGE DEPENDENCIES:
   Stage-9 is a root stage
   Stage-1 depends on stages: Stage-9
diff --git a/ql/src/test/results/clientpositive/bucketmapjoin10.q.out b/ql/src/test/results/clientpositive/bucketmapjoin10.q.out
index 041f2d0c40..fcdbb09e81 100644
--- a/ql/src/test/results/clientpositive/bucketmapjoin10.q.out
+++ b/ql/src/test/results/clientpositive/bucketmapjoin10.q.out
@@ -140,57 +140,6 @@ SELECT /*+ MAPJOIN(b) */ count(*)
 FROM srcbucket_mapjoin_part_1 a JOIN srcbucket_mapjoin_part_2 b
 ON a.key = b.key AND a.part IS NOT NULL AND b.part IS NOT NULL
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_1
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            b
-         AND
-            AND
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     key
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-               TOK_FUNCTION
-                  TOK_ISNOTNULL
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     part
-            TOK_FUNCTION
-               TOK_ISNOTNULL
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  part
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
diff --git a/ql/src/test/results/clientpositive/bucketmapjoin11.q.out b/ql/src/test/results/clientpositive/bucketmapjoin11.q.out
index 5e9fbe4615..968066a095 100644
--- a/ql/src/test/results/clientpositive/bucketmapjoin11.q.out
+++ b/ql/src/test/results/clientpositive/bucketmapjoin11.q.out
@@ -150,57 +150,6 @@ SELECT /*+ MAPJOIN(b) */ count(*)
 FROM srcbucket_mapjoin_part_1 a JOIN srcbucket_mapjoin_part_2 b
 ON a.key = b.key AND a.part IS NOT NULL AND b.part IS NOT NULL
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_1
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            b
-         AND
-            AND
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     key
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-               TOK_FUNCTION
-                  TOK_ISNOTNULL
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     part
-            TOK_FUNCTION
-               TOK_ISNOTNULL
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  part
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
@@ -518,67 +467,6 @@ SELECT /*+ MAPJOIN(b) */ count(*)
 FROM srcbucket_mapjoin_part_1 a JOIN srcbucket_mapjoin_part_2 b
 ON a.key = b.key AND a.part = b.part AND a.part IS NOT NULL AND b.part IS NOT NULL
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_1
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            b
-         AND
-            AND
-               AND
-                  =
-                     .
-                        TOK_TABLE_OR_COL
-                           a
-                        key
-                     .
-                        TOK_TABLE_OR_COL
-                           b
-                        key
-                  =
-                     .
-                        TOK_TABLE_OR_COL
-                           a
-                        part
-                     .
-                        TOK_TABLE_OR_COL
-                           b
-                        part
-               TOK_FUNCTION
-                  TOK_ISNOTNULL
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     part
-            TOK_FUNCTION
-               TOK_ISNOTNULL
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  part
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
diff --git a/ql/src/test/results/clientpositive/bucketmapjoin12.q.out b/ql/src/test/results/clientpositive/bucketmapjoin12.q.out
index 3a38d7b489..9017871e10 100644
--- a/ql/src/test/results/clientpositive/bucketmapjoin12.q.out
+++ b/ql/src/test/results/clientpositive/bucketmapjoin12.q.out
@@ -109,57 +109,6 @@ SELECT /*+ MAPJOIN(b) */ count(*)
 FROM srcbucket_mapjoin_part_1 a JOIN srcbucket_mapjoin_part_2 b
 ON a.key = b.key AND a.part = '1' and b.part = '1'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_1
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            b
-         and
-            AND
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     key
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     part
-                  '1'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  part
-               '1'
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
@@ -389,57 +338,6 @@ SELECT /*+ MAPJOIN(b) */ count(*)
 FROM srcbucket_mapjoin_part_1 a JOIN srcbucket_mapjoin_part_3 b
 ON a.key = b.key AND a.part = '1' and b.part = '1'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_1
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_3
-            b
-         and
-            AND
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     key
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     part
-                  '1'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  part
-               '1'
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
diff --git a/ql/src/test/results/clientpositive/bucketmapjoin13.q.out b/ql/src/test/results/clientpositive/bucketmapjoin13.q.out
index c78b7a193c..55d6ffdf26 100644
--- a/ql/src/test/results/clientpositive/bucketmapjoin13.q.out
+++ b/ql/src/test/results/clientpositive/bucketmapjoin13.q.out
@@ -82,43 +82,6 @@ SELECT /*+ MAPJOIN(b) */ count(*)
 FROM srcbucket_mapjoin_part_1 a JOIN srcbucket_mapjoin_part_2 b
 ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_1
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
@@ -397,50 +360,6 @@ SELECT /*+ MAPJOIN(b) */ count(*)
 FROM srcbucket_mapjoin_part_1 a JOIN srcbucket_mapjoin_part_2 b
 ON a.key = b.key and a.part = '2'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_1
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            b
-         and
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  part
-               '2'
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
@@ -685,43 +604,6 @@ SELECT /*+ MAPJOIN(b) */ count(*)
 FROM srcbucket_mapjoin_part_1 a JOIN srcbucket_mapjoin_part_2 b
 ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_1
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
@@ -968,43 +850,6 @@ SELECT /*+ MAPJOIN(b) */ count(*)
 FROM srcbucket_mapjoin_part_1 a JOIN srcbucket_mapjoin_part_2 b
 ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_1
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
diff --git a/ql/src/test/results/clientpositive/bucketmapjoin2.q.out b/ql/src/test/results/clientpositive/bucketmapjoin2.q.out
index d9c4463204..f2efb95d4e 100644
--- a/ql/src/test/results/clientpositive/bucketmapjoin2.q.out
+++ b/ql/src/test/results/clientpositive/bucketmapjoin2.q.out
@@ -100,63 +100,6 @@ select /*+mapjoin(b)*/ a.key, a.value, b.value
 from srcbucket_mapjoin_part a join srcbucket_mapjoin_part_2 b
 on a.key=b.key and b.ds="2008-04-08"
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            b
-         and
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  ds
-               "2008-04-08"
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucketmapjoin_tmp_result
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-9 is a root stage
   Stage-1 depends on stages: Stage-9
@@ -640,63 +583,6 @@ select /*+mapjoin(a)*/ a.key, a.value, b.value
 from srcbucket_mapjoin_part a join srcbucket_mapjoin_part_2 b
 on a.key=b.key and b.ds="2008-04-08"
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            b
-         and
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  ds
-               "2008-04-08"
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucketmapjoin_tmp_result
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  a
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-9 is a root stage
   Stage-1 depends on stages: Stage-9
@@ -1239,56 +1125,6 @@ select /*+mapjoin(b)*/ a.key, a.value, b.value
 from srcbucket_mapjoin_part a join srcbucket_mapjoin_part_2 b
 on a.key=b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucketmapjoin_tmp_result
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-9 is a root stage
   Stage-1 depends on stages: Stage-9
diff --git a/ql/src/test/results/clientpositive/bucketmapjoin3.q.out b/ql/src/test/results/clientpositive/bucketmapjoin3.q.out
index 77b19bae90..565998382f 100644
--- a/ql/src/test/results/clientpositive/bucketmapjoin3.q.out
+++ b/ql/src/test/results/clientpositive/bucketmapjoin3.q.out
@@ -124,70 +124,6 @@ select /*+mapjoin(b)*/ a.key, a.value, b.value
 from srcbucket_mapjoin_part_2 a join srcbucket_mapjoin_part b 
 on a.key=b.key and b.ds="2008-04-08" and a.ds="2008-04-08"
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part
-            b
-         and
-            and
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     key
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     ds
-                  "2008-04-08"
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  ds
-               "2008-04-08"
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucketmapjoin_tmp_result
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-9 is a root stage
   Stage-1 depends on stages: Stage-9
@@ -671,70 +607,6 @@ select /*+mapjoin(a)*/ a.key, a.value, b.value
 from srcbucket_mapjoin_part_2 a join srcbucket_mapjoin_part b 
 on a.key=b.key and b.ds="2008-04-08" and a.ds="2008-04-08"
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part
-            b
-         and
-            and
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     key
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     ds
-                  "2008-04-08"
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  ds
-               "2008-04-08"
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucketmapjoin_tmp_result
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  a
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-9 is a root stage
   Stage-1 depends on stages: Stage-9
diff --git a/ql/src/test/results/clientpositive/bucketmapjoin4.q.out b/ql/src/test/results/clientpositive/bucketmapjoin4.q.out
index 58581608a9..5794d477c6 100644
--- a/ql/src/test/results/clientpositive/bucketmapjoin4.q.out
+++ b/ql/src/test/results/clientpositive/bucketmapjoin4.q.out
@@ -124,56 +124,6 @@ select /*+mapjoin(b)*/ a.key, a.value, b.value
 from srcbucket_mapjoin a join srcbucket_mapjoin b
 on a.key=b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucketmapjoin_tmp_result
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-9 is a root stage
   Stage-1 depends on stages: Stage-9
@@ -598,56 +548,6 @@ select /*+mapjoin(a)*/ a.key, a.value, b.value
 from srcbucket_mapjoin a join srcbucket_mapjoin b
 on a.key=b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucketmapjoin_tmp_result
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  a
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-9 is a root stage
   Stage-1 depends on stages: Stage-9
diff --git a/ql/src/test/results/clientpositive/bucketmapjoin5.q.out b/ql/src/test/results/clientpositive/bucketmapjoin5.q.out
index 728c0b7b5a..1bcb382614 100644
--- a/ql/src/test/results/clientpositive/bucketmapjoin5.q.out
+++ b/ql/src/test/results/clientpositive/bucketmapjoin5.q.out
@@ -174,56 +174,6 @@ select /*+mapjoin(a)*/ a.key, a.value, b.value
 from srcbucket_mapjoin a join srcbucket_mapjoin_part b 
 on a.key=b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucketmapjoin_tmp_result
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  a
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-9 is a root stage
   Stage-1 depends on stages: Stage-9
@@ -709,56 +659,6 @@ select /*+mapjoin(a)*/ a.key, a.value, b.value
 from srcbucket_mapjoin a join srcbucket_mapjoin_part_2 b 
 on a.key=b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucketmapjoin_tmp_result
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  a
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-9 is a root stage
   Stage-1 depends on stages: Stage-9
diff --git a/ql/src/test/results/clientpositive/bucketmapjoin7.q.out b/ql/src/test/results/clientpositive/bucketmapjoin7.q.out
index 7f96a2354e..76b13f385f 100644
--- a/ql/src/test/results/clientpositive/bucketmapjoin7.q.out
+++ b/ql/src/test/results/clientpositive/bucketmapjoin7.q.out
@@ -68,79 +68,6 @@ FROM srcbucket_mapjoin_part_1 a JOIN srcbucket_mapjoin_part_2 b
 ON a.key = b.key AND a.ds = '2008-04-08' AND b.ds = '2008-04-08'
 ORDER BY a.key, b.value LIMIT 1
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_1
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            b
-         AND
-            AND
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     key
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     ds
-                  '2008-04-08'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  ds
-               '2008-04-08'
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  value
-      TOK_LIMIT
-         1
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
diff --git a/ql/src/test/results/clientpositive/bucketmapjoin8.q.out b/ql/src/test/results/clientpositive/bucketmapjoin8.q.out
index 804c882305..097eaad524 100644
--- a/ql/src/test/results/clientpositive/bucketmapjoin8.q.out
+++ b/ql/src/test/results/clientpositive/bucketmapjoin8.q.out
@@ -74,57 +74,6 @@ SELECT /*+ MAPJOIN(b) */ count(*)
 FROM srcbucket_mapjoin_part_1 a JOIN srcbucket_mapjoin_part_2 b
 ON a.key = b.key AND a.part = '1' and b.part = '1'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_1
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            b
-         and
-            AND
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     key
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     part
-                  '1'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  part
-               '1'
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
@@ -363,57 +312,6 @@ SELECT /*+ MAPJOIN(b) */ count(*)
 FROM srcbucket_mapjoin_part_1 a JOIN srcbucket_mapjoin_part_2 b
 ON a.key = b.key AND a.part = '1' and b.part = '1'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_1
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            b
-         and
-            AND
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     key
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     part
-                  '1'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  part
-               '1'
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
diff --git a/ql/src/test/results/clientpositive/bucketmapjoin9.q.out b/ql/src/test/results/clientpositive/bucketmapjoin9.q.out
index cc0672e601..144d86d2b3 100644
--- a/ql/src/test/results/clientpositive/bucketmapjoin9.q.out
+++ b/ql/src/test/results/clientpositive/bucketmapjoin9.q.out
@@ -82,57 +82,6 @@ SELECT /*+ MAPJOIN(b) */ count(*)
 FROM srcbucket_mapjoin_part_1 a JOIN srcbucket_mapjoin_part_2 b
 ON a.key = b.key AND a.part = '1' and b.part = '1'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_1
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            b
-         and
-            AND
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     key
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     part
-                  '1'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  part
-               '1'
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
@@ -396,57 +345,6 @@ SELECT /*+ MAPJOIN(b) */ count(*)
 FROM srcbucket_mapjoin_part_1 a JOIN srcbucket_mapjoin_part_2 b
 ON a.key = b.key AND a.part = '1' AND b.part = '1'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_1
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            b
-         AND
-            AND
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     key
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     part
-                  '1'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  part
-               '1'
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
diff --git a/ql/src/test/results/clientpositive/bucketmapjoin_negative.q.out b/ql/src/test/results/clientpositive/bucketmapjoin_negative.q.out
index 36b1cfee73..d108575ea7 100644
--- a/ql/src/test/results/clientpositive/bucketmapjoin_negative.q.out
+++ b/ql/src/test/results/clientpositive/bucketmapjoin_negative.q.out
@@ -75,63 +75,6 @@ select /*+mapjoin(b)*/ a.key, a.value, b.value
 from srcbucket_mapjoin a join srcbucket_mapjoin_part b 
 on a.key=b.key where b.ds="2008-04-08"
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucketmapjoin_tmp_result
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-      TOK_WHERE
-         =
-            .
-               TOK_TABLE_OR_COL
-                  b
-               ds
-            "2008-04-08"
-
-
 STAGE DEPENDENCIES:
   Stage-9 is a root stage
   Stage-1 depends on stages: Stage-9
diff --git a/ql/src/test/results/clientpositive/bucketmapjoin_negative2.q.out b/ql/src/test/results/clientpositive/bucketmapjoin_negative2.q.out
index 21138d6f40..9c6a226d4a 100644
--- a/ql/src/test/results/clientpositive/bucketmapjoin_negative2.q.out
+++ b/ql/src/test/results/clientpositive/bucketmapjoin_negative2.q.out
@@ -84,56 +84,6 @@ select /*+mapjoin(b)*/ a.key, a.value, b.value
 from srcbucket_mapjoin a join srcbucket_mapjoin_part_2 b 
 on a.key=b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucketmapjoin_tmp_result
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-9 is a root stage
   Stage-1 depends on stages: Stage-9
diff --git a/ql/src/test/results/clientpositive/bucketmapjoin_negative3.q.out b/ql/src/test/results/clientpositive/bucketmapjoin_negative3.q.out
index c95681aaba..3078854b52 100644
--- a/ql/src/test/results/clientpositive/bucketmapjoin_negative3.q.out
+++ b/ql/src/test/results/clientpositive/bucketmapjoin_negative3.q.out
@@ -148,52 +148,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: -- should be allowed
 explain extended select /* + MAPJOIN(R) */ * from test1 L join test1 R on L.key=R.key AND L.value=R.value
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               test1
-            L
-         TOK_TABREF
-            TOK_TABNAME
-               test1
-            R
-         AND
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     L
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     R
-                  key
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     L
-                  value
-               .
-                  TOK_TABLE_OR_COL
-                     R
-                  value
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  R
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
@@ -336,52 +290,6 @@ PREHOOK: query: explain extended select /* + MAPJOIN(R) */ * from test2 L join t
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select /* + MAPJOIN(R) */ * from test2 L join test2 R on L.key=R.key AND L.value=R.value
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               test2
-            L
-         TOK_TABREF
-            TOK_TABNAME
-               test2
-            R
-         AND
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     L
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     R
-                  key
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     L
-                  value
-               .
-                  TOK_TABLE_OR_COL
-                     R
-                  value
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  R
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
@@ -526,47 +434,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: -- should not apply bucket mapjoin
 explain extended select /* + MAPJOIN(R) */ * from test1 L join test1 R on L.key+L.key=R.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               test1
-            L
-         TOK_TABREF
-            TOK_TABNAME
-               test1
-            R
-         =
-            +
-               .
-                  TOK_TABLE_OR_COL
-                     L
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     L
-                  key
-            .
-               TOK_TABLE_OR_COL
-                  R
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  R
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
@@ -701,52 +568,6 @@ PREHOOK: query: explain extended select /* + MAPJOIN(R) */ * from test1 L join t
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select /* + MAPJOIN(R) */ * from test1 L join test2 R on L.key=R.key AND L.value=R.value
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               test1
-            L
-         TOK_TABREF
-            TOK_TABNAME
-               test2
-            R
-         AND
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     L
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     R
-                  key
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     L
-                  value
-               .
-                  TOK_TABLE_OR_COL
-                     R
-                  value
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  R
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
@@ -881,52 +702,6 @@ PREHOOK: query: explain extended select /* + MAPJOIN(R) */ * from test1 L join t
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select /* + MAPJOIN(R) */ * from test1 L join test3 R on L.key=R.key AND L.value=R.value
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               test1
-            L
-         TOK_TABREF
-            TOK_TABNAME
-               test3
-            R
-         AND
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     L
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     R
-                  key
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     L
-                  value
-               .
-                  TOK_TABLE_OR_COL
-                     R
-                  value
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  R
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
@@ -1061,52 +836,6 @@ PREHOOK: query: explain extended select /* + MAPJOIN(R) */ * from test1 L join t
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select /* + MAPJOIN(R) */ * from test1 L join test4 R on L.key=R.key AND L.value=R.value
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               test1
-            L
-         TOK_TABREF
-            TOK_TABNAME
-               test4
-            R
-         AND
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     L
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     R
-                  key
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     L
-                  value
-               .
-                  TOK_TABLE_OR_COL
-                     R
-                  value
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  R
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
@@ -1241,52 +970,6 @@ PREHOOK: query: explain extended select /* + MAPJOIN(R) */ * from test2 L join t
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select /* + MAPJOIN(R) */ * from test2 L join test3 R on L.key=R.key AND L.value=R.value
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               test2
-            L
-         TOK_TABREF
-            TOK_TABNAME
-               test3
-            R
-         AND
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     L
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     R
-                  key
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     L
-                  value
-               .
-                  TOK_TABLE_OR_COL
-                     R
-                  value
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  R
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
@@ -1421,52 +1104,6 @@ PREHOOK: query: explain extended select /* + MAPJOIN(R) */ * from test2 L join t
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select /* + MAPJOIN(R) */ * from test2 L join test4 R on L.key=R.key AND L.value=R.value
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               test2
-            L
-         TOK_TABREF
-            TOK_TABNAME
-               test4
-            R
-         AND
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     L
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     R
-                  key
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     L
-                  value
-               .
-                  TOK_TABLE_OR_COL
-                     R
-                  value
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  R
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
@@ -1601,52 +1238,6 @@ PREHOOK: query: explain extended select /* + MAPJOIN(R) */ * from test3 L join t
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select /* + MAPJOIN(R) */ * from test3 L join test4 R on L.key=R.key AND L.value=R.value
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               test3
-            L
-         TOK_TABREF
-            TOK_TABNAME
-               test4
-            R
-         AND
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     L
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     R
-                  key
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     L
-                  value
-               .
-                  TOK_TABLE_OR_COL
-                     R
-                  value
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  R
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
diff --git a/ql/src/test/results/clientpositive/cbo_rp_outer_join_ppr.q.java1.7.out b/ql/src/test/results/clientpositive/cbo_rp_outer_join_ppr.q.java1.7.out
index f680a02726..5c40dc47bc 100644
--- a/ql/src/test/results/clientpositive/cbo_rp_outer_join_ppr.q.java1.7.out
+++ b/ql/src/test/results/clientpositive/cbo_rp_outer_join_ppr.q.java1.7.out
@@ -22,90 +22,6 @@ EXPLAIN EXTENDED
  SELECT a.key, a.value, b.key, b.value
  WHERE a.key > 10 AND a.key < 20 AND b.key > 15 AND b.key < 25
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_FULLOUTERJOIN
-         TOK_TABREF
-            TOK_TABNAME
-               src
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcpart
-            b
-         AND
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  ds
-               '2008-04-08'
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-      TOK_WHERE
-         AND
-            AND
-               AND
-                  >
-                     .
-                        TOK_TABLE_OR_COL
-                           a
-                        key
-                     10
-                  <
-                     .
-                        TOK_TABLE_OR_COL
-                           a
-                        key
-                     20
-               >
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-                  15
-            <
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-               25
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -497,90 +413,6 @@ POSTHOOK: query: EXPLAIN EXTENDED
  SELECT a.key, a.value, b.key, b.value
  WHERE a.key > 10 AND a.key < 20 AND b.key > 15 AND b.key < 25 AND b.ds = '2008-04-08'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_FULLOUTERJOIN
-         TOK_TABREF
-            TOK_TABNAME
-               src
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcpart
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-      TOK_WHERE
-         AND
-            AND
-               AND
-                  AND
-                     >
-                        .
-                           TOK_TABLE_OR_COL
-                              a
-                           key
-                        10
-                     <
-                        .
-                           TOK_TABLE_OR_COL
-                              a
-                           key
-                        20
-                  >
-                     .
-                        TOK_TABLE_OR_COL
-                           b
-                        key
-                     15
-               <
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-                  25
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  ds
-               '2008-04-08'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/columnstats_partlvl.q.out b/ql/src/test/results/clientpositive/columnstats_partlvl.q.out
index bfdc3b6632..4edf39a7fd 100644
--- a/ql/src/test/results/clientpositive/columnstats_partlvl.q.out
+++ b/ql/src/test/results/clientpositive/columnstats_partlvl.q.out
@@ -88,21 +88,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 analyze table Employee_Part partition (employeeSalary=2000.0) compute statistics for columns employeeID
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_ANALYZE
-   TOK_TAB
-      TOK_TABNAME
-         Employee_Part
-      TOK_PARTSPEC
-         TOK_PARTVAL
-            employeeSalary
-            2000.0
-   columns
-   TOK_TABCOLNAME
-      employeeID
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
   Stage-1 depends on stages: Stage-0
@@ -287,21 +272,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 analyze table Employee_Part partition (employeeSalary=4000.0) compute statistics for columns employeeID
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_ANALYZE
-   TOK_TAB
-      TOK_TABNAME
-         Employee_Part
-      TOK_PARTSPEC
-         TOK_PARTVAL
-            employeeSalary
-            4000.0
-   columns
-   TOK_TABCOLNAME
-      employeeID
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
   Stage-1 depends on stages: Stage-0
diff --git a/ql/src/test/results/clientpositive/columnstats_tbllvl.q.out b/ql/src/test/results/clientpositive/columnstats_tbllvl.q.out
index 96cf8fd237..669807d7a9 100644
--- a/ql/src/test/results/clientpositive/columnstats_tbllvl.q.out
+++ b/ql/src/test/results/clientpositive/columnstats_tbllvl.q.out
@@ -89,19 +89,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 analyze table UserVisits_web_text_none compute statistics for columns sourceIP, avgTimeOnSite, adRevenue
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_ANALYZE
-   TOK_TAB
-      TOK_TABNAME
-         UserVisits_web_text_none
-   columns
-   TOK_TABCOLNAME
-      sourceIP
-      avgTimeOnSite
-      adRevenue
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
   Stage-1 depends on stages: Stage-0
@@ -490,20 +477,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 analyze table dummydb.UserVisits_in_dummy_db compute statistics for columns sourceIP, avgTimeOnSite, adRevenue
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_ANALYZE
-   TOK_TAB
-      TOK_TABNAME
-         dummydb
-         UserVisits_in_dummy_db
-   columns
-   TOK_TABCOLNAME
-      sourceIP
-      avgTimeOnSite
-      adRevenue
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
   Stage-1 depends on stages: Stage-0
diff --git a/ql/src/test/results/clientpositive/combine2.q.out b/ql/src/test/results/clientpositive/combine2.q.out
index 8c59816101..fb9ef84ce9 100644
--- a/ql/src/test/results/clientpositive/combine2.q.out
+++ b/ql/src/test/results/clientpositive/combine2.q.out
@@ -152,29 +152,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select count(1) from combine2 where value is not null
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            combine2
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_WHERE
-         TOK_FUNCTION
-            TOK_ISNOTNULL
-            TOK_TABLE_OR_COL
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/constantPropagateForSubQuery.q.out b/ql/src/test/results/clientpositive/constantPropagateForSubQuery.q.out
index dc2f869e6d..c7a39f555d 100644
--- a/ql/src/test/results/clientpositive/constantPropagateForSubQuery.q.out
+++ b/ql/src/test/results/clientpositive/constantPropagateForSubQuery.q.out
@@ -9,68 +9,6 @@ POSTHOOK: query: -- SORT_QUERY_RESULTS
 explain extended
  select * from (select a.key as ak, a.value as av, b.key as bk, b.value as bv from src a join src1 b where a.key = '429' ) c
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_QUERY
-            TOK_FROM
-               TOK_JOIN
-                  TOK_TABREF
-                     TOK_TABNAME
-                        src
-                     a
-                  TOK_TABREF
-                     TOK_TABNAME
-                        src1
-                     b
-            TOK_INSERT
-               TOK_DESTINATION
-                  TOK_DIR
-                     TOK_TMP_FILE
-               TOK_SELECT
-                  TOK_SELEXPR
-                     .
-                        TOK_TABLE_OR_COL
-                           a
-                        key
-                     ak
-                  TOK_SELEXPR
-                     .
-                        TOK_TABLE_OR_COL
-                           a
-                        value
-                     av
-                  TOK_SELEXPR
-                     .
-                        TOK_TABLE_OR_COL
-                           b
-                        key
-                     bk
-                  TOK_SELEXPR
-                     .
-                        TOK_TABLE_OR_COL
-                           b
-                        value
-                     bv
-               TOK_WHERE
-                  =
-                     .
-                        TOK_TABLE_OR_COL
-                           a
-                        key
-                     '429'
-         c
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/ctas.q.out b/ql/src/test/results/clientpositive/ctas.q.out
index c9676deaa1..8d6c117039 100644
--- a/ql/src/test/results/clientpositive/ctas.q.out
+++ b/ql/src/test/results/clientpositive/ctas.q.out
@@ -694,49 +694,6 @@ PREHOOK: query: explain extended create table nzhang_ctas5 row format delimited
 PREHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: query: explain extended create table nzhang_ctas5 row format delimited fields terminated by ',' lines terminated by '\012' stored as textfile as select key, value from src sort by key, value limit 10
 POSTHOOK: type: CREATETABLE_AS_SELECT
-ABSTRACT SYNTAX TREE:
-  
-TOK_CREATETABLE
-   TOK_TABNAME
-      nzhang_ctas5
-   TOK_LIKETABLE
-   TOK_TABLEROWFORMAT
-      TOK_SERDEPROPS
-         TOK_TABLEROWFORMATFIELD
-            ','
-         TOK_TABLEROWFORMATLINES
-            '\012'
-   TOK_FILEFORMAT_GENERIC
-      textfile
-   TOK_QUERY
-      TOK_FROM
-         TOK_TABREF
-            TOK_TABNAME
-               src
-      TOK_INSERT
-         TOK_DESTINATION
-            TOK_DIR
-               TOK_TMP_FILE
-         TOK_SELECT
-            TOK_SELEXPR
-               TOK_TABLE_OR_COL
-                  key
-            TOK_SELEXPR
-               TOK_TABLE_OR_COL
-                  value
-         TOK_SORTBY
-            TOK_TABSORTCOLNAMEASC
-               TOK_NULLS_FIRST
-                  TOK_TABLE_OR_COL
-                     key
-            TOK_TABSORTCOLNAMEASC
-               TOK_NULLS_FIRST
-                  TOK_TABLE_OR_COL
-                     value
-         TOK_LIMIT
-            10
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/disable_merge_for_bucketing.q.out b/ql/src/test/results/clientpositive/disable_merge_for_bucketing.q.out
index 366bd7aa10..c4dbf17979 100644
--- a/ql/src/test/results/clientpositive/disable_merge_for_bucketing.q.out
+++ b/ql/src/test/results/clientpositive/disable_merge_for_bucketing.q.out
@@ -14,23 +14,6 @@ POSTHOOK: query: explain extended
 insert overwrite table bucket2_1
 select * from src
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            src
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucket2_1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/display_colstats_tbllvl.q.out b/ql/src/test/results/clientpositive/display_colstats_tbllvl.q.out
index b79095c463..1028c2677c 100644
--- a/ql/src/test/results/clientpositive/display_colstats_tbllvl.q.out
+++ b/ql/src/test/results/clientpositive/display_colstats_tbllvl.q.out
@@ -105,19 +105,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 analyze table UserVisits_web_text_none compute statistics for columns sourceIP, avgTimeOnSite, adRevenue
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_ANALYZE
-   TOK_TAB
-      TOK_TABNAME
-         UserVisits_web_text_none
-   columns
-   TOK_TABCOLNAME
-      sourceIP
-      avgTimeOnSite
-      adRevenue
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
   Stage-1 depends on stages: Stage-0
diff --git a/ql/src/test/results/clientpositive/drop_multi_partitions.q.out b/ql/src/test/results/clientpositive/drop_multi_partitions.q.out
index f723635f9f..5a0f84a226 100644
--- a/ql/src/test/results/clientpositive/drop_multi_partitions.q.out
+++ b/ql/src/test/results/clientpositive/drop_multi_partitions.q.out
@@ -46,20 +46,6 @@ PREHOOK: query: explain extended alter table dmp.mp drop partition (b='1')
 PREHOOK: type: ALTERTABLE_DROPPARTS
 POSTHOOK: query: explain extended alter table dmp.mp drop partition (b='1')
 POSTHOOK: type: ALTERTABLE_DROPPARTS
-ABSTRACT SYNTAX TREE:
-  
-TOK_ALTERTABLE
-   TOK_TABNAME
-      dmp
-      mp
-   TOK_ALTERTABLE_DROPPARTS
-      TOK_PARTSPEC
-         TOK_PARTVAL
-            b
-            =
-            '1'
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
diff --git a/ql/src/test/results/clientpositive/dynamic_partition_skip_default.q.out b/ql/src/test/results/clientpositive/dynamic_partition_skip_default.q.out
index e0168b3f95..fcd1b93714 100644
--- a/ql/src/test/results/clientpositive/dynamic_partition_skip_default.q.out
+++ b/ql/src/test/results/clientpositive/dynamic_partition_skip_default.q.out
@@ -46,33 +46,6 @@ PREHOOK: query: explain extended select intcol from dynamic_part_table where par
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select intcol from dynamic_part_table where partcol1='1' and partcol2='1'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            dynamic_part_table
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               intcol
-      TOK_WHERE
-         and
-            =
-               TOK_TABLE_OR_COL
-                  partcol1
-               '1'
-            =
-               TOK_TABLE_OR_COL
-                  partcol2
-               '1'
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
@@ -140,33 +113,6 @@ PREHOOK: query: explain extended select intcol from dynamic_part_table where par
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select intcol from dynamic_part_table where partcol1='1' and partcol2='1'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            dynamic_part_table
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               intcol
-      TOK_WHERE
-         and
-            =
-               TOK_TABLE_OR_COL
-                  partcol1
-               '1'
-            =
-               TOK_TABLE_OR_COL
-                  partcol2
-               '1'
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
@@ -234,43 +180,6 @@ PREHOOK: query: explain extended select intcol from dynamic_part_table where (pa
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select intcol from dynamic_part_table where (partcol1='1' and partcol2='1')or (partcol1='1' and partcol2='__HIVE_DEFAULT_PARTITION__')
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            dynamic_part_table
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               intcol
-      TOK_WHERE
-         or
-            and
-               =
-                  TOK_TABLE_OR_COL
-                     partcol1
-                  '1'
-               =
-                  TOK_TABLE_OR_COL
-                     partcol2
-                  '1'
-            and
-               =
-                  TOK_TABLE_OR_COL
-                     partcol1
-                  '1'
-               =
-                  TOK_TABLE_OR_COL
-                     partcol2
-                  '__HIVE_DEFAULT_PARTITION__'
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
diff --git a/ql/src/test/results/clientpositive/encrypted/encryption_join_unencrypted_tbl.q.out b/ql/src/test/results/clientpositive/encrypted/encryption_join_unencrypted_tbl.q.out
index ecf9861515..02ffbfbbbd 100644
--- a/ql/src/test/results/clientpositive/encrypted/encryption_join_unencrypted_tbl.q.out
+++ b/ql/src/test/results/clientpositive/encrypted/encryption_join_unencrypted_tbl.q.out
@@ -540,38 +540,6 @@ PREHOOK: query: EXPLAIN EXTENDED SELECT * FROM src t1 JOIN encrypted_table t2 WH
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN EXTENDED SELECT * FROM src t1 JOIN encrypted_table t2 WHERE t1.key = t2.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               src
-            t1
-         TOK_TABREF
-            TOK_TABNAME
-               encrypted_table
-            t2
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         =
-            .
-               TOK_TABLE_OR_COL
-                  t1
-               key
-            .
-               TOK_TABLE_OR_COL
-                  t2
-               key
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/encrypted/encryption_join_with_different_encryption_keys.q.out b/ql/src/test/results/clientpositive/encrypted/encryption_join_with_different_encryption_keys.q.out
index d46aaea7e8..7a91538001 100644
--- a/ql/src/test/results/clientpositive/encrypted/encryption_join_with_different_encryption_keys.q.out
+++ b/ql/src/test/results/clientpositive/encrypted/encryption_join_with_different_encryption_keys.q.out
@@ -60,38 +60,6 @@ PREHOOK: query: EXPLAIN EXTENDED SELECT * FROM table_key_1 t1 JOIN table_key_2 t
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN EXTENDED SELECT * FROM table_key_1 t1 JOIN table_key_2 t2 WHERE (t1.key = t2.key)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               table_key_1
-            t1
-         TOK_TABREF
-            TOK_TABNAME
-               table_key_2
-            t2
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         =
-            .
-               TOK_TABLE_OR_COL
-                  t1
-               key
-            .
-               TOK_TABLE_OR_COL
-                  t2
-               key
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/explain_logical.q.out b/ql/src/test/results/clientpositive/explain_logical.q.out
index dc784808b3..5b8a422a19 100644
--- a/ql/src/test/results/clientpositive/explain_logical.q.out
+++ b/ql/src/test/results/clientpositive/explain_logical.q.out
@@ -70,35 +70,6 @@ POSTHOOK: query: -- Simple select queries, union queries and join queries
 EXPLAIN LOGICAL 
   SELECT key, count(1) FROM srcpart WHERE ds IS NOT NULL GROUP BY key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_WHERE
-         TOK_FUNCTION
-            TOK_ISNOTNULL
-            TOK_TABLE_OR_COL
-               ds
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            key
-
-
 LOGICAL PLAN:
 $hdt$_0:srcpart 
   TableScan (TS_0)
@@ -140,45 +111,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN LOGICAL 
   SELECT key, count(1) FROM (SELECT key, value FROM src) subq1 GROUP BY key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_QUERY
-            TOK_FROM
-               TOK_TABREF
-                  TOK_TABNAME
-                     src
-            TOK_INSERT
-               TOK_DESTINATION
-                  TOK_DIR
-                     TOK_TMP_FILE
-               TOK_SELECT
-                  TOK_SELEXPR
-                     TOK_TABLE_OR_COL
-                        key
-                  TOK_SELEXPR
-                     TOK_TABLE_OR_COL
-                        value
-         subq1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            key
-
-
 LOGICAL PLAN:
 $hdt$_0:src 
   TableScan (TS_0)
@@ -224,59 +156,6 @@ POSTHOOK: query: EXPLAIN LOGICAL
     SELECT key, value FROM src UNION ALL SELECT key, value FROM srcpart WHERE ds IS NOT NULL
   ) S1
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_UNIONALL
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        src
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           key
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           value
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        srcpart
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           key
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           value
-                  TOK_WHERE
-                     TOK_FUNCTION
-                        TOK_ISNOTNULL
-                        TOK_TABLE_OR_COL
-                           ds
-         S1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 LOGICAL PLAN:
 null-subquery1:$hdt$_0-subquery1:src 
   TableScan (TS_0)
@@ -312,50 +191,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN LOGICAL 
   SELECT S1.key, S2.value FROM src S1 JOIN srcpart S2 ON S1.key = S2.key WHERE ds IS NOT NULL
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               src
-            S1
-         TOK_TABREF
-            TOK_TABNAME
-               srcpart
-            S2
-         =
-            .
-               TOK_TABLE_OR_COL
-                  S1
-               key
-            .
-               TOK_TABLE_OR_COL
-                  S2
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  S1
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  S2
-               value
-      TOK_WHERE
-         TOK_FUNCTION
-            TOK_ISNOTNULL
-            TOK_TABLE_OR_COL
-               ds
-
-
 LOGICAL PLAN:
 $hdt$_0:s1 
   TableScan (TS_0)
@@ -424,22 +259,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: -- With views
 EXPLAIN LOGICAL SELECT * FROM V1
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            V1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 LOGICAL PLAN:
 src 
   TableScan (TS_0)
@@ -455,22 +274,6 @@ PREHOOK: query: EXPLAIN LOGICAL SELECT * FROM V2
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN LOGICAL SELECT * FROM V2
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            V2
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 LOGICAL PLAN:
 srcpart 
   TableScan (TS_0)
@@ -486,22 +289,6 @@ PREHOOK: query: EXPLAIN LOGICAL SELECT * FROM V3
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN LOGICAL SELECT * FROM V3
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            V3
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 LOGICAL PLAN:
 $hdt$_0:srcpart 
   TableScan (TS_0)
@@ -568,22 +355,6 @@ PREHOOK: query: EXPLAIN LOGICAL SELECT * FROM V4
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN LOGICAL SELECT * FROM V4
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            V4
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 LOGICAL PLAN:
 $hdt$_0:srcpart 
   TableScan (TS_0)
@@ -695,22 +466,6 @@ PREHOOK: query: EXPLAIN LOGICAL SELECT * FROM V5
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN LOGICAL SELECT * FROM V5
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            V5
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 LOGICAL PLAN:
 srcpart 
   TableScan (TS_0)
@@ -729,77 +484,6 @@ PREHOOK: query: EXPLAIN LOGICAL SELECT s1.key, s1.cnt, s2.value FROM (SELECT key
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN LOGICAL SELECT s1.key, s1.cnt, s2.value FROM (SELECT key, count(value) as cnt FROM src GROUP BY key) s1 JOIN src s2 ON (s1.key = s2.key) ORDER BY s1.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_SUBQUERY
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        src
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           key
-                     TOK_SELEXPR
-                        TOK_FUNCTION
-                           count
-                           TOK_TABLE_OR_COL
-                              value
-                        cnt
-                  TOK_GROUPBY
-                     TOK_TABLE_OR_COL
-                        key
-            s1
-         TOK_TABREF
-            TOK_TABNAME
-               src
-            s2
-         =
-            .
-               TOK_TABLE_OR_COL
-                  s1
-               key
-            .
-               TOK_TABLE_OR_COL
-                  s2
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  s1
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  s1
-               cnt
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  s2
-               value
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               .
-                  TOK_TABLE_OR_COL
-                     s1
-                  key
-
-
 LOGICAL PLAN:
 $hdt$_0:src 
   TableScan (TS_0)
diff --git a/ql/src/test/results/clientpositive/extrapolate_part_stats_full.q.out b/ql/src/test/results/clientpositive/extrapolate_part_stats_full.q.out
index a30c356442..fa2c77e0e8 100644
--- a/ql/src/test/results/clientpositive/extrapolate_part_stats_full.q.out
+++ b/ql/src/test/results/clientpositive/extrapolate_part_stats_full.q.out
@@ -90,23 +90,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: -- basicStatState: COMPLETE colStatState: PARTIAL
 explain extended select state from loc_orc_1d
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            loc_orc_1d
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               state
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
@@ -220,26 +203,6 @@ POSTHOOK: query: -- column statistics for __HIVE_DEFAULT_PARTITION__ is not supp
 -- basicStatState: COMPLETE colStatState: PARTIAL
 explain extended select state,locid from loc_orc_1d
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            loc_orc_1d
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               state
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               locid
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
@@ -422,23 +385,6 @@ PREHOOK: query: explain extended select state from loc_orc_2d
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select state from loc_orc_2d
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            loc_orc_2d
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               state
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
@@ -638,26 +584,6 @@ PREHOOK: query: explain extended select state,locid from loc_orc_2d
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select state,locid from loc_orc_2d
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            loc_orc_2d
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               state
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               locid
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
diff --git a/ql/src/test/results/clientpositive/extrapolate_part_stats_partial.q.out b/ql/src/test/results/clientpositive/extrapolate_part_stats_partial.q.out
index 4e589b8aca..68652e9706 100644
--- a/ql/src/test/results/clientpositive/extrapolate_part_stats_partial.q.out
+++ b/ql/src/test/results/clientpositive/extrapolate_part_stats_partial.q.out
@@ -107,23 +107,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: -- basicStatState: COMPLETE colStatState: PARTIAL
 explain extended select state from loc_orc_1d
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            loc_orc_1d
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               state
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
@@ -323,26 +306,6 @@ POSTHOOK: query: -- column statistics for __HIVE_DEFAULT_PARTITION__ is not supp
 -- basicStatState: COMPLETE colStatState: PARTIAL
 explain extended select state,locid from loc_orc_1d
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            loc_orc_1d
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               state
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               locid
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
@@ -558,23 +521,6 @@ PREHOOK: query: explain extended select state from loc_orc_1d
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select state from loc_orc_1d
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            loc_orc_1d
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               state
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
@@ -770,26 +716,6 @@ PREHOOK: query: explain extended select state,locid from loc_orc_1d
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select state,locid from loc_orc_1d
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            loc_orc_1d
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               state
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               locid
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
@@ -1059,23 +985,6 @@ PREHOOK: query: explain extended select state from loc_orc_2d
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select state from loc_orc_2d
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            loc_orc_2d
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               state
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
@@ -1583,26 +1492,6 @@ PREHOOK: query: explain extended select state,locid from loc_orc_2d
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select state,locid from loc_orc_2d
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            loc_orc_2d
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               state
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               locid
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
diff --git a/ql/src/test/results/clientpositive/extrapolate_part_stats_partial_ndv.q.out b/ql/src/test/results/clientpositive/extrapolate_part_stats_partial_ndv.q.out
index 3185f70621..e82136f140 100644
--- a/ql/src/test/results/clientpositive/extrapolate_part_stats_partial_ndv.q.out
+++ b/ql/src/test/results/clientpositive/extrapolate_part_stats_partial_ndv.q.out
@@ -175,32 +175,6 @@ PREHOOK: query: explain extended select state,locid,cnt,zip from loc_orc_1d
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select state,locid,cnt,zip from loc_orc_1d
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            loc_orc_1d
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               state
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               locid
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               cnt
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               zip
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
@@ -488,32 +462,6 @@ PREHOOK: query: explain extended select state,locid,cnt,zip from loc_orc_1d
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select state,locid,cnt,zip from loc_orc_1d
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            loc_orc_1d
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               state
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               locid
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               cnt
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               zip
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
@@ -854,32 +802,6 @@ PREHOOK: query: explain extended select state,locid,cnt,zip from loc_orc_2d
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select state,locid,cnt,zip from loc_orc_2d
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            loc_orc_2d
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               state
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               locid
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               cnt
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               zip
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
diff --git a/ql/src/test/results/clientpositive/filter_join_breaktask.q.out b/ql/src/test/results/clientpositive/filter_join_breaktask.q.out
index 018fd5d55a..6c21260463 100644
--- a/ql/src/test/results/clientpositive/filter_join_breaktask.q.out
+++ b/ql/src/test/results/clientpositive/filter_join_breaktask.q.out
@@ -32,108 +32,6 @@ SELECT f.key, g.value
 FROM filter_join_breaktask f JOIN filter_join_breaktask m ON( f.key = m.key AND f.ds='2008-04-08' AND m.ds='2008-04-08' AND f.key is not null) 
 JOIN filter_join_breaktask g ON(g.value = m.value AND g.ds='2008-04-08' AND m.ds='2008-04-08' AND m.value is not null AND m.value !='')
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_JOIN
-            TOK_TABREF
-               TOK_TABNAME
-                  filter_join_breaktask
-               f
-            TOK_TABREF
-               TOK_TABNAME
-                  filter_join_breaktask
-               m
-            AND
-               AND
-                  AND
-                     =
-                        .
-                           TOK_TABLE_OR_COL
-                              f
-                           key
-                        .
-                           TOK_TABLE_OR_COL
-                              m
-                           key
-                     =
-                        .
-                           TOK_TABLE_OR_COL
-                              f
-                           ds
-                        '2008-04-08'
-                  =
-                     .
-                        TOK_TABLE_OR_COL
-                           m
-                        ds
-                     '2008-04-08'
-               TOK_FUNCTION
-                  TOK_ISNOTNULL
-                  .
-                     TOK_TABLE_OR_COL
-                        f
-                     key
-         TOK_TABREF
-            TOK_TABNAME
-               filter_join_breaktask
-            g
-         AND
-            AND
-               AND
-                  AND
-                     =
-                        .
-                           TOK_TABLE_OR_COL
-                              g
-                           value
-                        .
-                           TOK_TABLE_OR_COL
-                              m
-                           value
-                     =
-                        .
-                           TOK_TABLE_OR_COL
-                              g
-                           ds
-                        '2008-04-08'
-                  =
-                     .
-                        TOK_TABLE_OR_COL
-                           m
-                        ds
-                     '2008-04-08'
-               TOK_FUNCTION
-                  TOK_ISNOTNULL
-                  .
-                     TOK_TABLE_OR_COL
-                        m
-                     value
-            !=
-               .
-                  TOK_TABLE_OR_COL
-                     m
-                  value
-               ''
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  f
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  g
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/fouter_join_ppr.q.out b/ql/src/test/results/clientpositive/fouter_join_ppr.q.out
index e5ae82837c..45dbc363be 100644
--- a/ql/src/test/results/clientpositive/fouter_join_ppr.q.out
+++ b/ql/src/test/results/clientpositive/fouter_join_ppr.q.out
@@ -20,90 +20,6 @@ EXPLAIN EXTENDED
  SELECT a.key, a.value, b.key, b.value
  WHERE a.key > 10 AND a.key < 20 AND b.key > 15 AND b.key < 25
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_FULLOUTERJOIN
-         TOK_TABREF
-            TOK_TABNAME
-               src
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcpart
-            b
-         AND
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  ds
-               '2008-04-08'
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-      TOK_WHERE
-         AND
-            AND
-               AND
-                  >
-                     .
-                        TOK_TABLE_OR_COL
-                           a
-                        key
-                     10
-                  <
-                     .
-                        TOK_TABLE_OR_COL
-                           a
-                        key
-                     20
-               >
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-                  15
-            <
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-               25
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -491,90 +407,6 @@ POSTHOOK: query: EXPLAIN EXTENDED
  SELECT a.key, a.value, b.key, b.value
  WHERE a.key > 10 AND a.key < 20 AND b.key > 15 AND b.key < 25
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_FULLOUTERJOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcpart
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               src
-            b
-         AND
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  ds
-               '2008-04-08'
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-      TOK_WHERE
-         AND
-            AND
-               AND
-                  >
-                     .
-                        TOK_TABLE_OR_COL
-                           a
-                        key
-                     10
-                  <
-                     .
-                        TOK_TABLE_OR_COL
-                           a
-                        key
-                     20
-               >
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-                  15
-            <
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-               25
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -966,90 +798,6 @@ POSTHOOK: query: EXPLAIN EXTENDED
  SELECT a.key, a.value, b.key, b.value
  WHERE a.key > 10 AND a.key < 20 AND b.key > 15 AND b.key < 25 AND b.ds = '2008-04-08'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_FULLOUTERJOIN
-         TOK_TABREF
-            TOK_TABNAME
-               src
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcpart
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-      TOK_WHERE
-         AND
-            AND
-               AND
-                  AND
-                     >
-                        .
-                           TOK_TABLE_OR_COL
-                              a
-                           key
-                        10
-                     <
-                        .
-                           TOK_TABLE_OR_COL
-                              a
-                           key
-                        20
-                  >
-                     .
-                        TOK_TABLE_OR_COL
-                           b
-                        key
-                     15
-               <
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-                  25
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  ds
-               '2008-04-08'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1342,90 +1090,6 @@ POSTHOOK: query: EXPLAIN EXTENDED
  SELECT a.key, a.value, b.key, b.value
  WHERE a.key > 10 AND a.key < 20 AND b.key > 15 AND b.key < 25 AND a.ds = '2008-04-08'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_FULLOUTERJOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcpart
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               src
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-      TOK_WHERE
-         AND
-            AND
-               AND
-                  AND
-                     >
-                        .
-                           TOK_TABLE_OR_COL
-                              a
-                           key
-                        10
-                     <
-                        .
-                           TOK_TABLE_OR_COL
-                              a
-                           key
-                        20
-                  >
-                     .
-                        TOK_TABLE_OR_COL
-                           b
-                        key
-                     15
-               <
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-                  25
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  ds
-               '2008-04-08'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/groupby_map_ppr.q.out b/ql/src/test/results/clientpositive/groupby_map_ppr.q.out
index 556995c606..3d07b0d4bc 100644
--- a/ql/src/test/results/clientpositive/groupby_map_ppr.q.out
+++ b/ql/src/test/results/clientpositive/groupby_map_ppr.q.out
@@ -24,77 +24,6 @@ SELECT substr(src.key,1,1), count(DISTINCT substr(src.value,5)), concat(substr(s
 WHERE src.ds = '2008-04-08'
 GROUP BY substr(src.key,1,1)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-         src
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dest1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTION
-               substr
-               .
-                  TOK_TABLE_OR_COL
-                     src
-                  key
-               1
-               1
-         TOK_SELEXPR
-            TOK_FUNCTIONDI
-               count
-               TOK_FUNCTION
-                  substr
-                  .
-                     TOK_TABLE_OR_COL
-                        src
-                     value
-                  5
-         TOK_SELEXPR
-            TOK_FUNCTION
-               concat
-               TOK_FUNCTION
-                  substr
-                  .
-                     TOK_TABLE_OR_COL
-                        src
-                     key
-                  1
-                  1
-               TOK_FUNCTION
-                  sum
-                  TOK_FUNCTION
-                     substr
-                     .
-                        TOK_TABLE_OR_COL
-                           src
-                        value
-                     5
-      TOK_WHERE
-         =
-            .
-               TOK_TABLE_OR_COL
-                  src
-               ds
-            '2008-04-08'
-      TOK_GROUPBY
-         TOK_FUNCTION
-            substr
-            .
-               TOK_TABLE_OR_COL
-                  src
-               key
-            1
-            1
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/groupby_map_ppr_multi_distinct.q.out b/ql/src/test/results/clientpositive/groupby_map_ppr_multi_distinct.q.out
index 393e6fa2e0..6689225698 100644
--- a/ql/src/test/results/clientpositive/groupby_map_ppr_multi_distinct.q.out
+++ b/ql/src/test/results/clientpositive/groupby_map_ppr_multi_distinct.q.out
@@ -24,94 +24,6 @@ SELECT substr(src.key,1,1), count(DISTINCT substr(src.value,5)), concat(substr(s
 WHERE src.ds = '2008-04-08'
 GROUP BY substr(src.key,1,1)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-         src
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dest1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTION
-               substr
-               .
-                  TOK_TABLE_OR_COL
-                     src
-                  key
-               1
-               1
-         TOK_SELEXPR
-            TOK_FUNCTIONDI
-               count
-               TOK_FUNCTION
-                  substr
-                  .
-                     TOK_TABLE_OR_COL
-                        src
-                     value
-                  5
-         TOK_SELEXPR
-            TOK_FUNCTION
-               concat
-               TOK_FUNCTION
-                  substr
-                  .
-                     TOK_TABLE_OR_COL
-                        src
-                     key
-                  1
-                  1
-               TOK_FUNCTION
-                  sum
-                  TOK_FUNCTION
-                     substr
-                     .
-                        TOK_TABLE_OR_COL
-                           src
-                        value
-                     5
-         TOK_SELEXPR
-            TOK_FUNCTIONDI
-               sum
-               TOK_FUNCTION
-                  substr
-                  .
-                     TOK_TABLE_OR_COL
-                        src
-                     value
-                  5
-         TOK_SELEXPR
-            TOK_FUNCTIONDI
-               count
-               .
-                  TOK_TABLE_OR_COL
-                     src
-                  value
-      TOK_WHERE
-         =
-            .
-               TOK_TABLE_OR_COL
-                  src
-               ds
-            '2008-04-08'
-      TOK_GROUPBY
-         TOK_FUNCTION
-            substr
-            .
-               TOK_TABLE_OR_COL
-                  src
-               key
-            1
-            1
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/groupby_ppr.q.out b/ql/src/test/results/clientpositive/groupby_ppr.q.out
index 2e160b3e1d..62fffbe023 100644
--- a/ql/src/test/results/clientpositive/groupby_ppr.q.out
+++ b/ql/src/test/results/clientpositive/groupby_ppr.q.out
@@ -24,77 +24,6 @@ SELECT substr(src.key,1,1), count(DISTINCT substr(src.value,5)), concat(substr(s
 WHERE src.ds = '2008-04-08'
 GROUP BY substr(src.key,1,1)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-         src
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dest1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTION
-               substr
-               .
-                  TOK_TABLE_OR_COL
-                     src
-                  key
-               1
-               1
-         TOK_SELEXPR
-            TOK_FUNCTIONDI
-               count
-               TOK_FUNCTION
-                  substr
-                  .
-                     TOK_TABLE_OR_COL
-                        src
-                     value
-                  5
-         TOK_SELEXPR
-            TOK_FUNCTION
-               concat
-               TOK_FUNCTION
-                  substr
-                  .
-                     TOK_TABLE_OR_COL
-                        src
-                     key
-                  1
-                  1
-               TOK_FUNCTION
-                  sum
-                  TOK_FUNCTION
-                     substr
-                     .
-                        TOK_TABLE_OR_COL
-                           src
-                        value
-                     5
-      TOK_WHERE
-         =
-            .
-               TOK_TABLE_OR_COL
-                  src
-               ds
-            '2008-04-08'
-      TOK_GROUPBY
-         TOK_FUNCTION
-            substr
-            .
-               TOK_TABLE_OR_COL
-                  src
-               key
-            1
-            1
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/groupby_ppr_multi_distinct.q.out b/ql/src/test/results/clientpositive/groupby_ppr_multi_distinct.q.out
index 93fbc0ec16..2408056f10 100644
--- a/ql/src/test/results/clientpositive/groupby_ppr_multi_distinct.q.out
+++ b/ql/src/test/results/clientpositive/groupby_ppr_multi_distinct.q.out
@@ -24,94 +24,6 @@ SELECT substr(src.key,1,1), count(DISTINCT substr(src.value,5)), concat(substr(s
 WHERE src.ds = '2008-04-08'
 GROUP BY substr(src.key,1,1)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-         src
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dest1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTION
-               substr
-               .
-                  TOK_TABLE_OR_COL
-                     src
-                  key
-               1
-               1
-         TOK_SELEXPR
-            TOK_FUNCTIONDI
-               count
-               TOK_FUNCTION
-                  substr
-                  .
-                     TOK_TABLE_OR_COL
-                        src
-                     value
-                  5
-         TOK_SELEXPR
-            TOK_FUNCTION
-               concat
-               TOK_FUNCTION
-                  substr
-                  .
-                     TOK_TABLE_OR_COL
-                        src
-                     key
-                  1
-                  1
-               TOK_FUNCTION
-                  sum
-                  TOK_FUNCTION
-                     substr
-                     .
-                        TOK_TABLE_OR_COL
-                           src
-                        value
-                     5
-         TOK_SELEXPR
-            TOK_FUNCTIONDI
-               sum
-               TOK_FUNCTION
-                  substr
-                  .
-                     TOK_TABLE_OR_COL
-                        src
-                     value
-                  5
-         TOK_SELEXPR
-            TOK_FUNCTIONDI
-               count
-               .
-                  TOK_TABLE_OR_COL
-                     src
-                  value
-      TOK_WHERE
-         =
-            .
-               TOK_TABLE_OR_COL
-                  src
-               ds
-            '2008-04-08'
-      TOK_GROUPBY
-         TOK_FUNCTION
-            substr
-            .
-               TOK_TABLE_OR_COL
-                  src
-               key
-            1
-            1
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/groupby_sort_1_23.q.out b/ql/src/test/results/clientpositive/groupby_sort_1_23.q.out
index efb13a74ef..a6e15ba2ed 100644
--- a/ql/src/test/results/clientpositive/groupby_sort_1_23.q.out
+++ b/ql/src/test/results/clientpositive/groupby_sort_1_23.q.out
@@ -54,31 +54,6 @@ EXPLAIN EXTENDED
 INSERT OVERWRITE TABLE outputTbl1
 SELECT key, count(1) FROM T1 GROUP BY key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            T1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            key
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-7 depends on stages: Stage-1 , consists of Stage-4, Stage-3, Stage-5
@@ -413,36 +388,6 @@ EXPLAIN EXTENDED
 INSERT OVERWRITE TABLE outputTbl2
 SELECT key, val, count(1) FROM T1 GROUP BY key, val
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            T1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl2
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               val
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            key
-         TOK_TABLE_OR_COL
-            val
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -630,46 +575,6 @@ EXPLAIN EXTENDED
 INSERT OVERWRITE TABLE outputTbl1
 SELECT key, count(1) FROM (SELECT key, val FROM T1) subq1 GROUP BY key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_QUERY
-            TOK_FROM
-               TOK_TABREF
-                  TOK_TABNAME
-                     T1
-            TOK_INSERT
-               TOK_DESTINATION
-                  TOK_DIR
-                     TOK_TMP_FILE
-               TOK_SELECT
-                  TOK_SELEXPR
-                     TOK_TABLE_OR_COL
-                        key
-                  TOK_SELEXPR
-                     TOK_TABLE_OR_COL
-                        val
-         subq1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            key
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-7 depends on stages: Stage-1 , consists of Stage-4, Stage-3, Stage-5
@@ -1036,48 +941,6 @@ EXPLAIN EXTENDED
 INSERT OVERWRITE TABLE outputTbl1
 SELECT k, count(1) FROM (SELECT key as k, val as v FROM T1) subq1 GROUP BY k
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_QUERY
-            TOK_FROM
-               TOK_TABREF
-                  TOK_TABNAME
-                     T1
-            TOK_INSERT
-               TOK_DESTINATION
-                  TOK_DIR
-                     TOK_TMP_FILE
-               TOK_SELECT
-                  TOK_SELEXPR
-                     TOK_TABLE_OR_COL
-                        key
-                     k
-                  TOK_SELEXPR
-                     TOK_TABLE_OR_COL
-                        val
-                     v
-         subq1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               k
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            k
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-7 depends on stages: Stage-1 , consists of Stage-4, Stage-3, Stage-5
@@ -1454,34 +1317,6 @@ EXPLAIN EXTENDED
 INSERT OVERWRITE TABLE outputTbl3
 SELECT 1, key, count(1) FROM T1 GROUP BY 1, key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            T1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl3
-      TOK_SELECT
-         TOK_SELEXPR
-            1
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_GROUPBY
-         1
-         TOK_TABLE_OR_COL
-            key
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-7 depends on stages: Stage-1 , consists of Stage-4, Stage-3, Stage-5
@@ -1817,39 +1652,6 @@ EXPLAIN EXTENDED
 INSERT OVERWRITE TABLE outputTbl4
 SELECT key, 1, val, count(1) FROM T1 GROUP BY key, 1, val
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            T1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl4
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            1
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               val
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            key
-         1
-         TOK_TABLE_OR_COL
-            val
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -2038,40 +1840,6 @@ EXPLAIN EXTENDED
 INSERT OVERWRITE TABLE outputTbl3
 SELECT key, key + 1, count(1) FROM T1 GROUP BY key, key + 1
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            T1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl3
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            +
-               TOK_TABLE_OR_COL
-                  key
-               1
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            key
-         +
-            TOK_TABLE_OR_COL
-               key
-            1
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -2278,58 +2046,6 @@ SELECT key + key, sum(cnt) from
 (SELECT key, count(1) as cnt FROM T1 GROUP BY key) subq1
 group by key + key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_QUERY
-            TOK_FROM
-               TOK_TABREF
-                  TOK_TABNAME
-                     T1
-            TOK_INSERT
-               TOK_DESTINATION
-                  TOK_DIR
-                     TOK_TMP_FILE
-               TOK_SELECT
-                  TOK_SELEXPR
-                     TOK_TABLE_OR_COL
-                        key
-                  TOK_SELEXPR
-                     TOK_FUNCTION
-                        count
-                        1
-                     cnt
-               TOK_GROUPBY
-                  TOK_TABLE_OR_COL
-                     key
-         subq1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl1
-      TOK_SELECT
-         TOK_SELEXPR
-            +
-               TOK_TABLE_OR_COL
-                  key
-               TOK_TABLE_OR_COL
-                  key
-         TOK_SELEXPR
-            TOK_FUNCTION
-               sum
-               TOK_TABLE_OR_COL
-                  cnt
-      TOK_GROUPBY
-         +
-            TOK_TABLE_OR_COL
-               key
-            TOK_TABLE_OR_COL
-               key
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -2547,63 +2263,6 @@ SELECT key, count(1) FROM T1 GROUP BY key
 SELECT key, count(1) FROM T1 GROUP BY key
 ) subq1
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_UNIONALL
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        T1
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           key
-                     TOK_SELEXPR
-                        TOK_FUNCTION
-                           count
-                           1
-                  TOK_GROUPBY
-                     TOK_TABLE_OR_COL
-                        key
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        T1
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           key
-                     TOK_SELEXPR
-                        TOK_FUNCTION
-                           count
-                           1
-                  TOK_GROUPBY
-                     TOK_TABLE_OR_COL
-                        key
-         subq1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-7 depends on stages: Stage-1 , consists of Stage-4, Stage-3, Stage-5
@@ -3044,70 +2703,6 @@ SELECT key, count(1) FROM T1 GROUP BY key
 SELECT key + key as key, count(1) FROM T1 GROUP BY key + key
 ) subq1
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_UNIONALL
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        T1
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           key
-                     TOK_SELEXPR
-                        TOK_FUNCTION
-                           count
-                           1
-                  TOK_GROUPBY
-                     TOK_TABLE_OR_COL
-                        key
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        T1
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        +
-                           TOK_TABLE_OR_COL
-                              key
-                           TOK_TABLE_OR_COL
-                              key
-                        key
-                     TOK_SELEXPR
-                        TOK_FUNCTION
-                           count
-                           1
-                  TOK_GROUPBY
-                     +
-                        TOK_TABLE_OR_COL
-                           key
-                        TOK_TABLE_OR_COL
-                           key
-         subq1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-9 is a root stage
   Stage-2 depends on stages: Stage-9
@@ -3667,89 +3262,6 @@ JOIN
 (SELECT key, count(1) as cnt FROM T1 GROUP BY key) subq2
 ON subq1.key = subq2.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_SUBQUERY
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        T1
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           key
-                     TOK_SELEXPR
-                        TOK_FUNCTION
-                           count
-                           1
-                        cnt
-                  TOK_GROUPBY
-                     TOK_TABLE_OR_COL
-                        key
-            subq1
-         TOK_SUBQUERY
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        T1
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           key
-                     TOK_SELEXPR
-                        TOK_FUNCTION
-                           count
-                           1
-                        cnt
-                  TOK_GROUPBY
-                     TOK_TABLE_OR_COL
-                        key
-            subq2
-         =
-            .
-               TOK_TABLE_OR_COL
-                  subq1
-               key
-            .
-               TOK_TABLE_OR_COL
-                  subq2
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl1
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  subq1
-               key
-         TOK_SELEXPR
-            +
-               .
-                  TOK_TABLE_OR_COL
-                     subq1
-                  cnt
-               .
-                  TOK_TABLE_OR_COL
-                     subq2
-                  cnt
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -3992,78 +3504,6 @@ JOIN
 (SELECT key, val, count(1) FROM T1 GROUP BY key, val) subq2
 ON subq1.key = subq2.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_SUBQUERY
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        T1
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           key
-                     TOK_SELEXPR
-                        TOK_FUNCTION
-                           count
-                           1
-                  TOK_GROUPBY
-                     TOK_TABLE_OR_COL
-                        key
-            subq1
-         TOK_SUBQUERY
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        T1
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           key
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           val
-                     TOK_SELEXPR
-                        TOK_FUNCTION
-                           count
-                           1
-                  TOK_GROUPBY
-                     TOK_TABLE_OR_COL
-                        key
-                     TOK_TABLE_OR_COL
-                        val
-            subq2
-         =
-            .
-               TOK_TABLE_OR_COL
-                  subq1
-               key
-            .
-               TOK_TABLE_OR_COL
-                  subq2
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-1 depends on stages: Stage-2
@@ -4365,31 +3805,6 @@ EXPLAIN EXTENDED
 INSERT OVERWRITE TABLE outputTbl1
 SELECT key, count(1) FROM T2 GROUP BY key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            T2
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            key
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -4588,39 +4003,6 @@ EXPLAIN EXTENDED
 INSERT OVERWRITE TABLE outputTbl4
 SELECT key, 1, val, count(1) FROM T2 GROUP BY key, 1, val
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            T2
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl4
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            1
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               val
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            key
-         1
-         TOK_TABLE_OR_COL
-            val
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-7 depends on stages: Stage-1 , consists of Stage-4, Stage-3, Stage-5
@@ -5000,42 +4382,6 @@ EXPLAIN EXTENDED
 INSERT OVERWRITE TABLE outputTbl5
 SELECT key, 1, val, 2, count(1) FROM T2 GROUP BY key, 1, val, 2
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            T2
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl5
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            1
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               val
-         TOK_SELEXPR
-            2
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            key
-         1
-         TOK_TABLE_OR_COL
-            val
-         2
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-7 depends on stages: Stage-1 , consists of Stage-4, Stage-3, Stage-5
@@ -5372,59 +4718,6 @@ SELECT key, constant, val, count(1) from
 (SELECT key, 1 as constant, val from T2)subq
 group by key, constant, val
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_QUERY
-            TOK_FROM
-               TOK_TABREF
-                  TOK_TABNAME
-                     T2
-            TOK_INSERT
-               TOK_DESTINATION
-                  TOK_DIR
-                     TOK_TMP_FILE
-               TOK_SELECT
-                  TOK_SELEXPR
-                     TOK_TABLE_OR_COL
-                        key
-                  TOK_SELEXPR
-                     1
-                     constant
-                  TOK_SELEXPR
-                     TOK_TABLE_OR_COL
-                        val
-         subq
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl4
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               constant
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               val
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            key
-         TOK_TABLE_OR_COL
-            constant
-         TOK_TABLE_OR_COL
-            val
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-7 depends on stages: Stage-1 , consists of Stage-4, Stage-3, Stage-5
@@ -5808,81 +5101,6 @@ SELECT key, constant as constant2, val, 2 as constant3 from
 )subq2
 group by key, constant3, val
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_QUERY
-            TOK_FROM
-               TOK_SUBQUERY
-                  TOK_QUERY
-                     TOK_FROM
-                        TOK_TABREF
-                           TOK_TABNAME
-                              T2
-                     TOK_INSERT
-                        TOK_DESTINATION
-                           TOK_DIR
-                              TOK_TMP_FILE
-                        TOK_SELECT
-                           TOK_SELEXPR
-                              TOK_TABLE_OR_COL
-                                 key
-                           TOK_SELEXPR
-                              1
-                              constant
-                           TOK_SELEXPR
-                              TOK_TABLE_OR_COL
-                                 val
-                  subq
-            TOK_INSERT
-               TOK_DESTINATION
-                  TOK_DIR
-                     TOK_TMP_FILE
-               TOK_SELECT
-                  TOK_SELEXPR
-                     TOK_TABLE_OR_COL
-                        key
-                  TOK_SELEXPR
-                     TOK_TABLE_OR_COL
-                        constant
-                     constant2
-                  TOK_SELEXPR
-                     TOK_TABLE_OR_COL
-                        val
-                  TOK_SELEXPR
-                     2
-                     constant3
-         subq2
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl4
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               constant3
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               val
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            key
-         TOK_TABLE_OR_COL
-            constant3
-         TOK_TABLE_OR_COL
-            val
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-7 depends on stages: Stage-1 , consists of Stage-4, Stage-3, Stage-5
diff --git a/ql/src/test/results/clientpositive/groupby_sort_6.q.out b/ql/src/test/results/clientpositive/groupby_sort_6.q.out
index 844a2a45e6..f5230852fa 100644
--- a/ql/src/test/results/clientpositive/groupby_sort_6.q.out
+++ b/ql/src/test/results/clientpositive/groupby_sort_6.q.out
@@ -28,36 +28,6 @@ EXPLAIN EXTENDED
 INSERT OVERWRITE TABLE outputTbl1
 SELECT key, count(1) FROM T1 where ds = '1' GROUP BY key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            T1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_WHERE
-         =
-            TOK_TABLE_OR_COL
-               ds
-            '1'
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            key
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -198,36 +168,6 @@ EXPLAIN EXTENDED
 INSERT OVERWRITE TABLE outputTbl1
 SELECT key, count(1) FROM T1 where ds = '1' GROUP BY key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            T1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_WHERE
-         =
-            TOK_TABLE_OR_COL
-               ds
-            '1'
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            key
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -371,36 +311,6 @@ EXPLAIN EXTENDED
 INSERT OVERWRITE TABLE outputTbl1
 SELECT key, count(1) FROM T1 where ds = '2' GROUP BY key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            T1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_WHERE
-         =
-            TOK_TABLE_OR_COL
-               ds
-            '2'
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            key
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/groupby_sort_skew_1_23.q.out b/ql/src/test/results/clientpositive/groupby_sort_skew_1_23.q.out
index 860a880891..38b24a462a 100644
--- a/ql/src/test/results/clientpositive/groupby_sort_skew_1_23.q.out
+++ b/ql/src/test/results/clientpositive/groupby_sort_skew_1_23.q.out
@@ -54,31 +54,6 @@ EXPLAIN EXTENDED
 INSERT OVERWRITE TABLE outputTbl1
 SELECT key, count(1) FROM T1 GROUP BY key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            T1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            key
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-7 depends on stages: Stage-1 , consists of Stage-4, Stage-3, Stage-5
@@ -413,36 +388,6 @@ EXPLAIN EXTENDED
 INSERT OVERWRITE TABLE outputTbl2
 SELECT key, val, count(1) FROM T1 GROUP BY key, val
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            T1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl2
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               val
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            key
-         TOK_TABLE_OR_COL
-            val
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -696,46 +641,6 @@ EXPLAIN EXTENDED
 INSERT OVERWRITE TABLE outputTbl1
 SELECT key, count(1) FROM (SELECT key, val FROM T1) subq1 GROUP BY key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_QUERY
-            TOK_FROM
-               TOK_TABREF
-                  TOK_TABNAME
-                     T1
-            TOK_INSERT
-               TOK_DESTINATION
-                  TOK_DIR
-                     TOK_TMP_FILE
-               TOK_SELECT
-                  TOK_SELEXPR
-                     TOK_TABLE_OR_COL
-                        key
-                  TOK_SELEXPR
-                     TOK_TABLE_OR_COL
-                        val
-         subq1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            key
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-7 depends on stages: Stage-1 , consists of Stage-4, Stage-3, Stage-5
@@ -1102,48 +1007,6 @@ EXPLAIN EXTENDED
 INSERT OVERWRITE TABLE outputTbl1
 SELECT k, count(1) FROM (SELECT key as k, val as v FROM T1) subq1 GROUP BY k
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_QUERY
-            TOK_FROM
-               TOK_TABREF
-                  TOK_TABNAME
-                     T1
-            TOK_INSERT
-               TOK_DESTINATION
-                  TOK_DIR
-                     TOK_TMP_FILE
-               TOK_SELECT
-                  TOK_SELEXPR
-                     TOK_TABLE_OR_COL
-                        key
-                     k
-                  TOK_SELEXPR
-                     TOK_TABLE_OR_COL
-                        val
-                     v
-         subq1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               k
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            k
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-7 depends on stages: Stage-1 , consists of Stage-4, Stage-3, Stage-5
@@ -1520,34 +1383,6 @@ EXPLAIN EXTENDED
 INSERT OVERWRITE TABLE outputTbl3
 SELECT 1, key, count(1) FROM T1 GROUP BY 1, key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            T1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl3
-      TOK_SELECT
-         TOK_SELEXPR
-            1
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_GROUPBY
-         1
-         TOK_TABLE_OR_COL
-            key
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-7 depends on stages: Stage-1 , consists of Stage-4, Stage-3, Stage-5
@@ -1883,39 +1718,6 @@ EXPLAIN EXTENDED
 INSERT OVERWRITE TABLE outputTbl4
 SELECT key, 1, val, count(1) FROM T1 GROUP BY key, 1, val
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            T1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl4
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            1
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               val
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            key
-         1
-         TOK_TABLE_OR_COL
-            val
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -2170,40 +1972,6 @@ EXPLAIN EXTENDED
 INSERT OVERWRITE TABLE outputTbl3
 SELECT key, key + 1, count(1) FROM T1 GROUP BY key, key + 1
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            T1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl3
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            +
-               TOK_TABLE_OR_COL
-                  key
-               1
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            key
-         +
-            TOK_TABLE_OR_COL
-               key
-            1
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -2476,58 +2244,6 @@ SELECT key + key, sum(cnt) from
 (SELECT key, count(1) as cnt FROM T1 GROUP BY key) subq1
 group by key + key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_QUERY
-            TOK_FROM
-               TOK_TABREF
-                  TOK_TABNAME
-                     T1
-            TOK_INSERT
-               TOK_DESTINATION
-                  TOK_DIR
-                     TOK_TMP_FILE
-               TOK_SELECT
-                  TOK_SELEXPR
-                     TOK_TABLE_OR_COL
-                        key
-                  TOK_SELEXPR
-                     TOK_FUNCTION
-                        count
-                        1
-                     cnt
-               TOK_GROUPBY
-                  TOK_TABLE_OR_COL
-                     key
-         subq1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl1
-      TOK_SELECT
-         TOK_SELEXPR
-            +
-               TOK_TABLE_OR_COL
-                  key
-               TOK_TABLE_OR_COL
-                  key
-         TOK_SELEXPR
-            TOK_FUNCTION
-               sum
-               TOK_TABLE_OR_COL
-                  cnt
-      TOK_GROUPBY
-         +
-            TOK_TABLE_OR_COL
-               key
-            TOK_TABLE_OR_COL
-               key
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -2811,63 +2527,6 @@ SELECT key, count(1) FROM T1 GROUP BY key
 SELECT key, count(1) FROM T1 GROUP BY key
 ) subq1
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_UNIONALL
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        T1
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           key
-                     TOK_SELEXPR
-                        TOK_FUNCTION
-                           count
-                           1
-                  TOK_GROUPBY
-                     TOK_TABLE_OR_COL
-                        key
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        T1
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           key
-                     TOK_SELEXPR
-                        TOK_FUNCTION
-                           count
-                           1
-                  TOK_GROUPBY
-                     TOK_TABLE_OR_COL
-                        key
-         subq1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-7 depends on stages: Stage-1 , consists of Stage-4, Stage-3, Stage-5
@@ -3308,70 +2967,6 @@ SELECT key, count(1) FROM T1 GROUP BY key
 SELECT key + key as key, count(1) FROM T1 GROUP BY key + key
 ) subq1
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_UNIONALL
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        T1
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           key
-                     TOK_SELEXPR
-                        TOK_FUNCTION
-                           count
-                           1
-                  TOK_GROUPBY
-                     TOK_TABLE_OR_COL
-                        key
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        T1
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        +
-                           TOK_TABLE_OR_COL
-                              key
-                           TOK_TABLE_OR_COL
-                              key
-                        key
-                     TOK_SELEXPR
-                        TOK_FUNCTION
-                           count
-                           1
-                  TOK_GROUPBY
-                     +
-                        TOK_TABLE_OR_COL
-                           key
-                        TOK_TABLE_OR_COL
-                           key
-         subq1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-9 is a root stage
   Stage-10 depends on stages: Stage-9
@@ -3997,89 +3592,6 @@ JOIN
 (SELECT key, count(1) as cnt FROM T1 GROUP BY key) subq2
 ON subq1.key = subq2.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_SUBQUERY
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        T1
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           key
-                     TOK_SELEXPR
-                        TOK_FUNCTION
-                           count
-                           1
-                        cnt
-                  TOK_GROUPBY
-                     TOK_TABLE_OR_COL
-                        key
-            subq1
-         TOK_SUBQUERY
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        T1
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           key
-                     TOK_SELEXPR
-                        TOK_FUNCTION
-                           count
-                           1
-                        cnt
-                  TOK_GROUPBY
-                     TOK_TABLE_OR_COL
-                        key
-            subq2
-         =
-            .
-               TOK_TABLE_OR_COL
-                  subq1
-               key
-            .
-               TOK_TABLE_OR_COL
-                  subq2
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl1
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  subq1
-               key
-         TOK_SELEXPR
-            +
-               .
-                  TOK_TABLE_OR_COL
-                     subq1
-                  cnt
-               .
-                  TOK_TABLE_OR_COL
-                     subq2
-                  cnt
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -4322,78 +3834,6 @@ JOIN
 (SELECT key, val, count(1) FROM T1 GROUP BY key, val) subq2
 ON subq1.key = subq2.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_SUBQUERY
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        T1
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           key
-                     TOK_SELEXPR
-                        TOK_FUNCTION
-                           count
-                           1
-                  TOK_GROUPBY
-                     TOK_TABLE_OR_COL
-                        key
-            subq1
-         TOK_SUBQUERY
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        T1
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           key
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           val
-                     TOK_SELEXPR
-                        TOK_FUNCTION
-                           count
-                           1
-                  TOK_GROUPBY
-                     TOK_TABLE_OR_COL
-                        key
-                     TOK_TABLE_OR_COL
-                        val
-            subq2
-         =
-            .
-               TOK_TABLE_OR_COL
-                  subq1
-               key
-            .
-               TOK_TABLE_OR_COL
-                  subq2
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-3 depends on stages: Stage-2
@@ -4761,31 +4201,6 @@ EXPLAIN EXTENDED
 INSERT OVERWRITE TABLE outputTbl1
 SELECT key, count(1) FROM T2 GROUP BY key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            T2
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            key
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -5050,39 +4465,6 @@ EXPLAIN EXTENDED
 INSERT OVERWRITE TABLE outputTbl4
 SELECT key, 1, val, count(1) FROM T2 GROUP BY key, 1, val
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            T2
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl4
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            1
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               val
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            key
-         1
-         TOK_TABLE_OR_COL
-            val
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-7 depends on stages: Stage-1 , consists of Stage-4, Stage-3, Stage-5
@@ -5462,42 +4844,6 @@ EXPLAIN EXTENDED
 INSERT OVERWRITE TABLE outputTbl5
 SELECT key, 1, val, 2, count(1) FROM T2 GROUP BY key, 1, val, 2
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            T2
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl5
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            1
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               val
-         TOK_SELEXPR
-            2
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            key
-         1
-         TOK_TABLE_OR_COL
-            val
-         2
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-7 depends on stages: Stage-1 , consists of Stage-4, Stage-3, Stage-5
@@ -5834,59 +5180,6 @@ SELECT key, constant, val, count(1) from
 (SELECT key, 1 as constant, val from T2)subq
 group by key, constant, val
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_QUERY
-            TOK_FROM
-               TOK_TABREF
-                  TOK_TABNAME
-                     T2
-            TOK_INSERT
-               TOK_DESTINATION
-                  TOK_DIR
-                     TOK_TMP_FILE
-               TOK_SELECT
-                  TOK_SELEXPR
-                     TOK_TABLE_OR_COL
-                        key
-                  TOK_SELEXPR
-                     1
-                     constant
-                  TOK_SELEXPR
-                     TOK_TABLE_OR_COL
-                        val
-         subq
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl4
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               constant
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               val
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            key
-         TOK_TABLE_OR_COL
-            constant
-         TOK_TABLE_OR_COL
-            val
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-7 depends on stages: Stage-1 , consists of Stage-4, Stage-3, Stage-5
@@ -6270,81 +5563,6 @@ SELECT key, constant as constant2, val, 2 as constant3 from
 )subq2
 group by key, constant3, val
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_QUERY
-            TOK_FROM
-               TOK_SUBQUERY
-                  TOK_QUERY
-                     TOK_FROM
-                        TOK_TABREF
-                           TOK_TABNAME
-                              T2
-                     TOK_INSERT
-                        TOK_DESTINATION
-                           TOK_DIR
-                              TOK_TMP_FILE
-                        TOK_SELECT
-                           TOK_SELEXPR
-                              TOK_TABLE_OR_COL
-                                 key
-                           TOK_SELEXPR
-                              1
-                              constant
-                           TOK_SELEXPR
-                              TOK_TABLE_OR_COL
-                                 val
-                  subq
-            TOK_INSERT
-               TOK_DESTINATION
-                  TOK_DIR
-                     TOK_TMP_FILE
-               TOK_SELECT
-                  TOK_SELEXPR
-                     TOK_TABLE_OR_COL
-                        key
-                  TOK_SELEXPR
-                     TOK_TABLE_OR_COL
-                        constant
-                     constant2
-                  TOK_SELEXPR
-                     TOK_TABLE_OR_COL
-                        val
-                  TOK_SELEXPR
-                     2
-                     constant3
-         subq2
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl4
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               constant3
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               val
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            key
-         TOK_TABLE_OR_COL
-            constant3
-         TOK_TABLE_OR_COL
-            val
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-7 depends on stages: Stage-1 , consists of Stage-4, Stage-3, Stage-5
diff --git a/ql/src/test/results/clientpositive/input23.q.out b/ql/src/test/results/clientpositive/input23.q.out
index 33f2eb67e5..dcb2891e0c 100644
--- a/ql/src/test/results/clientpositive/input23.q.out
+++ b/ql/src/test/results/clientpositive/input23.q.out
@@ -5,58 +5,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
  select * from srcpart a join srcpart b where a.ds = '2008-04-08' and a.hr = '11' and b.ds = '2008-04-08' and b.hr = '14' limit 5
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcpart
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcpart
-            b
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         and
-            and
-               and
-                  =
-                     .
-                        TOK_TABLE_OR_COL
-                           a
-                        ds
-                     '2008-04-08'
-                  =
-                     .
-                        TOK_TABLE_OR_COL
-                           a
-                        hr
-                     '11'
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     ds
-                  '2008-04-08'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  hr
-               '14'
-      TOK_LIMIT
-         5
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/input42.q.out b/ql/src/test/results/clientpositive/input42.q.out
index 4219c17065..866468d7e0 100644
--- a/ql/src/test/results/clientpositive/input42.q.out
+++ b/ql/src/test/results/clientpositive/input42.q.out
@@ -8,30 +8,6 @@ POSTHOOK: query: -- SORT_QUERY_RESULTS
 explain extended
 select * from srcpart a where a.ds='2008-04-08'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-         a
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               ds
-            '2008-04-08'
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
@@ -1157,35 +1133,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select * from srcpart a where a.ds='2008-04-08' and key < 200
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-         a
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         and
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  ds
-               '2008-04-08'
-            <
-               TOK_TABLE_OR_COL
-                  key
-               200
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
@@ -1693,36 +1640,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select * from srcpart a where a.ds='2008-04-08' and rand(100) < 0.1
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-         a
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         and
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  ds
-               '2008-04-08'
-            <
-               TOK_FUNCTION
-                  rand
-                  100
-               0.1
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
diff --git a/ql/src/test/results/clientpositive/input_part1.q.out b/ql/src/test/results/clientpositive/input_part1.q.out
index 501f7a9f87..2abaa3b51c 100644
--- a/ql/src/test/results/clientpositive/input_part1.q.out
+++ b/ql/src/test/results/clientpositive/input_part1.q.out
@@ -14,62 +14,6 @@ POSTHOOK: query: EXPLAIN EXTENDED
 FROM srcpart
 INSERT OVERWRITE TABLE dest1 SELECT srcpart.key, srcpart.value, srcpart.hr, srcpart.ds WHERE srcpart.key < 100 and srcpart.ds = '2008-04-08' and srcpart.hr = '12'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dest1
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  srcpart
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  srcpart
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  srcpart
-               hr
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  srcpart
-               ds
-      TOK_WHERE
-         and
-            and
-               <
-                  .
-                     TOK_TABLE_OR_COL
-                        srcpart
-                     key
-                  100
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        srcpart
-                     ds
-                  '2008-04-08'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     srcpart
-                  hr
-               '12'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-7 depends on stages: Stage-1 , consists of Stage-4, Stage-3, Stage-5
diff --git a/ql/src/test/results/clientpositive/input_part2.q.out b/ql/src/test/results/clientpositive/input_part2.q.out
index 9eba510608..2ce071ce93 100644
--- a/ql/src/test/results/clientpositive/input_part2.q.out
+++ b/ql/src/test/results/clientpositive/input_part2.q.out
@@ -28,109 +28,6 @@ FROM srcpart
 INSERT OVERWRITE TABLE dest1 SELECT srcpart.key, srcpart.value, srcpart.hr, srcpart.ds WHERE srcpart.key < 100 and srcpart.ds = '2008-04-08' and srcpart.hr = '12'
 INSERT OVERWRITE TABLE dest2 SELECT srcpart.key, srcpart.value, srcpart.hr, srcpart.ds WHERE srcpart.key < 100 and srcpart.ds = '2008-04-09' and srcpart.hr = '12'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dest1
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  srcpart
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  srcpart
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  srcpart
-               hr
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  srcpart
-               ds
-      TOK_WHERE
-         and
-            and
-               <
-                  .
-                     TOK_TABLE_OR_COL
-                        srcpart
-                     key
-                  100
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        srcpart
-                     ds
-                  '2008-04-08'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     srcpart
-                  hr
-               '12'
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dest2
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  srcpart
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  srcpart
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  srcpart
-               hr
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  srcpart
-               ds
-      TOK_WHERE
-         and
-            and
-               <
-                  .
-                     TOK_TABLE_OR_COL
-                        srcpart
-                     key
-                  100
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        srcpart
-                     ds
-                  '2008-04-09'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     srcpart
-                  hr
-               '12'
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-8 depends on stages: Stage-2 , consists of Stage-5, Stage-4, Stage-6
diff --git a/ql/src/test/results/clientpositive/input_part7.q.out b/ql/src/test/results/clientpositive/input_part7.q.out
index 53125d13d0..142908074c 100644
--- a/ql/src/test/results/clientpositive/input_part7.q.out
+++ b/ql/src/test/results/clientpositive/input_part7.q.out
@@ -14,105 +14,6 @@ SELECT * FROM (
 ) A
 SORT BY A.key, A.value, A.ds, A.hr
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_UNIONALL
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        SRCPART
-                     X
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_ALLCOLREF
-                           TOK_TABNAME
-                              X
-                  TOK_WHERE
-                     and
-                        =
-                           .
-                              TOK_TABLE_OR_COL
-                                 X
-                              ds
-                           '2008-04-08'
-                        <
-                           .
-                              TOK_TABLE_OR_COL
-                                 X
-                              key
-                           100
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        SRCPART
-                     Y
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_ALLCOLREF
-                           TOK_TABNAME
-                              Y
-                  TOK_WHERE
-                     and
-                        =
-                           .
-                              TOK_TABLE_OR_COL
-                                 Y
-                              ds
-                           '2008-04-08'
-                        <
-                           .
-                              TOK_TABLE_OR_COL
-                                 Y
-                              key
-                           100
-         A
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_SORTBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               .
-                  TOK_TABLE_OR_COL
-                     A
-                  key
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               .
-                  TOK_TABLE_OR_COL
-                     A
-                  value
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               .
-                  TOK_TABLE_OR_COL
-                     A
-                  ds
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               .
-                  TOK_TABLE_OR_COL
-                     A
-                  hr
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/input_part9.q.out b/ql/src/test/results/clientpositive/input_part9.q.out
index 0a3c87b486..920096e714 100644
--- a/ql/src/test/results/clientpositive/input_part9.q.out
+++ b/ql/src/test/results/clientpositive/input_part9.q.out
@@ -8,35 +8,6 @@ POSTHOOK: query: -- SORT_QUERY_RESULTS
 EXPLAIN EXTENDED
 SELECT x.* FROM SRCPART x WHERE key IS NOT NULL AND ds = '2008-04-08'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            SRCPART
-         x
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-               TOK_TABNAME
-                  x
-      TOK_WHERE
-         AND
-            TOK_FUNCTION
-               TOK_ISNOTNULL
-               TOK_TABLE_OR_COL
-                  key
-            =
-               TOK_TABLE_OR_COL
-                  ds
-               '2008-04-08'
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
diff --git a/ql/src/test/results/clientpositive/join17.q.out b/ql/src/test/results/clientpositive/join17.q.out
index 13260ef825..39c49a5ec7 100644
--- a/ql/src/test/results/clientpositive/join17.q.out
+++ b/ql/src/test/results/clientpositive/join17.q.out
@@ -18,44 +18,6 @@ POSTHOOK: query: EXPLAIN EXTENDED
 FROM src src1 JOIN src src2 ON (src1.key = src2.key)
 INSERT OVERWRITE TABLE dest1 SELECT src1.*, src2.*
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               src
-            src1
-         TOK_TABREF
-            TOK_TABNAME
-               src
-            src2
-         =
-            .
-               TOK_TABLE_OR_COL
-                  src1
-               key
-            .
-               TOK_TABLE_OR_COL
-                  src2
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dest1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-               TOK_TABNAME
-                  src1
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-               TOK_TABNAME
-                  src2
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/join26.q.out b/ql/src/test/results/clientpositive/join26.q.out
index 5533ce4a7c..0fdc4032e2 100644
--- a/ql/src/test/results/clientpositive/join26.q.out
+++ b/ql/src/test/results/clientpositive/join26.q.out
@@ -22,85 +22,6 @@ SELECT /*+ MAPJOIN(x,y) */ x.key, z.value, y.value
 FROM src1 x JOIN src y ON (x.key = y.key) 
 JOIN srcpart z ON (x.key = z.key and z.ds='2008-04-08' and z.hr=11)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_JOIN
-            TOK_TABREF
-               TOK_TABNAME
-                  src1
-               x
-            TOK_TABREF
-               TOK_TABNAME
-                  src
-               y
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     x
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     y
-                  key
-         TOK_TABREF
-            TOK_TABNAME
-               srcpart
-            z
-         and
-            and
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        x
-                     key
-                  .
-                     TOK_TABLE_OR_COL
-                        z
-                     key
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        z
-                     ds
-                  '2008-04-08'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     z
-                  hr
-               11
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dest_j1
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  x
-                  y
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  x
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  z
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  y
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-10 is a root stage
   Stage-1 depends on stages: Stage-10
diff --git a/ql/src/test/results/clientpositive/join32.q.out b/ql/src/test/results/clientpositive/join32.q.out
index 5cb124bddc..aad54630ec 100644
--- a/ql/src/test/results/clientpositive/join32.q.out
+++ b/ql/src/test/results/clientpositive/join32.q.out
@@ -26,79 +26,6 @@ SELECT x.key, z.value, y.value
 FROM src1 x JOIN src y ON (x.key = y.key) 
 JOIN srcpart z ON (x.value = z.value and z.ds='2008-04-08' and z.hr=11)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_JOIN
-            TOK_TABREF
-               TOK_TABNAME
-                  src1
-               x
-            TOK_TABREF
-               TOK_TABNAME
-                  src
-               y
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     x
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     y
-                  key
-         TOK_TABREF
-            TOK_TABNAME
-               srcpart
-            z
-         and
-            and
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        x
-                     value
-                  .
-                     TOK_TABLE_OR_COL
-                        z
-                     value
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        z
-                     ds
-                  '2008-04-08'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     z
-                  hr
-               11
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dest_j1
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  x
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  z
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  y
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-8 is a root stage
   Stage-6 depends on stages: Stage-8
diff --git a/ql/src/test/results/clientpositive/join32_lessSize.q.out b/ql/src/test/results/clientpositive/join32_lessSize.q.out
index 544e814fd5..a94b951c88 100644
--- a/ql/src/test/results/clientpositive/join32_lessSize.q.out
+++ b/ql/src/test/results/clientpositive/join32_lessSize.q.out
@@ -34,79 +34,6 @@ SELECT x.key, z.value, y.value
 FROM src1 x JOIN src y ON (x.key = y.key) 
 JOIN srcpart z ON (x.value = z.value and z.ds='2008-04-08' and z.hr=11)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_JOIN
-            TOK_TABREF
-               TOK_TABNAME
-                  src1
-               x
-            TOK_TABREF
-               TOK_TABNAME
-                  src
-               y
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     x
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     y
-                  key
-         TOK_TABREF
-            TOK_TABNAME
-               srcpart
-            z
-         and
-            and
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        x
-                     value
-                  .
-                     TOK_TABLE_OR_COL
-                        z
-                     value
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        z
-                     ds
-                  '2008-04-08'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     z
-                  hr
-               11
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dest_j1
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  x
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  z
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  y
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-9 is a root stage
   Stage-7 depends on stages: Stage-9
@@ -579,79 +506,6 @@ FROM src w JOIN src1 x ON (x.value = w.value)
 JOIN src y ON (x.key = y.key) 
 JOIN src1 z ON (x.key = z.key)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_JOIN
-            TOK_JOIN
-               TOK_TABREF
-                  TOK_TABNAME
-                     src
-                  w
-               TOK_TABREF
-                  TOK_TABNAME
-                     src1
-                  x
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        x
-                     value
-                  .
-                     TOK_TABLE_OR_COL
-                        w
-                     value
-            TOK_TABREF
-               TOK_TABNAME
-                  src
-               y
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     x
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     y
-                  key
-         TOK_TABREF
-            TOK_TABNAME
-               src1
-            z
-         =
-            .
-               TOK_TABLE_OR_COL
-                  x
-               key
-            .
-               TOK_TABLE_OR_COL
-                  z
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dest_j1
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  x
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  z
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  y
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-13 is a root stage
   Stage-10 depends on stages: Stage-13
@@ -1215,98 +1069,6 @@ SELECT res.key, z.value, res.value
 FROM (select x.key, x.value from src1 x JOIN src y ON (x.key = y.key)) res 
 JOIN srcpart z ON (res.value = z.value and z.ds='2008-04-08' and z.hr=11)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_SUBQUERY
-            TOK_QUERY
-               TOK_FROM
-                  TOK_JOIN
-                     TOK_TABREF
-                        TOK_TABNAME
-                           src1
-                        x
-                     TOK_TABREF
-                        TOK_TABNAME
-                           src
-                        y
-                     =
-                        .
-                           TOK_TABLE_OR_COL
-                              x
-                           key
-                        .
-                           TOK_TABLE_OR_COL
-                              y
-                           key
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        .
-                           TOK_TABLE_OR_COL
-                              x
-                           key
-                     TOK_SELEXPR
-                        .
-                           TOK_TABLE_OR_COL
-                              x
-                           value
-            res
-         TOK_TABREF
-            TOK_TABNAME
-               srcpart
-            z
-         and
-            and
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        res
-                     value
-                  .
-                     TOK_TABLE_OR_COL
-                        z
-                     value
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        z
-                     ds
-                  '2008-04-08'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     z
-                  hr
-               11
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dest_j2
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  res
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  z
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  res
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-8 is a root stage
   Stage-6 depends on stages: Stage-8
@@ -1827,98 +1589,6 @@ SELECT res.key, z.value, res.value
 FROM (select x.key, x.value from src1 x LEFT OUTER JOIN src y ON (x.key = y.key)) res 
 JOIN srcpart z ON (res.value = z.value and z.ds='2008-04-08' and z.hr=11)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_SUBQUERY
-            TOK_QUERY
-               TOK_FROM
-                  TOK_LEFTOUTERJOIN
-                     TOK_TABREF
-                        TOK_TABNAME
-                           src1
-                        x
-                     TOK_TABREF
-                        TOK_TABNAME
-                           src
-                        y
-                     =
-                        .
-                           TOK_TABLE_OR_COL
-                              x
-                           key
-                        .
-                           TOK_TABLE_OR_COL
-                              y
-                           key
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        .
-                           TOK_TABLE_OR_COL
-                              x
-                           key
-                     TOK_SELEXPR
-                        .
-                           TOK_TABLE_OR_COL
-                              x
-                           value
-            res
-         TOK_TABREF
-            TOK_TABNAME
-               srcpart
-            z
-         and
-            and
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        res
-                     value
-                  .
-                     TOK_TABLE_OR_COL
-                        z
-                     value
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        z
-                     ds
-                  '2008-04-08'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     z
-                  hr
-               11
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dest_j2
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  res
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  z
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  res
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-8 is a root stage
   Stage-6 depends on stages: Stage-8
diff --git a/ql/src/test/results/clientpositive/join33.q.out b/ql/src/test/results/clientpositive/join33.q.out
index 5cb124bddc..aad54630ec 100644
--- a/ql/src/test/results/clientpositive/join33.q.out
+++ b/ql/src/test/results/clientpositive/join33.q.out
@@ -26,79 +26,6 @@ SELECT x.key, z.value, y.value
 FROM src1 x JOIN src y ON (x.key = y.key) 
 JOIN srcpart z ON (x.value = z.value and z.ds='2008-04-08' and z.hr=11)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_JOIN
-            TOK_TABREF
-               TOK_TABNAME
-                  src1
-               x
-            TOK_TABREF
-               TOK_TABNAME
-                  src
-               y
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     x
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     y
-                  key
-         TOK_TABREF
-            TOK_TABNAME
-               srcpart
-            z
-         and
-            and
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        x
-                     value
-                  .
-                     TOK_TABLE_OR_COL
-                        z
-                     value
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        z
-                     ds
-                  '2008-04-08'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     z
-                  hr
-               11
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dest_j1
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  x
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  z
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  y
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-8 is a root stage
   Stage-6 depends on stages: Stage-8
diff --git a/ql/src/test/results/clientpositive/join34.q.out b/ql/src/test/results/clientpositive/join34.q.out
index e2c2b1a5ab..74fac5c6a3 100644
--- a/ql/src/test/results/clientpositive/join34.q.out
+++ b/ql/src/test/results/clientpositive/join34.q.out
@@ -34,110 +34,6 @@ FROM
 ) subq1
 JOIN src1 x ON (x.key = subq1.key)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_SUBQUERY
-            TOK_UNIONALL
-               TOK_QUERY
-                  TOK_FROM
-                     TOK_TABREF
-                        TOK_TABNAME
-                           src
-                        x
-                  TOK_INSERT
-                     TOK_DESTINATION
-                        TOK_DIR
-                           TOK_TMP_FILE
-                     TOK_SELECT
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 x
-                              key
-                           key
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 x
-                              value
-                           value
-                     TOK_WHERE
-                        <
-                           .
-                              TOK_TABLE_OR_COL
-                                 x
-                              key
-                           20
-               TOK_QUERY
-                  TOK_FROM
-                     TOK_TABREF
-                        TOK_TABNAME
-                           src
-                        x1
-                  TOK_INSERT
-                     TOK_DESTINATION
-                        TOK_DIR
-                           TOK_TMP_FILE
-                     TOK_SELECT
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 x1
-                              key
-                           key
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 x1
-                              value
-                           value
-                     TOK_WHERE
-                        >
-                           .
-                              TOK_TABLE_OR_COL
-                                 x1
-                              key
-                           100
-            subq1
-         TOK_TABREF
-            TOK_TABNAME
-               src1
-            x
-         =
-            .
-               TOK_TABLE_OR_COL
-                  x
-               key
-            .
-               TOK_TABLE_OR_COL
-                  subq1
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dest_j1
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  x
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  x
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  subq1
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-6 is a root stage
   Stage-5 depends on stages: Stage-6
diff --git a/ql/src/test/results/clientpositive/join35.q.out b/ql/src/test/results/clientpositive/join35.q.out
index 96f7cc85ec..6fe9caeb77 100644
--- a/ql/src/test/results/clientpositive/join35.q.out
+++ b/ql/src/test/results/clientpositive/join35.q.out
@@ -34,118 +34,6 @@ FROM
 ) subq1
 JOIN src1 x ON (x.key = subq1.key)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_SUBQUERY
-            TOK_UNIONALL
-               TOK_QUERY
-                  TOK_FROM
-                     TOK_TABREF
-                        TOK_TABNAME
-                           src
-                        x
-                  TOK_INSERT
-                     TOK_DESTINATION
-                        TOK_DIR
-                           TOK_TMP_FILE
-                     TOK_SELECT
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 x
-                              key
-                           key
-                        TOK_SELEXPR
-                           TOK_FUNCTION
-                              count
-                              1
-                           cnt
-                     TOK_WHERE
-                        <
-                           .
-                              TOK_TABLE_OR_COL
-                                 x
-                              key
-                           20
-                     TOK_GROUPBY
-                        .
-                           TOK_TABLE_OR_COL
-                              x
-                           key
-               TOK_QUERY
-                  TOK_FROM
-                     TOK_TABREF
-                        TOK_TABNAME
-                           src
-                        x1
-                  TOK_INSERT
-                     TOK_DESTINATION
-                        TOK_DIR
-                           TOK_TMP_FILE
-                     TOK_SELECT
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 x1
-                              key
-                           key
-                        TOK_SELEXPR
-                           TOK_FUNCTION
-                              count
-                              1
-                           cnt
-                     TOK_WHERE
-                        >
-                           .
-                              TOK_TABLE_OR_COL
-                                 x1
-                              key
-                           100
-                     TOK_GROUPBY
-                        .
-                           TOK_TABLE_OR_COL
-                              x1
-                           key
-            subq1
-         TOK_TABREF
-            TOK_TABNAME
-               src1
-            x
-         =
-            .
-               TOK_TABLE_OR_COL
-                  x
-               key
-            .
-               TOK_TABLE_OR_COL
-                  subq1
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dest_j1
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  x
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  x
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  subq1
-               cnt
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-7 depends on stages: Stage-1, Stage-4
diff --git a/ql/src/test/results/clientpositive/join9.q.out b/ql/src/test/results/clientpositive/join9.q.out
index e904b31c28..f41d1538e8 100644
--- a/ql/src/test/results/clientpositive/join9.q.out
+++ b/ql/src/test/results/clientpositive/join9.q.out
@@ -18,60 +18,6 @@ POSTHOOK: query: EXPLAIN EXTENDED
 FROM srcpart src1 JOIN src src2 ON (src1.key = src2.key)
 INSERT OVERWRITE TABLE dest1 SELECT src1.key, src2.value where src1.ds = '2008-04-08' and src1.hr = '12'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcpart
-            src1
-         TOK_TABREF
-            TOK_TABNAME
-               src
-            src2
-         =
-            .
-               TOK_TABLE_OR_COL
-                  src1
-               key
-            .
-               TOK_TABLE_OR_COL
-                  src2
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dest1
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  src1
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  src2
-               value
-      TOK_WHERE
-         and
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     src1
-                  ds
-               '2008-04-08'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     src1
-                  hr
-               '12'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/join_filters_overlap.q.out b/ql/src/test/results/clientpositive/join_filters_overlap.q.out
index dede6b734c..ac00fd5735 100644
--- a/ql/src/test/results/clientpositive/join_filters_overlap.q.out
+++ b/ql/src/test/results/clientpositive/join_filters_overlap.q.out
@@ -22,78 +22,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: -- overlap on a
 explain extended select * from a left outer join a b on (a.key=b.key AND a.value=50 AND b.value=50) left outer join a c on (a.key=c.key AND a.value=60 AND c.value=60)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_LEFTOUTERJOIN
-         TOK_LEFTOUTERJOIN
-            TOK_TABREF
-               TOK_TABNAME
-                  a
-            TOK_TABREF
-               TOK_TABNAME
-                  a
-               b
-            AND
-               AND
-                  =
-                     .
-                        TOK_TABLE_OR_COL
-                           a
-                        key
-                     .
-                        TOK_TABLE_OR_COL
-                           b
-                        key
-                  =
-                     .
-                        TOK_TABLE_OR_COL
-                           a
-                        value
-                     50
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     value
-                  50
-         TOK_TABREF
-            TOK_TABNAME
-               a
-            c
-         AND
-            AND
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     key
-                  .
-                     TOK_TABLE_OR_COL
-                        c
-                     key
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     value
-                  60
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     c
-                  value
-               60
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -285,78 +213,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: -- overlap on b
 explain extended select * from a right outer join a b on (a.key=b.key AND a.value=50 AND b.value=50) left outer join a c on (b.key=c.key AND b.value=60 AND c.value=60)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_LEFTOUTERJOIN
-         TOK_RIGHTOUTERJOIN
-            TOK_TABREF
-               TOK_TABNAME
-                  a
-            TOK_TABREF
-               TOK_TABNAME
-                  a
-               b
-            AND
-               AND
-                  =
-                     .
-                        TOK_TABLE_OR_COL
-                           a
-                        key
-                     .
-                        TOK_TABLE_OR_COL
-                           b
-                        key
-                  =
-                     .
-                        TOK_TABLE_OR_COL
-                           a
-                        value
-                     50
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     value
-                  50
-         TOK_TABREF
-            TOK_TABNAME
-               a
-            c
-         AND
-            AND
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-                  .
-                     TOK_TABLE_OR_COL
-                        c
-                     key
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     value
-                  60
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     c
-                  value
-               60
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -548,92 +404,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: -- overlap on b with two filters for each
 explain extended select * from a right outer join a b on (a.key=b.key AND a.value=50 AND b.value=50 AND b.value>10) left outer join a c on (b.key=c.key AND b.value=60 AND b.value>20 AND c.value=60)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_LEFTOUTERJOIN
-         TOK_RIGHTOUTERJOIN
-            TOK_TABREF
-               TOK_TABNAME
-                  a
-            TOK_TABREF
-               TOK_TABNAME
-                  a
-               b
-            AND
-               AND
-                  AND
-                     =
-                        .
-                           TOK_TABLE_OR_COL
-                              a
-                           key
-                        .
-                           TOK_TABLE_OR_COL
-                              b
-                           key
-                     =
-                        .
-                           TOK_TABLE_OR_COL
-                              a
-                           value
-                        50
-                  =
-                     .
-                        TOK_TABLE_OR_COL
-                           b
-                        value
-                     50
-               >
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     value
-                  10
-         TOK_TABREF
-            TOK_TABNAME
-               a
-            c
-         AND
-            AND
-               AND
-                  =
-                     .
-                        TOK_TABLE_OR_COL
-                           b
-                        key
-                     .
-                        TOK_TABLE_OR_COL
-                           c
-                        key
-                  =
-                     .
-                        TOK_TABLE_OR_COL
-                           b
-                        value
-                     60
-               >
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     value
-                  20
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     c
-                  value
-               60
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -825,106 +595,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: -- overlap on a, b
 explain extended select * from a full outer join a b on (a.key=b.key AND a.value=50 AND b.value=50) left outer join a c on (b.key=c.key AND b.value=60 AND c.value=60) left outer join a d on (a.key=d.key AND a.value=40 AND d.value=40)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_LEFTOUTERJOIN
-         TOK_LEFTOUTERJOIN
-            TOK_FULLOUTERJOIN
-               TOK_TABREF
-                  TOK_TABNAME
-                     a
-               TOK_TABREF
-                  TOK_TABNAME
-                     a
-                  b
-               AND
-                  AND
-                     =
-                        .
-                           TOK_TABLE_OR_COL
-                              a
-                           key
-                        .
-                           TOK_TABLE_OR_COL
-                              b
-                           key
-                     =
-                        .
-                           TOK_TABLE_OR_COL
-                              a
-                           value
-                        50
-                  =
-                     .
-                        TOK_TABLE_OR_COL
-                           b
-                        value
-                     50
-            TOK_TABREF
-               TOK_TABNAME
-                  a
-               c
-            AND
-               AND
-                  =
-                     .
-                        TOK_TABLE_OR_COL
-                           b
-                        key
-                     .
-                        TOK_TABLE_OR_COL
-                           c
-                        key
-                  =
-                     .
-                        TOK_TABLE_OR_COL
-                           b
-                        value
-                     60
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        c
-                     value
-                  60
-         TOK_TABREF
-            TOK_TABNAME
-               a
-            d
-         AND
-            AND
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     key
-                  .
-                     TOK_TABLE_OR_COL
-                        d
-                     key
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     value
-                  40
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     d
-                  value
-               40
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1128,106 +798,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: -- triple overlap on a
 explain extended select * from a left outer join a b on (a.key=b.key AND a.value=50 AND b.value=50) left outer join a c on (a.key=c.key AND a.value=60 AND c.value=60) left outer join a d on (a.key=d.key AND a.value=40 AND d.value=40)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_LEFTOUTERJOIN
-         TOK_LEFTOUTERJOIN
-            TOK_LEFTOUTERJOIN
-               TOK_TABREF
-                  TOK_TABNAME
-                     a
-               TOK_TABREF
-                  TOK_TABNAME
-                     a
-                  b
-               AND
-                  AND
-                     =
-                        .
-                           TOK_TABLE_OR_COL
-                              a
-                           key
-                        .
-                           TOK_TABLE_OR_COL
-                              b
-                           key
-                     =
-                        .
-                           TOK_TABLE_OR_COL
-                              a
-                           value
-                        50
-                  =
-                     .
-                        TOK_TABLE_OR_COL
-                           b
-                        value
-                     50
-            TOK_TABREF
-               TOK_TABNAME
-                  a
-               c
-            AND
-               AND
-                  =
-                     .
-                        TOK_TABLE_OR_COL
-                           a
-                        key
-                     .
-                        TOK_TABLE_OR_COL
-                           c
-                        key
-                  =
-                     .
-                        TOK_TABLE_OR_COL
-                           a
-                        value
-                     60
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        c
-                     value
-                  60
-         TOK_TABREF
-            TOK_TABNAME
-               a
-            d
-         AND
-            AND
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     key
-                  .
-                     TOK_TABLE_OR_COL
-                        d
-                     key
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     value
-                  40
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     d
-                  value
-               40
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/join_map_ppr.q.out b/ql/src/test/results/clientpositive/join_map_ppr.q.out
index 444fd7f6ee..e720e6538c 100644
--- a/ql/src/test/results/clientpositive/join_map_ppr.q.out
+++ b/ql/src/test/results/clientpositive/join_map_ppr.q.out
@@ -24,85 +24,6 @@ FROM src1 x JOIN src y ON (x.key = y.key)
 JOIN srcpart z ON (x.key = z.key)
 WHERE z.ds='2008-04-08' and z.hr=11
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_JOIN
-            TOK_TABREF
-               TOK_TABNAME
-                  src1
-               x
-            TOK_TABREF
-               TOK_TABNAME
-                  src
-               y
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     x
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     y
-                  key
-         TOK_TABREF
-            TOK_TABNAME
-               srcpart
-            z
-         =
-            .
-               TOK_TABLE_OR_COL
-                  x
-               key
-            .
-               TOK_TABLE_OR_COL
-                  z
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dest_j1
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  x
-                  y
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  x
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  z
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  y
-               value
-      TOK_WHERE
-         and
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     z
-                  ds
-               '2008-04-08'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     z
-                  hr
-               11
-
-
 STAGE DEPENDENCIES:
   Stage-10 is a root stage
   Stage-1 depends on stages: Stage-10
@@ -631,85 +552,6 @@ FROM src1_copy x JOIN src_copy y ON (x.key = y.key)
 JOIN srcpart z ON (x.key = z.key)
 WHERE z.ds='2008-04-08' and z.hr=11
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_JOIN
-            TOK_TABREF
-               TOK_TABNAME
-                  src1_copy
-               x
-            TOK_TABREF
-               TOK_TABNAME
-                  src_copy
-               y
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     x
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     y
-                  key
-         TOK_TABREF
-            TOK_TABNAME
-               srcpart
-            z
-         =
-            .
-               TOK_TABLE_OR_COL
-                  x
-               key
-            .
-               TOK_TABLE_OR_COL
-                  z
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dest_j1
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  x
-                  y
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  x
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  z
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  y
-               value
-      TOK_WHERE
-         and
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     z
-                  ds
-               '2008-04-08'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     z
-                  hr
-               11
-
-
 STAGE DEPENDENCIES:
   Stage-10 is a root stage
   Stage-1 depends on stages: Stage-10
diff --git a/ql/src/test/results/clientpositive/list_bucket_dml_1.q.out b/ql/src/test/results/clientpositive/list_bucket_dml_1.q.out
index 0cd07efadb..2b7ebb293d 100644
--- a/ql/src/test/results/clientpositive/list_bucket_dml_1.q.out
+++ b/ql/src/test/results/clientpositive/list_bucket_dml_1.q.out
@@ -30,41 +30,6 @@ POSTHOOK: query: -- list bucketing DML
 explain extended
 insert overwrite table list_bucketing_dynamic_part partition (ds='2008-04-08', hr) select key, value, hr from srcpart where ds='2008-04-08'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               list_bucketing_dynamic_part
-            TOK_PARTSPEC
-               TOK_PARTVAL
-                  ds
-                  '2008-04-08'
-               TOK_PARTVAL
-                  hr
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               hr
-      TOK_WHERE
-         =
-            TOK_TABLE_OR_COL
-               ds
-            '2008-04-08'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -393,41 +358,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select key, value from list_bucketing_dynamic_part where ds='2008-04-08' and hr='11' and key = "484"
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            list_bucketing_dynamic_part
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-      TOK_WHERE
-         and
-            and
-               =
-                  TOK_TABLE_OR_COL
-                     ds
-                  '2008-04-08'
-               =
-                  TOK_TABLE_OR_COL
-                     hr
-                  '11'
-            =
-               TOK_TABLE_OR_COL
-                  key
-               "484"
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
diff --git a/ql/src/test/results/clientpositive/list_bucket_dml_10.q.java1.7.out b/ql/src/test/results/clientpositive/list_bucket_dml_10.q.java1.7.out
index 8eb467323c..8447e86051 100644
--- a/ql/src/test/results/clientpositive/list_bucket_dml_10.q.java1.7.out
+++ b/ql/src/test/results/clientpositive/list_bucket_dml_10.q.java1.7.out
@@ -54,34 +54,6 @@ explain extended
 insert overwrite table list_bucketing_static_part partition (ds = '2008-04-08',  hr = '11')
 select key, value from src
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            src
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               list_bucketing_static_part
-            TOK_PARTSPEC
-               TOK_PARTVAL
-                  ds
-                  '2008-04-08'
-               TOK_PARTVAL
-                  hr
-                  '11'
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-7 depends on stages: Stage-1 , consists of Stage-4, Stage-3, Stage-5
diff --git a/ql/src/test/results/clientpositive/list_bucket_dml_11.q.java1.7.out b/ql/src/test/results/clientpositive/list_bucket_dml_11.q.java1.7.out
index f304083bd5..b58d17c1e7 100644
--- a/ql/src/test/results/clientpositive/list_bucket_dml_11.q.java1.7.out
+++ b/ql/src/test/results/clientpositive/list_bucket_dml_11.q.java1.7.out
@@ -40,34 +40,6 @@ explain extended
 insert overwrite table list_bucketing_static_part partition (ds = '2008-04-08',  hr = '11')
 select key, value from src
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            src
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               list_bucketing_static_part
-            TOK_PARTSPEC
-               TOK_PARTVAL
-                  ds
-                  '2008-04-08'
-               TOK_PARTVAL
-                  hr
-                  '11'
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -267,41 +239,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select key, value from list_bucketing_static_part where ds='2008-04-08' and hr='11' and value = "val_466"
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            list_bucketing_static_part
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-      TOK_WHERE
-         and
-            and
-               =
-                  TOK_TABLE_OR_COL
-                     ds
-                  '2008-04-08'
-               =
-                  TOK_TABLE_OR_COL
-                     hr
-                  '11'
-            =
-               TOK_TABLE_OR_COL
-                  value
-               "val_466"
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
diff --git a/ql/src/test/results/clientpositive/list_bucket_dml_12.q.java1.7.out b/ql/src/test/results/clientpositive/list_bucket_dml_12.q.java1.7.out
index 7d8070ac7d..0be7f4e8c2 100644
--- a/ql/src/test/results/clientpositive/list_bucket_dml_12.q.java1.7.out
+++ b/ql/src/test/results/clientpositive/list_bucket_dml_12.q.java1.7.out
@@ -38,40 +38,6 @@ explain extended
 insert overwrite table list_bucketing_mul_col partition (ds = '2008-04-08',  hr = '11')
 select 1, key, 1, value, 1 from src
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            src
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               list_bucketing_mul_col
-            TOK_PARTSPEC
-               TOK_PARTVAL
-                  ds
-                  '2008-04-08'
-               TOK_PARTVAL
-                  hr
-                  '11'
-      TOK_SELECT
-         TOK_SELEXPR
-            1
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            1
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-         TOK_SELEXPR
-            1
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -279,42 +245,6 @@ POSTHOOK: query: explain extended
 select * from list_bucketing_mul_col 
 where ds='2008-04-08' and hr='11' and col2 = "466" and col4 = "val_466"
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            list_bucketing_mul_col
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         and
-            and
-               and
-                  =
-                     TOK_TABLE_OR_COL
-                        ds
-                     '2008-04-08'
-                  =
-                     TOK_TABLE_OR_COL
-                        hr
-                     '11'
-               =
-                  TOK_TABLE_OR_COL
-                     col2
-                  "466"
-            =
-               TOK_TABLE_OR_COL
-                  col4
-               "val_466"
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
@@ -405,42 +335,6 @@ POSTHOOK: query: explain extended
 select * from list_bucketing_mul_col 
 where ds='2008-04-08' and hr='11' and col2 = "382" and col4 = "val_382"
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            list_bucketing_mul_col
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         and
-            and
-               and
-                  =
-                     TOK_TABLE_OR_COL
-                        ds
-                     '2008-04-08'
-                  =
-                     TOK_TABLE_OR_COL
-                        hr
-                     '11'
-               =
-                  TOK_TABLE_OR_COL
-                     col2
-                  "382"
-            =
-               TOK_TABLE_OR_COL
-                  col4
-               "val_382"
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
diff --git a/ql/src/test/results/clientpositive/list_bucket_dml_13.q.java1.7.out b/ql/src/test/results/clientpositive/list_bucket_dml_13.q.java1.7.out
index 81b14313bc..bfce33500e 100644
--- a/ql/src/test/results/clientpositive/list_bucket_dml_13.q.java1.7.out
+++ b/ql/src/test/results/clientpositive/list_bucket_dml_13.q.java1.7.out
@@ -38,40 +38,6 @@ explain extended
 insert overwrite table list_bucketing_mul_col partition (ds = '2008-04-08',  hr = '2013-01-23+18:00:99')
 select 1, key, 1, value, 1 from src
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            src
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               list_bucketing_mul_col
-            TOK_PARTSPEC
-               TOK_PARTVAL
-                  ds
-                  '2008-04-08'
-               TOK_PARTVAL
-                  hr
-                  '2013-01-23+18:00:99'
-      TOK_SELECT
-         TOK_SELEXPR
-            1
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            1
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-         TOK_SELEXPR
-            1
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -279,42 +245,6 @@ POSTHOOK: query: explain extended
 select * from list_bucketing_mul_col 
 where ds='2008-04-08' and hr='2013-01-23+18:00:99' and col2 = "466" and col4 = "val_466"
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            list_bucketing_mul_col
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         and
-            and
-               and
-                  =
-                     TOK_TABLE_OR_COL
-                        ds
-                     '2008-04-08'
-                  =
-                     TOK_TABLE_OR_COL
-                        hr
-                     '2013-01-23+18:00:99'
-               =
-                  TOK_TABLE_OR_COL
-                     col2
-                  "466"
-            =
-               TOK_TABLE_OR_COL
-                  col4
-               "val_466"
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
diff --git a/ql/src/test/results/clientpositive/list_bucket_dml_14.q.out b/ql/src/test/results/clientpositive/list_bucket_dml_14.q.out
index 790801fa8f..c063dc1440 100644
--- a/ql/src/test/results/clientpositive/list_bucket_dml_14.q.out
+++ b/ql/src/test/results/clientpositive/list_bucket_dml_14.q.out
@@ -28,23 +28,6 @@ POSTHOOK: query: -- list bucketing DML
 explain extended
 insert overwrite table list_bucketing select * from src
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            src
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               list_bucketing
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -249,31 +232,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select key, value from list_bucketing where key = "484"
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            list_bucketing
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-      TOK_WHERE
-         =
-            TOK_TABLE_OR_COL
-               key
-            "484"
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/list_bucket_dml_2.q.java1.7.out b/ql/src/test/results/clientpositive/list_bucket_dml_2.q.java1.7.out
index bfc1e43ec6..dcfbec0423 100644
--- a/ql/src/test/results/clientpositive/list_bucket_dml_2.q.java1.7.out
+++ b/ql/src/test/results/clientpositive/list_bucket_dml_2.q.java1.7.out
@@ -56,39 +56,6 @@ explain extended
 insert overwrite table list_bucketing_static_part partition (ds = '2008-04-08',  hr = '11')
 select key, value from srcpart where ds = '2008-04-08'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               list_bucketing_static_part
-            TOK_PARTSPEC
-               TOK_PARTVAL
-                  ds
-                  '2008-04-08'
-               TOK_PARTVAL
-                  hr
-                  '11'
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-      TOK_WHERE
-         =
-            TOK_TABLE_OR_COL
-               ds
-            '2008-04-08'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -365,42 +332,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select * from list_bucketing_static_part where ds = '2008-04-08' and  hr = '11' and key = '484' and value = 'val_484'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            list_bucketing_static_part
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         and
-            and
-               and
-                  =
-                     TOK_TABLE_OR_COL
-                        ds
-                     '2008-04-08'
-                  =
-                     TOK_TABLE_OR_COL
-                        hr
-                     '11'
-               =
-                  TOK_TABLE_OR_COL
-                     key
-                  '484'
-            =
-               TOK_TABLE_OR_COL
-                  value
-               'val_484'
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
diff --git a/ql/src/test/results/clientpositive/list_bucket_dml_3.q.out b/ql/src/test/results/clientpositive/list_bucket_dml_3.q.out
index ea24f8630f..548815af31 100644
--- a/ql/src/test/results/clientpositive/list_bucket_dml_3.q.out
+++ b/ql/src/test/results/clientpositive/list_bucket_dml_3.q.out
@@ -24,39 +24,6 @@ POSTHOOK: query: -- list bucketing DML
 explain extended
 insert overwrite table list_bucketing_static_part partition (ds='2008-04-08', hr='11') select key, value from srcpart where ds='2008-04-08'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               list_bucketing_static_part
-            TOK_PARTSPEC
-               TOK_PARTVAL
-                  ds
-                  '2008-04-08'
-               TOK_PARTVAL
-                  hr
-                  '11'
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-      TOK_WHERE
-         =
-            TOK_TABLE_OR_COL
-               ds
-            '2008-04-08'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -335,41 +302,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select key, value from list_bucketing_static_part where ds='2008-04-08' and hr='11' and key = "484"
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            list_bucketing_static_part
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-      TOK_WHERE
-         and
-            and
-               =
-                  TOK_TABLE_OR_COL
-                     ds
-                  '2008-04-08'
-               =
-                  TOK_TABLE_OR_COL
-                     hr
-                  '11'
-            =
-               TOK_TABLE_OR_COL
-                  key
-               "484"
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
diff --git a/ql/src/test/results/clientpositive/list_bucket_dml_4.q.java1.7.out b/ql/src/test/results/clientpositive/list_bucket_dml_4.q.java1.7.out
index 6b8b89f74d..c15c6a2927 100644
--- a/ql/src/test/results/clientpositive/list_bucket_dml_4.q.java1.7.out
+++ b/ql/src/test/results/clientpositive/list_bucket_dml_4.q.java1.7.out
@@ -64,39 +64,6 @@ explain extended
 insert overwrite table list_bucketing_static_part partition (ds = '2008-04-08',  hr = '11')
 select key, value from srcpart where ds = '2008-04-08'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               list_bucketing_static_part
-            TOK_PARTSPEC
-               TOK_PARTVAL
-                  ds
-                  '2008-04-08'
-               TOK_PARTVAL
-                  hr
-                  '11'
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-      TOK_WHERE
-         =
-            TOK_TABLE_OR_COL
-               ds
-            '2008-04-08'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -353,39 +320,6 @@ explain extended
 insert overwrite table list_bucketing_static_part partition (ds = '2008-04-08',  hr = '11')
 select key, value from srcpart where ds = '2008-04-08'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               list_bucketing_static_part
-            TOK_PARTSPEC
-               TOK_PARTVAL
-                  ds
-                  '2008-04-08'
-               TOK_PARTVAL
-                  hr
-                  '11'
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-      TOK_WHERE
-         =
-            TOK_TABLE_OR_COL
-               ds
-            '2008-04-08'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-7 depends on stages: Stage-1 , consists of Stage-4, Stage-3, Stage-5
@@ -774,42 +708,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select * from list_bucketing_static_part where ds = '2008-04-08' and  hr = '11' and key = '484' and value = 'val_484'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            list_bucketing_static_part
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         and
-            and
-               and
-                  =
-                     TOK_TABLE_OR_COL
-                        ds
-                     '2008-04-08'
-                  =
-                     TOK_TABLE_OR_COL
-                        hr
-                     '11'
-               =
-                  TOK_TABLE_OR_COL
-                     key
-                  '484'
-            =
-               TOK_TABLE_OR_COL
-                  value
-               'val_484'
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
diff --git a/ql/src/test/results/clientpositive/list_bucket_dml_5.q.java1.7.out b/ql/src/test/results/clientpositive/list_bucket_dml_5.q.java1.7.out
index 101947448b..a0947b21d0 100644
--- a/ql/src/test/results/clientpositive/list_bucket_dml_5.q.java1.7.out
+++ b/ql/src/test/results/clientpositive/list_bucket_dml_5.q.java1.7.out
@@ -34,41 +34,6 @@ POSTHOOK: query: -- list bucketing DML
 explain extended
 insert overwrite table list_bucketing_dynamic_part partition (ds='2008-04-08', hr) select key, value, hr from srcpart where ds='2008-04-08'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               list_bucketing_dynamic_part
-            TOK_PARTSPEC
-               TOK_PARTVAL
-                  ds
-                  '2008-04-08'
-               TOK_PARTVAL
-                  hr
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               hr
-      TOK_WHERE
-         =
-            TOK_TABLE_OR_COL
-               ds
-            '2008-04-08'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -402,47 +367,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select key, value, ds, hr from list_bucketing_dynamic_part where ds='2008-04-08' and key = "103" and value ="val_103"
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            list_bucketing_dynamic_part
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               hr
-      TOK_WHERE
-         and
-            and
-               =
-                  TOK_TABLE_OR_COL
-                     ds
-                  '2008-04-08'
-               =
-                  TOK_TABLE_OR_COL
-                     key
-                  "103"
-            =
-               TOK_TABLE_OR_COL
-                  value
-               "val_103"
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
diff --git a/ql/src/test/results/clientpositive/list_bucket_dml_6.q.java1.7.out b/ql/src/test/results/clientpositive/list_bucket_dml_6.q.java1.7.out
index 668e9184b6..c022618439 100644
--- a/ql/src/test/results/clientpositive/list_bucket_dml_6.q.java1.7.out
+++ b/ql/src/test/results/clientpositive/list_bucket_dml_6.q.java1.7.out
@@ -110,49 +110,6 @@ explain extended
 insert overwrite table list_bucketing_dynamic_part partition (ds = '2008-04-08', hr)
 select key, value, if(key % 100 == 0, 'a1', 'b1') from srcpart where ds = '2008-04-08'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               list_bucketing_dynamic_part
-            TOK_PARTSPEC
-               TOK_PARTVAL
-                  ds
-                  '2008-04-08'
-               TOK_PARTVAL
-                  hr
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-         TOK_SELEXPR
-            TOK_FUNCTION
-               if
-               ==
-                  %
-                     TOK_TABLE_OR_COL
-                        key
-                     100
-                  0
-               'a1'
-               'b1'
-      TOK_WHERE
-         =
-            TOK_TABLE_OR_COL
-               ds
-            '2008-04-08'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -456,49 +413,6 @@ explain extended
 insert overwrite table list_bucketing_dynamic_part partition (ds = '2008-04-08', hr)
 select key, value, if(key % 100 == 0, 'a1', 'b1') from srcpart where ds = '2008-04-08'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               list_bucketing_dynamic_part
-            TOK_PARTSPEC
-               TOK_PARTVAL
-                  ds
-                  '2008-04-08'
-               TOK_PARTVAL
-                  hr
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-         TOK_SELEXPR
-            TOK_FUNCTION
-               if
-               ==
-                  %
-                     TOK_TABLE_OR_COL
-                        key
-                     100
-                  0
-               'a1'
-               'b1'
-      TOK_WHERE
-         =
-            TOK_TABLE_OR_COL
-               ds
-            '2008-04-08'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-7 depends on stages: Stage-1 , consists of Stage-4, Stage-3, Stage-5
@@ -942,32 +856,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select * from list_bucketing_dynamic_part where key = '484' and value = 'val_484'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            list_bucketing_dynamic_part
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         and
-            =
-               TOK_TABLE_OR_COL
-                  key
-               '484'
-            =
-               TOK_TABLE_OR_COL
-                  value
-               'val_484'
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
diff --git a/ql/src/test/results/clientpositive/list_bucket_dml_7.q.out b/ql/src/test/results/clientpositive/list_bucket_dml_7.q.out
index 3aa9003bef..b8757deda0 100644
--- a/ql/src/test/results/clientpositive/list_bucket_dml_7.q.out
+++ b/ql/src/test/results/clientpositive/list_bucket_dml_7.q.out
@@ -56,49 +56,6 @@ explain extended
 insert overwrite table list_bucketing_dynamic_part partition (ds = '2008-04-08', hr)
 select key, value, if(key % 100 == 0, 'a1', 'b1') from srcpart where ds = '2008-04-08'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               list_bucketing_dynamic_part
-            TOK_PARTSPEC
-               TOK_PARTVAL
-                  ds
-                  '2008-04-08'
-               TOK_PARTVAL
-                  hr
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-         TOK_SELEXPR
-            TOK_FUNCTION
-               if
-               ==
-                  %
-                     TOK_TABLE_OR_COL
-                        key
-                     100
-                  0
-               'a1'
-               'b1'
-      TOK_WHERE
-         =
-            TOK_TABLE_OR_COL
-               ds
-            '2008-04-08'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -402,49 +359,6 @@ explain extended
 insert overwrite table list_bucketing_dynamic_part partition (ds = '2008-04-08', hr)
 select key, value, if(key % 100 == 0, 'a1', 'b1') from srcpart where ds = '2008-04-08'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               list_bucketing_dynamic_part
-            TOK_PARTSPEC
-               TOK_PARTVAL
-                  ds
-                  '2008-04-08'
-               TOK_PARTVAL
-                  hr
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-         TOK_SELEXPR
-            TOK_FUNCTION
-               if
-               ==
-                  %
-                     TOK_TABLE_OR_COL
-                        key
-                     100
-                  0
-               'a1'
-               'b1'
-      TOK_WHERE
-         =
-            TOK_TABLE_OR_COL
-               ds
-            '2008-04-08'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-7 depends on stages: Stage-1 , consists of Stage-4, Stage-3, Stage-5
@@ -888,32 +802,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select * from list_bucketing_dynamic_part where key = '484' and value = 'val_484'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            list_bucketing_dynamic_part
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         and
-            =
-               TOK_TABLE_OR_COL
-                  key
-               '484'
-            =
-               TOK_TABLE_OR_COL
-                  value
-               'val_484'
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
diff --git a/ql/src/test/results/clientpositive/list_bucket_dml_8.q.java1.7.out b/ql/src/test/results/clientpositive/list_bucket_dml_8.q.java1.7.out
index 672e5ac4b1..d40a693402 100644
--- a/ql/src/test/results/clientpositive/list_bucket_dml_8.q.java1.7.out
+++ b/ql/src/test/results/clientpositive/list_bucket_dml_8.q.java1.7.out
@@ -112,49 +112,6 @@ explain extended
 insert overwrite table list_bucketing_dynamic_part partition (ds = '2008-04-08', hr)
 select key, value, if(key % 100 == 0, 'a1', 'b1') from srcpart where ds = '2008-04-08'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               list_bucketing_dynamic_part
-            TOK_PARTSPEC
-               TOK_PARTVAL
-                  ds
-                  '2008-04-08'
-               TOK_PARTVAL
-                  hr
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-         TOK_SELEXPR
-            TOK_FUNCTION
-               if
-               ==
-                  %
-                     TOK_TABLE_OR_COL
-                        key
-                     100
-                  0
-               'a1'
-               'b1'
-      TOK_WHERE
-         =
-            TOK_TABLE_OR_COL
-               ds
-            '2008-04-08'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -532,32 +489,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select * from list_bucketing_dynamic_part where key = '484' and value = 'val_484'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            list_bucketing_dynamic_part
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         and
-            =
-               TOK_TABLE_OR_COL
-                  key
-               '484'
-            =
-               TOK_TABLE_OR_COL
-                  value
-               'val_484'
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
diff --git a/ql/src/test/results/clientpositive/list_bucket_dml_9.q.java1.7.out b/ql/src/test/results/clientpositive/list_bucket_dml_9.q.java1.7.out
index 7179f618e5..752ea4e47e 100644
--- a/ql/src/test/results/clientpositive/list_bucket_dml_9.q.java1.7.out
+++ b/ql/src/test/results/clientpositive/list_bucket_dml_9.q.java1.7.out
@@ -64,39 +64,6 @@ explain extended
 insert overwrite table list_bucketing_static_part partition (ds = '2008-04-08',  hr = '11')
 select key, value from srcpart where ds = '2008-04-08'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               list_bucketing_static_part
-            TOK_PARTSPEC
-               TOK_PARTVAL
-                  ds
-                  '2008-04-08'
-               TOK_PARTVAL
-                  hr
-                  '11'
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-      TOK_WHERE
-         =
-            TOK_TABLE_OR_COL
-               ds
-            '2008-04-08'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -353,39 +320,6 @@ explain extended
 insert overwrite table list_bucketing_static_part partition (ds = '2008-04-08',  hr = '11')
 select key, value from srcpart where ds = '2008-04-08'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               list_bucketing_static_part
-            TOK_PARTSPEC
-               TOK_PARTVAL
-                  ds
-                  '2008-04-08'
-               TOK_PARTVAL
-                  hr
-                  '11'
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-      TOK_WHERE
-         =
-            TOK_TABLE_OR_COL
-               ds
-            '2008-04-08'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-7 depends on stages: Stage-1 , consists of Stage-4, Stage-3, Stage-5
@@ -774,42 +708,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select * from list_bucketing_static_part where ds = '2008-04-08' and  hr = '11' and key = '484' and value = 'val_484'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            list_bucketing_static_part
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         and
-            and
-               and
-                  =
-                     TOK_TABLE_OR_COL
-                        ds
-                     '2008-04-08'
-                  =
-                     TOK_TABLE_OR_COL
-                        hr
-                     '11'
-               =
-                  TOK_TABLE_OR_COL
-                     key
-                  '484'
-            =
-               TOK_TABLE_OR_COL
-                  value
-               'val_484'
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
diff --git a/ql/src/test/results/clientpositive/list_bucket_query_multiskew_1.q.out b/ql/src/test/results/clientpositive/list_bucket_query_multiskew_1.q.out
index 1d8ec8b2f5..492866a94a 100644
--- a/ql/src/test/results/clientpositive/list_bucket_query_multiskew_1.q.out
+++ b/ql/src/test/results/clientpositive/list_bucket_query_multiskew_1.q.out
@@ -116,43 +116,6 @@ POSTHOOK: query: -- pruner only pick up skewed-value directory
 -- explain plan shows which directory selected: Truncated Path -> Alias
 explain extended SELECT key FROM fact_daily WHERE ( ds='1' and hr='4') and (key='484' and value= 'val_484')
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            fact_daily
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-      TOK_WHERE
-         and
-            and
-               =
-                  TOK_TABLE_OR_COL
-                     ds
-                  '1'
-               =
-                  TOK_TABLE_OR_COL
-                     hr
-                  '4'
-            and
-               =
-                  TOK_TABLE_OR_COL
-                     key
-                  '484'
-               =
-                  TOK_TABLE_OR_COL
-                     value
-                  'val_484'
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
@@ -241,46 +204,6 @@ POSTHOOK: query: -- pruner only pick up skewed-value directory
 -- explain plan shows which directory selected: Truncated Path -> Alias
 explain extended SELECT key,value FROM fact_daily WHERE ( ds='1' and hr='4') and (key='238' and value= 'val_238')
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            fact_daily
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-      TOK_WHERE
-         and
-            and
-               =
-                  TOK_TABLE_OR_COL
-                     ds
-                  '1'
-               =
-                  TOK_TABLE_OR_COL
-                     hr
-                  '4'
-            and
-               =
-                  TOK_TABLE_OR_COL
-                     key
-                  '238'
-               =
-                  TOK_TABLE_OR_COL
-                     value
-                  'val_238'
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
@@ -370,38 +293,6 @@ POSTHOOK: query: -- pruner only pick up default directory
 -- explain plan shows which directory selected: Truncated Path -> Alias
 explain extended SELECT key FROM fact_daily WHERE ( ds='1' and hr='4') and (value = "3")
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            fact_daily
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-      TOK_WHERE
-         and
-            and
-               =
-                  TOK_TABLE_OR_COL
-                     ds
-                  '1'
-               =
-                  TOK_TABLE_OR_COL
-                     hr
-                  '4'
-            =
-               TOK_TABLE_OR_COL
-                  value
-               "3"
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
@@ -489,41 +380,6 @@ POSTHOOK: query: -- pruner only pick up default directory
 -- explain plan shows which directory selected: Truncated Path -> Alias
 explain extended SELECT key,value FROM fact_daily WHERE ( ds='1' and hr='4') and key = '495'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            fact_daily
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-      TOK_WHERE
-         and
-            and
-               =
-                  TOK_TABLE_OR_COL
-                     ds
-                  '1'
-               =
-                  TOK_TABLE_OR_COL
-                     hr
-                  '4'
-            =
-               TOK_TABLE_OR_COL
-                  key
-               '495'
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
diff --git a/ql/src/test/results/clientpositive/list_bucket_query_multiskew_2.q.out b/ql/src/test/results/clientpositive/list_bucket_query_multiskew_2.q.out
index 83576f10d1..cfb613aa69 100644
--- a/ql/src/test/results/clientpositive/list_bucket_query_multiskew_2.q.out
+++ b/ql/src/test/results/clientpositive/list_bucket_query_multiskew_2.q.out
@@ -116,41 +116,6 @@ POSTHOOK: query: -- pruner only pick up default directory
 -- explain plan shows which directory selected: Truncated Path -> Alias
 explain extended SELECT key, value FROM fact_daily WHERE ds='1' and hr='4' and value= 'val_484'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            fact_daily
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-      TOK_WHERE
-         and
-            and
-               =
-                  TOK_TABLE_OR_COL
-                     ds
-                  '1'
-               =
-                  TOK_TABLE_OR_COL
-                     hr
-                  '4'
-            =
-               TOK_TABLE_OR_COL
-                  value
-               'val_484'
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
@@ -239,38 +204,6 @@ POSTHOOK: query: -- pruner only pick up default directory
 -- explain plan shows which directory selected: Truncated Path -> Alias
 explain extended SELECT key FROM fact_daily WHERE ds='1' and hr='4' and key= '406'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            fact_daily
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-      TOK_WHERE
-         and
-            and
-               =
-                  TOK_TABLE_OR_COL
-                     ds
-                  '1'
-               =
-                  TOK_TABLE_OR_COL
-                     hr
-                  '4'
-            =
-               TOK_TABLE_OR_COL
-                  key
-               '406'
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
@@ -362,56 +295,6 @@ POSTHOOK: query: -- pruner only pick up skewed-value directory
 -- explain plan shows which directory selected: Truncated Path -> Alias
 explain extended SELECT key, value FROM fact_daily WHERE ds='1' and hr='4' and ( (key='484' and value ='val_484')  or (key='238' and value= 'val_238'))
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            fact_daily
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-      TOK_WHERE
-         and
-            and
-               =
-                  TOK_TABLE_OR_COL
-                     ds
-                  '1'
-               =
-                  TOK_TABLE_OR_COL
-                     hr
-                  '4'
-            or
-               and
-                  =
-                     TOK_TABLE_OR_COL
-                        key
-                     '484'
-                  =
-                     TOK_TABLE_OR_COL
-                        value
-                     'val_484'
-               and
-                  =
-                     TOK_TABLE_OR_COL
-                        key
-                     '238'
-                  =
-                     TOK_TABLE_OR_COL
-                        value
-                     'val_238'
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
diff --git a/ql/src/test/results/clientpositive/list_bucket_query_multiskew_3.q.out b/ql/src/test/results/clientpositive/list_bucket_query_multiskew_3.q.out
index 2e772451bf..6a5f8f5da1 100644
--- a/ql/src/test/results/clientpositive/list_bucket_query_multiskew_3.q.out
+++ b/ql/src/test/results/clientpositive/list_bucket_query_multiskew_3.q.out
@@ -234,37 +234,6 @@ POSTHOOK: query: -- query non-skewed partition
 explain extended
 select * from fact_daily where ds = '1' and  hr='1' and key='145'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            fact_daily
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         and
-            and
-               =
-                  TOK_TABLE_OR_COL
-                     ds
-                  '1'
-               =
-                  TOK_TABLE_OR_COL
-                     hr
-                  '1'
-            =
-               TOK_TABLE_OR_COL
-                  key
-               '145'
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
@@ -349,33 +318,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select count(*) from fact_daily where ds = '1' and  hr='1'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            fact_daily
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-      TOK_WHERE
-         and
-            =
-               TOK_TABLE_OR_COL
-                  ds
-               '1'
-            =
-               TOK_TABLE_OR_COL
-                  hr
-               '1'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -508,42 +450,6 @@ POSTHOOK: query: -- query skewed partition
 explain extended
 SELECT * FROM fact_daily WHERE ds='1' and hr='2' and (key='484' and value='val_484')
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            fact_daily
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         and
-            and
-               =
-                  TOK_TABLE_OR_COL
-                     ds
-                  '1'
-               =
-                  TOK_TABLE_OR_COL
-                     hr
-                  '2'
-            and
-               =
-                  TOK_TABLE_OR_COL
-                     key
-                  '484'
-               =
-                  TOK_TABLE_OR_COL
-                     value
-                  'val_484'
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
@@ -630,42 +536,6 @@ POSTHOOK: query: -- query another skewed partition
 explain extended
 SELECT * FROM fact_daily WHERE ds='1' and hr='3' and (key='327' and value='val_327')
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            fact_daily
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         and
-            and
-               =
-                  TOK_TABLE_OR_COL
-                     ds
-                  '1'
-               =
-                  TOK_TABLE_OR_COL
-                     hr
-                  '3'
-            and
-               =
-                  TOK_TABLE_OR_COL
-                     key
-                  '327'
-               =
-                  TOK_TABLE_OR_COL
-                     value
-                  'val_327'
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
diff --git a/ql/src/test/results/clientpositive/list_bucket_query_oneskew_1.q.out b/ql/src/test/results/clientpositive/list_bucket_query_oneskew_1.q.out
index 1895ab0328..6a9b4a18d4 100644
--- a/ql/src/test/results/clientpositive/list_bucket_query_oneskew_1.q.out
+++ b/ql/src/test/results/clientpositive/list_bucket_query_oneskew_1.q.out
@@ -176,33 +176,6 @@ POSTHOOK: query: -- pruner only pick up skewed-value directory
 -- explain plan shows which directory selected: Truncated Path -> Alias
 explain extended SELECT x FROM fact_daily WHERE ds='1' and x=484
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            fact_daily
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               x
-      TOK_WHERE
-         and
-            =
-               TOK_TABLE_OR_COL
-                  ds
-               '1'
-            =
-               TOK_TABLE_OR_COL
-                  x
-               484
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
@@ -288,33 +261,6 @@ POSTHOOK: query: -- pruner only pick up default directory since x equal to non-s
 -- explain plan shows which directory selected: Truncated Path -> Alias
 explain extended SELECT x FROM fact_daily WHERE ds='1' and x=495
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            fact_daily
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               x
-      TOK_WHERE
-         and
-            =
-               TOK_TABLE_OR_COL
-                  ds
-               '1'
-            =
-               TOK_TABLE_OR_COL
-                  x
-               495
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
@@ -396,33 +342,6 @@ PREHOOK: query: explain extended SELECT x FROM fact_daily WHERE ds='1' and x=1
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended SELECT x FROM fact_daily WHERE ds='1' and x=1
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            fact_daily
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               x
-      TOK_WHERE
-         and
-            =
-               TOK_TABLE_OR_COL
-                  ds
-               '1'
-            =
-               TOK_TABLE_OR_COL
-                  x
-               1
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
diff --git a/ql/src/test/results/clientpositive/list_bucket_query_oneskew_2.q.out b/ql/src/test/results/clientpositive/list_bucket_query_oneskew_2.q.out
index 135f5e1aa6..8517a5247f 100644
--- a/ql/src/test/results/clientpositive/list_bucket_query_oneskew_2.q.out
+++ b/ql/src/test/results/clientpositive/list_bucket_query_oneskew_2.q.out
@@ -181,45 +181,6 @@ POSTHOOK: query: -- The first subquery
 -- explain plan shows which directory selected: Truncated Path -> Alias
 explain extended select x from (select x from fact_daily where ds = '1') subq where x = 484
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_QUERY
-            TOK_FROM
-               TOK_TABREF
-                  TOK_TABNAME
-                     fact_daily
-            TOK_INSERT
-               TOK_DESTINATION
-                  TOK_DIR
-                     TOK_TMP_FILE
-               TOK_SELECT
-                  TOK_SELEXPR
-                     TOK_TABLE_OR_COL
-                        x
-               TOK_WHERE
-                  =
-                     TOK_TABLE_OR_COL
-                        ds
-                     '1'
-         subq
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               x
-      TOK_WHERE
-         =
-            TOK_TABLE_OR_COL
-               x
-            484
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
@@ -305,53 +266,6 @@ POSTHOOK: query: -- The second subquery
 -- explain plan shows which directory selected: Truncated Path -> Alias
 explain extended select x1, y1 from(select x as x1, y as y1 from fact_daily where ds ='1') subq where x1 = 484
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_QUERY
-            TOK_FROM
-               TOK_TABREF
-                  TOK_TABNAME
-                     fact_daily
-            TOK_INSERT
-               TOK_DESTINATION
-                  TOK_DIR
-                     TOK_TMP_FILE
-               TOK_SELECT
-                  TOK_SELEXPR
-                     TOK_TABLE_OR_COL
-                        x
-                     x1
-                  TOK_SELEXPR
-                     TOK_TABLE_OR_COL
-                        y
-                     y1
-               TOK_WHERE
-                  =
-                     TOK_TABLE_OR_COL
-                        ds
-                     '1'
-         subq
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               x1
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               y1
-      TOK_WHERE
-         =
-            TOK_TABLE_OR_COL
-               x1
-            484
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
@@ -437,40 +351,6 @@ POSTHOOK: query: -- The third subquery
 -- explain plan shows which directory selected: Truncated Path -> Alias
 explain extended  select y, count(1) from fact_daily where ds ='1' and x = 484 group by y
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            fact_daily
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               y
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_WHERE
-         and
-            =
-               TOK_TABLE_OR_COL
-                  ds
-               '1'
-            =
-               TOK_TABLE_OR_COL
-                  x
-               484
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            y
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -612,56 +492,6 @@ POSTHOOK: query: -- The fourth subquery
 -- explain plan shows which directory selected: Truncated Path -> Alias
 explain extended  select x, c from (select x, count(1) as c from fact_daily where ds = '1' group by x) subq where x = 484
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_QUERY
-            TOK_FROM
-               TOK_TABREF
-                  TOK_TABNAME
-                     fact_daily
-            TOK_INSERT
-               TOK_DESTINATION
-                  TOK_DIR
-                     TOK_TMP_FILE
-               TOK_SELECT
-                  TOK_SELEXPR
-                     TOK_TABLE_OR_COL
-                        x
-                  TOK_SELEXPR
-                     TOK_FUNCTION
-                        count
-                        1
-                     c
-               TOK_WHERE
-                  =
-                     TOK_TABLE_OR_COL
-                        ds
-                     '1'
-               TOK_GROUPBY
-                  TOK_TABLE_OR_COL
-                     x
-         subq
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               x
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               c
-      TOK_WHERE
-         =
-            TOK_TABLE_OR_COL
-               x
-            484
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/list_bucket_query_oneskew_3.q.out b/ql/src/test/results/clientpositive/list_bucket_query_oneskew_3.q.out
index 3a4030579d..0c6fb63317 100644
--- a/ql/src/test/results/clientpositive/list_bucket_query_oneskew_3.q.out
+++ b/ql/src/test/results/clientpositive/list_bucket_query_oneskew_3.q.out
@@ -203,34 +203,6 @@ POSTHOOK: query: -- pruner  pick up right directory
 -- explain plan shows which directory selected: Truncated Path -> Alias
 explain extended SELECT x FROM fact_daily WHERE ds='1' and not (x = 86)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            fact_daily
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               x
-      TOK_WHERE
-         and
-            =
-               TOK_TABLE_OR_COL
-                  ds
-               '1'
-            not
-               =
-                  TOK_TABLE_OR_COL
-                     x
-                  86
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
diff --git a/ql/src/test/results/clientpositive/llap/llap_nullscan.q.out b/ql/src/test/results/clientpositive/llap/llap_nullscan.q.out
index e17d7213c0..c755268132 100644
--- a/ql/src/test/results/clientpositive/llap/llap_nullscan.q.out
+++ b/ql/src/test/results/clientpositive/llap/llap_nullscan.q.out
@@ -30,26 +30,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select * from src_orc where 1=2
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            src_orc
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         =
-            1
-            2
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/llap/tez_join_result_complex.q.out b/ql/src/test/results/clientpositive/llap/tez_join_result_complex.q.out
index 440466cc80..6ca9ea6c20 100644
--- a/ql/src/test/results/clientpositive/llap/tez_join_result_complex.q.out
+++ b/ql/src/test/results/clientpositive/llap/tez_join_result_complex.q.out
@@ -148,271 +148,6 @@ inner join
 service_request_clean b
 on a.contact_event_id = b.cnctevn_id
 POSTHOOK: type: CREATETABLE_AS_SELECT
-ABSTRACT SYNTAX TREE:
-  
-TOK_CREATETABLE
-   TOK_TABNAME
-      ct_events1_test
-   TOK_LIKETABLE
-   TOK_QUERY
-      TOK_FROM
-         TOK_JOIN
-            TOK_SUBQUERY
-               TOK_QUERY
-                  TOK_FROM
-                     TOK_TABREF
-                        TOK_TABNAME
-                           default
-                           ct_events_clean
-                        a
-                  TOK_INSERT
-                     TOK_DESTINATION
-                        TOK_DIR
-                           TOK_TMP_FILE
-                     TOK_SELECT
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 a
-                              contact_event_id
-                           contact_event_id
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 a
-                              ce_create_dt
-                           ce_create_dt
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 a
-                              ce_end_dt
-                           ce_end_dt
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 a
-                              contact_type
-                           contact_type
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 a
-                              cnctevs_cd
-                           cnctevs_cd
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 a
-                              contact_mode
-                           contact_mode
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 a
-                              cntvnst_stts_cd
-                           cntvnst_stts_cd
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 a
-                              total_transfers
-                           total_transfers
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 a
-                              ce_notes
-                           ce_notes
-                     TOK_WHERE
-                        TOK_FUNCTION
-                           TOK_ISNOTNULL
-                           .
-                              TOK_TABLE_OR_COL
-                                 a
-                              contact_event_id
-               $hdt$_0
-            TOK_SUBQUERY
-               TOK_QUERY
-                  TOK_FROM
-                     TOK_TABREF
-                        TOK_TABNAME
-                           default
-                           service_request_clean
-                        b
-                  TOK_INSERT
-                     TOK_DESTINATION
-                        TOK_DIR
-                           TOK_TMP_FILE
-                     TOK_SELECT
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 b
-                              cnctevn_id
-                           cnctevn_id
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 b
-                              svcrqst_id
-                           svcrqst_id
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 b
-                              cnctmd_cd
-                           cnctmd_cd
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 b
-                              svcrtyp_cd
-                           svcrtyp_cd
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 b
-                              cmpltyp_cd
-                           cmpltyp_cd
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 b
-                              sum_reason_cd
-                           sum_reason_cd
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 b
-                              svcrqct_cds
-                           svcrqct_cds
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 b
-                              notes
-                           notes
-                     TOK_WHERE
-                        TOK_FUNCTION
-                           TOK_ISNOTNULL
-                           .
-                              TOK_TABLE_OR_COL
-                                 b
-                              cnctevn_id
-               $hdt$_1
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_0
-                  contact_event_id
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_1
-                  cnctevn_id
-      TOK_INSERT
-         TOK_DESTINATION
-            TOK_DIR
-               TOK_TMP_FILE
-         TOK_SELECT
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_0
-                  contact_event_id
-               a.contact_event_id
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_0
-                  ce_create_dt
-               a.ce_create_dt
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_0
-                  ce_end_dt
-               a.ce_end_dt
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_0
-                  contact_type
-               a.contact_type
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_0
-                  cnctevs_cd
-               a.cnctevs_cd
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_0
-                  contact_mode
-               a.contact_mode
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_0
-                  cntvnst_stts_cd
-               a.cntvnst_stts_cd
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_0
-                  total_transfers
-               a.total_transfers
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_0
-                  ce_notes
-               a.ce_notes
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_1
-                  svcrqst_id
-               b.svcrqst_id
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_1
-                  svcrqct_cds
-               b.svcrqct_cds
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_1
-                  svcrtyp_cd
-               b.svcrtyp_cd
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_1
-                  cmpltyp_cd
-               b.cmpltyp_cd
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_1
-                  sum_reason_cd
-               src
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_1
-                  cnctmd_cd
-               b.cnctmd_cd
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_1
-                  notes
-               b.notes
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -1389,271 +1124,6 @@ inner join
 service_request_clean b
 on a.contact_event_id = b.cnctevn_id
 POSTHOOK: type: CREATETABLE_AS_SELECT
-ABSTRACT SYNTAX TREE:
-  
-TOK_CREATETABLE
-   TOK_TABNAME
-      ct_events1_test
-   TOK_LIKETABLE
-   TOK_QUERY
-      TOK_FROM
-         TOK_JOIN
-            TOK_SUBQUERY
-               TOK_QUERY
-                  TOK_FROM
-                     TOK_TABREF
-                        TOK_TABNAME
-                           default
-                           ct_events_clean
-                        a
-                  TOK_INSERT
-                     TOK_DESTINATION
-                        TOK_DIR
-                           TOK_TMP_FILE
-                     TOK_SELECT
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 a
-                              contact_event_id
-                           contact_event_id
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 a
-                              ce_create_dt
-                           ce_create_dt
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 a
-                              ce_end_dt
-                           ce_end_dt
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 a
-                              contact_type
-                           contact_type
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 a
-                              cnctevs_cd
-                           cnctevs_cd
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 a
-                              contact_mode
-                           contact_mode
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 a
-                              cntvnst_stts_cd
-                           cntvnst_stts_cd
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 a
-                              total_transfers
-                           total_transfers
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 a
-                              ce_notes
-                           ce_notes
-                     TOK_WHERE
-                        TOK_FUNCTION
-                           TOK_ISNOTNULL
-                           .
-                              TOK_TABLE_OR_COL
-                                 a
-                              contact_event_id
-               $hdt$_0
-            TOK_SUBQUERY
-               TOK_QUERY
-                  TOK_FROM
-                     TOK_TABREF
-                        TOK_TABNAME
-                           default
-                           service_request_clean
-                        b
-                  TOK_INSERT
-                     TOK_DESTINATION
-                        TOK_DIR
-                           TOK_TMP_FILE
-                     TOK_SELECT
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 b
-                              cnctevn_id
-                           cnctevn_id
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 b
-                              svcrqst_id
-                           svcrqst_id
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 b
-                              cnctmd_cd
-                           cnctmd_cd
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 b
-                              svcrtyp_cd
-                           svcrtyp_cd
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 b
-                              cmpltyp_cd
-                           cmpltyp_cd
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 b
-                              sum_reason_cd
-                           sum_reason_cd
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 b
-                              svcrqct_cds
-                           svcrqct_cds
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 b
-                              notes
-                           notes
-                     TOK_WHERE
-                        TOK_FUNCTION
-                           TOK_ISNOTNULL
-                           .
-                              TOK_TABLE_OR_COL
-                                 b
-                              cnctevn_id
-               $hdt$_1
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_0
-                  contact_event_id
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_1
-                  cnctevn_id
-      TOK_INSERT
-         TOK_DESTINATION
-            TOK_DIR
-               TOK_TMP_FILE
-         TOK_SELECT
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_0
-                  contact_event_id
-               a.contact_event_id
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_0
-                  ce_create_dt
-               a.ce_create_dt
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_0
-                  ce_end_dt
-               a.ce_end_dt
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_0
-                  contact_type
-               a.contact_type
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_0
-                  cnctevs_cd
-               a.cnctevs_cd
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_0
-                  contact_mode
-               a.contact_mode
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_0
-                  cntvnst_stts_cd
-               a.cntvnst_stts_cd
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_0
-                  total_transfers
-               a.total_transfers
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_0
-                  ce_notes
-               a.ce_notes
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_1
-                  svcrqst_id
-               b.svcrqst_id
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_1
-                  svcrqct_cds
-               b.svcrqct_cds
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_1
-                  svcrtyp_cd
-               b.svcrtyp_cd
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_1
-                  cmpltyp_cd
-               b.cmpltyp_cd
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_1
-                  sum_reason_cd
-               src
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_1
-                  cnctmd_cd
-               b.cnctmd_cd
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_1
-                  notes
-               b.notes
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/load_dyn_part8.q.out b/ql/src/test/results/clientpositive/load_dyn_part8.q.out
index 84ccb7587c..757e7dd4c8 100644
--- a/ql/src/test/results/clientpositive/load_dyn_part8.q.out
+++ b/ql/src/test/results/clientpositive/load_dyn_part8.q.out
@@ -48,69 +48,6 @@ from srcpart
 insert overwrite table nzhang_part8 partition (ds, hr) select key, value, ds, hr where ds <= '2008-04-08'
 insert overwrite table nzhang_part8 partition(ds='2008-12-31', hr) select key, value, hr where ds > '2008-04-08'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               nzhang_part8
-            TOK_PARTSPEC
-               TOK_PARTVAL
-                  ds
-               TOK_PARTVAL
-                  hr
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               hr
-      TOK_WHERE
-         <=
-            TOK_TABLE_OR_COL
-               ds
-            '2008-04-08'
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               nzhang_part8
-            TOK_PARTSPEC
-               TOK_PARTVAL
-                  ds
-                  '2008-12-31'
-               TOK_PARTVAL
-                  hr
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               hr
-      TOK_WHERE
-         >
-            TOK_TABLE_OR_COL
-               ds
-            '2008-04-08'
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-0 depends on stages: Stage-2
diff --git a/ql/src/test/results/clientpositive/louter_join_ppr.q.out b/ql/src/test/results/clientpositive/louter_join_ppr.q.out
index d994b95d67..fd127ec679 100644
--- a/ql/src/test/results/clientpositive/louter_join_ppr.q.out
+++ b/ql/src/test/results/clientpositive/louter_join_ppr.q.out
@@ -20,90 +20,6 @@ EXPLAIN EXTENDED
  SELECT a.key, a.value, b.key, b.value
  WHERE a.key > 10 AND a.key < 20 AND b.key > 15 AND b.key < 25
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_LEFTOUTERJOIN
-         TOK_TABREF
-            TOK_TABNAME
-               src
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcpart
-            b
-         AND
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  ds
-               '2008-04-08'
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-      TOK_WHERE
-         AND
-            AND
-               AND
-                  >
-                     .
-                        TOK_TABLE_OR_COL
-                           a
-                        key
-                     10
-                  <
-                     .
-                        TOK_TABLE_OR_COL
-                           a
-                        key
-                     20
-               >
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-                  15
-            <
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-               25
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -396,90 +312,6 @@ POSTHOOK: query: EXPLAIN EXTENDED
  SELECT a.key, a.value, b.key, b.value
  WHERE a.key > 10 AND a.key < 20 AND b.key > 15 AND b.key < 25
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_LEFTOUTERJOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcpart
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               src
-            b
-         AND
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  ds
-               '2008-04-08'
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-      TOK_WHERE
-         AND
-            AND
-               AND
-                  >
-                     .
-                        TOK_TABLE_OR_COL
-                           a
-                        key
-                     10
-                  <
-                     .
-                        TOK_TABLE_OR_COL
-                           a
-                        key
-                     20
-               >
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-                  15
-            <
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-               25
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -879,90 +711,6 @@ POSTHOOK: query: EXPLAIN EXTENDED
  SELECT a.key, a.value, b.key, b.value
  WHERE a.key > 10 AND a.key < 20 AND b.key > 15 AND b.key < 25 AND b.ds = '2008-04-08'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_LEFTOUTERJOIN
-         TOK_TABREF
-            TOK_TABNAME
-               src
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcpart
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-      TOK_WHERE
-         AND
-            AND
-               AND
-                  AND
-                     >
-                        .
-                           TOK_TABLE_OR_COL
-                              a
-                           key
-                        10
-                     <
-                        .
-                           TOK_TABLE_OR_COL
-                              a
-                           key
-                        20
-                  >
-                     .
-                        TOK_TABLE_OR_COL
-                           b
-                        key
-                     15
-               <
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-                  25
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  ds
-               '2008-04-08'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1251,90 +999,6 @@ POSTHOOK: query: EXPLAIN EXTENDED
  SELECT a.key, a.value, b.key, b.value
  WHERE a.key > 10 AND a.key < 20 AND b.key > 15 AND b.key < 25 AND a.ds = '2008-04-08'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_LEFTOUTERJOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcpart
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               src
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-      TOK_WHERE
-         AND
-            AND
-               AND
-                  AND
-                     >
-                        .
-                           TOK_TABLE_OR_COL
-                              a
-                           key
-                        10
-                     <
-                        .
-                           TOK_TABLE_OR_COL
-                              a
-                           key
-                        20
-                  >
-                     .
-                        TOK_TABLE_OR_COL
-                           b
-                        key
-                     15
-               <
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-                  25
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  ds
-               '2008-04-08'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/macro.q.out b/ql/src/test/results/clientpositive/macro.q.out
index 76ea250174..35e03caac4 100644
--- a/ql/src/test/results/clientpositive/macro.q.out
+++ b/ql/src/test/results/clientpositive/macro.q.out
@@ -41,26 +41,6 @@ PREHOOK: query: EXPLAIN EXTENDED SELECT SIGMOID(2) FROM src LIMIT 1
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN EXTENDED SELECT SIGMOID(2) FROM src LIMIT 1
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            src
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTION
-               SIGMOID
-               2
-      TOK_LIMIT
-         1
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
@@ -131,27 +111,6 @@ PREHOOK: query: EXPLAIN EXTENDED SELECT FIXED_NUMBER() + 1 FROM src LIMIT 1
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN EXTENDED SELECT FIXED_NUMBER() + 1 FROM src LIMIT 1
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            src
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            +
-               TOK_FUNCTION
-                  FIXED_NUMBER
-               1
-      TOK_LIMIT
-         1
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
@@ -249,27 +208,6 @@ PREHOOK: query: EXPLAIN EXTENDED SELECT SIMPLE_ADD(1, 9) FROM src LIMIT 1
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN EXTENDED SELECT SIMPLE_ADD(1, 9) FROM src LIMIT 1
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            src
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTION
-               SIMPLE_ADD
-               1
-               9
-      TOK_LIMIT
-         1
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
diff --git a/ql/src/test/results/clientpositive/mapjoin_mapjoin.q.out b/ql/src/test/results/clientpositive/mapjoin_mapjoin.q.out
index a32986c1e3..85bd14be0f 100644
--- a/ql/src/test/results/clientpositive/mapjoin_mapjoin.q.out
+++ b/ql/src/test/results/clientpositive/mapjoin_mapjoin.q.out
@@ -10,51 +10,6 @@ POSTHOOK: query: -- Since the inputs are small, it should be automatically conve
 
 explain extended select srcpart.key from srcpart join src on (srcpart.value=src.value) join src1 on (srcpart.key=src1.key)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_JOIN
-            TOK_TABREF
-               TOK_TABNAME
-                  srcpart
-            TOK_TABREF
-               TOK_TABNAME
-                  src
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     srcpart
-                  value
-               .
-                  TOK_TABLE_OR_COL
-                     src
-                  value
-         TOK_TABREF
-            TOK_TABNAME
-               src1
-         =
-            .
-               TOK_TABLE_OR_COL
-                  srcpart
-               key
-            .
-               TOK_TABLE_OR_COL
-                  src1
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  srcpart
-               key
-
-
 STAGE DEPENDENCIES:
   Stage-7 is a root stage
   Stage-5 depends on stages: Stage-7
diff --git a/ql/src/test/results/clientpositive/merge3.q.out b/ql/src/test/results/clientpositive/merge3.q.out
index 5b581dbdeb..7f879db92b 100644
--- a/ql/src/test/results/clientpositive/merge3.q.out
+++ b/ql/src/test/results/clientpositive/merge3.q.out
@@ -61,38 +61,6 @@ POSTHOOK: query: explain extended
 create table merge_src2 as 
 select key, value from merge_src
 POSTHOOK: type: CREATETABLE_AS_SELECT
-ABSTRACT SYNTAX TREE:
-  
-TOK_CREATETABLE
-   TOK_TABNAME
-      merge_src2
-   TOK_LIKETABLE
-   TOK_QUERY
-      TOK_FROM
-         TOK_TABREF
-            TOK_TABNAME
-               default
-               merge_src
-            merge_src
-      TOK_INSERT
-         TOK_DESTINATION
-            TOK_DIR
-               TOK_TMP_FILE
-         TOK_SELECT
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     merge_src
-                  key
-               key
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     merge_src
-                  value
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-7 depends on stages: Stage-1 , consists of Stage-4, Stage-3, Stage-5
@@ -2404,38 +2372,6 @@ insert overwrite table merge_src_part2 partition(ds)
 select key, value, ds from merge_src_part
 where ds is not null
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            merge_src_part
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               merge_src_part2
-            TOK_PARTSPEC
-               TOK_PARTVAL
-                  ds
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds
-      TOK_WHERE
-         TOK_FUNCTION
-            TOK_ISNOTNULL
-            TOK_TABLE_OR_COL
-               ds
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-7 depends on stages: Stage-1 , consists of Stage-4, Stage-3, Stage-5
@@ -4845,52 +4781,6 @@ from (select * from merge_src_part where ds is not null distribute by ds) s
 insert overwrite table merge_src_part2 partition(ds)
 select key, value, ds
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_QUERY
-            TOK_FROM
-               TOK_TABREF
-                  TOK_TABNAME
-                     merge_src_part
-            TOK_INSERT
-               TOK_DESTINATION
-                  TOK_DIR
-                     TOK_TMP_FILE
-               TOK_SELECT
-                  TOK_SELEXPR
-                     TOK_ALLCOLREF
-               TOK_WHERE
-                  TOK_FUNCTION
-                     TOK_ISNOTNULL
-                     TOK_TABLE_OR_COL
-                        ds
-               TOK_DISTRIBUTEBY
-                  TOK_TABLE_OR_COL
-                     ds
-         s
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               merge_src_part2
-            TOK_PARTSPEC
-               TOK_PARTVAL
-                  ds
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-7 depends on stages: Stage-1 , consists of Stage-4, Stage-3, Stage-5
diff --git a/ql/src/test/results/clientpositive/metadataonly1.q.out b/ql/src/test/results/clientpositive/metadataonly1.q.out
index d6d86bbdcd..0281407537 100644
--- a/ql/src/test/results/clientpositive/metadataonly1.q.out
+++ b/ql/src/test/results/clientpositive/metadataonly1.q.out
@@ -10,25 +10,6 @@ PREHOOK: query: explain extended select max(ds) from TEST1
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select max(ds) from TEST1
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            TEST1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTION
-               max
-               TOK_TABLE_OR_COL
-                  ds
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -113,25 +94,6 @@ PREHOOK: query: explain extended select max(ds) from TEST1
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select max(ds) from TEST1
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            TEST1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTION
-               max
-               TOK_TABLE_OR_COL
-                  ds
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -255,25 +217,6 @@ PREHOOK: query: explain extended select count(distinct ds) from TEST1
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select count(distinct ds) from TEST1
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            TEST1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONDI
-               count
-               TOK_TABLE_OR_COL
-                  ds
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -398,25 +341,6 @@ PREHOOK: query: explain extended select count(ds) from TEST1
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select count(ds) from TEST1
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            TEST1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               TOK_TABLE_OR_COL
-                  ds
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -550,52 +474,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended 
 select count(*) from TEST1 a2 join (select max(ds) m from TEST1) b on a2.ds=b.m
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               TEST1
-            a2
-         TOK_SUBQUERY
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        TEST1
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_FUNCTION
-                           max
-                           TOK_TABLE_OR_COL
-                              ds
-                        m
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a2
-               ds
-            .
-               TOK_TABLE_OR_COL
-                  b
-               m
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
@@ -1027,31 +905,6 @@ PREHOOK: query: explain extended select ds, count(distinct hr) from TEST2 group
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select ds, count(distinct hr) from TEST2 group by ds
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            TEST2
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds
-         TOK_SELEXPR
-            TOK_FUNCTIONDI
-               count
-               TOK_TABLE_OR_COL
-                  hr
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            ds
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1267,31 +1120,6 @@ PREHOOK: query: explain extended select ds, count(hr) from TEST2 group by ds
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select ds, count(hr) from TEST2 group by ds
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            TEST2
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               TOK_TABLE_OR_COL
-                  hr
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            ds
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1508,25 +1336,6 @@ PREHOOK: query: explain extended select max(ds) from TEST1
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select max(ds) from TEST1
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            TEST1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTION
-               max
-               TOK_TABLE_OR_COL
-                  ds
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1744,31 +1553,6 @@ PREHOOK: query: explain extended select ds, count(distinct hr) from TEST2 group
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select ds, count(distinct hr) from TEST2 group by ds
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            TEST2
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds
-         TOK_SELEXPR
-            TOK_FUNCTIONDI
-               count
-               TOK_TABLE_OR_COL
-                  hr
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            ds
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/offset_limit_global_optimizer.q.out b/ql/src/test/results/clientpositive/offset_limit_global_optimizer.q.out
index 0cd5c82e36..7d8655fc0c 100644
--- a/ql/src/test/results/clientpositive/offset_limit_global_optimizer.q.out
+++ b/ql/src/test/results/clientpositive/offset_limit_global_optimizer.q.out
@@ -4,42 +4,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN EXTENDED
 SELECT srcpart.key, substr(srcpart.value,5), ds, hr FROM srcpart LIMIT 400,10
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  srcpart
-               key
-         TOK_SELEXPR
-            TOK_FUNCTION
-               substr
-               .
-                  TOK_TABLE_OR_COL
-                     srcpart
-                  value
-               5
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               hr
-      TOK_LIMIT
-         400
-         10
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -172,42 +136,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN EXTENDED
 SELECT srcpart.key, substr(srcpart.value,5), ds, hr FROM srcpart LIMIT 490,10
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  srcpart
-               key
-         TOK_SELEXPR
-            TOK_FUNCTION
-               substr
-               .
-                  TOK_TABLE_OR_COL
-                     srcpart
-                  value
-               5
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               hr
-      TOK_LIMIT
-         490
-         10
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -481,42 +409,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN EXTENDED
 SELECT srcpart.key, substr(srcpart.value,5), ds, hr FROM srcpart LIMIT 490,20
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  srcpart
-               key
-         TOK_SELEXPR
-            TOK_FUNCTION
-               substr
-               .
-                  TOK_TABLE_OR_COL
-                     srcpart
-                  value
-               5
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               hr
-      TOK_LIMIT
-         490
-         20
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -800,42 +692,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN EXTENDED
 SELECT srcpart.key, substr(srcpart.value,5), ds, hr FROM srcpart LIMIT 490,600
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  srcpart
-               key
-         TOK_SELEXPR
-            TOK_FUNCTION
-               substr
-               .
-                  TOK_TABLE_OR_COL
-                     srcpart
-                  value
-               5
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               hr
-      TOK_LIMIT
-         490
-         600
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1699,42 +1555,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN EXTENDED
 SELECT srcpart.key, substr(srcpart.value,5), ds, hr FROM srcpart LIMIT 400,10
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  srcpart
-               key
-         TOK_SELEXPR
-            TOK_FUNCTION
-               substr
-               .
-                  TOK_TABLE_OR_COL
-                     srcpart
-                  value
-               5
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               hr
-      TOK_LIMIT
-         400
-         10
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1867,42 +1687,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN EXTENDED
 SELECT srcpart.key, substr(srcpart.value,5), ds, hr FROM srcpart LIMIT 490,10
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  srcpart
-               key
-         TOK_SELEXPR
-            TOK_FUNCTION
-               substr
-               .
-                  TOK_TABLE_OR_COL
-                     srcpart
-                  value
-               5
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               hr
-      TOK_LIMIT
-         490
-         10
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -2176,42 +1960,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN EXTENDED
 SELECT srcpart.key, substr(srcpart.value,5), ds, hr FROM srcpart LIMIT 490,20
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  srcpart
-               key
-         TOK_SELEXPR
-            TOK_FUNCTION
-               substr
-               .
-                  TOK_TABLE_OR_COL
-                     srcpart
-                  value
-               5
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               hr
-      TOK_LIMIT
-         490
-         20
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -2495,42 +2243,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN EXTENDED
 SELECT srcpart.key, substr(srcpart.value,5), ds, hr FROM srcpart LIMIT 490,600
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  srcpart
-               key
-         TOK_SELEXPR
-            TOK_FUNCTION
-               substr
-               .
-                  TOK_TABLE_OR_COL
-                     srcpart
-                  value
-               5
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               hr
-      TOK_LIMIT
-         490
-         600
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/optimize_nullscan.q.out b/ql/src/test/results/clientpositive/optimize_nullscan.q.out
index 023b71b894..4a693d625d 100644
--- a/ql/src/test/results/clientpositive/optimize_nullscan.q.out
+++ b/ql/src/test/results/clientpositive/optimize_nullscan.q.out
@@ -14,25 +14,6 @@ POSTHOOK: query: -- SORT_QUERY_RESULTS
 explain extended 
 select key from src where false
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            src
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-      TOK_WHERE
-         false
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -144,32 +125,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select count(key) from srcpart where 1=2 group by key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               TOK_TABLE_OR_COL
-                  key
-      TOK_WHERE
-         =
-            1
-            2
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            key
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -256,63 +211,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select * from (select key from src where false) a left outer join (select key from srcpart limit 0) b on a.key=b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_LEFTOUTERJOIN
-         TOK_SUBQUERY
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        src
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           key
-                  TOK_WHERE
-                     false
-            a
-         TOK_SUBQUERY
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        srcpart
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           key
-                  TOK_LIMIT
-                     0
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-1 depends on stages: Stage-2
@@ -724,54 +622,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select count(key) from src where false union all select count(key) from srcpart
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_UNIONALL
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        src
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_FUNCTION
-                           count
-                           TOK_TABLE_OR_COL
-                              key
-                  TOK_WHERE
-                     false
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        srcpart
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_FUNCTION
-                           count
-                           TOK_TABLE_OR_COL
-                              key
-         _u1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1, Stage-3
@@ -1249,54 +1099,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select * from (select key from src where false) a left outer join (select value from srcpart limit 0) b
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_LEFTOUTERJOIN
-         TOK_SUBQUERY
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        src
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           key
-                  TOK_WHERE
-                     false
-            a
-         TOK_SUBQUERY
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        srcpart
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           value
-                  TOK_LIMIT
-                     0
-            b
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-1 depends on stages: Stage-2
@@ -1707,65 +1509,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended 
 select * from (select key from src union all select src.key from src left outer join srcpart on src.key = srcpart.key) a  where false
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_UNIONALL
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        src
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           key
-            TOK_QUERY
-               TOK_FROM
-                  TOK_LEFTOUTERJOIN
-                     TOK_TABREF
-                        TOK_TABNAME
-                           src
-                     TOK_TABREF
-                        TOK_TABNAME
-                           srcpart
-                     =
-                        .
-                           TOK_TABLE_OR_COL
-                              src
-                           key
-                        .
-                           TOK_TABLE_OR_COL
-                              srcpart
-                           key
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        .
-                           TOK_TABLE_OR_COL
-                              src
-                           key
-         a
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         false
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-2 depends on stages: Stage-3
@@ -2041,40 +1784,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended 
 select * from src s1, src s2 where false and s1.value = s2.value
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               src
-            s1
-         TOK_TABREF
-            TOK_TABNAME
-               src
-            s2
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         and
-            false
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     s1
-                  value
-               .
-                  TOK_TABLE_OR_COL
-                     s2
-                  value
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -2222,28 +1931,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select count(1) from src where null = 1
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            src
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_WHERE
-         =
-            TOK_NULL
-            1
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/outer_join_ppr.q.java1.7.out b/ql/src/test/results/clientpositive/outer_join_ppr.q.java1.7.out
index c471301b7b..1312e5388f 100644
--- a/ql/src/test/results/clientpositive/outer_join_ppr.q.java1.7.out
+++ b/ql/src/test/results/clientpositive/outer_join_ppr.q.java1.7.out
@@ -22,90 +22,6 @@ EXPLAIN EXTENDED
  SELECT a.key, a.value, b.key, b.value
  WHERE a.key > 10 AND a.key < 20 AND b.key > 15 AND b.key < 25
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_FULLOUTERJOIN
-         TOK_TABREF
-            TOK_TABNAME
-               src
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcpart
-            b
-         AND
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  ds
-               '2008-04-08'
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-      TOK_WHERE
-         AND
-            AND
-               AND
-                  >
-                     .
-                        TOK_TABLE_OR_COL
-                           a
-                        key
-                     10
-                  <
-                     .
-                        TOK_TABLE_OR_COL
-                           a
-                        key
-                     20
-               >
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-                  15
-            <
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-               25
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -493,90 +409,6 @@ POSTHOOK: query: EXPLAIN EXTENDED
  SELECT a.key, a.value, b.key, b.value
  WHERE a.key > 10 AND a.key < 20 AND b.key > 15 AND b.key < 25 AND b.ds = '2008-04-08'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_FULLOUTERJOIN
-         TOK_TABREF
-            TOK_TABNAME
-               src
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcpart
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-      TOK_WHERE
-         AND
-            AND
-               AND
-                  AND
-                     >
-                        .
-                           TOK_TABLE_OR_COL
-                              a
-                           key
-                        10
-                     <
-                        .
-                           TOK_TABLE_OR_COL
-                              a
-                           key
-                        20
-                  >
-                     .
-                        TOK_TABLE_OR_COL
-                           b
-                        key
-                     15
-               <
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-                  25
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  ds
-               '2008-04-08'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/pcr.q.out b/ql/src/test/results/clientpositive/pcr.q.out
index 684d4d736d..b53226eaaa 100644
--- a/ql/src/test/results/clientpositive/pcr.q.out
+++ b/ql/src/test/results/clientpositive/pcr.q.out
@@ -52,48 +52,6 @@ PREHOOK: query: explain extended select key, value, ds from pcr_t1 where ds<='20
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select key, value, ds from pcr_t1 where ds<='2000-04-09' and key<5 order by key, ds
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            pcr_t1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds
-      TOK_WHERE
-         and
-            <=
-               TOK_TABLE_OR_COL
-                  ds
-               '2000-04-09'
-            <
-               TOK_TABLE_OR_COL
-                  key
-               5
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  key
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  ds
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -279,41 +237,6 @@ PREHOOK: query: explain extended select key, value from pcr_t1 where ds<='2000-0
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select key, value from pcr_t1 where ds<='2000-04-09' or key<5 order by key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            pcr_t1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-      TOK_WHERE
-         or
-            <=
-               TOK_TABLE_OR_COL
-                  ds
-               '2000-04-09'
-            <
-               TOK_TABLE_OR_COL
-                  key
-               5
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  key
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -582,53 +505,6 @@ PREHOOK: query: explain extended select key, value, ds from pcr_t1 where ds<='20
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select key, value, ds from pcr_t1 where ds<='2000-04-09' and key<5 and value != 'val_2' order by key, ds
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            pcr_t1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds
-      TOK_WHERE
-         and
-            and
-               <=
-                  TOK_TABLE_OR_COL
-                     ds
-                  '2000-04-09'
-               <
-                  TOK_TABLE_OR_COL
-                     key
-                  5
-            !=
-               TOK_TABLE_OR_COL
-                  value
-               'val_2'
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  key
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  ds
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -816,58 +692,6 @@ POSTHOOK: query: explain extended
 select key, value, ds from pcr_t1
 where (ds < '2000-04-09' and key < 5) or (ds > '2000-04-09' and value == 'val_5') order by key, ds
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            pcr_t1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds
-      TOK_WHERE
-         or
-            and
-               <
-                  TOK_TABLE_OR_COL
-                     ds
-                  '2000-04-09'
-               <
-                  TOK_TABLE_OR_COL
-                     key
-                  5
-            and
-               >
-                  TOK_TABLE_OR_COL
-                     ds
-                  '2000-04-09'
-               ==
-                  TOK_TABLE_OR_COL
-                     value
-                  'val_5'
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  key
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  ds
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1057,58 +881,6 @@ POSTHOOK: query: explain extended
 select key, value, ds from pcr_t1
 where (ds < '2000-04-10' and key < 5) or (ds > '2000-04-08' and value == 'val_5') order by key, ds
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            pcr_t1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds
-      TOK_WHERE
-         or
-            and
-               <
-                  TOK_TABLE_OR_COL
-                     ds
-                  '2000-04-10'
-               <
-                  TOK_TABLE_OR_COL
-                     key
-                  5
-            and
-               >
-                  TOK_TABLE_OR_COL
-                     ds
-                  '2000-04-08'
-               ==
-                  TOK_TABLE_OR_COL
-                     value
-                  'val_5'
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  key
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  ds
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1354,58 +1126,6 @@ POSTHOOK: query: explain extended
 select key, value, ds from pcr_t1
 where (ds < '2000-04-10' or key < 5) and (ds > '2000-04-08' or value == 'val_5') order by key, ds
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            pcr_t1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds
-      TOK_WHERE
-         and
-            or
-               <
-                  TOK_TABLE_OR_COL
-                     ds
-                  '2000-04-10'
-               <
-                  TOK_TABLE_OR_COL
-                     key
-                  5
-            or
-               >
-                  TOK_TABLE_OR_COL
-                     ds
-                  '2000-04-08'
-               ==
-                  TOK_TABLE_OR_COL
-                     value
-                  'val_5'
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  key
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  ds
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1659,50 +1379,6 @@ PREHOOK: query: explain extended select key, value from pcr_t1 where (ds='2000-0
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select key, value from pcr_t1 where (ds='2000-04-08' or ds='2000-04-09') and key=14 order by key, value
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            pcr_t1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-      TOK_WHERE
-         and
-            or
-               =
-                  TOK_TABLE_OR_COL
-                     ds
-                  '2000-04-08'
-               =
-                  TOK_TABLE_OR_COL
-                     ds
-                  '2000-04-09'
-            =
-               TOK_TABLE_OR_COL
-                  key
-               14
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  key
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  value
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1877,45 +1553,6 @@ PREHOOK: query: explain extended select key, value from pcr_t1 where ds='2000-04
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select key, value from pcr_t1 where ds='2000-04-08' or ds='2000-04-09' order by key, value
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            pcr_t1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-      TOK_WHERE
-         or
-            =
-               TOK_TABLE_OR_COL
-                  ds
-               '2000-04-08'
-            =
-               TOK_TABLE_OR_COL
-                  ds
-               '2000-04-09'
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  key
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  value
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -2126,45 +1763,6 @@ PREHOOK: query: explain extended select key, value from pcr_t1 where ds>='2000-0
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select key, value from pcr_t1 where ds>='2000-04-08' or ds<'2000-04-10' order by key, value
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            pcr_t1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-      TOK_WHERE
-         or
-            >=
-               TOK_TABLE_OR_COL
-                  ds
-               '2000-04-08'
-            <
-               TOK_TABLE_OR_COL
-                  ds
-               '2000-04-10'
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  key
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  value
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -2443,62 +2041,6 @@ PREHOOK: query: explain extended select key, value, ds from pcr_t1 where (ds='20
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select key, value, ds from pcr_t1 where (ds='2000-04-08' and key=1) or (ds='2000-04-09' and key=2) order by key, value, ds
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            pcr_t1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds
-      TOK_WHERE
-         or
-            and
-               =
-                  TOK_TABLE_OR_COL
-                     ds
-                  '2000-04-08'
-               =
-                  TOK_TABLE_OR_COL
-                     key
-                  1
-            and
-               =
-                  TOK_TABLE_OR_COL
-                     ds
-                  '2000-04-09'
-               =
-                  TOK_TABLE_OR_COL
-                     key
-                  2
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  key
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  value
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  ds
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -2674,58 +2216,6 @@ PREHOOK: query: explain extended select * from pcr_t1 t1 join pcr_t1 t2 on t1.ke
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select * from pcr_t1 t1 join pcr_t1 t2 on t1.key=t2.key and t1.ds='2000-04-08' and t2.ds='2000-04-08' order by t1.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               pcr_t1
-            t1
-         TOK_TABREF
-            TOK_TABNAME
-               pcr_t1
-            t2
-         and
-            and
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        t1
-                     key
-                  .
-                     TOK_TABLE_OR_COL
-                        t2
-                     key
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        t1
-                     ds
-                  '2000-04-08'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     t2
-                  ds
-               '2000-04-08'
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               .
-                  TOK_TABLE_OR_COL
-                     t1
-                  key
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -2980,58 +2470,6 @@ PREHOOK: query: explain extended select * from pcr_t1 t1 join pcr_t1 t2 on t1.ke
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select * from pcr_t1 t1 join pcr_t1 t2 on t1.key=t2.key and t1.ds='2000-04-08' and t2.ds='2000-04-09' order by t1.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               pcr_t1
-            t1
-         TOK_TABREF
-            TOK_TABNAME
-               pcr_t1
-            t2
-         and
-            and
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        t1
-                     key
-                  .
-                     TOK_TABLE_OR_COL
-                        t2
-                     key
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        t1
-                     ds
-                  '2000-04-08'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     t2
-                  ds
-               '2000-04-09'
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               .
-                  TOK_TABLE_OR_COL
-                     t1
-                  key
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -3344,67 +2782,6 @@ PREHOOK: query: explain extended select key, value, ds from pcr_t1 where (ds>'20
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select key, value, ds from pcr_t1 where (ds>'2000-04-08' and ds<'2000-04-11') or (ds>='2000-04-08' and ds<='2000-04-11' and key=2) order by key, value, ds
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            pcr_t1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds
-      TOK_WHERE
-         or
-            and
-               >
-                  TOK_TABLE_OR_COL
-                     ds
-                  '2000-04-08'
-               <
-                  TOK_TABLE_OR_COL
-                     ds
-                  '2000-04-11'
-            and
-               and
-                  >=
-                     TOK_TABLE_OR_COL
-                        ds
-                     '2000-04-08'
-                  <=
-                     TOK_TABLE_OR_COL
-                        ds
-                     '2000-04-11'
-               =
-                  TOK_TABLE_OR_COL
-                     key
-                  2
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  key
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  value
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  ds
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -3717,62 +3094,6 @@ PREHOOK: query: explain extended select key, value, ds from pcr_t1 where (ds>'20
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select key, value, ds from pcr_t1 where (ds>'2000-04-08' and ds<'2000-04-11') or (ds<='2000-04-09' and key=2) order by key, value, ds
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            pcr_t1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds
-      TOK_WHERE
-         or
-            and
-               >
-                  TOK_TABLE_OR_COL
-                     ds
-                  '2000-04-08'
-               <
-                  TOK_TABLE_OR_COL
-                     ds
-                  '2000-04-11'
-            and
-               <=
-                  TOK_TABLE_OR_COL
-                     ds
-                  '2000-04-09'
-               =
-                  TOK_TABLE_OR_COL
-                     key
-                  2
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  key
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  value
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  ds
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -4058,49 +3379,6 @@ from pcr_t1
 insert overwrite table pcr_t2 select key, value where ds='2000-04-08'
 insert overwrite table pcr_t3 select key, value where ds='2000-04-08'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            pcr_t1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               pcr_t2
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-      TOK_WHERE
-         =
-            TOK_TABLE_OR_COL
-               ds
-            '2000-04-08'
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               pcr_t3
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-      TOK_WHERE
-         =
-            TOK_TABLE_OR_COL
-               ds
-            '2000-04-08'
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-8 depends on stages: Stage-2 , consists of Stage-5, Stage-4, Stage-6
@@ -4625,59 +3903,6 @@ from pcr_t1
 insert overwrite table pcr_t2 select key, value where ds='2000-04-08' and key=2
 insert overwrite table pcr_t3 select key, value where ds='2000-04-08' and key=3
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            pcr_t1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               pcr_t2
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-      TOK_WHERE
-         and
-            =
-               TOK_TABLE_OR_COL
-                  ds
-               '2000-04-08'
-            =
-               TOK_TABLE_OR_COL
-                  key
-               2
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               pcr_t3
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-      TOK_WHERE
-         and
-            =
-               TOK_TABLE_OR_COL
-                  ds
-               '2000-04-08'
-            =
-               TOK_TABLE_OR_COL
-                  key
-               3
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-8 depends on stages: Stage-2 , consists of Stage-5, Stage-4, Stage-6
@@ -5284,43 +4509,6 @@ PREHOOK: query: explain extended select key, value from srcpart where ds='2008-0
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select key, value from srcpart where ds='2008-04-08' and hr=11 order by key limit 10
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-      TOK_WHERE
-         and
-            =
-               TOK_TABLE_OR_COL
-                  ds
-               '2008-04-08'
-            =
-               TOK_TABLE_OR_COL
-                  hr
-               11
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  key
-      TOK_LIMIT
-         10
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -5448,65 +4636,6 @@ PREHOOK: query: explain extended select key, value, ds, hr from srcpart where ds
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select key, value, ds, hr from srcpart where ds='2008-04-08' and (hr='11' or hr='12') and key=11 order by key, ds, hr
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               hr
-      TOK_WHERE
-         and
-            and
-               =
-                  TOK_TABLE_OR_COL
-                     ds
-                  '2008-04-08'
-               or
-                  =
-                     TOK_TABLE_OR_COL
-                        hr
-                     '11'
-                  =
-                     TOK_TABLE_OR_COL
-                        hr
-                     '12'
-            =
-               TOK_TABLE_OR_COL
-                  key
-               11
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  key
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  ds
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  hr
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -5686,55 +4815,6 @@ PREHOOK: query: explain extended select key, value, ds, hr from srcpart where hr
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select key, value, ds, hr from srcpart where hr='11' and key=11 order by key, ds, hr
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               hr
-      TOK_WHERE
-         and
-            =
-               TOK_TABLE_OR_COL
-                  hr
-               '11'
-            =
-               TOK_TABLE_OR_COL
-                  key
-               11
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  key
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  ds
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  hr
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/pcs.q.out b/ql/src/test/results/clientpositive/pcs.q.out
index d6d24310ae..8b99401ea6 100644
--- a/ql/src/test/results/clientpositive/pcs.q.out
+++ b/ql/src/test/results/clientpositive/pcs.q.out
@@ -82,62 +82,6 @@ PREHOOK: query: explain extended select key, value, ds from pcs_t1 where (ds='20
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select key, value, ds from pcs_t1 where (ds='2000-04-08' and key=1) or (ds='2000-04-09' and key=2) order by key, value, ds
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            pcs_t1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds
-      TOK_WHERE
-         or
-            and
-               =
-                  TOK_TABLE_OR_COL
-                     ds
-                  '2000-04-08'
-               =
-                  TOK_TABLE_OR_COL
-                     key
-                  1
-            and
-               =
-                  TOK_TABLE_OR_COL
-                     ds
-                  '2000-04-09'
-               =
-                  TOK_TABLE_OR_COL
-                     key
-                  2
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  key
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  value
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  ds
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -313,40 +257,6 @@ PREHOOK: query: explain extended select ds from pcs_t1 where struct(ds, key) in
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select ds from pcs_t1 where struct(ds, key) in (struct('2000-04-08',1), struct('2000-04-09',2))
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            pcs_t1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds
-      TOK_WHERE
-         TOK_FUNCTION
-            in
-            TOK_FUNCTION
-               struct
-               TOK_TABLE_OR_COL
-                  ds
-               TOK_TABLE_OR_COL
-                  key
-            TOK_FUNCTION
-               struct
-               '2000-04-08'
-               1
-            TOK_FUNCTION
-               struct
-               '2000-04-09'
-               2
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -509,42 +419,6 @@ PREHOOK: query: explain extended select ds from pcs_t1 where struct(ds, key+2) i
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select ds from pcs_t1 where struct(ds, key+2) in (struct('2000-04-08',3), struct('2000-04-09',4))
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            pcs_t1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds
-      TOK_WHERE
-         TOK_FUNCTION
-            in
-            TOK_FUNCTION
-               struct
-               TOK_TABLE_OR_COL
-                  ds
-               +
-                  TOK_TABLE_OR_COL
-                     key
-                  2
-            TOK_FUNCTION
-               struct
-               '2000-04-08'
-               3
-            TOK_FUNCTION
-               struct
-               '2000-04-09'
-               4
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -707,77 +581,6 @@ PREHOOK: query: explain extended select /*+ MAPJOIN(pcs_t1) */ a.ds, b.key from
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select /*+ MAPJOIN(pcs_t1) */ a.ds, b.key from pcs_t1 a join pcs_t1 b  on a.ds=b.ds where struct(a.ds, a.key, b.ds) in (struct('2000-04-08',1, '2000-04-09'), struct('2000-04-09',2, '2000-04-08'))
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               pcs_t1
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               pcs_t1
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               ds
-            .
-               TOK_TABLE_OR_COL
-                  b
-               ds
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  pcs_t1
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               ds
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-      TOK_WHERE
-         TOK_FUNCTION
-            in
-            TOK_FUNCTION
-               struct
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  ds
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  ds
-            TOK_FUNCTION
-               struct
-               '2000-04-08'
-               1
-               '2000-04-09'
-            TOK_FUNCTION
-               struct
-               '2000-04-09'
-               2
-               '2000-04-08'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -971,43 +774,6 @@ PREHOOK: query: explain extended select ds from pcs_t1 where struct(ds, key+key)
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select ds from pcs_t1 where struct(ds, key+key) in (struct('2000-04-08',1), struct('2000-04-09',2))
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            pcs_t1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds
-      TOK_WHERE
-         TOK_FUNCTION
-            in
-            TOK_FUNCTION
-               struct
-               TOK_TABLE_OR_COL
-                  ds
-               +
-                  TOK_TABLE_OR_COL
-                     key
-                  TOK_TABLE_OR_COL
-                     key
-            TOK_FUNCTION
-               struct
-               '2000-04-08'
-               1
-            TOK_FUNCTION
-               struct
-               '2000-04-09'
-               2
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1267,120 +1033,6 @@ SELECT * FROM (
 WHERE A.ds = '2008-04-08'
 SORT BY A.key, A.value, A.ds
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_UNIONALL
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        pcs_t1
-                     X
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_ALLCOLREF
-                           TOK_TABNAME
-                              X
-                  TOK_WHERE
-                     TOK_FUNCTION
-                        in
-                        TOK_FUNCTION
-                           struct
-                           .
-                              TOK_TABLE_OR_COL
-                                 X
-                              ds
-                           .
-                              TOK_TABLE_OR_COL
-                                 X
-                              key
-                        TOK_FUNCTION
-                           struct
-                           '2000-04-08'
-                           1
-                        TOK_FUNCTION
-                           struct
-                           '2000-04-09'
-                           2
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        pcs_t1
-                     Y
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_ALLCOLREF
-                           TOK_TABNAME
-                              Y
-                  TOK_WHERE
-                     TOK_FUNCTION
-                        in
-                        TOK_FUNCTION
-                           struct
-                           .
-                              TOK_TABLE_OR_COL
-                                 Y
-                              ds
-                           .
-                              TOK_TABLE_OR_COL
-                                 Y
-                              key
-                        TOK_FUNCTION
-                           struct
-                           '2000-04-08'
-                           1
-                        TOK_FUNCTION
-                           struct
-                           '2000-04-09'
-                           2
-         A
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         =
-            .
-               TOK_TABLE_OR_COL
-                  A
-               ds
-            '2008-04-08'
-      TOK_SORTBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               .
-                  TOK_TABLE_OR_COL
-                     A
-                  key
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               .
-                  TOK_TABLE_OR_COL
-                     A
-                  value
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               .
-                  TOK_TABLE_OR_COL
-                     A
-                  ds
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1498,42 +1150,6 @@ PREHOOK: query: explain extended select ds from pcs_t1 where struct(case when ds
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select ds from pcs_t1 where struct(case when ds='2000-04-08' then 10 else 20 end) in (struct(10),struct(11))
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            pcs_t1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds
-      TOK_WHERE
-         TOK_FUNCTION
-            in
-            TOK_FUNCTION
-               struct
-               TOK_FUNCTION
-                  when
-                  =
-                     TOK_TABLE_OR_COL
-                        ds
-                     '2000-04-08'
-                  10
-                  20
-            TOK_FUNCTION
-               struct
-               10
-            TOK_FUNCTION
-               struct
-               11
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
@@ -1634,45 +1250,6 @@ PREHOOK: query: explain extended select ds from pcs_t1 where struct(ds, key, ran
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select ds from pcs_t1 where struct(ds, key, rand(100)) in (struct('2000-04-08',1,0.2), struct('2000-04-09',2,0.3))
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            pcs_t1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds
-      TOK_WHERE
-         TOK_FUNCTION
-            in
-            TOK_FUNCTION
-               struct
-               TOK_TABLE_OR_COL
-                  ds
-               TOK_TABLE_OR_COL
-                  key
-               TOK_FUNCTION
-                  rand
-                  100
-            TOK_FUNCTION
-               struct
-               '2000-04-08'
-               1
-               0.2
-            TOK_FUNCTION
-               struct
-               '2000-04-09'
-               2
-               0.3
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1822,47 +1399,6 @@ PREHOOK: query: explain extended select ds from pcs_t1 where struct(ds='2000-04-
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select ds from pcs_t1 where struct(ds='2000-04-08' or key = 2, key) in (struct(true,2), struct(false,3))
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            pcs_t1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds
-      TOK_WHERE
-         TOK_FUNCTION
-            in
-            TOK_FUNCTION
-               struct
-               or
-                  =
-                     TOK_TABLE_OR_COL
-                        ds
-                     '2000-04-08'
-                  =
-                     TOK_TABLE_OR_COL
-                        key
-                     2
-               TOK_TABLE_OR_COL
-                  key
-            TOK_FUNCTION
-               struct
-               true
-               2
-            TOK_FUNCTION
-               struct
-               false
-               3
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
@@ -2036,59 +1572,6 @@ PREHOOK: query: explain extended select ds from pcs_t1 where key = 3 or (struct(
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select ds from pcs_t1 where key = 3 or (struct(ds='2000-04-08' or key = 2, key) in (struct(true,2), struct(false,3)) and key+5 > 0)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            pcs_t1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds
-      TOK_WHERE
-         or
-            =
-               TOK_TABLE_OR_COL
-                  key
-               3
-            and
-               TOK_FUNCTION
-                  in
-                  TOK_FUNCTION
-                     struct
-                     or
-                        =
-                           TOK_TABLE_OR_COL
-                              ds
-                           '2000-04-08'
-                        =
-                           TOK_TABLE_OR_COL
-                              key
-                           2
-                     TOK_TABLE_OR_COL
-                        key
-                  TOK_FUNCTION
-                     struct
-                     true
-                     2
-                  TOK_FUNCTION
-                     struct
-                     false
-                     3
-               >
-                  +
-                     TOK_TABLE_OR_COL
-                        key
-                     5
-                  0
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
diff --git a/ql/src/test/results/clientpositive/pointlookup2.q.out b/ql/src/test/results/clientpositive/pointlookup2.q.out
index 6fc6e7f7f8..d0ad68a835 100644
--- a/ql/src/test/results/clientpositive/pointlookup2.q.out
+++ b/ql/src/test/results/clientpositive/pointlookup2.q.out
@@ -98,62 +98,6 @@ from pcr_t1
 where (ds='2000-04-08' and key=1) or (ds='2000-04-09' and key=2)
 order by key, value, ds
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            pcr_t1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds
-      TOK_WHERE
-         or
-            and
-               =
-                  TOK_TABLE_OR_COL
-                     ds
-                  '2000-04-08'
-               =
-                  TOK_TABLE_OR_COL
-                     key
-                  1
-            and
-               =
-                  TOK_TABLE_OR_COL
-                     ds
-                  '2000-04-09'
-               =
-                  TOK_TABLE_OR_COL
-                     key
-                  2
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  key
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  value
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  ds
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -324,58 +268,6 @@ from pcr_t1 t1 join pcr_t1 t2
 on t1.key=t2.key and t1.ds='2000-04-08' and t2.ds='2000-04-08'
 order by t1.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               pcr_t1
-            t1
-         TOK_TABREF
-            TOK_TABNAME
-               pcr_t1
-            t2
-         and
-            and
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        t1
-                     key
-                  .
-                     TOK_TABLE_OR_COL
-                        t2
-                     key
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        t1
-                     ds
-                  '2000-04-08'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     t2
-                  ds
-               '2000-04-08'
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               .
-                  TOK_TABLE_OR_COL
-                     t1
-                  key
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -590,58 +482,6 @@ from pcr_t1 t1 join pcr_t1 t2
 on t1.key=t2.key and t1.ds='2000-04-08' and t2.ds='2000-04-09'
 order by t1.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               pcr_t1
-            t1
-         TOK_TABREF
-            TOK_TABNAME
-               pcr_t1
-            t2
-         and
-            and
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        t1
-                     key
-                  .
-                     TOK_TABLE_OR_COL
-                        t2
-                     key
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        t1
-                     ds
-                  '2000-04-08'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     t2
-                  ds
-               '2000-04-09'
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               .
-                  TOK_TABLE_OR_COL
-                     t1
-                  key
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -903,75 +743,6 @@ from pcr_t1 t1 join pcr_t2 t2
 where (t1.ds='2000-04-08' and t2.key=1) or (t1.ds='2000-04-09' and t2.key=2)
 order by t2.key, t2.value, t1.ds
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               pcr_t1
-            t1
-         TOK_TABREF
-            TOK_TABNAME
-               pcr_t2
-            t2
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         or
-            and
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        t1
-                     ds
-                  '2000-04-08'
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        t2
-                     key
-                  1
-            and
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        t1
-                     ds
-                  '2000-04-09'
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        t2
-                     key
-                  2
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               .
-                  TOK_TABLE_OR_COL
-                     t2
-                  key
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               .
-                  TOK_TABLE_OR_COL
-                     t2
-                  value
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               .
-                  TOK_TABLE_OR_COL
-                     t1
-                  ds
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -1274,75 +1045,6 @@ from pcr_t1 t1 join pcr_t2 t2
 where (t2.ds='2000-04-08' and t1.key=1) or (t2.ds='2000-04-09' and t1.key=2)
 order by t1.key, t1.value, t2.ds
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               pcr_t1
-            t1
-         TOK_TABREF
-            TOK_TABNAME
-               pcr_t2
-            t2
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         or
-            and
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        t2
-                     ds
-                  '2000-04-08'
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        t1
-                     key
-                  1
-            and
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        t2
-                     ds
-                  '2000-04-09'
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        t1
-                     key
-                  2
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               .
-                  TOK_TABLE_OR_COL
-                     t1
-                  key
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               .
-                  TOK_TABLE_OR_COL
-                     t1
-                  value
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               .
-                  TOK_TABLE_OR_COL
-                     t2
-                  ds
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/pointlookup3.q.out b/ql/src/test/results/clientpositive/pointlookup3.q.out
index 2b25b39f96..39804cf5fc 100644
--- a/ql/src/test/results/clientpositive/pointlookup3.q.out
+++ b/ql/src/test/results/clientpositive/pointlookup3.q.out
@@ -52,69 +52,6 @@ from pcr_t1
 where (ds1='2000-04-08' and key=1) or (ds1='2000-04-09' and key=2)
 order by key, value, ds1, ds2
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            pcr_t1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds1
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds2
-      TOK_WHERE
-         or
-            and
-               =
-                  TOK_TABLE_OR_COL
-                     ds1
-                  '2000-04-08'
-               =
-                  TOK_TABLE_OR_COL
-                     key
-                  1
-            and
-               =
-                  TOK_TABLE_OR_COL
-                     ds1
-                  '2000-04-09'
-               =
-                  TOK_TABLE_OR_COL
-                     key
-                  2
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  key
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  value
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  ds1
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  ds2
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -287,79 +224,6 @@ from pcr_t1
 where (ds1='2000-04-08' and ds2='2001-04-08' and key=1) or (ds1='2000-04-09' and ds2='2001-04-08' and key=2)
 order by key, value, ds1, ds2
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            pcr_t1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds1
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds2
-      TOK_WHERE
-         or
-            and
-               and
-                  =
-                     TOK_TABLE_OR_COL
-                        ds1
-                     '2000-04-08'
-                  =
-                     TOK_TABLE_OR_COL
-                        ds2
-                     '2001-04-08'
-               =
-                  TOK_TABLE_OR_COL
-                     key
-                  1
-            and
-               and
-                  =
-                     TOK_TABLE_OR_COL
-                        ds1
-                     '2000-04-09'
-                  =
-                     TOK_TABLE_OR_COL
-                        ds2
-                     '2001-04-08'
-               =
-                  TOK_TABLE_OR_COL
-                     key
-                  2
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  key
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  value
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  ds1
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  ds2
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -485,58 +349,6 @@ from pcr_t1 t1 join pcr_t1 t2
 on t1.key=t2.key and t1.ds1='2000-04-08' and t2.ds2='2001-04-08'
 order by t1.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               pcr_t1
-            t1
-         TOK_TABREF
-            TOK_TABNAME
-               pcr_t1
-            t2
-         and
-            and
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        t1
-                     key
-                  .
-                     TOK_TABLE_OR_COL
-                        t2
-                     key
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        t1
-                     ds1
-                  '2000-04-08'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     t2
-                  ds2
-               '2001-04-08'
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               .
-                  TOK_TABLE_OR_COL
-                     t1
-                  key
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -752,58 +564,6 @@ from pcr_t1 t1 join pcr_t1 t2
 on t1.key=t2.key and t1.ds1='2000-04-08' and t2.ds1='2000-04-09'
 order by t1.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               pcr_t1
-            t1
-         TOK_TABREF
-            TOK_TABNAME
-               pcr_t1
-            t2
-         and
-            and
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        t1
-                     key
-                  .
-                     TOK_TABLE_OR_COL
-                        t2
-                     key
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        t1
-                     ds1
-                  '2000-04-08'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     t2
-                  ds1
-               '2000-04-09'
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               .
-                  TOK_TABLE_OR_COL
-                     t1
-                  key
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -1067,75 +827,6 @@ from pcr_t1 t1 join pcr_t1 t2
 where (t1.ds1='2000-04-08' and t2.key=1) or (t1.ds1='2000-04-09' and t2.key=2)
 order by t2.key, t2.value, t1.ds1
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               pcr_t1
-            t1
-         TOK_TABREF
-            TOK_TABNAME
-               pcr_t1
-            t2
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         or
-            and
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        t1
-                     ds1
-                  '2000-04-08'
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        t2
-                     key
-                  1
-            and
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        t1
-                     ds1
-                  '2000-04-09'
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        t2
-                     key
-                  2
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               .
-                  TOK_TABLE_OR_COL
-                     t2
-                  key
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               .
-                  TOK_TABLE_OR_COL
-                     t2
-                  value
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               .
-                  TOK_TABLE_OR_COL
-                     t1
-                  ds1
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/pointlookup4.q.out b/ql/src/test/results/clientpositive/pointlookup4.q.out
index 6236272bc8..1ff7593d3b 100644
--- a/ql/src/test/results/clientpositive/pointlookup4.q.out
+++ b/ql/src/test/results/clientpositive/pointlookup4.q.out
@@ -52,79 +52,6 @@ from pcr_t1
 where (ds1='2000-04-08' and ds2='2001-04-08' and key=1) or (ds1='2000-04-09' and ds2='2001-04-09' and key=2)
 order by key, value, ds1, ds2
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            pcr_t1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds1
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds2
-      TOK_WHERE
-         or
-            and
-               and
-                  =
-                     TOK_TABLE_OR_COL
-                        ds1
-                     '2000-04-08'
-                  =
-                     TOK_TABLE_OR_COL
-                        ds2
-                     '2001-04-08'
-               =
-                  TOK_TABLE_OR_COL
-                     key
-                  1
-            and
-               and
-                  =
-                     TOK_TABLE_OR_COL
-                        ds1
-                     '2000-04-09'
-                  =
-                     TOK_TABLE_OR_COL
-                        ds2
-                     '2001-04-09'
-               =
-                  TOK_TABLE_OR_COL
-                     key
-                  2
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  key
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  value
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  ds1
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  ds2
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -297,79 +224,6 @@ from pcr_t1
 where (ds1='2000-04-08' and ds2='2001-04-08' and key=1) or (ds1='2000-04-09' and ds2='2001-04-09' and key=2)
 order by key, value, ds1, ds2
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            pcr_t1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds1
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds2
-      TOK_WHERE
-         or
-            and
-               and
-                  =
-                     TOK_TABLE_OR_COL
-                        ds1
-                     '2000-04-08'
-                  =
-                     TOK_TABLE_OR_COL
-                        ds2
-                     '2001-04-08'
-               =
-                  TOK_TABLE_OR_COL
-                     key
-                  1
-            and
-               and
-                  =
-                     TOK_TABLE_OR_COL
-                        ds1
-                     '2000-04-09'
-                  =
-                     TOK_TABLE_OR_COL
-                        ds2
-                     '2001-04-09'
-               =
-                  TOK_TABLE_OR_COL
-                     key
-                  2
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  key
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  value
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  ds1
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  ds2
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/ppd_join_filter.q.out b/ql/src/test/results/clientpositive/ppd_join_filter.q.out
index 74d2de1570..d8e5009a99 100644
--- a/ql/src/test/results/clientpositive/ppd_join_filter.q.out
+++ b/ql/src/test/results/clientpositive/ppd_join_filter.q.out
@@ -24,101 +24,6 @@ group by key
 ) b
 on a.key=b.key and b.k1 < 5
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               src
-            a
-         TOK_SUBQUERY
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        src
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           key
-                     TOK_SELEXPR
-                        TOK_FUNCTION
-                           min
-                           TOK_TABLE_OR_COL
-                              key
-                        k
-                     TOK_SELEXPR
-                        +
-                           TOK_FUNCTION
-                              min
-                              TOK_TABLE_OR_COL
-                                 key
-                           1
-                        k1
-                     TOK_SELEXPR
-                        +
-                           TOK_FUNCTION
-                              min
-                              TOK_TABLE_OR_COL
-                                 key
-                           2
-                        k2
-                     TOK_SELEXPR
-                        +
-                           TOK_FUNCTION
-                              min
-                              TOK_TABLE_OR_COL
-                                 key
-                           3
-                        k3
-                  TOK_GROUPBY
-                     TOK_TABLE_OR_COL
-                        key
-            b
-         and
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-            <
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  k1
-               5
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               k2
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               k3
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-1 depends on stages: Stage-2
@@ -441,101 +346,6 @@ group by key
 ) b
 on a.key=b.key and b.k1 < 5
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               src
-            a
-         TOK_SUBQUERY
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        src
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           key
-                     TOK_SELEXPR
-                        TOK_FUNCTION
-                           min
-                           TOK_TABLE_OR_COL
-                              key
-                        k
-                     TOK_SELEXPR
-                        +
-                           TOK_FUNCTION
-                              min
-                              TOK_TABLE_OR_COL
-                                 key
-                           1
-                        k1
-                     TOK_SELEXPR
-                        +
-                           TOK_FUNCTION
-                              min
-                              TOK_TABLE_OR_COL
-                                 key
-                           2
-                        k2
-                     TOK_SELEXPR
-                        +
-                           TOK_FUNCTION
-                              min
-                              TOK_TABLE_OR_COL
-                                 key
-                           3
-                        k3
-                  TOK_GROUPBY
-                     TOK_TABLE_OR_COL
-                        key
-            b
-         and
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-            <
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  k1
-               5
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               k2
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               k3
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-1 depends on stages: Stage-2
@@ -858,101 +668,6 @@ group by key
 ) b
 on a.key=b.key and b.k1 < 5
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               src
-            a
-         TOK_SUBQUERY
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        src
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           key
-                     TOK_SELEXPR
-                        TOK_FUNCTION
-                           min
-                           TOK_TABLE_OR_COL
-                              key
-                        k
-                     TOK_SELEXPR
-                        +
-                           TOK_FUNCTION
-                              min
-                              TOK_TABLE_OR_COL
-                                 key
-                           1
-                        k1
-                     TOK_SELEXPR
-                        +
-                           TOK_FUNCTION
-                              min
-                              TOK_TABLE_OR_COL
-                                 key
-                           2
-                        k2
-                     TOK_SELEXPR
-                        +
-                           TOK_FUNCTION
-                              min
-                              TOK_TABLE_OR_COL
-                                 key
-                           3
-                        k3
-                  TOK_GROUPBY
-                     TOK_TABLE_OR_COL
-                        key
-            b
-         and
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-            <
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  k1
-               5
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               k2
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               k3
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-1 depends on stages: Stage-2
@@ -1275,101 +990,6 @@ group by key
 ) b
 on a.key=b.key and b.k1 < 5
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               src
-            a
-         TOK_SUBQUERY
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        src
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           key
-                     TOK_SELEXPR
-                        TOK_FUNCTION
-                           min
-                           TOK_TABLE_OR_COL
-                              key
-                        k
-                     TOK_SELEXPR
-                        +
-                           TOK_FUNCTION
-                              min
-                              TOK_TABLE_OR_COL
-                                 key
-                           1
-                        k1
-                     TOK_SELEXPR
-                        +
-                           TOK_FUNCTION
-                              min
-                              TOK_TABLE_OR_COL
-                                 key
-                           2
-                        k2
-                     TOK_SELEXPR
-                        +
-                           TOK_FUNCTION
-                              min
-                              TOK_TABLE_OR_COL
-                                 key
-                           3
-                        k3
-                  TOK_GROUPBY
-                     TOK_TABLE_OR_COL
-                        key
-            b
-         and
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-            <
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  k1
-               5
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               k2
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               k3
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-1 depends on stages: Stage-2
diff --git a/ql/src/test/results/clientpositive/ppd_union_view.q.out b/ql/src/test/results/clientpositive/ppd_union_view.q.out
index 36bb214c58..435b6f92aa 100644
--- a/ql/src/test/results/clientpositive/ppd_union_view.q.out
+++ b/ql/src/test/results/clientpositive/ppd_union_view.q.out
@@ -138,27 +138,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select * from t1 where ds = '2011-10-13'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            t1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         =
-            TOK_TABLE_OR_COL
-               ds
-            '2011-10-13'
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-2 depends on stages: Stage-3
@@ -487,27 +466,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select * from t1 where ds = '2011-10-15'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            t1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         =
-            TOK_TABLE_OR_COL
-               ds
-            '2011-10-15'
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-2 depends on stages: Stage-3
diff --git a/ql/src/test/results/clientpositive/ppd_vc.q.out b/ql/src/test/results/clientpositive/ppd_vc.q.out
index cc25e80b99..a82a709aef 100644
--- a/ql/src/test/results/clientpositive/ppd_vc.q.out
+++ b/ql/src/test/results/clientpositive/ppd_vc.q.out
@@ -8,27 +8,6 @@ POSTHOOK: query: --HIVE-3926 PPD on virtual column of partitioned table is not w
 explain extended
 select * from srcpart where BLOCK__OFFSET__INSIDE__FILE<100
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         <
-            TOK_TABLE_OR_COL
-               BLOCK__OFFSET__INSIDE__FILE
-            100
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -332,77 +311,6 @@ select b.* from src a join
   (select *,BLOCK__OFFSET__INSIDE__FILE from srcpart where BLOCK__OFFSET__INSIDE__FILE<100) b
     on a.key=b.key AND b.BLOCK__OFFSET__INSIDE__FILE<50 order by ds,hr,BLOCK__OFFSET__INSIDE__FILE
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               src
-            a
-         TOK_SUBQUERY
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        srcpart
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_ALLCOLREF
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           BLOCK__OFFSET__INSIDE__FILE
-                  TOK_WHERE
-                     <
-                        TOK_TABLE_OR_COL
-                           BLOCK__OFFSET__INSIDE__FILE
-                        100
-            b
-         AND
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-            <
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  BLOCK__OFFSET__INSIDE__FILE
-               50
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-               TOK_TABNAME
-                  b
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  ds
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  hr
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  BLOCK__OFFSET__INSIDE__FILE
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/ppr_allchildsarenull.q.out b/ql/src/test/results/clientpositive/ppr_allchildsarenull.q.out
index b1f280fbe4..9e9e61f45d 100644
--- a/ql/src/test/results/clientpositive/ppr_allchildsarenull.q.out
+++ b/ql/src/test/results/clientpositive/ppr_allchildsarenull.q.out
@@ -16,50 +16,6 @@ SELECT
    THEN 1
    ELSE 0  end ) > 0
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTION
-               TOK_INT
-               TOK_TABLE_OR_COL
-                  key
-            user_id
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-      TOK_WHERE
-         and
-            =
-               TOK_TABLE_OR_COL
-                  ds
-               '2008-04-08'
-            >
-               TOK_FUNCTION
-                  WHEN
-                  OR
-                     LIKE
-                        TOK_TABLE_OR_COL
-                           value
-                        'aaa%'
-                     LIKE
-                        TOK_TABLE_OR_COL
-                           value
-                        'vvv%'
-                  1
-                  0
-               0
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -249,50 +205,6 @@ SELECT
    THEN 1
    ELSE 0  end ) > 0
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTION
-               TOK_INT
-               TOK_TABLE_OR_COL
-                  key
-            user_id
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-      TOK_WHERE
-         and
-            =
-               TOK_TABLE_OR_COL
-                  ds
-               '2008-04-08'
-            >
-               TOK_FUNCTION
-                  WHEN
-                  OR
-                     LIKE
-                        TOK_TABLE_OR_COL
-                           value
-                        'aaa%'
-                     LIKE
-                        TOK_TABLE_OR_COL
-                           value
-                        'vvv%'
-                  1
-                  0
-               0
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/push_or.q.out b/ql/src/test/results/clientpositive/push_or.q.out
index bc5c930d16..cc448c1d11 100644
--- a/ql/src/test/results/clientpositive/push_or.q.out
+++ b/ql/src/test/results/clientpositive/push_or.q.out
@@ -34,48 +34,6 @@ PREHOOK: query: explain extended select key, value, ds from push_or where ds='20
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select key, value, ds from push_or where ds='2000-04-09' or key=5 order by key, ds
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            push_or
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds
-      TOK_WHERE
-         or
-            =
-               TOK_TABLE_OR_COL
-                  ds
-               '2000-04-09'
-            =
-               TOK_TABLE_OR_COL
-                  key
-               5
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  key
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  ds
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/rand_partitionpruner1.q.out b/ql/src/test/results/clientpositive/rand_partitionpruner1.q.out
index 5dcb8658a3..e03c0557a3 100644
--- a/ql/src/test/results/clientpositive/rand_partitionpruner1.q.out
+++ b/ql/src/test/results/clientpositive/rand_partitionpruner1.q.out
@@ -4,28 +4,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: -- scanning un-partitioned data
 explain extended select * from src where rand(1) < 0.1
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            src
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         <
-            TOK_FUNCTION
-               rand
-               1
-            0.1
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/rand_partitionpruner2.q.out b/ql/src/test/results/clientpositive/rand_partitionpruner2.q.out
index 4559b39c0b..d88c53d46e 100644
--- a/ql/src/test/results/clientpositive/rand_partitionpruner2.q.out
+++ b/ql/src/test/results/clientpositive/rand_partitionpruner2.q.out
@@ -18,39 +18,6 @@ POSTHOOK: query: explain extended
 insert overwrite table tmptable
 select a.* from srcpart a where rand(1) < 0.1 and a.ds = '2008-04-08'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-         a
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               tmptable
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-               TOK_TABNAME
-                  a
-      TOK_WHERE
-         and
-            <
-               TOK_FUNCTION
-                  rand
-                  1
-               0.1
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  ds
-               '2008-04-08'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-7 depends on stages: Stage-1 , consists of Stage-4, Stage-3, Stage-5
diff --git a/ql/src/test/results/clientpositive/rand_partitionpruner3.q.out b/ql/src/test/results/clientpositive/rand_partitionpruner3.q.out
index 9ee3462a38..a2a06b2a53 100644
--- a/ql/src/test/results/clientpositive/rand_partitionpruner3.q.out
+++ b/ql/src/test/results/clientpositive/rand_partitionpruner3.q.out
@@ -6,56 +6,6 @@ POSTHOOK: query: -- complex predicates in the where clause
 
 explain extended select a.* from srcpart a where rand(1) < 0.1 and a.ds = '2008-04-08' and not(key > 50 or key < 10) and a.hr like '%2'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-         a
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-               TOK_TABNAME
-                  a
-      TOK_WHERE
-         and
-            and
-               and
-                  <
-                     TOK_FUNCTION
-                        rand
-                        1
-                     0.1
-                  =
-                     .
-                        TOK_TABLE_OR_COL
-                           a
-                        ds
-                     '2008-04-08'
-               not
-                  or
-                     >
-                        TOK_TABLE_OR_COL
-                           key
-                        50
-                     <
-                        TOK_TABLE_OR_COL
-                           key
-                        10
-            like
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  hr
-               '%2'
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
@@ -144,50 +94,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: -- without rand for comparison
 explain extended select a.* from srcpart a where a.ds = '2008-04-08' and not(key > 50 or key < 10) and a.hr like '%2'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-         a
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-               TOK_TABNAME
-                  a
-      TOK_WHERE
-         and
-            and
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     ds
-                  '2008-04-08'
-               not
-                  or
-                     >
-                        TOK_TABLE_OR_COL
-                           key
-                        50
-                     <
-                        TOK_TABLE_OR_COL
-                           key
-                        10
-            like
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  hr
-               '%2'
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
diff --git a/ql/src/test/results/clientpositive/reduce_deduplicate.q.out b/ql/src/test/results/clientpositive/reduce_deduplicate.q.out
index 96b51d7fd5..379f884bf5 100644
--- a/ql/src/test/results/clientpositive/reduce_deduplicate.q.out
+++ b/ql/src/test/results/clientpositive/reduce_deduplicate.q.out
@@ -14,26 +14,6 @@ POSTHOOK: query: explain extended
 insert overwrite table bucket5_1
 select * from src cluster by key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            src
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucket5_1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_CLUSTERBY
-         TOK_TABLE_OR_COL
-            key
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -248,133 +228,6 @@ select s2.* from
 )s
 )s2
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_QUERY
-            TOK_FROM
-               TOK_SUBQUERY
-                  TOK_QUERY
-                     TOK_FROM
-                        TOK_TABREF
-                           TOK_TABNAME
-                              complex_tbl_2
-                     TOK_INSERT
-                        TOK_DESTINATION
-                           TOK_DIR
-                              TOK_TMP_FILE
-                        TOK_SELECT
-                           TOK_SELEXPR
-                              TOK_TRANSFORM
-                                 TOK_EXPLIST
-                                    TOK_TABLE_OR_COL
-                                       aet
-                                    TOK_TABLE_OR_COL
-                                       aes
-                                 TOK_SERDE
-                                 TOK_RECORDWRITER
-                                 'cat'
-                                 TOK_SERDE
-                                 TOK_RECORDREADER
-                                 TOK_TABCOLLIST
-                                    TOK_TABCOL
-                                       aid
-                                       TOK_STRING
-                                    TOK_TABCOL
-                                       bid
-                                       TOK_STRING
-                                    TOK_TABCOL
-                                       t
-                                       TOK_INT
-                                    TOK_TABCOL
-                                       ctime
-                                       TOK_STRING
-                                    TOK_TABCOL
-                                       etime
-                                       TOK_BIGINT
-                                    TOK_TABCOL
-                                       l
-                                       TOK_STRING
-                                    TOK_TABCOL
-                                       et
-                                       TOK_STRING
-                        TOK_WHERE
-                           =
-                              TOK_TABLE_OR_COL
-                                 ds
-                              '2010-03-29'
-                        TOK_CLUSTERBY
-                           TOK_TABLE_OR_COL
-                              bid
-                  s
-            TOK_INSERT
-               TOK_DESTINATION
-                  TOK_DIR
-                     TOK_TMP_FILE
-               TOK_SELECT
-                  TOK_SELEXPR
-                     TOK_TRANSFORM
-                        TOK_EXPLIST
-                           TOK_TABLE_OR_COL
-                              aid
-                           TOK_TABLE_OR_COL
-                              bid
-                           TOK_TABLE_OR_COL
-                              t
-                           TOK_TABLE_OR_COL
-                              ctime
-                           TOK_TABLE_OR_COL
-                              etime
-                           TOK_TABLE_OR_COL
-                              l
-                           TOK_TABLE_OR_COL
-                              et
-                        TOK_SERDE
-                        TOK_RECORDWRITER
-                        'cat'
-                        TOK_SERDE
-                        TOK_RECORDREADER
-                        TOK_TABCOLLIST
-                           TOK_TABCOL
-                              aid
-                              TOK_STRING
-                           TOK_TABCOL
-                              bid
-                              TOK_STRING
-                           TOK_TABCOL
-                              t
-                              TOK_INT
-                           TOK_TABCOL
-                              ctime
-                              TOK_STRING
-                           TOK_TABCOL
-                              etime
-                              TOK_BIGINT
-                           TOK_TABCOL
-                              l
-                              TOK_STRING
-                           TOK_TABCOL
-                              et
-                              TOK_STRING
-         s2
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               complex_tbl_1
-            TOK_PARTSPEC
-               TOK_PARTVAL
-                  ds
-                  '2010-03-29'
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-               TOK_TABNAME
-                  s2
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/router_join_ppr.q.out b/ql/src/test/results/clientpositive/router_join_ppr.q.out
index f149058f2b..1f79be9a10 100644
--- a/ql/src/test/results/clientpositive/router_join_ppr.q.out
+++ b/ql/src/test/results/clientpositive/router_join_ppr.q.out
@@ -20,90 +20,6 @@ EXPLAIN EXTENDED
  SELECT a.key, a.value, b.key, b.value
  WHERE a.key > 10 AND a.key < 20 AND b.key > 15 AND b.key < 25
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_RIGHTOUTERJOIN
-         TOK_TABREF
-            TOK_TABNAME
-               src
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcpart
-            b
-         AND
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  ds
-               '2008-04-08'
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-      TOK_WHERE
-         AND
-            AND
-               AND
-                  >
-                     .
-                        TOK_TABLE_OR_COL
-                           a
-                        key
-                     10
-                  <
-                     .
-                        TOK_TABLE_OR_COL
-                           a
-                        key
-                     20
-               >
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-                  15
-            <
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-               25
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -499,90 +415,6 @@ POSTHOOK: query: EXPLAIN EXTENDED
  SELECT a.key, a.value, b.key, b.value
  WHERE a.key > 10 AND a.key < 20 AND b.key > 15 AND b.key < 25
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_RIGHTOUTERJOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcpart
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               src
-            b
-         AND
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  ds
-               '2008-04-08'
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-      TOK_WHERE
-         AND
-            AND
-               AND
-                  >
-                     .
-                        TOK_TABLE_OR_COL
-                           a
-                        key
-                     10
-                  <
-                     .
-                        TOK_TABLE_OR_COL
-                           a
-                        key
-                     20
-               >
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-                  15
-            <
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-               25
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -879,90 +711,6 @@ POSTHOOK: query: EXPLAIN EXTENDED
  SELECT a.key, a.value, b.key, b.value
  WHERE a.key > 10 AND a.key < 20 AND b.key > 15 AND b.key < 25 AND b.ds = '2008-04-08'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_RIGHTOUTERJOIN
-         TOK_TABREF
-            TOK_TABNAME
-               src
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcpart
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-      TOK_WHERE
-         AND
-            AND
-               AND
-                  AND
-                     >
-                        .
-                           TOK_TABLE_OR_COL
-                              a
-                           key
-                        10
-                     <
-                        .
-                           TOK_TABLE_OR_COL
-                              a
-                           key
-                        20
-                  >
-                     .
-                        TOK_TABLE_OR_COL
-                           b
-                        key
-                     15
-               <
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-                  25
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  ds
-               '2008-04-08'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1255,90 +1003,6 @@ POSTHOOK: query: EXPLAIN EXTENDED
  SELECT a.key, a.value, b.key, b.value
  WHERE a.key > 10 AND a.key < 20 AND b.key > 15 AND b.key < 25 AND a.ds = '2008-04-08'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_RIGHTOUTERJOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcpart
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               src
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-      TOK_WHERE
-         AND
-            AND
-               AND
-                  AND
-                     >
-                        .
-                           TOK_TABLE_OR_COL
-                              a
-                           key
-                        10
-                     <
-                        .
-                           TOK_TABLE_OR_COL
-                              a
-                           key
-                        20
-                  >
-                     .
-                        TOK_TABLE_OR_COL
-                           b
-                        key
-                     15
-               <
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-                  25
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  ds
-               '2008-04-08'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/sample1.q.out b/ql/src/test/results/clientpositive/sample1.q.out
index caf62f4e12..e188902906 100644
--- a/ql/src/test/results/clientpositive/sample1.q.out
+++ b/ql/src/test/results/clientpositive/sample1.q.out
@@ -18,45 +18,6 @@ INSERT OVERWRITE TABLE dest1 SELECT s.*
 FROM srcpart TABLESAMPLE (BUCKET 1 OUT OF 1 ON rand()) s
 WHERE s.ds='2008-04-08' and s.hr='11'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-         TOK_TABLEBUCKETSAMPLE
-            1
-            1
-            TOK_FUNCTION
-               rand
-         s
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dest1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-               TOK_TABNAME
-                  s
-      TOK_WHERE
-         and
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     s
-                  ds
-               '2008-04-08'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     s
-                  hr
-               '11'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-7 depends on stages: Stage-1 , consists of Stage-4, Stage-3, Stage-5
diff --git a/ql/src/test/results/clientpositive/sample10.q.out b/ql/src/test/results/clientpositive/sample10.q.out
index bf0cb5996c..3d0b88faae 100644
--- a/ql/src/test/results/clientpositive/sample10.q.out
+++ b/ql/src/test/results/clientpositive/sample10.q.out
@@ -43,45 +43,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select ds, count(1) from srcpartbucket tablesample (bucket 1 out of 4 on key) where ds is not null group by ds ORDER BY ds ASC
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpartbucket
-         TOK_TABLEBUCKETSAMPLE
-            1
-            4
-            TOK_TABLE_OR_COL
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_WHERE
-         TOK_FUNCTION
-            TOK_ISNOTNULL
-            TOK_TABLE_OR_COL
-               ds
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            ds
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  ds
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/sample2.q.out b/ql/src/test/results/clientpositive/sample2.q.out
index e70edd75ec..9653c41f86 100644
--- a/ql/src/test/results/clientpositive/sample2.q.out
+++ b/ql/src/test/results/clientpositive/sample2.q.out
@@ -18,29 +18,6 @@ EXPLAIN EXTENDED
 INSERT OVERWRITE TABLE dest1 SELECT s.* 
 FROM srcbucket TABLESAMPLE (BUCKET 1 OUT OF 2) s
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcbucket
-         TOK_TABLEBUCKETSAMPLE
-            1
-            2
-         s
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dest1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-               TOK_TABNAME
-                  s
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-7 depends on stages: Stage-1 , consists of Stage-4, Stage-3, Stage-5
diff --git a/ql/src/test/results/clientpositive/sample4.q.out b/ql/src/test/results/clientpositive/sample4.q.out
index 90dfc261af..a9730b137d 100644
--- a/ql/src/test/results/clientpositive/sample4.q.out
+++ b/ql/src/test/results/clientpositive/sample4.q.out
@@ -18,31 +18,6 @@ EXPLAIN EXTENDED
 INSERT OVERWRITE TABLE dest1 SELECT s.*
 FROM srcbucket TABLESAMPLE (BUCKET 1 OUT OF 2 on key) s
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcbucket
-         TOK_TABLEBUCKETSAMPLE
-            1
-            2
-            TOK_TABLE_OR_COL
-               key
-         s
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dest1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-               TOK_TABNAME
-                  s
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-7 depends on stages: Stage-1 , consists of Stage-4, Stage-3, Stage-5
diff --git a/ql/src/test/results/clientpositive/sample5.q.out b/ql/src/test/results/clientpositive/sample5.q.out
index 04aa8ccf9a..d5ff403b5e 100644
--- a/ql/src/test/results/clientpositive/sample5.q.out
+++ b/ql/src/test/results/clientpositive/sample5.q.out
@@ -20,31 +20,6 @@ EXPLAIN EXTENDED
 INSERT OVERWRITE TABLE dest1 SELECT s.* -- here's another test
 FROM srcbucket TABLESAMPLE (BUCKET 1 OUT OF 5 on key) s
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcbucket
-         TOK_TABLEBUCKETSAMPLE
-            1
-            5
-            TOK_TABLE_OR_COL
-               key
-         s
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dest1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-               TOK_TABNAME
-                  s
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-7 depends on stages: Stage-1 , consists of Stage-4, Stage-3, Stage-5
diff --git a/ql/src/test/results/clientpositive/sample6.q.out b/ql/src/test/results/clientpositive/sample6.q.out
index c2be9d6b08..ea71ad6d54 100644
--- a/ql/src/test/results/clientpositive/sample6.q.out
+++ b/ql/src/test/results/clientpositive/sample6.q.out
@@ -16,31 +16,6 @@ EXPLAIN EXTENDED
 INSERT OVERWRITE TABLE dest1 SELECT s.*
 FROM srcbucket TABLESAMPLE (BUCKET 1 OUT OF 4 on key) s
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcbucket
-         TOK_TABLEBUCKETSAMPLE
-            1
-            4
-            TOK_TABLE_OR_COL
-               key
-         s
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dest1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-               TOK_TABNAME
-                  s
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-7 depends on stages: Stage-1 , consists of Stage-4, Stage-3, Stage-5
@@ -600,39 +575,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN EXTENDED SELECT s.* FROM srcbucket TABLESAMPLE (BUCKET 4 OUT OF 4 on key) s
 ORDER BY key, value
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcbucket
-         TOK_TABLEBUCKETSAMPLE
-            4
-            4
-            TOK_TABLE_OR_COL
-               key
-         s
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-               TOK_TABNAME
-                  s
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  key
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  value
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1002,39 +944,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN EXTENDED SELECT s.* FROM srcbucket TABLESAMPLE (BUCKET 1 OUT OF 2 on key) s
 ORDER BY key, value
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcbucket
-         TOK_TABLEBUCKETSAMPLE
-            1
-            2
-            TOK_TABLE_OR_COL
-               key
-         s
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-               TOK_TABNAME
-                  s
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  key
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  value
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1658,39 +1567,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN EXTENDED SELECT s.* FROM srcbucket TABLESAMPLE (BUCKET 1 OUT OF 3 on key) s
 ORDER BY key, value
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcbucket
-         TOK_TABLEBUCKETSAMPLE
-            1
-            3
-            TOK_TABLE_OR_COL
-               key
-         s
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-               TOK_TABNAME
-                  s
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  key
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  value
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -2156,39 +2032,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN EXTENDED SELECT s.* FROM srcbucket TABLESAMPLE (BUCKET 2 OUT OF 3 on key) s
 ORDER BY key, value
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcbucket
-         TOK_TABLEBUCKETSAMPLE
-            2
-            3
-            TOK_TABLE_OR_COL
-               key
-         s
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-               TOK_TABNAME
-                  s
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  key
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  value
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -2640,39 +2483,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN EXTENDED SELECT s.* FROM srcbucket2 TABLESAMPLE (BUCKET 1 OUT OF 2 on key) s
 ORDER BY key, value
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcbucket2
-         TOK_TABLEBUCKETSAMPLE
-            1
-            2
-            TOK_TABLE_OR_COL
-               key
-         s
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-               TOK_TABNAME
-                  s
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  key
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  value
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -2972,39 +2782,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN EXTENDED SELECT s.* FROM srcbucket2 TABLESAMPLE (BUCKET 2 OUT OF 4 on key) s
 ORDER BY key, value
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcbucket2
-         TOK_TABLEBUCKETSAMPLE
-            2
-            4
-            TOK_TABLE_OR_COL
-               key
-         s
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-               TOK_TABNAME
-                  s
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  key
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  value
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -3181,39 +2958,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN EXTENDED SELECT s.* FROM empty_bucket TABLESAMPLE (BUCKET 1 OUT OF 2 on key) s
 ORDER BY key, value
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            empty_bucket
-         TOK_TABLEBUCKETSAMPLE
-            1
-            2
-            TOK_TABLE_OR_COL
-               key
-         s
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-               TOK_TABNAME
-                  s
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  key
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  value
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/sample7.q.out b/ql/src/test/results/clientpositive/sample7.q.out
index e1897eec26..94618e5a6a 100644
--- a/ql/src/test/results/clientpositive/sample7.q.out
+++ b/ql/src/test/results/clientpositive/sample7.q.out
@@ -18,38 +18,6 @@ INSERT OVERWRITE TABLE dest1 SELECT s.*
 FROM srcbucket TABLESAMPLE (BUCKET 1 OUT OF 4 on key) s
 WHERE s.key > 100
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcbucket
-         TOK_TABLEBUCKETSAMPLE
-            1
-            4
-            TOK_TABLE_OR_COL
-               key
-         s
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dest1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-               TOK_TABNAME
-                  s
-      TOK_WHERE
-         >
-            .
-               TOK_TABLE_OR_COL
-                  s
-               key
-            100
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-7 depends on stages: Stage-1 , consists of Stage-4, Stage-3, Stage-5
diff --git a/ql/src/test/results/clientpositive/sample8.q.out b/ql/src/test/results/clientpositive/sample8.q.out
index 3f50ed241a..dd55fa037f 100644
--- a/ql/src/test/results/clientpositive/sample8.q.out
+++ b/ql/src/test/results/clientpositive/sample8.q.out
@@ -16,74 +16,6 @@ FROM srcpart TABLESAMPLE (BUCKET 1 OUT OF 1 ON key) s
 JOIN srcpart TABLESAMPLE (BUCKET 1 OUT OF 10 ON key) t
 WHERE t.key = s.key and t.value = s.value and s.ds='2008-04-08' and s.hr='11'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcpart
-            TOK_TABLEBUCKETSAMPLE
-               1
-               1
-               TOK_TABLE_OR_COL
-                  key
-            s
-         TOK_TABREF
-            TOK_TABNAME
-               srcpart
-            TOK_TABLEBUCKETSAMPLE
-               1
-               10
-               TOK_TABLE_OR_COL
-                  key
-            t
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-               TOK_TABNAME
-                  s
-      TOK_WHERE
-         and
-            and
-               and
-                  =
-                     .
-                        TOK_TABLE_OR_COL
-                           t
-                        key
-                     .
-                        TOK_TABLE_OR_COL
-                           s
-                        key
-                  =
-                     .
-                        TOK_TABLE_OR_COL
-                           t
-                        value
-                     .
-                        TOK_TABLE_OR_COL
-                           s
-                        value
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        s
-                     ds
-                  '2008-04-08'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     s
-                  hr
-               '11'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/sample9.q.out b/ql/src/test/results/clientpositive/sample9.q.out
index b5bce0b011..14a512a4fe 100644
--- a/ql/src/test/results/clientpositive/sample9.q.out
+++ b/ql/src/test/results/clientpositive/sample9.q.out
@@ -6,43 +6,6 @@ POSTHOOK: query: EXPLAIN EXTENDED
 SELECT s.*
 FROM (SELECT a.* FROM srcbucket TABLESAMPLE (BUCKET 1 OUT OF 2 on key) a) s
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_QUERY
-            TOK_FROM
-               TOK_TABREF
-                  TOK_TABNAME
-                     srcbucket
-                  TOK_TABLEBUCKETSAMPLE
-                     1
-                     2
-                     TOK_TABLE_OR_COL
-                        key
-                  a
-            TOK_INSERT
-               TOK_DESTINATION
-                  TOK_DIR
-                     TOK_TMP_FILE
-               TOK_SELECT
-                  TOK_SELEXPR
-                     TOK_ALLCOLREF
-                        TOK_TABNAME
-                           a
-         s
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-               TOK_TABNAME
-                  s
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/serde_user_properties.q.out b/ql/src/test/results/clientpositive/serde_user_properties.q.out
index 080653d7ab..1dbc27418f 100644
--- a/ql/src/test/results/clientpositive/serde_user_properties.q.out
+++ b/ql/src/test/results/clientpositive/serde_user_properties.q.out
@@ -6,23 +6,6 @@ POSTHOOK: query: -- HIVE-2906 Table properties in SQL
 
 explain extended select key from src
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            src
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
@@ -45,26 +28,6 @@ PREHOOK: query: explain extended select a.key from src a
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select a.key from src a
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            src
-         a
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
@@ -87,29 +50,6 @@ PREHOOK: query: explain extended select a.key from src tablesample(1 percent) a
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select a.key from src tablesample(1 percent) a
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            src
-         TOK_TABLESPLITSAMPLE
-            TOK_PERCENT
-            1
-         a
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -212,28 +152,6 @@ PREHOOK: query: explain extended select key from src ('user.defined.key'='some.v
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select key from src ('user.defined.key'='some.value')
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            src
-         TOK_TABLEPROPERTIES
-            TOK_TABLEPROPLIST
-               TOK_TABLEPROPERTY
-                  'user.defined.key'
-                  'some.value'
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
@@ -256,31 +174,6 @@ PREHOOK: query: explain extended select key from src ('user.defined.key'='some.v
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select key from src ('user.defined.key'='some.value') tablesample(1 percent)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            src
-         TOK_TABLEPROPERTIES
-            TOK_TABLEPROPLIST
-               TOK_TABLEPROPERTY
-                  'user.defined.key'
-                  'some.value'
-         TOK_TABLESPLITSAMPLE
-            TOK_PERCENT
-            1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -385,31 +278,6 @@ PREHOOK: query: explain extended select a.key from src ('user.defined.key'='some
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select a.key from src ('user.defined.key'='some.value') a
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            src
-         TOK_TABLEPROPERTIES
-            TOK_TABLEPROPLIST
-               TOK_TABLEPROPERTY
-                  'user.defined.key'
-                  'some.value'
-         a
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
@@ -432,34 +300,6 @@ PREHOOK: query: explain extended select a.key from src ('user.defined.key'='some
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select a.key from src ('user.defined.key'='some.value') tablesample(1 percent) a
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            src
-         TOK_TABLEPROPERTIES
-            TOK_TABLEPROPLIST
-               TOK_TABLEPROPERTY
-                  'user.defined.key'
-                  'some.value'
-         TOK_TABLESPLITSAMPLE
-            TOK_PERCENT
-            1
-         a
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/smb_mapjoin9.q.out b/ql/src/test/results/clientpositive/smb_mapjoin9.q.out
index ff7c0aa762..45b1884f67 100644
--- a/ql/src/test/results/clientpositive/smb_mapjoin9.q.out
+++ b/ql/src/test/results/clientpositive/smb_mapjoin9.q.out
@@ -28,83 +28,6 @@ FROM hive_test_smb_bucket1 a JOIN
 hive_test_smb_bucket2 b
 ON a.key = b.key WHERE a.ds = '2010-10-15' and b.ds='2010-10-15' and  b.key IS NOT NULL
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               hive_test_smb_bucket1
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               hive_test_smb_bucket2
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-            k1
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               ds
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            k2
-      TOK_WHERE
-         and
-            and
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     ds
-                  '2010-10-15'
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     ds
-                  '2010-10-15'
-            TOK_FUNCTION
-               TOK_ISNOTNULL
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -189,83 +112,6 @@ FROM hive_test_smb_bucket1 a JOIN
 hive_test_smb_bucket2 b
 ON a.key = b.key WHERE a.ds = '2010-10-15' and b.ds='2010-10-15' and  b.key IS NOT NULL
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               hive_test_smb_bucket1
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               hive_test_smb_bucket2
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  a
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-            k1
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               ds
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            k2
-      TOK_WHERE
-         and
-            and
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     ds
-                  '2010-10-15'
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     ds
-                  '2010-10-15'
-            TOK_FUNCTION
-               TOK_ISNOTNULL
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/smb_mapjoin_11.q.out b/ql/src/test/results/clientpositive/smb_mapjoin_11.q.out
index b407402158..30dbc70d76 100644
--- a/ql/src/test/results/clientpositive/smb_mapjoin_11.q.out
+++ b/ql/src/test/results/clientpositive/smb_mapjoin_11.q.out
@@ -56,69 +56,6 @@ POSTHOOK: query: -- Insert data into the bucketed table by joining the two bucke
 EXPLAIN EXTENDED
 INSERT OVERWRITE TABLE test_table3 PARTITION (ds = '1') SELECT /*+ MAPJOIN(b) */ a.key, b.value FROM test_table1 a JOIN test_table2 b ON a.key = b.key AND a.ds = '1' AND b.ds = '1'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               test_table1
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               test_table2
-            b
-         AND
-            AND
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     key
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     ds
-                  '1'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  ds
-               '1'
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               test_table3
-            TOK_PARTSPEC
-               TOK_PARTVAL
-                  ds
-                  '1'
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1842,25 +1779,6 @@ PREHOOK: query: EXPLAIN EXTENDED SELECT * FROM test_table1 TABLESAMPLE(BUCKET 2
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN EXTENDED SELECT * FROM test_table1 TABLESAMPLE(BUCKET 2 OUT OF 16)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            test_table1
-         TOK_TABLEBUCKETSAMPLE
-            2
-            16
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1968,25 +1886,6 @@ PREHOOK: query: EXPLAIN EXTENDED SELECT * FROM test_table3 TABLESAMPLE(BUCKET 2
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN EXTENDED SELECT * FROM test_table3 TABLESAMPLE(BUCKET 2 OUT OF 16)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            test_table3
-         TOK_TABLEBUCKETSAMPLE
-            2
-            16
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/smb_mapjoin_12.q.out b/ql/src/test/results/clientpositive/smb_mapjoin_12.q.out
index e2723a0dd0..519faf6028 100644
--- a/ql/src/test/results/clientpositive/smb_mapjoin_12.q.out
+++ b/ql/src/test/results/clientpositive/smb_mapjoin_12.q.out
@@ -68,69 +68,6 @@ POSTHOOK: query: -- Insert data into the bucketed table by joining the two bucke
 EXPLAIN EXTENDED
 INSERT OVERWRITE TABLE test_table3 PARTITION (ds = '1') SELECT /*+ MAPJOIN(b) */ a.key, b.value FROM test_table1 a JOIN test_table2 b ON a.key = b.key AND a.ds = '1' AND b.ds >= '1'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               test_table1
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               test_table2
-            b
-         AND
-            AND
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     key
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     ds
-                  '1'
-            >=
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  ds
-               '1'
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               test_table3
-            TOK_PARTSPEC
-               TOK_PARTVAL
-                  ds
-                  '1'
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -323,75 +260,6 @@ explain extended
 INSERT OVERWRITE TABLE test_table3 PARTITION (ds = '2') 
 SELECT /*+mapjoin(b)*/ a.key, concat(a.value, b.value) FROM test_table3 a JOIN test_table1 b ON a.key = b.key AND a.ds = '1' AND b.ds='1'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               test_table3
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               test_table1
-            b
-         AND
-            AND
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     key
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     ds
-                  '1'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  ds
-               '1'
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               test_table3
-            TOK_PARTSPEC
-               TOK_PARTVAL
-                  ds
-                  '2'
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            TOK_FUNCTION
-               concat
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  value
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  value
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/smb_mapjoin_13.q.out b/ql/src/test/results/clientpositive/smb_mapjoin_13.q.out
index a5a60e4664..f0f8af8f76 100644
--- a/ql/src/test/results/clientpositive/smb_mapjoin_13.q.out
+++ b/ql/src/test/results/clientpositive/smb_mapjoin_13.q.out
@@ -76,51 +76,6 @@ POSTHOOK: query: -- Join data from 2 tables on their respective sorted columns (
 EXPLAIN EXTENDED
 SELECT /*+mapjoin(b)*/ * FROM test_table1 a JOIN test_table2 b ON a.key = b.value ORDER BY a.key LIMIT 10
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               test_table1
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               test_table2
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-      TOK_LIMIT
-         10
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -276,51 +231,6 @@ POSTHOOK: query: -- Join data from 2 tables on their respective columns (two eac
 EXPLAIN EXTENDED
 SELECT /*+mapjoin(b)*/ * FROM test_table3 a JOIN test_table4 b ON a.key = b.value ORDER BY a.key LIMIT 10
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               test_table3
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               test_table4
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-      TOK_LIMIT
-         10
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
diff --git a/ql/src/test/results/clientpositive/smb_mapjoin_15.q.out b/ql/src/test/results/clientpositive/smb_mapjoin_15.q.out
index cdf235957a..1474e4986c 100644
--- a/ql/src/test/results/clientpositive/smb_mapjoin_15.q.out
+++ b/ql/src/test/results/clientpositive/smb_mapjoin_15.q.out
@@ -48,51 +48,6 @@ POSTHOOK: query: -- it should be converted to a sort-merge join, since the first
 EXPLAIN EXTENDED
 SELECT /*+mapjoin(b)*/ * FROM test_table1 a JOIN test_table2 b ON a.key = b.key ORDER BY a.key LIMIT 10
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               test_table1
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               test_table2
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-      TOK_LIMIT
-         10
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -300,61 +255,6 @@ POSTHOOK: query: -- it should be converted to a sort-merge join, since the first
 EXPLAIN EXTENDED
 SELECT /*+mapjoin(b)*/ * FROM test_table1 a JOIN test_table2 b ON a.key = b.key and a.key2 = b.key2 ORDER BY a.key LIMIT 10
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               test_table1
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               test_table2
-            b
-         and
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key2
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key2
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-      TOK_LIMIT
-         10
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -510,61 +410,6 @@ POSTHOOK: query: -- it should be converted to a sort-merge join, since the first
 EXPLAIN EXTENDED
 SELECT /*+mapjoin(b)*/ * FROM test_table1 a JOIN test_table2 b ON a.key2 = b.key2 and a.key = b.key ORDER BY a.key LIMIT 10
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               test_table1
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               test_table2
-            b
-         and
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key2
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key2
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-      TOK_LIMIT
-         10
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -720,61 +565,6 @@ POSTHOOK: query: -- it should not be converted to a sort-merge join, since the f
 EXPLAIN EXTENDED
 SELECT /*+mapjoin(b)*/ * FROM test_table1 a JOIN test_table2 b ON a.key = b.key and a.value = b.value ORDER BY a.key LIMIT 10
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               test_table1
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               test_table2
-            b
-         and
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  value
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  value
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-      TOK_LIMIT
-         10
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
diff --git a/ql/src/test/results/clientpositive/sort_merge_join_desc_5.q.out b/ql/src/test/results/clientpositive/sort_merge_join_desc_5.q.out
index 29dee15d3b..687d8923c7 100644
--- a/ql/src/test/results/clientpositive/sort_merge_join_desc_5.q.out
+++ b/ql/src/test/results/clientpositive/sort_merge_join_desc_5.q.out
@@ -60,57 +60,6 @@ SELECT /*+ MAPJOIN(b) */ count(*)
 FROM srcbucket_mapjoin_part_1 a JOIN srcbucket_mapjoin_part_2 b
 ON a.key = b.key AND a.part = '1' AND b.part = '1'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_1
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            b
-         AND
-            AND
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     key
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     part
-                  '1'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  part
-               '1'
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/sort_merge_join_desc_6.q.out b/ql/src/test/results/clientpositive/sort_merge_join_desc_6.q.out
index b1f99e56db..06027d8899 100644
--- a/ql/src/test/results/clientpositive/sort_merge_join_desc_6.q.out
+++ b/ql/src/test/results/clientpositive/sort_merge_join_desc_6.q.out
@@ -60,57 +60,6 @@ SELECT /*+ MAPJOIN(b) */ count(*)
 FROM srcbucket_mapjoin_part_1 a JOIN srcbucket_mapjoin_part_2 b
 ON a.key = b.key AND a.part = '1' AND b.part = '1'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_1
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            b
-         AND
-            AND
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     key
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     part
-                  '1'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  part
-               '1'
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
diff --git a/ql/src/test/results/clientpositive/sort_merge_join_desc_7.q.out b/ql/src/test/results/clientpositive/sort_merge_join_desc_7.q.out
index f788fec8bd..8bbcdd3fc4 100644
--- a/ql/src/test/results/clientpositive/sort_merge_join_desc_7.q.out
+++ b/ql/src/test/results/clientpositive/sort_merge_join_desc_7.q.out
@@ -96,57 +96,6 @@ SELECT /*+ MAPJOIN(b) */ count(*)
 FROM srcbucket_mapjoin_part_1 a JOIN srcbucket_mapjoin_part_2 b
 ON a.key = b.key AND a.part IS NOT NULL AND b.part IS NOT NULL
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_1
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            b
-         AND
-            AND
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     key
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-               TOK_FUNCTION
-                  TOK_ISNOTNULL
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     part
-            TOK_FUNCTION
-               TOK_ISNOTNULL
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  part
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
diff --git a/ql/src/test/results/clientpositive/spark/auto_join_reordering_values.q.out b/ql/src/test/results/clientpositive/spark/auto_join_reordering_values.q.out
index ea388268b8..4e5bd92901 100644
--- a/ql/src/test/results/clientpositive/spark/auto_join_reordering_values.q.out
+++ b/ql/src/test/results/clientpositive/spark/auto_join_reordering_values.q.out
@@ -84,89 +84,6 @@ JOIN `orderpayment_small` `order_city` ON `order_city`.`cityid` = `orderpayment`
 JOIN `user_small` `user` ON `user`.`userid` = `orderpayment`.`userid`
 limit 5
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_JOIN
-            TOK_JOIN
-               TOK_JOIN
-                  TOK_TABREF
-                     TOK_TABNAME
-                        orderpayment_small
-                     orderpayment
-                  TOK_TABREF
-                     TOK_TABNAME
-                        orderpayment_small
-                     dim_pay_date
-                  =
-                     .
-                        TOK_TABLE_OR_COL
-                           dim_pay_date
-                        date
-                     .
-                        TOK_TABLE_OR_COL
-                           orderpayment
-                        date
-               TOK_TABREF
-                  TOK_TABNAME
-                     orderpayment_small
-                  deal
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        deal
-                     dealid
-                  .
-                     TOK_TABLE_OR_COL
-                        orderpayment
-                     dealid
-            TOK_TABREF
-               TOK_TABNAME
-                  orderpayment_small
-               order_city
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     order_city
-                  cityid
-               .
-                  TOK_TABLE_OR_COL
-                     orderpayment
-                  cityid
-         TOK_TABREF
-            TOK_TABNAME
-               user_small
-            user
-         =
-            .
-               TOK_TABLE_OR_COL
-                  user
-               userid
-            .
-               TOK_TABLE_OR_COL
-                  orderpayment
-               userid
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  dim_pay_date
-               date
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  deal
-               dealid
-      TOK_LIMIT
-         5
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_1.q.out b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_1.q.out
index c32a0dd855..dfb571d2c0 100644
--- a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_1.q.out
+++ b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_1.q.out
@@ -109,38 +109,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: -- Since size is being used to find the big table, the order of the tables in the join does not matter
 explain extended select count(*) FROM bucket_small a JOIN bucket_big b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -341,38 +309,6 @@ PREHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_s
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_small b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -573,38 +509,6 @@ PREHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_s
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_small b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-1 depends on stages: Stage-2
diff --git a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_12.q.out b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_12.q.out
index d004ff361e..76ea0a830c 100644
--- a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_12.q.out
+++ b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_12.q.out
@@ -143,66 +143,6 @@ PREHOOK: query: explain extended select count(*) FROM bucket_small a JOIN bucket
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select count(*) FROM bucket_small a JOIN bucket_medium b ON a.key = b.key JOIN bucket_big c ON c.key = b.key JOIN bucket_medium d ON c.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_JOIN
-            TOK_JOIN
-               TOK_TABREF
-                  TOK_TABNAME
-                     bucket_small
-                  a
-               TOK_TABREF
-                  TOK_TABNAME
-                     bucket_medium
-                  b
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     key
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-            TOK_TABREF
-               TOK_TABNAME
-                  bucket_big
-               c
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     c
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_medium
-            d
-         =
-            .
-               TOK_TABLE_OR_COL
-                  c
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-1 depends on stages: Stage-2
diff --git a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_3.q.out b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_3.q.out
index 00d5138984..c942d113cd 100644
--- a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_3.q.out
+++ b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_3.q.out
@@ -89,38 +89,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: -- Since size is being used to find the big table, the order of the tables in the join does not matter
 explain extended select count(*) FROM bucket_small a JOIN bucket_big b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -275,38 +243,6 @@ PREHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_s
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_small b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -461,38 +397,6 @@ PREHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_s
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_small b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-1 depends on stages: Stage-2
diff --git a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_4.q.out b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_4.q.out
index b06df04cd1..ba2547a308 100644
--- a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_4.q.out
+++ b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_4.q.out
@@ -105,38 +105,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: -- Since size is being used to find the big table, the order of the tables in the join does not matter
 explain extended select count(*) FROM bucket_small a JOIN bucket_big b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -291,38 +259,6 @@ PREHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_s
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_small b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -477,38 +413,6 @@ PREHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_s
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_small b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-1 depends on stages: Stage-2
diff --git a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_5.q.out b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_5.q.out
index 18ab5c8881..99fca25072 100644
--- a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_5.q.out
+++ b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_5.q.out
@@ -76,38 +76,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: -- Since size is being used to find the big table, the order of the tables in the join does not matter
 explain extended select count(*) FROM bucket_small a JOIN bucket_big b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -253,38 +221,6 @@ PREHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_s
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_small b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -430,38 +366,6 @@ PREHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_s
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_small b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-1 depends on stages: Stage-2
diff --git a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_7.q.out b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_7.q.out
index dd01e6980e..00c601f36d 100644
--- a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_7.q.out
+++ b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_7.q.out
@@ -122,38 +122,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: -- Since size is being used to find the big table, the order of the tables in the join does not matter
 explain extended select count(*) FROM bucket_small a JOIN bucket_big b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -356,38 +324,6 @@ PREHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_s
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_small b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -590,38 +526,6 @@ PREHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_s
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_small b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-1 depends on stages: Stage-2
diff --git a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_8.q.out b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_8.q.out
index f0f27f0036..5564ceb1c9 100644
--- a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_8.q.out
+++ b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_8.q.out
@@ -122,38 +122,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: -- Since size is being used to find the big table, the order of the tables in the join does not matter
 explain extended select count(*) FROM bucket_small a JOIN bucket_big b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -356,38 +324,6 @@ PREHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_s
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_small b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -592,38 +528,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: -- The mapjoin should fail resulting in the sort-merge join
 explain extended select count(*) FROM bucket_big a JOIN bucket_small b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-1 depends on stages: Stage-2
diff --git a/ql/src/test/results/clientpositive/spark/bucket2.q.out b/ql/src/test/results/clientpositive/spark/bucket2.q.out
index f4f87c20cd..aa474595a9 100644
--- a/ql/src/test/results/clientpositive/spark/bucket2.q.out
+++ b/ql/src/test/results/clientpositive/spark/bucket2.q.out
@@ -18,23 +18,6 @@ POSTHOOK: query: explain extended
 insert overwrite table bucket2_1
 select * from src
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            src
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucket2_1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/spark/bucket3.q.out b/ql/src/test/results/clientpositive/spark/bucket3.q.out
index 96b2818c14..39d9c333ab 100644
--- a/ql/src/test/results/clientpositive/spark/bucket3.q.out
+++ b/ql/src/test/results/clientpositive/spark/bucket3.q.out
@@ -18,27 +18,6 @@ POSTHOOK: query: explain extended
 insert overwrite table bucket3_1 partition (ds='1')
 select * from src
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            src
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucket3_1
-            TOK_PARTSPEC
-               TOK_PARTVAL
-                  ds
-                  '1'
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/spark/bucket4.q.out b/ql/src/test/results/clientpositive/spark/bucket4.q.out
index 4049f2228d..680cee7823 100644
--- a/ql/src/test/results/clientpositive/spark/bucket4.q.out
+++ b/ql/src/test/results/clientpositive/spark/bucket4.q.out
@@ -14,23 +14,6 @@ POSTHOOK: query: explain extended
 insert overwrite table bucket4_1
 select * from src
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            src
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucket4_1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/spark/bucket5.q.out b/ql/src/test/results/clientpositive/spark/bucket5.q.out
index 5baf054642..0504eac42f 100644
--- a/ql/src/test/results/clientpositive/spark/bucket5.q.out
+++ b/ql/src/test/results/clientpositive/spark/bucket5.q.out
@@ -30,42 +30,6 @@ FROM src
 INSERT OVERWRITE TABLE bucketed_table SELECT key, value
 INSERT OVERWRITE TABLE unbucketed_table SELECT key, value cluster by key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            src
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucketed_table
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               unbucketed_table
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-      TOK_CLUSTERBY
-         TOK_TABLE_OR_COL
-            key
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-0 depends on stages: Stage-2
diff --git a/ql/src/test/results/clientpositive/spark/bucket_map_join_1.q.out b/ql/src/test/results/clientpositive/spark/bucket_map_join_1.q.out
index fd17425e3e..299cedf0ef 100644
--- a/ql/src/test/results/clientpositive/spark/bucket_map_join_1.q.out
+++ b/ql/src/test/results/clientpositive/spark/bucket_map_join_1.q.out
@@ -56,53 +56,6 @@ POSTHOOK: query: -- The tables are bucketed in same columns in different order,
 explain extended
 select /*+ mapjoin(b) */ count(*) from table1 a join table2 b on a.key=b.key and a.value=b.value
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               table1
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               table2
-            b
-         and
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  value
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  value
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-1 depends on stages: Stage-2
diff --git a/ql/src/test/results/clientpositive/spark/bucket_map_join_2.q.out b/ql/src/test/results/clientpositive/spark/bucket_map_join_2.q.out
index 4884907d9f..f330bf293b 100644
--- a/ql/src/test/results/clientpositive/spark/bucket_map_join_2.q.out
+++ b/ql/src/test/results/clientpositive/spark/bucket_map_join_2.q.out
@@ -56,53 +56,6 @@ POSTHOOK: query: -- The tables are bucketed in same columns in different order,
 explain extended
 select /*+ mapjoin(b) */ count(*) from table1 a join table2 b on a.key=b.key and a.value=b.value
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               table1
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               table2
-            b
-         and
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  value
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  value
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-1 depends on stages: Stage-2
diff --git a/ql/src/test/results/clientpositive/spark/bucket_map_join_spark1.q.out b/ql/src/test/results/clientpositive/spark/bucket_map_join_spark1.q.out
index 3dbfdddc2f..b32528cb75 100644
--- a/ql/src/test/results/clientpositive/spark/bucket_map_join_spark1.q.out
+++ b/ql/src/test/results/clientpositive/spark/bucket_map_join_spark1.q.out
@@ -116,58 +116,6 @@ select a.key, a.value, b.value
 from srcbucket_mapjoin_part a join srcbucket_mapjoin_part_2 b
 on a.key=b.key and b.ds="2008-04-08"
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            b
-         and
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  ds
-               "2008-04-08"
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucketmapjoin_tmp_result
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
@@ -455,58 +403,6 @@ select a.key, a.value, b.value
 from srcbucket_mapjoin_part a join srcbucket_mapjoin_part_2 b
 on a.key=b.key and b.ds="2008-04-08"
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            b
-         and
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  ds
-               "2008-04-08"
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucketmapjoin_tmp_result
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
diff --git a/ql/src/test/results/clientpositive/spark/bucket_map_join_spark2.q.out b/ql/src/test/results/clientpositive/spark/bucket_map_join_spark2.q.out
index 216c0bd5df..7b304c54c7 100644
--- a/ql/src/test/results/clientpositive/spark/bucket_map_join_spark2.q.out
+++ b/ql/src/test/results/clientpositive/spark/bucket_map_join_spark2.q.out
@@ -100,58 +100,6 @@ select a.key, a.value, b.value
 from srcbucket_mapjoin_part a join srcbucket_mapjoin_part_2 b
 on a.key=b.key and b.ds="2008-04-08"
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            b
-         and
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  ds
-               "2008-04-08"
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucketmapjoin_tmp_result
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
@@ -439,58 +387,6 @@ select a.key, a.value, b.value
 from srcbucket_mapjoin_part a join srcbucket_mapjoin_part_2 b
 on a.key=b.key and b.ds="2008-04-08"
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            b
-         and
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  ds
-               "2008-04-08"
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucketmapjoin_tmp_result
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
diff --git a/ql/src/test/results/clientpositive/spark/bucket_map_join_spark3.q.out b/ql/src/test/results/clientpositive/spark/bucket_map_join_spark3.q.out
index 5bc2ec454c..4265d1a7e4 100644
--- a/ql/src/test/results/clientpositive/spark/bucket_map_join_spark3.q.out
+++ b/ql/src/test/results/clientpositive/spark/bucket_map_join_spark3.q.out
@@ -100,58 +100,6 @@ select a.key, a.value, b.value
 from srcbucket_mapjoin_part a join srcbucket_mapjoin_part_2 b
 on a.key=b.key and b.ds="2008-04-08"
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            b
-         and
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  ds
-               "2008-04-08"
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucketmapjoin_tmp_result
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
@@ -439,58 +387,6 @@ select a.key, a.value, b.value
 from srcbucket_mapjoin_part a join srcbucket_mapjoin_part_2 b
 on a.key=b.key and b.ds="2008-04-08"
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            b
-         and
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  ds
-               "2008-04-08"
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucketmapjoin_tmp_result
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
diff --git a/ql/src/test/results/clientpositive/spark/bucket_map_join_spark4.q.out b/ql/src/test/results/clientpositive/spark/bucket_map_join_spark4.q.out
index d8746cd147..9cd87d263e 100644
--- a/ql/src/test/results/clientpositive/spark/bucket_map_join_spark4.q.out
+++ b/ql/src/test/results/clientpositive/spark/bucket_map_join_spark4.q.out
@@ -70,73 +70,6 @@ POSTHOOK: query: explain extended
 select a.key as key, a.value as val1, b.value as val2, c.value as val3
 from tbl1 a join tbl2 b on a.key = b.key join tbl3 c on a.value = c.value
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_JOIN
-            TOK_TABREF
-               TOK_TABNAME
-                  tbl1
-               a
-            TOK_TABREF
-               TOK_TABNAME
-                  tbl2
-               b
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-         TOK_TABREF
-            TOK_TABNAME
-               tbl3
-            c
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-            .
-               TOK_TABLE_OR_COL
-                  c
-               value
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-            val1
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-            val2
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  c
-               value
-            val3
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-1 depends on stages: Stage-2
@@ -515,73 +448,6 @@ POSTHOOK: query: explain extended
 select a.key as key, a.value as val1, b.value as val2, c.value as val3
 from tbl1 a join tbl2 b on a.key = b.key join tbl3 c on a.value = c.value
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_JOIN
-            TOK_TABREF
-               TOK_TABNAME
-                  tbl1
-               a
-            TOK_TABREF
-               TOK_TABNAME
-                  tbl2
-               b
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-         TOK_TABREF
-            TOK_TABNAME
-               tbl3
-            c
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-            .
-               TOK_TABLE_OR_COL
-                  c
-               value
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-            val1
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-            val2
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  c
-               value
-            val3
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-1 depends on stages: Stage-2
diff --git a/ql/src/test/results/clientpositive/spark/bucketmapjoin1.q.out b/ql/src/test/results/clientpositive/spark/bucketmapjoin1.q.out
index cee6601d9d..c6a7f0e454 100644
--- a/ql/src/test/results/clientpositive/spark/bucketmapjoin1.q.out
+++ b/ql/src/test/results/clientpositive/spark/bucketmapjoin1.q.out
@@ -34,62 +34,6 @@ select /*+mapjoin(b)*/ a.key, a.value, b.value
 from srcbucket_mapjoin_part a join srcbucket_mapjoin_part_2 b
 on a.key=b.key where b.ds="2008-04-08"
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-      TOK_WHERE
-         =
-            .
-               TOK_TABLE_OR_COL
-                  b
-               ds
-            "2008-04-08"
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-1 depends on stages: Stage-2
@@ -209,62 +153,6 @@ select /*+mapjoin(a)*/ a.key, a.value, b.value
 from srcbucket_mapjoin_part a join srcbucket_mapjoin_part_2 b
 on a.key=b.key where b.ds="2008-04-08"
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  a
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-      TOK_WHERE
-         =
-            .
-               TOK_TABLE_OR_COL
-                  b
-               ds
-            "2008-04-08"
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-1 depends on stages: Stage-2
@@ -476,63 +364,6 @@ select /*+mapjoin(b)*/ a.key, a.value, b.value
 from srcbucket_mapjoin a join srcbucket_mapjoin_part b 
 on a.key=b.key where b.ds="2008-04-08"
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucketmapjoin_tmp_result
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-      TOK_WHERE
-         =
-            .
-               TOK_TABLE_OR_COL
-                  b
-               ds
-            "2008-04-08"
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
@@ -864,63 +695,6 @@ select /*+mapjoin(a)*/ a.key, a.value, b.value
 from srcbucket_mapjoin a join srcbucket_mapjoin_part b 
 on a.key=b.key where b.ds="2008-04-08"
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucketmapjoin_tmp_result
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  a
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-      TOK_WHERE
-         =
-            .
-               TOK_TABLE_OR_COL
-                  b
-               ds
-            "2008-04-08"
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
diff --git a/ql/src/test/results/clientpositive/spark/bucketmapjoin10.q.out b/ql/src/test/results/clientpositive/spark/bucketmapjoin10.q.out
index 8764bc3332..0e3b5c7730 100644
--- a/ql/src/test/results/clientpositive/spark/bucketmapjoin10.q.out
+++ b/ql/src/test/results/clientpositive/spark/bucketmapjoin10.q.out
@@ -140,57 +140,6 @@ SELECT /*+ MAPJOIN(b) */ count(*)
 FROM srcbucket_mapjoin_part_1 a JOIN srcbucket_mapjoin_part_2 b
 ON a.key = b.key AND a.part IS NOT NULL AND b.part IS NOT NULL
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_1
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            b
-         AND
-            AND
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     key
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-               TOK_FUNCTION
-                  TOK_ISNOTNULL
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     part
-            TOK_FUNCTION
-               TOK_ISNOTNULL
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  part
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-1 depends on stages: Stage-2
diff --git a/ql/src/test/results/clientpositive/spark/bucketmapjoin11.q.out b/ql/src/test/results/clientpositive/spark/bucketmapjoin11.q.out
index 58ac20c648..38f978506b 100644
--- a/ql/src/test/results/clientpositive/spark/bucketmapjoin11.q.out
+++ b/ql/src/test/results/clientpositive/spark/bucketmapjoin11.q.out
@@ -150,57 +150,6 @@ SELECT /*+ MAPJOIN(b) */ count(*)
 FROM srcbucket_mapjoin_part_1 a JOIN srcbucket_mapjoin_part_2 b
 ON a.key = b.key AND a.part IS NOT NULL AND b.part IS NOT NULL
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_1
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            b
-         AND
-            AND
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     key
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-               TOK_FUNCTION
-                  TOK_ISNOTNULL
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     part
-            TOK_FUNCTION
-               TOK_ISNOTNULL
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  part
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-1 depends on stages: Stage-2
@@ -538,67 +487,6 @@ SELECT /*+ MAPJOIN(b) */ count(*)
 FROM srcbucket_mapjoin_part_1 a JOIN srcbucket_mapjoin_part_2 b
 ON a.key = b.key AND a.part = b.part AND a.part IS NOT NULL AND b.part IS NOT NULL
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_1
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            b
-         AND
-            AND
-               AND
-                  =
-                     .
-                        TOK_TABLE_OR_COL
-                           a
-                        key
-                     .
-                        TOK_TABLE_OR_COL
-                           b
-                        key
-                  =
-                     .
-                        TOK_TABLE_OR_COL
-                           a
-                        part
-                     .
-                        TOK_TABLE_OR_COL
-                           b
-                        part
-               TOK_FUNCTION
-                  TOK_ISNOTNULL
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     part
-            TOK_FUNCTION
-               TOK_ISNOTNULL
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  part
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-1 depends on stages: Stage-2
diff --git a/ql/src/test/results/clientpositive/spark/bucketmapjoin12.q.out b/ql/src/test/results/clientpositive/spark/bucketmapjoin12.q.out
index bde9085f9c..55ded7d4e2 100644
--- a/ql/src/test/results/clientpositive/spark/bucketmapjoin12.q.out
+++ b/ql/src/test/results/clientpositive/spark/bucketmapjoin12.q.out
@@ -109,57 +109,6 @@ SELECT /*+ MAPJOIN(b) */ count(*)
 FROM srcbucket_mapjoin_part_1 a JOIN srcbucket_mapjoin_part_2 b
 ON a.key = b.key AND a.part = '1' and b.part = '1'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_1
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            b
-         and
-            AND
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     key
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     part
-                  '1'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  part
-               '1'
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-1 depends on stages: Stage-2
@@ -406,57 +355,6 @@ SELECT /*+ MAPJOIN(b) */ count(*)
 FROM srcbucket_mapjoin_part_1 a JOIN srcbucket_mapjoin_part_3 b
 ON a.key = b.key AND a.part = '1' and b.part = '1'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_1
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_3
-            b
-         and
-            AND
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     key
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     part
-                  '1'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  part
-               '1'
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-1 depends on stages: Stage-2
diff --git a/ql/src/test/results/clientpositive/spark/bucketmapjoin13.q.out b/ql/src/test/results/clientpositive/spark/bucketmapjoin13.q.out
index 7a4d32ad23..b4f4949873 100644
--- a/ql/src/test/results/clientpositive/spark/bucketmapjoin13.q.out
+++ b/ql/src/test/results/clientpositive/spark/bucketmapjoin13.q.out
@@ -82,43 +82,6 @@ SELECT /*+ MAPJOIN(b) */ count(*)
 FROM srcbucket_mapjoin_part_1 a JOIN srcbucket_mapjoin_part_2 b
 ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_1
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-1 depends on stages: Stage-2
@@ -411,50 +374,6 @@ SELECT /*+ MAPJOIN(b) */ count(*)
 FROM srcbucket_mapjoin_part_1 a JOIN srcbucket_mapjoin_part_2 b
 ON a.key = b.key and a.part = '2'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_1
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            b
-         and
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  part
-               '2'
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-1 depends on stages: Stage-2
@@ -716,43 +635,6 @@ SELECT /*+ MAPJOIN(b) */ count(*)
 FROM srcbucket_mapjoin_part_1 a JOIN srcbucket_mapjoin_part_2 b
 ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_1
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-1 depends on stages: Stage-2
@@ -1016,43 +898,6 @@ SELECT /*+ MAPJOIN(b) */ count(*)
 FROM srcbucket_mapjoin_part_1 a JOIN srcbucket_mapjoin_part_2 b
 ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_1
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-1 depends on stages: Stage-2
diff --git a/ql/src/test/results/clientpositive/spark/bucketmapjoin2.q.out b/ql/src/test/results/clientpositive/spark/bucketmapjoin2.q.out
index cbcca5797b..48ff95f9ca 100644
--- a/ql/src/test/results/clientpositive/spark/bucketmapjoin2.q.out
+++ b/ql/src/test/results/clientpositive/spark/bucketmapjoin2.q.out
@@ -100,63 +100,6 @@ select /*+mapjoin(b)*/ a.key, a.value, b.value
 from srcbucket_mapjoin_part a join srcbucket_mapjoin_part_2 b
 on a.key=b.key and b.ds="2008-04-08"
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            b
-         and
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  ds
-               "2008-04-08"
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucketmapjoin_tmp_result
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
@@ -496,63 +439,6 @@ select /*+mapjoin(a)*/ a.key, a.value, b.value
 from srcbucket_mapjoin_part a join srcbucket_mapjoin_part_2 b
 on a.key=b.key and b.ds="2008-04-08"
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            b
-         and
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  ds
-               "2008-04-08"
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucketmapjoin_tmp_result
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  a
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
@@ -921,56 +807,6 @@ select /*+mapjoin(b)*/ a.key, a.value, b.value
 from srcbucket_mapjoin_part a join srcbucket_mapjoin_part_2 b
 on a.key=b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucketmapjoin_tmp_result
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
diff --git a/ql/src/test/results/clientpositive/spark/bucketmapjoin3.q.out b/ql/src/test/results/clientpositive/spark/bucketmapjoin3.q.out
index 3b306db6fd..95589cada4 100644
--- a/ql/src/test/results/clientpositive/spark/bucketmapjoin3.q.out
+++ b/ql/src/test/results/clientpositive/spark/bucketmapjoin3.q.out
@@ -124,70 +124,6 @@ select /*+mapjoin(b)*/ a.key, a.value, b.value
 from srcbucket_mapjoin_part_2 a join srcbucket_mapjoin_part b 
 on a.key=b.key and b.ds="2008-04-08" and a.ds="2008-04-08"
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part
-            b
-         and
-            and
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     key
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     ds
-                  "2008-04-08"
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  ds
-               "2008-04-08"
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucketmapjoin_tmp_result
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
@@ -527,70 +463,6 @@ select /*+mapjoin(a)*/ a.key, a.value, b.value
 from srcbucket_mapjoin_part_2 a join srcbucket_mapjoin_part b 
 on a.key=b.key and b.ds="2008-04-08" and a.ds="2008-04-08"
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part
-            b
-         and
-            and
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     key
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     ds
-                  "2008-04-08"
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  ds
-               "2008-04-08"
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucketmapjoin_tmp_result
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  a
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
diff --git a/ql/src/test/results/clientpositive/spark/bucketmapjoin4.q.out b/ql/src/test/results/clientpositive/spark/bucketmapjoin4.q.out
index 11a7d3a5be..fba617c708 100644
--- a/ql/src/test/results/clientpositive/spark/bucketmapjoin4.q.out
+++ b/ql/src/test/results/clientpositive/spark/bucketmapjoin4.q.out
@@ -124,56 +124,6 @@ select /*+mapjoin(b)*/ a.key, a.value, b.value
 from srcbucket_mapjoin a join srcbucket_mapjoin b
 on a.key=b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucketmapjoin_tmp_result
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
@@ -493,56 +443,6 @@ select /*+mapjoin(a)*/ a.key, a.value, b.value
 from srcbucket_mapjoin a join srcbucket_mapjoin b
 on a.key=b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucketmapjoin_tmp_result
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  a
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
diff --git a/ql/src/test/results/clientpositive/spark/bucketmapjoin5.q.out b/ql/src/test/results/clientpositive/spark/bucketmapjoin5.q.out
index 188e4e7357..7214b42714 100644
--- a/ql/src/test/results/clientpositive/spark/bucketmapjoin5.q.out
+++ b/ql/src/test/results/clientpositive/spark/bucketmapjoin5.q.out
@@ -174,56 +174,6 @@ select /*+mapjoin(a)*/ a.key, a.value, b.value
 from srcbucket_mapjoin a join srcbucket_mapjoin_part b 
 on a.key=b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucketmapjoin_tmp_result
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  a
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
@@ -604,56 +554,6 @@ select /*+mapjoin(a)*/ a.key, a.value, b.value
 from srcbucket_mapjoin a join srcbucket_mapjoin_part_2 b 
 on a.key=b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucketmapjoin_tmp_result
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  a
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
diff --git a/ql/src/test/results/clientpositive/spark/bucketmapjoin7.q.out b/ql/src/test/results/clientpositive/spark/bucketmapjoin7.q.out
index d89bd58f71..d3440704b3 100644
--- a/ql/src/test/results/clientpositive/spark/bucketmapjoin7.q.out
+++ b/ql/src/test/results/clientpositive/spark/bucketmapjoin7.q.out
@@ -68,79 +68,6 @@ FROM srcbucket_mapjoin_part_1 a JOIN srcbucket_mapjoin_part_2 b
 ON a.key = b.key AND a.ds = '2008-04-08' AND b.ds = '2008-04-08'
 ORDER BY a.key, b.value LIMIT 1
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_1
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            b
-         AND
-            AND
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     key
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     ds
-                  '2008-04-08'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  ds
-               '2008-04-08'
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  value
-      TOK_LIMIT
-         1
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-1 depends on stages: Stage-2
diff --git a/ql/src/test/results/clientpositive/spark/bucketmapjoin8.q.out b/ql/src/test/results/clientpositive/spark/bucketmapjoin8.q.out
index 80dd175ce3..a7ad6de2ff 100644
--- a/ql/src/test/results/clientpositive/spark/bucketmapjoin8.q.out
+++ b/ql/src/test/results/clientpositive/spark/bucketmapjoin8.q.out
@@ -74,57 +74,6 @@ SELECT /*+ MAPJOIN(b) */ count(*)
 FROM srcbucket_mapjoin_part_1 a JOIN srcbucket_mapjoin_part_2 b
 ON a.key = b.key AND a.part = '1' and b.part = '1'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_1
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            b
-         and
-            AND
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     key
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     part
-                  '1'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  part
-               '1'
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-1 depends on stages: Stage-2
@@ -380,57 +329,6 @@ SELECT /*+ MAPJOIN(b) */ count(*)
 FROM srcbucket_mapjoin_part_1 a JOIN srcbucket_mapjoin_part_2 b
 ON a.key = b.key AND a.part = '1' and b.part = '1'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_1
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            b
-         and
-            AND
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     key
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     part
-                  '1'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  part
-               '1'
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-1 depends on stages: Stage-2
diff --git a/ql/src/test/results/clientpositive/spark/bucketmapjoin9.q.out b/ql/src/test/results/clientpositive/spark/bucketmapjoin9.q.out
index 2c3dd41697..6e4c53696b 100644
--- a/ql/src/test/results/clientpositive/spark/bucketmapjoin9.q.out
+++ b/ql/src/test/results/clientpositive/spark/bucketmapjoin9.q.out
@@ -82,57 +82,6 @@ SELECT /*+ MAPJOIN(b) */ count(*)
 FROM srcbucket_mapjoin_part_1 a JOIN srcbucket_mapjoin_part_2 b
 ON a.key = b.key AND a.part = '1' and b.part = '1'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_1
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            b
-         and
-            AND
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     key
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     part
-                  '1'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  part
-               '1'
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-1 depends on stages: Stage-2
@@ -410,57 +359,6 @@ SELECT /*+ MAPJOIN(b) */ count(*)
 FROM srcbucket_mapjoin_part_1 a JOIN srcbucket_mapjoin_part_2 b
 ON a.key = b.key AND a.part = '1' AND b.part = '1'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_1
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            b
-         AND
-            AND
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     key
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     part
-                  '1'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  part
-               '1'
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-1 depends on stages: Stage-2
diff --git a/ql/src/test/results/clientpositive/spark/bucketmapjoin_negative.q.out b/ql/src/test/results/clientpositive/spark/bucketmapjoin_negative.q.out
index b07af547d6..9fff7b273d 100644
--- a/ql/src/test/results/clientpositive/spark/bucketmapjoin_negative.q.out
+++ b/ql/src/test/results/clientpositive/spark/bucketmapjoin_negative.q.out
@@ -75,63 +75,6 @@ select /*+mapjoin(b)*/ a.key, a.value, b.value
 from srcbucket_mapjoin a join srcbucket_mapjoin_part b 
 on a.key=b.key where b.ds="2008-04-08"
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucketmapjoin_tmp_result
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-      TOK_WHERE
-         =
-            .
-               TOK_TABLE_OR_COL
-                  b
-               ds
-            "2008-04-08"
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
diff --git a/ql/src/test/results/clientpositive/spark/bucketmapjoin_negative2.q.out b/ql/src/test/results/clientpositive/spark/bucketmapjoin_negative2.q.out
index 98c19b4262..b199ad9324 100644
--- a/ql/src/test/results/clientpositive/spark/bucketmapjoin_negative2.q.out
+++ b/ql/src/test/results/clientpositive/spark/bucketmapjoin_negative2.q.out
@@ -84,56 +84,6 @@ select /*+mapjoin(b)*/ a.key, a.value, b.value
 from srcbucket_mapjoin a join srcbucket_mapjoin_part_2 b 
 on a.key=b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part_2
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucketmapjoin_tmp_result
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
diff --git a/ql/src/test/results/clientpositive/spark/bucketmapjoin_negative3.q.out b/ql/src/test/results/clientpositive/spark/bucketmapjoin_negative3.q.out
index dd59399d40..845e450c1d 100644
--- a/ql/src/test/results/clientpositive/spark/bucketmapjoin_negative3.q.out
+++ b/ql/src/test/results/clientpositive/spark/bucketmapjoin_negative3.q.out
@@ -148,52 +148,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: -- should be allowed
 explain extended select /* + MAPJOIN(R) */ * from test1 L join test1 R on L.key=R.key AND L.value=R.value
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               test1
-            L
-         TOK_TABREF
-            TOK_TABNAME
-               test1
-            R
-         AND
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     L
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     R
-                  key
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     L
-                  value
-               .
-                  TOK_TABLE_OR_COL
-                     R
-                  value
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  R
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-1 depends on stages: Stage-2
@@ -391,52 +345,6 @@ PREHOOK: query: explain extended select /* + MAPJOIN(R) */ * from test2 L join t
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select /* + MAPJOIN(R) */ * from test2 L join test2 R on L.key=R.key AND L.value=R.value
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               test2
-            L
-         TOK_TABREF
-            TOK_TABNAME
-               test2
-            R
-         AND
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     L
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     R
-                  key
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     L
-                  value
-               .
-                  TOK_TABLE_OR_COL
-                     R
-                  value
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  R
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-1 depends on stages: Stage-2
@@ -636,47 +544,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: -- should not apply bucket mapjoin
 explain extended select /* + MAPJOIN(R) */ * from test1 L join test1 R on L.key+L.key=R.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               test1
-            L
-         TOK_TABREF
-            TOK_TABNAME
-               test1
-            R
-         =
-            +
-               .
-                  TOK_TABLE_OR_COL
-                     L
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     L
-                  key
-            .
-               TOK_TABLE_OR_COL
-                  R
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  R
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-1 depends on stages: Stage-2
@@ -863,52 +730,6 @@ PREHOOK: query: explain extended select /* + MAPJOIN(R) */ * from test1 L join t
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select /* + MAPJOIN(R) */ * from test1 L join test2 R on L.key=R.key AND L.value=R.value
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               test1
-            L
-         TOK_TABREF
-            TOK_TABNAME
-               test2
-            R
-         AND
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     L
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     R
-                  key
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     L
-                  value
-               .
-                  TOK_TABLE_OR_COL
-                     R
-                  value
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  R
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-1 depends on stages: Stage-2
@@ -1095,52 +916,6 @@ PREHOOK: query: explain extended select /* + MAPJOIN(R) */ * from test1 L join t
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select /* + MAPJOIN(R) */ * from test1 L join test3 R on L.key=R.key AND L.value=R.value
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               test1
-            L
-         TOK_TABREF
-            TOK_TABNAME
-               test3
-            R
-         AND
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     L
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     R
-                  key
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     L
-                  value
-               .
-                  TOK_TABLE_OR_COL
-                     R
-                  value
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  R
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-1 depends on stages: Stage-2
@@ -1327,52 +1102,6 @@ PREHOOK: query: explain extended select /* + MAPJOIN(R) */ * from test1 L join t
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select /* + MAPJOIN(R) */ * from test1 L join test4 R on L.key=R.key AND L.value=R.value
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               test1
-            L
-         TOK_TABREF
-            TOK_TABNAME
-               test4
-            R
-         AND
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     L
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     R
-                  key
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     L
-                  value
-               .
-                  TOK_TABLE_OR_COL
-                     R
-                  value
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  R
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-1 depends on stages: Stage-2
@@ -1559,52 +1288,6 @@ PREHOOK: query: explain extended select /* + MAPJOIN(R) */ * from test2 L join t
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select /* + MAPJOIN(R) */ * from test2 L join test3 R on L.key=R.key AND L.value=R.value
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               test2
-            L
-         TOK_TABREF
-            TOK_TABNAME
-               test3
-            R
-         AND
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     L
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     R
-                  key
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     L
-                  value
-               .
-                  TOK_TABLE_OR_COL
-                     R
-                  value
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  R
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-1 depends on stages: Stage-2
@@ -1791,52 +1474,6 @@ PREHOOK: query: explain extended select /* + MAPJOIN(R) */ * from test2 L join t
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select /* + MAPJOIN(R) */ * from test2 L join test4 R on L.key=R.key AND L.value=R.value
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               test2
-            L
-         TOK_TABREF
-            TOK_TABNAME
-               test4
-            R
-         AND
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     L
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     R
-                  key
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     L
-                  value
-               .
-                  TOK_TABLE_OR_COL
-                     R
-                  value
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  R
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-1 depends on stages: Stage-2
@@ -2023,52 +1660,6 @@ PREHOOK: query: explain extended select /* + MAPJOIN(R) */ * from test3 L join t
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select /* + MAPJOIN(R) */ * from test3 L join test4 R on L.key=R.key AND L.value=R.value
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               test3
-            L
-         TOK_TABREF
-            TOK_TABNAME
-               test4
-            R
-         AND
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     L
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     R
-                  key
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     L
-                  value
-               .
-                  TOK_TABLE_OR_COL
-                     R
-                  value
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  R
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-1 depends on stages: Stage-2
diff --git a/ql/src/test/results/clientpositive/spark/ctas.q.out b/ql/src/test/results/clientpositive/spark/ctas.q.out
index 086ad734ce..5396ada197 100644
--- a/ql/src/test/results/clientpositive/spark/ctas.q.out
+++ b/ql/src/test/results/clientpositive/spark/ctas.q.out
@@ -678,49 +678,6 @@ PREHOOK: query: explain extended create table nzhang_ctas5 row format delimited
 PREHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: query: explain extended create table nzhang_ctas5 row format delimited fields terminated by ',' lines terminated by '\012' stored as textfile as select key, value from src sort by key, value limit 10
 POSTHOOK: type: CREATETABLE_AS_SELECT
-ABSTRACT SYNTAX TREE:
-  
-TOK_CREATETABLE
-   TOK_TABNAME
-      nzhang_ctas5
-   TOK_LIKETABLE
-   TOK_TABLEROWFORMAT
-      TOK_SERDEPROPS
-         TOK_TABLEROWFORMATFIELD
-            ','
-         TOK_TABLEROWFORMATLINES
-            '\012'
-   TOK_FILEFORMAT_GENERIC
-      textfile
-   TOK_QUERY
-      TOK_FROM
-         TOK_TABREF
-            TOK_TABNAME
-               src
-      TOK_INSERT
-         TOK_DESTINATION
-            TOK_DIR
-               TOK_TMP_FILE
-         TOK_SELECT
-            TOK_SELEXPR
-               TOK_TABLE_OR_COL
-                  key
-            TOK_SELEXPR
-               TOK_TABLE_OR_COL
-                  value
-         TOK_SORTBY
-            TOK_TABSORTCOLNAMEASC
-               TOK_NULLS_FIRST
-                  TOK_TABLE_OR_COL
-                     key
-            TOK_TABSORTCOLNAMEASC
-               TOK_NULLS_FIRST
-                  TOK_TABLE_OR_COL
-                     value
-         TOK_LIMIT
-            10
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/spark/disable_merge_for_bucketing.q.out b/ql/src/test/results/clientpositive/spark/disable_merge_for_bucketing.q.out
index fc2ff7b226..e21b1b1697 100644
--- a/ql/src/test/results/clientpositive/spark/disable_merge_for_bucketing.q.out
+++ b/ql/src/test/results/clientpositive/spark/disable_merge_for_bucketing.q.out
@@ -14,23 +14,6 @@ POSTHOOK: query: explain extended
 insert overwrite table bucket2_1
 select * from src
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            src
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucket2_1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/spark/filter_join_breaktask.q.out b/ql/src/test/results/clientpositive/spark/filter_join_breaktask.q.out
index c5f16ed08c..0bfdf5bd1e 100644
--- a/ql/src/test/results/clientpositive/spark/filter_join_breaktask.q.out
+++ b/ql/src/test/results/clientpositive/spark/filter_join_breaktask.q.out
@@ -32,108 +32,6 @@ SELECT f.key, g.value
 FROM filter_join_breaktask f JOIN filter_join_breaktask m ON( f.key = m.key AND f.ds='2008-04-08' AND m.ds='2008-04-08' AND f.key is not null) 
 JOIN filter_join_breaktask g ON(g.value = m.value AND g.ds='2008-04-08' AND m.ds='2008-04-08' AND m.value is not null AND m.value !='')
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_JOIN
-            TOK_TABREF
-               TOK_TABNAME
-                  filter_join_breaktask
-               f
-            TOK_TABREF
-               TOK_TABNAME
-                  filter_join_breaktask
-               m
-            AND
-               AND
-                  AND
-                     =
-                        .
-                           TOK_TABLE_OR_COL
-                              f
-                           key
-                        .
-                           TOK_TABLE_OR_COL
-                              m
-                           key
-                     =
-                        .
-                           TOK_TABLE_OR_COL
-                              f
-                           ds
-                        '2008-04-08'
-                  =
-                     .
-                        TOK_TABLE_OR_COL
-                           m
-                        ds
-                     '2008-04-08'
-               TOK_FUNCTION
-                  TOK_ISNOTNULL
-                  .
-                     TOK_TABLE_OR_COL
-                        f
-                     key
-         TOK_TABREF
-            TOK_TABNAME
-               filter_join_breaktask
-            g
-         AND
-            AND
-               AND
-                  AND
-                     =
-                        .
-                           TOK_TABLE_OR_COL
-                              g
-                           value
-                        .
-                           TOK_TABLE_OR_COL
-                              m
-                           value
-                     =
-                        .
-                           TOK_TABLE_OR_COL
-                              g
-                           ds
-                        '2008-04-08'
-                  =
-                     .
-                        TOK_TABLE_OR_COL
-                           m
-                        ds
-                     '2008-04-08'
-               TOK_FUNCTION
-                  TOK_ISNOTNULL
-                  .
-                     TOK_TABLE_OR_COL
-                        m
-                     value
-            !=
-               .
-                  TOK_TABLE_OR_COL
-                     m
-                  value
-               ''
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  f
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  g
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/spark/groupby_map_ppr.q.out b/ql/src/test/results/clientpositive/spark/groupby_map_ppr.q.out
index b5eae57a16..7660305e04 100644
--- a/ql/src/test/results/clientpositive/spark/groupby_map_ppr.q.out
+++ b/ql/src/test/results/clientpositive/spark/groupby_map_ppr.q.out
@@ -24,77 +24,6 @@ SELECT substr(src.key,1,1), count(DISTINCT substr(src.value,5)), concat(substr(s
 WHERE src.ds = '2008-04-08'
 GROUP BY substr(src.key,1,1)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-         src
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dest1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTION
-               substr
-               .
-                  TOK_TABLE_OR_COL
-                     src
-                  key
-               1
-               1
-         TOK_SELEXPR
-            TOK_FUNCTIONDI
-               count
-               TOK_FUNCTION
-                  substr
-                  .
-                     TOK_TABLE_OR_COL
-                        src
-                     value
-                  5
-         TOK_SELEXPR
-            TOK_FUNCTION
-               concat
-               TOK_FUNCTION
-                  substr
-                  .
-                     TOK_TABLE_OR_COL
-                        src
-                     key
-                  1
-                  1
-               TOK_FUNCTION
-                  sum
-                  TOK_FUNCTION
-                     substr
-                     .
-                        TOK_TABLE_OR_COL
-                           src
-                        value
-                     5
-      TOK_WHERE
-         =
-            .
-               TOK_TABLE_OR_COL
-                  src
-               ds
-            '2008-04-08'
-      TOK_GROUPBY
-         TOK_FUNCTION
-            substr
-            .
-               TOK_TABLE_OR_COL
-                  src
-               key
-            1
-            1
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/spark/groupby_map_ppr_multi_distinct.q.out b/ql/src/test/results/clientpositive/spark/groupby_map_ppr_multi_distinct.q.out
index ada2f91533..0608adce2c 100644
--- a/ql/src/test/results/clientpositive/spark/groupby_map_ppr_multi_distinct.q.out
+++ b/ql/src/test/results/clientpositive/spark/groupby_map_ppr_multi_distinct.q.out
@@ -24,94 +24,6 @@ SELECT substr(src.key,1,1), count(DISTINCT substr(src.value,5)), concat(substr(s
 WHERE src.ds = '2008-04-08'
 GROUP BY substr(src.key,1,1)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-         src
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dest1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTION
-               substr
-               .
-                  TOK_TABLE_OR_COL
-                     src
-                  key
-               1
-               1
-         TOK_SELEXPR
-            TOK_FUNCTIONDI
-               count
-               TOK_FUNCTION
-                  substr
-                  .
-                     TOK_TABLE_OR_COL
-                        src
-                     value
-                  5
-         TOK_SELEXPR
-            TOK_FUNCTION
-               concat
-               TOK_FUNCTION
-                  substr
-                  .
-                     TOK_TABLE_OR_COL
-                        src
-                     key
-                  1
-                  1
-               TOK_FUNCTION
-                  sum
-                  TOK_FUNCTION
-                     substr
-                     .
-                        TOK_TABLE_OR_COL
-                           src
-                        value
-                     5
-         TOK_SELEXPR
-            TOK_FUNCTIONDI
-               sum
-               TOK_FUNCTION
-                  substr
-                  .
-                     TOK_TABLE_OR_COL
-                        src
-                     value
-                  5
-         TOK_SELEXPR
-            TOK_FUNCTIONDI
-               count
-               .
-                  TOK_TABLE_OR_COL
-                     src
-                  value
-      TOK_WHERE
-         =
-            .
-               TOK_TABLE_OR_COL
-                  src
-               ds
-            '2008-04-08'
-      TOK_GROUPBY
-         TOK_FUNCTION
-            substr
-            .
-               TOK_TABLE_OR_COL
-                  src
-               key
-            1
-            1
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/spark/groupby_ppr.q.out b/ql/src/test/results/clientpositive/spark/groupby_ppr.q.out
index 97a9a6dd8c..6abeb5dc12 100644
--- a/ql/src/test/results/clientpositive/spark/groupby_ppr.q.out
+++ b/ql/src/test/results/clientpositive/spark/groupby_ppr.q.out
@@ -24,77 +24,6 @@ SELECT substr(src.key,1,1), count(DISTINCT substr(src.value,5)), concat(substr(s
 WHERE src.ds = '2008-04-08'
 GROUP BY substr(src.key,1,1)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-         src
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dest1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTION
-               substr
-               .
-                  TOK_TABLE_OR_COL
-                     src
-                  key
-               1
-               1
-         TOK_SELEXPR
-            TOK_FUNCTIONDI
-               count
-               TOK_FUNCTION
-                  substr
-                  .
-                     TOK_TABLE_OR_COL
-                        src
-                     value
-                  5
-         TOK_SELEXPR
-            TOK_FUNCTION
-               concat
-               TOK_FUNCTION
-                  substr
-                  .
-                     TOK_TABLE_OR_COL
-                        src
-                     key
-                  1
-                  1
-               TOK_FUNCTION
-                  sum
-                  TOK_FUNCTION
-                     substr
-                     .
-                        TOK_TABLE_OR_COL
-                           src
-                        value
-                     5
-      TOK_WHERE
-         =
-            .
-               TOK_TABLE_OR_COL
-                  src
-               ds
-            '2008-04-08'
-      TOK_GROUPBY
-         TOK_FUNCTION
-            substr
-            .
-               TOK_TABLE_OR_COL
-                  src
-               key
-            1
-            1
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/spark/groupby_ppr_multi_distinct.q.out b/ql/src/test/results/clientpositive/spark/groupby_ppr_multi_distinct.q.out
index a8724f52ed..66d6cb6737 100644
--- a/ql/src/test/results/clientpositive/spark/groupby_ppr_multi_distinct.q.out
+++ b/ql/src/test/results/clientpositive/spark/groupby_ppr_multi_distinct.q.out
@@ -24,94 +24,6 @@ SELECT substr(src.key,1,1), count(DISTINCT substr(src.value,5)), concat(substr(s
 WHERE src.ds = '2008-04-08'
 GROUP BY substr(src.key,1,1)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-         src
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dest1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTION
-               substr
-               .
-                  TOK_TABLE_OR_COL
-                     src
-                  key
-               1
-               1
-         TOK_SELEXPR
-            TOK_FUNCTIONDI
-               count
-               TOK_FUNCTION
-                  substr
-                  .
-                     TOK_TABLE_OR_COL
-                        src
-                     value
-                  5
-         TOK_SELEXPR
-            TOK_FUNCTION
-               concat
-               TOK_FUNCTION
-                  substr
-                  .
-                     TOK_TABLE_OR_COL
-                        src
-                     key
-                  1
-                  1
-               TOK_FUNCTION
-                  sum
-                  TOK_FUNCTION
-                     substr
-                     .
-                        TOK_TABLE_OR_COL
-                           src
-                        value
-                     5
-         TOK_SELEXPR
-            TOK_FUNCTIONDI
-               sum
-               TOK_FUNCTION
-                  substr
-                  .
-                     TOK_TABLE_OR_COL
-                        src
-                     value
-                  5
-         TOK_SELEXPR
-            TOK_FUNCTIONDI
-               count
-               .
-                  TOK_TABLE_OR_COL
-                     src
-                  value
-      TOK_WHERE
-         =
-            .
-               TOK_TABLE_OR_COL
-                  src
-               ds
-            '2008-04-08'
-      TOK_GROUPBY
-         TOK_FUNCTION
-            substr
-            .
-               TOK_TABLE_OR_COL
-                  src
-               key
-            1
-            1
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/spark/groupby_sort_1_23.q.out b/ql/src/test/results/clientpositive/spark/groupby_sort_1_23.q.out
index 4e7e72e9ff..1b4822ec6b 100644
--- a/ql/src/test/results/clientpositive/spark/groupby_sort_1_23.q.out
+++ b/ql/src/test/results/clientpositive/spark/groupby_sort_1_23.q.out
@@ -54,31 +54,6 @@ EXPLAIN EXTENDED
 INSERT OVERWRITE TABLE outputTbl1
 SELECT key, count(1) FROM T1 GROUP BY key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            T1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            key
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -258,36 +233,6 @@ EXPLAIN EXTENDED
 INSERT OVERWRITE TABLE outputTbl2
 SELECT key, val, count(1) FROM T1 GROUP BY key, val
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            T1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl2
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               val
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            key
-         TOK_TABLE_OR_COL
-            val
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -481,46 +426,6 @@ EXPLAIN EXTENDED
 INSERT OVERWRITE TABLE outputTbl1
 SELECT key, count(1) FROM (SELECT key, val FROM T1) subq1 GROUP BY key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_QUERY
-            TOK_FROM
-               TOK_TABREF
-                  TOK_TABNAME
-                     T1
-            TOK_INSERT
-               TOK_DESTINATION
-                  TOK_DIR
-                     TOK_TMP_FILE
-               TOK_SELECT
-                  TOK_SELEXPR
-                     TOK_TABLE_OR_COL
-                        key
-                  TOK_SELEXPR
-                     TOK_TABLE_OR_COL
-                        val
-         subq1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            key
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -702,48 +607,6 @@ EXPLAIN EXTENDED
 INSERT OVERWRITE TABLE outputTbl1
 SELECT k, count(1) FROM (SELECT key as k, val as v FROM T1) subq1 GROUP BY k
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_QUERY
-            TOK_FROM
-               TOK_TABREF
-                  TOK_TABNAME
-                     T1
-            TOK_INSERT
-               TOK_DESTINATION
-                  TOK_DIR
-                     TOK_TMP_FILE
-               TOK_SELECT
-                  TOK_SELEXPR
-                     TOK_TABLE_OR_COL
-                        key
-                     k
-                  TOK_SELEXPR
-                     TOK_TABLE_OR_COL
-                        val
-                     v
-         subq1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               k
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            k
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -935,34 +798,6 @@ EXPLAIN EXTENDED
 INSERT OVERWRITE TABLE outputTbl3
 SELECT 1, key, count(1) FROM T1 GROUP BY 1, key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            T1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl3
-      TOK_SELECT
-         TOK_SELEXPR
-            1
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_GROUPBY
-         1
-         TOK_TABLE_OR_COL
-            key
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1143,39 +978,6 @@ EXPLAIN EXTENDED
 INSERT OVERWRITE TABLE outputTbl4
 SELECT key, 1, val, count(1) FROM T1 GROUP BY key, 1, val
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            T1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl4
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            1
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               val
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            key
-         1
-         TOK_TABLE_OR_COL
-            val
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1370,40 +1172,6 @@ EXPLAIN EXTENDED
 INSERT OVERWRITE TABLE outputTbl3
 SELECT key, key + 1, count(1) FROM T1 GROUP BY key, key + 1
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            T1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl3
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            +
-               TOK_TABLE_OR_COL
-                  key
-               1
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            key
-         +
-            TOK_TABLE_OR_COL
-               key
-            1
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1616,58 +1384,6 @@ SELECT key + key, sum(cnt) from
 (SELECT key, count(1) as cnt FROM T1 GROUP BY key) subq1
 group by key + key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_QUERY
-            TOK_FROM
-               TOK_TABREF
-                  TOK_TABNAME
-                     T1
-            TOK_INSERT
-               TOK_DESTINATION
-                  TOK_DIR
-                     TOK_TMP_FILE
-               TOK_SELECT
-                  TOK_SELEXPR
-                     TOK_TABLE_OR_COL
-                        key
-                  TOK_SELEXPR
-                     TOK_FUNCTION
-                        count
-                        1
-                     cnt
-               TOK_GROUPBY
-                  TOK_TABLE_OR_COL
-                     key
-         subq1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl1
-      TOK_SELECT
-         TOK_SELEXPR
-            +
-               TOK_TABLE_OR_COL
-                  key
-               TOK_TABLE_OR_COL
-                  key
-         TOK_SELEXPR
-            TOK_FUNCTION
-               sum
-               TOK_TABLE_OR_COL
-                  cnt
-      TOK_GROUPBY
-         +
-            TOK_TABLE_OR_COL
-               key
-            TOK_TABLE_OR_COL
-               key
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1891,63 +1607,6 @@ SELECT key, count(1) FROM T1 GROUP BY key
 SELECT key, count(1) FROM T1 GROUP BY key
 ) subq1
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_UNIONALL
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        T1
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           key
-                     TOK_SELEXPR
-                        TOK_FUNCTION
-                           count
-                           1
-                  TOK_GROUPBY
-                     TOK_TABLE_OR_COL
-                        key
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        T1
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           key
-                     TOK_SELEXPR
-                        TOK_FUNCTION
-                           count
-                           1
-                  TOK_GROUPBY
-                     TOK_TABLE_OR_COL
-                        key
-         subq1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -2254,70 +1913,6 @@ SELECT key, count(1) FROM T1 GROUP BY key
 SELECT key + key as key, count(1) FROM T1 GROUP BY key + key
 ) subq1
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_UNIONALL
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        T1
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           key
-                     TOK_SELEXPR
-                        TOK_FUNCTION
-                           count
-                           1
-                  TOK_GROUPBY
-                     TOK_TABLE_OR_COL
-                        key
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        T1
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        +
-                           TOK_TABLE_OR_COL
-                              key
-                           TOK_TABLE_OR_COL
-                              key
-                        key
-                     TOK_SELEXPR
-                        TOK_FUNCTION
-                           count
-                           1
-                  TOK_GROUPBY
-                     +
-                        TOK_TABLE_OR_COL
-                           key
-                        TOK_TABLE_OR_COL
-                           key
-         subq1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -2648,89 +2243,6 @@ JOIN
 (SELECT key, count(1) as cnt FROM T1 GROUP BY key) subq2
 ON subq1.key = subq2.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_SUBQUERY
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        T1
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           key
-                     TOK_SELEXPR
-                        TOK_FUNCTION
-                           count
-                           1
-                        cnt
-                  TOK_GROUPBY
-                     TOK_TABLE_OR_COL
-                        key
-            subq1
-         TOK_SUBQUERY
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        T1
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           key
-                     TOK_SELEXPR
-                        TOK_FUNCTION
-                           count
-                           1
-                        cnt
-                  TOK_GROUPBY
-                     TOK_TABLE_OR_COL
-                        key
-            subq2
-         =
-            .
-               TOK_TABLE_OR_COL
-                  subq1
-               key
-            .
-               TOK_TABLE_OR_COL
-                  subq2
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl1
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  subq1
-               key
-         TOK_SELEXPR
-            +
-               .
-                  TOK_TABLE_OR_COL
-                     subq1
-                  cnt
-               .
-                  TOK_TABLE_OR_COL
-                     subq2
-                  cnt
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -3034,78 +2546,6 @@ JOIN
 (SELECT key, val, count(1) FROM T1 GROUP BY key, val) subq2
 ON subq1.key = subq2.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_SUBQUERY
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        T1
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           key
-                     TOK_SELEXPR
-                        TOK_FUNCTION
-                           count
-                           1
-                  TOK_GROUPBY
-                     TOK_TABLE_OR_COL
-                        key
-            subq1
-         TOK_SUBQUERY
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        T1
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           key
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           val
-                     TOK_SELEXPR
-                        TOK_FUNCTION
-                           count
-                           1
-                  TOK_GROUPBY
-                     TOK_TABLE_OR_COL
-                        key
-                     TOK_TABLE_OR_COL
-                        val
-            subq2
-         =
-            .
-               TOK_TABLE_OR_COL
-                  subq1
-               key
-            .
-               TOK_TABLE_OR_COL
-                  subq2
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -3372,31 +2812,6 @@ EXPLAIN EXTENDED
 INSERT OVERWRITE TABLE outputTbl1
 SELECT key, count(1) FROM T2 GROUP BY key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            T2
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            key
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -3601,39 +3016,6 @@ EXPLAIN EXTENDED
 INSERT OVERWRITE TABLE outputTbl4
 SELECT key, 1, val, count(1) FROM T2 GROUP BY key, 1, val
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            T2
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl4
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            1
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               val
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            key
-         1
-         TOK_TABLE_OR_COL
-            val
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -3828,42 +3210,6 @@ EXPLAIN EXTENDED
 INSERT OVERWRITE TABLE outputTbl5
 SELECT key, 1, val, 2, count(1) FROM T2 GROUP BY key, 1, val, 2
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            T2
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl5
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            1
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               val
-         TOK_SELEXPR
-            2
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            key
-         1
-         TOK_TABLE_OR_COL
-            val
-         2
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -4045,59 +3391,6 @@ SELECT key, constant, val, count(1) from
 (SELECT key, 1 as constant, val from T2)subq
 group by key, constant, val
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_QUERY
-            TOK_FROM
-               TOK_TABREF
-                  TOK_TABNAME
-                     T2
-            TOK_INSERT
-               TOK_DESTINATION
-                  TOK_DIR
-                     TOK_TMP_FILE
-               TOK_SELECT
-                  TOK_SELEXPR
-                     TOK_TABLE_OR_COL
-                        key
-                  TOK_SELEXPR
-                     1
-                     constant
-                  TOK_SELEXPR
-                     TOK_TABLE_OR_COL
-                        val
-         subq
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl4
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               constant
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               val
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            key
-         TOK_TABLE_OR_COL
-            constant
-         TOK_TABLE_OR_COL
-            val
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -4296,81 +3589,6 @@ SELECT key, constant as constant2, val, 2 as constant3 from
 )subq2
 group by key, constant3, val
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_QUERY
-            TOK_FROM
-               TOK_SUBQUERY
-                  TOK_QUERY
-                     TOK_FROM
-                        TOK_TABREF
-                           TOK_TABNAME
-                              T2
-                     TOK_INSERT
-                        TOK_DESTINATION
-                           TOK_DIR
-                              TOK_TMP_FILE
-                        TOK_SELECT
-                           TOK_SELEXPR
-                              TOK_TABLE_OR_COL
-                                 key
-                           TOK_SELEXPR
-                              1
-                              constant
-                           TOK_SELEXPR
-                              TOK_TABLE_OR_COL
-                                 val
-                  subq
-            TOK_INSERT
-               TOK_DESTINATION
-                  TOK_DIR
-                     TOK_TMP_FILE
-               TOK_SELECT
-                  TOK_SELEXPR
-                     TOK_TABLE_OR_COL
-                        key
-                  TOK_SELEXPR
-                     TOK_TABLE_OR_COL
-                        constant
-                     constant2
-                  TOK_SELEXPR
-                     TOK_TABLE_OR_COL
-                        val
-                  TOK_SELEXPR
-                     2
-                     constant3
-         subq2
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl4
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               constant3
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               val
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            key
-         TOK_TABLE_OR_COL
-            constant3
-         TOK_TABLE_OR_COL
-            val
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/spark/groupby_sort_skew_1_23.q.out b/ql/src/test/results/clientpositive/spark/groupby_sort_skew_1_23.q.out
index b8f1bbd6ef..0956771ea4 100644
--- a/ql/src/test/results/clientpositive/spark/groupby_sort_skew_1_23.q.out
+++ b/ql/src/test/results/clientpositive/spark/groupby_sort_skew_1_23.q.out
@@ -54,31 +54,6 @@ EXPLAIN EXTENDED
 INSERT OVERWRITE TABLE outputTbl1
 SELECT key, count(1) FROM T1 GROUP BY key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            T1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            key
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -258,36 +233,6 @@ EXPLAIN EXTENDED
 INSERT OVERWRITE TABLE outputTbl2
 SELECT key, val, count(1) FROM T1 GROUP BY key, val
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            T1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl2
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               val
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            key
-         TOK_TABLE_OR_COL
-            val
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -500,46 +445,6 @@ EXPLAIN EXTENDED
 INSERT OVERWRITE TABLE outputTbl1
 SELECT key, count(1) FROM (SELECT key, val FROM T1) subq1 GROUP BY key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_QUERY
-            TOK_FROM
-               TOK_TABREF
-                  TOK_TABNAME
-                     T1
-            TOK_INSERT
-               TOK_DESTINATION
-                  TOK_DIR
-                     TOK_TMP_FILE
-               TOK_SELECT
-                  TOK_SELEXPR
-                     TOK_TABLE_OR_COL
-                        key
-                  TOK_SELEXPR
-                     TOK_TABLE_OR_COL
-                        val
-         subq1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            key
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -721,48 +626,6 @@ EXPLAIN EXTENDED
 INSERT OVERWRITE TABLE outputTbl1
 SELECT k, count(1) FROM (SELECT key as k, val as v FROM T1) subq1 GROUP BY k
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_QUERY
-            TOK_FROM
-               TOK_TABREF
-                  TOK_TABNAME
-                     T1
-            TOK_INSERT
-               TOK_DESTINATION
-                  TOK_DIR
-                     TOK_TMP_FILE
-               TOK_SELECT
-                  TOK_SELEXPR
-                     TOK_TABLE_OR_COL
-                        key
-                     k
-                  TOK_SELEXPR
-                     TOK_TABLE_OR_COL
-                        val
-                     v
-         subq1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               k
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            k
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -954,34 +817,6 @@ EXPLAIN EXTENDED
 INSERT OVERWRITE TABLE outputTbl3
 SELECT 1, key, count(1) FROM T1 GROUP BY 1, key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            T1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl3
-      TOK_SELECT
-         TOK_SELEXPR
-            1
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_GROUPBY
-         1
-         TOK_TABLE_OR_COL
-            key
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1162,39 +997,6 @@ EXPLAIN EXTENDED
 INSERT OVERWRITE TABLE outputTbl4
 SELECT key, 1, val, count(1) FROM T1 GROUP BY key, 1, val
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            T1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl4
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            1
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               val
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            key
-         1
-         TOK_TABLE_OR_COL
-            val
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1408,40 +1210,6 @@ EXPLAIN EXTENDED
 INSERT OVERWRITE TABLE outputTbl3
 SELECT key, key + 1, count(1) FROM T1 GROUP BY key, key + 1
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            T1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl3
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            +
-               TOK_TABLE_OR_COL
-                  key
-               1
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            key
-         +
-            TOK_TABLE_OR_COL
-               key
-            1
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1673,58 +1441,6 @@ SELECT key + key, sum(cnt) from
 (SELECT key, count(1) as cnt FROM T1 GROUP BY key) subq1
 group by key + key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_QUERY
-            TOK_FROM
-               TOK_TABREF
-                  TOK_TABNAME
-                     T1
-            TOK_INSERT
-               TOK_DESTINATION
-                  TOK_DIR
-                     TOK_TMP_FILE
-               TOK_SELECT
-                  TOK_SELEXPR
-                     TOK_TABLE_OR_COL
-                        key
-                  TOK_SELEXPR
-                     TOK_FUNCTION
-                        count
-                        1
-                     cnt
-               TOK_GROUPBY
-                  TOK_TABLE_OR_COL
-                     key
-         subq1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl1
-      TOK_SELECT
-         TOK_SELEXPR
-            +
-               TOK_TABLE_OR_COL
-                  key
-               TOK_TABLE_OR_COL
-                  key
-         TOK_SELEXPR
-            TOK_FUNCTION
-               sum
-               TOK_TABLE_OR_COL
-                  cnt
-      TOK_GROUPBY
-         +
-            TOK_TABLE_OR_COL
-               key
-            TOK_TABLE_OR_COL
-               key
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1967,63 +1683,6 @@ SELECT key, count(1) FROM T1 GROUP BY key
 SELECT key, count(1) FROM T1 GROUP BY key
 ) subq1
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_UNIONALL
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        T1
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           key
-                     TOK_SELEXPR
-                        TOK_FUNCTION
-                           count
-                           1
-                  TOK_GROUPBY
-                     TOK_TABLE_OR_COL
-                        key
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        T1
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           key
-                     TOK_SELEXPR
-                        TOK_FUNCTION
-                           count
-                           1
-                  TOK_GROUPBY
-                     TOK_TABLE_OR_COL
-                        key
-         subq1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -2330,70 +1989,6 @@ SELECT key, count(1) FROM T1 GROUP BY key
 SELECT key + key as key, count(1) FROM T1 GROUP BY key + key
 ) subq1
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_UNIONALL
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        T1
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           key
-                     TOK_SELEXPR
-                        TOK_FUNCTION
-                           count
-                           1
-                  TOK_GROUPBY
-                     TOK_TABLE_OR_COL
-                        key
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        T1
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        +
-                           TOK_TABLE_OR_COL
-                              key
-                           TOK_TABLE_OR_COL
-                              key
-                        key
-                     TOK_SELEXPR
-                        TOK_FUNCTION
-                           count
-                           1
-                  TOK_GROUPBY
-                     +
-                        TOK_TABLE_OR_COL
-                           key
-                        TOK_TABLE_OR_COL
-                           key
-         subq1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -2743,89 +2338,6 @@ JOIN
 (SELECT key, count(1) as cnt FROM T1 GROUP BY key) subq2
 ON subq1.key = subq2.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_SUBQUERY
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        T1
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           key
-                     TOK_SELEXPR
-                        TOK_FUNCTION
-                           count
-                           1
-                        cnt
-                  TOK_GROUPBY
-                     TOK_TABLE_OR_COL
-                        key
-            subq1
-         TOK_SUBQUERY
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        T1
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           key
-                     TOK_SELEXPR
-                        TOK_FUNCTION
-                           count
-                           1
-                        cnt
-                  TOK_GROUPBY
-                     TOK_TABLE_OR_COL
-                        key
-            subq2
-         =
-            .
-               TOK_TABLE_OR_COL
-                  subq1
-               key
-            .
-               TOK_TABLE_OR_COL
-                  subq2
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl1
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  subq1
-               key
-         TOK_SELEXPR
-            +
-               .
-                  TOK_TABLE_OR_COL
-                     subq1
-                  cnt
-               .
-                  TOK_TABLE_OR_COL
-                     subq2
-                  cnt
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -3129,78 +2641,6 @@ JOIN
 (SELECT key, val, count(1) FROM T1 GROUP BY key, val) subq2
 ON subq1.key = subq2.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_SUBQUERY
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        T1
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           key
-                     TOK_SELEXPR
-                        TOK_FUNCTION
-                           count
-                           1
-                  TOK_GROUPBY
-                     TOK_TABLE_OR_COL
-                        key
-            subq1
-         TOK_SUBQUERY
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        T1
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           key
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           val
-                     TOK_SELEXPR
-                        TOK_FUNCTION
-                           count
-                           1
-                  TOK_GROUPBY
-                     TOK_TABLE_OR_COL
-                        key
-                     TOK_TABLE_OR_COL
-                        val
-            subq2
-         =
-            .
-               TOK_TABLE_OR_COL
-                  subq1
-               key
-            .
-               TOK_TABLE_OR_COL
-                  subq2
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -3486,31 +2926,6 @@ EXPLAIN EXTENDED
 INSERT OVERWRITE TABLE outputTbl1
 SELECT key, count(1) FROM T2 GROUP BY key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            T2
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            key
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -3734,39 +3149,6 @@ EXPLAIN EXTENDED
 INSERT OVERWRITE TABLE outputTbl4
 SELECT key, 1, val, count(1) FROM T2 GROUP BY key, 1, val
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            T2
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl4
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            1
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               val
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            key
-         1
-         TOK_TABLE_OR_COL
-            val
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -3961,42 +3343,6 @@ EXPLAIN EXTENDED
 INSERT OVERWRITE TABLE outputTbl5
 SELECT key, 1, val, 2, count(1) FROM T2 GROUP BY key, 1, val, 2
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            T2
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl5
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            1
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               val
-         TOK_SELEXPR
-            2
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            key
-         1
-         TOK_TABLE_OR_COL
-            val
-         2
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -4178,59 +3524,6 @@ SELECT key, constant, val, count(1) from
 (SELECT key, 1 as constant, val from T2)subq
 group by key, constant, val
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_QUERY
-            TOK_FROM
-               TOK_TABREF
-                  TOK_TABNAME
-                     T2
-            TOK_INSERT
-               TOK_DESTINATION
-                  TOK_DIR
-                     TOK_TMP_FILE
-               TOK_SELECT
-                  TOK_SELEXPR
-                     TOK_TABLE_OR_COL
-                        key
-                  TOK_SELEXPR
-                     1
-                     constant
-                  TOK_SELEXPR
-                     TOK_TABLE_OR_COL
-                        val
-         subq
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl4
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               constant
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               val
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            key
-         TOK_TABLE_OR_COL
-            constant
-         TOK_TABLE_OR_COL
-            val
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -4429,81 +3722,6 @@ SELECT key, constant as constant2, val, 2 as constant3 from
 )subq2
 group by key, constant3, val
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_QUERY
-            TOK_FROM
-               TOK_SUBQUERY
-                  TOK_QUERY
-                     TOK_FROM
-                        TOK_TABREF
-                           TOK_TABNAME
-                              T2
-                     TOK_INSERT
-                        TOK_DESTINATION
-                           TOK_DIR
-                              TOK_TMP_FILE
-                        TOK_SELECT
-                           TOK_SELEXPR
-                              TOK_TABLE_OR_COL
-                                 key
-                           TOK_SELEXPR
-                              1
-                              constant
-                           TOK_SELEXPR
-                              TOK_TABLE_OR_COL
-                                 val
-                  subq
-            TOK_INSERT
-               TOK_DESTINATION
-                  TOK_DIR
-                     TOK_TMP_FILE
-               TOK_SELECT
-                  TOK_SELEXPR
-                     TOK_TABLE_OR_COL
-                        key
-                  TOK_SELEXPR
-                     TOK_TABLE_OR_COL
-                        constant
-                     constant2
-                  TOK_SELEXPR
-                     TOK_TABLE_OR_COL
-                        val
-                  TOK_SELEXPR
-                     2
-                     constant3
-         subq2
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               outputTbl4
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               constant3
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               val
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            key
-         TOK_TABLE_OR_COL
-            constant3
-         TOK_TABLE_OR_COL
-            val
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/spark/input_part2.q.out b/ql/src/test/results/clientpositive/spark/input_part2.q.out
index 6129b1c4aa..73a3679a5f 100644
--- a/ql/src/test/results/clientpositive/spark/input_part2.q.out
+++ b/ql/src/test/results/clientpositive/spark/input_part2.q.out
@@ -28,109 +28,6 @@ FROM srcpart
 INSERT OVERWRITE TABLE dest1 SELECT srcpart.key, srcpart.value, srcpart.hr, srcpart.ds WHERE srcpart.key < 100 and srcpart.ds = '2008-04-08' and srcpart.hr = '12'
 INSERT OVERWRITE TABLE dest2 SELECT srcpart.key, srcpart.value, srcpart.hr, srcpart.ds WHERE srcpart.key < 100 and srcpart.ds = '2008-04-09' and srcpart.hr = '12'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dest1
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  srcpart
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  srcpart
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  srcpart
-               hr
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  srcpart
-               ds
-      TOK_WHERE
-         and
-            and
-               <
-                  .
-                     TOK_TABLE_OR_COL
-                        srcpart
-                     key
-                  100
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        srcpart
-                     ds
-                  '2008-04-08'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     srcpart
-                  hr
-               '12'
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dest2
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  srcpart
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  srcpart
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  srcpart
-               hr
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  srcpart
-               ds
-      TOK_WHERE
-         and
-            and
-               <
-                  .
-                     TOK_TABLE_OR_COL
-                        srcpart
-                     key
-                  100
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        srcpart
-                     ds
-                  '2008-04-09'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     srcpart
-                  hr
-               '12'
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-0 depends on stages: Stage-2
diff --git a/ql/src/test/results/clientpositive/spark/join17.q.out b/ql/src/test/results/clientpositive/spark/join17.q.out
index 026bf1a7dc..0d92441153 100644
--- a/ql/src/test/results/clientpositive/spark/join17.q.out
+++ b/ql/src/test/results/clientpositive/spark/join17.q.out
@@ -18,44 +18,6 @@ POSTHOOK: query: EXPLAIN EXTENDED
 FROM src src1 JOIN src src2 ON (src1.key = src2.key)
 INSERT OVERWRITE TABLE dest1 SELECT src1.*, src2.*
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               src
-            src1
-         TOK_TABREF
-            TOK_TABNAME
-               src
-            src2
-         =
-            .
-               TOK_TABLE_OR_COL
-                  src1
-               key
-            .
-               TOK_TABLE_OR_COL
-                  src2
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dest1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-               TOK_TABNAME
-                  src1
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-               TOK_TABNAME
-                  src2
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/spark/join26.q.out b/ql/src/test/results/clientpositive/spark/join26.q.out
index b0449f6783..c700b879c1 100644
--- a/ql/src/test/results/clientpositive/spark/join26.q.out
+++ b/ql/src/test/results/clientpositive/spark/join26.q.out
@@ -22,85 +22,6 @@ SELECT /*+ MAPJOIN(x,y) */ x.key, z.value, y.value
 FROM src1 x JOIN src y ON (x.key = y.key) 
 JOIN srcpart z ON (x.key = z.key and z.ds='2008-04-08' and z.hr=11)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_JOIN
-            TOK_TABREF
-               TOK_TABNAME
-                  src1
-               x
-            TOK_TABREF
-               TOK_TABNAME
-                  src
-               y
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     x
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     y
-                  key
-         TOK_TABREF
-            TOK_TABNAME
-               srcpart
-            z
-         and
-            and
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        x
-                     key
-                  .
-                     TOK_TABLE_OR_COL
-                        z
-                     key
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        z
-                     ds
-                  '2008-04-08'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     z
-                  hr
-               11
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dest_j1
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  x
-                  y
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  x
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  z
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  y
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
diff --git a/ql/src/test/results/clientpositive/spark/join32.q.out b/ql/src/test/results/clientpositive/spark/join32.q.out
index 377121709d..fc3dcc24c9 100644
--- a/ql/src/test/results/clientpositive/spark/join32.q.out
+++ b/ql/src/test/results/clientpositive/spark/join32.q.out
@@ -26,79 +26,6 @@ SELECT x.key, z.value, y.value
 FROM src1 x JOIN src y ON (x.key = y.key) 
 JOIN srcpart z ON (x.value = z.value and z.ds='2008-04-08' and z.hr=11)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_JOIN
-            TOK_TABREF
-               TOK_TABNAME
-                  src1
-               x
-            TOK_TABREF
-               TOK_TABNAME
-                  src
-               y
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     x
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     y
-                  key
-         TOK_TABREF
-            TOK_TABNAME
-               srcpart
-            z
-         and
-            and
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        x
-                     value
-                  .
-                     TOK_TABLE_OR_COL
-                        z
-                     value
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        z
-                     ds
-                  '2008-04-08'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     z
-                  hr
-               11
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dest_j1
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  x
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  z
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  y
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
diff --git a/ql/src/test/results/clientpositive/spark/join32_lessSize.q.out b/ql/src/test/results/clientpositive/spark/join32_lessSize.q.out
index c4ac2dd6df..4d5110f0ba 100644
--- a/ql/src/test/results/clientpositive/spark/join32_lessSize.q.out
+++ b/ql/src/test/results/clientpositive/spark/join32_lessSize.q.out
@@ -34,79 +34,6 @@ SELECT x.key, z.value, y.value
 FROM src1 x JOIN src y ON (x.key = y.key) 
 JOIN srcpart z ON (x.value = z.value and z.ds='2008-04-08' and z.hr=11)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_JOIN
-            TOK_TABREF
-               TOK_TABNAME
-                  src1
-               x
-            TOK_TABREF
-               TOK_TABNAME
-                  src
-               y
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     x
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     y
-                  key
-         TOK_TABREF
-            TOK_TABNAME
-               srcpart
-            z
-         and
-            and
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        x
-                     value
-                  .
-                     TOK_TABLE_OR_COL
-                        z
-                     value
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        z
-                     ds
-                  '2008-04-08'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     z
-                  hr
-               11
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dest_j1
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  x
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  z
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  y
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
@@ -539,79 +466,6 @@ FROM src w JOIN src1 x ON (x.value = w.value)
 JOIN src y ON (x.key = y.key) 
 JOIN src1 z ON (x.key = z.key)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_JOIN
-            TOK_JOIN
-               TOK_TABREF
-                  TOK_TABNAME
-                     src
-                  w
-               TOK_TABREF
-                  TOK_TABNAME
-                     src1
-                  x
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        x
-                     value
-                  .
-                     TOK_TABLE_OR_COL
-                        w
-                     value
-            TOK_TABREF
-               TOK_TABNAME
-                  src
-               y
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     x
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     y
-                  key
-         TOK_TABREF
-            TOK_TABNAME
-               src1
-            z
-         =
-            .
-               TOK_TABLE_OR_COL
-                  x
-               key
-            .
-               TOK_TABLE_OR_COL
-                  z
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dest_j1
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  x
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  z
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  y
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-4 is a root stage
   Stage-3 depends on stages: Stage-4
@@ -1135,98 +989,6 @@ SELECT res.key, z.value, res.value
 FROM (select x.key, x.value from src1 x JOIN src y ON (x.key = y.key)) res 
 JOIN srcpart z ON (res.value = z.value and z.ds='2008-04-08' and z.hr=11)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_SUBQUERY
-            TOK_QUERY
-               TOK_FROM
-                  TOK_JOIN
-                     TOK_TABREF
-                        TOK_TABNAME
-                           src1
-                        x
-                     TOK_TABREF
-                        TOK_TABNAME
-                           src
-                        y
-                     =
-                        .
-                           TOK_TABLE_OR_COL
-                              x
-                           key
-                        .
-                           TOK_TABLE_OR_COL
-                              y
-                           key
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        .
-                           TOK_TABLE_OR_COL
-                              x
-                           key
-                     TOK_SELEXPR
-                        .
-                           TOK_TABLE_OR_COL
-                              x
-                           value
-            res
-         TOK_TABREF
-            TOK_TABNAME
-               srcpart
-            z
-         and
-            and
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        res
-                     value
-                  .
-                     TOK_TABLE_OR_COL
-                        z
-                     value
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        z
-                     ds
-                  '2008-04-08'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     z
-                  hr
-               11
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dest_j2
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  res
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  z
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  res
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
@@ -1661,98 +1423,6 @@ SELECT res.key, z.value, res.value
 FROM (select x.key, x.value from src1 x LEFT OUTER JOIN src y ON (x.key = y.key)) res 
 JOIN srcpart z ON (res.value = z.value and z.ds='2008-04-08' and z.hr=11)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_SUBQUERY
-            TOK_QUERY
-               TOK_FROM
-                  TOK_LEFTOUTERJOIN
-                     TOK_TABREF
-                        TOK_TABNAME
-                           src1
-                        x
-                     TOK_TABREF
-                        TOK_TABNAME
-                           src
-                        y
-                     =
-                        .
-                           TOK_TABLE_OR_COL
-                              x
-                           key
-                        .
-                           TOK_TABLE_OR_COL
-                              y
-                           key
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        .
-                           TOK_TABLE_OR_COL
-                              x
-                           key
-                     TOK_SELEXPR
-                        .
-                           TOK_TABLE_OR_COL
-                              x
-                           value
-            res
-         TOK_TABREF
-            TOK_TABNAME
-               srcpart
-            z
-         and
-            and
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        res
-                     value
-                  .
-                     TOK_TABLE_OR_COL
-                        z
-                     value
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        z
-                     ds
-                  '2008-04-08'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     z
-                  hr
-               11
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dest_j2
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  res
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  z
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  res
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
diff --git a/ql/src/test/results/clientpositive/spark/join33.q.out b/ql/src/test/results/clientpositive/spark/join33.q.out
index 377121709d..fc3dcc24c9 100644
--- a/ql/src/test/results/clientpositive/spark/join33.q.out
+++ b/ql/src/test/results/clientpositive/spark/join33.q.out
@@ -26,79 +26,6 @@ SELECT x.key, z.value, y.value
 FROM src1 x JOIN src y ON (x.key = y.key) 
 JOIN srcpart z ON (x.value = z.value and z.ds='2008-04-08' and z.hr=11)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_JOIN
-            TOK_TABREF
-               TOK_TABNAME
-                  src1
-               x
-            TOK_TABREF
-               TOK_TABNAME
-                  src
-               y
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     x
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     y
-                  key
-         TOK_TABREF
-            TOK_TABNAME
-               srcpart
-            z
-         and
-            and
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        x
-                     value
-                  .
-                     TOK_TABLE_OR_COL
-                        z
-                     value
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        z
-                     ds
-                  '2008-04-08'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     z
-                  hr
-               11
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dest_j1
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  x
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  z
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  y
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
diff --git a/ql/src/test/results/clientpositive/spark/join34.q.out b/ql/src/test/results/clientpositive/spark/join34.q.out
index bb55191c97..8d0b649e6c 100644
--- a/ql/src/test/results/clientpositive/spark/join34.q.out
+++ b/ql/src/test/results/clientpositive/spark/join34.q.out
@@ -34,110 +34,6 @@ FROM
 ) subq1
 JOIN src1 x ON (x.key = subq1.key)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_SUBQUERY
-            TOK_UNIONALL
-               TOK_QUERY
-                  TOK_FROM
-                     TOK_TABREF
-                        TOK_TABNAME
-                           src
-                        x
-                  TOK_INSERT
-                     TOK_DESTINATION
-                        TOK_DIR
-                           TOK_TMP_FILE
-                     TOK_SELECT
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 x
-                              key
-                           key
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 x
-                              value
-                           value
-                     TOK_WHERE
-                        <
-                           .
-                              TOK_TABLE_OR_COL
-                                 x
-                              key
-                           20
-               TOK_QUERY
-                  TOK_FROM
-                     TOK_TABREF
-                        TOK_TABNAME
-                           src
-                        x1
-                  TOK_INSERT
-                     TOK_DESTINATION
-                        TOK_DIR
-                           TOK_TMP_FILE
-                     TOK_SELECT
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 x1
-                              key
-                           key
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 x1
-                              value
-                           value
-                     TOK_WHERE
-                        >
-                           .
-                              TOK_TABLE_OR_COL
-                                 x1
-                              key
-                           100
-            subq1
-         TOK_TABREF
-            TOK_TABNAME
-               src1
-            x
-         =
-            .
-               TOK_TABLE_OR_COL
-                  x
-               key
-            .
-               TOK_TABLE_OR_COL
-                  subq1
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dest_j1
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  x
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  x
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  subq1
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/spark/join35.q.out b/ql/src/test/results/clientpositive/spark/join35.q.out
index 60ceca034f..7f9aa240b2 100644
--- a/ql/src/test/results/clientpositive/spark/join35.q.out
+++ b/ql/src/test/results/clientpositive/spark/join35.q.out
@@ -34,118 +34,6 @@ FROM
 ) subq1
 JOIN src1 x ON (x.key = subq1.key)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_SUBQUERY
-            TOK_UNIONALL
-               TOK_QUERY
-                  TOK_FROM
-                     TOK_TABREF
-                        TOK_TABNAME
-                           src
-                        x
-                  TOK_INSERT
-                     TOK_DESTINATION
-                        TOK_DIR
-                           TOK_TMP_FILE
-                     TOK_SELECT
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 x
-                              key
-                           key
-                        TOK_SELEXPR
-                           TOK_FUNCTION
-                              count
-                              1
-                           cnt
-                     TOK_WHERE
-                        <
-                           .
-                              TOK_TABLE_OR_COL
-                                 x
-                              key
-                           20
-                     TOK_GROUPBY
-                        .
-                           TOK_TABLE_OR_COL
-                              x
-                           key
-               TOK_QUERY
-                  TOK_FROM
-                     TOK_TABREF
-                        TOK_TABNAME
-                           src
-                        x1
-                  TOK_INSERT
-                     TOK_DESTINATION
-                        TOK_DIR
-                           TOK_TMP_FILE
-                     TOK_SELECT
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 x1
-                              key
-                           key
-                        TOK_SELEXPR
-                           TOK_FUNCTION
-                              count
-                              1
-                           cnt
-                     TOK_WHERE
-                        >
-                           .
-                              TOK_TABLE_OR_COL
-                                 x1
-                              key
-                           100
-                     TOK_GROUPBY
-                        .
-                           TOK_TABLE_OR_COL
-                              x1
-                           key
-            subq1
-         TOK_TABREF
-            TOK_TABNAME
-               src1
-            x
-         =
-            .
-               TOK_TABLE_OR_COL
-                  x
-               key
-            .
-               TOK_TABLE_OR_COL
-                  subq1
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dest_j1
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  x
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  x
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  subq1
-               cnt
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/spark/join9.q.out b/ql/src/test/results/clientpositive/spark/join9.q.out
index 5f26aaf2ac..714302e3f9 100644
--- a/ql/src/test/results/clientpositive/spark/join9.q.out
+++ b/ql/src/test/results/clientpositive/spark/join9.q.out
@@ -18,60 +18,6 @@ POSTHOOK: query: EXPLAIN EXTENDED
 FROM srcpart src1 JOIN src src2 ON (src1.key = src2.key)
 INSERT OVERWRITE TABLE dest1 SELECT src1.key, src2.value where src1.ds = '2008-04-08' and src1.hr = '12'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcpart
-            src1
-         TOK_TABREF
-            TOK_TABNAME
-               src
-            src2
-         =
-            .
-               TOK_TABLE_OR_COL
-                  src1
-               key
-            .
-               TOK_TABLE_OR_COL
-                  src2
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dest1
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  src1
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  src2
-               value
-      TOK_WHERE
-         and
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     src1
-                  ds
-               '2008-04-08'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     src1
-                  hr
-               '12'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/spark/join_filters_overlap.q.out b/ql/src/test/results/clientpositive/spark/join_filters_overlap.q.out
index cde721380c..2d5d7c1a63 100644
--- a/ql/src/test/results/clientpositive/spark/join_filters_overlap.q.out
+++ b/ql/src/test/results/clientpositive/spark/join_filters_overlap.q.out
@@ -22,78 +22,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: -- overlap on a
 explain extended select * from a left outer join a b on (a.key=b.key AND a.value=50 AND b.value=50) left outer join a c on (a.key=c.key AND a.value=60 AND c.value=60)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_LEFTOUTERJOIN
-         TOK_LEFTOUTERJOIN
-            TOK_TABREF
-               TOK_TABNAME
-                  a
-            TOK_TABREF
-               TOK_TABNAME
-                  a
-               b
-            AND
-               AND
-                  =
-                     .
-                        TOK_TABLE_OR_COL
-                           a
-                        key
-                     .
-                        TOK_TABLE_OR_COL
-                           b
-                        key
-                  =
-                     .
-                        TOK_TABLE_OR_COL
-                           a
-                        value
-                     50
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     value
-                  50
-         TOK_TABREF
-            TOK_TABNAME
-               a
-            c
-         AND
-            AND
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     key
-                  .
-                     TOK_TABLE_OR_COL
-                        c
-                     key
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     value
-                  60
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     c
-                  value
-               60
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -393,78 +321,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: -- overlap on b
 explain extended select * from a right outer join a b on (a.key=b.key AND a.value=50 AND b.value=50) left outer join a c on (b.key=c.key AND b.value=60 AND c.value=60)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_LEFTOUTERJOIN
-         TOK_RIGHTOUTERJOIN
-            TOK_TABREF
-               TOK_TABNAME
-                  a
-            TOK_TABREF
-               TOK_TABNAME
-                  a
-               b
-            AND
-               AND
-                  =
-                     .
-                        TOK_TABLE_OR_COL
-                           a
-                        key
-                     .
-                        TOK_TABLE_OR_COL
-                           b
-                        key
-                  =
-                     .
-                        TOK_TABLE_OR_COL
-                           a
-                        value
-                     50
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     value
-                  50
-         TOK_TABREF
-            TOK_TABNAME
-               a
-            c
-         AND
-            AND
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-                  .
-                     TOK_TABLE_OR_COL
-                        c
-                     key
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     value
-                  60
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     c
-                  value
-               60
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -764,92 +620,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: -- overlap on b with two filters for each
 explain extended select * from a right outer join a b on (a.key=b.key AND a.value=50 AND b.value=50 AND b.value>10) left outer join a c on (b.key=c.key AND b.value=60 AND b.value>20 AND c.value=60)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_LEFTOUTERJOIN
-         TOK_RIGHTOUTERJOIN
-            TOK_TABREF
-               TOK_TABNAME
-                  a
-            TOK_TABREF
-               TOK_TABNAME
-                  a
-               b
-            AND
-               AND
-                  AND
-                     =
-                        .
-                           TOK_TABLE_OR_COL
-                              a
-                           key
-                        .
-                           TOK_TABLE_OR_COL
-                              b
-                           key
-                     =
-                        .
-                           TOK_TABLE_OR_COL
-                              a
-                           value
-                        50
-                  =
-                     .
-                        TOK_TABLE_OR_COL
-                           b
-                        value
-                     50
-               >
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     value
-                  10
-         TOK_TABREF
-            TOK_TABNAME
-               a
-            c
-         AND
-            AND
-               AND
-                  =
-                     .
-                        TOK_TABLE_OR_COL
-                           b
-                        key
-                     .
-                        TOK_TABLE_OR_COL
-                           c
-                        key
-                  =
-                     .
-                        TOK_TABLE_OR_COL
-                           b
-                        value
-                     60
-               >
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     value
-                  20
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     c
-                  value
-               60
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1149,106 +919,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: -- overlap on a, b
 explain extended select * from a full outer join a b on (a.key=b.key AND a.value=50 AND b.value=50) left outer join a c on (b.key=c.key AND b.value=60 AND c.value=60) left outer join a d on (a.key=d.key AND a.value=40 AND d.value=40)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_LEFTOUTERJOIN
-         TOK_LEFTOUTERJOIN
-            TOK_FULLOUTERJOIN
-               TOK_TABREF
-                  TOK_TABNAME
-                     a
-               TOK_TABREF
-                  TOK_TABNAME
-                     a
-                  b
-               AND
-                  AND
-                     =
-                        .
-                           TOK_TABLE_OR_COL
-                              a
-                           key
-                        .
-                           TOK_TABLE_OR_COL
-                              b
-                           key
-                     =
-                        .
-                           TOK_TABLE_OR_COL
-                              a
-                           value
-                        50
-                  =
-                     .
-                        TOK_TABLE_OR_COL
-                           b
-                        value
-                     50
-            TOK_TABREF
-               TOK_TABNAME
-                  a
-               c
-            AND
-               AND
-                  =
-                     .
-                        TOK_TABLE_OR_COL
-                           b
-                        key
-                     .
-                        TOK_TABLE_OR_COL
-                           c
-                        key
-                  =
-                     .
-                        TOK_TABLE_OR_COL
-                           b
-                        value
-                     60
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        c
-                     value
-                  60
-         TOK_TABREF
-            TOK_TABNAME
-               a
-            d
-         AND
-            AND
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     key
-                  .
-                     TOK_TABLE_OR_COL
-                        d
-                     key
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     value
-                  40
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     d
-                  value
-               40
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1611,106 +1281,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: -- triple overlap on a
 explain extended select * from a left outer join a b on (a.key=b.key AND a.value=50 AND b.value=50) left outer join a c on (a.key=c.key AND a.value=60 AND c.value=60) left outer join a d on (a.key=d.key AND a.value=40 AND d.value=40)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_LEFTOUTERJOIN
-         TOK_LEFTOUTERJOIN
-            TOK_LEFTOUTERJOIN
-               TOK_TABREF
-                  TOK_TABNAME
-                     a
-               TOK_TABREF
-                  TOK_TABNAME
-                     a
-                  b
-               AND
-                  AND
-                     =
-                        .
-                           TOK_TABLE_OR_COL
-                              a
-                           key
-                        .
-                           TOK_TABLE_OR_COL
-                              b
-                           key
-                     =
-                        .
-                           TOK_TABLE_OR_COL
-                              a
-                           value
-                        50
-                  =
-                     .
-                        TOK_TABLE_OR_COL
-                           b
-                        value
-                     50
-            TOK_TABREF
-               TOK_TABNAME
-                  a
-               c
-            AND
-               AND
-                  =
-                     .
-                        TOK_TABLE_OR_COL
-                           a
-                        key
-                     .
-                        TOK_TABLE_OR_COL
-                           c
-                        key
-                  =
-                     .
-                        TOK_TABLE_OR_COL
-                           a
-                        value
-                     60
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        c
-                     value
-                  60
-         TOK_TABREF
-            TOK_TABNAME
-               a
-            d
-         AND
-            AND
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     key
-                  .
-                     TOK_TABLE_OR_COL
-                        d
-                     key
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     value
-                  40
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     d
-                  value
-               40
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/spark/join_map_ppr.q.out b/ql/src/test/results/clientpositive/spark/join_map_ppr.q.out
index 8e2871540f..9341862d20 100644
--- a/ql/src/test/results/clientpositive/spark/join_map_ppr.q.out
+++ b/ql/src/test/results/clientpositive/spark/join_map_ppr.q.out
@@ -24,85 +24,6 @@ FROM src1 x JOIN src y ON (x.key = y.key)
 JOIN srcpart z ON (x.key = z.key)
 WHERE z.ds='2008-04-08' and z.hr=11
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_JOIN
-            TOK_TABREF
-               TOK_TABNAME
-                  src1
-               x
-            TOK_TABREF
-               TOK_TABNAME
-                  src
-               y
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     x
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     y
-                  key
-         TOK_TABREF
-            TOK_TABNAME
-               srcpart
-            z
-         =
-            .
-               TOK_TABLE_OR_COL
-                  x
-               key
-            .
-               TOK_TABLE_OR_COL
-                  z
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dest_j1
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  x
-                  y
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  x
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  z
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  y
-               value
-      TOK_WHERE
-         and
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     z
-                  ds
-               '2008-04-08'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     z
-                  hr
-               11
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
@@ -577,85 +498,6 @@ FROM src1_copy x JOIN src_copy y ON (x.key = y.key)
 JOIN srcpart z ON (x.key = z.key)
 WHERE z.ds='2008-04-08' and z.hr=11
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_JOIN
-            TOK_TABREF
-               TOK_TABNAME
-                  src1_copy
-               x
-            TOK_TABREF
-               TOK_TABNAME
-                  src_copy
-               y
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     x
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     y
-                  key
-         TOK_TABREF
-            TOK_TABNAME
-               srcpart
-            z
-         =
-            .
-               TOK_TABLE_OR_COL
-                  x
-               key
-            .
-               TOK_TABLE_OR_COL
-                  z
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dest_j1
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  x
-                  y
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  x
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  z
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  y
-               value
-      TOK_WHERE
-         and
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     z
-                  ds
-               '2008-04-08'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     z
-                  hr
-               11
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
diff --git a/ql/src/test/results/clientpositive/spark/list_bucket_dml_10.q.java1.7.out b/ql/src/test/results/clientpositive/spark/list_bucket_dml_10.q.java1.7.out
index 6b3c375e1d..30405443a8 100644
--- a/ql/src/test/results/clientpositive/spark/list_bucket_dml_10.q.java1.7.out
+++ b/ql/src/test/results/clientpositive/spark/list_bucket_dml_10.q.java1.7.out
@@ -54,34 +54,6 @@ explain extended
 insert overwrite table list_bucketing_static_part partition (ds = '2008-04-08',  hr = '11')
 select key, value from src
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            src
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               list_bucketing_static_part
-            TOK_PARTSPEC
-               TOK_PARTVAL
-                  ds
-                  '2008-04-08'
-               TOK_PARTVAL
-                  hr
-                  '11'
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/spark/list_bucket_dml_2.q.java1.7.out b/ql/src/test/results/clientpositive/spark/list_bucket_dml_2.q.java1.7.out
index ab218c321f..d8da70cb2e 100644
--- a/ql/src/test/results/clientpositive/spark/list_bucket_dml_2.q.java1.7.out
+++ b/ql/src/test/results/clientpositive/spark/list_bucket_dml_2.q.java1.7.out
@@ -56,39 +56,6 @@ explain extended
 insert overwrite table list_bucketing_static_part partition (ds = '2008-04-08',  hr = '11')
 select key, value from srcpart where ds = '2008-04-08'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               list_bucketing_static_part
-            TOK_PARTSPEC
-               TOK_PARTVAL
-                  ds
-                  '2008-04-08'
-               TOK_PARTVAL
-                  hr
-                  '11'
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-      TOK_WHERE
-         =
-            TOK_TABLE_OR_COL
-               ds
-            '2008-04-08'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -368,42 +335,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select * from list_bucketing_static_part where ds = '2008-04-08' and  hr = '11' and key = '484' and value = 'val_484'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            list_bucketing_static_part
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         and
-            and
-               and
-                  =
-                     TOK_TABLE_OR_COL
-                        ds
-                     '2008-04-08'
-                  =
-                     TOK_TABLE_OR_COL
-                        hr
-                     '11'
-               =
-                  TOK_TABLE_OR_COL
-                     key
-                  '484'
-            =
-               TOK_TABLE_OR_COL
-                  value
-               'val_484'
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
diff --git a/ql/src/test/results/clientpositive/spark/load_dyn_part8.q.out b/ql/src/test/results/clientpositive/spark/load_dyn_part8.q.out
index 8d6fe334b5..b5283575d3 100644
--- a/ql/src/test/results/clientpositive/spark/load_dyn_part8.q.out
+++ b/ql/src/test/results/clientpositive/spark/load_dyn_part8.q.out
@@ -48,69 +48,6 @@ from srcpart
 insert overwrite table nzhang_part8 partition (ds, hr) select key, value, ds, hr where ds <= '2008-04-08'
 insert overwrite table nzhang_part8 partition(ds='2008-12-31', hr) select key, value, hr where ds > '2008-04-08'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               nzhang_part8
-            TOK_PARTSPEC
-               TOK_PARTVAL
-                  ds
-               TOK_PARTVAL
-                  hr
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               hr
-      TOK_WHERE
-         <=
-            TOK_TABLE_OR_COL
-               ds
-            '2008-04-08'
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               nzhang_part8
-            TOK_PARTSPEC
-               TOK_PARTVAL
-                  ds
-                  '2008-12-31'
-               TOK_PARTVAL
-                  hr
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               hr
-      TOK_WHERE
-         >
-            TOK_TABLE_OR_COL
-               ds
-            '2008-04-08'
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-0 depends on stages: Stage-2
diff --git a/ql/src/test/results/clientpositive/spark/louter_join_ppr.q.out b/ql/src/test/results/clientpositive/spark/louter_join_ppr.q.out
index f9225d7282..3d90dc4e80 100644
--- a/ql/src/test/results/clientpositive/spark/louter_join_ppr.q.out
+++ b/ql/src/test/results/clientpositive/spark/louter_join_ppr.q.out
@@ -20,90 +20,6 @@ EXPLAIN EXTENDED
  SELECT a.key, a.value, b.key, b.value
  WHERE a.key > 10 AND a.key < 20 AND b.key > 15 AND b.key < 25
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_LEFTOUTERJOIN
-         TOK_TABREF
-            TOK_TABNAME
-               src
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcpart
-            b
-         AND
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  ds
-               '2008-04-08'
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-      TOK_WHERE
-         AND
-            AND
-               AND
-                  >
-                     .
-                        TOK_TABLE_OR_COL
-                           a
-                        key
-                     10
-                  <
-                     .
-                        TOK_TABLE_OR_COL
-                           a
-                        key
-                     20
-               >
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-                  15
-            <
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-               25
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -408,90 +324,6 @@ POSTHOOK: query: EXPLAIN EXTENDED
  SELECT a.key, a.value, b.key, b.value
  WHERE a.key > 10 AND a.key < 20 AND b.key > 15 AND b.key < 25
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_LEFTOUTERJOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcpart
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               src
-            b
-         AND
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  ds
-               '2008-04-08'
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-      TOK_WHERE
-         AND
-            AND
-               AND
-                  >
-                     .
-                        TOK_TABLE_OR_COL
-                           a
-                        key
-                     10
-                  <
-                     .
-                        TOK_TABLE_OR_COL
-                           a
-                        key
-                     20
-               >
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-                  15
-            <
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-               25
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -903,90 +735,6 @@ POSTHOOK: query: EXPLAIN EXTENDED
  SELECT a.key, a.value, b.key, b.value
  WHERE a.key > 10 AND a.key < 20 AND b.key > 15 AND b.key < 25 AND b.ds = '2008-04-08'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_LEFTOUTERJOIN
-         TOK_TABREF
-            TOK_TABNAME
-               src
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcpart
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-      TOK_WHERE
-         AND
-            AND
-               AND
-                  AND
-                     >
-                        .
-                           TOK_TABLE_OR_COL
-                              a
-                           key
-                        10
-                     <
-                        .
-                           TOK_TABLE_OR_COL
-                              a
-                           key
-                        20
-                  >
-                     .
-                        TOK_TABLE_OR_COL
-                           b
-                        key
-                     15
-               <
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-                  25
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  ds
-               '2008-04-08'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1287,90 +1035,6 @@ POSTHOOK: query: EXPLAIN EXTENDED
  SELECT a.key, a.value, b.key, b.value
  WHERE a.key > 10 AND a.key < 20 AND b.key > 15 AND b.key < 25 AND a.ds = '2008-04-08'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_LEFTOUTERJOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcpart
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               src
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-      TOK_WHERE
-         AND
-            AND
-               AND
-                  AND
-                     >
-                        .
-                           TOK_TABLE_OR_COL
-                              a
-                           key
-                        10
-                     <
-                        .
-                           TOK_TABLE_OR_COL
-                              a
-                           key
-                        20
-                  >
-                     .
-                        TOK_TABLE_OR_COL
-                           b
-                        key
-                     15
-               <
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-                  25
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  ds
-               '2008-04-08'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/spark/mapjoin_mapjoin.q.out b/ql/src/test/results/clientpositive/spark/mapjoin_mapjoin.q.out
index fcc1dc25cc..aea47f7864 100644
--- a/ql/src/test/results/clientpositive/spark/mapjoin_mapjoin.q.out
+++ b/ql/src/test/results/clientpositive/spark/mapjoin_mapjoin.q.out
@@ -10,51 +10,6 @@ POSTHOOK: query: -- Since the inputs are small, it should be automatically conve
 
 explain extended select srcpart.key from srcpart join src on (srcpart.value=src.value) join src1 on (srcpart.key=src1.key)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_JOIN
-            TOK_TABREF
-               TOK_TABNAME
-                  srcpart
-            TOK_TABREF
-               TOK_TABNAME
-                  src
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     srcpart
-                  value
-               .
-                  TOK_TABLE_OR_COL
-                     src
-                  value
-         TOK_TABREF
-            TOK_TABNAME
-               src1
-         =
-            .
-               TOK_TABLE_OR_COL
-                  srcpart
-               key
-            .
-               TOK_TABLE_OR_COL
-                  src1
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  srcpart
-               key
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-1 depends on stages: Stage-2
diff --git a/ql/src/test/results/clientpositive/spark/optimize_nullscan.q.out b/ql/src/test/results/clientpositive/spark/optimize_nullscan.q.out
index 2d15f65485..4aecb730db 100644
--- a/ql/src/test/results/clientpositive/spark/optimize_nullscan.q.out
+++ b/ql/src/test/results/clientpositive/spark/optimize_nullscan.q.out
@@ -14,25 +14,6 @@ POSTHOOK: query: -- SORT_QUERY_RESULTS
 explain extended 
 select key from src where false
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            src
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-      TOK_WHERE
-         false
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
@@ -66,32 +47,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select count(key) from srcpart where 1=2 group by key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               TOK_TABLE_OR_COL
-                  key
-      TOK_WHERE
-         =
-            1
-            2
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            key
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -184,63 +139,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select * from (select key from src where false) a left outer join (select key from srcpart limit 0) b on a.key=b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_LEFTOUTERJOIN
-         TOK_SUBQUERY
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        src
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           key
-                  TOK_WHERE
-                     false
-            a
-         TOK_SUBQUERY
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        srcpart
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           key
-                  TOK_LIMIT
-                     0
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -616,54 +514,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select count(key) from src where false union all select count(key) from srcpart
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_UNIONALL
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        src
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_FUNCTION
-                           count
-                           TOK_TABLE_OR_COL
-                              key
-                  TOK_WHERE
-                     false
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        srcpart
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_FUNCTION
-                           count
-                           TOK_TABLE_OR_COL
-                              key
-         _u1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1054,54 +904,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select * from (select key from src where false) a left outer join (select value from srcpart limit 0) b
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_LEFTOUTERJOIN
-         TOK_SUBQUERY
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        src
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           key
-                  TOK_WHERE
-                     false
-            a
-         TOK_SUBQUERY
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        srcpart
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           value
-                  TOK_LIMIT
-                     0
-            b
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1476,65 +1278,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended 
 select * from (select key from src union all select src.key from src left outer join srcpart on src.key = srcpart.key) a  where false
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_UNIONALL
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        src
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           key
-            TOK_QUERY
-               TOK_FROM
-                  TOK_LEFTOUTERJOIN
-                     TOK_TABREF
-                        TOK_TABNAME
-                           src
-                     TOK_TABREF
-                        TOK_TABNAME
-                           srcpart
-                     =
-                        .
-                           TOK_TABLE_OR_COL
-                              src
-                           key
-                        .
-                           TOK_TABLE_OR_COL
-                              srcpart
-                           key
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        .
-                           TOK_TABLE_OR_COL
-                              src
-                           key
-         a
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         false
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1768,40 +1511,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended 
 select * from src s1, src s2 where false and s1.value = s2.value
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               src
-            s1
-         TOK_TABREF
-            TOK_TABNAME
-               src
-            s2
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         and
-            false
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     s1
-                  value
-               .
-                  TOK_TABLE_OR_COL
-                     s2
-                  value
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -2005,28 +1714,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select count(1) from src where null = 1
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            src
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_WHERE
-         =
-            TOK_NULL
-            1
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/spark/outer_join_ppr.q.java1.7.out b/ql/src/test/results/clientpositive/spark/outer_join_ppr.q.java1.7.out
index 9b1a503bb3..68943e1419 100644
--- a/ql/src/test/results/clientpositive/spark/outer_join_ppr.q.java1.7.out
+++ b/ql/src/test/results/clientpositive/spark/outer_join_ppr.q.java1.7.out
@@ -22,90 +22,6 @@ EXPLAIN EXTENDED
  SELECT a.key, a.value, b.key, b.value
  WHERE a.key > 10 AND a.key < 20 AND b.key > 15 AND b.key < 25
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_FULLOUTERJOIN
-         TOK_TABREF
-            TOK_TABNAME
-               src
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcpart
-            b
-         AND
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  ds
-               '2008-04-08'
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-      TOK_WHERE
-         AND
-            AND
-               AND
-                  >
-                     .
-                        TOK_TABLE_OR_COL
-                           a
-                        key
-                     10
-                  <
-                     .
-                        TOK_TABLE_OR_COL
-                           a
-                        key
-                     20
-               >
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-                  15
-            <
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-               25
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -505,90 +421,6 @@ POSTHOOK: query: EXPLAIN EXTENDED
  SELECT a.key, a.value, b.key, b.value
  WHERE a.key > 10 AND a.key < 20 AND b.key > 15 AND b.key < 25 AND b.ds = '2008-04-08'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_FULLOUTERJOIN
-         TOK_TABREF
-            TOK_TABNAME
-               src
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcpart
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-      TOK_WHERE
-         AND
-            AND
-               AND
-                  AND
-                     >
-                        .
-                           TOK_TABLE_OR_COL
-                              a
-                           key
-                        10
-                     <
-                        .
-                           TOK_TABLE_OR_COL
-                              a
-                           key
-                        20
-                  >
-                     .
-                        TOK_TABLE_OR_COL
-                           b
-                        key
-                     15
-               <
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-                  25
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  ds
-               '2008-04-08'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/spark/pcr.q.out b/ql/src/test/results/clientpositive/spark/pcr.q.out
index 6345effb2b..3dd2147ec7 100644
--- a/ql/src/test/results/clientpositive/spark/pcr.q.out
+++ b/ql/src/test/results/clientpositive/spark/pcr.q.out
@@ -52,48 +52,6 @@ PREHOOK: query: explain extended select key, value, ds from pcr_t1 where ds<='20
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select key, value, ds from pcr_t1 where ds<='2000-04-09' and key<5 order by key, ds
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            pcr_t1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds
-      TOK_WHERE
-         and
-            <=
-               TOK_TABLE_OR_COL
-                  ds
-               '2000-04-09'
-            <
-               TOK_TABLE_OR_COL
-                  key
-               5
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  key
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  ds
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -285,41 +243,6 @@ PREHOOK: query: explain extended select key, value from pcr_t1 where ds<='2000-0
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select key, value from pcr_t1 where ds<='2000-04-09' or key<5 order by key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            pcr_t1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-      TOK_WHERE
-         or
-            <=
-               TOK_TABLE_OR_COL
-                  ds
-               '2000-04-09'
-            <
-               TOK_TABLE_OR_COL
-                  key
-               5
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  key
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -594,53 +517,6 @@ PREHOOK: query: explain extended select key, value, ds from pcr_t1 where ds<='20
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select key, value, ds from pcr_t1 where ds<='2000-04-09' and key<5 and value != 'val_2' order by key, ds
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            pcr_t1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds
-      TOK_WHERE
-         and
-            and
-               <=
-                  TOK_TABLE_OR_COL
-                     ds
-                  '2000-04-09'
-               <
-                  TOK_TABLE_OR_COL
-                     key
-                  5
-            !=
-               TOK_TABLE_OR_COL
-                  value
-               'val_2'
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  key
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  ds
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -834,58 +710,6 @@ POSTHOOK: query: explain extended
 select key, value, ds from pcr_t1
 where (ds < '2000-04-09' and key < 5) or (ds > '2000-04-09' and value == 'val_5') order by key, ds
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            pcr_t1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds
-      TOK_WHERE
-         or
-            and
-               <
-                  TOK_TABLE_OR_COL
-                     ds
-                  '2000-04-09'
-               <
-                  TOK_TABLE_OR_COL
-                     key
-                  5
-            and
-               >
-                  TOK_TABLE_OR_COL
-                     ds
-                  '2000-04-09'
-               ==
-                  TOK_TABLE_OR_COL
-                     value
-                  'val_5'
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  key
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  ds
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1081,58 +905,6 @@ POSTHOOK: query: explain extended
 select key, value, ds from pcr_t1
 where (ds < '2000-04-10' and key < 5) or (ds > '2000-04-08' and value == 'val_5') order by key, ds
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            pcr_t1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds
-      TOK_WHERE
-         or
-            and
-               <
-                  TOK_TABLE_OR_COL
-                     ds
-                  '2000-04-10'
-               <
-                  TOK_TABLE_OR_COL
-                     key
-                  5
-            and
-               >
-                  TOK_TABLE_OR_COL
-                     ds
-                  '2000-04-08'
-               ==
-                  TOK_TABLE_OR_COL
-                     value
-                  'val_5'
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  key
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  ds
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1384,58 +1156,6 @@ POSTHOOK: query: explain extended
 select key, value, ds from pcr_t1
 where (ds < '2000-04-10' or key < 5) and (ds > '2000-04-08' or value == 'val_5') order by key, ds
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            pcr_t1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds
-      TOK_WHERE
-         and
-            or
-               <
-                  TOK_TABLE_OR_COL
-                     ds
-                  '2000-04-10'
-               <
-                  TOK_TABLE_OR_COL
-                     key
-                  5
-            or
-               >
-                  TOK_TABLE_OR_COL
-                     ds
-                  '2000-04-08'
-               ==
-                  TOK_TABLE_OR_COL
-                     value
-                  'val_5'
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  key
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  ds
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1695,50 +1415,6 @@ PREHOOK: query: explain extended select key, value from pcr_t1 where (ds='2000-0
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select key, value from pcr_t1 where (ds='2000-04-08' or ds='2000-04-09') and key=14 order by key, value
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            pcr_t1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-      TOK_WHERE
-         and
-            or
-               =
-                  TOK_TABLE_OR_COL
-                     ds
-                  '2000-04-08'
-               =
-                  TOK_TABLE_OR_COL
-                     ds
-                  '2000-04-09'
-            =
-               TOK_TABLE_OR_COL
-                  key
-               14
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  key
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  value
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1919,45 +1595,6 @@ PREHOOK: query: explain extended select key, value from pcr_t1 where ds='2000-04
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select key, value from pcr_t1 where ds='2000-04-08' or ds='2000-04-09' order by key, value
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            pcr_t1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-      TOK_WHERE
-         or
-            =
-               TOK_TABLE_OR_COL
-                  ds
-               '2000-04-08'
-            =
-               TOK_TABLE_OR_COL
-                  ds
-               '2000-04-09'
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  key
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  value
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -2174,45 +1811,6 @@ PREHOOK: query: explain extended select key, value from pcr_t1 where ds>='2000-0
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select key, value from pcr_t1 where ds>='2000-04-08' or ds<'2000-04-10' order by key, value
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            pcr_t1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-      TOK_WHERE
-         or
-            >=
-               TOK_TABLE_OR_COL
-                  ds
-               '2000-04-08'
-            <
-               TOK_TABLE_OR_COL
-                  ds
-               '2000-04-10'
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  key
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  value
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -2497,62 +2095,6 @@ PREHOOK: query: explain extended select key, value, ds from pcr_t1 where (ds='20
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select key, value, ds from pcr_t1 where (ds='2000-04-08' and key=1) or (ds='2000-04-09' and key=2) order by key, value, ds
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            pcr_t1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds
-      TOK_WHERE
-         or
-            and
-               =
-                  TOK_TABLE_OR_COL
-                     ds
-                  '2000-04-08'
-               =
-                  TOK_TABLE_OR_COL
-                     key
-                  1
-            and
-               =
-                  TOK_TABLE_OR_COL
-                     ds
-                  '2000-04-09'
-               =
-                  TOK_TABLE_OR_COL
-                     key
-                  2
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  key
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  value
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  ds
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -2734,58 +2276,6 @@ PREHOOK: query: explain extended select * from pcr_t1 t1 join pcr_t1 t2 on t1.ke
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select * from pcr_t1 t1 join pcr_t1 t2 on t1.key=t2.key and t1.ds='2000-04-08' and t2.ds='2000-04-08' order by t1.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               pcr_t1
-            t1
-         TOK_TABREF
-            TOK_TABNAME
-               pcr_t1
-            t2
-         and
-            and
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        t1
-                     key
-                  .
-                     TOK_TABLE_OR_COL
-                        t2
-                     key
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        t1
-                     ds
-                  '2000-04-08'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     t2
-                  ds
-               '2000-04-08'
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               .
-                  TOK_TABLE_OR_COL
-                     t1
-                  key
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -3051,58 +2541,6 @@ PREHOOK: query: explain extended select * from pcr_t1 t1 join pcr_t1 t2 on t1.ke
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select * from pcr_t1 t1 join pcr_t1 t2 on t1.key=t2.key and t1.ds='2000-04-08' and t2.ds='2000-04-09' order by t1.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               pcr_t1
-            t1
-         TOK_TABREF
-            TOK_TABNAME
-               pcr_t1
-            t2
-         and
-            and
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        t1
-                     key
-                  .
-                     TOK_TABLE_OR_COL
-                        t2
-                     key
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        t1
-                     ds
-                  '2000-04-08'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     t2
-                  ds
-               '2000-04-09'
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               .
-                  TOK_TABLE_OR_COL
-                     t1
-                  key
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -3380,67 +2818,6 @@ PREHOOK: query: explain extended select key, value, ds from pcr_t1 where (ds>'20
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select key, value, ds from pcr_t1 where (ds>'2000-04-08' and ds<'2000-04-11') or (ds>='2000-04-08' and ds<='2000-04-11' and key=2) order by key, value, ds
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            pcr_t1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds
-      TOK_WHERE
-         or
-            and
-               >
-                  TOK_TABLE_OR_COL
-                     ds
-                  '2000-04-08'
-               <
-                  TOK_TABLE_OR_COL
-                     ds
-                  '2000-04-11'
-            and
-               and
-                  >=
-                     TOK_TABLE_OR_COL
-                        ds
-                     '2000-04-08'
-                  <=
-                     TOK_TABLE_OR_COL
-                        ds
-                     '2000-04-11'
-               =
-                  TOK_TABLE_OR_COL
-                     key
-                  2
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  key
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  value
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  ds
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -3759,62 +3136,6 @@ PREHOOK: query: explain extended select key, value, ds from pcr_t1 where (ds>'20
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select key, value, ds from pcr_t1 where (ds>'2000-04-08' and ds<'2000-04-11') or (ds<='2000-04-09' and key=2) order by key, value, ds
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            pcr_t1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds
-      TOK_WHERE
-         or
-            and
-               >
-                  TOK_TABLE_OR_COL
-                     ds
-                  '2000-04-08'
-               <
-                  TOK_TABLE_OR_COL
-                     ds
-                  '2000-04-11'
-            and
-               <=
-                  TOK_TABLE_OR_COL
-                     ds
-                  '2000-04-09'
-               =
-                  TOK_TABLE_OR_COL
-                     key
-                  2
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  key
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  value
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  ds
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -4106,49 +3427,6 @@ from pcr_t1
 insert overwrite table pcr_t2 select key, value where ds='2000-04-08'
 insert overwrite table pcr_t3 select key, value where ds='2000-04-08'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            pcr_t1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               pcr_t2
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-      TOK_WHERE
-         =
-            TOK_TABLE_OR_COL
-               ds
-            '2000-04-08'
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               pcr_t3
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-      TOK_WHERE
-         =
-            TOK_TABLE_OR_COL
-               ds
-            '2000-04-08'
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-0 depends on stages: Stage-2
@@ -4360,59 +3638,6 @@ from pcr_t1
 insert overwrite table pcr_t2 select key, value where ds='2000-04-08' and key=2
 insert overwrite table pcr_t3 select key, value where ds='2000-04-08' and key=3
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            pcr_t1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               pcr_t2
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-      TOK_WHERE
-         and
-            =
-               TOK_TABLE_OR_COL
-                  ds
-               '2000-04-08'
-            =
-               TOK_TABLE_OR_COL
-                  key
-               2
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               pcr_t3
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-      TOK_WHERE
-         and
-            =
-               TOK_TABLE_OR_COL
-                  ds
-               '2000-04-08'
-            =
-               TOK_TABLE_OR_COL
-                  key
-               3
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-0 depends on stages: Stage-2
@@ -4646,43 +3871,6 @@ PREHOOK: query: explain extended select key, value from srcpart where ds='2008-0
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select key, value from srcpart where ds='2008-04-08' and hr=11 order by key limit 10
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-      TOK_WHERE
-         and
-            =
-               TOK_TABLE_OR_COL
-                  ds
-               '2008-04-08'
-            =
-               TOK_TABLE_OR_COL
-                  hr
-               11
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  key
-      TOK_LIMIT
-         10
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -4816,65 +4004,6 @@ PREHOOK: query: explain extended select key, value, ds, hr from srcpart where ds
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select key, value, ds, hr from srcpart where ds='2008-04-08' and (hr='11' or hr='12') and key=11 order by key, ds, hr
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               hr
-      TOK_WHERE
-         and
-            and
-               =
-                  TOK_TABLE_OR_COL
-                     ds
-                  '2008-04-08'
-               or
-                  =
-                     TOK_TABLE_OR_COL
-                        hr
-                     '11'
-                  =
-                     TOK_TABLE_OR_COL
-                        hr
-                     '12'
-            =
-               TOK_TABLE_OR_COL
-                  key
-               11
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  key
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  ds
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  hr
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -5060,55 +4189,6 @@ PREHOOK: query: explain extended select key, value, ds, hr from srcpart where hr
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select key, value, ds, hr from srcpart where hr='11' and key=11 order by key, ds, hr
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               hr
-      TOK_WHERE
-         and
-            =
-               TOK_TABLE_OR_COL
-                  hr
-               '11'
-            =
-               TOK_TABLE_OR_COL
-                  key
-               11
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  key
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  ds
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  hr
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/spark/ppd_join_filter.q.out b/ql/src/test/results/clientpositive/spark/ppd_join_filter.q.out
index 9f94f1695e..6b1cadf4f3 100644
--- a/ql/src/test/results/clientpositive/spark/ppd_join_filter.q.out
+++ b/ql/src/test/results/clientpositive/spark/ppd_join_filter.q.out
@@ -24,101 +24,6 @@ group by key
 ) b
 on a.key=b.key and b.k1 < 5
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               src
-            a
-         TOK_SUBQUERY
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        src
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           key
-                     TOK_SELEXPR
-                        TOK_FUNCTION
-                           min
-                           TOK_TABLE_OR_COL
-                              key
-                        k
-                     TOK_SELEXPR
-                        +
-                           TOK_FUNCTION
-                              min
-                              TOK_TABLE_OR_COL
-                                 key
-                           1
-                        k1
-                     TOK_SELEXPR
-                        +
-                           TOK_FUNCTION
-                              min
-                              TOK_TABLE_OR_COL
-                                 key
-                           2
-                        k2
-                     TOK_SELEXPR
-                        +
-                           TOK_FUNCTION
-                              min
-                              TOK_TABLE_OR_COL
-                                 key
-                           3
-                        k3
-                  TOK_GROUPBY
-                     TOK_TABLE_OR_COL
-                        key
-            b
-         and
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-            <
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  k1
-               5
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               k2
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               k3
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -406,101 +311,6 @@ group by key
 ) b
 on a.key=b.key and b.k1 < 5
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               src
-            a
-         TOK_SUBQUERY
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        src
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           key
-                     TOK_SELEXPR
-                        TOK_FUNCTION
-                           min
-                           TOK_TABLE_OR_COL
-                              key
-                        k
-                     TOK_SELEXPR
-                        +
-                           TOK_FUNCTION
-                              min
-                              TOK_TABLE_OR_COL
-                                 key
-                           1
-                        k1
-                     TOK_SELEXPR
-                        +
-                           TOK_FUNCTION
-                              min
-                              TOK_TABLE_OR_COL
-                                 key
-                           2
-                        k2
-                     TOK_SELEXPR
-                        +
-                           TOK_FUNCTION
-                              min
-                              TOK_TABLE_OR_COL
-                                 key
-                           3
-                        k3
-                  TOK_GROUPBY
-                     TOK_TABLE_OR_COL
-                        key
-            b
-         and
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-            <
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  k1
-               5
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               k2
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               k3
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -788,101 +598,6 @@ group by key
 ) b
 on a.key=b.key and b.k1 < 5
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               src
-            a
-         TOK_SUBQUERY
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        src
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           key
-                     TOK_SELEXPR
-                        TOK_FUNCTION
-                           min
-                           TOK_TABLE_OR_COL
-                              key
-                        k
-                     TOK_SELEXPR
-                        +
-                           TOK_FUNCTION
-                              min
-                              TOK_TABLE_OR_COL
-                                 key
-                           1
-                        k1
-                     TOK_SELEXPR
-                        +
-                           TOK_FUNCTION
-                              min
-                              TOK_TABLE_OR_COL
-                                 key
-                           2
-                        k2
-                     TOK_SELEXPR
-                        +
-                           TOK_FUNCTION
-                              min
-                              TOK_TABLE_OR_COL
-                                 key
-                           3
-                        k3
-                  TOK_GROUPBY
-                     TOK_TABLE_OR_COL
-                        key
-            b
-         and
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-            <
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  k1
-               5
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               k2
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               k3
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1170,101 +885,6 @@ group by key
 ) b
 on a.key=b.key and b.k1 < 5
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               src
-            a
-         TOK_SUBQUERY
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        src
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           key
-                     TOK_SELEXPR
-                        TOK_FUNCTION
-                           min
-                           TOK_TABLE_OR_COL
-                              key
-                        k
-                     TOK_SELEXPR
-                        +
-                           TOK_FUNCTION
-                              min
-                              TOK_TABLE_OR_COL
-                                 key
-                           1
-                        k1
-                     TOK_SELEXPR
-                        +
-                           TOK_FUNCTION
-                              min
-                              TOK_TABLE_OR_COL
-                                 key
-                           2
-                        k2
-                     TOK_SELEXPR
-                        +
-                           TOK_FUNCTION
-                              min
-                              TOK_TABLE_OR_COL
-                                 key
-                           3
-                        k3
-                  TOK_GROUPBY
-                     TOK_TABLE_OR_COL
-                        key
-            b
-         and
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-            <
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  k1
-               5
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               k2
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               k3
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/spark/reduce_deduplicate.q.out b/ql/src/test/results/clientpositive/spark/reduce_deduplicate.q.out
index 83988d3a2b..3f5f649831 100644
--- a/ql/src/test/results/clientpositive/spark/reduce_deduplicate.q.out
+++ b/ql/src/test/results/clientpositive/spark/reduce_deduplicate.q.out
@@ -14,26 +14,6 @@ POSTHOOK: query: explain extended
 insert overwrite table bucket5_1
 select * from src cluster by key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            src
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucket5_1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_CLUSTERBY
-         TOK_TABLE_OR_COL
-            key
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -254,133 +234,6 @@ select s2.* from
 )s
 )s2
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_QUERY
-            TOK_FROM
-               TOK_SUBQUERY
-                  TOK_QUERY
-                     TOK_FROM
-                        TOK_TABREF
-                           TOK_TABNAME
-                              complex_tbl_2
-                     TOK_INSERT
-                        TOK_DESTINATION
-                           TOK_DIR
-                              TOK_TMP_FILE
-                        TOK_SELECT
-                           TOK_SELEXPR
-                              TOK_TRANSFORM
-                                 TOK_EXPLIST
-                                    TOK_TABLE_OR_COL
-                                       aet
-                                    TOK_TABLE_OR_COL
-                                       aes
-                                 TOK_SERDE
-                                 TOK_RECORDWRITER
-                                 'cat'
-                                 TOK_SERDE
-                                 TOK_RECORDREADER
-                                 TOK_TABCOLLIST
-                                    TOK_TABCOL
-                                       aid
-                                       TOK_STRING
-                                    TOK_TABCOL
-                                       bid
-                                       TOK_STRING
-                                    TOK_TABCOL
-                                       t
-                                       TOK_INT
-                                    TOK_TABCOL
-                                       ctime
-                                       TOK_STRING
-                                    TOK_TABCOL
-                                       etime
-                                       TOK_BIGINT
-                                    TOK_TABCOL
-                                       l
-                                       TOK_STRING
-                                    TOK_TABCOL
-                                       et
-                                       TOK_STRING
-                        TOK_WHERE
-                           =
-                              TOK_TABLE_OR_COL
-                                 ds
-                              '2010-03-29'
-                        TOK_CLUSTERBY
-                           TOK_TABLE_OR_COL
-                              bid
-                  s
-            TOK_INSERT
-               TOK_DESTINATION
-                  TOK_DIR
-                     TOK_TMP_FILE
-               TOK_SELECT
-                  TOK_SELEXPR
-                     TOK_TRANSFORM
-                        TOK_EXPLIST
-                           TOK_TABLE_OR_COL
-                              aid
-                           TOK_TABLE_OR_COL
-                              bid
-                           TOK_TABLE_OR_COL
-                              t
-                           TOK_TABLE_OR_COL
-                              ctime
-                           TOK_TABLE_OR_COL
-                              etime
-                           TOK_TABLE_OR_COL
-                              l
-                           TOK_TABLE_OR_COL
-                              et
-                        TOK_SERDE
-                        TOK_RECORDWRITER
-                        'cat'
-                        TOK_SERDE
-                        TOK_RECORDREADER
-                        TOK_TABCOLLIST
-                           TOK_TABCOL
-                              aid
-                              TOK_STRING
-                           TOK_TABCOL
-                              bid
-                              TOK_STRING
-                           TOK_TABCOL
-                              t
-                              TOK_INT
-                           TOK_TABCOL
-                              ctime
-                              TOK_STRING
-                           TOK_TABCOL
-                              etime
-                              TOK_BIGINT
-                           TOK_TABCOL
-                              l
-                              TOK_STRING
-                           TOK_TABCOL
-                              et
-                              TOK_STRING
-         s2
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               complex_tbl_1
-            TOK_PARTSPEC
-               TOK_PARTVAL
-                  ds
-                  '2010-03-29'
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-               TOK_TABNAME
-                  s2
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/spark/router_join_ppr.q.out b/ql/src/test/results/clientpositive/spark/router_join_ppr.q.out
index 4efa2062fe..1149f16417 100644
--- a/ql/src/test/results/clientpositive/spark/router_join_ppr.q.out
+++ b/ql/src/test/results/clientpositive/spark/router_join_ppr.q.out
@@ -20,90 +20,6 @@ EXPLAIN EXTENDED
  SELECT a.key, a.value, b.key, b.value
  WHERE a.key > 10 AND a.key < 20 AND b.key > 15 AND b.key < 25
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_RIGHTOUTERJOIN
-         TOK_TABREF
-            TOK_TABNAME
-               src
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcpart
-            b
-         AND
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  ds
-               '2008-04-08'
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-      TOK_WHERE
-         AND
-            AND
-               AND
-                  >
-                     .
-                        TOK_TABLE_OR_COL
-                           a
-                        key
-                     10
-                  <
-                     .
-                        TOK_TABLE_OR_COL
-                           a
-                        key
-                     20
-               >
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-                  15
-            <
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-               25
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -511,90 +427,6 @@ POSTHOOK: query: EXPLAIN EXTENDED
  SELECT a.key, a.value, b.key, b.value
  WHERE a.key > 10 AND a.key < 20 AND b.key > 15 AND b.key < 25
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_RIGHTOUTERJOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcpart
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               src
-            b
-         AND
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  ds
-               '2008-04-08'
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-      TOK_WHERE
-         AND
-            AND
-               AND
-                  >
-                     .
-                        TOK_TABLE_OR_COL
-                           a
-                        key
-                     10
-                  <
-                     .
-                        TOK_TABLE_OR_COL
-                           a
-                        key
-                     20
-               >
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-                  15
-            <
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-               25
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -903,90 +735,6 @@ POSTHOOK: query: EXPLAIN EXTENDED
  SELECT a.key, a.value, b.key, b.value
  WHERE a.key > 10 AND a.key < 20 AND b.key > 15 AND b.key < 25 AND b.ds = '2008-04-08'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_RIGHTOUTERJOIN
-         TOK_TABREF
-            TOK_TABNAME
-               src
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcpart
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-      TOK_WHERE
-         AND
-            AND
-               AND
-                  AND
-                     >
-                        .
-                           TOK_TABLE_OR_COL
-                              a
-                           key
-                        10
-                     <
-                        .
-                           TOK_TABLE_OR_COL
-                              a
-                           key
-                        20
-                  >
-                     .
-                        TOK_TABLE_OR_COL
-                           b
-                        key
-                     15
-               <
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-                  25
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  ds
-               '2008-04-08'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1291,90 +1039,6 @@ POSTHOOK: query: EXPLAIN EXTENDED
  SELECT a.key, a.value, b.key, b.value
  WHERE a.key > 10 AND a.key < 20 AND b.key > 15 AND b.key < 25 AND a.ds = '2008-04-08'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_RIGHTOUTERJOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcpart
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               src
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-      TOK_WHERE
-         AND
-            AND
-               AND
-                  AND
-                     >
-                        .
-                           TOK_TABLE_OR_COL
-                              a
-                           key
-                        10
-                     <
-                        .
-                           TOK_TABLE_OR_COL
-                              a
-                           key
-                        20
-                  >
-                     .
-                        TOK_TABLE_OR_COL
-                           b
-                        key
-                     15
-               <
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-                  25
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  ds
-               '2008-04-08'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/spark/sample1.q.out b/ql/src/test/results/clientpositive/spark/sample1.q.out
index 1d574cc08b..15b1016555 100644
--- a/ql/src/test/results/clientpositive/spark/sample1.q.out
+++ b/ql/src/test/results/clientpositive/spark/sample1.q.out
@@ -18,45 +18,6 @@ INSERT OVERWRITE TABLE dest1 SELECT s.*
 FROM srcpart TABLESAMPLE (BUCKET 1 OUT OF 1 ON rand()) s
 WHERE s.ds='2008-04-08' and s.hr='11'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-         TOK_TABLEBUCKETSAMPLE
-            1
-            1
-            TOK_FUNCTION
-               rand
-         s
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dest1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-               TOK_TABNAME
-                  s
-      TOK_WHERE
-         and
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     s
-                  ds
-               '2008-04-08'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     s
-                  hr
-               '11'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/spark/sample10.q.out b/ql/src/test/results/clientpositive/spark/sample10.q.out
index 3130d6991f..386f512704 100644
--- a/ql/src/test/results/clientpositive/spark/sample10.q.out
+++ b/ql/src/test/results/clientpositive/spark/sample10.q.out
@@ -43,45 +43,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select ds, count(1) from srcpartbucket tablesample (bucket 1 out of 4 on key) where ds is not null group by ds ORDER BY ds ASC
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpartbucket
-         TOK_TABLEBUCKETSAMPLE
-            1
-            4
-            TOK_TABLE_OR_COL
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_WHERE
-         TOK_FUNCTION
-            TOK_ISNOTNULL
-            TOK_TABLE_OR_COL
-               ds
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            ds
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  ds
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/spark/sample2.q.out b/ql/src/test/results/clientpositive/spark/sample2.q.out
index 6c070f0934..28108bbc8c 100644
--- a/ql/src/test/results/clientpositive/spark/sample2.q.out
+++ b/ql/src/test/results/clientpositive/spark/sample2.q.out
@@ -18,29 +18,6 @@ EXPLAIN EXTENDED
 INSERT OVERWRITE TABLE dest1 SELECT s.* 
 FROM srcbucket TABLESAMPLE (BUCKET 1 OUT OF 2) s
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcbucket
-         TOK_TABLEBUCKETSAMPLE
-            1
-            2
-         s
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dest1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-               TOK_TABNAME
-                  s
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/spark/sample4.q.out b/ql/src/test/results/clientpositive/spark/sample4.q.out
index d6a0808748..25f300d7d1 100644
--- a/ql/src/test/results/clientpositive/spark/sample4.q.out
+++ b/ql/src/test/results/clientpositive/spark/sample4.q.out
@@ -18,31 +18,6 @@ EXPLAIN EXTENDED
 INSERT OVERWRITE TABLE dest1 SELECT s.*
 FROM srcbucket TABLESAMPLE (BUCKET 1 OUT OF 2 on key) s
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcbucket
-         TOK_TABLEBUCKETSAMPLE
-            1
-            2
-            TOK_TABLE_OR_COL
-               key
-         s
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dest1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-               TOK_TABNAME
-                  s
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/spark/sample5.q.out b/ql/src/test/results/clientpositive/spark/sample5.q.out
index 928b6739d9..8aebfe5ae2 100644
--- a/ql/src/test/results/clientpositive/spark/sample5.q.out
+++ b/ql/src/test/results/clientpositive/spark/sample5.q.out
@@ -20,31 +20,6 @@ EXPLAIN EXTENDED
 INSERT OVERWRITE TABLE dest1 SELECT s.* -- here's another test
 FROM srcbucket TABLESAMPLE (BUCKET 1 OUT OF 5 on key) s
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcbucket
-         TOK_TABLEBUCKETSAMPLE
-            1
-            5
-            TOK_TABLE_OR_COL
-               key
-         s
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dest1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-               TOK_TABNAME
-                  s
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/spark/sample6.q.out b/ql/src/test/results/clientpositive/spark/sample6.q.out
index 42dc25bf24..2b497124dc 100644
--- a/ql/src/test/results/clientpositive/spark/sample6.q.out
+++ b/ql/src/test/results/clientpositive/spark/sample6.q.out
@@ -16,31 +16,6 @@ EXPLAIN EXTENDED
 INSERT OVERWRITE TABLE dest1 SELECT s.*
 FROM srcbucket TABLESAMPLE (BUCKET 1 OUT OF 4 on key) s
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcbucket
-         TOK_TABLEBUCKETSAMPLE
-            1
-            4
-            TOK_TABLE_OR_COL
-               key
-         s
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dest1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-               TOK_TABNAME
-                  s
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -445,39 +420,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN EXTENDED SELECT s.* FROM srcbucket TABLESAMPLE (BUCKET 4 OUT OF 4 on key) s
 ORDER BY key, value
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcbucket
-         TOK_TABLEBUCKETSAMPLE
-            4
-            4
-            TOK_TABLE_OR_COL
-               key
-         s
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-               TOK_TABNAME
-                  s
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  key
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  value
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -853,39 +795,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN EXTENDED SELECT s.* FROM srcbucket TABLESAMPLE (BUCKET 1 OUT OF 2 on key) s
 ORDER BY key, value
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcbucket
-         TOK_TABLEBUCKETSAMPLE
-            1
-            2
-            TOK_TABLE_OR_COL
-               key
-         s
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-               TOK_TABNAME
-                  s
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  key
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  value
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1515,39 +1424,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN EXTENDED SELECT s.* FROM srcbucket TABLESAMPLE (BUCKET 1 OUT OF 3 on key) s
 ORDER BY key, value
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcbucket
-         TOK_TABLEBUCKETSAMPLE
-            1
-            3
-            TOK_TABLE_OR_COL
-               key
-         s
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-               TOK_TABNAME
-                  s
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  key
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  value
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -2019,39 +1895,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN EXTENDED SELECT s.* FROM srcbucket TABLESAMPLE (BUCKET 2 OUT OF 3 on key) s
 ORDER BY key, value
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcbucket
-         TOK_TABLEBUCKETSAMPLE
-            2
-            3
-            TOK_TABLE_OR_COL
-               key
-         s
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-               TOK_TABNAME
-                  s
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  key
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  value
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -2509,39 +2352,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN EXTENDED SELECT s.* FROM srcbucket2 TABLESAMPLE (BUCKET 1 OUT OF 2 on key) s
 ORDER BY key, value
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcbucket2
-         TOK_TABLEBUCKETSAMPLE
-            1
-            2
-            TOK_TABLE_OR_COL
-               key
-         s
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-               TOK_TABNAME
-                  s
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  key
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  value
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -2847,39 +2657,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN EXTENDED SELECT s.* FROM srcbucket2 TABLESAMPLE (BUCKET 2 OUT OF 4 on key) s
 ORDER BY key, value
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcbucket2
-         TOK_TABLEBUCKETSAMPLE
-            2
-            4
-            TOK_TABLE_OR_COL
-               key
-         s
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-               TOK_TABNAME
-                  s
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  key
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  value
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -3062,39 +2839,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN EXTENDED SELECT s.* FROM empty_bucket TABLESAMPLE (BUCKET 1 OUT OF 2 on key) s
 ORDER BY key, value
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            empty_bucket
-         TOK_TABLEBUCKETSAMPLE
-            1
-            2
-            TOK_TABLE_OR_COL
-               key
-         s
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-               TOK_TABNAME
-                  s
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  key
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               TOK_TABLE_OR_COL
-                  value
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/spark/sample7.q.out b/ql/src/test/results/clientpositive/spark/sample7.q.out
index 4b87cbd9e7..6c17ab153b 100644
--- a/ql/src/test/results/clientpositive/spark/sample7.q.out
+++ b/ql/src/test/results/clientpositive/spark/sample7.q.out
@@ -18,38 +18,6 @@ INSERT OVERWRITE TABLE dest1 SELECT s.*
 FROM srcbucket TABLESAMPLE (BUCKET 1 OUT OF 4 on key) s
 WHERE s.key > 100
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcbucket
-         TOK_TABLEBUCKETSAMPLE
-            1
-            4
-            TOK_TABLE_OR_COL
-               key
-         s
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dest1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-               TOK_TABNAME
-                  s
-      TOK_WHERE
-         >
-            .
-               TOK_TABLE_OR_COL
-                  s
-               key
-            100
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/spark/sample8.q.out b/ql/src/test/results/clientpositive/spark/sample8.q.out
index ae145b2bfd..e847fa5ad1 100644
--- a/ql/src/test/results/clientpositive/spark/sample8.q.out
+++ b/ql/src/test/results/clientpositive/spark/sample8.q.out
@@ -16,74 +16,6 @@ FROM srcpart TABLESAMPLE (BUCKET 1 OUT OF 1 ON key) s
 JOIN srcpart TABLESAMPLE (BUCKET 1 OUT OF 10 ON key) t
 WHERE t.key = s.key and t.value = s.value and s.ds='2008-04-08' and s.hr='11'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcpart
-            TOK_TABLEBUCKETSAMPLE
-               1
-               1
-               TOK_TABLE_OR_COL
-                  key
-            s
-         TOK_TABREF
-            TOK_TABNAME
-               srcpart
-            TOK_TABLEBUCKETSAMPLE
-               1
-               10
-               TOK_TABLE_OR_COL
-                  key
-            t
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-               TOK_TABNAME
-                  s
-      TOK_WHERE
-         and
-            and
-               and
-                  =
-                     .
-                        TOK_TABLE_OR_COL
-                           t
-                        key
-                     .
-                        TOK_TABLE_OR_COL
-                           s
-                        key
-                  =
-                     .
-                        TOK_TABLE_OR_COL
-                           t
-                        value
-                     .
-                        TOK_TABLE_OR_COL
-                           s
-                        value
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        s
-                     ds
-                  '2008-04-08'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     s
-                  hr
-               '11'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/spark/sample9.q.out b/ql/src/test/results/clientpositive/spark/sample9.q.out
index 1a84bd6a63..46974e5868 100644
--- a/ql/src/test/results/clientpositive/spark/sample9.q.out
+++ b/ql/src/test/results/clientpositive/spark/sample9.q.out
@@ -6,43 +6,6 @@ POSTHOOK: query: EXPLAIN EXTENDED
 SELECT s.*
 FROM (SELECT a.* FROM srcbucket TABLESAMPLE (BUCKET 1 OUT OF 2 on key) a) s
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_QUERY
-            TOK_FROM
-               TOK_TABREF
-                  TOK_TABNAME
-                     srcbucket
-                  TOK_TABLEBUCKETSAMPLE
-                     1
-                     2
-                     TOK_TABLE_OR_COL
-                        key
-                  a
-            TOK_INSERT
-               TOK_DESTINATION
-                  TOK_DIR
-                     TOK_TMP_FILE
-               TOK_SELECT
-                  TOK_SELEXPR
-                     TOK_ALLCOLREF
-                        TOK_TABNAME
-                           a
-         s
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-               TOK_TABNAME
-                  s
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
diff --git a/ql/src/test/results/clientpositive/spark/smb_mapjoin_11.q.out b/ql/src/test/results/clientpositive/spark/smb_mapjoin_11.q.out
index a14ca28972..bb2eac915f 100644
--- a/ql/src/test/results/clientpositive/spark/smb_mapjoin_11.q.out
+++ b/ql/src/test/results/clientpositive/spark/smb_mapjoin_11.q.out
@@ -56,69 +56,6 @@ POSTHOOK: query: -- Insert data into the bucketed table by joining the two bucke
 EXPLAIN EXTENDED
 INSERT OVERWRITE TABLE test_table3 PARTITION (ds = '1') SELECT /*+ MAPJOIN(b) */ a.key, b.value FROM test_table1 a JOIN test_table2 b ON a.key = b.key AND a.ds = '1' AND b.ds = '1'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               test_table1
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               test_table2
-            b
-         AND
-            AND
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     key
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     ds
-                  '1'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  ds
-               '1'
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               test_table3
-            TOK_PARTSPEC
-               TOK_PARTVAL
-                  ds
-                  '1'
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1853,25 +1790,6 @@ PREHOOK: query: EXPLAIN EXTENDED SELECT * FROM test_table1 TABLESAMPLE(BUCKET 2
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN EXTENDED SELECT * FROM test_table1 TABLESAMPLE(BUCKET 2 OUT OF 16)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            test_table1
-         TOK_TABLEBUCKETSAMPLE
-            2
-            16
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
@@ -1943,25 +1861,6 @@ PREHOOK: query: EXPLAIN EXTENDED SELECT * FROM test_table3 TABLESAMPLE(BUCKET 2
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN EXTENDED SELECT * FROM test_table3 TABLESAMPLE(BUCKET 2 OUT OF 16)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            test_table3
-         TOK_TABLEBUCKETSAMPLE
-            2
-            16
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
diff --git a/ql/src/test/results/clientpositive/spark/smb_mapjoin_12.q.out b/ql/src/test/results/clientpositive/spark/smb_mapjoin_12.q.out
index 59ad4068a1..d186987307 100644
--- a/ql/src/test/results/clientpositive/spark/smb_mapjoin_12.q.out
+++ b/ql/src/test/results/clientpositive/spark/smb_mapjoin_12.q.out
@@ -68,69 +68,6 @@ POSTHOOK: query: -- Insert data into the bucketed table by joining the two bucke
 EXPLAIN EXTENDED
 INSERT OVERWRITE TABLE test_table3 PARTITION (ds = '1') SELECT /*+ MAPJOIN(b) */ a.key, b.value FROM test_table1 a JOIN test_table2 b ON a.key = b.key AND a.ds = '1' AND b.ds >= '1'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               test_table1
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               test_table2
-            b
-         AND
-            AND
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     key
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     ds
-                  '1'
-            >=
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  ds
-               '1'
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               test_table3
-            TOK_PARTSPEC
-               TOK_PARTVAL
-                  ds
-                  '1'
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -347,75 +284,6 @@ explain extended
 INSERT OVERWRITE TABLE test_table3 PARTITION (ds = '2') 
 SELECT /*+mapjoin(b)*/ a.key, concat(a.value, b.value) FROM test_table3 a JOIN test_table1 b ON a.key = b.key AND a.ds = '1' AND b.ds='1'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               test_table3
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               test_table1
-            b
-         AND
-            AND
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     key
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     ds
-                  '1'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  ds
-               '1'
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               test_table3
-            TOK_PARTSPEC
-               TOK_PARTVAL
-                  ds
-                  '2'
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            TOK_FUNCTION
-               concat
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  value
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  value
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/spark/smb_mapjoin_13.q.out b/ql/src/test/results/clientpositive/spark/smb_mapjoin_13.q.out
index eee4ddb24a..7e6f225043 100644
--- a/ql/src/test/results/clientpositive/spark/smb_mapjoin_13.q.out
+++ b/ql/src/test/results/clientpositive/spark/smb_mapjoin_13.q.out
@@ -76,51 +76,6 @@ POSTHOOK: query: -- Join data from 2 tables on their respective sorted columns (
 EXPLAIN EXTENDED
 SELECT /*+mapjoin(b)*/ * FROM test_table1 a JOIN test_table2 b ON a.key = b.value ORDER BY a.key LIMIT 10
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               test_table1
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               test_table2
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-      TOK_LIMIT
-         10
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -288,51 +243,6 @@ POSTHOOK: query: -- Join data from 2 tables on their respective columns (two eac
 EXPLAIN EXTENDED
 SELECT /*+mapjoin(b)*/ * FROM test_table3 a JOIN test_table4 b ON a.key = b.value ORDER BY a.key LIMIT 10
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               test_table3
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               test_table4
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-      TOK_LIMIT
-         10
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-1 depends on stages: Stage-2
diff --git a/ql/src/test/results/clientpositive/spark/smb_mapjoin_15.q.out b/ql/src/test/results/clientpositive/spark/smb_mapjoin_15.q.out
index bafa6366bc..4152280e18 100644
--- a/ql/src/test/results/clientpositive/spark/smb_mapjoin_15.q.out
+++ b/ql/src/test/results/clientpositive/spark/smb_mapjoin_15.q.out
@@ -48,51 +48,6 @@ POSTHOOK: query: -- it should be converted to a sort-merge join, since the first
 EXPLAIN EXTENDED
 SELECT /*+mapjoin(b)*/ * FROM test_table1 a JOIN test_table2 b ON a.key = b.key ORDER BY a.key LIMIT 10
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               test_table1
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               test_table2
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-      TOK_LIMIT
-         10
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -312,61 +267,6 @@ POSTHOOK: query: -- it should be converted to a sort-merge join, since the first
 EXPLAIN EXTENDED
 SELECT /*+mapjoin(b)*/ * FROM test_table1 a JOIN test_table2 b ON a.key = b.key and a.key2 = b.key2 ORDER BY a.key LIMIT 10
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               test_table1
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               test_table2
-            b
-         and
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key2
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key2
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-      TOK_LIMIT
-         10
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -534,61 +434,6 @@ POSTHOOK: query: -- it should be converted to a sort-merge join, since the first
 EXPLAIN EXTENDED
 SELECT /*+mapjoin(b)*/ * FROM test_table1 a JOIN test_table2 b ON a.key2 = b.key2 and a.key = b.key ORDER BY a.key LIMIT 10
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               test_table1
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               test_table2
-            b
-         and
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key2
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key2
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-      TOK_LIMIT
-         10
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -756,61 +601,6 @@ POSTHOOK: query: -- it should not be converted to a sort-merge join, since the f
 EXPLAIN EXTENDED
 SELECT /*+mapjoin(b)*/ * FROM test_table1 a JOIN test_table2 b ON a.key = b.key and a.value = b.value ORDER BY a.key LIMIT 10
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               test_table1
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               test_table2
-            b
-         and
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  value
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  value
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_ORDERBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-      TOK_LIMIT
-         10
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-1 depends on stages: Stage-2
diff --git a/ql/src/test/results/clientpositive/spark/stats0.q.out b/ql/src/test/results/clientpositive/spark/stats0.q.out
index 6f881b46ea..e74132055a 100644
--- a/ql/src/test/results/clientpositive/spark/stats0.q.out
+++ b/ql/src/test/results/clientpositive/spark/stats0.q.out
@@ -14,23 +14,6 @@ POSTHOOK: query: explain extended
 insert overwrite table stats_non_partitioned
 select * from src
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            src
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               stats_non_partitioned
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1335,23 +1318,6 @@ POSTHOOK: query: explain extended
 insert overwrite table stats_non_partitioned
 select * from src
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            src
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               stats_non_partitioned
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/spark/stats12.q.out b/ql/src/test/results/clientpositive/spark/stats12.q.out
index 64079ef079..a321e3f158 100644
--- a/ql/src/test/results/clientpositive/spark/stats12.q.out
+++ b/ql/src/test/results/clientpositive/spark/stats12.q.out
@@ -39,20 +39,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 analyze table analyze_srcpart PARTITION(ds='2008-04-08',hr) compute statistics
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_ANALYZE
-   TOK_TAB
-      TOK_TABNAME
-         analyze_srcpart
-      TOK_PARTSPEC
-         TOK_PARTVAL
-            ds
-            '2008-04-08'
-         TOK_PARTVAL
-            hr
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
   Stage-1 depends on stages: Stage-0
diff --git a/ql/src/test/results/clientpositive/spark/stats13.q.out b/ql/src/test/results/clientpositive/spark/stats13.q.out
index 9355b704d1..c4778c99bf 100644
--- a/ql/src/test/results/clientpositive/spark/stats13.q.out
+++ b/ql/src/test/results/clientpositive/spark/stats13.q.out
@@ -39,21 +39,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 analyze table analyze_srcpart PARTITION(ds='2008-04-08',hr=11) compute statistics
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_ANALYZE
-   TOK_TAB
-      TOK_TABNAME
-         analyze_srcpart
-      TOK_PARTSPEC
-         TOK_PARTVAL
-            ds
-            '2008-04-08'
-         TOK_PARTVAL
-            hr
-            11
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
   Stage-1 depends on stages: Stage-0
diff --git a/ql/src/test/results/clientpositive/spark/stats3.q.out b/ql/src/test/results/clientpositive/spark/stats3.q.out
index 0d8cbbd16b..4dbda94c96 100644
--- a/ql/src/test/results/clientpositive/spark/stats3.q.out
+++ b/ql/src/test/results/clientpositive/spark/stats3.q.out
@@ -20,17 +20,6 @@ PREHOOK: type: LOAD
 POSTHOOK: query: explain extended
 load data local inpath '../../data/files/test.dat' overwrite into table hive_test_src
 POSTHOOK: type: LOAD
-ABSTRACT SYNTAX TREE:
-  
-TOK_LOAD
-   '../../data/files/test.dat'
-   TOK_TAB
-      TOK_TABNAME
-         hive_test_src
-   local
-   overwrite
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
   Stage-1 depends on stages: Stage-0
diff --git a/ql/src/test/results/clientpositive/spark/transform_ppr1.q.out b/ql/src/test/results/clientpositive/spark/transform_ppr1.q.out
index 8b8bff6ebf..57cb338793 100644
--- a/ql/src/test/results/clientpositive/spark/transform_ppr1.q.out
+++ b/ql/src/test/results/clientpositive/spark/transform_ppr1.q.out
@@ -20,81 +20,6 @@ FROM (
 ) tmap
 SELECT tmap.tkey, tmap.tvalue WHERE tmap.tkey < 100 AND tmap.ds = '2008-04-08'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_QUERY
-            TOK_FROM
-               TOK_TABREF
-                  TOK_TABNAME
-                     srcpart
-                  src
-            TOK_INSERT
-               TOK_DESTINATION
-                  TOK_DIR
-                     TOK_TMP_FILE
-               TOK_SELECT
-                  TOK_SELEXPR
-                     TOK_TRANSFORM
-                        TOK_EXPLIST
-                           .
-                              TOK_TABLE_OR_COL
-                                 src
-                              ds
-                           .
-                              TOK_TABLE_OR_COL
-                                 src
-                              key
-                           .
-                              TOK_TABLE_OR_COL
-                                 src
-                              value
-                        TOK_SERDE
-                        TOK_RECORDWRITER
-                        'cat'
-                        TOK_SERDE
-                        TOK_RECORDREADER
-                        TOK_ALIASLIST
-                           ds
-                           tkey
-                           tvalue
-               TOK_CLUSTERBY
-                  TOK_TABLE_OR_COL
-                     tkey
-         tmap
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  tmap
-               tkey
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  tmap
-               tvalue
-      TOK_WHERE
-         AND
-            <
-               .
-                  TOK_TABLE_OR_COL
-                     tmap
-                  tkey
-               100
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     tmap
-                  ds
-               '2008-04-08'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/spark/transform_ppr2.q.out b/ql/src/test/results/clientpositive/spark/transform_ppr2.q.out
index 33f0d3ec41..2dfbd1c815 100644
--- a/ql/src/test/results/clientpositive/spark/transform_ppr2.q.out
+++ b/ql/src/test/results/clientpositive/spark/transform_ppr2.q.out
@@ -22,81 +22,6 @@ FROM (
 ) tmap
 SELECT tmap.tkey, tmap.tvalue WHERE tmap.tkey < 100
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_QUERY
-            TOK_FROM
-               TOK_TABREF
-                  TOK_TABNAME
-                     srcpart
-                  src
-            TOK_INSERT
-               TOK_DESTINATION
-                  TOK_DIR
-                     TOK_TMP_FILE
-               TOK_SELECT
-                  TOK_SELEXPR
-                     TOK_TRANSFORM
-                        TOK_EXPLIST
-                           .
-                              TOK_TABLE_OR_COL
-                                 src
-                              ds
-                           .
-                              TOK_TABLE_OR_COL
-                                 src
-                              key
-                           .
-                              TOK_TABLE_OR_COL
-                                 src
-                              value
-                        TOK_SERDE
-                        TOK_RECORDWRITER
-                        'cat'
-                        TOK_SERDE
-                        TOK_RECORDREADER
-                        TOK_ALIASLIST
-                           ds
-                           tkey
-                           tvalue
-               TOK_WHERE
-                  =
-                     .
-                        TOK_TABLE_OR_COL
-                           src
-                        ds
-                     '2008-04-08'
-               TOK_CLUSTERBY
-                  TOK_TABLE_OR_COL
-                     tkey
-         tmap
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  tmap
-               tkey
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  tmap
-               tvalue
-      TOK_WHERE
-         <
-            .
-               TOK_TABLE_OR_COL
-                  tmap
-               tkey
-            100
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/spark/union22.q.out b/ql/src/test/results/clientpositive/spark/union22.q.out
index cc3c557803..e76d51e5c6 100644
--- a/ql/src/test/results/clientpositive/spark/union22.q.out
+++ b/ql/src/test/results/clientpositive/spark/union22.q.out
@@ -78,146 +78,6 @@ where a.k1 > 20
 )
 subq
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_UNIONALL
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        dst_union22_delta
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           k1
-                        k1
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           k2
-                        k2
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           k3
-                        k3
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           k4
-                        k4
-                  TOK_WHERE
-                     and
-                        =
-                           TOK_TABLE_OR_COL
-                              ds
-                           '1'
-                        <=
-                           TOK_TABLE_OR_COL
-                              k0
-                           50
-            TOK_QUERY
-               TOK_FROM
-                  TOK_LEFTOUTERJOIN
-                     TOK_TABREF
-                        TOK_TABNAME
-                           dst_union22
-                        a
-                     TOK_SUBQUERY
-                        TOK_QUERY
-                           TOK_FROM
-                              TOK_TABREF
-                                 TOK_TABNAME
-                                    dst_union22_delta
-                           TOK_INSERT
-                              TOK_DESTINATION
-                                 TOK_DIR
-                                    TOK_TMP_FILE
-                              TOK_SELECT
-                                 TOK_SELEXPR
-                                    TOK_ALLCOLREF
-                              TOK_WHERE
-                                 and
-                                    =
-                                       TOK_TABLE_OR_COL
-                                          ds
-                                       '1'
-                                    >
-                                       TOK_TABLE_OR_COL
-                                          k0
-                                       50
-                        b
-                     and
-                        =
-                           .
-                              TOK_TABLE_OR_COL
-                                 a
-                              k1
-                           .
-                              TOK_TABLE_OR_COL
-                                 b
-                              k1
-                        =
-                           .
-                              TOK_TABLE_OR_COL
-                                 a
-                              ds
-                           '1'
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        .
-                           TOK_TABLE_OR_COL
-                              a
-                           k1
-                        k1
-                     TOK_SELEXPR
-                        .
-                           TOK_TABLE_OR_COL
-                              a
-                           k2
-                        k2
-                     TOK_SELEXPR
-                        .
-                           TOK_TABLE_OR_COL
-                              b
-                           k3
-                        k3
-                     TOK_SELEXPR
-                        .
-                           TOK_TABLE_OR_COL
-                              b
-                           k4
-                        k4
-                  TOK_WHERE
-                     >
-                        .
-                           TOK_TABLE_OR_COL
-                              a
-                           k1
-                        20
-         subq
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dst_union22
-            TOK_PARTSPEC
-               TOK_PARTVAL
-                  ds
-                  '2'
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
   Stage-1 depends on stages: Stage-3
diff --git a/ql/src/test/results/clientpositive/spark/union24.q.out b/ql/src/test/results/clientpositive/spark/union24.q.out
index 3bdc50306d..503263081d 100644
--- a/ql/src/test/results/clientpositive/spark/union24.q.out
+++ b/ql/src/test/results/clientpositive/spark/union24.q.out
@@ -72,121 +72,6 @@ select s.key, s.count from (
   select key, count(1) as count from src5 where key < 10 group by key
 )s
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_UNIONALL
-            TOK_UNIONALL
-               TOK_UNIONALL
-                  TOK_QUERY
-                     TOK_FROM
-                        TOK_TABREF
-                           TOK_TABNAME
-                              src2
-                     TOK_INSERT
-                        TOK_DESTINATION
-                           TOK_DIR
-                              TOK_TMP_FILE
-                        TOK_SELECT
-                           TOK_SELEXPR
-                              TOK_TABLE_OR_COL
-                                 key
-                           TOK_SELEXPR
-                              TOK_TABLE_OR_COL
-                                 count
-                        TOK_WHERE
-                           <
-                              TOK_TABLE_OR_COL
-                                 key
-                              10
-                  TOK_QUERY
-                     TOK_FROM
-                        TOK_TABREF
-                           TOK_TABNAME
-                              src3
-                     TOK_INSERT
-                        TOK_DESTINATION
-                           TOK_DIR
-                              TOK_TMP_FILE
-                        TOK_SELECT
-                           TOK_SELEXPR
-                              TOK_TABLE_OR_COL
-                                 key
-                           TOK_SELEXPR
-                              TOK_TABLE_OR_COL
-                                 count
-                        TOK_WHERE
-                           <
-                              TOK_TABLE_OR_COL
-                                 key
-                              10
-               TOK_QUERY
-                  TOK_FROM
-                     TOK_TABREF
-                        TOK_TABNAME
-                           src4
-                  TOK_INSERT
-                     TOK_DESTINATION
-                        TOK_DIR
-                           TOK_TMP_FILE
-                     TOK_SELECT
-                        TOK_SELEXPR
-                           TOK_TABLE_OR_COL
-                              key
-                        TOK_SELEXPR
-                           TOK_TABLE_OR_COL
-                              count
-                     TOK_WHERE
-                        <
-                           TOK_TABLE_OR_COL
-                              key
-                           10
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        src5
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           key
-                     TOK_SELEXPR
-                        TOK_FUNCTION
-                           count
-                           1
-                        count
-                  TOK_WHERE
-                     <
-                        TOK_TABLE_OR_COL
-                           key
-                        10
-                  TOK_GROUPBY
-                     TOK_TABLE_OR_COL
-                        key
-         s
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  s
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  s
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -641,117 +526,6 @@ select s.key, s.count from (
   select a.key as key, b.count as count from src4 a join src5 b on a.key=b.key where a.key < 10
 )s
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_UNIONALL
-            TOK_UNIONALL
-               TOK_QUERY
-                  TOK_FROM
-                     TOK_TABREF
-                        TOK_TABNAME
-                           src2
-                  TOK_INSERT
-                     TOK_DESTINATION
-                        TOK_DIR
-                           TOK_TMP_FILE
-                     TOK_SELECT
-                        TOK_SELEXPR
-                           TOK_TABLE_OR_COL
-                              key
-                        TOK_SELEXPR
-                           TOK_TABLE_OR_COL
-                              count
-                     TOK_WHERE
-                        <
-                           TOK_TABLE_OR_COL
-                              key
-                           10
-               TOK_QUERY
-                  TOK_FROM
-                     TOK_TABREF
-                        TOK_TABNAME
-                           src3
-                  TOK_INSERT
-                     TOK_DESTINATION
-                        TOK_DIR
-                           TOK_TMP_FILE
-                     TOK_SELECT
-                        TOK_SELEXPR
-                           TOK_TABLE_OR_COL
-                              key
-                        TOK_SELEXPR
-                           TOK_TABLE_OR_COL
-                              count
-                     TOK_WHERE
-                        <
-                           TOK_TABLE_OR_COL
-                              key
-                           10
-            TOK_QUERY
-               TOK_FROM
-                  TOK_JOIN
-                     TOK_TABREF
-                        TOK_TABNAME
-                           src4
-                        a
-                     TOK_TABREF
-                        TOK_TABNAME
-                           src5
-                        b
-                     =
-                        .
-                           TOK_TABLE_OR_COL
-                              a
-                           key
-                        .
-                           TOK_TABLE_OR_COL
-                              b
-                           key
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        .
-                           TOK_TABLE_OR_COL
-                              a
-                           key
-                        key
-                     TOK_SELEXPR
-                        .
-                           TOK_TABLE_OR_COL
-                              b
-                           count
-                        count
-                  TOK_WHERE
-                     <
-                        .
-                           TOK_TABLE_OR_COL
-                              a
-                           key
-                        10
-         s
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  s
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  s
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1179,121 +953,6 @@ select s.key, s.count from (
   select a.key as key, count(1) as count from src4 a join src5 b on a.key=b.key where a.key < 10 group by a.key
 )s
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_UNIONALL
-            TOK_UNIONALL
-               TOK_QUERY
-                  TOK_FROM
-                     TOK_TABREF
-                        TOK_TABNAME
-                           src2
-                  TOK_INSERT
-                     TOK_DESTINATION
-                        TOK_DIR
-                           TOK_TMP_FILE
-                     TOK_SELECT
-                        TOK_SELEXPR
-                           TOK_TABLE_OR_COL
-                              key
-                        TOK_SELEXPR
-                           TOK_TABLE_OR_COL
-                              count
-                     TOK_WHERE
-                        <
-                           TOK_TABLE_OR_COL
-                              key
-                           10
-               TOK_QUERY
-                  TOK_FROM
-                     TOK_TABREF
-                        TOK_TABNAME
-                           src3
-                  TOK_INSERT
-                     TOK_DESTINATION
-                        TOK_DIR
-                           TOK_TMP_FILE
-                     TOK_SELECT
-                        TOK_SELEXPR
-                           TOK_TABLE_OR_COL
-                              key
-                        TOK_SELEXPR
-                           TOK_TABLE_OR_COL
-                              count
-                     TOK_WHERE
-                        <
-                           TOK_TABLE_OR_COL
-                              key
-                           10
-            TOK_QUERY
-               TOK_FROM
-                  TOK_JOIN
-                     TOK_TABREF
-                        TOK_TABNAME
-                           src4
-                        a
-                     TOK_TABREF
-                        TOK_TABNAME
-                           src5
-                        b
-                     =
-                        .
-                           TOK_TABLE_OR_COL
-                              a
-                           key
-                        .
-                           TOK_TABLE_OR_COL
-                              b
-                           key
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        .
-                           TOK_TABLE_OR_COL
-                              a
-                           key
-                        key
-                     TOK_SELEXPR
-                        TOK_FUNCTION
-                           count
-                           1
-                        count
-                  TOK_WHERE
-                     <
-                        .
-                           TOK_TABLE_OR_COL
-                              a
-                           key
-                        10
-                  TOK_GROUPBY
-                     .
-                        TOK_TABLE_OR_COL
-                           a
-                        key
-         s
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  s
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  s
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/spark/union_ppr.q.out b/ql/src/test/results/clientpositive/spark/union_ppr.q.out
index 1d2120a14b..8f7b1f2fb6 100644
--- a/ql/src/test/results/clientpositive/spark/union_ppr.q.out
+++ b/ql/src/test/results/clientpositive/spark/union_ppr.q.out
@@ -20,98 +20,6 @@ SELECT * FROM (
 WHERE A.ds = '2008-04-08'
 SORT BY A.key, A.value, A.ds, A.hr
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_UNIONALL
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        SRCPART
-                     X
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_ALLCOLREF
-                           TOK_TABNAME
-                              X
-                  TOK_WHERE
-                     <
-                        .
-                           TOK_TABLE_OR_COL
-                              X
-                           key
-                        100
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        SRCPART
-                     Y
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_ALLCOLREF
-                           TOK_TABNAME
-                              Y
-                  TOK_WHERE
-                     <
-                        .
-                           TOK_TABLE_OR_COL
-                              Y
-                           key
-                        100
-         A
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         =
-            .
-               TOK_TABLE_OR_COL
-                  A
-               ds
-            '2008-04-08'
-      TOK_SORTBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               .
-                  TOK_TABLE_OR_COL
-                     A
-                  key
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               .
-                  TOK_TABLE_OR_COL
-                     A
-                  value
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               .
-                  TOK_TABLE_OR_COL
-                     A
-                  ds
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               .
-                  TOK_TABLE_OR_COL
-                     A
-                  hr
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/spark/vectorized_ptf.q.out b/ql/src/test/results/clientpositive/spark/vectorized_ptf.q.out
index f0a44448b5..7b56585fc8 100644
--- a/ql/src/test/results/clientpositive/spark/vectorized_ptf.q.out
+++ b/ql/src/test/results/clientpositive/spark/vectorized_ptf.q.out
@@ -142,88 +142,6 @@ from noop(on part_orc
   order by p_name
   )
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noop
-         TOK_TABREF
-            TOK_TABNAME
-               part_orc
-         TOK_PARTITIONINGSPEC
-            TOK_DISTRIBUTEBY
-               TOK_TABLE_OR_COL
-                  p_mfgr
-            TOK_ORDERBY
-               TOK_TABSORTCOLNAMEASC
-                  TOK_NULLS_FIRST
-                     TOK_TABLE_OR_COL
-                        p_name
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            TOK_FUNCTION
-               rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            r
-         TOK_SELEXPR
-            TOK_FUNCTION
-               dense_rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            dr
-         TOK_SELEXPR
-            TOK_FUNCTION
-               sum
-               TOK_TABLE_OR_COL
-                  p_retailprice
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-                  TOK_WINDOWRANGE
-                     preceding
-                        unbounded
-                     current
-            s1
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -471,94 +389,6 @@ from noop (on (select p1.* from part_orc p1 join part_orc p2 on p1.p_partkey = p
 distribute by j.p_mfgr
 sort by j.p_name)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noop
-         TOK_SUBQUERY
-            TOK_QUERY
-               TOK_FROM
-                  TOK_JOIN
-                     TOK_TABREF
-                        TOK_TABNAME
-                           part_orc
-                        p1
-                     TOK_TABREF
-                        TOK_TABNAME
-                           part_orc
-                        p2
-                     =
-                        .
-                           TOK_TABLE_OR_COL
-                              p1
-                           p_partkey
-                        .
-                           TOK_TABLE_OR_COL
-                              p2
-                           p_partkey
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_ALLCOLREF
-                           TOK_TABNAME
-                              p1
-            j
-         TOK_PARTITIONINGSPEC
-            TOK_DISTRIBUTEBY
-               .
-                  TOK_TABLE_OR_COL
-                     j
-                  p_mfgr
-            TOK_SORTBY
-               TOK_TABSORTCOLNAMEASC
-                  TOK_NULLS_FIRST
-                     .
-                        TOK_TABLE_OR_COL
-                           j
-                        p_name
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            -
-               TOK_TABLE_OR_COL
-                  p_size
-               TOK_FUNCTION
-                  lag
-                  TOK_TABLE_OR_COL
-                     p_size
-                  1
-                  TOK_TABLE_OR_COL
-                     p_size
-                  TOK_WINDOWSPEC
-                     TOK_PARTITIONINGSPEC
-                        TOK_DISTRIBUTEBY
-                           TOK_TABLE_OR_COL
-                              p_mfgr
-                        TOK_ORDERBY
-                           TOK_TABSORTCOLNAMEASC
-                              TOK_NULLS_FIRST
-                                 TOK_TABLE_OR_COL
-                                    p_name
-            deltaSz
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -880,40 +710,6 @@ from noop(on part_orc
 partition by p_mfgr
 order by p_name)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noop
-         TOK_TABREF
-            TOK_TABNAME
-               part_orc
-         TOK_PARTITIONINGSPEC
-            TOK_DISTRIBUTEBY
-               TOK_TABLE_OR_COL
-                  p_mfgr
-            TOK_ORDERBY
-               TOK_TABSORTCOLNAMEASC
-                  TOK_NULLS_FIRST
-                     TOK_TABLE_OR_COL
-                        p_name
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1108,89 +904,6 @@ from noop(on part_orc
   order by p_name
   ) abc
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noop
-         abc
-         TOK_TABREF
-            TOK_TABNAME
-               part_orc
-         TOK_PARTITIONINGSPEC
-            TOK_DISTRIBUTEBY
-               TOK_TABLE_OR_COL
-                  p_mfgr
-            TOK_ORDERBY
-               TOK_TABSORTCOLNAMEASC
-                  TOK_NULLS_FIRST
-                     TOK_TABLE_OR_COL
-                        p_name
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            TOK_FUNCTION
-               rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            r
-         TOK_SELEXPR
-            TOK_FUNCTION
-               dense_rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            dr
-         TOK_SELEXPR
-            TOK_FUNCTION
-               sum
-               TOK_TABLE_OR_COL
-                  p_retailprice
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-                  TOK_WINDOWRANGE
-                     preceding
-                        unbounded
-                     current
-            s1
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1444,93 +1157,6 @@ from noop(on part_orc
           order by p_name 
           )
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noop
-         TOK_TABREF
-            TOK_TABNAME
-               part_orc
-         TOK_PARTITIONINGSPEC
-            TOK_DISTRIBUTEBY
-               TOK_TABLE_OR_COL
-                  p_mfgr
-            TOK_ORDERBY
-               TOK_TABSORTCOLNAMEASC
-                  TOK_NULLS_FIRST
-                     TOK_TABLE_OR_COL
-                        p_name
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            TOK_FUNCTION
-               rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            r
-         TOK_SELEXPR
-            TOK_FUNCTION
-               dense_rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            dr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            -
-               TOK_TABLE_OR_COL
-                  p_size
-               TOK_FUNCTION
-                  lag
-                  TOK_TABLE_OR_COL
-                     p_size
-                  1
-                  TOK_TABLE_OR_COL
-                     p_size
-                  TOK_WINDOWSPEC
-                     TOK_PARTITIONINGSPEC
-                        TOK_DISTRIBUTEBY
-                           TOK_TABLE_OR_COL
-                              p_mfgr
-                        TOK_ORDERBY
-                           TOK_TABSORTCOLNAMEASC
-                              TOK_NULLS_FIRST
-                                 TOK_TABLE_OR_COL
-                                    p_name
-            deltaSz
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1787,100 +1413,6 @@ from noop(on part_orc
           ) 
 group by p_mfgr, p_name, p_size
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noop
-         TOK_TABREF
-            TOK_TABNAME
-               part_orc
-         TOK_PARTITIONINGSPEC
-            TOK_DISTRIBUTEBY
-               TOK_TABLE_OR_COL
-                  p_mfgr
-            TOK_ORDERBY
-               TOK_TABSORTCOLNAMEASC
-                  TOK_NULLS_FIRST
-                     TOK_TABLE_OR_COL
-                        p_name
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            TOK_FUNCTION
-               rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            r
-         TOK_SELEXPR
-            TOK_FUNCTION
-               dense_rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            dr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            -
-               TOK_TABLE_OR_COL
-                  p_size
-               TOK_FUNCTION
-                  lag
-                  TOK_TABLE_OR_COL
-                     p_size
-                  1
-                  TOK_TABLE_OR_COL
-                     p_size
-                  TOK_WINDOWSPEC
-                     TOK_PARTITIONINGSPEC
-                        TOK_DISTRIBUTEBY
-                           TOK_TABLE_OR_COL
-                              p_mfgr
-                        TOK_ORDERBY
-                           TOK_TABSORTCOLNAMEASC
-                              TOK_NULLS_FIRST
-                                 TOK_TABLE_OR_COL
-                                    p_name
-            deltaSz
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            p_mfgr
-         TOK_TABLE_OR_COL
-            p_name
-         TOK_TABLE_OR_COL
-            p_size
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -2139,50 +1671,6 @@ partition by p_mfgr
 order by p_name 
 ) abc join part_orc p1 on abc.p_partkey = p1.p_partkey
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_PTBLFUNCTION
-            noop
-            abc
-            TOK_TABREF
-               TOK_TABNAME
-                  part_orc
-            TOK_PARTITIONINGSPEC
-               TOK_DISTRIBUTEBY
-                  TOK_TABLE_OR_COL
-                     p_mfgr
-               TOK_ORDERBY
-                  TOK_TABSORTCOLNAMEASC
-                     TOK_NULLS_FIRST
-                        TOK_TABLE_OR_COL
-                           p_name
-         TOK_TABREF
-            TOK_TABNAME
-               part_orc
-            p1
-         =
-            .
-               TOK_TABLE_OR_COL
-                  abc
-               p_partkey
-            .
-               TOK_TABLE_OR_COL
-                  p1
-               p_partkey
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-               TOK_TABNAME
-                  abc
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -2464,50 +1952,6 @@ partition by p_mfgr
 order by p_name 
 ) abc on abc.p_partkey = p1.p_partkey
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               part_orc
-            p1
-         TOK_PTBLFUNCTION
-            noop
-            abc
-            TOK_TABREF
-               TOK_TABNAME
-                  part_orc
-            TOK_PARTITIONINGSPEC
-               TOK_DISTRIBUTEBY
-                  TOK_TABLE_OR_COL
-                     p_mfgr
-               TOK_ORDERBY
-                  TOK_TABSORTCOLNAMEASC
-                     TOK_NULLS_FIRST
-                        TOK_TABLE_OR_COL
-                           p_name
-         =
-            .
-               TOK_TABLE_OR_COL
-                  abc
-               p_partkey
-            .
-               TOK_TABLE_OR_COL
-                  p1
-               p_partkey
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-               TOK_TABNAME
-                  abc
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -2793,62 +2237,6 @@ from noopwithmap(on part_orc
 partition by p_mfgr
 order by p_name, p_size desc)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noopwithmap
-         TOK_TABREF
-            TOK_TABNAME
-               part_orc
-         TOK_PARTITIONINGSPEC
-            TOK_DISTRIBUTEBY
-               TOK_TABLE_OR_COL
-                  p_mfgr
-            TOK_ORDERBY
-               TOK_TABSORTCOLNAMEASC
-                  TOK_NULLS_FIRST
-                     TOK_TABLE_OR_COL
-                        p_name
-               TOK_TABSORTCOLNAMEDESC
-                  TOK_NULLS_LAST
-                     TOK_TABLE_OR_COL
-                        p_size
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            TOK_FUNCTION
-               rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-                        TOK_TABSORTCOLNAMEDESC
-                           TOK_NULLS_LAST
-                              TOK_TABLE_OR_COL
-                                 p_size
-            r
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -3095,88 +2483,6 @@ from noopwithmap(on part_orc
   partition by p_mfgr
   order by p_name)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noopwithmap
-         TOK_TABREF
-            TOK_TABNAME
-               part_orc
-         TOK_PARTITIONINGSPEC
-            TOK_DISTRIBUTEBY
-               TOK_TABLE_OR_COL
-                  p_mfgr
-            TOK_ORDERBY
-               TOK_TABSORTCOLNAMEASC
-                  TOK_NULLS_FIRST
-                     TOK_TABLE_OR_COL
-                        p_name
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            TOK_FUNCTION
-               rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            r
-         TOK_SELEXPR
-            TOK_FUNCTION
-               dense_rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            dr
-         TOK_SELEXPR
-            TOK_FUNCTION
-               sum
-               TOK_TABLE_OR_COL
-                  p_retailprice
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-                  TOK_WINDOWRANGE
-                     preceding
-                        unbounded
-                     current
-            s1
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -3442,88 +2748,6 @@ from noop(on part_orc
 partition by p_mfgr
 order by p_name)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noop
-         TOK_TABREF
-            TOK_TABNAME
-               part_orc
-         TOK_PARTITIONINGSPEC
-            TOK_DISTRIBUTEBY
-               TOK_TABLE_OR_COL
-                  p_mfgr
-            TOK_ORDERBY
-               TOK_TABSORTCOLNAMEASC
-                  TOK_NULLS_FIRST
-                     TOK_TABLE_OR_COL
-                        p_name
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            TOK_FUNCTION
-               rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            r
-         TOK_SELEXPR
-            TOK_FUNCTION
-               dense_rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            dr
-         TOK_SELEXPR
-            TOK_FUNCTION
-               sum
-               TOK_TABLE_OR_COL
-                  p_retailprice
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-                  TOK_WINDOWRANGE
-                     preceding
-                        unbounded
-                     current
-            s1
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -3775,96 +2999,6 @@ partition by p_mfgr
 order by p_mfgr, p_name
 )))
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noop
-         TOK_PTBLFUNCTION
-            noopwithmap
-            TOK_PTBLFUNCTION
-               noop
-               TOK_TABREF
-                  TOK_TABNAME
-                     part_orc
-               TOK_PARTITIONINGSPEC
-                  TOK_DISTRIBUTEBY
-                     TOK_TABLE_OR_COL
-                        p_mfgr
-                  TOK_ORDERBY
-                     TOK_TABSORTCOLNAMEASC
-                        TOK_NULLS_FIRST
-                           TOK_TABLE_OR_COL
-                              p_mfgr
-                     TOK_TABSORTCOLNAMEASC
-                        TOK_NULLS_FIRST
-                           TOK_TABLE_OR_COL
-                              p_name
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            TOK_FUNCTION
-               rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            r
-         TOK_SELEXPR
-            TOK_FUNCTION
-               dense_rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            dr
-         TOK_SELEXPR
-            TOK_FUNCTION
-               sum
-               TOK_TABLE_OR_COL
-                  p_retailprice
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-                  TOK_WINDOWRANGE
-                     preceding
-                        unbounded
-                     current
-            s1
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -4186,107 +3320,6 @@ order by p_name)
 window w1 as (partition by p_mfgr order by p_name rows between 2 preceding and 2 following) 
 ) sub1
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_QUERY
-            TOK_FROM
-               TOK_PTBLFUNCTION
-                  noop
-                  TOK_TABREF
-                     TOK_TABNAME
-                        part_orc
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            TOK_INSERT
-               TOK_DESTINATION
-                  TOK_DIR
-                     TOK_TMP_FILE
-               TOK_SELECT
-                  TOK_SELEXPR
-                     TOK_TABLE_OR_COL
-                        p_mfgr
-                  TOK_SELEXPR
-                     TOK_TABLE_OR_COL
-                        p_name
-                  TOK_SELEXPR
-                     TOK_FUNCTION
-                        count
-                        TOK_TABLE_OR_COL
-                           p_size
-                        TOK_WINDOWSPEC
-                           TOK_PARTITIONINGSPEC
-                              TOK_DISTRIBUTEBY
-                                 TOK_TABLE_OR_COL
-                                    p_mfgr
-                              TOK_ORDERBY
-                                 TOK_TABSORTCOLNAMEASC
-                                    TOK_NULLS_FIRST
-                                       TOK_TABLE_OR_COL
-                                          p_name
-                     cd
-                  TOK_SELEXPR
-                     TOK_TABLE_OR_COL
-                        p_retailprice
-                  TOK_SELEXPR
-                     TOK_FUNCTION
-                        sum
-                        TOK_TABLE_OR_COL
-                           p_retailprice
-                        TOK_WINDOWSPEC
-                           w1
-                     s1
-               window
-                  TOK_WINDOWDEF
-                     w1
-                     TOK_WINDOWSPEC
-                        TOK_PARTITIONINGSPEC
-                           TOK_DISTRIBUTEBY
-                              TOK_TABLE_OR_COL
-                                 p_mfgr
-                           TOK_ORDERBY
-                              TOK_TABSORTCOLNAMEASC
-                                 TOK_NULLS_FIRST
-                                    TOK_TABLE_OR_COL
-                                       p_name
-                        TOK_WINDOWRANGE
-                           preceding
-                              2
-                           following
-                              2
-         sub1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  sub1
-               cd
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  sub1
-               s1
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -4542,182 +3575,6 @@ partition by p_mfgr
 order by p_name 
 ) abc join part_orc p1 on abc.p_partkey = p1.p_partkey
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_PTBLFUNCTION
-            noop
-            abc
-            TOK_TABREF
-               TOK_TABNAME
-                  part_orc
-            TOK_PARTITIONINGSPEC
-               TOK_DISTRIBUTEBY
-                  TOK_TABLE_OR_COL
-                     p_mfgr
-               TOK_ORDERBY
-                  TOK_TABSORTCOLNAMEASC
-                     TOK_NULLS_FIRST
-                        TOK_TABLE_OR_COL
-                           p_name
-         TOK_TABREF
-            TOK_TABNAME
-               part_orc
-            p1
-         =
-            .
-               TOK_TABLE_OR_COL
-                  abc
-               p_partkey
-            .
-               TOK_TABLE_OR_COL
-                  p1
-               p_partkey
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  abc
-               p_mfgr
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  abc
-               p_name
-         TOK_SELEXPR
-            TOK_FUNCTION
-               rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        .
-                           TOK_TABLE_OR_COL
-                              abc
-                           p_mfgr
-                     TOK_SORTBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              .
-                                 TOK_TABLE_OR_COL
-                                    abc
-                                 p_name
-            r
-         TOK_SELEXPR
-            TOK_FUNCTION
-               dense_rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        .
-                           TOK_TABLE_OR_COL
-                              abc
-                           p_mfgr
-                     TOK_SORTBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              .
-                                 TOK_TABLE_OR_COL
-                                    abc
-                                 p_name
-            dr
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               .
-                  TOK_TABLE_OR_COL
-                     abc
-                  p_name
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        .
-                           TOK_TABLE_OR_COL
-                              abc
-                           p_mfgr
-                     TOK_SORTBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              .
-                                 TOK_TABLE_OR_COL
-                                    abc
-                                 p_name
-            cd
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  abc
-               p_retailprice
-         TOK_SELEXPR
-            TOK_FUNCTION
-               sum
-               .
-                  TOK_TABLE_OR_COL
-                     abc
-                  p_retailprice
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        .
-                           TOK_TABLE_OR_COL
-                              abc
-                           p_mfgr
-                     TOK_SORTBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              .
-                                 TOK_TABLE_OR_COL
-                                    abc
-                                 p_name
-                  TOK_WINDOWRANGE
-                     preceding
-                        unbounded
-                     current
-            s1
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  abc
-               p_size
-         TOK_SELEXPR
-            -
-               .
-                  TOK_TABLE_OR_COL
-                     abc
-                  p_size
-               TOK_FUNCTION
-                  lag
-                  .
-                     TOK_TABLE_OR_COL
-                        abc
-                     p_size
-                  1
-                  .
-                     TOK_TABLE_OR_COL
-                        abc
-                     p_size
-                  TOK_WINDOWSPEC
-                     TOK_PARTITIONINGSPEC
-                        TOK_DISTRIBUTEBY
-                           .
-                              TOK_TABLE_OR_COL
-                                 abc
-                              p_mfgr
-                        TOK_SORTBY
-                           TOK_TABSORTCOLNAMEASC
-                              TOK_NULLS_FIRST
-                                 .
-                                    TOK_TABLE_OR_COL
-                                       abc
-                                    p_name
-            deltaSz
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -5075,40 +3932,6 @@ from noop(on part_orc
 partition by p_mfgr 
 order by p_name)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noop
-         TOK_TABREF
-            TOK_TABNAME
-               part_orc
-         TOK_PARTITIONINGSPEC
-            TOK_DISTRIBUTEBY
-               TOK_TABLE_OR_COL
-                  p_mfgr
-            TOK_ORDERBY
-               TOK_TABSORTCOLNAMEASC
-                  TOK_NULLS_FIRST
-                     TOK_TABLE_OR_COL
-                        p_name
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECTDI
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -5337,65 +4160,6 @@ partition by p_mfgr
 order by p_mfgr)  
 window w1 as ( partition by p_mfgr order by p_brand rows between 2 preceding and current row)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noop
-         TOK_TABREF
-            TOK_TABNAME
-               mfgr_price_view
-         TOK_PARTITIONINGSPEC
-            TOK_DISTRIBUTEBY
-               TOK_TABLE_OR_COL
-                  p_mfgr
-            TOK_ORDERBY
-               TOK_TABSORTCOLNAMEASC
-                  TOK_NULLS_FIRST
-                     TOK_TABLE_OR_COL
-                        p_mfgr
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_brand
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               s
-         TOK_SELEXPR
-            TOK_FUNCTION
-               sum
-               TOK_TABLE_OR_COL
-                  s
-               TOK_WINDOWSPEC
-                  w1
-            s1
-      window
-         TOK_WINDOWDEF
-            w1
-            TOK_WINDOWSPEC
-               TOK_PARTITIONINGSPEC
-                  TOK_DISTRIBUTEBY
-                     TOK_TABLE_OR_COL
-                        p_mfgr
-                  TOK_ORDERBY
-                     TOK_TABSORTCOLNAMEASC
-                        TOK_NULLS_FIRST
-                           TOK_TABLE_OR_COL
-                              p_brand
-               TOK_WINDOWRANGE
-                  preceding
-                     2
-                  current
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -5689,212 +4453,6 @@ cume_dist() over (distribute by p_mfgr sort by p_mfgr, p_name) as cud,
 first_value(p_size, true) over w1  as fv1
 window w1 as (distribute by p_mfgr sort by p_mfgr, p_name rows between 2 preceding and 2 following)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noop
-         TOK_TABREF
-            TOK_TABNAME
-               part_orc
-         TOK_PARTITIONINGSPEC
-            TOK_DISTRIBUTEBY
-               TOK_TABLE_OR_COL
-                  p_mfgr
-            TOK_ORDERBY
-               TOK_TABSORTCOLNAMEASC
-                  TOK_NULLS_FIRST
-                     TOK_TABLE_OR_COL
-                        p_name
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               part_4
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            TOK_FUNCTION
-               rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_SORTBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            r
-         TOK_SELEXPR
-            TOK_FUNCTION
-               dense_rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_SORTBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            dr
-         TOK_SELEXPR
-            TOK_FUNCTION
-               sum
-               TOK_TABLE_OR_COL
-                  p_retailprice
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_SORTBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-                  TOK_WINDOWRANGE
-                     preceding
-                        unbounded
-                     current
-            s
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               part_5
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            TOK_FUNCTION
-               round
-               TOK_FUNCTION
-                  sum
-                  TOK_TABLE_OR_COL
-                     p_size
-                  TOK_WINDOWSPEC
-                     TOK_PARTITIONINGSPEC
-                        TOK_DISTRIBUTEBY
-                           TOK_TABLE_OR_COL
-                              p_mfgr
-                        TOK_SORTBY
-                           TOK_TABSORTCOLNAMEASC
-                              TOK_NULLS_FIRST
-                                 TOK_TABLE_OR_COL
-                                    p_size
-                     TOK_WINDOWVALUES
-                        preceding
-                           5
-                        current
-               1
-            s2
-         TOK_SELEXPR
-            TOK_FUNCTION
-               rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_SORTBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_mfgr
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            r
-         TOK_SELEXPR
-            TOK_FUNCTION
-               dense_rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_SORTBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_mfgr
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            dr
-         TOK_SELEXPR
-            TOK_FUNCTION
-               cume_dist
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_SORTBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_mfgr
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            cud
-         TOK_SELEXPR
-            TOK_FUNCTION
-               first_value
-               TOK_TABLE_OR_COL
-                  p_size
-               true
-               TOK_WINDOWSPEC
-                  w1
-            fv1
-      window
-         TOK_WINDOWDEF
-            w1
-            TOK_WINDOWSPEC
-               TOK_PARTITIONINGSPEC
-                  TOK_DISTRIBUTEBY
-                     TOK_TABLE_OR_COL
-                        p_mfgr
-                  TOK_SORTBY
-                     TOK_TABSORTCOLNAMEASC
-                        TOK_NULLS_FIRST
-                           TOK_TABLE_OR_COL
-                              p_mfgr
-                     TOK_TABSORTCOLNAMEASC
-                        TOK_NULLS_FIRST
-                           TOK_TABLE_OR_COL
-                              p_name
-               TOK_WINDOWRANGE
-                  preceding
-                     2
-                  following
-                     2
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-0 depends on stages: Stage-2
@@ -6432,115 +4990,6 @@ from noop(on
         partition by p_mfgr,p_name  
         order by p_mfgr,p_name)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noop
-         TOK_PTBLFUNCTION
-            noopwithmap
-            TOK_PTBLFUNCTION
-               noop
-               TOK_PTBLFUNCTION
-                  noop
-                  TOK_TABREF
-                     TOK_TABNAME
-                        part_orc
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_mfgr
-            TOK_PARTITIONINGSPEC
-               TOK_DISTRIBUTEBY
-                  TOK_TABLE_OR_COL
-                     p_mfgr
-                  TOK_TABLE_OR_COL
-                     p_name
-               TOK_ORDERBY
-                  TOK_TABSORTCOLNAMEASC
-                     TOK_NULLS_FIRST
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                  TOK_TABSORTCOLNAMEASC
-                     TOK_NULLS_FIRST
-                        TOK_TABLE_OR_COL
-                           p_name
-         TOK_PARTITIONINGSPEC
-            TOK_DISTRIBUTEBY
-               TOK_TABLE_OR_COL
-                  p_mfgr
-               TOK_TABLE_OR_COL
-                  p_name
-            TOK_ORDERBY
-               TOK_TABSORTCOLNAMEASC
-                  TOK_NULLS_FIRST
-                     TOK_TABLE_OR_COL
-                        p_mfgr
-               TOK_TABSORTCOLNAMEASC
-                  TOK_NULLS_FIRST
-                     TOK_TABLE_OR_COL
-                        p_name
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_FUNCTION
-               rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                        TOK_TABLE_OR_COL
-                           p_name
-            r
-         TOK_SELEXPR
-            TOK_FUNCTION
-               dense_rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                        TOK_TABLE_OR_COL
-                           p_name
-            dr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            TOK_FUNCTION
-               sum
-               TOK_TABLE_OR_COL
-                  p_size
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                        TOK_TABLE_OR_COL
-                           p_name
-                  TOK_WINDOWRANGE
-                     preceding
-                        unbounded
-                     current
-            s1
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -6891,118 +5340,6 @@ from noop(on
         partition by p_mfgr  
         order by p_mfgr )
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noop
-         TOK_PTBLFUNCTION
-            noop
-            TOK_PTBLFUNCTION
-               noop
-               TOK_PTBLFUNCTION
-                  noop
-                  TOK_TABREF
-                     TOK_TABNAME
-                        part_orc
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_mfgr
-            TOK_PARTITIONINGSPEC
-               TOK_DISTRIBUTEBY
-                  TOK_TABLE_OR_COL
-                     p_mfgr
-                  TOK_TABLE_OR_COL
-                     p_name
-               TOK_ORDERBY
-                  TOK_TABSORTCOLNAMEASC
-                     TOK_NULLS_FIRST
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                  TOK_TABSORTCOLNAMEASC
-                     TOK_NULLS_FIRST
-                        TOK_TABLE_OR_COL
-                           p_name
-         TOK_PARTITIONINGSPEC
-            TOK_DISTRIBUTEBY
-               TOK_TABLE_OR_COL
-                  p_mfgr
-            TOK_ORDERBY
-               TOK_TABSORTCOLNAMEASC
-                  TOK_NULLS_FIRST
-                     TOK_TABLE_OR_COL
-                        p_mfgr
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_FUNCTION
-               rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            r
-         TOK_SELEXPR
-            TOK_FUNCTION
-               dense_rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            dr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            TOK_FUNCTION
-               sum
-               TOK_TABLE_OR_COL
-                  p_size
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-                  TOK_WINDOWRANGE
-                     preceding
-                        unbounded
-                     current
-            s1
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -7349,105 +5686,6 @@ from noop(on
           partition by p_mfgr 
           order by p_mfgr))
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noop
-         TOK_PTBLFUNCTION
-            noop
-            TOK_PTBLFUNCTION
-               noop
-               TOK_PTBLFUNCTION
-                  noop
-                  TOK_TABREF
-                     TOK_TABNAME
-                        part_orc
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                        TOK_TABLE_OR_COL
-                           p_name
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_mfgr
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            TOK_PARTITIONINGSPEC
-               TOK_DISTRIBUTEBY
-                  TOK_TABLE_OR_COL
-                     p_mfgr
-               TOK_ORDERBY
-                  TOK_TABSORTCOLNAMEASC
-                     TOK_NULLS_FIRST
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_FUNCTION
-               rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            r
-         TOK_SELEXPR
-            TOK_FUNCTION
-               dense_rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            dr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            TOK_FUNCTION
-               sum
-               TOK_TABLE_OR_COL
-                  p_size
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            s1
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -7770,115 +6008,6 @@ from noopwithmap(on
           partition by p_mfgr,p_name 
           order by p_mfgr,p_name)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noopwithmap
-         TOK_PTBLFUNCTION
-            noop
-            TOK_PTBLFUNCTION
-               noop
-               TOK_PTBLFUNCTION
-                  noop
-                  TOK_TABREF
-                     TOK_TABNAME
-                        part_orc
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                        TOK_TABLE_OR_COL
-                           p_name
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_mfgr
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            TOK_PARTITIONINGSPEC
-               TOK_DISTRIBUTEBY
-                  TOK_TABLE_OR_COL
-                     p_mfgr
-               TOK_ORDERBY
-                  TOK_TABSORTCOLNAMEASC
-                     TOK_NULLS_FIRST
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-         TOK_PARTITIONINGSPEC
-            TOK_DISTRIBUTEBY
-               TOK_TABLE_OR_COL
-                  p_mfgr
-               TOK_TABLE_OR_COL
-                  p_name
-            TOK_ORDERBY
-               TOK_TABSORTCOLNAMEASC
-                  TOK_NULLS_FIRST
-                     TOK_TABLE_OR_COL
-                        p_mfgr
-               TOK_TABSORTCOLNAMEASC
-                  TOK_NULLS_FIRST
-                     TOK_TABLE_OR_COL
-                        p_name
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_FUNCTION
-               rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                        TOK_TABLE_OR_COL
-                           p_name
-            r
-         TOK_SELEXPR
-            TOK_FUNCTION
-               dense_rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                        TOK_TABLE_OR_COL
-                           p_name
-            dr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            TOK_FUNCTION
-               sum
-               TOK_TABLE_OR_COL
-                  p_size
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                        TOK_TABLE_OR_COL
-                           p_name
-                  TOK_WINDOWRANGE
-                     preceding
-                        unbounded
-                     current
-            s1
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -8244,151 +6373,6 @@ from noop(on
           order by p_mfgr
           ))
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noop
-         TOK_PTBLFUNCTION
-            noopwithmap
-            TOK_PTBLFUNCTION
-               noop
-               TOK_TABREF
-                  TOK_TABNAME
-                     part_orc
-               TOK_PARTITIONINGSPEC
-                  TOK_DISTRIBUTEBY
-                     TOK_TABLE_OR_COL
-                        p_mfgr
-                     TOK_TABLE_OR_COL
-                        p_name
-                  TOK_ORDERBY
-                     TOK_TABSORTCOLNAMEASC
-                        TOK_NULLS_FIRST
-                           TOK_TABLE_OR_COL
-                              p_mfgr
-                     TOK_TABSORTCOLNAMEASC
-                        TOK_NULLS_FIRST
-                           TOK_TABLE_OR_COL
-                              p_name
-            TOK_PARTITIONINGSPEC
-               TOK_DISTRIBUTEBY
-                  TOK_TABLE_OR_COL
-                     p_mfgr
-               TOK_ORDERBY
-                  TOK_TABSORTCOLNAMEASC
-                     TOK_NULLS_FIRST
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_FUNCTION
-               rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                        TOK_TABLE_OR_COL
-                           p_name
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_mfgr
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            r
-         TOK_SELEXPR
-            TOK_FUNCTION
-               dense_rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                        TOK_TABLE_OR_COL
-                           p_name
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_mfgr
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            dr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            TOK_FUNCTION
-               sum
-               TOK_TABLE_OR_COL
-                  p_size
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                        TOK_TABLE_OR_COL
-                           p_name
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_mfgr
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-                  TOK_WINDOWRANGE
-                     preceding
-                        unbounded
-                     current
-            s1
-         TOK_SELEXPR
-            TOK_FUNCTION
-               sum
-               TOK_TABLE_OR_COL
-                  p_size
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                        TOK_TABLE_OR_COL
-                           p_name
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_mfgr
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-                  TOK_WINDOWRANGE
-                     preceding
-                        unbounded
-                     current
-            s2
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -8724,118 +6708,6 @@ from noopwithmap(on
               order by p_mfgr, p_name) 
           ))
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noopwithmap
-         TOK_PTBLFUNCTION
-            noop
-            TOK_PTBLFUNCTION
-               noop
-               TOK_TABREF
-                  TOK_TABNAME
-                     part_orc
-               TOK_PARTITIONINGSPEC
-                  TOK_DISTRIBUTEBY
-                     TOK_TABLE_OR_COL
-                        p_mfgr
-                     TOK_TABLE_OR_COL
-                        p_name
-                  TOK_ORDERBY
-                     TOK_TABSORTCOLNAMEASC
-                        TOK_NULLS_FIRST
-                           TOK_TABLE_OR_COL
-                              p_mfgr
-                     TOK_TABSORTCOLNAMEASC
-                        TOK_NULLS_FIRST
-                           TOK_TABLE_OR_COL
-                              p_name
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_FUNCTION
-               rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            r
-         TOK_SELEXPR
-            TOK_FUNCTION
-               dense_rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            dr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            TOK_FUNCTION
-               sum
-               TOK_TABLE_OR_COL
-                  p_size
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-                  TOK_WINDOWVALUES
-                     preceding
-                        unbounded
-                     current
-            s1
-         TOK_SELEXPR
-            TOK_FUNCTION
-               sum
-               TOK_TABLE_OR_COL
-                  p_size
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-                  TOK_WINDOWVALUES
-                     preceding
-                        unbounded
-                     current
-            s2
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/stats0.q.out b/ql/src/test/results/clientpositive/stats0.q.out
index 99326fce5f..90a9a70c7b 100644
--- a/ql/src/test/results/clientpositive/stats0.q.out
+++ b/ql/src/test/results/clientpositive/stats0.q.out
@@ -14,23 +14,6 @@ POSTHOOK: query: explain extended
 insert overwrite table stats_non_partitioned
 select * from src
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            src
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               stats_non_partitioned
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1329,23 +1312,6 @@ POSTHOOK: query: explain extended
 insert overwrite table stats_non_partitioned
 select * from src
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            src
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               stats_non_partitioned
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-7 depends on stages: Stage-1 , consists of Stage-4, Stage-3, Stage-5
diff --git a/ql/src/test/results/clientpositive/stats11.q.out b/ql/src/test/results/clientpositive/stats11.q.out
index 7598dc0ae2..8ca5b27305 100644
--- a/ql/src/test/results/clientpositive/stats11.q.out
+++ b/ql/src/test/results/clientpositive/stats11.q.out
@@ -294,63 +294,6 @@ select /*+mapjoin(b)*/ a.key, a.value, b.value
 from srcbucket_mapjoin a join srcbucket_mapjoin_part b 
 on a.key=b.key where b.ds="2008-04-08"
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucketmapjoin_tmp_result
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  b
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-      TOK_WHERE
-         =
-            .
-               TOK_TABLE_OR_COL
-                  b
-               ds
-            "2008-04-08"
-
-
 STAGE DEPENDENCIES:
   Stage-9 is a root stage
   Stage-1 depends on stages: Stage-9
@@ -826,63 +769,6 @@ select /*+mapjoin(a)*/ a.key, a.value, b.value
 from srcbucket_mapjoin a join srcbucket_mapjoin_part b 
 on a.key=b.key where b.ds="2008-04-08"
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               srcbucket_mapjoin_part
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucketmapjoin_tmp_result
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  a
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               value
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  b
-               value
-      TOK_WHERE
-         =
-            .
-               TOK_TABLE_OR_COL
-                  b
-               ds
-            "2008-04-08"
-
-
 STAGE DEPENDENCIES:
   Stage-9 is a root stage
   Stage-1 depends on stages: Stage-9
diff --git a/ql/src/test/results/clientpositive/stats12.q.out b/ql/src/test/results/clientpositive/stats12.q.out
index 6a44d15f7e..9f373593fd 100644
--- a/ql/src/test/results/clientpositive/stats12.q.out
+++ b/ql/src/test/results/clientpositive/stats12.q.out
@@ -39,20 +39,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 analyze table analyze_srcpart PARTITION(ds='2008-04-08',hr) compute statistics
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_ANALYZE
-   TOK_TAB
-      TOK_TABNAME
-         analyze_srcpart
-      TOK_PARTSPEC
-         TOK_PARTVAL
-            ds
-            '2008-04-08'
-         TOK_PARTVAL
-            hr
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
   Stage-1 depends on stages: Stage-0
diff --git a/ql/src/test/results/clientpositive/stats13.q.out b/ql/src/test/results/clientpositive/stats13.q.out
index f98753e623..6fcd353db7 100644
--- a/ql/src/test/results/clientpositive/stats13.q.out
+++ b/ql/src/test/results/clientpositive/stats13.q.out
@@ -39,21 +39,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 analyze table analyze_srcpart PARTITION(ds='2008-04-08',hr=11) compute statistics
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_ANALYZE
-   TOK_TAB
-      TOK_TABNAME
-         analyze_srcpart
-      TOK_PARTSPEC
-         TOK_PARTVAL
-            ds
-            '2008-04-08'
-         TOK_PARTVAL
-            hr
-            11
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
   Stage-1 depends on stages: Stage-0
diff --git a/ql/src/test/results/clientpositive/stats3.q.out b/ql/src/test/results/clientpositive/stats3.q.out
index 0d8cbbd16b..4dbda94c96 100644
--- a/ql/src/test/results/clientpositive/stats3.q.out
+++ b/ql/src/test/results/clientpositive/stats3.q.out
@@ -20,17 +20,6 @@ PREHOOK: type: LOAD
 POSTHOOK: query: explain extended
 load data local inpath '../../data/files/test.dat' overwrite into table hive_test_src
 POSTHOOK: type: LOAD
-ABSTRACT SYNTAX TREE:
-  
-TOK_LOAD
-   '../../data/files/test.dat'
-   TOK_TAB
-      TOK_TABNAME
-         hive_test_src
-   local
-   overwrite
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
   Stage-1 depends on stages: Stage-0
diff --git a/ql/src/test/results/clientpositive/temp_table_display_colstats_tbllvl.q.out b/ql/src/test/results/clientpositive/temp_table_display_colstats_tbllvl.q.out
index 532e65a02c..e229dba76c 100644
--- a/ql/src/test/results/clientpositive/temp_table_display_colstats_tbllvl.q.out
+++ b/ql/src/test/results/clientpositive/temp_table_display_colstats_tbllvl.q.out
@@ -113,19 +113,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 analyze table UserVisits_web_text_none compute statistics for columns sourceIP, avgTimeOnSite, adRevenue
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_ANALYZE
-   TOK_TAB
-      TOK_TABNAME
-         UserVisits_web_text_none
-   columns
-   TOK_TABCOLNAME
-      sourceIP
-      avgTimeOnSite
-      adRevenue
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
   Stage-1 depends on stages: Stage-0
diff --git a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_1.q.out b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_1.q.out
index bd6db7fe86..892539d562 100644
--- a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_1.q.out
+++ b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_1.q.out
@@ -109,38 +109,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: -- Since size is being used to find the big table, the order of the tables in the join does not matter
 explain extended select count(*) FROM bucket_small a JOIN bucket_big b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -418,38 +386,6 @@ PREHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_s
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_small b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -727,38 +663,6 @@ PREHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_s
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_small b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_11.q.out b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_11.q.out
index 04b48a22b4..954fd968b7 100644
--- a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_11.q.out
+++ b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_11.q.out
@@ -105,38 +105,6 @@ PREHOOK: query: explain extended select count(*) FROM bucket_small a JOIN bucket
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select count(*) FROM bucket_small a JOIN bucket_big b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -419,38 +387,6 @@ POSTHOOK: query: -- Since size is being used to find the big table, the order of
 -- bucketized mapjoin is not done
 explain extended select count(*) FROM bucket_small a JOIN bucket_big b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -727,43 +663,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: -- The join is converted to a bucketed mapjoin with a mapjoin hint
 explain extended select /*+ mapjoin(a) */ count(*) FROM bucket_small a JOIN bucket_big b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  a
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1032,58 +931,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: -- HIVE-7023
 explain extended select /* + MAPJOIN(a,b) */ count(*) FROM bucket_small a JOIN bucket_big b ON a.key = b.key JOIN bucket_big c ON a.key = c.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_JOIN
-            TOK_TABREF
-               TOK_TABNAME
-                  bucket_small
-               a
-            TOK_TABREF
-               TOK_TABNAME
-                  bucket_big
-               b
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     a
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            c
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  c
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_HINTLIST
-            TOK_HINT
-               TOK_MAPJOIN
-               TOK_HINTARGLIST
-                  a
-                  b
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_12.q.out b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_12.q.out
index 866443544b..578880dbce 100644
--- a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_12.q.out
+++ b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_12.q.out
@@ -143,66 +143,6 @@ PREHOOK: query: explain extended select count(*) FROM bucket_small a JOIN bucket
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select count(*) FROM bucket_small a JOIN bucket_medium b ON a.key = b.key JOIN bucket_big c ON c.key = b.key JOIN bucket_medium d ON c.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_JOIN
-            TOK_JOIN
-               TOK_TABREF
-                  TOK_TABNAME
-                     bucket_small
-                  a
-               TOK_TABREF
-                  TOK_TABNAME
-                     bucket_medium
-                  b
-               =
-                  .
-                     TOK_TABLE_OR_COL
-                        a
-                     key
-                  .
-                     TOK_TABLE_OR_COL
-                        b
-                     key
-            TOK_TABREF
-               TOK_TABNAME
-                  bucket_big
-               c
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     c
-                  key
-               .
-                  TOK_TABLE_OR_COL
-                     b
-                  key
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_medium
-            d
-         =
-            .
-               TOK_TABLE_OR_COL
-                  c
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_2.q.out b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_2.q.out
index a0f2be1ab8..c2837388b1 100644
--- a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_2.q.out
+++ b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_2.q.out
@@ -89,38 +89,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: -- Since the leftmost table is assumed as the big table, arrange the tables in the join accordingly
 explain extended select count(*) FROM bucket_big a JOIN bucket_small b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -400,38 +368,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: -- The mapjoin should fail resulting in the sort-merge join
 explain extended select count(*) FROM bucket_big a JOIN bucket_small b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_3.q.out b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_3.q.out
index e6fb5dc8fe..351fd2072f 100644
--- a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_3.q.out
+++ b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_3.q.out
@@ -89,38 +89,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: -- Since size is being used to find the big table, the order of the tables in the join does not matter
 explain extended select count(*) FROM bucket_small a JOIN bucket_big b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -398,38 +366,6 @@ PREHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_s
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_small b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -707,38 +643,6 @@ PREHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_s
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_small b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_4.q.out b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_4.q.out
index b24c276939..2d9cdf8b00 100644
--- a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_4.q.out
+++ b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_4.q.out
@@ -105,38 +105,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: -- Since size is being used to find the big table, the order of the tables in the join does not matter
 explain extended select count(*) FROM bucket_small a JOIN bucket_big b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -414,38 +382,6 @@ PREHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_s
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_small b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -723,38 +659,6 @@ PREHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_s
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_small b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_5.q.out b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_5.q.out
index db7b805e2d..8bc203a1f2 100644
--- a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_5.q.out
+++ b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_5.q.out
@@ -76,38 +76,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: -- Since size is being used to find the big table, the order of the tables in the join does not matter
 explain extended select count(*) FROM bucket_small a JOIN bucket_big b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -311,38 +279,6 @@ PREHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_s
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_small b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -546,38 +482,6 @@ PREHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_s
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_small b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_7.q.out b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_7.q.out
index faf20fad98..18fc95c075 100644
--- a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_7.q.out
+++ b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_7.q.out
@@ -122,38 +122,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: -- Since size is being used to find the big table, the order of the tables in the join does not matter
 explain extended select count(*) FROM bucket_small a JOIN bucket_big b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -479,38 +447,6 @@ PREHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_s
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_small b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -836,38 +772,6 @@ PREHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_s
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_small b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_8.q.out b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_8.q.out
index 7b51ffcd22..9a1010c21b 100644
--- a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_8.q.out
+++ b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_8.q.out
@@ -122,38 +122,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: -- Since size is being used to find the big table, the order of the tables in the join does not matter
 explain extended select count(*) FROM bucket_small a JOIN bucket_big b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -479,38 +447,6 @@ PREHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_s
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select count(*) FROM bucket_big a JOIN bucket_small b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -838,38 +774,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: -- The mapjoin should fail resulting in the sort-merge join
 explain extended select count(*) FROM bucket_big a JOIN bucket_small b ON a.key = b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_big
-            a
-         TOK_TABREF
-            TOK_TABNAME
-               bucket_small
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/tez/bucket2.q.out b/ql/src/test/results/clientpositive/tez/bucket2.q.out
index 151b0cea67..e9432a8c68 100644
--- a/ql/src/test/results/clientpositive/tez/bucket2.q.out
+++ b/ql/src/test/results/clientpositive/tez/bucket2.q.out
@@ -18,23 +18,6 @@ POSTHOOK: query: explain extended
 insert overwrite table bucket2_1
 select * from src
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            src
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucket2_1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/tez/bucket3.q.out b/ql/src/test/results/clientpositive/tez/bucket3.q.out
index 3308a8a267..1532edca5e 100644
--- a/ql/src/test/results/clientpositive/tez/bucket3.q.out
+++ b/ql/src/test/results/clientpositive/tez/bucket3.q.out
@@ -18,27 +18,6 @@ POSTHOOK: query: explain extended
 insert overwrite table bucket3_1 partition (ds='1')
 select * from src
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            src
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucket3_1
-            TOK_PARTSPEC
-               TOK_PARTVAL
-                  ds
-                  '1'
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/tez/bucket4.q.out b/ql/src/test/results/clientpositive/tez/bucket4.q.out
index f2030e8c71..a0f1177e68 100644
--- a/ql/src/test/results/clientpositive/tez/bucket4.q.out
+++ b/ql/src/test/results/clientpositive/tez/bucket4.q.out
@@ -14,23 +14,6 @@ POSTHOOK: query: explain extended
 insert overwrite table bucket4_1
 select * from src
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            src
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucket4_1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/tez/bucketpruning1.q.out b/ql/src/test/results/clientpositive/tez/bucketpruning1.q.out
index 78df581325..bb9d3bb505 100644
--- a/ql/src/test/results/clientpositive/tez/bucketpruning1.q.out
+++ b/ql/src/test/results/clientpositive/tez/bucketpruning1.q.out
@@ -26,27 +26,6 @@ POSTHOOK: query: -- good cases
 explain extended
 select * from srcbucket_pruned where key = 1
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcbucket_pruned
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         =
-            TOK_TABLE_OR_COL
-               key
-            1
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -107,27 +86,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select * from srcbucket_pruned where key = 16
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcbucket_pruned
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         =
-            TOK_TABLE_OR_COL
-               key
-            16
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -188,27 +146,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select * from srcbucket_pruned where key = 17
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcbucket_pruned
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         =
-            TOK_TABLE_OR_COL
-               key
-            17
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -269,29 +206,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select * from srcbucket_pruned where key = 16+1
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcbucket_pruned
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         =
-            TOK_TABLE_OR_COL
-               key
-            +
-               16
-               1
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -352,27 +266,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select * from srcbucket_pruned where key = '11'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcbucket_pruned
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         =
-            TOK_TABLE_OR_COL
-               key
-            '11'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -433,32 +326,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select * from srcbucket_pruned where key = 1 and ds='2008-04-08'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcbucket_pruned
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         and
-            =
-               TOK_TABLE_OR_COL
-                  key
-               1
-            =
-               TOK_TABLE_OR_COL
-                  ds
-               '2008-04-08'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -519,37 +386,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select * from srcbucket_pruned where key = 1 and ds='2008-04-08' and value='One'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcbucket_pruned
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         and
-            and
-               =
-                  TOK_TABLE_OR_COL
-                     key
-                  1
-               =
-                  TOK_TABLE_OR_COL
-                     ds
-                  '2008-04-08'
-            =
-               TOK_TABLE_OR_COL
-                  value
-               'One'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -610,37 +446,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select * from srcbucket_pruned where value='One' and key = 1 and ds='2008-04-08'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcbucket_pruned
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         and
-            and
-               =
-                  TOK_TABLE_OR_COL
-                     value
-                  'One'
-               =
-                  TOK_TABLE_OR_COL
-                     key
-                  1
-            =
-               TOK_TABLE_OR_COL
-                  ds
-               '2008-04-08'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -701,29 +506,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select * from srcbucket_pruned where key in (2,3)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcbucket_pruned
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         TOK_FUNCTION
-            in
-            TOK_TABLE_OR_COL
-               key
-            2
-            3
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -784,34 +566,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select * from srcbucket_pruned where key in (2,3) and ds='2008-04-08'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcbucket_pruned
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         and
-            TOK_FUNCTION
-               in
-               TOK_TABLE_OR_COL
-                  key
-               2
-               3
-            =
-               TOK_TABLE_OR_COL
-                  ds
-               '2008-04-08'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -872,39 +626,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select * from srcbucket_pruned where key in (2,3) and ds='2008-04-08' and value='One'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcbucket_pruned
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         and
-            and
-               TOK_FUNCTION
-                  in
-                  TOK_TABLE_OR_COL
-                     key
-                  2
-                  3
-               =
-                  TOK_TABLE_OR_COL
-                     ds
-                  '2008-04-08'
-            =
-               TOK_TABLE_OR_COL
-                  value
-               'One'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -965,39 +686,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select * from srcbucket_pruned where value='One' and key in (2,3) and ds='2008-04-08'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcbucket_pruned
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         and
-            and
-               =
-                  TOK_TABLE_OR_COL
-                     value
-                  'One'
-               TOK_FUNCTION
-                  in
-                  TOK_TABLE_OR_COL
-                     key
-                  2
-                  3
-            =
-               TOK_TABLE_OR_COL
-                  ds
-               '2008-04-08'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1058,37 +746,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select * from srcbucket_pruned where (key=1 or key=2) and ds='2008-04-08'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcbucket_pruned
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         and
-            or
-               =
-                  TOK_TABLE_OR_COL
-                     key
-                  1
-               =
-                  TOK_TABLE_OR_COL
-                     key
-                  2
-            =
-               TOK_TABLE_OR_COL
-                  ds
-               '2008-04-08'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1148,42 +805,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select * from srcbucket_pruned where (key=1 or key=2) and value = 'One' and ds='2008-04-08'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcbucket_pruned
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         and
-            and
-               or
-                  =
-                     TOK_TABLE_OR_COL
-                        key
-                     1
-                  =
-                     TOK_TABLE_OR_COL
-                        key
-                     2
-               =
-                  TOK_TABLE_OR_COL
-                     value
-                  'One'
-            =
-               TOK_TABLE_OR_COL
-                  ds
-               '2008-04-08'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1247,28 +868,6 @@ POSTHOOK: query: -- compat case (-15 = 1 & 15)
 explain extended
 select * from srcbucket_pruned where key = -15
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcbucket_pruned
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         =
-            TOK_TABLE_OR_COL
-               key
-            -
-               15
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1333,44 +932,6 @@ POSTHOOK: query: -- valid but irrelevant case (all buckets selected)
 explain extended
 select * from srcbucket_pruned where key in (1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcbucket_pruned
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         TOK_FUNCTION
-            in
-            TOK_TABLE_OR_COL
-               key
-            1
-            2
-            3
-            4
-            5
-            6
-            7
-            8
-            9
-            10
-            11
-            12
-            13
-            14
-            15
-            16
-            17
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1430,49 +991,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select * from srcbucket_pruned where key in (1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17) and ds='2008-04-08'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcbucket_pruned
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         and
-            TOK_FUNCTION
-               in
-               TOK_TABLE_OR_COL
-                  key
-               1
-               2
-               3
-               4
-               5
-               6
-               7
-               8
-               9
-               10
-               11
-               12
-               13
-               14
-               15
-               16
-               17
-            =
-               TOK_TABLE_OR_COL
-                  ds
-               '2008-04-08'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1532,54 +1050,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select * from srcbucket_pruned where key in (1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17) and ds='2008-04-08' and value='One'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcbucket_pruned
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         and
-            and
-               TOK_FUNCTION
-                  in
-                  TOK_TABLE_OR_COL
-                     key
-                  1
-                  2
-                  3
-                  4
-                  5
-                  6
-                  7
-                  8
-                  9
-                  10
-                  11
-                  12
-                  13
-                  14
-                  15
-                  16
-                  17
-               =
-                  TOK_TABLE_OR_COL
-                     ds
-                  '2008-04-08'
-            =
-               TOK_TABLE_OR_COL
-                  value
-               'One'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1639,54 +1109,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select * from srcbucket_pruned where value='One' and key in (1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17) and ds='2008-04-08'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcbucket_pruned
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         and
-            and
-               =
-                  TOK_TABLE_OR_COL
-                     value
-                  'One'
-               TOK_FUNCTION
-                  in
-                  TOK_TABLE_OR_COL
-                     key
-                  1
-                  2
-                  3
-                  4
-                  5
-                  6
-                  7
-                  8
-                  9
-                  10
-                  11
-                  12
-                  13
-                  14
-                  15
-                  16
-                  17
-            =
-               TOK_TABLE_OR_COL
-                  ds
-               '2008-04-08'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1750,37 +1172,6 @@ POSTHOOK: query: -- valid, but unimplemented cases
 explain extended
 select * from srcbucket_pruned where key = 1 and ds='2008-04-08' or key = 2
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcbucket_pruned
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         or
-            and
-               =
-                  TOK_TABLE_OR_COL
-                     key
-                  1
-               =
-                  TOK_TABLE_OR_COL
-                     ds
-                  '2008-04-08'
-            =
-               TOK_TABLE_OR_COL
-                  key
-               2
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1840,42 +1231,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select * from srcbucket_pruned where key = 1 and ds='2008-04-08' and (value='One' or value = 'Two')
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcbucket_pruned
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         and
-            and
-               =
-                  TOK_TABLE_OR_COL
-                     key
-                  1
-               =
-                  TOK_TABLE_OR_COL
-                     ds
-                  '2008-04-08'
-            or
-               =
-                  TOK_TABLE_OR_COL
-                     value
-                  'One'
-               =
-                  TOK_TABLE_OR_COL
-                     value
-                  'Two'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1935,42 +1290,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select * from srcbucket_pruned where key = 1 or value = "One" or key = 2 and value = "Two"
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcbucket_pruned
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         or
-            or
-               =
-                  TOK_TABLE_OR_COL
-                     key
-                  1
-               =
-                  TOK_TABLE_OR_COL
-                     value
-                  "One"
-            and
-               =
-                  TOK_TABLE_OR_COL
-                     key
-                  2
-               =
-                  TOK_TABLE_OR_COL
-                     value
-                  "Two"
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -2034,27 +1353,6 @@ POSTHOOK: query: -- Invalid cases
 explain extended
 select * from srcbucket_pruned where key = 'x11'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcbucket_pruned
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         =
-            TOK_TABLE_OR_COL
-               key
-            'x11'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -2113,32 +1411,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select * from srcbucket_pruned where key = 1 or value = "One"
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcbucket_pruned
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         or
-            =
-               TOK_TABLE_OR_COL
-                  key
-               1
-            =
-               TOK_TABLE_OR_COL
-                  value
-               "One"
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -2198,37 +1470,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select * from srcbucket_pruned where key = 1 or value = "One" or key = 2
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcbucket_pruned
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         or
-            or
-               =
-                  TOK_TABLE_OR_COL
-                     key
-                  1
-               =
-                  TOK_TABLE_OR_COL
-                     value
-                  "One"
-            =
-               TOK_TABLE_OR_COL
-                  key
-               2
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -2288,29 +1529,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select * from srcbucket_unpruned where key in (3, 5)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcbucket_unpruned
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         TOK_FUNCTION
-            in
-            TOK_TABLE_OR_COL
-               key
-            3
-            5
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -2370,27 +1588,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select * from srcbucket_unpruned where key = 1
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcbucket_unpruned
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         =
-            TOK_TABLE_OR_COL
-               key
-            1
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/tez/ctas.q.out b/ql/src/test/results/clientpositive/tez/ctas.q.out
index 52ea981c36..d92a44663b 100644
--- a/ql/src/test/results/clientpositive/tez/ctas.q.out
+++ b/ql/src/test/results/clientpositive/tez/ctas.q.out
@@ -698,49 +698,6 @@ PREHOOK: query: explain extended create table nzhang_ctas5 row format delimited
 PREHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: query: explain extended create table nzhang_ctas5 row format delimited fields terminated by ',' lines terminated by '\012' stored as textfile as select key, value from src sort by key, value limit 10
 POSTHOOK: type: CREATETABLE_AS_SELECT
-ABSTRACT SYNTAX TREE:
-  
-TOK_CREATETABLE
-   TOK_TABNAME
-      nzhang_ctas5
-   TOK_LIKETABLE
-   TOK_TABLEROWFORMAT
-      TOK_SERDEPROPS
-         TOK_TABLEROWFORMATFIELD
-            ','
-         TOK_TABLEROWFORMATLINES
-            '\012'
-   TOK_FILEFORMAT_GENERIC
-      textfile
-   TOK_QUERY
-      TOK_FROM
-         TOK_TABREF
-            TOK_TABNAME
-               src
-      TOK_INSERT
-         TOK_DESTINATION
-            TOK_DIR
-               TOK_TMP_FILE
-         TOK_SELECT
-            TOK_SELEXPR
-               TOK_TABLE_OR_COL
-                  key
-            TOK_SELEXPR
-               TOK_TABLE_OR_COL
-                  value
-         TOK_SORTBY
-            TOK_TABSORTCOLNAMEASC
-               TOK_NULLS_FIRST
-                  TOK_TABLE_OR_COL
-                     key
-            TOK_TABSORTCOLNAMEASC
-               TOK_NULLS_FIRST
-                  TOK_TABLE_OR_COL
-                     value
-         TOK_LIMIT
-            10
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/tez/disable_merge_for_bucketing.q.out b/ql/src/test/results/clientpositive/tez/disable_merge_for_bucketing.q.out
index 65f750bb29..bb62e1f1e2 100644
--- a/ql/src/test/results/clientpositive/tez/disable_merge_for_bucketing.q.out
+++ b/ql/src/test/results/clientpositive/tez/disable_merge_for_bucketing.q.out
@@ -14,23 +14,6 @@ POSTHOOK: query: explain extended
 insert overwrite table bucket2_1
 select * from src
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            src
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               bucket2_1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/tez/filter_join_breaktask.q.out b/ql/src/test/results/clientpositive/tez/filter_join_breaktask.q.out
index 15cad97a85..2075b480ca 100644
--- a/ql/src/test/results/clientpositive/tez/filter_join_breaktask.q.out
+++ b/ql/src/test/results/clientpositive/tez/filter_join_breaktask.q.out
@@ -32,108 +32,6 @@ SELECT f.key, g.value
 FROM filter_join_breaktask f JOIN filter_join_breaktask m ON( f.key = m.key AND f.ds='2008-04-08' AND m.ds='2008-04-08' AND f.key is not null) 
 JOIN filter_join_breaktask g ON(g.value = m.value AND g.ds='2008-04-08' AND m.ds='2008-04-08' AND m.value is not null AND m.value !='')
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_JOIN
-            TOK_TABREF
-               TOK_TABNAME
-                  filter_join_breaktask
-               f
-            TOK_TABREF
-               TOK_TABNAME
-                  filter_join_breaktask
-               m
-            AND
-               AND
-                  AND
-                     =
-                        .
-                           TOK_TABLE_OR_COL
-                              f
-                           key
-                        .
-                           TOK_TABLE_OR_COL
-                              m
-                           key
-                     =
-                        .
-                           TOK_TABLE_OR_COL
-                              f
-                           ds
-                        '2008-04-08'
-                  =
-                     .
-                        TOK_TABLE_OR_COL
-                           m
-                        ds
-                     '2008-04-08'
-               TOK_FUNCTION
-                  TOK_ISNOTNULL
-                  .
-                     TOK_TABLE_OR_COL
-                        f
-                     key
-         TOK_TABREF
-            TOK_TABNAME
-               filter_join_breaktask
-            g
-         AND
-            AND
-               AND
-                  AND
-                     =
-                        .
-                           TOK_TABLE_OR_COL
-                              g
-                           value
-                        .
-                           TOK_TABLE_OR_COL
-                              m
-                           value
-                     =
-                        .
-                           TOK_TABLE_OR_COL
-                              g
-                           ds
-                        '2008-04-08'
-                  =
-                     .
-                        TOK_TABLE_OR_COL
-                           m
-                        ds
-                     '2008-04-08'
-               TOK_FUNCTION
-                  TOK_ISNOTNULL
-                  .
-                     TOK_TABLE_OR_COL
-                        m
-                     value
-            !=
-               .
-                  TOK_TABLE_OR_COL
-                     m
-                  value
-               ''
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  f
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  g
-               value
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/tez/llap_nullscan.q.out b/ql/src/test/results/clientpositive/tez/llap_nullscan.q.out
index 39f04ea971..944a494312 100644
--- a/ql/src/test/results/clientpositive/tez/llap_nullscan.q.out
+++ b/ql/src/test/results/clientpositive/tez/llap_nullscan.q.out
@@ -30,26 +30,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select * from src_orc where 1=2
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            src_orc
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         =
-            1
-            2
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/tez/mapjoin_mapjoin.q.out b/ql/src/test/results/clientpositive/tez/mapjoin_mapjoin.q.out
index d03b1cc8a1..316c914d59 100644
--- a/ql/src/test/results/clientpositive/tez/mapjoin_mapjoin.q.out
+++ b/ql/src/test/results/clientpositive/tez/mapjoin_mapjoin.q.out
@@ -10,51 +10,6 @@ POSTHOOK: query: -- Since the inputs are small, it should be automatically conve
 
 explain extended select srcpart.key from srcpart join src on (srcpart.value=src.value) join src1 on (srcpart.key=src1.key)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_JOIN
-            TOK_TABREF
-               TOK_TABNAME
-                  srcpart
-            TOK_TABREF
-               TOK_TABNAME
-                  src
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     srcpart
-                  value
-               .
-                  TOK_TABLE_OR_COL
-                     src
-                  value
-         TOK_TABREF
-            TOK_TABNAME
-               src1
-         =
-            .
-               TOK_TABLE_OR_COL
-                  srcpart
-               key
-            .
-               TOK_TABLE_OR_COL
-                  src1
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  srcpart
-               key
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/tez/metadataonly1.q.out b/ql/src/test/results/clientpositive/tez/metadataonly1.q.out
index 1961d1ba1c..e43a7e43fa 100644
--- a/ql/src/test/results/clientpositive/tez/metadataonly1.q.out
+++ b/ql/src/test/results/clientpositive/tez/metadataonly1.q.out
@@ -10,25 +10,6 @@ PREHOOK: query: explain extended select max(ds) from TEST1
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select max(ds) from TEST1
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            TEST1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTION
-               max
-               TOK_TABLE_OR_COL
-                  ds
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -120,25 +101,6 @@ PREHOOK: query: explain extended select max(ds) from TEST1
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select max(ds) from TEST1
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            TEST1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTION
-               max
-               TOK_TABLE_OR_COL
-                  ds
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -269,25 +231,6 @@ PREHOOK: query: explain extended select count(distinct ds) from TEST1
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select count(distinct ds) from TEST1
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            TEST1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONDI
-               count
-               TOK_TABLE_OR_COL
-                  ds
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -419,25 +362,6 @@ PREHOOK: query: explain extended select count(ds) from TEST1
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select count(ds) from TEST1
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            TEST1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               TOK_TABLE_OR_COL
-                  ds
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -578,52 +502,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended 
 select count(*) from TEST1 a2 join (select max(ds) m from TEST1) b on a2.ds=b.m
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               TEST1
-            a2
-         TOK_SUBQUERY
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        TEST1
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_FUNCTION
-                           max
-                           TOK_TABLE_OR_COL
-                              ds
-                        m
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a2
-               ds
-            .
-               TOK_TABLE_OR_COL
-                  b
-               m
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTIONSTAR
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -991,31 +869,6 @@ PREHOOK: query: explain extended select ds, count(distinct hr) from TEST2 group
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select ds, count(distinct hr) from TEST2 group by ds
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            TEST2
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds
-         TOK_SELEXPR
-            TOK_FUNCTIONDI
-               count
-               TOK_TABLE_OR_COL
-                  hr
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            ds
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1238,31 +1091,6 @@ PREHOOK: query: explain extended select ds, count(hr) from TEST2 group by ds
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select ds, count(hr) from TEST2 group by ds
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            TEST2
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               TOK_TABLE_OR_COL
-                  hr
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            ds
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1486,25 +1314,6 @@ PREHOOK: query: explain extended select max(ds) from TEST1
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select max(ds) from TEST1
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            TEST1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTION
-               max
-               TOK_TABLE_OR_COL
-                  ds
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1729,31 +1538,6 @@ PREHOOK: query: explain extended select ds, count(distinct hr) from TEST2 group
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended select ds, count(distinct hr) from TEST2 group by ds
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            TEST2
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ds
-         TOK_SELEXPR
-            TOK_FUNCTIONDI
-               count
-               TOK_TABLE_OR_COL
-                  hr
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            ds
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/tez/optimize_nullscan.q.out b/ql/src/test/results/clientpositive/tez/optimize_nullscan.q.out
index 336a5e9cf2..2cae5ce7e7 100644
--- a/ql/src/test/results/clientpositive/tez/optimize_nullscan.q.out
+++ b/ql/src/test/results/clientpositive/tez/optimize_nullscan.q.out
@@ -14,25 +14,6 @@ POSTHOOK: query: -- SORT_QUERY_RESULTS
 explain extended 
 select key from src where false
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            src
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-      TOK_WHERE
-         false
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
@@ -66,32 +47,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select count(key) from srcpart where 1=2 group by key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               TOK_TABLE_OR_COL
-                  key
-      TOK_WHERE
-         =
-            1
-            2
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            key
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -185,63 +140,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select * from (select key from src where false) a left outer join (select key from srcpart limit 0) b on a.key=b.key
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_LEFTOUTERJOIN
-         TOK_SUBQUERY
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        src
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           key
-                  TOK_WHERE
-                     false
-            a
-         TOK_SUBQUERY
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        srcpart
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           key
-                  TOK_LIMIT
-                     0
-            b
-         =
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-            .
-               TOK_TABLE_OR_COL
-                  b
-               key
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -619,54 +517,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select count(key) from src where false union all select count(key) from srcpart
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_UNIONALL
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        src
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_FUNCTION
-                           count
-                           TOK_TABLE_OR_COL
-                              key
-                  TOK_WHERE
-                     false
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        srcpart
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_FUNCTION
-                           count
-                           TOK_TABLE_OR_COL
-                              key
-         _u1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1060,54 +910,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select * from (select key from src where false) a left outer join (select value from srcpart limit 0) b
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_LEFTOUTERJOIN
-         TOK_SUBQUERY
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        src
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           key
-                  TOK_WHERE
-                     false
-            a
-         TOK_SUBQUERY
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        srcpart
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           value
-                  TOK_LIMIT
-                     0
-            b
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1484,65 +1286,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended 
 select * from (select key from src union all select src.key from src left outer join srcpart on src.key = srcpart.key) a  where false
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_UNIONALL
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        src
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           key
-            TOK_QUERY
-               TOK_FROM
-                  TOK_LEFTOUTERJOIN
-                     TOK_TABREF
-                        TOK_TABNAME
-                           src
-                     TOK_TABREF
-                        TOK_TABNAME
-                           srcpart
-                     =
-                        .
-                           TOK_TABLE_OR_COL
-                              src
-                           key
-                        .
-                           TOK_TABLE_OR_COL
-                              srcpart
-                           key
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        .
-                           TOK_TABLE_OR_COL
-                              src
-                           key
-         a
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         false
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1784,40 +1527,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended 
 select * from src s1, src s2 where false and s1.value = s2.value
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               src
-            s1
-         TOK_TABREF
-            TOK_TABNAME
-               src
-            s2
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         and
-            false
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     s1
-                  value
-               .
-                  TOK_TABLE_OR_COL
-                     s2
-                  value
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -2023,28 +1732,6 @@ PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
 select count(1) from src where null = 1
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            src
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_WHERE
-         =
-            TOK_NULL
-            1
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/tez/sample1.q.out b/ql/src/test/results/clientpositive/tez/sample1.q.out
index 96632188c1..009969ed28 100644
--- a/ql/src/test/results/clientpositive/tez/sample1.q.out
+++ b/ql/src/test/results/clientpositive/tez/sample1.q.out
@@ -18,45 +18,6 @@ INSERT OVERWRITE TABLE dest1 SELECT s.*
 FROM srcpart TABLESAMPLE (BUCKET 1 OUT OF 1 ON rand()) s
 WHERE s.ds='2008-04-08' and s.hr='11'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            srcpart
-         TOK_TABLEBUCKETSAMPLE
-            1
-            1
-            TOK_FUNCTION
-               rand
-         s
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dest1
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-               TOK_TABNAME
-                  s
-      TOK_WHERE
-         and
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     s
-                  ds
-               '2008-04-08'
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     s
-                  hr
-               '11'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/tez/tez_join_result_complex.q.out b/ql/src/test/results/clientpositive/tez/tez_join_result_complex.q.out
index 180bcc6f06..3e3b08cdba 100644
--- a/ql/src/test/results/clientpositive/tez/tez_join_result_complex.q.out
+++ b/ql/src/test/results/clientpositive/tez/tez_join_result_complex.q.out
@@ -148,271 +148,6 @@ inner join
 service_request_clean b
 on a.contact_event_id = b.cnctevn_id
 POSTHOOK: type: CREATETABLE_AS_SELECT
-ABSTRACT SYNTAX TREE:
-  
-TOK_CREATETABLE
-   TOK_TABNAME
-      ct_events1_test
-   TOK_LIKETABLE
-   TOK_QUERY
-      TOK_FROM
-         TOK_JOIN
-            TOK_SUBQUERY
-               TOK_QUERY
-                  TOK_FROM
-                     TOK_TABREF
-                        TOK_TABNAME
-                           default
-                           ct_events_clean
-                        a
-                  TOK_INSERT
-                     TOK_DESTINATION
-                        TOK_DIR
-                           TOK_TMP_FILE
-                     TOK_SELECT
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 a
-                              contact_event_id
-                           contact_event_id
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 a
-                              ce_create_dt
-                           ce_create_dt
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 a
-                              ce_end_dt
-                           ce_end_dt
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 a
-                              contact_type
-                           contact_type
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 a
-                              cnctevs_cd
-                           cnctevs_cd
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 a
-                              contact_mode
-                           contact_mode
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 a
-                              cntvnst_stts_cd
-                           cntvnst_stts_cd
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 a
-                              total_transfers
-                           total_transfers
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 a
-                              ce_notes
-                           ce_notes
-                     TOK_WHERE
-                        TOK_FUNCTION
-                           TOK_ISNOTNULL
-                           .
-                              TOK_TABLE_OR_COL
-                                 a
-                              contact_event_id
-               $hdt$_0
-            TOK_SUBQUERY
-               TOK_QUERY
-                  TOK_FROM
-                     TOK_TABREF
-                        TOK_TABNAME
-                           default
-                           service_request_clean
-                        b
-                  TOK_INSERT
-                     TOK_DESTINATION
-                        TOK_DIR
-                           TOK_TMP_FILE
-                     TOK_SELECT
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 b
-                              cnctevn_id
-                           cnctevn_id
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 b
-                              svcrqst_id
-                           svcrqst_id
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 b
-                              cnctmd_cd
-                           cnctmd_cd
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 b
-                              svcrtyp_cd
-                           svcrtyp_cd
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 b
-                              cmpltyp_cd
-                           cmpltyp_cd
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 b
-                              sum_reason_cd
-                           sum_reason_cd
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 b
-                              svcrqct_cds
-                           svcrqct_cds
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 b
-                              notes
-                           notes
-                     TOK_WHERE
-                        TOK_FUNCTION
-                           TOK_ISNOTNULL
-                           .
-                              TOK_TABLE_OR_COL
-                                 b
-                              cnctevn_id
-               $hdt$_1
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_0
-                  contact_event_id
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_1
-                  cnctevn_id
-      TOK_INSERT
-         TOK_DESTINATION
-            TOK_DIR
-               TOK_TMP_FILE
-         TOK_SELECT
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_0
-                  contact_event_id
-               a.contact_event_id
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_0
-                  ce_create_dt
-               a.ce_create_dt
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_0
-                  ce_end_dt
-               a.ce_end_dt
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_0
-                  contact_type
-               a.contact_type
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_0
-                  cnctevs_cd
-               a.cnctevs_cd
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_0
-                  contact_mode
-               a.contact_mode
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_0
-                  cntvnst_stts_cd
-               a.cntvnst_stts_cd
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_0
-                  total_transfers
-               a.total_transfers
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_0
-                  ce_notes
-               a.ce_notes
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_1
-                  svcrqst_id
-               b.svcrqst_id
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_1
-                  svcrqct_cds
-               b.svcrqct_cds
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_1
-                  svcrtyp_cd
-               b.svcrtyp_cd
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_1
-                  cmpltyp_cd
-               b.cmpltyp_cd
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_1
-                  sum_reason_cd
-               src
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_1
-                  cnctmd_cd
-               b.cnctmd_cd
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_1
-                  notes
-               b.notes
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -1385,271 +1120,6 @@ inner join
 service_request_clean b
 on a.contact_event_id = b.cnctevn_id
 POSTHOOK: type: CREATETABLE_AS_SELECT
-ABSTRACT SYNTAX TREE:
-  
-TOK_CREATETABLE
-   TOK_TABNAME
-      ct_events1_test
-   TOK_LIKETABLE
-   TOK_QUERY
-      TOK_FROM
-         TOK_JOIN
-            TOK_SUBQUERY
-               TOK_QUERY
-                  TOK_FROM
-                     TOK_TABREF
-                        TOK_TABNAME
-                           default
-                           ct_events_clean
-                        a
-                  TOK_INSERT
-                     TOK_DESTINATION
-                        TOK_DIR
-                           TOK_TMP_FILE
-                     TOK_SELECT
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 a
-                              contact_event_id
-                           contact_event_id
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 a
-                              ce_create_dt
-                           ce_create_dt
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 a
-                              ce_end_dt
-                           ce_end_dt
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 a
-                              contact_type
-                           contact_type
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 a
-                              cnctevs_cd
-                           cnctevs_cd
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 a
-                              contact_mode
-                           contact_mode
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 a
-                              cntvnst_stts_cd
-                           cntvnst_stts_cd
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 a
-                              total_transfers
-                           total_transfers
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 a
-                              ce_notes
-                           ce_notes
-                     TOK_WHERE
-                        TOK_FUNCTION
-                           TOK_ISNOTNULL
-                           .
-                              TOK_TABLE_OR_COL
-                                 a
-                              contact_event_id
-               $hdt$_0
-            TOK_SUBQUERY
-               TOK_QUERY
-                  TOK_FROM
-                     TOK_TABREF
-                        TOK_TABNAME
-                           default
-                           service_request_clean
-                        b
-                  TOK_INSERT
-                     TOK_DESTINATION
-                        TOK_DIR
-                           TOK_TMP_FILE
-                     TOK_SELECT
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 b
-                              cnctevn_id
-                           cnctevn_id
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 b
-                              svcrqst_id
-                           svcrqst_id
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 b
-                              cnctmd_cd
-                           cnctmd_cd
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 b
-                              svcrtyp_cd
-                           svcrtyp_cd
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 b
-                              cmpltyp_cd
-                           cmpltyp_cd
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 b
-                              sum_reason_cd
-                           sum_reason_cd
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 b
-                              svcrqct_cds
-                           svcrqct_cds
-                        TOK_SELEXPR
-                           .
-                              TOK_TABLE_OR_COL
-                                 b
-                              notes
-                           notes
-                     TOK_WHERE
-                        TOK_FUNCTION
-                           TOK_ISNOTNULL
-                           .
-                              TOK_TABLE_OR_COL
-                                 b
-                              cnctevn_id
-               $hdt$_1
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_0
-                  contact_event_id
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_1
-                  cnctevn_id
-      TOK_INSERT
-         TOK_DESTINATION
-            TOK_DIR
-               TOK_TMP_FILE
-         TOK_SELECT
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_0
-                  contact_event_id
-               a.contact_event_id
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_0
-                  ce_create_dt
-               a.ce_create_dt
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_0
-                  ce_end_dt
-               a.ce_end_dt
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_0
-                  contact_type
-               a.contact_type
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_0
-                  cnctevs_cd
-               a.cnctevs_cd
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_0
-                  contact_mode
-               a.contact_mode
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_0
-                  cntvnst_stts_cd
-               a.cntvnst_stts_cd
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_0
-                  total_transfers
-               a.total_transfers
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_0
-                  ce_notes
-               a.ce_notes
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_1
-                  svcrqst_id
-               b.svcrqst_id
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_1
-                  svcrqct_cds
-               b.svcrqct_cds
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_1
-                  svcrtyp_cd
-               b.svcrtyp_cd
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_1
-                  cmpltyp_cd
-               b.cmpltyp_cd
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_1
-                  sum_reason_cd
-               src
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_1
-                  cnctmd_cd
-               b.cnctmd_cd
-            TOK_SELEXPR
-               .
-                  TOK_TABLE_OR_COL
-                     $hdt$_1
-                  notes
-               b.notes
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/tez/transform_ppr1.q.out b/ql/src/test/results/clientpositive/tez/transform_ppr1.q.out
index 92d1f4c881..5d7374fc94 100644
--- a/ql/src/test/results/clientpositive/tez/transform_ppr1.q.out
+++ b/ql/src/test/results/clientpositive/tez/transform_ppr1.q.out
@@ -20,81 +20,6 @@ FROM (
 ) tmap
 SELECT tmap.tkey, tmap.tvalue WHERE tmap.tkey < 100 AND tmap.ds = '2008-04-08'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_QUERY
-            TOK_FROM
-               TOK_TABREF
-                  TOK_TABNAME
-                     srcpart
-                  src
-            TOK_INSERT
-               TOK_DESTINATION
-                  TOK_DIR
-                     TOK_TMP_FILE
-               TOK_SELECT
-                  TOK_SELEXPR
-                     TOK_TRANSFORM
-                        TOK_EXPLIST
-                           .
-                              TOK_TABLE_OR_COL
-                                 src
-                              ds
-                           .
-                              TOK_TABLE_OR_COL
-                                 src
-                              key
-                           .
-                              TOK_TABLE_OR_COL
-                                 src
-                              value
-                        TOK_SERDE
-                        TOK_RECORDWRITER
-                        'cat'
-                        TOK_SERDE
-                        TOK_RECORDREADER
-                        TOK_ALIASLIST
-                           ds
-                           tkey
-                           tvalue
-               TOK_CLUSTERBY
-                  TOK_TABLE_OR_COL
-                     tkey
-         tmap
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  tmap
-               tkey
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  tmap
-               tvalue
-      TOK_WHERE
-         AND
-            <
-               .
-                  TOK_TABLE_OR_COL
-                     tmap
-                  tkey
-               100
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     tmap
-                  ds
-               '2008-04-08'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/tez/transform_ppr2.q.out b/ql/src/test/results/clientpositive/tez/transform_ppr2.q.out
index c131bbea1d..4d74124f11 100644
--- a/ql/src/test/results/clientpositive/tez/transform_ppr2.q.out
+++ b/ql/src/test/results/clientpositive/tez/transform_ppr2.q.out
@@ -22,81 +22,6 @@ FROM (
 ) tmap
 SELECT tmap.tkey, tmap.tvalue WHERE tmap.tkey < 100
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_QUERY
-            TOK_FROM
-               TOK_TABREF
-                  TOK_TABNAME
-                     srcpart
-                  src
-            TOK_INSERT
-               TOK_DESTINATION
-                  TOK_DIR
-                     TOK_TMP_FILE
-               TOK_SELECT
-                  TOK_SELEXPR
-                     TOK_TRANSFORM
-                        TOK_EXPLIST
-                           .
-                              TOK_TABLE_OR_COL
-                                 src
-                              ds
-                           .
-                              TOK_TABLE_OR_COL
-                                 src
-                              key
-                           .
-                              TOK_TABLE_OR_COL
-                                 src
-                              value
-                        TOK_SERDE
-                        TOK_RECORDWRITER
-                        'cat'
-                        TOK_SERDE
-                        TOK_RECORDREADER
-                        TOK_ALIASLIST
-                           ds
-                           tkey
-                           tvalue
-               TOK_WHERE
-                  =
-                     .
-                        TOK_TABLE_OR_COL
-                           src
-                        ds
-                     '2008-04-08'
-               TOK_CLUSTERBY
-                  TOK_TABLE_OR_COL
-                     tkey
-         tmap
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  tmap
-               tkey
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  tmap
-               tvalue
-      TOK_WHERE
-         <
-            .
-               TOK_TABLE_OR_COL
-                  tmap
-               tkey
-            100
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/tez/unionDistinct_1.q.out b/ql/src/test/results/clientpositive/tez/unionDistinct_1.q.out
index bef2365453..ee330864ef 100644
--- a/ql/src/test/results/clientpositive/tez/unionDistinct_1.q.out
+++ b/ql/src/test/results/clientpositive/tez/unionDistinct_1.q.out
@@ -6456,157 +6456,6 @@ where a.k1 > 20
 )
 subq
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_QUERY
-            TOK_FROM
-               TOK_SUBQUERY
-                  TOK_UNIONALL
-                     TOK_QUERY
-                        TOK_FROM
-                           TOK_TABREF
-                              TOK_TABNAME
-                                 dst_union22_delta
-                        TOK_INSERT
-                           TOK_DESTINATION
-                              TOK_DIR
-                                 TOK_TMP_FILE
-                           TOK_SELECT
-                              TOK_SELEXPR
-                                 TOK_TABLE_OR_COL
-                                    k1
-                                 k1
-                              TOK_SELEXPR
-                                 TOK_TABLE_OR_COL
-                                    k2
-                                 k2
-                              TOK_SELEXPR
-                                 TOK_TABLE_OR_COL
-                                    k3
-                                 k3
-                              TOK_SELEXPR
-                                 TOK_TABLE_OR_COL
-                                    k4
-                                 k4
-                           TOK_WHERE
-                              and
-                                 =
-                                    TOK_TABLE_OR_COL
-                                       ds
-                                    '1'
-                                 <=
-                                    TOK_TABLE_OR_COL
-                                       k0
-                                    50
-                     TOK_QUERY
-                        TOK_FROM
-                           TOK_LEFTOUTERJOIN
-                              TOK_TABREF
-                                 TOK_TABNAME
-                                    dst_union22
-                                 a
-                              TOK_SUBQUERY
-                                 TOK_QUERY
-                                    TOK_FROM
-                                       TOK_TABREF
-                                          TOK_TABNAME
-                                             dst_union22_delta
-                                    TOK_INSERT
-                                       TOK_DESTINATION
-                                          TOK_DIR
-                                             TOK_TMP_FILE
-                                       TOK_SELECT
-                                          TOK_SELEXPR
-                                             TOK_ALLCOLREF
-                                       TOK_WHERE
-                                          and
-                                             =
-                                                TOK_TABLE_OR_COL
-                                                   ds
-                                                '1'
-                                             >
-                                                TOK_TABLE_OR_COL
-                                                   k0
-                                                50
-                                 b
-                              and
-                                 =
-                                    .
-                                       TOK_TABLE_OR_COL
-                                          a
-                                       k1
-                                    .
-                                       TOK_TABLE_OR_COL
-                                          b
-                                       k1
-                                 =
-                                    .
-                                       TOK_TABLE_OR_COL
-                                          a
-                                       ds
-                                    '1'
-                        TOK_INSERT
-                           TOK_DESTINATION
-                              TOK_DIR
-                                 TOK_TMP_FILE
-                           TOK_SELECT
-                              TOK_SELEXPR
-                                 .
-                                    TOK_TABLE_OR_COL
-                                       a
-                                    k1
-                                 k1
-                              TOK_SELEXPR
-                                 .
-                                    TOK_TABLE_OR_COL
-                                       a
-                                    k2
-                                 k2
-                              TOK_SELEXPR
-                                 .
-                                    TOK_TABLE_OR_COL
-                                       b
-                                    k3
-                                 k3
-                              TOK_SELEXPR
-                                 .
-                                    TOK_TABLE_OR_COL
-                                       b
-                                    k4
-                                 k4
-                           TOK_WHERE
-                              >
-                                 .
-                                    TOK_TABLE_OR_COL
-                                       a
-                                    k1
-                                 20
-                  _u1
-            TOK_INSERT
-               TOK_DESTINATION
-                  TOK_DIR
-                     TOK_TMP_FILE
-               TOK_SELECTDI
-                  TOK_SELEXPR
-                     TOK_ALLCOLREF
-         subq
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dst_union22
-            TOK_PARTSPEC
-               TOK_PARTVAL
-                  ds
-                  '2'
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -7838,154 +7687,6 @@ select s.key, s.count from (
   select key, count(1) as count from src5 where key < 10 group by key
 )s
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_QUERY
-            TOK_FROM
-               TOK_SUBQUERY
-                  TOK_UNIONALL
-                     TOK_QUERY
-                        TOK_FROM
-                           TOK_SUBQUERY
-                              TOK_UNIONALL
-                                 TOK_QUERY
-                                    TOK_FROM
-                                       TOK_SUBQUERY
-                                          TOK_UNIONALL
-                                             TOK_QUERY
-                                                TOK_FROM
-                                                   TOK_TABREF
-                                                      TOK_TABNAME
-                                                         src2
-                                                TOK_INSERT
-                                                   TOK_DESTINATION
-                                                      TOK_DIR
-                                                         TOK_TMP_FILE
-                                                   TOK_SELECT
-                                                      TOK_SELEXPR
-                                                         TOK_TABLE_OR_COL
-                                                            key
-                                                      TOK_SELEXPR
-                                                         TOK_TABLE_OR_COL
-                                                            count
-                                                   TOK_WHERE
-                                                      <
-                                                         TOK_TABLE_OR_COL
-                                                            key
-                                                         10
-                                             TOK_QUERY
-                                                TOK_FROM
-                                                   TOK_TABREF
-                                                      TOK_TABNAME
-                                                         src3
-                                                TOK_INSERT
-                                                   TOK_DESTINATION
-                                                      TOK_DIR
-                                                         TOK_TMP_FILE
-                                                   TOK_SELECT
-                                                      TOK_SELEXPR
-                                                         TOK_TABLE_OR_COL
-                                                            key
-                                                      TOK_SELEXPR
-                                                         TOK_TABLE_OR_COL
-                                                            count
-                                                   TOK_WHERE
-                                                      <
-                                                         TOK_TABLE_OR_COL
-                                                            key
-                                                         10
-                                          _u1
-                                    TOK_INSERT
-                                       TOK_DESTINATION
-                                          TOK_DIR
-                                             TOK_TMP_FILE
-                                       TOK_SELECTDI
-                                          TOK_SELEXPR
-                                             TOK_ALLCOLREF
-                                 TOK_QUERY
-                                    TOK_FROM
-                                       TOK_TABREF
-                                          TOK_TABNAME
-                                             src4
-                                    TOK_INSERT
-                                       TOK_DESTINATION
-                                          TOK_DIR
-                                             TOK_TMP_FILE
-                                       TOK_SELECT
-                                          TOK_SELEXPR
-                                             TOK_TABLE_OR_COL
-                                                key
-                                          TOK_SELEXPR
-                                             TOK_TABLE_OR_COL
-                                                count
-                                       TOK_WHERE
-                                          <
-                                             TOK_TABLE_OR_COL
-                                                key
-                                             10
-                              _u2
-                        TOK_INSERT
-                           TOK_DESTINATION
-                              TOK_DIR
-                                 TOK_TMP_FILE
-                           TOK_SELECTDI
-                              TOK_SELEXPR
-                                 TOK_ALLCOLREF
-                     TOK_QUERY
-                        TOK_FROM
-                           TOK_TABREF
-                              TOK_TABNAME
-                                 src5
-                        TOK_INSERT
-                           TOK_DESTINATION
-                              TOK_DIR
-                                 TOK_TMP_FILE
-                           TOK_SELECT
-                              TOK_SELEXPR
-                                 TOK_TABLE_OR_COL
-                                    key
-                              TOK_SELEXPR
-                                 TOK_FUNCTION
-                                    count
-                                    1
-                                 count
-                           TOK_WHERE
-                              <
-                                 TOK_TABLE_OR_COL
-                                    key
-                                 10
-                           TOK_GROUPBY
-                              TOK_TABLE_OR_COL
-                                 key
-                  _u3
-            TOK_INSERT
-               TOK_DESTINATION
-                  TOK_DIR
-                     TOK_TMP_FILE
-               TOK_SELECTDI
-                  TOK_SELEXPR
-                     TOK_ALLCOLREF
-         s
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  s
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  s
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -8473,139 +8174,6 @@ select s.key, s.count from (
   select a.key as key, b.count as count from src4 a join src5 b on a.key=b.key where a.key < 10
 )s
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_QUERY
-            TOK_FROM
-               TOK_SUBQUERY
-                  TOK_UNIONALL
-                     TOK_QUERY
-                        TOK_FROM
-                           TOK_SUBQUERY
-                              TOK_UNIONALL
-                                 TOK_QUERY
-                                    TOK_FROM
-                                       TOK_TABREF
-                                          TOK_TABNAME
-                                             src2
-                                    TOK_INSERT
-                                       TOK_DESTINATION
-                                          TOK_DIR
-                                             TOK_TMP_FILE
-                                       TOK_SELECT
-                                          TOK_SELEXPR
-                                             TOK_TABLE_OR_COL
-                                                key
-                                          TOK_SELEXPR
-                                             TOK_TABLE_OR_COL
-                                                count
-                                       TOK_WHERE
-                                          <
-                                             TOK_TABLE_OR_COL
-                                                key
-                                             10
-                                 TOK_QUERY
-                                    TOK_FROM
-                                       TOK_TABREF
-                                          TOK_TABNAME
-                                             src3
-                                    TOK_INSERT
-                                       TOK_DESTINATION
-                                          TOK_DIR
-                                             TOK_TMP_FILE
-                                       TOK_SELECT
-                                          TOK_SELEXPR
-                                             TOK_TABLE_OR_COL
-                                                key
-                                          TOK_SELEXPR
-                                             TOK_TABLE_OR_COL
-                                                count
-                                       TOK_WHERE
-                                          <
-                                             TOK_TABLE_OR_COL
-                                                key
-                                             10
-                              _u1
-                        TOK_INSERT
-                           TOK_DESTINATION
-                              TOK_DIR
-                                 TOK_TMP_FILE
-                           TOK_SELECTDI
-                              TOK_SELEXPR
-                                 TOK_ALLCOLREF
-                     TOK_QUERY
-                        TOK_FROM
-                           TOK_JOIN
-                              TOK_TABREF
-                                 TOK_TABNAME
-                                    src4
-                                 a
-                              TOK_TABREF
-                                 TOK_TABNAME
-                                    src5
-                                 b
-                              =
-                                 .
-                                    TOK_TABLE_OR_COL
-                                       a
-                                    key
-                                 .
-                                    TOK_TABLE_OR_COL
-                                       b
-                                    key
-                        TOK_INSERT
-                           TOK_DESTINATION
-                              TOK_DIR
-                                 TOK_TMP_FILE
-                           TOK_SELECT
-                              TOK_SELEXPR
-                                 .
-                                    TOK_TABLE_OR_COL
-                                       a
-                                    key
-                                 key
-                              TOK_SELEXPR
-                                 .
-                                    TOK_TABLE_OR_COL
-                                       b
-                                    count
-                                 count
-                           TOK_WHERE
-                              <
-                                 .
-                                    TOK_TABLE_OR_COL
-                                       a
-                                    key
-                                 10
-                  _u2
-            TOK_INSERT
-               TOK_DESTINATION
-                  TOK_DIR
-                     TOK_TMP_FILE
-               TOK_SELECTDI
-                  TOK_SELEXPR
-                     TOK_ALLCOLREF
-         s
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  s
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  s
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -9051,143 +8619,6 @@ select s.key, s.count from (
   select a.key as key, count(1) as count from src4 a join src5 b on a.key=b.key where a.key < 10 group by a.key
 )s
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_QUERY
-            TOK_FROM
-               TOK_SUBQUERY
-                  TOK_UNIONALL
-                     TOK_QUERY
-                        TOK_FROM
-                           TOK_SUBQUERY
-                              TOK_UNIONALL
-                                 TOK_QUERY
-                                    TOK_FROM
-                                       TOK_TABREF
-                                          TOK_TABNAME
-                                             src2
-                                    TOK_INSERT
-                                       TOK_DESTINATION
-                                          TOK_DIR
-                                             TOK_TMP_FILE
-                                       TOK_SELECT
-                                          TOK_SELEXPR
-                                             TOK_TABLE_OR_COL
-                                                key
-                                          TOK_SELEXPR
-                                             TOK_TABLE_OR_COL
-                                                count
-                                       TOK_WHERE
-                                          <
-                                             TOK_TABLE_OR_COL
-                                                key
-                                             10
-                                 TOK_QUERY
-                                    TOK_FROM
-                                       TOK_TABREF
-                                          TOK_TABNAME
-                                             src3
-                                    TOK_INSERT
-                                       TOK_DESTINATION
-                                          TOK_DIR
-                                             TOK_TMP_FILE
-                                       TOK_SELECT
-                                          TOK_SELEXPR
-                                             TOK_TABLE_OR_COL
-                                                key
-                                          TOK_SELEXPR
-                                             TOK_TABLE_OR_COL
-                                                count
-                                       TOK_WHERE
-                                          <
-                                             TOK_TABLE_OR_COL
-                                                key
-                                             10
-                              _u1
-                        TOK_INSERT
-                           TOK_DESTINATION
-                              TOK_DIR
-                                 TOK_TMP_FILE
-                           TOK_SELECTDI
-                              TOK_SELEXPR
-                                 TOK_ALLCOLREF
-                     TOK_QUERY
-                        TOK_FROM
-                           TOK_JOIN
-                              TOK_TABREF
-                                 TOK_TABNAME
-                                    src4
-                                 a
-                              TOK_TABREF
-                                 TOK_TABNAME
-                                    src5
-                                 b
-                              =
-                                 .
-                                    TOK_TABLE_OR_COL
-                                       a
-                                    key
-                                 .
-                                    TOK_TABLE_OR_COL
-                                       b
-                                    key
-                        TOK_INSERT
-                           TOK_DESTINATION
-                              TOK_DIR
-                                 TOK_TMP_FILE
-                           TOK_SELECT
-                              TOK_SELEXPR
-                                 .
-                                    TOK_TABLE_OR_COL
-                                       a
-                                    key
-                                 key
-                              TOK_SELEXPR
-                                 TOK_FUNCTION
-                                    count
-                                    1
-                                 count
-                           TOK_WHERE
-                              <
-                                 .
-                                    TOK_TABLE_OR_COL
-                                       a
-                                    key
-                                 10
-                           TOK_GROUPBY
-                              .
-                                 TOK_TABLE_OR_COL
-                                    a
-                                 key
-                  _u2
-            TOK_INSERT
-               TOK_DESTINATION
-                  TOK_DIR
-                     TOK_TMP_FILE
-               TOK_SELECTDI
-                  TOK_SELEXPR
-                     TOK_ALLCOLREF
-         s
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  s
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  s
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/tez/vectorized_ptf.q.out b/ql/src/test/results/clientpositive/tez/vectorized_ptf.q.out
index 3d1f22ff64..1365626a29 100644
--- a/ql/src/test/results/clientpositive/tez/vectorized_ptf.q.out
+++ b/ql/src/test/results/clientpositive/tez/vectorized_ptf.q.out
@@ -142,88 +142,6 @@ from noop(on part_orc
   order by p_name
   )
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noop
-         TOK_TABREF
-            TOK_TABNAME
-               part_orc
-         TOK_PARTITIONINGSPEC
-            TOK_DISTRIBUTEBY
-               TOK_TABLE_OR_COL
-                  p_mfgr
-            TOK_ORDERBY
-               TOK_TABSORTCOLNAMEASC
-                  TOK_NULLS_FIRST
-                     TOK_TABLE_OR_COL
-                        p_name
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            TOK_FUNCTION
-               rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            r
-         TOK_SELEXPR
-            TOK_FUNCTION
-               dense_rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            dr
-         TOK_SELEXPR
-            TOK_FUNCTION
-               sum
-               TOK_TABLE_OR_COL
-                  p_retailprice
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-                  TOK_WINDOWRANGE
-                     preceding
-                        unbounded
-                     current
-            s1
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -472,94 +390,6 @@ from noop (on (select p1.* from part_orc p1 join part_orc p2 on p1.p_partkey = p
 distribute by j.p_mfgr
 sort by j.p_name)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noop
-         TOK_SUBQUERY
-            TOK_QUERY
-               TOK_FROM
-                  TOK_JOIN
-                     TOK_TABREF
-                        TOK_TABNAME
-                           part_orc
-                        p1
-                     TOK_TABREF
-                        TOK_TABNAME
-                           part_orc
-                        p2
-                     =
-                        .
-                           TOK_TABLE_OR_COL
-                              p1
-                           p_partkey
-                        .
-                           TOK_TABLE_OR_COL
-                              p2
-                           p_partkey
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_ALLCOLREF
-                           TOK_TABNAME
-                              p1
-            j
-         TOK_PARTITIONINGSPEC
-            TOK_DISTRIBUTEBY
-               .
-                  TOK_TABLE_OR_COL
-                     j
-                  p_mfgr
-            TOK_SORTBY
-               TOK_TABSORTCOLNAMEASC
-                  TOK_NULLS_FIRST
-                     .
-                        TOK_TABLE_OR_COL
-                           j
-                        p_name
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            -
-               TOK_TABLE_OR_COL
-                  p_size
-               TOK_FUNCTION
-                  lag
-                  TOK_TABLE_OR_COL
-                     p_size
-                  1
-                  TOK_TABLE_OR_COL
-                     p_size
-                  TOK_WINDOWSPEC
-                     TOK_PARTITIONINGSPEC
-                        TOK_DISTRIBUTEBY
-                           TOK_TABLE_OR_COL
-                              p_mfgr
-                        TOK_ORDERBY
-                           TOK_TABSORTCOLNAMEASC
-                              TOK_NULLS_FIRST
-                                 TOK_TABLE_OR_COL
-                                    p_name
-            deltaSz
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -883,40 +713,6 @@ from noop(on part_orc
 partition by p_mfgr
 order by p_name)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noop
-         TOK_TABREF
-            TOK_TABNAME
-               part_orc
-         TOK_PARTITIONINGSPEC
-            TOK_DISTRIBUTEBY
-               TOK_TABLE_OR_COL
-                  p_mfgr
-            TOK_ORDERBY
-               TOK_TABSORTCOLNAMEASC
-                  TOK_NULLS_FIRST
-                     TOK_TABLE_OR_COL
-                        p_name
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1112,89 +908,6 @@ from noop(on part_orc
   order by p_name
   ) abc
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noop
-         abc
-         TOK_TABREF
-            TOK_TABNAME
-               part_orc
-         TOK_PARTITIONINGSPEC
-            TOK_DISTRIBUTEBY
-               TOK_TABLE_OR_COL
-                  p_mfgr
-            TOK_ORDERBY
-               TOK_TABSORTCOLNAMEASC
-                  TOK_NULLS_FIRST
-                     TOK_TABLE_OR_COL
-                        p_name
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            TOK_FUNCTION
-               rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            r
-         TOK_SELEXPR
-            TOK_FUNCTION
-               dense_rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            dr
-         TOK_SELEXPR
-            TOK_FUNCTION
-               sum
-               TOK_TABLE_OR_COL
-                  p_retailprice
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-                  TOK_WINDOWRANGE
-                     preceding
-                        unbounded
-                     current
-            s1
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1449,93 +1162,6 @@ from noop(on part_orc
           order by p_name 
           )
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noop
-         TOK_TABREF
-            TOK_TABNAME
-               part_orc
-         TOK_PARTITIONINGSPEC
-            TOK_DISTRIBUTEBY
-               TOK_TABLE_OR_COL
-                  p_mfgr
-            TOK_ORDERBY
-               TOK_TABSORTCOLNAMEASC
-                  TOK_NULLS_FIRST
-                     TOK_TABLE_OR_COL
-                        p_name
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            TOK_FUNCTION
-               rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            r
-         TOK_SELEXPR
-            TOK_FUNCTION
-               dense_rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            dr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            -
-               TOK_TABLE_OR_COL
-                  p_size
-               TOK_FUNCTION
-                  lag
-                  TOK_TABLE_OR_COL
-                     p_size
-                  1
-                  TOK_TABLE_OR_COL
-                     p_size
-                  TOK_WINDOWSPEC
-                     TOK_PARTITIONINGSPEC
-                        TOK_DISTRIBUTEBY
-                           TOK_TABLE_OR_COL
-                              p_mfgr
-                        TOK_ORDERBY
-                           TOK_TABSORTCOLNAMEASC
-                              TOK_NULLS_FIRST
-                                 TOK_TABLE_OR_COL
-                                    p_name
-            deltaSz
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1793,100 +1419,6 @@ from noop(on part_orc
           ) 
 group by p_mfgr, p_name, p_size
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noop
-         TOK_TABREF
-            TOK_TABNAME
-               part_orc
-         TOK_PARTITIONINGSPEC
-            TOK_DISTRIBUTEBY
-               TOK_TABLE_OR_COL
-                  p_mfgr
-            TOK_ORDERBY
-               TOK_TABSORTCOLNAMEASC
-                  TOK_NULLS_FIRST
-                     TOK_TABLE_OR_COL
-                        p_name
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            TOK_FUNCTION
-               rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            r
-         TOK_SELEXPR
-            TOK_FUNCTION
-               dense_rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            dr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            -
-               TOK_TABLE_OR_COL
-                  p_size
-               TOK_FUNCTION
-                  lag
-                  TOK_TABLE_OR_COL
-                     p_size
-                  1
-                  TOK_TABLE_OR_COL
-                     p_size
-                  TOK_WINDOWSPEC
-                     TOK_PARTITIONINGSPEC
-                        TOK_DISTRIBUTEBY
-                           TOK_TABLE_OR_COL
-                              p_mfgr
-                        TOK_ORDERBY
-                           TOK_TABSORTCOLNAMEASC
-                              TOK_NULLS_FIRST
-                                 TOK_TABLE_OR_COL
-                                    p_name
-            deltaSz
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            p_mfgr
-         TOK_TABLE_OR_COL
-            p_name
-         TOK_TABLE_OR_COL
-            p_size
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -2146,50 +1678,6 @@ partition by p_mfgr
 order by p_name 
 ) abc join part_orc p1 on abc.p_partkey = p1.p_partkey
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_PTBLFUNCTION
-            noop
-            abc
-            TOK_TABREF
-               TOK_TABNAME
-                  part_orc
-            TOK_PARTITIONINGSPEC
-               TOK_DISTRIBUTEBY
-                  TOK_TABLE_OR_COL
-                     p_mfgr
-               TOK_ORDERBY
-                  TOK_TABSORTCOLNAMEASC
-                     TOK_NULLS_FIRST
-                        TOK_TABLE_OR_COL
-                           p_name
-         TOK_TABREF
-            TOK_TABNAME
-               part_orc
-            p1
-         =
-            .
-               TOK_TABLE_OR_COL
-                  abc
-               p_partkey
-            .
-               TOK_TABLE_OR_COL
-                  p1
-               p_partkey
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-               TOK_TABNAME
-                  abc
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -2473,50 +1961,6 @@ partition by p_mfgr
 order by p_name 
 ) abc on abc.p_partkey = p1.p_partkey
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               part_orc
-            p1
-         TOK_PTBLFUNCTION
-            noop
-            abc
-            TOK_TABREF
-               TOK_TABNAME
-                  part_orc
-            TOK_PARTITIONINGSPEC
-               TOK_DISTRIBUTEBY
-                  TOK_TABLE_OR_COL
-                     p_mfgr
-               TOK_ORDERBY
-                  TOK_TABSORTCOLNAMEASC
-                     TOK_NULLS_FIRST
-                        TOK_TABLE_OR_COL
-                           p_name
-         =
-            .
-               TOK_TABLE_OR_COL
-                  abc
-               p_partkey
-            .
-               TOK_TABLE_OR_COL
-                  p1
-               p_partkey
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-               TOK_TABNAME
-                  abc
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -2804,62 +2248,6 @@ from noopwithmap(on part_orc
 partition by p_mfgr
 order by p_name, p_size desc)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noopwithmap
-         TOK_TABREF
-            TOK_TABNAME
-               part_orc
-         TOK_PARTITIONINGSPEC
-            TOK_DISTRIBUTEBY
-               TOK_TABLE_OR_COL
-                  p_mfgr
-            TOK_ORDERBY
-               TOK_TABSORTCOLNAMEASC
-                  TOK_NULLS_FIRST
-                     TOK_TABLE_OR_COL
-                        p_name
-               TOK_TABSORTCOLNAMEDESC
-                  TOK_NULLS_LAST
-                     TOK_TABLE_OR_COL
-                        p_size
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            TOK_FUNCTION
-               rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-                        TOK_TABSORTCOLNAMEDESC
-                           TOK_NULLS_LAST
-                              TOK_TABLE_OR_COL
-                                 p_size
-            r
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -3107,88 +2495,6 @@ from noopwithmap(on part_orc
   partition by p_mfgr
   order by p_name)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noopwithmap
-         TOK_TABREF
-            TOK_TABNAME
-               part_orc
-         TOK_PARTITIONINGSPEC
-            TOK_DISTRIBUTEBY
-               TOK_TABLE_OR_COL
-                  p_mfgr
-            TOK_ORDERBY
-               TOK_TABSORTCOLNAMEASC
-                  TOK_NULLS_FIRST
-                     TOK_TABLE_OR_COL
-                        p_name
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            TOK_FUNCTION
-               rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            r
-         TOK_SELEXPR
-            TOK_FUNCTION
-               dense_rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            dr
-         TOK_SELEXPR
-            TOK_FUNCTION
-               sum
-               TOK_TABLE_OR_COL
-                  p_retailprice
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-                  TOK_WINDOWRANGE
-                     preceding
-                        unbounded
-                     current
-            s1
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -3455,88 +2761,6 @@ from noop(on part_orc
 partition by p_mfgr
 order by p_name)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noop
-         TOK_TABREF
-            TOK_TABNAME
-               part_orc
-         TOK_PARTITIONINGSPEC
-            TOK_DISTRIBUTEBY
-               TOK_TABLE_OR_COL
-                  p_mfgr
-            TOK_ORDERBY
-               TOK_TABSORTCOLNAMEASC
-                  TOK_NULLS_FIRST
-                     TOK_TABLE_OR_COL
-                        p_name
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            TOK_FUNCTION
-               rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            r
-         TOK_SELEXPR
-            TOK_FUNCTION
-               dense_rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            dr
-         TOK_SELEXPR
-            TOK_FUNCTION
-               sum
-               TOK_TABLE_OR_COL
-                  p_retailprice
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-                  TOK_WINDOWRANGE
-                     preceding
-                        unbounded
-                     current
-            s1
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -3789,96 +3013,6 @@ partition by p_mfgr
 order by p_mfgr, p_name
 )))
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noop
-         TOK_PTBLFUNCTION
-            noopwithmap
-            TOK_PTBLFUNCTION
-               noop
-               TOK_TABREF
-                  TOK_TABNAME
-                     part_orc
-               TOK_PARTITIONINGSPEC
-                  TOK_DISTRIBUTEBY
-                     TOK_TABLE_OR_COL
-                        p_mfgr
-                  TOK_ORDERBY
-                     TOK_TABSORTCOLNAMEASC
-                        TOK_NULLS_FIRST
-                           TOK_TABLE_OR_COL
-                              p_mfgr
-                     TOK_TABSORTCOLNAMEASC
-                        TOK_NULLS_FIRST
-                           TOK_TABLE_OR_COL
-                              p_name
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            TOK_FUNCTION
-               rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            r
-         TOK_SELEXPR
-            TOK_FUNCTION
-               dense_rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            dr
-         TOK_SELEXPR
-            TOK_FUNCTION
-               sum
-               TOK_TABLE_OR_COL
-                  p_retailprice
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-                  TOK_WINDOWRANGE
-                     preceding
-                        unbounded
-                     current
-            s1
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -4201,107 +3335,6 @@ order by p_name)
 window w1 as (partition by p_mfgr order by p_name rows between 2 preceding and 2 following) 
 ) sub1
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_QUERY
-            TOK_FROM
-               TOK_PTBLFUNCTION
-                  noop
-                  TOK_TABREF
-                     TOK_TABNAME
-                        part_orc
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            TOK_INSERT
-               TOK_DESTINATION
-                  TOK_DIR
-                     TOK_TMP_FILE
-               TOK_SELECT
-                  TOK_SELEXPR
-                     TOK_TABLE_OR_COL
-                        p_mfgr
-                  TOK_SELEXPR
-                     TOK_TABLE_OR_COL
-                        p_name
-                  TOK_SELEXPR
-                     TOK_FUNCTION
-                        count
-                        TOK_TABLE_OR_COL
-                           p_size
-                        TOK_WINDOWSPEC
-                           TOK_PARTITIONINGSPEC
-                              TOK_DISTRIBUTEBY
-                                 TOK_TABLE_OR_COL
-                                    p_mfgr
-                              TOK_ORDERBY
-                                 TOK_TABSORTCOLNAMEASC
-                                    TOK_NULLS_FIRST
-                                       TOK_TABLE_OR_COL
-                                          p_name
-                     cd
-                  TOK_SELEXPR
-                     TOK_TABLE_OR_COL
-                        p_retailprice
-                  TOK_SELEXPR
-                     TOK_FUNCTION
-                        sum
-                        TOK_TABLE_OR_COL
-                           p_retailprice
-                        TOK_WINDOWSPEC
-                           w1
-                     s1
-               window
-                  TOK_WINDOWDEF
-                     w1
-                     TOK_WINDOWSPEC
-                        TOK_PARTITIONINGSPEC
-                           TOK_DISTRIBUTEBY
-                              TOK_TABLE_OR_COL
-                                 p_mfgr
-                           TOK_ORDERBY
-                              TOK_TABSORTCOLNAMEASC
-                                 TOK_NULLS_FIRST
-                                    TOK_TABLE_OR_COL
-                                       p_name
-                        TOK_WINDOWRANGE
-                           preceding
-                              2
-                           following
-                              2
-         sub1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  sub1
-               cd
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  sub1
-               s1
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -4558,182 +3591,6 @@ partition by p_mfgr
 order by p_name 
 ) abc join part_orc p1 on abc.p_partkey = p1.p_partkey
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_PTBLFUNCTION
-            noop
-            abc
-            TOK_TABREF
-               TOK_TABNAME
-                  part_orc
-            TOK_PARTITIONINGSPEC
-               TOK_DISTRIBUTEBY
-                  TOK_TABLE_OR_COL
-                     p_mfgr
-               TOK_ORDERBY
-                  TOK_TABSORTCOLNAMEASC
-                     TOK_NULLS_FIRST
-                        TOK_TABLE_OR_COL
-                           p_name
-         TOK_TABREF
-            TOK_TABNAME
-               part_orc
-            p1
-         =
-            .
-               TOK_TABLE_OR_COL
-                  abc
-               p_partkey
-            .
-               TOK_TABLE_OR_COL
-                  p1
-               p_partkey
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  abc
-               p_mfgr
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  abc
-               p_name
-         TOK_SELEXPR
-            TOK_FUNCTION
-               rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        .
-                           TOK_TABLE_OR_COL
-                              abc
-                           p_mfgr
-                     TOK_SORTBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              .
-                                 TOK_TABLE_OR_COL
-                                    abc
-                                 p_name
-            r
-         TOK_SELEXPR
-            TOK_FUNCTION
-               dense_rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        .
-                           TOK_TABLE_OR_COL
-                              abc
-                           p_mfgr
-                     TOK_SORTBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              .
-                                 TOK_TABLE_OR_COL
-                                    abc
-                                 p_name
-            dr
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               .
-                  TOK_TABLE_OR_COL
-                     abc
-                  p_name
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        .
-                           TOK_TABLE_OR_COL
-                              abc
-                           p_mfgr
-                     TOK_SORTBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              .
-                                 TOK_TABLE_OR_COL
-                                    abc
-                                 p_name
-            cd
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  abc
-               p_retailprice
-         TOK_SELEXPR
-            TOK_FUNCTION
-               sum
-               .
-                  TOK_TABLE_OR_COL
-                     abc
-                  p_retailprice
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        .
-                           TOK_TABLE_OR_COL
-                              abc
-                           p_mfgr
-                     TOK_SORTBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              .
-                                 TOK_TABLE_OR_COL
-                                    abc
-                                 p_name
-                  TOK_WINDOWRANGE
-                     preceding
-                        unbounded
-                     current
-            s1
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  abc
-               p_size
-         TOK_SELEXPR
-            -
-               .
-                  TOK_TABLE_OR_COL
-                     abc
-                  p_size
-               TOK_FUNCTION
-                  lag
-                  .
-                     TOK_TABLE_OR_COL
-                        abc
-                     p_size
-                  1
-                  .
-                     TOK_TABLE_OR_COL
-                        abc
-                     p_size
-                  TOK_WINDOWSPEC
-                     TOK_PARTITIONINGSPEC
-                        TOK_DISTRIBUTEBY
-                           .
-                              TOK_TABLE_OR_COL
-                                 abc
-                              p_mfgr
-                        TOK_SORTBY
-                           TOK_TABSORTCOLNAMEASC
-                              TOK_NULLS_FIRST
-                                 .
-                                    TOK_TABLE_OR_COL
-                                       abc
-                                    p_name
-            deltaSz
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -5093,40 +3950,6 @@ from noop(on part_orc
 partition by p_mfgr 
 order by p_name)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noop
-         TOK_TABREF
-            TOK_TABNAME
-               part_orc
-         TOK_PARTITIONINGSPEC
-            TOK_DISTRIBUTEBY
-               TOK_TABLE_OR_COL
-                  p_mfgr
-            TOK_ORDERBY
-               TOK_TABSORTCOLNAMEASC
-                  TOK_NULLS_FIRST
-                     TOK_TABLE_OR_COL
-                        p_name
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECTDI
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -5356,65 +4179,6 @@ partition by p_mfgr
 order by p_mfgr)  
 window w1 as ( partition by p_mfgr order by p_brand rows between 2 preceding and current row)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noop
-         TOK_TABREF
-            TOK_TABNAME
-               mfgr_price_view
-         TOK_PARTITIONINGSPEC
-            TOK_DISTRIBUTEBY
-               TOK_TABLE_OR_COL
-                  p_mfgr
-            TOK_ORDERBY
-               TOK_TABSORTCOLNAMEASC
-                  TOK_NULLS_FIRST
-                     TOK_TABLE_OR_COL
-                        p_mfgr
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_brand
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               s
-         TOK_SELEXPR
-            TOK_FUNCTION
-               sum
-               TOK_TABLE_OR_COL
-                  s
-               TOK_WINDOWSPEC
-                  w1
-            s1
-      window
-         TOK_WINDOWDEF
-            w1
-            TOK_WINDOWSPEC
-               TOK_PARTITIONINGSPEC
-                  TOK_DISTRIBUTEBY
-                     TOK_TABLE_OR_COL
-                        p_mfgr
-                  TOK_ORDERBY
-                     TOK_TABSORTCOLNAMEASC
-                        TOK_NULLS_FIRST
-                           TOK_TABLE_OR_COL
-                              p_brand
-               TOK_WINDOWRANGE
-                  preceding
-                     2
-                  current
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -5709,212 +4473,6 @@ cume_dist() over (distribute by p_mfgr sort by p_mfgr, p_name) as cud,
 first_value(p_size, true) over w1  as fv1
 window w1 as (distribute by p_mfgr sort by p_mfgr, p_name rows between 2 preceding and 2 following)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noop
-         TOK_TABREF
-            TOK_TABNAME
-               part_orc
-         TOK_PARTITIONINGSPEC
-            TOK_DISTRIBUTEBY
-               TOK_TABLE_OR_COL
-                  p_mfgr
-            TOK_ORDERBY
-               TOK_TABSORTCOLNAMEASC
-                  TOK_NULLS_FIRST
-                     TOK_TABLE_OR_COL
-                        p_name
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               part_4
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            TOK_FUNCTION
-               rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_SORTBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            r
-         TOK_SELEXPR
-            TOK_FUNCTION
-               dense_rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_SORTBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            dr
-         TOK_SELEXPR
-            TOK_FUNCTION
-               sum
-               TOK_TABLE_OR_COL
-                  p_retailprice
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_SORTBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-                  TOK_WINDOWRANGE
-                     preceding
-                        unbounded
-                     current
-            s
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               part_5
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            TOK_FUNCTION
-               round
-               TOK_FUNCTION
-                  sum
-                  TOK_TABLE_OR_COL
-                     p_size
-                  TOK_WINDOWSPEC
-                     TOK_PARTITIONINGSPEC
-                        TOK_DISTRIBUTEBY
-                           TOK_TABLE_OR_COL
-                              p_mfgr
-                        TOK_SORTBY
-                           TOK_TABSORTCOLNAMEASC
-                              TOK_NULLS_FIRST
-                                 TOK_TABLE_OR_COL
-                                    p_size
-                     TOK_WINDOWVALUES
-                        preceding
-                           5
-                        current
-               1
-            s2
-         TOK_SELEXPR
-            TOK_FUNCTION
-               rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_SORTBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_mfgr
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            r
-         TOK_SELEXPR
-            TOK_FUNCTION
-               dense_rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_SORTBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_mfgr
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            dr
-         TOK_SELEXPR
-            TOK_FUNCTION
-               cume_dist
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_SORTBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_mfgr
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            cud
-         TOK_SELEXPR
-            TOK_FUNCTION
-               first_value
-               TOK_TABLE_OR_COL
-                  p_size
-               true
-               TOK_WINDOWSPEC
-                  w1
-            fv1
-      window
-         TOK_WINDOWDEF
-            w1
-            TOK_WINDOWSPEC
-               TOK_PARTITIONINGSPEC
-                  TOK_DISTRIBUTEBY
-                     TOK_TABLE_OR_COL
-                        p_mfgr
-                  TOK_SORTBY
-                     TOK_TABSORTCOLNAMEASC
-                        TOK_NULLS_FIRST
-                           TOK_TABLE_OR_COL
-                              p_mfgr
-                     TOK_TABSORTCOLNAMEASC
-                        TOK_NULLS_FIRST
-                           TOK_TABLE_OR_COL
-                              p_name
-               TOK_WINDOWRANGE
-                  preceding
-                     2
-                  following
-                     2
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-3 depends on stages: Stage-2
@@ -6439,115 +4997,6 @@ from noop(on
         partition by p_mfgr,p_name  
         order by p_mfgr,p_name)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noop
-         TOK_PTBLFUNCTION
-            noopwithmap
-            TOK_PTBLFUNCTION
-               noop
-               TOK_PTBLFUNCTION
-                  noop
-                  TOK_TABREF
-                     TOK_TABNAME
-                        part_orc
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_mfgr
-            TOK_PARTITIONINGSPEC
-               TOK_DISTRIBUTEBY
-                  TOK_TABLE_OR_COL
-                     p_mfgr
-                  TOK_TABLE_OR_COL
-                     p_name
-               TOK_ORDERBY
-                  TOK_TABSORTCOLNAMEASC
-                     TOK_NULLS_FIRST
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                  TOK_TABSORTCOLNAMEASC
-                     TOK_NULLS_FIRST
-                        TOK_TABLE_OR_COL
-                           p_name
-         TOK_PARTITIONINGSPEC
-            TOK_DISTRIBUTEBY
-               TOK_TABLE_OR_COL
-                  p_mfgr
-               TOK_TABLE_OR_COL
-                  p_name
-            TOK_ORDERBY
-               TOK_TABSORTCOLNAMEASC
-                  TOK_NULLS_FIRST
-                     TOK_TABLE_OR_COL
-                        p_mfgr
-               TOK_TABSORTCOLNAMEASC
-                  TOK_NULLS_FIRST
-                     TOK_TABLE_OR_COL
-                        p_name
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_FUNCTION
-               rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                        TOK_TABLE_OR_COL
-                           p_name
-            r
-         TOK_SELEXPR
-            TOK_FUNCTION
-               dense_rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                        TOK_TABLE_OR_COL
-                           p_name
-            dr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            TOK_FUNCTION
-               sum
-               TOK_TABLE_OR_COL
-                  p_size
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                        TOK_TABLE_OR_COL
-                           p_name
-                  TOK_WINDOWRANGE
-                     preceding
-                        unbounded
-                     current
-            s1
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -6899,118 +5348,6 @@ from noop(on
         partition by p_mfgr  
         order by p_mfgr )
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noop
-         TOK_PTBLFUNCTION
-            noop
-            TOK_PTBLFUNCTION
-               noop
-               TOK_PTBLFUNCTION
-                  noop
-                  TOK_TABREF
-                     TOK_TABNAME
-                        part_orc
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_mfgr
-            TOK_PARTITIONINGSPEC
-               TOK_DISTRIBUTEBY
-                  TOK_TABLE_OR_COL
-                     p_mfgr
-                  TOK_TABLE_OR_COL
-                     p_name
-               TOK_ORDERBY
-                  TOK_TABSORTCOLNAMEASC
-                     TOK_NULLS_FIRST
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                  TOK_TABSORTCOLNAMEASC
-                     TOK_NULLS_FIRST
-                        TOK_TABLE_OR_COL
-                           p_name
-         TOK_PARTITIONINGSPEC
-            TOK_DISTRIBUTEBY
-               TOK_TABLE_OR_COL
-                  p_mfgr
-            TOK_ORDERBY
-               TOK_TABSORTCOLNAMEASC
-                  TOK_NULLS_FIRST
-                     TOK_TABLE_OR_COL
-                        p_mfgr
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_FUNCTION
-               rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            r
-         TOK_SELEXPR
-            TOK_FUNCTION
-               dense_rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            dr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            TOK_FUNCTION
-               sum
-               TOK_TABLE_OR_COL
-                  p_size
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-                  TOK_WINDOWRANGE
-                     preceding
-                        unbounded
-                     current
-            s1
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -7358,105 +5695,6 @@ from noop(on
           partition by p_mfgr 
           order by p_mfgr))
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noop
-         TOK_PTBLFUNCTION
-            noop
-            TOK_PTBLFUNCTION
-               noop
-               TOK_PTBLFUNCTION
-                  noop
-                  TOK_TABREF
-                     TOK_TABNAME
-                        part_orc
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                        TOK_TABLE_OR_COL
-                           p_name
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_mfgr
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            TOK_PARTITIONINGSPEC
-               TOK_DISTRIBUTEBY
-                  TOK_TABLE_OR_COL
-                     p_mfgr
-               TOK_ORDERBY
-                  TOK_TABSORTCOLNAMEASC
-                     TOK_NULLS_FIRST
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_FUNCTION
-               rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            r
-         TOK_SELEXPR
-            TOK_FUNCTION
-               dense_rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            dr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            TOK_FUNCTION
-               sum
-               TOK_TABLE_OR_COL
-                  p_size
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            s1
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -7780,115 +6018,6 @@ from noopwithmap(on
           partition by p_mfgr,p_name 
           order by p_mfgr,p_name)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noopwithmap
-         TOK_PTBLFUNCTION
-            noop
-            TOK_PTBLFUNCTION
-               noop
-               TOK_PTBLFUNCTION
-                  noop
-                  TOK_TABREF
-                     TOK_TABNAME
-                        part_orc
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                        TOK_TABLE_OR_COL
-                           p_name
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_mfgr
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            TOK_PARTITIONINGSPEC
-               TOK_DISTRIBUTEBY
-                  TOK_TABLE_OR_COL
-                     p_mfgr
-               TOK_ORDERBY
-                  TOK_TABSORTCOLNAMEASC
-                     TOK_NULLS_FIRST
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-         TOK_PARTITIONINGSPEC
-            TOK_DISTRIBUTEBY
-               TOK_TABLE_OR_COL
-                  p_mfgr
-               TOK_TABLE_OR_COL
-                  p_name
-            TOK_ORDERBY
-               TOK_TABSORTCOLNAMEASC
-                  TOK_NULLS_FIRST
-                     TOK_TABLE_OR_COL
-                        p_mfgr
-               TOK_TABSORTCOLNAMEASC
-                  TOK_NULLS_FIRST
-                     TOK_TABLE_OR_COL
-                        p_name
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_FUNCTION
-               rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                        TOK_TABLE_OR_COL
-                           p_name
-            r
-         TOK_SELEXPR
-            TOK_FUNCTION
-               dense_rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                        TOK_TABLE_OR_COL
-                           p_name
-            dr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            TOK_FUNCTION
-               sum
-               TOK_TABLE_OR_COL
-                  p_size
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                        TOK_TABLE_OR_COL
-                           p_name
-                  TOK_WINDOWRANGE
-                     preceding
-                        unbounded
-                     current
-            s1
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -8255,151 +6384,6 @@ from noop(on
           order by p_mfgr
           ))
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noop
-         TOK_PTBLFUNCTION
-            noopwithmap
-            TOK_PTBLFUNCTION
-               noop
-               TOK_TABREF
-                  TOK_TABNAME
-                     part_orc
-               TOK_PARTITIONINGSPEC
-                  TOK_DISTRIBUTEBY
-                     TOK_TABLE_OR_COL
-                        p_mfgr
-                     TOK_TABLE_OR_COL
-                        p_name
-                  TOK_ORDERBY
-                     TOK_TABSORTCOLNAMEASC
-                        TOK_NULLS_FIRST
-                           TOK_TABLE_OR_COL
-                              p_mfgr
-                     TOK_TABSORTCOLNAMEASC
-                        TOK_NULLS_FIRST
-                           TOK_TABLE_OR_COL
-                              p_name
-            TOK_PARTITIONINGSPEC
-               TOK_DISTRIBUTEBY
-                  TOK_TABLE_OR_COL
-                     p_mfgr
-               TOK_ORDERBY
-                  TOK_TABSORTCOLNAMEASC
-                     TOK_NULLS_FIRST
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_FUNCTION
-               rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                        TOK_TABLE_OR_COL
-                           p_name
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_mfgr
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            r
-         TOK_SELEXPR
-            TOK_FUNCTION
-               dense_rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                        TOK_TABLE_OR_COL
-                           p_name
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_mfgr
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            dr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            TOK_FUNCTION
-               sum
-               TOK_TABLE_OR_COL
-                  p_size
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                        TOK_TABLE_OR_COL
-                           p_name
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_mfgr
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-                  TOK_WINDOWRANGE
-                     preceding
-                        unbounded
-                     current
-            s1
-         TOK_SELEXPR
-            TOK_FUNCTION
-               sum
-               TOK_TABLE_OR_COL
-                  p_size
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                        TOK_TABLE_OR_COL
-                           p_name
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_mfgr
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-                  TOK_WINDOWRANGE
-                     preceding
-                        unbounded
-                     current
-            s2
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -8736,118 +6720,6 @@ from noopwithmap(on
               order by p_mfgr, p_name) 
           ))
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noopwithmap
-         TOK_PTBLFUNCTION
-            noop
-            TOK_PTBLFUNCTION
-               noop
-               TOK_TABREF
-                  TOK_TABNAME
-                     part_orc
-               TOK_PARTITIONINGSPEC
-                  TOK_DISTRIBUTEBY
-                     TOK_TABLE_OR_COL
-                        p_mfgr
-                     TOK_TABLE_OR_COL
-                        p_name
-                  TOK_ORDERBY
-                     TOK_TABSORTCOLNAMEASC
-                        TOK_NULLS_FIRST
-                           TOK_TABLE_OR_COL
-                              p_mfgr
-                     TOK_TABSORTCOLNAMEASC
-                        TOK_NULLS_FIRST
-                           TOK_TABLE_OR_COL
-                              p_name
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_FUNCTION
-               rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            r
-         TOK_SELEXPR
-            TOK_FUNCTION
-               dense_rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            dr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            TOK_FUNCTION
-               sum
-               TOK_TABLE_OR_COL
-                  p_size
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-                  TOK_WINDOWVALUES
-                     preceding
-                        unbounded
-                     current
-            s1
-         TOK_SELEXPR
-            TOK_FUNCTION
-               sum
-               TOK_TABLE_OR_COL
-                  p_size
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-                  TOK_WINDOWVALUES
-                     preceding
-                        unbounded
-                     current
-            s2
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/transform_ppr1.q.out b/ql/src/test/results/clientpositive/transform_ppr1.q.out
index a5c5dbebf1..8c58139dda 100644
--- a/ql/src/test/results/clientpositive/transform_ppr1.q.out
+++ b/ql/src/test/results/clientpositive/transform_ppr1.q.out
@@ -20,81 +20,6 @@ FROM (
 ) tmap
 SELECT tmap.tkey, tmap.tvalue WHERE tmap.tkey < 100 AND tmap.ds = '2008-04-08'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_QUERY
-            TOK_FROM
-               TOK_TABREF
-                  TOK_TABNAME
-                     srcpart
-                  src
-            TOK_INSERT
-               TOK_DESTINATION
-                  TOK_DIR
-                     TOK_TMP_FILE
-               TOK_SELECT
-                  TOK_SELEXPR
-                     TOK_TRANSFORM
-                        TOK_EXPLIST
-                           .
-                              TOK_TABLE_OR_COL
-                                 src
-                              ds
-                           .
-                              TOK_TABLE_OR_COL
-                                 src
-                              key
-                           .
-                              TOK_TABLE_OR_COL
-                                 src
-                              value
-                        TOK_SERDE
-                        TOK_RECORDWRITER
-                        'cat'
-                        TOK_SERDE
-                        TOK_RECORDREADER
-                        TOK_ALIASLIST
-                           ds
-                           tkey
-                           tvalue
-               TOK_CLUSTERBY
-                  TOK_TABLE_OR_COL
-                     tkey
-         tmap
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  tmap
-               tkey
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  tmap
-               tvalue
-      TOK_WHERE
-         AND
-            <
-               .
-                  TOK_TABLE_OR_COL
-                     tmap
-                  tkey
-               100
-            =
-               .
-                  TOK_TABLE_OR_COL
-                     tmap
-                  ds
-               '2008-04-08'
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/transform_ppr2.q.out b/ql/src/test/results/clientpositive/transform_ppr2.q.out
index 522478749f..8e36abde70 100644
--- a/ql/src/test/results/clientpositive/transform_ppr2.q.out
+++ b/ql/src/test/results/clientpositive/transform_ppr2.q.out
@@ -22,81 +22,6 @@ FROM (
 ) tmap
 SELECT tmap.tkey, tmap.tvalue WHERE tmap.tkey < 100
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_QUERY
-            TOK_FROM
-               TOK_TABREF
-                  TOK_TABNAME
-                     srcpart
-                  src
-            TOK_INSERT
-               TOK_DESTINATION
-                  TOK_DIR
-                     TOK_TMP_FILE
-               TOK_SELECT
-                  TOK_SELEXPR
-                     TOK_TRANSFORM
-                        TOK_EXPLIST
-                           .
-                              TOK_TABLE_OR_COL
-                                 src
-                              ds
-                           .
-                              TOK_TABLE_OR_COL
-                                 src
-                              key
-                           .
-                              TOK_TABLE_OR_COL
-                                 src
-                              value
-                        TOK_SERDE
-                        TOK_RECORDWRITER
-                        'cat'
-                        TOK_SERDE
-                        TOK_RECORDREADER
-                        TOK_ALIASLIST
-                           ds
-                           tkey
-                           tvalue
-               TOK_WHERE
-                  =
-                     .
-                        TOK_TABLE_OR_COL
-                           src
-                        ds
-                     '2008-04-08'
-               TOK_CLUSTERBY
-                  TOK_TABLE_OR_COL
-                     tkey
-         tmap
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  tmap
-               tkey
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  tmap
-               tvalue
-      TOK_WHERE
-         <
-            .
-               TOK_TABLE_OR_COL
-                  tmap
-               tkey
-            100
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/truncate_column_list_bucket.q.out b/ql/src/test/results/clientpositive/truncate_column_list_bucket.q.out
index 1fa437b9c7..39ffc6c984 100644
--- a/ql/src/test/results/clientpositive/truncate_column_list_bucket.q.out
+++ b/ql/src/test/results/clientpositive/truncate_column_list_bucket.q.out
@@ -67,32 +67,6 @@ POSTHOOK: query: -- In the following select statements the list bucketing optimi
 
 EXPLAIN EXTENDED SELECT * FROM test_tab WHERE part = '1' AND key = '484'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            test_tab
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         AND
-            =
-               TOK_TABLE_OR_COL
-                  part
-               '1'
-            =
-               TOK_TABLE_OR_COL
-                  key
-               '484'
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
@@ -171,32 +145,6 @@ PREHOOK: query: EXPLAIN EXTENDED SELECT * FROM test_tab WHERE part = '1' AND key
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN EXTENDED SELECT * FROM test_tab WHERE part = '1' AND key = '0'
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            test_tab
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         AND
-            =
-               TOK_TABLE_OR_COL
-                  part
-               '1'
-            =
-               TOK_TABLE_OR_COL
-                  key
-               '0'
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
diff --git a/ql/src/test/results/clientpositive/udf_explode.q.out b/ql/src/test/results/clientpositive/udf_explode.q.out
index 91b9bbee64..8db4375119 100644
--- a/ql/src/test/results/clientpositive/udf_explode.q.out
+++ b/ql/src/test/results/clientpositive/udf_explode.q.out
@@ -12,32 +12,6 @@ PREHOOK: query: EXPLAIN EXTENDED SELECT explode(array(1,2,3)) AS myCol FROM src
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN EXTENDED SELECT explode(array(1,2,3)) AS myCol FROM src tablesample (1 rows)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            src
-         TOK_TABLESPLITSAMPLE
-            TOK_ROWCOUNT
-            1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTION
-               explode
-               TOK_FUNCTION
-                  array
-                  1
-                  2
-                  3
-            myCol
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -140,55 +114,6 @@ PREHOOK: query: EXPLAIN EXTENDED SELECT a.myCol, count(1) FROM (SELECT explode(a
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN EXTENDED SELECT a.myCol, count(1) FROM (SELECT explode(array(1,2,3)) AS myCol FROM src tablesample (1 rows)) a GROUP BY a.myCol
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_QUERY
-            TOK_FROM
-               TOK_TABREF
-                  TOK_TABNAME
-                     src
-                  TOK_TABLESPLITSAMPLE
-                     TOK_ROWCOUNT
-                     1
-            TOK_INSERT
-               TOK_DESTINATION
-                  TOK_DIR
-                     TOK_TMP_FILE
-               TOK_SELECT
-                  TOK_SELEXPR
-                     TOK_FUNCTION
-                        explode
-                        TOK_FUNCTION
-                           array
-                           1
-                           2
-                           3
-                     myCol
-         a
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               myCol
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_GROUPBY
-         .
-            TOK_TABLE_OR_COL
-               a
-            myCol
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -347,36 +272,6 @@ PREHOOK: query: EXPLAIN EXTENDED SELECT explode(map(1,'one',2,'two',3,'three'))
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN EXTENDED SELECT explode(map(1,'one',2,'two',3,'three')) AS (key,val) FROM src tablesample (1 rows)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            src
-         TOK_TABLESPLITSAMPLE
-            TOK_ROWCOUNT
-            1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTION
-               explode
-               TOK_FUNCTION
-                  map
-                  1
-                  'one'
-                  2
-                  'two'
-                  3
-                  'three'
-            key
-            val
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -479,68 +374,6 @@ PREHOOK: query: EXPLAIN EXTENDED SELECT a.key, a.val, count(1) FROM (SELECT expl
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN EXTENDED SELECT a.key, a.val, count(1) FROM (SELECT explode(map(1,'one',2,'two',3,'three')) AS (key,val) FROM src tablesample (1 rows)) a GROUP BY a.key, a.val
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_QUERY
-            TOK_FROM
-               TOK_TABREF
-                  TOK_TABNAME
-                     src
-                  TOK_TABLESPLITSAMPLE
-                     TOK_ROWCOUNT
-                     1
-            TOK_INSERT
-               TOK_DESTINATION
-                  TOK_DIR
-                     TOK_TMP_FILE
-               TOK_SELECT
-                  TOK_SELEXPR
-                     TOK_FUNCTION
-                        explode
-                        TOK_FUNCTION
-                           map
-                           1
-                           'one'
-                           2
-                           'two'
-                           3
-                           'three'
-                     key
-                     val
-         a
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               val
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_GROUPBY
-         .
-            TOK_TABLE_OR_COL
-               a
-            key
-         .
-            TOK_TABLE_OR_COL
-               a
-            val
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/udf_java_method.q.out b/ql/src/test/results/clientpositive/udf_java_method.q.out
index 2d2a57dbe0..2c66a8f08c 100644
--- a/ql/src/test/results/clientpositive/udf_java_method.q.out
+++ b/ql/src/test/results/clientpositive/udf_java_method.q.out
@@ -35,69 +35,6 @@ SELECT java_method("java.lang.String", "valueOf", 1),
        java_method("java.lang.Math", "floor", 1.9)
 FROM src tablesample (1 rows)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            src
-         TOK_TABLESPLITSAMPLE
-            TOK_ROWCOUNT
-            1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTION
-               java_method
-               "java.lang.String"
-               "valueOf"
-               1
-         TOK_SELEXPR
-            TOK_FUNCTION
-               java_method
-               "java.lang.String"
-               "isEmpty"
-         TOK_SELEXPR
-            TOK_FUNCTION
-               java_method
-               "java.lang.Math"
-               "max"
-               2
-               3
-         TOK_SELEXPR
-            TOK_FUNCTION
-               java_method
-               "java.lang.Math"
-               "min"
-               2
-               3
-         TOK_SELEXPR
-            TOK_FUNCTION
-               java_method
-               "java.lang.Math"
-               "round"
-               2.5
-         TOK_SELEXPR
-            TOK_FUNCTION
-               round
-               TOK_FUNCTION
-                  java_method
-                  "java.lang.Math"
-                  "exp"
-                  1.0
-               6
-         TOK_SELEXPR
-            TOK_FUNCTION
-               java_method
-               "java.lang.Math"
-               "floor"
-               1.9
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
diff --git a/ql/src/test/results/clientpositive/udf_reflect.q.out b/ql/src/test/results/clientpositive/udf_reflect.q.out
index b65d1cdbcd..4c31977ed1 100644
--- a/ql/src/test/results/clientpositive/udf_reflect.q.out
+++ b/ql/src/test/results/clientpositive/udf_reflect.q.out
@@ -33,77 +33,6 @@ SELECT reflect("java.lang.String", "valueOf", 1),
        reflect("java.lang.Integer", "valueOf", key, 16)
 FROM src tablesample (1 rows)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            src
-         TOK_TABLESPLITSAMPLE
-            TOK_ROWCOUNT
-            1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTION
-               reflect
-               "java.lang.String"
-               "valueOf"
-               1
-         TOK_SELEXPR
-            TOK_FUNCTION
-               reflect
-               "java.lang.String"
-               "isEmpty"
-         TOK_SELEXPR
-            TOK_FUNCTION
-               reflect
-               "java.lang.Math"
-               "max"
-               2
-               3
-         TOK_SELEXPR
-            TOK_FUNCTION
-               reflect
-               "java.lang.Math"
-               "min"
-               2
-               3
-         TOK_SELEXPR
-            TOK_FUNCTION
-               reflect
-               "java.lang.Math"
-               "round"
-               2.5
-         TOK_SELEXPR
-            TOK_FUNCTION
-               round
-               TOK_FUNCTION
-                  reflect
-                  "java.lang.Math"
-                  "exp"
-                  1.0
-               6
-         TOK_SELEXPR
-            TOK_FUNCTION
-               reflect
-               "java.lang.Math"
-               "floor"
-               1.9
-         TOK_SELEXPR
-            TOK_FUNCTION
-               reflect
-               "java.lang.Integer"
-               "valueOf"
-               TOK_TABLE_OR_COL
-                  key
-               16
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
diff --git a/ql/src/test/results/clientpositive/udf_reflect2.q.out b/ql/src/test/results/clientpositive/udf_reflect2.q.out
index 6c2265729f..a862990af4 100644
--- a/ql/src/test/results/clientpositive/udf_reflect2.q.out
+++ b/ql/src/test/results/clientpositive/udf_reflect2.q.out
@@ -78,235 +78,6 @@ SELECT key,
        reflect2(ts, "getTime")
 FROM (select cast(key as int) key, value, cast('2013-02-15 19:41:20' as timestamp) ts from src) a LIMIT 5
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_QUERY
-            TOK_FROM
-               TOK_TABREF
-                  TOK_TABNAME
-                     src
-            TOK_INSERT
-               TOK_DESTINATION
-                  TOK_DIR
-                     TOK_TMP_FILE
-               TOK_SELECT
-                  TOK_SELEXPR
-                     TOK_FUNCTION
-                        TOK_INT
-                        TOK_TABLE_OR_COL
-                           key
-                     key
-                  TOK_SELEXPR
-                     TOK_TABLE_OR_COL
-                        value
-                  TOK_SELEXPR
-                     TOK_FUNCTION
-                        TOK_TIMESTAMP
-                        '2013-02-15 19:41:20'
-                     ts
-         a
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               key
-         TOK_SELEXPR
-            TOK_FUNCTION
-               reflect2
-               TOK_TABLE_OR_COL
-                  key
-               "byteValue"
-         TOK_SELEXPR
-            TOK_FUNCTION
-               reflect2
-               TOK_TABLE_OR_COL
-                  key
-               "shortValue"
-         TOK_SELEXPR
-            TOK_FUNCTION
-               reflect2
-               TOK_TABLE_OR_COL
-                  key
-               "intValue"
-         TOK_SELEXPR
-            TOK_FUNCTION
-               reflect2
-               TOK_TABLE_OR_COL
-                  key
-               "longValue"
-         TOK_SELEXPR
-            TOK_FUNCTION
-               reflect2
-               TOK_TABLE_OR_COL
-                  key
-               "floatValue"
-         TOK_SELEXPR
-            TOK_FUNCTION
-               reflect2
-               TOK_TABLE_OR_COL
-                  key
-               "doubleValue"
-         TOK_SELEXPR
-            TOK_FUNCTION
-               reflect2
-               TOK_TABLE_OR_COL
-                  key
-               "toString"
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               value
-         TOK_SELEXPR
-            TOK_FUNCTION
-               reflect2
-               TOK_TABLE_OR_COL
-                  value
-               "concat"
-               "_concat"
-         TOK_SELEXPR
-            TOK_FUNCTION
-               reflect2
-               TOK_TABLE_OR_COL
-                  value
-               "contains"
-               "86"
-         TOK_SELEXPR
-            TOK_FUNCTION
-               reflect2
-               TOK_TABLE_OR_COL
-                  value
-               "startsWith"
-               "v"
-         TOK_SELEXPR
-            TOK_FUNCTION
-               reflect2
-               TOK_TABLE_OR_COL
-                  value
-               "endsWith"
-               "6"
-         TOK_SELEXPR
-            TOK_FUNCTION
-               reflect2
-               TOK_TABLE_OR_COL
-                  value
-               "equals"
-               "val_86"
-         TOK_SELEXPR
-            TOK_FUNCTION
-               reflect2
-               TOK_TABLE_OR_COL
-                  value
-               "equalsIgnoreCase"
-               "VAL_86"
-         TOK_SELEXPR
-            TOK_FUNCTION
-               reflect2
-               TOK_TABLE_OR_COL
-                  value
-               "getBytes"
-         TOK_SELEXPR
-            TOK_FUNCTION
-               reflect2
-               TOK_TABLE_OR_COL
-                  value
-               "indexOf"
-               "1"
-         TOK_SELEXPR
-            TOK_FUNCTION
-               reflect2
-               TOK_TABLE_OR_COL
-                  value
-               "lastIndexOf"
-               "1"
-         TOK_SELEXPR
-            TOK_FUNCTION
-               reflect2
-               TOK_TABLE_OR_COL
-                  value
-               "replace"
-               "val"
-               "VALUE"
-         TOK_SELEXPR
-            TOK_FUNCTION
-               reflect2
-               TOK_TABLE_OR_COL
-                  value
-               "substring"
-               1
-         TOK_SELEXPR
-            TOK_FUNCTION
-               reflect2
-               TOK_TABLE_OR_COL
-                  value
-               "substring"
-               1
-               5
-         TOK_SELEXPR
-            TOK_FUNCTION
-               reflect2
-               TOK_TABLE_OR_COL
-                  value
-               "toUpperCase"
-         TOK_SELEXPR
-            TOK_FUNCTION
-               reflect2
-               TOK_TABLE_OR_COL
-                  value
-               "trim"
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               ts
-         TOK_SELEXPR
-            TOK_FUNCTION
-               reflect2
-               TOK_TABLE_OR_COL
-                  ts
-               "getYear"
-         TOK_SELEXPR
-            TOK_FUNCTION
-               reflect2
-               TOK_TABLE_OR_COL
-                  ts
-               "getMonth"
-         TOK_SELEXPR
-            TOK_FUNCTION
-               reflect2
-               TOK_TABLE_OR_COL
-                  ts
-               "getDay"
-         TOK_SELEXPR
-            TOK_FUNCTION
-               reflect2
-               TOK_TABLE_OR_COL
-                  ts
-               "getHours"
-         TOK_SELEXPR
-            TOK_FUNCTION
-               reflect2
-               TOK_TABLE_OR_COL
-                  ts
-               "getMinutes"
-         TOK_SELEXPR
-            TOK_FUNCTION
-               reflect2
-               TOK_TABLE_OR_COL
-                  ts
-               "getSeconds"
-         TOK_SELEXPR
-            TOK_FUNCTION
-               reflect2
-               TOK_TABLE_OR_COL
-                  ts
-               "getTime"
-      TOK_LIMIT
-         5
-
-
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
diff --git a/ql/src/test/results/clientpositive/udtf_explode.q.out b/ql/src/test/results/clientpositive/udtf_explode.q.out
index 62d8e9f7f2..330410954b 100644
--- a/ql/src/test/results/clientpositive/udtf_explode.q.out
+++ b/ql/src/test/results/clientpositive/udtf_explode.q.out
@@ -12,31 +12,6 @@ PREHOOK: query: EXPLAIN EXTENDED SELECT explode(array(1,2,3)) AS myCol FROM src
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN EXTENDED SELECT explode(array(1,2,3)) AS myCol FROM src LIMIT 3
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_TABREF
-         TOK_TABNAME
-            src
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_FUNCTION
-               explode
-               TOK_FUNCTION
-                  array
-                  1
-                  2
-                  3
-            myCol
-      TOK_LIMIT
-         3
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -141,54 +116,6 @@ PREHOOK: query: EXPLAIN EXTENDED SELECT a.myCol, count(1) FROM (SELECT explode(a
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN EXTENDED SELECT a.myCol, count(1) FROM (SELECT explode(array(1,2,3)) AS myCol FROM src LIMIT 3) a GROUP BY a.myCol
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_QUERY
-            TOK_FROM
-               TOK_TABREF
-                  TOK_TABNAME
-                     src
-            TOK_INSERT
-               TOK_DESTINATION
-                  TOK_DIR
-                     TOK_TMP_FILE
-               TOK_SELECT
-                  TOK_SELEXPR
-                     TOK_FUNCTION
-                        explode
-                        TOK_FUNCTION
-                           array
-                           1
-                           2
-                           3
-                     myCol
-               TOK_LIMIT
-                  3
-         a
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               myCol
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_GROUPBY
-         .
-            TOK_TABLE_OR_COL
-               a
-            myCol
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -453,67 +380,6 @@ PREHOOK: query: EXPLAIN EXTENDED SELECT a.myKey, a.myVal, count(1) FROM (SELECT
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN EXTENDED SELECT a.myKey, a.myVal, count(1) FROM (SELECT explode(map(1,'one',2,'two',3,'three')) as (myKey,myVal) FROM src LIMIT 3) a GROUP BY a.myKey, a.myVal
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_QUERY
-            TOK_FROM
-               TOK_TABREF
-                  TOK_TABNAME
-                     src
-            TOK_INSERT
-               TOK_DESTINATION
-                  TOK_DIR
-                     TOK_TMP_FILE
-               TOK_SELECT
-                  TOK_SELEXPR
-                     TOK_FUNCTION
-                        explode
-                        TOK_FUNCTION
-                           map
-                           1
-                           'one'
-                           2
-                           'two'
-                           3
-                           'three'
-                     myKey
-                     myVal
-               TOK_LIMIT
-                  3
-         a
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               myKey
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  a
-               myVal
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               1
-      TOK_GROUPBY
-         .
-            TOK_TABLE_OR_COL
-               a
-            myKey
-         .
-            TOK_TABLE_OR_COL
-               a
-            myVal
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/union22.q.out b/ql/src/test/results/clientpositive/union22.q.out
index 5309c714fa..f0751483b7 100644
--- a/ql/src/test/results/clientpositive/union22.q.out
+++ b/ql/src/test/results/clientpositive/union22.q.out
@@ -78,146 +78,6 @@ where a.k1 > 20
 )
 subq
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_UNIONALL
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        dst_union22_delta
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           k1
-                        k1
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           k2
-                        k2
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           k3
-                        k3
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           k4
-                        k4
-                  TOK_WHERE
-                     and
-                        =
-                           TOK_TABLE_OR_COL
-                              ds
-                           '1'
-                        <=
-                           TOK_TABLE_OR_COL
-                              k0
-                           50
-            TOK_QUERY
-               TOK_FROM
-                  TOK_LEFTOUTERJOIN
-                     TOK_TABREF
-                        TOK_TABNAME
-                           dst_union22
-                        a
-                     TOK_SUBQUERY
-                        TOK_QUERY
-                           TOK_FROM
-                              TOK_TABREF
-                                 TOK_TABNAME
-                                    dst_union22_delta
-                           TOK_INSERT
-                              TOK_DESTINATION
-                                 TOK_DIR
-                                    TOK_TMP_FILE
-                              TOK_SELECT
-                                 TOK_SELEXPR
-                                    TOK_ALLCOLREF
-                              TOK_WHERE
-                                 and
-                                    =
-                                       TOK_TABLE_OR_COL
-                                          ds
-                                       '1'
-                                    >
-                                       TOK_TABLE_OR_COL
-                                          k0
-                                       50
-                        b
-                     and
-                        =
-                           .
-                              TOK_TABLE_OR_COL
-                                 a
-                              k1
-                           .
-                              TOK_TABLE_OR_COL
-                                 b
-                              k1
-                        =
-                           .
-                              TOK_TABLE_OR_COL
-                                 a
-                              ds
-                           '1'
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        .
-                           TOK_TABLE_OR_COL
-                              a
-                           k1
-                        k1
-                     TOK_SELEXPR
-                        .
-                           TOK_TABLE_OR_COL
-                              a
-                           k2
-                        k2
-                     TOK_SELEXPR
-                        .
-                           TOK_TABLE_OR_COL
-                              b
-                           k3
-                        k3
-                     TOK_SELEXPR
-                        .
-                           TOK_TABLE_OR_COL
-                              b
-                           k4
-                        k4
-                  TOK_WHERE
-                     >
-                        .
-                           TOK_TABLE_OR_COL
-                              a
-                           k1
-                        20
-         subq
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dst_union22
-            TOK_PARTSPEC
-               TOK_PARTVAL
-                  ds
-                  '2'
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-7 is a root stage , consists of Stage-8, Stage-4
   Stage-8 has a backup stage: Stage-4
diff --git a/ql/src/test/results/clientpositive/union24.q.out b/ql/src/test/results/clientpositive/union24.q.out
index 993b838704..91b582ff4f 100644
--- a/ql/src/test/results/clientpositive/union24.q.out
+++ b/ql/src/test/results/clientpositive/union24.q.out
@@ -72,121 +72,6 @@ select s.key, s.count from (
   select key, count(1) as count from src5 where key < 10 group by key
 )s
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_UNIONALL
-            TOK_UNIONALL
-               TOK_UNIONALL
-                  TOK_QUERY
-                     TOK_FROM
-                        TOK_TABREF
-                           TOK_TABNAME
-                              src2
-                     TOK_INSERT
-                        TOK_DESTINATION
-                           TOK_DIR
-                              TOK_TMP_FILE
-                        TOK_SELECT
-                           TOK_SELEXPR
-                              TOK_TABLE_OR_COL
-                                 key
-                           TOK_SELEXPR
-                              TOK_TABLE_OR_COL
-                                 count
-                        TOK_WHERE
-                           <
-                              TOK_TABLE_OR_COL
-                                 key
-                              10
-                  TOK_QUERY
-                     TOK_FROM
-                        TOK_TABREF
-                           TOK_TABNAME
-                              src3
-                     TOK_INSERT
-                        TOK_DESTINATION
-                           TOK_DIR
-                              TOK_TMP_FILE
-                        TOK_SELECT
-                           TOK_SELEXPR
-                              TOK_TABLE_OR_COL
-                                 key
-                           TOK_SELEXPR
-                              TOK_TABLE_OR_COL
-                                 count
-                        TOK_WHERE
-                           <
-                              TOK_TABLE_OR_COL
-                                 key
-                              10
-               TOK_QUERY
-                  TOK_FROM
-                     TOK_TABREF
-                        TOK_TABNAME
-                           src4
-                  TOK_INSERT
-                     TOK_DESTINATION
-                        TOK_DIR
-                           TOK_TMP_FILE
-                     TOK_SELECT
-                        TOK_SELEXPR
-                           TOK_TABLE_OR_COL
-                              key
-                        TOK_SELEXPR
-                           TOK_TABLE_OR_COL
-                              count
-                     TOK_WHERE
-                        <
-                           TOK_TABLE_OR_COL
-                              key
-                           10
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        src5
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_TABLE_OR_COL
-                           key
-                     TOK_SELEXPR
-                        TOK_FUNCTION
-                           count
-                           1
-                        count
-                  TOK_WHERE
-                     <
-                        TOK_TABLE_OR_COL
-                           key
-                        10
-                  TOK_GROUPBY
-                     TOK_TABLE_OR_COL
-                        key
-         s
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  s
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  s
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-5 is a root stage
   Stage-2 depends on stages: Stage-5
@@ -674,117 +559,6 @@ select s.key, s.count from (
   select a.key as key, b.count as count from src4 a join src5 b on a.key=b.key where a.key < 10
 )s
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_UNIONALL
-            TOK_UNIONALL
-               TOK_QUERY
-                  TOK_FROM
-                     TOK_TABREF
-                        TOK_TABNAME
-                           src2
-                  TOK_INSERT
-                     TOK_DESTINATION
-                        TOK_DIR
-                           TOK_TMP_FILE
-                     TOK_SELECT
-                        TOK_SELEXPR
-                           TOK_TABLE_OR_COL
-                              key
-                        TOK_SELEXPR
-                           TOK_TABLE_OR_COL
-                              count
-                     TOK_WHERE
-                        <
-                           TOK_TABLE_OR_COL
-                              key
-                           10
-               TOK_QUERY
-                  TOK_FROM
-                     TOK_TABREF
-                        TOK_TABNAME
-                           src3
-                  TOK_INSERT
-                     TOK_DESTINATION
-                        TOK_DIR
-                           TOK_TMP_FILE
-                     TOK_SELECT
-                        TOK_SELEXPR
-                           TOK_TABLE_OR_COL
-                              key
-                        TOK_SELEXPR
-                           TOK_TABLE_OR_COL
-                              count
-                     TOK_WHERE
-                        <
-                           TOK_TABLE_OR_COL
-                              key
-                           10
-            TOK_QUERY
-               TOK_FROM
-                  TOK_JOIN
-                     TOK_TABREF
-                        TOK_TABNAME
-                           src4
-                        a
-                     TOK_TABREF
-                        TOK_TABNAME
-                           src5
-                        b
-                     =
-                        .
-                           TOK_TABLE_OR_COL
-                              a
-                           key
-                        .
-                           TOK_TABLE_OR_COL
-                              b
-                           key
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        .
-                           TOK_TABLE_OR_COL
-                              a
-                           key
-                        key
-                     TOK_SELEXPR
-                        .
-                           TOK_TABLE_OR_COL
-                              b
-                           count
-                        count
-                  TOK_WHERE
-                     <
-                        .
-                           TOK_TABLE_OR_COL
-                              a
-                           key
-                        10
-         s
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  s
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  s
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-4 is a root stage
   Stage-2 depends on stages: Stage-4
@@ -1246,121 +1020,6 @@ select s.key, s.count from (
   select a.key as key, count(1) as count from src4 a join src5 b on a.key=b.key where a.key < 10 group by a.key
 )s
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_UNIONALL
-            TOK_UNIONALL
-               TOK_QUERY
-                  TOK_FROM
-                     TOK_TABREF
-                        TOK_TABNAME
-                           src2
-                  TOK_INSERT
-                     TOK_DESTINATION
-                        TOK_DIR
-                           TOK_TMP_FILE
-                     TOK_SELECT
-                        TOK_SELEXPR
-                           TOK_TABLE_OR_COL
-                              key
-                        TOK_SELEXPR
-                           TOK_TABLE_OR_COL
-                              count
-                     TOK_WHERE
-                        <
-                           TOK_TABLE_OR_COL
-                              key
-                           10
-               TOK_QUERY
-                  TOK_FROM
-                     TOK_TABREF
-                        TOK_TABNAME
-                           src3
-                  TOK_INSERT
-                     TOK_DESTINATION
-                        TOK_DIR
-                           TOK_TMP_FILE
-                     TOK_SELECT
-                        TOK_SELEXPR
-                           TOK_TABLE_OR_COL
-                              key
-                        TOK_SELEXPR
-                           TOK_TABLE_OR_COL
-                              count
-                     TOK_WHERE
-                        <
-                           TOK_TABLE_OR_COL
-                              key
-                           10
-            TOK_QUERY
-               TOK_FROM
-                  TOK_JOIN
-                     TOK_TABREF
-                        TOK_TABNAME
-                           src4
-                        a
-                     TOK_TABREF
-                        TOK_TABNAME
-                           src5
-                        b
-                     =
-                        .
-                           TOK_TABLE_OR_COL
-                              a
-                           key
-                        .
-                           TOK_TABLE_OR_COL
-                              b
-                           key
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        .
-                           TOK_TABLE_OR_COL
-                              a
-                           key
-                        key
-                     TOK_SELEXPR
-                        TOK_FUNCTION
-                           count
-                           1
-                        count
-                  TOK_WHERE
-                     <
-                        .
-                           TOK_TABLE_OR_COL
-                              a
-                           key
-                        10
-                  TOK_GROUPBY
-                     .
-                        TOK_TABLE_OR_COL
-                           a
-                        key
-         s
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  s
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  s
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-4 is a root stage
   Stage-5 depends on stages: Stage-4
diff --git a/ql/src/test/results/clientpositive/unionDistinct_1.q.out b/ql/src/test/results/clientpositive/unionDistinct_1.q.out
index 61bfa74eb0..0330133917 100644
--- a/ql/src/test/results/clientpositive/unionDistinct_1.q.out
+++ b/ql/src/test/results/clientpositive/unionDistinct_1.q.out
@@ -6815,157 +6815,6 @@ where a.k1 > 20
 )
 subq
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_QUERY
-            TOK_FROM
-               TOK_SUBQUERY
-                  TOK_UNIONALL
-                     TOK_QUERY
-                        TOK_FROM
-                           TOK_TABREF
-                              TOK_TABNAME
-                                 dst_union22_delta
-                        TOK_INSERT
-                           TOK_DESTINATION
-                              TOK_DIR
-                                 TOK_TMP_FILE
-                           TOK_SELECT
-                              TOK_SELEXPR
-                                 TOK_TABLE_OR_COL
-                                    k1
-                                 k1
-                              TOK_SELEXPR
-                                 TOK_TABLE_OR_COL
-                                    k2
-                                 k2
-                              TOK_SELEXPR
-                                 TOK_TABLE_OR_COL
-                                    k3
-                                 k3
-                              TOK_SELEXPR
-                                 TOK_TABLE_OR_COL
-                                    k4
-                                 k4
-                           TOK_WHERE
-                              and
-                                 =
-                                    TOK_TABLE_OR_COL
-                                       ds
-                                    '1'
-                                 <=
-                                    TOK_TABLE_OR_COL
-                                       k0
-                                    50
-                     TOK_QUERY
-                        TOK_FROM
-                           TOK_LEFTOUTERJOIN
-                              TOK_TABREF
-                                 TOK_TABNAME
-                                    dst_union22
-                                 a
-                              TOK_SUBQUERY
-                                 TOK_QUERY
-                                    TOK_FROM
-                                       TOK_TABREF
-                                          TOK_TABNAME
-                                             dst_union22_delta
-                                    TOK_INSERT
-                                       TOK_DESTINATION
-                                          TOK_DIR
-                                             TOK_TMP_FILE
-                                       TOK_SELECT
-                                          TOK_SELEXPR
-                                             TOK_ALLCOLREF
-                                       TOK_WHERE
-                                          and
-                                             =
-                                                TOK_TABLE_OR_COL
-                                                   ds
-                                                '1'
-                                             >
-                                                TOK_TABLE_OR_COL
-                                                   k0
-                                                50
-                                 b
-                              and
-                                 =
-                                    .
-                                       TOK_TABLE_OR_COL
-                                          a
-                                       k1
-                                    .
-                                       TOK_TABLE_OR_COL
-                                          b
-                                       k1
-                                 =
-                                    .
-                                       TOK_TABLE_OR_COL
-                                          a
-                                       ds
-                                    '1'
-                        TOK_INSERT
-                           TOK_DESTINATION
-                              TOK_DIR
-                                 TOK_TMP_FILE
-                           TOK_SELECT
-                              TOK_SELEXPR
-                                 .
-                                    TOK_TABLE_OR_COL
-                                       a
-                                    k1
-                                 k1
-                              TOK_SELEXPR
-                                 .
-                                    TOK_TABLE_OR_COL
-                                       a
-                                    k2
-                                 k2
-                              TOK_SELEXPR
-                                 .
-                                    TOK_TABLE_OR_COL
-                                       b
-                                    k3
-                                 k3
-                              TOK_SELEXPR
-                                 .
-                                    TOK_TABLE_OR_COL
-                                       b
-                                    k4
-                                 k4
-                           TOK_WHERE
-                              >
-                                 .
-                                    TOK_TABLE_OR_COL
-                                       a
-                                    k1
-                                 20
-                  _u1
-            TOK_INSERT
-               TOK_DESTINATION
-                  TOK_DIR
-                     TOK_TMP_FILE
-               TOK_SELECTDI
-                  TOK_SELEXPR
-                     TOK_ALLCOLREF
-         subq
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               dst_union22
-            TOK_PARTSPEC
-               TOK_PARTVAL
-                  ds
-                  '2'
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-
-
 STAGE DEPENDENCIES:
   Stage-7 is a root stage , consists of Stage-8, Stage-4
   Stage-8 has a backup stage: Stage-4
@@ -8460,154 +8309,6 @@ select s.key, s.count from (
   select key, count(1) as count from src5 where key < 10 group by key
 )s
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_QUERY
-            TOK_FROM
-               TOK_SUBQUERY
-                  TOK_UNIONALL
-                     TOK_QUERY
-                        TOK_FROM
-                           TOK_SUBQUERY
-                              TOK_UNIONALL
-                                 TOK_QUERY
-                                    TOK_FROM
-                                       TOK_SUBQUERY
-                                          TOK_UNIONALL
-                                             TOK_QUERY
-                                                TOK_FROM
-                                                   TOK_TABREF
-                                                      TOK_TABNAME
-                                                         src2
-                                                TOK_INSERT
-                                                   TOK_DESTINATION
-                                                      TOK_DIR
-                                                         TOK_TMP_FILE
-                                                   TOK_SELECT
-                                                      TOK_SELEXPR
-                                                         TOK_TABLE_OR_COL
-                                                            key
-                                                      TOK_SELEXPR
-                                                         TOK_TABLE_OR_COL
-                                                            count
-                                                   TOK_WHERE
-                                                      <
-                                                         TOK_TABLE_OR_COL
-                                                            key
-                                                         10
-                                             TOK_QUERY
-                                                TOK_FROM
-                                                   TOK_TABREF
-                                                      TOK_TABNAME
-                                                         src3
-                                                TOK_INSERT
-                                                   TOK_DESTINATION
-                                                      TOK_DIR
-                                                         TOK_TMP_FILE
-                                                   TOK_SELECT
-                                                      TOK_SELEXPR
-                                                         TOK_TABLE_OR_COL
-                                                            key
-                                                      TOK_SELEXPR
-                                                         TOK_TABLE_OR_COL
-                                                            count
-                                                   TOK_WHERE
-                                                      <
-                                                         TOK_TABLE_OR_COL
-                                                            key
-                                                         10
-                                          _u1
-                                    TOK_INSERT
-                                       TOK_DESTINATION
-                                          TOK_DIR
-                                             TOK_TMP_FILE
-                                       TOK_SELECTDI
-                                          TOK_SELEXPR
-                                             TOK_ALLCOLREF
-                                 TOK_QUERY
-                                    TOK_FROM
-                                       TOK_TABREF
-                                          TOK_TABNAME
-                                             src4
-                                    TOK_INSERT
-                                       TOK_DESTINATION
-                                          TOK_DIR
-                                             TOK_TMP_FILE
-                                       TOK_SELECT
-                                          TOK_SELEXPR
-                                             TOK_TABLE_OR_COL
-                                                key
-                                          TOK_SELEXPR
-                                             TOK_TABLE_OR_COL
-                                                count
-                                       TOK_WHERE
-                                          <
-                                             TOK_TABLE_OR_COL
-                                                key
-                                             10
-                              _u2
-                        TOK_INSERT
-                           TOK_DESTINATION
-                              TOK_DIR
-                                 TOK_TMP_FILE
-                           TOK_SELECTDI
-                              TOK_SELEXPR
-                                 TOK_ALLCOLREF
-                     TOK_QUERY
-                        TOK_FROM
-                           TOK_TABREF
-                              TOK_TABNAME
-                                 src5
-                        TOK_INSERT
-                           TOK_DESTINATION
-                              TOK_DIR
-                                 TOK_TMP_FILE
-                           TOK_SELECT
-                              TOK_SELEXPR
-                                 TOK_TABLE_OR_COL
-                                    key
-                              TOK_SELEXPR
-                                 TOK_FUNCTION
-                                    count
-                                    1
-                                 count
-                           TOK_WHERE
-                              <
-                                 TOK_TABLE_OR_COL
-                                    key
-                                 10
-                           TOK_GROUPBY
-                              TOK_TABLE_OR_COL
-                                 key
-                  _u3
-            TOK_INSERT
-               TOK_DESTINATION
-                  TOK_DIR
-                     TOK_TMP_FILE
-               TOK_SELECTDI
-                  TOK_SELEXPR
-                     TOK_ALLCOLREF
-         s
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  s
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  s
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -9213,139 +8914,6 @@ select s.key, s.count from (
   select a.key as key, b.count as count from src4 a join src5 b on a.key=b.key where a.key < 10
 )s
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_QUERY
-            TOK_FROM
-               TOK_SUBQUERY
-                  TOK_UNIONALL
-                     TOK_QUERY
-                        TOK_FROM
-                           TOK_SUBQUERY
-                              TOK_UNIONALL
-                                 TOK_QUERY
-                                    TOK_FROM
-                                       TOK_TABREF
-                                          TOK_TABNAME
-                                             src2
-                                    TOK_INSERT
-                                       TOK_DESTINATION
-                                          TOK_DIR
-                                             TOK_TMP_FILE
-                                       TOK_SELECT
-                                          TOK_SELEXPR
-                                             TOK_TABLE_OR_COL
-                                                key
-                                          TOK_SELEXPR
-                                             TOK_TABLE_OR_COL
-                                                count
-                                       TOK_WHERE
-                                          <
-                                             TOK_TABLE_OR_COL
-                                                key
-                                             10
-                                 TOK_QUERY
-                                    TOK_FROM
-                                       TOK_TABREF
-                                          TOK_TABNAME
-                                             src3
-                                    TOK_INSERT
-                                       TOK_DESTINATION
-                                          TOK_DIR
-                                             TOK_TMP_FILE
-                                       TOK_SELECT
-                                          TOK_SELEXPR
-                                             TOK_TABLE_OR_COL
-                                                key
-                                          TOK_SELEXPR
-                                             TOK_TABLE_OR_COL
-                                                count
-                                       TOK_WHERE
-                                          <
-                                             TOK_TABLE_OR_COL
-                                                key
-                                             10
-                              _u1
-                        TOK_INSERT
-                           TOK_DESTINATION
-                              TOK_DIR
-                                 TOK_TMP_FILE
-                           TOK_SELECTDI
-                              TOK_SELEXPR
-                                 TOK_ALLCOLREF
-                     TOK_QUERY
-                        TOK_FROM
-                           TOK_JOIN
-                              TOK_TABREF
-                                 TOK_TABNAME
-                                    src4
-                                 a
-                              TOK_TABREF
-                                 TOK_TABNAME
-                                    src5
-                                 b
-                              =
-                                 .
-                                    TOK_TABLE_OR_COL
-                                       a
-                                    key
-                                 .
-                                    TOK_TABLE_OR_COL
-                                       b
-                                    key
-                        TOK_INSERT
-                           TOK_DESTINATION
-                              TOK_DIR
-                                 TOK_TMP_FILE
-                           TOK_SELECT
-                              TOK_SELEXPR
-                                 .
-                                    TOK_TABLE_OR_COL
-                                       a
-                                    key
-                                 key
-                              TOK_SELEXPR
-                                 .
-                                    TOK_TABLE_OR_COL
-                                       b
-                                    count
-                                 count
-                           TOK_WHERE
-                              <
-                                 .
-                                    TOK_TABLE_OR_COL
-                                       a
-                                    key
-                                 10
-                  _u2
-            TOK_INSERT
-               TOK_DESTINATION
-                  TOK_DIR
-                     TOK_TMP_FILE
-               TOK_SELECTDI
-                  TOK_SELEXPR
-                     TOK_ALLCOLREF
-         s
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  s
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  s
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-7 depends on stages: Stage-1
@@ -9817,143 +9385,6 @@ select s.key, s.count from (
   select a.key as key, count(1) as count from src4 a join src5 b on a.key=b.key where a.key < 10 group by a.key
 )s
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_QUERY
-            TOK_FROM
-               TOK_SUBQUERY
-                  TOK_UNIONALL
-                     TOK_QUERY
-                        TOK_FROM
-                           TOK_SUBQUERY
-                              TOK_UNIONALL
-                                 TOK_QUERY
-                                    TOK_FROM
-                                       TOK_TABREF
-                                          TOK_TABNAME
-                                             src2
-                                    TOK_INSERT
-                                       TOK_DESTINATION
-                                          TOK_DIR
-                                             TOK_TMP_FILE
-                                       TOK_SELECT
-                                          TOK_SELEXPR
-                                             TOK_TABLE_OR_COL
-                                                key
-                                          TOK_SELEXPR
-                                             TOK_TABLE_OR_COL
-                                                count
-                                       TOK_WHERE
-                                          <
-                                             TOK_TABLE_OR_COL
-                                                key
-                                             10
-                                 TOK_QUERY
-                                    TOK_FROM
-                                       TOK_TABREF
-                                          TOK_TABNAME
-                                             src3
-                                    TOK_INSERT
-                                       TOK_DESTINATION
-                                          TOK_DIR
-                                             TOK_TMP_FILE
-                                       TOK_SELECT
-                                          TOK_SELEXPR
-                                             TOK_TABLE_OR_COL
-                                                key
-                                          TOK_SELEXPR
-                                             TOK_TABLE_OR_COL
-                                                count
-                                       TOK_WHERE
-                                          <
-                                             TOK_TABLE_OR_COL
-                                                key
-                                             10
-                              _u1
-                        TOK_INSERT
-                           TOK_DESTINATION
-                              TOK_DIR
-                                 TOK_TMP_FILE
-                           TOK_SELECTDI
-                              TOK_SELEXPR
-                                 TOK_ALLCOLREF
-                     TOK_QUERY
-                        TOK_FROM
-                           TOK_JOIN
-                              TOK_TABREF
-                                 TOK_TABNAME
-                                    src4
-                                 a
-                              TOK_TABREF
-                                 TOK_TABNAME
-                                    src5
-                                 b
-                              =
-                                 .
-                                    TOK_TABLE_OR_COL
-                                       a
-                                    key
-                                 .
-                                    TOK_TABLE_OR_COL
-                                       b
-                                    key
-                        TOK_INSERT
-                           TOK_DESTINATION
-                              TOK_DIR
-                                 TOK_TMP_FILE
-                           TOK_SELECT
-                              TOK_SELEXPR
-                                 .
-                                    TOK_TABLE_OR_COL
-                                       a
-                                    key
-                                 key
-                              TOK_SELEXPR
-                                 TOK_FUNCTION
-                                    count
-                                    1
-                                 count
-                           TOK_WHERE
-                              <
-                                 .
-                                    TOK_TABLE_OR_COL
-                                       a
-                                    key
-                                 10
-                           TOK_GROUPBY
-                              .
-                                 TOK_TABLE_OR_COL
-                                    a
-                                 key
-                  _u2
-            TOK_INSERT
-               TOK_DESTINATION
-                  TOK_DIR
-                     TOK_TMP_FILE
-               TOK_SELECTDI
-                  TOK_SELEXPR
-                     TOK_ALLCOLREF
-         s
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  s
-               key
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  s
-               count
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1, Stage-5
diff --git a/ql/src/test/results/clientpositive/union_ppr.q.out b/ql/src/test/results/clientpositive/union_ppr.q.out
index 11c6dceff5..c5b11938c0 100644
--- a/ql/src/test/results/clientpositive/union_ppr.q.out
+++ b/ql/src/test/results/clientpositive/union_ppr.q.out
@@ -20,98 +20,6 @@ SELECT * FROM (
 WHERE A.ds = '2008-04-08'
 SORT BY A.key, A.value, A.ds, A.hr
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_UNIONALL
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        SRCPART
-                     X
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_ALLCOLREF
-                           TOK_TABNAME
-                              X
-                  TOK_WHERE
-                     <
-                        .
-                           TOK_TABLE_OR_COL
-                              X
-                           key
-                        100
-            TOK_QUERY
-               TOK_FROM
-                  TOK_TABREF
-                     TOK_TABNAME
-                        SRCPART
-                     Y
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_ALLCOLREF
-                           TOK_TABNAME
-                              Y
-                  TOK_WHERE
-                     <
-                        .
-                           TOK_TABLE_OR_COL
-                              Y
-                           key
-                        100
-         A
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-      TOK_WHERE
-         =
-            .
-               TOK_TABLE_OR_COL
-                  A
-               ds
-            '2008-04-08'
-      TOK_SORTBY
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               .
-                  TOK_TABLE_OR_COL
-                     A
-                  key
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               .
-                  TOK_TABLE_OR_COL
-                     A
-                  value
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               .
-                  TOK_TABLE_OR_COL
-                     A
-                  ds
-         TOK_TABSORTCOLNAMEASC
-            TOK_NULLS_FIRST
-               .
-                  TOK_TABLE_OR_COL
-                     A
-                  hr
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/vectorized_ptf.q.out b/ql/src/test/results/clientpositive/vectorized_ptf.q.out
index 3b17591247..fc4351d211 100644
--- a/ql/src/test/results/clientpositive/vectorized_ptf.q.out
+++ b/ql/src/test/results/clientpositive/vectorized_ptf.q.out
@@ -142,88 +142,6 @@ from noop(on part_orc
   order by p_name
   )
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noop
-         TOK_TABREF
-            TOK_TABNAME
-               part_orc
-         TOK_PARTITIONINGSPEC
-            TOK_DISTRIBUTEBY
-               TOK_TABLE_OR_COL
-                  p_mfgr
-            TOK_ORDERBY
-               TOK_TABSORTCOLNAMEASC
-                  TOK_NULLS_FIRST
-                     TOK_TABLE_OR_COL
-                        p_name
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            TOK_FUNCTION
-               rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            r
-         TOK_SELEXPR
-            TOK_FUNCTION
-               dense_rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            dr
-         TOK_SELEXPR
-            TOK_FUNCTION
-               sum
-               TOK_TABLE_OR_COL
-                  p_retailprice
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-                  TOK_WINDOWRANGE
-                     preceding
-                        unbounded
-                     current
-            s1
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -512,94 +430,6 @@ from noop (on (select p1.* from part_orc p1 join part_orc p2 on p1.p_partkey = p
 distribute by j.p_mfgr
 sort by j.p_name)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noop
-         TOK_SUBQUERY
-            TOK_QUERY
-               TOK_FROM
-                  TOK_JOIN
-                     TOK_TABREF
-                        TOK_TABNAME
-                           part_orc
-                        p1
-                     TOK_TABREF
-                        TOK_TABNAME
-                           part_orc
-                        p2
-                     =
-                        .
-                           TOK_TABLE_OR_COL
-                              p1
-                           p_partkey
-                        .
-                           TOK_TABLE_OR_COL
-                              p2
-                           p_partkey
-               TOK_INSERT
-                  TOK_DESTINATION
-                     TOK_DIR
-                        TOK_TMP_FILE
-                  TOK_SELECT
-                     TOK_SELEXPR
-                        TOK_ALLCOLREF
-                           TOK_TABNAME
-                              p1
-            j
-         TOK_PARTITIONINGSPEC
-            TOK_DISTRIBUTEBY
-               .
-                  TOK_TABLE_OR_COL
-                     j
-                  p_mfgr
-            TOK_SORTBY
-               TOK_TABSORTCOLNAMEASC
-                  TOK_NULLS_FIRST
-                     .
-                        TOK_TABLE_OR_COL
-                           j
-                        p_name
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            -
-               TOK_TABLE_OR_COL
-                  p_size
-               TOK_FUNCTION
-                  lag
-                  TOK_TABLE_OR_COL
-                     p_size
-                  1
-                  TOK_TABLE_OR_COL
-                     p_size
-                  TOK_WINDOWSPEC
-                     TOK_PARTITIONINGSPEC
-                        TOK_DISTRIBUTEBY
-                           TOK_TABLE_OR_COL
-                              p_mfgr
-                        TOK_ORDERBY
-                           TOK_TABSORTCOLNAMEASC
-                              TOK_NULLS_FIRST
-                                 TOK_TABLE_OR_COL
-                                    p_name
-            deltaSz
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -956,40 +786,6 @@ from noop(on part_orc
 partition by p_mfgr
 order by p_name)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noop
-         TOK_TABREF
-            TOK_TABNAME
-               part_orc
-         TOK_PARTITIONINGSPEC
-            TOK_DISTRIBUTEBY
-               TOK_TABLE_OR_COL
-                  p_mfgr
-            TOK_ORDERBY
-               TOK_TABSORTCOLNAMEASC
-                  TOK_NULLS_FIRST
-                     TOK_TABLE_OR_COL
-                        p_name
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -1178,89 +974,6 @@ from noop(on part_orc
   order by p_name
   ) abc
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noop
-         abc
-         TOK_TABREF
-            TOK_TABNAME
-               part_orc
-         TOK_PARTITIONINGSPEC
-            TOK_DISTRIBUTEBY
-               TOK_TABLE_OR_COL
-                  p_mfgr
-            TOK_ORDERBY
-               TOK_TABSORTCOLNAMEASC
-                  TOK_NULLS_FIRST
-                     TOK_TABLE_OR_COL
-                        p_name
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            TOK_FUNCTION
-               rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            r
-         TOK_SELEXPR
-            TOK_FUNCTION
-               dense_rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            dr
-         TOK_SELEXPR
-            TOK_FUNCTION
-               sum
-               TOK_TABLE_OR_COL
-                  p_retailprice
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-                  TOK_WINDOWRANGE
-                     preceding
-                        unbounded
-                     current
-            s1
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -1555,93 +1268,6 @@ from noop(on part_orc
           order by p_name 
           )
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noop
-         TOK_TABREF
-            TOK_TABNAME
-               part_orc
-         TOK_PARTITIONINGSPEC
-            TOK_DISTRIBUTEBY
-               TOK_TABLE_OR_COL
-                  p_mfgr
-            TOK_ORDERBY
-               TOK_TABSORTCOLNAMEASC
-                  TOK_NULLS_FIRST
-                     TOK_TABLE_OR_COL
-                        p_name
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            TOK_FUNCTION
-               rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            r
-         TOK_SELEXPR
-            TOK_FUNCTION
-               dense_rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            dr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            -
-               TOK_TABLE_OR_COL
-                  p_size
-               TOK_FUNCTION
-                  lag
-                  TOK_TABLE_OR_COL
-                     p_size
-                  1
-                  TOK_TABLE_OR_COL
-                     p_size
-                  TOK_WINDOWSPEC
-                     TOK_PARTITIONINGSPEC
-                        TOK_DISTRIBUTEBY
-                           TOK_TABLE_OR_COL
-                              p_mfgr
-                        TOK_ORDERBY
-                           TOK_TABSORTCOLNAMEASC
-                              TOK_NULLS_FIRST
-                                 TOK_TABLE_OR_COL
-                                    p_name
-            deltaSz
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -1939,100 +1565,6 @@ from noop(on part_orc
           ) 
 group by p_mfgr, p_name, p_size
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noop
-         TOK_TABREF
-            TOK_TABNAME
-               part_orc
-         TOK_PARTITIONINGSPEC
-            TOK_DISTRIBUTEBY
-               TOK_TABLE_OR_COL
-                  p_mfgr
-            TOK_ORDERBY
-               TOK_TABSORTCOLNAMEASC
-                  TOK_NULLS_FIRST
-                     TOK_TABLE_OR_COL
-                        p_name
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            TOK_FUNCTION
-               rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            r
-         TOK_SELEXPR
-            TOK_FUNCTION
-               dense_rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            dr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            -
-               TOK_TABLE_OR_COL
-                  p_size
-               TOK_FUNCTION
-                  lag
-                  TOK_TABLE_OR_COL
-                     p_size
-                  1
-                  TOK_TABLE_OR_COL
-                     p_size
-                  TOK_WINDOWSPEC
-                     TOK_PARTITIONINGSPEC
-                        TOK_DISTRIBUTEBY
-                           TOK_TABLE_OR_COL
-                              p_mfgr
-                        TOK_ORDERBY
-                           TOK_TABSORTCOLNAMEASC
-                              TOK_NULLS_FIRST
-                                 TOK_TABLE_OR_COL
-                                    p_name
-            deltaSz
-      TOK_GROUPBY
-         TOK_TABLE_OR_COL
-            p_mfgr
-         TOK_TABLE_OR_COL
-            p_name
-         TOK_TABLE_OR_COL
-            p_size
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -2332,50 +1864,6 @@ partition by p_mfgr
 order by p_name 
 ) abc join part_orc p1 on abc.p_partkey = p1.p_partkey
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_PTBLFUNCTION
-            noop
-            abc
-            TOK_TABREF
-               TOK_TABNAME
-                  part_orc
-            TOK_PARTITIONINGSPEC
-               TOK_DISTRIBUTEBY
-                  TOK_TABLE_OR_COL
-                     p_mfgr
-               TOK_ORDERBY
-                  TOK_TABSORTCOLNAMEASC
-                     TOK_NULLS_FIRST
-                        TOK_TABLE_OR_COL
-                           p_name
-         TOK_TABREF
-            TOK_TABNAME
-               part_orc
-            p1
-         =
-            .
-               TOK_TABLE_OR_COL
-                  abc
-               p_partkey
-            .
-               TOK_TABLE_OR_COL
-                  p1
-               p_partkey
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-               TOK_TABNAME
-                  abc
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -2691,50 +2179,6 @@ partition by p_mfgr
 order by p_name 
 ) abc on abc.p_partkey = p1.p_partkey
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_TABREF
-            TOK_TABNAME
-               part_orc
-            p1
-         TOK_PTBLFUNCTION
-            noop
-            abc
-            TOK_TABREF
-               TOK_TABNAME
-                  part_orc
-            TOK_PARTITIONINGSPEC
-               TOK_DISTRIBUTEBY
-                  TOK_TABLE_OR_COL
-                     p_mfgr
-               TOK_ORDERBY
-                  TOK_TABSORTCOLNAMEASC
-                     TOK_NULLS_FIRST
-                        TOK_TABLE_OR_COL
-                           p_name
-         =
-            .
-               TOK_TABLE_OR_COL
-                  abc
-               p_partkey
-            .
-               TOK_TABLE_OR_COL
-                  p1
-               p_partkey
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_ALLCOLREF
-               TOK_TABNAME
-                  abc
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-1 depends on stages: Stage-2
@@ -3054,62 +2498,6 @@ from noopwithmap(on part_orc
 partition by p_mfgr
 order by p_name, p_size desc)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noopwithmap
-         TOK_TABREF
-            TOK_TABNAME
-               part_orc
-         TOK_PARTITIONINGSPEC
-            TOK_DISTRIBUTEBY
-               TOK_TABLE_OR_COL
-                  p_mfgr
-            TOK_ORDERBY
-               TOK_TABSORTCOLNAMEASC
-                  TOK_NULLS_FIRST
-                     TOK_TABLE_OR_COL
-                        p_name
-               TOK_TABSORTCOLNAMEDESC
-                  TOK_NULLS_LAST
-                     TOK_TABLE_OR_COL
-                        p_size
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            TOK_FUNCTION
-               rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-                        TOK_TABSORTCOLNAMEDESC
-                           TOK_NULLS_LAST
-                              TOK_TABLE_OR_COL
-                                 p_size
-            r
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -3397,88 +2785,6 @@ from noopwithmap(on part_orc
   partition by p_mfgr
   order by p_name)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noopwithmap
-         TOK_TABREF
-            TOK_TABNAME
-               part_orc
-         TOK_PARTITIONINGSPEC
-            TOK_DISTRIBUTEBY
-               TOK_TABLE_OR_COL
-                  p_mfgr
-            TOK_ORDERBY
-               TOK_TABSORTCOLNAMEASC
-                  TOK_NULLS_FIRST
-                     TOK_TABLE_OR_COL
-                        p_name
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            TOK_FUNCTION
-               rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            r
-         TOK_SELEXPR
-            TOK_FUNCTION
-               dense_rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            dr
-         TOK_SELEXPR
-            TOK_FUNCTION
-               sum
-               TOK_TABLE_OR_COL
-                  p_retailprice
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-                  TOK_WINDOWRANGE
-                     preceding
-                        unbounded
-                     current
-            s1
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -3785,88 +3091,6 @@ from noop(on part_orc
 partition by p_mfgr
 order by p_name)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noop
-         TOK_TABREF
-            TOK_TABNAME
-               part_orc
-         TOK_PARTITIONINGSPEC
-            TOK_DISTRIBUTEBY
-               TOK_TABLE_OR_COL
-                  p_mfgr
-            TOK_ORDERBY
-               TOK_TABSORTCOLNAMEASC
-                  TOK_NULLS_FIRST
-                     TOK_TABLE_OR_COL
-                        p_name
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            TOK_FUNCTION
-               rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            r
-         TOK_SELEXPR
-            TOK_FUNCTION
-               dense_rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            dr
-         TOK_SELEXPR
-            TOK_FUNCTION
-               sum
-               TOK_TABLE_OR_COL
-                  p_retailprice
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-                  TOK_WINDOWRANGE
-                     preceding
-                        unbounded
-                     current
-            s1
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -4159,96 +3383,6 @@ partition by p_mfgr
 order by p_mfgr, p_name
 )))
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noop
-         TOK_PTBLFUNCTION
-            noopwithmap
-            TOK_PTBLFUNCTION
-               noop
-               TOK_TABREF
-                  TOK_TABNAME
-                     part_orc
-               TOK_PARTITIONINGSPEC
-                  TOK_DISTRIBUTEBY
-                     TOK_TABLE_OR_COL
-                        p_mfgr
-                  TOK_ORDERBY
-                     TOK_TABSORTCOLNAMEASC
-                        TOK_NULLS_FIRST
-                           TOK_TABLE_OR_COL
-                              p_mfgr
-                     TOK_TABSORTCOLNAMEASC
-                        TOK_NULLS_FIRST
-                           TOK_TABLE_OR_COL
-                              p_name
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            TOK_FUNCTION
-               rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            r
-         TOK_SELEXPR
-            TOK_FUNCTION
-               dense_rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            dr
-         TOK_SELEXPR
-            TOK_FUNCTION
-               sum
-               TOK_TABLE_OR_COL
-                  p_retailprice
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-                  TOK_WINDOWRANGE
-                     preceding
-                        unbounded
-                     current
-            s1
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -4658,107 +3792,6 @@ order by p_name)
 window w1 as (partition by p_mfgr order by p_name rows between 2 preceding and 2 following) 
 ) sub1
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_SUBQUERY
-         TOK_QUERY
-            TOK_FROM
-               TOK_PTBLFUNCTION
-                  noop
-                  TOK_TABREF
-                     TOK_TABNAME
-                        part_orc
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            TOK_INSERT
-               TOK_DESTINATION
-                  TOK_DIR
-                     TOK_TMP_FILE
-               TOK_SELECT
-                  TOK_SELEXPR
-                     TOK_TABLE_OR_COL
-                        p_mfgr
-                  TOK_SELEXPR
-                     TOK_TABLE_OR_COL
-                        p_name
-                  TOK_SELEXPR
-                     TOK_FUNCTION
-                        count
-                        TOK_TABLE_OR_COL
-                           p_size
-                        TOK_WINDOWSPEC
-                           TOK_PARTITIONINGSPEC
-                              TOK_DISTRIBUTEBY
-                                 TOK_TABLE_OR_COL
-                                    p_mfgr
-                              TOK_ORDERBY
-                                 TOK_TABSORTCOLNAMEASC
-                                    TOK_NULLS_FIRST
-                                       TOK_TABLE_OR_COL
-                                          p_name
-                     cd
-                  TOK_SELEXPR
-                     TOK_TABLE_OR_COL
-                        p_retailprice
-                  TOK_SELEXPR
-                     TOK_FUNCTION
-                        sum
-                        TOK_TABLE_OR_COL
-                           p_retailprice
-                        TOK_WINDOWSPEC
-                           w1
-                     s1
-               window
-                  TOK_WINDOWDEF
-                     w1
-                     TOK_WINDOWSPEC
-                        TOK_PARTITIONINGSPEC
-                           TOK_DISTRIBUTEBY
-                              TOK_TABLE_OR_COL
-                                 p_mfgr
-                           TOK_ORDERBY
-                              TOK_TABSORTCOLNAMEASC
-                                 TOK_NULLS_FIRST
-                                    TOK_TABLE_OR_COL
-                                       p_name
-                        TOK_WINDOWRANGE
-                           preceding
-                              2
-                           following
-                              2
-         sub1
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  sub1
-               cd
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  sub1
-               s1
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -5055,182 +4088,6 @@ partition by p_mfgr
 order by p_name 
 ) abc join part_orc p1 on abc.p_partkey = p1.p_partkey
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_JOIN
-         TOK_PTBLFUNCTION
-            noop
-            abc
-            TOK_TABREF
-               TOK_TABNAME
-                  part_orc
-            TOK_PARTITIONINGSPEC
-               TOK_DISTRIBUTEBY
-                  TOK_TABLE_OR_COL
-                     p_mfgr
-               TOK_ORDERBY
-                  TOK_TABSORTCOLNAMEASC
-                     TOK_NULLS_FIRST
-                        TOK_TABLE_OR_COL
-                           p_name
-         TOK_TABREF
-            TOK_TABNAME
-               part_orc
-            p1
-         =
-            .
-               TOK_TABLE_OR_COL
-                  abc
-               p_partkey
-            .
-               TOK_TABLE_OR_COL
-                  p1
-               p_partkey
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  abc
-               p_mfgr
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  abc
-               p_name
-         TOK_SELEXPR
-            TOK_FUNCTION
-               rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        .
-                           TOK_TABLE_OR_COL
-                              abc
-                           p_mfgr
-                     TOK_SORTBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              .
-                                 TOK_TABLE_OR_COL
-                                    abc
-                                 p_name
-            r
-         TOK_SELEXPR
-            TOK_FUNCTION
-               dense_rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        .
-                           TOK_TABLE_OR_COL
-                              abc
-                           p_mfgr
-                     TOK_SORTBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              .
-                                 TOK_TABLE_OR_COL
-                                    abc
-                                 p_name
-            dr
-         TOK_SELEXPR
-            TOK_FUNCTION
-               count
-               .
-                  TOK_TABLE_OR_COL
-                     abc
-                  p_name
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        .
-                           TOK_TABLE_OR_COL
-                              abc
-                           p_mfgr
-                     TOK_SORTBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              .
-                                 TOK_TABLE_OR_COL
-                                    abc
-                                 p_name
-            cd
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  abc
-               p_retailprice
-         TOK_SELEXPR
-            TOK_FUNCTION
-               sum
-               .
-                  TOK_TABLE_OR_COL
-                     abc
-                  p_retailprice
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        .
-                           TOK_TABLE_OR_COL
-                              abc
-                           p_mfgr
-                     TOK_SORTBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              .
-                                 TOK_TABLE_OR_COL
-                                    abc
-                                 p_name
-                  TOK_WINDOWRANGE
-                     preceding
-                        unbounded
-                     current
-            s1
-         TOK_SELEXPR
-            .
-               TOK_TABLE_OR_COL
-                  abc
-               p_size
-         TOK_SELEXPR
-            -
-               .
-                  TOK_TABLE_OR_COL
-                     abc
-                  p_size
-               TOK_FUNCTION
-                  lag
-                  .
-                     TOK_TABLE_OR_COL
-                        abc
-                     p_size
-                  1
-                  .
-                     TOK_TABLE_OR_COL
-                        abc
-                     p_size
-                  TOK_WINDOWSPEC
-                     TOK_PARTITIONINGSPEC
-                        TOK_DISTRIBUTEBY
-                           .
-                              TOK_TABLE_OR_COL
-                                 abc
-                              p_mfgr
-                        TOK_SORTBY
-                           TOK_TABSORTCOLNAMEASC
-                              TOK_NULLS_FIRST
-                                 .
-                                    TOK_TABLE_OR_COL
-                                       abc
-                                    p_name
-            deltaSz
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -5669,40 +4526,6 @@ from noop(on part_orc
 partition by p_mfgr 
 order by p_name)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noop
-         TOK_TABREF
-            TOK_TABNAME
-               part_orc
-         TOK_PARTITIONINGSPEC
-            TOK_DISTRIBUTEBY
-               TOK_TABLE_OR_COL
-                  p_mfgr
-            TOK_ORDERBY
-               TOK_TABSORTCOLNAMEASC
-                  TOK_NULLS_FIRST
-                     TOK_TABLE_OR_COL
-                        p_name
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECTDI
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -5971,65 +4794,6 @@ partition by p_mfgr
 order by p_mfgr)  
 window w1 as ( partition by p_mfgr order by p_brand rows between 2 preceding and current row)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noop
-         TOK_TABREF
-            TOK_TABNAME
-               mfgr_price_view
-         TOK_PARTITIONINGSPEC
-            TOK_DISTRIBUTEBY
-               TOK_TABLE_OR_COL
-                  p_mfgr
-            TOK_ORDERBY
-               TOK_TABSORTCOLNAMEASC
-                  TOK_NULLS_FIRST
-                     TOK_TABLE_OR_COL
-                        p_mfgr
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_brand
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               s
-         TOK_SELEXPR
-            TOK_FUNCTION
-               sum
-               TOK_TABLE_OR_COL
-                  s
-               TOK_WINDOWSPEC
-                  w1
-            s1
-      window
-         TOK_WINDOWDEF
-            w1
-            TOK_WINDOWSPEC
-               TOK_PARTITIONINGSPEC
-                  TOK_DISTRIBUTEBY
-                     TOK_TABLE_OR_COL
-                        p_mfgr
-                  TOK_ORDERBY
-                     TOK_TABSORTCOLNAMEASC
-                        TOK_NULLS_FIRST
-                           TOK_TABLE_OR_COL
-                              p_brand
-               TOK_WINDOWRANGE
-                  preceding
-                     2
-                  current
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -6364,212 +5128,6 @@ cume_dist() over (distribute by p_mfgr sort by p_mfgr, p_name) as cud,
 first_value(p_size, true) over w1  as fv1
 window w1 as (distribute by p_mfgr sort by p_mfgr, p_name rows between 2 preceding and 2 following)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noop
-         TOK_TABREF
-            TOK_TABNAME
-               part_orc
-         TOK_PARTITIONINGSPEC
-            TOK_DISTRIBUTEBY
-               TOK_TABLE_OR_COL
-                  p_mfgr
-            TOK_ORDERBY
-               TOK_TABSORTCOLNAMEASC
-                  TOK_NULLS_FIRST
-                     TOK_TABLE_OR_COL
-                        p_name
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               part_4
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            TOK_FUNCTION
-               rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_SORTBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            r
-         TOK_SELEXPR
-            TOK_FUNCTION
-               dense_rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_SORTBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            dr
-         TOK_SELEXPR
-            TOK_FUNCTION
-               sum
-               TOK_TABLE_OR_COL
-                  p_retailprice
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_SORTBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-                  TOK_WINDOWRANGE
-                     preceding
-                        unbounded
-                     current
-            s
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_TAB
-            TOK_TABNAME
-               part_5
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            TOK_FUNCTION
-               round
-               TOK_FUNCTION
-                  sum
-                  TOK_TABLE_OR_COL
-                     p_size
-                  TOK_WINDOWSPEC
-                     TOK_PARTITIONINGSPEC
-                        TOK_DISTRIBUTEBY
-                           TOK_TABLE_OR_COL
-                              p_mfgr
-                        TOK_SORTBY
-                           TOK_TABSORTCOLNAMEASC
-                              TOK_NULLS_FIRST
-                                 TOK_TABLE_OR_COL
-                                    p_size
-                     TOK_WINDOWVALUES
-                        preceding
-                           5
-                        current
-               1
-            s2
-         TOK_SELEXPR
-            TOK_FUNCTION
-               rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_SORTBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_mfgr
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            r
-         TOK_SELEXPR
-            TOK_FUNCTION
-               dense_rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_SORTBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_mfgr
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            dr
-         TOK_SELEXPR
-            TOK_FUNCTION
-               cume_dist
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_SORTBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_mfgr
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            cud
-         TOK_SELEXPR
-            TOK_FUNCTION
-               first_value
-               TOK_TABLE_OR_COL
-                  p_size
-               true
-               TOK_WINDOWSPEC
-                  w1
-            fv1
-      window
-         TOK_WINDOWDEF
-            w1
-            TOK_WINDOWSPEC
-               TOK_PARTITIONINGSPEC
-                  TOK_DISTRIBUTEBY
-                     TOK_TABLE_OR_COL
-                        p_mfgr
-                  TOK_SORTBY
-                     TOK_TABSORTCOLNAMEASC
-                        TOK_NULLS_FIRST
-                           TOK_TABLE_OR_COL
-                              p_mfgr
-                     TOK_TABSORTCOLNAMEASC
-                        TOK_NULLS_FIRST
-                           TOK_TABLE_OR_COL
-                              p_name
-               TOK_WINDOWRANGE
-                  preceding
-                     2
-                  following
-                     2
-
-
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-3 depends on stages: Stage-2
@@ -7224,115 +5782,6 @@ from noop(on
         partition by p_mfgr,p_name  
         order by p_mfgr,p_name)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noop
-         TOK_PTBLFUNCTION
-            noopwithmap
-            TOK_PTBLFUNCTION
-               noop
-               TOK_PTBLFUNCTION
-                  noop
-                  TOK_TABREF
-                     TOK_TABNAME
-                        part_orc
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_mfgr
-            TOK_PARTITIONINGSPEC
-               TOK_DISTRIBUTEBY
-                  TOK_TABLE_OR_COL
-                     p_mfgr
-                  TOK_TABLE_OR_COL
-                     p_name
-               TOK_ORDERBY
-                  TOK_TABSORTCOLNAMEASC
-                     TOK_NULLS_FIRST
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                  TOK_TABSORTCOLNAMEASC
-                     TOK_NULLS_FIRST
-                        TOK_TABLE_OR_COL
-                           p_name
-         TOK_PARTITIONINGSPEC
-            TOK_DISTRIBUTEBY
-               TOK_TABLE_OR_COL
-                  p_mfgr
-               TOK_TABLE_OR_COL
-                  p_name
-            TOK_ORDERBY
-               TOK_TABSORTCOLNAMEASC
-                  TOK_NULLS_FIRST
-                     TOK_TABLE_OR_COL
-                        p_mfgr
-               TOK_TABSORTCOLNAMEASC
-                  TOK_NULLS_FIRST
-                     TOK_TABLE_OR_COL
-                        p_name
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_FUNCTION
-               rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                        TOK_TABLE_OR_COL
-                           p_name
-            r
-         TOK_SELEXPR
-            TOK_FUNCTION
-               dense_rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                        TOK_TABLE_OR_COL
-                           p_name
-            dr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            TOK_FUNCTION
-               sum
-               TOK_TABLE_OR_COL
-                  p_size
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                        TOK_TABLE_OR_COL
-                           p_name
-                  TOK_WINDOWRANGE
-                     preceding
-                        unbounded
-                     current
-            s1
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -7771,118 +6220,6 @@ from noop(on
         partition by p_mfgr  
         order by p_mfgr )
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noop
-         TOK_PTBLFUNCTION
-            noop
-            TOK_PTBLFUNCTION
-               noop
-               TOK_PTBLFUNCTION
-                  noop
-                  TOK_TABREF
-                     TOK_TABNAME
-                        part_orc
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_mfgr
-            TOK_PARTITIONINGSPEC
-               TOK_DISTRIBUTEBY
-                  TOK_TABLE_OR_COL
-                     p_mfgr
-                  TOK_TABLE_OR_COL
-                     p_name
-               TOK_ORDERBY
-                  TOK_TABSORTCOLNAMEASC
-                     TOK_NULLS_FIRST
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                  TOK_TABSORTCOLNAMEASC
-                     TOK_NULLS_FIRST
-                        TOK_TABLE_OR_COL
-                           p_name
-         TOK_PARTITIONINGSPEC
-            TOK_DISTRIBUTEBY
-               TOK_TABLE_OR_COL
-                  p_mfgr
-            TOK_ORDERBY
-               TOK_TABSORTCOLNAMEASC
-                  TOK_NULLS_FIRST
-                     TOK_TABLE_OR_COL
-                        p_mfgr
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_FUNCTION
-               rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            r
-         TOK_SELEXPR
-            TOK_FUNCTION
-               dense_rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            dr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            TOK_FUNCTION
-               sum
-               TOK_TABLE_OR_COL
-                  p_size
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-                  TOK_WINDOWRANGE
-                     preceding
-                        unbounded
-                     current
-            s1
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -8364,105 +6701,6 @@ from noop(on
           partition by p_mfgr 
           order by p_mfgr))
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noop
-         TOK_PTBLFUNCTION
-            noop
-            TOK_PTBLFUNCTION
-               noop
-               TOK_PTBLFUNCTION
-                  noop
-                  TOK_TABREF
-                     TOK_TABNAME
-                        part_orc
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                        TOK_TABLE_OR_COL
-                           p_name
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_mfgr
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            TOK_PARTITIONINGSPEC
-               TOK_DISTRIBUTEBY
-                  TOK_TABLE_OR_COL
-                     p_mfgr
-               TOK_ORDERBY
-                  TOK_TABSORTCOLNAMEASC
-                     TOK_NULLS_FIRST
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_FUNCTION
-               rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            r
-         TOK_SELEXPR
-            TOK_FUNCTION
-               dense_rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            dr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            TOK_FUNCTION
-               sum
-               TOK_TABLE_OR_COL
-                  p_size
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            s1
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -8873,115 +7111,6 @@ from noopwithmap(on
           partition by p_mfgr,p_name 
           order by p_mfgr,p_name)
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noopwithmap
-         TOK_PTBLFUNCTION
-            noop
-            TOK_PTBLFUNCTION
-               noop
-               TOK_PTBLFUNCTION
-                  noop
-                  TOK_TABREF
-                     TOK_TABNAME
-                        part_orc
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                        TOK_TABLE_OR_COL
-                           p_name
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_mfgr
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            TOK_PARTITIONINGSPEC
-               TOK_DISTRIBUTEBY
-                  TOK_TABLE_OR_COL
-                     p_mfgr
-               TOK_ORDERBY
-                  TOK_TABSORTCOLNAMEASC
-                     TOK_NULLS_FIRST
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-         TOK_PARTITIONINGSPEC
-            TOK_DISTRIBUTEBY
-               TOK_TABLE_OR_COL
-                  p_mfgr
-               TOK_TABLE_OR_COL
-                  p_name
-            TOK_ORDERBY
-               TOK_TABSORTCOLNAMEASC
-                  TOK_NULLS_FIRST
-                     TOK_TABLE_OR_COL
-                        p_mfgr
-               TOK_TABSORTCOLNAMEASC
-                  TOK_NULLS_FIRST
-                     TOK_TABLE_OR_COL
-                        p_name
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_FUNCTION
-               rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                        TOK_TABLE_OR_COL
-                           p_name
-            r
-         TOK_SELEXPR
-            TOK_FUNCTION
-               dense_rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                        TOK_TABLE_OR_COL
-                           p_name
-            dr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            TOK_FUNCTION
-               sum
-               TOK_TABLE_OR_COL
-                  p_size
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                        TOK_TABLE_OR_COL
-                           p_name
-                  TOK_WINDOWRANGE
-                     preceding
-                        unbounded
-                     current
-            s1
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -9482,151 +7611,6 @@ from noop(on
           order by p_mfgr
           ))
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noop
-         TOK_PTBLFUNCTION
-            noopwithmap
-            TOK_PTBLFUNCTION
-               noop
-               TOK_TABREF
-                  TOK_TABNAME
-                     part_orc
-               TOK_PARTITIONINGSPEC
-                  TOK_DISTRIBUTEBY
-                     TOK_TABLE_OR_COL
-                        p_mfgr
-                     TOK_TABLE_OR_COL
-                        p_name
-                  TOK_ORDERBY
-                     TOK_TABSORTCOLNAMEASC
-                        TOK_NULLS_FIRST
-                           TOK_TABLE_OR_COL
-                              p_mfgr
-                     TOK_TABSORTCOLNAMEASC
-                        TOK_NULLS_FIRST
-                           TOK_TABLE_OR_COL
-                              p_name
-            TOK_PARTITIONINGSPEC
-               TOK_DISTRIBUTEBY
-                  TOK_TABLE_OR_COL
-                     p_mfgr
-               TOK_ORDERBY
-                  TOK_TABSORTCOLNAMEASC
-                     TOK_NULLS_FIRST
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_FUNCTION
-               rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                        TOK_TABLE_OR_COL
-                           p_name
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_mfgr
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            r
-         TOK_SELEXPR
-            TOK_FUNCTION
-               dense_rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                        TOK_TABLE_OR_COL
-                           p_name
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_mfgr
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            dr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            TOK_FUNCTION
-               sum
-               TOK_TABLE_OR_COL
-                  p_size
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                        TOK_TABLE_OR_COL
-                           p_name
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_mfgr
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-                  TOK_WINDOWRANGE
-                     preceding
-                        unbounded
-                     current
-            s1
-         TOK_SELEXPR
-            TOK_FUNCTION
-               sum
-               TOK_TABLE_OR_COL
-                  p_size
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                        TOK_TABLE_OR_COL
-                           p_name
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_mfgr
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-                  TOK_WINDOWRANGE
-                     preceding
-                        unbounded
-                     current
-            s2
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -10050,118 +8034,6 @@ from noopwithmap(on
               order by p_mfgr, p_name) 
           ))
 POSTHOOK: type: QUERY
-ABSTRACT SYNTAX TREE:
-  
-TOK_QUERY
-   TOK_FROM
-      TOK_PTBLFUNCTION
-         noopwithmap
-         TOK_PTBLFUNCTION
-            noop
-            TOK_PTBLFUNCTION
-               noop
-               TOK_TABREF
-                  TOK_TABNAME
-                     part_orc
-               TOK_PARTITIONINGSPEC
-                  TOK_DISTRIBUTEBY
-                     TOK_TABLE_OR_COL
-                        p_mfgr
-                     TOK_TABLE_OR_COL
-                        p_name
-                  TOK_ORDERBY
-                     TOK_TABSORTCOLNAMEASC
-                        TOK_NULLS_FIRST
-                           TOK_TABLE_OR_COL
-                              p_mfgr
-                     TOK_TABSORTCOLNAMEASC
-                        TOK_NULLS_FIRST
-                           TOK_TABLE_OR_COL
-                              p_name
-   TOK_INSERT
-      TOK_DESTINATION
-         TOK_DIR
-            TOK_TMP_FILE
-      TOK_SELECT
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_mfgr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_name
-         TOK_SELEXPR
-            TOK_FUNCTION
-               rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            r
-         TOK_SELEXPR
-            TOK_FUNCTION
-               dense_rank
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-            dr
-         TOK_SELEXPR
-            TOK_TABLE_OR_COL
-               p_size
-         TOK_SELEXPR
-            TOK_FUNCTION
-               sum
-               TOK_TABLE_OR_COL
-                  p_size
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-                  TOK_WINDOWVALUES
-                     preceding
-                        unbounded
-                     current
-            s1
-         TOK_SELEXPR
-            TOK_FUNCTION
-               sum
-               TOK_TABLE_OR_COL
-                  p_size
-               TOK_WINDOWSPEC
-                  TOK_PARTITIONINGSPEC
-                     TOK_DISTRIBUTEBY
-                        TOK_TABLE_OR_COL
-                           p_mfgr
-                     TOK_ORDERBY
-                        TOK_TABSORTCOLNAMEASC
-                           TOK_NULLS_FIRST
-                              TOK_TABLE_OR_COL
-                                 p_name
-                  TOK_WINDOWVALUES
-                     preceding
-                        unbounded
-                     current
-            s2
-
-
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
