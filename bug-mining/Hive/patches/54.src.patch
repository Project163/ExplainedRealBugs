diff --git a/CHANGES.txt b/CHANGES.txt
index db8baab1eb..d08bff3a52 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -80,8 +80,11 @@ Trunk (unreleased changes)
 
   BUG FIXES
 
-    HIVE-222. Fixed Group by on a combination of disitinct and non distinct aggregates.
-    (Ashish Thusoo via zshao)
+    HIVE-235. Fixed DynamicSerDe to work with null values with Thrift
+    Protocols that can have missing fields for null values. (zshao)
+
+    HIVE-222. Fixed Group by on a combination of disitinct and non distinct
+    aggregates. (Ashish Thusoo via zshao)
 
     HIVE-161. Fixed xpath x.y when x is a null list. (zshao)
 
diff --git a/data/files/null.txt b/data/files/null.txt
new file mode 100644
index 0000000000..7014a64126
--- /dev/null
+++ b/data/files/null.txt
@@ -0,0 +1,10 @@
+1.01same0
+1.01same1
+1.01same2
+1.01same3
+1.01same4
+\N1same5
+\N\Nsame6
+1.0\Nsame7
+1.01same8
+1.01same9
diff --git a/ql/src/test/queries/clientpositive/input21.q b/ql/src/test/queries/clientpositive/input21.q
new file mode 100644
index 0000000000..ed27476bb3
--- /dev/null
+++ b/ql/src/test/queries/clientpositive/input21.q
@@ -0,0 +1,10 @@
+DROP TABLE src_null;
+
+CREATE TABLE src_null(a STRING, b STRING, c STRING, d STRING) STORED AS TEXTFILE;
+LOAD DATA LOCAL INPATH '../data/files/null.txt' INTO TABLE src_null;
+
+EXPLAIN SELECT * FROM src_null DISTRIBUTE BY c SORT BY d;
+
+SELECT * FROM src_null DISTRIBUTE BY c SORT BY d;
+
+DROP TABLE src_null;
diff --git a/ql/src/test/results/clientpositive/input21.q.out b/ql/src/test/results/clientpositive/input21.q.out
new file mode 100644
index 0000000000..47b1e51698
--- /dev/null
+++ b/ql/src/test/results/clientpositive/input21.q.out
@@ -0,0 +1,63 @@
+ABSTRACT SYNTAX TREE:
+  (TOK_QUERY (TOK_FROM (TOK_TABREF src_null)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR TOK_ALLCOLREF)) (TOK_DISTRIBUTEBY c) (TOK_SORTBY (TOK_TABSORTCOLNAMEASC d))))
+
+STAGE DEPENDENCIES:
+  Stage-1 is a root stage
+  Stage-0 is a root stage
+
+STAGE PLANS:
+  Stage: Stage-1
+    Map Reduce
+      Alias -> Map Operator Tree:
+        src_null 
+            Select Operator
+              expressions:
+                    expr: a
+                    type: string
+                    expr: b
+                    type: string
+                    expr: c
+                    type: string
+                    expr: d
+                    type: string
+              Reduce Output Operator
+                key expressions:
+                      expr: 3
+                      type: string
+                sort order: +
+                Map-reduce partition columns:
+                      expr: 2
+                      type: string
+                tag: -1
+                value expressions:
+                      expr: 0
+                      type: string
+                      expr: 1
+                      type: string
+                      expr: 2
+                      type: string
+                      expr: 3
+                      type: string
+      Reduce Operator Tree:
+        Extract
+          File Output Operator
+            compressed: false
+            table:
+                input format: org.apache.hadoop.mapred.TextInputFormat
+                output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
+
+  Stage: Stage-0
+    Fetch Operator
+      limit: -1
+
+
+1.0	1	same	0
+1.0	1	same	1
+1.0	1	same	2
+1.0	1	same	3
+1.0	1	same	4
+NULL	1	same	5
+NULL	NULL	same	6
+1.0	NULL	same	7
+1.0	1	same	8
+1.0	1	same	9
diff --git a/serde/src/java/org/apache/hadoop/hive/serde2/dynamic_type/DynamicSerDeFieldList.java b/serde/src/java/org/apache/hadoop/hive/serde2/dynamic_type/DynamicSerDeFieldList.java
index ffedc56393..5e55965323 100644
--- a/serde/src/java/org/apache/hadoop/hive/serde2/dynamic_type/DynamicSerDeFieldList.java
+++ b/serde/src/java/org/apache/hadoop/hive/serde2/dynamic_type/DynamicSerDeFieldList.java
@@ -119,17 +119,18 @@ protected DynamicSerDeTypeBase getFieldByName(String fieldname) {
    */
   protected boolean isRealThrift = false;
 
+  protected boolean[] fieldsPresent; 
   public Object deserialize(Object reuse, TProtocol iprot)  throws SerDeException, TException, IllegalAccessException {
     ArrayList<Object> struct = null;
 
     if (reuse == null) {
       struct = new ArrayList<Object>(this.getNumFields());
-      for(int i=0; i<this.getNumFields(); i++) {
+      for(int i=0; i<ordered_types.length; i++) {
         struct.add(null);
       }
     } else {
       struct = (ArrayList<Object>) reuse;
-      assert(struct.size() == this.getNumFields());
+      assert(struct.size() == ordered_types.length);
     }
 
     boolean fastSkips = iprot instanceof org.apache.hadoop.hive.serde2.thrift.SkippableTProtocol;
@@ -137,6 +138,11 @@ public Object deserialize(Object reuse, TProtocol iprot)  throws SerDeException,
     // may need to strip away the STOP marker when in thrift mode
     boolean stopSeen = false;
 
+    if (fieldsPresent == null) {
+      fieldsPresent = new boolean[ordered_types.length];
+    }
+    Arrays.fill(fieldsPresent, false);
+
     // Read the fields.
     for(int i = 0; i < this.getNumFields(); i++) {
       DynamicSerDeTypeBase mt = null;
@@ -189,7 +195,15 @@ public Object deserialize(Object reuse, TProtocol iprot)  throws SerDeException,
       if(thrift_mode) {
         iprot.readFieldEnd();
       }
+      fieldsPresent[orderedId] = true;
     }
+    
+    for(int i = 0; i < ordered_types.length; i++) {
+      if (!fieldsPresent[i]) {
+        struct.set(i, null);
+      }
+    }
+    
     if(thrift_mode && !stopSeen) {
       // strip off the STOP marker, which may be left if all the fields were in the serialization
       iprot.readFieldBegin();
