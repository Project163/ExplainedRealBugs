diff --git a/itests/hive-unit/src/test/java/org/apache/hive/beeline/TestHplSqlViaBeeLine.java b/itests/hive-unit/src/test/java/org/apache/hive/beeline/TestHplSqlViaBeeLine.java
index c4f2d7729b..efe021e659 100644
--- a/itests/hive-unit/src/test/java/org/apache/hive/beeline/TestHplSqlViaBeeLine.java
+++ b/itests/hive-unit/src/test/java/org/apache/hive/beeline/TestHplSqlViaBeeLine.java
@@ -1042,6 +1042,26 @@ public void testHplSqlExitConditionHandler() throws Throwable {
     testScriptFile(SCRIPT_TEXT, args(), "Exit CONDITION Handler invoked.", OutStream.ERR);
   }
 
+  @Test
+  public void testExecuteImmediateSelectCountStatement() throws Throwable {
+    String SCRIPT_TEXT =
+        "DROP TABLE IF EXISTS result;\n" +
+            "CREATE TABLE result (s string);\n" +
+            "execute immediate 'SELECT count(*) from result';";
+    // Inverted match, output should not have NPE
+    testScriptFile(SCRIPT_TEXT, args(), "^(.(?!(ClassCastException)))*$", OutStream.ERR);
+  }
+
+  @Test
+  public void testExecuteSelectCountStatement() throws Throwable {
+    String SCRIPT_TEXT =
+        "DROP TABLE IF EXISTS result;\n" +
+            "CREATE TABLE result (s string);\n" +
+            "execute 'SELECT count(*) from result';";
+    // Inverted match, output should not have NPE
+    testScriptFile(SCRIPT_TEXT, args(), "^(.(?!(ClassCastException)))*$", OutStream.ERR);
+  }
+
   private static List<String> args() {
     return Arrays.asList("-d", BeeLine.BEELINE_DEFAULT_JDBC_DRIVER,
             "-u", miniHS2.getBaseJdbcURL() + ";mode=hplsql", "-n", userName);
diff --git a/service/src/java/org/apache/hive/service/cli/operation/hplsql/HplSqlQueryExecutor.java b/service/src/java/org/apache/hive/service/cli/operation/hplsql/HplSqlQueryExecutor.java
index 9aa25d39c6..eae9107bef 100644
--- a/service/src/java/org/apache/hive/service/cli/operation/hplsql/HplSqlQueryExecutor.java
+++ b/service/src/java/org/apache/hive/service/cli/operation/hplsql/HplSqlQueryExecutor.java
@@ -137,6 +137,8 @@ public <T> T get(int columnIndex, Class<T> type) {
               return type.cast(((Number) current[columnIndex]).shortValue());
           if (type == Byte.class)
               return type.cast(((Number) current[columnIndex]).byteValue());
+          if (type == String.class)
+            return (T) String.valueOf(current[columnIndex]);
         }
         // RowSet can never return the HiveDecimal instances created on Hive side, nor its BigDecimal representation.
         // Instead, it gets converted into String object in ColumnBasedSet.addRow()...
