diff --git a/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDAFCumeDist.java b/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDAFCumeDist.java
index bb134c2fca..d088d61a62 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDAFCumeDist.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDAFCumeDist.java
@@ -19,6 +19,7 @@
 package org.apache.hadoop.hive.ql.udf.generic;
 
 import java.util.ArrayList;
+import java.util.List;
 
 import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
@@ -55,29 +56,49 @@ protected GenericUDAFRankEvaluator createEvaluator()
 		return new GenericUDAFCumeDistEvaluator();
 	}
 
-	public static class GenericUDAFCumeDistEvaluator extends GenericUDAFRankEvaluator
-	{
-		@Override
-		public ObjectInspector init(Mode m, ObjectInspector[] parameters) throws HiveException
-		{
-			super.init(m, parameters);
-			return ObjectInspectorFactory.getStandardListObjectInspector(PrimitiveObjectInspectorFactory.writableDoubleObjectInspector);
-		}
-
-		@Override
-		public Object terminate(AggregationBuffer agg) throws HiveException
-		{
-			ArrayList<IntWritable> ranks =  ((RankBuffer) agg).rowNums;
-			double sz = ranks.size();
-			ArrayList<DoubleWritable> pranks = new ArrayList<DoubleWritable>(ranks.size());
+  public static class GenericUDAFCumeDistEvaluator extends GenericUDAFRankEvaluator
+  {
+    @Override
+    public ObjectInspector init(Mode m, ObjectInspector[] parameters) throws HiveException
+    {
+      super.init(m, parameters);
+      return ObjectInspectorFactory
+          .getStandardListObjectInspector(PrimitiveObjectInspectorFactory.writableDoubleObjectInspector);
+    }
 
-			for(IntWritable i : ranks)
-			{
-				double pr = ((double)i.get())/sz;
-				pranks.add(new DoubleWritable(pr));
-			}
-
-			return pranks;
-		}
-	}
+    @Override
+    public Object terminate(AggregationBuffer agg) throws HiveException
+    {
+      List<IntWritable> ranks = ((RankBuffer) agg).rowNums;
+      int ranksSize = ranks.size();
+      double ranksSizeDouble = ranksSize;
+      List<DoubleWritable> distances = new ArrayList<DoubleWritable>(ranksSize);
+      int last = -1;
+      int current = -1;
+      // tracks the number of elements with the same rank at the current time
+      int elementsAtRank = 1;
+      for (int index = 0; index < ranksSize; index++) {
+        current = ranks.get(index).get();
+        if (index == 0) {
+          last = current;
+        } else if (last == current) {
+          elementsAtRank++;
+        } else {
+          last = current;
+          double distance = ((double) index) / ranksSizeDouble;
+          while (elementsAtRank-- > 0) {
+            distances.add(new DoubleWritable(distance));
+          }
+          elementsAtRank = 1;
+        }
+      }
+      if (ranksSize > 0 && last == current) {
+        double distance = ((double) ranksSize) / ranksSizeDouble;
+        while (elementsAtRank-- > 0) {
+          distances.add(new DoubleWritable(distance));
+        }
+      }
+      return distances;
+    }
+  }
 }
diff --git a/ql/src/test/queries/clientpositive/ptf_decimal.q b/ql/src/test/queries/clientpositive/ptf_decimal.q
new file mode 100644
index 0000000000..03f435e453
--- /dev/null
+++ b/ql/src/test/queries/clientpositive/ptf_decimal.q
@@ -0,0 +1,49 @@
+DROP TABLE IF EXISTS part;
+
+-- data setup
+CREATE TABLE part( 
+    p_partkey INT,
+    p_name STRING,
+    p_mfgr STRING,
+    p_brand STRING,
+    p_type STRING,
+    p_size INT,
+    p_container STRING,
+    p_retailprice DECIMAL,
+    p_comment STRING
+);
+
+LOAD DATA LOCAL INPATH '../data/files/part_tiny.txt' overwrite into table part;
+
+-- 1. aggregate functions with decimal type
+
+select p_mfgr, p_retailprice,
+lead(p_retailprice) over (partition by p_mfgr ORDER BY p_name) as c1,
+lag(p_retailprice) over (partition by p_mfgr ORDER BY p_name) as c2,
+first_value(p_retailprice) over (partition by p_mfgr ORDER BY p_name) as c3,
+last_value(p_retailprice) over (partition by p_mfgr ORDER BY p_name) as c4
+from part;
+
+-- 2. ranking functions with decimal type
+
+select p_mfgr, p_retailprice,
+row_number() over (PARTITION BY p_mfgr ORDER BY p_retailprice) as c1,
+rank() over (PARTITION BY p_mfgr ORDER BY p_retailprice) as c2,
+dense_rank() over (PARTITION BY p_mfgr ORDER BY p_retailprice) as c3,
+percent_rank() over (PARTITION BY p_mfgr ORDER BY p_retailprice) as c4,
+cume_dist() over (PARTITION BY p_mfgr ORDER BY p_retailprice) as c5,
+ntile(5) over (PARTITION BY p_mfgr ORDER BY p_retailprice) as c6
+from part;
+
+-- 3. order by decimal
+
+select p_mfgr, p_retailprice,
+lag(p_retailprice) over (partition by p_mfgr ORDER BY p_retailprice desc) as c1
+from part;
+
+-- 4. partition by decimal
+
+select p_mfgr, p_retailprice,
+lag(p_retailprice) over (partition by p_retailprice) as c1
+from part;
+
diff --git a/ql/src/test/results/clientpositive/ptf.q.out b/ql/src/test/results/clientpositive/ptf.q.out
index c041befde6..331961fb27 100644
--- a/ql/src/test/results/clientpositive/ptf.q.out
+++ b/ql/src/test/results/clientpositive/ptf.q.out
@@ -979,8 +979,8 @@ POSTHOOK: Lineage: part_5.p_size SCRIPT [(part)part.FieldSchema(name:p_partkey,
 POSTHOOK: Lineage: part_5.r SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), ]
 POSTHOOK: Lineage: part_5.s1 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), ]
 POSTHOOK: Lineage: part_5.s2 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), ]
-Manufacturer#1	almond antique burnished rose metallic	2	4	4	1	1	0.16666666666666666	2
-Manufacturer#1	almond antique burnished rose metallic	2	2	4	1	1	0.16666666666666666	2
+Manufacturer#1	almond antique burnished rose metallic	2	4	4	1	1	0.3333333333333333	2
+Manufacturer#1	almond antique burnished rose metallic	2	2	4	1	1	0.3333333333333333	2
 Manufacturer#1	almond antique salmon chartreuse burlywood	6	44	10	4	3	0.6666666666666666	2
 Manufacturer#1	almond aquamarine burnished black steel	28	72	28	5	4	0.8333333333333334	34
 Manufacturer#1	almond antique chartreuse lavender yellow	34	38	34	3	2	0.5	2
diff --git a/ql/src/test/results/clientpositive/ptf_decimal.q.out b/ql/src/test/results/clientpositive/ptf_decimal.q.out
new file mode 100644
index 0000000000..2090829328
--- /dev/null
+++ b/ql/src/test/results/clientpositive/ptf_decimal.q.out
@@ -0,0 +1,221 @@
+PREHOOK: query: DROP TABLE IF EXISTS part
+PREHOOK: type: DROPTABLE
+POSTHOOK: query: DROP TABLE IF EXISTS part
+POSTHOOK: type: DROPTABLE
+PREHOOK: query: -- data setup
+CREATE TABLE part( 
+    p_partkey INT,
+    p_name STRING,
+    p_mfgr STRING,
+    p_brand STRING,
+    p_type STRING,
+    p_size INT,
+    p_container STRING,
+    p_retailprice DECIMAL,
+    p_comment STRING
+)
+PREHOOK: type: CREATETABLE
+POSTHOOK: query: -- data setup
+CREATE TABLE part( 
+    p_partkey INT,
+    p_name STRING,
+    p_mfgr STRING,
+    p_brand STRING,
+    p_type STRING,
+    p_size INT,
+    p_container STRING,
+    p_retailprice DECIMAL,
+    p_comment STRING
+)
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: default@part
+PREHOOK: query: LOAD DATA LOCAL INPATH '../data/files/part_tiny.txt' overwrite into table part
+PREHOOK: type: LOAD
+PREHOOK: Output: default@part
+POSTHOOK: query: LOAD DATA LOCAL INPATH '../data/files/part_tiny.txt' overwrite into table part
+POSTHOOK: type: LOAD
+POSTHOOK: Output: default@part
+PREHOOK: query: -- 1. aggregate functions with decimal type
+
+select p_mfgr, p_retailprice,
+lead(p_retailprice) over (partition by p_mfgr ORDER BY p_name) as c1,
+lag(p_retailprice) over (partition by p_mfgr ORDER BY p_name) as c2,
+first_value(p_retailprice) over (partition by p_mfgr ORDER BY p_name) as c3,
+last_value(p_retailprice) over (partition by p_mfgr ORDER BY p_name) as c4
+from part
+PREHOOK: type: QUERY
+PREHOOK: Input: default@part
+#### A masked pattern was here ####
+POSTHOOK: query: -- 1. aggregate functions with decimal type
+
+select p_mfgr, p_retailprice,
+lead(p_retailprice) over (partition by p_mfgr ORDER BY p_name) as c1,
+lag(p_retailprice) over (partition by p_mfgr ORDER BY p_name) as c2,
+first_value(p_retailprice) over (partition by p_mfgr ORDER BY p_name) as c3,
+last_value(p_retailprice) over (partition by p_mfgr ORDER BY p_name) as c4
+from part
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@part
+#### A masked pattern was here ####
+Manufacturer#1	1173.15	1173.15	NULL	1173.15	1173.15
+Manufacturer#1	1173.15	1753.76	1173.15	1173.15	1173.15
+Manufacturer#1	1753.76	1602.59	1173.15	1173.15	1753.76
+Manufacturer#1	1602.59	1414.42	1753.76	1173.15	1602.59
+Manufacturer#1	1414.42	1632.66	1602.59	1173.15	1414.42
+Manufacturer#1	1632.66	NULL	1414.42	1173.15	1632.66
+Manufacturer#2	1690.68	1800.7	NULL	1690.68	1690.68
+Manufacturer#2	1800.7	2031.98	1690.68	1690.68	1800.7
+Manufacturer#2	2031.98	1698.66	1800.7	1690.68	2031.98
+Manufacturer#2	1698.66	1701.6	2031.98	1690.68	1698.66
+Manufacturer#2	1701.6	NULL	1698.66	1690.68	1701.6
+Manufacturer#3	1671.68	1190.27	NULL	1671.68	1671.68
+Manufacturer#3	1190.27	1410.39	1671.68	1671.68	1190.27
+Manufacturer#3	1410.39	1922.98	1190.27	1671.68	1410.39
+Manufacturer#3	1922.98	1337.29	1410.39	1671.68	1922.98
+Manufacturer#3	1337.29	NULL	1922.98	1671.68	1337.29
+Manufacturer#4	1620.67	1375.42	NULL	1620.67	1620.67
+Manufacturer#4	1375.42	1206.26	1620.67	1620.67	1375.42
+Manufacturer#4	1206.26	1844.92	1375.42	1620.67	1206.26
+Manufacturer#4	1844.92	1290.35	1206.26	1620.67	1844.92
+Manufacturer#4	1290.35	NULL	1844.92	1620.67	1290.35
+Manufacturer#5	1789.69	1611.66	NULL	1789.69	1789.69
+Manufacturer#5	1611.66	1788.73	1789.69	1789.69	1611.66
+Manufacturer#5	1788.73	1018.1	1611.66	1789.69	1788.73
+Manufacturer#5	1018.1	1464.48	1788.73	1789.69	1018.1
+Manufacturer#5	1464.48	NULL	1018.1	1789.69	1464.48
+PREHOOK: query: -- 2. ranking functions with decimal type
+
+select p_mfgr, p_retailprice,
+row_number() over (PARTITION BY p_mfgr ORDER BY p_retailprice) as c1,
+rank() over (PARTITION BY p_mfgr ORDER BY p_retailprice) as c2,
+dense_rank() over (PARTITION BY p_mfgr ORDER BY p_retailprice) as c3,
+percent_rank() over (PARTITION BY p_mfgr ORDER BY p_retailprice) as c4,
+cume_dist() over (PARTITION BY p_mfgr ORDER BY p_retailprice) as c5,
+ntile(5) over (PARTITION BY p_mfgr ORDER BY p_retailprice) as c6
+from part
+PREHOOK: type: QUERY
+PREHOOK: Input: default@part
+#### A masked pattern was here ####
+POSTHOOK: query: -- 2. ranking functions with decimal type
+
+select p_mfgr, p_retailprice,
+row_number() over (PARTITION BY p_mfgr ORDER BY p_retailprice) as c1,
+rank() over (PARTITION BY p_mfgr ORDER BY p_retailprice) as c2,
+dense_rank() over (PARTITION BY p_mfgr ORDER BY p_retailprice) as c3,
+percent_rank() over (PARTITION BY p_mfgr ORDER BY p_retailprice) as c4,
+cume_dist() over (PARTITION BY p_mfgr ORDER BY p_retailprice) as c5,
+ntile(5) over (PARTITION BY p_mfgr ORDER BY p_retailprice) as c6
+from part
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@part
+#### A masked pattern was here ####
+Manufacturer#1	1173.15	1	1	1	0.0	0.3333333333333333	1
+Manufacturer#1	1173.15	2	1	1	0.0	0.3333333333333333	1
+Manufacturer#1	1414.42	3	3	2	0.4	0.5	2
+Manufacturer#1	1602.59	4	4	3	0.6	0.6666666666666666	3
+Manufacturer#1	1632.66	5	5	4	0.8	0.8333333333333334	4
+Manufacturer#1	1753.76	6	6	5	1.0	1.0	5
+Manufacturer#2	1690.68	1	1	1	0.0	0.2	1
+Manufacturer#2	1698.66	2	2	2	0.25	0.4	2
+Manufacturer#2	1701.6	3	3	3	0.5	0.6	3
+Manufacturer#2	1800.7	4	4	4	0.75	0.8	4
+Manufacturer#2	2031.98	5	5	5	1.0	1.0	5
+Manufacturer#3	1190.27	1	1	1	0.0	0.2	1
+Manufacturer#3	1337.29	2	2	2	0.25	0.4	2
+Manufacturer#3	1410.39	3	3	3	0.5	0.6	3
+Manufacturer#3	1671.68	4	4	4	0.75	0.8	4
+Manufacturer#3	1922.98	5	5	5	1.0	1.0	5
+Manufacturer#4	1206.26	1	1	1	0.0	0.2	1
+Manufacturer#4	1290.35	2	2	2	0.25	0.4	2
+Manufacturer#4	1375.42	3	3	3	0.5	0.6	3
+Manufacturer#4	1620.67	4	4	4	0.75	0.8	4
+Manufacturer#4	1844.92	5	5	5	1.0	1.0	5
+Manufacturer#5	1018.1	1	1	1	0.0	0.2	1
+Manufacturer#5	1464.48	2	2	2	0.25	0.4	2
+Manufacturer#5	1611.66	3	3	3	0.5	0.6	3
+Manufacturer#5	1788.73	4	4	4	0.75	0.8	4
+Manufacturer#5	1789.69	5	5	5	1.0	1.0	5
+PREHOOK: query: -- 3. order by decimal
+
+select p_mfgr, p_retailprice,
+lag(p_retailprice) over (partition by p_mfgr ORDER BY p_retailprice desc) as c1
+from part
+PREHOOK: type: QUERY
+PREHOOK: Input: default@part
+#### A masked pattern was here ####
+POSTHOOK: query: -- 3. order by decimal
+
+select p_mfgr, p_retailprice,
+lag(p_retailprice) over (partition by p_mfgr ORDER BY p_retailprice desc) as c1
+from part
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@part
+#### A masked pattern was here ####
+Manufacturer#1	1753.76	NULL
+Manufacturer#1	1632.66	1753.76
+Manufacturer#1	1602.59	1632.66
+Manufacturer#1	1414.42	1602.59
+Manufacturer#1	1173.15	1414.42
+Manufacturer#1	1173.15	1173.15
+Manufacturer#2	2031.98	NULL
+Manufacturer#2	1800.7	2031.98
+Manufacturer#2	1701.6	1800.7
+Manufacturer#2	1698.66	1701.6
+Manufacturer#2	1690.68	1698.66
+Manufacturer#3	1922.98	NULL
+Manufacturer#3	1671.68	1922.98
+Manufacturer#3	1410.39	1671.68
+Manufacturer#3	1337.29	1410.39
+Manufacturer#3	1190.27	1337.29
+Manufacturer#4	1844.92	NULL
+Manufacturer#4	1620.67	1844.92
+Manufacturer#4	1375.42	1620.67
+Manufacturer#4	1290.35	1375.42
+Manufacturer#4	1206.26	1290.35
+Manufacturer#5	1789.69	NULL
+Manufacturer#5	1788.73	1789.69
+Manufacturer#5	1611.66	1788.73
+Manufacturer#5	1464.48	1611.66
+Manufacturer#5	1018.1	1464.48
+PREHOOK: query: -- 4. partition by decimal
+
+select p_mfgr, p_retailprice,
+lag(p_retailprice) over (partition by p_retailprice) as c1
+from part
+PREHOOK: type: QUERY
+PREHOOK: Input: default@part
+#### A masked pattern was here ####
+POSTHOOK: query: -- 4. partition by decimal
+
+select p_mfgr, p_retailprice,
+lag(p_retailprice) over (partition by p_retailprice) as c1
+from part
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@part
+#### A masked pattern was here ####
+Manufacturer#5	1018.1	NULL
+Manufacturer#1	1173.15	NULL
+Manufacturer#1	1173.15	1173.15
+Manufacturer#3	1190.27	NULL
+Manufacturer#4	1206.26	NULL
+Manufacturer#4	1290.35	NULL
+Manufacturer#3	1337.29	NULL
+Manufacturer#4	1375.42	NULL
+Manufacturer#3	1410.39	NULL
+Manufacturer#1	1414.42	NULL
+Manufacturer#5	1464.48	NULL
+Manufacturer#1	1602.59	NULL
+Manufacturer#5	1611.66	NULL
+Manufacturer#4	1620.67	NULL
+Manufacturer#1	1632.66	NULL
+Manufacturer#3	1671.68	NULL
+Manufacturer#2	1690.68	NULL
+Manufacturer#2	1698.66	NULL
+Manufacturer#2	1701.6	NULL
+Manufacturer#1	1753.76	NULL
+Manufacturer#5	1788.73	NULL
+Manufacturer#5	1789.69	NULL
+Manufacturer#2	1800.7	NULL
+Manufacturer#4	1844.92	NULL
+Manufacturer#3	1922.98	NULL
+Manufacturer#2	2031.98	NULL
diff --git a/ql/src/test/results/clientpositive/windowing.q.out b/ql/src/test/results/clientpositive/windowing.q.out
index 3e1660aa45..6b18666466 100644
--- a/ql/src/test/results/clientpositive/windowing.q.out
+++ b/ql/src/test/results/clientpositive/windowing.q.out
@@ -692,32 +692,32 @@ window w1 as (distribute by p_mfgr sort by p_mfgr, p_name rows between 2 precedi
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@part
 #### A masked pattern was here ####
-Manufacturer#1	almond antique burnished rose metallic	2	1	1	0.16666666666666666	0.0	2	6	19.0	16.237815945091466	2	42	2
-Manufacturer#1	almond antique burnished rose metallic	2	1	1	0.16666666666666666	0.0	1	6	19.0	16.237815945091466	2	42	2
-Manufacturer#1	almond antique chartreuse lavender yellow	34	1	1	0.16666666666666666	0.0	1	6	19.0	16.237815945091466	2	42	2
-Manufacturer#1	almond antique salmon chartreuse burlywood	6	1	1	0.16666666666666666	0.0	2	6	19.0	16.237815945091466	2	42	2
-Manufacturer#1	almond aquamarine burnished black steel	28	1	1	0.16666666666666666	0.0	3	6	19.0	16.237815945091466	2	42	34
-Manufacturer#1	almond aquamarine pink moccasin thistle	42	1	1	0.16666666666666666	0.0	3	6	19.0	16.237815945091466	2	42	6
-Manufacturer#2	almond antique violet chocolate turquoise	14	1	1	0.2	0.0	1	5	19.8	12.560254774486067	4	18	14
-Manufacturer#2	almond antique violet turquoise frosted	40	1	1	0.2	0.0	1	5	19.8	12.560254774486067	4	18	14
-Manufacturer#2	almond aquamarine midnight light salmon	2	1	1	0.2	0.0	2	5	19.8	12.560254774486067	4	18	14
-Manufacturer#2	almond aquamarine rose maroon antique	25	1	1	0.2	0.0	2	5	19.8	12.560254774486067	4	18	40
-Manufacturer#2	almond aquamarine sandy cyan gainsboro	18	1	1	0.2	0.0	3	5	19.8	12.560254774486067	4	18	2
-Manufacturer#3	almond antique chartreuse khaki white	17	1	1	0.2	0.0	1	5	19.2	14.344336861632886	4	45	17
-Manufacturer#3	almond antique forest lavender goldenrod	14	1	1	0.2	0.0	2	5	19.2	14.344336861632886	4	45	17
-Manufacturer#3	almond antique metallic orange dim	19	1	1	0.2	0.0	1	5	19.2	14.344336861632886	4	45	17
-Manufacturer#3	almond antique misty red olive	1	1	1	0.2	0.0	2	5	19.2	14.344336861632886	4	45	14
-Manufacturer#3	almond antique olive coral navajo	45	1	1	0.2	0.0	3	5	19.2	14.344336861632886	4	45	19
-Manufacturer#4	almond antique gainsboro frosted violet	10	1	1	0.2	0.0	1	5	19.0	12.149074038789951	0	12	10
-Manufacturer#4	almond antique violet mint lemon	39	1	1	0.2	0.0	1	5	19.0	12.149074038789951	0	12	10
-Manufacturer#4	almond aquamarine floral ivory bisque	27	1	1	0.2	0.0	2	5	19.0	12.149074038789951	0	12	10
-Manufacturer#4	almond aquamarine yellow dodger mint	7	1	1	0.2	0.0	2	5	19.0	12.149074038789951	0	12	39
-Manufacturer#4	almond azure aquamarine papaya violet	12	1	1	0.2	0.0	3	5	19.0	12.149074038789951	0	12	27
-Manufacturer#5	almond antique blue firebrick mint	31	1	1	0.2	0.0	1	5	21.6	16.206171663906314	1	23	31
-Manufacturer#5	almond antique medium spring khaki	6	1	1	0.2	0.0	1	5	21.6	16.206171663906314	1	23	31
-Manufacturer#5	almond antique sky peru orange	2	1	1	0.2	0.0	2	5	21.6	16.206171663906314	1	23	31
-Manufacturer#5	almond aquamarine dodger light gainsboro	46	1	1	0.2	0.0	2	5	21.6	16.206171663906314	1	23	6
-Manufacturer#5	almond azure blanched chiffon midnight	23	1	1	0.2	0.0	3	5	21.6	16.206171663906314	1	23	2
+Manufacturer#1	almond antique burnished rose metallic	2	1	1	1.0	0.0	2	6	19.0	16.237815945091466	2	42	2
+Manufacturer#1	almond antique burnished rose metallic	2	1	1	1.0	0.0	1	6	19.0	16.237815945091466	2	42	2
+Manufacturer#1	almond antique chartreuse lavender yellow	34	1	1	1.0	0.0	1	6	19.0	16.237815945091466	2	42	2
+Manufacturer#1	almond antique salmon chartreuse burlywood	6	1	1	1.0	0.0	2	6	19.0	16.237815945091466	2	42	2
+Manufacturer#1	almond aquamarine burnished black steel	28	1	1	1.0	0.0	3	6	19.0	16.237815945091466	2	42	34
+Manufacturer#1	almond aquamarine pink moccasin thistle	42	1	1	1.0	0.0	3	6	19.0	16.237815945091466	2	42	6
+Manufacturer#2	almond antique violet chocolate turquoise	14	1	1	1.0	0.0	1	5	19.8	12.560254774486067	4	18	14
+Manufacturer#2	almond antique violet turquoise frosted	40	1	1	1.0	0.0	1	5	19.8	12.560254774486067	4	18	14
+Manufacturer#2	almond aquamarine midnight light salmon	2	1	1	1.0	0.0	2	5	19.8	12.560254774486067	4	18	14
+Manufacturer#2	almond aquamarine rose maroon antique	25	1	1	1.0	0.0	2	5	19.8	12.560254774486067	4	18	40
+Manufacturer#2	almond aquamarine sandy cyan gainsboro	18	1	1	1.0	0.0	3	5	19.8	12.560254774486067	4	18	2
+Manufacturer#3	almond antique chartreuse khaki white	17	1	1	1.0	0.0	1	5	19.2	14.344336861632886	4	45	17
+Manufacturer#3	almond antique forest lavender goldenrod	14	1	1	1.0	0.0	2	5	19.2	14.344336861632886	4	45	17
+Manufacturer#3	almond antique metallic orange dim	19	1	1	1.0	0.0	1	5	19.2	14.344336861632886	4	45	17
+Manufacturer#3	almond antique misty red olive	1	1	1	1.0	0.0	2	5	19.2	14.344336861632886	4	45	14
+Manufacturer#3	almond antique olive coral navajo	45	1	1	1.0	0.0	3	5	19.2	14.344336861632886	4	45	19
+Manufacturer#4	almond antique gainsboro frosted violet	10	1	1	1.0	0.0	1	5	19.0	12.149074038789951	0	12	10
+Manufacturer#4	almond antique violet mint lemon	39	1	1	1.0	0.0	1	5	19.0	12.149074038789951	0	12	10
+Manufacturer#4	almond aquamarine floral ivory bisque	27	1	1	1.0	0.0	2	5	19.0	12.149074038789951	0	12	10
+Manufacturer#4	almond aquamarine yellow dodger mint	7	1	1	1.0	0.0	2	5	19.0	12.149074038789951	0	12	39
+Manufacturer#4	almond azure aquamarine papaya violet	12	1	1	1.0	0.0	3	5	19.0	12.149074038789951	0	12	27
+Manufacturer#5	almond antique blue firebrick mint	31	1	1	1.0	0.0	1	5	21.6	16.206171663906314	1	23	31
+Manufacturer#5	almond antique medium spring khaki	6	1	1	1.0	0.0	1	5	21.6	16.206171663906314	1	23	31
+Manufacturer#5	almond antique sky peru orange	2	1	1	1.0	0.0	2	5	21.6	16.206171663906314	1	23	31
+Manufacturer#5	almond aquamarine dodger light gainsboro	46	1	1	1.0	0.0	2	5	21.6	16.206171663906314	1	23	6
+Manufacturer#5	almond azure blanched chiffon midnight	23	1	1	1.0	0.0	3	5	21.6	16.206171663906314	1	23	2
 PREHOOK: query: -- 16. testMultipleWindows
 select  p_mfgr,p_name, p_size,  
   rank() over(distribute by p_mfgr sort by p_mfgr) as r, 
@@ -744,32 +744,32 @@ window w1 as (distribute by p_mfgr sort by p_mfgr, p_name rows between 2 precedi
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@part
 #### A masked pattern was here ####
-Manufacturer#1	almond antique burnished rose metallic	2	1	1	0.16666666666666666	4	4	2
-Manufacturer#1	almond antique burnished rose metallic	2	1	1	0.16666666666666666	2	4	2
-Manufacturer#1	almond antique salmon chartreuse burlywood	6	1	1	0.16666666666666666	44	10	2
-Manufacturer#1	almond aquamarine burnished black steel	28	1	1	0.16666666666666666	72	28	34
-Manufacturer#1	almond antique chartreuse lavender yellow	34	1	1	0.16666666666666666	38	34	2
-Manufacturer#1	almond aquamarine pink moccasin thistle	42	1	1	0.16666666666666666	114	42	6
-Manufacturer#2	almond aquamarine midnight light salmon	2	1	1	0.2	56	2	14
-Manufacturer#2	almond antique violet chocolate turquoise	14	1	1	0.2	14	14	14
-Manufacturer#2	almond aquamarine sandy cyan gainsboro	18	1	1	0.2	99	32	2
-Manufacturer#2	almond aquamarine rose maroon antique	25	1	1	0.2	81	25	40
-Manufacturer#2	almond antique violet turquoise frosted	40	1	1	0.2	54	40	14
-Manufacturer#3	almond antique misty red olive	1	1	1	0.2	51	1	14
-Manufacturer#3	almond antique forest lavender goldenrod	14	1	1	0.2	31	14	17
-Manufacturer#3	almond antique chartreuse khaki white	17	1	1	0.2	17	31	17
-Manufacturer#3	almond antique metallic orange dim	19	1	1	0.2	50	50	17
-Manufacturer#3	almond antique olive coral navajo	45	1	1	0.2	96	45	19
-Manufacturer#4	almond aquamarine yellow dodger mint	7	1	1	0.2	83	7	39
-Manufacturer#4	almond antique gainsboro frosted violet	10	1	1	0.2	10	17	10
-Manufacturer#4	almond azure aquamarine papaya violet	12	1	1	0.2	95	29	27
-Manufacturer#4	almond aquamarine floral ivory bisque	27	1	1	0.2	76	27	10
-Manufacturer#4	almond antique violet mint lemon	39	1	1	0.2	49	39	10
-Manufacturer#5	almond antique sky peru orange	2	1	1	0.2	39	2	31
-Manufacturer#5	almond antique medium spring khaki	6	1	1	0.2	37	8	31
-Manufacturer#5	almond azure blanched chiffon midnight	23	1	1	0.2	108	23	2
-Manufacturer#5	almond antique blue firebrick mint	31	1	1	0.2	31	31	31
-Manufacturer#5	almond aquamarine dodger light gainsboro	46	1	1	0.2	85	46	6
+Manufacturer#1	almond antique burnished rose metallic	2	1	1	1.0	4	4	2
+Manufacturer#1	almond antique burnished rose metallic	2	1	1	1.0	2	4	2
+Manufacturer#1	almond antique salmon chartreuse burlywood	6	1	1	1.0	44	10	2
+Manufacturer#1	almond aquamarine burnished black steel	28	1	1	1.0	72	28	34
+Manufacturer#1	almond antique chartreuse lavender yellow	34	1	1	1.0	38	34	2
+Manufacturer#1	almond aquamarine pink moccasin thistle	42	1	1	1.0	114	42	6
+Manufacturer#2	almond aquamarine midnight light salmon	2	1	1	1.0	56	2	14
+Manufacturer#2	almond antique violet chocolate turquoise	14	1	1	1.0	14	14	14
+Manufacturer#2	almond aquamarine sandy cyan gainsboro	18	1	1	1.0	99	32	2
+Manufacturer#2	almond aquamarine rose maroon antique	25	1	1	1.0	81	25	40
+Manufacturer#2	almond antique violet turquoise frosted	40	1	1	1.0	54	40	14
+Manufacturer#3	almond antique misty red olive	1	1	1	1.0	51	1	14
+Manufacturer#3	almond antique forest lavender goldenrod	14	1	1	1.0	31	14	17
+Manufacturer#3	almond antique chartreuse khaki white	17	1	1	1.0	17	31	17
+Manufacturer#3	almond antique metallic orange dim	19	1	1	1.0	50	50	17
+Manufacturer#3	almond antique olive coral navajo	45	1	1	1.0	96	45	19
+Manufacturer#4	almond aquamarine yellow dodger mint	7	1	1	1.0	83	7	39
+Manufacturer#4	almond antique gainsboro frosted violet	10	1	1	1.0	10	17	10
+Manufacturer#4	almond azure aquamarine papaya violet	12	1	1	1.0	95	29	27
+Manufacturer#4	almond aquamarine floral ivory bisque	27	1	1	1.0	76	27	10
+Manufacturer#4	almond antique violet mint lemon	39	1	1	1.0	49	39	10
+Manufacturer#5	almond antique sky peru orange	2	1	1	1.0	39	2	31
+Manufacturer#5	almond antique medium spring khaki	6	1	1	1.0	37	8	31
+Manufacturer#5	almond azure blanched chiffon midnight	23	1	1	1.0	108	23	2
+Manufacturer#5	almond antique blue firebrick mint	31	1	1	1.0	31	31	31
+Manufacturer#5	almond aquamarine dodger light gainsboro	46	1	1	1.0	85	46	6
 PREHOOK: query: -- 17. testCountStar
 select  p_mfgr,p_name, p_size,
 count(*) over(distribute by p_mfgr sort by p_mfgr ) as c, 
@@ -1425,32 +1425,32 @@ POSTHOOK: Lineage: part_3.fv SCRIPT [(part)part.FieldSchema(name:p_partkey, type
 POSTHOOK: Lineage: part_3.p_mfgr SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.p_name SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.p_size SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
-Manufacturer#1	almond antique burnished rose metallic	2	1	1	0	4.0	4.0	2
-Manufacturer#1	almond antique burnished rose metallic	2	1	1	0	2.0	4.0	2
-Manufacturer#1	almond antique salmon chartreuse burlywood	6	1	1	0	44.0	10.0	2
-Manufacturer#1	almond aquamarine burnished black steel	28	1	1	0	72.0	28.0	34
-Manufacturer#1	almond antique chartreuse lavender yellow	34	1	1	0	38.0	34.0	2
-Manufacturer#1	almond aquamarine pink moccasin thistle	42	1	1	0	114.0	42.0	6
-Manufacturer#2	almond aquamarine midnight light salmon	2	1	1	0	56.0	2.0	14
-Manufacturer#2	almond antique violet chocolate turquoise	14	1	1	0	14.0	14.0	14
-Manufacturer#2	almond aquamarine sandy cyan gainsboro	18	1	1	0	99.0	32.0	2
-Manufacturer#2	almond aquamarine rose maroon antique	25	1	1	0	81.0	25.0	40
-Manufacturer#2	almond antique violet turquoise frosted	40	1	1	0	54.0	40.0	14
-Manufacturer#3	almond antique misty red olive	1	1	1	0	51.0	1.0	14
-Manufacturer#3	almond antique forest lavender goldenrod	14	1	1	0	31.0	14.0	17
-Manufacturer#3	almond antique chartreuse khaki white	17	1	1	0	17.0	31.0	17
-Manufacturer#3	almond antique metallic orange dim	19	1	1	0	50.0	50.0	17
-Manufacturer#3	almond antique olive coral navajo	45	1	1	0	96.0	45.0	19
-Manufacturer#4	almond aquamarine yellow dodger mint	7	1	1	0	83.0	7.0	39
-Manufacturer#4	almond antique gainsboro frosted violet	10	1	1	0	10.0	17.0	10
-Manufacturer#4	almond azure aquamarine papaya violet	12	1	1	0	95.0	29.0	27
-Manufacturer#4	almond aquamarine floral ivory bisque	27	1	1	0	76.0	27.0	10
-Manufacturer#4	almond antique violet mint lemon	39	1	1	0	49.0	39.0	10
-Manufacturer#5	almond antique sky peru orange	2	1	1	0	39.0	2.0	31
-Manufacturer#5	almond antique medium spring khaki	6	1	1	0	37.0	8.0	31
-Manufacturer#5	almond azure blanched chiffon midnight	23	1	1	0	108.0	23.0	2
-Manufacturer#5	almond antique blue firebrick mint	31	1	1	0	31.0	31.0	31
-Manufacturer#5	almond aquamarine dodger light gainsboro	46	1	1	0	85.0	46.0	6
+Manufacturer#1	almond antique burnished rose metallic	2	1	1	1	4.0	4.0	2
+Manufacturer#1	almond antique burnished rose metallic	2	1	1	1	2.0	4.0	2
+Manufacturer#1	almond antique salmon chartreuse burlywood	6	1	1	1	44.0	10.0	2
+Manufacturer#1	almond aquamarine burnished black steel	28	1	1	1	72.0	28.0	34
+Manufacturer#1	almond antique chartreuse lavender yellow	34	1	1	1	38.0	34.0	2
+Manufacturer#1	almond aquamarine pink moccasin thistle	42	1	1	1	114.0	42.0	6
+Manufacturer#2	almond aquamarine midnight light salmon	2	1	1	1	56.0	2.0	14
+Manufacturer#2	almond antique violet chocolate turquoise	14	1	1	1	14.0	14.0	14
+Manufacturer#2	almond aquamarine sandy cyan gainsboro	18	1	1	1	99.0	32.0	2
+Manufacturer#2	almond aquamarine rose maroon antique	25	1	1	1	81.0	25.0	40
+Manufacturer#2	almond antique violet turquoise frosted	40	1	1	1	54.0	40.0	14
+Manufacturer#3	almond antique misty red olive	1	1	1	1	51.0	1.0	14
+Manufacturer#3	almond antique forest lavender goldenrod	14	1	1	1	31.0	14.0	17
+Manufacturer#3	almond antique chartreuse khaki white	17	1	1	1	17.0	31.0	17
+Manufacturer#3	almond antique metallic orange dim	19	1	1	1	50.0	50.0	17
+Manufacturer#3	almond antique olive coral navajo	45	1	1	1	96.0	45.0	19
+Manufacturer#4	almond aquamarine yellow dodger mint	7	1	1	1	83.0	7.0	39
+Manufacturer#4	almond antique gainsboro frosted violet	10	1	1	1	10.0	17.0	10
+Manufacturer#4	almond azure aquamarine papaya violet	12	1	1	1	95.0	29.0	27
+Manufacturer#4	almond aquamarine floral ivory bisque	27	1	1	1	76.0	27.0	10
+Manufacturer#4	almond antique violet mint lemon	39	1	1	1	49.0	39.0	10
+Manufacturer#5	almond antique sky peru orange	2	1	1	1	39.0	2.0	31
+Manufacturer#5	almond antique medium spring khaki	6	1	1	1	37.0	8.0	31
+Manufacturer#5	almond azure blanched chiffon midnight	23	1	1	1	108.0	23.0	2
+Manufacturer#5	almond antique blue firebrick mint	31	1	1	1	31.0	31.0	31
+Manufacturer#5	almond aquamarine dodger light gainsboro	46	1	1	1	85.0	46.0	6
 PREHOOK: query: select * from part_3
 PREHOOK: type: QUERY
 PREHOOK: Input: default@part_3
diff --git a/ql/src/test/results/clientpositive/windowing_rank.q.out b/ql/src/test/results/clientpositive/windowing_rank.q.out
index 44621b0477..f72e734a8d 100644
--- a/ql/src/test/results/clientpositive/windowing_rank.q.out
+++ b/ql/src/test/results/clientpositive/windowing_rank.q.out
@@ -263,106 +263,106 @@ POSTHOOK: query: select s, cume_dist() over (partition by bo order by b) from ov
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over10k
 #### A masked pattern was here ####
-holly allen	2.0112630732099757E-4
-wendy falkner	2.0112630732099757E-4
-david ovid	2.0112630732099757E-4
-victor garcia	2.0112630732099757E-4
-katie xylophone	2.0112630732099757E-4
-ulysses xylophone	2.0112630732099757E-4
-nick steinbeck	2.0112630732099757E-4
-ethan ellison	2.0112630732099757E-4
-nick quirinius	2.0112630732099757E-4
-irene garcia	2.0112630732099757E-4
-mike xylophone	2.0112630732099757E-4
-victor xylophone	2.0112630732099757E-4
-jessica steinbeck	2.0112630732099757E-4
-irene van buren	2.0112630732099757E-4
-quinn steinbeck	2.0112630732099757E-4
-calvin allen	2.0112630732099757E-4
-david zipper	2.0112630732099757E-4
-sarah miller	2.0112630732099757E-4
-ulysses nixon	2.0112630732099757E-4
-ulysses ichabod	2.0112630732099757E-4
-yuri nixon	2.0112630732099757E-4
-tom hernandez	2.0112630732099757E-4
-rachel thompson	2.0112630732099757E-4
-katie xylophone	0.004827031375703942
-oscar quirinius	0.004827031375703942
-rachel davidson	0.004827031375703942
-sarah van buren	0.004827031375703942
-ulysses allen	0.004827031375703942
-bob king	0.004827031375703942
-bob johnson	0.004827031375703942
-calvin van buren	0.004827031375703942
-tom king	0.004827031375703942
-zach young	0.004827031375703942
-zach allen	0.004827031375703942
-mike steinbeck	0.004827031375703942
-wendy ellison	0.004827031375703942
-gabriella robinson	0.004827031375703942
-xavier davidson	0.007642799678197908
-jessica miller	0.007642799678197908
-mike steinbeck	0.007642799678197908
-alice falkner	0.007642799678197908
-irene nixon	0.007642799678197908
-jessica brown	0.007642799678197908
-ethan ovid	0.007642799678197908
-ulysses king	0.007642799678197908
-gabriella davidson	0.007642799678197908
-jessica quirinius	0.007642799678197908
-luke falkner	0.007642799678197908
-luke robinson	0.007642799678197908
-priscilla hernandez	0.007642799678197908
-mike van buren	0.007642799678197908
-ulysses robinson	0.007642799678197908
-bob underhill	0.007642799678197908
-bob ovid	0.007642799678197908
-tom polk	0.007642799678197908
-gabriella garcia	0.007642799678197908
-wendy allen	0.011464199517296863
-victor robinson	0.011464199517296863
-calvin nixon	0.011464199517296863
-wendy nixon	0.011464199517296863
-mike falkner	0.011464199517296863
-nick falkner	0.011464199517296863
-priscilla nixon	0.011464199517296863
-david davidson	0.011464199517296863
-bob underhill	0.011464199517296863
-oscar laertes	0.011464199517296863
-oscar miller	0.011464199517296863
-priscilla xylophone	0.011464199517296863
-jessica robinson	0.011464199517296863
-quinn miller	0.011464199517296863
-yuri ellison	0.011464199517296863
-holly falkner	0.011464199517296863
-oscar thompson	0.011464199517296863
-irene laertes	0.011464199517296863
-alice hernandez	0.011464199517296863
-luke johnson	0.015285599356395816
-fred carson	0.015285599356395816
-nick allen	0.015285599356395816
-nick ellison	0.015285599356395816
-priscilla laertes	0.015285599356395816
-priscilla underhill	0.015285599356395816
-calvin nixon	0.015285599356395816
-oscar king	0.015285599356395816
-katie polk	0.015285599356395816
-irene king	0.015285599356395816
-jessica davidson	0.015285599356395816
-victor steinbeck	0.015285599356395816
-priscilla young	0.015285599356395816
-katie polk	0.015285599356395816
-holly davidson	0.015285599356395816
-wendy miller	0.015285599356395816
-zach johnson	0.01850362027353178
-mike falkner	0.01850362027353178
-victor zipper	0.01850362027353178
-wendy king	0.01850362027353178
-fred ellison	0.01850362027353178
-mike hernandez	0.01850362027353178
-xavier allen	0.01850362027353178
-zach zipper	0.01850362027353178
-ethan laertes	0.01850362027353178
+holly allen	0.004625905068382945
+wendy falkner	0.004625905068382945
+david ovid	0.004625905068382945
+victor garcia	0.004625905068382945
+katie xylophone	0.004625905068382945
+ulysses xylophone	0.004625905068382945
+nick steinbeck	0.004625905068382945
+ethan ellison	0.004625905068382945
+nick quirinius	0.004625905068382945
+irene garcia	0.004625905068382945
+mike xylophone	0.004625905068382945
+victor xylophone	0.004625905068382945
+jessica steinbeck	0.004625905068382945
+irene van buren	0.004625905068382945
+quinn steinbeck	0.004625905068382945
+calvin allen	0.004625905068382945
+david zipper	0.004625905068382945
+sarah miller	0.004625905068382945
+ulysses nixon	0.004625905068382945
+ulysses ichabod	0.004625905068382945
+yuri nixon	0.004625905068382945
+tom hernandez	0.004625905068382945
+rachel thompson	0.004625905068382945
+katie xylophone	0.007441673370876911
+oscar quirinius	0.007441673370876911
+rachel davidson	0.007441673370876911
+sarah van buren	0.007441673370876911
+ulysses allen	0.007441673370876911
+bob king	0.007441673370876911
+bob johnson	0.007441673370876911
+calvin van buren	0.007441673370876911
+tom king	0.007441673370876911
+zach young	0.007441673370876911
+zach allen	0.007441673370876911
+mike steinbeck	0.007441673370876911
+wendy ellison	0.007441673370876911
+gabriella robinson	0.007441673370876911
+xavier davidson	0.011263073209975865
+jessica miller	0.011263073209975865
+mike steinbeck	0.011263073209975865
+alice falkner	0.011263073209975865
+irene nixon	0.011263073209975865
+jessica brown	0.011263073209975865
+ethan ovid	0.011263073209975865
+ulysses king	0.011263073209975865
+gabriella davidson	0.011263073209975865
+jessica quirinius	0.011263073209975865
+luke falkner	0.011263073209975865
+luke robinson	0.011263073209975865
+priscilla hernandez	0.011263073209975865
+mike van buren	0.011263073209975865
+ulysses robinson	0.011263073209975865
+bob underhill	0.011263073209975865
+bob ovid	0.011263073209975865
+tom polk	0.011263073209975865
+gabriella garcia	0.011263073209975865
+wendy allen	0.015084473049074818
+victor robinson	0.015084473049074818
+calvin nixon	0.015084473049074818
+wendy nixon	0.015084473049074818
+mike falkner	0.015084473049074818
+nick falkner	0.015084473049074818
+priscilla nixon	0.015084473049074818
+david davidson	0.015084473049074818
+bob underhill	0.015084473049074818
+oscar laertes	0.015084473049074818
+oscar miller	0.015084473049074818
+priscilla xylophone	0.015084473049074818
+jessica robinson	0.015084473049074818
+quinn miller	0.015084473049074818
+yuri ellison	0.015084473049074818
+holly falkner	0.015084473049074818
+oscar thompson	0.015084473049074818
+irene laertes	0.015084473049074818
+alice hernandez	0.015084473049074818
+luke johnson	0.01830249396621078
+fred carson	0.01830249396621078
+nick allen	0.01830249396621078
+nick ellison	0.01830249396621078
+priscilla laertes	0.01830249396621078
+priscilla underhill	0.01830249396621078
+calvin nixon	0.01830249396621078
+oscar king	0.01830249396621078
+katie polk	0.01830249396621078
+irene king	0.01830249396621078
+jessica davidson	0.01830249396621078
+victor steinbeck	0.01830249396621078
+priscilla young	0.01830249396621078
+katie polk	0.01830249396621078
+holly davidson	0.01830249396621078
+wendy miller	0.01830249396621078
+zach johnson	0.02252614641995173
+mike falkner	0.02252614641995173
+victor zipper	0.02252614641995173
+wendy king	0.02252614641995173
+fred ellison	0.02252614641995173
+mike hernandez	0.02252614641995173
+xavier allen	0.02252614641995173
+zach zipper	0.02252614641995173
+ethan laertes	0.02252614641995173
 PREHOOK: query: select s, percent_rank() over (partition by dec order by f) from over10k limit 100
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over10k
