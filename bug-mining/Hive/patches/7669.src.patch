diff --git a/itests/hive-blobstore/src/test/results/clientpositive/buckets.q.out b/itests/hive-blobstore/src/test/results/clientpositive/buckets.q.out
index f75187eb0b..633f5e68df 100644
--- a/itests/hive-blobstore/src/test/results/clientpositive/buckets.q.out
+++ b/itests/hive-blobstore/src/test/results/clientpositive/buckets.q.out
@@ -61,6 +61,7 @@ PARTITION (b)
 SELECT a, c, b FROM source
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@source
+POSTHOOK: Output: default@buckets
 POSTHOOK: Output: default@buckets@b=abc
 POSTHOOK: Output: default@buckets@b=ajss
 POSTHOOK: Output: default@buckets@b=data
@@ -122,6 +123,7 @@ PARTITION (b)
 SELECT a, c, b FROM source
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@source
+POSTHOOK: Output: default@buckets
 POSTHOOK: Output: default@buckets@b=abc
 POSTHOOK: Output: default@buckets@b=ajss
 POSTHOOK: Output: default@buckets@b=data
diff --git a/itests/hive-blobstore/src/test/results/clientpositive/insert_into_dynamic_partitions.q.out b/itests/hive-blobstore/src/test/results/clientpositive/insert_into_dynamic_partitions.q.out
index fd82a0c0f8..e40b563ef2 100644
--- a/itests/hive-blobstore/src/test/results/clientpositive/insert_into_dynamic_partitions.q.out
+++ b/itests/hive-blobstore/src/test/results/clientpositive/insert_into_dynamic_partitions.q.out
@@ -19,6 +19,7 @@ PREHOOK: Output: default@table1
 POSTHOOK: query: INSERT INTO TABLE table1 PARTITION (key) VALUES (1, '101'), (2, '202'), (3, '303'), (4, '404'), (5, '505')
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@table1
 POSTHOOK: Output: default@table1@key=101
 POSTHOOK: Output: default@table1@key=202
 POSTHOOK: Output: default@table1@key=303
@@ -36,6 +37,7 @@ PREHOOK: Output: default@table1
 POSTHOOK: query: INSERT INTO TABLE table1 PARTITION (key) VALUES (1, '101'), (2, '202'), (3, '303'), (4, '404'), (5, '505')
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@table1
 POSTHOOK: Output: default@table1@key=101
 POSTHOOK: Output: default@table1@key=202
 POSTHOOK: Output: default@table1@key=303
@@ -81,6 +83,7 @@ PREHOOK: Output: default@table1
 POSTHOOK: query: EXPLAIN EXTENDED INSERT INTO TABLE table1 PARTITION (key) VALUES (1, '101'), (2, '202'), (3, '303'), (4, '404'), (5, '505')
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@table1
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -296,6 +299,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@table1
 POSTHOOK: Input: default@table1@country=USA/state=CA
 POSTHOOK: Input: default@table1@country=USA/state=TX
+POSTHOOK: Output: default@table2
 POSTHOOK: Output: default@table2@country=USA/state=CA
 POSTHOOK: Output: default@table2@country=USA/state=TX
 POSTHOOK: Lineage: table2 PARTITION(country=USA,state=CA).age SIMPLE [(table1)table1.FieldSchema(name:age, type:int, comment:null), ]
diff --git a/itests/hive-blobstore/src/test/results/clientpositive/insert_overwrite_dynamic_partitions.q.out b/itests/hive-blobstore/src/test/results/clientpositive/insert_overwrite_dynamic_partitions.q.out
index bdd82d4836..ec3b3ff5b3 100644
--- a/itests/hive-blobstore/src/test/results/clientpositive/insert_overwrite_dynamic_partitions.q.out
+++ b/itests/hive-blobstore/src/test/results/clientpositive/insert_overwrite_dynamic_partitions.q.out
@@ -19,6 +19,7 @@ PREHOOK: Output: default@table1
 POSTHOOK: query: INSERT OVERWRITE TABLE table1 PARTITION (key) VALUES (1, '101'), (2, '202'), (3, '303'), (4, '404'), (5, '505')
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@table1
 POSTHOOK: Output: default@table1@key=101
 POSTHOOK: Output: default@table1@key=202
 POSTHOOK: Output: default@table1@key=303
@@ -59,6 +60,7 @@ PREHOOK: Output: default@table1
 POSTHOOK: query: INSERT OVERWRITE TABLE table1 PARTITION (key) VALUES (1, '101'), (2, '202'), (3, '303'), (4, '404'), (5, '505')
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@table1
 POSTHOOK: Output: default@table1@key=101
 POSTHOOK: Output: default@table1@key=202
 POSTHOOK: Output: default@table1@key=303
@@ -99,6 +101,7 @@ PREHOOK: Output: default@table1
 POSTHOOK: query: EXPLAIN EXTENDED INSERT OVERWRITE TABLE table1 PARTITION (key) VALUES (1, '101'), (2, '202'), (3, '303'), (4, '404'), (5, '505')
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@table1
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-0 depends on stages: Stage-1
@@ -314,6 +317,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@table1
 POSTHOOK: Input: default@table1@country=USA/state=CA
 POSTHOOK: Input: default@table1@country=USA/state=TX
+POSTHOOK: Output: default@table2
 POSTHOOK: Output: default@table2@country=USA/state=CA
 POSTHOOK: Output: default@table2@country=USA/state=TX
 POSTHOOK: Lineage: table2 PARTITION(country=USA,state=CA).age SIMPLE [(table1)table1.FieldSchema(name:age, type:int, comment:null), ]
@@ -357,6 +361,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@table1
 POSTHOOK: Input: default@table1@country=USA/state=CA
 POSTHOOK: Input: default@table1@country=USA/state=TX
+POSTHOOK: Output: default@table2
 POSTHOOK: Output: default@table2@country=USA/state=CA
 POSTHOOK: Lineage: table2 PARTITION(country=USA,state=CA).age SIMPLE [(table1)table1.FieldSchema(name:age, type:int, comment:null), ]
 POSTHOOK: Lineage: table2 PARTITION(country=USA,state=CA).name SIMPLE [(table1)table1.FieldSchema(name:name, type:string, comment:null), ]
diff --git a/itests/hive-blobstore/src/test/results/clientpositive/insert_overwrite_dynamic_partitions_merge_move.q.out b/itests/hive-blobstore/src/test/results/clientpositive/insert_overwrite_dynamic_partitions_merge_move.q.out
index a7c7bb9cc3..6e6e028351 100644
--- a/itests/hive-blobstore/src/test/results/clientpositive/insert_overwrite_dynamic_partitions_merge_move.q.out
+++ b/itests/hive-blobstore/src/test/results/clientpositive/insert_overwrite_dynamic_partitions_merge_move.q.out
@@ -47,6 +47,7 @@ SELECT
 FROM tmp_table_merge_move t
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@tmp_table_merge_move
+POSTHOOK: Output: default@s3_table_merge_move
 POSTHOOK: Output: default@s3_table_merge_move@reported_date=2017-04-10/product_id=10000
 POSTHOOK: Output: default@s3_table_merge_move@reported_date=2017-04-10/product_id=10001
 POSTHOOK: Output: default@s3_table_merge_move@reported_date=2017-04-10/product_id=10002
@@ -94,6 +95,7 @@ SELECT
 FROM tmp_table_merge_move t
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@tmp_table_merge_move
+POSTHOOK: Output: default@s3_table_merge_move
 POSTHOOK: Output: default@s3_table_merge_move@reported_date=2017-04-10/product_id=10000
 POSTHOOK: Output: default@s3_table_merge_move@reported_date=2017-04-10/product_id=10001
 POSTHOOK: Output: default@s3_table_merge_move@reported_date=2017-04-10/product_id=10002
diff --git a/itests/hive-blobstore/src/test/results/clientpositive/insert_overwrite_dynamic_partitions_merge_only.q.out b/itests/hive-blobstore/src/test/results/clientpositive/insert_overwrite_dynamic_partitions_merge_only.q.out
index 09b74bbb7d..428cb2cae0 100644
--- a/itests/hive-blobstore/src/test/results/clientpositive/insert_overwrite_dynamic_partitions_merge_only.q.out
+++ b/itests/hive-blobstore/src/test/results/clientpositive/insert_overwrite_dynamic_partitions_merge_only.q.out
@@ -47,6 +47,7 @@ SELECT
 FROM tmp_table_merge t
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@tmp_table_merge
+POSTHOOK: Output: default@s3_table_merge
 POSTHOOK: Output: default@s3_table_merge@reported_date=2017-04-10/product_id=10000
 POSTHOOK: Output: default@s3_table_merge@reported_date=2017-04-10/product_id=10001
 POSTHOOK: Lineage: s3_table_merge PARTITION(reported_date=2017-04-10,product_id=10000).event_name SIMPLE [(tmp_table_merge)t.FieldSchema(name:name, type:string, comment:null), ]
@@ -89,6 +90,7 @@ SELECT
 FROM tmp_table_merge t
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@tmp_table_merge
+POSTHOOK: Output: default@s3_table_merge
 POSTHOOK: Output: default@s3_table_merge@reported_date=2017-04-10/product_id=10000
 POSTHOOK: Output: default@s3_table_merge@reported_date=2017-04-10/product_id=10001
 POSTHOOK: Lineage: s3_table_merge PARTITION(reported_date=2017-04-10,product_id=10000).event_name SIMPLE [(tmp_table_merge)t.FieldSchema(name:name, type:string, comment:null), ]
diff --git a/itests/hive-blobstore/src/test/results/clientpositive/insert_overwrite_dynamic_partitions_move_only.q.out b/itests/hive-blobstore/src/test/results/clientpositive/insert_overwrite_dynamic_partitions_move_only.q.out
index b60b0a9e6b..c6cc769286 100644
--- a/itests/hive-blobstore/src/test/results/clientpositive/insert_overwrite_dynamic_partitions_move_only.q.out
+++ b/itests/hive-blobstore/src/test/results/clientpositive/insert_overwrite_dynamic_partitions_move_only.q.out
@@ -47,6 +47,7 @@ SELECT
 FROM tmp_table_move t
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@tmp_table_move
+POSTHOOK: Output: default@s3_table_move
 POSTHOOK: Output: default@s3_table_move@reported_date=2017-04-10/product_id=10000
 POSTHOOK: Output: default@s3_table_move@reported_date=2017-04-10/product_id=10001
 POSTHOOK: Output: default@s3_table_move@reported_date=2017-04-10/product_id=10002
@@ -104,6 +105,7 @@ SELECT
 FROM tmp_table_move t
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@tmp_table_move
+POSTHOOK: Output: default@s3_table_move
 POSTHOOK: Output: default@s3_table_move@reported_date=2017-04-10/product_id=10000
 POSTHOOK: Output: default@s3_table_move@reported_date=2017-04-10/product_id=10001
 POSTHOOK: Output: default@s3_table_move@reported_date=2017-04-10/product_id=10002
diff --git a/itests/hive-blobstore/src/test/results/clientpositive/orc_buckets.q.out b/itests/hive-blobstore/src/test/results/clientpositive/orc_buckets.q.out
index e54b84e9f7..4a36522147 100644
--- a/itests/hive-blobstore/src/test/results/clientpositive/orc_buckets.q.out
+++ b/itests/hive-blobstore/src/test/results/clientpositive/orc_buckets.q.out
@@ -63,6 +63,7 @@ PARTITION (b)
 SELECT a, c, b FROM blobstore_source
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@blobstore_source
+POSTHOOK: Output: default@orc_buckets
 POSTHOOK: Output: default@orc_buckets@b=abc
 POSTHOOK: Output: default@orc_buckets@b=ajss
 POSTHOOK: Output: default@orc_buckets@b=data
@@ -124,6 +125,7 @@ PARTITION (b)
 SELECT a, c, b FROM blobstore_source
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@blobstore_source
+POSTHOOK: Output: default@orc_buckets
 POSTHOOK: Output: default@orc_buckets@b=abc
 POSTHOOK: Output: default@orc_buckets@b=ajss
 POSTHOOK: Output: default@orc_buckets@b=data
diff --git a/itests/hive-blobstore/src/test/results/clientpositive/orc_format_part.q.out b/itests/hive-blobstore/src/test/results/clientpositive/orc_format_part.q.out
index 7b2561358a..7d006c020e 100644
--- a/itests/hive-blobstore/src/test/results/clientpositive/orc_format_part.q.out
+++ b/itests/hive-blobstore/src/test/results/clientpositive/orc_format_part.q.out
@@ -99,6 +99,7 @@ POSTHOOK: query: INSERT OVERWRITE TABLE orc_events PARTITION (run_date, game_id,
 SELECT * FROM src_events
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src_events
+POSTHOOK: Output: default@orc_events
 POSTHOOK: Output: default@orc_events@run_date=20120921/game_id=39/event_name=hq_change
 POSTHOOK: Output: default@orc_events@run_date=20121021/game_id=39/event_name=hq_change
 POSTHOOK: Output: default@orc_events@run_date=20121121/game_id=39/event_name=hq_change
diff --git a/itests/hive-blobstore/src/test/results/clientpositive/orc_nonstd_partitions_loc.q.out b/itests/hive-blobstore/src/test/results/clientpositive/orc_nonstd_partitions_loc.q.out
index 1201ce2107..0f952b48ad 100644
--- a/itests/hive-blobstore/src/test/results/clientpositive/orc_nonstd_partitions_loc.q.out
+++ b/itests/hive-blobstore/src/test/results/clientpositive/orc_nonstd_partitions_loc.q.out
@@ -99,6 +99,7 @@ POSTHOOK: query: INSERT OVERWRITE TABLE orc_events PARTITION (run_date, game_id,
 SELECT * FROM src_events
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src_events
+POSTHOOK: Output: default@orc_events
 POSTHOOK: Output: default@orc_events@run_date=20120921/game_id=39/event_name=hq_change
 POSTHOOK: Output: default@orc_events@run_date=20121021/game_id=39/event_name=hq_change
 POSTHOOK: Output: default@orc_events@run_date=20121121/game_id=39/event_name=hq_change
@@ -313,6 +314,7 @@ POSTHOOK: query: INSERT OVERWRITE TABLE orc_events PARTITION (run_date, game_id,
 SELECT * FROM src_events
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src_events
+POSTHOOK: Output: default@orc_events
 POSTHOOK: Output: default@orc_events@run_date=20120921/game_id=39/event_name=hq_change
 POSTHOOK: Output: default@orc_events@run_date=20121021/game_id=39/event_name=hq_change
 POSTHOOK: Output: default@orc_events@run_date=20121121/game_id=39/event_name=hq_change
@@ -433,6 +435,7 @@ POSTHOOK: query: INSERT OVERWRITE TABLE orc_events PARTITION (run_date, game_id,
 SELECT * FROM src_events
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src_events
+POSTHOOK: Output: default@orc_events
 POSTHOOK: Output: default@orc_events@run_date=20120921/game_id=39/event_name=hq_change
 POSTHOOK: Output: default@orc_events@run_date=20121021/game_id=39/event_name=hq_change
 POSTHOOK: Output: default@orc_events@run_date=20121121/game_id=39/event_name=hq_change
diff --git a/itests/hive-blobstore/src/test/results/clientpositive/parquet_buckets.q.out b/itests/hive-blobstore/src/test/results/clientpositive/parquet_buckets.q.out
index 355958d5e1..04bd57364b 100644
--- a/itests/hive-blobstore/src/test/results/clientpositive/parquet_buckets.q.out
+++ b/itests/hive-blobstore/src/test/results/clientpositive/parquet_buckets.q.out
@@ -63,6 +63,7 @@ PARTITION (b)
 SELECT a, c, b FROM blobstore_source
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@blobstore_source
+POSTHOOK: Output: default@parquet_buckets
 POSTHOOK: Output: default@parquet_buckets@b=abc
 POSTHOOK: Output: default@parquet_buckets@b=ajss
 POSTHOOK: Output: default@parquet_buckets@b=data
@@ -124,6 +125,7 @@ PARTITION (b)
 SELECT a, c, b FROM blobstore_source
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@blobstore_source
+POSTHOOK: Output: default@parquet_buckets
 POSTHOOK: Output: default@parquet_buckets@b=abc
 POSTHOOK: Output: default@parquet_buckets@b=ajss
 POSTHOOK: Output: default@parquet_buckets@b=data
diff --git a/itests/hive-blobstore/src/test/results/clientpositive/parquet_format_part.q.out b/itests/hive-blobstore/src/test/results/clientpositive/parquet_format_part.q.out
index 0931e3d557..71297618b8 100644
--- a/itests/hive-blobstore/src/test/results/clientpositive/parquet_format_part.q.out
+++ b/itests/hive-blobstore/src/test/results/clientpositive/parquet_format_part.q.out
@@ -99,6 +99,7 @@ POSTHOOK: query: INSERT OVERWRITE TABLE parquet_events PARTITION (run_date, game
 SELECT * FROM src_events
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src_events
+POSTHOOK: Output: default@parquet_events
 POSTHOOK: Output: default@parquet_events@run_date=20120921/game_id=39/event_name=hq_change
 POSTHOOK: Output: default@parquet_events@run_date=20121021/game_id=39/event_name=hq_change
 POSTHOOK: Output: default@parquet_events@run_date=20121121/game_id=39/event_name=hq_change
diff --git a/itests/hive-blobstore/src/test/results/clientpositive/parquet_nonstd_partitions_loc.q.out b/itests/hive-blobstore/src/test/results/clientpositive/parquet_nonstd_partitions_loc.q.out
index 15ae3d91a7..978238fcf4 100644
--- a/itests/hive-blobstore/src/test/results/clientpositive/parquet_nonstd_partitions_loc.q.out
+++ b/itests/hive-blobstore/src/test/results/clientpositive/parquet_nonstd_partitions_loc.q.out
@@ -99,6 +99,7 @@ POSTHOOK: query: INSERT OVERWRITE TABLE parquet_events PARTITION (run_date, game
 SELECT * FROM src_events
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src_events
+POSTHOOK: Output: default@parquet_events
 POSTHOOK: Output: default@parquet_events@run_date=20120921/game_id=39/event_name=hq_change
 POSTHOOK: Output: default@parquet_events@run_date=20121021/game_id=39/event_name=hq_change
 POSTHOOK: Output: default@parquet_events@run_date=20121121/game_id=39/event_name=hq_change
@@ -313,6 +314,7 @@ POSTHOOK: query: INSERT OVERWRITE TABLE parquet_events PARTITION (run_date, game
 SELECT * FROM src_events
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src_events
+POSTHOOK: Output: default@parquet_events
 POSTHOOK: Output: default@parquet_events@run_date=20120921/game_id=39/event_name=hq_change
 POSTHOOK: Output: default@parquet_events@run_date=20121021/game_id=39/event_name=hq_change
 POSTHOOK: Output: default@parquet_events@run_date=20121121/game_id=39/event_name=hq_change
@@ -433,6 +435,7 @@ POSTHOOK: query: INSERT OVERWRITE TABLE parquet_events PARTITION (run_date, game
 SELECT * FROM src_events
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src_events
+POSTHOOK: Output: default@parquet_events
 POSTHOOK: Output: default@parquet_events@run_date=20120921/game_id=39/event_name=hq_change
 POSTHOOK: Output: default@parquet_events@run_date=20121021/game_id=39/event_name=hq_change
 POSTHOOK: Output: default@parquet_events@run_date=20121121/game_id=39/event_name=hq_change
diff --git a/itests/hive-blobstore/src/test/results/clientpositive/rcfile_buckets.q.out b/itests/hive-blobstore/src/test/results/clientpositive/rcfile_buckets.q.out
index 6bcfd0aced..569292bdb5 100644
--- a/itests/hive-blobstore/src/test/results/clientpositive/rcfile_buckets.q.out
+++ b/itests/hive-blobstore/src/test/results/clientpositive/rcfile_buckets.q.out
@@ -63,6 +63,7 @@ PARTITION (b)
 SELECT a, c, b FROM blobstore_source
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@blobstore_source
+POSTHOOK: Output: default@rcfile_buckets
 POSTHOOK: Output: default@rcfile_buckets@b=abc
 POSTHOOK: Output: default@rcfile_buckets@b=ajss
 POSTHOOK: Output: default@rcfile_buckets@b=data
@@ -124,6 +125,7 @@ PARTITION (b)
 SELECT a, c, b FROM blobstore_source
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@blobstore_source
+POSTHOOK: Output: default@rcfile_buckets
 POSTHOOK: Output: default@rcfile_buckets@b=abc
 POSTHOOK: Output: default@rcfile_buckets@b=ajss
 POSTHOOK: Output: default@rcfile_buckets@b=data
diff --git a/itests/hive-blobstore/src/test/results/clientpositive/rcfile_format_part.q.out b/itests/hive-blobstore/src/test/results/clientpositive/rcfile_format_part.q.out
index 24fc525804..843716f5c7 100644
--- a/itests/hive-blobstore/src/test/results/clientpositive/rcfile_format_part.q.out
+++ b/itests/hive-blobstore/src/test/results/clientpositive/rcfile_format_part.q.out
@@ -99,6 +99,7 @@ POSTHOOK: query: INSERT OVERWRITE TABLE rcfile_events PARTITION (run_date, game_
 SELECT * FROM src_events
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src_events
+POSTHOOK: Output: default@rcfile_events
 POSTHOOK: Output: default@rcfile_events@run_date=20120921/game_id=39/event_name=hq_change
 POSTHOOK: Output: default@rcfile_events@run_date=20121021/game_id=39/event_name=hq_change
 POSTHOOK: Output: default@rcfile_events@run_date=20121121/game_id=39/event_name=hq_change
diff --git a/itests/hive-blobstore/src/test/results/clientpositive/rcfile_nonstd_partitions_loc.q.out b/itests/hive-blobstore/src/test/results/clientpositive/rcfile_nonstd_partitions_loc.q.out
index 6bcfe41262..96fcffc43c 100644
--- a/itests/hive-blobstore/src/test/results/clientpositive/rcfile_nonstd_partitions_loc.q.out
+++ b/itests/hive-blobstore/src/test/results/clientpositive/rcfile_nonstd_partitions_loc.q.out
@@ -99,6 +99,7 @@ POSTHOOK: query: INSERT OVERWRITE TABLE rcfile_events PARTITION (run_date, game_
 SELECT * FROM src_events
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src_events
+POSTHOOK: Output: default@rcfile_events
 POSTHOOK: Output: default@rcfile_events@run_date=20120921/game_id=39/event_name=hq_change
 POSTHOOK: Output: default@rcfile_events@run_date=20121021/game_id=39/event_name=hq_change
 POSTHOOK: Output: default@rcfile_events@run_date=20121121/game_id=39/event_name=hq_change
@@ -323,6 +324,7 @@ POSTHOOK: query: INSERT OVERWRITE TABLE rcfile_events PARTITION (run_date, game_
 SELECT * FROM src_events
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src_events
+POSTHOOK: Output: default@rcfile_events
 POSTHOOK: Output: default@rcfile_events@run_date=20120921/game_id=39/event_name=hq_change
 POSTHOOK: Output: default@rcfile_events@run_date=20121021/game_id=39/event_name=hq_change
 POSTHOOK: Output: default@rcfile_events@run_date=20121121/game_id=39/event_name=hq_change
@@ -453,6 +455,7 @@ POSTHOOK: query: INSERT OVERWRITE TABLE rcfile_events PARTITION (run_date, game_
 SELECT * FROM src_events
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src_events
+POSTHOOK: Output: default@rcfile_events
 POSTHOOK: Output: default@rcfile_events@run_date=20120921/game_id=39/event_name=hq_change
 POSTHOOK: Output: default@rcfile_events@run_date=20121021/game_id=39/event_name=hq_change
 POSTHOOK: Output: default@rcfile_events@run_date=20121121/game_id=39/event_name=hq_change
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
index 958c36d74c..46e1f42913 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
@@ -8188,7 +8188,7 @@ private WriteEntity generateTableWriteEntity(String dest, Table dest_tab,
     if ((dpCtx != null) && (dpCtx.getNumDPCols() >= 0)) {
       // No static partition specified
       if (dpCtx.getNumSPCols() == 0) {
-        output = new WriteEntity(dest_tab, determineWriteType(ltd, dest), false);
+        output = new WriteEntity(dest_tab, determineWriteType(ltd, dest), true);
         outputs.add(output);
         output.setDynamicPartitionWrite(true);
       }
diff --git a/ql/src/test/queries/clientpositive/lineage4.q b/ql/src/test/queries/clientpositive/lineage4.q
new file mode 100644
index 0000000000..85ec9fc189
--- /dev/null
+++ b/ql/src/test/queries/clientpositive/lineage4.q
@@ -0,0 +1,3 @@
+create table table_t (id int) partitioned by (dob date);
+create table table_b (id int) partitioned by (dob date);
+from table_b a insert overwrite table table_t select a.id,a.dob;
diff --git a/ql/src/test/results/clientnegative/mm_delete.q.out b/ql/src/test/results/clientnegative/mm_delete.q.out
index d0fd905673..aa0d083024 100644
--- a/ql/src/test/results/clientnegative/mm_delete.q.out
+++ b/ql/src/test/results/clientnegative/mm_delete.q.out
@@ -25,6 +25,7 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
+POSTHOOK: Output: default@mm_srcpart
 POSTHOOK: Output: default@mm_srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@mm_srcpart@ds=2008-04-08/hr=12
 POSTHOOK: Output: default@mm_srcpart@ds=2008-04-09/hr=11
diff --git a/ql/src/test/results/clientnegative/mm_update.q.out b/ql/src/test/results/clientnegative/mm_update.q.out
index 528d16269f..d412d8b999 100644
--- a/ql/src/test/results/clientnegative/mm_update.q.out
+++ b/ql/src/test/results/clientnegative/mm_update.q.out
@@ -25,6 +25,7 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
+POSTHOOK: Output: default@mm_srcpart
 POSTHOOK: Output: default@mm_srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@mm_srcpart@ds=2008-04-08/hr=12
 POSTHOOK: Output: default@mm_srcpart@ds=2008-04-09/hr=11
diff --git a/ql/src/test/results/clientpositive/encrypted/encryption_drop_partition.q.out b/ql/src/test/results/clientpositive/encrypted/encryption_drop_partition.q.out
index f8d7b0638c..19cef72a9d 100644
--- a/ql/src/test/results/clientpositive/encrypted/encryption_drop_partition.q.out
+++ b/ql/src/test/results/clientpositive/encrypted/encryption_drop_partition.q.out
@@ -21,6 +21,7 @@ PREHOOK: Output: default@encrypted_table_dp
 POSTHOOK: query: INSERT INTO encrypted_table_dp PARTITION(p)(p,key,value) values('2014-09-23', 1, 'foo'),('2014-09-24', 2, 'bar')
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@encrypted_table_dp
 POSTHOOK: Output: default@encrypted_table_dp@p=2014-09-23
 POSTHOOK: Output: default@encrypted_table_dp@p=2014-09-24
 POSTHOOK: Lineage: encrypted_table_dp PARTITION(p=2014-09-23).key SCRIPT []
diff --git a/ql/src/test/results/clientpositive/encrypted/encryption_insert_partition_dynamic.q.out b/ql/src/test/results/clientpositive/encrypted/encryption_insert_partition_dynamic.q.out
index f9c7060315..0af7f5e35f 100644
--- a/ql/src/test/results/clientpositive/encrypted/encryption_insert_partition_dynamic.q.out
+++ b/ql/src/test/results/clientpositive/encrypted/encryption_insert_partition_dynamic.q.out
@@ -43,6 +43,7 @@ POSTHOOK: query: insert into table encryptedTable_n0 partition (key) values
     ('val_502', '502')
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@encryptedtable_n0
 POSTHOOK: Output: default@encryptedtable_n0@key=501
 POSTHOOK: Output: default@encryptedtable_n0@key=502
 POSTHOOK: Lineage: encryptedtable_n0 PARTITION(key=501).value SCRIPT []
@@ -72,6 +73,7 @@ insert into table encryptedTable_n0 partition (key)
     select value, key limit 2
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
+POSTHOOK: Output: default@encryptedtable_n0
 POSTHOOK: Output: default@encryptedtable_n0@key=238
 POSTHOOK: Output: default@encryptedtable_n0@key=501
 POSTHOOK: Output: default@encryptedtable_n0@key=502
@@ -119,6 +121,7 @@ POSTHOOK: Input: default@encryptedtable_n0@key=238
 POSTHOOK: Input: default@encryptedtable_n0@key=501
 POSTHOOK: Input: default@encryptedtable_n0@key=502
 POSTHOOK: Input: default@encryptedtable_n0@key=86
+POSTHOOK: Output: default@unencryptedtable_n0
 POSTHOOK: Output: default@unencryptedtable_n0@key=238
 POSTHOOK: Output: default@unencryptedtable_n0@key=501
 POSTHOOK: Output: default@unencryptedtable_n0@key=502
diff --git a/ql/src/test/results/clientpositive/llap/acid_direct_insert_insert_overwrite.q.out b/ql/src/test/results/clientpositive/llap/acid_direct_insert_insert_overwrite.q.out
index d3a33cb36f..edb8fbdf67 100644
--- a/ql/src/test/results/clientpositive/llap/acid_direct_insert_insert_overwrite.q.out
+++ b/ql/src/test/results/clientpositive/llap/acid_direct_insert_insert_overwrite.q.out
@@ -626,6 +626,7 @@ PREHOOK: Output: default@io_test_acid_part
 POSTHOOK: query: insert overwrite table io_test_acid_part partition (c) select a, b, c from io_test_text_1 where c is not null
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@io_test_text_1
+POSTHOOK: Output: default@io_test_acid_part
 POSTHOOK: Output: default@io_test_acid_part@c=1111
 POSTHOOK: Output: default@io_test_acid_part@c=2222
 POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1111).a SIMPLE [(io_test_text_1)io_test_text_1.FieldSchema(name:a, type:int, comment:null), ]
@@ -654,6 +655,7 @@ PREHOOK: Output: default@io_test_acid_part
 POSTHOOK: query: insert overwrite table io_test_acid_part partition (c) select a, b, c from io_test_text_1 where c is null
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@io_test_text_1
+POSTHOOK: Output: default@io_test_acid_part
 POSTHOOK: Output: default@io_test_acid_part@c=1111
 POSTHOOK: Output: default@io_test_acid_part@c=2222
 POSTHOOK: Output: default@io_test_acid_part@c=__HIVE_DEFAULT_PARTITION__
@@ -689,6 +691,7 @@ PREHOOK: Output: default@io_test_acid_part
 POSTHOOK: query: insert overwrite table io_test_acid_part partition (c) select a, b, c from io_test_text_2 where b=11 or b=44 or b=99
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@io_test_text_2
+POSTHOOK: Output: default@io_test_acid_part
 POSTHOOK: Output: default@io_test_acid_part@c=1111
 POSTHOOK: Output: default@io_test_acid_part@c=2222
 POSTHOOK: Output: default@io_test_acid_part@c=4444
@@ -729,6 +732,7 @@ PREHOOK: Output: default@io_test_acid_part
 POSTHOOK: query: insert overwrite table io_test_acid_part partition (c) select a, b, c from io_test_text_2 where b=99
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@io_test_text_2
+POSTHOOK: Output: default@io_test_acid_part
 POSTHOOK: Output: default@io_test_acid_part@c=1111
 POSTHOOK: Output: default@io_test_acid_part@c=2222
 POSTHOOK: Output: default@io_test_acid_part@c=4444
@@ -789,6 +793,7 @@ insert overwrite table io_test_acid_part partition (c) select a, b, c where c is
 insert overwrite table io_test_acid_part partition (c) select a, b, c where c is null
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@io_test_text_1
+POSTHOOK: Output: default@io_test_acid_part
 POSTHOOK: Output: default@io_test_acid_part@c=1111
 POSTHOOK: Output: default@io_test_acid_part@c=2222
 POSTHOOK: Output: default@io_test_acid_part@c=__HIVE_DEFAULT_PARTITION__
@@ -830,6 +835,7 @@ insert overwrite table io_test_acid_part partition (c) select a, b, c where b=99
 insert overwrite table io_test_acid_part partition (c) select a, b, c where b=44
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@io_test_text_1
+POSTHOOK: Output: default@io_test_acid_part
 POSTHOOK: Output: default@io_test_acid_part@c=1111
 POSTHOOK: Output: default@io_test_acid_part@c=2222
 POSTHOOK: Output: default@io_test_acid_part@c=__HIVE_DEFAULT_PARTITION__
@@ -869,6 +875,7 @@ insert overwrite table io_test_acid_part partition (c) select a, b, c where b=44
 insert overwrite table io_test_acid_part partition (c) select a, b, c where b=9
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@io_test_text_2
+POSTHOOK: Output: default@io_test_acid_part
 POSTHOOK: Output: default@io_test_acid_part@c=1111
 POSTHOOK: Output: default@io_test_acid_part@c=2222
 POSTHOOK: Output: default@io_test_acid_part@c=4444
@@ -928,6 +935,7 @@ insert overwrite table io_test_acid_part partition (c) select a, b, c where c is
 insert overwrite table io_test_acid_part partition (c) select a, b, c where c is null
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@io_test_text_2
+POSTHOOK: Output: default@io_test_acid_part
 POSTHOOK: Output: default@io_test_acid_part@c=1111
 POSTHOOK: Output: default@io_test_acid_part@c=2222
 POSTHOOK: Output: default@io_test_acid_part@c=4444
@@ -987,6 +995,7 @@ insert overwrite table io_test_acid_part partition (c) select a, b, c where b=33
 insert overwrite table io_test_acid_part partition (c) select a, b, c where b=88
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@io_test_text_2
+POSTHOOK: Output: default@io_test_acid_part
 POSTHOOK: Output: default@io_test_acid_part@c=1111
 POSTHOOK: Output: default@io_test_acid_part@c=2222
 POSTHOOK: Lineage: io_test_acid_part PARTITION(c=1111).a SIMPLE [(io_test_text_2)io_test_text_2.FieldSchema(name:a, type:int, comment:null), ]
@@ -1117,6 +1126,7 @@ insert overwrite table io_test_acid_part partition (pc1, pc2, pc3)
   where a=111
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@io_test_text_3
+POSTHOOK: Output: default@io_test_acid_part
 POSTHOOK: Output: default@io_test_acid_part@pc1=11/pc2=11/pc3=11
 POSTHOOK: Output: default@io_test_acid_part@pc1=11/pc2=11/pc3=22
 POSTHOOK: Output: default@io_test_acid_part@pc1=11/pc2=11/pc3=__HIVE_DEFAULT_PARTITION__
diff --git a/ql/src/test/results/clientpositive/llap/acid_insert_overwrite.q.out b/ql/src/test/results/clientpositive/llap/acid_insert_overwrite.q.out
index 7fd2d3ae6e..8aca839e2f 100644
--- a/ql/src/test/results/clientpositive/llap/acid_insert_overwrite.q.out
+++ b/ql/src/test/results/clientpositive/llap/acid_insert_overwrite.q.out
@@ -355,6 +355,7 @@ PREHOOK: Output: default@acidparttbl
 POSTHOOK: query: insert into table acidparttbl partition(p) values ('g', 7, 100), ('h', 8, 200)
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@acidparttbl
 POSTHOOK: Output: default@acidparttbl@p=100
 POSTHOOK: Output: default@acidparttbl@p=200
 POSTHOOK: Lineage: acidparttbl PARTITION(p=100).key SCRIPT []
@@ -385,6 +386,7 @@ PREHOOK: Output: default@acidparttbl
 POSTHOOK: query: insert overwrite table acidparttbl partition(p) values ('i', 9, 100), ('j', 10, 200)
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@acidparttbl
 POSTHOOK: Output: default@acidparttbl@p=100
 POSTHOOK: Output: default@acidparttbl@p=200
 POSTHOOK: Lineage: acidparttbl PARTITION(p=100).key SCRIPT []
diff --git a/ql/src/test/results/clientpositive/llap/acid_insert_overwrite_update.q.out b/ql/src/test/results/clientpositive/llap/acid_insert_overwrite_update.q.out
index 45a2e331b5..44e614c028 100644
--- a/ql/src/test/results/clientpositive/llap/acid_insert_overwrite_update.q.out
+++ b/ql/src/test/results/clientpositive/llap/acid_insert_overwrite_update.q.out
@@ -154,6 +154,7 @@ PREHOOK: Output: default@orc_test_txn
 #### A masked pattern was here ####
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@orc_test_txn__temp_table_for_load_data__
+POSTHOOK: Output: default@orc_test_txn
 POSTHOOK: Output: default@orc_test_txn@year=2016
 POSTHOOK: Output: default@orc_test_txn@year=2017
 POSTHOOK: Output: default@orc_test_txn@year=2018
diff --git a/ql/src/test/results/clientpositive/llap/acid_multiinsert_dyn_part.q.out b/ql/src/test/results/clientpositive/llap/acid_multiinsert_dyn_part.q.out
index 645c858364..83479b7b37 100644
--- a/ql/src/test/results/clientpositive/llap/acid_multiinsert_dyn_part.q.out
+++ b/ql/src/test/results/clientpositive/llap/acid_multiinsert_dyn_part.q.out
@@ -113,6 +113,7 @@ where a.c is null
 sort by a.c
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@multiinsert_test_text
+POSTHOOK: Output: default@multiinsert_test_acid
 POSTHOOK: Output: default@multiinsert_test_acid@c=1111
 POSTHOOK: Output: default@multiinsert_test_acid@c=2222
 POSTHOOK: Output: default@multiinsert_test_acid@c=__HIVE_DEFAULT_PARTITION__
@@ -174,6 +175,7 @@ where a.c is null
 sort by a.c
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@multiinsert_test_text
+POSTHOOK: Output: default@multiinsert_test_mm
 POSTHOOK: Output: default@multiinsert_test_mm@c=1111
 POSTHOOK: Output: default@multiinsert_test_mm@c=2222
 POSTHOOK: Output: default@multiinsert_test_mm@c=__HIVE_DEFAULT_PARTITION__
@@ -235,6 +237,7 @@ where a.c is null
 sort by a.c
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@multiinsert_test_text
+POSTHOOK: Output: default@multiinsert_test_acid_nondi
 POSTHOOK: Output: default@multiinsert_test_acid_nondi@c=1111
 POSTHOOK: Output: default@multiinsert_test_acid_nondi@c=2222
 POSTHOOK: Output: default@multiinsert_test_acid_nondi@c=__HIVE_DEFAULT_PARTITION__
@@ -344,6 +347,7 @@ where a.c is null
 sort by a.c
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@multiinsert_test_text_2
+POSTHOOK: Output: default@multiinsert_test_acid
 POSTHOOK: Output: default@multiinsert_test_acid@c=1111
 POSTHOOK: Output: default@multiinsert_test_acid@c=2222
 POSTHOOK: Output: default@multiinsert_test_acid@c=4444
@@ -405,6 +409,7 @@ where a.c is null
 sort by a.c
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@multiinsert_test_text_2
+POSTHOOK: Output: default@multiinsert_test_mm
 POSTHOOK: Output: default@multiinsert_test_mm@c=1111
 POSTHOOK: Output: default@multiinsert_test_mm@c=2222
 POSTHOOK: Output: default@multiinsert_test_mm@c=4444
@@ -466,6 +471,7 @@ where a.c is null
 sort by a.c
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@multiinsert_test_text_2
+POSTHOOK: Output: default@multiinsert_test_acid_nondi
 POSTHOOK: Output: default@multiinsert_test_acid_nondi@c=1111
 POSTHOOK: Output: default@multiinsert_test_acid_nondi@c=2222
 POSTHOOK: Output: default@multiinsert_test_acid_nondi@c=4444
diff --git a/ql/src/test/results/clientpositive/llap/acid_no_buckets.q.out b/ql/src/test/results/clientpositive/llap/acid_no_buckets.q.out
index 0902ddc0d1..e368f92d9d 100644
--- a/ql/src/test/results/clientpositive/llap/acid_no_buckets.q.out
+++ b/ql/src/test/results/clientpositive/llap/acid_no_buckets.q.out
@@ -25,6 +25,7 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
+POSTHOOK: Output: default@srcpart_acid
 POSTHOOK: Output: default@srcpart_acid@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@srcpart_acid@ds=2008-04-08/hr=12
 POSTHOOK: Output: default@srcpart_acid@ds=2008-04-09/hr=11
@@ -605,6 +606,7 @@ POSTHOOK: Input: default@srcpart_acid@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart_acid@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart_acid@ds=2008-04-09/hr=12
 POSTHOOK: Output: default@merge_tmp_table
+POSTHOOK: Output: default@srcpart_acid
 POSTHOOK: Output: default@srcpart_acid@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@srcpart_acid@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@srcpart_acid@ds=2008-04-08/hr=11
@@ -696,6 +698,7 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
+POSTHOOK: Output: default@srcpart_acidb
 POSTHOOK: Output: default@srcpart_acidb@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@srcpart_acidb@ds=2008-04-08/hr=12
 POSTHOOK: Output: default@srcpart_acidb@ds=2008-04-09/hr=11
@@ -1156,6 +1159,7 @@ POSTHOOK: Input: default@srcpart_acidb@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart_acidb@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart_acidb@ds=2008-04-09/hr=12
 POSTHOOK: Output: default@merge_tmp_table
+POSTHOOK: Output: default@srcpart_acidb
 POSTHOOK: Output: default@srcpart_acidb@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@srcpart_acidb@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@srcpart_acidb@ds=2008-04-08/hr=11
@@ -1247,6 +1251,7 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
+POSTHOOK: Output: default@srcpart_acidv
 POSTHOOK: Output: default@srcpart_acidv@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@srcpart_acidv@ds=2008-04-08/hr=12
 POSTHOOK: Output: default@srcpart_acidv@ds=2008-04-09/hr=11
@@ -1737,6 +1742,7 @@ POSTHOOK: Input: default@srcpart_acidv@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart_acidv@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart_acidv@ds=2008-04-09/hr=12
 POSTHOOK: Output: default@merge_tmp_table
+POSTHOOK: Output: default@srcpart_acidv
 POSTHOOK: Output: default@srcpart_acidv@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@srcpart_acidv@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@srcpart_acidv@ds=2008-04-08/hr=12
@@ -2027,6 +2033,7 @@ POSTHOOK: Input: default@srcpart_acidv@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart_acidv@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart_acidv@ds=2008-04-09/hr=12
 POSTHOOK: Output: default@merge_tmp_table
+POSTHOOK: Output: default@srcpart_acidv
 POSTHOOK: Output: default@srcpart_acidv@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@srcpart_acidv@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@srcpart_acidv@ds=2008-04-08/hr=11
@@ -2118,6 +2125,7 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
+POSTHOOK: Output: default@srcpart_acidvb
 POSTHOOK: Output: default@srcpart_acidvb@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@srcpart_acidvb@ds=2008-04-08/hr=12
 POSTHOOK: Output: default@srcpart_acidvb@ds=2008-04-09/hr=11
@@ -2608,6 +2616,7 @@ POSTHOOK: Input: default@srcpart_acidvb@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart_acidvb@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart_acidvb@ds=2008-04-09/hr=12
 POSTHOOK: Output: default@merge_tmp_table
+POSTHOOK: Output: default@srcpart_acidvb
 POSTHOOK: Output: default@srcpart_acidvb@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@srcpart_acidvb@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@srcpart_acidvb@ds=2008-04-08/hr=12
@@ -2907,6 +2916,7 @@ POSTHOOK: Input: default@srcpart_acidvb@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart_acidvb@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart_acidvb@ds=2008-04-09/hr=12
 POSTHOOK: Output: default@merge_tmp_table
+POSTHOOK: Output: default@srcpart_acidvb
 POSTHOOK: Output: default@srcpart_acidvb@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@srcpart_acidvb@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@srcpart_acidvb@ds=2008-04-08/hr=11
diff --git a/ql/src/test/results/clientpositive/llap/acid_stats2.q.out b/ql/src/test/results/clientpositive/llap/acid_stats2.q.out
index f692c2a465..c38829e15b 100644
--- a/ql/src/test/results/clientpositive/llap/acid_stats2.q.out
+++ b/ql/src/test/results/clientpositive/llap/acid_stats2.q.out
@@ -278,6 +278,7 @@ PREHOOK: Output: default@stats4
 POSTHOOK: query: insert into table stats4 partition (ds) values (12341234, 'bob', 'today'),(123471234871239847, 'bob', 'today'),(431, 'tracy', 'tomorrow')
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@stats4
 POSTHOOK: Output: default@stats4@ds=today
 POSTHOOK: Output: default@stats4@ds=tomorrow
 POSTHOOK: Lineage: stats4 PARTITION(ds=today).key SCRIPT []
diff --git a/ql/src/test/results/clientpositive/llap/acid_subquery.q.out b/ql/src/test/results/clientpositive/llap/acid_subquery.q.out
index 4ca2e5a09d..eef983c743 100644
--- a/ql/src/test/results/clientpositive/llap/acid_subquery.q.out
+++ b/ql/src/test/results/clientpositive/llap/acid_subquery.q.out
@@ -29,6 +29,7 @@ PREHOOK: Output: default@target
 POSTHOOK: query: insert into target partition(p,q) values (1,2,1,2), (3,4,1,2), (5,6,1,3), (7,8,2,2)
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@target
 POSTHOOK: Output: default@target@p=1/q=2
 POSTHOOK: Output: default@target@p=1/q=3
 POSTHOOK: Output: default@target@p=2/q=2
@@ -93,6 +94,7 @@ POSTHOOK: Input: default@target@p=1/q=2
 POSTHOOK: Input: default@target@p=1/q=3
 POSTHOOK: Input: default@target@p=2/q=2
 POSTHOOK: Output: default@merge_tmp_table
+POSTHOOK: Output: default@target
 POSTHOOK: Output: default@target@p=1/q=2
 POSTHOOK: Output: default@target@p=1/q=2
 POSTHOOK: Output: default@target@p=1/q=2
diff --git a/ql/src/test/results/clientpositive/llap/acid_table_directories_test.q.out b/ql/src/test/results/clientpositive/llap/acid_table_directories_test.q.out
index 1fec3617ad..71979a5006 100644
--- a/ql/src/test/results/clientpositive/llap/acid_table_directories_test.q.out
+++ b/ql/src/test/results/clientpositive/llap/acid_table_directories_test.q.out
@@ -96,6 +96,7 @@ PREHOOK: Output: default@acidparttbl
 POSTHOOK: query: insert into table acidparttbl partition(p) values ('g', 7, 100), ('h', 8, 200)
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@acidparttbl
 POSTHOOK: Output: default@acidparttbl@p=100
 POSTHOOK: Output: default@acidparttbl@p=200
 POSTHOOK: Lineage: acidparttbl PARTITION(p=100).key SCRIPT []
@@ -126,6 +127,7 @@ PREHOOK: Output: default@acidparttbl
 POSTHOOK: query: insert overwrite table acidparttbl partition(p) values ('i', 9, 100), ('j', 10, 200)
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@acidparttbl
 POSTHOOK: Output: default@acidparttbl@p=100
 POSTHOOK: Output: default@acidparttbl@p=200
 POSTHOOK: Lineage: acidparttbl PARTITION(p=100).key SCRIPT []
diff --git a/ql/src/test/results/clientpositive/llap/acid_table_stats.q.out b/ql/src/test/results/clientpositive/llap/acid_table_stats.q.out
index 0ee584f331..36c65fae4f 100644
--- a/ql/src/test/results/clientpositive/llap/acid_table_stats.q.out
+++ b/ql/src/test/results/clientpositive/llap/acid_table_stats.q.out
@@ -65,6 +65,7 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
+POSTHOOK: Output: default@acid
 POSTHOOK: Output: default@acid@ds=2008-04-08
 POSTHOOK: Output: default@acid@ds=2008-04-09
 POSTHOOK: Lineage: acid PARTITION(ds=2008-04-08).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -293,6 +294,7 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
+POSTHOOK: Output: default@acid
 POSTHOOK: Output: default@acid@ds=2008-04-08
 POSTHOOK: Output: default@acid@ds=2008-04-09
 POSTHOOK: Lineage: acid PARTITION(ds=2008-04-08).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -560,6 +562,7 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
+POSTHOOK: Output: default@acid
 POSTHOOK: Output: default@acid@ds=2008-04-08
 POSTHOOK: Output: default@acid@ds=2008-04-09
 POSTHOOK: Lineage: acid PARTITION(ds=2008-04-08).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/llap/alterColumnStatsPart.q.out b/ql/src/test/results/clientpositive/llap/alterColumnStatsPart.q.out
index a62f9ff086..2e2b391d7d 100644
--- a/ql/src/test/results/clientpositive/llap/alterColumnStatsPart.q.out
+++ b/ql/src/test/results/clientpositive/llap/alterColumnStatsPart.q.out
@@ -221,6 +221,7 @@ PREHOOK: Output: default@p
 POSTHOOK: query: insert into p partition (c) values (2,3,4)
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@p
 POSTHOOK: Output: default@p@c=4
 POSTHOOK: Lineage: p PARTITION(c=4).a SCRIPT []
 POSTHOOK: Lineage: p PARTITION(c=4).b SCRIPT []
@@ -231,6 +232,7 @@ PREHOOK: Output: default@p
 POSTHOOK: query: insert into p partition (c) values (4,5,6)
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@p
 POSTHOOK: Output: default@p@c=6
 POSTHOOK: Lineage: p PARTITION(c=6).a SCRIPT []
 POSTHOOK: Lineage: p PARTITION(c=6).b SCRIPT []
diff --git a/ql/src/test/results/clientpositive/llap/alter_partition_change_col.q.out b/ql/src/test/results/clientpositive/llap/alter_partition_change_col.q.out
index 9a5ac432ac..2c9db39e70 100644
--- a/ql/src/test/results/clientpositive/llap/alter_partition_change_col.q.out
+++ b/ql/src/test/results/clientpositive/llap/alter_partition_change_col.q.out
@@ -35,6 +35,7 @@ POSTHOOK: query: insert overwrite table alter_partition_change_col1 partition (p
   select c1, c2, cast(null as string), '123' from alter_partition_change_col0
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alter_partition_change_col0
+POSTHOOK: Output: default@alter_partition_change_col1
 POSTHOOK: Output: default@alter_partition_change_col1@p1=__HIVE_DEFAULT_PARTITION__/p2=123
 POSTHOOK: Output: default@alter_partition_change_col1@p1=abc/p2=123
 POSTHOOK: Lineage: alter_partition_change_col1 PARTITION(p1=__HIVE_DEFAULT_PARTITION__,p2=123).c1 EXPRESSION [(alter_partition_change_col0)alter_partition_change_col0.FieldSchema(name:c1, type:string, comment:null), ]
diff --git a/ql/src/test/results/clientpositive/llap/alter_partition_coltype.q.out b/ql/src/test/results/clientpositive/llap/alter_partition_coltype.q.out
index 3567e5c790..92daaa634c 100644
--- a/ql/src/test/results/clientpositive/llap/alter_partition_coltype.q.out
+++ b/ql/src/test/results/clientpositive/llap/alter_partition_coltype.q.out
@@ -428,6 +428,7 @@ PREHOOK: Output: pt@alterdynamic_part_table
 POSTHOOK: query: insert into table pt.alterdynamic_part_table partition(partcol1, partcol2) select '1', '1', '1' from src where key=150 limit 5
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
+POSTHOOK: Output: pt@alterdynamic_part_table
 POSTHOOK: Output: pt@alterdynamic_part_table@partcol1=1/partcol2=1
 POSTHOOK: Lineage: alterdynamic_part_table PARTITION(partcol1=1,partcol2=1).intcol SIMPLE []
 PREHOOK: query: insert into table pt.alterdynamic_part_table partition(partcol1, partcol2) select '1', '2', '1' from src where key=150 limit 5
@@ -437,6 +438,7 @@ PREHOOK: Output: pt@alterdynamic_part_table
 POSTHOOK: query: insert into table pt.alterdynamic_part_table partition(partcol1, partcol2) select '1', '2', '1' from src where key=150 limit 5
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
+POSTHOOK: Output: pt@alterdynamic_part_table
 POSTHOOK: Output: pt@alterdynamic_part_table@partcol1=2/partcol2=1
 POSTHOOK: Lineage: alterdynamic_part_table PARTITION(partcol1=2,partcol2=1).intcol SIMPLE []
 PREHOOK: query: insert into table pt.alterdynamic_part_table partition(partcol1, partcol2) select NULL, '1', '1' from src where key=150 limit 5
@@ -446,6 +448,7 @@ PREHOOK: Output: pt@alterdynamic_part_table
 POSTHOOK: query: insert into table pt.alterdynamic_part_table partition(partcol1, partcol2) select NULL, '1', '1' from src where key=150 limit 5
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
+POSTHOOK: Output: pt@alterdynamic_part_table
 POSTHOOK: Output: pt@alterdynamic_part_table@partcol1=1/partcol2=1
 POSTHOOK: Lineage: alterdynamic_part_table PARTITION(partcol1=1,partcol2=1).intcol EXPRESSION []
 PREHOOK: query: alter table pt.alterdynamic_part_table partition column (partcol1 int)
diff --git a/ql/src/test/results/clientpositive/llap/alter_table_cascade.q.out b/ql/src/test/results/clientpositive/llap/alter_table_cascade.q.out
index d722b902bd..ffc127d419 100644
--- a/ql/src/test/results/clientpositive/llap/alter_table_cascade.q.out
+++ b/ql/src/test/results/clientpositive/llap/alter_table_cascade.q.out
@@ -43,6 +43,7 @@ POSTHOOK: query: insert overwrite table alter_table_cascade partition (p1, p2)
   select c1, cast(null as string), '123' from alter_table_src
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alter_table_src
+POSTHOOK: Output: default@alter_table_cascade
 POSTHOOK: Output: default@alter_table_cascade@p1=__HIVE_DEFAULT_PARTITION__/p2=123
 POSTHOOK: Output: default@alter_table_cascade@p1=abc/p2=123
 POSTHOOK: Lineage: alter_table_cascade PARTITION(p1=__HIVE_DEFAULT_PARTITION__,p2=123).c1 EXPRESSION [(alter_table_src)alter_table_src.FieldSchema(name:c1, type:string, comment:null), ]
@@ -857,6 +858,7 @@ POSTHOOK: query: insert overwrite table alter_table_restrict partition (p1, p2)
   select c1, cast(null as string), '123' from alter_table_src
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alter_table_src
+POSTHOOK: Output: default@alter_table_restrict
 POSTHOOK: Output: default@alter_table_restrict@p1=__HIVE_DEFAULT_PARTITION__/p2=123
 POSTHOOK: Output: default@alter_table_restrict@p1=abc/p2=123
 POSTHOOK: Lineage: alter_table_restrict PARTITION(p1=__HIVE_DEFAULT_PARTITION__,p2=123).c1 EXPRESSION [(alter_table_src)alter_table_src.FieldSchema(name:c1, type:string, comment:null), ]
diff --git a/ql/src/test/results/clientpositive/llap/alter_table_partition_drop.q.out b/ql/src/test/results/clientpositive/llap/alter_table_partition_drop.q.out
index 511cb99756..45c8ff5a32 100644
--- a/ql/src/test/results/clientpositive/llap/alter_table_partition_drop.q.out
+++ b/ql/src/test/results/clientpositive/llap/alter_table_partition_drop.q.out
@@ -17,6 +17,7 @@ PREHOOK: Output: default@part_table
 POSTHOOK: query: INSERT INTO part_table PARTITION(p)(p,key,value) values('2014-09-23', 1, 'foo'),('2014-09-24', 2, 'bar')
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@part_table
 POSTHOOK: Output: default@part_table@p=2014-09-23
 POSTHOOK: Output: default@part_table@p=2014-09-24
 POSTHOOK: Lineage: part_table PARTITION(p=2014-09-23).key SCRIPT []
diff --git a/ql/src/test/results/clientpositive/llap/analyze_table_null_partition.q.out b/ql/src/test/results/clientpositive/llap/analyze_table_null_partition.q.out
index da06a7d599..5d8100931f 100644
--- a/ql/src/test/results/clientpositive/llap/analyze_table_null_partition.q.out
+++ b/ql/src/test/results/clientpositive/llap/analyze_table_null_partition.q.out
@@ -37,6 +37,7 @@ PREHOOK: Output: default@test2_n6
 POSTHOOK: query: FROM test1_n9 INSERT OVERWRITE TABLE test2_n6 PARTITION(age) SELECT test1_n9.name, test1_n9.age
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@test1_n9
+POSTHOOK: Output: default@test2_n6
 POSTHOOK: Output: default@test2_n6@age=15
 POSTHOOK: Output: default@test2_n6@age=30
 POSTHOOK: Output: default@test2_n6@age=40
diff --git a/ql/src/test/results/clientpositive/llap/annotate_stats_part.q.out b/ql/src/test/results/clientpositive/llap/annotate_stats_part.q.out
index fb0b15cb83..85c049fe39 100644
--- a/ql/src/test/results/clientpositive/llap/annotate_stats_part.q.out
+++ b/ql/src/test/results/clientpositive/llap/annotate_stats_part.q.out
@@ -70,6 +70,7 @@ PREHOOK: Output: default@loc_orc_n4
 POSTHOOK: query: insert overwrite table loc_orc_n4 partition(year) select * from loc_staging_n4
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@loc_staging_n4
+POSTHOOK: Output: default@loc_orc_n4
 POSTHOOK: Output: default@loc_orc_n4@year=2001
 POSTHOOK: Output: default@loc_orc_n4@year=__HIVE_DEFAULT_PARTITION__
 POSTHOOK: Lineage: loc_orc_n4 PARTITION(year=2001).locid SIMPLE [(loc_staging_n4)loc_staging_n4.FieldSchema(name:locid, type:int, comment:null), ]
diff --git a/ql/src/test/results/clientpositive/llap/autoColumnStats_1.q.out b/ql/src/test/results/clientpositive/llap/autoColumnStats_1.q.out
index feb626cb1b..d42c842c0a 100644
--- a/ql/src/test/results/clientpositive/llap/autoColumnStats_1.q.out
+++ b/ql/src/test/results/clientpositive/llap/autoColumnStats_1.q.out
@@ -446,6 +446,7 @@ select key, value from (
 ) T
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
+POSTHOOK: Output: default@nzhang_part14_n1
 POSTHOOK: Output: default@nzhang_part14_n1@value= 
 POSTHOOK: Output: default@nzhang_part14_n1@value=__HIVE_DEFAULT_PARTITION__
 POSTHOOK: Lineage: nzhang_part14_n1 PARTITION(value= ).key EXPRESSION []
@@ -538,6 +539,7 @@ POSTHOOK: query: insert overwrite table nzhang_part14_n1 partition(value)
 select key, value from src5_n0
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src5_n0
+POSTHOOK: Output: default@nzhang_part14_n1
 POSTHOOK: Output: default@nzhang_part14_n1@value=val_165
 POSTHOOK: Output: default@nzhang_part14_n1@value=val_238
 POSTHOOK: Output: default@nzhang_part14_n1@value=val_27
@@ -1090,6 +1092,7 @@ select key, value, ds, hr from (
 ) T
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
+POSTHOOK: Output: default@nzhang_part14_n1
 POSTHOOK: Output: default@nzhang_part14_n1@ds=1/hr=2
 POSTHOOK: Output: default@nzhang_part14_n1@ds=1/hr=3
 POSTHOOK: Output: default@nzhang_part14_n1@ds=2/hr=1
diff --git a/ql/src/test/results/clientpositive/llap/autoColumnStats_2.q.out b/ql/src/test/results/clientpositive/llap/autoColumnStats_2.q.out
index 0a73e2dd45..c1d11a15bd 100644
--- a/ql/src/test/results/clientpositive/llap/autoColumnStats_2.q.out
+++ b/ql/src/test/results/clientpositive/llap/autoColumnStats_2.q.out
@@ -477,6 +477,7 @@ select key, value from (
 ) T
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
+POSTHOOK: Output: default@nzhang_part14
 POSTHOOK: Output: default@nzhang_part14@value= 
 POSTHOOK: Output: default@nzhang_part14@value=__HIVE_DEFAULT_PARTITION__
 POSTHOOK: Lineage: nzhang_part14 PARTITION(value= ).key EXPRESSION []
@@ -533,6 +534,7 @@ POSTHOOK: query: insert into table nzhang_part14 partition(value)
 select key, value from src5
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src5
+POSTHOOK: Output: default@nzhang_part14
 POSTHOOK: Output: default@nzhang_part14@value=val_165
 POSTHOOK: Output: default@nzhang_part14@value=val_238
 POSTHOOK: Output: default@nzhang_part14@value=val_27
@@ -1216,6 +1218,7 @@ select key, value, ds, hr from (
 ) T
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
+POSTHOOK: Output: default@nzhang_part14
 POSTHOOK: Output: default@nzhang_part14@ds=1/hr=2
 POSTHOOK: Output: default@nzhang_part14@ds=1/hr=3
 POSTHOOK: Output: default@nzhang_part14@ds=2/hr=1
diff --git a/ql/src/test/results/clientpositive/llap/autoColumnStats_3.q.out b/ql/src/test/results/clientpositive/llap/autoColumnStats_3.q.out
index 867c625509..7b7078fc21 100644
--- a/ql/src/test/results/clientpositive/llap/autoColumnStats_3.q.out
+++ b/ql/src/test/results/clientpositive/llap/autoColumnStats_3.q.out
@@ -176,6 +176,7 @@ select key, value, ds, hr from (
 ) T
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
+POSTHOOK: Output: default@nzhang_part14_n2
 POSTHOOK: Output: default@nzhang_part14_n2@ds=1/hr=2
 POSTHOOK: Output: default@nzhang_part14_n2@ds=1/hr=3
 POSTHOOK: Output: default@nzhang_part14_n2@ds=2/hr=1
@@ -334,6 +335,7 @@ select key, value, ds, hr from (
 ) T
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
+POSTHOOK: Output: default@nzhang_part14_n2
 POSTHOOK: Output: default@nzhang_part14_n2@ds=1/hr=2
 POSTHOOK: Output: default@nzhang_part14_n2@ds=1/hr=3
 POSTHOOK: Output: default@nzhang_part14_n2@ds=2/hr=1
diff --git a/ql/src/test/results/clientpositive/llap/autoColumnStats_8.q.out b/ql/src/test/results/clientpositive/llap/autoColumnStats_8.q.out
index a78ab9603b..ee2a3f6712 100644
--- a/ql/src/test/results/clientpositive/llap/autoColumnStats_8.q.out
+++ b/ql/src/test/results/clientpositive/llap/autoColumnStats_8.q.out
@@ -55,6 +55,7 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
+POSTHOOK: Output: default@nzhang_part8
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-3 depends on stages: Stage-2
@@ -520,6 +521,7 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
+POSTHOOK: Output: default@nzhang_part8
 POSTHOOK: Output: default@nzhang_part8@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@nzhang_part8@ds=2008-04-08/hr=12
 POSTHOOK: Output: default@nzhang_part8@ds=2008-12-31/hr=11
diff --git a/ql/src/test/results/clientpositive/llap/auto_sortmerge_join_16.q.out b/ql/src/test/results/clientpositive/llap/auto_sortmerge_join_16.q.out
index 1f0443aae2..ba61706360 100644
--- a/ql/src/test/results/clientpositive/llap/auto_sortmerge_join_16.q.out
+++ b/ql/src/test/results/clientpositive/llap/auto_sortmerge_join_16.q.out
@@ -125,6 +125,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@stage_bucket_small_n17
 POSTHOOK: Input: default@stage_bucket_small_n17@file_tag=1
 POSTHOOK: Input: default@stage_bucket_small_n17@file_tag=2
+POSTHOOK: Output: default@bucket_small_n17
 POSTHOOK: Output: default@bucket_small_n17@pri=1
 POSTHOOK: Output: default@bucket_small_n17@pri=2
 POSTHOOK: Lineage: bucket_small_n17 PARTITION(pri=1).key SIMPLE [(stage_bucket_small_n17)stage_bucket_small_n17.FieldSchema(name:key, type:bigint, comment:null), ]
@@ -155,6 +156,7 @@ POSTHOOK: query: insert overwrite table bucket_big_n17 partition(day,pri)
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@stage_bucket_big_n17
 POSTHOOK: Input: default@stage_bucket_big_n17@file_tag=1
+POSTHOOK: Output: default@bucket_big_n17
 POSTHOOK: Output: default@bucket_big_n17@day=day1/pri=1
 POSTHOOK: Lineage: bucket_big_n17 PARTITION(day=day1,pri=1).key SIMPLE [(stage_bucket_big_n17)stage_bucket_big_n17.FieldSchema(name:key, type:bigint, comment:null), ]
 POSTHOOK: Lineage: bucket_big_n17 PARTITION(day=day1,pri=1).value SIMPLE [(stage_bucket_big_n17)stage_bucket_big_n17.FieldSchema(name:value, type:string, comment:null), ]
@@ -568,6 +570,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@stage_bucket_small_n17
 POSTHOOK: Input: default@stage_bucket_small_n17@file_tag=1
 POSTHOOK: Input: default@stage_bucket_small_n17@file_tag=2
+POSTHOOK: Output: default@bucket_small_n17
 POSTHOOK: Output: default@bucket_small_n17@pri=1
 POSTHOOK: Output: default@bucket_small_n17@pri=2
 POSTHOOK: Lineage: bucket_small_n17 PARTITION(pri=1).key SIMPLE [(stage_bucket_small_n17)stage_bucket_small_n17.FieldSchema(name:key, type:bigint, comment:null), ]
@@ -589,6 +592,7 @@ where file_tag='1'
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@stage_bucket_big_n17
 POSTHOOK: Input: default@stage_bucket_big_n17@file_tag=1
+POSTHOOK: Output: default@bucket_big_n17
 POSTHOOK: Output: default@bucket_big_n17@day=day1/pri=1
 POSTHOOK: Lineage: bucket_big_n17 PARTITION(day=day1,pri=1).key SIMPLE [(stage_bucket_big_n17)stage_bucket_big_n17.FieldSchema(name:key, type:bigint, comment:null), ]
 POSTHOOK: Lineage: bucket_big_n17 PARTITION(day=day1,pri=1).value SIMPLE [(stage_bucket_big_n17)stage_bucket_big_n17.FieldSchema(name:value, type:string, comment:null), ]
diff --git a/ql/src/test/results/clientpositive/llap/avro_extschema_insert.q.out b/ql/src/test/results/clientpositive/llap/avro_extschema_insert.q.out
index bb92c221b2..9b406d249c 100644
--- a/ql/src/test/results/clientpositive/llap/avro_extschema_insert.q.out
+++ b/ql/src/test/results/clientpositive/llap/avro_extschema_insert.q.out
@@ -50,6 +50,7 @@ POSTHOOK: query: insert overwrite table avro_extschema_insert2 partition (p1) se
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@avro_extschema_insert1
 POSTHOOK: Input: default@avro_extschema_insert1@p1=part1
+POSTHOOK: Output: default@avro_extschema_insert2
 POSTHOOK: Output: default@avro_extschema_insert2@p1=part1
 POSTHOOK: Lineage: avro_extschema_insert2 PARTITION(p1=part1).col1 SIMPLE [(avro_extschema_insert1)avro_extschema_insert1.FieldSchema(name:col1, type:string, comment:), ]
 POSTHOOK: Lineage: avro_extschema_insert2 PARTITION(p1=part1).col2 SIMPLE [(avro_extschema_insert1)avro_extschema_insert1.FieldSchema(name:col2, type:bigint, comment:), ]
diff --git a/ql/src/test/results/clientpositive/llap/avro_partitioned.q.out b/ql/src/test/results/clientpositive/llap/avro_partitioned.q.out
index da6a067ef2..d641da6ea9 100644
--- a/ql/src/test/results/clientpositive/llap/avro_partitioned.q.out
+++ b/ql/src/test/results/clientpositive/llap/avro_partitioned.q.out
@@ -139,6 +139,7 @@ PREHOOK: Output: default@episodes_partitioned_n1
 POSTHOOK: query: INSERT OVERWRITE TABLE episodes_partitioned_n1 PARTITION (doctor_pt) SELECT title, air_date, doctor, doctor as doctor_pt FROM episodes_n2
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@episodes_n2
+POSTHOOK: Output: default@episodes_partitioned_n1
 POSTHOOK: Output: default@episodes_partitioned_n1@doctor_pt=1
 POSTHOOK: Output: default@episodes_partitioned_n1@doctor_pt=11
 POSTHOOK: Output: default@episodes_partitioned_n1@doctor_pt=2
@@ -315,6 +316,7 @@ PREHOOK: Output: default@episodes_partitioned_serdeproperties
 POSTHOOK: query: INSERT INTO TABLE episodes_partitioned_serdeproperties PARTITION (doctor_pt) SELECT title, air_date, doctor, doctor as doctor_pt FROM episodes_n2
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@episodes_n2
+POSTHOOK: Output: default@episodes_partitioned_serdeproperties
 POSTHOOK: Output: default@episodes_partitioned_serdeproperties@doctor_pt=1
 POSTHOOK: Output: default@episodes_partitioned_serdeproperties@doctor_pt=11
 POSTHOOK: Output: default@episodes_partitioned_serdeproperties@doctor_pt=2
diff --git a/ql/src/test/results/clientpositive/llap/avro_partitioned_native.q.out b/ql/src/test/results/clientpositive/llap/avro_partitioned_native.q.out
index 0c005e448a..4e100185ec 100644
--- a/ql/src/test/results/clientpositive/llap/avro_partitioned_native.q.out
+++ b/ql/src/test/results/clientpositive/llap/avro_partitioned_native.q.out
@@ -49,6 +49,7 @@ POSTHOOK: query: INSERT OVERWRITE TABLE episodes_partitioned PARTITION (doctor_p
 SELECT title, air_date, doctor, doctor as doctor_pt FROM episodes
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@episodes
+POSTHOOK: Output: default@episodes_partitioned
 POSTHOOK: Output: default@episodes_partitioned@doctor_pt=1
 POSTHOOK: Output: default@episodes_partitioned@doctor_pt=11
 POSTHOOK: Output: default@episodes_partitioned@doctor_pt=2
diff --git a/ql/src/test/results/clientpositive/llap/avro_schema_evolution_native.q.out b/ql/src/test/results/clientpositive/llap/avro_schema_evolution_native.q.out
index 21040ecf32..1bb3092620 100644
--- a/ql/src/test/results/clientpositive/llap/avro_schema_evolution_native.q.out
+++ b/ql/src/test/results/clientpositive/llap/avro_schema_evolution_native.q.out
@@ -49,6 +49,7 @@ POSTHOOK: query: INSERT OVERWRITE TABLE episodes_partitioned_n0 PARTITION (docto
 SELECT title, air_date, doctor, doctor as doctor_pt FROM episodes_n0
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@episodes_n0
+POSTHOOK: Output: default@episodes_partitioned_n0
 POSTHOOK: Output: default@episodes_partitioned_n0@doctor_pt=1
 POSTHOOK: Output: default@episodes_partitioned_n0@doctor_pt=11
 POSTHOOK: Output: default@episodes_partitioned_n0@doctor_pt=2
diff --git a/ql/src/test/results/clientpositive/llap/combine2.q.out b/ql/src/test/results/clientpositive/llap/combine2.q.out
index 944d4e2dc4..cde4a66e2c 100644
--- a/ql/src/test/results/clientpositive/llap/combine2.q.out
+++ b/ql/src/test/results/clientpositive/llap/combine2.q.out
@@ -31,6 +31,7 @@ select * from (
    select key, '2010-04-21 09:45:00' value from src where key = 19) s
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
+POSTHOOK: Output: default@combine2_n0
 POSTHOOK: Output: default@combine2_n0@value=2010-04-21 09%3A45%3A00
 POSTHOOK: Output: default@combine2_n0@value=val_0
 POSTHOOK: Output: default@combine2_n0@value=val_2
diff --git a/ql/src/test/results/clientpositive/llap/constprog_dp.q.out b/ql/src/test/results/clientpositive/llap/constprog_dp.q.out
index ac01f4aeb3..57a71479bd 100644
--- a/ql/src/test/results/clientpositive/llap/constprog_dp.q.out
+++ b/ql/src/test/results/clientpositive/llap/constprog_dp.q.out
@@ -21,6 +21,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcpart
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
+POSTHOOK: Output: default@dest_n1
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -130,6 +131,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcpart
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
+POSTHOOK: Output: default@dest_n1
 POSTHOOK: Output: default@dest_n1@ds=2008-04-08
 POSTHOOK: Lineage: dest_n1 PARTITION(ds=2008-04-08).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: dest_n1 PARTITION(ds=2008-04-08).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/llap/cp_sel.q.out b/ql/src/test/results/clientpositive/llap/cp_sel.q.out
index 4f337d09f7..cf5a996717 100644
--- a/ql/src/test/results/clientpositive/llap/cp_sel.q.out
+++ b/ql/src/test/results/clientpositive/llap/cp_sel.q.out
@@ -111,6 +111,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcpart
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
+POSTHOOK: Output: default@testpartbucket
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -234,6 +235,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcpart
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
+POSTHOOK: Output: default@testpartbucket
 POSTHOOK: Output: default@testpartbucket@ds=hello/hr=world
 POSTHOOK: Lineage: testpartbucket PARTITION(ds=hello,hr=world).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: testpartbucket PARTITION(ds=hello,hr=world).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/llap/create_transactional_full_acid.q.out b/ql/src/test/results/clientpositive/llap/create_transactional_full_acid.q.out
index e8279b1160..a307a5ab02 100644
--- a/ql/src/test/results/clientpositive/llap/create_transactional_full_acid.q.out
+++ b/ql/src/test/results/clientpositive/llap/create_transactional_full_acid.q.out
@@ -73,6 +73,7 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
+POSTHOOK: Output: default@transactional_table_test
 POSTHOOK: Output: default@transactional_table_test@ds=2008-04-08
 POSTHOOK: Output: default@transactional_table_test@ds=2008-04-09
 POSTHOOK: Lineage: transactional_table_test PARTITION(ds=2008-04-08).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -102,6 +103,7 @@ PREHOOK: Output: default@target
 POSTHOOK: query: insert into target partition(p,q) values (1,2,1,2), (3,4,1,2), (5,6,1,3), (7,8,2,2)
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@target
 POSTHOOK: Output: default@target@p=1/q=2
 POSTHOOK: Output: default@target@p=1/q=3
 POSTHOOK: Output: default@target@p=2/q=2
@@ -186,6 +188,7 @@ POSTHOOK: Input: default@target@p=1/q=2
 POSTHOOK: Input: default@target@p=1/q=3
 POSTHOOK: Input: default@target@p=2/q=2
 POSTHOOK: Output: default@merge_tmp_table
+POSTHOOK: Output: default@target
 POSTHOOK: Output: default@target@p=1/q=2
 POSTHOOK: Output: default@target@p=1/q=2
 POSTHOOK: Output: default@target@p=1/q=2
diff --git a/ql/src/test/results/clientpositive/llap/create_transactional_insert_only.q.out b/ql/src/test/results/clientpositive/llap/create_transactional_insert_only.q.out
index 47cb3ca4d9..c4daffb377 100644
--- a/ql/src/test/results/clientpositive/llap/create_transactional_insert_only.q.out
+++ b/ql/src/test/results/clientpositive/llap/create_transactional_insert_only.q.out
@@ -65,6 +65,7 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
+POSTHOOK: Output: default@transactional_insert_only_table
 POSTHOOK: Output: default@transactional_insert_only_table@ds=2008-04-08
 POSTHOOK: Output: default@transactional_insert_only_table@ds=2008-04-09
 POSTHOOK: Lineage: transactional_insert_only_table PARTITION(ds=2008-04-08).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/llap/ctas.q.out b/ql/src/test/results/clientpositive/llap/ctas.q.out
index 78657b277a..8f5c683fef 100644
--- a/ql/src/test/results/clientpositive/llap/ctas.q.out
+++ b/ql/src/test/results/clientpositive/llap/ctas.q.out
@@ -1150,6 +1150,7 @@ POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@acid_ctas_part
+POSTHOOK: Output: default@acid_ctas_part
 POSTHOOK: Output: default@acid_ctas_part@k=0
 POSTHOOK: Output: default@acid_ctas_part@k=10
 POSTHOOK: Output: default@acid_ctas_part@k=100
diff --git a/ql/src/test/results/clientpositive/llap/dbtxnmgr_query4.q.out b/ql/src/test/results/clientpositive/llap/dbtxnmgr_query4.q.out
index dd7b6294c0..121f20ecc5 100644
--- a/ql/src/test/results/clientpositive/llap/dbtxnmgr_query4.q.out
+++ b/ql/src/test/results/clientpositive/llap/dbtxnmgr_query4.q.out
@@ -43,6 +43,7 @@ PREHOOK: Output: default@t2_n95
 POSTHOOK: query: insert overwrite table T2_n95 partition (val) select key, val from T1_n163
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@t1_n163
+POSTHOOK: Output: default@t2_n95
 POSTHOOK: Output: default@t2_n95@val=11
 POSTHOOK: Output: default@t2_n95@val=12
 POSTHOOK: Output: default@t2_n95@val=13
diff --git a/ql/src/test/results/clientpositive/llap/drop_partitions_filter4.q.out b/ql/src/test/results/clientpositive/llap/drop_partitions_filter4.q.out
index ddfb7bf423..eb1bdc13ff 100644
--- a/ql/src/test/results/clientpositive/llap/drop_partitions_filter4.q.out
+++ b/ql/src/test/results/clientpositive/llap/drop_partitions_filter4.q.out
@@ -13,6 +13,7 @@ PREHOOK: Output: default@ptestfilter_n2
 POSTHOOK: query: INSERT OVERWRITE TABLE ptestfilter_n2 PARTITION (c) select 'Col1', 1, null
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@ptestfilter_n2
 POSTHOOK: Output: default@ptestfilter_n2@c=__HIVE_DEFAULT_PARTITION__
 POSTHOOK: Lineage: ptestfilter_n2 PARTITION(c=__HIVE_DEFAULT_PARTITION__).a SIMPLE []
 POSTHOOK: Lineage: ptestfilter_n2 PARTITION(c=__HIVE_DEFAULT_PARTITION__).b SIMPLE []
@@ -69,6 +70,7 @@ PREHOOK: Output: default@ptestfilter_n2
 POSTHOOK: query: INSERT OVERWRITE TABLE ptestfilter_n2 PARTITION (c) select 'Col1', 1, null
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@ptestfilter_n2
 POSTHOOK: Output: default@ptestfilter_n2@c=__HIVE_DEFAULT_PARTITION__
 POSTHOOK: Lineage: ptestfilter_n2 PARTITION(c=__HIVE_DEFAULT_PARTITION__).a SIMPLE []
 POSTHOOK: Lineage: ptestfilter_n2 PARTITION(c=__HIVE_DEFAULT_PARTITION__).b SIMPLE []
@@ -110,6 +112,7 @@ PREHOOK: Output: default@ptestfilter_n2
 POSTHOOK: query: INSERT OVERWRITE TABLE ptestfilter_n2 PARTITION (c,d) select 'Col1', 1, null, null
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@ptestfilter_n2
 POSTHOOK: Output: default@ptestfilter_n2@c=__HIVE_DEFAULT_PARTITION__/d=__HIVE_DEFAULT_PARTITION__
 POSTHOOK: Lineage: ptestfilter_n2 PARTITION(c=__HIVE_DEFAULT_PARTITION__,d=__HIVE_DEFAULT_PARTITION__).a SIMPLE []
 POSTHOOK: Lineage: ptestfilter_n2 PARTITION(c=__HIVE_DEFAULT_PARTITION__,d=__HIVE_DEFAULT_PARTITION__).b SIMPLE []
@@ -120,6 +123,7 @@ PREHOOK: Output: default@ptestfilter_n2
 POSTHOOK: query: INSERT OVERWRITE TABLE ptestfilter_n2 PARTITION (c,d) select 'Col2', 2, null, 2
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@ptestfilter_n2
 POSTHOOK: Output: default@ptestfilter_n2@c=__HIVE_DEFAULT_PARTITION__/d=2
 POSTHOOK: Lineage: ptestfilter_n2 PARTITION(c=__HIVE_DEFAULT_PARTITION__,d=2).a SIMPLE []
 POSTHOOK: Lineage: ptestfilter_n2 PARTITION(c=__HIVE_DEFAULT_PARTITION__,d=2).b SIMPLE []
@@ -130,6 +134,7 @@ PREHOOK: Output: default@ptestfilter_n2
 POSTHOOK: query: INSERT OVERWRITE TABLE ptestfilter_n2 PARTITION (c,d) select 'Col3', 3, 'Uganda', null
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@ptestfilter_n2
 POSTHOOK: Output: default@ptestfilter_n2@c=Uganda/d=__HIVE_DEFAULT_PARTITION__
 POSTHOOK: Lineage: ptestfilter_n2 PARTITION(c=Uganda,d=__HIVE_DEFAULT_PARTITION__).a SIMPLE []
 POSTHOOK: Lineage: ptestfilter_n2 PARTITION(c=Uganda,d=__HIVE_DEFAULT_PARTITION__).b SIMPLE []
@@ -189,6 +194,7 @@ PREHOOK: Output: default@ptestfilter_n2
 POSTHOOK: query: INSERT OVERWRITE TABLE ptestfilter_n2 PARTITION (c,d) select 'Col2', 2, null, 2
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@ptestfilter_n2
 POSTHOOK: Output: default@ptestfilter_n2@c=__HIVE_DEFAULT_PARTITION__/d=2
 POSTHOOK: Lineage: ptestfilter_n2 PARTITION(c=__HIVE_DEFAULT_PARTITION__,d=2).a SIMPLE []
 POSTHOOK: Lineage: ptestfilter_n2 PARTITION(c=__HIVE_DEFAULT_PARTITION__,d=2).b SIMPLE []
@@ -199,6 +205,7 @@ PREHOOK: Output: default@ptestfilter_n2
 POSTHOOK: query: INSERT OVERWRITE TABLE ptestfilter_n2 PARTITION (c,d) select 'Col2', 2, null, 3
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@ptestfilter_n2
 POSTHOOK: Output: default@ptestfilter_n2@c=__HIVE_DEFAULT_PARTITION__/d=3
 POSTHOOK: Lineage: ptestfilter_n2 PARTITION(c=__HIVE_DEFAULT_PARTITION__,d=3).a SIMPLE []
 POSTHOOK: Lineage: ptestfilter_n2 PARTITION(c=__HIVE_DEFAULT_PARTITION__,d=3).b SIMPLE []
@@ -209,6 +216,7 @@ PREHOOK: Output: default@ptestfilter_n2
 POSTHOOK: query: INSERT OVERWRITE TABLE ptestfilter_n2 PARTITION (c,d) select 'Col3', 3, 'Uganda', null
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@ptestfilter_n2
 POSTHOOK: Output: default@ptestfilter_n2@c=Uganda/d=__HIVE_DEFAULT_PARTITION__
 POSTHOOK: Lineage: ptestfilter_n2 PARTITION(c=Uganda,d=__HIVE_DEFAULT_PARTITION__).a SIMPLE []
 POSTHOOK: Lineage: ptestfilter_n2 PARTITION(c=Uganda,d=__HIVE_DEFAULT_PARTITION__).b SIMPLE []
diff --git a/ql/src/test/results/clientpositive/llap/dynamic_partition_insert.q.out b/ql/src/test/results/clientpositive/llap/dynamic_partition_insert.q.out
index 8965dab21f..736c27489b 100644
--- a/ql/src/test/results/clientpositive/llap/dynamic_partition_insert.q.out
+++ b/ql/src/test/results/clientpositive/llap/dynamic_partition_insert.q.out
@@ -63,6 +63,7 @@ PREHOOK: Output: default@t2_n78
 POSTHOOK: query: INSERT OVERWRITE TABLE t2_n78 partition(p1) SELECT *,c1 AS p1 FROM t1_n131 DISTRIBUTE BY p1
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@t1_n131
+POSTHOOK: Output: default@t2_n78
 POSTHOOK: Output: default@t2_n78@p1=1
 POSTHOOK: Output: default@t2_n78@p1=2
 POSTHOOK: Output: default@t2_n78@p1=3
@@ -142,6 +143,7 @@ PREHOOK: Output: default@t2_n78
 POSTHOOK: query: INSERT OVERWRITE TABLE t2_n78 SELECT *,c1 AS p1 FROM t1_n131 DISTRIBUTE BY p1
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@t1_n131
+POSTHOOK: Output: default@t2_n78
 POSTHOOK: Output: default@t2_n78@p1=1
 POSTHOOK: Output: default@t2_n78@p1=2
 POSTHOOK: Output: default@t2_n78@p1=3
@@ -242,6 +244,7 @@ PREHOOK: Output: default@table1_n15
 POSTHOOK: query: INSERT INTO TABLE table1_n15 VALUES (1, '101'), (2, '202'), (3, '303'), (4, '404'), (5, '505')
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@table1_n15
 POSTHOOK: Output: default@table1_n15@key=101
 POSTHOOK: Output: default@table1_n15@key=202
 POSTHOOK: Output: default@table1_n15@key=303
@@ -309,6 +312,7 @@ PREHOOK: Output: default@table1_n15
 POSTHOOK: query: INSERT INTO table1_n15 values ('John Doe', 23, 'USA', 'CA'), ('Jane Doe', 22, 'USA', 'TX')
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@table1_n15
 POSTHOOK: Output: default@table1_n15@country=USA/state=CA
 POSTHOOK: Output: default@table1_n15@country=USA/state=TX
 POSTHOOK: Lineage: table1_n15 PARTITION(country=USA,state=CA).age SCRIPT []
@@ -342,6 +346,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@table1_n15
 POSTHOOK: Input: default@table1_n15@country=USA/state=CA
 POSTHOOK: Input: default@table1_n15@country=USA/state=TX
+POSTHOOK: Output: default@table2_n10
 POSTHOOK: Output: default@table2_n10@country=USA/state=CA
 POSTHOOK: Output: default@table2_n10@country=USA/state=TX
 POSTHOOK: Lineage: table2_n10 PARTITION(country=USA,state=CA).age SIMPLE [(table1_n15)table1_n15.FieldSchema(name:age, type:int, comment:null), ]
@@ -414,6 +419,7 @@ INSERT OVERWRITE TABLE dest1_n143 SELECT src.* WHERE src.key < 100
 INSERT OVERWRITE TABLE dest2_n37 SELECT src.key, src.value WHERE src.key >= 100 and src.key < 200
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
+POSTHOOK: Output: default@dest1_n143
 POSTHOOK: Output: default@dest1_n143@value=val_0
 POSTHOOK: Output: default@dest1_n143@value=val_10
 POSTHOOK: Output: default@dest1_n143@value=val_11
@@ -471,6 +477,7 @@ POSTHOOK: Output: default@dest1_n143@value=val_95
 POSTHOOK: Output: default@dest1_n143@value=val_96
 POSTHOOK: Output: default@dest1_n143@value=val_97
 POSTHOOK: Output: default@dest1_n143@value=val_98
+POSTHOOK: Output: default@dest2_n37
 POSTHOOK: Output: default@dest2_n37@value=val_100
 POSTHOOK: Output: default@dest2_n37@value=val_103
 POSTHOOK: Output: default@dest2_n37@value=val_104
@@ -957,6 +964,7 @@ PREHOOK: Output: default@table1_n15
 POSTHOOK: query: INSERT INTO table1_n15 values ('John Doe', 23, 'USA', 'CA'), ('Jane Doe', 22, 'USA', 'TX')
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@table1_n15
 POSTHOOK: Output: default@table1_n15@country=USA/state=CA
 POSTHOOK: Output: default@table1_n15@country=USA/state=TX
 POSTHOOK: Lineage: table1_n15 PARTITION(country=USA,state=CA).age SCRIPT []
@@ -990,6 +998,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@table1_n15
 POSTHOOK: Input: default@table1_n15@country=USA/state=CA
 POSTHOOK: Input: default@table1_n15@country=USA/state=TX
+POSTHOOK: Output: default@table2_n10
 POSTHOOK: Output: default@table2_n10@country=USA/state=CA
 POSTHOOK: Output: default@table2_n10@country=USA/state=TX
 POSTHOOK: Lineage: table2_n10 PARTITION(country=USA,state=CA).age SIMPLE [(table1_n15)table1_n15.FieldSchema(name:age, type:int, comment:null), ]
@@ -1029,6 +1038,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@table1_n15
 POSTHOOK: Input: default@table1_n15@country=USA/state=CA
 POSTHOOK: Input: default@table1_n15@country=USA/state=TX
+POSTHOOK: Output: default@table2_n10
 POSTHOOK: Output: default@table2_n10@country=USA/state=CA
 POSTHOOK: Output: default@table2_n10@country=USA/state=TX
 POSTHOOK: Lineage: table2_n10 PARTITION(country=USA,state=CA).age SIMPLE []
@@ -1070,6 +1080,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@table1_n15
 POSTHOOK: Input: default@table1_n15@country=USA/state=CA
 POSTHOOK: Input: default@table1_n15@country=USA/state=TX
+POSTHOOK: Output: default@table2_n10
 POSTHOOK: Output: default@table2_n10@country=USA/state=__HIVE_DEFAULT_PARTITION__
 POSTHOOK: Lineage: table2_n10 PARTITION(country=USA,state=__HIVE_DEFAULT_PARTITION__).age SIMPLE [(table1_n15)table1_n15.FieldSchema(name:age, type:int, comment:null), ]
 POSTHOOK: Lineage: table2_n10 PARTITION(country=USA,state=__HIVE_DEFAULT_PARTITION__).name SIMPLE [(table1_n15)table1_n15.FieldSchema(name:name, type:string, comment:null), ]
@@ -1113,6 +1124,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@table1_n15
 POSTHOOK: Input: default@table1_n15@country=USA/state=CA
 POSTHOOK: Input: default@table1_n15@country=USA/state=TX
+POSTHOOK: Output: default@table2_n10
 POSTHOOK: Output: default@table2_n10@country=USA/state=__HIVE_DEFAULT_PARTITION__
 POSTHOOK: Lineage: table2_n10 PARTITION(country=USA,state=__HIVE_DEFAULT_PARTITION__).age SIMPLE []
 POSTHOOK: Lineage: table2_n10 PARTITION(country=USA,state=__HIVE_DEFAULT_PARTITION__).name SIMPLE [(table1_n15)table1_n15.FieldSchema(name:name, type:string, comment:null), ]
diff --git a/ql/src/test/results/clientpositive/llap/dynamic_partition_pruning.q.out b/ql/src/test/results/clientpositive/llap/dynamic_partition_pruning.q.out
index 376ccef101..7c8e269a2f 100644
--- a/ql/src/test/results/clientpositive/llap/dynamic_partition_pruning.q.out
+++ b/ql/src/test/results/clientpositive/llap/dynamic_partition_pruning.q.out
@@ -6717,6 +6717,7 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
+POSTHOOK: Output: default@srcpart_orc
 POSTHOOK: Output: default@srcpart_orc@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@srcpart_orc@ds=2008-04-08/hr=12
 POSTHOOK: Output: default@srcpart_orc@ds=2008-04-09/hr=11
diff --git a/ql/src/test/results/clientpositive/llap/dynamic_partition_skip_default.q.out b/ql/src/test/results/clientpositive/llap/dynamic_partition_skip_default.q.out
index aa68fa7ad4..578cb52439 100644
--- a/ql/src/test/results/clientpositive/llap/dynamic_partition_skip_default.q.out
+++ b/ql/src/test/results/clientpositive/llap/dynamic_partition_skip_default.q.out
@@ -13,6 +13,7 @@ PREHOOK: Output: default@dynamic_part_table
 POSTHOOK: query: insert into table dynamic_part_table partition(partcol1, partcol2) select '1', '1', '1' from src where key=150
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
+POSTHOOK: Output: default@dynamic_part_table
 POSTHOOK: Output: default@dynamic_part_table@partcol1=1/partcol2=1
 POSTHOOK: Lineage: dynamic_part_table PARTITION(partcol1=1,partcol2=1).intcol SIMPLE []
 PREHOOK: query: insert into table dynamic_part_table partition(partcol1, partcol2) select '1', NULL, '1' from src where key=150
@@ -22,6 +23,7 @@ PREHOOK: Output: default@dynamic_part_table
 POSTHOOK: query: insert into table dynamic_part_table partition(partcol1, partcol2) select '1', NULL, '1' from src where key=150
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
+POSTHOOK: Output: default@dynamic_part_table
 POSTHOOK: Output: default@dynamic_part_table@partcol1=__HIVE_DEFAULT_PARTITION__/partcol2=1
 POSTHOOK: Lineage: dynamic_part_table PARTITION(partcol1=__HIVE_DEFAULT_PARTITION__,partcol2=1).intcol SIMPLE []
 PREHOOK: query: insert into table dynamic_part_table partition(partcol1, partcol2) select '1', '1', NULL from src where key=150
@@ -31,6 +33,7 @@ PREHOOK: Output: default@dynamic_part_table
 POSTHOOK: query: insert into table dynamic_part_table partition(partcol1, partcol2) select '1', '1', NULL from src where key=150
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
+POSTHOOK: Output: default@dynamic_part_table
 POSTHOOK: Output: default@dynamic_part_table@partcol1=1/partcol2=__HIVE_DEFAULT_PARTITION__
 POSTHOOK: Lineage: dynamic_part_table PARTITION(partcol1=1,partcol2=__HIVE_DEFAULT_PARTITION__).intcol SIMPLE []
 PREHOOK: query: insert into table dynamic_part_table partition(partcol1, partcol2) select '1', NULL, NULL from src where key=150
@@ -40,6 +43,7 @@ PREHOOK: Output: default@dynamic_part_table
 POSTHOOK: query: insert into table dynamic_part_table partition(partcol1, partcol2) select '1', NULL, NULL from src where key=150
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
+POSTHOOK: Output: default@dynamic_part_table
 POSTHOOK: Output: default@dynamic_part_table@partcol1=__HIVE_DEFAULT_PARTITION__/partcol2=__HIVE_DEFAULT_PARTITION__
 POSTHOOK: Lineage: dynamic_part_table PARTITION(partcol1=__HIVE_DEFAULT_PARTITION__,partcol2=__HIVE_DEFAULT_PARTITION__).intcol SIMPLE []
 PREHOOK: query: explain extended select intcol from dynamic_part_table where partcol1='1' and partcol2='1'
diff --git a/ql/src/test/results/clientpositive/llap/dynpart_sort_opt_bucketing.q.out b/ql/src/test/results/clientpositive/llap/dynpart_sort_opt_bucketing.q.out
index 39c7ae63ac..664b3a9de7 100644
--- a/ql/src/test/results/clientpositive/llap/dynpart_sort_opt_bucketing.q.out
+++ b/ql/src/test/results/clientpositive/llap/dynpart_sort_opt_bucketing.q.out
@@ -70,6 +70,7 @@ POSTHOOK: query: insert overwrite table t1_n147 partition(e) select a,b,c,d,'epa
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@t1_staging
 POSTHOOK: Input: default@t1_staging@e=epart
+POSTHOOK: Output: default@t1_n147
 POSTHOOK: Output: default@t1_n147@e=epart
 POSTHOOK: Lineage: t1_n147 PARTITION(e=epart).a SIMPLE [(t1_staging)t1_staging.FieldSchema(name:a, type:string, comment:null), ]
 POSTHOOK: Lineage: t1_n147 PARTITION(e=epart).b SIMPLE [(t1_staging)t1_staging.FieldSchema(name:b, type:int, comment:null), ]
@@ -173,6 +174,7 @@ POSTHOOK: query: insert overwrite table t1_n147 partition(e) select a,b,c,d,'epa
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@t1_staging
 POSTHOOK: Input: default@t1_staging@e=epart
+POSTHOOK: Output: default@t1_n147
 POSTHOOK: Output: default@t1_n147@e=epart
 POSTHOOK: Lineage: t1_n147 PARTITION(e=epart).a SIMPLE [(t1_staging)t1_staging.FieldSchema(name:a, type:string, comment:null), ]
 POSTHOOK: Lineage: t1_n147 PARTITION(e=epart).b SIMPLE [(t1_staging)t1_staging.FieldSchema(name:b, type:int, comment:null), ]
@@ -264,6 +266,7 @@ POSTHOOK: query: explain INSERT INTO TABLE dynpart_sort_opt_bucketing_test PARTI
                 '-5', 'single family')
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@dynpart_sort_opt_bucketing_test
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -347,6 +350,7 @@ POSTHOOK: query: INSERT INTO TABLE dynpart_sort_opt_bucketing_test PARTITION (ca
                 '-5', 'single family')
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@dynpart_sort_opt_bucketing_test
 POSTHOOK: Output: default@dynpart_sort_opt_bucketing_test@ca_location_type=single family
 POSTHOOK: Lineage: dynpart_sort_opt_bucketing_test PARTITION(ca_location_type=single family).ca_address_id SCRIPT []
 POSTHOOK: Lineage: dynpart_sort_opt_bucketing_test PARTITION(ca_location_type=single family).ca_address_sk SCRIPT []
@@ -382,6 +386,7 @@ POSTHOOK: query: explain INSERT INTO TABLE dynpart_sort_opt_bucketing_test PARTI
                    '-5', 'single family')
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@dynpart_sort_opt_bucketing_test
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -474,6 +479,7 @@ POSTHOOK: query: INSERT INTO TABLE dynpart_sort_opt_bucketing_test PARTITION (ca
                    '-5', 'single family')
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@dynpart_sort_opt_bucketing_test
 POSTHOOK: Output: default@dynpart_sort_opt_bucketing_test@ca_location_type=single family
 POSTHOOK: Lineage: dynpart_sort_opt_bucketing_test PARTITION(ca_location_type=single family).ca_address_id SCRIPT []
 POSTHOOK: Lineage: dynpart_sort_opt_bucketing_test PARTITION(ca_location_type=single family).ca_address_sk SCRIPT []
@@ -585,6 +591,7 @@ POSTHOOK: query: explain insert overwrite table t1_n147 partition(e) select a,b,
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@t1_staging
 POSTHOOK: Input: default@t1_staging@e=100
+POSTHOOK: Output: default@t1_n147
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -658,6 +665,7 @@ POSTHOOK: query: insert overwrite table t1_n147 partition(e) select a,b,c,d,e  f
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@t1_staging
 POSTHOOK: Input: default@t1_staging@e=100
+POSTHOOK: Output: default@t1_n147
 POSTHOOK: Output: default@t1_n147@e=100
 POSTHOOK: Lineage: t1_n147 PARTITION(e=100).a SIMPLE [(t1_staging)t1_staging.FieldSchema(name:a, type:string, comment:null), ]
 POSTHOOK: Lineage: t1_n147 PARTITION(e=100).b EXPRESSION [(t1_staging)t1_staging.FieldSchema(name:b, type:int, comment:null), ]
diff --git a/ql/src/test/results/clientpositive/llap/dynpart_sort_opt_vectorization.q.out b/ql/src/test/results/clientpositive/llap/dynpart_sort_opt_vectorization.q.out
index a408b7c6ea..eab3b1bd1d 100644
--- a/ql/src/test/results/clientpositive/llap/dynpart_sort_opt_vectorization.q.out
+++ b/ql/src/test/results/clientpositive/llap/dynpart_sort_opt_vectorization.q.out
@@ -436,6 +436,7 @@ PREHOOK: Output: default@over1k_part_buck_orc
 POSTHOOK: query: explain insert overwrite table over1k_part_buck_orc partition(t) select si,i,b,f,t from over1k_orc where t is null or t=27
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_orc
+POSTHOOK: Output: default@over1k_part_buck_orc
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -518,6 +519,7 @@ PREHOOK: Output: default@over1k_part_buck_sort_orc
 POSTHOOK: query: explain insert overwrite table over1k_part_buck_sort_orc partition(t) select si,i,b,f,t from over1k_orc where t is null or t=27
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_orc
+POSTHOOK: Output: default@over1k_part_buck_sort_orc
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -634,6 +636,7 @@ PREHOOK: Output: default@over1k_part_buck_orc
 POSTHOOK: query: insert overwrite table over1k_part_buck_orc partition(t) select si,i,b,f,t from over1k_orc where t is null or t=27
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_orc
+POSTHOOK: Output: default@over1k_part_buck_orc
 POSTHOOK: Output: default@over1k_part_buck_orc@t=27
 POSTHOOK: Output: default@over1k_part_buck_orc@t=__HIVE_DEFAULT_PARTITION__
 POSTHOOK: Lineage: over1k_part_buck_orc PARTITION(t=27).b SIMPLE [(over1k_orc)over1k_orc.FieldSchema(name:b, type:bigint, comment:null), ]
@@ -651,6 +654,7 @@ PREHOOK: Output: default@over1k_part_buck_sort_orc
 POSTHOOK: query: insert overwrite table over1k_part_buck_sort_orc partition(t) select si,i,b,f,t from over1k_orc where t is null or t=27
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_orc
+POSTHOOK: Output: default@over1k_part_buck_sort_orc
 POSTHOOK: Output: default@over1k_part_buck_sort_orc@t=27
 POSTHOOK: Output: default@over1k_part_buck_sort_orc@t=__HIVE_DEFAULT_PARTITION__
 POSTHOOK: Lineage: over1k_part_buck_sort_orc PARTITION(t=27).b SIMPLE [(over1k_orc)over1k_orc.FieldSchema(name:b, type:bigint, comment:null), ]
@@ -946,6 +950,7 @@ PREHOOK: Output: default@over1k_part_buck_orc
 POSTHOOK: query: explain insert into table over1k_part_buck_orc partition(t) select si,i,b,f,t from over1k_orc where t is null or t=27
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_orc
+POSTHOOK: Output: default@over1k_part_buck_orc
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -1028,6 +1033,7 @@ PREHOOK: Output: default@over1k_part_buck_sort_orc
 POSTHOOK: query: explain insert into table over1k_part_buck_sort_orc partition(t) select si,i,b,f,t from over1k_orc where t is null or t=27
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_orc
+POSTHOOK: Output: default@over1k_part_buck_sort_orc
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -1144,6 +1150,7 @@ PREHOOK: Output: default@over1k_part_buck_orc
 POSTHOOK: query: insert into table over1k_part_buck_orc partition(t) select si,i,b,f,t from over1k_orc where t is null or t=27
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_orc
+POSTHOOK: Output: default@over1k_part_buck_orc
 POSTHOOK: Output: default@over1k_part_buck_orc@t=27
 POSTHOOK: Output: default@over1k_part_buck_orc@t=__HIVE_DEFAULT_PARTITION__
 POSTHOOK: Lineage: over1k_part_buck_orc PARTITION(t=27).b SIMPLE [(over1k_orc)over1k_orc.FieldSchema(name:b, type:bigint, comment:null), ]
@@ -1161,6 +1168,7 @@ PREHOOK: Output: default@over1k_part_buck_sort_orc
 POSTHOOK: query: insert into table over1k_part_buck_sort_orc partition(t) select si,i,b,f,t from over1k_orc where t is null or t=27
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_orc
+POSTHOOK: Output: default@over1k_part_buck_sort_orc
 POSTHOOK: Output: default@over1k_part_buck_sort_orc@t=27
 POSTHOOK: Output: default@over1k_part_buck_sort_orc@t=__HIVE_DEFAULT_PARTITION__
 POSTHOOK: Lineage: over1k_part_buck_sort_orc PARTITION(t=27).b SIMPLE [(over1k_orc)over1k_orc.FieldSchema(name:b, type:bigint, comment:null), ]
@@ -2534,6 +2542,7 @@ PREHOOK: Output: default@over1k_part_buck_sort2_orc
 POSTHOOK: query: explain insert overwrite table over1k_part_buck_sort2_orc partition(t) select si,i,b,f,t from over1k_orc where t is null or t=27
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_orc
+POSTHOOK: Output: default@over1k_part_buck_sort2_orc
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -2655,6 +2664,7 @@ PREHOOK: Output: default@over1k_part_buck_sort2_orc
 POSTHOOK: query: explain insert overwrite table over1k_part_buck_sort2_orc partition(t) select si,i,b,f,t from over1k_orc where t is null or t=27
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_orc
+POSTHOOK: Output: default@over1k_part_buck_sort2_orc
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -2737,6 +2747,7 @@ PREHOOK: Output: default@over1k_part_buck_sort2_orc
 POSTHOOK: query: insert overwrite table over1k_part_buck_sort2_orc partition(t) select si,i,b,f,t from over1k_orc where t is null or t=27
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_orc
+POSTHOOK: Output: default@over1k_part_buck_sort2_orc
 POSTHOOK: Output: default@over1k_part_buck_sort2_orc@t=27
 POSTHOOK: Output: default@over1k_part_buck_sort2_orc@t=__HIVE_DEFAULT_PARTITION__
 POSTHOOK: Lineage: over1k_part_buck_sort2_orc PARTITION(t=27).b SIMPLE [(over1k_orc)over1k_orc.FieldSchema(name:b, type:bigint, comment:null), ]
@@ -2969,6 +2980,7 @@ PREHOOK: Output: default@over1k_part_buck_sort2_orc
 POSTHOOK: query: insert overwrite table over1k_part_buck_sort2_orc partition(t) select si,i,b,f,t from over1k_orc where t is null or t=27
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_orc
+POSTHOOK: Output: default@over1k_part_buck_sort2_orc
 POSTHOOK: Output: default@over1k_part_buck_sort2_orc@t=27
 POSTHOOK: Output: default@over1k_part_buck_sort2_orc@t=__HIVE_DEFAULT_PARTITION__
 POSTHOOK: Lineage: over1k_part_buck_sort2_orc PARTITION(t=27).b SIMPLE [(over1k_orc)over1k_orc.FieldSchema(name:b, type:bigint, comment:null), ]
@@ -3219,6 +3231,7 @@ POSTHOOK: query: explain insert into table addcolumns_vectorization_true_disallo
   select cint,csmallint, cstring1 from alltypesorc limit 10
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc
+POSTHOOK: Output: default@addcolumns_vectorization_true_disallowincompatible_true_fileformat_orc_tinyint
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -3321,6 +3334,7 @@ POSTHOOK: query: insert into table addcolumns_vectorization_true_disallowincompa
   select cint,csmallint, cstring1 from alltypesorc limit 10
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc
+POSTHOOK: Output: default@addcolumns_vectorization_true_disallowincompatible_true_fileformat_orc_tinyint
 POSTHOOK: Output: default@addcolumns_vectorization_true_disallowincompatible_true_fileformat_orc_tinyint@s=cvLH6Eat2yFsyy7p
 POSTHOOK: Lineage: addcolumns_vectorization_true_disallowincompatible_true_fileformat_orc_tinyint PARTITION(s=cvLH6Eat2yFsyy7p).i SIMPLE [(alltypesorc)alltypesorc.FieldSchema(name:cint, type:int, comment:null), ]
 POSTHOOK: Lineage: addcolumns_vectorization_true_disallowincompatible_true_fileformat_orc_tinyint PARTITION(s=cvLH6Eat2yFsyy7p).si SIMPLE [(alltypesorc)alltypesorc.FieldSchema(name:csmallint, type:smallint, comment:null), ]
diff --git a/ql/src/test/results/clientpositive/llap/dynpart_sort_optimization.q.out b/ql/src/test/results/clientpositive/llap/dynpart_sort_optimization.q.out
index 5789d488cf..9cbca95c92 100644
--- a/ql/src/test/results/clientpositive/llap/dynpart_sort_optimization.q.out
+++ b/ql/src/test/results/clientpositive/llap/dynpart_sort_optimization.q.out
@@ -379,6 +379,7 @@ PREHOOK: Output: default@over1k_part_buck
 POSTHOOK: query: explain insert overwrite table over1k_part_buck partition(t) select si,i,b,f,t from over1k_n3 where t is null or t=27
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_n3
+POSTHOOK: Output: default@over1k_part_buck
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -461,6 +462,7 @@ PREHOOK: Output: default@over1k_part_buck_sort
 POSTHOOK: query: explain insert overwrite table over1k_part_buck_sort partition(t) select si,i,b,f,t from over1k_n3 where t is null or t=27
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_n3
+POSTHOOK: Output: default@over1k_part_buck_sort
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -577,6 +579,7 @@ PREHOOK: Output: default@over1k_part_buck
 POSTHOOK: query: insert overwrite table over1k_part_buck partition(t) select si,i,b,f,t from over1k_n3 where t is null or t=27
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_n3
+POSTHOOK: Output: default@over1k_part_buck
 POSTHOOK: Output: default@over1k_part_buck@t=27
 POSTHOOK: Output: default@over1k_part_buck@t=__HIVE_DEFAULT_PARTITION__
 POSTHOOK: Lineage: over1k_part_buck PARTITION(t=27).b SIMPLE [(over1k_n3)over1k_n3.FieldSchema(name:b, type:bigint, comment:null), ]
@@ -594,6 +597,7 @@ PREHOOK: Output: default@over1k_part_buck_sort
 POSTHOOK: query: insert overwrite table over1k_part_buck_sort partition(t) select si,i,b,f,t from over1k_n3 where t is null or t=27
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_n3
+POSTHOOK: Output: default@over1k_part_buck_sort
 POSTHOOK: Output: default@over1k_part_buck_sort@t=27
 POSTHOOK: Output: default@over1k_part_buck_sort@t=__HIVE_DEFAULT_PARTITION__
 POSTHOOK: Lineage: over1k_part_buck_sort PARTITION(t=27).b SIMPLE [(over1k_n3)over1k_n3.FieldSchema(name:b, type:bigint, comment:null), ]
@@ -875,6 +879,7 @@ PREHOOK: Output: default@over1k_part_buck
 POSTHOOK: query: explain insert into table over1k_part_buck partition(t) select si,i,b,f,t from over1k_n3 where t is null or t=27
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_n3
+POSTHOOK: Output: default@over1k_part_buck
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -957,6 +962,7 @@ PREHOOK: Output: default@over1k_part_buck_sort
 POSTHOOK: query: explain insert into table over1k_part_buck_sort partition(t) select si,i,b,f,t from over1k_n3 where t is null or t=27
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_n3
+POSTHOOK: Output: default@over1k_part_buck_sort
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -1073,6 +1079,7 @@ PREHOOK: Output: default@over1k_part_buck
 POSTHOOK: query: insert into table over1k_part_buck partition(t) select si,i,b,f,t from over1k_n3 where t is null or t=27
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_n3
+POSTHOOK: Output: default@over1k_part_buck
 POSTHOOK: Output: default@over1k_part_buck@t=27
 POSTHOOK: Output: default@over1k_part_buck@t=__HIVE_DEFAULT_PARTITION__
 POSTHOOK: Lineage: over1k_part_buck PARTITION(t=27).b SIMPLE [(over1k_n3)over1k_n3.FieldSchema(name:b, type:bigint, comment:null), ]
@@ -1090,6 +1097,7 @@ PREHOOK: Output: default@over1k_part_buck_sort
 POSTHOOK: query: insert into table over1k_part_buck_sort partition(t) select si,i,b,f,t from over1k_n3 where t is null or t=27
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_n3
+POSTHOOK: Output: default@over1k_part_buck_sort
 POSTHOOK: Output: default@over1k_part_buck_sort@t=27
 POSTHOOK: Output: default@over1k_part_buck_sort@t=__HIVE_DEFAULT_PARTITION__
 POSTHOOK: Lineage: over1k_part_buck_sort PARTITION(t=27).b SIMPLE [(over1k_n3)over1k_n3.FieldSchema(name:b, type:bigint, comment:null), ]
@@ -2463,6 +2471,7 @@ PREHOOK: Output: default@over1k_part_buck_sort2
 POSTHOOK: query: explain insert overwrite table over1k_part_buck_sort2 partition(t) select si,i,b,f,t from over1k_n3 where t is null or t=27
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_n3
+POSTHOOK: Output: default@over1k_part_buck_sort2
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -2584,6 +2593,7 @@ PREHOOK: Output: default@over1k_part_buck_sort2
 POSTHOOK: query: explain insert overwrite table over1k_part_buck_sort2 partition(t) select si,i,b,f,t from over1k_n3 where t is null or t=27
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_n3
+POSTHOOK: Output: default@over1k_part_buck_sort2
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -2666,6 +2676,7 @@ PREHOOK: Output: default@over1k_part_buck_sort2
 POSTHOOK: query: insert overwrite table over1k_part_buck_sort2 partition(t) select si,i,b,f,t from over1k_n3 where t is null or t=27
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_n3
+POSTHOOK: Output: default@over1k_part_buck_sort2
 POSTHOOK: Output: default@over1k_part_buck_sort2@t=27
 POSTHOOK: Output: default@over1k_part_buck_sort2@t=__HIVE_DEFAULT_PARTITION__
 POSTHOOK: Lineage: over1k_part_buck_sort2 PARTITION(t=27).b SIMPLE [(over1k_n3)over1k_n3.FieldSchema(name:b, type:bigint, comment:null), ]
@@ -2805,6 +2816,7 @@ PREHOOK: Output: default@over1k_part_buck_sort2
 POSTHOOK: query: insert overwrite table over1k_part_buck_sort2 partition(t) select si,i,b,f,t from over1k_n3 where t is null or t=27
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_n3
+POSTHOOK: Output: default@over1k_part_buck_sort2
 POSTHOOK: Output: default@over1k_part_buck_sort2@t=27
 POSTHOOK: Output: default@over1k_part_buck_sort2@t=__HIVE_DEFAULT_PARTITION__
 POSTHOOK: Lineage: over1k_part_buck_sort2 PARTITION(t=27).b SIMPLE [(over1k_n3)over1k_n3.FieldSchema(name:b, type:bigint, comment:null), ]
@@ -2960,6 +2972,7 @@ PREHOOK: Output: default@over1k_part3
 POSTHOOK: query: explain insert overwrite table over1k_part3 partition(s,t,i) select si,b,f,s,t,i from over1k_n3 where s="foo"
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_n3
+POSTHOOK: Output: default@over1k_part3
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -3083,6 +3096,7 @@ PREHOOK: Output: default@over1k_part3
 POSTHOOK: query: explain insert overwrite table over1k_part3 partition(s,t,i) select si,b,f,s,t,i from over1k_n3 where t=27
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_n3
+POSTHOOK: Output: default@over1k_part3
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -3206,6 +3220,7 @@ PREHOOK: Output: default@over1k_part3
 POSTHOOK: query: explain insert overwrite table over1k_part3 partition(s,t,i) select si,b,f,s,t,i from over1k_n3 where i=100
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_n3
+POSTHOOK: Output: default@over1k_part3
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -3329,6 +3344,7 @@ PREHOOK: Output: default@over1k_part3
 POSTHOOK: query: explain insert overwrite table over1k_part3 partition(s,t,i) select si,b,f,s,t,i from over1k_n3 where i=100 and t=27
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_n3
+POSTHOOK: Output: default@over1k_part3
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -3452,6 +3468,7 @@ PREHOOK: Output: default@over1k_part3
 POSTHOOK: query: explain insert overwrite table over1k_part3 partition(s,t,i) select si,b,f,s,t,i from over1k_n3 where i=100 and s="foo"
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_n3
+POSTHOOK: Output: default@over1k_part3
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -3575,6 +3592,7 @@ PREHOOK: Output: default@over1k_part3
 POSTHOOK: query: explain insert overwrite table over1k_part3 partition(s,t,i) select si,b,f,s,t,i from over1k_n3 where t=27 and s="foo"
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_n3
+POSTHOOK: Output: default@over1k_part3
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -3698,6 +3716,7 @@ PREHOOK: Output: default@over1k_part3
 POSTHOOK: query: explain insert overwrite table over1k_part3 partition(s,t,i) select si,b,f,s,t,i from over1k_n3 where i=100 and t=27 and s="foo"
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_n3
+POSTHOOK: Output: default@over1k_part3
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -3806,6 +3825,7 @@ PREHOOK: Output: default@over1k_part3
 POSTHOOK: query: insert overwrite table over1k_part3 partition(s,t,i) select si,b,f,s,t,i from over1k_n3 where s="foo"
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_n3
+POSTHOOK: Output: default@over1k_part3
 PREHOOK: query: insert overwrite table over1k_part3 partition(s,t,i) select si,b,f,s,t,i from over1k_n3 where t=27
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over1k_n3
@@ -3813,6 +3833,7 @@ PREHOOK: Output: default@over1k_part3
 POSTHOOK: query: insert overwrite table over1k_part3 partition(s,t,i) select si,b,f,s,t,i from over1k_n3 where t=27
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_n3
+POSTHOOK: Output: default@over1k_part3
 POSTHOOK: Output: default@over1k_part3@s=alice quirinius/t=27/i=65636
 POSTHOOK: Output: default@over1k_part3@s=bob ovid/t=27/i=65619
 POSTHOOK: Output: default@over1k_part3@s=david allen/t=27/i=65617
@@ -3884,6 +3905,7 @@ PREHOOK: Output: default@over1k_part3
 POSTHOOK: query: insert overwrite table over1k_part3 partition(s,t,i) select si,b,f,s,t,i from over1k_n3 where i=100
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_n3
+POSTHOOK: Output: default@over1k_part3
 PREHOOK: query: insert overwrite table over1k_part3 partition(s,t,i) select si,b,f,s,t,i from over1k_n3 where i=100 and t=27
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over1k_n3
@@ -3891,6 +3913,7 @@ PREHOOK: Output: default@over1k_part3
 POSTHOOK: query: insert overwrite table over1k_part3 partition(s,t,i) select si,b,f,s,t,i from over1k_n3 where i=100 and t=27
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_n3
+POSTHOOK: Output: default@over1k_part3
 PREHOOK: query: insert overwrite table over1k_part3 partition(s,t,i) select si,b,f,s,t,i from over1k_n3 where i=100 and s="foo"
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over1k_n3
@@ -3898,6 +3921,7 @@ PREHOOK: Output: default@over1k_part3
 POSTHOOK: query: insert overwrite table over1k_part3 partition(s,t,i) select si,b,f,s,t,i from over1k_n3 where i=100 and s="foo"
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_n3
+POSTHOOK: Output: default@over1k_part3
 PREHOOK: query: insert overwrite table over1k_part3 partition(s,t,i) select si,b,f,s,t,i from over1k_n3 where t=27 and s="foo"
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over1k_n3
@@ -3905,6 +3929,7 @@ PREHOOK: Output: default@over1k_part3
 POSTHOOK: query: insert overwrite table over1k_part3 partition(s,t,i) select si,b,f,s,t,i from over1k_n3 where t=27 and s="foo"
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_n3
+POSTHOOK: Output: default@over1k_part3
 PREHOOK: query: insert overwrite table over1k_part3 partition(s,t,i) select si,b,f,s,t,i from over1k_n3 where i=100 and t=27 and s="foo"
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over1k_n3
@@ -3912,6 +3937,7 @@ PREHOOK: Output: default@over1k_part3
 POSTHOOK: query: insert overwrite table over1k_part3 partition(s,t,i) select si,b,f,s,t,i from over1k_n3 where i=100 and t=27 and s="foo"
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_n3
+POSTHOOK: Output: default@over1k_part3
 PREHOOK: query: select sum(hash(*)) from over1k_part3
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over1k_part3
@@ -3984,6 +4010,7 @@ PREHOOK: Output: default@over1k_part3
 POSTHOOK: query: insert overwrite table over1k_part3 partition(s,t,i) select si,b,f,s,t,i from over1k_n3 where s="foo"
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_n3
+POSTHOOK: Output: default@over1k_part3
 PREHOOK: query: insert overwrite table over1k_part3 partition(s,t,i) select si,b,f,s,t,i from over1k_n3 where t=27
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over1k_n3
@@ -3991,6 +4018,7 @@ PREHOOK: Output: default@over1k_part3
 POSTHOOK: query: insert overwrite table over1k_part3 partition(s,t,i) select si,b,f,s,t,i from over1k_n3 where t=27
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_n3
+POSTHOOK: Output: default@over1k_part3
 POSTHOOK: Output: default@over1k_part3@s=alice quirinius/t=27/i=65636
 POSTHOOK: Output: default@over1k_part3@s=bob ovid/t=27/i=65619
 POSTHOOK: Output: default@over1k_part3@s=david allen/t=27/i=65617
@@ -4062,6 +4090,7 @@ PREHOOK: Output: default@over1k_part3
 POSTHOOK: query: insert overwrite table over1k_part3 partition(s,t,i) select si,b,f,s,t,i from over1k_n3 where i=100
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_n3
+POSTHOOK: Output: default@over1k_part3
 PREHOOK: query: insert overwrite table over1k_part3 partition(s,t,i) select si,b,f,s,t,i from over1k_n3 where i=100 and t=27
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over1k_n3
@@ -4069,6 +4098,7 @@ PREHOOK: Output: default@over1k_part3
 POSTHOOK: query: insert overwrite table over1k_part3 partition(s,t,i) select si,b,f,s,t,i from over1k_n3 where i=100 and t=27
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_n3
+POSTHOOK: Output: default@over1k_part3
 PREHOOK: query: insert overwrite table over1k_part3 partition(s,t,i) select si,b,f,s,t,i from over1k_n3 where i=100 and s="foo"
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over1k_n3
@@ -4076,6 +4106,7 @@ PREHOOK: Output: default@over1k_part3
 POSTHOOK: query: insert overwrite table over1k_part3 partition(s,t,i) select si,b,f,s,t,i from over1k_n3 where i=100 and s="foo"
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_n3
+POSTHOOK: Output: default@over1k_part3
 PREHOOK: query: insert overwrite table over1k_part3 partition(s,t,i) select si,b,f,s,t,i from over1k_n3 where t=27 and s="foo"
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over1k_n3
@@ -4083,6 +4114,7 @@ PREHOOK: Output: default@over1k_part3
 POSTHOOK: query: insert overwrite table over1k_part3 partition(s,t,i) select si,b,f,s,t,i from over1k_n3 where t=27 and s="foo"
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_n3
+POSTHOOK: Output: default@over1k_part3
 PREHOOK: query: insert overwrite table over1k_part3 partition(s,t,i) select si,b,f,s,t,i from over1k_n3 where i=100 and t=27 and s="foo"
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over1k_n3
@@ -4090,6 +4122,7 @@ PREHOOK: Output: default@over1k_part3
 POSTHOOK: query: insert overwrite table over1k_part3 partition(s,t,i) select si,b,f,s,t,i from over1k_n3 where i=100 and t=27 and s="foo"
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_n3
+POSTHOOK: Output: default@over1k_part3
 PREHOOK: query: select sum(hash(*)) from over1k_part3
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over1k_part3
@@ -4748,6 +4781,8 @@ insert overwrite table over1k_part4_1 partition(s)
 select i+0, s
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_n3
+POSTHOOK: Output: default@over1k_part4_0
+POSTHOOK: Output: default@over1k_part4_1
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-3 depends on stages: Stage-2
@@ -4980,6 +5015,7 @@ insert overwrite table over1k_part4_1 partition(s)
 select i+0, s
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1k_n3
+POSTHOOK: Output: default@over1k_part4_0
 POSTHOOK: Output: default@over1k_part4_0@s=bob brown
 POSTHOOK: Output: default@over1k_part4_0@s=bob carson
 POSTHOOK: Output: default@over1k_part4_0@s=bob davidson
@@ -5000,6 +5036,7 @@ POSTHOOK: Output: default@over1k_part4_0@s=bob white
 POSTHOOK: Output: default@over1k_part4_0@s=bob xylophone
 POSTHOOK: Output: default@over1k_part4_0@s=bob young
 POSTHOOK: Output: default@over1k_part4_0@s=bob zipper
+POSTHOOK: Output: default@over1k_part4_1
 POSTHOOK: Output: default@over1k_part4_1@s=bob brown
 POSTHOOK: Output: default@over1k_part4_1@s=bob carson
 POSTHOOK: Output: default@over1k_part4_1@s=bob davidson
diff --git a/ql/src/test/results/clientpositive/llap/dynpart_sort_optimization2.q.out b/ql/src/test/results/clientpositive/llap/dynpart_sort_optimization2.q.out
index 4d56b3552c..d30425e080 100644
--- a/ql/src/test/results/clientpositive/llap/dynpart_sort_optimization2.q.out
+++ b/ql/src/test/results/clientpositive/llap/dynpart_sort_optimization2.q.out
@@ -75,6 +75,7 @@ select ss_net_paid_inc_tax,
     distribute by ss_sold_date_sk
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@ss_n0
+POSTHOOK: Output: default@ss_part
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -206,6 +207,7 @@ select ss_net_paid_inc_tax,
     distribute by ss_sold_date_sk
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@ss_n0
+POSTHOOK: Output: default@ss_part
 POSTHOOK: Output: default@ss_part@ss_sold_date_sk=2452617
 POSTHOOK: Output: default@ss_part@ss_sold_date_sk=2452638
 POSTHOOK: Lineage: ss_part PARTITION(ss_sold_date_sk=2452617).ss_net_paid_inc_tax SIMPLE [(ss_n0)ss_n0.FieldSchema(name:ss_net_paid_inc_tax, type:float, comment:null), ]
@@ -349,6 +351,7 @@ select ss_net_paid_inc_tax,
     distribute by ss_sold_date_sk
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@ss_n0
+POSTHOOK: Output: default@ss_part
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -468,6 +471,7 @@ select ss_net_paid_inc_tax,
     distribute by ss_sold_date_sk
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@ss_n0
+POSTHOOK: Output: default@ss_part
 POSTHOOK: Output: default@ss_part@ss_sold_date_sk=2452617
 POSTHOOK: Output: default@ss_part@ss_sold_date_sk=2452638
 POSTHOOK: Lineage: ss_part PARTITION(ss_sold_date_sk=2452617).ss_net_paid_inc_tax SIMPLE [(ss_n0)ss_n0.FieldSchema(name:ss_net_paid_inc_tax, type:float, comment:null), ]
@@ -617,6 +621,7 @@ select ss_net_paid_inc_tax,
     distribute by ss_sold_date_sk
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@ss_n0
+POSTHOOK: Output: default@ss_part
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -744,6 +749,7 @@ select ss_net_paid_inc_tax,
     distribute by ss_sold_date_sk
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@ss_n0
+POSTHOOK: Output: default@ss_part
 POSTHOOK: Output: default@ss_part@ss_sold_date_sk=2452617
 POSTHOOK: Output: default@ss_part@ss_sold_date_sk=2452638
 POSTHOOK: Lineage: ss_part PARTITION(ss_sold_date_sk=2452617).ss_net_paid_inc_tax SIMPLE [(ss_n0)ss_n0.FieldSchema(name:ss_net_paid_inc_tax, type:float, comment:null), ]
@@ -887,6 +893,7 @@ select ss_net_paid_inc_tax,
     distribute by ss_sold_date_sk
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@ss_n0
+POSTHOOK: Output: default@ss_part
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -1002,6 +1009,7 @@ select ss_net_paid_inc_tax,
     distribute by ss_sold_date_sk
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@ss_n0
+POSTHOOK: Output: default@ss_part
 POSTHOOK: Output: default@ss_part@ss_sold_date_sk=2452617
 POSTHOOK: Output: default@ss_part@ss_sold_date_sk=2452638
 POSTHOOK: Lineage: ss_part PARTITION(ss_sold_date_sk=2452617).ss_net_paid_inc_tax SIMPLE [(ss_n0)ss_n0.FieldSchema(name:ss_net_paid_inc_tax, type:float, comment:null), ]
@@ -1206,6 +1214,7 @@ select ss_net_paid_inc_tax,
     distribute by ss_sold_date_sk
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@ss_orc
+POSTHOOK: Output: default@ss_part_orc
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -1333,6 +1342,7 @@ select ss_net_paid_inc_tax,
     distribute by ss_sold_date_sk
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@ss_orc
+POSTHOOK: Output: default@ss_part_orc
 POSTHOOK: Output: default@ss_part_orc@ss_sold_date_sk=2452617
 POSTHOOK: Output: default@ss_part_orc@ss_sold_date_sk=2452638
 POSTHOOK: Lineage: ss_part_orc PARTITION(ss_sold_date_sk=2452617).ss_net_paid_inc_tax SIMPLE [(ss_orc)ss_orc.FieldSchema(name:ss_net_paid_inc_tax, type:float, comment:null), ]
@@ -1476,6 +1486,7 @@ select ss_net_paid_inc_tax,
     distribute by ss_sold_date_sk
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@ss_orc
+POSTHOOK: Output: default@ss_part_orc
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -1591,6 +1602,7 @@ select ss_net_paid_inc_tax,
     distribute by ss_sold_date_sk
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@ss_orc
+POSTHOOK: Output: default@ss_part_orc
 POSTHOOK: Output: default@ss_part_orc@ss_sold_date_sk=2452617
 POSTHOOK: Output: default@ss_part_orc@ss_sold_date_sk=2452638
 POSTHOOK: Lineage: ss_part_orc PARTITION(ss_sold_date_sk=2452617).ss_net_paid_inc_tax SIMPLE [(ss_orc)ss_orc.FieldSchema(name:ss_net_paid_inc_tax, type:float, comment:null), ]
@@ -1772,6 +1784,7 @@ from src
 group by "day", key
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
+POSTHOOK: Output: default@hive13_dp1
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -1914,6 +1927,7 @@ from src
 group by "day", key
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
+POSTHOOK: Output: default@hive13_dp1
 POSTHOOK: Output: default@hive13_dp1@day=day
 POSTHOOK: Lineage: hive13_dp1 PARTITION(day=day).k1 EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: hive13_dp1 PARTITION(day=day).k2 EXPRESSION [(src)src.FieldSchema(name:value, type:string, comment:default), ]
@@ -1951,6 +1965,7 @@ from src
 group by "day", key
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
+POSTHOOK: Output: default@hive13_dp1
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -2093,6 +2108,7 @@ from src
 group by "day", key
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
+POSTHOOK: Output: default@hive13_dp1
 POSTHOOK: Output: default@hive13_dp1@day=day
 POSTHOOK: Lineage: hive13_dp1 PARTITION(day=day).k1 EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: hive13_dp1 PARTITION(day=day).k2 EXPRESSION [(src)src.FieldSchema(name:value, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/llap/dynpart_sort_optimization_acid.q.out b/ql/src/test/results/clientpositive/llap/dynpart_sort_optimization_acid.q.out
index ba0b22232a..0e50417752 100644
--- a/ql/src/test/results/clientpositive/llap/dynpart_sort_optimization_acid.q.out
+++ b/ql/src/test/results/clientpositive/llap/dynpart_sort_optimization_acid.q.out
@@ -25,6 +25,7 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
+POSTHOOK: Output: default@acid_part
 POSTHOOK: Output: default@acid_part@ds=2008-04-08
 POSTHOOK: Output: default@acid_part@ds=2008-04-09
 POSTHOOK: Lineage: acid_part PARTITION(ds=2008-04-08).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -326,6 +327,7 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
+POSTHOOK: Output: default@acid_part_sdpo
 POSTHOOK: Output: default@acid_part_sdpo@ds=2008-04-08
 POSTHOOK: Output: default@acid_part_sdpo@ds=2008-04-09
 POSTHOOK: Lineage: acid_part_sdpo PARTITION(ds=2008-04-08).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -627,6 +629,7 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
+POSTHOOK: Output: default@acid_2l_part
 POSTHOOK: Output: default@acid_2l_part@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@acid_2l_part@ds=2008-04-08/hr=12
 POSTHOOK: Output: default@acid_2l_part@ds=2008-04-09/hr=11
@@ -1087,6 +1090,7 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
+POSTHOOK: Output: default@acid_2l_part_sdpo
 POSTHOOK: Output: default@acid_2l_part_sdpo@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@acid_2l_part_sdpo@ds=2008-04-08/hr=12
 POSTHOOK: Output: default@acid_2l_part_sdpo@ds=2008-04-09/hr=11
@@ -1546,6 +1550,7 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
+POSTHOOK: Output: default@acid_2l_part_sdpo_no_cp
 POSTHOOK: Output: default@acid_2l_part_sdpo_no_cp@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@acid_2l_part_sdpo_no_cp@ds=2008-04-08/hr=12
 POSTHOOK: Output: default@acid_2l_part_sdpo_no_cp@ds=2008-04-09/hr=11
diff --git a/ql/src/test/results/clientpositive/llap/dynpart_sort_optimization_acid2.q.out b/ql/src/test/results/clientpositive/llap/dynpart_sort_optimization_acid2.q.out
index 25f388e857..071196bf68 100644
--- a/ql/src/test/results/clientpositive/llap/dynpart_sort_optimization_acid2.q.out
+++ b/ql/src/test/results/clientpositive/llap/dynpart_sort_optimization_acid2.q.out
@@ -29,6 +29,7 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
+POSTHOOK: Output: default@non_acid
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/llap/enforce_constraint_notnull.q.out b/ql/src/test/results/clientpositive/llap/enforce_constraint_notnull.q.out
index 3de8f0a4bd..b6f6c37335 100644
--- a/ql/src/test/results/clientpositive/llap/enforce_constraint_notnull.q.out
+++ b/ql/src/test/results/clientpositive/llap/enforce_constraint_notnull.q.out
@@ -3951,6 +3951,7 @@ PREHOOK: Output: default@tablepartitioned
 POSTHOOK: query: explain INSERT INTO tablePartitioned partition(p1, p2) select key, value, value, key as p1, 3 as p2 from src limit 10
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
+POSTHOOK: Output: default@tablepartitioned
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -4077,6 +4078,7 @@ PREHOOK: Output: default@tablepartitioned
 POSTHOOK: query: INSERT INTO tablePartitioned partition(p1, p2) select key, value, value, key as p1, 3 as p2 from src limit 10
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
+POSTHOOK: Output: default@tablepartitioned
 POSTHOOK: Output: default@tablepartitioned@p1=165/p2=3
 POSTHOOK: Output: default@tablepartitioned@p1=238/p2=3
 POSTHOOK: Output: default@tablepartitioned@p1=255/p2=3
@@ -4173,6 +4175,7 @@ insert overwrite table src_multi2_n1 select * where key > 10 and key < 20
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 POSTHOOK: Output: default@src_multi2_n1
+POSTHOOK: Output: default@tablepartitioned
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-3 depends on stages: Stage-2
diff --git a/ql/src/test/results/clientpositive/llap/explain_locks.q.out b/ql/src/test/results/clientpositive/llap/explain_locks.q.out
index d02201313b..667e6d69ad 100644
--- a/ql/src/test/results/clientpositive/llap/explain_locks.q.out
+++ b/ql/src/test/results/clientpositive/llap/explain_locks.q.out
@@ -44,6 +44,7 @@ PREHOOK: Output: default@target
 POSTHOOK: query: insert into target partition(p,q) values (1,2,1,2), (3,4,1,2), (5,6,1,3), (7,8,2,2)
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@target
 POSTHOOK: Output: default@target@p=1/q=2
 POSTHOOK: Output: default@target@p=1/q=3
 POSTHOOK: Output: default@target@p=2/q=2
@@ -132,6 +133,7 @@ POSTHOOK: Input: default@target@p=1/q=2
 POSTHOOK: Input: default@target@p=1/q=3
 POSTHOOK: Input: default@target@p=2/q=2
 POSTHOOK: Output: default@merge_tmp_table
+POSTHOOK: Output: default@target
 POSTHOOK: Output: default@target@p=1/q=2
 POSTHOOK: Output: default@target@p=1/q=2
 POSTHOOK: Output: default@target@p=1/q=3
@@ -229,6 +231,7 @@ POSTHOOK: Input: default@target@p=1/q=2
 POSTHOOK: Input: default@target@p=1/q=3
 POSTHOOK: Input: default@target@p=2/q=2
 POSTHOOK: Output: default@merge_tmp_table
+POSTHOOK: Output: default@target
 POSTHOOK: Output: default@target@p=1/q=2
 POSTHOOK: Output: default@target@p=1/q=2
 POSTHOOK: Output: default@target@p=1/q=3
diff --git a/ql/src/test/results/clientpositive/llap/extrapolate_part_stats_full.q.out b/ql/src/test/results/clientpositive/llap/extrapolate_part_stats_full.q.out
index cba98dddbe..056b784933 100644
--- a/ql/src/test/results/clientpositive/llap/extrapolate_part_stats_full.q.out
+++ b/ql/src/test/results/clientpositive/llap/extrapolate_part_stats_full.q.out
@@ -47,6 +47,7 @@ PREHOOK: Output: default@loc_orc_1d
 POSTHOOK: query: insert overwrite table loc_orc_1d partition(year) select * from ext_loc
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@ext_loc
+POSTHOOK: Output: default@loc_orc_1d
 POSTHOOK: Output: default@loc_orc_1d@year=2000
 POSTHOOK: Output: default@loc_orc_1d@year=2001
 POSTHOOK: Lineage: loc_orc_1d PARTITION(year=2000).locid SIMPLE [(ext_loc)ext_loc.FieldSchema(name:locid, type:int, comment:null), ]
@@ -320,6 +321,7 @@ PREHOOK: Output: default@loc_orc_2d
 POSTHOOK: query: insert overwrite table loc_orc_2d partition(zip, year) select * from ext_loc
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@ext_loc
+POSTHOOK: Output: default@loc_orc_2d
 POSTHOOK: Output: default@loc_orc_2d@zip=94086/year=2000
 POSTHOOK: Output: default@loc_orc_2d@zip=94086/year=2001
 POSTHOOK: Output: default@loc_orc_2d@zip=94087/year=2000
diff --git a/ql/src/test/results/clientpositive/llap/extrapolate_part_stats_partial.q.out b/ql/src/test/results/clientpositive/llap/extrapolate_part_stats_partial.q.out
index de09f9e8ea..bd1766710d 100644
--- a/ql/src/test/results/clientpositive/llap/extrapolate_part_stats_partial.q.out
+++ b/ql/src/test/results/clientpositive/llap/extrapolate_part_stats_partial.q.out
@@ -47,6 +47,7 @@ PREHOOK: Output: default@loc_orc_1d_n1
 POSTHOOK: query: insert overwrite table loc_orc_1d_n1 partition(year) select * from ext_loc_n1
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@ext_loc_n1
+POSTHOOK: Output: default@loc_orc_1d_n1
 POSTHOOK: Output: default@loc_orc_1d_n1@year=2000
 POSTHOOK: Output: default@loc_orc_1d_n1@year=2001
 POSTHOOK: Output: default@loc_orc_1d_n1@year=2002
@@ -860,6 +861,7 @@ PREHOOK: Output: default@loc_orc_2d_n1
 POSTHOOK: query: insert overwrite table loc_orc_2d_n1 partition(zip, year) select * from ext_loc_n1
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@ext_loc_n1
+POSTHOOK: Output: default@loc_orc_2d_n1
 POSTHOOK: Output: default@loc_orc_2d_n1@zip=43201/year=2001
 POSTHOOK: Output: default@loc_orc_2d_n1@zip=43201/year=2002
 POSTHOOK: Output: default@loc_orc_2d_n1@zip=43201/year=2003
diff --git a/ql/src/test/results/clientpositive/llap/extrapolate_part_stats_partial_ndv.q.out b/ql/src/test/results/clientpositive/llap/extrapolate_part_stats_partial_ndv.q.out
index 383b2dbc12..f641edafdd 100644
--- a/ql/src/test/results/clientpositive/llap/extrapolate_part_stats_partial_ndv.q.out
+++ b/ql/src/test/results/clientpositive/llap/extrapolate_part_stats_partial_ndv.q.out
@@ -59,6 +59,7 @@ PREHOOK: Output: default@loc_orc_1d_n0
 POSTHOOK: query: insert overwrite table loc_orc_1d_n0 partition(year) select * from ext_loc_n0
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@ext_loc_n0
+POSTHOOK: Output: default@loc_orc_1d_n0
 POSTHOOK: Output: default@loc_orc_1d_n0@year=2000
 POSTHOOK: Output: default@loc_orc_1d_n0@year=2001
 POSTHOOK: Output: default@loc_orc_1d_n0@year=2002
@@ -792,6 +793,7 @@ PREHOOK: Output: default@loc_orc_2d_n0
 POSTHOOK: query: insert overwrite table loc_orc_2d_n0 partition(zip, year) select * from ext_loc_n0
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@ext_loc_n0
+POSTHOOK: Output: default@loc_orc_2d_n0
 POSTHOOK: Output: default@loc_orc_2d_n0@zip=43201/year=2001
 POSTHOOK: Output: default@loc_orc_2d_n0@zip=43201/year=2002
 POSTHOOK: Output: default@loc_orc_2d_n0@zip=43201/year=2003
diff --git a/ql/src/test/results/clientpositive/llap/filter_numeric.q.out b/ql/src/test/results/clientpositive/llap/filter_numeric.q.out
index 19ce226560..ac16215564 100644
--- a/ql/src/test/results/clientpositive/llap/filter_numeric.q.out
+++ b/ql/src/test/results/clientpositive/llap/filter_numeric.q.out
@@ -17,6 +17,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcpart
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
+POSTHOOK: Output: default@partint
 POSTHOOK: Output: default@partint@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@partint@ds=2008-04-08/hr=12
 POSTHOOK: Lineage: partint PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/llap/implicit_cast_during_insert.q.out b/ql/src/test/results/clientpositive/llap/implicit_cast_during_insert.q.out
index ef11f0e3ad..a70705e3a5 100644
--- a/ql/src/test/results/clientpositive/llap/implicit_cast_during_insert.q.out
+++ b/ql/src/test/results/clientpositive/llap/implicit_cast_during_insert.q.out
@@ -21,6 +21,7 @@ insert overwrite table implicit_cast_during_insert partition (p1)
   distribute by key1 sort by key1
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
+POSTHOOK: Output: default@implicit_cast_during_insert
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -128,6 +129,7 @@ POSTHOOK: query: insert overwrite table implicit_cast_during_insert partition (p
   distribute by key1 sort by key1
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
+POSTHOOK: Output: default@implicit_cast_during_insert
 POSTHOOK: Output: default@implicit_cast_during_insert@p1=0
 POSTHOOK: Lineage: implicit_cast_during_insert PARTITION(p1=0).c1 EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: implicit_cast_during_insert PARTITION(p1=0).c2 SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/llap/infer_bucket_sort_dyn_part.q.out b/ql/src/test/results/clientpositive/llap/infer_bucket_sort_dyn_part.q.out
index 84dcaeb291..fad941b074 100644
--- a/ql/src/test/results/clientpositive/llap/infer_bucket_sort_dyn_part.q.out
+++ b/ql/src/test/results/clientpositive/llap/infer_bucket_sort_dyn_part.q.out
@@ -29,6 +29,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcpart
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
+POSTHOOK: Output: default@test_table_n8
 POSTHOOK: Output: default@test_table_n8@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@test_table_n8@ds=2008-04-08/hr=12
 POSTHOOK: Lineage: test_table_n8 PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -128,6 +129,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcpart
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
+POSTHOOK: Output: default@test_table_n8
 POSTHOOK: Output: default@test_table_n8@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@test_table_n8@ds=2008-04-08/hr=12
 POSTHOOK: Lineage: test_table_n8 PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -229,6 +231,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcpart
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
+POSTHOOK: Output: default@test_table_n8
 POSTHOOK: Output: default@test_table_n8@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@test_table_n8@ds=2008-04-08/hr=12
 POSTHOOK: Lineage: test_table_n8 PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/llap/insert0.q.out b/ql/src/test/results/clientpositive/llap/insert0.q.out
index 71579d29d7..f30614b13f 100644
--- a/ql/src/test/results/clientpositive/llap/insert0.q.out
+++ b/ql/src/test/results/clientpositive/llap/insert0.q.out
@@ -141,6 +141,7 @@ POSTHOOK: query: insert overwrite table ctas_part partition (modkey)
 select key, value, ceil(key / 100) from src where key is not null order by key limit 10
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
+POSTHOOK: Output: default@ctas_part
 POSTHOOK: Output: default@ctas_part@modkey=0
 POSTHOOK: Output: default@ctas_part@modkey=1
 POSTHOOK: Output: default@ctas_part@modkey=2
diff --git a/ql/src/test/results/clientpositive/llap/insert_acid_dynamic_partition.q.out b/ql/src/test/results/clientpositive/llap/insert_acid_dynamic_partition.q.out
index 07eedf3a36..793188500a 100644
--- a/ql/src/test/results/clientpositive/llap/insert_acid_dynamic_partition.q.out
+++ b/ql/src/test/results/clientpositive/llap/insert_acid_dynamic_partition.q.out
@@ -13,6 +13,7 @@ PREHOOK: Output: default@acid_dynamic
 POSTHOOK: query: insert into table acid_dynamic partition (ds) select cint, cast(cstring1 as varchar(128)), cstring2 from alltypesorc where cint is not null and cint < 0 order by cint limit 5
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc
+POSTHOOK: Output: default@acid_dynamic
 POSTHOOK: Output: default@acid_dynamic@ds=4KWs6gw7lv2WYd66P
 POSTHOOK: Output: default@acid_dynamic@ds=4hA4KQj2vD3fI6gX82220d
 POSTHOOK: Output: default@acid_dynamic@ds=KbaDXiN85adbHRx58v
diff --git a/ql/src/test/results/clientpositive/llap/insert_into6.q.out b/ql/src/test/results/clientpositive/llap/insert_into6.q.out
index 0fc0523315..b74b29310d 100644
--- a/ql/src/test/results/clientpositive/llap/insert_into6.q.out
+++ b/ql/src/test/results/clientpositive/llap/insert_into6.q.out
@@ -201,6 +201,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@insert_into6a
 POSTHOOK: Input: default@insert_into6a@ds=1
 POSTHOOK: Input: default@insert_into6a@ds=2
+POSTHOOK: Output: default@insert_into6b
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -307,6 +308,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@insert_into6a
 POSTHOOK: Input: default@insert_into6a@ds=1
 POSTHOOK: Input: default@insert_into6a@ds=2
+POSTHOOK: Output: default@insert_into6b
 POSTHOOK: Output: default@insert_into6b@ds=1
 POSTHOOK: Output: default@insert_into6b@ds=2
 POSTHOOK: Lineage: insert_into6b PARTITION(ds=1).key SIMPLE [(insert_into6a)insert_into6a.FieldSchema(name:key, type:int, comment:null), ]
diff --git a/ql/src/test/results/clientpositive/llap/insert_into_with_schema.q.out b/ql/src/test/results/clientpositive/llap/insert_into_with_schema.q.out
index 13545d8f91..66c538855a 100644
--- a/ql/src/test/results/clientpositive/llap/insert_into_with_schema.q.out
+++ b/ql/src/test/results/clientpositive/llap/insert_into_with_schema.q.out
@@ -235,6 +235,7 @@ PREHOOK: Output: x314@pageviews
 POSTHOOK: query: INSERT INTO TABLE pageviews PARTITION (datestamp,i)(userid,i,link,datestamp) VALUES ('jsmith', 17, '17mail.com', '2014-09-23')
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: x314@pageviews
 POSTHOOK: Output: x314@pageviews@datestamp=2014-09-23/i=17
 POSTHOOK: Lineage: pageviews PARTITION(datestamp=2014-09-23,i=17).link SCRIPT []
 POSTHOOK: Lineage: pageviews PARTITION(datestamp=2014-09-23,i=17).source_n0 SIMPLE []
@@ -246,6 +247,7 @@ PREHOOK: Output: x314@pageviews
 POSTHOOK: query: INSERT INTO TABLE pageviews PARTITION (datestamp,i)(userid,i,link,datestamp) VALUES ('jsmith', 19, '19mail.com', '2014-09-24')
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: x314@pageviews
 POSTHOOK: Output: x314@pageviews@datestamp=2014-09-24/i=19
 POSTHOOK: Lineage: pageviews PARTITION(datestamp=2014-09-24,i=19).link SCRIPT []
 POSTHOOK: Lineage: pageviews PARTITION(datestamp=2014-09-24,i=19).source_n0 SIMPLE []
@@ -257,6 +259,7 @@ PREHOOK: Output: x314@pageviews
 POSTHOOK: query: INSERT INTO TABLE pageviews PARTITION (datestamp,i)(userid,i,link) VALUES ('jsmith', 23, '23mail.com')
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: x314@pageviews
 POSTHOOK: Output: x314@pageviews@datestamp=__HIVE_DEFAULT_PARTITION__/i=23
 POSTHOOK: Lineage: pageviews PARTITION(datestamp=__HIVE_DEFAULT_PARTITION__,i=23).link SCRIPT []
 POSTHOOK: Lineage: pageviews PARTITION(datestamp=__HIVE_DEFAULT_PARTITION__,i=23).source_n0 SIMPLE []
diff --git a/ql/src/test/results/clientpositive/llap/insert_into_with_schema2.q.out b/ql/src/test/results/clientpositive/llap/insert_into_with_schema2.q.out
index 82788f5b69..cfa1eac591 100644
--- a/ql/src/test/results/clientpositive/llap/insert_into_with_schema2.q.out
+++ b/ql/src/test/results/clientpositive/llap/insert_into_with_schema2.q.out
@@ -119,6 +119,7 @@ PREHOOK: Output: default@acid_partitioned
 POSTHOOK: query: insert into acid_partitioned partition (p) (a,p) values(1,2)
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@acid_partitioned
 POSTHOOK: Output: default@acid_partitioned@p=2
 POSTHOOK: Lineage: acid_partitioned PARTITION(p=2).a SCRIPT []
 POSTHOOK: Lineage: acid_partitioned PARTITION(p=2).c SIMPLE []
diff --git a/ql/src/test/results/clientpositive/llap/insert_overwrite.q.out b/ql/src/test/results/clientpositive/llap/insert_overwrite.q.out
index 1ee38d371c..e21a5177c0 100644
--- a/ql/src/test/results/clientpositive/llap/insert_overwrite.q.out
+++ b/ql/src/test/results/clientpositive/llap/insert_overwrite.q.out
@@ -246,6 +246,7 @@ PREHOOK: Output: default@ext_part
 POSTHOOK: query: INSERT OVERWRITE TABLE ext_part PARTITION (par) SELECT * FROM b
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@b
+POSTHOOK: Output: default@ext_part
 PREHOOK: query: SELECT count(*) FROM ext_part
 PREHOOK: type: QUERY
 PREHOOK: Input: default@ext_part
@@ -276,6 +277,7 @@ PREHOOK: Output: default@ext_part
 POSTHOOK: query: INSERT OVERWRITE TABLE ext_part PARTITION (par) SELECT * FROM b
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@b
+POSTHOOK: Output: default@ext_part
 POSTHOOK: Output: default@ext_part@par=1
 POSTHOOK: Lineage: ext_part PARTITION(par=1).col SIMPLE [(b)b.FieldSchema(name:par, type:string, comment:null), ]
 PREHOOK: query: SELECT count(*) FROM ext_part
@@ -372,6 +374,7 @@ PREHOOK: Output: default@int_part
 POSTHOOK: query: INSERT OVERWRITE TABLE int_part PARTITION (par) SELECT * FROM b
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@b
+POSTHOOK: Output: default@int_part
 POSTHOOK: Output: default@int_part@par=1
 POSTHOOK: Output: default@int_part@par=2
 POSTHOOK: Output: default@int_part@par=3
@@ -434,6 +437,7 @@ PREHOOK: Output: default@int_part
 POSTHOOK: query: INSERT OVERWRITE TABLE int_part PARTITION (par) SELECT * FROM b
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@b
+POSTHOOK: Output: default@int_part
 POSTHOOK: Output: default@int_part@par=1
 POSTHOOK: Output: default@int_part@par=2
 POSTHOOK: Output: default@int_part@par=3
diff --git a/ql/src/test/results/clientpositive/llap/insert_values_dynamic_partitioned.q.out b/ql/src/test/results/clientpositive/llap/insert_values_dynamic_partitioned.q.out
index cd234b566a..79b6109da0 100644
--- a/ql/src/test/results/clientpositive/llap/insert_values_dynamic_partitioned.q.out
+++ b/ql/src/test/results/clientpositive/llap/insert_values_dynamic_partitioned.q.out
@@ -21,6 +21,7 @@ POSTHOOK: query: insert into table ivdp partition (ds) values
     (6553, 923.19, 'the lamb was sure to go', 'tomorrow')
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@ivdp
 POSTHOOK: Output: default@ivdp@ds=today
 POSTHOOK: Output: default@ivdp@ds=tomorrow
 POSTHOOK: Lineage: ivdp PARTITION(ds=today).de SCRIPT []
diff --git a/ql/src/test/results/clientpositive/llap/insert_with_move_files_from_source_dir.q.out b/ql/src/test/results/clientpositive/llap/insert_with_move_files_from_source_dir.q.out
index b55cdfaca5..762474b9c8 100644
--- a/ql/src/test/results/clientpositive/llap/insert_with_move_files_from_source_dir.q.out
+++ b/ql/src/test/results/clientpositive/llap/insert_with_move_files_from_source_dir.q.out
@@ -83,6 +83,7 @@ PREHOOK: Output: default@emp1_part_bucket
 POSTHOOK: query: insert overwrite table emp1_part_bucket partition (dept, country) select * from emp1
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@emp1
+POSTHOOK: Output: default@emp1_part_bucket
 POSTHOOK: Output: default@emp1_part_bucket@dept=2000/country=UK
 POSTHOOK: Output: default@emp1_part_bucket@dept=2000/country=USA
 POSTHOOK: Output: default@emp1_part_bucket@dept=3000/country=UK
diff --git a/ql/src/test/results/clientpositive/llap/lineage4.q.out b/ql/src/test/results/clientpositive/llap/lineage4.q.out
new file mode 100644
index 0000000000..fdfc26a3cb
--- /dev/null
+++ b/ql/src/test/results/clientpositive/llap/lineage4.q.out
@@ -0,0 +1,24 @@
+PREHOOK: query: create table table_t (id int) partitioned by (dob date)
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@table_t
+POSTHOOK: query: create table table_t (id int) partitioned by (dob date)
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@table_t
+PREHOOK: query: create table table_b (id int) partitioned by (dob date)
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@table_b
+POSTHOOK: query: create table table_b (id int) partitioned by (dob date)
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@table_b
+PREHOOK: query: from table_b a insert overwrite table table_t select a.id,a.dob
+PREHOOK: type: QUERY
+PREHOOK: Input: default@table_b
+PREHOOK: Output: default@table_t
+POSTHOOK: query: from table_b a insert overwrite table table_t select a.id,a.dob
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@table_b
+POSTHOOK: Output: default@table_t
diff --git a/ql/src/test/results/clientpositive/llap/llap_partitioned.q.out b/ql/src/test/results/clientpositive/llap/llap_partitioned.q.out
index 012569950c..b1de8fd106 100644
--- a/ql/src/test/results/clientpositive/llap/llap_partitioned.q.out
+++ b/ql/src/test/results/clientpositive/llap/llap_partitioned.q.out
@@ -75,6 +75,7 @@ POSTHOOK: query: INSERT OVERWRITE TABLE orc_llap_part PARTITION (ctinyint)
 SELECT csmallint, cint, cbigint, cfloat, cdouble, cstring1, cstring1, cstring1, cboolean1, cboolean2, ctinyint FROM alltypesorc
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc
+POSTHOOK: Output: default@orc_llap_part
 POSTHOOK: Output: default@orc_llap_part@ctinyint=-1
 POSTHOOK: Output: default@orc_llap_part@ctinyint=-10
 POSTHOOK: Output: default@orc_llap_part@ctinyint=-11
@@ -1492,6 +1493,7 @@ POSTHOOK: query: INSERT OVERWRITE TABLE orc_llap_dim_part PARTITION (ctinyint)
 SELECT null, null, sum(cbigint) as cbigint, null, null, null, null, null, null, null, ctinyint FROM alltypesorc WHERE ctinyint > 10 AND ctinyint < 21 GROUP BY ctinyint
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc
+POSTHOOK: Output: default@orc_llap_dim_part
 POSTHOOK: Output: default@orc_llap_dim_part@ctinyint=11
 POSTHOOK: Output: default@orc_llap_dim_part@ctinyint=12
 POSTHOOK: Output: default@orc_llap_dim_part@ctinyint=13
diff --git a/ql/src/test/results/clientpositive/llap/llap_stats.q.out b/ql/src/test/results/clientpositive/llap/llap_stats.q.out
index 6fea21c576..479af05d35 100644
--- a/ql/src/test/results/clientpositive/llap/llap_stats.q.out
+++ b/ql/src/test/results/clientpositive/llap/llap_stats.q.out
@@ -19,6 +19,7 @@ POSTHOOK: query: insert into table llap_stats partition(cint)
 select cint, ctinyint, csmallint from alltypesorc where cint is not null limit 10
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc
+POSTHOOK: Output: default@llap_stats
 POSTHOOK: Output: default@llap_stats@cint=-13326
 POSTHOOK: Output: default@llap_stats@cint=-15431
 POSTHOOK: Output: default@llap_stats@cint=-15549
diff --git a/ql/src/test/results/clientpositive/llap/load_data_using_job.q.out b/ql/src/test/results/clientpositive/llap/load_data_using_job.q.out
index d2abd75c02..d04e82e423 100644
--- a/ql/src/test/results/clientpositive/llap/load_data_using_job.q.out
+++ b/ql/src/test/results/clientpositive/llap/load_data_using_job.q.out
@@ -195,6 +195,7 @@ PREHOOK: Output: default@srcbucket_mapjoin_n8
 POSTHOOK: query: explain load data local inpath '../../data/files/load_data_job/load_data_1_partition.txt' INTO TABLE srcbucket_mapjoin_n8
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcbucket_mapjoin_n8__temp_table_for_load_data__
+POSTHOOK: Output: default@srcbucket_mapjoin_n8
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -269,6 +270,7 @@ PREHOOK: Output: default@srcbucket_mapjoin_n8
 POSTHOOK: query: load data local inpath '../../data/files/load_data_job/load_data_1_partition.txt' INTO TABLE srcbucket_mapjoin_n8
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcbucket_mapjoin_n8__temp_table_for_load_data__
+POSTHOOK: Output: default@srcbucket_mapjoin_n8
 POSTHOOK: Output: default@srcbucket_mapjoin_n8@ds=2008-04-08
 POSTHOOK: Lineage: srcbucket_mapjoin_n8 PARTITION(ds=2008-04-08).key SIMPLE [(srcbucket_mapjoin_n8__temp_table_for_load_data__)srcbucket_mapjoin_n8__temp_table_for_load_data__.FieldSchema(name:key, type:int, comment:null), ]
 POSTHOOK: Lineage: srcbucket_mapjoin_n8 PARTITION(ds=2008-04-08).value SIMPLE [(srcbucket_mapjoin_n8__temp_table_for_load_data__)srcbucket_mapjoin_n8__temp_table_for_load_data__.FieldSchema(name:value, type:string, comment:null), ]
@@ -423,6 +425,7 @@ PREHOOK: Output: default@srcbucket_mapjoin_n8
 POSTHOOK: query: explain load data local inpath '../../data/files/load_data_job/partitions/load_data_2_partitions.txt' INTO TABLE srcbucket_mapjoin_n8
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcbucket_mapjoin_n8__temp_table_for_load_data__
+POSTHOOK: Output: default@srcbucket_mapjoin_n8
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -498,6 +501,7 @@ PREHOOK: Output: default@srcbucket_mapjoin_n8
 POSTHOOK: query: load data local inpath '../../data/files/load_data_job/partitions/load_data_2_partitions.txt' INTO TABLE srcbucket_mapjoin_n8
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcbucket_mapjoin_n8__temp_table_for_load_data__
+POSTHOOK: Output: default@srcbucket_mapjoin_n8
 POSTHOOK: Output: default@srcbucket_mapjoin_n8@ds=2008-04-08/hr=0
 POSTHOOK: Output: default@srcbucket_mapjoin_n8@ds=2008-04-08/hr=1
 POSTHOOK: Lineage: srcbucket_mapjoin_n8 PARTITION(ds=2008-04-08,hr=0).key SIMPLE [(srcbucket_mapjoin_n8__temp_table_for_load_data__)srcbucket_mapjoin_n8__temp_table_for_load_data__.FieldSchema(name:key, type:int, comment:null), ]
@@ -657,6 +661,7 @@ PREHOOK: Output: default@srcbucket_mapjoin_n8
 POSTHOOK: query: explain load data local inpath '../../data/files/load_data_job/partitions/subdir' INTO TABLE srcbucket_mapjoin_n8
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcbucket_mapjoin_n8__temp_table_for_load_data__
+POSTHOOK: Output: default@srcbucket_mapjoin_n8
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -732,6 +737,7 @@ PREHOOK: Output: default@srcbucket_mapjoin_n8
 POSTHOOK: query: load data local inpath '../../data/files/load_data_job/partitions/subdir' INTO TABLE srcbucket_mapjoin_n8
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcbucket_mapjoin_n8__temp_table_for_load_data__
+POSTHOOK: Output: default@srcbucket_mapjoin_n8
 POSTHOOK: Output: default@srcbucket_mapjoin_n8@ds=2008-04-08/hr=0
 POSTHOOK: Output: default@srcbucket_mapjoin_n8@ds=2008-04-08/hr=1
 POSTHOOK: Lineage: srcbucket_mapjoin_n8 PARTITION(ds=2008-04-08,hr=0).key SIMPLE [(srcbucket_mapjoin_n8__temp_table_for_load_data__)srcbucket_mapjoin_n8__temp_table_for_load_data__.FieldSchema(name:key, type:int, comment:null), ]
@@ -1234,6 +1240,7 @@ PREHOOK: Output: default@srcbucket_mapjoin_n8
 POSTHOOK: query: explain load data local inpath '../../data/files/load_data_job/load_data_1_partition.txt' INTO TABLE srcbucket_mapjoin_n8
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcbucket_mapjoin_n8__temp_table_for_load_data__
+POSTHOOK: Output: default@srcbucket_mapjoin_n8
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -1308,6 +1315,7 @@ PREHOOK: Output: default@srcbucket_mapjoin_n8
 POSTHOOK: query: load data local inpath '../../data/files/load_data_job/load_data_1_partition.txt' INTO TABLE srcbucket_mapjoin_n8
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcbucket_mapjoin_n8__temp_table_for_load_data__
+POSTHOOK: Output: default@srcbucket_mapjoin_n8
 POSTHOOK: Output: default@srcbucket_mapjoin_n8@ds=2008-04-08
 POSTHOOK: Lineage: srcbucket_mapjoin_n8 PARTITION(ds=2008-04-08).key SIMPLE [(srcbucket_mapjoin_n8__temp_table_for_load_data__)srcbucket_mapjoin_n8__temp_table_for_load_data__.FieldSchema(name:key, type:int, comment:null), ]
 POSTHOOK: Lineage: srcbucket_mapjoin_n8 PARTITION(ds=2008-04-08).value SIMPLE [(srcbucket_mapjoin_n8__temp_table_for_load_data__)srcbucket_mapjoin_n8__temp_table_for_load_data__.FieldSchema(name:value, type:string, comment:null), ]
@@ -1462,6 +1470,7 @@ PREHOOK: Output: default@srcbucket_mapjoin_n8
 POSTHOOK: query: explain load data local inpath '../../data/files/load_data_job/partitions/load_data_2_partitions.txt' INTO TABLE srcbucket_mapjoin_n8
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcbucket_mapjoin_n8__temp_table_for_load_data__
+POSTHOOK: Output: default@srcbucket_mapjoin_n8
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -1537,6 +1546,7 @@ PREHOOK: Output: default@srcbucket_mapjoin_n8
 POSTHOOK: query: load data local inpath '../../data/files/load_data_job/partitions/load_data_2_partitions.txt' INTO TABLE srcbucket_mapjoin_n8
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcbucket_mapjoin_n8__temp_table_for_load_data__
+POSTHOOK: Output: default@srcbucket_mapjoin_n8
 POSTHOOK: Output: default@srcbucket_mapjoin_n8@ds=2008-04-08/hr=0
 POSTHOOK: Output: default@srcbucket_mapjoin_n8@ds=2008-04-08/hr=1
 POSTHOOK: Lineage: srcbucket_mapjoin_n8 PARTITION(ds=2008-04-08,hr=0).key SIMPLE [(srcbucket_mapjoin_n8__temp_table_for_load_data__)srcbucket_mapjoin_n8__temp_table_for_load_data__.FieldSchema(name:key, type:int, comment:null), ]
@@ -1696,6 +1706,7 @@ PREHOOK: Output: default@srcbucket_mapjoin_n8
 POSTHOOK: query: explain load data local inpath '../../data/files/load_data_job/partitions/subdir' INTO TABLE srcbucket_mapjoin_n8
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcbucket_mapjoin_n8__temp_table_for_load_data__
+POSTHOOK: Output: default@srcbucket_mapjoin_n8
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -1771,6 +1782,7 @@ PREHOOK: Output: default@srcbucket_mapjoin_n8
 POSTHOOK: query: load data local inpath '../../data/files/load_data_job/partitions/subdir' INTO TABLE srcbucket_mapjoin_n8
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcbucket_mapjoin_n8__temp_table_for_load_data__
+POSTHOOK: Output: default@srcbucket_mapjoin_n8
 POSTHOOK: Output: default@srcbucket_mapjoin_n8@ds=2008-04-08/hr=0
 POSTHOOK: Output: default@srcbucket_mapjoin_n8@ds=2008-04-08/hr=1
 POSTHOOK: Lineage: srcbucket_mapjoin_n8 PARTITION(ds=2008-04-08,hr=0).key SIMPLE [(srcbucket_mapjoin_n8__temp_table_for_load_data__)srcbucket_mapjoin_n8__temp_table_for_load_data__.FieldSchema(name:key, type:int, comment:null), ]
@@ -2048,6 +2060,7 @@ PREHOOK: Output: default@srcbucket_mapjoin_n8
 POSTHOOK: query: explain load data local inpath '../../data/files/load_data_job/partitions' INTO TABLE srcbucket_mapjoin_n8
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcbucket_mapjoin_n8__temp_table_for_load_data__
+POSTHOOK: Output: default@srcbucket_mapjoin_n8
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -2123,6 +2136,7 @@ PREHOOK: Output: default@srcbucket_mapjoin_n8
 POSTHOOK: query: load data local inpath '../../data/files/load_data_job/partitions' INTO TABLE srcbucket_mapjoin_n8
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcbucket_mapjoin_n8__temp_table_for_load_data__
+POSTHOOK: Output: default@srcbucket_mapjoin_n8
 POSTHOOK: Output: default@srcbucket_mapjoin_n8@ds=2008-04-08/hr=0
 POSTHOOK: Output: default@srcbucket_mapjoin_n8@ds=2008-04-08/hr=1
 POSTHOOK: Lineage: srcbucket_mapjoin_n8 PARTITION(ds=2008-04-08,hr=0).key SIMPLE [(srcbucket_mapjoin_n8__temp_table_for_load_data__)srcbucket_mapjoin_n8__temp_table_for_load_data__.FieldSchema(name:key, type:int, comment:null), ]
@@ -2636,6 +2650,7 @@ PREHOOK: Output: default@srcbucket_mapjoin_n8
 POSTHOOK: query: explain load data local inpath '../../data/files/load_data_job/partitions/load_data_2_partitions.txt' INTO TABLE srcbucket_mapjoin_n8
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcbucket_mapjoin_n8__temp_table_for_load_data__
+POSTHOOK: Output: default@srcbucket_mapjoin_n8
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -2710,6 +2725,7 @@ PREHOOK: Output: default@srcbucket_mapjoin_n8
 POSTHOOK: query: load data local inpath '../../data/files/load_data_job/partitions/load_data_2_partitions.txt' INTO TABLE srcbucket_mapjoin_n8
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcbucket_mapjoin_n8__temp_table_for_load_data__
+POSTHOOK: Output: default@srcbucket_mapjoin_n8
 POSTHOOK: Output: default@srcbucket_mapjoin_n8@hr=0
 POSTHOOK: Output: default@srcbucket_mapjoin_n8@hr=1
 POSTHOOK: Lineage: srcbucket_mapjoin_n8 PARTITION(hr=0).ds SIMPLE [(srcbucket_mapjoin_n8__temp_table_for_load_data__)srcbucket_mapjoin_n8__temp_table_for_load_data__.FieldSchema(name:ds, type:string, comment:null), ]
@@ -2875,6 +2891,7 @@ INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat'
 SERDE 'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcbucket_mapjoin_n8__temp_table_for_load_data__
+POSTHOOK: Output: default@srcbucket_mapjoin_n8
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -2953,6 +2970,7 @@ INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat'
 SERDE 'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe'
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcbucket_mapjoin_n8__temp_table_for_load_data__
+POSTHOOK: Output: default@srcbucket_mapjoin_n8
 POSTHOOK: Output: default@srcbucket_mapjoin_n8@ds=2008-04-08
 POSTHOOK: Lineage: srcbucket_mapjoin_n8 PARTITION(ds=2008-04-08).key SIMPLE [(srcbucket_mapjoin_n8__temp_table_for_load_data__)srcbucket_mapjoin_n8__temp_table_for_load_data__.FieldSchema(name:key, type:int, comment:null), ]
 POSTHOOK: Lineage: srcbucket_mapjoin_n8 PARTITION(ds=2008-04-08).value SIMPLE [(srcbucket_mapjoin_n8__temp_table_for_load_data__)srcbucket_mapjoin_n8__temp_table_for_load_data__.FieldSchema(name:value, type:string, comment:null), ]
@@ -3107,6 +3125,7 @@ PREHOOK: Output: default@orc_test_txn
 #### A masked pattern was here ####
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@orc_test_txn__temp_table_for_load_data__
+POSTHOOK: Output: default@orc_test_txn
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -3183,6 +3202,7 @@ PREHOOK: Output: default@orc_test_txn
 #### A masked pattern was here ####
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@orc_test_txn__temp_table_for_load_data__
+POSTHOOK: Output: default@orc_test_txn
 POSTHOOK: Output: default@orc_test_txn@year=2016
 POSTHOOK: Output: default@orc_test_txn@year=2017
 POSTHOOK: Output: default@orc_test_txn@year=2018
diff --git a/ql/src/test/results/clientpositive/llap/load_dyn_part1.q.out b/ql/src/test/results/clientpositive/llap/load_dyn_part1.q.out
index 4eefbbd4fa..bc4400a70e 100644
--- a/ql/src/test/results/clientpositive/llap/load_dyn_part1.q.out
+++ b/ql/src/test/results/clientpositive/llap/load_dyn_part1.q.out
@@ -63,6 +63,7 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
+POSTHOOK: Output: default@nzhang_part1_n0
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-3 depends on stages: Stage-2
@@ -259,6 +260,7 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
+POSTHOOK: Output: default@nzhang_part1_n0
 POSTHOOK: Output: default@nzhang_part1_n0@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@nzhang_part1_n0@ds=2008-04-08/hr=12
 POSTHOOK: Output: default@nzhang_part2_n0@ds=2008-12-31/hr=11
diff --git a/ql/src/test/results/clientpositive/llap/load_dyn_part14.q.out b/ql/src/test/results/clientpositive/llap/load_dyn_part14.q.out
index f662100218..12ba635db9 100644
--- a/ql/src/test/results/clientpositive/llap/load_dyn_part14.q.out
+++ b/ql/src/test/results/clientpositive/llap/load_dyn_part14.q.out
@@ -45,6 +45,7 @@ select key, value from (
 ) T
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
+POSTHOOK: Output: default@nzhang_part14_n0
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -288,6 +289,7 @@ select key, value from (
 ) T
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
+POSTHOOK: Output: default@nzhang_part14_n0
 POSTHOOK: Output: default@nzhang_part14_n0@value= 
 POSTHOOK: Output: default@nzhang_part14_n0@value=__HIVE_DEFAULT_PARTITION__
 POSTHOOK: Lineage: nzhang_part14_n0 PARTITION(value= ).key EXPRESSION []
diff --git a/ql/src/test/results/clientpositive/llap/load_dyn_part15.q.out b/ql/src/test/results/clientpositive/llap/load_dyn_part15.q.out
index 4c9cd6d183..ab0aac69f9 100644
--- a/ql/src/test/results/clientpositive/llap/load_dyn_part15.q.out
+++ b/ql/src/test/results/clientpositive/llap/load_dyn_part15.q.out
@@ -23,6 +23,7 @@ POSTHOOK: query: INSERT OVERWRITE TABLE load_dyn_part15_test PARTITION(part_key)
 SELECT key, part_key FROM src LATERAL VIEW explode(array("1","{2","3]")) myTable AS part_key
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
+POSTHOOK: Output: default@load_dyn_part15_test
 POSTHOOK: Output: default@load_dyn_part15_test@part_key=%7B2
 POSTHOOK: Output: default@load_dyn_part15_test@part_key=1
 POSTHOOK: Output: default@load_dyn_part15_test@part_key=3%5D
diff --git a/ql/src/test/results/clientpositive/llap/load_dyn_part4.q.out b/ql/src/test/results/clientpositive/llap/load_dyn_part4.q.out
index d1bef1252f..c98b1a6c53 100644
--- a/ql/src/test/results/clientpositive/llap/load_dyn_part4.q.out
+++ b/ql/src/test/results/clientpositive/llap/load_dyn_part4.q.out
@@ -60,6 +60,7 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
+POSTHOOK: Output: default@nzhang_part4
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -172,6 +173,7 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
+POSTHOOK: Output: default@nzhang_part4
 POSTHOOK: Output: default@nzhang_part4@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@nzhang_part4@ds=2008-04-08/hr=12
 POSTHOOK: Output: default@nzhang_part4@ds=2008-04-09/hr=11
diff --git a/ql/src/test/results/clientpositive/llap/load_dyn_part5.q.out b/ql/src/test/results/clientpositive/llap/load_dyn_part5.q.out
index 8975270cd2..d1818e6051 100644
--- a/ql/src/test/results/clientpositive/llap/load_dyn_part5.q.out
+++ b/ql/src/test/results/clientpositive/llap/load_dyn_part5.q.out
@@ -29,6 +29,7 @@ POSTHOOK: query: explain
 insert overwrite table nzhang_part5 partition (value) select key, value from src
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
+POSTHOOK: Output: default@nzhang_part5
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -146,6 +147,7 @@ PREHOOK: Output: default@nzhang_part5
 POSTHOOK: query: insert overwrite table nzhang_part5 partition (value) select key, value from src
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
+POSTHOOK: Output: default@nzhang_part5
 POSTHOOK: Output: default@nzhang_part5@value=val_0
 POSTHOOK: Output: default@nzhang_part5@value=val_10
 POSTHOOK: Output: default@nzhang_part5@value=val_100
diff --git a/ql/src/test/results/clientpositive/llap/load_dyn_part8.q.out b/ql/src/test/results/clientpositive/llap/load_dyn_part8.q.out
index f887a68765..3ea3b8cddb 100644
--- a/ql/src/test/results/clientpositive/llap/load_dyn_part8.q.out
+++ b/ql/src/test/results/clientpositive/llap/load_dyn_part8.q.out
@@ -55,6 +55,7 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
+POSTHOOK: Output: default@nzhang_part8_n0
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-3 depends on stages: Stage-2
@@ -520,6 +521,7 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
+POSTHOOK: Output: default@nzhang_part8_n0
 POSTHOOK: Output: default@nzhang_part8_n0@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@nzhang_part8_n0@ds=2008-04-08/hr=12
 POSTHOOK: Output: default@nzhang_part8_n0@ds=2008-12-31/hr=11
diff --git a/ql/src/test/results/clientpositive/llap/load_dyn_part9.q.out b/ql/src/test/results/clientpositive/llap/load_dyn_part9.q.out
index 9208f6abb9..5bed2b47ec 100644
--- a/ql/src/test/results/clientpositive/llap/load_dyn_part9.q.out
+++ b/ql/src/test/results/clientpositive/llap/load_dyn_part9.q.out
@@ -48,6 +48,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcpart
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
+POSTHOOK: Output: default@nzhang_part9
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -158,6 +159,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcpart
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
+POSTHOOK: Output: default@nzhang_part9
 POSTHOOK: Output: default@nzhang_part9@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@nzhang_part9@ds=2008-04-08/hr=12
 POSTHOOK: Lineage: nzhang_part9 PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/llap/lock3.q.out b/ql/src/test/results/clientpositive/llap/lock3.q.out
index 5d5d4badad..a9cfe7f16a 100644
--- a/ql/src/test/results/clientpositive/llap/lock3.q.out
+++ b/ql/src/test/results/clientpositive/llap/lock3.q.out
@@ -39,6 +39,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcpart
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
+POSTHOOK: Output: default@tstsrcpart_n4
 POSTHOOK: Output: default@tstsrcpart_n4@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@tstsrcpart_n4@ds=2008-04-08/hr=12
 POSTHOOK: Lineage: tstsrcpart_n4 PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/llap/lock4.q.out b/ql/src/test/results/clientpositive/llap/lock4.q.out
index 7deb6ee0da..07dfa6bfee 100644
--- a/ql/src/test/results/clientpositive/llap/lock4.q.out
+++ b/ql/src/test/results/clientpositive/llap/lock4.q.out
@@ -39,6 +39,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcpart
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
+POSTHOOK: Output: default@tstsrcpart_n3
 POSTHOOK: Output: default@tstsrcpart_n3@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@tstsrcpart_n3@ds=2008-04-08/hr=12
 POSTHOOK: Lineage: tstsrcpart_n3 PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_create.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_create.q.out
index ff5e27f98d..2a7a250931 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_create.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_create.q.out
@@ -307,6 +307,7 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@acid_cmv_part
+POSTHOOK: Output: default@acid_cmv_part
 POSTHOOK: Output: default@acid_cmv_part@k=0
 POSTHOOK: Output: default@acid_cmv_part@k=10
 POSTHOOK: Output: default@acid_cmv_part@k=100
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_partition_cluster.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_partition_cluster.q.out
index 4d6de9d8f7..831953c5fe 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_partition_cluster.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_partition_cluster.q.out
@@ -27,6 +27,7 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@src_txn
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cluster_mv_1
+POSTHOOK: Output: default@cluster_mv_1
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -172,6 +173,7 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@src_txn
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cluster_mv_1
+POSTHOOK: Output: default@cluster_mv_1
 POSTHOOK: Output: default@cluster_mv_1@partkey=301.0
 POSTHOOK: Output: default@cluster_mv_1@partkey=302.0
 POSTHOOK: Output: default@cluster_mv_1@partkey=303.0
@@ -495,6 +497,7 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@src_txn
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cluster_mv_2
+POSTHOOK: Output: default@cluster_mv_2
 POSTHOOK: Output: default@cluster_mv_2@partkey=301.0
 POSTHOOK: Output: default@cluster_mv_2@partkey=302.0
 POSTHOOK: Output: default@cluster_mv_2@partkey=303.0
@@ -944,6 +947,7 @@ POSTHOOK: query: EXPLAIN
 ALTER MATERIALIZED VIEW cluster_mv_1 REBUILD
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src_txn
+POSTHOOK: Output: default@cluster_mv_1
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -1056,6 +1060,7 @@ PREHOOK: Output: default@cluster_mv_1
 POSTHOOK: query: ALTER MATERIALIZED VIEW cluster_mv_1 REBUILD
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src_txn
+POSTHOOK: Output: default@cluster_mv_1
 POSTHOOK: Output: default@cluster_mv_1@partkey=338.0
 POSTHOOK: Lineage: cluster_mv_1 PARTITION(partkey=338.0).key SIMPLE [(src_txn)src_txn.FieldSchema(name:key, type:string, comment:null), ]
 POSTHOOK: Lineage: cluster_mv_1 PARTITION(partkey=338.0).value SIMPLE [(src_txn)src_txn.FieldSchema(name:value, type:string, comment:null), ]
@@ -1241,6 +1246,7 @@ POSTHOOK: Input: default@src_txn
 POSTHOOK: Input: default@src_txn_2
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cluster_mv_3
+POSTHOOK: Output: default@cluster_mv_3
 POSTHOOK: Output: default@cluster_mv_3@partkey=301.0
 POSTHOOK: Output: default@cluster_mv_3@partkey=302.0
 POSTHOOK: Output: default@cluster_mv_3@partkey=303.0
@@ -1360,6 +1366,7 @@ ALTER MATERIALIZED VIEW cluster_mv_3 REBUILD
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src_txn
 POSTHOOK: Input: default@src_txn_2
+POSTHOOK: Output: default@cluster_mv_3
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -1518,6 +1525,7 @@ POSTHOOK: query: ALTER MATERIALIZED VIEW cluster_mv_3 REBUILD
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src_txn
 POSTHOOK: Input: default@src_txn_2
+POSTHOOK: Output: default@cluster_mv_3
 POSTHOOK: Output: default@cluster_mv_3@partkey=338.0
 POSTHOOK: Lineage: cluster_mv_3 PARTITION(partkey=338.0).key SIMPLE [(src_txn)src_txn.FieldSchema(name:key, type:string, comment:null), ]
 POSTHOOK: Lineage: cluster_mv_3 PARTITION(partkey=338.0).value SIMPLE [(src_txn)src_txn.FieldSchema(name:value, type:string, comment:null), ]
@@ -1614,6 +1622,7 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@src_txn
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@cluster_mv_4
+POSTHOOK: Output: default@cluster_mv_4
 POSTHOOK: Output: default@cluster_mv_4@partkey=301.0
 POSTHOOK: Output: default@cluster_mv_4@partkey=302.0
 POSTHOOK: Output: default@cluster_mv_4@partkey=303.0
@@ -1843,6 +1852,7 @@ ALTER MATERIALIZED VIEW cluster_mv_3 REBUILD
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src_txn
 POSTHOOK: Input: default@src_txn_2
+POSTHOOK: Output: default@cluster_mv_3
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -2016,6 +2026,7 @@ POSTHOOK: query: ALTER MATERIALIZED VIEW cluster_mv_3 REBUILD
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src_txn
 POSTHOOK: Input: default@src_txn_2
+POSTHOOK: Output: default@cluster_mv_3
 POSTHOOK: Output: default@cluster_mv_3@partkey=301.0
 POSTHOOK: Output: default@cluster_mv_3@partkey=302.0
 POSTHOOK: Output: default@cluster_mv_3@partkey=303.0
@@ -2203,6 +2214,7 @@ POSTHOOK: query: EXPLAIN
 ALTER MATERIALIZED VIEW cluster_mv_4 REBUILD
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src_txn
+POSTHOOK: Output: default@cluster_mv_4
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -2330,6 +2342,7 @@ PREHOOK: Output: default@cluster_mv_4
 POSTHOOK: query: ALTER MATERIALIZED VIEW cluster_mv_4 REBUILD
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src_txn
+POSTHOOK: Output: default@cluster_mv_4
 POSTHOOK: Output: default@cluster_mv_4@partkey=301.0
 POSTHOOK: Output: default@cluster_mv_4@partkey=302.0
 POSTHOOK: Output: default@cluster_mv_4@partkey=303.0
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_partitioned.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_partitioned.q.out
index e463b3cba6..8951f00443 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_partitioned.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_partitioned.q.out
@@ -27,6 +27,7 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@src_txn
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@partition_mv_1
+POSTHOOK: Output: default@partition_mv_1
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -170,6 +171,7 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@src_txn
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@partition_mv_1
+POSTHOOK: Output: default@partition_mv_1
 POSTHOOK: Output: default@partition_mv_1@key=201
 POSTHOOK: Output: default@partition_mv_1@key=202
 POSTHOOK: Output: default@partition_mv_1@key=203
@@ -330,6 +332,7 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@src_txn
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@partition_mv_2
+POSTHOOK: Output: default@partition_mv_2
 POSTHOOK: Output: default@partition_mv_2@value=val_201
 POSTHOOK: Output: default@partition_mv_2@value=val_202
 POSTHOOK: Output: default@partition_mv_2@value=val_203
@@ -619,6 +622,7 @@ POSTHOOK: query: EXPLAIN
 ALTER MATERIALIZED VIEW partition_mv_1 REBUILD
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src_txn
+POSTHOOK: Output: default@partition_mv_1
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -746,6 +750,7 @@ PREHOOK: Output: default@partition_mv_1
 POSTHOOK: query: ALTER MATERIALIZED VIEW partition_mv_1 REBUILD
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src_txn
+POSTHOOK: Output: default@partition_mv_1
 POSTHOOK: Output: default@partition_mv_1@key=238
 POSTHOOK: Lineage: partition_mv_1 PARTITION(key=238).value SIMPLE [(src_txn)src_txn.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: SELECT * FROM partition_mv_1 where key = 238
@@ -868,6 +873,7 @@ POSTHOOK: Input: default@src_txn
 POSTHOOK: Input: default@src_txn_2
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@partition_mv_3
+POSTHOOK: Output: default@partition_mv_3
 POSTHOOK: Output: default@partition_mv_3@key=201
 POSTHOOK: Output: default@partition_mv_3@key=202
 POSTHOOK: Output: default@partition_mv_3@key=203
@@ -953,6 +959,7 @@ ALTER MATERIALIZED VIEW partition_mv_3 REBUILD
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src_txn
 POSTHOOK: Input: default@src_txn_2
+POSTHOOK: Output: default@partition_mv_3
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -1126,6 +1133,7 @@ POSTHOOK: query: ALTER MATERIALIZED VIEW partition_mv_3 REBUILD
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src_txn
 POSTHOOK: Input: default@src_txn_2
+POSTHOOK: Output: default@partition_mv_3
 POSTHOOK: Output: default@partition_mv_3@key=238
 POSTHOOK: Lineage: partition_mv_3 PARTITION(key=238).value SIMPLE [(src_txn)src_txn.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: SELECT * FROM partition_mv_3 where key = 238
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_partitioned_2.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_partitioned_2.q.out
index 6726c1e9d0..d8d6634798 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_partitioned_2.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_partitioned_2.q.out
@@ -25,6 +25,7 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@src_txn_2
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@partition_mv_1
+POSTHOOK: Output: default@partition_mv_1
 POSTHOOK: Output: default@partition_mv_1@key=201
 POSTHOOK: Output: default@partition_mv_1@key=202
 POSTHOOK: Output: default@partition_mv_1@key=203
@@ -162,6 +163,7 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@src_txn_2
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@partition_mv_2
+POSTHOOK: Output: default@partition_mv_2
 POSTHOOK: Output: default@partition_mv_2@value=val_201
 POSTHOOK: Output: default@partition_mv_2@value=val_202
 POSTHOOK: Output: default@partition_mv_2@value=val_203
@@ -299,6 +301,7 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@src_txn_2
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@partition_mv_3
+POSTHOOK: Output: default@partition_mv_3
 POSTHOOK: Output: default@partition_mv_3@key=221
 POSTHOOK: Output: default@partition_mv_3@key=222
 POSTHOOK: Output: default@partition_mv_3@key=223
@@ -326,6 +329,7 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@src_txn_2
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@partition_mv_4
+POSTHOOK: Output: default@partition_mv_4
 POSTHOOK: Output: default@partition_mv_4@key=223
 POSTHOOK: Output: default@partition_mv_4@key=224
 POSTHOOK: Output: default@partition_mv_4@key=226
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_partitioned_3.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_partitioned_3.q.out
index 8bdbf13d8a..65c52bef44 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_partitioned_3.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_partitioned_3.q.out
@@ -27,6 +27,7 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@src_txn
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@partition_mv_sdp
+POSTHOOK: Output: default@partition_mv_sdp
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_no_join_opt_2.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_no_join_opt_2.q.out
index 0796cd3174..fbd1736971 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_no_join_opt_2.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_no_join_opt_2.q.out
@@ -145,6 +145,7 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@emps_n30
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_part_n2
+POSTHOOK: Output: default@mv1_part_n2
 POSTHOOK: Output: default@mv1_part_n2@deptno=10
 POSTHOOK: Lineage: mv1_part_n2 PARTITION(deptno=10).commission SIMPLE [(emps_n30)emps_n30.FieldSchema(name:commission, type:int, comment:null), ]
 POSTHOOK: Lineage: mv1_part_n2 PARTITION(deptno=10).empid SIMPLE [(emps_n30)emps_n30.FieldSchema(name:empid, type:int, comment:null), ]
@@ -310,6 +311,7 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@emps_n30
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_part_n2
+POSTHOOK: Output: default@mv1_part_n2
 POSTHOOK: Output: default@mv1_part_n2@deptno=10
 POSTHOOK: Output: default@mv1_part_n2@deptno=20
 POSTHOOK: Lineage: mv1_part_n2 PARTITION(deptno=10).commission SIMPLE [(emps_n30)emps_n30.FieldSchema(name:commission, type:int, comment:null), ]
@@ -475,6 +477,7 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@emps_n30
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_part_n2
+POSTHOOK: Output: default@mv1_part_n2
 POSTHOOK: Output: default@mv1_part_n2@deptno=10
 POSTHOOK: Lineage: mv1_part_n2 PARTITION(deptno=10).commission SIMPLE [(emps_n30)emps_n30.FieldSchema(name:commission, type:int, comment:null), ]
 POSTHOOK: Lineage: mv1_part_n2 PARTITION(deptno=10).empid SIMPLE [(emps_n30)emps_n30.FieldSchema(name:empid, type:int, comment:null), ]
@@ -602,6 +605,7 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@emps_n30
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_part_n2
+POSTHOOK: Output: default@mv1_part_n2
 POSTHOOK: Output: default@mv1_part_n2@name=Bill
 POSTHOOK: Output: default@mv1_part_n2@name=Eric
 POSTHOOK: Output: default@mv1_part_n2@name=Sebastian
@@ -688,6 +692,7 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@emps_n30
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_part_n2
+POSTHOOK: Output: default@mv1_part_n2
 POSTHOOK: Output: default@mv1_part_n2@name=Bill
 POSTHOOK: Output: default@mv1_part_n2@name=Eric
 POSTHOOK: Output: default@mv1_part_n2@name=Sebastian
@@ -816,6 +821,7 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@emps_n30
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_part_n2
+POSTHOOK: Output: default@mv1_part_n2
 POSTHOOK: Output: default@mv1_part_n2@name=Bill
 POSTHOOK: Output: default@mv1_part_n2@name=Sebastian
 POSTHOOK: Output: default@mv1_part_n2@name=Theodore
@@ -939,6 +945,7 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@emps_n30
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_part_n2
+POSTHOOK: Output: default@mv1_part_n2
 POSTHOOK: Output: default@mv1_part_n2@name=Bill
 POSTHOOK: Output: default@mv1_part_n2@name=Eric
 POSTHOOK: Output: default@mv1_part_n2@name=Sebastian
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_part_1.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_part_1.q.out
index 3f19853e67..3dce0c5661 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_part_1.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_part_1.q.out
@@ -145,6 +145,7 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@emps_n30
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_part_n2
+POSTHOOK: Output: default@mv1_part_n2
 POSTHOOK: Output: default@mv1_part_n2@deptno=10
 POSTHOOK: Lineage: mv1_part_n2 PARTITION(deptno=10).commission SIMPLE [(emps_n30)emps_n30.FieldSchema(name:commission, type:int, comment:null), ]
 POSTHOOK: Lineage: mv1_part_n2 PARTITION(deptno=10).empid SIMPLE [(emps_n30)emps_n30.FieldSchema(name:empid, type:int, comment:null), ]
@@ -310,6 +311,7 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@emps_n30
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_part_n2
+POSTHOOK: Output: default@mv1_part_n2
 POSTHOOK: Output: default@mv1_part_n2@deptno=10
 POSTHOOK: Output: default@mv1_part_n2@deptno=20
 POSTHOOK: Lineage: mv1_part_n2 PARTITION(deptno=10).commission SIMPLE [(emps_n30)emps_n30.FieldSchema(name:commission, type:int, comment:null), ]
@@ -402,6 +404,7 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@emps_n30
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_part_n2
+POSTHOOK: Output: default@mv1_part_n2
 POSTHOOK: Output: default@mv1_part_n2@deptno=10
 POSTHOOK: Lineage: mv1_part_n2 PARTITION(deptno=10).commission SIMPLE [(emps_n30)emps_n30.FieldSchema(name:commission, type:int, comment:null), ]
 POSTHOOK: Lineage: mv1_part_n2 PARTITION(deptno=10).empid SIMPLE [(emps_n30)emps_n30.FieldSchema(name:empid, type:int, comment:null), ]
@@ -529,6 +532,7 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@emps_n30
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_part_n2
+POSTHOOK: Output: default@mv1_part_n2
 POSTHOOK: Output: default@mv1_part_n2@name=Bill
 POSTHOOK: Output: default@mv1_part_n2@name=Eric
 POSTHOOK: Output: default@mv1_part_n2@name=Sebastian
@@ -615,6 +619,7 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@emps_n30
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_part_n2
+POSTHOOK: Output: default@mv1_part_n2
 POSTHOOK: Output: default@mv1_part_n2@name=Bill
 POSTHOOK: Output: default@mv1_part_n2@name=Eric
 POSTHOOK: Output: default@mv1_part_n2@name=Sebastian
@@ -743,6 +748,7 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@emps_n30
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_part_n2
+POSTHOOK: Output: default@mv1_part_n2
 POSTHOOK: Output: default@mv1_part_n2@name=Bill
 POSTHOOK: Output: default@mv1_part_n2@name=Sebastian
 POSTHOOK: Output: default@mv1_part_n2@name=Theodore
@@ -866,6 +872,7 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@emps_n30
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_part_n2
+POSTHOOK: Output: default@mv1_part_n2
 POSTHOOK: Output: default@mv1_part_n2@name=Bill
 POSTHOOK: Output: default@mv1_part_n2@name=Eric
 POSTHOOK: Output: default@mv1_part_n2@name=Sebastian
diff --git a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_part_2.q.out b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_part_2.q.out
index e4d5e225ad..70a34255dd 100644
--- a/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_part_2.q.out
+++ b/ql/src/test/results/clientpositive/llap/materialized_view_rewrite_part_2.q.out
@@ -151,6 +151,7 @@ POSTHOOK: Input: default@depts_n00
 POSTHOOK: Input: default@emps_n00
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_part_n0
+POSTHOOK: Output: default@mv1_part_n0
 POSTHOOK: Output: default@mv1_part_n0@deptno=20
 POSTHOOK: Lineage: mv1_part_n0 PARTITION(deptno=20).empid SIMPLE [(emps_n00)emps_n00.FieldSchema(name:empid, type:int, comment:null), ]
 PREHOOK: query: explain
@@ -235,6 +236,7 @@ POSTHOOK: Input: default@depts_n00
 POSTHOOK: Input: default@emps_n00
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_part_n0
+POSTHOOK: Output: default@mv1_part_n0
 POSTHOOK: Output: default@mv1_part_n0@deptno=20
 POSTHOOK: Lineage: mv1_part_n0 PARTITION(deptno=20).empid SIMPLE [(emps_n00)emps_n00.FieldSchema(name:empid, type:int, comment:null), ]
 PREHOOK: query: explain
@@ -319,6 +321,7 @@ POSTHOOK: Input: default@depts_n00
 POSTHOOK: Input: default@emps_n00
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_part_n0
+POSTHOOK: Output: default@mv1_part_n0
 POSTHOOK: Output: default@mv1_part_n0@deptno=20
 POSTHOOK: Lineage: mv1_part_n0 PARTITION(deptno=20).empid SIMPLE [(emps_n00)emps_n00.FieldSchema(name:empid, type:int, comment:null), ]
 PREHOOK: query: explain
@@ -403,6 +406,7 @@ POSTHOOK: Input: default@depts_n00
 POSTHOOK: Input: default@emps_n00
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_part_n0
+POSTHOOK: Output: default@mv1_part_n0
 POSTHOOK: Output: default@mv1_part_n0@deptno=10
 POSTHOOK: Output: default@mv1_part_n0@deptno=20
 POSTHOOK: Lineage: mv1_part_n0 PARTITION(deptno=10).empid SIMPLE [(emps_n00)emps_n00.FieldSchema(name:empid, type:int, comment:null), ]
@@ -499,6 +503,7 @@ POSTHOOK: Input: default@depts_n00
 POSTHOOK: Input: default@emps_n00
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_part_n0
+POSTHOOK: Output: default@mv1_part_n0
 POSTHOOK: Output: default@mv1_part_n0@deptno=10
 POSTHOOK: Output: default@mv1_part_n0@deptno=20
 POSTHOOK: Lineage: mv1_part_n0 PARTITION(deptno=10).empid SIMPLE [(emps_n00)emps_n00.FieldSchema(name:empid, type:int, comment:null), ]
@@ -692,6 +697,7 @@ POSTHOOK: Input: default@depts_n00
 POSTHOOK: Input: default@emps_n00
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv1_part_n0
+POSTHOOK: Output: default@mv1_part_n0
 POSTHOOK: Output: default@mv1_part_n0@deptno2=20
 POSTHOOK: Output: default@mv1_part_n0@deptno2=30
 POSTHOOK: Lineage: mv1_part_n0 PARTITION(deptno2=20).deptno SIMPLE [(emps_n00)emps_n00.FieldSchema(name:deptno, type:int, comment:null), ]
diff --git a/ql/src/test/results/clientpositive/llap/merge3.q.out b/ql/src/test/results/clientpositive/llap/merge3.q.out
index a4f15ff8a1..a8073b261e 100644
--- a/ql/src/test/results/clientpositive/llap/merge3.q.out
+++ b/ql/src/test/results/clientpositive/llap/merge3.q.out
@@ -43,6 +43,7 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
+POSTHOOK: Output: default@merge_src_part
 POSTHOOK: Output: default@merge_src_part@ds=2008-04-08
 POSTHOOK: Output: default@merge_src_part@ds=2008-04-09
 POSTHOOK: Lineage: merge_src_part PARTITION(ds=2008-04-08).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -2318,6 +2319,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@merge_src_part
 POSTHOOK: Input: default@merge_src_part@ds=2008-04-08
 POSTHOOK: Input: default@merge_src_part@ds=2008-04-09
+POSTHOOK: Output: default@merge_src_part2
 OPTIMIZED SQL: SELECT `key`, `value`, `ds`
 FROM `default`.`merge_src_part`
 WHERE `ds` IS NOT NULL
@@ -2568,6 +2570,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@merge_src_part
 POSTHOOK: Input: default@merge_src_part@ds=2008-04-08
 POSTHOOK: Input: default@merge_src_part@ds=2008-04-09
+POSTHOOK: Output: default@merge_src_part2
 POSTHOOK: Output: default@merge_src_part2@ds=2008-04-08
 POSTHOOK: Output: default@merge_src_part2@ds=2008-04-09
 POSTHOOK: Lineage: merge_src_part2 PARTITION(ds=2008-04-08).key SIMPLE [(merge_src_part)merge_src_part.FieldSchema(name:key, type:string, comment:null), ]
@@ -4627,6 +4630,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@merge_src_part
 POSTHOOK: Input: default@merge_src_part@ds=2008-04-08
 POSTHOOK: Input: default@merge_src_part@ds=2008-04-09
+POSTHOOK: Output: default@merge_src_part2
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -4871,6 +4875,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@merge_src_part
 POSTHOOK: Input: default@merge_src_part@ds=2008-04-08
 POSTHOOK: Input: default@merge_src_part@ds=2008-04-09
+POSTHOOK: Output: default@merge_src_part2
 POSTHOOK: Output: default@merge_src_part2@ds=2008-04-08
 POSTHOOK: Output: default@merge_src_part2@ds=2008-04-09
 POSTHOOK: Lineage: merge_src_part2 PARTITION(ds=2008-04-08).key SIMPLE [(merge_src_part)merge_src_part.FieldSchema(name:key, type:string, comment:null), ]
diff --git a/ql/src/test/results/clientpositive/llap/merge_dynamic_partition.q.out b/ql/src/test/results/clientpositive/llap/merge_dynamic_partition.q.out
index 6044d9154f..a9ceb75077 100644
--- a/ql/src/test/results/clientpositive/llap/merge_dynamic_partition.q.out
+++ b/ql/src/test/results/clientpositive/llap/merge_dynamic_partition.q.out
@@ -1368,6 +1368,7 @@ insert overwrite table merge_dynamic_part_n1 partition (ds, hr) select key, valu
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcpart_merge_dp_n1
 POSTHOOK: Input: default@srcpart_merge_dp_n1@ds=2008-04-08/hr=11
+POSTHOOK: Output: default@merge_dynamic_part_n1
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -1489,6 +1490,7 @@ POSTHOOK: query: insert overwrite table merge_dynamic_part_n1 partition (ds, hr)
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcpart_merge_dp_n1
 POSTHOOK: Input: default@srcpart_merge_dp_n1@ds=2008-04-08/hr=11
+POSTHOOK: Output: default@merge_dynamic_part_n1
 POSTHOOK: Output: default@merge_dynamic_part_n1@ds=2008-04-08/hr=11
 POSTHOOK: Lineage: merge_dynamic_part_n1 PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart_merge_dp_n1)srcpart_merge_dp_n1.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: merge_dynamic_part_n1 PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart_merge_dp_n1)srcpart_merge_dp_n1.FieldSchema(name:value, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/llap/merge_dynamic_partition3.q.out b/ql/src/test/results/clientpositive/llap/merge_dynamic_partition3.q.out
index 4970d781ca..1ce182e6ac 100644
--- a/ql/src/test/results/clientpositive/llap/merge_dynamic_partition3.q.out
+++ b/ql/src/test/results/clientpositive/llap/merge_dynamic_partition3.q.out
@@ -141,6 +141,7 @@ POSTHOOK: Input: default@srcpart_merge_dp_n2@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart_merge_dp_n2@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart_merge_dp_n2@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart_merge_dp_n2@ds=2008-04-09/hr=12
+POSTHOOK: Output: default@merge_dynamic_part_n2
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -268,6 +269,7 @@ POSTHOOK: Input: default@srcpart_merge_dp_n2@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart_merge_dp_n2@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart_merge_dp_n2@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart_merge_dp_n2@ds=2008-04-09/hr=12
+POSTHOOK: Output: default@merge_dynamic_part_n2
 POSTHOOK: Output: default@merge_dynamic_part_n2@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@merge_dynamic_part_n2@ds=2008-04-08/hr=12
 POSTHOOK: Output: default@merge_dynamic_part_n2@ds=2008-04-09/hr=11
diff --git a/ql/src/test/results/clientpositive/llap/mi.q.out b/ql/src/test/results/clientpositive/llap/mi.q.out
index 585a7be318..cb17a89281 100644
--- a/ql/src/test/results/clientpositive/llap/mi.q.out
+++ b/ql/src/test/results/clientpositive/llap/mi.q.out
@@ -40,7 +40,9 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcpart
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
+POSTHOOK: Output: default@nzhang_t1
 POSTHOOK: Output: default@nzhang_t1@ds=2008-04-08/hr=11
+POSTHOOK: Output: default@nzhang_t2
 POSTHOOK: Output: default@nzhang_t2@ds=2008-04-08/hr=12
 POSTHOOK: Lineage: nzhang_t1 PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: nzhang_t1 PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/llap/mm_all.q.out b/ql/src/test/results/clientpositive/llap/mm_all.q.out
index ab4f308a8b..576f3ac902 100644
--- a/ql/src/test/results/clientpositive/llap/mm_all.q.out
+++ b/ql/src/test/results/clientpositive/llap/mm_all.q.out
@@ -718,6 +718,7 @@ POSTHOOK: Input: default@intermediate_n0
 POSTHOOK: Input: default@intermediate_n0@p=455
 POSTHOOK: Input: default@intermediate_n0@p=456
 POSTHOOK: Input: default@intermediate_n0@p=457
+POSTHOOK: Output: default@partunion_mm
 POSTHOOK: Output: default@partunion_mm@key=0
 POSTHOOK: Output: default@partunion_mm@key=1
 POSTHOOK: Output: default@partunion_mm@key=10
@@ -870,6 +871,7 @@ POSTHOOK: Input: default@intermediate_n0
 POSTHOOK: Input: default@intermediate_n0@p=455
 POSTHOOK: Input: default@intermediate_n0@p=456
 POSTHOOK: Input: default@intermediate_n0@p=457
+POSTHOOK: Output: default@skew_dp_union_mm
 POSTHOOK: Output: default@skew_dp_union_mm@k3=0
 POSTHOOK: Output: default@skew_dp_union_mm@k3=10
 POSTHOOK: Output: default@skew_dp_union_mm@k3=100
@@ -1151,6 +1153,7 @@ POSTHOOK: Input: default@intermediate_n0
 POSTHOOK: Input: default@intermediate_n0@p=455
 POSTHOOK: Input: default@intermediate_n0@p=456
 POSTHOOK: Input: default@intermediate_n0@p=457
+POSTHOOK: Output: default@merge1_mm
 POSTHOOK: Output: default@merge1_mm@key=0
 POSTHOOK: Output: default@merge1_mm@key=10
 POSTHOOK: Output: default@merge1_mm@key=100
@@ -1202,6 +1205,7 @@ POSTHOOK: Input: default@intermediate_n0
 POSTHOOK: Input: default@intermediate_n0@p=455
 POSTHOOK: Input: default@intermediate_n0@p=456
 POSTHOOK: Input: default@intermediate_n0@p=457
+POSTHOOK: Output: default@merge1_mm
 POSTHOOK: Output: default@merge1_mm@key=0
 POSTHOOK: Output: default@merge1_mm@key=10
 POSTHOOK: Output: default@merge1_mm@key=100
@@ -1632,6 +1636,7 @@ POSTHOOK: Input: default@intermediate_n0
 POSTHOOK: Input: default@intermediate_n0@p=455
 POSTHOOK: Input: default@intermediate_n0@p=456
 POSTHOOK: Input: default@intermediate_n0@p=457
+POSTHOOK: Output: default@multi1_mm
 POSTHOOK: Output: default@multi1_mm@p=1
 POSTHOOK: Output: default@multi1_mm@p=2
 POSTHOOK: Output: default@multi1_mm@p=455
@@ -1715,6 +1720,7 @@ POSTHOOK: Input: default@intermediate_n0
 POSTHOOK: Input: default@intermediate_n0@p=455
 POSTHOOK: Input: default@intermediate_n0@p=456
 POSTHOOK: Input: default@intermediate_n0@p=457
+POSTHOOK: Output: default@multi1_mm
 POSTHOOK: Output: default@multi1_mm@p=1
 POSTHOOK: Output: default@multi1_mm@p=2
 POSTHOOK: Output: default@multi1_mm@p=455
diff --git a/ql/src/test/results/clientpositive/llap/mm_buckets.q.out b/ql/src/test/results/clientpositive/llap/mm_buckets.q.out
index d5e33ffbc5..f7830b14f2 100644
--- a/ql/src/test/results/clientpositive/llap/mm_buckets.q.out
+++ b/ql/src/test/results/clientpositive/llap/mm_buckets.q.out
@@ -212,6 +212,7 @@ POSTHOOK: Input: default@intermediate_n2
 POSTHOOK: Input: default@intermediate_n2@p=455
 POSTHOOK: Input: default@intermediate_n2@p=456
 POSTHOOK: Input: default@intermediate_n2@p=457
+POSTHOOK: Output: default@bucket1_mm
 POSTHOOK: Output: default@bucket1_mm@key2=-1
 POSTHOOK: Output: default@bucket1_mm@key2=1
 POSTHOOK: Output: default@bucket1_mm@key2=101
diff --git a/ql/src/test/results/clientpositive/llap/mm_dp.q.out b/ql/src/test/results/clientpositive/llap/mm_dp.q.out
index 212007700a..ff1987a2a0 100644
--- a/ql/src/test/results/clientpositive/llap/mm_dp.q.out
+++ b/ql/src/test/results/clientpositive/llap/mm_dp.q.out
@@ -122,6 +122,7 @@ POSTHOOK: Input: default@intermediate_n0@p=456
 POSTHOOK: Input: default@intermediate_n0@p=457
 POSTHOOK: Input: default@intermediate_n0@p=458
 POSTHOOK: Input: default@intermediate_n0@p=459
+POSTHOOK: Output: default@dp_mm
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -213,6 +214,7 @@ POSTHOOK: Input: default@intermediate_n0@p=456
 POSTHOOK: Input: default@intermediate_n0@p=457
 POSTHOOK: Input: default@intermediate_n0@p=458
 POSTHOOK: Input: default@intermediate_n0@p=459
+POSTHOOK: Output: default@dp_mm
 POSTHOOK: Output: default@dp_mm@val=val_0
 POSTHOOK: Output: default@dp_mm@val=val_10
 POSTHOOK: Output: default@dp_mm@val=val_100
diff --git a/ql/src/test/results/clientpositive/llap/mm_exim.q.out b/ql/src/test/results/clientpositive/llap/mm_exim.q.out
index b66099d44d..191c5bb809 100644
--- a/ql/src/test/results/clientpositive/llap/mm_exim.q.out
+++ b/ql/src/test/results/clientpositive/llap/mm_exim.q.out
@@ -118,6 +118,7 @@ POSTHOOK: Input: default@intermediate_n4
 POSTHOOK: Input: default@intermediate_n4@p=455
 POSTHOOK: Input: default@intermediate_n4@p=456
 POSTHOOK: Input: default@intermediate_n4@p=457
+POSTHOOK: Output: default@intermmediate
 POSTHOOK: Output: default@intermmediate@p=455
 POSTHOOK: Output: default@intermmediate@p=456
 POSTHOOK: Output: default@intermmediate@p=457
diff --git a/ql/src/test/results/clientpositive/llap/murmur_hash_migration2.q.out b/ql/src/test/results/clientpositive/llap/murmur_hash_migration2.q.out
index b1a419fe46..02acbc0f60 100644
--- a/ql/src/test/results/clientpositive/llap/murmur_hash_migration2.q.out
+++ b/ql/src/test/results/clientpositive/llap/murmur_hash_migration2.q.out
@@ -17,6 +17,7 @@ PREHOOK: Output: default@acid_ptn_bucket1
 POSTHOOK: query: explain extended insert into acid_ptn_bucket1 partition (ds) values(1,2,'today'),(1,3,'today'),(1,4,'yesterday'),(2,2,'yesterday'),(2,3,'today'),(2,4,'today')
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@acid_ptn_bucket1
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -184,6 +185,7 @@ PREHOOK: Output: default@acid_ptn_bucket1
 POSTHOOK: query: insert into acid_ptn_bucket1 partition (ds) values(1,2,'today'),(1,3,'today'),(1,4,'yesterday'),(2,2,'yesterday'),(2,3,'today'),(2,4,'today')
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@acid_ptn_bucket1
 POSTHOOK: Output: default@acid_ptn_bucket1@ds=today
 POSTHOOK: Output: default@acid_ptn_bucket1@ds=yesterday
 POSTHOOK: Lineage: acid_ptn_bucket1 PARTITION(ds=today).a SCRIPT []
@@ -205,6 +207,7 @@ PREHOOK: Output: default@acid_ptn_bucket1
 POSTHOOK: query: insert into acid_ptn_bucket1 partition (ds) values(3,2,1000,'yesterday'),(3,3,1001,'today'),(3,4,1002,'yesterday'),(4,2,1003,'today'), (4,3,1004,'yesterday'),(4,4,1005,'today')
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@acid_ptn_bucket1
 POSTHOOK: Output: default@acid_ptn_bucket1@ds=today
 POSTHOOK: Output: default@acid_ptn_bucket1@ds=yesterday
 POSTHOOK: Lineage: acid_ptn_bucket1 PARTITION(ds=today).a SCRIPT []
diff --git a/ql/src/test/results/clientpositive/llap/nested_column_pruning.q.out b/ql/src/test/results/clientpositive/llap/nested_column_pruning.q.out
index f064a5379b..7ad50dbafb 100644
--- a/ql/src/test/results/clientpositive/llap/nested_column_pruning.q.out
+++ b/ql/src/test/results/clientpositive/llap/nested_column_pruning.q.out
@@ -1637,6 +1637,7 @@ SELECT s1.f1 AS f1, S1.f2 AS f2, s1.f6 AS f3
 FROM nested_tbl_1_n1
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@nested_tbl_1_n1
+POSTHOOK: Output: default@nested_tbl_3_n1
 POSTHOOK: Output: default@nested_tbl_3_n1@f3=4
 POSTHOOK: Lineage: nested_tbl_3_n1 PARTITION(f3=4).f1 EXPRESSION [(nested_tbl_1_n1)nested_tbl_1_n1.FieldSchema(name:s1, type:struct<f1:boolean,f2:string,f3:struct<f4:int,f5:double>,f6:int>, comment:null), ]
 POSTHOOK: Lineage: nested_tbl_3_n1 PARTITION(f3=4).f2 EXPRESSION [(nested_tbl_1_n1)nested_tbl_1_n1.FieldSchema(name:s1, type:struct<f1:boolean,f2:string,f3:struct<f4:int,f5:double>,f6:int>, comment:null), ]
diff --git a/ql/src/test/results/clientpositive/llap/orc_analyze.q.out b/ql/src/test/results/clientpositive/llap/orc_analyze.q.out
index 804f7ed590..f9d11ba8d0 100644
--- a/ql/src/test/results/clientpositive/llap/orc_analyze.q.out
+++ b/ql/src/test/results/clientpositive/llap/orc_analyze.q.out
@@ -291,6 +291,7 @@ POSTHOOK: query: INSERT OVERWRITE TABLE orc_create_people_n0 PARTITION (state)
   SELECT * FROM orc_create_people_staging_n0 ORDER BY id
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@orc_create_people_staging_n0
+POSTHOOK: Output: default@orc_create_people_n0
 POSTHOOK: Output: default@orc_create_people_n0@state=Ca
 POSTHOOK: Output: default@orc_create_people_n0@state=Or
 POSTHOOK: Lineage: orc_create_people_n0 PARTITION(state=Ca).address SIMPLE [(orc_create_people_staging_n0)orc_create_people_staging_n0.FieldSchema(name:address, type:string, comment:null), ]
@@ -534,6 +535,7 @@ POSTHOOK: query: INSERT OVERWRITE TABLE orc_create_people_n0 PARTITION (state)
   SELECT * FROM orc_create_people_staging_n0 ORDER BY id
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@orc_create_people_staging_n0
+POSTHOOK: Output: default@orc_create_people_n0
 POSTHOOK: Output: default@orc_create_people_n0@state=Ca
 POSTHOOK: Output: default@orc_create_people_n0@state=Or
 POSTHOOK: Lineage: orc_create_people_n0 PARTITION(state=Ca).address SIMPLE [(orc_create_people_staging_n0)orc_create_people_staging_n0.FieldSchema(name:address, type:string, comment:null), ]
@@ -677,6 +679,7 @@ POSTHOOK: query: INSERT OVERWRITE TABLE orc_create_people_n0 PARTITION (state)
   SELECT * FROM orc_create_people_staging_n0 ORDER BY id
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@orc_create_people_staging_n0
+POSTHOOK: Output: default@orc_create_people_n0
 POSTHOOK: Output: default@orc_create_people_n0@state=Ca
 POSTHOOK: Output: default@orc_create_people_n0@state=Or
 POSTHOOK: Lineage: orc_create_people_n0 PARTITION(state=Ca).address SIMPLE [(orc_create_people_staging_n0)orc_create_people_staging_n0.FieldSchema(name:address, type:string, comment:null), ]
@@ -926,6 +929,7 @@ POSTHOOK: query: INSERT OVERWRITE TABLE orc_create_people_n0 PARTITION (state)
   SELECT * FROM orc_create_people_staging_n0 ORDER BY id
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@orc_create_people_staging_n0
+POSTHOOK: Output: default@orc_create_people_n0
 POSTHOOK: Output: default@orc_create_people_n0@state=Ca
 POSTHOOK: Output: default@orc_create_people_n0@state=Or
 POSTHOOK: Lineage: orc_create_people_n0 PARTITION(state=Ca).address SIMPLE [(orc_create_people_staging_n0)orc_create_people_staging_n0.FieldSchema(name:address, type:string, comment:null), ]
@@ -1063,6 +1067,7 @@ POSTHOOK: query: INSERT OVERWRITE TABLE orc_create_people_n0 PARTITION (state)
   SELECT * FROM orc_create_people_staging_n0 ORDER BY id
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@orc_create_people_staging_n0
+POSTHOOK: Output: default@orc_create_people_n0
 POSTHOOK: Output: default@orc_create_people_n0@state=Ca
 POSTHOOK: Output: default@orc_create_people_n0@state=Or
 POSTHOOK: Lineage: orc_create_people_n0 PARTITION(state=Ca).address SIMPLE [(orc_create_people_staging_n0)orc_create_people_staging_n0.FieldSchema(name:address, type:string, comment:null), ]
diff --git a/ql/src/test/results/clientpositive/llap/orc_create.q.out b/ql/src/test/results/clientpositive/llap/orc_create.q.out
index 423e51ce00..518bf174e7 100644
--- a/ql/src/test/results/clientpositive/llap/orc_create.q.out
+++ b/ql/src/test/results/clientpositive/llap/orc_create.q.out
@@ -509,6 +509,7 @@ POSTHOOK: query: INSERT OVERWRITE TABLE orc_create_people PARTITION (state)
   SELECT * FROM orc_create_people_staging
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@orc_create_people_staging
+POSTHOOK: Output: default@orc_create_people
 POSTHOOK: Output: default@orc_create_people@state=Ca
 POSTHOOK: Output: default@orc_create_people@state=Or
 POSTHOOK: Lineage: orc_create_people PARTITION(state=Ca).address SIMPLE [(orc_create_people_staging)orc_create_people_staging.FieldSchema(name:address, type:string, comment:null), ]
diff --git a/ql/src/test/results/clientpositive/llap/orc_int_type_promotion.q.out b/ql/src/test/results/clientpositive/llap/orc_int_type_promotion.q.out
index cdfb44ad4a..399379ce61 100644
--- a/ql/src/test/results/clientpositive/llap/orc_int_type_promotion.q.out
+++ b/ql/src/test/results/clientpositive/llap/orc_int_type_promotion.q.out
@@ -247,6 +247,7 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
+POSTHOOK: Output: default@src_part_orc
 POSTHOOK: Output: default@src_part_orc@ds=2008-04-08
 POSTHOOK: Output: default@src_part_orc@ds=2008-04-09
 POSTHOOK: Lineage: src_part_orc PARTITION(ds=2008-04-08).key EXPRESSION [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/llap/orc_merge7.q.out b/ql/src/test/results/clientpositive/llap/orc_merge7.q.out
index 87921d386d..cf819b6e06 100644
--- a/ql/src/test/results/clientpositive/llap/orc_merge7.q.out
+++ b/ql/src/test/results/clientpositive/llap/orc_merge7.q.out
@@ -29,6 +29,7 @@ PREHOOK: Output: default@orc_merge5a_n0
 POSTHOOK: query: explain insert overwrite table orc_merge5a_n0 partition (st) select userid,string1,subtype,decimal1,ts,subtype from orc_merge5_n2
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@orc_merge5_n2
+POSTHOOK: Output: default@orc_merge5a_n0
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -146,6 +147,7 @@ PREHOOK: Output: default@orc_merge5a_n0
 POSTHOOK: query: insert overwrite table orc_merge5a_n0 partition (st) select userid,string1,subtype,decimal1,ts,subtype from orc_merge5_n2
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@orc_merge5_n2
+POSTHOOK: Output: default@orc_merge5a_n0
 POSTHOOK: Output: default@orc_merge5a_n0@st=0.8
 POSTHOOK: Output: default@orc_merge5a_n0@st=1.8
 POSTHOOK: Output: default@orc_merge5a_n0@st=8.0
@@ -177,6 +179,7 @@ PREHOOK: Output: default@orc_merge5a_n0
 POSTHOOK: query: insert overwrite table orc_merge5a_n0 partition (st) select userid,string1,subtype,decimal1,ts,subtype from orc_merge5_n2
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@orc_merge5_n2
+POSTHOOK: Output: default@orc_merge5a_n0
 POSTHOOK: Output: default@orc_merge5a_n0@st=0.8
 POSTHOOK: Output: default@orc_merge5a_n0@st=1.8
 POSTHOOK: Output: default@orc_merge5a_n0@st=8.0
@@ -261,6 +264,7 @@ PREHOOK: Output: default@orc_merge5a_n0
 POSTHOOK: query: explain insert overwrite table orc_merge5a_n0 partition (st) select userid,string1,subtype,decimal1,ts,subtype from orc_merge5_n2
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@orc_merge5_n2
+POSTHOOK: Output: default@orc_merge5a_n0
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-8 depends on stages: Stage-1 , consists of Stage-5, Stage-4, Stage-6
@@ -420,6 +424,7 @@ PREHOOK: Output: default@orc_merge5a_n0
 POSTHOOK: query: insert overwrite table orc_merge5a_n0 partition (st) select userid,string1,subtype,decimal1,ts,subtype from orc_merge5_n2
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@orc_merge5_n2
+POSTHOOK: Output: default@orc_merge5a_n0
 POSTHOOK: Output: default@orc_merge5a_n0@st=0.8
 POSTHOOK: Output: default@orc_merge5a_n0@st=1.8
 POSTHOOK: Output: default@orc_merge5a_n0@st=8.0
@@ -451,6 +456,7 @@ PREHOOK: Output: default@orc_merge5a_n0
 POSTHOOK: query: insert overwrite table orc_merge5a_n0 partition (st) select userid,string1,subtype,decimal1,ts,subtype from orc_merge5_n2
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@orc_merge5_n2
+POSTHOOK: Output: default@orc_merge5a_n0
 POSTHOOK: Output: default@orc_merge5a_n0@st=0.8
 POSTHOOK: Output: default@orc_merge5a_n0@st=1.8
 POSTHOOK: Output: default@orc_merge5a_n0@st=8.0
@@ -535,6 +541,7 @@ PREHOOK: Output: default@orc_merge5a_n0
 POSTHOOK: query: insert overwrite table orc_merge5a_n0 partition (st) select userid,string1,subtype,decimal1,ts,subtype from orc_merge5_n2
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@orc_merge5_n2
+POSTHOOK: Output: default@orc_merge5a_n0
 POSTHOOK: Output: default@orc_merge5a_n0@st=0.8
 POSTHOOK: Output: default@orc_merge5a_n0@st=1.8
 POSTHOOK: Output: default@orc_merge5a_n0@st=8.0
@@ -566,6 +573,7 @@ PREHOOK: Output: default@orc_merge5a_n0
 POSTHOOK: query: insert overwrite table orc_merge5a_n0 partition (st) select userid,string1,subtype,decimal1,ts,subtype from orc_merge5_n2
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@orc_merge5_n2
+POSTHOOK: Output: default@orc_merge5a_n0
 POSTHOOK: Output: default@orc_merge5a_n0@st=0.8
 POSTHOOK: Output: default@orc_merge5a_n0@st=1.8
 POSTHOOK: Output: default@orc_merge5a_n0@st=8.0
diff --git a/ql/src/test/results/clientpositive/llap/orc_merge_incompat2.q.out b/ql/src/test/results/clientpositive/llap/orc_merge_incompat2.q.out
index c7196ff960..dcc6c59a31 100644
--- a/ql/src/test/results/clientpositive/llap/orc_merge_incompat2.q.out
+++ b/ql/src/test/results/clientpositive/llap/orc_merge_incompat2.q.out
@@ -29,6 +29,7 @@ PREHOOK: Output: default@orc_merge5a
 POSTHOOK: query: explain insert overwrite table orc_merge5a partition (st) select userid,string1,subtype,decimal1,ts,subtype from orc_merge5
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@orc_merge5
+POSTHOOK: Output: default@orc_merge5a
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -146,6 +147,7 @@ PREHOOK: Output: default@orc_merge5a
 POSTHOOK: query: insert overwrite table orc_merge5a partition (st) select userid,string1,subtype,decimal1,ts,subtype from orc_merge5 order by userid
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@orc_merge5
+POSTHOOK: Output: default@orc_merge5a
 POSTHOOK: Output: default@orc_merge5a@st=0.8
 POSTHOOK: Output: default@orc_merge5a@st=1.8
 POSTHOOK: Output: default@orc_merge5a@st=8.0
@@ -177,6 +179,7 @@ PREHOOK: Output: default@orc_merge5a
 POSTHOOK: query: insert into table orc_merge5a partition (st) select userid,string1,subtype,decimal1,ts,subtype from orc_merge5 order by userid
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@orc_merge5
+POSTHOOK: Output: default@orc_merge5a
 POSTHOOK: Output: default@orc_merge5a@st=0.8
 POSTHOOK: Output: default@orc_merge5a@st=1.8
 POSTHOOK: Output: default@orc_merge5a@st=8.0
@@ -208,6 +211,7 @@ PREHOOK: Output: default@orc_merge5a
 POSTHOOK: query: insert into table orc_merge5a partition (st) select userid,string1,subtype,decimal1,ts,subtype from orc_merge5 order by userid
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@orc_merge5
+POSTHOOK: Output: default@orc_merge5a
 POSTHOOK: Output: default@orc_merge5a@st=0.8
 POSTHOOK: Output: default@orc_merge5a@st=1.8
 POSTHOOK: Output: default@orc_merge5a@st=8.0
@@ -239,6 +243,7 @@ PREHOOK: Output: default@orc_merge5a
 POSTHOOK: query: insert into table orc_merge5a partition (st) select userid,string1,subtype,decimal1,ts,subtype from orc_merge5 order by userid
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@orc_merge5
+POSTHOOK: Output: default@orc_merge5a
 POSTHOOK: Output: default@orc_merge5a@st=0.8
 POSTHOOK: Output: default@orc_merge5a@st=1.8
 POSTHOOK: Output: default@orc_merge5a@st=8.0
diff --git a/ql/src/test/results/clientpositive/llap/orc_nested_column_pruning.q.out b/ql/src/test/results/clientpositive/llap/orc_nested_column_pruning.q.out
index a20ead8e68..537c04969f 100644
--- a/ql/src/test/results/clientpositive/llap/orc_nested_column_pruning.q.out
+++ b/ql/src/test/results/clientpositive/llap/orc_nested_column_pruning.q.out
@@ -1637,6 +1637,7 @@ SELECT s1.f1 AS f1, S1.f2 AS f2, s1.f6 AS f3
 FROM nested_tbl_1_n0
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@nested_tbl_1_n0
+POSTHOOK: Output: default@nested_tbl_3_n0
 POSTHOOK: Output: default@nested_tbl_3_n0@f3=4
 POSTHOOK: Lineage: nested_tbl_3_n0 PARTITION(f3=4).f1 EXPRESSION [(nested_tbl_1_n0)nested_tbl_1_n0.FieldSchema(name:s1, type:struct<f1:boolean,f2:string,f3:struct<f4:int,f5:double>,f6:int>, comment:null), ]
 POSTHOOK: Lineage: nested_tbl_3_n0 PARTITION(f3=4).f2 EXPRESSION [(nested_tbl_1_n0)nested_tbl_1_n0.FieldSchema(name:s1, type:struct<f1:boolean,f2:string,f3:struct<f4:int,f5:double>,f6:int>, comment:null), ]
diff --git a/ql/src/test/results/clientpositive/llap/parquet_partitioned.q.out b/ql/src/test/results/clientpositive/llap/parquet_partitioned.q.out
index c74b52ed6e..c8237780ce 100644
--- a/ql/src/test/results/clientpositive/llap/parquet_partitioned.q.out
+++ b/ql/src/test/results/clientpositive/llap/parquet_partitioned.q.out
@@ -106,6 +106,7 @@ PREHOOK: Output: default@parquet_partitioned
 POSTHOOK: query: INSERT OVERWRITE TABLE parquet_partitioned PARTITION (part) SELECT * FROM parquet_partitioned_staging
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@parquet_partitioned_staging
+POSTHOOK: Output: default@parquet_partitioned
 POSTHOOK: Output: default@parquet_partitioned@part=part1
 POSTHOOK: Output: default@parquet_partitioned@part=part2
 POSTHOOK: Lineage: parquet_partitioned PARTITION(part=part1).id SIMPLE [(parquet_partitioned_staging)parquet_partitioned_staging.FieldSchema(name:id, type:int, comment:null), ]
diff --git a/ql/src/test/results/clientpositive/llap/partition_ctas.q.out b/ql/src/test/results/clientpositive/llap/partition_ctas.q.out
index fe1b429699..2c5250622a 100644
--- a/ql/src/test/results/clientpositive/llap/partition_ctas.q.out
+++ b/ql/src/test/results/clientpositive/llap/partition_ctas.q.out
@@ -13,6 +13,7 @@ POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@partition_ctas_1
+POSTHOOK: Output: default@partition_ctas_1
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -150,6 +151,7 @@ POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@partition_ctas_1
+POSTHOOK: Output: default@partition_ctas_1
 POSTHOOK: Output: default@partition_ctas_1@key=201
 POSTHOOK: Output: default@partition_ctas_1@key=202
 POSTHOOK: Output: default@partition_ctas_1@key=203
@@ -366,6 +368,7 @@ POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@partition_ctas_2
+POSTHOOK: Output: default@partition_ctas_2
 POSTHOOK: Output: default@partition_ctas_2@value=val_201
 POSTHOOK: Output: default@partition_ctas_2@value=val_202
 POSTHOOK: Output: default@partition_ctas_2@value=val_203
@@ -829,6 +832,7 @@ POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@partition_ctas_diff_order
+POSTHOOK: Output: default@partition_ctas_diff_order
 POSTHOOK: Output: default@partition_ctas_diff_order@value=val_201
 POSTHOOK: Output: default@partition_ctas_diff_order@value=val_202
 POSTHOOK: Output: default@partition_ctas_diff_order@value=val_203
@@ -1018,6 +1022,7 @@ POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@partition_ctas_complex_order
+POSTHOOK: Output: default@partition_ctas_complex_order
 POSTHOOK: Output: default@partition_ctas_complex_order@c0=val_201_0/c4=val_201_4/c1=val_201_1
 POSTHOOK: Output: default@partition_ctas_complex_order@c0=val_202_0/c4=val_202_4/c1=val_202_1
 POSTHOOK: Output: default@partition_ctas_complex_order@c0=val_203_0/c4=val_203_4/c1=val_203_1
diff --git a/ql/src/test/results/clientpositive/llap/partition_decode_name.q.out b/ql/src/test/results/clientpositive/llap/partition_decode_name.q.out
index 224561aaf9..49a87e1403 100644
--- a/ql/src/test/results/clientpositive/llap/partition_decode_name.q.out
+++ b/ql/src/test/results/clientpositive/llap/partition_decode_name.q.out
@@ -35,6 +35,7 @@ PREHOOK: Output: default@sc_part_n0
 POSTHOOK: query: insert overwrite table sc_part_n0 partition(ts) select * from sc_n0
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@sc_n0
+POSTHOOK: Output: default@sc_part_n0
 POSTHOOK: Output: default@sc_part_n0@ts=2011-01-11+14%3A18%3A26
 POSTHOOK: Output: default@sc_part_n0@ts=2011-01-11+15%3A18%3A26
 POSTHOOK: Output: default@sc_part_n0@ts=2011-01-11+16%3A18%3A26
@@ -66,6 +67,7 @@ PREHOOK: Output: default@sc_part_n0
 POSTHOOK: query: insert overwrite table sc_part_n0 partition(ts) select * from sc_n0
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@sc_n0
+POSTHOOK: Output: default@sc_part_n0
 POSTHOOK: Output: default@sc_part_n0@ts=2011-01-11+14%3A18%3A26
 POSTHOOK: Output: default@sc_part_n0@ts=2011-01-11+15%3A18%3A26
 POSTHOOK: Output: default@sc_part_n0@ts=2011-01-11+16%3A18%3A26
diff --git a/ql/src/test/results/clientpositive/llap/partition_discovery.q.out b/ql/src/test/results/clientpositive/llap/partition_discovery.q.out
index 39bef3bde8..06a475e586 100644
--- a/ql/src/test/results/clientpositive/llap/partition_discovery.q.out
+++ b/ql/src/test/results/clientpositive/llap/partition_discovery.q.out
@@ -266,6 +266,7 @@ POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@repairtable_n9
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@repairtable_n10
+POSTHOOK: Output: default@repairtable_n10
 PREHOOK: query: describe formatted repairtable_n10
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@repairtable_n10
diff --git a/ql/src/test/results/clientpositive/llap/partition_params_postgres.q.out b/ql/src/test/results/clientpositive/llap/partition_params_postgres.q.out
index f536fd24ff..301e3e6f01 100644
--- a/ql/src/test/results/clientpositive/llap/partition_params_postgres.q.out
+++ b/ql/src/test/results/clientpositive/llap/partition_params_postgres.q.out
@@ -17,6 +17,7 @@ PREHOOK: Output: default@my_table
 POSTHOOK: query: insert into my_table VALUES(11, 201, "F")
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@my_table
 POSTHOOK: Output: default@my_table@col2=F
 POSTHOOK: Lineage: my_table PARTITION(col2=F).col1 SCRIPT []
 POSTHOOK: Lineage: my_table PARTITION(col2=F).col3 SCRIPT []
diff --git a/ql/src/test/results/clientpositive/llap/partition_special_char.q.out b/ql/src/test/results/clientpositive/llap/partition_special_char.q.out
index c7a845107c..d4881b4664 100644
--- a/ql/src/test/results/clientpositive/llap/partition_special_char.q.out
+++ b/ql/src/test/results/clientpositive/llap/partition_special_char.q.out
@@ -35,6 +35,7 @@ PREHOOK: Output: default@sc_part
 POSTHOOK: query: insert overwrite table sc_part partition(ts) select * from sc
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@sc
+POSTHOOK: Output: default@sc_part
 POSTHOOK: Output: default@sc_part@ts=2011-01-11+14%3A18%3A26
 POSTHOOK: Output: default@sc_part@ts=2011-01-11+15%3A18%3A26
 POSTHOOK: Output: default@sc_part@ts=2011-01-11+16%3A18%3A26
@@ -66,6 +67,7 @@ PREHOOK: Output: default@sc_part
 POSTHOOK: query: insert overwrite table sc_part partition(ts) select * from sc
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@sc
+POSTHOOK: Output: default@sc_part
 POSTHOOK: Output: default@sc_part@ts=2011-01-11+14%3A18%3A26
 POSTHOOK: Output: default@sc_part@ts=2011-01-11+15%3A18%3A26
 POSTHOOK: Output: default@sc_part@ts=2011-01-11+16%3A18%3A26
diff --git a/ql/src/test/results/clientpositive/llap/partitioned_table_stats.q.out b/ql/src/test/results/clientpositive/llap/partitioned_table_stats.q.out
index 0ce2d3e490..ac3e275309 100644
--- a/ql/src/test/results/clientpositive/llap/partitioned_table_stats.q.out
+++ b/ql/src/test/results/clientpositive/llap/partitioned_table_stats.q.out
@@ -41,6 +41,7 @@ PREHOOK: Output: default@datatype_stats_n0
 POSTHOOK: query: INSERT INTO datatype_stats_n0 values(3, 45, 456, 45454.4, 454.6565, 2355, '2012-01-01 01:02:03', '2012-01-01', 'update_statistics', 'stats', 'hive', 'true', 'bin', 2)
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@datatype_stats_n0
 POSTHOOK: Output: default@datatype_stats_n0@t=2
 POSTHOOK: Lineage: datatype_stats_n0 PARTITION(t=2).b SCRIPT []
 POSTHOOK: Lineage: datatype_stats_n0 PARTITION(t=2).bin SCRIPT []
@@ -62,6 +63,7 @@ PREHOOK: Output: default@datatype_stats_n0
 POSTHOOK: query: INSERT INTO datatype_stats_n0 values(NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL)
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@datatype_stats_n0
 POSTHOOK: Output: default@datatype_stats_n0@t=__HIVE_DEFAULT_PARTITION__
 POSTHOOK: Lineage: datatype_stats_n0 PARTITION(t=__HIVE_DEFAULT_PARTITION__).b EXPRESSION []
 POSTHOOK: Lineage: datatype_stats_n0 PARTITION(t=__HIVE_DEFAULT_PARTITION__).bin EXPRESSION []
@@ -349,6 +351,7 @@ PREHOOK: Output: default@datatype_stats_n0
 POSTHOOK: query: INSERT INTO datatype_stats_n0 values(2, 44, 455, 45454.3, 454.6564, 2354, '2012-01-01 01:02:02', '2011-12-31', 'update_statistic', 'stat', 'hi', 'false', 'bi', 1)
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@datatype_stats_n0
 POSTHOOK: Output: default@datatype_stats_n0@t=1
 POSTHOOK: Lineage: datatype_stats_n0 PARTITION(t=1).b SCRIPT []
 POSTHOOK: Lineage: datatype_stats_n0 PARTITION(t=1).bin SCRIPT []
@@ -636,6 +639,7 @@ PREHOOK: Output: default@datatype_stats_n0
 POSTHOOK: query: INSERT INTO datatype_stats_n0 values(4, 46, 457, 45454.5, 454.6566, 2356, '2012-01-01 01:02:04', '2012-01-02', 'update_statisticsss', 'statsss', 'hiveee', 'true', 'binnn', 4)
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@datatype_stats_n0
 POSTHOOK: Output: default@datatype_stats_n0@t=4
 POSTHOOK: Lineage: datatype_stats_n0 PARTITION(t=4).b SCRIPT []
 POSTHOOK: Lineage: datatype_stats_n0 PARTITION(t=4).bin SCRIPT []
diff --git a/ql/src/test/results/clientpositive/llap/partitions_filter_default.q.out b/ql/src/test/results/clientpositive/llap/partitions_filter_default.q.out
index d24c4fc8a4..27edf40fd4 100644
--- a/ql/src/test/results/clientpositive/llap/partitions_filter_default.q.out
+++ b/ql/src/test/results/clientpositive/llap/partitions_filter_default.q.out
@@ -13,6 +13,7 @@ PREHOOK: Output: default@ptestfilter
 POSTHOOK: query: INSERT OVERWRITE TABLE ptestfilter PARTITION (c) select 'Col1', null
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@ptestfilter
 POSTHOOK: Output: default@ptestfilter@c=__HIVE_DEFAULT_PARTITION__
 POSTHOOK: Lineage: ptestfilter PARTITION(c=__HIVE_DEFAULT_PARTITION__).a SIMPLE []
 PREHOOK: query: INSERT OVERWRITE TABLE ptestfilter PARTITION (c) select 'Col2', 5
@@ -22,6 +23,7 @@ PREHOOK: Output: default@ptestfilter
 POSTHOOK: query: INSERT OVERWRITE TABLE ptestfilter PARTITION (c) select 'Col2', 5
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@ptestfilter
 POSTHOOK: Output: default@ptestfilter@c=5
 POSTHOOK: Lineage: ptestfilter PARTITION(c=5).a SIMPLE []
 PREHOOK: query: show partitions ptestfilter
diff --git a/ql/src/test/results/clientpositive/llap/quotedid_partition.q.out b/ql/src/test/results/clientpositive/llap/quotedid_partition.q.out
index a5434d3de9..275912ceff 100644
--- a/ql/src/test/results/clientpositive/llap/quotedid_partition.q.out
+++ b/ql/src/test/results/clientpositive/llap/quotedid_partition.q.out
@@ -119,6 +119,7 @@ POSTHOOK: query: insert overwrite table src_p2 partition(`!@#$%^&*()_q`)
 select key, value as `!@#$%^&*()_q` from src where key < '200'
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
+POSTHOOK: Output: default@src_p2
 POSTHOOK: Output: default@src_p2@!@%23$%25%5E&%2A()_q=val_0
 POSTHOOK: Output: default@src_p2@!@%23$%25%5E&%2A()_q=val_10
 POSTHOOK: Output: default@src_p2@!@%23$%25%5E&%2A()_q=val_100
diff --git a/ql/src/test/results/clientpositive/llap/sample10.q.out b/ql/src/test/results/clientpositive/llap/sample10.q.out
index 5cb190cfc2..2e675948d6 100644
--- a/ql/src/test/results/clientpositive/llap/sample10.q.out
+++ b/ql/src/test/results/clientpositive/llap/sample10.q.out
@@ -21,6 +21,7 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
+POSTHOOK: Output: default@srcpartbucket
 POSTHOOK: Output: default@srcpartbucket@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@srcpartbucket@ds=2008-04-08/hr=12
 POSTHOOK: Output: default@srcpartbucket@ds=2008-04-09/hr=11
diff --git a/ql/src/test/results/clientpositive/llap/sample10_mm.q.out b/ql/src/test/results/clientpositive/llap/sample10_mm.q.out
index ba528d4163..2c80d2481e 100644
--- a/ql/src/test/results/clientpositive/llap/sample10_mm.q.out
+++ b/ql/src/test/results/clientpositive/llap/sample10_mm.q.out
@@ -21,6 +21,7 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
+POSTHOOK: Output: default@srcpartbucket
 POSTHOOK: Output: default@srcpartbucket@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@srcpartbucket@ds=2008-04-08/hr=12
 POSTHOOK: Output: default@srcpartbucket@ds=2008-04-09/hr=11
diff --git a/ql/src/test/results/clientpositive/llap/schema_evol_orc_acid_part_update.q.out b/ql/src/test/results/clientpositive/llap/schema_evol_orc_acid_part_update.q.out
index ac7d3f1d09..67bafdbfce 100644
--- a/ql/src/test/results/clientpositive/llap/schema_evol_orc_acid_part_update.q.out
+++ b/ql/src/test/results/clientpositive/llap/schema_evol_orc_acid_part_update.q.out
@@ -609,6 +609,7 @@ PREHOOK: Output: default@all100kjson_textfile_orc_n0
 POSTHOOK: query: INSERT INTO TABLE all100kjson_textfile_orc_n0 PARTITION (t) SELECT csmallint, cint, cbigint, cfloat, cdouble, cstring1, cboolean1, ctimestamp1, ctinyint FROM alltypesorc WHERE ctinyint > 0
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc
+POSTHOOK: Output: default@all100kjson_textfile_orc_n0
 POSTHOOK: Output: default@all100kjson_textfile_orc_n0@t=1
 POSTHOOK: Output: default@all100kjson_textfile_orc_n0@t=10
 POSTHOOK: Output: default@all100kjson_textfile_orc_n0@t=11
@@ -1191,6 +1192,7 @@ PREHOOK: Output: default@all100kjson_textfile_orc_n0
 POSTHOOK: query: INSERT INTO TABLE all100kjson_textfile_orc_n0 PARTITION (t) SELECT csmallint, cint, cbigint, cfloat, cdouble, cstring1, cboolean1, ctimestamp1, ctinyint FROM alltypesorc WHERE ctinyint < 1 and ctinyint > -50
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc
+POSTHOOK: Output: default@all100kjson_textfile_orc_n0
 POSTHOOK: Output: default@all100kjson_textfile_orc_n0@t=-1
 POSTHOOK: Output: default@all100kjson_textfile_orc_n0@t=-10
 POSTHOOK: Output: default@all100kjson_textfile_orc_n0@t=-11
diff --git a/ql/src/test/results/clientpositive/llap/schema_evol_orc_acid_part_update_llap_io.q.out b/ql/src/test/results/clientpositive/llap/schema_evol_orc_acid_part_update_llap_io.q.out
index 32d0f846e1..6817b78340 100644
--- a/ql/src/test/results/clientpositive/llap/schema_evol_orc_acid_part_update_llap_io.q.out
+++ b/ql/src/test/results/clientpositive/llap/schema_evol_orc_acid_part_update_llap_io.q.out
@@ -609,6 +609,7 @@ PREHOOK: Output: default@all100kjson_textfile_orc
 POSTHOOK: query: INSERT INTO TABLE all100kjson_textfile_orc PARTITION (t) SELECT csmallint, cint, cbigint, cfloat, cdouble, cstring1, cboolean1, ctimestamp1, ctinyint FROM alltypesorc WHERE ctinyint > 0
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc
+POSTHOOK: Output: default@all100kjson_textfile_orc
 POSTHOOK: Output: default@all100kjson_textfile_orc@t=1
 POSTHOOK: Output: default@all100kjson_textfile_orc@t=10
 POSTHOOK: Output: default@all100kjson_textfile_orc@t=11
@@ -1191,6 +1192,7 @@ PREHOOK: Output: default@all100kjson_textfile_orc
 POSTHOOK: query: INSERT INTO TABLE all100kjson_textfile_orc PARTITION (t) SELECT csmallint, cint, cbigint, cfloat, cdouble, cstring1, cboolean1, ctimestamp1, ctinyint FROM alltypesorc WHERE ctinyint < 1 and ctinyint > -50
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc
+POSTHOOK: Output: default@all100kjson_textfile_orc
 POSTHOOK: Output: default@all100kjson_textfile_orc@t=-1
 POSTHOOK: Output: default@all100kjson_textfile_orc@t=-10
 POSTHOOK: Output: default@all100kjson_textfile_orc@t=-11
diff --git a/ql/src/test/results/clientpositive/llap/show_partitions2.q.out b/ql/src/test/results/clientpositive/llap/show_partitions2.q.out
index 46a9ee35cd..1ed9eaa56b 100644
--- a/ql/src/test/results/clientpositive/llap/show_partitions2.q.out
+++ b/ql/src/test/results/clientpositive/llap/show_partitions2.q.out
@@ -113,6 +113,7 @@ PREHOOK: Output: default@mpart1
 POSTHOOK: query: INSERT INTO TABLE mpart1 PARTITION(ds, hr, rs) SELECT * FROM srcpart1
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcpart1
+POSTHOOK: Output: default@mpart1
 POSTHOOK: Output: default@mpart1@ds=1980-11-10/hr=21/rs=NA
 POSTHOOK: Output: default@mpart1@ds=1980-11-10/hr=__HIVE_DEFAULT_PARTITION__/rs=NA
 POSTHOOK: Output: default@mpart1@ds=1980-11-11/hr=12/rs=AS
diff --git a/ql/src/test/results/clientpositive/llap/smb_join_partition_key.q.out b/ql/src/test/results/clientpositive/llap/smb_join_partition_key.q.out
index 34246d1803..ea3a60ed25 100644
--- a/ql/src/test/results/clientpositive/llap/smb_join_partition_key.q.out
+++ b/ql/src/test/results/clientpositive/llap/smb_join_partition_key.q.out
@@ -65,6 +65,7 @@ PREHOOK: Output: default@smb_table_part
 POSTHOOK: query: INSERT OVERWRITE TABLE smb_table_part PARTITION (p1) SELECT key, value, 100 as p1 FROM data_table
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@data_table
+POSTHOOK: Output: default@smb_table_part
 POSTHOOK: Output: default@smb_table_part@p1=100
 POSTHOOK: Lineage: smb_table_part PARTITION(p1=100).key SIMPLE [(data_table)data_table.FieldSchema(name:key, type:int, comment:null), ]
 POSTHOOK: Lineage: smb_table_part PARTITION(p1=100).value SIMPLE [(data_table)data_table.FieldSchema(name:value, type:string, comment:null), ]
@@ -109,6 +110,7 @@ PREHOOK: Output: default@smb_table_part
 POSTHOOK: query: INSERT OVERWRITE TABLE smb_table_part PARTITION (p1) SELECT key, value, 100 as p1 FROM data_table
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@data_table
+POSTHOOK: Output: default@smb_table_part
 POSTHOOK: Output: default@smb_table_part@p1=100.0
 POSTHOOK: Lineage: smb_table_part PARTITION(p1=100.0).key SIMPLE [(data_table)data_table.FieldSchema(name:key, type:int, comment:null), ]
 POSTHOOK: Lineage: smb_table_part PARTITION(p1=100.0).value SIMPLE [(data_table)data_table.FieldSchema(name:value, type:string, comment:null), ]
diff --git a/ql/src/test/results/clientpositive/llap/stats12.q.out b/ql/src/test/results/clientpositive/llap/stats12.q.out
index e160da1d54..c99a3d5706 100644
--- a/ql/src/test/results/clientpositive/llap/stats12.q.out
+++ b/ql/src/test/results/clientpositive/llap/stats12.q.out
@@ -21,6 +21,7 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
+POSTHOOK: Output: default@analyze_srcpart_n3
 POSTHOOK: Output: default@analyze_srcpart_n3@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@analyze_srcpart_n3@ds=2008-04-08/hr=12
 POSTHOOK: Output: default@analyze_srcpart_n3@ds=2008-04-09/hr=11
diff --git a/ql/src/test/results/clientpositive/llap/stats13.q.out b/ql/src/test/results/clientpositive/llap/stats13.q.out
index efd2b256d3..a28ef233c6 100644
--- a/ql/src/test/results/clientpositive/llap/stats13.q.out
+++ b/ql/src/test/results/clientpositive/llap/stats13.q.out
@@ -21,6 +21,7 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
+POSTHOOK: Output: default@analyze_srcpart
 POSTHOOK: Output: default@analyze_srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@analyze_srcpart@ds=2008-04-08/hr=12
 POSTHOOK: Output: default@analyze_srcpart@ds=2008-04-09/hr=11
diff --git a/ql/src/test/results/clientpositive/llap/stats2.q.out b/ql/src/test/results/clientpositive/llap/stats2.q.out
index 06143a2b9a..d0114192d8 100644
--- a/ql/src/test/results/clientpositive/llap/stats2.q.out
+++ b/ql/src/test/results/clientpositive/llap/stats2.q.out
@@ -23,6 +23,7 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
+POSTHOOK: Output: default@analyze_t1
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -85,6 +86,7 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
+POSTHOOK: Output: default@analyze_t1
 POSTHOOK: Output: default@analyze_t1@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@analyze_t1@ds=2008-04-08/hr=12
 POSTHOOK: Output: default@analyze_t1@ds=2008-04-09/hr=11
diff --git a/ql/src/test/results/clientpositive/llap/stats4.q.out b/ql/src/test/results/clientpositive/llap/stats4.q.out
index a53ea2e13b..48f1a356c3 100644
--- a/ql/src/test/results/clientpositive/llap/stats4.q.out
+++ b/ql/src/test/results/clientpositive/llap/stats4.q.out
@@ -54,6 +54,7 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
+POSTHOOK: Output: default@nzhang_part1
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-3 depends on stages: Stage-2
@@ -250,6 +251,7 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
+POSTHOOK: Output: default@nzhang_part1
 POSTHOOK: Output: default@nzhang_part1@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@nzhang_part1@ds=2008-04-08/hr=12
 POSTHOOK: Output: default@nzhang_part2@ds=2008-12-31/hr=11
diff --git a/ql/src/test/results/clientpositive/llap/stats6.q.out b/ql/src/test/results/clientpositive/llap/stats6.q.out
index adf4b15000..eee5975bf9 100644
--- a/ql/src/test/results/clientpositive/llap/stats6.q.out
+++ b/ql/src/test/results/clientpositive/llap/stats6.q.out
@@ -21,6 +21,7 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
+POSTHOOK: Output: default@analyze_srcpart_n2
 POSTHOOK: Output: default@analyze_srcpart_n2@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@analyze_srcpart_n2@ds=2008-04-08/hr=12
 POSTHOOK: Output: default@analyze_srcpart_n2@ds=2008-04-09/hr=11
diff --git a/ql/src/test/results/clientpositive/llap/stats7.q.out b/ql/src/test/results/clientpositive/llap/stats7.q.out
index 7e64f7f155..7fb254aab4 100644
--- a/ql/src/test/results/clientpositive/llap/stats7.q.out
+++ b/ql/src/test/results/clientpositive/llap/stats7.q.out
@@ -21,6 +21,7 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
+POSTHOOK: Output: default@analyze_srcpart_n4
 POSTHOOK: Output: default@analyze_srcpart_n4@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@analyze_srcpart_n4@ds=2008-04-08/hr=12
 POSTHOOK: Output: default@analyze_srcpart_n4@ds=2008-04-09/hr=11
diff --git a/ql/src/test/results/clientpositive/llap/stats8.q.out b/ql/src/test/results/clientpositive/llap/stats8.q.out
index 29b4dc1fa7..9d41fd0cae 100644
--- a/ql/src/test/results/clientpositive/llap/stats8.q.out
+++ b/ql/src/test/results/clientpositive/llap/stats8.q.out
@@ -21,6 +21,7 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
+POSTHOOK: Output: default@analyze_srcpart_n1
 POSTHOOK: Output: default@analyze_srcpart_n1@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@analyze_srcpart_n1@ds=2008-04-08/hr=12
 POSTHOOK: Output: default@analyze_srcpart_n1@ds=2008-04-09/hr=11
diff --git a/ql/src/test/results/clientpositive/llap/stats_empty_dyn_part.q.out b/ql/src/test/results/clientpositive/llap/stats_empty_dyn_part.q.out
index 3053999a8a..73f65cd64a 100644
--- a/ql/src/test/results/clientpositive/llap/stats_empty_dyn_part.q.out
+++ b/ql/src/test/results/clientpositive/llap/stats_empty_dyn_part.q.out
@@ -13,6 +13,7 @@ PREHOOK: Output: default@tmptable_n7
 POSTHOOK: query: explain insert overwrite table tmptable_n7 partition (part) select key, value from src where key = 'no_such_value'
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
+POSTHOOK: Output: default@tmptable_n7
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -119,3 +120,4 @@ PREHOOK: Output: default@tmptable_n7
 POSTHOOK: query: insert overwrite table tmptable_n7 partition (part) select key, value from src where key = 'no_such_value'
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
+POSTHOOK: Output: default@tmptable_n7
diff --git a/ql/src/test/results/clientpositive/llap/stats_noscan_1.q.out b/ql/src/test/results/clientpositive/llap/stats_noscan_1.q.out
index c8e59a7190..9d2e3a5111 100644
--- a/ql/src/test/results/clientpositive/llap/stats_noscan_1.q.out
+++ b/ql/src/test/results/clientpositive/llap/stats_noscan_1.q.out
@@ -21,6 +21,7 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
+POSTHOOK: Output: default@analyze_srcpart_n0
 POSTHOOK: Output: default@analyze_srcpart_n0@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@analyze_srcpart_n0@ds=2008-04-08/hr=12
 POSTHOOK: Output: default@analyze_srcpart_n0@ds=2008-04-09/hr=11
@@ -292,6 +293,7 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
+POSTHOOK: Output: default@analyze_srcpart_partial
 POSTHOOK: Output: default@analyze_srcpart_partial@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@analyze_srcpart_partial@ds=2008-04-08/hr=12
 POSTHOOK: Output: default@analyze_srcpart_partial@ds=2008-04-09/hr=11
diff --git a/ql/src/test/results/clientpositive/llap/stats_only_null.q.out b/ql/src/test/results/clientpositive/llap/stats_only_null.q.out
index 66cfaffb64..bf4010ac2f 100644
--- a/ql/src/test/results/clientpositive/llap/stats_only_null.q.out
+++ b/ql/src/test/results/clientpositive/llap/stats_only_null.q.out
@@ -399,6 +399,7 @@ PREHOOK: Output: default@stats_null_part
 POSTHOOK: query: insert into table stats_null_part partition(dt) select a,b,c,d,b from temps_null
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@temps_null
+POSTHOOK: Output: default@stats_null_part
 POSTHOOK: Output: default@stats_null_part@dt=1
 POSTHOOK: Output: default@stats_null_part@dt=__HIVE_DEFAULT_PARTITION__
 POSTHOOK: Lineage: stats_null_part PARTITION(dt=1).a SIMPLE [(temps_null)temps_null.FieldSchema(name:a, type:double, comment:null), ]
diff --git a/ql/src/test/results/clientpositive/llap/statsfs.q.out b/ql/src/test/results/clientpositive/llap/statsfs.q.out
index 71de02e37a..ab91bed738 100644
--- a/ql/src/test/results/clientpositive/llap/statsfs.q.out
+++ b/ql/src/test/results/clientpositive/llap/statsfs.q.out
@@ -383,6 +383,7 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
+POSTHOOK: Output: default@t1_n120
 POSTHOOK: Output: default@t1_n120@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@t1_n120@ds=2008-04-08/hr=12
 POSTHOOK: Output: default@t1_n120@ds=2008-04-09/hr=11
diff --git a/ql/src/test/results/clientpositive/llap/temp_table_alter_partition_change_col.q.out b/ql/src/test/results/clientpositive/llap/temp_table_alter_partition_change_col.q.out
index b7de24eb6b..50ff04f0d5 100644
--- a/ql/src/test/results/clientpositive/llap/temp_table_alter_partition_change_col.q.out
+++ b/ql/src/test/results/clientpositive/llap/temp_table_alter_partition_change_col.q.out
@@ -35,6 +35,7 @@ POSTHOOK: query: insert overwrite table alter_partition_change_col1 partition (p
   select c1, c2, cast(null as string), '123' from alter_partition_change_col0
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alter_partition_change_col0
+POSTHOOK: Output: default@alter_partition_change_col1
 POSTHOOK: Output: default@alter_partition_change_col1@p1=__HIVE_DEFAULT_PARTITION__/p2=123
 POSTHOOK: Output: default@alter_partition_change_col1@p1=abc/p2=123
 POSTHOOK: Lineage: alter_partition_change_col1 PARTITION(p1=__HIVE_DEFAULT_PARTITION__,p2=123).c1 EXPRESSION [(alter_partition_change_col0)alter_partition_change_col0.FieldSchema(name:c1, type:string, comment:null), ]
diff --git a/ql/src/test/results/clientpositive/llap/temp_table_alter_partition_coltype.q.out b/ql/src/test/results/clientpositive/llap/temp_table_alter_partition_coltype.q.out
index ea8d982154..90d769b016 100644
--- a/ql/src/test/results/clientpositive/llap/temp_table_alter_partition_coltype.q.out
+++ b/ql/src/test/results/clientpositive/llap/temp_table_alter_partition_coltype.q.out
@@ -750,6 +750,7 @@ PREHOOK: Output: pt@alterdynamic_part_table_temp
 POSTHOOK: query: insert into table pt.alterdynamic_part_table_temp partition(partcol1, partcol2) select '1', '1', '1' from src where key=150 limit 5
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
+POSTHOOK: Output: pt@alterdynamic_part_table_temp
 POSTHOOK: Output: pt@alterdynamic_part_table_temp@partcol1=1/partcol2=1
 POSTHOOK: Lineage: alterdynamic_part_table_temp PARTITION(partcol1=1,partcol2=1).intcol SIMPLE []
 PREHOOK: query: insert into table pt.alterdynamic_part_table_temp partition(partcol1, partcol2) select '1', '2', '1' from src where key=150 limit 5
@@ -759,6 +760,7 @@ PREHOOK: Output: pt@alterdynamic_part_table_temp
 POSTHOOK: query: insert into table pt.alterdynamic_part_table_temp partition(partcol1, partcol2) select '1', '2', '1' from src where key=150 limit 5
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
+POSTHOOK: Output: pt@alterdynamic_part_table_temp
 POSTHOOK: Output: pt@alterdynamic_part_table_temp@partcol1=2/partcol2=1
 POSTHOOK: Lineage: alterdynamic_part_table_temp PARTITION(partcol1=2,partcol2=1).intcol SIMPLE []
 PREHOOK: query: insert into table pt.alterdynamic_part_table_temp partition(partcol1, partcol2) select NULL, '1', '1' from src where key=150 limit 5
@@ -768,6 +770,7 @@ PREHOOK: Output: pt@alterdynamic_part_table_temp
 POSTHOOK: query: insert into table pt.alterdynamic_part_table_temp partition(partcol1, partcol2) select NULL, '1', '1' from src where key=150 limit 5
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
+POSTHOOK: Output: pt@alterdynamic_part_table_temp
 POSTHOOK: Output: pt@alterdynamic_part_table_temp@partcol1=1/partcol2=1
 POSTHOOK: Lineage: alterdynamic_part_table_temp PARTITION(partcol1=1,partcol2=1).intcol EXPRESSION []
 PREHOOK: query: alter table pt.alterdynamic_part_table_temp partition column (partcol1 int)
diff --git a/ql/src/test/results/clientpositive/llap/temp_table_avro_partitioned.q.out b/ql/src/test/results/clientpositive/llap/temp_table_avro_partitioned.q.out
index 4d46a899ef..14c51837b7 100644
--- a/ql/src/test/results/clientpositive/llap/temp_table_avro_partitioned.q.out
+++ b/ql/src/test/results/clientpositive/llap/temp_table_avro_partitioned.q.out
@@ -139,6 +139,7 @@ PREHOOK: Output: default@episodes_partitioned_n1_temp
 POSTHOOK: query: INSERT OVERWRITE TABLE episodes_partitioned_n1_temp PARTITION (doctor_pt) SELECT title, air_date, doctor, doctor as doctor_pt FROM episodes_n2_temp
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@episodes_n2_temp
+POSTHOOK: Output: default@episodes_partitioned_n1_temp
 POSTHOOK: Output: default@episodes_partitioned_n1_temp@doctor_pt=1
 POSTHOOK: Output: default@episodes_partitioned_n1_temp@doctor_pt=11
 POSTHOOK: Output: default@episodes_partitioned_n1_temp@doctor_pt=2
@@ -300,6 +301,7 @@ PREHOOK: Output: default@episodes_partitioned_serdeproperties_temp
 POSTHOOK: query: INSERT INTO TABLE episodes_partitioned_serdeproperties_temp PARTITION (doctor_pt) SELECT title, air_date, doctor, doctor as doctor_pt FROM episodes_n2_temp
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@episodes_n2_temp
+POSTHOOK: Output: default@episodes_partitioned_serdeproperties_temp
 POSTHOOK: Output: default@episodes_partitioned_serdeproperties_temp@doctor_pt=1
 POSTHOOK: Output: default@episodes_partitioned_serdeproperties_temp@doctor_pt=11
 POSTHOOK: Output: default@episodes_partitioned_serdeproperties_temp@doctor_pt=2
diff --git a/ql/src/test/results/clientpositive/llap/temp_table_avro_partitioned_native.q.out b/ql/src/test/results/clientpositive/llap/temp_table_avro_partitioned_native.q.out
index 06c124a9af..a85e96ba22 100644
--- a/ql/src/test/results/clientpositive/llap/temp_table_avro_partitioned_native.q.out
+++ b/ql/src/test/results/clientpositive/llap/temp_table_avro_partitioned_native.q.out
@@ -49,6 +49,7 @@ POSTHOOK: query: INSERT OVERWRITE TABLE episodes_partitioned PARTITION (doctor_p
   SELECT title, air_date, doctor, doctor as doctor_pt FROM episodes
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@episodes
+POSTHOOK: Output: default@episodes_partitioned
 POSTHOOK: Output: default@episodes_partitioned@doctor_pt=1
 POSTHOOK: Output: default@episodes_partitioned@doctor_pt=11
 POSTHOOK: Output: default@episodes_partitioned@doctor_pt=2
diff --git a/ql/src/test/results/clientpositive/llap/temp_table_drop_partitions_filter4.q.out b/ql/src/test/results/clientpositive/llap/temp_table_drop_partitions_filter4.q.out
index 7ddb6dfc5c..d5a4b092c0 100644
--- a/ql/src/test/results/clientpositive/llap/temp_table_drop_partitions_filter4.q.out
+++ b/ql/src/test/results/clientpositive/llap/temp_table_drop_partitions_filter4.q.out
@@ -13,6 +13,7 @@ PREHOOK: Output: default@ptestfilter_n2_temp
 POSTHOOK: query: INSERT OVERWRITE TABLE ptestfilter_n2_temp PARTITION (c) select 'Col1', 1, null
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@ptestfilter_n2_temp
 POSTHOOK: Output: default@ptestfilter_n2_temp@c=__HIVE_DEFAULT_PARTITION__
 POSTHOOK: Lineage: ptestfilter_n2_temp PARTITION(c=__HIVE_DEFAULT_PARTITION__).a SIMPLE []
 POSTHOOK: Lineage: ptestfilter_n2_temp PARTITION(c=__HIVE_DEFAULT_PARTITION__).b SIMPLE []
@@ -62,6 +63,7 @@ PREHOOK: Output: default@ptestfilter_n2_temp
 POSTHOOK: query: INSERT OVERWRITE TABLE ptestfilter_n2_temp PARTITION (c) select 'Col1', 1, null
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@ptestfilter_n2_temp
 POSTHOOK: Output: default@ptestfilter_n2_temp@c=__HIVE_DEFAULT_PARTITION__
 POSTHOOK: Lineage: ptestfilter_n2_temp PARTITION(c=__HIVE_DEFAULT_PARTITION__).a SIMPLE []
 POSTHOOK: Lineage: ptestfilter_n2_temp PARTITION(c=__HIVE_DEFAULT_PARTITION__).b SIMPLE []
@@ -103,6 +105,7 @@ PREHOOK: Output: default@ptestfilter_n2_temp
 POSTHOOK: query: INSERT OVERWRITE TABLE ptestfilter_n2_temp PARTITION (c,d) select 'Col1', 1, null, null
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@ptestfilter_n2_temp
 POSTHOOK: Output: default@ptestfilter_n2_temp@c=__HIVE_DEFAULT_PARTITION__/d=__HIVE_DEFAULT_PARTITION__
 POSTHOOK: Lineage: ptestfilter_n2_temp PARTITION(c=__HIVE_DEFAULT_PARTITION__,d=__HIVE_DEFAULT_PARTITION__).a SIMPLE []
 POSTHOOK: Lineage: ptestfilter_n2_temp PARTITION(c=__HIVE_DEFAULT_PARTITION__,d=__HIVE_DEFAULT_PARTITION__).b SIMPLE []
@@ -113,6 +116,7 @@ PREHOOK: Output: default@ptestfilter_n2_temp
 POSTHOOK: query: INSERT OVERWRITE TABLE ptestfilter_n2_temp PARTITION (c,d) select 'Col2', 2, null, 2
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@ptestfilter_n2_temp
 POSTHOOK: Output: default@ptestfilter_n2_temp@c=__HIVE_DEFAULT_PARTITION__/d=2
 POSTHOOK: Lineage: ptestfilter_n2_temp PARTITION(c=__HIVE_DEFAULT_PARTITION__,d=2).a SIMPLE []
 POSTHOOK: Lineage: ptestfilter_n2_temp PARTITION(c=__HIVE_DEFAULT_PARTITION__,d=2).b SIMPLE []
@@ -123,6 +127,7 @@ PREHOOK: Output: default@ptestfilter_n2_temp
 POSTHOOK: query: INSERT OVERWRITE TABLE ptestfilter_n2_temp PARTITION (c,d) select 'Col3', 3, 'Uganda', null
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@ptestfilter_n2_temp
 POSTHOOK: Output: default@ptestfilter_n2_temp@c=Uganda/d=__HIVE_DEFAULT_PARTITION__
 POSTHOOK: Lineage: ptestfilter_n2_temp PARTITION(c=Uganda,d=__HIVE_DEFAULT_PARTITION__).a SIMPLE []
 POSTHOOK: Lineage: ptestfilter_n2_temp PARTITION(c=Uganda,d=__HIVE_DEFAULT_PARTITION__).b SIMPLE []
@@ -182,6 +187,7 @@ PREHOOK: Output: default@ptestfilter_n2_temp
 POSTHOOK: query: INSERT OVERWRITE TABLE ptestfilter_n2_temp PARTITION (c,d) select 'Col2', 2, null, 2
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@ptestfilter_n2_temp
 POSTHOOK: Output: default@ptestfilter_n2_temp@c=__HIVE_DEFAULT_PARTITION__/d=2
 POSTHOOK: Lineage: ptestfilter_n2_temp PARTITION(c=__HIVE_DEFAULT_PARTITION__,d=2).a SIMPLE []
 POSTHOOK: Lineage: ptestfilter_n2_temp PARTITION(c=__HIVE_DEFAULT_PARTITION__,d=2).b SIMPLE []
@@ -192,6 +198,7 @@ PREHOOK: Output: default@ptestfilter_n2_temp
 POSTHOOK: query: INSERT OVERWRITE TABLE ptestfilter_n2_temp PARTITION (c,d) select 'Col2', 2, null, 3
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@ptestfilter_n2_temp
 POSTHOOK: Output: default@ptestfilter_n2_temp@c=__HIVE_DEFAULT_PARTITION__/d=3
 POSTHOOK: Lineage: ptestfilter_n2_temp PARTITION(c=__HIVE_DEFAULT_PARTITION__,d=3).a SIMPLE []
 POSTHOOK: Lineage: ptestfilter_n2_temp PARTITION(c=__HIVE_DEFAULT_PARTITION__,d=3).b SIMPLE []
@@ -202,6 +209,7 @@ PREHOOK: Output: default@ptestfilter_n2_temp
 POSTHOOK: query: INSERT OVERWRITE TABLE ptestfilter_n2_temp PARTITION (c,d) select 'Col3', 3, 'Uganda', null
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@ptestfilter_n2_temp
 POSTHOOK: Output: default@ptestfilter_n2_temp@c=Uganda/d=__HIVE_DEFAULT_PARTITION__
 POSTHOOK: Lineage: ptestfilter_n2_temp PARTITION(c=Uganda,d=__HIVE_DEFAULT_PARTITION__).a SIMPLE []
 POSTHOOK: Lineage: ptestfilter_n2_temp PARTITION(c=Uganda,d=__HIVE_DEFAULT_PARTITION__).b SIMPLE []
diff --git a/ql/src/test/results/clientpositive/llap/temp_table_insert_values_dynamic_partitioned.q.out b/ql/src/test/results/clientpositive/llap/temp_table_insert_values_dynamic_partitioned.q.out
index 6f3e30fe14..772934263e 100644
--- a/ql/src/test/results/clientpositive/llap/temp_table_insert_values_dynamic_partitioned.q.out
+++ b/ql/src/test/results/clientpositive/llap/temp_table_insert_values_dynamic_partitioned.q.out
@@ -21,6 +21,7 @@ POSTHOOK: query: insert into table ivdp_temp partition (ds) values
 (6553, 923.19, 'the lamb was sure to go', 'tomorrow')
 POSTHOOK: type: QUERY
 POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@ivdp_temp
 POSTHOOK: Output: default@ivdp_temp@ds=today
 POSTHOOK: Output: default@ivdp_temp@ds=tomorrow
 POSTHOOK: Lineage: ivdp_temp PARTITION(ds=today).de SCRIPT []
diff --git a/ql/src/test/results/clientpositive/llap/temp_table_insert_with_move_files_from_source_dir.q.out b/ql/src/test/results/clientpositive/llap/temp_table_insert_with_move_files_from_source_dir.q.out
index b6dd9cc601..fbeb02aa5f 100644
--- a/ql/src/test/results/clientpositive/llap/temp_table_insert_with_move_files_from_source_dir.q.out
+++ b/ql/src/test/results/clientpositive/llap/temp_table_insert_with_move_files_from_source_dir.q.out
@@ -83,6 +83,7 @@ PREHOOK: Output: default@emp1_temp_part_bucket_temp
 POSTHOOK: query: insert overwrite table emp1_temp_part_bucket_temp partition (dept, country) select * from emp1_temp
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@emp1_temp
+POSTHOOK: Output: default@emp1_temp_part_bucket_temp
 POSTHOOK: Output: default@emp1_temp_part_bucket_temp@dept=2000/country=UK
 POSTHOOK: Output: default@emp1_temp_part_bucket_temp@dept=2000/country=USA
 POSTHOOK: Output: default@emp1_temp_part_bucket_temp@dept=3000/country=UK
diff --git a/ql/src/test/results/clientpositive/llap/temp_table_llap_partitioned.q.out b/ql/src/test/results/clientpositive/llap/temp_table_llap_partitioned.q.out
index 42a4e94855..892db33b58 100644
--- a/ql/src/test/results/clientpositive/llap/temp_table_llap_partitioned.q.out
+++ b/ql/src/test/results/clientpositive/llap/temp_table_llap_partitioned.q.out
@@ -75,6 +75,7 @@ POSTHOOK: query: INSERT OVERWRITE TABLE orc_llap_part_temp PARTITION (ctinyint)
   SELECT csmallint, cint, cbigint, cfloat, cdouble, cstring1, cstring1, cstring1, cboolean1, cboolean2, ctinyint FROM alltypesorc
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc
+POSTHOOK: Output: default@orc_llap_part_temp
 POSTHOOK: Output: default@orc_llap_part_temp@ctinyint=-1
 POSTHOOK: Output: default@orc_llap_part_temp@ctinyint=-10
 POSTHOOK: Output: default@orc_llap_part_temp@ctinyint=-11
@@ -1492,6 +1493,7 @@ POSTHOOK: query: INSERT OVERWRITE TABLE orc_llap_dim_part_temp PARTITION (ctinyi
   SELECT null, null, sum(cbigint) as cbigint, null, null, null, null, null, null, null, ctinyint FROM alltypesorc WHERE ctinyint > 10 AND ctinyint < 21 GROUP BY ctinyint
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc
+POSTHOOK: Output: default@orc_llap_dim_part_temp
 POSTHOOK: Output: default@orc_llap_dim_part_temp@ctinyint=11
 POSTHOOK: Output: default@orc_llap_dim_part_temp@ctinyint=12
 POSTHOOK: Output: default@orc_llap_dim_part_temp@ctinyint=13
diff --git a/ql/src/test/results/clientpositive/llap/temp_table_load_dyn_part1.q.out b/ql/src/test/results/clientpositive/llap/temp_table_load_dyn_part1.q.out
index 9503e58a59..1bbf040d59 100644
--- a/ql/src/test/results/clientpositive/llap/temp_table_load_dyn_part1.q.out
+++ b/ql/src/test/results/clientpositive/llap/temp_table_load_dyn_part1.q.out
@@ -63,6 +63,7 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
+POSTHOOK: Output: default@temp_part1_n0
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
   Stage-3 depends on stages: Stage-2
@@ -171,6 +172,7 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
+POSTHOOK: Output: default@temp_part1_n0
 POSTHOOK: Output: default@temp_part1_n0@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@temp_part1_n0@ds=2008-04-08/hr=12
 POSTHOOK: Output: default@temp_part2_n0@ds=2008-12-31/hr=11
diff --git a/ql/src/test/results/clientpositive/llap/temp_table_merge_dynamic_partition.q.out b/ql/src/test/results/clientpositive/llap/temp_table_merge_dynamic_partition.q.out
index a822699b29..1c40489871 100644
--- a/ql/src/test/results/clientpositive/llap/temp_table_merge_dynamic_partition.q.out
+++ b/ql/src/test/results/clientpositive/llap/temp_table_merge_dynamic_partition.q.out
@@ -1325,6 +1325,7 @@ insert overwrite table merge_dynamic_part_n1_temp partition (ds, hr) select key,
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcpart_merge_dp_n1_temp
 POSTHOOK: Input: default@srcpart_merge_dp_n1_temp@ds=2008-04-08/hr=11
+POSTHOOK: Output: default@merge_dynamic_part_n1_temp
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -1403,6 +1404,7 @@ POSTHOOK: query: insert overwrite table merge_dynamic_part_n1_temp partition (ds
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcpart_merge_dp_n1_temp
 POSTHOOK: Input: default@srcpart_merge_dp_n1_temp@ds=2008-04-08/hr=11
+POSTHOOK: Output: default@merge_dynamic_part_n1_temp
 POSTHOOK: Output: default@merge_dynamic_part_n1_temp@ds=2008-04-08/hr=11
 POSTHOOK: Lineage: merge_dynamic_part_n1_temp PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart_merge_dp_n1_temp)srcpart_merge_dp_n1_temp.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: merge_dynamic_part_n1_temp PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart_merge_dp_n1_temp)srcpart_merge_dp_n1_temp.FieldSchema(name:value, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/llap/temp_table_merge_dynamic_partition3.q.out b/ql/src/test/results/clientpositive/llap/temp_table_merge_dynamic_partition3.q.out
index 9d6669d266..57b42d696e 100644
--- a/ql/src/test/results/clientpositive/llap/temp_table_merge_dynamic_partition3.q.out
+++ b/ql/src/test/results/clientpositive/llap/temp_table_merge_dynamic_partition3.q.out
@@ -141,6 +141,7 @@ POSTHOOK: Input: default@srcpart_merge_dp_n2_temp@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart_merge_dp_n2_temp@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart_merge_dp_n2_temp@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart_merge_dp_n2_temp@ds=2008-04-09/hr=12
+POSTHOOK: Output: default@merge_dynamic_part_n2_temp
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -225,6 +226,7 @@ POSTHOOK: Input: default@srcpart_merge_dp_n2_temp@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart_merge_dp_n2_temp@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart_merge_dp_n2_temp@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart_merge_dp_n2_temp@ds=2008-04-09/hr=12
+POSTHOOK: Output: default@merge_dynamic_part_n2_temp
 POSTHOOK: Output: default@merge_dynamic_part_n2_temp@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@merge_dynamic_part_n2_temp@ds=2008-04-08/hr=12
 POSTHOOK: Output: default@merge_dynamic_part_n2_temp@ds=2008-04-09/hr=11
diff --git a/ql/src/test/results/clientpositive/llap/temp_table_parquet_partitioned.q.out b/ql/src/test/results/clientpositive/llap/temp_table_parquet_partitioned.q.out
index e48b0ef088..d08b470d59 100644
--- a/ql/src/test/results/clientpositive/llap/temp_table_parquet_partitioned.q.out
+++ b/ql/src/test/results/clientpositive/llap/temp_table_parquet_partitioned.q.out
@@ -105,6 +105,7 @@ PREHOOK: Output: default@parquet_partitioned_temp
 POSTHOOK: query: INSERT OVERWRITE TABLE parquet_partitioned_temp PARTITION (part) SELECT * FROM parquet_partitioned_staging_temp
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@parquet_partitioned_staging_temp
+POSTHOOK: Output: default@parquet_partitioned_temp
 POSTHOOK: Output: default@parquet_partitioned_temp@part=part1
 POSTHOOK: Output: default@parquet_partitioned_temp@part=part2
 POSTHOOK: Lineage: parquet_partitioned_temp PARTITION(part=part1).id SIMPLE [(parquet_partitioned_staging_temp)parquet_partitioned_staging_temp.FieldSchema(name:id, type:int, comment:null), ]
diff --git a/ql/src/test/results/clientpositive/llap/temp_table_partition_ctas.q.out b/ql/src/test/results/clientpositive/llap/temp_table_partition_ctas.q.out
index 9a3b4ec01a..cdb674c476 100644
--- a/ql/src/test/results/clientpositive/llap/temp_table_partition_ctas.q.out
+++ b/ql/src/test/results/clientpositive/llap/temp_table_partition_ctas.q.out
@@ -13,6 +13,7 @@ POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@partition_ctas_1_temp
+POSTHOOK: Output: default@partition_ctas_1_temp
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -109,6 +110,7 @@ POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@partition_ctas_1_temp
+POSTHOOK: Output: default@partition_ctas_1_temp
 POSTHOOK: Output: default@partition_ctas_1_temp@key=201
 POSTHOOK: Output: default@partition_ctas_1_temp@key=202
 POSTHOOK: Output: default@partition_ctas_1_temp@key=203
@@ -325,6 +327,7 @@ POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@partition_ctas_2_temp
+POSTHOOK: Output: default@partition_ctas_2_temp
 POSTHOOK: Output: default@partition_ctas_2_temp@value=val_201
 POSTHOOK: Output: default@partition_ctas_2_temp@value=val_202
 POSTHOOK: Output: default@partition_ctas_2_temp@value=val_203
@@ -788,6 +791,7 @@ POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@partition_ctas_diff_order_temp
+POSTHOOK: Output: default@partition_ctas_diff_order_temp
 POSTHOOK: Output: default@partition_ctas_diff_order_temp@value=val_201
 POSTHOOK: Output: default@partition_ctas_diff_order_temp@value=val_202
 POSTHOOK: Output: default@partition_ctas_diff_order_temp@value=val_203
@@ -977,6 +981,7 @@ POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@partition_ctas_complex_order_temp
+POSTHOOK: Output: default@partition_ctas_complex_order_temp
 POSTHOOK: Output: default@partition_ctas_complex_order_temp@c0=val_201_0/c4=val_201_4/c1=val_201_1
 POSTHOOK: Output: default@partition_ctas_complex_order_temp@c0=val_202_0/c4=val_202_4/c1=val_202_1
 POSTHOOK: Output: default@partition_ctas_complex_order_temp@c0=val_203_0/c4=val_203_4/c1=val_203_1
diff --git a/ql/src/test/results/clientpositive/llap/temp_table_partition_decode_name.q.out b/ql/src/test/results/clientpositive/llap/temp_table_partition_decode_name.q.out
index 7310182998..deaaf3d8f3 100644
--- a/ql/src/test/results/clientpositive/llap/temp_table_partition_decode_name.q.out
+++ b/ql/src/test/results/clientpositive/llap/temp_table_partition_decode_name.q.out
@@ -33,6 +33,7 @@ PREHOOK: Output: default@sc_part_n0_temp
 POSTHOOK: query: insert overwrite table sc_part_n0_temp partition(ts) select * from sc_n0_temp
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@sc_n0_temp
+POSTHOOK: Output: default@sc_part_n0_temp
 POSTHOOK: Output: default@sc_part_n0_temp@ts=2011-01-11+14%3A18%3A26
 POSTHOOK: Output: default@sc_part_n0_temp@ts=2011-01-11+15%3A18%3A26
 POSTHOOK: Output: default@sc_part_n0_temp@ts=2011-01-11+16%3A18%3A26
@@ -64,6 +65,7 @@ PREHOOK: Output: default@sc_part_n0_temp
 POSTHOOK: query: insert overwrite table sc_part_n0_temp partition(ts) select * from sc_n0_temp
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@sc_n0_temp
+POSTHOOK: Output: default@sc_part_n0_temp
 POSTHOOK: Output: default@sc_part_n0_temp@ts=2011-01-11+14%3A18%3A26
 POSTHOOK: Output: default@sc_part_n0_temp@ts=2011-01-11+15%3A18%3A26
 POSTHOOK: Output: default@sc_part_n0_temp@ts=2011-01-11+16%3A18%3A26
diff --git a/ql/src/test/results/clientpositive/llap/temp_table_partition_special_char.q.out b/ql/src/test/results/clientpositive/llap/temp_table_partition_special_char.q.out
index e1b3457652..dd29ff22a9 100644
--- a/ql/src/test/results/clientpositive/llap/temp_table_partition_special_char.q.out
+++ b/ql/src/test/results/clientpositive/llap/temp_table_partition_special_char.q.out
@@ -33,6 +33,7 @@ PREHOOK: Output: default@sc_part_temp
 POSTHOOK: query: insert overwrite table sc_part_temp partition(ts) select * from sc_temp
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@sc_temp
+POSTHOOK: Output: default@sc_part_temp
 POSTHOOK: Output: default@sc_part_temp@ts=2011-01-11+14%3A18%3A26
 POSTHOOK: Output: default@sc_part_temp@ts=2011-01-11+15%3A18%3A26
 POSTHOOK: Output: default@sc_part_temp@ts=2011-01-11+16%3A18%3A26
@@ -64,6 +65,7 @@ PREHOOK: Output: default@sc_part_temp
 POSTHOOK: query: insert overwrite table sc_part_temp partition(ts) select * from sc_temp
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@sc_temp
+POSTHOOK: Output: default@sc_part_temp
 POSTHOOK: Output: default@sc_part_temp@ts=2011-01-11+14%3A18%3A26
 POSTHOOK: Output: default@sc_part_temp@ts=2011-01-11+15%3A18%3A26
 POSTHOOK: Output: default@sc_part_temp@ts=2011-01-11+16%3A18%3A26
diff --git a/ql/src/test/results/clientpositive/llap/tez_acid_union_dynamic_partition.q.out b/ql/src/test/results/clientpositive/llap/tez_acid_union_dynamic_partition.q.out
index 07b0efb5a3..e2c7c0478a 100644
--- a/ql/src/test/results/clientpositive/llap/tez_acid_union_dynamic_partition.q.out
+++ b/ql/src/test/results/clientpositive/llap/tez_acid_union_dynamic_partition.q.out
@@ -47,6 +47,7 @@ union all
 select 2 as id1, '2014' as part1 from dummy_n2 ) temps
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@dummy_n2
+POSTHOOK: Output: default@partunion1
 POSTHOOK: Output: default@partunion1@part1=2014
 POSTHOOK: Lineage: partunion1 PARTITION(part1=2014).id1 EXPRESSION []
 PREHOOK: query: select * from partunion1
diff --git a/ql/src/test/results/clientpositive/llap/tez_acid_union_dynamic_partition_2.q.out b/ql/src/test/results/clientpositive/llap/tez_acid_union_dynamic_partition_2.q.out
index 7e664e4cf4..9a068ed195 100644
--- a/ql/src/test/results/clientpositive/llap/tez_acid_union_dynamic_partition_2.q.out
+++ b/ql/src/test/results/clientpositive/llap/tez_acid_union_dynamic_partition_2.q.out
@@ -53,6 +53,7 @@ union all
 select 2 as id1, '2014' as part1 from dummy_n7
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@dummy_n7
+POSTHOOK: Output: default@partunion1_n0
 POSTHOOK: Output: default@partunion1_n0@part1=2014
 POSTHOOK: Lineage: partunion1_n0 PARTITION(part1=2014).id1 EXPRESSION []
 PREHOOK: query: select * from partunion1_n0
diff --git a/ql/src/test/results/clientpositive/llap/tez_compile_counters.q.out b/ql/src/test/results/clientpositive/llap/tez_compile_counters.q.out
index 1d31fdee42..f6f457765a 100644
--- a/ql/src/test/results/clientpositive/llap/tez_compile_counters.q.out
+++ b/ql/src/test/results/clientpositive/llap/tez_compile_counters.q.out
@@ -13,6 +13,7 @@ PREHOOK: Output: default@testpart
 POSTHOOK: query: insert overwrite table testpart partition(v) select * from src
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
+POSTHOOK: Output: default@testpart
 POSTHOOK: Output: default@testpart@v=val_0
 POSTHOOK: Output: default@testpart@v=val_10
 POSTHOOK: Output: default@testpart@v=val_100
@@ -638,6 +639,7 @@ PREHOOK: Output: default@testpart
 POSTHOOK: query: insert into table testpart partition(v) select * from src
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
+POSTHOOK: Output: default@testpart
 POSTHOOK: Output: default@testpart@v=val_0
 POSTHOOK: Output: default@testpart@v=val_10
 POSTHOOK: Output: default@testpart@v=val_100
diff --git a/ql/src/test/results/clientpositive/llap/tez_dml.q.out b/ql/src/test/results/clientpositive/llap/tez_dml.q.out
index b5c14caa8c..93b5a85cf4 100644
--- a/ql/src/test/results/clientpositive/llap/tez_dml.q.out
+++ b/ql/src/test/results/clientpositive/llap/tez_dml.q.out
@@ -469,6 +469,7 @@ PREHOOK: Output: default@tmp_src_part
 POSTHOOK: query: EXPLAIN INSERT INTO TABLE tmp_src_part PARTITION (d) SELECT * FROM tmp_src
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@tmp_src
+POSTHOOK: Output: default@tmp_src_part
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -571,6 +572,7 @@ PREHOOK: Output: default@tmp_src_part
 POSTHOOK: query: INSERT INTO TABLE tmp_src_part PARTITION (d) SELECT * FROM tmp_src
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@tmp_src
+POSTHOOK: Output: default@tmp_src_part
 POSTHOOK: Output: default@tmp_src_part@d=1
 POSTHOOK: Output: default@tmp_src_part@d=2
 POSTHOOK: Output: default@tmp_src_part@d=3
diff --git a/ql/src/test/results/clientpositive/llap/tez_input_counters.q.out b/ql/src/test/results/clientpositive/llap/tez_input_counters.q.out
index 393fdc3fda..dc3d1c7370 100644
--- a/ql/src/test/results/clientpositive/llap/tez_input_counters.q.out
+++ b/ql/src/test/results/clientpositive/llap/tez_input_counters.q.out
@@ -13,6 +13,7 @@ PREHOOK: Output: default@testpart
 POSTHOOK: query: insert overwrite table testpart partition(v) select * from src
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
+POSTHOOK: Output: default@testpart
 POSTHOOK: Output: default@testpart@v=val_0
 POSTHOOK: Output: default@testpart@v=val_10
 POSTHOOK: Output: default@testpart@v=val_100
@@ -638,6 +639,7 @@ PREHOOK: Output: default@testpart
 POSTHOOK: query: insert into table testpart partition(v) select * from src
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
+POSTHOOK: Output: default@testpart
 POSTHOOK: Output: default@testpart@v=val_0
 POSTHOOK: Output: default@testpart@v=val_10
 POSTHOOK: Output: default@testpart@v=val_100
diff --git a/ql/src/test/results/clientpositive/llap/tez_union_dynamic_partition.q.out b/ql/src/test/results/clientpositive/llap/tez_union_dynamic_partition.q.out
index 62547749b6..823c88d918 100644
--- a/ql/src/test/results/clientpositive/llap/tez_union_dynamic_partition.q.out
+++ b/ql/src/test/results/clientpositive/llap/tez_union_dynamic_partition.q.out
@@ -47,6 +47,7 @@ union all
 select 2 as id1, '2014' as part1 from dummy_n2 ) temps
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@dummy_n2
+POSTHOOK: Output: default@partunion1
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -206,6 +207,7 @@ union all
 select 2 as id1, '2014' as part1 from dummy_n2 ) temps
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@dummy_n2
+POSTHOOK: Output: default@partunion1
 POSTHOOK: Output: default@partunion1@part1=2014
 POSTHOOK: Lineage: partunion1 PARTITION(part1=2014).id1 EXPRESSION []
 PREHOOK: query: select * from partunion1
diff --git a/ql/src/test/results/clientpositive/llap/tez_union_dynamic_partition_2.q.out b/ql/src/test/results/clientpositive/llap/tez_union_dynamic_partition_2.q.out
index b5512f7ad7..37d2bb5b76 100644
--- a/ql/src/test/results/clientpositive/llap/tez_union_dynamic_partition_2.q.out
+++ b/ql/src/test/results/clientpositive/llap/tez_union_dynamic_partition_2.q.out
@@ -55,6 +55,7 @@ union all
 select 2 as id1, '2014' as part1 from dummy_n7 ) temps
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@dummy_n7
+POSTHOOK: Output: default@partunion1_n0
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-8 depends on stages: Stage-1 , consists of Stage-5, Stage-4, Stage-6
@@ -254,6 +255,7 @@ union all
 select 2 as id1, '2014' as part1 from dummy_n7
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@dummy_n7
+POSTHOOK: Output: default@partunion1_n0
 POSTHOOK: Output: default@partunion1_n0@part1=2014
 POSTHOOK: Lineage: partunion1_n0 PARTITION(part1=2014).id1 EXPRESSION []
 PREHOOK: query: select * from partunion1_n0
diff --git a/ql/src/test/results/clientpositive/llap/tunable_ndv.q.out b/ql/src/test/results/clientpositive/llap/tunable_ndv.q.out
index d03a67952d..a2b0efbf7b 100644
--- a/ql/src/test/results/clientpositive/llap/tunable_ndv.q.out
+++ b/ql/src/test/results/clientpositive/llap/tunable_ndv.q.out
@@ -47,6 +47,7 @@ PREHOOK: Output: default@loc_orc_1d_n2
 POSTHOOK: query: insert overwrite table loc_orc_1d_n2 partition(year) select * from ext_loc_n2
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@ext_loc_n2
+POSTHOOK: Output: default@loc_orc_1d_n2
 POSTHOOK: Output: default@loc_orc_1d_n2@year=2000
 POSTHOOK: Output: default@loc_orc_1d_n2@year=2001
 POSTHOOK: Lineage: loc_orc_1d_n2 PARTITION(year=2000).locid SIMPLE [(ext_loc_n2)ext_loc_n2.FieldSchema(name:locid, type:int, comment:null), ]
@@ -187,6 +188,7 @@ PREHOOK: Output: default@loc_orc_2d_n2
 POSTHOOK: query: insert overwrite table loc_orc_2d_n2 partition(zip, year) select * from ext_loc_n2
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@ext_loc_n2
+POSTHOOK: Output: default@loc_orc_2d_n2
 POSTHOOK: Output: default@loc_orc_2d_n2@zip=94086/year=2000
 POSTHOOK: Output: default@loc_orc_2d_n2@zip=94086/year=2001
 POSTHOOK: Output: default@loc_orc_2d_n2@zip=94087/year=2000
diff --git a/ql/src/test/results/clientpositive/llap/union_remove_15.q.out b/ql/src/test/results/clientpositive/llap/union_remove_15.q.out
index b02938da01..8877b20ecc 100644
--- a/ql/src/test/results/clientpositive/llap/union_remove_15.q.out
+++ b/ql/src/test/results/clientpositive/llap/union_remove_15.q.out
@@ -43,6 +43,7 @@ FROM (
 ) a
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@inputtbl1_n18
+POSTHOOK: Output: default@outputtbl1_n25
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -149,6 +150,7 @@ FROM (
 ) a
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@inputtbl1_n18
+POSTHOOK: Output: default@outputtbl1_n25
 POSTHOOK: Output: default@outputtbl1_n25@ds=1
 POSTHOOK: Output: default@outputtbl1_n25@ds=2
 POSTHOOK: Lineage: outputtbl1_n25 PARTITION(ds=1).key EXPRESSION [(inputtbl1_n18)inputtbl1_n18.FieldSchema(name:key, type:string, comment:null), ]
diff --git a/ql/src/test/results/clientpositive/llap/union_remove_16.q.out b/ql/src/test/results/clientpositive/llap/union_remove_16.q.out
index 6d715f2fa5..b4b8485f76 100644
--- a/ql/src/test/results/clientpositive/llap/union_remove_16.q.out
+++ b/ql/src/test/results/clientpositive/llap/union_remove_16.q.out
@@ -43,6 +43,7 @@ FROM (
 ) a
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@inputtbl1_n23
+POSTHOOK: Output: default@outputtbl1_n32
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -149,6 +150,7 @@ FROM (
 ) a
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@inputtbl1_n23
+POSTHOOK: Output: default@outputtbl1_n32
 POSTHOOK: Output: default@outputtbl1_n32@ds=1
 POSTHOOK: Output: default@outputtbl1_n32@ds=2
 POSTHOOK: Lineage: outputtbl1_n32 PARTITION(ds=1).key EXPRESSION [(inputtbl1_n23)inputtbl1_n23.FieldSchema(name:key, type:string, comment:null), ]
diff --git a/ql/src/test/results/clientpositive/llap/union_remove_17.q.out b/ql/src/test/results/clientpositive/llap/union_remove_17.q.out
index 48b60f8a09..faa93f6541 100644
--- a/ql/src/test/results/clientpositive/llap/union_remove_17.q.out
+++ b/ql/src/test/results/clientpositive/llap/union_remove_17.q.out
@@ -43,6 +43,7 @@ FROM (
 ) a
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@inputtbl1_n3
+POSTHOOK: Output: default@outputtbl1_n4
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -154,6 +155,7 @@ FROM (
 ) a
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@inputtbl1_n3
+POSTHOOK: Output: default@outputtbl1_n4
 POSTHOOK: Output: default@outputtbl1_n4@ds=1
 POSTHOOK: Output: default@outputtbl1_n4@ds=2
 POSTHOOK: Lineage: outputtbl1_n4 PARTITION(ds=1).key EXPRESSION [(inputtbl1_n3)inputtbl1_n3.FieldSchema(name:key, type:string, comment:null), ]
diff --git a/ql/src/test/results/clientpositive/llap/union_remove_18.q.out b/ql/src/test/results/clientpositive/llap/union_remove_18.q.out
index 93b77f3baf..ebbf329bb7 100644
--- a/ql/src/test/results/clientpositive/llap/union_remove_18.q.out
+++ b/ql/src/test/results/clientpositive/llap/union_remove_18.q.out
@@ -43,6 +43,7 @@ FROM (
 ) a
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@inputtbl1_n22
+POSTHOOK: Output: default@outputtbl1_n30
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -145,6 +146,7 @@ FROM (
 ) a
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@inputtbl1_n22
+POSTHOOK: Output: default@outputtbl1_n30
 POSTHOOK: Output: default@outputtbl1_n30@ds=11
 POSTHOOK: Output: default@outputtbl1_n30@ds=12
 POSTHOOK: Output: default@outputtbl1_n30@ds=13
diff --git a/ql/src/test/results/clientpositive/llap/union_remove_25.q.out b/ql/src/test/results/clientpositive/llap/union_remove_25.q.out
index 1cbc43b2fe..12a9a5d978 100644
--- a/ql/src/test/results/clientpositive/llap/union_remove_25.q.out
+++ b/ql/src/test/results/clientpositive/llap/union_remove_25.q.out
@@ -240,6 +240,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcpart
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
+POSTHOOK: Output: default@outputtbl2_n6
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -343,6 +344,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcpart
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
+POSTHOOK: Output: default@outputtbl2_n6
 POSTHOOK: Output: default@outputtbl2_n6@ds=2008-04-08
 POSTHOOK: Lineage: outputtbl2_n6 PARTITION(ds=2008-04-08).key EXPRESSION [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: outputtbl2_n6 PARTITION(ds=2008-04-08).values EXPRESSION [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
@@ -410,6 +412,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcpart
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
+POSTHOOK: Output: default@outputtbl3_n3
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
@@ -514,6 +517,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcpart
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
+POSTHOOK: Output: default@outputtbl3_n3
 POSTHOOK: Output: default@outputtbl3_n3@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@outputtbl3_n3@ds=2008-04-08/hr=12
 POSTHOOK: Lineage: outputtbl3_n3 PARTITION(ds=2008-04-08,hr=11).key EXPRESSION [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/llap/unionall_lateralview1.q.out b/ql/src/test/results/clientpositive/llap/unionall_lateralview1.q.out
index ff8dd70ac1..22af6af98a 100644
--- a/ql/src/test/results/clientpositive/llap/unionall_lateralview1.q.out
+++ b/ql/src/test/results/clientpositive/llap/unionall_lateralview1.q.out
@@ -71,6 +71,7 @@ select id, dts as dt from unionall_lv_src2 tt lateral view explode(tt.dates) dd
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@unionall_lv_src1
 POSTHOOK: Input: default@unionall_lv_src2
+POSTHOOK: Output: default@unionall_lv_dest
 POSTHOOK: Output: default@unionall_lv_dest@dt=2019-01-01
 POSTHOOK: Output: default@unionall_lv_dest@dt=2019-01-02
 POSTHOOK: Output: default@unionall_lv_dest@dt=2019-01-03
diff --git a/ql/src/test/results/clientpositive/llap/updateAccessTime.q.out b/ql/src/test/results/clientpositive/llap/updateAccessTime.q.out
index 093aa2a791..df0f77b434 100644
--- a/ql/src/test/results/clientpositive/llap/updateAccessTime.q.out
+++ b/ql/src/test/results/clientpositive/llap/updateAccessTime.q.out
@@ -78,6 +78,7 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
+POSTHOOK: Output: default@tstsrcpart_n1
 POSTHOOK: Output: default@tstsrcpart_n1@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@tstsrcpart_n1@ds=2008-04-08/hr=12
 POSTHOOK: Output: default@tstsrcpart_n1@ds=2008-04-09/hr=11
diff --git a/ql/src/test/results/clientpositive/llap/vector_count_distinct.q.out b/ql/src/test/results/clientpositive/llap/vector_count_distinct.q.out
index f4017fdec9..212d6952cf 100644
--- a/ql/src/test/results/clientpositive/llap/vector_count_distinct.q.out
+++ b/ql/src/test/results/clientpositive/llap/vector_count_distinct.q.out
@@ -205,6 +205,7 @@ select ws_sold_date_sk, ws_sold_time_sk, ws_ship_date_sk, ws_item_sk,
        ws_net_paid_inc_ship_tax, ws_net_profit, ws_web_site_sk from web_sales_txt
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@web_sales_txt
+POSTHOOK: Output: default@web_sales
 POSTHOOK: Output: default@web_sales@ws_web_site_sk=1
 POSTHOOK: Output: default@web_sales@ws_web_site_sk=10
 POSTHOOK: Output: default@web_sales@ws_web_site_sk=11
diff --git a/ql/src/test/results/clientpositive/llap/vector_orc_nested_column_pruning.q.out b/ql/src/test/results/clientpositive/llap/vector_orc_nested_column_pruning.q.out
index 789e639716..8f75b1885e 100644
--- a/ql/src/test/results/clientpositive/llap/vector_orc_nested_column_pruning.q.out
+++ b/ql/src/test/results/clientpositive/llap/vector_orc_nested_column_pruning.q.out
@@ -2264,6 +2264,7 @@ SELECT s1.f1 AS f1, S1.f2 AS f2, s1.f6 AS f3
 FROM nested_tbl_1
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@nested_tbl_1
+POSTHOOK: Output: default@nested_tbl_3
 POSTHOOK: Output: default@nested_tbl_3@f3=4
 POSTHOOK: Lineage: nested_tbl_3 PARTITION(f3=4).f1 EXPRESSION [(nested_tbl_1)nested_tbl_1.FieldSchema(name:s1, type:struct<f1:boolean,f2:string,f3:struct<f4:int,f5:double>,f6:int>, comment:null), ]
 POSTHOOK: Lineage: nested_tbl_3 PARTITION(f3=4).f2 EXPRESSION [(nested_tbl_1)nested_tbl_1.FieldSchema(name:s1, type:struct<f1:boolean,f2:string,f3:struct<f4:int,f5:double>,f6:int>, comment:null), ]
diff --git a/ql/src/test/results/clientpositive/llap/vector_partitioned_date_time.q.out b/ql/src/test/results/clientpositive/llap/vector_partitioned_date_time.q.out
index 2c9c7aa8ac..3681a59d5b 100644
--- a/ql/src/test/results/clientpositive/llap/vector_partitioned_date_time.q.out
+++ b/ql/src/test/results/clientpositive/llap/vector_partitioned_date_time.q.out
@@ -610,6 +610,7 @@ SELECT  origin_city_name, dest_city_name, fl_time, arr_delay, fl_num, fl_date
 FROM flights_tiny_orc
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@flights_tiny_orc
+POSTHOOK: Output: default@flights_tiny_orc_partitioned_date
 POSTHOOK: Output: default@flights_tiny_orc_partitioned_date@fl_date=2010-10-20
 POSTHOOK: Output: default@flights_tiny_orc_partitioned_date@fl_date=2010-10-21
 POSTHOOK: Output: default@flights_tiny_orc_partitioned_date@fl_date=2010-10-22
@@ -1673,6 +1674,7 @@ SELECT  origin_city_name, dest_city_name, fl_date, arr_delay, fl_num, fl_time
 FROM flights_tiny_orc
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@flights_tiny_orc
+POSTHOOK: Output: default@flights_tiny_orc_partitioned_timestamp
 POSTHOOK: Output: default@flights_tiny_orc_partitioned_timestamp@fl_time=2010-10-20 07%3A00%3A00
 POSTHOOK: Output: default@flights_tiny_orc_partitioned_timestamp@fl_time=2010-10-21 07%3A00%3A00
 POSTHOOK: Output: default@flights_tiny_orc_partitioned_timestamp@fl_time=2010-10-22 07%3A00%3A00
@@ -3283,6 +3285,7 @@ SELECT  origin_city_name, dest_city_name, fl_time, arr_delay, fl_num, fl_date
 FROM flights_tiny_parquet
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@flights_tiny_parquet
+POSTHOOK: Output: default@flights_tiny_parquet_partitioned_date
 POSTHOOK: Output: default@flights_tiny_parquet_partitioned_date@fl_date=2010-10-20
 POSTHOOK: Output: default@flights_tiny_parquet_partitioned_date@fl_date=2010-10-21
 POSTHOOK: Output: default@flights_tiny_parquet_partitioned_date@fl_date=2010-10-22
@@ -4346,6 +4349,7 @@ SELECT  origin_city_name, dest_city_name, fl_date, arr_delay, fl_num, fl_time
 FROM flights_tiny_parquet
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@flights_tiny_parquet
+POSTHOOK: Output: default@flights_tiny_parquet_partitioned_timestamp
 POSTHOOK: Output: default@flights_tiny_parquet_partitioned_timestamp@fl_time=2010-10-20 07%3A00%3A00
 POSTHOOK: Output: default@flights_tiny_parquet_partitioned_timestamp@fl_time=2010-10-21 07%3A00%3A00
 POSTHOOK: Output: default@flights_tiny_parquet_partitioned_timestamp@fl_time=2010-10-22 07%3A00%3A00
diff --git a/ql/src/test/results/clientpositive/llap/vectorized_dynamic_partition_pruning.q.out b/ql/src/test/results/clientpositive/llap/vectorized_dynamic_partition_pruning.q.out
index 56c84c7006..16d508c0fc 100644
--- a/ql/src/test/results/clientpositive/llap/vectorized_dynamic_partition_pruning.q.out
+++ b/ql/src/test/results/clientpositive/llap/vectorized_dynamic_partition_pruning.q.out
@@ -7585,6 +7585,7 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
+POSTHOOK: Output: default@srcpart_orc_n0
 POSTHOOK: Output: default@srcpart_orc_n0@ds=2008-04-08/hr=11
 POSTHOOK: Output: default@srcpart_orc_n0@ds=2008-04-08/hr=12
 POSTHOOK: Output: default@srcpart_orc_n0@ds=2008-04-09/hr=11
diff --git a/ql/src/test/results/clientpositive/perf/tez/constraints/mv_query44.q.out b/ql/src/test/results/clientpositive/perf/tez/constraints/mv_query44.q.out
index 6f3060ec8d..03988c4d5f 100644
--- a/ql/src/test/results/clientpositive/perf/tez/constraints/mv_query44.q.out
+++ b/ql/src/test/results/clientpositive/perf/tez/constraints/mv_query44.q.out
@@ -19,6 +19,7 @@ POSTHOOK: type: CREATE_MATERIALIZED_VIEW
 POSTHOOK: Input: default@store_sales
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@mv_store_sales_item_customer
+POSTHOOK: Output: default@mv_store_sales_item_customer
 Warning: Shuffle Join MERGEJOIN[112][tables = [$hdt$_1, $hdt$_2]] in Stage 'Reducer 3' is a cross product
 PREHOOK: query: explain
 select  asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing
diff --git a/ql/src/test/results/clientpositive/tez/vector_non_string_partition.q.out b/ql/src/test/results/clientpositive/tez/vector_non_string_partition.q.out
index f4d8003f03..0cd285f6a5 100644
--- a/ql/src/test/results/clientpositive/tez/vector_non_string_partition.q.out
+++ b/ql/src/test/results/clientpositive/tez/vector_non_string_partition.q.out
@@ -15,6 +15,7 @@ POSTHOOK: query: INSERT OVERWRITE TABLE non_string_part PARTITION(ctinyint) SELE
 WHERE ctinyint IS NULL AND cdouble IS NOT NULL ORDER BY cdouble
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc
+POSTHOOK: Output: default@non_string_part
 POSTHOOK: Output: default@non_string_part@ctinyint=__HIVE_DEFAULT_PARTITION__
 POSTHOOK: Lineage: non_string_part PARTITION(ctinyint=__HIVE_DEFAULT_PARTITION__).cdouble SIMPLE [(alltypesorc)alltypesorc.FieldSchema(name:cdouble, type:double, comment:null), ]
 POSTHOOK: Lineage: non_string_part PARTITION(ctinyint=__HIVE_DEFAULT_PARTITION__).cint SIMPLE [(alltypesorc)alltypesorc.FieldSchema(name:cint, type:int, comment:null), ]
