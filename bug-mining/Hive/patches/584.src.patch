diff --git a/cli/src/java/org/apache/hadoop/hive/cli/CliDriver.java b/cli/src/java/org/apache/hadoop/hive/cli/CliDriver.java
index 8d8310a1e9..1fb11e7abd 100644
--- a/cli/src/java/org/apache/hadoop/hive/cli/CliDriver.java
+++ b/cli/src/java/org/apache/hadoop/hive/cli/CliDriver.java
@@ -95,6 +95,7 @@ public int processCmd(String cmd) {
       // if we have come this far - either the previous commands
       // are all successful or this is command line. in either case
       // this counts as a successful run
+      ss.close();
       System.exit(0);
 
     } else if (tokens[0].equalsIgnoreCase("source")) {
diff --git a/cli/src/java/org/apache/hadoop/hive/cli/CliSessionState.java b/cli/src/java/org/apache/hadoop/hive/cli/CliSessionState.java
index d2267ab6ba..c693aeb35a 100644
--- a/cli/src/java/org/apache/hadoop/hive/cli/CliSessionState.java
+++ b/cli/src/java/org/apache/hadoop/hive/cli/CliSessionState.java
@@ -103,9 +103,10 @@ public int getPort() {
 
   public void close() {
     try {
-      client.clean();
-      client.shutdown();
-      transport.close();
+      if (remoteMode) {
+        client.clean();
+        transport.close();
+      }
     } catch (TException e) {
       e.printStackTrace();
     }
