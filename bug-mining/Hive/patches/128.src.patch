diff --git a/CHANGES.txt b/CHANGES.txt
index 304769f897..04ab071f91 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -64,6 +64,9 @@ Trunk - unreleased changes
     HIVE-426. Fix undeterministic query plan because of aliasToWork.
     (Namit Jain via zshao)
 
+    HIVE-404. Fix ordering in "SELECT * FROM t SORT BY col1 LIMIT 100" when
+    query is not a outer-most query.  (Namit Jain via zshao)
+
 Release 0.3.0 - Unreleased
 
   INCOMPATIBLE CHANGES
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
index d40cd5fa2f..c1a0c2b6c4 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
@@ -2351,8 +2351,8 @@ private Operator genLimitMapRedPlan(String dest, QB qb, Operator input, int limi
     // Add the limit operator to get the value fields
     Operator curr = genLimitPlan(dest, qb, input, limit);
 
-    // If it is a outer most query, the exact limit is applied by the fetch task
-    if (isOuterQuery)
+    // If it is a outer most query and no sorting is specified, exact limit is applied by the fetch task
+    if (isOuterQuery && !sortRequired(dest, qb))
       return curr;
 
     // Create a reduceSink operator followed by another limit
@@ -2360,6 +2360,21 @@ private Operator genLimitMapRedPlan(String dest, QB qb, Operator input, int limi
     return genLimitPlan(dest, qb, curr, limit);
   }
 
+  /*
+   * Is sorting reuired ?
+   * If there are no cluster by/sort by keys, then an additional map-reduce job is not needed.
+   * Else, sort the output by the relevant key (via another map-reduce job).
+   */
+  private boolean sortRequired(String dest, QB qb) {
+    if (qb.getParseInfo().getClusterByForClause(dest) != null)
+      return true;
+
+    if (qb.getParseInfo().getSortByForClause(dest) != null)
+      return true;
+    
+    return false;
+  }
+
   @SuppressWarnings("nls")
   private Operator genReduceSinkPlan(String dest, QB qb,
                                      Operator input, int numReducers) throws SemanticException {
diff --git a/ql/src/test/queries/clientpositive/input4_limit.q b/ql/src/test/queries/clientpositive/input4_limit.q
new file mode 100644
index 0000000000..e6e3c467fc
--- /dev/null
+++ b/ql/src/test/queries/clientpositive/input4_limit.q
@@ -0,0 +1,5 @@
+explain
+select * from src sort by key limit 10;
+
+
+select * from src sort by key limit 10;
diff --git a/ql/src/test/results/clientpositive/input4_limit.q.out b/ql/src/test/results/clientpositive/input4_limit.q.out
new file mode 100644
index 0000000000..f7d1223f67
--- /dev/null
+++ b/ql/src/test/results/clientpositive/input4_limit.q.out
@@ -0,0 +1,81 @@
+ABSTRACT SYNTAX TREE:
+  (TOK_QUERY (TOK_FROM (TOK_TABREF src)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR TOK_ALLCOLREF)) (TOK_SORTBY (TOK_TABSORTCOLNAMEASC (TOK_COLREF key))) (TOK_LIMIT 10)))
+
+STAGE DEPENDENCIES:
+  Stage-1 is a root stage
+  Stage-2 depends on stages: Stage-1
+  Stage-0 is a root stage
+
+STAGE PLANS:
+  Stage: Stage-1
+    Map Reduce
+      Alias -> Map Operator Tree:
+        src 
+            Select Operator
+              expressions:
+                    expr: key
+                    type: string
+                    expr: value
+                    type: string
+              Reduce Output Operator
+                key expressions:
+                      expr: 0
+                      type: string
+                sort order: +
+                tag: -1
+                value expressions:
+                      expr: 0
+                      type: string
+                      expr: 1
+                      type: string
+      Reduce Operator Tree:
+        Extract
+          Limit
+            File Output Operator
+              compressed: false
+              GlobalTableId: 0
+              table:
+                  input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                  output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+                  name: binary_table
+
+  Stage: Stage-2
+    Map Reduce
+      Alias -> Map Operator Tree:
+        /data/users/njain/hive1/hive/build/ql/tmp/528401691/102882840.10002 
+          Reduce Output Operator
+            key expressions:
+                  expr: 0
+                  type: string
+            sort order: +
+            tag: -1
+            value expressions:
+                  expr: 0
+                  type: string
+                  expr: 1
+                  type: string
+      Reduce Operator Tree:
+        Extract
+          Limit
+            File Output Operator
+              compressed: false
+              GlobalTableId: 0
+              table:
+                  input format: org.apache.hadoop.mapred.TextInputFormat
+                  output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+
+  Stage: Stage-0
+    Fetch Operator
+      limit: 10
+
+
+0	val_0
+0	val_0
+0	val_0
+10	val_10
+100	val_100
+100	val_100
+103	val_103
+103	val_103
+104	val_104
+104	val_104
