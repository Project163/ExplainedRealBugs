diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/vector/VectorColumnAssignFactory.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/vector/VectorColumnAssignFactory.java
index dda9aaee34..f63d416b5b 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/vector/VectorColumnAssignFactory.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/vector/VectorColumnAssignFactory.java
@@ -473,7 +473,7 @@ public static VectorColumnAssign[] buildAssigners(VectorizedRowBatch outputBatch
   public static VectorColumnAssign[] buildAssigners(VectorizedRowBatch outputBatch,
       Writable[] writables) throws HiveException {
     VectorColumnAssign[] vcas = new VectorColumnAssign[outputBatch.numCols];
-    for (int i = 0; i < outputBatch.numCols; ++i) {
+    for (int i = 0; i < writables.length; ++i) {
       if (writables[i] == null) {
         assert(outputBatch.cols[i] == null);
         vcas[i] = buildObjectAssign(outputBatch, i, PrimitiveCategory.VOID);
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/io/parquet/VectorizedParquetInputFormat.java b/ql/src/java/org/apache/hadoop/hive/ql/io/parquet/VectorizedParquetInputFormat.java
index ca71bbf715..d7edd52614 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/io/parquet/VectorizedParquetInputFormat.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/io/parquet/VectorizedParquetInputFormat.java
@@ -127,7 +127,7 @@ public boolean next(NullWritable key, VectorizedRowBatch outputBatch)
             assigners = VectorColumnAssignFactory.buildAssigners(outputBatch, writables);
           }
 
-          for(int i = 0; i < outputBatch.numCols; ++i) {
+          for(int i = 0; i < writables.length; ++i) {
             assigners[i].assignObjectValue(writables[i], outputBatch.size);
           }
           ++outputBatch.size;
