diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
index 876c28cec7..8d44907139 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
@@ -6991,6 +6991,14 @@ private void genMapRedTasks(QB qb) throws SemanticException {
         if (fetch.getTblDesc() != null) {
           PlanUtils.configureTableJobPropertiesForStorageHandler(
             fetch.getTblDesc());
+        } else if ( (fetch.getPartDesc() != null) && (!fetch.getPartDesc().isEmpty())){
+            PartitionDesc pd0 = fetch.getPartDesc().get(0);
+            TableDesc td = pd0.getTableDesc();
+            if ((td != null)&&(td.getProperties() != null) 
+                && td.getProperties().containsKey(
+                    org.apache.hadoop.hive.metastore.api.Constants.META_TABLE_STORAGE)){
+              PlanUtils.configureTableJobPropertiesForStorageHandler(td);
+            }
         }
         fetchTask = (FetchTask) TaskFactory.get(fetch, conf);
         setFetchTask(fetchTask);
