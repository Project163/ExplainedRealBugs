diff --git a/ql/src/test/queries/clientpositive/leadlag.q b/ql/src/test/queries/clientpositive/leadlag.q
index a8da962548..f497667710 100644
--- a/ql/src/test/queries/clientpositive/leadlag.q
+++ b/ql/src/test/queries/clientpositive/leadlag.q
@@ -43,7 +43,7 @@ from part p1 join part p2 on p1.p_partkey = p2.p_partkey
 
 -- 4. testLagInSum
 select  p_mfgr,p_name, p_size,   
-sum(p_size - lag(p_size,1)) over(distribute by p_mfgr  sort by p_mfgr ) as deltaSum 
+sum(p_size - lag(p_size,1)) over(distribute by p_mfgr  sort by p_name ) as deltaSum 
 from part 
 window w1 as (rows between 2 preceding and 2 following) ;
 
@@ -51,7 +51,7 @@ window w1 as (rows between 2 preceding and 2 following) ;
 select  p_mfgr,p_name, p_size,   
 sum(p_size - lag(p_size,1)) over w1 as deltaSum 
 from part 
-window w1 as (distribute by p_mfgr sort by p_mfgr rows between 2 preceding and 2 following) ;
+window w1 as (distribute by p_mfgr sort by p_name rows between 2 preceding and 2 following) ;
 
 -- 6. testRankInLead
 select p_mfgr, p_name, p_size, r1,
@@ -76,7 +76,7 @@ order by p_name
 -- 8. testOverNoPartitionMultipleAggregate
 select p_name, p_retailprice,
 lead(p_retailprice) over() as l1 ,
-lag(p_retailprice)  over() as l2
+lag(p_retailprice) over() as l2
 from part
-order by p_name;
+where p_retailprice = 1173.15;
 
diff --git a/ql/src/test/queries/clientpositive/ptf.q b/ql/src/test/queries/clientpositive/ptf.q
index e83aea0e5a..059b5f4d36 100644
--- a/ql/src/test/queries/clientpositive/ptf.q
+++ b/ql/src/test/queries/clientpositive/ptf.q
@@ -182,7 +182,6 @@ CREATE TABLE part_5(
 p_mfgr STRING, 
 p_name STRING, 
 p_size INT, 
-s1 INT, 
 s2 INT, 
 r INT, 
 dr INT, 
@@ -197,8 +196,7 @@ rank() over (distribute by p_mfgr sort by p_name) as r,
 dense_rank() over (distribute by p_mfgr sort by p_name) as dr, 
 sum(p_retailprice) over (distribute by p_mfgr sort by p_name rows between unbounded preceding and current row)  as s  
 INSERT OVERWRITE TABLE part_5 select  p_mfgr,p_name, p_size,  
-sum(p_size) over (distribute by p_mfgr sort by p_mfgr, p_name rows between unbounded preceding and current row) as s1, 
-sum(p_size) over (distribute by p_mfgr sort by p_size range between 5 preceding and current row) as s2,
+round(sum(p_size),1) over (distribute by p_mfgr sort by p_size range between 5 preceding and current row) as s2,
 rank() over (distribute by p_mfgr sort by p_mfgr, p_name) as r, 
 dense_rank() over (distribute by p_mfgr sort by p_mfgr, p_name) as dr, 
 cume_dist() over (distribute by p_mfgr sort by p_mfgr, p_name) as cud, 
@@ -294,11 +292,11 @@ from noop(on
 
 -- 23. testMultiOperatorChainWithDiffPartitionForWindow2
 select p_mfgr, p_name,  
-rank() over (partition by p_mfgr order by p_mfgr) as r, 
-dense_rank() over (partition by p_mfgr order by p_mfgr) as dr, 
+rank() over (partition by p_mfgr order by p_name) as r, 
+dense_rank() over (partition by p_mfgr order by p_name) as dr, 
 p_size, 
-sum(p_size) over (partition by p_mfgr order by p_mfgr rows between unbounded preceding and current row) as s1, 
-sum(p_size) over (partition by p_mfgr order by p_mfgr rows between unbounded preceding and current row)  as s2
+sum(p_size) over (partition by p_mfgr order by p_name range between unbounded preceding and current row) as s1, 
+sum(p_size) over (partition by p_mfgr order by p_name range between unbounded preceding and current row)  as s2
 from noopwithmap(on 
         noop(on 
               noop(on part 
diff --git a/ql/src/test/queries/clientpositive/ptf_general_queries.q b/ql/src/test/queries/clientpositive/ptf_general_queries.q
index 719cf30b1e..885c3b3d43 100644
--- a/ql/src/test/queries/clientpositive/ptf_general_queries.q
+++ b/ql/src/test/queries/clientpositive/ptf_general_queries.q
@@ -23,10 +23,10 @@ sort by p_name ;
         
 -- 2. testUDAFsNoWindowingNoPTFNoGBY
 select p_mfgr,p_name, p_retailprice,  
-sum(p_retailprice) over(partition by p_mfgr order by p_mfgr) as s,
-min(p_retailprice) over(partition by p_mfgr order by p_mfgr) as mi,
-max(p_retailprice) over(partition by p_mfgr order by p_mfgr) as ma,
-avg(p_retailprice) over(partition by p_mfgr order by p_mfgr) as av 
+sum(p_retailprice) over(partition by p_mfgr order by p_name) as s,
+min(p_retailprice) over(partition by p_mfgr order by p_name) as mi,
+max(p_retailprice) over(partition by p_mfgr order by p_name) as ma,
+avg(p_retailprice) over(partition by p_mfgr order by p_name) as av 
 from part 
 ;        
         
diff --git a/ql/src/test/queries/clientpositive/windowing.q b/ql/src/test/queries/clientpositive/windowing.q
index f95478db9a..4c5e8d0122 100644
--- a/ql/src/test/queries/clientpositive/windowing.q
+++ b/ql/src/test/queries/clientpositive/windowing.q
@@ -106,57 +106,57 @@ from part
 
 -- 11. testFirstLast   
 select  p_mfgr,p_name, p_size, 
-sum(p_size) over (distribute by p_mfgr sort by p_mfgr rows between current row and current row) as s2, 
+sum(p_size) over (distribute by p_mfgr sort by p_name rows between current row and current row) as s2, 
 first_value(p_size) over w1  as f, 
 last_value(p_size, false) over w1  as l 
 from part 
-window w1 as (distribute by p_mfgr sort by p_mfgr rows between 2 preceding and 2 following);
+window w1 as (distribute by p_mfgr sort by p_name rows between 2 preceding and 2 following);
 
 -- 12. testFirstLastWithWhere
 select  p_mfgr,p_name, p_size, 
-rank() over(distribute by p_mfgr sort by p_mfgr) as r, 
-sum(p_size) over (distribute by p_mfgr sort by p_mfgr rows between current row and current row) as s2, 
+rank() over(distribute by p_mfgr sort by p_name) as r, 
+sum(p_size) over (distribute by p_mfgr sort by p_name rows between current row and current row) as s2, 
 first_value(p_size) over w1 as f,  
 last_value(p_size, false) over w1 as l 
 from part 
 where p_mfgr = 'Manufacturer#3'  
-window w1 as (distribute by p_mfgr sort by p_mfgr rows between 2 preceding and 2 following);
+window w1 as (distribute by p_mfgr sort by p_name rows between 2 preceding and 2 following);
 
 -- 13. testSumWindow
 select  p_mfgr,p_name, p_size,  
 sum(p_size) over w1 as s1, 
-sum(p_size) over (distribute by p_mfgr  sort by p_mfgr rows between current row and current row)  as s2 
+sum(p_size) over (distribute by p_mfgr  sort by p_name rows between current row and current row)  as s2 
 from part 
-window w1 as (distribute by p_mfgr  sort by p_mfgr rows between 2 preceding and 2 following);
+window w1 as (distribute by p_mfgr  sort by p_name rows between 2 preceding and 2 following);
 
 -- 14. testNoSortClause
 select  p_mfgr,p_name, p_size, 
-rank() over(distribute by p_mfgr) as r, dense_rank() over(distribute by p_mfgr) as dr 
+rank() over(distribute by p_mfgr sort by p_name) as r, dense_rank() over(distribute by p_mfgr sort by p_name) as dr 
 from part  
-window w1 as (distribute by p_mfgr rows between 2 preceding and 2 following);
+window w1 as (distribute by p_mfgr sort by p_name rows between 2 preceding and 2 following);
 
 -- 15. testExpressions
 select  p_mfgr,p_name, p_size,  
-rank() over(distribute by p_mfgr sort by p_mfgr) as r,  
-dense_rank() over(distribute by p_mfgr sort by p_mfgr) as dr, 
-cume_dist() over(distribute by p_mfgr sort by p_mfgr) as cud, 
-percent_rank() over(distribute by p_mfgr sort by p_mfgr) as pr, 
-ntile(3) over(distribute by p_mfgr sort by p_mfgr) as nt, 
-count(p_size) over(distribute by p_mfgr sort by p_mfgr) as ca, 
-avg(p_size) over(distribute by p_mfgr sort by p_mfgr) as avg, 
-stddev(p_size) over(distribute by p_mfgr sort by p_mfgr) as st, 
-first_value(p_size % 5) over(distribute by p_mfgr sort by p_mfgr) as fv, 
-last_value(p_size) over(distribute by p_mfgr sort by p_mfgr) as lv, 
+rank() over(distribute by p_mfgr sort by p_name) as r,  
+dense_rank() over(distribute by p_mfgr sort by p_name) as dr, 
+cume_dist() over(distribute by p_mfgr sort by p_name) as cud, 
+percent_rank() over(distribute by p_mfgr sort by p_name) as pr, 
+ntile(3) over(distribute by p_mfgr sort by p_name) as nt, 
+count(p_size) over(distribute by p_mfgr sort by p_name) as ca, 
+avg(p_size) over(distribute by p_mfgr sort by p_name) as avg, 
+stddev(p_size) over(distribute by p_mfgr sort by p_name) as st, 
+first_value(p_size % 5) over(distribute by p_mfgr sort by p_name) as fv, 
+last_value(p_size) over(distribute by p_mfgr sort by p_name) as lv, 
 first_value(p_size) over w1  as fvW1
 from part 
 window w1 as (distribute by p_mfgr sort by p_mfgr, p_name rows between 2 preceding and 2 following);
 
 -- 16. testMultipleWindows
 select  p_mfgr,p_name, p_size,  
-  rank() over(distribute by p_mfgr sort by p_mfgr) as r, 
-  dense_rank() over(distribute by p_mfgr sort by p_mfgr) as dr, 
-cume_dist() over(distribute by p_mfgr sort by p_mfgr) as cud, 
-sum(p_size) over (distribute by p_mfgr sort by p_mfgr, p_name rows between unbounded preceding and current row) as s1, 
+  rank() over(distribute by p_mfgr sort by p_name) as r, 
+  dense_rank() over(distribute by p_mfgr sort by p_name) as dr, 
+cume_dist() over(distribute by p_mfgr sort by p_name) as cud, 
+sum(p_size) over (distribute by p_mfgr sort by p_name range between unbounded preceding and current row) as s1, 
 sum(p_size) over (distribute by p_mfgr sort by p_size range between 5 preceding and current row) as s2, 
 first_value(p_size) over w1  as fv1
 from part 
@@ -164,8 +164,8 @@ window w1 as (distribute by p_mfgr sort by p_mfgr, p_name rows between 2 precedi
 
 -- 17. testCountStar
 select  p_mfgr,p_name, p_size,
-count(*) over(distribute by p_mfgr sort by p_mfgr ) as c, 
-count(p_size) over(distribute by p_mfgr sort by p_mfgr) as ca, 
+count(*) over(distribute by p_mfgr sort by p_name ) as c, 
+count(p_size) over(distribute by p_mfgr sort by p_name) as ca, 
 first_value(p_size) over w1  as fvW1
 from part 
 window w1 as (distribute by p_mfgr sort by p_mfgr, p_name rows between 2 preceding and 2 following);
@@ -204,28 +204,32 @@ window w1 as (distribute by p_mfgr sort by p_mfgr, p_name rows between 2 precedi
 select  p_mfgr,p_name, p_size, 
 histogram_numeric(p_retailprice, 5) over w1 as hist, 
 percentile(p_partkey, 0.5) over w1 as per,
-row_number() over(distribute by p_mfgr sort by p_mfgr) as rn
+row_number() over(distribute by p_mfgr sort by p_name) as rn
 from part
 window w1 as (distribute by p_mfgr sort by p_mfgr, p_name rows between 2 preceding and 2 following);
 
 -- 22. testViewAsTableInputWithWindowing
 create view IF NOT EXISTS mfgr_price_view as 
 select p_mfgr, p_brand, 
-sum(p_retailprice) as s 
+round(sum(p_retailprice),2) as s 
 from part 
 group by p_mfgr, p_brand;
         
+select * 
+from (
 select p_mfgr, p_brand, s, 
-sum(s) over w1  as s1
+round(sum(s),2) over w1  as s1
 from mfgr_price_view 
-window w1 as (distribute by p_mfgr sort by p_mfgr rows between 2 preceding and current row);
+window w1 as (distribute by p_mfgr sort by p_mfgr )
+) sq
+order by p_mfgr, p_brand;
 
 -- 23. testCreateViewWithWindowingQuery
 create view IF NOT EXISTS mfgr_brand_price_view as 
 select p_mfgr, p_brand, 
 sum(p_retailprice) over w1  as s
 from part 
-window w1 as (distribute by p_mfgr sort by p_mfgr rows between 2 preceding and current row);
+window w1 as (distribute by p_mfgr sort by p_name rows between 2 preceding and current row);
         
 select * from mfgr_brand_price_view;        
         
@@ -234,7 +238,7 @@ select p_mfgr, p_name,
 lv_col, p_size, sum(p_size) over w1   as s
 from (select p_mfgr, p_name, p_size, array(1,2,3) arr from part) p 
 lateral view explode(arr) part_lv as lv_col
-window w1 as (distribute by p_mfgr sort by p_name rows between 2 preceding and current row);        
+window w1 as (distribute by p_mfgr sort by p_size, lv_col rows between 2 preceding and current row);        
 
 -- 25. testMultipleInserts3SWQs
 CREATE TABLE part_1( 
@@ -251,8 +255,7 @@ p_name STRING,
 p_size INT, 
 r INT, 
 dr INT, 
-cud INT, 
-s1 DOUBLE, 
+cud INT,  
 s2 DOUBLE, 
 fv1 INT);
 
@@ -272,17 +275,16 @@ dense_rank() over(distribute by p_mfgr sort by p_name ) as dr,
 sum(p_retailprice) over (distribute by p_mfgr sort by p_name rows between unbounded preceding and current row)  as s
 INSERT OVERWRITE TABLE part_2 
 select  p_mfgr,p_name, p_size,  
-rank() over(distribute by p_mfgr sort by p_mfgr) as r, 
-dense_rank() over(distribute by p_mfgr sort by p_mfgr) as dr, 
-cume_dist() over(distribute by p_mfgr sort by p_mfgr) as cud, 
-sum(p_size) over (distribute by p_mfgr sort by p_mfgr, p_name rows between unbounded preceding and current row) as s1, 
-sum(p_size) over (distribute by p_mfgr sort by p_size range between 5 preceding and current row) as s2, 
+rank() over(distribute by p_mfgr sort by p_name) as r, 
+dense_rank() over(distribute by p_mfgr sort by p_name) as dr, 
+cume_dist() over(distribute by p_mfgr sort by p_name) as cud, 
+round(sum(p_size),1) over (distribute by p_mfgr sort by p_size range between 5 preceding and current row) as s2, 
 first_value(p_size) over w1  as fv1
 window w1 as (distribute by p_mfgr sort by p_mfgr, p_name rows between 2 preceding and 2 following) 
 INSERT OVERWRITE TABLE part_3 
 select  p_mfgr,p_name, p_size,  
-count(*) over(distribute by p_mfgr sort by p_mfgr) as c, 
-count(p_size) over(distribute by p_mfgr sort by p_mfgr) as ca, 
+count(*) over(distribute by p_mfgr sort by p_name) as c, 
+count(p_size) over(distribute by p_mfgr sort by p_name) as ca, 
 first_value(p_size) over w1  as fv
 window w1 as (distribute by p_mfgr sort by p_mfgr, p_name rows between 2 preceding and 2 following);
 
@@ -333,7 +335,7 @@ select p_mfgr, p_name, p_size,
 sum(p_size) over w1 as s1, 
 sum(p_size) over w2 as s2
 from part 
-window w1 as (partition by p_mfgr order by p_mfgr rows between 2 preceding and 2 following), 
+window w1 as (partition by p_mfgr order by p_name range between 2 preceding and 2 following), 
        w2 as w1;
        
                
@@ -342,7 +344,7 @@ select p_mfgr, p_name, p_size,
 sum(p_size) over w1 as s1, 
 sum(p_size) over w2 as s2 
 from part 
-window w1 as (partition by p_mfgr order by p_mfgr rows between 2 preceding and 2 following), 
+window w1 as (partition by p_mfgr order by p_name range between 2 preceding and 2 following), 
        w2 as (w1 rows between unbounded preceding and current row); 
 
         
@@ -352,9 +354,9 @@ sum(p_size) over w1 as s1,
 sum(p_size) over w2 as s2,
 sum(p_size) over w3 as s3
 from part 
-window w1 as (distribute by p_mfgr sort by p_mfgr rows between 2 preceding and 2 following), 
+window w1 as (distribute by p_mfgr sort by p_name range between 2 preceding and 2 following), 
        w2 as w3,
-       w3 as (distribute by p_mfgr sort by p_mfgr rows between unbounded preceding and current row); 
+       w3 as (distribute by p_mfgr sort by p_name range between unbounded preceding and current row); 
 
 
 -- 34. testWindowDefinitionPropagation
@@ -363,9 +365,9 @@ sum(p_size) over w1 as s1,
 sum(p_size) over w2 as s2,
 sum(p_size) over (w3 rows between 2 preceding and 2 following)  as s3
 from part 
-window w1 as (distribute by p_mfgr sort by p_mfgr rows between 2 preceding and 2 following), 
+window w1 as (distribute by p_mfgr sort by p_name range between 2 preceding and 2 following), 
        w2 as w3,
-       w3 as (distribute by p_mfgr sort by p_mfgr rows between unbounded preceding and current row); 
+       w3 as (distribute by p_mfgr sort by p_name range between unbounded preceding and current row); 
 
 -- 35. testDistinctWithWindowing
 select DISTINCT p_mfgr, p_name, p_size,
@@ -379,11 +381,11 @@ rank() over (partition by p_mfgr order by p_name )  as r
 from part;    
 
 -- 37. testPartitioningVariousForms
-select p_mfgr, p_name, p_size,
-sum(p_retailprice) over (partition by p_mfgr order by p_mfgr) as s1,
+select p_mfgr,
+round(sum(p_retailprice),2) over (partition by p_mfgr order by p_mfgr) as s1,
 min(p_retailprice) over (partition by p_mfgr) as s2,
 max(p_retailprice) over (distribute by p_mfgr sort by p_mfgr) as s3,
-avg(p_retailprice) over (distribute by p_mfgr) as s4,
+round(avg(p_retailprice),2) over (distribute by p_mfgr) as s4,
 count(p_retailprice) over (cluster by p_mfgr ) as s5
 from part;
 
@@ -421,7 +423,7 @@ select p_mfgr, p_name, p_size,
         
 -- 44. testOverNoPartitionSingleAggregate
 select p_name, p_retailprice,
-avg(p_retailprice) over()
+round(avg(p_retailprice),2) over()
 from part
 order by p_name;
         
diff --git a/ql/src/test/queries/clientpositive/windowing_expressions.q b/ql/src/test/queries/clientpositive/windowing_expressions.q
index e98757802b..5a4a07232d 100644
--- a/ql/src/test/queries/clientpositive/windowing_expressions.q
+++ b/ql/src/test/queries/clientpositive/windowing_expressions.q
@@ -49,9 +49,9 @@ sum(p_retailprice) - 5 over (distribute by p_mfgr sort by p_retailprice rows bet
 from part
 ;
 
-select s, si, f, si - lead(f, 3) over (partition by t order by bo desc) from over10k limit 100;
-select s, i, i - lead(i, 3, 0) over (partition by si order by i) from over10k limit 100;
-select s, si, d, si - lag(d, 3) over (partition by b order by si) from over10k limit 100;
+select s, si, f, si - lead(f, 3) over (partition by t order by bo,s,si,f desc) from over10k limit 100;
+select s, i, i - lead(i, 3, 0) over (partition by si order by i,s) from over10k limit 100;
+select s, si, d, si - lag(d, 3) over (partition by b order by si,s,d) from over10k limit 100;
 select s, lag(s, 3, 'fred') over (partition by f order by b) from over10k limit 100;
 
 select p_mfgr, avg(p_retailprice) over(partition by p_mfgr, p_type order by p_mfgr) from part;
@@ -61,7 +61,7 @@ select p_mfgr, avg(p_retailprice) over(partition by p_mfgr order by p_type,p_mfg
 -- multi table insert test
 create table t1 (a1 int, b1 string); 
 create table t2 (a1 int, b1 string);
-from (select sum(i) over (), s from over10k) tt insert overwrite table t1 select * insert overwrite table t2 select * ;
+from (select sum(i) over (partition by ts order by i), s from over10k) tt insert overwrite table t1 select * insert overwrite table t2 select * ;
 select * from t1 limit 3;
 select * from t2 limit 3;
 
diff --git a/ql/src/test/queries/clientpositive/windowing_multipartitioning.q b/ql/src/test/queries/clientpositive/windowing_multipartitioning.q
index 5b7d652d7d..bb371e9009 100644
--- a/ql/src/test/queries/clientpositive/windowing_multipartitioning.q
+++ b/ql/src/test/queries/clientpositive/windowing_multipartitioning.q
@@ -30,7 +30,7 @@ select s, sum(i) over (partition by s), sum(f) over (partition by si) from over1
 select s, rank() over (partition by s order by bo), rank() over (partition by si order by bin desc) from over10k
 where s = 'tom allen' or s = 'bob steinbeck';
 
-select s, sum(f) over (partition by i), row_number() over () from over10k where s = 'tom allen' or s = 'bob steinbeck';
+select s, sum(f) over (partition by i), row_number() over (order by f) from over10k where s = 'tom allen' or s = 'bob steinbeck';
 
 select s, rank() over w1, 
 rank() over w2 
@@ -39,4 +39,4 @@ where s = 'tom allen' or s = 'bob steinbeck'
 window 
 w1 as (partition by s order by dec), 
 w2 as (partition by si order by f) 
-;
\ No newline at end of file
+;
diff --git a/ql/src/test/queries/clientpositive/windowing_navfn.q b/ql/src/test/queries/clientpositive/windowing_navfn.q
index 7be35b043a..8a9d001259 100644
--- a/ql/src/test/queries/clientpositive/windowing_navfn.q
+++ b/ql/src/test/queries/clientpositive/windowing_navfn.q
@@ -19,9 +19,9 @@ load data local inpath '../data/files/over10k' into table over10k;
 
 select s, row_number() over (partition by d order by dec) from over10k limit 100;
 
-select i, lead(s) over (partition by bin order by d desc) from over10k limit 100;
+select i, lead(s) over (partition by bin order by d,i desc) from over10k limit 100;
 
-select i, lag(dec) over (partition by i order by s) from over10k limit 100;
+select i, lag(dec) over (partition by i order by s,i,dec) from over10k limit 100;
 
 select s, last_value(t) over (partition by d order by f) from over10k limit 100;
 
diff --git a/ql/src/test/queries/clientpositive/windowing_ntile.q b/ql/src/test/queries/clientpositive/windowing_ntile.q
index 5f003a456d..505c259f4b 100644
--- a/ql/src/test/queries/clientpositive/windowing_ntile.q
+++ b/ql/src/test/queries/clientpositive/windowing_ntile.q
@@ -17,12 +17,12 @@ create table over10k(
 
 load data local inpath '../data/files/over10k' into table over10k;
 
-select i, ntile(10) over (partition by s) from over10k limit 100;
+select i, ntile(10) over (partition by s order by i) from over10k limit 100;
 
-select s, ntile(100) over (partition by i) from over10k limit 100;
+select s, ntile(100) over (partition by i order by s) from over10k limit 100;
 
-select f, ntile(4) over (partition by d) from over10k limit 100;
+select f, ntile(4) over (partition by d order by f) from over10k limit 100;
 
-select d, ntile(1000) over (partition by dec) from over10k limit 100;
+select d, ntile(1000) over (partition by dec order by d) from over10k limit 100;
 
 
diff --git a/ql/src/test/queries/clientpositive/windowing_rank.q b/ql/src/test/queries/clientpositive/windowing_rank.q
index 5ef7296058..bf76867813 100644
--- a/ql/src/test/queries/clientpositive/windowing_rank.q
+++ b/ql/src/test/queries/clientpositive/windowing_rank.q
@@ -19,9 +19,9 @@ load data local inpath '../data/files/over10k' into table over10k;
 
 select s, rank() over (partition by f order by t) from over10k limit 100;
 
-select s, dense_rank() over (partition by ts order by i desc) from over10k limit 100;
+select s, dense_rank() over (partition by ts order by i,s desc) from over10k limit 100;
 
-select s, cume_dist() over (partition by bo order by b) from over10k limit 100;
+select s, cume_dist() over (partition by bo order by b,s) from over10k limit 100;
 
 select s, percent_rank() over (partition by dec order by f) from over10k limit 100;
 
@@ -30,7 +30,7 @@ select s, percent_rank() over (partition by dec order by f) from over10k limit 1
 select ts, dec, rnk
 from
   (select ts, dec,
-          rank() over (partition by ts)  as rnk
+          rank() over (partition by ts order by dec)  as rnk
           from
             (select other.ts, other.dec
              from over10k other
@@ -54,7 +54,7 @@ where dec = 89.5 limit 10;
 select ts, dec, rnk
 from
   (select ts, dec,
-          rank() over (partition by ts)  as rnk
+          rank() over (partition by ts order by dec)  as rnk
           from
             (select other.ts, other.dec
              from over10k other
diff --git a/ql/src/test/queries/clientpositive/windowing_udaf.q b/ql/src/test/queries/clientpositive/windowing_udaf.q
index 6a2deb424e..f22b992cd4 100644
--- a/ql/src/test/queries/clientpositive/windowing_udaf.q
+++ b/ql/src/test/queries/clientpositive/windowing_udaf.q
@@ -19,9 +19,9 @@ load data local inpath '../data/files/over10k' into table over10k;
 
 select s, min(i) over (partition by s) from over10k limit 100;
 
-select s, avg(f) over (partition by si order by t) from over10k limit 100;
+select s, avg(f) over (partition by si order by s) from over10k limit 100;
 
-select s, avg(i) over (partition by t, b) from over10k limit 100;
+select s, avg(i) over (partition by t, b order by s) from over10k limit 100;
 
 select max(i) over w from over10k window w as (partition by f) limit 100;
 
diff --git a/ql/src/test/queries/clientpositive/windowing_windowspec.q b/ql/src/test/queries/clientpositive/windowing_windowspec.q
index efb5248768..00b5b5b867 100644
--- a/ql/src/test/queries/clientpositive/windowing_windowspec.q
+++ b/ql/src/test/queries/clientpositive/windowing_windowspec.q
@@ -17,18 +17,18 @@ create table over10k(
 
 load data local inpath '../data/files/over10k' into table over10k;
 
-select s, sum(b) over (partition by i order by si rows unbounded preceding) from over10k limit 100;
+select s, sum(b) over (partition by i order by s,b rows unbounded preceding) from over10k limit 100;
 
-select s, sum(f) over (partition by d order by i rows unbounded preceding) from over10k limit 100;
+select s, sum(f) over (partition by d order by s,f rows unbounded preceding) from over10k limit 100;
 
-select s, sum(f) over (partition by ts order by b range between current row and unbounded following) from over10k limit 100;
+select s, sum(f) over (partition by ts order by f range between current row and unbounded following) from over10k limit 100;
 
-select s, avg(f) over (partition by bin order by s rows between current row and 5 following) from over10k limit 100;
+select s, avg(f) over (partition by ts order by s,f rows between current row and 5 following) from over10k limit 100;
 
-select s, avg(d) over (partition by t order by ts desc rows between 5 preceding and 5 following) from over10k limit 100;
+select s, avg(d) over (partition by t order by s,d desc rows between 5 preceding and 5 following) from over10k limit 100;
 
-select s, sum(i) over() from over10k limit 100;
+select s, sum(i) over(partition by ts order by s) from over10k limit 100;
 
-select f, sum(f) over (order by f range between unbounded preceding and current row) from over10k limit 100;
+select f, sum(f) over (partition by ts order by f range between unbounded preceding and current row) from over10k limit 100;
 
 
diff --git a/ql/src/test/results/clientpositive/leadlag.q.out b/ql/src/test/results/clientpositive/leadlag.q.out
index 439c0ca3e7..9168e5d9a1 100644
--- a/ql/src/test/results/clientpositive/leadlag.q.out
+++ b/ql/src/test/results/clientpositive/leadlag.q.out
@@ -177,7 +177,7 @@ Manufacturer#5	almond aquamarine dodger light gainsboro	46	44
 Manufacturer#5	almond azure blanched chiffon midnight	23	-23
 PREHOOK: query: -- 4. testLagInSum
 select  p_mfgr,p_name, p_size,   
-sum(p_size - lag(p_size,1)) over(distribute by p_mfgr  sort by p_mfgr ) as deltaSum 
+sum(p_size - lag(p_size,1)) over(distribute by p_mfgr  sort by p_name ) as deltaSum 
 from part 
 window w1 as (rows between 2 preceding and 2 following)
 PREHOOK: type: QUERY
@@ -185,43 +185,43 @@ PREHOOK: Input: default@part
 #### A masked pattern was here ####
 POSTHOOK: query: -- 4. testLagInSum
 select  p_mfgr,p_name, p_size,   
-sum(p_size - lag(p_size,1)) over(distribute by p_mfgr  sort by p_mfgr ) as deltaSum 
+sum(p_size - lag(p_size,1)) over(distribute by p_mfgr  sort by p_name ) as deltaSum 
 from part 
 window w1 as (rows between 2 preceding and 2 following)
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@part
 #### A masked pattern was here ####
-Manufacturer#1	almond antique burnished rose metallic	2	40
-Manufacturer#1	almond antique chartreuse lavender yellow	34	40
-Manufacturer#1	almond antique burnished rose metallic	2	40
-Manufacturer#1	almond antique salmon chartreuse burlywood	6	40
-Manufacturer#1	almond aquamarine burnished black steel	28	40
+Manufacturer#1	almond antique burnished rose metallic	2	0
+Manufacturer#1	almond antique burnished rose metallic	2	0
+Manufacturer#1	almond antique chartreuse lavender yellow	34	32
+Manufacturer#1	almond antique salmon chartreuse burlywood	6	4
+Manufacturer#1	almond aquamarine burnished black steel	28	26
 Manufacturer#1	almond aquamarine pink moccasin thistle	42	40
-Manufacturer#2	almond antique violet chocolate turquoise	14	4
-Manufacturer#2	almond antique violet turquoise frosted	40	4
-Manufacturer#2	almond aquamarine midnight light salmon	2	4
-Manufacturer#2	almond aquamarine rose maroon antique	25	4
+Manufacturer#2	almond antique violet chocolate turquoise	14	0
+Manufacturer#2	almond antique violet turquoise frosted	40	26
+Manufacturer#2	almond aquamarine midnight light salmon	2	-12
+Manufacturer#2	almond aquamarine rose maroon antique	25	11
 Manufacturer#2	almond aquamarine sandy cyan gainsboro	18	4
-Manufacturer#3	almond antique metallic orange dim	19	26
-Manufacturer#3	almond antique chartreuse khaki white	17	26
-Manufacturer#3	almond antique forest lavender goldenrod	14	26
-Manufacturer#3	almond antique misty red olive	1	26
-Manufacturer#3	almond antique olive coral navajo	45	26
-Manufacturer#4	almond antique gainsboro frosted violet	10	2
-Manufacturer#4	almond antique violet mint lemon	39	2
-Manufacturer#4	almond aquamarine floral ivory bisque	27	2
-Manufacturer#4	almond aquamarine yellow dodger mint	7	2
+Manufacturer#3	almond antique chartreuse khaki white	17	0
+Manufacturer#3	almond antique forest lavender goldenrod	14	-3
+Manufacturer#3	almond antique metallic orange dim	19	2
+Manufacturer#3	almond antique misty red olive	1	-16
+Manufacturer#3	almond antique olive coral navajo	45	28
+Manufacturer#4	almond antique gainsboro frosted violet	10	0
+Manufacturer#4	almond antique violet mint lemon	39	29
+Manufacturer#4	almond aquamarine floral ivory bisque	27	17
+Manufacturer#4	almond aquamarine yellow dodger mint	7	-3
 Manufacturer#4	almond azure aquamarine papaya violet	12	2
-Manufacturer#5	almond antique blue firebrick mint	31	-8
-Manufacturer#5	almond antique medium spring khaki	6	-8
-Manufacturer#5	almond antique sky peru orange	2	-8
-Manufacturer#5	almond aquamarine dodger light gainsboro	46	-8
+Manufacturer#5	almond antique blue firebrick mint	31	0
+Manufacturer#5	almond antique medium spring khaki	6	-25
+Manufacturer#5	almond antique sky peru orange	2	-29
+Manufacturer#5	almond aquamarine dodger light gainsboro	46	15
 Manufacturer#5	almond azure blanched chiffon midnight	23	-8
 PREHOOK: query: -- 5. testLagInSumOverWindow
 select  p_mfgr,p_name, p_size,   
 sum(p_size - lag(p_size,1)) over w1 as deltaSum 
 from part 
-window w1 as (distribute by p_mfgr sort by p_mfgr rows between 2 preceding and 2 following)
+window w1 as (distribute by p_mfgr sort by p_name rows between 2 preceding and 2 following)
 PREHOOK: type: QUERY
 PREHOOK: Input: default@part
 #### A masked pattern was here ####
@@ -229,26 +229,26 @@ POSTHOOK: query: -- 5. testLagInSumOverWindow
 select  p_mfgr,p_name, p_size,   
 sum(p_size - lag(p_size,1)) over w1 as deltaSum 
 from part 
-window w1 as (distribute by p_mfgr sort by p_mfgr rows between 2 preceding and 2 following)
+window w1 as (distribute by p_mfgr sort by p_name rows between 2 preceding and 2 following)
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@part
 #### A masked pattern was here ####
-Manufacturer#1	almond antique burnished rose metallic	2	0
-Manufacturer#1	almond antique chartreuse lavender yellow	34	4
-Manufacturer#1	almond antique burnished rose metallic	2	26
-Manufacturer#1	almond antique salmon chartreuse burlywood	6	8
-Manufacturer#1	almond aquamarine burnished black steel	28	40
+Manufacturer#1	almond antique burnished rose metallic	2	32
+Manufacturer#1	almond antique burnished rose metallic	2	4
+Manufacturer#1	almond antique chartreuse lavender yellow	34	26
+Manufacturer#1	almond antique salmon chartreuse burlywood	6	40
+Manufacturer#1	almond aquamarine burnished black steel	28	8
 Manufacturer#1	almond aquamarine pink moccasin thistle	42	36
 Manufacturer#2	almond antique violet chocolate turquoise	14	-12
 Manufacturer#2	almond antique violet turquoise frosted	40	11
 Manufacturer#2	almond aquamarine midnight light salmon	2	4
 Manufacturer#2	almond aquamarine rose maroon antique	25	-22
 Manufacturer#2	almond aquamarine sandy cyan gainsboro	18	16
-Manufacturer#3	almond antique metallic orange dim	19	-5
-Manufacturer#3	almond antique chartreuse khaki white	17	-18
-Manufacturer#3	almond antique forest lavender goldenrod	14	26
-Manufacturer#3	almond antique misty red olive	1	28
-Manufacturer#3	almond antique olive coral navajo	45	31
+Manufacturer#3	almond antique chartreuse khaki white	17	2
+Manufacturer#3	almond antique forest lavender goldenrod	14	-16
+Manufacturer#3	almond antique metallic orange dim	19	28
+Manufacturer#3	almond antique misty red olive	1	31
+Manufacturer#3	almond antique olive coral navajo	45	26
 Manufacturer#4	almond antique gainsboro frosted violet	10	17
 Manufacturer#4	almond antique violet mint lemon	39	-3
 Manufacturer#4	almond aquamarine floral ivory bisque	27	2
@@ -360,44 +360,20 @@ Manufacturer#5	almond azure blanched chiffon midnight	5	5	23	0
 PREHOOK: query: -- 8. testOverNoPartitionMultipleAggregate
 select p_name, p_retailprice,
 lead(p_retailprice) over() as l1 ,
-lag(p_retailprice)  over() as l2
+lag(p_retailprice) over() as l2
 from part
-order by p_name
+where p_retailprice = 1173.15
 PREHOOK: type: QUERY
 PREHOOK: Input: default@part
 #### A masked pattern was here ####
 POSTHOOK: query: -- 8. testOverNoPartitionMultipleAggregate
 select p_name, p_retailprice,
 lead(p_retailprice) over() as l1 ,
-lag(p_retailprice)  over() as l2
+lag(p_retailprice) over() as l2
 from part
-order by p_name
+where p_retailprice = 1173.15
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@part
 #### A masked pattern was here ####
-almond antique blue firebrick mint	1789.69	1611.66	1290.35
-almond antique burnished rose metallic	1173.15	1753.76	1173.15
 almond antique burnished rose metallic	1173.15	1173.15	NULL
-almond antique chartreuse khaki white	1671.68	1190.27	1701.6
-almond antique chartreuse lavender yellow	1753.76	1602.59	1173.15
-almond antique forest lavender goldenrod	1190.27	1410.39	1671.68
-almond antique gainsboro frosted violet	1620.67	1375.42	1337.29
-almond antique medium spring khaki	1611.66	1788.73	1789.69
-almond antique metallic orange dim	1410.39	1922.98	1190.27
-almond antique misty red olive	1922.98	1337.29	1410.39
-almond antique olive coral navajo	1337.29	1620.67	1922.98
-almond antique salmon chartreuse burlywood	1602.59	1414.42	1753.76
-almond antique sky peru orange	1788.73	1018.1	1611.66
-almond antique violet chocolate turquoise	1690.68	1800.7	1632.66
-almond antique violet mint lemon	1375.42	1206.26	1620.67
-almond antique violet turquoise frosted	1800.7	2031.98	1690.68
-almond aquamarine burnished black steel	1414.42	1632.66	1602.59
-almond aquamarine dodger light gainsboro	1018.1	1464.48	1788.73
-almond aquamarine floral ivory bisque	1206.26	1844.92	1375.42
-almond aquamarine midnight light salmon	2031.98	1698.66	1800.7
-almond aquamarine pink moccasin thistle	1632.66	1690.68	1414.42
-almond aquamarine rose maroon antique	1698.66	1701.6	2031.98
-almond aquamarine sandy cyan gainsboro	1701.6	1671.68	1698.66
-almond aquamarine yellow dodger mint	1844.92	1290.35	1206.26
-almond azure aquamarine papaya violet	1290.35	1789.69	1844.92
-almond azure blanched chiffon midnight	1464.48	NULL	1018.1
+almond antique burnished rose metallic	1173.15	NULL	1173.15
diff --git a/ql/src/test/results/clientpositive/ptf.q.out b/ql/src/test/results/clientpositive/ptf.q.out
index 8a1c19dbd3..b8d60f0974 100644
--- a/ql/src/test/results/clientpositive/ptf.q.out
+++ b/ql/src/test/results/clientpositive/ptf.q.out
@@ -833,7 +833,6 @@ PREHOOK: query: CREATE TABLE part_5(
 p_mfgr STRING, 
 p_name STRING, 
 p_size INT, 
-s1 INT, 
 s2 INT, 
 r INT, 
 dr INT, 
@@ -844,7 +843,6 @@ POSTHOOK: query: CREATE TABLE part_5(
 p_mfgr STRING, 
 p_name STRING, 
 p_size INT, 
-s1 INT, 
 s2 INT, 
 r INT, 
 dr INT, 
@@ -860,8 +858,7 @@ rank() over (distribute by p_mfgr sort by p_name) as r,
 dense_rank() over (distribute by p_mfgr sort by p_name) as dr, 
 sum(p_retailprice) over (distribute by p_mfgr sort by p_name rows between unbounded preceding and current row)  as s  
 INSERT OVERWRITE TABLE part_5 select  p_mfgr,p_name, p_size,  
-sum(p_size) over (distribute by p_mfgr sort by p_mfgr, p_name rows between unbounded preceding and current row) as s1, 
-sum(p_size) over (distribute by p_mfgr sort by p_size range between 5 preceding and current row) as s2,
+round(sum(p_size),1) over (distribute by p_mfgr sort by p_size range between 5 preceding and current row) as s2,
 rank() over (distribute by p_mfgr sort by p_mfgr, p_name) as r, 
 dense_rank() over (distribute by p_mfgr sort by p_mfgr, p_name) as dr, 
 cume_dist() over (distribute by p_mfgr sort by p_mfgr, p_name) as cud, 
@@ -879,8 +876,7 @@ rank() over (distribute by p_mfgr sort by p_name) as r,
 dense_rank() over (distribute by p_mfgr sort by p_name) as dr, 
 sum(p_retailprice) over (distribute by p_mfgr sort by p_name rows between unbounded preceding and current row)  as s  
 INSERT OVERWRITE TABLE part_5 select  p_mfgr,p_name, p_size,  
-sum(p_size) over (distribute by p_mfgr sort by p_mfgr, p_name rows between unbounded preceding and current row) as s1, 
-sum(p_size) over (distribute by p_mfgr sort by p_size range between 5 preceding and current row) as s2,
+round(sum(p_size),1) over (distribute by p_mfgr sort by p_size range between 5 preceding and current row) as s2,
 rank() over (distribute by p_mfgr sort by p_mfgr, p_name) as r, 
 dense_rank() over (distribute by p_mfgr sort by p_mfgr, p_name) as dr, 
 cume_dist() over (distribute by p_mfgr sort by p_mfgr, p_name) as cud, 
@@ -903,7 +899,6 @@ POSTHOOK: Lineage: part_5.p_mfgr SCRIPT [(part)part.FieldSchema(name:p_partkey,
 POSTHOOK: Lineage: part_5.p_name SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_5.p_size SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_5.r SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
-POSTHOOK: Lineage: part_5.s1 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_5.s2 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 PREHOOK: query: select * from part_4
 PREHOOK: type: QUERY
@@ -926,7 +921,6 @@ POSTHOOK: Lineage: part_5.p_mfgr SCRIPT [(part)part.FieldSchema(name:p_partkey,
 POSTHOOK: Lineage: part_5.p_name SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_5.p_size SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_5.r SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
-POSTHOOK: Lineage: part_5.s1 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_5.s2 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 Manufacturer#1	almond antique burnished rose metallic	2	1	1	1173.15
 Manufacturer#1	almond antique burnished rose metallic	2	1	1	2346.3
@@ -975,34 +969,33 @@ POSTHOOK: Lineage: part_5.p_mfgr SCRIPT [(part)part.FieldSchema(name:p_partkey,
 POSTHOOK: Lineage: part_5.p_name SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_5.p_size SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_5.r SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
-POSTHOOK: Lineage: part_5.s1 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_5.s2 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
-Manufacturer#1	almond antique burnished rose metallic	2	4	4	1	1	0.3333333333333333	2
-Manufacturer#1	almond antique burnished rose metallic	2	2	4	1	1	0.3333333333333333	2
-Manufacturer#1	almond antique salmon chartreuse burlywood	6	44	10	4	3	0.6666666666666666	2
-Manufacturer#1	almond aquamarine burnished black steel	28	72	28	5	4	0.8333333333333334	34
-Manufacturer#1	almond antique chartreuse lavender yellow	34	38	34	3	2	0.5	2
-Manufacturer#1	almond aquamarine pink moccasin thistle	42	114	42	6	5	1.0	6
-Manufacturer#2	almond aquamarine midnight light salmon	2	56	2	3	3	0.6	14
-Manufacturer#2	almond antique violet chocolate turquoise	14	14	14	1	1	0.2	14
-Manufacturer#2	almond aquamarine sandy cyan gainsboro	18	99	32	5	5	1.0	2
-Manufacturer#2	almond aquamarine rose maroon antique	25	81	25	4	4	0.8	40
-Manufacturer#2	almond antique violet turquoise frosted	40	54	40	2	2	0.4	14
-Manufacturer#3	almond antique misty red olive	1	51	1	4	4	0.8	14
-Manufacturer#3	almond antique forest lavender goldenrod	14	31	14	2	2	0.4	17
-Manufacturer#3	almond antique chartreuse khaki white	17	17	31	1	1	0.2	17
-Manufacturer#3	almond antique metallic orange dim	19	50	50	3	3	0.6	17
-Manufacturer#3	almond antique olive coral navajo	45	96	45	5	5	1.0	19
-Manufacturer#4	almond aquamarine yellow dodger mint	7	83	7	4	4	0.8	39
-Manufacturer#4	almond antique gainsboro frosted violet	10	10	17	1	1	0.2	10
-Manufacturer#4	almond azure aquamarine papaya violet	12	95	29	5	5	1.0	27
-Manufacturer#4	almond aquamarine floral ivory bisque	27	76	27	3	3	0.6	10
-Manufacturer#4	almond antique violet mint lemon	39	49	39	2	2	0.4	10
-Manufacturer#5	almond antique sky peru orange	2	39	2	3	3	0.6	31
-Manufacturer#5	almond antique medium spring khaki	6	37	8	2	2	0.4	31
-Manufacturer#5	almond azure blanched chiffon midnight	23	108	23	5	5	1.0	2
-Manufacturer#5	almond antique blue firebrick mint	31	31	31	1	1	0.2	31
-Manufacturer#5	almond aquamarine dodger light gainsboro	46	85	46	4	4	0.8	6
+Manufacturer#1	almond antique burnished rose metallic	2	4	1	1	0.3333333333333333	2
+Manufacturer#1	almond antique burnished rose metallic	2	4	1	1	0.3333333333333333	2
+Manufacturer#1	almond antique chartreuse lavender yellow	34	34	3	2	0.5	2
+Manufacturer#1	almond antique salmon chartreuse burlywood	6	10	4	3	0.6666666666666666	2
+Manufacturer#1	almond aquamarine burnished black steel	28	28	5	4	0.8333333333333334	34
+Manufacturer#1	almond aquamarine pink moccasin thistle	42	42	6	5	1.0	6
+Manufacturer#2	almond antique violet chocolate turquoise	14	14	1	1	0.2	14
+Manufacturer#2	almond antique violet turquoise frosted	40	40	2	2	0.4	14
+Manufacturer#2	almond aquamarine midnight light salmon	2	2	3	3	0.6	14
+Manufacturer#2	almond aquamarine rose maroon antique	25	25	4	4	0.8	40
+Manufacturer#2	almond aquamarine sandy cyan gainsboro	18	32	5	5	1.0	2
+Manufacturer#3	almond antique chartreuse khaki white	17	31	1	1	0.2	17
+Manufacturer#3	almond antique forest lavender goldenrod	14	14	2	2	0.4	17
+Manufacturer#3	almond antique metallic orange dim	19	50	3	3	0.6	17
+Manufacturer#3	almond antique misty red olive	1	1	4	4	0.8	14
+Manufacturer#3	almond antique olive coral navajo	45	45	5	5	1.0	19
+Manufacturer#4	almond antique gainsboro frosted violet	10	17	1	1	0.2	10
+Manufacturer#4	almond antique violet mint lemon	39	39	2	2	0.4	10
+Manufacturer#4	almond aquamarine floral ivory bisque	27	27	3	3	0.6	10
+Manufacturer#4	almond aquamarine yellow dodger mint	7	7	4	4	0.8	39
+Manufacturer#4	almond azure aquamarine papaya violet	12	29	5	5	1.0	27
+Manufacturer#5	almond antique blue firebrick mint	31	31	1	1	0.2	31
+Manufacturer#5	almond antique medium spring khaki	6	8	2	2	0.4	31
+Manufacturer#5	almond antique sky peru orange	2	2	3	3	0.6	31
+Manufacturer#5	almond aquamarine dodger light gainsboro	46	46	4	4	0.8	6
+Manufacturer#5	almond azure blanched chiffon midnight	23	23	5	5	1.0	2
 PREHOOK: query: -- 18. testMulti2OperatorsFunctionChainWithMap
 select p_mfgr, p_name,  
 rank() over (partition by p_mfgr,p_name) as r, 
@@ -1054,7 +1047,6 @@ POSTHOOK: Lineage: part_5.p_mfgr SCRIPT [(part)part.FieldSchema(name:p_partkey,
 POSTHOOK: Lineage: part_5.p_name SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_5.p_size SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_5.r SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
-POSTHOOK: Lineage: part_5.s1 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_5.s2 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 Manufacturer#1	almond antique burnished rose metallic	1	1	2	2
 Manufacturer#1	almond antique burnished rose metallic	1	1	2	4
@@ -1133,7 +1125,6 @@ POSTHOOK: Lineage: part_5.p_mfgr SCRIPT [(part)part.FieldSchema(name:p_partkey,
 POSTHOOK: Lineage: part_5.p_name SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_5.p_size SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_5.r SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
-POSTHOOK: Lineage: part_5.s1 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_5.s2 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 Manufacturer#1	almond antique burnished rose metallic	1	1	2	2
 Manufacturer#1	almond antique burnished rose metallic	1	1	2	4
@@ -1208,7 +1199,6 @@ POSTHOOK: Lineage: part_5.p_mfgr SCRIPT [(part)part.FieldSchema(name:p_partkey,
 POSTHOOK: Lineage: part_5.p_name SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_5.p_size SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_5.r SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
-POSTHOOK: Lineage: part_5.s1 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_5.s2 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 Manufacturer#1	almond antique burnished rose metallic	1	1	2	4
 Manufacturer#1	almond antique burnished rose metallic	1	1	2	4
@@ -1287,7 +1277,6 @@ POSTHOOK: Lineage: part_5.p_mfgr SCRIPT [(part)part.FieldSchema(name:p_partkey,
 POSTHOOK: Lineage: part_5.p_name SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_5.p_size SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_5.r SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
-POSTHOOK: Lineage: part_5.s1 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_5.s2 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 Manufacturer#1	almond antique burnished rose metallic	1	1	2	2
 Manufacturer#1	almond antique burnished rose metallic	1	1	2	4
@@ -1364,7 +1353,6 @@ POSTHOOK: Lineage: part_5.p_mfgr SCRIPT [(part)part.FieldSchema(name:p_partkey,
 POSTHOOK: Lineage: part_5.p_name SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_5.p_size SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_5.r SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
-POSTHOOK: Lineage: part_5.s1 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_5.s2 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 Manufacturer#1	almond antique burnished rose metallic	1	1	2	2	2
 Manufacturer#1	almond antique burnished rose metallic	1	1	2	4	4
@@ -1394,11 +1382,11 @@ Manufacturer#5	almond aquamarine dodger light gainsboro	1	1	46	46	46
 Manufacturer#5	almond azure blanched chiffon midnight	1	1	23	23	23
 PREHOOK: query: -- 23. testMultiOperatorChainWithDiffPartitionForWindow2
 select p_mfgr, p_name,  
-rank() over (partition by p_mfgr order by p_mfgr) as r, 
-dense_rank() over (partition by p_mfgr order by p_mfgr) as dr, 
+rank() over (partition by p_mfgr order by p_name) as r, 
+dense_rank() over (partition by p_mfgr order by p_name) as dr, 
 p_size, 
-sum(p_size) over (partition by p_mfgr order by p_mfgr rows between unbounded preceding and current row) as s1, 
-sum(p_size) over (partition by p_mfgr order by p_mfgr rows between unbounded preceding and current row)  as s2
+sum(p_size) over (partition by p_mfgr order by p_name range between unbounded preceding and current row) as s1, 
+sum(p_size) over (partition by p_mfgr order by p_name range between unbounded preceding and current row)  as s2
 from noopwithmap(on 
         noop(on 
               noop(on part 
@@ -1410,11 +1398,11 @@ PREHOOK: Input: default@part
 #### A masked pattern was here ####
 POSTHOOK: query: -- 23. testMultiOperatorChainWithDiffPartitionForWindow2
 select p_mfgr, p_name,  
-rank() over (partition by p_mfgr order by p_mfgr) as r, 
-dense_rank() over (partition by p_mfgr order by p_mfgr) as dr, 
+rank() over (partition by p_mfgr order by p_name) as r, 
+dense_rank() over (partition by p_mfgr order by p_name) as dr, 
 p_size, 
-sum(p_size) over (partition by p_mfgr order by p_mfgr rows between unbounded preceding and current row) as s1, 
-sum(p_size) over (partition by p_mfgr order by p_mfgr rows between unbounded preceding and current row)  as s2
+sum(p_size) over (partition by p_mfgr order by p_name range between unbounded preceding and current row) as s1, 
+sum(p_size) over (partition by p_mfgr order by p_name range between unbounded preceding and current row)  as s2
 from noopwithmap(on 
         noop(on 
               noop(on part 
@@ -1437,31 +1425,30 @@ POSTHOOK: Lineage: part_5.p_mfgr SCRIPT [(part)part.FieldSchema(name:p_partkey,
 POSTHOOK: Lineage: part_5.p_name SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_5.p_size SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_5.r SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
-POSTHOOK: Lineage: part_5.s1 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_5.s2 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
-Manufacturer#1	almond antique burnished rose metallic	1	1	2	2	2
-Manufacturer#1	almond antique chartreuse lavender yellow	1	1	34	36	36
-Manufacturer#1	almond antique burnished rose metallic	1	1	2	38	38
-Manufacturer#1	almond antique salmon chartreuse burlywood	1	1	6	44	44
-Manufacturer#1	almond aquamarine burnished black steel	1	1	28	72	72
-Manufacturer#1	almond aquamarine pink moccasin thistle	1	1	42	114	114
+Manufacturer#1	almond antique burnished rose metallic	1	1	2	4	4
+Manufacturer#1	almond antique burnished rose metallic	1	1	2	4	4
+Manufacturer#1	almond antique chartreuse lavender yellow	3	2	34	38	38
+Manufacturer#1	almond antique salmon chartreuse burlywood	4	3	6	44	44
+Manufacturer#1	almond aquamarine burnished black steel	5	4	28	72	72
+Manufacturer#1	almond aquamarine pink moccasin thistle	6	5	42	114	114
 Manufacturer#2	almond antique violet chocolate turquoise	1	1	14	14	14
-Manufacturer#2	almond antique violet turquoise frosted	1	1	40	54	54
-Manufacturer#2	almond aquamarine midnight light salmon	1	1	2	56	56
-Manufacturer#2	almond aquamarine rose maroon antique	1	1	25	81	81
-Manufacturer#2	almond aquamarine sandy cyan gainsboro	1	1	18	99	99
-Manufacturer#3	almond antique metallic orange dim	1	1	19	19	19
-Manufacturer#3	almond antique chartreuse khaki white	1	1	17	36	36
-Manufacturer#3	almond antique forest lavender goldenrod	1	1	14	50	50
-Manufacturer#3	almond antique misty red olive	1	1	1	51	51
-Manufacturer#3	almond antique olive coral navajo	1	1	45	96	96
+Manufacturer#2	almond antique violet turquoise frosted	2	2	40	54	54
+Manufacturer#2	almond aquamarine midnight light salmon	3	3	2	56	56
+Manufacturer#2	almond aquamarine rose maroon antique	4	4	25	81	81
+Manufacturer#2	almond aquamarine sandy cyan gainsboro	5	5	18	99	99
+Manufacturer#3	almond antique chartreuse khaki white	1	1	17	17	17
+Manufacturer#3	almond antique forest lavender goldenrod	2	2	14	31	31
+Manufacturer#3	almond antique metallic orange dim	3	3	19	50	50
+Manufacturer#3	almond antique misty red olive	4	4	1	51	51
+Manufacturer#3	almond antique olive coral navajo	5	5	45	96	96
 Manufacturer#4	almond antique gainsboro frosted violet	1	1	10	10	10
-Manufacturer#4	almond antique violet mint lemon	1	1	39	49	49
-Manufacturer#4	almond aquamarine floral ivory bisque	1	1	27	76	76
-Manufacturer#4	almond aquamarine yellow dodger mint	1	1	7	83	83
-Manufacturer#4	almond azure aquamarine papaya violet	1	1	12	95	95
+Manufacturer#4	almond antique violet mint lemon	2	2	39	49	49
+Manufacturer#4	almond aquamarine floral ivory bisque	3	3	27	76	76
+Manufacturer#4	almond aquamarine yellow dodger mint	4	4	7	83	83
+Manufacturer#4	almond azure aquamarine papaya violet	5	5	12	95	95
 Manufacturer#5	almond antique blue firebrick mint	1	1	31	31	31
-Manufacturer#5	almond antique medium spring khaki	1	1	6	37	37
-Manufacturer#5	almond antique sky peru orange	1	1	2	39	39
-Manufacturer#5	almond aquamarine dodger light gainsboro	1	1	46	85	85
-Manufacturer#5	almond azure blanched chiffon midnight	1	1	23	108	108
+Manufacturer#5	almond antique medium spring khaki	2	2	6	37	37
+Manufacturer#5	almond antique sky peru orange	3	3	2	39	39
+Manufacturer#5	almond aquamarine dodger light gainsboro	4	4	46	85	85
+Manufacturer#5	almond azure blanched chiffon midnight	5	5	23	108	108
diff --git a/ql/src/test/results/clientpositive/ptf_general_queries.q.out b/ql/src/test/results/clientpositive/ptf_general_queries.q.out
index a7c5384a73..4914b8fa8e 100644
--- a/ql/src/test/results/clientpositive/ptf_general_queries.q.out
+++ b/ql/src/test/results/clientpositive/ptf_general_queries.q.out
@@ -79,49 +79,49 @@ Manufacturer#4	almond azure aquamarine papaya violet	12
 Manufacturer#5	almond azure blanched chiffon midnight	23
 PREHOOK: query: -- 2. testUDAFsNoWindowingNoPTFNoGBY
 select p_mfgr,p_name, p_retailprice,  
-sum(p_retailprice) over(partition by p_mfgr order by p_mfgr) as s,
-min(p_retailprice) over(partition by p_mfgr order by p_mfgr) as mi,
-max(p_retailprice) over(partition by p_mfgr order by p_mfgr) as ma,
-avg(p_retailprice) over(partition by p_mfgr order by p_mfgr) as av 
+sum(p_retailprice) over(partition by p_mfgr order by p_name) as s,
+min(p_retailprice) over(partition by p_mfgr order by p_name) as mi,
+max(p_retailprice) over(partition by p_mfgr order by p_name) as ma,
+avg(p_retailprice) over(partition by p_mfgr order by p_name) as av 
 from part
 PREHOOK: type: QUERY
 PREHOOK: Input: default@part
 #### A masked pattern was here ####
 POSTHOOK: query: -- 2. testUDAFsNoWindowingNoPTFNoGBY
 select p_mfgr,p_name, p_retailprice,  
-sum(p_retailprice) over(partition by p_mfgr order by p_mfgr) as s,
-min(p_retailprice) over(partition by p_mfgr order by p_mfgr) as mi,
-max(p_retailprice) over(partition by p_mfgr order by p_mfgr) as ma,
-avg(p_retailprice) over(partition by p_mfgr order by p_mfgr) as av 
+sum(p_retailprice) over(partition by p_mfgr order by p_name) as s,
+min(p_retailprice) over(partition by p_mfgr order by p_name) as mi,
+max(p_retailprice) over(partition by p_mfgr order by p_name) as ma,
+avg(p_retailprice) over(partition by p_mfgr order by p_name) as av 
 from part
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@part
 #### A masked pattern was here ####
-Manufacturer#1	almond antique burnished rose metallic	1173.15	8749.73	1173.15	1753.76	1458.2883333333332
-Manufacturer#1	almond antique chartreuse lavender yellow	1753.76	8749.73	1173.15	1753.76	1458.2883333333332
-Manufacturer#1	almond antique burnished rose metallic	1173.15	8749.73	1173.15	1753.76	1458.2883333333332
-Manufacturer#1	almond antique salmon chartreuse burlywood	1602.59	8749.73	1173.15	1753.76	1458.2883333333332
-Manufacturer#1	almond aquamarine burnished black steel	1414.42	8749.73	1173.15	1753.76	1458.2883333333332
-Manufacturer#1	almond aquamarine pink moccasin thistle	1632.66	8749.73	1173.15	1753.76	1458.2883333333332
-Manufacturer#2	almond antique violet chocolate turquoise	1690.68	8923.62	1690.68	2031.98	1784.7240000000002
-Manufacturer#2	almond antique violet turquoise frosted	1800.7	8923.62	1690.68	2031.98	1784.7240000000002
-Manufacturer#2	almond aquamarine midnight light salmon	2031.98	8923.62	1690.68	2031.98	1784.7240000000002
-Manufacturer#2	almond aquamarine rose maroon antique	1698.66	8923.62	1690.68	2031.98	1784.7240000000002
+Manufacturer#1	almond antique burnished rose metallic	1173.15	2346.3	1173.15	1173.15	1173.15
+Manufacturer#1	almond antique burnished rose metallic	1173.15	2346.3	1173.15	1173.15	1173.15
+Manufacturer#1	almond antique chartreuse lavender yellow	1753.76	4100.06	1173.15	1753.76	1366.6866666666667
+Manufacturer#1	almond antique salmon chartreuse burlywood	1602.59	5702.650000000001	1173.15	1753.76	1425.6625000000001
+Manufacturer#1	almond aquamarine burnished black steel	1414.42	7117.070000000001	1173.15	1753.76	1423.4140000000002
+Manufacturer#1	almond aquamarine pink moccasin thistle	1632.66	8749.730000000001	1173.15	1753.76	1458.2883333333336
+Manufacturer#2	almond antique violet chocolate turquoise	1690.68	1690.68	1690.68	1690.68	1690.68
+Manufacturer#2	almond antique violet turquoise frosted	1800.7	3491.38	1690.68	1800.7	1745.69
+Manufacturer#2	almond aquamarine midnight light salmon	2031.98	5523.360000000001	1690.68	2031.98	1841.1200000000001
+Manufacturer#2	almond aquamarine rose maroon antique	1698.66	7222.02	1690.68	2031.98	1805.505
 Manufacturer#2	almond aquamarine sandy cyan gainsboro	1701.6	8923.62	1690.68	2031.98	1784.7240000000002
-Manufacturer#3	almond antique metallic orange dim	1410.39	7532.61	1190.27	1922.98	1506.522
-Manufacturer#3	almond antique chartreuse khaki white	1671.68	7532.61	1190.27	1922.98	1506.522
-Manufacturer#3	almond antique forest lavender goldenrod	1190.27	7532.61	1190.27	1922.98	1506.522
-Manufacturer#3	almond antique misty red olive	1922.98	7532.61	1190.27	1922.98	1506.522
+Manufacturer#3	almond antique chartreuse khaki white	1671.68	1671.68	1671.68	1671.68	1671.68
+Manufacturer#3	almond antique forest lavender goldenrod	1190.27	2861.95	1190.27	1671.68	1430.975
+Manufacturer#3	almond antique metallic orange dim	1410.39	4272.34	1190.27	1671.68	1424.1133333333335
+Manufacturer#3	almond antique misty red olive	1922.98	6195.32	1190.27	1922.98	1548.83
 Manufacturer#3	almond antique olive coral navajo	1337.29	7532.61	1190.27	1922.98	1506.522
-Manufacturer#4	almond antique gainsboro frosted violet	1620.67	7337.620000000001	1206.26	1844.92	1467.5240000000001
-Manufacturer#4	almond antique violet mint lemon	1375.42	7337.620000000001	1206.26	1844.92	1467.5240000000001
-Manufacturer#4	almond aquamarine floral ivory bisque	1206.26	7337.620000000001	1206.26	1844.92	1467.5240000000001
-Manufacturer#4	almond aquamarine yellow dodger mint	1844.92	7337.620000000001	1206.26	1844.92	1467.5240000000001
+Manufacturer#4	almond antique gainsboro frosted violet	1620.67	1620.67	1620.67	1620.67	1620.67
+Manufacturer#4	almond antique violet mint lemon	1375.42	2996.09	1375.42	1620.67	1498.045
+Manufacturer#4	almond aquamarine floral ivory bisque	1206.26	4202.35	1206.26	1620.67	1400.7833333333335
+Manufacturer#4	almond aquamarine yellow dodger mint	1844.92	6047.27	1206.26	1844.92	1511.8175
 Manufacturer#4	almond azure aquamarine papaya violet	1290.35	7337.620000000001	1206.26	1844.92	1467.5240000000001
-Manufacturer#5	almond antique blue firebrick mint	1789.69	7672.66	1018.1	1789.69	1534.532
-Manufacturer#5	almond antique medium spring khaki	1611.66	7672.66	1018.1	1789.69	1534.532
-Manufacturer#5	almond antique sky peru orange	1788.73	7672.66	1018.1	1789.69	1534.532
-Manufacturer#5	almond aquamarine dodger light gainsboro	1018.1	7672.66	1018.1	1789.69	1534.532
+Manufacturer#5	almond antique blue firebrick mint	1789.69	1789.69	1789.69	1789.69	1789.69
+Manufacturer#5	almond antique medium spring khaki	1611.66	3401.3500000000004	1611.66	1789.69	1700.6750000000002
+Manufacturer#5	almond antique sky peru orange	1788.73	5190.08	1611.66	1789.69	1730.0266666666666
+Manufacturer#5	almond aquamarine dodger light gainsboro	1018.1	6208.18	1018.1	1789.69	1552.045
 Manufacturer#5	almond azure blanched chiffon midnight	1464.48	7672.66	1018.1	1789.69	1534.532
 PREHOOK: query: -- 3. testConstExprInSelect
 select 'tst1' as key, count(1) as value from part
diff --git a/ql/src/test/results/clientpositive/windowing.q.out b/ql/src/test/results/clientpositive/windowing.q.out
index 55fe4d0ce2..43c3753cc5 100644
--- a/ql/src/test/results/clientpositive/windowing.q.out
+++ b/ql/src/test/results/clientpositive/windowing.q.out
@@ -497,40 +497,40 @@ Manufacturer#5	almond aquamarine dodger light gainsboro	46	4	4	6208.18
 Manufacturer#5	almond azure blanched chiffon midnight	23	5	5	7672.66
 PREHOOK: query: -- 11. testFirstLast   
 select  p_mfgr,p_name, p_size, 
-sum(p_size) over (distribute by p_mfgr sort by p_mfgr rows between current row and current row) as s2, 
+sum(p_size) over (distribute by p_mfgr sort by p_name rows between current row and current row) as s2, 
 first_value(p_size) over w1  as f, 
 last_value(p_size, false) over w1  as l 
 from part 
-window w1 as (distribute by p_mfgr sort by p_mfgr rows between 2 preceding and 2 following)
+window w1 as (distribute by p_mfgr sort by p_name rows between 2 preceding and 2 following)
 PREHOOK: type: QUERY
 PREHOOK: Input: default@part
 #### A masked pattern was here ####
 POSTHOOK: query: -- 11. testFirstLast   
 select  p_mfgr,p_name, p_size, 
-sum(p_size) over (distribute by p_mfgr sort by p_mfgr rows between current row and current row) as s2, 
+sum(p_size) over (distribute by p_mfgr sort by p_name rows between current row and current row) as s2, 
 first_value(p_size) over w1  as f, 
 last_value(p_size, false) over w1  as l 
 from part 
-window w1 as (distribute by p_mfgr sort by p_mfgr rows between 2 preceding and 2 following)
+window w1 as (distribute by p_mfgr sort by p_name rows between 2 preceding and 2 following)
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@part
 #### A masked pattern was here ####
-Manufacturer#1	almond antique burnished rose metallic	2	2	2	2
-Manufacturer#1	almond antique chartreuse lavender yellow	34	34	2	6
-Manufacturer#1	almond antique burnished rose metallic	2	2	2	28
-Manufacturer#1	almond antique salmon chartreuse burlywood	6	6	34	42
-Manufacturer#1	almond aquamarine burnished black steel	28	28	2	42
+Manufacturer#1	almond antique burnished rose metallic	2	2	2	34
+Manufacturer#1	almond antique burnished rose metallic	2	2	2	6
+Manufacturer#1	almond antique chartreuse lavender yellow	34	34	2	28
+Manufacturer#1	almond antique salmon chartreuse burlywood	6	6	2	42
+Manufacturer#1	almond aquamarine burnished black steel	28	28	34	42
 Manufacturer#1	almond aquamarine pink moccasin thistle	42	42	6	42
 Manufacturer#2	almond antique violet chocolate turquoise	14	14	14	2
 Manufacturer#2	almond antique violet turquoise frosted	40	40	14	25
 Manufacturer#2	almond aquamarine midnight light salmon	2	2	14	18
 Manufacturer#2	almond aquamarine rose maroon antique	25	25	40	18
 Manufacturer#2	almond aquamarine sandy cyan gainsboro	18	18	2	18
-Manufacturer#3	almond antique metallic orange dim	19	19	19	14
-Manufacturer#3	almond antique chartreuse khaki white	17	17	19	1
-Manufacturer#3	almond antique forest lavender goldenrod	14	14	19	45
-Manufacturer#3	almond antique misty red olive	1	1	17	45
-Manufacturer#3	almond antique olive coral navajo	45	45	14	45
+Manufacturer#3	almond antique chartreuse khaki white	17	17	17	19
+Manufacturer#3	almond antique forest lavender goldenrod	14	14	17	1
+Manufacturer#3	almond antique metallic orange dim	19	19	17	45
+Manufacturer#3	almond antique misty red olive	1	1	14	45
+Manufacturer#3	almond antique olive coral navajo	45	45	19	45
 Manufacturer#4	almond antique gainsboro frosted violet	10	10	10	27
 Manufacturer#4	almond antique violet mint lemon	39	39	10	7
 Manufacturer#4	almond aquamarine floral ivory bisque	27	27	10	12
@@ -543,67 +543,67 @@ Manufacturer#5	almond aquamarine dodger light gainsboro	46	46	6	23
 Manufacturer#5	almond azure blanched chiffon midnight	23	23	2	23
 PREHOOK: query: -- 12. testFirstLastWithWhere
 select  p_mfgr,p_name, p_size, 
-rank() over(distribute by p_mfgr sort by p_mfgr) as r, 
-sum(p_size) over (distribute by p_mfgr sort by p_mfgr rows between current row and current row) as s2, 
+rank() over(distribute by p_mfgr sort by p_name) as r, 
+sum(p_size) over (distribute by p_mfgr sort by p_name rows between current row and current row) as s2, 
 first_value(p_size) over w1 as f,  
 last_value(p_size, false) over w1 as l 
 from part 
 where p_mfgr = 'Manufacturer#3'  
-window w1 as (distribute by p_mfgr sort by p_mfgr rows between 2 preceding and 2 following)
+window w1 as (distribute by p_mfgr sort by p_name rows between 2 preceding and 2 following)
 PREHOOK: type: QUERY
 PREHOOK: Input: default@part
 #### A masked pattern was here ####
 POSTHOOK: query: -- 12. testFirstLastWithWhere
 select  p_mfgr,p_name, p_size, 
-rank() over(distribute by p_mfgr sort by p_mfgr) as r, 
-sum(p_size) over (distribute by p_mfgr sort by p_mfgr rows between current row and current row) as s2, 
+rank() over(distribute by p_mfgr sort by p_name) as r, 
+sum(p_size) over (distribute by p_mfgr sort by p_name rows between current row and current row) as s2, 
 first_value(p_size) over w1 as f,  
 last_value(p_size, false) over w1 as l 
 from part 
 where p_mfgr = 'Manufacturer#3'  
-window w1 as (distribute by p_mfgr sort by p_mfgr rows between 2 preceding and 2 following)
+window w1 as (distribute by p_mfgr sort by p_name rows between 2 preceding and 2 following)
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@part
 #### A masked pattern was here ####
 Manufacturer#3	almond antique chartreuse khaki white	17	1	17	17	19
-Manufacturer#3	almond antique forest lavender goldenrod	14	1	14	17	1
-Manufacturer#3	almond antique metallic orange dim	19	1	19	17	45
-Manufacturer#3	almond antique misty red olive	1	1	1	14	45
-Manufacturer#3	almond antique olive coral navajo	45	1	45	19	45
+Manufacturer#3	almond antique forest lavender goldenrod	14	2	14	17	1
+Manufacturer#3	almond antique metallic orange dim	19	3	19	17	45
+Manufacturer#3	almond antique misty red olive	1	4	1	14	45
+Manufacturer#3	almond antique olive coral navajo	45	5	45	19	45
 PREHOOK: query: -- 13. testSumWindow
 select  p_mfgr,p_name, p_size,  
 sum(p_size) over w1 as s1, 
-sum(p_size) over (distribute by p_mfgr  sort by p_mfgr rows between current row and current row)  as s2 
+sum(p_size) over (distribute by p_mfgr  sort by p_name rows between current row and current row)  as s2 
 from part 
-window w1 as (distribute by p_mfgr  sort by p_mfgr rows between 2 preceding and 2 following)
+window w1 as (distribute by p_mfgr  sort by p_name rows between 2 preceding and 2 following)
 PREHOOK: type: QUERY
 PREHOOK: Input: default@part
 #### A masked pattern was here ####
 POSTHOOK: query: -- 13. testSumWindow
 select  p_mfgr,p_name, p_size,  
 sum(p_size) over w1 as s1, 
-sum(p_size) over (distribute by p_mfgr  sort by p_mfgr rows between current row and current row)  as s2 
+sum(p_size) over (distribute by p_mfgr  sort by p_name rows between current row and current row)  as s2 
 from part 
-window w1 as (distribute by p_mfgr  sort by p_mfgr rows between 2 preceding and 2 following)
+window w1 as (distribute by p_mfgr  sort by p_name rows between 2 preceding and 2 following)
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@part
 #### A masked pattern was here ####
 Manufacturer#1	almond antique burnished rose metallic	2	38	2
-Manufacturer#1	almond antique chartreuse lavender yellow	34	44	34
-Manufacturer#1	almond antique burnished rose metallic	2	72	2
+Manufacturer#1	almond antique burnished rose metallic	2	44	2
+Manufacturer#1	almond antique chartreuse lavender yellow	34	72	34
 Manufacturer#1	almond antique salmon chartreuse burlywood	6	112	6
-Manufacturer#1	almond aquamarine burnished black steel	28	78	28
+Manufacturer#1	almond aquamarine burnished black steel	28	110	28
 Manufacturer#1	almond aquamarine pink moccasin thistle	42	76	42
 Manufacturer#2	almond antique violet chocolate turquoise	14	56	14
 Manufacturer#2	almond antique violet turquoise frosted	40	81	40
 Manufacturer#2	almond aquamarine midnight light salmon	2	99	2
 Manufacturer#2	almond aquamarine rose maroon antique	25	85	25
 Manufacturer#2	almond aquamarine sandy cyan gainsboro	18	45	18
-Manufacturer#3	almond antique metallic orange dim	19	50	19
-Manufacturer#3	almond antique chartreuse khaki white	17	51	17
-Manufacturer#3	almond antique forest lavender goldenrod	14	96	14
-Manufacturer#3	almond antique misty red olive	1	77	1
-Manufacturer#3	almond antique olive coral navajo	45	60	45
+Manufacturer#3	almond antique chartreuse khaki white	17	50	17
+Manufacturer#3	almond antique forest lavender goldenrod	14	51	14
+Manufacturer#3	almond antique metallic orange dim	19	96	19
+Manufacturer#3	almond antique misty red olive	1	79	1
+Manufacturer#3	almond antique olive coral navajo	45	65	45
 Manufacturer#4	almond antique gainsboro frosted violet	10	76	10
 Manufacturer#4	almond antique violet mint lemon	39	83	39
 Manufacturer#4	almond aquamarine floral ivory bisque	27	95	27
@@ -616,58 +616,58 @@ Manufacturer#5	almond aquamarine dodger light gainsboro	46	77	46
 Manufacturer#5	almond azure blanched chiffon midnight	23	71	23
 PREHOOK: query: -- 14. testNoSortClause
 select  p_mfgr,p_name, p_size, 
-rank() over(distribute by p_mfgr) as r, dense_rank() over(distribute by p_mfgr) as dr 
+rank() over(distribute by p_mfgr sort by p_name) as r, dense_rank() over(distribute by p_mfgr sort by p_name) as dr 
 from part  
-window w1 as (distribute by p_mfgr rows between 2 preceding and 2 following)
+window w1 as (distribute by p_mfgr sort by p_name rows between 2 preceding and 2 following)
 PREHOOK: type: QUERY
 PREHOOK: Input: default@part
 #### A masked pattern was here ####
 POSTHOOK: query: -- 14. testNoSortClause
 select  p_mfgr,p_name, p_size, 
-rank() over(distribute by p_mfgr) as r, dense_rank() over(distribute by p_mfgr) as dr 
+rank() over(distribute by p_mfgr sort by p_name) as r, dense_rank() over(distribute by p_mfgr sort by p_name) as dr 
 from part  
-window w1 as (distribute by p_mfgr rows between 2 preceding and 2 following)
+window w1 as (distribute by p_mfgr sort by p_name rows between 2 preceding and 2 following)
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@part
 #### A masked pattern was here ####
 Manufacturer#1	almond antique burnished rose metallic	2	1	1
-Manufacturer#1	almond antique chartreuse lavender yellow	34	1	1
 Manufacturer#1	almond antique burnished rose metallic	2	1	1
-Manufacturer#1	almond antique salmon chartreuse burlywood	6	1	1
-Manufacturer#1	almond aquamarine burnished black steel	28	1	1
-Manufacturer#1	almond aquamarine pink moccasin thistle	42	1	1
+Manufacturer#1	almond antique chartreuse lavender yellow	34	3	2
+Manufacturer#1	almond antique salmon chartreuse burlywood	6	4	3
+Manufacturer#1	almond aquamarine burnished black steel	28	5	4
+Manufacturer#1	almond aquamarine pink moccasin thistle	42	6	5
 Manufacturer#2	almond antique violet chocolate turquoise	14	1	1
-Manufacturer#2	almond antique violet turquoise frosted	40	1	1
-Manufacturer#2	almond aquamarine midnight light salmon	2	1	1
-Manufacturer#2	almond aquamarine rose maroon antique	25	1	1
-Manufacturer#2	almond aquamarine sandy cyan gainsboro	18	1	1
-Manufacturer#3	almond antique metallic orange dim	19	1	1
+Manufacturer#2	almond antique violet turquoise frosted	40	2	2
+Manufacturer#2	almond aquamarine midnight light salmon	2	3	3
+Manufacturer#2	almond aquamarine rose maroon antique	25	4	4
+Manufacturer#2	almond aquamarine sandy cyan gainsboro	18	5	5
 Manufacturer#3	almond antique chartreuse khaki white	17	1	1
-Manufacturer#3	almond antique forest lavender goldenrod	14	1	1
-Manufacturer#3	almond antique misty red olive	1	1	1
-Manufacturer#3	almond antique olive coral navajo	45	1	1
+Manufacturer#3	almond antique forest lavender goldenrod	14	2	2
+Manufacturer#3	almond antique metallic orange dim	19	3	3
+Manufacturer#3	almond antique misty red olive	1	4	4
+Manufacturer#3	almond antique olive coral navajo	45	5	5
 Manufacturer#4	almond antique gainsboro frosted violet	10	1	1
-Manufacturer#4	almond antique violet mint lemon	39	1	1
-Manufacturer#4	almond aquamarine floral ivory bisque	27	1	1
-Manufacturer#4	almond aquamarine yellow dodger mint	7	1	1
-Manufacturer#4	almond azure aquamarine papaya violet	12	1	1
+Manufacturer#4	almond antique violet mint lemon	39	2	2
+Manufacturer#4	almond aquamarine floral ivory bisque	27	3	3
+Manufacturer#4	almond aquamarine yellow dodger mint	7	4	4
+Manufacturer#4	almond azure aquamarine papaya violet	12	5	5
 Manufacturer#5	almond antique blue firebrick mint	31	1	1
-Manufacturer#5	almond antique medium spring khaki	6	1	1
-Manufacturer#5	almond antique sky peru orange	2	1	1
-Manufacturer#5	almond aquamarine dodger light gainsboro	46	1	1
-Manufacturer#5	almond azure blanched chiffon midnight	23	1	1
+Manufacturer#5	almond antique medium spring khaki	6	2	2
+Manufacturer#5	almond antique sky peru orange	2	3	3
+Manufacturer#5	almond aquamarine dodger light gainsboro	46	4	4
+Manufacturer#5	almond azure blanched chiffon midnight	23	5	5
 PREHOOK: query: -- 15. testExpressions
 select  p_mfgr,p_name, p_size,  
-rank() over(distribute by p_mfgr sort by p_mfgr) as r,  
-dense_rank() over(distribute by p_mfgr sort by p_mfgr) as dr, 
-cume_dist() over(distribute by p_mfgr sort by p_mfgr) as cud, 
-percent_rank() over(distribute by p_mfgr sort by p_mfgr) as pr, 
-ntile(3) over(distribute by p_mfgr sort by p_mfgr) as nt, 
-count(p_size) over(distribute by p_mfgr sort by p_mfgr) as ca, 
-avg(p_size) over(distribute by p_mfgr sort by p_mfgr) as avg, 
-stddev(p_size) over(distribute by p_mfgr sort by p_mfgr) as st, 
-first_value(p_size % 5) over(distribute by p_mfgr sort by p_mfgr) as fv, 
-last_value(p_size) over(distribute by p_mfgr sort by p_mfgr) as lv, 
+rank() over(distribute by p_mfgr sort by p_name) as r,  
+dense_rank() over(distribute by p_mfgr sort by p_name) as dr, 
+cume_dist() over(distribute by p_mfgr sort by p_name) as cud, 
+percent_rank() over(distribute by p_mfgr sort by p_name) as pr, 
+ntile(3) over(distribute by p_mfgr sort by p_name) as nt, 
+count(p_size) over(distribute by p_mfgr sort by p_name) as ca, 
+avg(p_size) over(distribute by p_mfgr sort by p_name) as avg, 
+stddev(p_size) over(distribute by p_mfgr sort by p_name) as st, 
+first_value(p_size % 5) over(distribute by p_mfgr sort by p_name) as fv, 
+last_value(p_size) over(distribute by p_mfgr sort by p_name) as lv, 
 first_value(p_size) over w1  as fvW1
 from part 
 window w1 as (distribute by p_mfgr sort by p_mfgr, p_name rows between 2 preceding and 2 following)
@@ -676,54 +676,54 @@ PREHOOK: Input: default@part
 #### A masked pattern was here ####
 POSTHOOK: query: -- 15. testExpressions
 select  p_mfgr,p_name, p_size,  
-rank() over(distribute by p_mfgr sort by p_mfgr) as r,  
-dense_rank() over(distribute by p_mfgr sort by p_mfgr) as dr, 
-cume_dist() over(distribute by p_mfgr sort by p_mfgr) as cud, 
-percent_rank() over(distribute by p_mfgr sort by p_mfgr) as pr, 
-ntile(3) over(distribute by p_mfgr sort by p_mfgr) as nt, 
-count(p_size) over(distribute by p_mfgr sort by p_mfgr) as ca, 
-avg(p_size) over(distribute by p_mfgr sort by p_mfgr) as avg, 
-stddev(p_size) over(distribute by p_mfgr sort by p_mfgr) as st, 
-first_value(p_size % 5) over(distribute by p_mfgr sort by p_mfgr) as fv, 
-last_value(p_size) over(distribute by p_mfgr sort by p_mfgr) as lv, 
+rank() over(distribute by p_mfgr sort by p_name) as r,  
+dense_rank() over(distribute by p_mfgr sort by p_name) as dr, 
+cume_dist() over(distribute by p_mfgr sort by p_name) as cud, 
+percent_rank() over(distribute by p_mfgr sort by p_name) as pr, 
+ntile(3) over(distribute by p_mfgr sort by p_name) as nt, 
+count(p_size) over(distribute by p_mfgr sort by p_name) as ca, 
+avg(p_size) over(distribute by p_mfgr sort by p_name) as avg, 
+stddev(p_size) over(distribute by p_mfgr sort by p_name) as st, 
+first_value(p_size % 5) over(distribute by p_mfgr sort by p_name) as fv, 
+last_value(p_size) over(distribute by p_mfgr sort by p_name) as lv, 
 first_value(p_size) over w1  as fvW1
 from part 
 window w1 as (distribute by p_mfgr sort by p_mfgr, p_name rows between 2 preceding and 2 following)
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@part
 #### A masked pattern was here ####
-Manufacturer#1	almond antique burnished rose metallic	2	1	1	1.0	0.0	2	6	19.0	16.237815945091466	2	42	2
-Manufacturer#1	almond antique burnished rose metallic	2	1	1	1.0	0.0	1	6	19.0	16.237815945091466	2	42	2
-Manufacturer#1	almond antique chartreuse lavender yellow	34	1	1	1.0	0.0	1	6	19.0	16.237815945091466	2	42	2
-Manufacturer#1	almond antique salmon chartreuse burlywood	6	1	1	1.0	0.0	2	6	19.0	16.237815945091466	2	42	2
-Manufacturer#1	almond aquamarine burnished black steel	28	1	1	1.0	0.0	3	6	19.0	16.237815945091466	2	42	34
-Manufacturer#1	almond aquamarine pink moccasin thistle	42	1	1	1.0	0.0	3	6	19.0	16.237815945091466	2	42	6
-Manufacturer#2	almond antique violet chocolate turquoise	14	1	1	1.0	0.0	1	5	19.8	12.560254774486067	4	18	14
-Manufacturer#2	almond antique violet turquoise frosted	40	1	1	1.0	0.0	1	5	19.8	12.560254774486067	4	18	14
-Manufacturer#2	almond aquamarine midnight light salmon	2	1	1	1.0	0.0	2	5	19.8	12.560254774486067	4	18	14
-Manufacturer#2	almond aquamarine rose maroon antique	25	1	1	1.0	0.0	2	5	19.8	12.560254774486067	4	18	40
-Manufacturer#2	almond aquamarine sandy cyan gainsboro	18	1	1	1.0	0.0	3	5	19.8	12.560254774486067	4	18	2
-Manufacturer#3	almond antique chartreuse khaki white	17	1	1	1.0	0.0	1	5	19.2	14.344336861632886	4	45	17
-Manufacturer#3	almond antique forest lavender goldenrod	14	1	1	1.0	0.0	2	5	19.2	14.344336861632886	4	45	17
-Manufacturer#3	almond antique metallic orange dim	19	1	1	1.0	0.0	1	5	19.2	14.344336861632886	4	45	17
-Manufacturer#3	almond antique misty red olive	1	1	1	1.0	0.0	2	5	19.2	14.344336861632886	4	45	14
-Manufacturer#3	almond antique olive coral navajo	45	1	1	1.0	0.0	3	5	19.2	14.344336861632886	4	45	19
-Manufacturer#4	almond antique gainsboro frosted violet	10	1	1	1.0	0.0	1	5	19.0	12.149074038789951	0	12	10
-Manufacturer#4	almond antique violet mint lemon	39	1	1	1.0	0.0	1	5	19.0	12.149074038789951	0	12	10
-Manufacturer#4	almond aquamarine floral ivory bisque	27	1	1	1.0	0.0	2	5	19.0	12.149074038789951	0	12	10
-Manufacturer#4	almond aquamarine yellow dodger mint	7	1	1	1.0	0.0	2	5	19.0	12.149074038789951	0	12	39
-Manufacturer#4	almond azure aquamarine papaya violet	12	1	1	1.0	0.0	3	5	19.0	12.149074038789951	0	12	27
-Manufacturer#5	almond antique blue firebrick mint	31	1	1	1.0	0.0	1	5	21.6	16.206171663906314	1	23	31
-Manufacturer#5	almond antique medium spring khaki	6	1	1	1.0	0.0	1	5	21.6	16.206171663906314	1	23	31
-Manufacturer#5	almond antique sky peru orange	2	1	1	1.0	0.0	2	5	21.6	16.206171663906314	1	23	31
-Manufacturer#5	almond aquamarine dodger light gainsboro	46	1	1	1.0	0.0	2	5	21.6	16.206171663906314	1	23	6
-Manufacturer#5	almond azure blanched chiffon midnight	23	1	1	1.0	0.0	3	5	21.6	16.206171663906314	1	23	2
+Manufacturer#1	almond antique burnished rose metallic	2	1	1	0.3333333333333333	0.0	1	2	2.0	0.0	2	2	2
+Manufacturer#1	almond antique burnished rose metallic	2	1	1	0.3333333333333333	0.0	1	2	2.0	0.0	2	2	2
+Manufacturer#1	almond antique chartreuse lavender yellow	34	3	2	0.5	0.4	2	3	12.666666666666666	15.084944665313014	2	34	2
+Manufacturer#1	almond antique salmon chartreuse burlywood	6	4	3	0.6666666666666666	0.6	2	4	11.0	13.379088160259652	2	6	2
+Manufacturer#1	almond aquamarine burnished black steel	28	5	4	0.8333333333333334	0.8	3	5	14.4	13.763720427268202	2	28	34
+Manufacturer#1	almond aquamarine pink moccasin thistle	42	6	5	1.0	1.0	3	6	19.0	16.237815945091466	2	42	6
+Manufacturer#2	almond antique violet chocolate turquoise	14	1	1	0.2	0.0	1	1	14.0	0.0	4	14	14
+Manufacturer#2	almond antique violet turquoise frosted	40	2	2	0.4	0.25	1	2	27.0	13.0	4	40	14
+Manufacturer#2	almond aquamarine midnight light salmon	2	3	3	0.6	0.5	2	3	18.666666666666668	15.86050300449376	4	2	14
+Manufacturer#2	almond aquamarine rose maroon antique	25	4	4	0.8	0.75	2	4	20.25	14.00669482783144	4	25	40
+Manufacturer#2	almond aquamarine sandy cyan gainsboro	18	5	5	1.0	1.0	3	5	19.8	12.560254774486067	4	18	2
+Manufacturer#3	almond antique chartreuse khaki white	17	1	1	0.2	0.0	1	1	17.0	0.0	2	17	17
+Manufacturer#3	almond antique forest lavender goldenrod	14	2	2	0.4	0.25	1	2	15.5	1.5	2	14	17
+Manufacturer#3	almond antique metallic orange dim	19	3	3	0.6	0.5	2	3	16.666666666666668	2.0548046676563256	2	19	17
+Manufacturer#3	almond antique misty red olive	1	4	4	0.8	0.75	2	4	12.75	7.013380069552769	2	1	14
+Manufacturer#3	almond antique olive coral navajo	45	5	5	1.0	1.0	3	5	19.2	14.344336861632886	2	45	19
+Manufacturer#4	almond antique gainsboro frosted violet	10	1	1	0.2	0.0	1	1	10.0	0.0	0	10	10
+Manufacturer#4	almond antique violet mint lemon	39	2	2	0.4	0.25	1	2	24.5	14.5	0	39	10
+Manufacturer#4	almond aquamarine floral ivory bisque	27	3	3	0.6	0.5	2	3	25.333333333333332	11.897712198383164	0	27	10
+Manufacturer#4	almond aquamarine yellow dodger mint	7	4	4	0.8	0.75	2	4	20.75	13.007209539328564	0	7	39
+Manufacturer#4	almond azure aquamarine papaya violet	12	5	5	1.0	1.0	3	5	19.0	12.149074038789951	0	12	27
+Manufacturer#5	almond antique blue firebrick mint	31	1	1	0.2	0.0	1	1	31.0	0.0	1	31	31
+Manufacturer#5	almond antique medium spring khaki	6	2	2	0.4	0.25	1	2	18.5	12.5	1	6	31
+Manufacturer#5	almond antique sky peru orange	2	3	3	0.6	0.5	2	3	13.0	12.832251036613439	1	2	31
+Manufacturer#5	almond aquamarine dodger light gainsboro	46	4	4	0.8	0.75	2	4	21.25	18.102140757380052	1	46	6
+Manufacturer#5	almond azure blanched chiffon midnight	23	5	5	1.0	1.0	3	5	21.6	16.206171663906314	1	23	2
 PREHOOK: query: -- 16. testMultipleWindows
 select  p_mfgr,p_name, p_size,  
-  rank() over(distribute by p_mfgr sort by p_mfgr) as r, 
-  dense_rank() over(distribute by p_mfgr sort by p_mfgr) as dr, 
-cume_dist() over(distribute by p_mfgr sort by p_mfgr) as cud, 
-sum(p_size) over (distribute by p_mfgr sort by p_mfgr, p_name rows between unbounded preceding and current row) as s1, 
+  rank() over(distribute by p_mfgr sort by p_name) as r, 
+  dense_rank() over(distribute by p_mfgr sort by p_name) as dr, 
+cume_dist() over(distribute by p_mfgr sort by p_name) as cud, 
+sum(p_size) over (distribute by p_mfgr sort by p_name range between unbounded preceding and current row) as s1, 
 sum(p_size) over (distribute by p_mfgr sort by p_size range between 5 preceding and current row) as s2, 
 first_value(p_size) over w1  as fv1
 from part 
@@ -733,10 +733,10 @@ PREHOOK: Input: default@part
 #### A masked pattern was here ####
 POSTHOOK: query: -- 16. testMultipleWindows
 select  p_mfgr,p_name, p_size,  
-  rank() over(distribute by p_mfgr sort by p_mfgr) as r, 
-  dense_rank() over(distribute by p_mfgr sort by p_mfgr) as dr, 
-cume_dist() over(distribute by p_mfgr sort by p_mfgr) as cud, 
-sum(p_size) over (distribute by p_mfgr sort by p_mfgr, p_name rows between unbounded preceding and current row) as s1, 
+  rank() over(distribute by p_mfgr sort by p_name) as r, 
+  dense_rank() over(distribute by p_mfgr sort by p_name) as dr, 
+cume_dist() over(distribute by p_mfgr sort by p_name) as cud, 
+sum(p_size) over (distribute by p_mfgr sort by p_name range between unbounded preceding and current row) as s1, 
 sum(p_size) over (distribute by p_mfgr sort by p_size range between 5 preceding and current row) as s2, 
 first_value(p_size) over w1  as fv1
 from part 
@@ -744,36 +744,36 @@ window w1 as (distribute by p_mfgr sort by p_mfgr, p_name rows between 2 precedi
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@part
 #### A masked pattern was here ####
-Manufacturer#1	almond antique burnished rose metallic	2	1	1	1.0	4	4	2
-Manufacturer#1	almond antique burnished rose metallic	2	1	1	1.0	2	4	2
-Manufacturer#1	almond antique salmon chartreuse burlywood	6	1	1	1.0	44	10	2
-Manufacturer#1	almond aquamarine burnished black steel	28	1	1	1.0	72	28	34
-Manufacturer#1	almond antique chartreuse lavender yellow	34	1	1	1.0	38	34	2
-Manufacturer#1	almond aquamarine pink moccasin thistle	42	1	1	1.0	114	42	6
-Manufacturer#2	almond aquamarine midnight light salmon	2	1	1	1.0	56	2	14
-Manufacturer#2	almond antique violet chocolate turquoise	14	1	1	1.0	14	14	14
-Manufacturer#2	almond aquamarine sandy cyan gainsboro	18	1	1	1.0	99	32	2
-Manufacturer#2	almond aquamarine rose maroon antique	25	1	1	1.0	81	25	40
-Manufacturer#2	almond antique violet turquoise frosted	40	1	1	1.0	54	40	14
-Manufacturer#3	almond antique misty red olive	1	1	1	1.0	51	1	14
-Manufacturer#3	almond antique forest lavender goldenrod	14	1	1	1.0	31	14	17
-Manufacturer#3	almond antique chartreuse khaki white	17	1	1	1.0	17	31	17
-Manufacturer#3	almond antique metallic orange dim	19	1	1	1.0	50	50	17
-Manufacturer#3	almond antique olive coral navajo	45	1	1	1.0	96	45	19
-Manufacturer#4	almond aquamarine yellow dodger mint	7	1	1	1.0	83	7	39
-Manufacturer#4	almond antique gainsboro frosted violet	10	1	1	1.0	10	17	10
-Manufacturer#4	almond azure aquamarine papaya violet	12	1	1	1.0	95	29	27
-Manufacturer#4	almond aquamarine floral ivory bisque	27	1	1	1.0	76	27	10
-Manufacturer#4	almond antique violet mint lemon	39	1	1	1.0	49	39	10
-Manufacturer#5	almond antique sky peru orange	2	1	1	1.0	39	2	31
-Manufacturer#5	almond antique medium spring khaki	6	1	1	1.0	37	8	31
-Manufacturer#5	almond azure blanched chiffon midnight	23	1	1	1.0	108	23	2
-Manufacturer#5	almond antique blue firebrick mint	31	1	1	1.0	31	31	31
-Manufacturer#5	almond aquamarine dodger light gainsboro	46	1	1	1.0	85	46	6
+Manufacturer#1	almond antique burnished rose metallic	2	1	1	0.3333333333333333	4	4	2
+Manufacturer#1	almond antique burnished rose metallic	2	1	1	0.3333333333333333	4	4	2
+Manufacturer#1	almond antique chartreuse lavender yellow	34	3	2	0.5	38	34	2
+Manufacturer#1	almond antique salmon chartreuse burlywood	6	4	3	0.6666666666666666	44	10	2
+Manufacturer#1	almond aquamarine burnished black steel	28	5	4	0.8333333333333334	72	28	34
+Manufacturer#1	almond aquamarine pink moccasin thistle	42	6	5	1.0	114	42	6
+Manufacturer#2	almond antique violet chocolate turquoise	14	1	1	0.2	14	14	14
+Manufacturer#2	almond antique violet turquoise frosted	40	2	2	0.4	54	40	14
+Manufacturer#2	almond aquamarine midnight light salmon	2	3	3	0.6	56	2	14
+Manufacturer#2	almond aquamarine rose maroon antique	25	4	4	0.8	81	25	40
+Manufacturer#2	almond aquamarine sandy cyan gainsboro	18	5	5	1.0	99	32	2
+Manufacturer#3	almond antique chartreuse khaki white	17	1	1	0.2	17	31	17
+Manufacturer#3	almond antique forest lavender goldenrod	14	2	2	0.4	31	14	17
+Manufacturer#3	almond antique metallic orange dim	19	3	3	0.6	50	50	17
+Manufacturer#3	almond antique misty red olive	1	4	4	0.8	51	1	14
+Manufacturer#3	almond antique olive coral navajo	45	5	5	1.0	96	45	19
+Manufacturer#4	almond antique gainsboro frosted violet	10	1	1	0.2	10	17	10
+Manufacturer#4	almond antique violet mint lemon	39	2	2	0.4	49	39	10
+Manufacturer#4	almond aquamarine floral ivory bisque	27	3	3	0.6	76	27	10
+Manufacturer#4	almond aquamarine yellow dodger mint	7	4	4	0.8	83	7	39
+Manufacturer#4	almond azure aquamarine papaya violet	12	5	5	1.0	95	29	27
+Manufacturer#5	almond antique blue firebrick mint	31	1	1	0.2	31	31	31
+Manufacturer#5	almond antique medium spring khaki	6	2	2	0.4	37	8	31
+Manufacturer#5	almond antique sky peru orange	2	3	3	0.6	39	2	31
+Manufacturer#5	almond aquamarine dodger light gainsboro	46	4	4	0.8	85	46	6
+Manufacturer#5	almond azure blanched chiffon midnight	23	5	5	1.0	108	23	2
 PREHOOK: query: -- 17. testCountStar
 select  p_mfgr,p_name, p_size,
-count(*) over(distribute by p_mfgr sort by p_mfgr ) as c, 
-count(p_size) over(distribute by p_mfgr sort by p_mfgr) as ca, 
+count(*) over(distribute by p_mfgr sort by p_name ) as c, 
+count(p_size) over(distribute by p_mfgr sort by p_name) as ca, 
 first_value(p_size) over w1  as fvW1
 from part 
 window w1 as (distribute by p_mfgr sort by p_mfgr, p_name rows between 2 preceding and 2 following)
@@ -782,39 +782,39 @@ PREHOOK: Input: default@part
 #### A masked pattern was here ####
 POSTHOOK: query: -- 17. testCountStar
 select  p_mfgr,p_name, p_size,
-count(*) over(distribute by p_mfgr sort by p_mfgr ) as c, 
-count(p_size) over(distribute by p_mfgr sort by p_mfgr) as ca, 
+count(*) over(distribute by p_mfgr sort by p_name ) as c, 
+count(p_size) over(distribute by p_mfgr sort by p_name) as ca, 
 first_value(p_size) over w1  as fvW1
 from part 
 window w1 as (distribute by p_mfgr sort by p_mfgr, p_name rows between 2 preceding and 2 following)
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@part
 #### A masked pattern was here ####
-Manufacturer#1	almond antique burnished rose metallic	2	6	6	2
-Manufacturer#1	almond antique burnished rose metallic	2	6	6	2
-Manufacturer#1	almond antique chartreuse lavender yellow	34	6	6	2
-Manufacturer#1	almond antique salmon chartreuse burlywood	6	6	6	2
-Manufacturer#1	almond aquamarine burnished black steel	28	6	6	34
+Manufacturer#1	almond antique burnished rose metallic	2	2	2	2
+Manufacturer#1	almond antique burnished rose metallic	2	2	2	2
+Manufacturer#1	almond antique chartreuse lavender yellow	34	3	3	2
+Manufacturer#1	almond antique salmon chartreuse burlywood	6	4	4	2
+Manufacturer#1	almond aquamarine burnished black steel	28	5	5	34
 Manufacturer#1	almond aquamarine pink moccasin thistle	42	6	6	6
-Manufacturer#2	almond antique violet chocolate turquoise	14	5	5	14
-Manufacturer#2	almond antique violet turquoise frosted	40	5	5	14
-Manufacturer#2	almond aquamarine midnight light salmon	2	5	5	14
-Manufacturer#2	almond aquamarine rose maroon antique	25	5	5	40
+Manufacturer#2	almond antique violet chocolate turquoise	14	1	1	14
+Manufacturer#2	almond antique violet turquoise frosted	40	2	2	14
+Manufacturer#2	almond aquamarine midnight light salmon	2	3	3	14
+Manufacturer#2	almond aquamarine rose maroon antique	25	4	4	40
 Manufacturer#2	almond aquamarine sandy cyan gainsboro	18	5	5	2
-Manufacturer#3	almond antique chartreuse khaki white	17	5	5	17
-Manufacturer#3	almond antique forest lavender goldenrod	14	5	5	17
-Manufacturer#3	almond antique metallic orange dim	19	5	5	17
-Manufacturer#3	almond antique misty red olive	1	5	5	14
+Manufacturer#3	almond antique chartreuse khaki white	17	1	1	17
+Manufacturer#3	almond antique forest lavender goldenrod	14	2	2	17
+Manufacturer#3	almond antique metallic orange dim	19	3	3	17
+Manufacturer#3	almond antique misty red olive	1	4	4	14
 Manufacturer#3	almond antique olive coral navajo	45	5	5	19
-Manufacturer#4	almond antique gainsboro frosted violet	10	5	5	10
-Manufacturer#4	almond antique violet mint lemon	39	5	5	10
-Manufacturer#4	almond aquamarine floral ivory bisque	27	5	5	10
-Manufacturer#4	almond aquamarine yellow dodger mint	7	5	5	39
+Manufacturer#4	almond antique gainsboro frosted violet	10	1	1	10
+Manufacturer#4	almond antique violet mint lemon	39	2	2	10
+Manufacturer#4	almond aquamarine floral ivory bisque	27	3	3	10
+Manufacturer#4	almond aquamarine yellow dodger mint	7	4	4	39
 Manufacturer#4	almond azure aquamarine papaya violet	12	5	5	27
-Manufacturer#5	almond antique blue firebrick mint	31	5	5	31
-Manufacturer#5	almond antique medium spring khaki	6	5	5	31
-Manufacturer#5	almond antique sky peru orange	2	5	5	31
-Manufacturer#5	almond aquamarine dodger light gainsboro	46	5	5	6
+Manufacturer#5	almond antique blue firebrick mint	31	1	1	31
+Manufacturer#5	almond antique medium spring khaki	6	2	2	31
+Manufacturer#5	almond antique sky peru orange	2	3	3	31
+Manufacturer#5	almond aquamarine dodger light gainsboro	46	4	4	6
 Manufacturer#5	almond azure blanched chiffon midnight	23	5	5	2
 PREHOOK: query: -- 18. testUDAFs
 select  p_mfgr,p_name, p_size, 
@@ -969,7 +969,7 @@ PREHOOK: query: -- 21. testDISTs
 select  p_mfgr,p_name, p_size, 
 histogram_numeric(p_retailprice, 5) over w1 as hist, 
 percentile(p_partkey, 0.5) over w1 as per,
-row_number() over(distribute by p_mfgr sort by p_mfgr) as rn
+row_number() over(distribute by p_mfgr sort by p_name) as rn
 from part
 window w1 as (distribute by p_mfgr sort by p_mfgr, p_name rows between 2 preceding and 2 following)
 PREHOOK: type: QUERY
@@ -979,15 +979,15 @@ POSTHOOK: query: -- 21. testDISTs
 select  p_mfgr,p_name, p_size, 
 histogram_numeric(p_retailprice, 5) over w1 as hist, 
 percentile(p_partkey, 0.5) over w1 as per,
-row_number() over(distribute by p_mfgr sort by p_mfgr) as rn
+row_number() over(distribute by p_mfgr sort by p_name) as rn
 from part
 window w1 as (distribute by p_mfgr sort by p_mfgr, p_name rows between 2 preceding and 2 following)
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@part
 #### A masked pattern was here ####
-Manufacturer#1	almond antique burnished rose metallic	2	[{"x":1173.15,"y":2.0},{"x":1602.59,"y":1.0},{"x":1753.76,"y":1.0}]	115872.0	1
-Manufacturer#1	almond antique chartreuse lavender yellow	34	[{"x":1173.15,"y":2.0},{"x":1414.42,"y":1.0},{"x":1602.59,"y":1.0},{"x":1753.76,"y":1.0}]	110592.0	2
-Manufacturer#1	almond antique burnished rose metallic	2	[{"x":1173.15,"y":2.0},{"x":1753.76,"y":1.0}]	121152.0	3
+Manufacturer#1	almond antique burnished rose metallic	2	[{"x":1173.15,"y":2.0},{"x":1753.76,"y":1.0}]	121152.0	1
+Manufacturer#1	almond antique burnished rose metallic	2	[{"x":1173.15,"y":2.0},{"x":1602.59,"y":1.0},{"x":1753.76,"y":1.0}]	115872.0	2
+Manufacturer#1	almond antique chartreuse lavender yellow	34	[{"x":1173.15,"y":2.0},{"x":1414.42,"y":1.0},{"x":1602.59,"y":1.0},{"x":1753.76,"y":1.0}]	110592.0	3
 Manufacturer#1	almond antique salmon chartreuse burlywood	6	[{"x":1173.15,"y":1.0},{"x":1414.42,"y":1.0},{"x":1602.59,"y":1.0},{"x":1632.66,"y":1.0},{"x":1753.76,"y":1.0}]	86428.0	4
 Manufacturer#1	almond aquamarine burnished black steel	28	[{"x":1414.42,"y":1.0},{"x":1602.59,"y":1.0},{"x":1632.66,"y":1.0},{"x":1753.76,"y":1.0}]	86098.0	5
 Manufacturer#1	almond aquamarine pink moccasin thistle	42	[{"x":1414.42,"y":1.0},{"x":1602.59,"y":1.0},{"x":1632.66,"y":1.0}]	86428.0	6
@@ -996,9 +996,9 @@ Manufacturer#2	almond antique violet turquoise frosted	40	[{"x":1690.68,"y":1.0}
 Manufacturer#2	almond aquamarine midnight light salmon	2	[{"x":1690.68,"y":1.0},{"x":1698.66,"y":1.0},{"x":1701.6,"y":1.0},{"x":1800.7,"y":1.0},{"x":2031.98,"y":1.0}]	146985.0	3
 Manufacturer#2	almond aquamarine rose maroon antique	25	[{"x":1698.66,"y":1.0},{"x":1701.6,"y":1.0},{"x":1800.7,"y":1.0},{"x":2031.98,"y":1.0}]	169347.0	4
 Manufacturer#2	almond aquamarine sandy cyan gainsboro	18	[{"x":1698.66,"y":1.0},{"x":1701.6,"y":1.0},{"x":2031.98,"y":1.0}]	146985.0	5
-Manufacturer#3	almond antique metallic orange dim	19	[{"x":1190.27,"y":1.0},{"x":1337.29,"y":1.0},{"x":1410.39,"y":1.0},{"x":1671.68,"y":1.0},{"x":1922.98,"y":1.0}]	90681.0	1
-Manufacturer#3	almond antique chartreuse khaki white	17	[{"x":1190.27,"y":1.0},{"x":1410.39,"y":1.0},{"x":1671.68,"y":1.0}]	90681.0	2
-Manufacturer#3	almond antique forest lavender goldenrod	14	[{"x":1190.27,"y":1.0},{"x":1410.39,"y":1.0},{"x":1671.68,"y":1.0},{"x":1922.98,"y":1.0}]	65831.5	3
+Manufacturer#3	almond antique chartreuse khaki white	17	[{"x":1190.27,"y":1.0},{"x":1410.39,"y":1.0},{"x":1671.68,"y":1.0}]	90681.0	1
+Manufacturer#3	almond antique forest lavender goldenrod	14	[{"x":1190.27,"y":1.0},{"x":1410.39,"y":1.0},{"x":1671.68,"y":1.0},{"x":1922.98,"y":1.0}]	65831.5	2
+Manufacturer#3	almond antique metallic orange dim	19	[{"x":1190.27,"y":1.0},{"x":1337.29,"y":1.0},{"x":1410.39,"y":1.0},{"x":1671.68,"y":1.0},{"x":1922.98,"y":1.0}]	90681.0	3
 Manufacturer#3	almond antique misty red olive	1	[{"x":1190.27,"y":1.0},{"x":1337.29,"y":1.0},{"x":1410.39,"y":1.0},{"x":1922.98,"y":1.0}]	76690.0	4
 Manufacturer#3	almond antique olive coral navajo	45	[{"x":1337.29,"y":1.0},{"x":1410.39,"y":1.0},{"x":1922.98,"y":1.0}]	112398.0	5
 Manufacturer#4	almond antique gainsboro frosted violet	10	[{"x":1206.26,"y":1.0},{"x":1375.42,"y":1.0},{"x":1620.67,"y":1.0}]	48427.0	1
@@ -1014,63 +1014,71 @@ Manufacturer#5	almond azure blanched chiffon midnight	23	[{"x":1018.1,"y":1.0},{
 PREHOOK: query: -- 22. testViewAsTableInputWithWindowing
 create view IF NOT EXISTS mfgr_price_view as 
 select p_mfgr, p_brand, 
-sum(p_retailprice) as s 
+round(sum(p_retailprice),2) as s 
 from part 
 group by p_mfgr, p_brand
 PREHOOK: type: CREATEVIEW
 POSTHOOK: query: -- 22. testViewAsTableInputWithWindowing
 create view IF NOT EXISTS mfgr_price_view as 
 select p_mfgr, p_brand, 
-sum(p_retailprice) as s 
+round(sum(p_retailprice),2) as s 
 from part 
 group by p_mfgr, p_brand
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Output: default@mfgr_price_view
-PREHOOK: query: select p_mfgr, p_brand, s, 
-sum(s) over w1  as s1
+PREHOOK: query: select * 
+from (
+select p_mfgr, p_brand, s, 
+round(sum(s),2) over w1  as s1
 from mfgr_price_view 
-window w1 as (distribute by p_mfgr sort by p_mfgr rows between 2 preceding and current row)
+window w1 as (distribute by p_mfgr sort by p_mfgr )
+) sq
+order by p_mfgr, p_brand
 PREHOOK: type: QUERY
 PREHOOK: Input: default@mfgr_price_view
 PREHOOK: Input: default@part
 #### A masked pattern was here ####
-POSTHOOK: query: select p_mfgr, p_brand, s, 
-sum(s) over w1  as s1
+POSTHOOK: query: select * 
+from (
+select p_mfgr, p_brand, s, 
+round(sum(s),2) over w1  as s1
 from mfgr_price_view 
-window w1 as (distribute by p_mfgr sort by p_mfgr rows between 2 preceding and current row)
+window w1 as (distribute by p_mfgr sort by p_mfgr )
+) sq
+order by p_mfgr, p_brand
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@mfgr_price_view
 POSTHOOK: Input: default@part
 #### A masked pattern was here ####
-Manufacturer#1	Brand#14	2346.3	2346.3
-Manufacturer#1	Brand#12	4800.84	7147.14
+Manufacturer#1	Brand#12	4800.84	8749.73
+Manufacturer#1	Brand#14	2346.3	8749.73
 Manufacturer#1	Brand#15	1602.59	8749.73
-Manufacturer#2	Brand#22	3491.38	3491.38
-Manufacturer#2	Brand#23	2031.98	5523.360000000001
-Manufacturer#2	Brand#24	1698.66	7222.02
-Manufacturer#2	Brand#25	1701.6	5432.24
-Manufacturer#3	Brand#32	3333.37	3333.37
-Manufacturer#3	Brand#31	1671.68	5005.05
-Manufacturer#3	Brand#34	1337.29	6342.34
-Manufacturer#3	Brand#35	1190.27	4199.24
-Manufacturer#4	Brand#41	4755.9400000000005	4755.9400000000005
-Manufacturer#4	Brand#42	2581.6800000000003	7337.620000000001
-Manufacturer#5	Brand#51	1611.66	1611.66
-Manufacturer#5	Brand#52	3254.17	4865.83
+Manufacturer#2	Brand#22	3491.38	8923.62
+Manufacturer#2	Brand#23	2031.98	8923.62
+Manufacturer#2	Brand#24	1698.66	8923.62
+Manufacturer#2	Brand#25	1701.6	8923.62
+Manufacturer#3	Brand#31	1671.68	7532.61
+Manufacturer#3	Brand#32	3333.37	7532.61
+Manufacturer#3	Brand#34	1337.29	7532.61
+Manufacturer#3	Brand#35	1190.27	7532.61
+Manufacturer#4	Brand#41	4755.94	7337.62
+Manufacturer#4	Brand#42	2581.68	7337.62
+Manufacturer#5	Brand#51	1611.66	7672.66
+Manufacturer#5	Brand#52	3254.17	7672.66
 Manufacturer#5	Brand#53	2806.83	7672.66
 PREHOOK: query: -- 23. testCreateViewWithWindowingQuery
 create view IF NOT EXISTS mfgr_brand_price_view as 
 select p_mfgr, p_brand, 
 sum(p_retailprice) over w1  as s
 from part 
-window w1 as (distribute by p_mfgr sort by p_mfgr rows between 2 preceding and current row)
+window w1 as (distribute by p_mfgr sort by p_name rows between 2 preceding and current row)
 PREHOOK: type: CREATEVIEW
 POSTHOOK: query: -- 23. testCreateViewWithWindowingQuery
 create view IF NOT EXISTS mfgr_brand_price_view as 
 select p_mfgr, p_brand, 
 sum(p_retailprice) over w1  as s
 from part 
-window w1 as (distribute by p_mfgr sort by p_mfgr rows between 2 preceding and current row)
+window w1 as (distribute by p_mfgr sort by p_name rows between 2 preceding and current row)
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Output: default@mfgr_brand_price_view
 PREHOOK: query: select * from mfgr_brand_price_view
@@ -1084,21 +1092,21 @@ POSTHOOK: Input: default@mfgr_brand_price_view
 POSTHOOK: Input: default@part
 #### A masked pattern was here ####
 Manufacturer#1	Brand#14	1173.15
-Manufacturer#1	Brand#12	2926.91
-Manufacturer#1	Brand#14	4100.0599999999995
+Manufacturer#1	Brand#14	2346.3
+Manufacturer#1	Brand#12	4100.06
 Manufacturer#1	Brand#15	4529.5
-Manufacturer#1	Brand#12	4190.16
+Manufacturer#1	Brand#12	4770.77
 Manufacturer#1	Brand#12	4649.67
 Manufacturer#2	Brand#22	1690.68
 Manufacturer#2	Brand#22	3491.38
 Manufacturer#2	Brand#23	5523.360000000001
 Manufacturer#2	Brand#24	5531.34
 Manufacturer#2	Brand#25	5432.24
-Manufacturer#3	Brand#32	1410.39
-Manufacturer#3	Brand#31	3082.07
-Manufacturer#3	Brand#35	4272.34
-Manufacturer#3	Brand#32	4784.93
-Manufacturer#3	Brand#34	4450.54
+Manufacturer#3	Brand#31	1671.68
+Manufacturer#3	Brand#35	2861.95
+Manufacturer#3	Brand#32	4272.34
+Manufacturer#3	Brand#32	4523.639999999999
+Manufacturer#3	Brand#34	4670.66
 Manufacturer#4	Brand#41	1620.67
 Manufacturer#4	Brand#42	2996.09
 Manufacturer#4	Brand#42	4202.35
@@ -1114,7 +1122,7 @@ select p_mfgr, p_name,
 lv_col, p_size, sum(p_size) over w1   as s
 from (select p_mfgr, p_name, p_size, array(1,2,3) arr from part) p 
 lateral view explode(arr) part_lv as lv_col
-window w1 as (distribute by p_mfgr sort by p_name rows between 2 preceding and current row)
+window w1 as (distribute by p_mfgr sort by p_size, lv_col rows between 2 preceding and current row)
 PREHOOK: type: QUERY
 PREHOOK: Input: default@part
 #### A masked pattern was here ####
@@ -1123,88 +1131,88 @@ select p_mfgr, p_name,
 lv_col, p_size, sum(p_size) over w1   as s
 from (select p_mfgr, p_name, p_size, array(1,2,3) arr from part) p 
 lateral view explode(arr) part_lv as lv_col
-window w1 as (distribute by p_mfgr sort by p_name rows between 2 preceding and current row)
+window w1 as (distribute by p_mfgr sort by p_size, lv_col rows between 2 preceding and current row)
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@part
 #### A masked pattern was here ####
-Manufacturer#1	almond antique burnished rose metallic	2	2	2
+Manufacturer#1	almond antique burnished rose metallic	1	2	2
 Manufacturer#1	almond antique burnished rose metallic	1	2	4
-Manufacturer#1	almond antique burnished rose metallic	3	2	6
-Manufacturer#1	almond antique burnished rose metallic	1	2	6
+Manufacturer#1	almond antique burnished rose metallic	2	2	6
 Manufacturer#1	almond antique burnished rose metallic	2	2	6
 Manufacturer#1	almond antique burnished rose metallic	3	2	6
-Manufacturer#1	almond antique chartreuse lavender yellow	1	34	38
-Manufacturer#1	almond antique chartreuse lavender yellow	2	34	70
-Manufacturer#1	almond antique chartreuse lavender yellow	3	34	102
-Manufacturer#1	almond antique salmon chartreuse burlywood	1	6	74
-Manufacturer#1	almond antique salmon chartreuse burlywood	2	6	46
+Manufacturer#1	almond antique burnished rose metallic	3	2	6
+Manufacturer#1	almond antique salmon chartreuse burlywood	1	6	10
+Manufacturer#1	almond antique salmon chartreuse burlywood	2	6	14
 Manufacturer#1	almond antique salmon chartreuse burlywood	3	6	18
 Manufacturer#1	almond aquamarine burnished black steel	1	28	40
 Manufacturer#1	almond aquamarine burnished black steel	2	28	62
 Manufacturer#1	almond aquamarine burnished black steel	3	28	84
-Manufacturer#1	almond aquamarine pink moccasin thistle	1	42	98
-Manufacturer#1	almond aquamarine pink moccasin thistle	2	42	112
+Manufacturer#1	almond antique chartreuse lavender yellow	1	34	90
+Manufacturer#1	almond antique chartreuse lavender yellow	2	34	96
+Manufacturer#1	almond antique chartreuse lavender yellow	3	34	102
+Manufacturer#1	almond aquamarine pink moccasin thistle	1	42	110
+Manufacturer#1	almond aquamarine pink moccasin thistle	2	42	118
 Manufacturer#1	almond aquamarine pink moccasin thistle	3	42	126
-Manufacturer#2	almond antique violet chocolate turquoise	2	14	14
-Manufacturer#2	almond antique violet chocolate turquoise	1	14	28
-Manufacturer#2	almond antique violet chocolate turquoise	3	14	42
-Manufacturer#2	almond antique violet turquoise frosted	1	40	68
-Manufacturer#2	almond antique violet turquoise frosted	2	40	94
-Manufacturer#2	almond antique violet turquoise frosted	3	40	120
-Manufacturer#2	almond aquamarine midnight light salmon	1	2	82
-Manufacturer#2	almond aquamarine midnight light salmon	2	2	44
+Manufacturer#2	almond aquamarine midnight light salmon	1	2	2
+Manufacturer#2	almond aquamarine midnight light salmon	2	2	4
 Manufacturer#2	almond aquamarine midnight light salmon	3	2	6
-Manufacturer#2	almond aquamarine rose maroon antique	1	25	29
-Manufacturer#2	almond aquamarine rose maroon antique	2	25	52
-Manufacturer#2	almond aquamarine rose maroon antique	3	25	75
-Manufacturer#2	almond aquamarine sandy cyan gainsboro	1	18	68
-Manufacturer#2	almond aquamarine sandy cyan gainsboro	2	18	61
+Manufacturer#2	almond antique violet chocolate turquoise	1	14	18
+Manufacturer#2	almond antique violet chocolate turquoise	2	14	30
+Manufacturer#2	almond antique violet chocolate turquoise	3	14	42
+Manufacturer#2	almond aquamarine sandy cyan gainsboro	1	18	46
+Manufacturer#2	almond aquamarine sandy cyan gainsboro	2	18	50
 Manufacturer#2	almond aquamarine sandy cyan gainsboro	3	18	54
-Manufacturer#3	almond antique chartreuse khaki white	1	17	17
-Manufacturer#3	almond antique chartreuse khaki white	2	17	34
-Manufacturer#3	almond antique chartreuse khaki white	3	17	51
-Manufacturer#3	almond antique forest lavender goldenrod	1	14	48
-Manufacturer#3	almond antique forest lavender goldenrod	2	14	45
+Manufacturer#2	almond aquamarine rose maroon antique	1	25	61
+Manufacturer#2	almond aquamarine rose maroon antique	2	25	68
+Manufacturer#2	almond aquamarine rose maroon antique	3	25	75
+Manufacturer#2	almond antique violet turquoise frosted	1	40	90
+Manufacturer#2	almond antique violet turquoise frosted	2	40	105
+Manufacturer#2	almond antique violet turquoise frosted	3	40	120
+Manufacturer#3	almond antique misty red olive	1	1	1
+Manufacturer#3	almond antique misty red olive	2	1	2
+Manufacturer#3	almond antique misty red olive	3	1	3
+Manufacturer#3	almond antique forest lavender goldenrod	1	14	16
+Manufacturer#3	almond antique forest lavender goldenrod	2	14	29
 Manufacturer#3	almond antique forest lavender goldenrod	3	14	42
-Manufacturer#3	almond antique metallic orange dim	1	19	47
-Manufacturer#3	almond antique metallic orange dim	2	19	52
+Manufacturer#3	almond antique chartreuse khaki white	1	17	45
+Manufacturer#3	almond antique chartreuse khaki white	2	17	48
+Manufacturer#3	almond antique chartreuse khaki white	3	17	51
+Manufacturer#3	almond antique metallic orange dim	1	19	53
+Manufacturer#3	almond antique metallic orange dim	2	19	55
 Manufacturer#3	almond antique metallic orange dim	3	19	57
-Manufacturer#3	almond antique misty red olive	1	1	39
-Manufacturer#3	almond antique misty red olive	2	1	21
-Manufacturer#3	almond antique misty red olive	3	1	3
-Manufacturer#3	almond antique olive coral navajo	1	45	47
-Manufacturer#3	almond antique olive coral navajo	2	45	91
+Manufacturer#3	almond antique olive coral navajo	1	45	83
+Manufacturer#3	almond antique olive coral navajo	2	45	109
 Manufacturer#3	almond antique olive coral navajo	3	45	135
-Manufacturer#4	almond antique gainsboro frosted violet	1	10	10
-Manufacturer#4	almond antique gainsboro frosted violet	2	10	20
-Manufacturer#4	almond antique gainsboro frosted violet	3	10	30
-Manufacturer#4	almond antique violet mint lemon	1	39	59
-Manufacturer#4	almond antique violet mint lemon	2	39	88
-Manufacturer#4	almond antique violet mint lemon	3	39	117
-Manufacturer#4	almond aquamarine floral ivory bisque	1	27	105
-Manufacturer#4	almond aquamarine floral ivory bisque	2	27	93
-Manufacturer#4	almond aquamarine floral ivory bisque	3	27	81
-Manufacturer#4	almond aquamarine yellow dodger mint	1	7	61
-Manufacturer#4	almond aquamarine yellow dodger mint	2	7	41
+Manufacturer#4	almond aquamarine yellow dodger mint	1	7	7
+Manufacturer#4	almond aquamarine yellow dodger mint	2	7	14
 Manufacturer#4	almond aquamarine yellow dodger mint	3	7	21
-Manufacturer#4	almond azure aquamarine papaya violet	1	12	26
-Manufacturer#4	almond azure aquamarine papaya violet	2	12	31
+Manufacturer#4	almond antique gainsboro frosted violet	1	10	24
+Manufacturer#4	almond antique gainsboro frosted violet	2	10	27
+Manufacturer#4	almond antique gainsboro frosted violet	3	10	30
+Manufacturer#4	almond azure aquamarine papaya violet	1	12	32
+Manufacturer#4	almond azure aquamarine papaya violet	2	12	34
 Manufacturer#4	almond azure aquamarine papaya violet	3	12	36
-Manufacturer#5	almond antique blue firebrick mint	2	31	31
-Manufacturer#5	almond antique blue firebrick mint	1	31	62
-Manufacturer#5	almond antique blue firebrick mint	3	31	93
-Manufacturer#5	almond antique medium spring khaki	1	6	68
-Manufacturer#5	almond antique medium spring khaki	2	6	43
-Manufacturer#5	almond antique medium spring khaki	3	6	18
-Manufacturer#5	almond antique sky peru orange	2	2	14
-Manufacturer#5	almond antique sky peru orange	1	2	10
+Manufacturer#4	almond aquamarine floral ivory bisque	1	27	51
+Manufacturer#4	almond aquamarine floral ivory bisque	2	27	66
+Manufacturer#4	almond aquamarine floral ivory bisque	3	27	81
+Manufacturer#4	almond antique violet mint lemon	1	39	93
+Manufacturer#4	almond antique violet mint lemon	2	39	105
+Manufacturer#4	almond antique violet mint lemon	3	39	117
+Manufacturer#5	almond antique sky peru orange	1	2	2
+Manufacturer#5	almond antique sky peru orange	2	2	4
 Manufacturer#5	almond antique sky peru orange	3	2	6
-Manufacturer#5	almond aquamarine dodger light gainsboro	1	46	50
-Manufacturer#5	almond aquamarine dodger light gainsboro	2	46	94
-Manufacturer#5	almond aquamarine dodger light gainsboro	3	46	138
-Manufacturer#5	almond azure blanched chiffon midnight	1	23	115
-Manufacturer#5	almond azure blanched chiffon midnight	2	23	92
+Manufacturer#5	almond antique medium spring khaki	1	6	10
+Manufacturer#5	almond antique medium spring khaki	2	6	14
+Manufacturer#5	almond antique medium spring khaki	3	6	18
+Manufacturer#5	almond azure blanched chiffon midnight	1	23	35
+Manufacturer#5	almond azure blanched chiffon midnight	2	23	52
 Manufacturer#5	almond azure blanched chiffon midnight	3	23	69
+Manufacturer#5	almond antique blue firebrick mint	1	31	77
+Manufacturer#5	almond antique blue firebrick mint	2	31	85
+Manufacturer#5	almond antique blue firebrick mint	3	31	93
+Manufacturer#5	almond aquamarine dodger light gainsboro	1	46	108
+Manufacturer#5	almond aquamarine dodger light gainsboro	2	46	123
+Manufacturer#5	almond aquamarine dodger light gainsboro	3	46	138
 PREHOOK: query: -- 25. testMultipleInserts3SWQs
 CREATE TABLE part_1( 
 p_mfgr STRING, 
@@ -1230,8 +1238,7 @@ p_name STRING,
 p_size INT, 
 r INT, 
 dr INT, 
-cud INT, 
-s1 DOUBLE, 
+cud INT,  
 s2 DOUBLE, 
 fv1 INT)
 PREHOOK: type: CREATETABLE
@@ -1241,8 +1248,7 @@ p_name STRING,
 p_size INT, 
 r INT, 
 dr INT, 
-cud INT, 
-s1 DOUBLE, 
+cud INT,  
 s2 DOUBLE, 
 fv1 INT)
 POSTHOOK: type: CREATETABLE
@@ -1272,17 +1278,16 @@ dense_rank() over(distribute by p_mfgr sort by p_name ) as dr,
 sum(p_retailprice) over (distribute by p_mfgr sort by p_name rows between unbounded preceding and current row)  as s
 INSERT OVERWRITE TABLE part_2 
 select  p_mfgr,p_name, p_size,  
-rank() over(distribute by p_mfgr sort by p_mfgr) as r, 
-dense_rank() over(distribute by p_mfgr sort by p_mfgr) as dr, 
-cume_dist() over(distribute by p_mfgr sort by p_mfgr) as cud, 
-sum(p_size) over (distribute by p_mfgr sort by p_mfgr, p_name rows between unbounded preceding and current row) as s1, 
-sum(p_size) over (distribute by p_mfgr sort by p_size range between 5 preceding and current row) as s2, 
+rank() over(distribute by p_mfgr sort by p_name) as r, 
+dense_rank() over(distribute by p_mfgr sort by p_name) as dr, 
+cume_dist() over(distribute by p_mfgr sort by p_name) as cud, 
+round(sum(p_size),1) over (distribute by p_mfgr sort by p_size range between 5 preceding and current row) as s2, 
 first_value(p_size) over w1  as fv1
 window w1 as (distribute by p_mfgr sort by p_mfgr, p_name rows between 2 preceding and 2 following) 
 INSERT OVERWRITE TABLE part_3 
 select  p_mfgr,p_name, p_size,  
-count(*) over(distribute by p_mfgr sort by p_mfgr) as c, 
-count(p_size) over(distribute by p_mfgr sort by p_mfgr) as ca, 
+count(*) over(distribute by p_mfgr sort by p_name) as c, 
+count(p_size) over(distribute by p_mfgr sort by p_name) as ca, 
 first_value(p_size) over w1  as fv
 window w1 as (distribute by p_mfgr sort by p_mfgr, p_name rows between 2 preceding and 2 following)
 PREHOOK: type: QUERY
@@ -1298,17 +1303,16 @@ dense_rank() over(distribute by p_mfgr sort by p_name ) as dr,
 sum(p_retailprice) over (distribute by p_mfgr sort by p_name rows between unbounded preceding and current row)  as s
 INSERT OVERWRITE TABLE part_2 
 select  p_mfgr,p_name, p_size,  
-rank() over(distribute by p_mfgr sort by p_mfgr) as r, 
-dense_rank() over(distribute by p_mfgr sort by p_mfgr) as dr, 
-cume_dist() over(distribute by p_mfgr sort by p_mfgr) as cud, 
-sum(p_size) over (distribute by p_mfgr sort by p_mfgr, p_name rows between unbounded preceding and current row) as s1, 
-sum(p_size) over (distribute by p_mfgr sort by p_size range between 5 preceding and current row) as s2, 
+rank() over(distribute by p_mfgr sort by p_name) as r, 
+dense_rank() over(distribute by p_mfgr sort by p_name) as dr, 
+cume_dist() over(distribute by p_mfgr sort by p_name) as cud, 
+round(sum(p_size),1) over (distribute by p_mfgr sort by p_size range between 5 preceding and current row) as s2, 
 first_value(p_size) over w1  as fv1
 window w1 as (distribute by p_mfgr sort by p_mfgr, p_name rows between 2 preceding and 2 following) 
 INSERT OVERWRITE TABLE part_3 
 select  p_mfgr,p_name, p_size,  
-count(*) over(distribute by p_mfgr sort by p_mfgr) as c, 
-count(p_size) over(distribute by p_mfgr sort by p_mfgr) as ca, 
+count(*) over(distribute by p_mfgr sort by p_name) as c, 
+count(p_size) over(distribute by p_mfgr sort by p_name) as ca, 
 first_value(p_size) over w1  as fv
 window w1 as (distribute by p_mfgr sort by p_mfgr, p_name rows between 2 preceding and 2 following)
 POSTHOOK: type: QUERY
@@ -1329,7 +1333,6 @@ POSTHOOK: Lineage: part_2.p_mfgr SCRIPT [(part)part.FieldSchema(name:p_partkey,
 POSTHOOK: Lineage: part_2.p_name SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.p_size SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.r SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
-POSTHOOK: Lineage: part_2.s1 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.s2 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.c SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.ca SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
@@ -1358,7 +1361,6 @@ POSTHOOK: Lineage: part_2.p_mfgr SCRIPT [(part)part.FieldSchema(name:p_partkey,
 POSTHOOK: Lineage: part_2.p_name SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.p_size SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.r SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
-POSTHOOK: Lineage: part_2.s1 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.s2 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.c SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.ca SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
@@ -1413,7 +1415,6 @@ POSTHOOK: Lineage: part_2.p_mfgr SCRIPT [(part)part.FieldSchema(name:p_partkey,
 POSTHOOK: Lineage: part_2.p_name SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.p_size SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.r SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
-POSTHOOK: Lineage: part_2.s1 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.s2 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.c SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.ca SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
@@ -1421,32 +1422,32 @@ POSTHOOK: Lineage: part_3.fv SCRIPT [(part)part.FieldSchema(name:p_partkey, type
 POSTHOOK: Lineage: part_3.p_mfgr SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.p_name SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.p_size SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
-Manufacturer#1	almond antique burnished rose metallic	2	1	1	1	4.0	4.0	2
-Manufacturer#1	almond antique burnished rose metallic	2	1	1	1	2.0	4.0	2
-Manufacturer#1	almond antique salmon chartreuse burlywood	6	1	1	1	44.0	10.0	2
-Manufacturer#1	almond aquamarine burnished black steel	28	1	1	1	72.0	28.0	34
-Manufacturer#1	almond antique chartreuse lavender yellow	34	1	1	1	38.0	34.0	2
-Manufacturer#1	almond aquamarine pink moccasin thistle	42	1	1	1	114.0	42.0	6
-Manufacturer#2	almond aquamarine midnight light salmon	2	1	1	1	56.0	2.0	14
-Manufacturer#2	almond antique violet chocolate turquoise	14	1	1	1	14.0	14.0	14
-Manufacturer#2	almond aquamarine sandy cyan gainsboro	18	1	1	1	99.0	32.0	2
-Manufacturer#2	almond aquamarine rose maroon antique	25	1	1	1	81.0	25.0	40
-Manufacturer#2	almond antique violet turquoise frosted	40	1	1	1	54.0	40.0	14
-Manufacturer#3	almond antique misty red olive	1	1	1	1	51.0	1.0	14
-Manufacturer#3	almond antique forest lavender goldenrod	14	1	1	1	31.0	14.0	17
-Manufacturer#3	almond antique chartreuse khaki white	17	1	1	1	17.0	31.0	17
-Manufacturer#3	almond antique metallic orange dim	19	1	1	1	50.0	50.0	17
-Manufacturer#3	almond antique olive coral navajo	45	1	1	1	96.0	45.0	19
-Manufacturer#4	almond aquamarine yellow dodger mint	7	1	1	1	83.0	7.0	39
-Manufacturer#4	almond antique gainsboro frosted violet	10	1	1	1	10.0	17.0	10
-Manufacturer#4	almond azure aquamarine papaya violet	12	1	1	1	95.0	29.0	27
-Manufacturer#4	almond aquamarine floral ivory bisque	27	1	1	1	76.0	27.0	10
-Manufacturer#4	almond antique violet mint lemon	39	1	1	1	49.0	39.0	10
-Manufacturer#5	almond antique sky peru orange	2	1	1	1	39.0	2.0	31
-Manufacturer#5	almond antique medium spring khaki	6	1	1	1	37.0	8.0	31
-Manufacturer#5	almond azure blanched chiffon midnight	23	1	1	1	108.0	23.0	2
-Manufacturer#5	almond antique blue firebrick mint	31	1	1	1	31.0	31.0	31
-Manufacturer#5	almond aquamarine dodger light gainsboro	46	1	1	1	85.0	46.0	6
+Manufacturer#1	almond antique burnished rose metallic	2	1	1	0	4.0	2
+Manufacturer#1	almond antique burnished rose metallic	2	1	1	0	4.0	2
+Manufacturer#1	almond antique chartreuse lavender yellow	34	3	2	0	34.0	2
+Manufacturer#1	almond antique salmon chartreuse burlywood	6	4	3	0	10.0	2
+Manufacturer#1	almond aquamarine burnished black steel	28	5	4	0	28.0	34
+Manufacturer#1	almond aquamarine pink moccasin thistle	42	6	5	1	42.0	6
+Manufacturer#2	almond antique violet chocolate turquoise	14	1	1	0	14.0	14
+Manufacturer#2	almond antique violet turquoise frosted	40	2	2	0	40.0	14
+Manufacturer#2	almond aquamarine midnight light salmon	2	3	3	0	2.0	14
+Manufacturer#2	almond aquamarine rose maroon antique	25	4	4	0	25.0	40
+Manufacturer#2	almond aquamarine sandy cyan gainsboro	18	5	5	1	32.0	2
+Manufacturer#3	almond antique chartreuse khaki white	17	1	1	0	31.0	17
+Manufacturer#3	almond antique forest lavender goldenrod	14	2	2	0	14.0	17
+Manufacturer#3	almond antique metallic orange dim	19	3	3	0	50.0	17
+Manufacturer#3	almond antique misty red olive	1	4	4	0	1.0	14
+Manufacturer#3	almond antique olive coral navajo	45	5	5	1	45.0	19
+Manufacturer#4	almond antique gainsboro frosted violet	10	1	1	0	17.0	10
+Manufacturer#4	almond antique violet mint lemon	39	2	2	0	39.0	10
+Manufacturer#4	almond aquamarine floral ivory bisque	27	3	3	0	27.0	10
+Manufacturer#4	almond aquamarine yellow dodger mint	7	4	4	0	7.0	39
+Manufacturer#4	almond azure aquamarine papaya violet	12	5	5	1	29.0	27
+Manufacturer#5	almond antique blue firebrick mint	31	1	1	0	31.0	31
+Manufacturer#5	almond antique medium spring khaki	6	2	2	0	8.0	31
+Manufacturer#5	almond antique sky peru orange	2	3	3	0	2.0	31
+Manufacturer#5	almond aquamarine dodger light gainsboro	46	4	4	0	46.0	6
+Manufacturer#5	almond azure blanched chiffon midnight	23	5	5	1	23.0	2
 PREHOOK: query: select * from part_3
 PREHOOK: type: QUERY
 PREHOOK: Input: default@part_3
@@ -1468,7 +1469,6 @@ POSTHOOK: Lineage: part_2.p_mfgr SCRIPT [(part)part.FieldSchema(name:p_partkey,
 POSTHOOK: Lineage: part_2.p_name SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.p_size SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.r SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
-POSTHOOK: Lineage: part_2.s1 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.s2 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.c SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.ca SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
@@ -1476,31 +1476,31 @@ POSTHOOK: Lineage: part_3.fv SCRIPT [(part)part.FieldSchema(name:p_partkey, type
 POSTHOOK: Lineage: part_3.p_mfgr SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.p_name SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.p_size SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
-Manufacturer#1	almond antique burnished rose metallic	2	6	6	2
-Manufacturer#1	almond antique burnished rose metallic	2	6	6	2
-Manufacturer#1	almond antique chartreuse lavender yellow	34	6	6	2
-Manufacturer#1	almond antique salmon chartreuse burlywood	6	6	6	2
-Manufacturer#1	almond aquamarine burnished black steel	28	6	6	34
+Manufacturer#1	almond antique burnished rose metallic	2	2	2	2
+Manufacturer#1	almond antique burnished rose metallic	2	2	2	2
+Manufacturer#1	almond antique chartreuse lavender yellow	34	3	3	2
+Manufacturer#1	almond antique salmon chartreuse burlywood	6	4	4	2
+Manufacturer#1	almond aquamarine burnished black steel	28	5	5	34
 Manufacturer#1	almond aquamarine pink moccasin thistle	42	6	6	6
-Manufacturer#2	almond antique violet chocolate turquoise	14	5	5	14
-Manufacturer#2	almond antique violet turquoise frosted	40	5	5	14
-Manufacturer#2	almond aquamarine midnight light salmon	2	5	5	14
-Manufacturer#2	almond aquamarine rose maroon antique	25	5	5	40
+Manufacturer#2	almond antique violet chocolate turquoise	14	1	1	14
+Manufacturer#2	almond antique violet turquoise frosted	40	2	2	14
+Manufacturer#2	almond aquamarine midnight light salmon	2	3	3	14
+Manufacturer#2	almond aquamarine rose maroon antique	25	4	4	40
 Manufacturer#2	almond aquamarine sandy cyan gainsboro	18	5	5	2
-Manufacturer#3	almond antique chartreuse khaki white	17	5	5	17
-Manufacturer#3	almond antique forest lavender goldenrod	14	5	5	17
-Manufacturer#3	almond antique metallic orange dim	19	5	5	17
-Manufacturer#3	almond antique misty red olive	1	5	5	14
+Manufacturer#3	almond antique chartreuse khaki white	17	1	1	17
+Manufacturer#3	almond antique forest lavender goldenrod	14	2	2	17
+Manufacturer#3	almond antique metallic orange dim	19	3	3	17
+Manufacturer#3	almond antique misty red olive	1	4	4	14
 Manufacturer#3	almond antique olive coral navajo	45	5	5	19
-Manufacturer#4	almond antique gainsboro frosted violet	10	5	5	10
-Manufacturer#4	almond antique violet mint lemon	39	5	5	10
-Manufacturer#4	almond aquamarine floral ivory bisque	27	5	5	10
-Manufacturer#4	almond aquamarine yellow dodger mint	7	5	5	39
+Manufacturer#4	almond antique gainsboro frosted violet	10	1	1	10
+Manufacturer#4	almond antique violet mint lemon	39	2	2	10
+Manufacturer#4	almond aquamarine floral ivory bisque	27	3	3	10
+Manufacturer#4	almond aquamarine yellow dodger mint	7	4	4	39
 Manufacturer#4	almond azure aquamarine papaya violet	12	5	5	27
-Manufacturer#5	almond antique blue firebrick mint	31	5	5	31
-Manufacturer#5	almond antique medium spring khaki	6	5	5	31
-Manufacturer#5	almond antique sky peru orange	2	5	5	31
-Manufacturer#5	almond aquamarine dodger light gainsboro	46	5	5	6
+Manufacturer#5	almond antique blue firebrick mint	31	1	1	31
+Manufacturer#5	almond antique medium spring khaki	6	2	2	31
+Manufacturer#5	almond antique sky peru orange	2	3	3	31
+Manufacturer#5	almond aquamarine dodger light gainsboro	46	4	4	6
 Manufacturer#5	almond azure blanched chiffon midnight	23	5	5	2
 PREHOOK: query: -- 26. testGroupByHavingWithSWQAndAlias
 select p_mfgr, p_name, p_size, min(p_retailprice) as mi,
@@ -1537,7 +1537,6 @@ POSTHOOK: Lineage: part_2.p_mfgr SCRIPT [(part)part.FieldSchema(name:p_partkey,
 POSTHOOK: Lineage: part_2.p_name SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.p_size SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.r SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
-POSTHOOK: Lineage: part_2.s1 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.s2 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.c SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.ca SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
@@ -1601,7 +1600,6 @@ POSTHOOK: Lineage: part_2.p_mfgr SCRIPT [(part)part.FieldSchema(name:p_partkey,
 POSTHOOK: Lineage: part_2.p_name SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.p_size SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.r SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
-POSTHOOK: Lineage: part_2.s1 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.s2 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.c SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.ca SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
@@ -1662,7 +1660,6 @@ POSTHOOK: Lineage: part_2.p_mfgr SCRIPT [(part)part.FieldSchema(name:p_partkey,
 POSTHOOK: Lineage: part_2.p_name SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.p_size SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.r SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
-POSTHOOK: Lineage: part_2.s1 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.s2 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.c SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.ca SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
@@ -1725,7 +1722,6 @@ POSTHOOK: Lineage: part_2.p_mfgr SCRIPT [(part)part.FieldSchema(name:p_partkey,
 POSTHOOK: Lineage: part_2.p_name SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.p_size SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.r SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
-POSTHOOK: Lineage: part_2.s1 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.s2 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.c SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.ca SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
@@ -1792,7 +1788,6 @@ POSTHOOK: Lineage: part_2.p_mfgr SCRIPT [(part)part.FieldSchema(name:p_partkey,
 POSTHOOK: Lineage: part_2.p_name SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.p_size SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.r SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
-POSTHOOK: Lineage: part_2.s1 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.s2 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.c SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.ca SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
@@ -1831,7 +1826,7 @@ select p_mfgr, p_name, p_size,
 sum(p_size) over w1 as s1, 
 sum(p_size) over w2 as s2
 from part 
-window w1 as (partition by p_mfgr order by p_mfgr rows between 2 preceding and 2 following), 
+window w1 as (partition by p_mfgr order by p_name range between 2 preceding and 2 following), 
        w2 as w1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@part
@@ -1841,7 +1836,7 @@ select p_mfgr, p_name, p_size,
 sum(p_size) over w1 as s1, 
 sum(p_size) over w2 as s2
 from part 
-window w1 as (partition by p_mfgr order by p_mfgr rows between 2 preceding and 2 following), 
+window w1 as (partition by p_mfgr order by p_name range between 2 preceding and 2 following), 
        w2 as w1
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@part
@@ -1859,7 +1854,6 @@ POSTHOOK: Lineage: part_2.p_mfgr SCRIPT [(part)part.FieldSchema(name:p_partkey,
 POSTHOOK: Lineage: part_2.p_name SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.p_size SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.r SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
-POSTHOOK: Lineage: part_2.s1 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.s2 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.c SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.ca SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
@@ -1867,38 +1861,38 @@ POSTHOOK: Lineage: part_3.fv SCRIPT [(part)part.FieldSchema(name:p_partkey, type
 POSTHOOK: Lineage: part_3.p_mfgr SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.p_name SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.p_size SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
-Manufacturer#1	almond antique burnished rose metallic	2	38	38
-Manufacturer#1	almond antique chartreuse lavender yellow	34	44	44
-Manufacturer#1	almond antique burnished rose metallic	2	72	72
-Manufacturer#1	almond antique salmon chartreuse burlywood	6	112	112
-Manufacturer#1	almond aquamarine burnished black steel	28	78	78
-Manufacturer#1	almond aquamarine pink moccasin thistle	42	76	76
-Manufacturer#2	almond antique violet chocolate turquoise	14	56	56
-Manufacturer#2	almond antique violet turquoise frosted	40	81	81
-Manufacturer#2	almond aquamarine midnight light salmon	2	99	99
-Manufacturer#2	almond aquamarine rose maroon antique	25	85	85
-Manufacturer#2	almond aquamarine sandy cyan gainsboro	18	45	45
-Manufacturer#3	almond antique metallic orange dim	19	50	50
-Manufacturer#3	almond antique chartreuse khaki white	17	51	51
-Manufacturer#3	almond antique forest lavender goldenrod	14	96	96
-Manufacturer#3	almond antique misty red olive	1	77	77
-Manufacturer#3	almond antique olive coral navajo	45	60	60
-Manufacturer#4	almond antique gainsboro frosted violet	10	76	76
-Manufacturer#4	almond antique violet mint lemon	39	83	83
-Manufacturer#4	almond aquamarine floral ivory bisque	27	95	95
-Manufacturer#4	almond aquamarine yellow dodger mint	7	85	85
-Manufacturer#4	almond azure aquamarine papaya violet	12	46	46
-Manufacturer#5	almond antique blue firebrick mint	31	39	39
-Manufacturer#5	almond antique medium spring khaki	6	85	85
-Manufacturer#5	almond antique sky peru orange	2	108	108
-Manufacturer#5	almond aquamarine dodger light gainsboro	46	77	77
-Manufacturer#5	almond azure blanched chiffon midnight	23	71	71
+Manufacturer#1	almond antique burnished rose metallic	2	4	4
+Manufacturer#1	almond antique burnished rose metallic	2	4	4
+Manufacturer#1	almond antique chartreuse lavender yellow	34	34	34
+Manufacturer#1	almond antique salmon chartreuse burlywood	6	6	6
+Manufacturer#1	almond aquamarine burnished black steel	28	28	28
+Manufacturer#1	almond aquamarine pink moccasin thistle	42	42	42
+Manufacturer#2	almond antique violet chocolate turquoise	14	14	14
+Manufacturer#2	almond antique violet turquoise frosted	40	40	40
+Manufacturer#2	almond aquamarine midnight light salmon	2	2	2
+Manufacturer#2	almond aquamarine rose maroon antique	25	25	25
+Manufacturer#2	almond aquamarine sandy cyan gainsboro	18	18	18
+Manufacturer#3	almond antique chartreuse khaki white	17	17	17
+Manufacturer#3	almond antique forest lavender goldenrod	14	14	14
+Manufacturer#3	almond antique metallic orange dim	19	19	19
+Manufacturer#3	almond antique misty red olive	1	1	1
+Manufacturer#3	almond antique olive coral navajo	45	45	45
+Manufacturer#4	almond antique gainsboro frosted violet	10	10	10
+Manufacturer#4	almond antique violet mint lemon	39	39	39
+Manufacturer#4	almond aquamarine floral ivory bisque	27	27	27
+Manufacturer#4	almond aquamarine yellow dodger mint	7	7	7
+Manufacturer#4	almond azure aquamarine papaya violet	12	12	12
+Manufacturer#5	almond antique blue firebrick mint	31	31	31
+Manufacturer#5	almond antique medium spring khaki	6	6	6
+Manufacturer#5	almond antique sky peru orange	2	2	2
+Manufacturer#5	almond aquamarine dodger light gainsboro	46	46	46
+Manufacturer#5	almond azure blanched chiffon midnight	23	23	23
 PREHOOK: query: -- 32. testWindowInheritance
 select p_mfgr, p_name, p_size, 
 sum(p_size) over w1 as s1, 
 sum(p_size) over w2 as s2 
 from part 
-window w1 as (partition by p_mfgr order by p_mfgr rows between 2 preceding and 2 following), 
+window w1 as (partition by p_mfgr order by p_name range between 2 preceding and 2 following), 
        w2 as (w1 rows between unbounded preceding and current row)
 PREHOOK: type: QUERY
 PREHOOK: Input: default@part
@@ -1908,7 +1902,7 @@ select p_mfgr, p_name, p_size,
 sum(p_size) over w1 as s1, 
 sum(p_size) over w2 as s2 
 from part 
-window w1 as (partition by p_mfgr order by p_mfgr rows between 2 preceding and 2 following), 
+window w1 as (partition by p_mfgr order by p_name range between 2 preceding and 2 following), 
        w2 as (w1 rows between unbounded preceding and current row)
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@part
@@ -1926,7 +1920,6 @@ POSTHOOK: Lineage: part_2.p_mfgr SCRIPT [(part)part.FieldSchema(name:p_partkey,
 POSTHOOK: Lineage: part_2.p_name SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.p_size SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.r SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
-POSTHOOK: Lineage: part_2.s1 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.s2 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.c SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.ca SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
@@ -1934,41 +1927,41 @@ POSTHOOK: Lineage: part_3.fv SCRIPT [(part)part.FieldSchema(name:p_partkey, type
 POSTHOOK: Lineage: part_3.p_mfgr SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.p_name SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.p_size SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
-Manufacturer#1	almond antique burnished rose metallic	2	38	2
-Manufacturer#1	almond antique chartreuse lavender yellow	34	44	36
-Manufacturer#1	almond antique burnished rose metallic	2	72	38
-Manufacturer#1	almond antique salmon chartreuse burlywood	6	112	44
-Manufacturer#1	almond aquamarine burnished black steel	28	78	72
-Manufacturer#1	almond aquamarine pink moccasin thistle	42	76	114
-Manufacturer#2	almond antique violet chocolate turquoise	14	56	14
-Manufacturer#2	almond antique violet turquoise frosted	40	81	54
-Manufacturer#2	almond aquamarine midnight light salmon	2	99	56
-Manufacturer#2	almond aquamarine rose maroon antique	25	85	81
-Manufacturer#2	almond aquamarine sandy cyan gainsboro	18	45	99
-Manufacturer#3	almond antique metallic orange dim	19	50	19
-Manufacturer#3	almond antique chartreuse khaki white	17	51	36
-Manufacturer#3	almond antique forest lavender goldenrod	14	96	50
-Manufacturer#3	almond antique misty red olive	1	77	51
-Manufacturer#3	almond antique olive coral navajo	45	60	96
-Manufacturer#4	almond antique gainsboro frosted violet	10	76	10
-Manufacturer#4	almond antique violet mint lemon	39	83	49
-Manufacturer#4	almond aquamarine floral ivory bisque	27	95	76
-Manufacturer#4	almond aquamarine yellow dodger mint	7	85	83
-Manufacturer#4	almond azure aquamarine papaya violet	12	46	95
-Manufacturer#5	almond antique blue firebrick mint	31	39	31
-Manufacturer#5	almond antique medium spring khaki	6	85	37
-Manufacturer#5	almond antique sky peru orange	2	108	39
-Manufacturer#5	almond aquamarine dodger light gainsboro	46	77	85
-Manufacturer#5	almond azure blanched chiffon midnight	23	71	108
+Manufacturer#1	almond antique burnished rose metallic	2	4	2
+Manufacturer#1	almond antique burnished rose metallic	2	4	4
+Manufacturer#1	almond antique chartreuse lavender yellow	34	34	38
+Manufacturer#1	almond antique salmon chartreuse burlywood	6	6	44
+Manufacturer#1	almond aquamarine burnished black steel	28	28	72
+Manufacturer#1	almond aquamarine pink moccasin thistle	42	42	114
+Manufacturer#2	almond antique violet chocolate turquoise	14	14	14
+Manufacturer#2	almond antique violet turquoise frosted	40	40	54
+Manufacturer#2	almond aquamarine midnight light salmon	2	2	56
+Manufacturer#2	almond aquamarine rose maroon antique	25	25	81
+Manufacturer#2	almond aquamarine sandy cyan gainsboro	18	18	99
+Manufacturer#3	almond antique chartreuse khaki white	17	17	17
+Manufacturer#3	almond antique forest lavender goldenrod	14	14	31
+Manufacturer#3	almond antique metallic orange dim	19	19	50
+Manufacturer#3	almond antique misty red olive	1	1	51
+Manufacturer#3	almond antique olive coral navajo	45	45	96
+Manufacturer#4	almond antique gainsboro frosted violet	10	10	10
+Manufacturer#4	almond antique violet mint lemon	39	39	49
+Manufacturer#4	almond aquamarine floral ivory bisque	27	27	76
+Manufacturer#4	almond aquamarine yellow dodger mint	7	7	83
+Manufacturer#4	almond azure aquamarine papaya violet	12	12	95
+Manufacturer#5	almond antique blue firebrick mint	31	31	31
+Manufacturer#5	almond antique medium spring khaki	6	6	37
+Manufacturer#5	almond antique sky peru orange	2	2	39
+Manufacturer#5	almond aquamarine dodger light gainsboro	46	46	85
+Manufacturer#5	almond azure blanched chiffon midnight	23	23	108
 PREHOOK: query: -- 33. testWindowForwardReference
 select p_mfgr, p_name, p_size, 
 sum(p_size) over w1 as s1, 
 sum(p_size) over w2 as s2,
 sum(p_size) over w3 as s3
 from part 
-window w1 as (distribute by p_mfgr sort by p_mfgr rows between 2 preceding and 2 following), 
+window w1 as (distribute by p_mfgr sort by p_name range between 2 preceding and 2 following), 
        w2 as w3,
-       w3 as (distribute by p_mfgr sort by p_mfgr rows between unbounded preceding and current row)
+       w3 as (distribute by p_mfgr sort by p_name range between unbounded preceding and current row)
 PREHOOK: type: QUERY
 PREHOOK: Input: default@part
 #### A masked pattern was here ####
@@ -1978,9 +1971,9 @@ sum(p_size) over w1 as s1,
 sum(p_size) over w2 as s2,
 sum(p_size) over w3 as s3
 from part 
-window w1 as (distribute by p_mfgr sort by p_mfgr rows between 2 preceding and 2 following), 
+window w1 as (distribute by p_mfgr sort by p_name range between 2 preceding and 2 following), 
        w2 as w3,
-       w3 as (distribute by p_mfgr sort by p_mfgr rows between unbounded preceding and current row)
+       w3 as (distribute by p_mfgr sort by p_name range between unbounded preceding and current row)
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@part
 #### A masked pattern was here ####
@@ -1997,7 +1990,6 @@ POSTHOOK: Lineage: part_2.p_mfgr SCRIPT [(part)part.FieldSchema(name:p_partkey,
 POSTHOOK: Lineage: part_2.p_name SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.p_size SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.r SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
-POSTHOOK: Lineage: part_2.s1 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.s2 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.c SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.ca SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
@@ -2005,41 +1997,41 @@ POSTHOOK: Lineage: part_3.fv SCRIPT [(part)part.FieldSchema(name:p_partkey, type
 POSTHOOK: Lineage: part_3.p_mfgr SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.p_name SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.p_size SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
-Manufacturer#1	almond antique burnished rose metallic	2	38	2	2
-Manufacturer#1	almond antique chartreuse lavender yellow	34	44	36	36
-Manufacturer#1	almond antique burnished rose metallic	2	72	38	38
-Manufacturer#1	almond antique salmon chartreuse burlywood	6	112	44	44
-Manufacturer#1	almond aquamarine burnished black steel	28	78	72	72
-Manufacturer#1	almond aquamarine pink moccasin thistle	42	76	114	114
-Manufacturer#2	almond antique violet chocolate turquoise	14	56	14	14
-Manufacturer#2	almond antique violet turquoise frosted	40	81	54	54
-Manufacturer#2	almond aquamarine midnight light salmon	2	99	56	56
-Manufacturer#2	almond aquamarine rose maroon antique	25	85	81	81
-Manufacturer#2	almond aquamarine sandy cyan gainsboro	18	45	99	99
-Manufacturer#3	almond antique metallic orange dim	19	50	19	19
-Manufacturer#3	almond antique chartreuse khaki white	17	51	36	36
-Manufacturer#3	almond antique forest lavender goldenrod	14	96	50	50
-Manufacturer#3	almond antique misty red olive	1	77	51	51
-Manufacturer#3	almond antique olive coral navajo	45	60	96	96
-Manufacturer#4	almond antique gainsboro frosted violet	10	76	10	10
-Manufacturer#4	almond antique violet mint lemon	39	83	49	49
-Manufacturer#4	almond aquamarine floral ivory bisque	27	95	76	76
-Manufacturer#4	almond aquamarine yellow dodger mint	7	85	83	83
-Manufacturer#4	almond azure aquamarine papaya violet	12	46	95	95
-Manufacturer#5	almond antique blue firebrick mint	31	39	31	31
-Manufacturer#5	almond antique medium spring khaki	6	85	37	37
-Manufacturer#5	almond antique sky peru orange	2	108	39	39
-Manufacturer#5	almond aquamarine dodger light gainsboro	46	77	85	85
-Manufacturer#5	almond azure blanched chiffon midnight	23	71	108	108
+Manufacturer#1	almond antique burnished rose metallic	2	4	4	4
+Manufacturer#1	almond antique burnished rose metallic	2	4	4	4
+Manufacturer#1	almond antique chartreuse lavender yellow	34	34	38	38
+Manufacturer#1	almond antique salmon chartreuse burlywood	6	6	44	44
+Manufacturer#1	almond aquamarine burnished black steel	28	28	72	72
+Manufacturer#1	almond aquamarine pink moccasin thistle	42	42	114	114
+Manufacturer#2	almond antique violet chocolate turquoise	14	14	14	14
+Manufacturer#2	almond antique violet turquoise frosted	40	40	54	54
+Manufacturer#2	almond aquamarine midnight light salmon	2	2	56	56
+Manufacturer#2	almond aquamarine rose maroon antique	25	25	81	81
+Manufacturer#2	almond aquamarine sandy cyan gainsboro	18	18	99	99
+Manufacturer#3	almond antique chartreuse khaki white	17	17	17	17
+Manufacturer#3	almond antique forest lavender goldenrod	14	14	31	31
+Manufacturer#3	almond antique metallic orange dim	19	19	50	50
+Manufacturer#3	almond antique misty red olive	1	1	51	51
+Manufacturer#3	almond antique olive coral navajo	45	45	96	96
+Manufacturer#4	almond antique gainsboro frosted violet	10	10	10	10
+Manufacturer#4	almond antique violet mint lemon	39	39	49	49
+Manufacturer#4	almond aquamarine floral ivory bisque	27	27	76	76
+Manufacturer#4	almond aquamarine yellow dodger mint	7	7	83	83
+Manufacturer#4	almond azure aquamarine papaya violet	12	12	95	95
+Manufacturer#5	almond antique blue firebrick mint	31	31	31	31
+Manufacturer#5	almond antique medium spring khaki	6	6	37	37
+Manufacturer#5	almond antique sky peru orange	2	2	39	39
+Manufacturer#5	almond aquamarine dodger light gainsboro	46	46	85	85
+Manufacturer#5	almond azure blanched chiffon midnight	23	23	108	108
 PREHOOK: query: -- 34. testWindowDefinitionPropagation
 select p_mfgr, p_name, p_size, 
 sum(p_size) over w1 as s1, 
 sum(p_size) over w2 as s2,
 sum(p_size) over (w3 rows between 2 preceding and 2 following)  as s3
 from part 
-window w1 as (distribute by p_mfgr sort by p_mfgr rows between 2 preceding and 2 following), 
+window w1 as (distribute by p_mfgr sort by p_name range between 2 preceding and 2 following), 
        w2 as w3,
-       w3 as (distribute by p_mfgr sort by p_mfgr rows between unbounded preceding and current row)
+       w3 as (distribute by p_mfgr sort by p_name range between unbounded preceding and current row)
 PREHOOK: type: QUERY
 PREHOOK: Input: default@part
 #### A masked pattern was here ####
@@ -2049,9 +2041,9 @@ sum(p_size) over w1 as s1,
 sum(p_size) over w2 as s2,
 sum(p_size) over (w3 rows between 2 preceding and 2 following)  as s3
 from part 
-window w1 as (distribute by p_mfgr sort by p_mfgr rows between 2 preceding and 2 following), 
+window w1 as (distribute by p_mfgr sort by p_name range between 2 preceding and 2 following), 
        w2 as w3,
-       w3 as (distribute by p_mfgr sort by p_mfgr rows between unbounded preceding and current row)
+       w3 as (distribute by p_mfgr sort by p_name range between unbounded preceding and current row)
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@part
 #### A masked pattern was here ####
@@ -2068,7 +2060,6 @@ POSTHOOK: Lineage: part_2.p_mfgr SCRIPT [(part)part.FieldSchema(name:p_partkey,
 POSTHOOK: Lineage: part_2.p_name SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.p_size SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.r SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
-POSTHOOK: Lineage: part_2.s1 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.s2 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.c SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.ca SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
@@ -2076,32 +2067,32 @@ POSTHOOK: Lineage: part_3.fv SCRIPT [(part)part.FieldSchema(name:p_partkey, type
 POSTHOOK: Lineage: part_3.p_mfgr SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.p_name SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.p_size SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
-Manufacturer#1	almond antique burnished rose metallic	2	38	2	38
-Manufacturer#1	almond antique chartreuse lavender yellow	34	44	36	44
-Manufacturer#1	almond antique burnished rose metallic	2	72	38	72
-Manufacturer#1	almond antique salmon chartreuse burlywood	6	112	44	112
-Manufacturer#1	almond aquamarine burnished black steel	28	78	72	78
-Manufacturer#1	almond aquamarine pink moccasin thistle	42	76	114	76
-Manufacturer#2	almond antique violet chocolate turquoise	14	56	14	56
-Manufacturer#2	almond antique violet turquoise frosted	40	81	54	81
-Manufacturer#2	almond aquamarine midnight light salmon	2	99	56	99
-Manufacturer#2	almond aquamarine rose maroon antique	25	85	81	85
-Manufacturer#2	almond aquamarine sandy cyan gainsboro	18	45	99	45
-Manufacturer#3	almond antique metallic orange dim	19	50	19	50
-Manufacturer#3	almond antique chartreuse khaki white	17	51	36	51
-Manufacturer#3	almond antique forest lavender goldenrod	14	96	50	96
-Manufacturer#3	almond antique misty red olive	1	77	51	77
-Manufacturer#3	almond antique olive coral navajo	45	60	96	60
-Manufacturer#4	almond antique gainsboro frosted violet	10	76	10	76
-Manufacturer#4	almond antique violet mint lemon	39	83	49	83
-Manufacturer#4	almond aquamarine floral ivory bisque	27	95	76	95
-Manufacturer#4	almond aquamarine yellow dodger mint	7	85	83	85
-Manufacturer#4	almond azure aquamarine papaya violet	12	46	95	46
-Manufacturer#5	almond antique blue firebrick mint	31	39	31	39
-Manufacturer#5	almond antique medium spring khaki	6	85	37	85
-Manufacturer#5	almond antique sky peru orange	2	108	39	108
-Manufacturer#5	almond aquamarine dodger light gainsboro	46	77	85	77
-Manufacturer#5	almond azure blanched chiffon midnight	23	71	108	71
+Manufacturer#1	almond antique burnished rose metallic	2	4	4	38
+Manufacturer#1	almond antique burnished rose metallic	2	4	4	44
+Manufacturer#1	almond antique chartreuse lavender yellow	34	34	38	72
+Manufacturer#1	almond antique salmon chartreuse burlywood	6	6	44	112
+Manufacturer#1	almond aquamarine burnished black steel	28	28	72	110
+Manufacturer#1	almond aquamarine pink moccasin thistle	42	42	114	76
+Manufacturer#2	almond antique violet chocolate turquoise	14	14	14	56
+Manufacturer#2	almond antique violet turquoise frosted	40	40	54	81
+Manufacturer#2	almond aquamarine midnight light salmon	2	2	56	99
+Manufacturer#2	almond aquamarine rose maroon antique	25	25	81	85
+Manufacturer#2	almond aquamarine sandy cyan gainsboro	18	18	99	45
+Manufacturer#3	almond antique chartreuse khaki white	17	17	17	50
+Manufacturer#3	almond antique forest lavender goldenrod	14	14	31	51
+Manufacturer#3	almond antique metallic orange dim	19	19	50	96
+Manufacturer#3	almond antique misty red olive	1	1	51	79
+Manufacturer#3	almond antique olive coral navajo	45	45	96	65
+Manufacturer#4	almond antique gainsboro frosted violet	10	10	10	76
+Manufacturer#4	almond antique violet mint lemon	39	39	49	83
+Manufacturer#4	almond aquamarine floral ivory bisque	27	27	76	95
+Manufacturer#4	almond aquamarine yellow dodger mint	7	7	83	85
+Manufacturer#4	almond azure aquamarine papaya violet	12	12	95	46
+Manufacturer#5	almond antique blue firebrick mint	31	31	31	39
+Manufacturer#5	almond antique medium spring khaki	6	6	37	85
+Manufacturer#5	almond antique sky peru orange	2	2	39	108
+Manufacturer#5	almond aquamarine dodger light gainsboro	46	46	85	77
+Manufacturer#5	almond azure blanched chiffon midnight	23	23	108	71
 PREHOOK: query: -- 35. testDistinctWithWindowing
 select DISTINCT p_mfgr, p_name, p_size,
 sum(p_size) over w1 as s
@@ -2131,7 +2122,6 @@ POSTHOOK: Lineage: part_2.p_mfgr SCRIPT [(part)part.FieldSchema(name:p_partkey,
 POSTHOOK: Lineage: part_2.p_name SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.p_size SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.r SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
-POSTHOOK: Lineage: part_2.s1 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.s2 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.c SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.ca SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
@@ -2191,7 +2181,6 @@ POSTHOOK: Lineage: part_2.p_mfgr SCRIPT [(part)part.FieldSchema(name:p_partkey,
 POSTHOOK: Lineage: part_2.p_name SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.p_size SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.r SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
-POSTHOOK: Lineage: part_2.s1 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.s2 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.c SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.ca SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
@@ -2226,22 +2215,22 @@ Manufacturer#5	almond antique sky peru orange	2	3
 Manufacturer#5	almond aquamarine dodger light gainsboro	46	4
 Manufacturer#5	almond azure blanched chiffon midnight	23	5
 PREHOOK: query: -- 37. testPartitioningVariousForms
-select p_mfgr, p_name, p_size,
-sum(p_retailprice) over (partition by p_mfgr order by p_mfgr) as s1,
+select p_mfgr,
+round(sum(p_retailprice),2) over (partition by p_mfgr order by p_mfgr) as s1,
 min(p_retailprice) over (partition by p_mfgr) as s2,
 max(p_retailprice) over (distribute by p_mfgr sort by p_mfgr) as s3,
-avg(p_retailprice) over (distribute by p_mfgr) as s4,
+round(avg(p_retailprice),2) over (distribute by p_mfgr) as s4,
 count(p_retailprice) over (cluster by p_mfgr ) as s5
 from part
 PREHOOK: type: QUERY
 PREHOOK: Input: default@part
 #### A masked pattern was here ####
 POSTHOOK: query: -- 37. testPartitioningVariousForms
-select p_mfgr, p_name, p_size,
-sum(p_retailprice) over (partition by p_mfgr order by p_mfgr) as s1,
+select p_mfgr,
+round(sum(p_retailprice),2) over (partition by p_mfgr order by p_mfgr) as s1,
 min(p_retailprice) over (partition by p_mfgr) as s2,
 max(p_retailprice) over (distribute by p_mfgr sort by p_mfgr) as s3,
-avg(p_retailprice) over (distribute by p_mfgr) as s4,
+round(avg(p_retailprice),2) over (distribute by p_mfgr) as s4,
 count(p_retailprice) over (cluster by p_mfgr ) as s5
 from part
 POSTHOOK: type: QUERY
@@ -2260,7 +2249,6 @@ POSTHOOK: Lineage: part_2.p_mfgr SCRIPT [(part)part.FieldSchema(name:p_partkey,
 POSTHOOK: Lineage: part_2.p_name SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.p_size SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.r SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
-POSTHOOK: Lineage: part_2.s1 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.s2 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.c SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.ca SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
@@ -2268,32 +2256,32 @@ POSTHOOK: Lineage: part_3.fv SCRIPT [(part)part.FieldSchema(name:p_partkey, type
 POSTHOOK: Lineage: part_3.p_mfgr SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.p_name SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.p_size SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
-Manufacturer#1	almond antique burnished rose metallic	2	8749.73	1173.15	1753.76	1458.2883333333332	6
-Manufacturer#1	almond antique chartreuse lavender yellow	34	8749.73	1173.15	1753.76	1458.2883333333332	6
-Manufacturer#1	almond antique burnished rose metallic	2	8749.73	1173.15	1753.76	1458.2883333333332	6
-Manufacturer#1	almond antique salmon chartreuse burlywood	6	8749.73	1173.15	1753.76	1458.2883333333332	6
-Manufacturer#1	almond aquamarine burnished black steel	28	8749.73	1173.15	1753.76	1458.2883333333332	6
-Manufacturer#1	almond aquamarine pink moccasin thistle	42	8749.73	1173.15	1753.76	1458.2883333333332	6
-Manufacturer#2	almond antique violet chocolate turquoise	14	8923.62	1690.68	2031.98	1784.7240000000002	5
-Manufacturer#2	almond antique violet turquoise frosted	40	8923.62	1690.68	2031.98	1784.7240000000002	5
-Manufacturer#2	almond aquamarine midnight light salmon	2	8923.62	1690.68	2031.98	1784.7240000000002	5
-Manufacturer#2	almond aquamarine rose maroon antique	25	8923.62	1690.68	2031.98	1784.7240000000002	5
-Manufacturer#2	almond aquamarine sandy cyan gainsboro	18	8923.62	1690.68	2031.98	1784.7240000000002	5
-Manufacturer#3	almond antique metallic orange dim	19	7532.61	1190.27	1922.98	1506.522	5
-Manufacturer#3	almond antique chartreuse khaki white	17	7532.61	1190.27	1922.98	1506.522	5
-Manufacturer#3	almond antique forest lavender goldenrod	14	7532.61	1190.27	1922.98	1506.522	5
-Manufacturer#3	almond antique misty red olive	1	7532.61	1190.27	1922.98	1506.522	5
-Manufacturer#3	almond antique olive coral navajo	45	7532.61	1190.27	1922.98	1506.522	5
-Manufacturer#4	almond antique gainsboro frosted violet	10	7337.620000000001	1206.26	1844.92	1467.5240000000001	5
-Manufacturer#4	almond antique violet mint lemon	39	7337.620000000001	1206.26	1844.92	1467.5240000000001	5
-Manufacturer#4	almond aquamarine floral ivory bisque	27	7337.620000000001	1206.26	1844.92	1467.5240000000001	5
-Manufacturer#4	almond aquamarine yellow dodger mint	7	7337.620000000001	1206.26	1844.92	1467.5240000000001	5
-Manufacturer#4	almond azure aquamarine papaya violet	12	7337.620000000001	1206.26	1844.92	1467.5240000000001	5
-Manufacturer#5	almond antique blue firebrick mint	31	7672.66	1018.1	1789.69	1534.532	5
-Manufacturer#5	almond antique medium spring khaki	6	7672.66	1018.1	1789.69	1534.532	5
-Manufacturer#5	almond antique sky peru orange	2	7672.66	1018.1	1789.69	1534.532	5
-Manufacturer#5	almond aquamarine dodger light gainsboro	46	7672.66	1018.1	1789.69	1534.532	5
-Manufacturer#5	almond azure blanched chiffon midnight	23	7672.66	1018.1	1789.69	1534.532	5
+Manufacturer#1	8749.73	1173.15	1753.76	1458.29	6
+Manufacturer#1	8749.73	1173.15	1753.76	1458.29	6
+Manufacturer#1	8749.73	1173.15	1753.76	1458.29	6
+Manufacturer#1	8749.73	1173.15	1753.76	1458.29	6
+Manufacturer#1	8749.73	1173.15	1753.76	1458.29	6
+Manufacturer#1	8749.73	1173.15	1753.76	1458.29	6
+Manufacturer#2	8923.62	1690.68	2031.98	1784.72	5
+Manufacturer#2	8923.62	1690.68	2031.98	1784.72	5
+Manufacturer#2	8923.62	1690.68	2031.98	1784.72	5
+Manufacturer#2	8923.62	1690.68	2031.98	1784.72	5
+Manufacturer#2	8923.62	1690.68	2031.98	1784.72	5
+Manufacturer#3	7532.61	1190.27	1922.98	1506.52	5
+Manufacturer#3	7532.61	1190.27	1922.98	1506.52	5
+Manufacturer#3	7532.61	1190.27	1922.98	1506.52	5
+Manufacturer#3	7532.61	1190.27	1922.98	1506.52	5
+Manufacturer#3	7532.61	1190.27	1922.98	1506.52	5
+Manufacturer#4	7337.62	1206.26	1844.92	1467.52	5
+Manufacturer#4	7337.62	1206.26	1844.92	1467.52	5
+Manufacturer#4	7337.62	1206.26	1844.92	1467.52	5
+Manufacturer#4	7337.62	1206.26	1844.92	1467.52	5
+Manufacturer#4	7337.62	1206.26	1844.92	1467.52	5
+Manufacturer#5	7672.66	1018.1	1789.69	1534.53	5
+Manufacturer#5	7672.66	1018.1	1789.69	1534.53	5
+Manufacturer#5	7672.66	1018.1	1789.69	1534.53	5
+Manufacturer#5	7672.66	1018.1	1789.69	1534.53	5
+Manufacturer#5	7672.66	1018.1	1789.69	1534.53	5
 PREHOOK: query: -- 38. testPartitioningVariousForms2
 select p_mfgr, p_name, p_size,
 sum(p_retailprice) over (partition by p_mfgr, p_name order by p_mfgr, p_name rows between unbounded preceding and current row) as s1,
@@ -2325,7 +2313,6 @@ POSTHOOK: Lineage: part_2.p_mfgr SCRIPT [(part)part.FieldSchema(name:p_partkey,
 POSTHOOK: Lineage: part_2.p_name SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.p_size SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.r SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
-POSTHOOK: Lineage: part_2.s1 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.s2 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.c SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.ca SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
@@ -2386,7 +2373,6 @@ POSTHOOK: Lineage: part_2.p_mfgr SCRIPT [(part)part.FieldSchema(name:p_partkey,
 POSTHOOK: Lineage: part_2.p_name SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.p_size SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.r SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
-POSTHOOK: Lineage: part_2.s1 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.s2 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.c SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.ca SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
@@ -2447,7 +2433,6 @@ POSTHOOK: Lineage: part_2.p_mfgr SCRIPT [(part)part.FieldSchema(name:p_partkey,
 POSTHOOK: Lineage: part_2.p_name SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.p_size SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.r SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
-POSTHOOK: Lineage: part_2.s1 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.s2 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.c SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.ca SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
@@ -2508,7 +2493,6 @@ POSTHOOK: Lineage: part_2.p_mfgr SCRIPT [(part)part.FieldSchema(name:p_partkey,
 POSTHOOK: Lineage: part_2.p_name SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.p_size SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.r SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
-POSTHOOK: Lineage: part_2.s1 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.s2 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.c SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.ca SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
@@ -2569,7 +2553,6 @@ POSTHOOK: Lineage: part_2.p_mfgr SCRIPT [(part)part.FieldSchema(name:p_partkey,
 POSTHOOK: Lineage: part_2.p_name SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.p_size SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.r SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
-POSTHOOK: Lineage: part_2.s1 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.s2 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.c SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.ca SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
@@ -2630,7 +2613,6 @@ POSTHOOK: Lineage: part_2.p_mfgr SCRIPT [(part)part.FieldSchema(name:p_partkey,
 POSTHOOK: Lineage: part_2.p_name SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.p_size SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.r SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
-POSTHOOK: Lineage: part_2.s1 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.s2 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.c SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.ca SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
@@ -2666,7 +2648,7 @@ Manufacturer#5	almond antique blue firebrick mint	31	2807.79
 Manufacturer#5	almond aquamarine dodger light gainsboro	46	1018.1
 PREHOOK: query: -- 44. testOverNoPartitionSingleAggregate
 select p_name, p_retailprice,
-avg(p_retailprice) over()
+round(avg(p_retailprice),2) over()
 from part
 order by p_name
 PREHOOK: type: QUERY
@@ -2674,7 +2656,7 @@ PREHOOK: Input: default@part
 #### A masked pattern was here ####
 POSTHOOK: query: -- 44. testOverNoPartitionSingleAggregate
 select p_name, p_retailprice,
-avg(p_retailprice) over()
+round(avg(p_retailprice),2) over()
 from part
 order by p_name
 POSTHOOK: type: QUERY
@@ -2693,7 +2675,6 @@ POSTHOOK: Lineage: part_2.p_mfgr SCRIPT [(part)part.FieldSchema(name:p_partkey,
 POSTHOOK: Lineage: part_2.p_name SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.p_size SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.r SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
-POSTHOOK: Lineage: part_2.s1 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_2.s2 SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.c SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.ca SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
@@ -2701,29 +2682,29 @@ POSTHOOK: Lineage: part_3.fv SCRIPT [(part)part.FieldSchema(name:p_partkey, type
 POSTHOOK: Lineage: part_3.p_mfgr SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.p_name SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: part_3.p_size SCRIPT [(part)part.FieldSchema(name:p_partkey, type:int, comment:null), (part)part.FieldSchema(name:p_name, type:string, comment:null), (part)part.FieldSchema(name:p_mfgr, type:string, comment:null), (part)part.FieldSchema(name:p_brand, type:string, comment:null), (part)part.FieldSchema(name:p_type, type:string, comment:null), (part)part.FieldSchema(name:p_size, type:int, comment:null), (part)part.FieldSchema(name:p_container, type:string, comment:null), (part)part.FieldSchema(name:p_retailprice, type:double, comment:null), (part)part.FieldSchema(name:p_comment, type:string, comment:null), (part)part.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (part)part.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
-almond antique blue firebrick mint	1789.69	1546.7784615384621
-almond antique burnished rose metallic	1173.15	1546.7784615384621
-almond antique burnished rose metallic	1173.15	1546.7784615384621
-almond antique chartreuse khaki white	1671.68	1546.7784615384621
-almond antique chartreuse lavender yellow	1753.76	1546.7784615384621
-almond antique forest lavender goldenrod	1190.27	1546.7784615384621
-almond antique gainsboro frosted violet	1620.67	1546.7784615384621
-almond antique medium spring khaki	1611.66	1546.7784615384621
-almond antique metallic orange dim	1410.39	1546.7784615384621
-almond antique misty red olive	1922.98	1546.7784615384621
-almond antique olive coral navajo	1337.29	1546.7784615384621
-almond antique salmon chartreuse burlywood	1602.59	1546.7784615384621
-almond antique sky peru orange	1788.73	1546.7784615384621
-almond antique violet chocolate turquoise	1690.68	1546.7784615384621
-almond antique violet mint lemon	1375.42	1546.7784615384621
-almond antique violet turquoise frosted	1800.7	1546.7784615384621
-almond aquamarine burnished black steel	1414.42	1546.7784615384621
-almond aquamarine dodger light gainsboro	1018.1	1546.7784615384621
-almond aquamarine floral ivory bisque	1206.26	1546.7784615384621
-almond aquamarine midnight light salmon	2031.98	1546.7784615384621
-almond aquamarine pink moccasin thistle	1632.66	1546.7784615384621
-almond aquamarine rose maroon antique	1698.66	1546.7784615384621
-almond aquamarine sandy cyan gainsboro	1701.6	1546.7784615384621
-almond aquamarine yellow dodger mint	1844.92	1546.7784615384621
-almond azure aquamarine papaya violet	1290.35	1546.7784615384621
-almond azure blanched chiffon midnight	1464.48	1546.7784615384621
+almond antique blue firebrick mint	1789.69	1546.78
+almond antique burnished rose metallic	1173.15	1546.78
+almond antique burnished rose metallic	1173.15	1546.78
+almond antique chartreuse khaki white	1671.68	1546.78
+almond antique chartreuse lavender yellow	1753.76	1546.78
+almond antique forest lavender goldenrod	1190.27	1546.78
+almond antique gainsboro frosted violet	1620.67	1546.78
+almond antique medium spring khaki	1611.66	1546.78
+almond antique metallic orange dim	1410.39	1546.78
+almond antique misty red olive	1922.98	1546.78
+almond antique olive coral navajo	1337.29	1546.78
+almond antique salmon chartreuse burlywood	1602.59	1546.78
+almond antique sky peru orange	1788.73	1546.78
+almond antique violet chocolate turquoise	1690.68	1546.78
+almond antique violet mint lemon	1375.42	1546.78
+almond antique violet turquoise frosted	1800.7	1546.78
+almond aquamarine burnished black steel	1414.42	1546.78
+almond aquamarine dodger light gainsboro	1018.1	1546.78
+almond aquamarine floral ivory bisque	1206.26	1546.78
+almond aquamarine midnight light salmon	2031.98	1546.78
+almond aquamarine pink moccasin thistle	1632.66	1546.78
+almond aquamarine rose maroon antique	1698.66	1546.78
+almond aquamarine sandy cyan gainsboro	1701.6	1546.78
+almond aquamarine yellow dodger mint	1844.92	1546.78
+almond azure aquamarine papaya violet	1290.35	1546.78
+almond azure blanched chiffon midnight	1464.48	1546.78
diff --git a/ql/src/test/results/clientpositive/windowing_expressions.q.out b/ql/src/test/results/clientpositive/windowing_expressions.q.out
index 2018461869..3dbf225371 100644
--- a/ql/src/test/results/clientpositive/windowing_expressions.q.out
+++ b/ql/src/test/results/clientpositive/windowing_expressions.q.out
@@ -162,119 +162,119 @@ Manufacturer#5	1464.48	23	2	2482.58	2477.58
 Manufacturer#5	1611.66	6	3	4094.24	4089.24
 Manufacturer#5	1788.73	2	4	5882.969999999999	5877.969999999999
 Manufacturer#5	1789.69	31	5	7672.66	7667.66
-PREHOOK: query: select s, si, f, si - lead(f, 3) over (partition by t order by bo desc) from over10k limit 100
+PREHOOK: query: select s, si, f, si - lead(f, 3) over (partition by t order by bo,s,si,f desc) from over10k limit 100
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over10k
 #### A masked pattern was here ####
-POSTHOOK: query: select s, si, f, si - lead(f, 3) over (partition by t order by bo desc) from over10k limit 100
+POSTHOOK: query: select s, si, f, si - lead(f, 3) over (partition by t order by bo,s,si,f desc) from over10k limit 100
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over10k
 #### A masked pattern was here ####
-david hernandez	408	81.68	352.41
-mike allen	465	83.39	441.78
-sarah miller	386	58.81	297.22
-luke king	337	55.59	256.35
-nick robinson	350	23.22	349.17
-katie ichabod	469	88.78	400.27
-gabriella brown	498	80.65	415.26
-oscar davidson	432	0.83	350.05
-holly nixon	505	68.73	502.74
-holly polk	268	82.74	202.5
-rachel davidson	507	81.95	498.63
-mike polk	500	2.26	443.8
-yuri xylophone	430	65.5	357.74
-bob ellison	339	8.37	254.25
-luke ichabod	289	56.2	203.04001
-nick nixon	335	72.26	282.7
-holly thompson	387	84.75	331.59
-jessica miller	299	85.96	298.44
-calvin white	280	52.3	232.49
-oscar johnson	469	55.41	406.88
-rachel thompson	344	0.56	279.71
-david falkner	469	47.51	374.78
-mike white	454	62.12	431.65
-irene young	458	64.29	396.19
-oscar johnson	315	94.22	300.77
-bob johnson	374	22.35	345.22
-victor robinson	415	61.81	333.03
-ethan underhill	339	14.23	257.36
-xavier ovid	280	28.78	198.61
-mike xylophone	448	81.97	429.56
-tom hernandez	467	81.64	428.95
-tom steinbeck	414	81.39	316.12
-alice falkner	280	18.44	182.48999
-david carson	270	38.05	217.87
-sarah zipper	376	97.88	368.9
-tom hernandez	477	97.51	438.78
-victor thompson	344	52.13	332.93
-ulysses carson	343	7.1	282.72
-sarah xylophone	275	38.22	268.2
-oscar miller	324	11.07	251.7
-quinn polk	507	60.28	463.6
-luke young	451	6.8	422.25
-bob underhill	465	72.3	452.88
-victor allen	337	43.4	330.17
-xavier garcia	493	28.75	396.22
-zach thompson	386	12.12	293.29
-bob van buren	433	6.83	423.14
-fred ellison	376	96.78	304.03
-jessica king	459	92.71	399.93
+alice allen	400	76.31	337.23
+alice davidson	384	71.97	357.79
+alice king	455	2.48	395.93
+alice king	458	62.77	384.16998
+alice xylophone	485	26.21	464.05
+bob falkner	260	59.07	242.4
+bob ichabod	454	73.83	381.7
+bob polk	264	20.95	257.17
+bob underhill	454	17.6	424.94
+bob underhill	465	72.3	453.17
+bob van buren	433	6.83	398.4
+calvin ichabod	431	29.06	334.22
+david garcia	485	11.83	421.51
+ethan steinbeck	298	34.6	288.14
+fred ellison	376	96.78	330.76
+holly steinbeck	384	63.49	293.7
 holly underhill	318	9.86	269.91
-alice davidson	384	71.97	340.31
-bob falkner	260	59.07	237.66
-jessica johnson	494	48.09	468.5
-victor hernandez	447	43.69	427.06
-ulysses steinbeck	333	22.34	273.66
-wendy quirinius	279	25.5	257.0
-quinn ellison	266	19.94	181.61
-ulysses ellison	381	59.34	377.18
-priscilla laertes	316	22.0	244.22
-sarah robinson	320	84.39	298.66
-luke garcia	311	3.82	290.05
-wendy robinson	275	71.78	231.27
-priscilla zipper	485	21.34	422.19
-bob polk	264	20.95	187.69
-oscar garcia	362	43.73	351.74
-jessica white	284	62.81	238.76
-alice allen	400	76.31	370.94
-ulysses quirinius	303	10.26	268.4
-irene ellison	458	45.24	394.51
-calvin ichabod	431	29.06	356.08002
-ethan steinbeck	298	34.6	234.81
-holly steinbeck	384	63.49	365.73
-mike king	275	74.92	261.33
-priscilla quirinius	423	63.19	360.61
-zach young	286	18.27	223.23
-wendy xylophone	314	13.67	223.7
-victor xylophone	438	62.39	420.4
-alice king	458	62.77	455.52
-irene underhill	307	90.3	295.17
-bob underhill	454	17.6	427.79
-alice king	455	2.48	381.16998
-david garcia	485	11.83	428.95
-alice xylophone	485	26.21	459.33
-bob ichabod	454	73.83	NULL
-tom polk	346	56.05	NULL
-ulysses robinson	313	25.67	NULL
-nick laertes	502	48.26	462.38
-oscar zipper	445	35.62	420.6
-nick falkner	384	1.65	378.41
-irene ichabod	409	39.62	321.22
-wendy ichabod	387	24.4	310.48
-ethan quirinius	503	5.59	431.97
-alice carson	473	87.78	455.91
-quinn laertes	340	76.52	295.12
-tom xylophone	352	71.03	295.24
-tom ellison	420	17.09	346.94
-fred ichabod	371	44.88	298.41
-luke xylophone	395	56.76	319.22
-quinn hernandez	456	73.06	439.65
-ethan falkner	261	72.59	212.26
-PREHOOK: query: select s, i, i - lead(i, 3, 0) over (partition by si order by i) from over10k limit 100
+irene ellison	458	45.24	365.29
+irene underhill	307	90.3	244.19
+jessica johnson	494	48.09	490.18
+jessica king	459	92.71	452.2
+jessica white	284	62.81	209.08
+luke garcia	311	3.82	267.27
+luke young	451	6.8	429.0
+mike king	275	74.92	211.81
+oscar garcia	362	43.73	340.66
+priscilla laertes	316	22.0	296.06
+priscilla quirinius	423	63.19	362.72
+priscilla zipper	485	21.34	400.61
+quinn ellison	266	19.94	209.95
+quinn polk	507	60.28	447.66
+sarah robinson	320	84.39	309.74
+tom polk	346	56.05	320.33
+ulysses ellison	381	59.34	358.66
+ulysses quirinius	303	10.26	259.6
+ulysses robinson	313	25.67	269.31
+ulysses steinbeck	333	22.34	270.61
+victor allen	337	43.4	311.5
+victor hernandez	447	43.69	375.22
+victor xylophone	438	62.39	424.33
+wendy quirinius	279	25.5	250.25
+wendy robinson	275	71.78	262.88
+wendy xylophone	314	13.67	295.73
+xavier garcia	493	28.75	474.56
+zach thompson	386	12.12	377.63
+zach young	286	18.27	263.65
+alice falkner	280	18.44	227.7
+bob ellison	339	8.37	300.95
+bob johnson	374	22.35	326.49
+calvin white	280	52.3	198.32
+david carson	270	38.05	255.77
+david falkner	469	47.51	388.35
+david hernandez	408	81.68	339.27
+ethan underhill	339	14.23	256.26
+gabriella brown	498	80.65	413.25
+holly nixon	505	68.73	440.71
+holly polk	268	82.74	182.04001
+holly thompson	387	84.75	298.22
+irene young	458	64.29	401.8
+jessica miller	299	85.96	243.41
+katie ichabod	469	88.78	385.61
+luke ichabod	289	56.2	286.74
+luke king	337	55.59	274.88
+mike allen	465	83.39	383.03
+mike polk	500	2.26	427.74
+mike white	454	62.12	430.78
+mike xylophone	448	81.97	447.17
+nick nixon	335	72.26	240.78
+nick robinson	350	23.22	294.59
+oscar davidson	432	0.83	420.93
+oscar johnson	315	94.22	233.05
+oscar johnson	469	55.41	468.44
+oscar miller	324	11.07	265.19
+rachel davidson	507	81.95	468.78
+rachel thompson	344	0.56	246.12
+sarah miller	386	58.81	304.36
+sarah xylophone	275	38.22	177.48999
+sarah zipper	376	97.88	294.61
+tom hernandez	467	81.64	459.9
+tom hernandez	477	97.51	415.19
+tom steinbeck	414	81.39	361.87
+ulysses carson	343	7.1	314.22
+victor robinson	415	61.81	349.5
+victor thompson	344	52.13	NULL
+xavier ovid	280	28.78	NULL
+yuri xylophone	430	65.5	NULL
+alice underhill	389	26.68	368.06
+alice underhill	446	6.49	444.21
+bob ovid	331	67.12	236.43
+bob van buren	406	20.94	383.32
+david falkner	406	1.79	374.34
+david miller	450	94.57	380.13
+ethan allen	380	22.68	375.6
+ethan king	395	31.66	361.51
+ethan nixon	475	69.87	431.39
+ethan polk	283	4.4	243.82
+fred allen	331	33.49	281.68
+fred king	511	43.61	457.22
+fred polk	261	39.18	248.73
+fred young	303	49.32	221.51001
+PREHOOK: query: select s, i, i - lead(i, 3, 0) over (partition by si order by i,s) from over10k limit 100
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over10k
 #### A masked pattern was here ####
-POSTHOOK: query: select s, i, i - lead(i, 3, 0) over (partition by si order by i) from over10k limit 100
+POSTHOOK: query: select s, i, i - lead(i, 3, 0) over (partition by si order by i,s) from over10k limit 100
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over10k
 #### A masked pattern was here ####
@@ -288,8 +288,8 @@ ethan falkner	65586	-18
 victor davidson	65596	-17
 xavier quirinius	65599	-14
 fred quirinius	65604	-11
-xavier van buren	65613	-3
-nick zipper	65613	-7
+nick zipper	65613	-3
+xavier van buren	65613	-7
 victor johnson	65615	-12
 alice ovid	65616	-24
 xavier ovid	65620	-23
@@ -307,8 +307,8 @@ zach white	65733	-8
 fred hernandez	65737	-7
 rachel ellison	65738	-6
 oscar steinbeck	65741	-6
-tom allen	65744	-8
-alice ellison	65744	-19
+alice ellison	65744	-8
+tom allen	65744	-19
 quinn quirinius	65747	-31
 victor hernandez	65752	-26
 holly xylophone	65763	-26
@@ -328,14 +328,14 @@ victor xylophone	65578	-16
 gabriella ellison	65584	-26
 nick quirinius	65588	-22
 holly robinson	65594	-18
-yuri brown	65610	-16
-alice xylophone	65610	-21
+alice xylophone	65610	-16
+yuri brown	65610	-21
 sarah hernandez	65612	-26
 katie garcia	65626	-28
 jessica laertes	65631	-23
 ethan underhill	65638	-17
-priscilla thompson	65654	-37
-irene young	65654	-40
+irene young	65654	-37
+priscilla thompson	65654	-40
 luke quirinius	65655	-44
 david brown	65691	-20
 luke falkner	65694	-18
@@ -351,16 +351,16 @@ ulysses young	65748	-23
 nick davidson	65752	-19
 fred zipper	65756	-15
 yuri nixon	65771	-10
-zach zipper	65771	-19
-zach hernandez	65771	65771
+zach hernandez	65771	-19
+zach zipper	65771	65771
 alice underhill	65781	65781
 oscar laertes	65790	65790
 sarah zipper	65546	-19
-luke ovid	65551	-17
 bob falkner	65551	-17
+luke ovid	65551	-17
 katie allen	65565	-4
-zach steinbeck	65568	-5
-nick falkner	65568	-11
+nick falkner	65568	-5
+zach steinbeck	65568	-11
 oscar van buren	65569	-13
 gabriella young	65573	-11
 jessica ichabod	65579	-24
@@ -373,16 +373,16 @@ jessica laertes	65617	-62
 fred king	65656	-61
 priscilla underhill	65669	-48
 priscilla zipper	65679	-45
-sarah polk	65717	-11
-nick king	65717	-17
+nick king	65717	-11
+sarah polk	65717	-17
 irene quirinius	65724	-28
 tom laertes	65728	-25
 yuri johnson	65734	-27
-PREHOOK: query: select s, si, d, si - lag(d, 3) over (partition by b order by si) from over10k limit 100
+PREHOOK: query: select s, si, d, si - lag(d, 3) over (partition by b order by si,s,d) from over10k limit 100
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over10k
 #### A masked pattern was here ####
-POSTHOOK: query: select s, si, d, si - lag(d, 3) over (partition by b order by si) from over10k limit 100
+POSTHOOK: query: select s, si, d, si - lag(d, 3) over (partition by b order by si,s,d) from over10k limit 100
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over10k
 #### A masked pattern was here ####
@@ -420,18 +420,18 @@ ethan ellison	453	47.92	405.78
 irene nixon	454	48.03	421.40999999999997
 bob steinbeck	462	47.04	442.37
 luke robinson	462	47.48	414.08
-tom hernandez	467	29.36	418.97
-gabriella steinbeck	467	9.35	419.96
+gabriella steinbeck	467	9.35	418.97
+tom hernandez	467	29.36	419.96
 irene polk	485	14.26	437.52
-mike xylophone	494	36.92	464.64
-calvin allen	499	39.99	489.65
+mike xylophone	494	36.92	484.65
+calvin allen	499	39.99	469.64
 quinn steinbeck	503	16.62	488.74
-ulysses garcia	263	31.85	NULL
 calvin thompson	263	30.87	NULL
 rachel quirinius	263	29.46	NULL
-mike steinbeck	266	48.57	234.15
-rachel young	275	14.75	244.13
-tom king	278	31.11	248.54
+ulysses garcia	263	31.85	NULL
+mike steinbeck	266	48.57	235.13
+rachel young	275	14.75	245.54
+tom king	278	31.11	246.15
 oscar robinson	283	30.35	234.43
 zach allen	284	1.88	269.25
 bob king	308	27.61	276.89
@@ -455,11 +455,11 @@ sarah xylophone	507	16.09	499.97
 rachel thompson	267	46.87	NULL
 gabriella van buren	271	41.04	NULL
 mike steinbeck	284	11.44	NULL
-luke falkner	293	40.67	246.13
-ethan ovid	293	2.08	251.96
+ethan ovid	293	2.08	246.13
+luke falkner	293	40.67	251.96
 irene nixon	321	24.35	309.56
-mike van buren	327	2.58	286.33
-ulysses robinson	329	26.64	326.92
+mike van buren	327	2.58	324.92
+ulysses robinson	329	26.64	288.33
 quinn laertes	332	10.71	307.65
 tom polk	346	34.03	343.42
 jessica johnson	352	45.71	325.36
@@ -674,12 +674,12 @@ PREHOOK: type: CREATETABLE
 POSTHOOK: query: create table t2 (a1 int, b1 string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: default@t2
-PREHOOK: query: from (select sum(i) over (), s from over10k) tt insert overwrite table t1 select * insert overwrite table t2 select *
+PREHOOK: query: from (select sum(i) over (partition by ts order by i), s from over10k) tt insert overwrite table t1 select * insert overwrite table t2 select *
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over10k
 PREHOOK: Output: default@t1
 PREHOOK: Output: default@t2
-POSTHOOK: query: from (select sum(i) over (), s from over10k) tt insert overwrite table t1 select * insert overwrite table t2 select *
+POSTHOOK: query: from (select sum(i) over (partition by ts order by i), s from over10k) tt insert overwrite table t1 select * insert overwrite table t2 select *
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over10k
 POSTHOOK: Output: default@t1
@@ -700,9 +700,9 @@ POSTHOOK: Lineage: t1.a1 SCRIPT [(over10k)over10k.FieldSchema(name:t, type:tinyi
 POSTHOOK: Lineage: t1.b1 SCRIPT [(over10k)over10k.FieldSchema(name:t, type:tinyint, comment:null), (over10k)over10k.FieldSchema(name:si, type:smallint, comment:null), (over10k)over10k.FieldSchema(name:i, type:int, comment:null), (over10k)over10k.FieldSchema(name:b, type:bigint, comment:null), (over10k)over10k.FieldSchema(name:f, type:float, comment:null), (over10k)over10k.FieldSchema(name:d, type:double, comment:null), (over10k)over10k.FieldSchema(name:bo, type:boolean, comment:null), (over10k)over10k.FieldSchema(name:s, type:string, comment:null), (over10k)over10k.FieldSchema(name:ts, type:timestamp, comment:null), (over10k)over10k.FieldSchema(name:dec, type:decimal, comment:null), (over10k)over10k.FieldSchema(name:bin, type:binary, comment:null), (over10k)over10k.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (over10k)over10k.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: t2.a1 SCRIPT [(over10k)over10k.FieldSchema(name:t, type:tinyint, comment:null), (over10k)over10k.FieldSchema(name:si, type:smallint, comment:null), (over10k)over10k.FieldSchema(name:i, type:int, comment:null), (over10k)over10k.FieldSchema(name:b, type:bigint, comment:null), (over10k)over10k.FieldSchema(name:f, type:float, comment:null), (over10k)over10k.FieldSchema(name:d, type:double, comment:null), (over10k)over10k.FieldSchema(name:bo, type:boolean, comment:null), (over10k)over10k.FieldSchema(name:s, type:string, comment:null), (over10k)over10k.FieldSchema(name:ts, type:timestamp, comment:null), (over10k)over10k.FieldSchema(name:dec, type:decimal, comment:null), (over10k)over10k.FieldSchema(name:bin, type:binary, comment:null), (over10k)over10k.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (over10k)over10k.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: t2.b1 SCRIPT [(over10k)over10k.FieldSchema(name:t, type:tinyint, comment:null), (over10k)over10k.FieldSchema(name:si, type:smallint, comment:null), (over10k)over10k.FieldSchema(name:i, type:int, comment:null), (over10k)over10k.FieldSchema(name:b, type:bigint, comment:null), (over10k)over10k.FieldSchema(name:f, type:float, comment:null), (over10k)over10k.FieldSchema(name:d, type:double, comment:null), (over10k)over10k.FieldSchema(name:bo, type:boolean, comment:null), (over10k)over10k.FieldSchema(name:s, type:string, comment:null), (over10k)over10k.FieldSchema(name:ts, type:timestamp, comment:null), (over10k)over10k.FieldSchema(name:dec, type:decimal, comment:null), (over10k)over10k.FieldSchema(name:bin, type:binary, comment:null), (over10k)over10k.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (over10k)over10k.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
-656584379	bob davidson
-656584379	alice zipper
-656584379	katie davidson
+65542	rachel thompson
+131088	oscar brown
+262258	wendy steinbeck
 PREHOOK: query: select * from t2 limit 3
 PREHOOK: type: QUERY
 PREHOOK: Input: default@t2
@@ -715,9 +715,9 @@ POSTHOOK: Lineage: t1.a1 SCRIPT [(over10k)over10k.FieldSchema(name:t, type:tinyi
 POSTHOOK: Lineage: t1.b1 SCRIPT [(over10k)over10k.FieldSchema(name:t, type:tinyint, comment:null), (over10k)over10k.FieldSchema(name:si, type:smallint, comment:null), (over10k)over10k.FieldSchema(name:i, type:int, comment:null), (over10k)over10k.FieldSchema(name:b, type:bigint, comment:null), (over10k)over10k.FieldSchema(name:f, type:float, comment:null), (over10k)over10k.FieldSchema(name:d, type:double, comment:null), (over10k)over10k.FieldSchema(name:bo, type:boolean, comment:null), (over10k)over10k.FieldSchema(name:s, type:string, comment:null), (over10k)over10k.FieldSchema(name:ts, type:timestamp, comment:null), (over10k)over10k.FieldSchema(name:dec, type:decimal, comment:null), (over10k)over10k.FieldSchema(name:bin, type:binary, comment:null), (over10k)over10k.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (over10k)over10k.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: t2.a1 SCRIPT [(over10k)over10k.FieldSchema(name:t, type:tinyint, comment:null), (over10k)over10k.FieldSchema(name:si, type:smallint, comment:null), (over10k)over10k.FieldSchema(name:i, type:int, comment:null), (over10k)over10k.FieldSchema(name:b, type:bigint, comment:null), (over10k)over10k.FieldSchema(name:f, type:float, comment:null), (over10k)over10k.FieldSchema(name:d, type:double, comment:null), (over10k)over10k.FieldSchema(name:bo, type:boolean, comment:null), (over10k)over10k.FieldSchema(name:s, type:string, comment:null), (over10k)over10k.FieldSchema(name:ts, type:timestamp, comment:null), (over10k)over10k.FieldSchema(name:dec, type:decimal, comment:null), (over10k)over10k.FieldSchema(name:bin, type:binary, comment:null), (over10k)over10k.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (over10k)over10k.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: t2.b1 SCRIPT [(over10k)over10k.FieldSchema(name:t, type:tinyint, comment:null), (over10k)over10k.FieldSchema(name:si, type:smallint, comment:null), (over10k)over10k.FieldSchema(name:i, type:int, comment:null), (over10k)over10k.FieldSchema(name:b, type:bigint, comment:null), (over10k)over10k.FieldSchema(name:f, type:float, comment:null), (over10k)over10k.FieldSchema(name:d, type:double, comment:null), (over10k)over10k.FieldSchema(name:bo, type:boolean, comment:null), (over10k)over10k.FieldSchema(name:s, type:string, comment:null), (over10k)over10k.FieldSchema(name:ts, type:timestamp, comment:null), (over10k)over10k.FieldSchema(name:dec, type:decimal, comment:null), (over10k)over10k.FieldSchema(name:bin, type:binary, comment:null), (over10k)over10k.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), (over10k)over10k.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
-656584379	bob davidson
-656584379	alice zipper
-656584379	katie davidson
+65542	rachel thompson
+131088	oscar brown
+262258	wendy steinbeck
 PREHOOK: query: select p_mfgr, p_retailprice, p_size,
 round(sum(p_retailprice),2) + 50.0 = round(sum(lag(p_retailprice,1,50.0)) + last_value(p_retailprice),2) 
   over(distribute by p_mfgr sort by p_retailprice)
diff --git a/ql/src/test/results/clientpositive/windowing_multipartitioning.q.out b/ql/src/test/results/clientpositive/windowing_multipartitioning.q.out
index 3279219700..1953d6d790 100644
--- a/ql/src/test/results/clientpositive/windowing_multipartitioning.q.out
+++ b/ql/src/test/results/clientpositive/windowing_multipartitioning.q.out
@@ -271,44 +271,44 @@ bob steinbeck	5	1
 tom allen	1	1
 bob steinbeck	1	1
 tom allen	7	2
-PREHOOK: query: select s, sum(f) over (partition by i), row_number() over () from over10k where s = 'tom allen' or s = 'bob steinbeck'
+PREHOOK: query: select s, sum(f) over (partition by i), row_number() over (order by f) from over10k where s = 'tom allen' or s = 'bob steinbeck'
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over10k
 #### A masked pattern was here ####
-POSTHOOK: query: select s, sum(f) over (partition by i), row_number() over () from over10k where s = 'tom allen' or s = 'bob steinbeck'
+POSTHOOK: query: select s, sum(f) over (partition by i), row_number() over (order by f) from over10k where s = 'tom allen' or s = 'bob steinbeck'
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over10k
 #### A masked pattern was here ####
-bob steinbeck	47.810001373291016	1
-tom allen	11.069999694824219	2
-tom allen	54.00000190734863	3
-tom allen	54.00000190734863	4
-tom allen	26.239999771118164	5
-bob steinbeck	28.479999542236328	6
-tom allen	81.8499984741211	7
-tom allen	15.84000015258789	8
-bob steinbeck	83.52999877929688	9
-bob steinbeck	38.33000183105469	10
-bob steinbeck	83.52999877929688	11
-bob steinbeck	80.7300033569336	12
-bob steinbeck	9.699999809265137	13
-tom allen	89.88999938964844	14
-bob steinbeck	26.290000915527344	15
-bob steinbeck	36.209999084472656	16
-tom allen	52.779998779296875	17
-tom allen	11.300000190734863	18
-tom allen	77.77999877929688	19
-tom allen	40.5099983215332	20
-bob steinbeck	82.19000244140625	21
-tom allen	83.47000122070312	22
-tom allen	38.93000030517578	23
-tom allen	47.16999816894531	24
-tom allen	19.459999084472656	25
-tom allen	50.630001068115234	26
-bob steinbeck	27.959999084472656	27
-tom allen	2.8499999046325684	28
-tom allen	95.41000366210938	29
-tom allen	55.38999938964844	30
+tom allen	2.8499999046325684	1
+bob steinbeck	9.699999809265137	2
+tom allen	11.069999694824219	3
+tom allen	11.300000190734863	4
+tom allen	54.00000190734863	5
+tom allen	15.84000015258789	6
+tom allen	19.459999084472656	7
+tom allen	26.239999771118164	8
+bob steinbeck	26.290000915527344	9
+bob steinbeck	27.959999084472656	10
+bob steinbeck	28.479999542236328	11
+bob steinbeck	36.209999084472656	12
+bob steinbeck	38.33000183105469	13
+tom allen	38.93000030517578	14
+tom allen	54.00000190734863	15
+tom allen	40.5099983215332	16
+tom allen	47.16999816894531	17
+bob steinbeck	47.810001373291016	18
+tom allen	50.630001068115234	19
+tom allen	52.779998779296875	20
+tom allen	55.38999938964844	21
+tom allen	77.77999877929688	22
+bob steinbeck	80.7300033569336	23
+tom allen	81.8499984741211	24
+bob steinbeck	82.19000244140625	25
+tom allen	83.47000122070312	26
+bob steinbeck	83.52999877929688	27
+bob steinbeck	83.52999877929688	28
+tom allen	89.88999938964844	29
+tom allen	95.41000366210938	30
 PREHOOK: query: select s, rank() over w1, 
 rank() over w2 
 from over10k 
diff --git a/ql/src/test/results/clientpositive/windowing_navfn.q.out b/ql/src/test/results/clientpositive/windowing_navfn.q.out
index edfbb0894a..3272d573bc 100644
--- a/ql/src/test/results/clientpositive/windowing_navfn.q.out
+++ b/ql/src/test/results/clientpositive/windowing_navfn.q.out
@@ -147,119 +147,119 @@ david garcia	1
 holly hernandez	2
 tom white	3
 rachel ellison	1
-PREHOOK: query: select i, lead(s) over (partition by bin order by d desc) from over10k limit 100
+PREHOOK: query: select i, lead(s) over (partition by bin order by d,i desc) from over10k limit 100
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over10k
 #### A masked pattern was here ####
-POSTHOOK: query: select i, lead(s) over (partition by bin order by d desc) from over10k limit 100
+POSTHOOK: query: select i, lead(s) over (partition by bin order by d,i desc) from over10k limit 100
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over10k
 #### A masked pattern was here ####
-65551	sarah steinbeck
-65575	holly underhill
-65779	yuri thompson
-65603	irene brown
-65700	alice ovid
-65761	zach polk
-65662	bob king
-65646	irene garcia
-65683	sarah underhill
-65732	bob underhill
-65683	david robinson
-65680	irene nixon
-65771	david young
-65698	ulysses johnson
-65776	priscilla nixon
-65677	jessica thompson
-65575	jessica ovid
-65546	irene zipper
-65689	nick king
-65732	katie laertes
-65559	bob quirinius
-65572	alice davidson
-65690	bob zipper
-65659	yuri ellison
-65536	ulysses garcia
-65762	mike hernandez
-65537	david laertes
-65720	tom johnson
-65536	wendy brown
-65728	alice steinbeck
-65599	ethan brown
-65598	gabriella zipper
-65738	oscar king
-65550	katie falkner
-65621	sarah hernandez
-65540	mike allen
-65646	sarah thompson
-65716	fred laertes
-65603	ulysses underhill
-65745	zach davidson
-65791	katie garcia
-65661	quinn carson
-65644	katie laertes
-65745	mike garcia
-65669	bob carson
-65775	irene van buren
-65589	sarah young
-65758	quinn nixon
-65677	wendy ichabod
-65725	ethan thompson
-65768	sarah king
-65784	irene polk
-65670	holly king
-65759	irene young
-65679	nick laertes
-65740	wendy nixon
-65746	holly van buren
-65572	xavier johnson
-65607	irene van buren
-65671	alice king
-65538	katie van buren
-65649	tom quirinius
-65540	quinn white
-65660	zach ellison
-65692	alice quirinius
-65577	ethan hernandez
-65553	calvin robinson
-65758	mike garcia
-65692	ethan nixon
-65766	mike ichabod
-65571	irene johnson
-65568	yuri xylophone
-65667	nick ellison
-65691	ethan brown
-65791	quinn ovid
-65573	zach thompson
-65551	alice garcia
-65759	ulysses king
-65732	gabriella laertes
-65609	bob garcia
-65585	priscilla robinson
-65640	xavier ellison
-65647	fred zipper
-65735	quinn polk
-65625	victor robinson
-65746	bob steinbeck
-65617	katie allen
-65658	quinn davidson
-65659	victor allen
-65707	alice falkner
-65775	zach nixon
-65752	tom polk
-65700	nick brown
-65587	bob van buren
-65661	katie polk
-65680	rachel polk
-65634	rachel king
-65756	xavier ichabod
-65783	luke garcia
-65650	tom carson
-PREHOOK: query: select i, lag(dec) over (partition by i order by s) from over10k limit 100
+65773	gabriella van buren
+65727	quinn steinbeck
+65649	katie laertes
+65643	luke young
+65712	xavier white
+65554	oscar garcia
+65715	katie ichabod
+65737	mike garcia
+65641	katie thompson
+65674	zach falkner
+65627	katie ovid
+65628	irene davidson
+65657	wendy van buren
+65686	yuri ichabod
+65594	ethan underhill
+65615	zach young
+65708	calvin falkner
+65674	nick xylophone
+65717	tom hernandez
+65713	tom ichabod
+65681	priscilla ichabod
+65654	victor laertes
+65580	victor van buren
+65711	holly xylophone
+65727	david garcia
+65692	yuri ovid
+65760	oscar xylophone
+65545	luke falkner
+65653	alice falkner
+65773	jessica robinson
+65756	fred davidson
+65698	tom hernandez
+65659	irene ellison
+65662	holly robinson
+65610	mike garcia
+65537	yuri hernandez
+65601	ulysses garcia
+65545	mike brown
+65538	ethan nixon
+65551	yuri falkner
+65709	rachel robinson
+65774	yuri polk
+65713	yuri nixon
+65613	sarah thompson
+65693	nick nixon
+65650	ethan carson
+65781	oscar king
+65675	priscilla ichabod
+65541	jessica thompson
+65719	mike polk
+65694	luke brown
+65538	victor young
+65746	oscar nixon
+65564	tom zipper
+65708	irene ellison
+65696	alice davidson
+65596	jessica garcia
+65586	victor miller
+65696	holly white
+65600	david robinson
+65785	jessica davidson
+65606	ulysses brown
+65734	ethan underhill
+65546	ethan miller
+65578	tom thompson
+65776	holly steinbeck
+65741	yuri underhill
+65770	priscilla king
+65562	bob white
+65605	victor van buren
+65764	bob allen
+65725	david underhill
+65700	holly king
+65648	victor ovid
+65733	priscilla xylophone
+65682	katie miller
+65694	victor xylophone
+65553	mike steinbeck
+65635	holly laertes
+65537	katie steinbeck
+65761	zach white
+65747	ethan falkner
+65601	ulysses king
+65590	rachel davidson
+65732	irene young
+65642	bob thompson
+65570	tom xylophone
+65692	sarah davidson
+65760	tom laertes
+65784	yuri johnson
+65630	zach laertes
+65774	nick polk
+65788	quinn xylophone
+65595	yuri white
+65765	xavier ellison
+65541	jessica ichabod
+65711	tom steinbeck
+65536	alice hernandez
+65545	tom zipper
+65789	ulysses hernandez
+PREHOOK: query: select i, lag(dec) over (partition by i order by s,i,dec) from over10k limit 100
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over10k
 #### A masked pattern was here ####
-POSTHOOK: query: select i, lag(dec) over (partition by i order by s) from over10k limit 100
+POSTHOOK: query: select i, lag(dec) over (partition by i order by s,i,dec) from over10k limit 100
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over10k
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/windowing_ntile.q.out b/ql/src/test/results/clientpositive/windowing_ntile.q.out
index cb0e527b73..36f738e1b9 100644
--- a/ql/src/test/results/clientpositive/windowing_ntile.q.out
+++ b/ql/src/test/results/clientpositive/windowing_ntile.q.out
@@ -39,240 +39,240 @@ PREHOOK: Output: default@over10k
 POSTHOOK: query: load data local inpath '../data/files/over10k' into table over10k
 POSTHOOK: type: LOAD
 POSTHOOK: Output: default@over10k
-PREHOOK: query: select i, ntile(10) over (partition by s) from over10k limit 100
+PREHOOK: query: select i, ntile(10) over (partition by s order by i) from over10k limit 100
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over10k
 #### A masked pattern was here ####
-POSTHOOK: query: select i, ntile(10) over (partition by s) from over10k limit 100
+POSTHOOK: query: select i, ntile(10) over (partition by s order by i) from over10k limit 100
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over10k
 #### A masked pattern was here ####
-65600	1
-65758	2
-65609	3
-65557	4
+65545	1
+65557	2
+65600	3
+65609	4
 65662	5
 65670	6
-65545	7
-65720	8
-65790	1
-65781	1
-65570	2
-65708	2
-65704	3
-65707	3
-65779	4
-65667	4
-65673	5
+65720	7
+65758	8
+65569	1
+65570	1
+65666	2
+65667	2
+65673	3
+65696	3
+65704	4
+65707	4
+65708	5
 65711	6
-65569	7
-65666	8
-65733	9
-65696	10
-65785	1
-65710	2
-65747	3
-65713	4
-65559	5
-65559	6
-65545	7
-65565	8
-65695	9
-65576	10
+65733	7
+65779	8
+65781	9
+65790	10
+65545	1
+65559	2
+65559	3
+65565	4
+65576	5
+65695	6
+65710	7
+65713	8
+65747	9
+65785	10
+65544	1
 65547	1
-65677	1
-65676	2
-65596	2
-65791	3
-65707	3
-65690	4
-65563	4
-65560	5
+65554	2
+65560	2
+65563	3
+65590	3
+65596	4
+65631	4
 65641	5
-65544	6
+65676	5
+65677	6
 65677	6
-65590	7
-65747	7
+65690	7
+65707	7
 65740	8
-65554	8
-65631	9
-65742	10
-65730	1
-65612	1
-65745	2
-65677	2
-65699	3
-65713	3
-65544	4
-65537	4
-65557	5
-65698	5
-65787	6
+65742	8
+65747	9
+65791	10
+65537	1
+65544	1
+65557	2
+65572	2
+65612	3
+65677	3
+65681	4
+65698	4
+65699	5
+65713	5
+65730	6
 65741	7
-65572	8
-65681	9
-65744	10
-65773	1
-65611	1
-65669	2
-65699	2
-65752	3
-65722	3
-65597	4
-65715	4
+65744	8
+65745	9
+65787	10
+65596	1
+65597	1
+65611	2
+65622	2
+65669	3
+65685	3
+65690	4
+65699	4
 65709	5
-65718	5
-65622	6
-65775	6
-65690	7
-65685	7
-65596	8
-65710	9
+65710	5
+65715	6
+65718	6
+65722	7
+65752	7
+65773	8
+65775	9
 65785	10
-65623	1
-65746	1
-65725	2
-65712	2
-65759	3
-65613	3
-65744	4
-65573	5
-65630	6
-65674	7
-65675	8
+65573	1
+65613	1
+65623	2
+65630	2
+65674	3
+65675	3
+65712	4
+65725	5
+65734	6
+65744	7
+65746	8
 65746	9
-65734	10
+65759	10
 65543	1
-65685	1
-65684	2
-65691	2
-65737	3
-PREHOOK: query: select s, ntile(100) over (partition by i) from over10k limit 100
+65545	1
+65569	2
+65603	2
+65633	3
+PREHOOK: query: select s, ntile(100) over (partition by i order by s) from over10k limit 100
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over10k
 #### A masked pattern was here ####
-POSTHOOK: query: select s, ntile(100) over (partition by i) from over10k limit 100
+POSTHOOK: query: select s, ntile(100) over (partition by i order by s) from over10k limit 100
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over10k
 #### A masked pattern was here ####
-rachel ichabod	1
+alice ichabod	1
 alice robinson	2
-priscilla young	3
-david laertes	4
-david nixon	5
-wendy polk	6
-alice ichabod	7
-holly white	8
-xavier davidson	9
-oscar ovid	10
-sarah thompson	11
-ethan johnson	12
-tom steinbeck	13
-katie ellison	14
-gabriella garcia	15
-luke allen	16
-zach hernandez	17
+bob robinson	3
+calvin thompson	4
+david johnson	5
+david laertes	6
+david nixon	7
+david nixon	8
+ethan johnson	9
+ethan ovid	10
+ethan underhill	11
+fred miller	12
+fred miller	13
+gabriella garcia	14
+gabriella underhill	15
+holly white	16
+irene johnson	17
+katie ellison	18
+luke allen	19
+mike quirinius	20
+mike white	21
+nick davidson	22
+oscar allen	23
+oscar garcia	24
+oscar ichabod	25
+oscar ovid	26
+oscar steinbeck	27
+priscilla garcia	28
+priscilla white	29
+priscilla xylophone	30
+priscilla young	31
+rachel brown	32
+rachel ichabod	33
+rachel xylophone	34
+sarah thompson	35
+sarah thompson	36
+tom johnson	37
+tom steinbeck	38
+ulysses polk	39
+victor johnson	40
+wendy polk	41
+xavier davidson	42
+yuri ellison	43
+zach allen	44
+zach hernandez	45
+alice ellison	1
+bob carson	2
+calvin brown	3
+david xylophone	4
+ethan white	5
+fred johnson	6
+fred van buren	7
+gabriella ichabod	8
+holly laertes	9
+holly quirinius	10
+jessica hernandez	11
+katie robinson	12
+katie thompson	13
+luke nixon	14
+mike garcia	15
+mike hernandez	16
+nick carson	17
 nick davidson	18
-zach allen	19
-sarah thompson	20
-david johnson	21
-bob robinson	22
-ethan ovid	23
-calvin thompson	24
-rachel brown	25
-rachel xylophone	26
-tom johnson	27
-ulysses polk	28
-oscar allen	29
-irene johnson	30
-oscar ichabod	31
-yuri ellison	32
-fred miller	33
-mike white	34
-david nixon	35
-priscilla white	36
-oscar garcia	37
-fred miller	38
-victor johnson	39
-oscar steinbeck	40
-priscilla garcia	41
-gabriella underhill	42
-priscilla xylophone	43
-mike quirinius	44
-ethan underhill	45
-oscar carson	1
-nick carson	2
-katie thompson	3
-victor xylophone	4
-xavier underhill	5
-zach nixon	6
-bob carson	7
-yuri garcia	8
-fred van buren	9
-sarah ichabod	10
-oscar robinson	11
-david xylophone	12
-wendy garcia	13
-mike garcia	14
-ulysses falkner	15
-sarah falkner	16
-mike hernandez	17
-fred johnson	18
-katie robinson	19
-holly quirinius	20
-luke nixon	21
-alice ellison	22
-yuri quirinius	23
-zach falkner	24
-zach ovid	25
-gabriella ichabod	26
-priscilla white	27
-ethan white	28
-calvin brown	29
-jessica hernandez	30
-wendy van buren	31
-holly laertes	32
+oscar carson	19
+oscar robinson	20
+priscilla white	21
+sarah falkner	22
+sarah ichabod	23
+ulysses falkner	24
+victor xylophone	25
+wendy garcia	26
+wendy van buren	27
+xavier underhill	28
+yuri garcia	29
+yuri quirinius	30
+yuri white	31
+zach falkner	32
 zach ichabod	33
-nick davidson	34
-yuri white	35
-victor garcia	1
-sarah ichabod	2
-mike brown	3
-holly thompson	4
-alice king	5
-quinn garcia	6
-holly hernandez	7
-gabriella nixon	8
-zach van buren	9
+zach nixon	34
+zach ovid	35
+alice ichabod	1
+alice king	2
+alice robinson	3
+calvin allen	4
+gabriella johnson	5
+gabriella nixon	6
+holly falkner	7
+holly hernandez	8
+holly thompson	9
 katie nixon	10
-luke davidson	11
-rachel young	12
-alice robinson	13
-oscar white	14
-holly falkner	15
-tom polk	16
-quinn laertes	17
-calvin allen	18
-luke brown	19
-xavier davidson	20
-PREHOOK: query: select f, ntile(4) over (partition by d) from over10k limit 100
+luke brown	11
+luke davidson	12
+luke white	13
+mike brown	14
+nick quirinius	15
+oscar white	16
+priscilla xylophone	17
+quinn garcia	18
+quinn laertes	19
+rachel young	20
+PREHOOK: query: select f, ntile(4) over (partition by d order by f) from over10k limit 100
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over10k
 #### A masked pattern was here ####
-POSTHOOK: query: select f, ntile(4) over (partition by d) from over10k limit 100
+POSTHOOK: query: select f, ntile(4) over (partition by d order by f) from over10k limit 100
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over10k
 #### A masked pattern was here ####
 8.39	1
-25.5	1
-5.29	2
+5.29	1
+25.5	2
 37.59	3
 79.24	1
-60.0	1
-48.5	2
+48.5	1
+60.0	2
 77.84	3
-51.57	1
-14.36	2
+14.36	1
+51.57	2
 87.91	3
 40.91	1
 59.09	2
@@ -280,65 +280,65 @@ POSTHOOK: Input: default@over10k
 46.55	2
 92.71	3
 59.72	1
-98.89	2
-97.35	3
+97.35	2
+98.89	3
 19.11	1
-35.21	1
-13.33	2
+13.33	1
+35.21	2
 30.47	1
 90.04	1
-77.44	1
-15.36	2
-60.76	3
+15.36	1
+60.76	2
+77.44	3
 9.07	1
 50.08	1
 13.3	1
 87.05	1
-66.95	1
-3.94	2
-41.66	1
-75.93	2
+3.94	1
+66.95	2
+18.65	1
+41.66	2
 48.52	3
-18.65	4
-70.77	1
-84.83	2
-50.15	3
+75.93	4
+50.15	1
+70.77	2
+84.83	3
 64.79	1
 88.94	2
-96.71	1
-1.42	2
-94.14	1
-9.88	2
+1.42	1
+96.71	2
+9.88	1
+94.14	2
 25.69	1
 67.56	2
 85.72	3
-82.8	1
+30.0	1
 40.0	1
-95.11	2
-61.73	3
-30.0	4
+61.73	2
+82.8	3
+95.11	4
 80.65	1
-96.54	1
-7.96	2
-61.07	1
+7.96	1
+96.54	2
 20.74	1
-89.36	2
-49.61	3
-69.97	4
-61.71	1
+49.61	1
+61.07	2
+69.97	3
+89.36	4
+2.66	1
 38.69	2
-2.66	3
-58.25	4
+58.25	3
+61.71	4
 32.69	1
 98.29	2
-25.63	1
-0.62	2
+0.62	1
+25.63	2
 90.1	3
-69.42	1
-29.06	2
-85.03	1
-38.09	2
-68.81	3
+29.06	1
+69.42	2
+38.09	1
+68.81	2
+85.03	3
 75.75	1
 88.22	2
 24.02	1
@@ -346,100 +346,100 @@ POSTHOOK: Input: default@over10k
 76.99	1
 96.45	1
 1.09	1
-57.61	1
-84.92	2
-26.21	3
+26.21	1
+57.61	2
+84.92	3
 80.99	1
 39.16	1
 39.82	2
-44.57	1
-24.15	2
+24.15	1
+44.57	2
 38.05	1
 81.55	2
-74.45	1
-49.13	2
+49.13	1
+74.45	2
 42.49	1
-67.28	1
+37.63	1
 49.09	2
-37.63	3
+67.28	3
 10.6	1
-PREHOOK: query: select d, ntile(1000) over (partition by dec) from over10k limit 100
+PREHOOK: query: select d, ntile(1000) over (partition by dec order by d) from over10k limit 100
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over10k
 #### A masked pattern was here ####
-POSTHOOK: query: select d, ntile(1000) over (partition by dec) from over10k limit 100
+POSTHOOK: query: select d, ntile(1000) over (partition by dec order by d) from over10k limit 100
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over10k
 #### A masked pattern was here ####
-41.04	1
-9.71	2
+9.71	1
+41.04	2
 43.7	1
-33.72	1
-1.42	2
+1.42	1
+33.72	2
 4.83	1
 12.49	1
 6.26	1
 14.11	2
 41.76	3
 6.55	1
-32.62	1
-11.27	2
+11.27	1
+32.62	2
 40.35	3
 41.23	1
 39.43	1
 21.2	1
 40.64	1
-43.97	1
-12.07	2
+12.07	1
+43.97	2
 27.64	1
-4.1	1
-0.7	2
+0.7	1
+4.1	2
 33.38	1
-33.65	1
-18.69	2
+18.69	1
+33.65	2
 2.2	1
 0.38	1
 15.83	1
-43.34	1
-11.38	2
-23.27	1
-38.18	2
-15.95	3
+11.38	1
+43.34	2
+15.95	1
+23.27	2
+38.18	3
 20.76	1
 5.63	1
 13.64	1
 34.33	2
 43.48	3
-46.79	1
-44.21	2
+44.21	1
+46.79	2
 6.52	1
 3.59	1
 40.26	2
-25.9	1
-16.31	2
+16.31	1
+25.9	2
 46.21	3
 45.08	1
 7.91	1
 24.37	2
 37.13	1
-39.25	1
-5.37	2
-7.64	1
-7.25	2
+5.37	1
+39.25	2
+7.25	1
+7.64	2
 16.09	3
 49.82	1
 16.08	1
 4.6	1
 14.12	1
-28.42	1
-27.58	2
+27.58	1
+28.42	2
 45.53	3
 48.56	4
 36.7	1
 32.68	1
-40.09	1
-3.17	2
-24.84	3
+3.17	1
+24.84	2
+40.09	3
 26.36	1
 33.49	1
 24.76	1
@@ -460,14 +460,14 @@ POSTHOOK: Input: default@over10k
 37.82	1
 15.27	1
 15.22	1
-40.54	1
-11.43	2
-22.64	1
-4.81	2
+11.43	1
+40.54	2
+4.81	1
+22.64	2
 14.18	1
 44.83	1
 5.15	1
-7.52	1
-2.78	2
-3.7	3
+2.78	1
+3.7	2
+7.52	3
 45.55	4
diff --git a/ql/src/test/results/clientpositive/windowing_rank.q.out b/ql/src/test/results/clientpositive/windowing_rank.q.out
index f72e734a8d..df06348447 100644
--- a/ql/src/test/results/clientpositive/windowing_rank.q.out
+++ b/ql/src/test/results/clientpositive/windowing_rank.q.out
@@ -147,222 +147,222 @@ ulysses garcia	1
 irene falkner	1
 holly robinson	1
 yuri white	1
-PREHOOK: query: select s, dense_rank() over (partition by ts order by i desc) from over10k limit 100
+PREHOOK: query: select s, dense_rank() over (partition by ts order by i,s desc) from over10k limit 100
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over10k
 #### A masked pattern was here ####
-POSTHOOK: query: select s, dense_rank() over (partition by ts order by i desc) from over10k limit 100
+POSTHOOK: query: select s, dense_rank() over (partition by ts order by i,s desc) from over10k limit 100
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over10k
 #### A masked pattern was here ####
-jessica polk	1
-calvin steinbeck	2
-katie king	3
-rachel garcia	3
-bob ovid	4
-mike laertes	5
-gabriella xylophone	6
-sarah falkner	7
-jessica laertes	8
-tom johnson	9
-calvin brown	10
-yuri allen	11
-calvin laertes	12
+rachel thompson	1
+oscar brown	2
+wendy steinbeck	3
+victor van buren	4
+fred zipper	5
+priscilla zipper	6
+katie white	7
+fred nixon	8
+gabriella van buren	9
+luke zipper	10
+victor ellison	11
+david falkner	12
 nick carson	13
-david falkner	14
-victor ellison	15
-luke zipper	16
-gabriella van buren	17
-fred nixon	18
-priscilla zipper	19
-katie white	19
-fred zipper	20
-wendy steinbeck	21
-victor van buren	21
-oscar brown	22
-rachel thompson	23
-luke king	1
-holly thompson	1
-luke xylophone	2
-rachel robinson	3
-wendy thompson	4
-priscilla hernandez	5
-fred polk	6
-irene brown	7
-rachel young	8
-bob falkner	9
-katie davidson	10
+calvin laertes	14
+yuri allen	15
+calvin brown	16
+tom johnson	17
+jessica laertes	18
+sarah falkner	19
+gabriella xylophone	20
+mike laertes	21
+bob ovid	22
+rachel garcia	23
+katie king	24
+calvin steinbeck	25
+jessica polk	26
+xavier davidson	1
+ethan ovid	2
+calvin white	3
+katie zipper	4
+quinn allen	5
+victor underhill	6
+ulysses xylophone	7
+priscilla zipper	8
+quinn ovid	9
+katie xylophone	10
 rachel ovid	11
-jessica brown	12
-holly falkner	13
-sarah van buren	14
-yuri hernandez	15
-zach young	16
-calvin carson	17
-bob king	18
-calvin nixon	19
-gabriella johnson	20
-xavier johnson	20
-ethan young	21
-jessica brown	22
-jessica nixon	23
-fred king	23
-ulysses johnson	23
-wendy johnson	24
-oscar davidson	25
-nick ellison	26
-luke steinbeck	27
-jessica robinson	28
-priscilla brown	29
-gabriella underhill	29
-gabriella steinbeck	30
-luke thompson	31
-alice miller	32
-oscar van buren	32
-yuri brown	33
-rachel ovid	34
-katie xylophone	35
-quinn ovid	36
-priscilla zipper	37
-victor underhill	38
-ulysses xylophone	38
-quinn allen	39
-katie zipper	40
-calvin white	41
-ethan ovid	42
-xavier davidson	43
-oscar carson	1
-priscilla garcia	2
-priscilla hernandez	3
-bob carson	4
-quinn van buren	5
-rachel ichabod	6
-ethan ichabod	6
-jessica ovid	7
-ulysses carson	7
-holly allen	8
-wendy falkner	8
-rachel ellison	9
-jessica johnson	10
-rachel ichabod	11
-wendy underhill	12
-sarah falkner	13
-tom hernandez	14
+yuri brown	12
+oscar van buren	13
+alice miller	14
+luke thompson	15
+gabriella steinbeck	16
+priscilla brown	17
+gabriella underhill	18
+jessica robinson	19
+luke steinbeck	20
+nick ellison	21
+oscar davidson	22
+wendy johnson	23
+ulysses johnson	24
+jessica nixon	25
+fred king	26
+jessica brown	27
+ethan young	28
+xavier johnson	29
+gabriella johnson	30
+calvin nixon	31
+bob king	32
+calvin carson	33
+zach young	34
+yuri hernandez	35
+sarah van buren	36
+holly falkner	37
+jessica brown	38
+rachel ovid	39
+katie davidson	40
+bob falkner	41
+rachel young	42
+irene brown	43
+fred polk	44
+priscilla hernandez	45
+wendy thompson	46
+rachel robinson	47
+luke xylophone	48
+luke king	49
+holly thompson	50
+yuri garcia	1
+nick king	2
+calvin white	3
+rachel polk	4
+rachel davidson	5
+victor hernandez	6
+wendy miller	7
+wendy brown	8
+priscilla thompson	9
+holly nixon	10
+victor hernandez	11
+priscilla polk	12
+ethan nixon	13
+alice underhill	14
 jessica thompson	15
-alice underhill	16
-ethan nixon	16
-priscilla polk	17
-victor hernandez	18
-holly nixon	19
-priscilla thompson	20
-PREHOOK: query: select s, cume_dist() over (partition by bo order by b) from over10k limit 100
+tom hernandez	16
+sarah falkner	17
+wendy underhill	18
+rachel ichabod	19
+jessica johnson	20
+rachel ellison	21
+wendy falkner	22
+holly allen	23
+ulysses carson	24
+PREHOOK: query: select s, cume_dist() over (partition by bo order by b,s) from over10k limit 100
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over10k
 #### A masked pattern was here ####
-POSTHOOK: query: select s, cume_dist() over (partition by bo order by b) from over10k limit 100
+POSTHOOK: query: select s, cume_dist() over (partition by bo order by b,s) from over10k limit 100
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over10k
 #### A masked pattern was here ####
-holly allen	0.004625905068382945
-wendy falkner	0.004625905068382945
-david ovid	0.004625905068382945
-victor garcia	0.004625905068382945
-katie xylophone	0.004625905068382945
-ulysses xylophone	0.004625905068382945
-nick steinbeck	0.004625905068382945
-ethan ellison	0.004625905068382945
-nick quirinius	0.004625905068382945
-irene garcia	0.004625905068382945
-mike xylophone	0.004625905068382945
-victor xylophone	0.004625905068382945
-jessica steinbeck	0.004625905068382945
-irene van buren	0.004625905068382945
-quinn steinbeck	0.004625905068382945
-calvin allen	0.004625905068382945
-david zipper	0.004625905068382945
-sarah miller	0.004625905068382945
-ulysses nixon	0.004625905068382945
-ulysses ichabod	0.004625905068382945
+calvin allen	2.0112630732099757E-4
+david ovid	4.0225261464199515E-4
+david zipper	6.033789219629927E-4
+ethan ellison	8.045052292839903E-4
+holly allen	0.001005631536604988
+irene garcia	0.0012067578439259854
+irene van buren	0.0014078841512469831
+jessica steinbeck	0.0016090104585679806
+katie xylophone	0.0018101367658889783
+mike xylophone	0.002011263073209976
+nick quirinius	0.0022123893805309734
+nick steinbeck	0.002413515687851971
+quinn steinbeck	0.002614641995172969
+rachel thompson	0.0028157683024939663
+sarah miller	0.0030168946098149637
+tom hernandez	0.003218020917135961
+ulysses ichabod	0.003419147224456959
+ulysses nixon	0.0036202735317779565
+ulysses xylophone	0.003821399839098954
+victor garcia	0.004022526146419952
+victor xylophone	0.004223652453740949
+wendy falkner	0.004424778761061947
 yuri nixon	0.004625905068382945
-tom hernandez	0.004625905068382945
-rachel thompson	0.004625905068382945
-katie xylophone	0.007441673370876911
-oscar quirinius	0.007441673370876911
-rachel davidson	0.007441673370876911
-sarah van buren	0.007441673370876911
-ulysses allen	0.007441673370876911
-bob king	0.007441673370876911
-bob johnson	0.007441673370876911
-calvin van buren	0.007441673370876911
-tom king	0.007441673370876911
+bob johnson	0.004827031375703942
+bob king	0.00502815768302494
+calvin van buren	0.005229283990345938
+gabriella robinson	0.005430410297666935
+katie xylophone	0.0056315366049879325
+mike steinbeck	0.00583266291230893
+oscar quirinius	0.006033789219629927
+rachel davidson	0.006234915526950925
+sarah van buren	0.006436041834271922
+tom king	0.00663716814159292
+ulysses allen	0.006838294448913918
+wendy ellison	0.007039420756234915
+zach allen	0.007240547063555913
 zach young	0.007441673370876911
-zach allen	0.007441673370876911
-mike steinbeck	0.007441673370876911
-wendy ellison	0.007441673370876911
-gabriella robinson	0.007441673370876911
+alice falkner	0.007642799678197908
+bob ovid	0.007843925985518906
+bob underhill	0.008045052292839904
+ethan ovid	0.008246178600160902
+gabriella davidson	0.008447304907481898
+gabriella garcia	0.008648431214802896
+irene nixon	0.008849557522123894
+jessica brown	0.009050683829444892
+jessica miller	0.00925181013676589
+jessica quirinius	0.009452936444086887
+luke falkner	0.009654062751407884
+luke robinson	0.009855189058728881
+mike steinbeck	0.01005631536604988
+mike van buren	0.010257441673370877
+priscilla hernandez	0.010458567980691875
+tom polk	0.010659694288012871
+ulysses king	0.01086082059533387
+ulysses robinson	0.011061946902654867
 xavier davidson	0.011263073209975865
-jessica miller	0.011263073209975865
-mike steinbeck	0.011263073209975865
-alice falkner	0.011263073209975865
-irene nixon	0.011263073209975865
-jessica brown	0.011263073209975865
-ethan ovid	0.011263073209975865
-ulysses king	0.011263073209975865
-gabriella davidson	0.011263073209975865
-jessica quirinius	0.011263073209975865
-luke falkner	0.011263073209975865
-luke robinson	0.011263073209975865
-priscilla hernandez	0.011263073209975865
-mike van buren	0.011263073209975865
-ulysses robinson	0.011263073209975865
-bob underhill	0.011263073209975865
-bob ovid	0.011263073209975865
-tom polk	0.011263073209975865
-gabriella garcia	0.011263073209975865
-wendy allen	0.015084473049074818
-victor robinson	0.015084473049074818
-calvin nixon	0.015084473049074818
-wendy nixon	0.015084473049074818
-mike falkner	0.015084473049074818
-nick falkner	0.015084473049074818
-priscilla nixon	0.015084473049074818
-david davidson	0.015084473049074818
-bob underhill	0.015084473049074818
-oscar laertes	0.015084473049074818
-oscar miller	0.015084473049074818
-priscilla xylophone	0.015084473049074818
-jessica robinson	0.015084473049074818
-quinn miller	0.015084473049074818
+alice hernandez	0.011464199517296863
+bob underhill	0.01166532582461786
+calvin nixon	0.011866452131938857
+david davidson	0.012067578439259855
+holly falkner	0.012268704746580853
+irene laertes	0.01246983105390185
+jessica robinson	0.012670957361222849
+mike falkner	0.012872083668543845
+nick falkner	0.013073209975864843
+oscar laertes	0.01327433628318584
+oscar miller	0.013475462590506838
+oscar thompson	0.013676588897827836
+priscilla nixon	0.013877715205148834
+priscilla xylophone	0.01407884151246983
+quinn miller	0.014279967819790828
+victor robinson	0.014481094127111826
+wendy allen	0.014682220434432824
+wendy nixon	0.014883346741753822
 yuri ellison	0.015084473049074818
-holly falkner	0.015084473049074818
-oscar thompson	0.015084473049074818
-irene laertes	0.015084473049074818
-alice hernandez	0.015084473049074818
-luke johnson	0.01830249396621078
-fred carson	0.01830249396621078
-nick allen	0.01830249396621078
-nick ellison	0.01830249396621078
-priscilla laertes	0.01830249396621078
-priscilla underhill	0.01830249396621078
-calvin nixon	0.01830249396621078
-oscar king	0.01830249396621078
-katie polk	0.01830249396621078
-irene king	0.01830249396621078
-jessica davidson	0.01830249396621078
-victor steinbeck	0.01830249396621078
-priscilla young	0.01830249396621078
-katie polk	0.01830249396621078
-holly davidson	0.01830249396621078
+calvin nixon	0.015285599356395816
+fred carson	0.015486725663716814
+holly davidson	0.015687851971037812
+irene king	0.01588897827835881
+jessica davidson	0.016090104585679808
+katie polk	0.016492357200321803
+katie polk	0.016492357200321803
+luke johnson	0.0166934835076428
+nick allen	0.016894609814963796
+nick ellison	0.017095736122284794
+oscar king	0.01729686242960579
+priscilla laertes	0.01749798873692679
+priscilla underhill	0.017699115044247787
+priscilla young	0.017900241351568785
+victor steinbeck	0.018101367658889783
 wendy miller	0.01830249396621078
-zach johnson	0.02252614641995173
-mike falkner	0.02252614641995173
-victor zipper	0.02252614641995173
-wendy king	0.02252614641995173
-fred ellison	0.02252614641995173
-mike hernandez	0.02252614641995173
-xavier allen	0.02252614641995173
-zach zipper	0.02252614641995173
-ethan laertes	0.02252614641995173
+calvin carson	0.01850362027353178
+ethan hernandez	0.018704746580852777
+ethan laertes	0.01910699919549477
+ethan laertes	0.01910699919549477
+ethan white	0.019308125502815767
+fred ellison	0.019509251810136765
+gabriella hernandez	0.019710378117457763
+gabriella ovid	0.01991150442477876
+gabriella steinbeck	0.02011263073209976
 PREHOOK: query: select s, percent_rank() over (partition by dec order by f) from over10k limit 100
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over10k
@@ -476,7 +476,7 @@ PREHOOK: query: -- If following tests fail, look for the comments in class PTFPP
 select ts, dec, rnk
 from
   (select ts, dec,
-          rank() over (partition by ts)  as rnk
+          rank() over (partition by ts order by dec)  as rnk
           from
             (select other.ts, other.dec
              from over10k other
@@ -492,7 +492,7 @@ POSTHOOK: query: -- If following tests fail, look for the comments in class PTFP
 select ts, dec, rnk
 from
   (select ts, dec,
-          rank() over (partition by ts)  as rnk
+          rank() over (partition by ts order by dec)  as rnk
           from
             (select other.ts, other.dec
              from over10k other
@@ -503,16 +503,16 @@ where rnk =  1 limit 10
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over10k
 #### A masked pattern was here ####
-2013-03-01 09:11:58.70307	34.22	1
-2013-03-01 09:11:58.70307	34.22	1
-2013-03-01 09:11:58.70307	34.22	1
-2013-03-01 09:11:58.70307	34.22	1
-2013-03-01 09:11:58.70307	34.22	1
-2013-03-01 09:11:58.70307	34.22	1
-2013-03-01 09:11:58.70307	34.22	1
-2013-03-01 09:11:58.70307	34.22	1
-2013-03-01 09:11:58.70307	34.22	1
-2013-03-01 09:11:58.70307	34.22	1
+2013-03-01 09:11:58.70307	0.5	1
+2013-03-01 09:11:58.70307	0.5	1
+2013-03-01 09:11:58.70307	0.5	1
+2013-03-01 09:11:58.70307	0.5	1
+2013-03-01 09:11:58.70307	0.5	1
+2013-03-01 09:11:58.70307	0.5	1
+2013-03-01 09:11:58.70307	0.5	1
+2013-03-01 09:11:58.70307	0.5	1
+2013-03-01 09:11:58.70307	0.5	1
+2013-03-01 09:11:58.70307	0.5	1
 PREHOOK: query: select ts, dec, rnk
 from
   (select ts, dec,
@@ -554,7 +554,7 @@ POSTHOOK: Input: default@over10k
 PREHOOK: query: select ts, dec, rnk
 from
   (select ts, dec,
-          rank() over (partition by ts)  as rnk
+          rank() over (partition by ts order by dec)  as rnk
           from
             (select other.ts, other.dec
              from over10k other
@@ -569,7 +569,7 @@ PREHOOK: Input: default@over10k
 POSTHOOK: query: select ts, dec, rnk
 from
   (select ts, dec,
-          rank() over (partition by ts)  as rnk
+          rank() over (partition by ts order by dec)  as rnk
           from
             (select other.ts, other.dec
              from over10k other
@@ -581,13 +581,13 @@ where rnk = 1 limit 10
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over10k
 #### A masked pattern was here ####
-2013-03-01 09:11:58.70307	53.25	1
-2013-03-01 09:11:58.70307	53.25	1
-2013-03-01 09:11:58.70307	53.25	1
-2013-03-01 09:11:58.70307	53.25	1
-2013-03-01 09:11:58.70307	53.25	1
-2013-03-01 09:11:58.70307	53.25	1
-2013-03-01 09:11:58.70307	53.25	1
-2013-03-01 09:11:58.70307	53.25	1
-2013-03-01 09:11:58.70307	53.25	1
-2013-03-01 09:11:58.70307	79.99	1
+2013-03-01 09:11:58.70307	37.3	1
+2013-03-01 09:11:58.70307	37.3	1
+2013-03-01 09:11:58.70307	37.3	1
+2013-03-01 09:11:58.70307	37.3	1
+2013-03-01 09:11:58.70307	37.3	1
+2013-03-01 09:11:58.70307	37.3	1
+2013-03-01 09:11:58.70307	37.3	1
+2013-03-01 09:11:58.70307	37.3	1
+2013-03-01 09:11:58.70307	37.3	1
+2013-03-01 09:11:58.70307	37.3	1
diff --git a/ql/src/test/results/clientpositive/windowing_udaf.q.out b/ql/src/test/results/clientpositive/windowing_udaf.q.out
index d7df34e2f5..901229d1cb 100644
--- a/ql/src/test/results/clientpositive/windowing_udaf.q.out
+++ b/ql/src/test/results/clientpositive/windowing_udaf.q.out
@@ -147,128 +147,128 @@ alice hernandez	65543
 alice hernandez	65543
 alice hernandez	65543
 alice hernandez	65543
-PREHOOK: query: select s, avg(f) over (partition by si order by t) from over10k limit 100
+PREHOOK: query: select s, avg(f) over (partition by si order by s) from over10k limit 100
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over10k
 #### A masked pattern was here ####
-POSTHOOK: query: select s, avg(f) over (partition by si order by t) from over10k limit 100
+POSTHOOK: query: select s, avg(f) over (partition by si order by s) from over10k limit 100
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over10k
 #### A masked pattern was here ####
-fred quirinius	40.970001220703125
-ulysses white	47.60000038146973
-alice ellison	44.45333353678385
-sarah white	41.5
-victor thompson	44.07000001271566
-calvin johnson	44.07000001271566
-nick zipper	51.10142871311733
-victor johnson	47.296250104904175
-calvin young	49.61400032043457
-zach nixon	49.61400032043457
-xavier quirinius	54.20833365122477
-victor robinson	54.20833365122477
-victor hernandez	54.74692329993615
-tom allen	54.20571436200823
-sarah brown	56.666666920979814
-irene polk	58.91937518119812
-holly xylophone	56.917647193459906
-rachel ovid	54.96833345625136
-wendy garcia	54.67736846522281
-oscar steinbeck	54.6835000038147
-zach white	54.382272633639246
-ethan thompson	54.382272633639246
-quinn hernandez	55.655652004739515
-fred hernandez	53.47749984264374
-wendy nixon	55.13319995880127
-david davidson	55.86461540368887
-rachel ellison	54.12888890725595
-gabriella falkner	53.41321430887495
-ethan falkner	52.01862072122508
-alice ovid	52.830666605631514
-zach underhill	53.1432257621519
-alice robinson	53.058787837173
-quinn quirinius	53.058787837173
-ulysses young	51.977352927712836
-xavier van buren	52.72857131958008
-xavier ovid	52.70055548350016
-victor davidson	51.42081073812536
-jessica laertes	51.61000061035156
-yuri nixon	52.75
-ethan king	61.550000508626304
-sarah hernandez	46.9425003528595
-alice underhill	41.020000267028806
-alice xylophone	50.516666889190674
-victor xylophone	52.099999972752165
-yuri brown	51.53500020503998
-oscar young	51.92777792612711
-nick quirinius	57.051818414167926
-zach underhill	57.051818414167926
-gabriella ellison	55.287500301996864
-holly white	54.27615407797006
-zach hernandez	54.87000022615705
-xavier brown	54.62933343251546
-irene young	52.748750150203705
-katie garcia	51.00941192402559
-oscar laertes	48.69000016318427
-katie ichabod	48.97000006625527
-nick davidson	48.98899998664856
-priscilla miller	47.38761901855469
-rachel robinson	48.00090911171653
-fred brown	50.08826098234757
-wendy brown	49.570400161743166
-fred zipper	49.570400161743166
-holly robinson	51.34037053143537
-priscilla laertes	51.34037053143537
-nick zipper	52.96571438653128
-ethan polk	54.25793121600973
-priscilla thompson	52.37741947174072
-luke quirinius	52.37741947174072
-oscar thompson	50.77843761444092
-ulysses young	50.225151639996156
-ethan underhill	51.552353017470416
-luke falkner	50.90800007411412
-zach zipper	52.148889011806915
-david brown	52.92216233949404
-zach hernandez	52.05473699067768
-mike underhill	51.34564116062262
-zach hernandez	51.274500131607056
-tom laertes	9.050000190734863
-oscar van buren	37.92999887466431
-priscilla underhill	49.59750008583069
-jessica ichabod	49.59750008583069
-bob falkner	54.244999726613365
-xavier zipper	54.244999726613365
-zach zipper	54.014285632542204
-jessica laertes	54.80499994754791
-calvin davidson	45.944000005722046
-calvin steinbeck	45.944000005722046
-gabriella young	44.62636371092363
-luke ovid	48.321666836738586
-nick king	54.24857177053179
-sarah zipper	54.24857177053179
-alice nixon	53.90733372370402
-ulysses laertes	50.65812536329031
-priscilla zipper	51.28058867594775
-calvin johnson	48.576667077011535
-katie allen	51.187895254084935
-zach steinbeck	49.3070004761219
-priscilla zipper	48.46285759267353
-mike underhill	48.61545496095311
-irene quirinius	49.54521778873775
-PREHOOK: query: select s, avg(i) over (partition by t, b) from over10k limit 100
+alice ellison	38.15999984741211
+alice ovid	57.26999855041504
+alice robinson	61.9533322652181
+calvin johnson	48.489999294281006
+calvin young	57.602000045776364
+david davidson	60.36000029246012
+ethan falkner	53.59000028882708
+ethan thompson	50.917500138282776
+fred hernandez	45.63555569118924
+fred quirinius	45.169000244140626
+gabriella falkner	44.16181841763583
+holly xylophone	42.55583349863688
+irene polk	46.413846236008865
+nick zipper	49.762142998831614
+oscar steinbeck	50.098000081380206
+quinn hernandez	52.19624996185303
+quinn quirinius	51.01882351146025
+rachel ellison	48.684444427490234
+rachel ovid	47.271052611501595
+sarah brown	49.46350011825562
+sarah white	48.66238103594099
+tom allen	48.59454545107755
+ulysses white	48.839565194171406
+ulysses young	47.483333349227905
+victor davidson	45.79800001144409
+victor hernandez	46.39076920656058
+victor johnson	45.437777748814334
+victor robinson	46.12964274202074
+victor thompson	47.65344815418638
+wendy garcia	47.7129998366038
+wendy nixon	49.234193478861165
+xavier ovid	49.311874970793724
+xavier quirinius	50.531212185368396
+xavier van buren	51.34705878706539
+zach nixon	50.55771423067365
+zach underhill	50.889999959203934
+zach white	51.42081073812536
+alice underhill	17.329999923706055
+alice xylophone	57.66499996185303
+david brown	65.36333401997884
+ethan king	68.81000089645386
+ethan polk	73.13600120544433
+ethan underhill	76.83833408355713
+fred brown	79.57714380536761
+fred zipper	72.68500089645386
+gabriella ellison	68.5955564710829
+holly robinson	69.57500076293945
+holly white	67.0809097290039
+irene young	63.535833994547524
+jessica laertes	62.61846219576322
+katie garcia	59.8014292035784
+katie ichabod	59.41533381144206
+luke falkner	57.51437544822693
+luke quirinius	56.508823843563306
+mike underhill	54.72500027550591
+nick davidson	54.44210544385408
+nick quirinius	55.77850008010864
+nick zipper	57.73428571791876
+oscar laertes	55.53090910478072
+oscar thompson	53.169130449709684
+oscar young	53.24833333492279
+priscilla laertes	53.86000003814697
+priscilla miller	52.379230792705826
+priscilla thompson	50.80222225189209
+rachel robinson	51.162142923900056
+sarah hernandez	49.505517301888304
+ulysses young	48.93933340708415
+victor xylophone	49.34774195763372
+wendy brown	49.7678125500679
+xavier brown	49.81303030071837
+yuri brown	49.74735299278708
+yuri nixon	49.86571431841169
+zach hernandez	49.37763158898605
+zach hernandez	49.37763158898605
+zach hernandez	49.37763158898605
+zach underhill	50.13846162649301
+zach zipper	51.274500131607056
+alice nixon	31.255000591278076
+alice nixon	31.255000591278076
+bob falkner	51.356666247049965
+calvin davidson	39.96249973773956
+calvin johnson	32.491999769210814
+calvin steinbeck	29.613333185513813
+david garcia	34.99428541319711
+fred king	40.516249507665634
+gabriella young	39.50888853602939
+holly johnson	40.59399974346161
+irene quirinius	43.26727249405601
+jessica falkner	42.47249974807104
+jessica ichabod	42.86076903343201
+jessica laertes	44.109285541943144
+katie allen	47.71466666857402
+luke ovid	50.293125078082085
+mike underhill	50.38294123200809
+nick falkner	52.106666922569275
+nick king	54.01842131112751
+nick xylophone	54.5635001540184
+oscar van buren	55.146666697093416
+priscilla underhill	56.049545580690555
+priscilla zipper	55.24625018239021
+PREHOOK: query: select s, avg(i) over (partition by t, b order by s) from over10k limit 100
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over10k
 #### A masked pattern was here ####
-POSTHOOK: query: select s, avg(i) over (partition by t, b) from over10k limit 100
+POSTHOOK: query: select s, avg(i) over (partition by t, b order by s) from over10k limit 100
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over10k
 #### A masked pattern was here ####
 oscar miller	65773.0
-bob underhill	65743.5
+bob underhill	65735.0
 tom polk	65743.5
 wendy robinson	65622.0
 alice king	65570.0
-ethan steinbeck	65695.5
+ethan steinbeck	65720.0
 quinn polk	65695.5
 bob ellison	65671.0
 mike xylophone	65610.0
@@ -279,13 +279,13 @@ xavier ovid	65769.0
 oscar garcia	65712.0
 sarah zipper	65766.0
 wendy xylophone	65670.0
-gabriella brown	65680.33333333333
+gabriella brown	65751.0
+irene young	65715.0
 sarah miller	65680.33333333333
-irene young	65680.33333333333
 nick nixon	65696.0
 tom steinbeck	65608.0
+calvin white	65548.0
 oscar johnson	65650.0
-calvin white	65650.0
 holly thompson	65550.0
 david falkner	65698.0
 ulysses steinbeck	65562.0
@@ -293,31 +293,31 @@ victor allen	65658.0
 rachel thompson	65733.0
 jessica johnson	65589.0
 alice falkner	65597.0
-ulysses carson	65728.33333333333
-priscilla quirinius	65728.33333333333
+priscilla quirinius	65646.0
+ulysses carson	65714.5
 victor thompson	65728.33333333333
 ulysses ellison	65640.0
 bob johnson	65731.0
 quinn ellison	65736.0
+bob polk	65776.0
 victor xylophone	65697.0
-bob polk	65697.0
 jessica white	65566.0
 holly nixon	65565.0
 oscar johnson	65671.0
 irene ellison	65696.0
 priscilla zipper	65669.0
 fred ellison	65548.0
+nick robinson	65566.0
 sarah robinson	65605.0
-nick robinson	65605.0
 tom hernandez	65575.0
-alice xylophone	65618.0
+alice xylophone	65661.0
 sarah xylophone	65618.0
 priscilla laertes	65696.0
 holly polk	65710.0
 katie ichabod	65577.0
 holly underhill	65553.0
+alice davidson	65676.0
 ethan underhill	65706.5
-alice davidson	65706.5
 bob van buren	65654.0
 jessica king	65644.0
 mike allen	65551.0
@@ -343,8 +343,8 @@ mike king	65543.0
 rachel davidson	65728.0
 luke ichabod	65757.0
 luke young	65696.0
+victor robinson	65571.0
 wendy quirinius	65616.0
-victor robinson	65616.0
 jessica miller	65763.0
 bob ichabod	65733.0
 bob falkner	65595.0
@@ -353,15 +353,15 @@ zach zipper	65588.0
 alice underhill	65790.0
 alice xylophone	65715.0
 ethan nixon	65782.0
+bob van buren	65582.0
 katie ovid	65613.0
-bob van buren	65613.0
+fred king	65712.0
 yuri hernandez	65657.5
-fred king	65657.5
 nick falkner	65604.0
+david laertes	65612.0
 sarah steinbeck	65655.0
-david laertes	65655.0
+alice carson	65565.0
 katie thompson	65582.5
-alice carson	65582.5
 oscar van buren	65595.0
 PREHOOK: query: select max(i) over w from over10k window w as (partition by f) limit 100
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/windowing_windowspec.q.out b/ql/src/test/results/clientpositive/windowing_windowspec.q.out
index 4a324cc557..a355e30359 100644
--- a/ql/src/test/results/clientpositive/windowing_windowspec.q.out
+++ b/ql/src/test/results/clientpositive/windowing_windowspec.q.out
@@ -39,148 +39,148 @@ PREHOOK: Output: default@over10k
 POSTHOOK: query: load data local inpath '../data/files/over10k' into table over10k
 POSTHOOK: type: LOAD
 POSTHOOK: Output: default@over10k
-PREHOOK: query: select s, sum(b) over (partition by i order by si rows unbounded preceding) from over10k limit 100
+PREHOOK: query: select s, sum(b) over (partition by i order by s,b rows unbounded preceding) from over10k limit 100
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over10k
 #### A masked pattern was here ####
-POSTHOOK: query: select s, sum(b) over (partition by i order by si rows unbounded preceding) from over10k limit 100
+POSTHOOK: query: select s, sum(b) over (partition by i order by s,b rows unbounded preceding) from over10k limit 100
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over10k
 #### A masked pattern was here ####
-bob robinson	4294967349
-irene johnson	8589934809
-david nixon	12884902300
-holly white	17179869620
-sarah thompson	21474836919
-david johnson	25769804409
-gabriella garcia	30064771840
-nick davidson	34359739370
-ethan underhill	38654706880
-ethan johnson	42949674237
-ethan ovid	47244641665
-ulysses polk	51539609149
-rachel xylophone	55834576466
-priscilla young	60129543807
-zach hernandez	64424511119
-wendy polk	68719478445
-priscilla garcia	73014445793
-oscar allen	77309413101
-priscilla xylophone	81604380561
-oscar garcia	85899348058
-sarah thompson	90194315396
-oscar ovid	94489282904
-luke allen	98784250367
-fred miller	103079217857
-rachel brown	107374185306
-alice ichabod	111669152747
-alice robinson	115964120223
-victor johnson	120259087607
-priscilla white	124554055096
-calvin thompson	128849022432
-rachel ichabod	133143989766
-mike quirinius	137438957244
-gabriella underhill	141733924551
-david laertes	146028891982
-katie ellison	150323859357
-fred miller	154618826769
-xavier davidson	158913794163
-oscar ichabod	163208761567
-tom steinbeck	167503728932
-tom johnson	171798696363
-david nixon	176093663744
-zach allen	180388631253
-yuri ellison	184683598766
-oscar steinbeck	188978566217
-mike white	193273533646
-david xylophone	4294967419
-oscar carson	8589934879
-alice ellison	12884902325
-nick davidson	17179869787
-mike hernandez	21474837308
-sarah ichabod	25769804857
-zach ichabod	30064772276
-zach ovid	34359739647
-yuri garcia	38654707087
-zach nixon	42949674516
-nick carson	47244641852
-mike garcia	51539609271
-wendy van buren	55834576685
-luke nixon	60129544135
-priscilla white	64424511540
-gabriella ichabod	68719478979
-xavier underhill	73014446393
-zach falkner	77309413898
-holly laertes	81604381346
-calvin brown	85899348783
-yuri quirinius	90194316225
-yuri white	94489283634
-katie robinson	98784251053
-katie thompson	103079218409
-oscar robinson	107374185735
-jessica hernandez	111669153271
-ulysses falkner	115964120819
-holly quirinius	120259088349
-fred van buren	124554055812
-victor xylophone	128849023352
-bob carson	133143990798
-ethan white	137438958291
-wendy garcia	141733925665
-fred johnson	146028893128
-sarah falkner	150323860576
-gabriella johnson	4294967496
-yuri brown	8589935023
-xavier davidson	12884902564
-katie nixon	17179870081
-calvin allen	21474837415
-mike brown	25769804757
-zach van buren	30064772179
-tom polk	34359739577
-alice ichabod	38654707028
-holly thompson	42949674367
-oscar white	47244641792
-priscilla xylophone	51539609245
-nick quirinius	55834576730
-ulysses davidson	60129544067
-gabriella nixon	64424511395
-rachel young	68719478910
-sarah ichabod	73014446396
-ulysses robinson	77309413900
-quinn laertes	81604381239
-luke white	85899348560
-PREHOOK: query: select s, sum(f) over (partition by d order by i rows unbounded preceding) from over10k limit 100
+alice ichabod	4294967441
+alice robinson	8589934917
+bob robinson	12884902266
+calvin thompson	17179869602
+david johnson	21474837092
+david laertes	25769804523
+david nixon	30064771904
+david nixon	34359739395
+ethan johnson	38654706752
+ethan ovid	42949674180
+ethan underhill	47244641690
+fred miller	51539609102
+fred miller	55834576592
+gabriella garcia	60129544023
+gabriella underhill	64424511330
+holly white	68719478650
+irene johnson	73014446110
+katie ellison	77309413485
+luke allen	81604380948
+mike quirinius	85899348426
+mike white	90194315855
+nick davidson	94489283385
+oscar allen	98784250693
+oscar garcia	103079218190
+oscar ichabod	107374185594
+oscar ovid	111669153102
+oscar steinbeck	115964120553
+priscilla garcia	120259087901
+priscilla white	124554055390
+priscilla xylophone	128849022850
+priscilla young	133143990191
+rachel brown	137438957640
+rachel ichabod	141733924974
+rachel xylophone	146028892291
+sarah thompson	150323859590
+sarah thompson	154618826928
+tom johnson	158913794359
+tom steinbeck	163208761724
+ulysses polk	167503729208
+victor johnson	171798696592
+wendy polk	176093663918
+xavier davidson	180388631312
+yuri ellison	184683598825
+zach allen	188978566334
+zach hernandez	193273533646
+alice ellison	4294967446
+bob carson	8589934892
+calvin brown	12884902329
+david xylophone	17179869748
+ethan white	21474837241
+fred johnson	25769804704
+fred van buren	30064772167
+gabriella ichabod	34359739606
+holly laertes	38654707054
+holly quirinius	42949674584
+jessica hernandez	47244642120
+katie robinson	51539609539
+katie thompson	55834576895
+luke nixon	60129544345
+mike garcia	64424511764
+mike hernandez	68719479285
+nick carson	73014446621
+nick davidson	77309414083
+oscar carson	81604381543
+oscar robinson	85899348869
+priscilla white	90194316274
+sarah falkner	94489283722
+sarah ichabod	98784251271
+ulysses falkner	103079218819
+victor xylophone	107374186359
+wendy garcia	111669153733
+wendy van buren	115964121147
+xavier underhill	120259088561
+yuri garcia	124554056001
+yuri quirinius	128849023443
+yuri white	133143990852
+zach falkner	137438958357
+zach ichabod	141733925776
+zach nixon	146028893205
+zach ovid	150323860576
+alice ichabod	4294967451
+alice king	8589934958
+alice robinson	12884902278
+calvin allen	17179869612
+gabriella johnson	21474837108
+gabriella nixon	25769804436
+holly falkner	30064771905
+holly hernandez	34359739256
+holly thompson	38654706595
+katie nixon	42949674112
+luke brown	47244641636
+luke davidson	51539608978
+luke white	55834576299
+mike brown	60129543641
+nick quirinius	64424511126
+oscar white	68719478551
+priscilla xylophone	73014446004
+quinn garcia	77309413317
+quinn laertes	81604380656
+rachel young	85899348171
+PREHOOK: query: select s, sum(f) over (partition by d order by s,f rows unbounded preceding) from over10k limit 100
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over10k
 #### A masked pattern was here ####
-POSTHOOK: query: select s, sum(f) over (partition by d order by i rows unbounded preceding) from over10k limit 100
+POSTHOOK: query: select s, sum(f) over (partition by d order by s,f rows unbounded preceding) from over10k limit 100
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over10k
 #### A masked pattern was here ####
 calvin miller	8.390000343322754
-wendy quirinius	25.5
-holly polk	30.789999961853027
+holly polk	5.289999961853027
+wendy quirinius	30.789999961853027
 yuri laertes	68.38000011444092
 nick steinbeck	79.23999786376953
 katie brown	60.0
 priscilla quirinius	137.83999633789062
 tom young	186.33999633789062
-xavier robinson	87.91000366210938
-katie falkner	139.4800033569336
-gabriella quirinius	153.84000301361084
+gabriella quirinius	14.359999656677246
+katie falkner	65.92999935150146
+xavier robinson	153.84000301361084
 ethan carson	40.90999984741211
 victor johnson	100.0
-zach white	46.54999923706055
-jessica white	78.0099983215332
-jessica king	170.71999740600586
+jessica king	92.70999908447266
+jessica white	124.16999816894531
+zach white	170.71999740600586
 holly falkner	97.3499984741211
-victor davidson	157.06999969482422
-quinn falkner	255.95999908447266
+quinn falkner	196.23999786376953
+victor davidson	255.95999908447266
 holly young	19.110000610351562
 nick robinson	13.329999923706055
 xavier steinbeck	48.53999900817871
 irene king	30.469999313354492
 quinn zipper	90.04000091552734
-wendy zipper	77.44000244140625
-priscilla miller	92.8000020980835
+priscilla miller	15.359999656677246
+wendy zipper	92.8000020980835
 yuri miller	153.5600004196167
 zach steinbeck	9.069999694824219
 fred nixon	50.08000183105469
@@ -192,606 +192,606 @@ holly hernandez	48.52000045776367
 jessica quirinius	90.18000030517578
 tom xylophone	166.11000061035156
 wendy king	184.76000022888184
-yuri zipper	70.7699966430664
-gabriella brown	155.5999984741211
-quinn johnson	205.75
+gabriella brown	84.83000183105469
+quinn johnson	134.9800033569336
+yuri zipper	205.75
 david robinson	64.79000091552734
 mike nixon	153.7300033569336
-rachel davidson	96.70999908447266
-gabriella white	98.12999904155731
+gabriella white	1.4199999570846558
+rachel davidson	98.12999904155731
 yuri garcia	9.880000114440918
 yuri zipper	104.01999950408936
-katie hernandez	67.55999755859375
-jessica steinbeck	93.24999809265137
-alice king	178.9699993133545
-quinn davidson	95.11000061035156
-quinn van buren	177.91000366210938
-priscilla young	239.6400032043457
-katie ovid	279.6400032043457
+alice king	85.72000122070312
+jessica steinbeck	111.41000175476074
+katie hernandez	178.9699993133545
+katie ovid	40.0
+priscilla young	101.72999954223633
+quinn davidson	196.8400001525879
+quinn van buren	279.6400032043457
 victor steinbeck	309.6400032043457
 gabriella brown	80.6500015258789
 jessica ichabod	96.54000091552734
 zach laertes	104.50000095367432
-tom robinson	89.36000061035156
-irene carson	150.43000030517578
-irene falkner	171.17000007629395
-priscilla zipper	241.14000129699707
-ethan miller	290.75000190734863
-nick white	58.25
-xavier laertes	119.95999908447266
-katie polk	158.64999771118164
-sarah davidson	161.30999779701233
-nick polk	98.29000091552734
-alice ichabod	130.97999954223633
-luke brown	0.6200000047683716
-gabriella robinson	90.71999847888947
+ethan miller	49.61000061035156
+irene carson	110.68000030517578
+irene falkner	131.42000007629395
+priscilla zipper	201.39000129699707
+tom robinson	290.75000190734863
+katie polk	38.689998626708984
+nick white	96.93999862670898
+sarah davidson	99.59999871253967
+xavier laertes	161.30999779701233
+alice ichabod	32.689998626708984
+nick polk	130.97999954223633
+gabriella robinson	90.0999984741211
+luke brown	90.71999847888947
 wendy allen	116.34999763965607
 calvin ichabod	29.059999465942383
 holly steinbeck	98.4799976348877
 gabriella carson	38.09000015258789
-tom nixon	123.11999893188477
-holly van buren	191.92999649047852
-mike brown	88.22000122070312
-katie laertes	163.97000122070312
+holly van buren	106.89999771118164
+tom nixon	191.92999649047852
+katie laertes	75.75
+mike brown	163.97000122070312
 oscar nixon	24.020000457763672
 zach garcia	101.61999893188477
 tom polk	76.98999786376953
 mike allen	96.44999694824219
 alice johnson	1.090000033378601
-priscilla thompson	84.91999816894531
-yuri young	142.52999877929688
-holly robinson	168.73999786376953
+holly robinson	26.209999084472656
+priscilla thompson	111.12999725341797
+yuri young	168.73999786376953
 rachel carson	80.98999786376953
-victor brown	39.15999984741211
-gabriella laertes	78.97999954223633
-holly allen	44.56999969482422
-bob carson	68.71999931335449
-rachel carson	81.55000305175781
-fred nixon	119.60000228881836
+gabriella laertes	39.81999969482422
+victor brown	78.97999954223633
+bob carson	24.149999618530273
+holly allen	68.71999931335449
+fred nixon	38.04999923706055
+rachel carson	119.60000228881836
 alice nixon	49.130001068115234
 priscilla brown	123.57999801635742
 victor falkner	42.4900016784668
-tom white	37.630001068115234
-david garcia	104.90999984741211
-holly hernandez	154.0
+david garcia	67.27999877929688
+holly hernandez	116.36999893188477
+tom white	154.0
 rachel ellison	10.600000381469727
-PREHOOK: query: select s, sum(f) over (partition by ts order by b range between current row and unbounded following) from over10k limit 100
+PREHOOK: query: select s, sum(f) over (partition by ts order by f range between current row and unbounded following) from over10k limit 100
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over10k
 #### A masked pattern was here ####
-POSTHOOK: query: select s, sum(f) over (partition by ts order by b range between current row and unbounded following) from over10k limit 100
+POSTHOOK: query: select s, sum(f) over (partition by ts order by f range between current row and unbounded following) from over10k limit 100
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over10k
 #### A masked pattern was here ####
-sarah falkner	1276.850001335144
-mike laertes	1236.3100004196167
-katie white	1194.7100019454956
-priscilla zipper	1194.7100019454956
-fred zipper	1081.7100057601929
-yuri allen	997.0000066757202
-fred nixon	982.220006942749
-wendy steinbeck	953.5300064086914
-nick carson	888.5700073242188
-calvin laertes	797.2100067138672
-jessica polk	766.0400066375732
-calvin brown	671.0000057220459
-david falkner	660.1100053787231
-calvin steinbeck	621.760006904602
-katie king	583.1500062942505
-jessica laertes	490.19000720977783
-rachel thompson	475.6500072479248
-gabriella van buren	475.6500072479248
-victor ellison	309.64000511169434
-gabriella xylophone	263.56000328063965
-oscar brown	260.3900032043457
-luke zipper	231.1700038909912
-tom johnson	176.81000328063965
-rachel garcia	158.96000289916992
-victor van buren	102.02000427246094
-bob ovid	20.610000610351562
-priscilla hernandez	2368.430002987385
-quinn ovid	2316.340002834797
-yuri brown	2253.3100040555
-katie zipper	2235.730004131794
-irene brown	2198.4100044369698
-nick ellison	2163.0900047421455
-jessica robinson	2152.4700048565865
-fred polk	2152.4700048565865
-gabriella johnson	2087.890006840229
-wendy johnson	2058.1800077557564
-jessica brown	1974.2000043988228
-katie xylophone	1895.150001347065
-priscilla zipper	1809.5999982953072
-luke thompson	1762.7599981427193
-rachel ovid	1733.689998447895
-holly thompson	1729.9599984288216
-xavier davidson	1729.9599984288216
-ethan young	1671.4599993824959
-ulysses xylophone	1583.52999907732
-wendy thompson	1568.829999268055
-katie davidson	1553.869999229908
-victor underhill	1472.4599955677986
-calvin carson	1407.9099925160408
-rachel ovid	1331.7799952626228
-zach young	1275.3299944996834
-rachel robinson	1231.0299952626228
-calvin nixon	1210.019995033741
-yuri hernandez	1210.019995033741
-quinn allen	1121.3799956440926
-luke xylophone	1089.439995110035
-ulysses johnson	1032.6799967885017
-jessica nixon	948.4699977040291
-luke steinbeck	868.0399973988533
-rachel young	773.7700007557869
-gabriella steinbeck	724.8800013661385
-oscar davidson	686.3800013661385
-alice miller	685.5500013828278
-bob king	640.8900015354156
-fred king	628.0600016117096
-xavier johnson	628.0600016117096
-gabriella underhill	543.2200031280518
-ethan ovid	454.290002822876
-luke king	435.19000244140625
-jessica brown	366.5699996948242
-bob falkner	334.7299995422363
-oscar van buren	334.7299995422363
-sarah van buren	173.4000015258789
-calvin white	119.31000137329102
-priscilla brown	69.03000259399414
-holly falkner	26.950000762939453
-bob carson	1607.950005441904
-oscar carson	1607.1600054204464
-rachel polk	1514.8300035893917
-sarah falkner	1485.8200033605099
-yuri garcia	1446.5200041234493
-ethan nixon	1423.2500036656857
-victor hernandez	1385.3000029027462
-nick king	1385.3000029027462
-quinn van buren	1385.3000029027462
-victor hernandez	1193.4799989163876
-rachel ichabod	1168.349999755621
-holly allen	1115.910001128912
-priscilla garcia	1115.5500011146069
-rachel davidson	1035.5300044715405
-priscilla thompson	954.2400035560131
-wendy brown	900.140005081892
-alice underhill	811.3100032508373
-holly nixon	785.4000034034252
-jessica thompson	754.9300040900707
-rachel ichabod	698.2300033271313
-wendy falkner	697.7500033378601
-wendy miller	635.6600031852722
-wendy underhill	634.3900032043457
-calvin white	609.0500030517578
-PREHOOK: query: select s, avg(f) over (partition by bin order by s rows between current row and 5 following) from over10k limit 100
+gabriella xylophone	1276.850001335144
+calvin brown	1273.68000125885
+jessica laertes	1262.7900009155273
+yuri allen	1248.2500009536743
+tom johnson	1233.4700012207031
+bob ovid	1215.6200008392334
+fred nixon	1195.0100002288818
+oscar brown	1166.3199996948242
+calvin laertes	1137.1000003814697
+david falkner	1105.9300003051758
+calvin steinbeck	1067.5800018310547
+katie white	1028.9700012207031
+sarah falkner	989.4900016784668
+mike laertes	948.9500007629395
+victor ellison	907.3500022888184
+luke zipper	861.2700004577637
+rachel garcia	806.9099998474121
+wendy steinbeck	749.9700012207031
+priscilla zipper	685.0100021362305
+rachel thompson	611.4900054931641
+victor van buren	532.9100036621094
+fred zipper	451.5
+gabriella van buren	366.79000091552734
+nick carson	279.36000061035156
+katie king	188.0
+jessica polk	95.04000091552734
+oscar davidson	2368.430002987385
+xavier johnson	2367.600003004074
+rachel ovid	2365.6100029945374
+xavier davidson	2361.880002975464
+nick ellison	2353.0200033187866
+jessica robinson	2342.4000034332275
+bob king	2331.0800037384033
+ulysses xylophone	2318.2500038146973
+wendy thompson	2303.550004005432
+yuri brown	2288.590003967285
+ethan ovid	2271.010004043579
+rachel robinson	2251.9100036621094
+holly falkner	2230.9000034332275
+calvin nixon	2203.950002670288
+luke thompson	2176.7200031280518
+gabriella johnson	2147.6500034332275
+jessica brown	2117.940004348755
+quinn allen	2086.100004196167
+irene brown	2054.1600036621094
+katie zipper	2018.8400039672852
+gabriella steinbeck	1981.520004272461
+priscilla brown	1943.020004272461
+zach young	1900.9400024414062
+alice miller	1856.6400032043457
+priscilla zipper	1811.9800033569336
+rachel young	1765.1400032043457
+holly thompson	1716.2500038146973
+calvin white	1666.6100044250488
+priscilla hernandez	1616.330005645752
+fred polk	1564.240005493164
+sarah van buren	1510.9800071716309
+rachel ovid	1456.890007019043
+luke xylophone	1400.4400062561035
+yuri hernandez	1343.6800079345703
+oscar van buren	1282.2700080871582
+quinn ovid	1220.390007019043
+victor underhill	1157.360008239746
+luke king	1092.8100051879883
+calvin carson	1024.1900024414062
+jessica brown	948.0600051879883
+jessica nixon	869.0100021362305
+katie davidson	788.5800018310547
+fred king	707.1699981689453
+wendy johnson	624.3199996948242
+ulysses johnson	540.3399963378906
+katie xylophone	456.12999725341797
+ethan young	370.57999420166016
+gabriella underhill	282.6499938964844
+luke steinbeck	193.7199935913086
+bob falkner	99.44999694824219
+holly allen	1607.950005441904
+rachel ichabod	1607.590005427599
+bob carson	1607.1100054383278
+wendy miller	1606.3200054168701
+nick king	1605.0500054359436
+rachel ellison	1600.5700054168701
+yuri garcia	1591.5700054168701
+victor hernandez	1568.3000049591064
+wendy underhill	1543.1700057983398
+alice underhill	1517.830005645752
+rachel polk	1491.9200057983398
+holly nixon	1462.910005569458
+ethan nixon	1432.4400062561035
+sarah falkner	1394.490005493164
+tom hernandez	1355.1900062561035
+rachel ichabod	1309.2800064086914
+priscilla thompson	1256.8400077819824
+jessica thompson	1202.7400093078613
+ulysses carson	1146.0400085449219
+wendy falkner	1087.2700080871582
+calvin white	1025.1800079345703
+jessica ovid	956.9800109863281
+jessica johnson	885.3000106811523
+priscilla garcia	805.8400115966797
+PREHOOK: query: select s, avg(f) over (partition by ts order by s,f rows between current row and 5 following) from over10k limit 100
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over10k
 #### A masked pattern was here ####
-POSTHOOK: query: select s, avg(f) over (partition by bin order by s rows between current row and 5 following) from over10k limit 100
+POSTHOOK: query: select s, avg(f) over (partition by ts order by s,f rows between current row and 5 following) from over10k limit 100
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over10k
 #### A masked pattern was here ####
-alice davidson	48.39166768391927
-alice davidson	46.76333427429199
-alice falkner	46.43333371480306
-alice falkner	46.9966672261556
-alice garcia	50.778334299723305
-alice hernandez	58.11500040690104
-alice king	56.846666971842446
-alice king	48.9350004196167
-alice nixon	42.5600004196167
-alice ovid	41.2383337020874
-alice polk	40.97999986012777
-alice quirinius	39.10666688283285
-alice steinbeck	38.64833370844523
-alice steinbeck	45.453333695729576
-alice xylophone	45.72333383560181
-bob allen	49.850000858306885
-bob carson	47.93000078201294
-bob davidson	50.72666724522909
-bob garcia	54.31500085194906
-bob ichabod	53.10500113169352
-bob king	54.813334147135414
-bob nixon	46.69166692097982
-bob quirinius	40.1850004196167
-bob robinson	40.178333600362144
-bob steinbeck	41.888333320617676
-bob thompson	45.609999656677246
-bob underhill	54.843332608540855
-bob underhill	67.28666655222575
-bob van buren	78.15333302815755
-bob white	77.08833312988281
-bob zipper	77.79500007629395
-calvin falkner	73.87833340962727
-calvin johnson	64.13000043233235
-calvin king	59.62166659037272
-calvin miller	54.65000025431315
-calvin robinson	45.6850004196167
-calvin young	47.97666708628336
-david falkner	53.101667722066246
-david falkner	46.96000130971273
-david garcia	38.215001265207924
-david laertes	31.49333429336548
-david robinson	29.42000087102254
-david robinson	20.826667308807373
-david underhill	18.201666673024494
-david underhill	25.678333441416424
-david underhill	35.02333323160807
-david young	33.43166661262512
-david young	44.64500037829081
-david young	52.74333373705546
-ethan brown	48.8166671593984
-ethan brown	54.74000064531962
-ethan brown	51.29333392779032
-ethan carson	61.7383337020874
-ethan carson	61.09500026702881
-ethan ellison	63.83333365122477
-ethan falkner	71.36666742960612
-ethan hernandez	64.01333363850911
-ethan hernandez	63.31000073750814
-ethan king	61.715000788370766
-ethan miller	62.758334477742515
-ethan nixon	59.5483341217041
-ethan nixon	52.14833354949951
-ethan polk	54.858333905537926
-ethan thompson	48.25166702270508
-ethan thompson	51.20000076293945
-ethan underhill	38.90000009536743
-ethan underhill	35.8683336575826
-ethan xylophone	33.24166711171468
-ethan zipper	38.02166716257731
-fred davidson	40.61000061035156
-fred ellison	42.13666661580404
-fred laertes	48.21500031153361
-fred ovid	50.3050004641215
-fred robinson	51.78000036875407
-fred underhill	39.080000162124634
-fred zipper	42.42166670163473
-gabriella ellison	29.853333711624146
-gabriella king	33.516666332880654
-gabriella laertes	33.8649996916453
-gabriella miller	31.606666326522827
-gabriella steinbeck	31.81166632970174
-gabriella underhill	32.311666329701744
-gabriella van buren	37.053332805633545
-gabriella van buren	32.42833344141642
-gabriella young	38.19166707992554
-gabriella zipper	45.965000788370766
-holly brown	49.75166734059652
-holly carson	53.02666759490967
-holly king	61.99000072479248
-holly king	71.15833377838135
-holly laertes	59.49499988555908
-holly nixon	51.66999959945679
-holly polk	47.653333028157554
-holly polk	43.83499972025553
-holly quirinius	28.495000183582306
-holly robinson	17.7650000055631
-holly steinbeck	15.870000024636587
-holly underhill	17.810000081857044
-holly underhill	17.54666676123937
-holly van buren	24.124999662240345
-PREHOOK: query: select s, avg(d) over (partition by t order by ts desc rows between 5 preceding and 5 following) from over10k limit 100
+bob ovid	28.053333441416424
+calvin brown	38.73666652043661
+calvin laertes	51.493333180745445
+calvin steinbeck	46.826666514078774
+david falkner	42.81499973932902
+fred nixon	52.26333347956339
+fred zipper	62.97499990463257
+gabriella van buren	55.43666664759318
+gabriella xylophone	49.925000031789146
+jessica laertes	56.32999976476034
+jessica polk	69.13333320617676
+katie king	58.16333293914795
+katie white	54.92333253224691
+luke zipper	57.83333237965902
+mike laertes	61.86999924977621
+nick carson	61.69333299001058
+oscar brown	49.44166628519694
+priscilla zipper	52.25166670481364
+rachel garcia	53.56666787465414
+rachel thompson	54.903334617614746
+sarah falkner	44.27000093460083
+tom johnson	45.01600093841553
+victor ellison	51.80750107765198
+victor van buren	53.71666749318441
+wendy steinbeck	39.869999408721924
+yuri allen	14.779999732971191
+alice miller	51.76333204905192
+bob falkner	47.50333213806152
+bob king	45.58333269755045
+calvin carson	57.253332455952965
+calvin nixon	53.441665967305504
+calvin white	53.85499922434489
+ethan ovid	51.891666094462074
+ethan young	63.52999941507975
+fred king	53.36666615804037
+fred polk	47.83166631062826
+gabriella johnson	44.84166653951009
+gabriella steinbeck	45.1966667175293
+gabriella underhill	51.95500055948893
+holly falkner	50.538333892822266
+holly thompson	47.93333371480306
+irene brown	53.22833442687988
+jessica brown	61.600001653035484
+jessica brown	62.51333491007487
+jessica nixon	60.775001525878906
+jessica robinson	63.08166758219401
+katie davidson	66.04000091552734
+katie xylophone	61.931666692097984
+katie zipper	49.44333283106486
+luke king	43.36166621247927
+luke steinbeck	42.238332599401474
+luke thompson	33.54000013073286
+luke xylophone	37.376666873693466
+nick ellison	35.72333384553591
+oscar davidson	39.27666728695234
+oscar van buren	49.643333752950035
+priscilla brown	39.95166691144308
+priscilla hernandez	42.346666733423866
+priscilla zipper	37.166666746139526
+quinn allen	37.50833328564962
+quinn ovid	41.199999888738
+rachel ovid	44.729999939600624
+rachel ovid	46.558333237965904
+rachel robinson	47.90833361943563
+rachel young	58.40333414077759
+sarah van buren	52.74833424886068
+ulysses johnson	45.21000083287557
+ulysses xylophone	31.506667653719585
+victor underhill	31.98666767279307
+wendy johnson	31.46333380540212
+wendy thompson	24.84999978542328
+xavier davidson	26.82799973487854
+xavier johnson	31.319999754428864
+yuri brown	41.09666633605957
+yuri hernandez	52.85499954223633
+zach young	44.29999923706055
+alice underhill	38.0366666217645
+bob carson	38.7966665327549
+calvin white	51.90833304325739
+ethan ichabod	52.48833360274633
+ethan nixon	46.103333373864494
+holly allen	40.5249999165535
+holly nixon	55.85333355267843
+jessica johnson	64.11166644096375
+jessica ovid	66.54166674613953
+jessica thompson	69.09166725476582
+nick king	68.65833353996277
+oscar carson	82.59166717529297
+priscilla garcia	80.75166702270508
+priscilla hernandez	68.91500091552734
+priscilla polk	53.32166742781798
+priscilla thompson	47.56499997278055
+quinn van buren	43.383333598574005
+rachel davidson	35.253333166241646
+rachel ellison	29.356666321555775
+rachel ichabod	37.651666397849716
+rachel ichabod	41.75999959309896
+rachel polk	49.56333351135254
+sarah falkner	59.53333377838135
+tom hernandez	63.331667264302574
+PREHOOK: query: select s, avg(d) over (partition by t order by s,d desc rows between 5 preceding and 5 following) from over10k limit 100
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over10k
 #### A masked pattern was here ####
-POSTHOOK: query: select s, avg(d) over (partition by t order by ts desc rows between 5 preceding and 5 following) from over10k limit 100
+POSTHOOK: query: select s, avg(d) over (partition by t order by s,d desc rows between 5 preceding and 5 following) from over10k limit 100
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over10k
 #### A masked pattern was here ####
-alice allen	26.85166666666667
-priscilla zipper	26.47857142857143
-oscar miller	29.321250000000003
-jessica johnson	31.596666666666668
-rachel davidson	30.332
-mike xylophone	30.16
-victor robinson	30.48909090909091
-david falkner	30.072727272727274
-alice falkner	31.735454545454548
-victor thompson	34.666363636363634
-irene underhill	30.888181818181817
-calvin white	28.08545454545454
-wendy robinson	30.245454545454546
-luke ichabod	30.201818181818183
-mike allen	26.28818181818182
-sarah zipper	24.572727272727274
-gabriella brown	23.074545454545458
-sarah robinson	21.203636363636367
-oscar garcia	20.433636363636367
-bob falkner	16.83454545454546
-jessica king	14.047272727272725
-rachel thompson	16.774545454545454
-holly polk	20.42727272727273
-wendy quirinius	17.714545454545455
-holly nixon	13.49909090909091
-bob ellison	17.05818181818182
-ulysses steinbeck	21.513636363636365
-yuri xylophone	24.372727272727275
-ulysses carson	27.01090909090909
-zach thompson	27.95909090909091
-david hernandez	31.309090909090912
-tom steinbeck	34.02454545454546
-priscilla laertes	32.46454545454546
-alice king	32.71636363636364
-jessica miller	31.975454545454546
-quinn polk	34.85454545454546
-holly steinbeck	34.307272727272725
-bob ichabod	32.709999999999994
-fred ellison	31.74272727272727
-quinn ellison	31.06363636363636
-priscilla quirinius	31.685454545454547
-ulysses robinson	27.94363636363636
-alice davidson	24.37
-holly underhill	24.76
-tom polk	21.314545454545456
-mike king	23.95909090909091
-calvin ichabod	21.58909090909091
-luke king	20.710000000000004
-bob johnson	20.000000000000004
-bob van buren	20.19
-jessica white	19.713636363636365
-ulysses ellison	18.872727272727275
-xavier garcia	18.97
-zach young	21.62272727272727
-wendy xylophone	21.697272727272725
-mike polk	24.85545454545455
-david garcia	23.35363636363636
-ulysses quirinius	24.449999999999992
-bob underhill	23.74272727272727
-tom hernandez	22.682727272727274
-luke young	22.7
-bob underhill	20.69
-victor hernandez	22.755454545454544
-sarah miller	25.623636363636365
-victor allen	24.8
-xavier ovid	22.758181818181818
-nick robinson	19.535454545454545
-alice king	19.842727272727274
-katie ichabod	19.493636363636366
-ethan underhill	17.997272727272726
-david carson	17.12272727272727
-victor xylophone	16.85545454545455
-oscar johnson	17.233636363636364
-alice xylophone	15.209090909090913
-bob polk	13.514545454545454
-sarah xylophone	15.072727272727274
-oscar johnson	15.853636363636365
-tom hernandez	19.042727272727276
-irene ellison	19.905454545454543
-mike white	20.50181818181818
-irene young	22.430000000000003
-nick nixon	24.43
-ethan steinbeck	23.576666666666668
-luke garcia	25.168750000000003
-holly thompson	27.551428571428573
-oscar davidson	29.75666666666667
-zach johnson	28.561666666666667
-alice nixon	25.732857142857142
-sarah van buren	23.74
-rachel thompson	24.32222222222222
-jessica white	26.415999999999997
-rachel polk	26.687272727272724
-fred ichabod	27.236363636363635
-irene ichabod	24.90909090909091
-fred polk	25.44181818181818
-quinn carson	23.25909090909091
-sarah allen	22.62727272727273
-jessica steinbeck	24.30636363636364
-ethan nixon	25.035454545454545
-jessica zipper	25.474545454545456
-PREHOOK: query: select s, sum(i) over() from over10k limit 100
+alice allen	33.20166666666666
+alice davidson	30.741428571428568
+alice falkner	27.742499999999996
+alice king	26.706666666666663
+alice king	26.306999999999995
+alice xylophone	24.458181818181814
+bob ellison	25.029090909090904
+bob falkner	24.216363636363635
+bob ichabod	20.17363636363637
+bob johnson	16.431818181818183
+bob polk	16.64090909090909
+bob underhill	15.266363636363637
+bob underhill	18.288181818181815
+bob van buren	18.405454545454543
+calvin ichabod	20.903636363636362
+calvin white	22.44818181818182
+david carson	24.329090909090908
+david falkner	25.01181818181818
+david garcia	22.984545454545454
+david hernandez	22.922727272727272
+ethan steinbeck	24.026363636363637
+ethan underhill	25.189090909090908
+fred ellison	27.16
+gabriella brown	25.664545454545454
+holly nixon	25.705454545454543
+holly polk	24.118181818181824
+holly steinbeck	24.490909090909096
+holly thompson	23.376363636363635
+holly underhill	19.453636363636363
+irene ellison	20.37818181818182
+irene underhill	23.51
+irene young	25.371818181818185
+jessica johnson	24.426363636363636
+jessica king	26.38
+jessica miller	23.99545454545455
+jessica white	26.86636363636364
+katie ichabod	28.520909090909093
+luke garcia	26.110909090909093
+luke ichabod	27.41909090909091
+luke king	28.713636363636365
+luke young	30.591818181818187
+mike allen	27.91545454545455
+mike king	25.526363636363637
+mike polk	24.774545454545454
+mike white	25.183636363636364
+mike xylophone	27.508181818181814
+nick nixon	26.225454545454543
+nick robinson	24.344545454545457
+oscar davidson	26.719090909090912
+oscar garcia	27.19636363636364
+oscar johnson	27.082727272727276
+oscar johnson	25.16454545454545
+oscar miller	28.05909090909091
+priscilla laertes	31.737272727272725
+priscilla quirinius	30.353636363636358
+priscilla zipper	27.96181818181818
+quinn ellison	29.406363636363633
+quinn polk	27.267272727272726
+rachel davidson	25.41545454545454
+rachel thompson	23.608181818181823
+sarah miller	21.499090909090913
+sarah robinson	23.40454545454546
+sarah xylophone	26.95727272727273
+sarah zipper	24.83545454545455
+tom hernandez	21.274545454545457
+tom hernandez	20.315454545454546
+tom polk	21.901818181818182
+tom steinbeck	20.772727272727273
+ulysses carson	21.64727272727273
+ulysses ellison	22.960909090909094
+ulysses quirinius	23.025454545454547
+ulysses robinson	23.762727272727275
+ulysses steinbeck	21.08909090909091
+victor allen	16.62818181818182
+victor hernandez	15.74909090909091
+victor robinson	18.19363636363636
+victor thompson	20.811818181818186
+victor xylophone	20.37272727272727
+wendy quirinius	20.816363636363636
+wendy robinson	19.936363636363634
+wendy xylophone	20.270909090909093
+xavier garcia	19.874000000000002
+xavier ovid	19.976666666666667
+yuri xylophone	21.896250000000002
+zach thompson	25.021428571428572
+zach young	27.776666666666667
+alice carson	18.785
+alice nixon	17.58142857142857
+alice underhill	17.072499999999998
+alice underhill	19.146666666666665
+alice xylophone	20.556
+bob falkner	19.116363636363637
+bob king	21.04
+bob ovid	20.85454545454546
+bob van buren	21.988181818181822
+bob xylophone	24.36454545454546
+calvin xylophone	26.912727272727274
+david falkner	27.310000000000002
+david laertes	28.004545454545454
+david miller	28.400909090909092
+PREHOOK: query: select s, sum(i) over(partition by ts order by s) from over10k limit 100
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over10k
 #### A masked pattern was here ####
-POSTHOOK: query: select s, sum(i) over() from over10k limit 100
+POSTHOOK: query: select s, sum(i) over(partition by ts order by s) from over10k limit 100
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over10k
 #### A masked pattern was here ####
-bob davidson	656584379
-alice zipper	656584379
-katie davidson	656584379
-xavier quirinius	656584379
-nick robinson	656584379
-tom hernandez	656584379
-ulysses hernandez	656584379
-priscilla ichabod	656584379
-quinn van buren	656584379
-luke laertes	656584379
-xavier polk	656584379
-zach falkner	656584379
-quinn davidson	656584379
-priscilla van buren	656584379
-fred king	656584379
-calvin ellison	656584379
-sarah garcia	656584379
-zach young	656584379
-david underhill	656584379
-yuri carson	656584379
-ulysses laertes	656584379
-jessica thompson	656584379
-sarah johnson	656584379
-zach ovid	656584379
-victor nixon	656584379
-sarah ellison	656584379
-xavier davidson	656584379
-fred steinbeck	656584379
-tom robinson	656584379
-victor allen	656584379
-luke allen	656584379
-fred zipper	656584379
-alice nixon	656584379
-irene van buren	656584379
-alice laertes	656584379
-quinn davidson	656584379
-rachel ellison	656584379
-tom van buren	656584379
-luke zipper	656584379
-mike carson	656584379
-jessica ellison	656584379
-bob brown	656584379
-zach thompson	656584379
-holly ichabod	656584379
-david polk	656584379
-holly falkner	656584379
-wendy van buren	656584379
-tom falkner	656584379
-xavier thompson	656584379
-fred johnson	656584379
-victor steinbeck	656584379
-irene thompson	656584379
-calvin brown	656584379
-irene underhill	656584379
-calvin davidson	656584379
-luke xylophone	656584379
-fred ichabod	656584379
-victor davidson	656584379
-bob xylophone	656584379
-oscar white	656584379
-irene laertes	656584379
-tom polk	656584379
-calvin garcia	656584379
-mike king	656584379
-ulysses underhill	656584379
-katie hernandez	656584379
-katie miller	656584379
-luke allen	656584379
-nick laertes	656584379
-holly underhill	656584379
-irene falkner	656584379
-oscar quirinius	656584379
-nick allen	656584379
-xavier ichabod	656584379
-zach xylophone	656584379
-jessica zipper	656584379
-alice allen	656584379
-jessica johnson	656584379
-fred steinbeck	656584379
-wendy ovid	656584379
-wendy king	656584379
-holly hernandez	656584379
-mike white	656584379
-priscilla johnson	656584379
-gabriella ovid	656584379
-victor xylophone	656584379
-alice laertes	656584379
-ulysses xylophone	656584379
-yuri nixon	656584379
-xavier johnson	656584379
-fred miller	656584379
-luke garcia	656584379
-oscar ovid	656584379
-calvin falkner	656584379
-luke ellison	656584379
-rachel allen	656584379
-oscar king	656584379
-calvin hernandez	656584379
-nick ichabod	656584379
-bob ovid	656584379
-PREHOOK: query: select f, sum(f) over (order by f range between unbounded preceding and current row) from over10k limit 100
+bob ovid	65748
+calvin brown	131440
+calvin laertes	197097
+calvin steinbeck	262874
+david falkner	328506
+fred nixon	394118
+fred zipper	459719
+gabriella van buren	525334
+gabriella xylophone	591058
+jessica laertes	656771
+jessica polk	722558
+katie king	788310
+katie white	853920
+luke zipper	919543
+mike laertes	985277
+nick carson	1050928
+oscar brown	1116474
+priscilla zipper	1182084
+rachel garcia	1247836
+rachel thompson	1313378
+sarah falkner	1379093
+tom johnson	1444791
+victor ellison	1510421
+victor van buren	1576006
+wendy steinbeck	1641591
+yuri allen	1707256
+alice miller	65581
+bob falkner	131319
+bob king	197015
+calvin carson	262712
+calvin nixon	328407
+calvin white	393960
+ethan ovid	459504
+ethan young	525178
+fred king	590838
+fred polk	656600
+gabriella johnson	722283
+gabriella steinbeck	787886
+gabriella underhill	853497
+holly falkner	919218
+holly thompson	985000
+irene brown	1050757
+jessica brown	1182155
+jessica brown	1182155
+jessica nixon	1247815
+jessica robinson	1313437
+katie davidson	1379172
+katie xylophone	1444746
+katie zipper	1510302
+luke king	1576084
+luke steinbeck	1641724
+luke thompson	1707324
+luke xylophone	1773102
+nick ellison	1838744
+oscar davidson	1904390
+oscar van buren	1969971
+priscilla brown	2035582
+priscilla hernandez	2101353
+priscilla zipper	2166925
+quinn allen	2232487
+quinn ovid	2298060
+rachel ovid	2429366
+rachel ovid	2429366
+rachel robinson	2495140
+rachel young	2560880
+sarah van buren	2626599
+ulysses johnson	2692259
+ulysses xylophone	2757830
+victor underhill	2823401
+wendy johnson	2889058
+wendy thompson	2954831
+xavier davidson	3020367
+xavier johnson	3086050
+yuri brown	3151628
+yuri hernandez	3217338
+zach young	3283046
+alice underhill	65705
+bob carson	131461
+calvin white	197044
+ethan ichabod	262796
+ethan nixon	328501
+holly allen	394248
+holly nixon	459928
+jessica johnson	525664
+jessica ovid	591415
+jessica thompson	657122
+nick king	722691
+oscar carson	788459
+priscilla garcia	854222
+priscilla hernandez	919979
+priscilla polk	985680
+priscilla thompson	1051347
+quinn van buren	1117102
+rachel davidson	1182710
+rachel ellison	1248448
+rachel ichabod	1379923
+rachel ichabod	1379923
+rachel polk	1445518
+sarah falkner	1511234
+tom hernandez	1576947
+PREHOOK: query: select f, sum(f) over (partition by ts order by f range between unbounded preceding and current row) from over10k limit 100
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over10k
 #### A masked pattern was here ####
-POSTHOOK: query: select f, sum(f) over (order by f range between unbounded preceding and current row) from over10k limit 100
+POSTHOOK: query: select f, sum(f) over (partition by ts order by f range between unbounded preceding and current row) from over10k limit 100
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over10k
 #### A masked pattern was here ####
-0.01	0.019999999552965164
-0.01	0.019999999552965164
-0.02	0.07999999821186066
-0.02	0.07999999821186066
-0.02	0.07999999821186066
-0.03	0.13999999687075615
-0.03	0.13999999687075615
-0.04	0.17999999597668648
-0.05	0.22999999672174454
-0.07	0.369999997317791
-0.07	0.369999997317791
-0.08	0.609999991953373
-0.08	0.609999991953373
-0.08	0.609999991953373
-0.09	0.7899999991059303
-0.09	0.7899999991059303
-0.1	0.8900000005960464
-0.11	1.0
-0.12	1.239999994635582
-0.12	1.239999994635582
-0.13	1.3699999898672104
-0.14	1.6499999910593033
-0.14	1.6499999910593033
-0.15	1.9500000029802322
-0.15	1.9500000029802322
-0.16	2.269999995827675
-0.16	2.269999995827675
-0.17	2.439999997615814
-0.18	2.6200000047683716
-0.19	2.810000002384186
-0.2	3.2100000083446503
-0.2	3.2100000083446503
-0.23	3.9000000208616257
-0.23	3.9000000208616257
-0.23	3.9000000208616257
-0.27	4.710000053048134
-0.27	4.710000053048134
-0.27	4.710000053048134
-0.28	5.27000005543232
-0.28	5.27000005543232
-0.29	5.560000047087669
-0.31	5.870000049471855
-0.32	6.190000042319298
-0.35	6.540000036358833
-0.36	7.260000064969063
-0.36	7.260000064969063
-0.37	7.630000069737434
-0.39	8.410000041127205
-0.39	8.410000041127205
-0.42	8.830000028014183
-0.43	10.120000049471855
-0.43	10.120000049471855
-0.43	10.120000049471855
-0.44	11.000000044703484
-0.44	11.000000044703484
-0.48	11.480000033974648
-0.5	12.480000033974648
-0.5	12.480000033974648
-0.51	12.990000024437904
-0.52	14.549999967217445
-0.52	14.549999967217445
-0.52	14.549999967217445
-0.53	15.079999938607216
-0.54	15.619999960064888
-0.55	16.169999971985817
-0.56	16.729999974370003
-0.57	17.299999967217445
-0.58	17.879999950528145
-0.59	18.4699999243021
-0.6	19.06999994814396
-0.61	19.679999962449074
-0.62	21.53999997675419
-0.62	21.53999997675419
-0.62	21.53999997675419
-0.67	22.20999999344349
-0.68	23.570000007748604
-0.68	23.570000007748604
-0.69	24.950000002980232
-0.69	24.950000002980232
-0.71	25.65999998152256
-0.75	26.40999998152256
-0.76	27.169999971985817
-0.77	27.93999995291233
-0.78	28.7199999243021
-0.79	31.089999988675117
-0.79	31.089999988675117
-0.79	31.089999988675117
-0.8	31.890000000596046
-0.82	32.70999999344349
-0.83	33.53999997675419
-0.84	35.2199999243021
-0.84	35.2199999243021
-0.85	36.06999994814396
-0.87	36.93999995291233
-0.88	37.81999994814396
-0.89	38.709999933838844
-0.9	39.609999909996986
-0.91	40.51999993622303
-0.92	41.43999995291233
-0.93	42.36999996006489
+3.17	3.1700000762939453
+10.89	14.0600004196167
+14.54	28.600000381469727
+14.78	43.38000011444092
+17.85	61.230000495910645
+20.61	81.8400011062622
+28.69	110.53000164031982
+29.22	139.75000095367432
+31.17	170.92000102996826
+38.35	209.26999950408936
+38.61	247.88000011444092
+39.48	287.35999965667725
+40.54	327.9000005722046
+41.6	369.4999990463257
+46.08	415.58000087738037
+54.36	469.94000148773193
+56.94	526.8800001144409
+64.96	591.8399991989136
+73.52	665.35999584198
+78.58	743.9399976730347
+81.41	825.350001335144
+84.71	910.0600004196167
+87.43	997.4900007247925
+91.36	1088.850001335144
+92.96	1181.8100004196167
+95.04	1276.850001335144
+0.83	0.8299999833106995
+1.99	2.8199999928474426
+3.73	6.550000011920929
+8.86	15.409999668598175
+10.62	26.029999554157257
+11.32	37.349999248981476
+12.83	50.17999917268753
+14.7	64.87999898195267
+14.96	79.83999902009964
+17.58	97.4199989438057
+19.1	116.51999932527542
+21.01	137.52999955415726
+26.95	164.4800003170967
+27.23	191.70999985933304
+29.07	220.77999955415726
+29.71	250.4899986386299
+31.84	282.3299987912178
+31.94	314.2699993252754
+35.32	349.58999902009964
+37.32	386.90999871492386
+38.5	425.40999871492386
+42.08	467.49000054597855
+44.3	511.7899997830391
+44.66	556.4499996304512
+46.84	603.2899997830391
+48.89	652.1799991726875
+49.64	701.819998562336
+50.28	752.0999973416328
+52.09	804.1899974942207
+53.26	857.4499958157539
+54.09	911.5399959683418
+56.45	967.9899967312813
+56.76	1024.7499950528145
+61.41	1086.1599949002266
+61.88	1148.0399959683418
+63.03	1211.0699947476387
+64.55	1275.6199977993965
+68.62	1344.2400005459785
+76.13	1420.3699977993965
+79.05	1499.4200008511543
+80.43	1579.85000115633
+81.41	1661.2600048184395
+82.85	1744.1100032925606
+83.98	1828.0900066494942
+84.21	1912.3000057339668
+85.55	1997.8500087857246
+87.93	2085.7800090909004
+88.93	2174.710009396076
+94.27	2268.9800060391426
+99.45	2368.430002987385
+0.36	0.36000001430511475
+0.48	0.8400000035762787
+0.79	1.6300000250339508
+1.27	2.9000000059604645
+4.48	7.380000025033951
+9.0	16.38000002503395
+23.27	39.65000048279762
+25.13	64.77999964356422
+25.34	90.11999979615211
+25.91	116.02999964356422
+29.01	145.03999987244606
+30.47	175.50999918580055
+37.95	213.45999994874
+39.3	252.75999918580055
+45.91	298.66999903321266
+52.44	351.10999765992165
+54.1	405.20999613404274
+56.7	461.9099968969822
+58.77	520.6799973547459
+62.09	582.7699975073338
+68.2	650.9699944555759
+71.68	722.6499947607517
+79.46	802.1099938452244
+80.02	882.1299904882908
