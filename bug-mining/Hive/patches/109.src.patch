diff --git a/CHANGES.txt b/CHANGES.txt
index 72f02bb41d..bccc60914b 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -15,6 +15,7 @@ Trunk - unreleased changes
 
   BUG FIXES
 
+    HIVE-387. Use URI from FileSystem Object instead of from HADOOPFS directly
     HIVE-381. Fix JDBC HiveResultSet's next function.
     (Kim P via namit)
 
diff --git a/metastore/src/java/org/apache/hadoop/hive/metastore/Warehouse.java b/metastore/src/java/org/apache/hadoop/hive/metastore/Warehouse.java
index f2c683d846..5c6b18dc04 100755
--- a/metastore/src/java/org/apache/hadoop/hive/metastore/Warehouse.java
+++ b/metastore/src/java/org/apache/hadoop/hive/metastore/Warehouse.java
@@ -54,13 +54,16 @@ public Warehouse(Configuration conf) throws MetaException {
     }
     whRoot = new Path(whRootString);
     URI uri = whRoot.toUri();
-    // if the METASTOREWAREHOUSE value doesn't have schema and authority specified then inherit
-    // from fs.default.name in hadoop-site.xml 
-    if ((uri.getScheme() == null) && (uri.getAuthority() == null)) {
-      whRoot = new Path(HiveConf.getVar(conf, HiveConf.ConfVars.HADOOPFS), whRootString);
-    }
+
+    // if the METASTOREWAREHOUSE value does not specify the schema and the authority
+    // then use the default file system as specified by the Configuration
     try {
-      fs  = whRoot.getFileSystem(conf);
+      if ((uri.getScheme() == null) && (uri.getAuthority() == null)) {
+        fs = FileSystem.get(conf);
+        whRoot = new Path(fs.getUri().toString(), whRootString);
+      } else {
+        fs  = whRoot.getFileSystem(conf);
+      }
     } catch (IOException e) {
       MetaStoreUtils.logAndThrowMetaException(e);
     }
