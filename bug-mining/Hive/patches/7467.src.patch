diff --git a/ql/src/java/org/apache/hadoop/hive/ql/Driver.java b/ql/src/java/org/apache/hadoop/hive/ql/Driver.java
index 48ebc4f870..b2c36f18e7 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/Driver.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/Driver.java
@@ -1103,7 +1103,10 @@ public void destroy() {
     } finally {
       driverState.unlock();
     }
-    if (!hiveLocks.isEmpty()) {
+    boolean isTxnOpen = driverContext != null
+        && driverContext.getTxnManager() != null
+        && driverContext.getTxnManager().isTxnOpen();
+    if (!hiveLocks.isEmpty() || isTxnOpen) {
       try {
         releaseLocksAndCommitOrRollback(false);
       } catch (LockException e) {
