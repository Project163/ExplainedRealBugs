diff --git a/CHANGES.txt b/CHANGES.txt
index 96b2ca514d..389c7672f9 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -430,6 +430,9 @@ Trunk - Unreleased
     HIVE-690. Fix script operator timeout bug
     (Zheng Shao via namit)
 
+    HIVE-697. GroupByOperator's initialization calls GenericUDAF.newAggregation before GenericUDAF.init
+    (Zheng Shao via namit)
+
 Release 0.3.1 - Unreleased
 
   INCOMPATIBLE CHANGES
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/GroupByOperator.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/GroupByOperator.java
index 5b468c81d2..1e01aed105 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/GroupByOperator.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/GroupByOperator.java
@@ -196,6 +196,18 @@ protected void initializeOp(Configuration hconf) throws HiveException {
       aggregationEvaluators[i] = agg.createGenericUDAFEvaluator();
     }
 
+    // init objectInspectors
+    int totalFields = keyFields.length + aggregationEvaluators.length;
+    objectInspectors = new ArrayList<ObjectInspector>(totalFields);
+    for(int i=0; i<keyFields.length; i++) {
+      objectInspectors.add(null);
+    }
+    for(int i=0; i<aggregationEvaluators.length; i++) {
+      ObjectInspector roi = aggregationEvaluators[i].init(
+          conf.getAggregators().get(i).getMode(), aggregationParameterObjectInspectors[i]);
+      objectInspectors.add(roi);
+    }
+    
     aggregationsParametersLastInvoke = new Object[conf.getAggregators().size()][];
     if (conf.getMode() != groupByDesc.Mode.HASH) {
       aggregations = newAggregations();
@@ -216,18 +228,6 @@ protected void initializeOp(Configuration hconf) throws HiveException {
         keysCurrentGroup = new HashSet<ArrayList<Object>>();
     }
 
-    // init objectInspectors
-    int totalFields = keyFields.length + aggregationEvaluators.length;
-    objectInspectors = new ArrayList<ObjectInspector>(totalFields);
-    for(int i=0; i<keyFields.length; i++) {
-      objectInspectors.add(null);
-    }
-    for(int i=0; i<aggregationEvaluators.length; i++) {
-      ObjectInspector roi = aggregationEvaluators[i].init(
-          conf.getAggregators().get(i).getMode(), aggregationParameterObjectInspectors[i]);
-      objectInspectors.add(roi);
-    }
-
     fieldNames = conf.getOutputColumnNames();
 
     for (int i = 0; i < keyFields.length; i++) {
