diff --git a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/SharedWorkOptimizer.java b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/SharedWorkOptimizer.java
index b206aced4e..01d4f57691 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/SharedWorkOptimizer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/SharedWorkOptimizer.java
@@ -33,6 +33,7 @@
 import java.util.Map;
 import java.util.Map.Entry;
 import java.util.Set;
+import java.util.TreeMap;
 
 import org.apache.commons.lang.StringUtils;
 import org.apache.hadoop.hive.ql.exec.AppMasterEventOperator;
@@ -362,7 +363,9 @@ private static void gatherDPPTableScanOps(
   private static Multimap<String, TableScanOperator> splitTableScanOpsByTable(
           ParseContext pctx) {
     Multimap<String, TableScanOperator> tableNameToOps = ArrayListMultimap.create();
-    for (Entry<String, TableScanOperator> e : pctx.getTopOps().entrySet()) {
+    // Sort by operator ID so we get deterministic results
+    Map<String, TableScanOperator> sortedTopOps = new TreeMap<>(pctx.getTopOps());
+    for (Entry<String, TableScanOperator> e : sortedTopOps.entrySet()) {
       TableScanOperator tsOp = e.getValue();
       tableNameToOps.put(
               tsOp.getConf().getTableMetadata().getDbName() + "."
diff --git a/ql/src/test/results/clientpositive/llap/correlationoptimizer6.q.out b/ql/src/test/results/clientpositive/llap/correlationoptimizer6.q.out
index a47a7d3719..d94dda26fb 100644
--- a/ql/src/test/results/clientpositive/llap/correlationoptimizer6.q.out
+++ b/ql/src/test/results/clientpositive/llap/correlationoptimizer6.q.out
@@ -1785,52 +1785,52 @@ STAGE PLANS:
     Tez
 #### A masked pattern was here ####
       Edges:
-        Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 5 (SIMPLE_EDGE), Reducer 4 (ONE_TO_ONE_EDGE)
-        Reducer 3 <- Map 1 (SIMPLE_EDGE), Map 6 (SIMPLE_EDGE)
-        Reducer 4 <- Reducer 3 (SIMPLE_EDGE)
+        Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 3 (SIMPLE_EDGE), Reducer 5 (ONE_TO_ONE_EDGE)
+        Reducer 4 <- Map 3 (SIMPLE_EDGE), Map 6 (SIMPLE_EDGE)
+        Reducer 5 <- Reducer 4 (SIMPLE_EDGE)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
             Map Operator Tree:
                 TableScan
-                  alias: zz
-                  Statistics: Num rows: 500 Data size: 43500 Basic stats: COMPLETE Column stats: COMPLETE
+                  alias: xx
+                  Statistics: Num rows: 25 Data size: 2150 Basic stats: COMPLETE Column stats: COMPLETE
                   Filter Operator
                     predicate: key is not null (type: boolean)
-                    Statistics: Num rows: 500 Data size: 43500 Basic stats: COMPLETE Column stats: COMPLETE
+                    Statistics: Num rows: 25 Data size: 2150 Basic stats: COMPLETE Column stats: COMPLETE
                     Select Operator
                       expressions: key (type: string)
                       outputColumnNames: _col0
-                      Statistics: Num rows: 500 Data size: 43500 Basic stats: COMPLETE Column stats: COMPLETE
-                      Reduce Output Operator
-                        key expressions: _col0 (type: string)
-                        sort order: +
-                        Map-reduce partition columns: _col0 (type: string)
-                        Statistics: Num rows: 500 Data size: 43500 Basic stats: COMPLETE Column stats: COMPLETE
+                      Statistics: Num rows: 25 Data size: 2150 Basic stats: COMPLETE Column stats: COMPLETE
                       Reduce Output Operator
                         key expressions: _col0 (type: string)
                         sort order: +
                         Map-reduce partition columns: _col0 (type: string)
-                        Statistics: Num rows: 500 Data size: 43500 Basic stats: COMPLETE Column stats: COMPLETE
+                        Statistics: Num rows: 25 Data size: 2150 Basic stats: COMPLETE Column stats: COMPLETE
             Execution mode: llap
             LLAP IO: no inputs
-        Map 5 
+        Map 3 
             Map Operator Tree:
                 TableScan
-                  alias: xx
-                  Statistics: Num rows: 25 Data size: 2150 Basic stats: COMPLETE Column stats: COMPLETE
+                  alias: x
+                  Statistics: Num rows: 500 Data size: 43500 Basic stats: COMPLETE Column stats: COMPLETE
                   Filter Operator
                     predicate: key is not null (type: boolean)
-                    Statistics: Num rows: 25 Data size: 2150 Basic stats: COMPLETE Column stats: COMPLETE
+                    Statistics: Num rows: 500 Data size: 43500 Basic stats: COMPLETE Column stats: COMPLETE
                     Select Operator
                       expressions: key (type: string)
                       outputColumnNames: _col0
-                      Statistics: Num rows: 25 Data size: 2150 Basic stats: COMPLETE Column stats: COMPLETE
+                      Statistics: Num rows: 500 Data size: 43500 Basic stats: COMPLETE Column stats: COMPLETE
                       Reduce Output Operator
                         key expressions: _col0 (type: string)
                         sort order: +
                         Map-reduce partition columns: _col0 (type: string)
-                        Statistics: Num rows: 25 Data size: 2150 Basic stats: COMPLETE Column stats: COMPLETE
+                        Statistics: Num rows: 500 Data size: 43500 Basic stats: COMPLETE Column stats: COMPLETE
+                      Reduce Output Operator
+                        key expressions: _col0 (type: string)
+                        sort order: +
+                        Map-reduce partition columns: _col0 (type: string)
+                        Statistics: Num rows: 500 Data size: 43500 Basic stats: COMPLETE Column stats: COMPLETE
             Execution mode: llap
             LLAP IO: no inputs
         Map 6 
@@ -1876,7 +1876,7 @@ STAGE PLANS:
                         input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                         output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                         serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-        Reducer 3 
+        Reducer 4 
             Execution mode: llap
             Reduce Operator Tree:
               Merge Join Operator
@@ -1899,7 +1899,7 @@ STAGE PLANS:
                     Map-reduce partition columns: _col0 (type: string)
                     Statistics: Num rows: 309 Data size: 29355 Basic stats: COMPLETE Column stats: COMPLETE
                     value expressions: _col1 (type: bigint)
-        Reducer 4 
+        Reducer 5 
             Execution mode: llap
             Reduce Operator Tree:
               Group By Operator
@@ -2003,52 +2003,52 @@ STAGE PLANS:
     Tez
 #### A masked pattern was here ####
       Edges:
-        Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 5 (SIMPLE_EDGE), Reducer 4 (ONE_TO_ONE_EDGE)
-        Reducer 3 <- Map 1 (SIMPLE_EDGE), Map 6 (SIMPLE_EDGE)
-        Reducer 4 <- Reducer 3 (SIMPLE_EDGE)
+        Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 3 (SIMPLE_EDGE), Reducer 5 (ONE_TO_ONE_EDGE)
+        Reducer 4 <- Map 3 (SIMPLE_EDGE), Map 6 (SIMPLE_EDGE)
+        Reducer 5 <- Reducer 4 (SIMPLE_EDGE)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
             Map Operator Tree:
                 TableScan
-                  alias: zz
-                  Statistics: Num rows: 500 Data size: 43500 Basic stats: COMPLETE Column stats: COMPLETE
+                  alias: xx
+                  Statistics: Num rows: 25 Data size: 2150 Basic stats: COMPLETE Column stats: COMPLETE
                   Filter Operator
                     predicate: key is not null (type: boolean)
-                    Statistics: Num rows: 500 Data size: 43500 Basic stats: COMPLETE Column stats: COMPLETE
+                    Statistics: Num rows: 25 Data size: 2150 Basic stats: COMPLETE Column stats: COMPLETE
                     Select Operator
                       expressions: key (type: string)
                       outputColumnNames: _col0
-                      Statistics: Num rows: 500 Data size: 43500 Basic stats: COMPLETE Column stats: COMPLETE
-                      Reduce Output Operator
-                        key expressions: _col0 (type: string)
-                        sort order: +
-                        Map-reduce partition columns: _col0 (type: string)
-                        Statistics: Num rows: 500 Data size: 43500 Basic stats: COMPLETE Column stats: COMPLETE
+                      Statistics: Num rows: 25 Data size: 2150 Basic stats: COMPLETE Column stats: COMPLETE
                       Reduce Output Operator
                         key expressions: _col0 (type: string)
                         sort order: +
                         Map-reduce partition columns: _col0 (type: string)
-                        Statistics: Num rows: 500 Data size: 43500 Basic stats: COMPLETE Column stats: COMPLETE
+                        Statistics: Num rows: 25 Data size: 2150 Basic stats: COMPLETE Column stats: COMPLETE
             Execution mode: llap
             LLAP IO: no inputs
-        Map 5 
+        Map 3 
             Map Operator Tree:
                 TableScan
-                  alias: xx
-                  Statistics: Num rows: 25 Data size: 2150 Basic stats: COMPLETE Column stats: COMPLETE
+                  alias: x
+                  Statistics: Num rows: 500 Data size: 43500 Basic stats: COMPLETE Column stats: COMPLETE
                   Filter Operator
                     predicate: key is not null (type: boolean)
-                    Statistics: Num rows: 25 Data size: 2150 Basic stats: COMPLETE Column stats: COMPLETE
+                    Statistics: Num rows: 500 Data size: 43500 Basic stats: COMPLETE Column stats: COMPLETE
                     Select Operator
                       expressions: key (type: string)
                       outputColumnNames: _col0
-                      Statistics: Num rows: 25 Data size: 2150 Basic stats: COMPLETE Column stats: COMPLETE
+                      Statistics: Num rows: 500 Data size: 43500 Basic stats: COMPLETE Column stats: COMPLETE
                       Reduce Output Operator
                         key expressions: _col0 (type: string)
                         sort order: +
                         Map-reduce partition columns: _col0 (type: string)
-                        Statistics: Num rows: 25 Data size: 2150 Basic stats: COMPLETE Column stats: COMPLETE
+                        Statistics: Num rows: 500 Data size: 43500 Basic stats: COMPLETE Column stats: COMPLETE
+                      Reduce Output Operator
+                        key expressions: _col0 (type: string)
+                        sort order: +
+                        Map-reduce partition columns: _col0 (type: string)
+                        Statistics: Num rows: 500 Data size: 43500 Basic stats: COMPLETE Column stats: COMPLETE
             Execution mode: llap
             LLAP IO: no inputs
         Map 6 
@@ -2094,7 +2094,7 @@ STAGE PLANS:
                         input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                         output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                         serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-        Reducer 3 
+        Reducer 4 
             Execution mode: llap
             Reduce Operator Tree:
               Merge Join Operator
@@ -2117,7 +2117,7 @@ STAGE PLANS:
                     Map-reduce partition columns: _col0 (type: string)
                     Statistics: Num rows: 309 Data size: 29355 Basic stats: COMPLETE Column stats: COMPLETE
                     value expressions: _col1 (type: bigint)
-        Reducer 4 
+        Reducer 5 
             Execution mode: llap
             Reduce Operator Tree:
               Group By Operator
diff --git a/ql/src/test/results/clientpositive/llap/limit_join_transpose.q.out b/ql/src/test/results/clientpositive/llap/limit_join_transpose.q.out
index 61fba3dd56..4dd7432ac5 100644
--- a/ql/src/test/results/clientpositive/llap/limit_join_transpose.q.out
+++ b/ql/src/test/results/clientpositive/llap/limit_join_transpose.q.out
@@ -340,16 +340,26 @@ STAGE PLANS:
     Tez
 #### A masked pattern was here ####
       Edges:
-        Reducer 2 <- Map 1 (CUSTOM_SIMPLE_EDGE)
-        Reducer 3 <- Map 1 (SIMPLE_EDGE), Reducer 2 (SIMPLE_EDGE)
+        Reducer 2 <- Map 1 (SIMPLE_EDGE), Reducer 4 (SIMPLE_EDGE)
+        Reducer 3 <- Map 1 (CUSTOM_SIMPLE_EDGE)
         Reducer 4 <- Map 1 (SIMPLE_EDGE), Reducer 3 (SIMPLE_EDGE)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
             Map Operator Tree:
                 TableScan
-                  alias: src2
+                  alias: src1
                   Statistics: Num rows: 500 Data size: 89000 Basic stats: COMPLETE Column stats: COMPLETE
+                  Select Operator
+                    expressions: key (type: string), value (type: string)
+                    outputColumnNames: _col0, _col1
+                    Statistics: Num rows: 500 Data size: 89000 Basic stats: COMPLETE Column stats: COMPLETE
+                    Reduce Output Operator
+                      key expressions: _col0 (type: string)
+                      sort order: +
+                      Map-reduce partition columns: _col0 (type: string)
+                      Statistics: Num rows: 500 Data size: 89000 Basic stats: COMPLETE Column stats: COMPLETE
+                      value expressions: _col1 (type: string)
                   Select Operator
                     expressions: key (type: string), value (type: string)
                     outputColumnNames: _col0, _col1
@@ -372,19 +382,34 @@ STAGE PLANS:
                       Map-reduce partition columns: _col1 (type: string)
                       Statistics: Num rows: 500 Data size: 89000 Basic stats: COMPLETE Column stats: COMPLETE
                       value expressions: _col0 (type: string)
-                  Select Operator
-                    expressions: key (type: string), value (type: string)
-                    outputColumnNames: _col0, _col1
-                    Statistics: Num rows: 500 Data size: 89000 Basic stats: COMPLETE Column stats: COMPLETE
-                    Reduce Output Operator
-                      key expressions: _col0 (type: string)
-                      sort order: +
-                      Map-reduce partition columns: _col0 (type: string)
-                      Statistics: Num rows: 500 Data size: 89000 Basic stats: COMPLETE Column stats: COMPLETE
-                      value expressions: _col1 (type: string)
             Execution mode: llap
             LLAP IO: no inputs
         Reducer 2 
+            Execution mode: llap
+            Reduce Operator Tree:
+              Merge Join Operator
+                condition map:
+                     Left Outer Join 0 to 1
+                keys:
+                  0 _col2 (type: string)
+                  1 _col0 (type: string)
+                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
+                Statistics: Num rows: 1 Data size: 534 Basic stats: COMPLETE Column stats: COMPLETE
+                Select Operator
+                  expressions: _col4 (type: string), _col5 (type: string), _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string)
+                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
+                  Statistics: Num rows: 1 Data size: 534 Basic stats: COMPLETE Column stats: COMPLETE
+                  Limit
+                    Number of rows: 1
+                    Statistics: Num rows: 1 Data size: 534 Basic stats: COMPLETE Column stats: COMPLETE
+                    File Output Operator
+                      compressed: false
+                      Statistics: Num rows: 1 Data size: 534 Basic stats: COMPLETE Column stats: COMPLETE
+                      table:
+                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+        Reducer 3 
             Execution mode: llap
             Reduce Operator Tree:
               Select Operator
@@ -400,7 +425,7 @@ STAGE PLANS:
                     Map-reduce partition columns: _col1 (type: string)
                     Statistics: Num rows: 1 Data size: 178 Basic stats: COMPLETE Column stats: COMPLETE
                     value expressions: _col0 (type: string)
-        Reducer 3 
+        Reducer 4 
             Execution mode: llap
             Reduce Operator Tree:
               Merge Join Operator
@@ -417,31 +442,6 @@ STAGE PLANS:
                   Map-reduce partition columns: _col2 (type: string)
                   Statistics: Num rows: 1 Data size: 356 Basic stats: COMPLETE Column stats: COMPLETE
                   value expressions: _col0 (type: string), _col1 (type: string), _col3 (type: string)
-        Reducer 4 
-            Execution mode: llap
-            Reduce Operator Tree:
-              Merge Join Operator
-                condition map:
-                     Left Outer Join 0 to 1
-                keys:
-                  0 _col2 (type: string)
-                  1 _col0 (type: string)
-                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
-                Statistics: Num rows: 1 Data size: 534 Basic stats: COMPLETE Column stats: COMPLETE
-                Select Operator
-                  expressions: _col4 (type: string), _col5 (type: string), _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string)
-                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
-                  Statistics: Num rows: 1 Data size: 534 Basic stats: COMPLETE Column stats: COMPLETE
-                  Limit
-                    Number of rows: 1
-                    Statistics: Num rows: 1 Data size: 534 Basic stats: COMPLETE Column stats: COMPLETE
-                    File Output Operator
-                      compressed: false
-                      Statistics: Num rows: 1 Data size: 534 Basic stats: COMPLETE Column stats: COMPLETE
-                      table:
-                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
-                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
-                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
 
   Stage: Stage-0
     Fetch Operator
@@ -1232,16 +1232,26 @@ STAGE PLANS:
     Tez
 #### A masked pattern was here ####
       Edges:
-        Reducer 2 <- Map 1 (CUSTOM_SIMPLE_EDGE)
-        Reducer 3 <- Map 1 (SIMPLE_EDGE), Reducer 2 (SIMPLE_EDGE)
+        Reducer 2 <- Map 1 (SIMPLE_EDGE), Reducer 4 (SIMPLE_EDGE)
+        Reducer 3 <- Map 1 (CUSTOM_SIMPLE_EDGE)
         Reducer 4 <- Map 1 (SIMPLE_EDGE), Reducer 3 (SIMPLE_EDGE)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
             Map Operator Tree:
                 TableScan
-                  alias: src2
+                  alias: src1
                   Statistics: Num rows: 500 Data size: 89000 Basic stats: COMPLETE Column stats: COMPLETE
+                  Select Operator
+                    expressions: key (type: string), value (type: string)
+                    outputColumnNames: _col0, _col1
+                    Statistics: Num rows: 500 Data size: 89000 Basic stats: COMPLETE Column stats: COMPLETE
+                    Reduce Output Operator
+                      key expressions: _col0 (type: string)
+                      sort order: +
+                      Map-reduce partition columns: _col0 (type: string)
+                      Statistics: Num rows: 500 Data size: 89000 Basic stats: COMPLETE Column stats: COMPLETE
+                      value expressions: _col1 (type: string)
                   Select Operator
                     expressions: key (type: string), value (type: string)
                     outputColumnNames: _col0, _col1
@@ -1265,19 +1275,35 @@ STAGE PLANS:
                       Map-reduce partition columns: _col1 (type: string)
                       Statistics: Num rows: 500 Data size: 89000 Basic stats: COMPLETE Column stats: COMPLETE
                       value expressions: _col0 (type: string)
-                  Select Operator
-                    expressions: key (type: string), value (type: string)
-                    outputColumnNames: _col0, _col1
-                    Statistics: Num rows: 500 Data size: 89000 Basic stats: COMPLETE Column stats: COMPLETE
-                    Reduce Output Operator
-                      key expressions: _col0 (type: string)
-                      sort order: +
-                      Map-reduce partition columns: _col0 (type: string)
-                      Statistics: Num rows: 500 Data size: 89000 Basic stats: COMPLETE Column stats: COMPLETE
-                      value expressions: _col1 (type: string)
             Execution mode: llap
             LLAP IO: no inputs
         Reducer 2 
+            Execution mode: llap
+            Reduce Operator Tree:
+              Merge Join Operator
+                condition map:
+                     Left Outer Join 0 to 1
+                keys:
+                  0 _col2 (type: string)
+                  1 _col0 (type: string)
+                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
+                Statistics: Num rows: 1 Data size: 534 Basic stats: COMPLETE Column stats: COMPLETE
+                Select Operator
+                  expressions: _col4 (type: string), _col5 (type: string), _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string)
+                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
+                  Statistics: Num rows: 1 Data size: 534 Basic stats: COMPLETE Column stats: COMPLETE
+                  Limit
+                    Number of rows: 1
+                    Offset of rows: 1
+                    Statistics: Num rows: 1 Data size: 534 Basic stats: COMPLETE Column stats: COMPLETE
+                    File Output Operator
+                      compressed: false
+                      Statistics: Num rows: 1 Data size: 534 Basic stats: COMPLETE Column stats: COMPLETE
+                      table:
+                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+        Reducer 3 
             Execution mode: llap
             Reduce Operator Tree:
               Select Operator
@@ -1294,7 +1320,7 @@ STAGE PLANS:
                     Map-reduce partition columns: _col1 (type: string)
                     Statistics: Num rows: 1 Data size: 178 Basic stats: COMPLETE Column stats: COMPLETE
                     value expressions: _col0 (type: string)
-        Reducer 3 
+        Reducer 4 
             Execution mode: llap
             Reduce Operator Tree:
               Merge Join Operator
@@ -1311,32 +1337,6 @@ STAGE PLANS:
                   Map-reduce partition columns: _col2 (type: string)
                   Statistics: Num rows: 1 Data size: 356 Basic stats: COMPLETE Column stats: COMPLETE
                   value expressions: _col0 (type: string), _col1 (type: string), _col3 (type: string)
-        Reducer 4 
-            Execution mode: llap
-            Reduce Operator Tree:
-              Merge Join Operator
-                condition map:
-                     Left Outer Join 0 to 1
-                keys:
-                  0 _col2 (type: string)
-                  1 _col0 (type: string)
-                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
-                Statistics: Num rows: 1 Data size: 534 Basic stats: COMPLETE Column stats: COMPLETE
-                Select Operator
-                  expressions: _col4 (type: string), _col5 (type: string), _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string)
-                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
-                  Statistics: Num rows: 1 Data size: 534 Basic stats: COMPLETE Column stats: COMPLETE
-                  Limit
-                    Number of rows: 1
-                    Offset of rows: 1
-                    Statistics: Num rows: 1 Data size: 534 Basic stats: COMPLETE Column stats: COMPLETE
-                    File Output Operator
-                      compressed: false
-                      Statistics: Num rows: 1 Data size: 534 Basic stats: COMPLETE Column stats: COMPLETE
-                      table:
-                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
-                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
-                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
 
   Stage: Stage-0
     Fetch Operator
diff --git a/ql/src/test/results/clientpositive/perf/query10.q.out b/ql/src/test/results/clientpositive/perf/query10.q.out
index 7793d523a6..e300561101 100644
--- a/ql/src/test/results/clientpositive/perf/query10.q.out
+++ b/ql/src/test/results/clientpositive/perf/query10.q.out
@@ -117,16 +117,16 @@ POSTHOOK: type: QUERY
 Plan optimized by CBO.
 
 Vertex dependency in root stage
-Reducer 11 <- Map 10 (SIMPLE_EDGE), Map 13 (SIMPLE_EDGE)
+Reducer 11 <- Map 10 (SIMPLE_EDGE), Map 16 (SIMPLE_EDGE)
 Reducer 12 <- Reducer 11 (SIMPLE_EDGE)
-Reducer 14 <- Map 13 (SIMPLE_EDGE), Map 18 (SIMPLE_EDGE)
+Reducer 14 <- Map 13 (SIMPLE_EDGE), Map 16 (SIMPLE_EDGE)
 Reducer 15 <- Reducer 14 (SIMPLE_EDGE)
-Reducer 16 <- Map 13 (SIMPLE_EDGE), Map 19 (SIMPLE_EDGE)
-Reducer 17 <- Reducer 16 (SIMPLE_EDGE)
+Reducer 17 <- Map 16 (SIMPLE_EDGE), Map 19 (SIMPLE_EDGE)
+Reducer 18 <- Reducer 17 (SIMPLE_EDGE)
 Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 8 (SIMPLE_EDGE)
 Reducer 3 <- Map 9 (SIMPLE_EDGE), Reducer 2 (SIMPLE_EDGE)
 Reducer 4 <- Reducer 12 (ONE_TO_ONE_EDGE), Reducer 15 (ONE_TO_ONE_EDGE), Reducer 3 (SIMPLE_EDGE)
-Reducer 5 <- Reducer 17 (ONE_TO_ONE_EDGE), Reducer 4 (SIMPLE_EDGE)
+Reducer 5 <- Reducer 18 (ONE_TO_ONE_EDGE), Reducer 4 (SIMPLE_EDGE)
 Reducer 6 <- Reducer 5 (SIMPLE_EDGE)
 Reducer 7 <- Reducer 6 (SIMPLE_EDGE)
 
@@ -157,28 +157,28 @@ Stage-0
                           predicate:(_col16 is not null or _col18 is not null)
                           Merge Join Operator [MERGEJOIN_112] (rows=766650239 width=88)
                             Conds:RS_62._col0=RS_63._col0(Left Outer),Output:["_col6","_col7","_col8","_col9","_col10","_col11","_col12","_col13","_col16","_col18"]
-                          <-Reducer 17 [ONE_TO_ONE_EDGE]
+                          <-Reducer 18 [ONE_TO_ONE_EDGE]
                             FORWARD [RS_63]
                               PartitionCols:_col0
                               Select Operator [SEL_61] (rows=158394413 width=135)
                                 Output:["_col0","_col1"]
                                 Group By Operator [GBY_60] (rows=158394413 width=135)
                                   Output:["_col0"],keys:KEY._col0
-                                <-Reducer 16 [SIMPLE_EDGE]
+                                <-Reducer 17 [SIMPLE_EDGE]
                                   SHUFFLE [RS_59]
                                     PartitionCols:_col0
                                     Group By Operator [GBY_58] (rows=316788826 width=135)
                                       Output:["_col0"],keys:_col1
                                       Merge Join Operator [MERGEJOIN_110] (rows=316788826 width=135)
                                         Conds:RS_54._col0=RS_55._col0(Inner),Output:["_col1"]
-                                      <-Map 13 [SIMPLE_EDGE]
+                                      <-Map 16 [SIMPLE_EDGE]
                                         SHUFFLE [RS_55]
                                           PartitionCols:_col0
-                                          Select Operator [SEL_14] (rows=4058 width=1119)
+                                          Select Operator [SEL_28] (rows=4058 width=1119)
                                             Output:["_col0"]
-                                            Filter Operator [FIL_101] (rows=4058 width=1119)
+                                            Filter Operator [FIL_103] (rows=4058 width=1119)
                                               predicate:((d_year = 2002) and d_moy BETWEEN 4 AND 7 and d_date_sk is not null)
-                                              TableScan [TS_12] (rows=73049 width=1119)
+                                              TableScan [TS_26] (rows=73049 width=1119)
                                                 default@date_dim,date_dim,Tbl:COMPLETE,Col:NONE,Output:["d_date_sk","d_year","d_moy"]
                                       <-Map 19 [SIMPLE_EDGE]
                                         SHUFFLE [RS_54]
@@ -210,10 +210,10 @@ Stage-0
                                             Output:["_col0"],keys:_col1
                                             Merge Join Operator [MERGEJOIN_108] (rows=158402938 width=135)
                                               Conds:RS_15._col0=RS_16._col0(Inner),Output:["_col1"]
-                                            <-Map 13 [SIMPLE_EDGE]
+                                            <-Map 16 [SIMPLE_EDGE]
                                               SHUFFLE [RS_16]
                                                 PartitionCols:_col0
-                                                 Please refer to the previous Select Operator [SEL_14]
+                                                 Please refer to the previous Select Operator [SEL_28]
                                             <-Map 10 [SIMPLE_EDGE]
                                               SHUFFLE [RS_15]
                                                 PartitionCols:_col0
@@ -235,11 +235,11 @@ Stage-0
                                           Output:["_col0"],keys:_col1
                                           Merge Join Operator [MERGEJOIN_109] (rows=633595212 width=88)
                                             Conds:RS_29._col0=RS_30._col0(Inner),Output:["_col1"]
-                                          <-Map 13 [SIMPLE_EDGE]
+                                          <-Map 16 [SIMPLE_EDGE]
                                             SHUFFLE [RS_30]
                                               PartitionCols:_col0
-                                               Please refer to the previous Select Operator [SEL_14]
-                                          <-Map 18 [SIMPLE_EDGE]
+                                               Please refer to the previous Select Operator [SEL_28]
+                                          <-Map 13 [SIMPLE_EDGE]
                                             SHUFFLE [RS_29]
                                               PartitionCols:_col0
                                               Select Operator [SEL_25] (rows=575995635 width=88)
diff --git a/ql/src/test/results/clientpositive/perf/query11.q.out b/ql/src/test/results/clientpositive/perf/query11.q.out
index 11a4a6be71..182aa74521 100644
--- a/ql/src/test/results/clientpositive/perf/query11.q.out
+++ b/ql/src/test/results/clientpositive/perf/query11.q.out
@@ -149,19 +149,19 @@ POSTHOOK: type: QUERY
 Plan optimized by CBO.
 
 Vertex dependency in root stage
-Reducer 11 <- Map 10 (SIMPLE_EDGE), Map 18 (SIMPLE_EDGE)
-Reducer 12 <- Map 17 (SIMPLE_EDGE), Reducer 11 (SIMPLE_EDGE)
+Reducer 11 <- Map 10 (SIMPLE_EDGE), Map 17 (SIMPLE_EDGE)
+Reducer 12 <- Map 18 (SIMPLE_EDGE), Reducer 11 (SIMPLE_EDGE)
 Reducer 13 <- Reducer 12 (SIMPLE_EDGE)
-Reducer 14 <- Map 10 (SIMPLE_EDGE), Map 18 (SIMPLE_EDGE)
-Reducer 15 <- Map 17 (SIMPLE_EDGE), Reducer 14 (SIMPLE_EDGE)
+Reducer 14 <- Map 10 (SIMPLE_EDGE), Map 17 (SIMPLE_EDGE)
+Reducer 15 <- Map 18 (SIMPLE_EDGE), Reducer 14 (SIMPLE_EDGE)
 Reducer 16 <- Reducer 15 (SIMPLE_EDGE)
-Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 10 (SIMPLE_EDGE)
-Reducer 3 <- Map 17 (SIMPLE_EDGE), Reducer 2 (SIMPLE_EDGE)
+Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 17 (SIMPLE_EDGE)
+Reducer 3 <- Map 18 (SIMPLE_EDGE), Reducer 2 (SIMPLE_EDGE)
 Reducer 4 <- Reducer 3 (SIMPLE_EDGE)
 Reducer 5 <- Reducer 13 (SIMPLE_EDGE), Reducer 16 (SIMPLE_EDGE), Reducer 4 (SIMPLE_EDGE), Reducer 9 (SIMPLE_EDGE)
 Reducer 6 <- Reducer 5 (SIMPLE_EDGE)
-Reducer 7 <- Map 1 (SIMPLE_EDGE), Map 10 (SIMPLE_EDGE)
-Reducer 8 <- Map 17 (SIMPLE_EDGE), Reducer 7 (SIMPLE_EDGE)
+Reducer 7 <- Map 1 (SIMPLE_EDGE), Map 17 (SIMPLE_EDGE)
+Reducer 8 <- Map 18 (SIMPLE_EDGE), Reducer 7 (SIMPLE_EDGE)
 Reducer 9 <- Reducer 8 (SIMPLE_EDGE)
 
 Stage-0
@@ -183,6 +183,54 @@ Stage-0
                   Merge Join Operator [MERGEJOIN_175] (rows=1149975359 width=88)
                     Conds:RS_86._col0=RS_87._col0(Inner),RS_87._col0=RS_88._col0(Inner),RS_87._col0=RS_89._col0(Inner),Output:["_col7","_col14","_col22","_col26","_col30"]
                   <-Reducer 13 [SIMPLE_EDGE]
+                    SHUFFLE [RS_89]
+                      PartitionCols:_col0
+                      Select Operator [SEL_85] (rows=348477374 width=88)
+                        Output:["_col0","_col3","_col7"]
+                        Group By Operator [GBY_84] (rows=348477374 width=88)
+                          Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7"],aggregations:["sum(VALUE._col0)"],keys:KEY._col0, KEY._col1, KEY._col2, KEY._col3, KEY._col4, KEY._col5, KEY._col6
+                        <-Reducer 12 [SIMPLE_EDGE]
+                          SHUFFLE [RS_83]
+                            PartitionCols:_col0, _col1, _col2, _col3, _col4, _col5, _col6
+                            Group By Operator [GBY_82] (rows=696954748 width=88)
+                              Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7"],aggregations:["sum(_col7)"],keys:_col0, _col1, _col2, _col3, _col4, _col5, _col6
+                              Select Operator [SEL_80] (rows=696954748 width=88)
+                                Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7"]
+                                Merge Join Operator [MERGEJOIN_174] (rows=696954748 width=88)
+                                  Conds:RS_77._col1=RS_78._col0(Inner),Output:["_col2","_col3","_col7","_col8","_col9","_col10","_col11","_col12","_col13"]
+                                <-Map 18 [SIMPLE_EDGE]
+                                  SHUFFLE [RS_78]
+                                    PartitionCols:_col0
+                                    Select Operator [SEL_73] (rows=80000000 width=860)
+                                      Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7"]
+                                      Filter Operator [FIL_164] (rows=80000000 width=860)
+                                        predicate:(c_customer_sk is not null and c_customer_id is not null)
+                                        TableScan [TS_71] (rows=80000000 width=860)
+                                          default@customer,customer,Tbl:COMPLETE,Col:NONE,Output:["c_customer_sk","c_customer_id","c_first_name","c_last_name","c_preferred_cust_flag","c_birth_country","c_login","c_email_address"]
+                                <-Reducer 11 [SIMPLE_EDGE]
+                                  SHUFFLE [RS_77]
+                                    PartitionCols:_col1
+                                    Merge Join Operator [MERGEJOIN_173] (rows=633595212 width=88)
+                                      Conds:RS_74._col0=RS_75._col0(Inner),Output:["_col1","_col2","_col3"]
+                                    <-Map 17 [SIMPLE_EDGE]
+                                      SHUFFLE [RS_75]
+                                        PartitionCols:_col0
+                                        Select Operator [SEL_70] (rows=36524 width=1119)
+                                          Output:["_col0"]
+                                          Filter Operator [FIL_163] (rows=36524 width=1119)
+                                            predicate:((d_year = 2002) and d_date_sk is not null)
+                                            TableScan [TS_68] (rows=73049 width=1119)
+                                              default@date_dim,date_dim,Tbl:COMPLETE,Col:NONE,Output:["d_date_sk","d_year"]
+                                    <-Map 10 [SIMPLE_EDGE]
+                                      SHUFFLE [RS_74]
+                                        PartitionCols:_col0
+                                        Select Operator [SEL_67] (rows=575995635 width=88)
+                                          Output:["_col0","_col1","_col2","_col3"]
+                                          Filter Operator [FIL_162] (rows=575995635 width=88)
+                                            predicate:(ss_customer_sk is not null and ss_sold_date_sk is not null)
+                                            TableScan [TS_65] (rows=575995635 width=88)
+                                              default@store_sales,store_sales,Tbl:COMPLETE,Col:NONE,Output:["ss_sold_date_sk","ss_customer_sk","ss_ext_discount_amt","ss_ext_list_price"]
+                  <-Reducer 16 [SIMPLE_EDGE]
                     SHUFFLE [RS_87]
                       PartitionCols:_col0
                       Select Operator [SEL_42] (rows=116159124 width=88)
@@ -193,7 +241,7 @@ Stage-0
                             Output:["_col0","_col7"]
                             Group By Operator [GBY_40] (rows=348477374 width=88)
                               Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7"],aggregations:["sum(VALUE._col0)"],keys:KEY._col0, KEY._col1, KEY._col2, KEY._col3, KEY._col4, KEY._col5, KEY._col6
-                            <-Reducer 12 [SIMPLE_EDGE]
+                            <-Reducer 15 [SIMPLE_EDGE]
                               SHUFFLE [RS_39]
                                 PartitionCols:_col0, _col1, _col2, _col3, _col4, _col5, _col6
                                 Group By Operator [GBY_38] (rows=696954748 width=88)
@@ -202,75 +250,27 @@ Stage-0
                                     Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7"]
                                     Merge Join Operator [MERGEJOIN_170] (rows=696954748 width=88)
                                       Conds:RS_33._col1=RS_34._col0(Inner),Output:["_col2","_col3","_col7","_col8","_col9","_col10","_col11","_col12","_col13"]
-                                    <-Map 17 [SIMPLE_EDGE]
+                                    <-Map 18 [SIMPLE_EDGE]
                                       SHUFFLE [RS_34]
                                         PartitionCols:_col0
-                                        Select Operator [SEL_8] (rows=80000000 width=860)
-                                          Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7"]
-                                          Filter Operator [FIL_155] (rows=80000000 width=860)
-                                            predicate:(c_customer_sk is not null and c_customer_id is not null)
-                                            TableScan [TS_6] (rows=80000000 width=860)
-                                              default@customer,customer,Tbl:COMPLETE,Col:NONE,Output:["c_customer_sk","c_customer_id","c_first_name","c_last_name","c_preferred_cust_flag","c_birth_country","c_login","c_email_address"]
-                                    <-Reducer 11 [SIMPLE_EDGE]
+                                         Please refer to the previous Select Operator [SEL_73]
+                                    <-Reducer 14 [SIMPLE_EDGE]
                                       SHUFFLE [RS_33]
                                         PartitionCols:_col1
                                         Merge Join Operator [MERGEJOIN_169] (rows=633595212 width=88)
                                           Conds:RS_30._col0=RS_31._col0(Inner),Output:["_col1","_col2","_col3"]
-                                        <-Map 10 [SIMPLE_EDGE]
+                                        <-Map 17 [SIMPLE_EDGE]
                                           SHUFFLE [RS_31]
                                             PartitionCols:_col0
                                             Select Operator [SEL_26] (rows=36524 width=1119)
                                               Output:["_col0"]
                                               Filter Operator [FIL_157] (rows=36524 width=1119)
                                                 predicate:((d_year = 2001) and d_date_sk is not null)
-                                                TableScan [TS_3] (rows=73049 width=1119)
-                                                  default@date_dim,date_dim,Tbl:COMPLETE,Col:NONE,Output:["d_date_sk","d_year"]
-                                        <-Map 18 [SIMPLE_EDGE]
+                                                 Please refer to the previous TableScan [TS_68]
+                                        <-Map 10 [SIMPLE_EDGE]
                                           SHUFFLE [RS_30]
                                             PartitionCols:_col0
-                                            Select Operator [SEL_23] (rows=575995635 width=88)
-                                              Output:["_col0","_col1","_col2","_col3"]
-                                              Filter Operator [FIL_156] (rows=575995635 width=88)
-                                                predicate:(ss_customer_sk is not null and ss_sold_date_sk is not null)
-                                                TableScan [TS_21] (rows=575995635 width=88)
-                                                  default@store_sales,store_sales,Tbl:COMPLETE,Col:NONE,Output:["ss_sold_date_sk","ss_customer_sk","ss_ext_discount_amt","ss_ext_list_price"]
-                  <-Reducer 16 [SIMPLE_EDGE]
-                    SHUFFLE [RS_89]
-                      PartitionCols:_col0
-                      Select Operator [SEL_85] (rows=348477374 width=88)
-                        Output:["_col0","_col3","_col7"]
-                        Group By Operator [GBY_84] (rows=348477374 width=88)
-                          Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7"],aggregations:["sum(VALUE._col0)"],keys:KEY._col0, KEY._col1, KEY._col2, KEY._col3, KEY._col4, KEY._col5, KEY._col6
-                        <-Reducer 15 [SIMPLE_EDGE]
-                          SHUFFLE [RS_83]
-                            PartitionCols:_col0, _col1, _col2, _col3, _col4, _col5, _col6
-                            Group By Operator [GBY_82] (rows=696954748 width=88)
-                              Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7"],aggregations:["sum(_col7)"],keys:_col0, _col1, _col2, _col3, _col4, _col5, _col6
-                              Select Operator [SEL_80] (rows=696954748 width=88)
-                                Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7"]
-                                Merge Join Operator [MERGEJOIN_174] (rows=696954748 width=88)
-                                  Conds:RS_77._col1=RS_78._col0(Inner),Output:["_col2","_col3","_col7","_col8","_col9","_col10","_col11","_col12","_col13"]
-                                <-Map 17 [SIMPLE_EDGE]
-                                  SHUFFLE [RS_78]
-                                    PartitionCols:_col0
-                                     Please refer to the previous Select Operator [SEL_8]
-                                <-Reducer 14 [SIMPLE_EDGE]
-                                  SHUFFLE [RS_77]
-                                    PartitionCols:_col1
-                                    Merge Join Operator [MERGEJOIN_173] (rows=633595212 width=88)
-                                      Conds:RS_74._col0=RS_75._col0(Inner),Output:["_col1","_col2","_col3"]
-                                    <-Map 10 [SIMPLE_EDGE]
-                                      SHUFFLE [RS_75]
-                                        PartitionCols:_col0
-                                        Select Operator [SEL_70] (rows=36524 width=1119)
-                                          Output:["_col0"]
-                                          Filter Operator [FIL_163] (rows=36524 width=1119)
-                                            predicate:((d_year = 2002) and d_date_sk is not null)
-                                             Please refer to the previous TableScan [TS_3]
-                                    <-Map 18 [SIMPLE_EDGE]
-                                      SHUFFLE [RS_74]
-                                        PartitionCols:_col0
-                                         Please refer to the previous Select Operator [SEL_23]
+                                             Please refer to the previous Select Operator [SEL_67]
                   <-Reducer 4 [SIMPLE_EDGE]
                     SHUFFLE [RS_86]
                       PartitionCols:_col0
@@ -287,23 +287,19 @@ Stage-0
                                 Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7"]
                                 Merge Join Operator [MERGEJOIN_168] (rows=174243235 width=135)
                                   Conds:RS_12._col1=RS_13._col0(Inner),Output:["_col2","_col3","_col7","_col8","_col9","_col10","_col11","_col12","_col13"]
-                                <-Map 17 [SIMPLE_EDGE]
+                                <-Map 18 [SIMPLE_EDGE]
                                   SHUFFLE [RS_13]
                                     PartitionCols:_col0
-                                     Please refer to the previous Select Operator [SEL_8]
+                                     Please refer to the previous Select Operator [SEL_73]
                                 <-Reducer 2 [SIMPLE_EDGE]
                                   SHUFFLE [RS_12]
                                     PartitionCols:_col1
                                     Merge Join Operator [MERGEJOIN_167] (rows=158402938 width=135)
                                       Conds:RS_9._col0=RS_10._col0(Inner),Output:["_col1","_col2","_col3"]
-                                    <-Map 10 [SIMPLE_EDGE]
+                                    <-Map 17 [SIMPLE_EDGE]
                                       SHUFFLE [RS_10]
                                         PartitionCols:_col0
-                                        Select Operator [SEL_5] (rows=36524 width=1119)
-                                          Output:["_col0"]
-                                          Filter Operator [FIL_154] (rows=36524 width=1119)
-                                            predicate:((d_year = 2002) and d_date_sk is not null)
-                                             Please refer to the previous TableScan [TS_3]
+                                         Please refer to the previous Select Operator [SEL_70]
                                     <-Map 1 [SIMPLE_EDGE]
                                       SHUFFLE [RS_9]
                                         PartitionCols:_col0
@@ -331,23 +327,23 @@ Stage-0
                                   Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7"]
                                   Merge Join Operator [MERGEJOIN_172] (rows=174243235 width=135)
                                     Conds:RS_55._col1=RS_56._col0(Inner),Output:["_col2","_col3","_col7","_col8","_col9","_col10","_col11","_col12","_col13"]
-                                  <-Map 17 [SIMPLE_EDGE]
+                                  <-Map 18 [SIMPLE_EDGE]
                                     SHUFFLE [RS_56]
                                       PartitionCols:_col0
-                                       Please refer to the previous Select Operator [SEL_8]
+                                       Please refer to the previous Select Operator [SEL_73]
                                   <-Reducer 7 [SIMPLE_EDGE]
                                     SHUFFLE [RS_55]
                                       PartitionCols:_col1
                                       Merge Join Operator [MERGEJOIN_171] (rows=158402938 width=135)
                                         Conds:RS_52._col0=RS_53._col0(Inner),Output:["_col1","_col2","_col3"]
-                                      <-Map 10 [SIMPLE_EDGE]
+                                      <-Map 17 [SIMPLE_EDGE]
                                         SHUFFLE [RS_53]
                                           PartitionCols:_col0
                                           Select Operator [SEL_48] (rows=36524 width=1119)
                                             Output:["_col0"]
                                             Filter Operator [FIL_160] (rows=36524 width=1119)
                                               predicate:((d_year = 2001) and d_date_sk is not null)
-                                               Please refer to the previous TableScan [TS_3]
+                                               Please refer to the previous TableScan [TS_68]
                                       <-Map 1 [SIMPLE_EDGE]
                                         SHUFFLE [RS_52]
                                           PartitionCols:_col0
diff --git a/ql/src/test/results/clientpositive/perf/query14.q.out b/ql/src/test/results/clientpositive/perf/query14.q.out
index 74c7660398..bebe0571a7 100644
--- a/ql/src/test/results/clientpositive/perf/query14.q.out
+++ b/ql/src/test/results/clientpositive/perf/query14.q.out
@@ -1,6 +1,6 @@
 Warning: Shuffle Join MERGEJOIN[890][tables = [$hdt$_1, $hdt$_2, $hdt$_0]] in Stage 'Reducer 5' is a cross product
-Warning: Shuffle Join MERGEJOIN[891][tables = [$hdt$_1, $hdt$_2, $hdt$_0]] in Stage 'Reducer 12' is a cross product
 Warning: Shuffle Join MERGEJOIN[892][tables = [$hdt$_2, $hdt$_3, $hdt$_1]] in Stage 'Reducer 16' is a cross product
+Warning: Shuffle Join MERGEJOIN[891][tables = [$hdt$_1, $hdt$_2, $hdt$_0]] in Stage 'Reducer 12' is a cross product
 PREHOOK: query: explain
 with  cross_items as
  (select i_item_sk ss_item_sk
@@ -211,79 +211,79 @@ Plan optimized by CBO.
 
 Vertex dependency in root stage
 Reducer 11 <- Union 10 (CUSTOM_SIMPLE_EDGE)
-Reducer 12 <- Reducer 11 (CUSTOM_SIMPLE_EDGE), Reducer 38 (CUSTOM_SIMPLE_EDGE), Reducer 47 (CUSTOM_SIMPLE_EDGE), Union 6 (CONTAINS)
-Reducer 13 <- Map 1 (SIMPLE_EDGE), Map 17 (SIMPLE_EDGE), Union 14 (CONTAINS)
+Reducer 12 <- Reducer 11 (CUSTOM_SIMPLE_EDGE), Reducer 27 (CUSTOM_SIMPLE_EDGE), Reducer 52 (CUSTOM_SIMPLE_EDGE), Union 6 (CONTAINS)
+Reducer 13 <- Map 1 (SIMPLE_EDGE), Map 91 (SIMPLE_EDGE), Union 14 (CONTAINS)
 Reducer 15 <- Union 14 (CUSTOM_SIMPLE_EDGE)
-Reducer 16 <- Reducer 15 (CUSTOM_SIMPLE_EDGE), Reducer 56 (CUSTOM_SIMPLE_EDGE), Reducer 65 (CUSTOM_SIMPLE_EDGE), Union 6 (CONTAINS)
-Reducer 18 <- Map 17 (SIMPLE_EDGE), Map 88 (SIMPLE_EDGE), Union 19 (CONTAINS)
-Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 17 (SIMPLE_EDGE), Union 3 (CONTAINS)
-Reducer 20 <- Union 19 (CUSTOM_SIMPLE_EDGE)
-Reducer 21 <- Map 17 (SIMPLE_EDGE), Map 97 (SIMPLE_EDGE)
-Reducer 22 <- Map 96 (SIMPLE_EDGE), Reducer 21 (SIMPLE_EDGE)
-Reducer 23 <- Reducer 22 (SIMPLE_EDGE), Union 24 (CONTAINS)
-Reducer 25 <- Union 24 (SIMPLE_EDGE)
-Reducer 26 <- Map 96 (SIMPLE_EDGE), Reducer 25 (ONE_TO_ONE_EDGE)
-Reducer 27 <- Reducer 26 (SIMPLE_EDGE)
-Reducer 28 <- Map 96 (SIMPLE_EDGE), Reducer 27 (ONE_TO_ONE_EDGE), Reducer 92 (SIMPLE_EDGE)
-Reducer 29 <- Reducer 28 (SIMPLE_EDGE)
-Reducer 30 <- Map 17 (SIMPLE_EDGE), Map 98 (SIMPLE_EDGE)
-Reducer 31 <- Map 96 (SIMPLE_EDGE), Reducer 30 (SIMPLE_EDGE)
-Reducer 32 <- Reducer 31 (SIMPLE_EDGE), Union 24 (CONTAINS)
-Reducer 33 <- Map 17 (SIMPLE_EDGE), Map 99 (SIMPLE_EDGE)
-Reducer 34 <- Map 96 (SIMPLE_EDGE), Reducer 33 (SIMPLE_EDGE)
-Reducer 35 <- Reducer 34 (SIMPLE_EDGE), Union 24 (CONTAINS)
-Reducer 36 <- Map 17 (SIMPLE_EDGE), Map 88 (SIMPLE_EDGE), Union 37 (CONTAINS)
-Reducer 38 <- Union 37 (CUSTOM_SIMPLE_EDGE)
-Reducer 39 <- Map 17 (SIMPLE_EDGE), Map 97 (SIMPLE_EDGE)
+Reducer 16 <- Reducer 15 (CUSTOM_SIMPLE_EDGE), Reducer 30 (CUSTOM_SIMPLE_EDGE), Reducer 55 (CUSTOM_SIMPLE_EDGE), Union 6 (CONTAINS)
+Reducer 18 <- Map 17 (SIMPLE_EDGE), Map 21 (SIMPLE_EDGE), Union 3 (CONTAINS)
+Reducer 19 <- Map 17 (SIMPLE_EDGE), Map 21 (SIMPLE_EDGE), Union 10 (CONTAINS)
+Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 91 (SIMPLE_EDGE), Union 3 (CONTAINS)
+Reducer 20 <- Map 17 (SIMPLE_EDGE), Map 21 (SIMPLE_EDGE), Union 14 (CONTAINS)
+Reducer 22 <- Map 21 (SIMPLE_EDGE), Map 43 (SIMPLE_EDGE), Union 23 (CONTAINS)
+Reducer 24 <- Union 23 (CUSTOM_SIMPLE_EDGE)
+Reducer 25 <- Map 21 (SIMPLE_EDGE), Map 43 (SIMPLE_EDGE), Union 26 (CONTAINS)
+Reducer 27 <- Union 26 (CUSTOM_SIMPLE_EDGE)
+Reducer 28 <- Map 21 (SIMPLE_EDGE), Map 43 (SIMPLE_EDGE), Union 29 (CONTAINS)
+Reducer 30 <- Union 29 (CUSTOM_SIMPLE_EDGE)
+Reducer 32 <- Map 31 (SIMPLE_EDGE), Map 35 (SIMPLE_EDGE), Union 3 (CONTAINS)
+Reducer 33 <- Map 31 (SIMPLE_EDGE), Map 35 (SIMPLE_EDGE), Union 10 (CONTAINS)
+Reducer 34 <- Map 31 (SIMPLE_EDGE), Map 35 (SIMPLE_EDGE), Union 14 (CONTAINS)
+Reducer 36 <- Map 35 (SIMPLE_EDGE), Map 44 (SIMPLE_EDGE), Union 23 (CONTAINS)
+Reducer 37 <- Map 35 (SIMPLE_EDGE), Map 44 (SIMPLE_EDGE), Union 26 (CONTAINS)
+Reducer 38 <- Map 35 (SIMPLE_EDGE), Map 44 (SIMPLE_EDGE), Union 29 (CONTAINS)
 Reducer 4 <- Union 3 (CUSTOM_SIMPLE_EDGE)
-Reducer 40 <- Map 96 (SIMPLE_EDGE), Reducer 39 (SIMPLE_EDGE)
-Reducer 41 <- Reducer 40 (SIMPLE_EDGE), Union 42 (CONTAINS)
-Reducer 43 <- Union 42 (SIMPLE_EDGE)
-Reducer 44 <- Map 96 (SIMPLE_EDGE), Reducer 43 (ONE_TO_ONE_EDGE)
-Reducer 45 <- Reducer 44 (SIMPLE_EDGE)
-Reducer 46 <- Map 96 (SIMPLE_EDGE), Reducer 45 (ONE_TO_ONE_EDGE), Reducer 94 (SIMPLE_EDGE)
-Reducer 47 <- Reducer 46 (SIMPLE_EDGE)
-Reducer 48 <- Map 17 (SIMPLE_EDGE), Map 98 (SIMPLE_EDGE)
-Reducer 49 <- Map 96 (SIMPLE_EDGE), Reducer 48 (SIMPLE_EDGE)
-Reducer 5 <- Reducer 20 (CUSTOM_SIMPLE_EDGE), Reducer 29 (CUSTOM_SIMPLE_EDGE), Reducer 4 (CUSTOM_SIMPLE_EDGE), Union 6 (CONTAINS)
-Reducer 50 <- Reducer 49 (SIMPLE_EDGE), Union 42 (CONTAINS)
-Reducer 51 <- Map 17 (SIMPLE_EDGE), Map 99 (SIMPLE_EDGE)
-Reducer 52 <- Map 96 (SIMPLE_EDGE), Reducer 51 (SIMPLE_EDGE)
-Reducer 53 <- Reducer 52 (SIMPLE_EDGE), Union 42 (CONTAINS)
-Reducer 54 <- Map 17 (SIMPLE_EDGE), Map 88 (SIMPLE_EDGE), Union 55 (CONTAINS)
-Reducer 56 <- Union 55 (CUSTOM_SIMPLE_EDGE)
-Reducer 57 <- Map 17 (SIMPLE_EDGE), Map 97 (SIMPLE_EDGE)
-Reducer 58 <- Map 96 (SIMPLE_EDGE), Reducer 57 (SIMPLE_EDGE)
-Reducer 59 <- Reducer 58 (SIMPLE_EDGE), Union 60 (CONTAINS)
-Reducer 61 <- Union 60 (SIMPLE_EDGE)
-Reducer 62 <- Map 96 (SIMPLE_EDGE), Reducer 61 (ONE_TO_ONE_EDGE)
-Reducer 63 <- Reducer 62 (SIMPLE_EDGE)
-Reducer 64 <- Map 96 (SIMPLE_EDGE), Reducer 63 (ONE_TO_ONE_EDGE), Reducer 95 (SIMPLE_EDGE)
-Reducer 65 <- Reducer 64 (SIMPLE_EDGE)
-Reducer 66 <- Map 17 (SIMPLE_EDGE), Map 98 (SIMPLE_EDGE)
-Reducer 67 <- Map 96 (SIMPLE_EDGE), Reducer 66 (SIMPLE_EDGE)
-Reducer 68 <- Reducer 67 (SIMPLE_EDGE), Union 60 (CONTAINS)
-Reducer 69 <- Map 17 (SIMPLE_EDGE), Map 99 (SIMPLE_EDGE)
+Reducer 40 <- Map 39 (SIMPLE_EDGE), Map 91 (SIMPLE_EDGE), Union 23 (CONTAINS)
+Reducer 41 <- Map 39 (SIMPLE_EDGE), Map 91 (SIMPLE_EDGE), Union 26 (CONTAINS)
+Reducer 42 <- Map 39 (SIMPLE_EDGE), Map 91 (SIMPLE_EDGE), Union 29 (CONTAINS)
+Reducer 46 <- Map 45 (SIMPLE_EDGE), Map 49 (SIMPLE_EDGE)
+Reducer 47 <- Map 56 (SIMPLE_EDGE), Reducer 46 (SIMPLE_EDGE), Reducer 58 (ONE_TO_ONE_EDGE)
+Reducer 48 <- Reducer 47 (SIMPLE_EDGE)
+Reducer 5 <- Reducer 24 (CUSTOM_SIMPLE_EDGE), Reducer 4 (CUSTOM_SIMPLE_EDGE), Reducer 48 (CUSTOM_SIMPLE_EDGE), Union 6 (CONTAINS)
+Reducer 50 <- Map 100 (SIMPLE_EDGE), Map 49 (SIMPLE_EDGE)
+Reducer 51 <- Map 56 (SIMPLE_EDGE), Reducer 50 (SIMPLE_EDGE), Reducer 68 (ONE_TO_ONE_EDGE)
+Reducer 52 <- Reducer 51 (SIMPLE_EDGE)
+Reducer 53 <- Map 101 (SIMPLE_EDGE), Map 49 (SIMPLE_EDGE)
+Reducer 54 <- Map 56 (SIMPLE_EDGE), Reducer 53 (SIMPLE_EDGE), Reducer 78 (ONE_TO_ONE_EDGE)
+Reducer 55 <- Reducer 54 (SIMPLE_EDGE)
+Reducer 57 <- Map 56 (SIMPLE_EDGE), Reducer 62 (ONE_TO_ONE_EDGE)
+Reducer 58 <- Reducer 57 (SIMPLE_EDGE)
+Reducer 59 <- Map 56 (SIMPLE_EDGE), Reducer 88 (SIMPLE_EDGE)
+Reducer 60 <- Reducer 59 (SIMPLE_EDGE), Union 61 (CONTAINS)
+Reducer 62 <- Union 61 (SIMPLE_EDGE)
+Reducer 63 <- Map 56 (SIMPLE_EDGE), Reducer 92 (SIMPLE_EDGE)
+Reducer 64 <- Reducer 63 (SIMPLE_EDGE), Union 61 (CONTAINS)
+Reducer 65 <- Map 56 (SIMPLE_EDGE), Reducer 93 (SIMPLE_EDGE)
+Reducer 66 <- Reducer 65 (SIMPLE_EDGE), Union 61 (CONTAINS)
+Reducer 67 <- Map 56 (SIMPLE_EDGE), Reducer 72 (ONE_TO_ONE_EDGE)
+Reducer 68 <- Reducer 67 (SIMPLE_EDGE)
+Reducer 69 <- Map 56 (SIMPLE_EDGE), Reducer 89 (SIMPLE_EDGE)
 Reducer 7 <- Union 6 (SIMPLE_EDGE)
-Reducer 70 <- Map 96 (SIMPLE_EDGE), Reducer 69 (SIMPLE_EDGE)
-Reducer 71 <- Reducer 70 (SIMPLE_EDGE), Union 60 (CONTAINS)
-Reducer 73 <- Map 72 (SIMPLE_EDGE), Map 76 (SIMPLE_EDGE), Union 3 (CONTAINS)
-Reducer 74 <- Map 72 (SIMPLE_EDGE), Map 76 (SIMPLE_EDGE), Union 10 (CONTAINS)
-Reducer 75 <- Map 72 (SIMPLE_EDGE), Map 76 (SIMPLE_EDGE), Union 14 (CONTAINS)
-Reducer 77 <- Map 76 (SIMPLE_EDGE), Map 89 (SIMPLE_EDGE), Union 19 (CONTAINS)
-Reducer 78 <- Map 76 (SIMPLE_EDGE), Map 89 (SIMPLE_EDGE), Union 37 (CONTAINS)
-Reducer 79 <- Map 76 (SIMPLE_EDGE), Map 89 (SIMPLE_EDGE), Union 55 (CONTAINS)
+Reducer 70 <- Reducer 69 (SIMPLE_EDGE), Union 71 (CONTAINS)
+Reducer 72 <- Union 71 (SIMPLE_EDGE)
+Reducer 73 <- Map 56 (SIMPLE_EDGE), Reducer 94 (SIMPLE_EDGE)
+Reducer 74 <- Reducer 73 (SIMPLE_EDGE), Union 71 (CONTAINS)
+Reducer 75 <- Map 56 (SIMPLE_EDGE), Reducer 95 (SIMPLE_EDGE)
+Reducer 76 <- Reducer 75 (SIMPLE_EDGE), Union 71 (CONTAINS)
+Reducer 77 <- Map 56 (SIMPLE_EDGE), Reducer 82 (ONE_TO_ONE_EDGE)
+Reducer 78 <- Reducer 77 (SIMPLE_EDGE)
+Reducer 79 <- Map 56 (SIMPLE_EDGE), Reducer 90 (SIMPLE_EDGE)
 Reducer 8 <- Reducer 7 (SIMPLE_EDGE)
-Reducer 81 <- Map 80 (SIMPLE_EDGE), Map 84 (SIMPLE_EDGE), Union 3 (CONTAINS)
-Reducer 82 <- Map 80 (SIMPLE_EDGE), Map 84 (SIMPLE_EDGE), Union 10 (CONTAINS)
-Reducer 83 <- Map 80 (SIMPLE_EDGE), Map 84 (SIMPLE_EDGE), Union 14 (CONTAINS)
-Reducer 85 <- Map 84 (SIMPLE_EDGE), Map 90 (SIMPLE_EDGE), Union 19 (CONTAINS)
-Reducer 86 <- Map 84 (SIMPLE_EDGE), Map 90 (SIMPLE_EDGE), Union 37 (CONTAINS)
-Reducer 87 <- Map 84 (SIMPLE_EDGE), Map 90 (SIMPLE_EDGE), Union 55 (CONTAINS)
-Reducer 9 <- Map 1 (SIMPLE_EDGE), Map 17 (SIMPLE_EDGE), Union 10 (CONTAINS)
-Reducer 92 <- Map 91 (SIMPLE_EDGE), Map 93 (SIMPLE_EDGE)
-Reducer 94 <- Map 100 (SIMPLE_EDGE), Map 93 (SIMPLE_EDGE)
-Reducer 95 <- Map 101 (SIMPLE_EDGE), Map 93 (SIMPLE_EDGE)
+Reducer 80 <- Reducer 79 (SIMPLE_EDGE), Union 81 (CONTAINS)
+Reducer 82 <- Union 81 (SIMPLE_EDGE)
+Reducer 83 <- Map 56 (SIMPLE_EDGE), Reducer 96 (SIMPLE_EDGE)
+Reducer 84 <- Reducer 83 (SIMPLE_EDGE), Union 81 (CONTAINS)
+Reducer 85 <- Map 56 (SIMPLE_EDGE), Reducer 97 (SIMPLE_EDGE)
+Reducer 86 <- Reducer 85 (SIMPLE_EDGE), Union 81 (CONTAINS)
+Reducer 88 <- Map 87 (SIMPLE_EDGE), Map 91 (SIMPLE_EDGE)
+Reducer 89 <- Map 87 (SIMPLE_EDGE), Map 91 (SIMPLE_EDGE)
+Reducer 9 <- Map 1 (SIMPLE_EDGE), Map 91 (SIMPLE_EDGE), Union 10 (CONTAINS)
+Reducer 90 <- Map 87 (SIMPLE_EDGE), Map 91 (SIMPLE_EDGE)
+Reducer 92 <- Map 91 (SIMPLE_EDGE), Map 98 (SIMPLE_EDGE)
+Reducer 93 <- Map 91 (SIMPLE_EDGE), Map 99 (SIMPLE_EDGE)
+Reducer 94 <- Map 91 (SIMPLE_EDGE), Map 98 (SIMPLE_EDGE)
+Reducer 95 <- Map 91 (SIMPLE_EDGE), Map 99 (SIMPLE_EDGE)
+Reducer 96 <- Map 91 (SIMPLE_EDGE), Map 98 (SIMPLE_EDGE)
+Reducer 97 <- Map 91 (SIMPLE_EDGE), Map 99 (SIMPLE_EDGE)
 
 Stage-0
   Fetch Operator
@@ -324,7 +324,7 @@ Stage-0
                                         Group By Operator [GBY_222] (rows=1 width=8)
                                           Output:["_col0"],aggregations:["count(VALUE._col0)"]
                                         <-Union 10 [CUSTOM_SIMPLE_EDGE]
-                                          <-Reducer 74 [CONTAINS]
+                                          <-Reducer 19 [CONTAINS]
                                             Reduce Output Operator [RS_221]
                                               Group By Operator [GBY_220] (rows=1 width=8)
                                                 Output:["_col0"],aggregations:["count(_col0)"]
@@ -334,7 +334,7 @@ Stage-0
                                                     Output:["_col0"]
                                                     Merge Join Operator [MERGEJOIN_861] (rows=316788826 width=135)
                                                       Conds:RS_204._col0=RS_205._col0(Inner),Output:["_col1"]
-                                                    <-Map 76 [SIMPLE_EDGE]
+                                                    <-Map 21 [SIMPLE_EDGE]
                                                       SHUFFLE [RS_205]
                                                         PartitionCols:_col0
                                                         Select Operator [SEL_15] (rows=8116 width=1119)
@@ -343,7 +343,7 @@ Stage-0
                                                             predicate:(d_year BETWEEN 1998 AND 2000 and d_date_sk is not null)
                                                             TableScan [TS_13] (rows=73049 width=1119)
                                                               default@date_dim,date_dim,Tbl:COMPLETE,Col:NONE,Output:["d_date_sk","d_year"]
-                                                    <-Map 72 [SIMPLE_EDGE]
+                                                    <-Map 17 [SIMPLE_EDGE]
                                                       SHUFFLE [RS_204]
                                                         PartitionCols:_col0
                                                         Select Operator [SEL_12] (rows=287989836 width=135)
@@ -352,7 +352,7 @@ Stage-0
                                                             predicate:cs_sold_date_sk is not null
                                                             TableScan [TS_10] (rows=287989836 width=135)
                                                               default@catalog_sales,catalog_sales,Tbl:COMPLETE,Col:NONE,Output:["cs_sold_date_sk","cs_quantity"]
-                                          <-Reducer 82 [CONTAINS]
+                                          <-Reducer 33 [CONTAINS]
                                             Reduce Output Operator [RS_221]
                                               Group By Operator [GBY_220] (rows=1 width=8)
                                                 Output:["_col0"],aggregations:["count(_col0)"]
@@ -362,7 +362,7 @@ Stage-0
                                                     Output:["_col0"]
                                                     Merge Join Operator [MERGEJOIN_862] (rows=158402938 width=135)
                                                       Conds:RS_215._col0=RS_216._col0(Inner),Output:["_col1"]
-                                                    <-Map 84 [SIMPLE_EDGE]
+                                                    <-Map 35 [SIMPLE_EDGE]
                                                       SHUFFLE [RS_216]
                                                         PartitionCols:_col0
                                                         Select Operator [SEL_26] (rows=8116 width=1119)
@@ -371,7 +371,7 @@ Stage-0
                                                             predicate:(d_year BETWEEN 1998 AND 2000 and d_date_sk is not null)
                                                             TableScan [TS_24] (rows=73049 width=1119)
                                                               default@date_dim,date_dim,Tbl:COMPLETE,Col:NONE,Output:["d_date_sk","d_year"]
-                                                    <-Map 80 [SIMPLE_EDGE]
+                                                    <-Map 31 [SIMPLE_EDGE]
                                                       SHUFFLE [RS_215]
                                                         PartitionCols:_col0
                                                         Select Operator [SEL_23] (rows=144002668 width=135)
@@ -390,15 +390,15 @@ Stage-0
                                                     Output:["_col0"]
                                                     Merge Join Operator [MERGEJOIN_860] (rows=633595212 width=88)
                                                       Conds:RS_194._col0=RS_195._col0(Inner),Output:["_col1"]
-                                                    <-Map 17 [SIMPLE_EDGE]
+                                                    <-Map 91 [SIMPLE_EDGE]
                                                       SHUFFLE [RS_195]
                                                         PartitionCols:_col0
-                                                        Select Operator [SEL_5] (rows=8116 width=1119)
+                                                        Select Operator [SEL_98] (rows=8116 width=1119)
                                                           Output:["_col0"]
-                                                          Filter Operator [FIL_771] (rows=8116 width=1119)
+                                                          Filter Operator [FIL_787] (rows=8116 width=1119)
                                                             predicate:(d_year BETWEEN 1999 AND 2001 and d_date_sk is not null)
-                                                            TableScan [TS_3] (rows=73049 width=1119)
-                                                              default@date_dim,date_dim,Tbl:COMPLETE,Col:NONE,Output:["d_date_sk","d_year"]
+                                                            TableScan [TS_96] (rows=73049 width=1119)
+                                                              default@date_dim,d1,Tbl:COMPLETE,Col:NONE,Output:["d_date_sk","d_year"]
                                                     <-Map 1 [SIMPLE_EDGE]
                                                       SHUFFLE [RS_194]
                                                         PartitionCols:_col0
@@ -408,35 +408,12 @@ Stage-0
                                                             predicate:ss_sold_date_sk is not null
                                                             TableScan [TS_0] (rows=575995635 width=88)
                                                               default@store_sales,store_sales,Tbl:COMPLETE,Col:NONE,Output:["ss_sold_date_sk","ss_quantity"]
-                            <-Reducer 38 [CUSTOM_SIMPLE_EDGE]
+                            <-Reducer 27 [CUSTOM_SIMPLE_EDGE]
                               PARTITION_ONLY_SHUFFLE [RS_371]
                                 Group By Operator [GBY_267] (rows=1 width=288)
                                   Output:["_col0"],aggregations:["avg(VALUE._col0)"]
-                                <-Union 37 [CUSTOM_SIMPLE_EDGE]
-                                  <-Reducer 36 [CONTAINS]
-                                    Reduce Output Operator [RS_266]
-                                      Group By Operator [GBY_265] (rows=1 width=288)
-                                        Output:["_col0"],aggregations:["avg(_col0)"]
-                                        Select Operator [SEL_263] (rows=1108786976 width=108)
-                                          Output:["_col0"]
-                                          Select Operator [SEL_241] (rows=633595212 width=88)
-                                            Output:["_col0","_col1"]
-                                            Merge Join Operator [MERGEJOIN_863] (rows=633595212 width=88)
-                                              Conds:RS_238._col0=RS_239._col0(Inner),Output:["_col1","_col2"]
-                                            <-Map 17 [SIMPLE_EDGE]
-                                              SHUFFLE [RS_239]
-                                                PartitionCols:_col0
-                                                 Please refer to the previous Select Operator [SEL_5]
-                                            <-Map 88 [SIMPLE_EDGE]
-                                              SHUFFLE [RS_238]
-                                                PartitionCols:_col0
-                                                Select Operator [SEL_46] (rows=575995635 width=88)
-                                                  Output:["_col0","_col1","_col2"]
-                                                  Filter Operator [FIL_776] (rows=575995635 width=88)
-                                                    predicate:ss_sold_date_sk is not null
-                                                    TableScan [TS_44] (rows=575995635 width=88)
-                                                      default@store_sales,store_sales,Tbl:COMPLETE,Col:NONE,Output:["ss_sold_date_sk","ss_quantity","ss_list_price"]
-                                  <-Reducer 78 [CONTAINS]
+                                <-Union 26 [CUSTOM_SIMPLE_EDGE]
+                                  <-Reducer 25 [CONTAINS]
                                     Reduce Output Operator [RS_266]
                                       Group By Operator [GBY_265] (rows=1 width=288)
                                         Output:["_col0"],aggregations:["avg(_col0)"]
@@ -446,11 +423,11 @@ Stage-0
                                             Output:["_col0","_col1"]
                                             Merge Join Operator [MERGEJOIN_864] (rows=316788826 width=135)
                                               Conds:RS_248._col0=RS_249._col0(Inner),Output:["_col1","_col2"]
-                                            <-Map 76 [SIMPLE_EDGE]
+                                            <-Map 21 [SIMPLE_EDGE]
                                               SHUFFLE [RS_249]
                                                 PartitionCols:_col0
                                                  Please refer to the previous Select Operator [SEL_15]
-                                            <-Map 89 [SIMPLE_EDGE]
+                                            <-Map 43 [SIMPLE_EDGE]
                                               SHUFFLE [RS_248]
                                                 PartitionCols:_col0
                                                 Select Operator [SEL_56] (rows=287989836 width=135)
@@ -459,7 +436,7 @@ Stage-0
                                                     predicate:cs_sold_date_sk is not null
                                                     TableScan [TS_54] (rows=287989836 width=135)
                                                       default@catalog_sales,catalog_sales,Tbl:COMPLETE,Col:NONE,Output:["cs_sold_date_sk","cs_quantity","cs_list_price"]
-                                  <-Reducer 86 [CONTAINS]
+                                  <-Reducer 37 [CONTAINS]
                                     Reduce Output Operator [RS_266]
                                       Group By Operator [GBY_265] (rows=1 width=288)
                                         Output:["_col0"],aggregations:["avg(_col0)"]
@@ -469,11 +446,11 @@ Stage-0
                                             Output:["_col0","_col1"]
                                             Merge Join Operator [MERGEJOIN_865] (rows=158402938 width=135)
                                               Conds:RS_259._col0=RS_260._col0(Inner),Output:["_col1","_col2"]
-                                            <-Map 84 [SIMPLE_EDGE]
+                                            <-Map 35 [SIMPLE_EDGE]
                                               SHUFFLE [RS_260]
                                                 PartitionCols:_col0
                                                  Please refer to the previous Select Operator [SEL_26]
-                                            <-Map 90 [SIMPLE_EDGE]
+                                            <-Map 44 [SIMPLE_EDGE]
                                               SHUFFLE [RS_259]
                                                 PartitionCols:_col0
                                                 Select Operator [SEL_67] (rows=144002668 width=135)
@@ -482,11 +459,34 @@ Stage-0
                                                     predicate:ws_sold_date_sk is not null
                                                     TableScan [TS_65] (rows=144002668 width=135)
                                                       default@web_sales,web_sales,Tbl:COMPLETE,Col:NONE,Output:["ws_sold_date_sk","ws_quantity","ws_list_price"]
-                            <-Reducer 47 [CUSTOM_SIMPLE_EDGE]
+                                  <-Reducer 41 [CONTAINS]
+                                    Reduce Output Operator [RS_266]
+                                      Group By Operator [GBY_265] (rows=1 width=288)
+                                        Output:["_col0"],aggregations:["avg(_col0)"]
+                                        Select Operator [SEL_263] (rows=1108786976 width=108)
+                                          Output:["_col0"]
+                                          Select Operator [SEL_241] (rows=633595212 width=88)
+                                            Output:["_col0","_col1"]
+                                            Merge Join Operator [MERGEJOIN_863] (rows=633595212 width=88)
+                                              Conds:RS_238._col0=RS_239._col0(Inner),Output:["_col1","_col2"]
+                                            <-Map 91 [SIMPLE_EDGE]
+                                              SHUFFLE [RS_239]
+                                                PartitionCols:_col0
+                                                 Please refer to the previous Select Operator [SEL_98]
+                                            <-Map 39 [SIMPLE_EDGE]
+                                              SHUFFLE [RS_238]
+                                                PartitionCols:_col0
+                                                Select Operator [SEL_46] (rows=575995635 width=88)
+                                                  Output:["_col0","_col1","_col2"]
+                                                  Filter Operator [FIL_776] (rows=575995635 width=88)
+                                                    predicate:ss_sold_date_sk is not null
+                                                    TableScan [TS_44] (rows=575995635 width=88)
+                                                      default@store_sales,store_sales,Tbl:COMPLETE,Col:NONE,Output:["ss_sold_date_sk","ss_quantity","ss_list_price"]
+                            <-Reducer 52 [CUSTOM_SIMPLE_EDGE]
                               PARTITION_ONLY_SHUFFLE [RS_372]
                                 Group By Operator [GBY_368] (rows=348467716 width=135)
                                   Output:["_col0","_col1","_col2","_col3","_col4"],aggregations:["sum(VALUE._col0)","count(VALUE._col1)"],keys:KEY._col0, KEY._col1, KEY._col2
-                                <-Reducer 46 [SIMPLE_EDGE]
+                                <-Reducer 51 [SIMPLE_EDGE]
                                   SHUFFLE [RS_367]
                                     PartitionCols:_col0, _col1, _col2
                                     Group By Operator [GBY_366] (rows=696935432 width=135)
@@ -495,36 +495,59 @@ Stage-0
                                         Output:["_col0","_col1","_col2","_col3"]
                                         Merge Join Operator [MERGEJOIN_874] (rows=696935432 width=135)
                                           Conds:RS_360._col1=RS_361._col0(Inner),RS_360._col1=RS_362._col0(Inner),Output:["_col2","_col3","_col8","_col9","_col10"]
-                                        <-Map 96 [SIMPLE_EDGE]
+                                        <-Map 56 [SIMPLE_EDGE]
                                           SHUFFLE [RS_361]
                                             PartitionCols:_col0
                                             Select Operator [SEL_277] (rows=462000 width=1436)
                                               Output:["_col0","_col1","_col2","_col3"]
                                               Filter Operator [FIL_809] (rows=462000 width=1436)
                                                 predicate:i_item_sk is not null
-                                                TableScan [TS_87] (rows=462000 width=1436)
+                                                TableScan [TS_90] (rows=462000 width=1436)
                                                   default@item,item,Tbl:COMPLETE,Col:NONE,Output:["i_item_sk","i_brand_id","i_class_id","i_category_id"]
-                                        <-Reducer 45 [ONE_TO_ONE_EDGE]
+                                        <-Reducer 50 [SIMPLE_EDGE]
+                                          SHUFFLE [RS_360]
+                                            PartitionCols:_col1
+                                            Merge Join Operator [MERGEJOIN_866] (rows=316788826 width=135)
+                                              Conds:RS_357._col0=RS_358._col0(Inner),Output:["_col1","_col2","_col3"]
+                                            <-Map 49 [SIMPLE_EDGE]
+                                              SHUFFLE [RS_358]
+                                                PartitionCols:_col0
+                                                Select Operator [SEL_86] (rows=18262 width=1119)
+                                                  Output:["_col0"]
+                                                  Filter Operator [FIL_783] (rows=18262 width=1119)
+                                                    predicate:((d_year = 2000) and (d_moy = 11) and d_date_sk is not null)
+                                                    TableScan [TS_84] (rows=73049 width=1119)
+                                                      default@date_dim,date_dim,Tbl:COMPLETE,Col:NONE,Output:["d_date_sk","d_year","d_moy"]
+                                            <-Map 100 [SIMPLE_EDGE]
+                                              SHUFFLE [RS_357]
+                                                PartitionCols:_col0
+                                                Select Operator [SEL_271] (rows=287989836 width=135)
+                                                  Output:["_col0","_col1","_col2","_col3"]
+                                                  Filter Operator [FIL_807] (rows=287989836 width=135)
+                                                    predicate:(cs_item_sk is not null and cs_sold_date_sk is not null)
+                                                    TableScan [TS_269] (rows=287989836 width=135)
+                                                      default@catalog_sales,catalog_sales,Tbl:COMPLETE,Col:NONE,Output:["cs_sold_date_sk","cs_item_sk","cs_quantity","cs_list_price"]
+                                        <-Reducer 68 [ONE_TO_ONE_EDGE]
                                           FORWARD [RS_362]
                                             PartitionCols:_col0
                                             Group By Operator [GBY_355] (rows=254100 width=1436)
                                               Output:["_col0"],keys:KEY._col0
-                                            <-Reducer 44 [SIMPLE_EDGE]
+                                            <-Reducer 67 [SIMPLE_EDGE]
                                               SHUFFLE [RS_354]
                                                 PartitionCols:_col0
                                                 Group By Operator [GBY_353] (rows=508200 width=1436)
                                                   Output:["_col0"],keys:_col0
                                                   Merge Join Operator [MERGEJOIN_873] (rows=508200 width=1436)
                                                     Conds:RS_349._col1, _col2, _col3=RS_350._col0, _col1, _col2(Inner),Output:["_col0"]
-                                                  <-Map 96 [SIMPLE_EDGE]
+                                                  <-Map 56 [SIMPLE_EDGE]
                                                     SHUFFLE [RS_349]
                                                       PartitionCols:_col1, _col2, _col3
                                                       Select Operator [SEL_280] (rows=462000 width=1436)
                                                         Output:["_col0","_col1","_col2","_col3"]
                                                         Filter Operator [FIL_810] (rows=462000 width=1436)
                                                           predicate:(i_brand_id is not null and i_class_id is not null and i_category_id is not null and i_item_sk is not null)
-                                                           Please refer to the previous TableScan [TS_87]
-                                                  <-Reducer 43 [ONE_TO_ONE_EDGE]
+                                                           Please refer to the previous TableScan [TS_90]
+                                                  <-Reducer 72 [ONE_TO_ONE_EDGE]
                                                     FORWARD [RS_350]
                                                       PartitionCols:_col0, _col1, _col2
                                                       Select Operator [SEL_348] (rows=1 width=108)
@@ -533,39 +556,39 @@ Stage-0
                                                           predicate:(_col3 = 3)
                                                           Group By Operator [GBY_346] (rows=304916424 width=108)
                                                             Output:["_col0","_col1","_col2","_col3"],aggregations:["count(VALUE._col0)"],keys:KEY._col0, KEY._col1, KEY._col2
-                                                          <-Union 42 [SIMPLE_EDGE]
-                                                            <-Reducer 41 [CONTAINS]
+                                                          <-Union 71 [SIMPLE_EDGE]
+                                                            <-Reducer 70 [CONTAINS]
                                                               Reduce Output Operator [RS_345]
                                                                 PartitionCols:_col0, _col1, _col2
                                                                 Group By Operator [GBY_344] (rows=609832849 width=108)
                                                                   Output:["_col0","_col1","_col2","_col3"],aggregations:["count(_col3)"],keys:_col0, _col1, _col2
                                                                   Group By Operator [GBY_299] (rows=348477374 width=88)
                                                                     Output:["_col0","_col1","_col2","_col3"],aggregations:["count(VALUE._col0)"],keys:KEY._col0, KEY._col1, KEY._col2
-                                                                  <-Reducer 40 [SIMPLE_EDGE]
+                                                                  <-Reducer 69 [SIMPLE_EDGE]
                                                                     SHUFFLE [RS_298]
                                                                       PartitionCols:_col0, _col1, _col2
                                                                       Group By Operator [GBY_297] (rows=696954748 width=88)
                                                                         Output:["_col0","_col1","_col2","_col3"],aggregations:["count()"],keys:_col5, _col6, _col7
                                                                         Merge Join Operator [MERGEJOIN_868] (rows=696954748 width=88)
                                                                           Conds:RS_293._col1=RS_294._col0(Inner),Output:["_col5","_col6","_col7"]
-                                                                        <-Map 96 [SIMPLE_EDGE]
+                                                                        <-Map 56 [SIMPLE_EDGE]
                                                                           SHUFFLE [RS_294]
                                                                             PartitionCols:_col0
                                                                             Select Operator [SEL_289] (rows=462000 width=1436)
                                                                               Output:["_col0","_col1","_col2","_col3"]
                                                                               Filter Operator [FIL_813] (rows=462000 width=1436)
                                                                                 predicate:(i_item_sk is not null and i_brand_id is not null and i_class_id is not null and i_category_id is not null)
-                                                                                 Please refer to the previous TableScan [TS_87]
-                                                                        <-Reducer 39 [SIMPLE_EDGE]
+                                                                                 Please refer to the previous TableScan [TS_90]
+                                                                        <-Reducer 89 [SIMPLE_EDGE]
                                                                           SHUFFLE [RS_293]
                                                                             PartitionCols:_col1
                                                                             Merge Join Operator [MERGEJOIN_867] (rows=633595212 width=88)
                                                                               Conds:RS_290._col0=RS_291._col0(Inner),Output:["_col1"]
-                                                                            <-Map 17 [SIMPLE_EDGE]
+                                                                            <-Map 91 [SIMPLE_EDGE]
                                                                               SHUFFLE [RS_291]
                                                                                 PartitionCols:_col0
-                                                                                 Please refer to the previous Select Operator [SEL_5]
-                                                                            <-Map 97 [SIMPLE_EDGE]
+                                                                                 Please refer to the previous Select Operator [SEL_98]
+                                                                            <-Map 87 [SIMPLE_EDGE]
                                                                               SHUFFLE [RS_290]
                                                                                 PartitionCols:_col0
                                                                                 Select Operator [SEL_95] (rows=575995635 width=88)
@@ -574,37 +597,37 @@ Stage-0
                                                                                     predicate:(ss_item_sk is not null and ss_sold_date_sk is not null)
                                                                                     TableScan [TS_93] (rows=575995635 width=88)
                                                                                       default@store_sales,store_sales,Tbl:COMPLETE,Col:NONE,Output:["ss_sold_date_sk","ss_item_sk"]
-                                                            <-Reducer 50 [CONTAINS]
+                                                            <-Reducer 74 [CONTAINS]
                                                               Reduce Output Operator [RS_345]
                                                                 PartitionCols:_col0, _col1, _col2
                                                                 Group By Operator [GBY_344] (rows=609832849 width=108)
                                                                   Output:["_col0","_col1","_col2","_col3"],aggregations:["count(_col3)"],keys:_col0, _col1, _col2
                                                                   Group By Operator [GBY_319] (rows=174233858 width=135)
                                                                     Output:["_col0","_col1","_col2","_col3"],aggregations:["count(VALUE._col0)"],keys:KEY._col0, KEY._col1, KEY._col2
-                                                                  <-Reducer 49 [SIMPLE_EDGE]
+                                                                  <-Reducer 73 [SIMPLE_EDGE]
                                                                     SHUFFLE [RS_318]
                                                                       PartitionCols:_col0, _col1, _col2
                                                                       Group By Operator [GBY_317] (rows=348467716 width=135)
                                                                         Output:["_col0","_col1","_col2","_col3"],aggregations:["count()"],keys:_col5, _col6, _col7
                                                                         Merge Join Operator [MERGEJOIN_870] (rows=348467716 width=135)
                                                                           Conds:RS_313._col1=RS_314._col0(Inner),Output:["_col5","_col6","_col7"]
-                                                                        <-Map 96 [SIMPLE_EDGE]
+                                                                        <-Map 56 [SIMPLE_EDGE]
                                                                           SHUFFLE [RS_314]
                                                                             PartitionCols:_col0
                                                                             Select Operator [SEL_309] (rows=462000 width=1436)
                                                                               Output:["_col0","_col1","_col2","_col3"]
                                                                               Filter Operator [FIL_816] (rows=462000 width=1436)
                                                                                 predicate:(i_item_sk is not null and i_brand_id is not null and i_class_id is not null and i_category_id is not null)
-                                                                                 Please refer to the previous TableScan [TS_87]
-                                                                        <-Reducer 48 [SIMPLE_EDGE]
+                                                                                 Please refer to the previous TableScan [TS_90]
+                                                                        <-Reducer 94 [SIMPLE_EDGE]
                                                                           SHUFFLE [RS_313]
                                                                             PartitionCols:_col1
                                                                             Merge Join Operator [MERGEJOIN_869] (rows=316788826 width=135)
                                                                               Conds:RS_310._col0=RS_311._col0(Inner),Output:["_col1"]
-                                                                            <-Map 17 [SIMPLE_EDGE]
+                                                                            <-Map 91 [SIMPLE_EDGE]
                                                                               SHUFFLE [RS_311]
                                                                                 PartitionCols:_col0
-                                                                                 Please refer to the previous Select Operator [SEL_5]
+                                                                                 Please refer to the previous Select Operator [SEL_98]
                                                                             <-Map 98 [SIMPLE_EDGE]
                                                                               SHUFFLE [RS_310]
                                                                                 PartitionCols:_col0
@@ -614,37 +637,37 @@ Stage-0
                                                                                     predicate:(cs_item_sk is not null and cs_sold_date_sk is not null)
                                                                                     TableScan [TS_113] (rows=287989836 width=135)
                                                                                       default@catalog_sales,catalog_sales,Tbl:COMPLETE,Col:NONE,Output:["cs_sold_date_sk","cs_item_sk"]
-                                                            <-Reducer 53 [CONTAINS]
+                                                            <-Reducer 76 [CONTAINS]
                                                               Reduce Output Operator [RS_345]
                                                                 PartitionCols:_col0, _col1, _col2
                                                                 Group By Operator [GBY_344] (rows=609832849 width=108)
                                                                   Output:["_col0","_col1","_col2","_col3"],aggregations:["count(_col3)"],keys:_col0, _col1, _col2
                                                                   Group By Operator [GBY_340] (rows=87121617 width=135)
                                                                     Output:["_col0","_col1","_col2","_col3"],aggregations:["count(VALUE._col0)"],keys:KEY._col0, KEY._col1, KEY._col2
-                                                                  <-Reducer 52 [SIMPLE_EDGE]
+                                                                  <-Reducer 75 [SIMPLE_EDGE]
                                                                     SHUFFLE [RS_339]
                                                                       PartitionCols:_col0, _col1, _col2
                                                                       Group By Operator [GBY_338] (rows=174243235 width=135)
                                                                         Output:["_col0","_col1","_col2","_col3"],aggregations:["count()"],keys:_col5, _col6, _col7
                                                                         Merge Join Operator [MERGEJOIN_872] (rows=174243235 width=135)
                                                                           Conds:RS_334._col1=RS_335._col0(Inner),Output:["_col5","_col6","_col7"]
-                                                                        <-Map 96 [SIMPLE_EDGE]
+                                                                        <-Map 56 [SIMPLE_EDGE]
                                                                           SHUFFLE [RS_335]
                                                                             PartitionCols:_col0
                                                                             Select Operator [SEL_330] (rows=462000 width=1436)
                                                                               Output:["_col0","_col1","_col2","_col3"]
                                                                               Filter Operator [FIL_819] (rows=462000 width=1436)
                                                                                 predicate:(i_item_sk is not null and i_brand_id is not null and i_class_id is not null and i_category_id is not null)
-                                                                                 Please refer to the previous TableScan [TS_87]
-                                                                        <-Reducer 51 [SIMPLE_EDGE]
+                                                                                 Please refer to the previous TableScan [TS_90]
+                                                                        <-Reducer 95 [SIMPLE_EDGE]
                                                                           SHUFFLE [RS_334]
                                                                             PartitionCols:_col1
                                                                             Merge Join Operator [MERGEJOIN_871] (rows=158402938 width=135)
                                                                               Conds:RS_331._col0=RS_332._col0(Inner),Output:["_col1"]
-                                                                            <-Map 17 [SIMPLE_EDGE]
+                                                                            <-Map 91 [SIMPLE_EDGE]
                                                                               SHUFFLE [RS_332]
                                                                                 PartitionCols:_col0
-                                                                                 Please refer to the previous Select Operator [SEL_5]
+                                                                                 Please refer to the previous Select Operator [SEL_98]
                                                                             <-Map 99 [SIMPLE_EDGE]
                                                                               SHUFFLE [RS_331]
                                                                                 PartitionCols:_col0
@@ -654,29 +677,6 @@ Stage-0
                                                                                     predicate:(ws_item_sk is not null and ws_sold_date_sk is not null)
                                                                                     TableScan [TS_134] (rows=144002668 width=135)
                                                                                       default@web_sales,web_sales,Tbl:COMPLETE,Col:NONE,Output:["ws_sold_date_sk","ws_item_sk"]
-                                        <-Reducer 94 [SIMPLE_EDGE]
-                                          SHUFFLE [RS_360]
-                                            PartitionCols:_col1
-                                            Merge Join Operator [MERGEJOIN_866] (rows=316788826 width=135)
-                                              Conds:RS_357._col0=RS_358._col0(Inner),Output:["_col1","_col2","_col3"]
-                                            <-Map 93 [SIMPLE_EDGE]
-                                              SHUFFLE [RS_358]
-                                                PartitionCols:_col0
-                                                Select Operator [SEL_86] (rows=18262 width=1119)
-                                                  Output:["_col0"]
-                                                  Filter Operator [FIL_783] (rows=18262 width=1119)
-                                                    predicate:((d_year = 2000) and (d_moy = 11) and d_date_sk is not null)
-                                                    TableScan [TS_84] (rows=73049 width=1119)
-                                                      default@date_dim,date_dim,Tbl:COMPLETE,Col:NONE,Output:["d_date_sk","d_year","d_moy"]
-                                            <-Map 100 [SIMPLE_EDGE]
-                                              SHUFFLE [RS_357]
-                                                PartitionCols:_col0
-                                                Select Operator [SEL_271] (rows=287989836 width=135)
-                                                  Output:["_col0","_col1","_col2","_col3"]
-                                                  Filter Operator [FIL_807] (rows=287989836 width=135)
-                                                    predicate:(cs_item_sk is not null and cs_sold_date_sk is not null)
-                                                    TableScan [TS_269] (rows=287989836 width=135)
-                                                      default@catalog_sales,catalog_sales,Tbl:COMPLETE,Col:NONE,Output:["cs_sold_date_sk","cs_item_sk","cs_quantity","cs_list_price"]
                   <-Reducer 16 [CONTAINS]
                     Reduce Output Operator [RS_568]
                       PartitionCols:_col0, _col1, _col2, _col3, _col4
@@ -709,15 +709,15 @@ Stage-0
                                                     Output:["_col0"]
                                                     Merge Join Operator [MERGEJOIN_875] (rows=633595212 width=88)
                                                       Conds:RS_383._col0=RS_384._col0(Inner),Output:["_col1"]
-                                                    <-Map 17 [SIMPLE_EDGE]
+                                                    <-Map 91 [SIMPLE_EDGE]
                                                       SHUFFLE [RS_384]
                                                         PartitionCols:_col0
-                                                         Please refer to the previous Select Operator [SEL_5]
+                                                         Please refer to the previous Select Operator [SEL_98]
                                                     <-Map 1 [SIMPLE_EDGE]
                                                       SHUFFLE [RS_383]
                                                         PartitionCols:_col0
                                                          Please refer to the previous Select Operator [SEL_2]
-                                          <-Reducer 75 [CONTAINS]
+                                          <-Reducer 20 [CONTAINS]
                                             Reduce Output Operator [RS_410]
                                               Group By Operator [GBY_409] (rows=1 width=8)
                                                 Output:["_col0"],aggregations:["count(_col0)"]
@@ -727,15 +727,15 @@ Stage-0
                                                     Output:["_col0"]
                                                     Merge Join Operator [MERGEJOIN_876] (rows=316788826 width=135)
                                                       Conds:RS_393._col0=RS_394._col0(Inner),Output:["_col1"]
-                                                    <-Map 76 [SIMPLE_EDGE]
+                                                    <-Map 21 [SIMPLE_EDGE]
                                                       SHUFFLE [RS_394]
                                                         PartitionCols:_col0
                                                          Please refer to the previous Select Operator [SEL_15]
-                                                    <-Map 72 [SIMPLE_EDGE]
+                                                    <-Map 17 [SIMPLE_EDGE]
                                                       SHUFFLE [RS_393]
                                                         PartitionCols:_col0
                                                          Please refer to the previous Select Operator [SEL_12]
-                                          <-Reducer 83 [CONTAINS]
+                                          <-Reducer 34 [CONTAINS]
                                             Reduce Output Operator [RS_410]
                                               Group By Operator [GBY_409] (rows=1 width=8)
                                                 Output:["_col0"],aggregations:["count(_col0)"]
@@ -745,38 +745,20 @@ Stage-0
                                                     Output:["_col0"]
                                                     Merge Join Operator [MERGEJOIN_877] (rows=158402938 width=135)
                                                       Conds:RS_404._col0=RS_405._col0(Inner),Output:["_col1"]
-                                                    <-Map 84 [SIMPLE_EDGE]
+                                                    <-Map 35 [SIMPLE_EDGE]
                                                       SHUFFLE [RS_405]
                                                         PartitionCols:_col0
                                                          Please refer to the previous Select Operator [SEL_26]
-                                                    <-Map 80 [SIMPLE_EDGE]
+                                                    <-Map 31 [SIMPLE_EDGE]
                                                       SHUFFLE [RS_404]
                                                         PartitionCols:_col0
                                                          Please refer to the previous Select Operator [SEL_23]
-                            <-Reducer 56 [CUSTOM_SIMPLE_EDGE]
+                            <-Reducer 30 [CUSTOM_SIMPLE_EDGE]
                               PARTITION_ONLY_SHUFFLE [RS_560]
                                 Group By Operator [GBY_456] (rows=1 width=288)
                                   Output:["_col0"],aggregations:["avg(VALUE._col0)"]
-                                <-Union 55 [CUSTOM_SIMPLE_EDGE]
-                                  <-Reducer 54 [CONTAINS]
-                                    Reduce Output Operator [RS_455]
-                                      Group By Operator [GBY_454] (rows=1 width=288)
-                                        Output:["_col0"],aggregations:["avg(_col0)"]
-                                        Select Operator [SEL_452] (rows=1108786976 width=108)
-                                          Output:["_col0"]
-                                          Select Operator [SEL_430] (rows=633595212 width=88)
-                                            Output:["_col0","_col1"]
-                                            Merge Join Operator [MERGEJOIN_878] (rows=633595212 width=88)
-                                              Conds:RS_427._col0=RS_428._col0(Inner),Output:["_col1","_col2"]
-                                            <-Map 17 [SIMPLE_EDGE]
-                                              SHUFFLE [RS_428]
-                                                PartitionCols:_col0
-                                                 Please refer to the previous Select Operator [SEL_5]
-                                            <-Map 88 [SIMPLE_EDGE]
-                                              SHUFFLE [RS_427]
-                                                PartitionCols:_col0
-                                                 Please refer to the previous Select Operator [SEL_46]
-                                  <-Reducer 79 [CONTAINS]
+                                <-Union 29 [CUSTOM_SIMPLE_EDGE]
+                                  <-Reducer 28 [CONTAINS]
                                     Reduce Output Operator [RS_455]
                                       Group By Operator [GBY_454] (rows=1 width=288)
                                         Output:["_col0"],aggregations:["avg(_col0)"]
@@ -786,15 +768,15 @@ Stage-0
                                             Output:["_col0","_col1"]
                                             Merge Join Operator [MERGEJOIN_879] (rows=316788826 width=135)
                                               Conds:RS_437._col0=RS_438._col0(Inner),Output:["_col1","_col2"]
-                                            <-Map 76 [SIMPLE_EDGE]
+                                            <-Map 21 [SIMPLE_EDGE]
                                               SHUFFLE [RS_438]
                                                 PartitionCols:_col0
                                                  Please refer to the previous Select Operator [SEL_15]
-                                            <-Map 89 [SIMPLE_EDGE]
+                                            <-Map 43 [SIMPLE_EDGE]
                                               SHUFFLE [RS_437]
                                                 PartitionCols:_col0
                                                  Please refer to the previous Select Operator [SEL_56]
-                                  <-Reducer 87 [CONTAINS]
+                                  <-Reducer 38 [CONTAINS]
                                     Reduce Output Operator [RS_455]
                                       Group By Operator [GBY_454] (rows=1 width=288)
                                         Output:["_col0"],aggregations:["avg(_col0)"]
@@ -804,19 +786,37 @@ Stage-0
                                             Output:["_col0","_col1"]
                                             Merge Join Operator [MERGEJOIN_880] (rows=158402938 width=135)
                                               Conds:RS_448._col0=RS_449._col0(Inner),Output:["_col1","_col2"]
-                                            <-Map 84 [SIMPLE_EDGE]
+                                            <-Map 35 [SIMPLE_EDGE]
                                               SHUFFLE [RS_449]
                                                 PartitionCols:_col0
                                                  Please refer to the previous Select Operator [SEL_26]
-                                            <-Map 90 [SIMPLE_EDGE]
+                                            <-Map 44 [SIMPLE_EDGE]
                                               SHUFFLE [RS_448]
                                                 PartitionCols:_col0
                                                  Please refer to the previous Select Operator [SEL_67]
-                            <-Reducer 65 [CUSTOM_SIMPLE_EDGE]
+                                  <-Reducer 42 [CONTAINS]
+                                    Reduce Output Operator [RS_455]
+                                      Group By Operator [GBY_454] (rows=1 width=288)
+                                        Output:["_col0"],aggregations:["avg(_col0)"]
+                                        Select Operator [SEL_452] (rows=1108786976 width=108)
+                                          Output:["_col0"]
+                                          Select Operator [SEL_430] (rows=633595212 width=88)
+                                            Output:["_col0","_col1"]
+                                            Merge Join Operator [MERGEJOIN_878] (rows=633595212 width=88)
+                                              Conds:RS_427._col0=RS_428._col0(Inner),Output:["_col1","_col2"]
+                                            <-Map 91 [SIMPLE_EDGE]
+                                              SHUFFLE [RS_428]
+                                                PartitionCols:_col0
+                                                 Please refer to the previous Select Operator [SEL_98]
+                                            <-Map 39 [SIMPLE_EDGE]
+                                              SHUFFLE [RS_427]
+                                                PartitionCols:_col0
+                                                 Please refer to the previous Select Operator [SEL_46]
+                            <-Reducer 55 [CUSTOM_SIMPLE_EDGE]
                               PARTITION_ONLY_SHUFFLE [RS_561]
                                 Group By Operator [GBY_557] (rows=174243235 width=135)
                                   Output:["_col0","_col1","_col2","_col3","_col4"],aggregations:["sum(VALUE._col0)","count(VALUE._col1)"],keys:KEY._col0, KEY._col1, KEY._col2
-                                <-Reducer 64 [SIMPLE_EDGE]
+                                <-Reducer 54 [SIMPLE_EDGE]
                                   SHUFFLE [RS_556]
                                     PartitionCols:_col0, _col1, _col2
                                     Group By Operator [GBY_555] (rows=348486471 width=135)
@@ -825,35 +825,53 @@ Stage-0
                                         Output:["_col0","_col1","_col2","_col3"]
                                         Merge Join Operator [MERGEJOIN_889] (rows=348486471 width=135)
                                           Conds:RS_549._col1=RS_550._col0(Inner),RS_549._col1=RS_551._col0(Inner),Output:["_col2","_col3","_col8","_col9","_col10"]
-                                        <-Map 96 [SIMPLE_EDGE]
+                                        <-Map 56 [SIMPLE_EDGE]
                                           SHUFFLE [RS_550]
                                             PartitionCols:_col0
                                             Select Operator [SEL_466] (rows=462000 width=1436)
                                               Output:["_col0","_col1","_col2","_col3"]
                                               Filter Operator [FIL_834] (rows=462000 width=1436)
                                                 predicate:i_item_sk is not null
-                                                 Please refer to the previous TableScan [TS_87]
-                                        <-Reducer 63 [ONE_TO_ONE_EDGE]
+                                                 Please refer to the previous TableScan [TS_90]
+                                        <-Reducer 53 [SIMPLE_EDGE]
+                                          SHUFFLE [RS_549]
+                                            PartitionCols:_col1
+                                            Merge Join Operator [MERGEJOIN_881] (rows=158402938 width=135)
+                                              Conds:RS_546._col0=RS_547._col0(Inner),Output:["_col1","_col2","_col3"]
+                                            <-Map 49 [SIMPLE_EDGE]
+                                              SHUFFLE [RS_547]
+                                                PartitionCols:_col0
+                                                 Please refer to the previous Select Operator [SEL_86]
+                                            <-Map 101 [SIMPLE_EDGE]
+                                              SHUFFLE [RS_546]
+                                                PartitionCols:_col0
+                                                Select Operator [SEL_460] (rows=144002668 width=135)
+                                                  Output:["_col0","_col1","_col2","_col3"]
+                                                  Filter Operator [FIL_832] (rows=144002668 width=135)
+                                                    predicate:(ws_item_sk is not null and ws_sold_date_sk is not null)
+                                                    TableScan [TS_458] (rows=144002668 width=135)
+                                                      default@web_sales,web_sales,Tbl:COMPLETE,Col:NONE,Output:["ws_sold_date_sk","ws_item_sk","ws_quantity","ws_list_price"]
+                                        <-Reducer 78 [ONE_TO_ONE_EDGE]
                                           FORWARD [RS_551]
                                             PartitionCols:_col0
                                             Group By Operator [GBY_544] (rows=254100 width=1436)
                                               Output:["_col0"],keys:KEY._col0
-                                            <-Reducer 62 [SIMPLE_EDGE]
+                                            <-Reducer 77 [SIMPLE_EDGE]
                                               SHUFFLE [RS_543]
                                                 PartitionCols:_col0
                                                 Group By Operator [GBY_542] (rows=508200 width=1436)
                                                   Output:["_col0"],keys:_col0
                                                   Merge Join Operator [MERGEJOIN_888] (rows=508200 width=1436)
                                                     Conds:RS_538._col1, _col2, _col3=RS_539._col0, _col1, _col2(Inner),Output:["_col0"]
-                                                  <-Map 96 [SIMPLE_EDGE]
+                                                  <-Map 56 [SIMPLE_EDGE]
                                                     SHUFFLE [RS_538]
                                                       PartitionCols:_col1, _col2, _col3
                                                       Select Operator [SEL_469] (rows=462000 width=1436)
                                                         Output:["_col0","_col1","_col2","_col3"]
                                                         Filter Operator [FIL_835] (rows=462000 width=1436)
                                                           predicate:(i_brand_id is not null and i_class_id is not null and i_category_id is not null and i_item_sk is not null)
-                                                           Please refer to the previous TableScan [TS_87]
-                                                  <-Reducer 61 [ONE_TO_ONE_EDGE]
+                                                           Please refer to the previous TableScan [TS_90]
+                                                  <-Reducer 82 [ONE_TO_ONE_EDGE]
                                                     FORWARD [RS_539]
                                                       PartitionCols:_col0, _col1, _col2
                                                       Select Operator [SEL_537] (rows=1 width=108)
@@ -862,130 +880,112 @@ Stage-0
                                                           predicate:(_col3 = 3)
                                                           Group By Operator [GBY_535] (rows=304916424 width=108)
                                                             Output:["_col0","_col1","_col2","_col3"],aggregations:["count(VALUE._col0)"],keys:KEY._col0, KEY._col1, KEY._col2
-                                                          <-Union 60 [SIMPLE_EDGE]
-                                                            <-Reducer 59 [CONTAINS]
+                                                          <-Union 81 [SIMPLE_EDGE]
+                                                            <-Reducer 80 [CONTAINS]
                                                               Reduce Output Operator [RS_534]
                                                                 PartitionCols:_col0, _col1, _col2
                                                                 Group By Operator [GBY_533] (rows=609832849 width=108)
                                                                   Output:["_col0","_col1","_col2","_col3"],aggregations:["count(_col3)"],keys:_col0, _col1, _col2
                                                                   Group By Operator [GBY_488] (rows=348477374 width=88)
                                                                     Output:["_col0","_col1","_col2","_col3"],aggregations:["count(VALUE._col0)"],keys:KEY._col0, KEY._col1, KEY._col2
-                                                                  <-Reducer 58 [SIMPLE_EDGE]
+                                                                  <-Reducer 79 [SIMPLE_EDGE]
                                                                     SHUFFLE [RS_487]
                                                                       PartitionCols:_col0, _col1, _col2
                                                                       Group By Operator [GBY_486] (rows=696954748 width=88)
                                                                         Output:["_col0","_col1","_col2","_col3"],aggregations:["count()"],keys:_col5, _col6, _col7
                                                                         Merge Join Operator [MERGEJOIN_883] (rows=696954748 width=88)
                                                                           Conds:RS_482._col1=RS_483._col0(Inner),Output:["_col5","_col6","_col7"]
-                                                                        <-Map 96 [SIMPLE_EDGE]
+                                                                        <-Map 56 [SIMPLE_EDGE]
                                                                           SHUFFLE [RS_483]
                                                                             PartitionCols:_col0
                                                                             Select Operator [SEL_478] (rows=462000 width=1436)
                                                                               Output:["_col0","_col1","_col2","_col3"]
                                                                               Filter Operator [FIL_838] (rows=462000 width=1436)
                                                                                 predicate:(i_item_sk is not null and i_brand_id is not null and i_class_id is not null and i_category_id is not null)
-                                                                                 Please refer to the previous TableScan [TS_87]
-                                                                        <-Reducer 57 [SIMPLE_EDGE]
+                                                                                 Please refer to the previous TableScan [TS_90]
+                                                                        <-Reducer 90 [SIMPLE_EDGE]
                                                                           SHUFFLE [RS_482]
                                                                             PartitionCols:_col1
                                                                             Merge Join Operator [MERGEJOIN_882] (rows=633595212 width=88)
                                                                               Conds:RS_479._col0=RS_480._col0(Inner),Output:["_col1"]
-                                                                            <-Map 17 [SIMPLE_EDGE]
+                                                                            <-Map 91 [SIMPLE_EDGE]
                                                                               SHUFFLE [RS_480]
                                                                                 PartitionCols:_col0
-                                                                                 Please refer to the previous Select Operator [SEL_5]
-                                                                            <-Map 97 [SIMPLE_EDGE]
+                                                                                 Please refer to the previous Select Operator [SEL_98]
+                                                                            <-Map 87 [SIMPLE_EDGE]
                                                                               SHUFFLE [RS_479]
                                                                                 PartitionCols:_col0
                                                                                  Please refer to the previous Select Operator [SEL_95]
-                                                            <-Reducer 68 [CONTAINS]
+                                                            <-Reducer 84 [CONTAINS]
                                                               Reduce Output Operator [RS_534]
                                                                 PartitionCols:_col0, _col1, _col2
                                                                 Group By Operator [GBY_533] (rows=609832849 width=108)
                                                                   Output:["_col0","_col1","_col2","_col3"],aggregations:["count(_col3)"],keys:_col0, _col1, _col2
                                                                   Group By Operator [GBY_508] (rows=174233858 width=135)
                                                                     Output:["_col0","_col1","_col2","_col3"],aggregations:["count(VALUE._col0)"],keys:KEY._col0, KEY._col1, KEY._col2
-                                                                  <-Reducer 67 [SIMPLE_EDGE]
+                                                                  <-Reducer 83 [SIMPLE_EDGE]
                                                                     SHUFFLE [RS_507]
                                                                       PartitionCols:_col0, _col1, _col2
                                                                       Group By Operator [GBY_506] (rows=348467716 width=135)
                                                                         Output:["_col0","_col1","_col2","_col3"],aggregations:["count()"],keys:_col5, _col6, _col7
                                                                         Merge Join Operator [MERGEJOIN_885] (rows=348467716 width=135)
                                                                           Conds:RS_502._col1=RS_503._col0(Inner),Output:["_col5","_col6","_col7"]
-                                                                        <-Map 96 [SIMPLE_EDGE]
+                                                                        <-Map 56 [SIMPLE_EDGE]
                                                                           SHUFFLE [RS_503]
                                                                             PartitionCols:_col0
                                                                             Select Operator [SEL_498] (rows=462000 width=1436)
                                                                               Output:["_col0","_col1","_col2","_col3"]
                                                                               Filter Operator [FIL_841] (rows=462000 width=1436)
                                                                                 predicate:(i_item_sk is not null and i_brand_id is not null and i_class_id is not null and i_category_id is not null)
-                                                                                 Please refer to the previous TableScan [TS_87]
-                                                                        <-Reducer 66 [SIMPLE_EDGE]
+                                                                                 Please refer to the previous TableScan [TS_90]
+                                                                        <-Reducer 96 [SIMPLE_EDGE]
                                                                           SHUFFLE [RS_502]
                                                                             PartitionCols:_col1
                                                                             Merge Join Operator [MERGEJOIN_884] (rows=316788826 width=135)
                                                                               Conds:RS_499._col0=RS_500._col0(Inner),Output:["_col1"]
-                                                                            <-Map 17 [SIMPLE_EDGE]
+                                                                            <-Map 91 [SIMPLE_EDGE]
                                                                               SHUFFLE [RS_500]
                                                                                 PartitionCols:_col0
-                                                                                 Please refer to the previous Select Operator [SEL_5]
+                                                                                 Please refer to the previous Select Operator [SEL_98]
                                                                             <-Map 98 [SIMPLE_EDGE]
                                                                               SHUFFLE [RS_499]
                                                                                 PartitionCols:_col0
                                                                                  Please refer to the previous Select Operator [SEL_115]
-                                                            <-Reducer 71 [CONTAINS]
+                                                            <-Reducer 86 [CONTAINS]
                                                               Reduce Output Operator [RS_534]
                                                                 PartitionCols:_col0, _col1, _col2
                                                                 Group By Operator [GBY_533] (rows=609832849 width=108)
                                                                   Output:["_col0","_col1","_col2","_col3"],aggregations:["count(_col3)"],keys:_col0, _col1, _col2
                                                                   Group By Operator [GBY_529] (rows=87121617 width=135)
                                                                     Output:["_col0","_col1","_col2","_col3"],aggregations:["count(VALUE._col0)"],keys:KEY._col0, KEY._col1, KEY._col2
-                                                                  <-Reducer 70 [SIMPLE_EDGE]
+                                                                  <-Reducer 85 [SIMPLE_EDGE]
                                                                     SHUFFLE [RS_528]
                                                                       PartitionCols:_col0, _col1, _col2
                                                                       Group By Operator [GBY_527] (rows=174243235 width=135)
                                                                         Output:["_col0","_col1","_col2","_col3"],aggregations:["count()"],keys:_col5, _col6, _col7
                                                                         Merge Join Operator [MERGEJOIN_887] (rows=174243235 width=135)
                                                                           Conds:RS_523._col1=RS_524._col0(Inner),Output:["_col5","_col6","_col7"]
-                                                                        <-Map 96 [SIMPLE_EDGE]
+                                                                        <-Map 56 [SIMPLE_EDGE]
                                                                           SHUFFLE [RS_524]
                                                                             PartitionCols:_col0
                                                                             Select Operator [SEL_519] (rows=462000 width=1436)
                                                                               Output:["_col0","_col1","_col2","_col3"]
                                                                               Filter Operator [FIL_844] (rows=462000 width=1436)
                                                                                 predicate:(i_item_sk is not null and i_brand_id is not null and i_class_id is not null and i_category_id is not null)
-                                                                                 Please refer to the previous TableScan [TS_87]
-                                                                        <-Reducer 69 [SIMPLE_EDGE]
+                                                                                 Please refer to the previous TableScan [TS_90]
+                                                                        <-Reducer 97 [SIMPLE_EDGE]
                                                                           SHUFFLE [RS_523]
                                                                             PartitionCols:_col1
                                                                             Merge Join Operator [MERGEJOIN_886] (rows=158402938 width=135)
                                                                               Conds:RS_520._col0=RS_521._col0(Inner),Output:["_col1"]
-                                                                            <-Map 17 [SIMPLE_EDGE]
+                                                                            <-Map 91 [SIMPLE_EDGE]
                                                                               SHUFFLE [RS_521]
                                                                                 PartitionCols:_col0
-                                                                                 Please refer to the previous Select Operator [SEL_5]
+                                                                                 Please refer to the previous Select Operator [SEL_98]
                                                                             <-Map 99 [SIMPLE_EDGE]
                                                                               SHUFFLE [RS_520]
                                                                                 PartitionCols:_col0
                                                                                  Please refer to the previous Select Operator [SEL_136]
-                                        <-Reducer 95 [SIMPLE_EDGE]
-                                          SHUFFLE [RS_549]
-                                            PartitionCols:_col1
-                                            Merge Join Operator [MERGEJOIN_881] (rows=158402938 width=135)
-                                              Conds:RS_546._col0=RS_547._col0(Inner),Output:["_col1","_col2","_col3"]
-                                            <-Map 93 [SIMPLE_EDGE]
-                                              SHUFFLE [RS_547]
-                                                PartitionCols:_col0
-                                                 Please refer to the previous Select Operator [SEL_86]
-                                            <-Map 101 [SIMPLE_EDGE]
-                                              SHUFFLE [RS_546]
-                                                PartitionCols:_col0
-                                                Select Operator [SEL_460] (rows=144002668 width=135)
-                                                  Output:["_col0","_col1","_col2","_col3"]
-                                                  Filter Operator [FIL_832] (rows=144002668 width=135)
-                                                    predicate:(ws_item_sk is not null and ws_sold_date_sk is not null)
-                                                    TableScan [TS_458] (rows=144002668 width=135)
-                                                      default@web_sales,web_sales,Tbl:COMPLETE,Col:NONE,Output:["ws_sold_date_sk","ws_item_sk","ws_quantity","ws_list_price"]
                   <-Reducer 5 [CONTAINS]
                     Reduce Output Operator [RS_568]
                       PartitionCols:_col0, _col1, _col2, _col3, _col4
@@ -997,30 +997,12 @@ Stage-0
                             predicate:(_col5 > _col1)
                             Merge Join Operator [MERGEJOIN_890] (rows=696954748 width=385)
                               Conds:(Inner),(Inner),Output:["_col1","_col2","_col3","_col4","_col5","_col6"]
-                            <-Reducer 20 [CUSTOM_SIMPLE_EDGE]
+                            <-Reducer 24 [CUSTOM_SIMPLE_EDGE]
                               PARTITION_ONLY_SHUFFLE [RS_183]
                                 Group By Operator [GBY_79] (rows=1 width=288)
                                   Output:["_col0"],aggregations:["avg(VALUE._col0)"]
-                                <-Union 19 [CUSTOM_SIMPLE_EDGE]
-                                  <-Reducer 18 [CONTAINS]
-                                    Reduce Output Operator [RS_78]
-                                      Group By Operator [GBY_77] (rows=1 width=288)
-                                        Output:["_col0"],aggregations:["avg(_col0)"]
-                                        Select Operator [SEL_75] (rows=1108786976 width=108)
-                                          Output:["_col0"]
-                                          Select Operator [SEL_53] (rows=633595212 width=88)
-                                            Output:["_col0","_col1"]
-                                            Merge Join Operator [MERGEJOIN_848] (rows=633595212 width=88)
-                                              Conds:RS_50._col0=RS_51._col0(Inner),Output:["_col1","_col2"]
-                                            <-Map 17 [SIMPLE_EDGE]
-                                              SHUFFLE [RS_51]
-                                                PartitionCols:_col0
-                                                 Please refer to the previous Select Operator [SEL_5]
-                                            <-Map 88 [SIMPLE_EDGE]
-                                              SHUFFLE [RS_50]
-                                                PartitionCols:_col0
-                                                 Please refer to the previous Select Operator [SEL_46]
-                                  <-Reducer 77 [CONTAINS]
+                                <-Union 23 [CUSTOM_SIMPLE_EDGE]
+                                  <-Reducer 22 [CONTAINS]
                                     Reduce Output Operator [RS_78]
                                       Group By Operator [GBY_77] (rows=1 width=288)
                                         Output:["_col0"],aggregations:["avg(_col0)"]
@@ -1030,15 +1012,15 @@ Stage-0
                                             Output:["_col0","_col1"]
                                             Merge Join Operator [MERGEJOIN_849] (rows=316788826 width=135)
                                               Conds:RS_60._col0=RS_61._col0(Inner),Output:["_col1","_col2"]
-                                            <-Map 76 [SIMPLE_EDGE]
+                                            <-Map 21 [SIMPLE_EDGE]
                                               SHUFFLE [RS_61]
                                                 PartitionCols:_col0
                                                  Please refer to the previous Select Operator [SEL_15]
-                                            <-Map 89 [SIMPLE_EDGE]
+                                            <-Map 43 [SIMPLE_EDGE]
                                               SHUFFLE [RS_60]
                                                 PartitionCols:_col0
                                                  Please refer to the previous Select Operator [SEL_56]
-                                  <-Reducer 85 [CONTAINS]
+                                  <-Reducer 36 [CONTAINS]
                                     Reduce Output Operator [RS_78]
                                       Group By Operator [GBY_77] (rows=1 width=288)
                                         Output:["_col0"],aggregations:["avg(_col0)"]
@@ -1048,19 +1030,102 @@ Stage-0
                                             Output:["_col0","_col1"]
                                             Merge Join Operator [MERGEJOIN_850] (rows=158402938 width=135)
                                               Conds:RS_71._col0=RS_72._col0(Inner),Output:["_col1","_col2"]
-                                            <-Map 84 [SIMPLE_EDGE]
+                                            <-Map 35 [SIMPLE_EDGE]
                                               SHUFFLE [RS_72]
                                                 PartitionCols:_col0
                                                  Please refer to the previous Select Operator [SEL_26]
-                                            <-Map 90 [SIMPLE_EDGE]
+                                            <-Map 44 [SIMPLE_EDGE]
                                               SHUFFLE [RS_71]
                                                 PartitionCols:_col0
                                                  Please refer to the previous Select Operator [SEL_67]
-                            <-Reducer 29 [CUSTOM_SIMPLE_EDGE]
+                                  <-Reducer 40 [CONTAINS]
+                                    Reduce Output Operator [RS_78]
+                                      Group By Operator [GBY_77] (rows=1 width=288)
+                                        Output:["_col0"],aggregations:["avg(_col0)"]
+                                        Select Operator [SEL_75] (rows=1108786976 width=108)
+                                          Output:["_col0"]
+                                          Select Operator [SEL_53] (rows=633595212 width=88)
+                                            Output:["_col0","_col1"]
+                                            Merge Join Operator [MERGEJOIN_848] (rows=633595212 width=88)
+                                              Conds:RS_50._col0=RS_51._col0(Inner),Output:["_col1","_col2"]
+                                            <-Map 91 [SIMPLE_EDGE]
+                                              SHUFFLE [RS_51]
+                                                PartitionCols:_col0
+                                                 Please refer to the previous Select Operator [SEL_98]
+                                            <-Map 39 [SIMPLE_EDGE]
+                                              SHUFFLE [RS_50]
+                                                PartitionCols:_col0
+                                                 Please refer to the previous Select Operator [SEL_46]
+                            <-Reducer 4 [CUSTOM_SIMPLE_EDGE]
+                              PARTITION_ONLY_SHUFFLE [RS_182]
+                                Select Operator [SEL_43] (rows=1 width=8)
+                                  Filter Operator [FIL_42] (rows=1 width=8)
+                                    predicate:(sq_count_check(_col0) <= 1)
+                                    Group By Operator [GBY_40] (rows=1 width=8)
+                                      Output:["_col0"],aggregations:["count()"]
+                                      Select Operator [SEL_35] (rows=1 width=8)
+                                        Group By Operator [GBY_34] (rows=1 width=8)
+                                          Output:["_col0"],aggregations:["count(VALUE._col0)"]
+                                        <-Union 3 [CUSTOM_SIMPLE_EDGE]
+                                          <-Reducer 18 [CONTAINS]
+                                            Reduce Output Operator [RS_33]
+                                              Group By Operator [GBY_32] (rows=1 width=8)
+                                                Output:["_col0"],aggregations:["count(_col0)"]
+                                                Select Operator [SEL_31] (rows=1108786976 width=108)
+                                                  Output:["_col0"]
+                                                  Select Operator [SEL_19] (rows=316788826 width=135)
+                                                    Output:["_col0"]
+                                                    Merge Join Operator [MERGEJOIN_846] (rows=316788826 width=135)
+                                                      Conds:RS_16._col0=RS_17._col0(Inner),Output:["_col1"]
+                                                    <-Map 21 [SIMPLE_EDGE]
+                                                      SHUFFLE [RS_17]
+                                                        PartitionCols:_col0
+                                                         Please refer to the previous Select Operator [SEL_15]
+                                                    <-Map 17 [SIMPLE_EDGE]
+                                                      SHUFFLE [RS_16]
+                                                        PartitionCols:_col0
+                                                         Please refer to the previous Select Operator [SEL_12]
+                                          <-Reducer 2 [CONTAINS]
+                                            Reduce Output Operator [RS_33]
+                                              Group By Operator [GBY_32] (rows=1 width=8)
+                                                Output:["_col0"],aggregations:["count(_col0)"]
+                                                Select Operator [SEL_31] (rows=1108786976 width=108)
+                                                  Output:["_col0"]
+                                                  Select Operator [SEL_9] (rows=633595212 width=88)
+                                                    Output:["_col0"]
+                                                    Merge Join Operator [MERGEJOIN_845] (rows=633595212 width=88)
+                                                      Conds:RS_6._col0=RS_7._col0(Inner),Output:["_col1"]
+                                                    <-Map 91 [SIMPLE_EDGE]
+                                                      SHUFFLE [RS_7]
+                                                        PartitionCols:_col0
+                                                         Please refer to the previous Select Operator [SEL_98]
+                                                    <-Map 1 [SIMPLE_EDGE]
+                                                      SHUFFLE [RS_6]
+                                                        PartitionCols:_col0
+                                                         Please refer to the previous Select Operator [SEL_2]
+                                          <-Reducer 32 [CONTAINS]
+                                            Reduce Output Operator [RS_33]
+                                              Group By Operator [GBY_32] (rows=1 width=8)
+                                                Output:["_col0"],aggregations:["count(_col0)"]
+                                                Select Operator [SEL_31] (rows=1108786976 width=108)
+                                                  Output:["_col0"]
+                                                  Select Operator [SEL_30] (rows=158402938 width=135)
+                                                    Output:["_col0"]
+                                                    Merge Join Operator [MERGEJOIN_847] (rows=158402938 width=135)
+                                                      Conds:RS_27._col0=RS_28._col0(Inner),Output:["_col1"]
+                                                    <-Map 35 [SIMPLE_EDGE]
+                                                      SHUFFLE [RS_28]
+                                                        PartitionCols:_col0
+                                                         Please refer to the previous Select Operator [SEL_26]
+                                                    <-Map 31 [SIMPLE_EDGE]
+                                                      SHUFFLE [RS_27]
+                                                        PartitionCols:_col0
+                                                         Please refer to the previous Select Operator [SEL_23]
+                            <-Reducer 48 [CUSTOM_SIMPLE_EDGE]
                               PARTITION_ONLY_SHUFFLE [RS_184]
                                 Group By Operator [GBY_180] (rows=696954748 width=88)
                                   Output:["_col0","_col1","_col2","_col3","_col4"],aggregations:["sum(VALUE._col0)","count(VALUE._col1)"],keys:KEY._col0, KEY._col1, KEY._col2
-                                <-Reducer 28 [SIMPLE_EDGE]
+                                <-Reducer 47 [SIMPLE_EDGE]
                                   SHUFFLE [RS_179]
                                     PartitionCols:_col0, _col1, _col2
                                     Group By Operator [GBY_178] (rows=1393909496 width=88)
@@ -1069,35 +1134,53 @@ Stage-0
                                         Output:["_col0","_col1","_col2","_col3"]
                                         Merge Join Operator [MERGEJOIN_859] (rows=1393909496 width=88)
                                           Conds:RS_172._col1=RS_173._col0(Inner),RS_172._col1=RS_174._col0(Inner),Output:["_col2","_col3","_col8","_col9","_col10"]
-                                        <-Map 96 [SIMPLE_EDGE]
+                                        <-Map 56 [SIMPLE_EDGE]
                                           SHUFFLE [RS_173]
                                             PartitionCols:_col0
                                             Select Operator [SEL_89] (rows=462000 width=1436)
                                               Output:["_col0","_col1","_col2","_col3"]
                                               Filter Operator [FIL_784] (rows=462000 width=1436)
                                                 predicate:i_item_sk is not null
-                                                 Please refer to the previous TableScan [TS_87]
-                                        <-Reducer 27 [ONE_TO_ONE_EDGE]
+                                                 Please refer to the previous TableScan [TS_90]
+                                        <-Reducer 46 [SIMPLE_EDGE]
+                                          SHUFFLE [RS_172]
+                                            PartitionCols:_col1
+                                            Merge Join Operator [MERGEJOIN_851] (rows=633595212 width=88)
+                                              Conds:RS_169._col0=RS_170._col0(Inner),Output:["_col1","_col2","_col3"]
+                                            <-Map 49 [SIMPLE_EDGE]
+                                              SHUFFLE [RS_170]
+                                                PartitionCols:_col0
+                                                 Please refer to the previous Select Operator [SEL_86]
+                                            <-Map 45 [SIMPLE_EDGE]
+                                              SHUFFLE [RS_169]
+                                                PartitionCols:_col0
+                                                Select Operator [SEL_83] (rows=575995635 width=88)
+                                                  Output:["_col0","_col1","_col2","_col3"]
+                                                  Filter Operator [FIL_782] (rows=575995635 width=88)
+                                                    predicate:(ss_item_sk is not null and ss_sold_date_sk is not null)
+                                                    TableScan [TS_81] (rows=575995635 width=88)
+                                                      default@store_sales,store_sales,Tbl:COMPLETE,Col:NONE,Output:["ss_sold_date_sk","ss_item_sk","ss_quantity","ss_list_price"]
+                                        <-Reducer 58 [ONE_TO_ONE_EDGE]
                                           FORWARD [RS_174]
                                             PartitionCols:_col0
                                             Group By Operator [GBY_167] (rows=254100 width=1436)
                                               Output:["_col0"],keys:KEY._col0
-                                            <-Reducer 26 [SIMPLE_EDGE]
+                                            <-Reducer 57 [SIMPLE_EDGE]
                                               SHUFFLE [RS_166]
                                                 PartitionCols:_col0
                                                 Group By Operator [GBY_165] (rows=508200 width=1436)
                                                   Output:["_col0"],keys:_col0
                                                   Merge Join Operator [MERGEJOIN_858] (rows=508200 width=1436)
                                                     Conds:RS_161._col1, _col2, _col3=RS_162._col0, _col1, _col2(Inner),Output:["_col0"]
-                                                  <-Map 96 [SIMPLE_EDGE]
+                                                  <-Map 56 [SIMPLE_EDGE]
                                                     SHUFFLE [RS_161]
                                                       PartitionCols:_col1, _col2, _col3
                                                       Select Operator [SEL_92] (rows=462000 width=1436)
                                                         Output:["_col0","_col1","_col2","_col3"]
                                                         Filter Operator [FIL_785] (rows=462000 width=1436)
                                                           predicate:(i_brand_id is not null and i_class_id is not null and i_category_id is not null and i_item_sk is not null)
-                                                           Please refer to the previous TableScan [TS_87]
-                                                  <-Reducer 25 [ONE_TO_ONE_EDGE]
+                                                           Please refer to the previous TableScan [TS_90]
+                                                  <-Reducer 62 [ONE_TO_ONE_EDGE]
                                                     FORWARD [RS_162]
                                                       PartitionCols:_col0, _col1, _col2
                                                       Select Operator [SEL_160] (rows=1 width=108)
@@ -1106,193 +1189,98 @@ Stage-0
                                                           predicate:(_col3 = 3)
                                                           Group By Operator [GBY_158] (rows=304916424 width=108)
                                                             Output:["_col0","_col1","_col2","_col3"],aggregations:["count(VALUE._col0)"],keys:KEY._col0, KEY._col1, KEY._col2
-                                                          <-Union 24 [SIMPLE_EDGE]
-                                                            <-Reducer 23 [CONTAINS]
+                                                          <-Union 61 [SIMPLE_EDGE]
+                                                            <-Reducer 60 [CONTAINS]
                                                               Reduce Output Operator [RS_157]
                                                                 PartitionCols:_col0, _col1, _col2
                                                                 Group By Operator [GBY_156] (rows=609832849 width=108)
                                                                   Output:["_col0","_col1","_col2","_col3"],aggregations:["count(_col3)"],keys:_col0, _col1, _col2
                                                                   Group By Operator [GBY_111] (rows=348477374 width=88)
                                                                     Output:["_col0","_col1","_col2","_col3"],aggregations:["count(VALUE._col0)"],keys:KEY._col0, KEY._col1, KEY._col2
-                                                                  <-Reducer 22 [SIMPLE_EDGE]
+                                                                  <-Reducer 59 [SIMPLE_EDGE]
                                                                     SHUFFLE [RS_110]
                                                                       PartitionCols:_col0, _col1, _col2
                                                                       Group By Operator [GBY_109] (rows=696954748 width=88)
                                                                         Output:["_col0","_col1","_col2","_col3"],aggregations:["count()"],keys:_col5, _col6, _col7
                                                                         Merge Join Operator [MERGEJOIN_853] (rows=696954748 width=88)
                                                                           Conds:RS_105._col1=RS_106._col0(Inner),Output:["_col5","_col6","_col7"]
-                                                                        <-Map 96 [SIMPLE_EDGE]
+                                                                        <-Map 56 [SIMPLE_EDGE]
                                                                           SHUFFLE [RS_106]
                                                                             PartitionCols:_col0
-                                                                            Select Operator [SEL_101] (rows=462000 width=1436)
-                                                                              Output:["_col0","_col1","_col2","_col3"]
-                                                                              Filter Operator [FIL_788] (rows=462000 width=1436)
-                                                                                predicate:(i_item_sk is not null and i_brand_id is not null and i_class_id is not null and i_category_id is not null)
-                                                                                 Please refer to the previous TableScan [TS_87]
-                                                                        <-Reducer 21 [SIMPLE_EDGE]
+                                                                             Please refer to the previous Select Operator [SEL_92]
+                                                                        <-Reducer 88 [SIMPLE_EDGE]
                                                                           SHUFFLE [RS_105]
                                                                             PartitionCols:_col1
                                                                             Merge Join Operator [MERGEJOIN_852] (rows=633595212 width=88)
                                                                               Conds:RS_102._col0=RS_103._col0(Inner),Output:["_col1"]
-                                                                            <-Map 17 [SIMPLE_EDGE]
+                                                                            <-Map 91 [SIMPLE_EDGE]
                                                                               SHUFFLE [RS_103]
                                                                                 PartitionCols:_col0
-                                                                                 Please refer to the previous Select Operator [SEL_5]
-                                                                            <-Map 97 [SIMPLE_EDGE]
+                                                                                 Please refer to the previous Select Operator [SEL_98]
+                                                                            <-Map 87 [SIMPLE_EDGE]
                                                                               SHUFFLE [RS_102]
                                                                                 PartitionCols:_col0
                                                                                  Please refer to the previous Select Operator [SEL_95]
-                                                            <-Reducer 32 [CONTAINS]
+                                                            <-Reducer 64 [CONTAINS]
                                                               Reduce Output Operator [RS_157]
                                                                 PartitionCols:_col0, _col1, _col2
                                                                 Group By Operator [GBY_156] (rows=609832849 width=108)
                                                                   Output:["_col0","_col1","_col2","_col3"],aggregations:["count(_col3)"],keys:_col0, _col1, _col2
                                                                   Group By Operator [GBY_131] (rows=174233858 width=135)
                                                                     Output:["_col0","_col1","_col2","_col3"],aggregations:["count(VALUE._col0)"],keys:KEY._col0, KEY._col1, KEY._col2
-                                                                  <-Reducer 31 [SIMPLE_EDGE]
+                                                                  <-Reducer 63 [SIMPLE_EDGE]
                                                                     SHUFFLE [RS_130]
                                                                       PartitionCols:_col0, _col1, _col2
                                                                       Group By Operator [GBY_129] (rows=348467716 width=135)
                                                                         Output:["_col0","_col1","_col2","_col3"],aggregations:["count()"],keys:_col5, _col6, _col7
                                                                         Merge Join Operator [MERGEJOIN_855] (rows=348467716 width=135)
                                                                           Conds:RS_125._col1=RS_126._col0(Inner),Output:["_col5","_col6","_col7"]
-                                                                        <-Map 96 [SIMPLE_EDGE]
+                                                                        <-Map 56 [SIMPLE_EDGE]
                                                                           SHUFFLE [RS_126]
                                                                             PartitionCols:_col0
-                                                                            Select Operator [SEL_121] (rows=462000 width=1436)
-                                                                              Output:["_col0","_col1","_col2","_col3"]
-                                                                              Filter Operator [FIL_791] (rows=462000 width=1436)
-                                                                                predicate:(i_item_sk is not null and i_brand_id is not null and i_class_id is not null and i_category_id is not null)
-                                                                                 Please refer to the previous TableScan [TS_87]
-                                                                        <-Reducer 30 [SIMPLE_EDGE]
+                                                                             Please refer to the previous Select Operator [SEL_92]
+                                                                        <-Reducer 92 [SIMPLE_EDGE]
                                                                           SHUFFLE [RS_125]
                                                                             PartitionCols:_col1
                                                                             Merge Join Operator [MERGEJOIN_854] (rows=316788826 width=135)
                                                                               Conds:RS_122._col0=RS_123._col0(Inner),Output:["_col1"]
-                                                                            <-Map 17 [SIMPLE_EDGE]
+                                                                            <-Map 91 [SIMPLE_EDGE]
                                                                               SHUFFLE [RS_123]
                                                                                 PartitionCols:_col0
-                                                                                 Please refer to the previous Select Operator [SEL_5]
+                                                                                 Please refer to the previous Select Operator [SEL_98]
                                                                             <-Map 98 [SIMPLE_EDGE]
                                                                               SHUFFLE [RS_122]
                                                                                 PartitionCols:_col0
                                                                                  Please refer to the previous Select Operator [SEL_115]
-                                                            <-Reducer 35 [CONTAINS]
+                                                            <-Reducer 66 [CONTAINS]
                                                               Reduce Output Operator [RS_157]
                                                                 PartitionCols:_col0, _col1, _col2
                                                                 Group By Operator [GBY_156] (rows=609832849 width=108)
                                                                   Output:["_col0","_col1","_col2","_col3"],aggregations:["count(_col3)"],keys:_col0, _col1, _col2
                                                                   Group By Operator [GBY_152] (rows=87121617 width=135)
                                                                     Output:["_col0","_col1","_col2","_col3"],aggregations:["count(VALUE._col0)"],keys:KEY._col0, KEY._col1, KEY._col2
-                                                                  <-Reducer 34 [SIMPLE_EDGE]
+                                                                  <-Reducer 65 [SIMPLE_EDGE]
                                                                     SHUFFLE [RS_151]
                                                                       PartitionCols:_col0, _col1, _col2
                                                                       Group By Operator [GBY_150] (rows=174243235 width=135)
                                                                         Output:["_col0","_col1","_col2","_col3"],aggregations:["count()"],keys:_col5, _col6, _col7
                                                                         Merge Join Operator [MERGEJOIN_857] (rows=174243235 width=135)
                                                                           Conds:RS_146._col1=RS_147._col0(Inner),Output:["_col5","_col6","_col7"]
-                                                                        <-Map 96 [SIMPLE_EDGE]
+                                                                        <-Map 56 [SIMPLE_EDGE]
                                                                           SHUFFLE [RS_147]
                                                                             PartitionCols:_col0
-                                                                            Select Operator [SEL_142] (rows=462000 width=1436)
-                                                                              Output:["_col0","_col1","_col2","_col3"]
-                                                                              Filter Operator [FIL_794] (rows=462000 width=1436)
-                                                                                predicate:(i_item_sk is not null and i_brand_id is not null and i_class_id is not null and i_category_id is not null)
-                                                                                 Please refer to the previous TableScan [TS_87]
-                                                                        <-Reducer 33 [SIMPLE_EDGE]
+                                                                             Please refer to the previous Select Operator [SEL_92]
+                                                                        <-Reducer 93 [SIMPLE_EDGE]
                                                                           SHUFFLE [RS_146]
                                                                             PartitionCols:_col1
                                                                             Merge Join Operator [MERGEJOIN_856] (rows=158402938 width=135)
                                                                               Conds:RS_143._col0=RS_144._col0(Inner),Output:["_col1"]
-                                                                            <-Map 17 [SIMPLE_EDGE]
+                                                                            <-Map 91 [SIMPLE_EDGE]
                                                                               SHUFFLE [RS_144]
                                                                                 PartitionCols:_col0
-                                                                                 Please refer to the previous Select Operator [SEL_5]
+                                                                                 Please refer to the previous Select Operator [SEL_98]
                                                                             <-Map 99 [SIMPLE_EDGE]
                                                                               SHUFFLE [RS_143]
                                                                                 PartitionCols:_col0
                                                                                  Please refer to the previous Select Operator [SEL_136]
-                                        <-Reducer 92 [SIMPLE_EDGE]
-                                          SHUFFLE [RS_172]
-                                            PartitionCols:_col1
-                                            Merge Join Operator [MERGEJOIN_851] (rows=633595212 width=88)
-                                              Conds:RS_169._col0=RS_170._col0(Inner),Output:["_col1","_col2","_col3"]
-                                            <-Map 93 [SIMPLE_EDGE]
-                                              SHUFFLE [RS_170]
-                                                PartitionCols:_col0
-                                                 Please refer to the previous Select Operator [SEL_86]
-                                            <-Map 91 [SIMPLE_EDGE]
-                                              SHUFFLE [RS_169]
-                                                PartitionCols:_col0
-                                                Select Operator [SEL_83] (rows=575995635 width=88)
-                                                  Output:["_col0","_col1","_col2","_col3"]
-                                                  Filter Operator [FIL_782] (rows=575995635 width=88)
-                                                    predicate:(ss_item_sk is not null and ss_sold_date_sk is not null)
-                                                    TableScan [TS_81] (rows=575995635 width=88)
-                                                      default@store_sales,store_sales,Tbl:COMPLETE,Col:NONE,Output:["ss_sold_date_sk","ss_item_sk","ss_quantity","ss_list_price"]
-                            <-Reducer 4 [CUSTOM_SIMPLE_EDGE]
-                              PARTITION_ONLY_SHUFFLE [RS_182]
-                                Select Operator [SEL_43] (rows=1 width=8)
-                                  Filter Operator [FIL_42] (rows=1 width=8)
-                                    predicate:(sq_count_check(_col0) <= 1)
-                                    Group By Operator [GBY_40] (rows=1 width=8)
-                                      Output:["_col0"],aggregations:["count()"]
-                                      Select Operator [SEL_35] (rows=1 width=8)
-                                        Group By Operator [GBY_34] (rows=1 width=8)
-                                          Output:["_col0"],aggregations:["count(VALUE._col0)"]
-                                        <-Union 3 [CUSTOM_SIMPLE_EDGE]
-                                          <-Reducer 2 [CONTAINS]
-                                            Reduce Output Operator [RS_33]
-                                              Group By Operator [GBY_32] (rows=1 width=8)
-                                                Output:["_col0"],aggregations:["count(_col0)"]
-                                                Select Operator [SEL_31] (rows=1108786976 width=108)
-                                                  Output:["_col0"]
-                                                  Select Operator [SEL_9] (rows=633595212 width=88)
-                                                    Output:["_col0"]
-                                                    Merge Join Operator [MERGEJOIN_845] (rows=633595212 width=88)
-                                                      Conds:RS_6._col0=RS_7._col0(Inner),Output:["_col1"]
-                                                    <-Map 17 [SIMPLE_EDGE]
-                                                      SHUFFLE [RS_7]
-                                                        PartitionCols:_col0
-                                                         Please refer to the previous Select Operator [SEL_5]
-                                                    <-Map 1 [SIMPLE_EDGE]
-                                                      SHUFFLE [RS_6]
-                                                        PartitionCols:_col0
-                                                         Please refer to the previous Select Operator [SEL_2]
-                                          <-Reducer 73 [CONTAINS]
-                                            Reduce Output Operator [RS_33]
-                                              Group By Operator [GBY_32] (rows=1 width=8)
-                                                Output:["_col0"],aggregations:["count(_col0)"]
-                                                Select Operator [SEL_31] (rows=1108786976 width=108)
-                                                  Output:["_col0"]
-                                                  Select Operator [SEL_19] (rows=316788826 width=135)
-                                                    Output:["_col0"]
-                                                    Merge Join Operator [MERGEJOIN_846] (rows=316788826 width=135)
-                                                      Conds:RS_16._col0=RS_17._col0(Inner),Output:["_col1"]
-                                                    <-Map 76 [SIMPLE_EDGE]
-                                                      SHUFFLE [RS_17]
-                                                        PartitionCols:_col0
-                                                         Please refer to the previous Select Operator [SEL_15]
-                                                    <-Map 72 [SIMPLE_EDGE]
-                                                      SHUFFLE [RS_16]
-                                                        PartitionCols:_col0
-                                                         Please refer to the previous Select Operator [SEL_12]
-                                          <-Reducer 81 [CONTAINS]
-                                            Reduce Output Operator [RS_33]
-                                              Group By Operator [GBY_32] (rows=1 width=8)
-                                                Output:["_col0"],aggregations:["count(_col0)"]
-                                                Select Operator [SEL_31] (rows=1108786976 width=108)
-                                                  Output:["_col0"]
-                                                  Select Operator [SEL_30] (rows=158402938 width=135)
-                                                    Output:["_col0"]
-                                                    Merge Join Operator [MERGEJOIN_847] (rows=158402938 width=135)
-                                                      Conds:RS_27._col0=RS_28._col0(Inner),Output:["_col1"]
-                                                    <-Map 84 [SIMPLE_EDGE]
-                                                      SHUFFLE [RS_28]
-                                                        PartitionCols:_col0
-                                                         Please refer to the previous Select Operator [SEL_26]
-                                                    <-Map 80 [SIMPLE_EDGE]
-                                                      SHUFFLE [RS_27]
-                                                        PartitionCols:_col0
-                                                         Please refer to the previous Select Operator [SEL_23]
 
diff --git a/ql/src/test/results/clientpositive/perf/query23.q.out b/ql/src/test/results/clientpositive/perf/query23.q.out
index ebd2271108..dde707d0ea 100644
--- a/ql/src/test/results/clientpositive/perf/query23.q.out
+++ b/ql/src/test/results/clientpositive/perf/query23.q.out
@@ -114,29 +114,29 @@ Reducer 16 <- Map 19 (SIMPLE_EDGE), Reducer 15 (SIMPLE_EDGE)
 Reducer 17 <- Reducer 16 (SIMPLE_EDGE)
 Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 7 (SIMPLE_EDGE)
 Reducer 21 <- Map 20 (SIMPLE_EDGE), Map 31 (SIMPLE_EDGE)
-Reducer 22 <- Map 40 (SIMPLE_EDGE), Reducer 21 (SIMPLE_EDGE)
+Reducer 22 <- Map 46 (SIMPLE_EDGE), Reducer 21 (SIMPLE_EDGE)
 Reducer 23 <- Reducer 22 (SIMPLE_EDGE)
 Reducer 24 <- Reducer 23 (CUSTOM_SIMPLE_EDGE)
-Reducer 25 <- Reducer 24 (CUSTOM_SIMPLE_EDGE), Reducer 35 (CUSTOM_SIMPLE_EDGE), Reducer 42 (CUSTOM_SIMPLE_EDGE)
+Reducer 25 <- Reducer 24 (CUSTOM_SIMPLE_EDGE), Reducer 35 (CUSTOM_SIMPLE_EDGE), Reducer 43 (CUSTOM_SIMPLE_EDGE)
 Reducer 26 <- Map 20 (SIMPLE_EDGE), Map 31 (SIMPLE_EDGE)
-Reducer 27 <- Map 40 (SIMPLE_EDGE), Reducer 26 (SIMPLE_EDGE)
+Reducer 27 <- Map 46 (SIMPLE_EDGE), Reducer 26 (SIMPLE_EDGE)
 Reducer 28 <- Reducer 27 (SIMPLE_EDGE)
 Reducer 29 <- Reducer 28 (CUSTOM_SIMPLE_EDGE)
 Reducer 3 <- Reducer 14 (SIMPLE_EDGE), Reducer 2 (SIMPLE_EDGE)
-Reducer 30 <- Reducer 29 (CUSTOM_SIMPLE_EDGE), Reducer 39 (CUSTOM_SIMPLE_EDGE), Reducer 44 (CUSTOM_SIMPLE_EDGE)
-Reducer 32 <- Map 31 (SIMPLE_EDGE), Map 45 (SIMPLE_EDGE)
-Reducer 33 <- Map 40 (SIMPLE_EDGE), Reducer 32 (SIMPLE_EDGE)
+Reducer 30 <- Reducer 29 (CUSTOM_SIMPLE_EDGE), Reducer 39 (CUSTOM_SIMPLE_EDGE), Reducer 45 (CUSTOM_SIMPLE_EDGE)
+Reducer 32 <- Map 31 (SIMPLE_EDGE), Map 40 (SIMPLE_EDGE)
+Reducer 33 <- Map 46 (SIMPLE_EDGE), Reducer 32 (SIMPLE_EDGE)
 Reducer 34 <- Reducer 33 (SIMPLE_EDGE)
 Reducer 35 <- Reducer 34 (CUSTOM_SIMPLE_EDGE)
-Reducer 36 <- Map 31 (SIMPLE_EDGE), Map 45 (SIMPLE_EDGE)
-Reducer 37 <- Map 40 (SIMPLE_EDGE), Reducer 36 (SIMPLE_EDGE)
+Reducer 36 <- Map 31 (SIMPLE_EDGE), Map 40 (SIMPLE_EDGE)
+Reducer 37 <- Map 46 (SIMPLE_EDGE), Reducer 36 (SIMPLE_EDGE)
 Reducer 38 <- Reducer 37 (SIMPLE_EDGE)
 Reducer 39 <- Reducer 38 (CUSTOM_SIMPLE_EDGE)
 Reducer 4 <- Reducer 25 (SIMPLE_EDGE), Reducer 3 (SIMPLE_EDGE), Union 5 (CONTAINS)
-Reducer 41 <- Map 40 (SIMPLE_EDGE), Map 46 (SIMPLE_EDGE)
-Reducer 42 <- Reducer 41 (SIMPLE_EDGE)
-Reducer 43 <- Map 40 (SIMPLE_EDGE), Map 46 (SIMPLE_EDGE)
-Reducer 44 <- Reducer 43 (SIMPLE_EDGE)
+Reducer 42 <- Map 41 (SIMPLE_EDGE), Map 46 (SIMPLE_EDGE)
+Reducer 43 <- Reducer 42 (SIMPLE_EDGE)
+Reducer 44 <- Map 41 (SIMPLE_EDGE), Map 46 (SIMPLE_EDGE)
+Reducer 45 <- Reducer 44 (SIMPLE_EDGE)
 Reducer 6 <- Union 5 (CUSTOM_SIMPLE_EDGE)
 Reducer 8 <- Map 47 (SIMPLE_EDGE), Map 7 (SIMPLE_EDGE)
 Reducer 9 <- Reducer 17 (SIMPLE_EDGE), Reducer 8 (SIMPLE_EDGE)
@@ -192,14 +192,14 @@ Stage-0
                                                     Output:["_col0"]
                                                     Merge Join Operator [MERGEJOIN_361] (rows=696954748 width=88)
                                                       Conds:RS_164._col1=RS_165._col0(Inner),Output:["_col6"]
-                                                    <-Map 40 [SIMPLE_EDGE]
+                                                    <-Map 46 [SIMPLE_EDGE]
                                                       SHUFFLE [RS_165]
                                                         PartitionCols:_col0
-                                                        Select Operator [SEL_41] (rows=80000000 width=860)
+                                                        Select Operator [SEL_93] (rows=80000000 width=860)
                                                           Output:["_col0"]
-                                                          Filter Operator [FIL_328] (rows=80000000 width=860)
+                                                          Filter Operator [FIL_333] (rows=80000000 width=860)
                                                             predicate:c_customer_sk is not null
-                                                            TableScan [TS_39] (rows=80000000 width=860)
+                                                            TableScan [TS_91] (rows=80000000 width=860)
                                                               default@customer,customer,Tbl:COMPLETE,Col:NONE,Output:["c_customer_sk"]
                                                     <-Reducer 26 [SIMPLE_EDGE]
                                                       SHUFFLE [RS_164]
@@ -245,10 +245,10 @@ Stage-0
                                                 Output:["_col0","_col1"]
                                                 Merge Join Operator [MERGEJOIN_363] (rows=696954748 width=88)
                                                   Conds:RS_193._col1=RS_194._col0(Inner),Output:["_col2","_col3","_col6"]
-                                                <-Map 40 [SIMPLE_EDGE]
+                                                <-Map 46 [SIMPLE_EDGE]
                                                   SHUFFLE [RS_194]
                                                     PartitionCols:_col0
-                                                     Please refer to the previous Select Operator [SEL_41]
+                                                     Please refer to the previous Select Operator [SEL_93]
                                                 <-Reducer 36 [SIMPLE_EDGE]
                                                   SHUFFLE [RS_193]
                                                     PartitionCols:_col1
@@ -258,7 +258,7 @@ Stage-0
                                                       SHUFFLE [RS_191]
                                                         PartitionCols:_col0
                                                          Please refer to the previous Select Operator [SEL_38]
-                                                    <-Map 45 [SIMPLE_EDGE]
+                                                    <-Map 40 [SIMPLE_EDGE]
                                                       SHUFFLE [RS_190]
                                                         PartitionCols:_col0
                                                         Select Operator [SEL_64] (rows=575995635 width=88)
@@ -267,11 +267,11 @@ Stage-0
                                                             predicate:(ss_customer_sk is not null and ss_sold_date_sk is not null)
                                                             TableScan [TS_62] (rows=575995635 width=88)
                                                               default@store_sales,store_sales,Tbl:COMPLETE,Col:NONE,Output:["ss_sold_date_sk","ss_customer_sk","ss_quantity","ss_sales_price"]
-                            <-Reducer 44 [CUSTOM_SIMPLE_EDGE]
+                            <-Reducer 45 [CUSTOM_SIMPLE_EDGE]
                               PARTITION_ONLY_SHUFFLE [RS_224]
                                 Group By Operator [GBY_220] (rows=316797606 width=88)
                                   Output:["_col0","_col1"],aggregations:["sum(VALUE._col0)"],keys:KEY._col0
-                                <-Reducer 43 [SIMPLE_EDGE]
+                                <-Reducer 44 [SIMPLE_EDGE]
                                   SHUFFLE [RS_219]
                                     PartitionCols:_col0
                                     Group By Operator [GBY_218] (rows=633595212 width=88)
@@ -280,11 +280,11 @@ Stage-0
                                         Output:["_col0","_col1"]
                                         Merge Join Operator [MERGEJOIN_364] (rows=633595212 width=88)
                                           Conds:RS_213._col0=RS_214._col0(Inner),Output:["_col1","_col2","_col3"]
-                                        <-Map 40 [SIMPLE_EDGE]
+                                        <-Map 46 [SIMPLE_EDGE]
                                           SHUFFLE [RS_214]
                                             PartitionCols:_col0
-                                             Please refer to the previous Select Operator [SEL_41]
-                                        <-Map 46 [SIMPLE_EDGE]
+                                             Please refer to the previous Select Operator [SEL_93]
+                                        <-Map 41 [SIMPLE_EDGE]
                                           SHUFFLE [RS_213]
                                             PartitionCols:_col0
                                             Select Operator [SEL_90] (rows=575995635 width=88)
@@ -415,10 +415,10 @@ Stage-0
                                                     Output:["_col0"]
                                                     Merge Join Operator [MERGEJOIN_353] (rows=696954748 width=88)
                                                       Conds:RS_45._col1=RS_46._col0(Inner),Output:["_col6"]
-                                                    <-Map 40 [SIMPLE_EDGE]
+                                                    <-Map 46 [SIMPLE_EDGE]
                                                       SHUFFLE [RS_46]
                                                         PartitionCols:_col0
-                                                         Please refer to the previous Select Operator [SEL_41]
+                                                         Please refer to the previous Select Operator [SEL_93]
                                                     <-Reducer 21 [SIMPLE_EDGE]
                                                       SHUFFLE [RS_45]
                                                         PartitionCols:_col1
@@ -453,10 +453,10 @@ Stage-0
                                                 Output:["_col0","_col1"]
                                                 Merge Join Operator [MERGEJOIN_355] (rows=696954748 width=88)
                                                   Conds:RS_74._col1=RS_75._col0(Inner),Output:["_col2","_col3","_col6"]
-                                                <-Map 40 [SIMPLE_EDGE]
+                                                <-Map 46 [SIMPLE_EDGE]
                                                   SHUFFLE [RS_75]
                                                     PartitionCols:_col0
-                                                     Please refer to the previous Select Operator [SEL_41]
+                                                     Please refer to the previous Select Operator [SEL_93]
                                                 <-Reducer 32 [SIMPLE_EDGE]
                                                   SHUFFLE [RS_74]
                                                     PartitionCols:_col1
@@ -466,15 +466,15 @@ Stage-0
                                                       SHUFFLE [RS_72]
                                                         PartitionCols:_col0
                                                          Please refer to the previous Select Operator [SEL_38]
-                                                    <-Map 45 [SIMPLE_EDGE]
+                                                    <-Map 40 [SIMPLE_EDGE]
                                                       SHUFFLE [RS_71]
                                                         PartitionCols:_col0
                                                          Please refer to the previous Select Operator [SEL_64]
-                            <-Reducer 42 [CUSTOM_SIMPLE_EDGE]
+                            <-Reducer 43 [CUSTOM_SIMPLE_EDGE]
                               PARTITION_ONLY_SHUFFLE [RS_105]
                                 Group By Operator [GBY_101] (rows=316797606 width=88)
                                   Output:["_col0","_col1"],aggregations:["sum(VALUE._col0)"],keys:KEY._col0
-                                <-Reducer 41 [SIMPLE_EDGE]
+                                <-Reducer 42 [SIMPLE_EDGE]
                                   SHUFFLE [RS_100]
                                     PartitionCols:_col0
                                     Group By Operator [GBY_99] (rows=633595212 width=88)
@@ -483,11 +483,11 @@ Stage-0
                                         Output:["_col0","_col1"]
                                         Merge Join Operator [MERGEJOIN_356] (rows=633595212 width=88)
                                           Conds:RS_94._col0=RS_95._col0(Inner),Output:["_col1","_col2","_col3"]
-                                        <-Map 40 [SIMPLE_EDGE]
+                                        <-Map 46 [SIMPLE_EDGE]
                                           SHUFFLE [RS_95]
                                             PartitionCols:_col0
-                                             Please refer to the previous Select Operator [SEL_41]
-                                        <-Map 46 [SIMPLE_EDGE]
+                                             Please refer to the previous Select Operator [SEL_93]
+                                        <-Map 41 [SIMPLE_EDGE]
                                           SHUFFLE [RS_94]
                                             PartitionCols:_col0
                                              Please refer to the previous Select Operator [SEL_90]
diff --git a/ql/src/test/results/clientpositive/perf/query4.q.out b/ql/src/test/results/clientpositive/perf/query4.q.out
index b03a91ea8d..1494710ece 100644
--- a/ql/src/test/results/clientpositive/perf/query4.q.out
+++ b/ql/src/test/results/clientpositive/perf/query4.q.out
@@ -218,24 +218,24 @@ Plan optimized by CBO.
 
 Vertex dependency in root stage
 Reducer 11 <- Map 10 (SIMPLE_EDGE), Map 24 (SIMPLE_EDGE)
-Reducer 12 <- Map 23 (SIMPLE_EDGE), Reducer 11 (SIMPLE_EDGE)
+Reducer 12 <- Map 25 (SIMPLE_EDGE), Reducer 11 (SIMPLE_EDGE)
 Reducer 13 <- Reducer 12 (SIMPLE_EDGE)
-Reducer 14 <- Map 10 (SIMPLE_EDGE), Map 25 (SIMPLE_EDGE)
-Reducer 15 <- Map 23 (SIMPLE_EDGE), Reducer 14 (SIMPLE_EDGE)
+Reducer 14 <- Map 10 (SIMPLE_EDGE), Map 24 (SIMPLE_EDGE)
+Reducer 15 <- Map 25 (SIMPLE_EDGE), Reducer 14 (SIMPLE_EDGE)
 Reducer 16 <- Reducer 15 (SIMPLE_EDGE)
-Reducer 17 <- Map 10 (SIMPLE_EDGE), Map 25 (SIMPLE_EDGE)
-Reducer 18 <- Map 23 (SIMPLE_EDGE), Reducer 17 (SIMPLE_EDGE)
-Reducer 19 <- Reducer 18 (SIMPLE_EDGE)
-Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 10 (SIMPLE_EDGE)
-Reducer 20 <- Map 10 (SIMPLE_EDGE), Map 24 (SIMPLE_EDGE)
-Reducer 21 <- Map 23 (SIMPLE_EDGE), Reducer 20 (SIMPLE_EDGE)
-Reducer 22 <- Reducer 21 (SIMPLE_EDGE)
-Reducer 3 <- Map 23 (SIMPLE_EDGE), Reducer 2 (SIMPLE_EDGE)
+Reducer 18 <- Map 17 (SIMPLE_EDGE), Map 24 (SIMPLE_EDGE)
+Reducer 19 <- Map 25 (SIMPLE_EDGE), Reducer 18 (SIMPLE_EDGE)
+Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 24 (SIMPLE_EDGE)
+Reducer 20 <- Reducer 19 (SIMPLE_EDGE)
+Reducer 21 <- Map 17 (SIMPLE_EDGE), Map 24 (SIMPLE_EDGE)
+Reducer 22 <- Map 25 (SIMPLE_EDGE), Reducer 21 (SIMPLE_EDGE)
+Reducer 23 <- Reducer 22 (SIMPLE_EDGE)
+Reducer 3 <- Map 25 (SIMPLE_EDGE), Reducer 2 (SIMPLE_EDGE)
 Reducer 4 <- Reducer 3 (SIMPLE_EDGE)
-Reducer 5 <- Reducer 13 (SIMPLE_EDGE), Reducer 16 (SIMPLE_EDGE), Reducer 19 (SIMPLE_EDGE), Reducer 22 (SIMPLE_EDGE), Reducer 4 (SIMPLE_EDGE), Reducer 9 (SIMPLE_EDGE)
+Reducer 5 <- Reducer 13 (SIMPLE_EDGE), Reducer 16 (SIMPLE_EDGE), Reducer 20 (SIMPLE_EDGE), Reducer 23 (SIMPLE_EDGE), Reducer 4 (SIMPLE_EDGE), Reducer 9 (SIMPLE_EDGE)
 Reducer 6 <- Reducer 5 (SIMPLE_EDGE)
-Reducer 7 <- Map 1 (SIMPLE_EDGE), Map 10 (SIMPLE_EDGE)
-Reducer 8 <- Map 23 (SIMPLE_EDGE), Reducer 7 (SIMPLE_EDGE)
+Reducer 7 <- Map 1 (SIMPLE_EDGE), Map 24 (SIMPLE_EDGE)
+Reducer 8 <- Map 25 (SIMPLE_EDGE), Reducer 7 (SIMPLE_EDGE)
 Reducer 9 <- Reducer 8 (SIMPLE_EDGE)
 
 Stage-0
@@ -257,55 +257,53 @@ Stage-0
                   Merge Join Operator [MERGEJOIN_296] (rows=1916625598 width=88)
                     Conds:RS_129._col0=RS_130._col0(Inner),RS_130._col0=RS_131._col0(Inner),RS_130._col0=RS_132._col0(Inner),RS_130._col0=RS_133._col0(Inner),RS_130._col0=RS_134._col0(Inner),Output:["_col7","_col15","_col23","_col31","_col39","_col43","_col47"]
                   <-Reducer 13 [SIMPLE_EDGE]
-                    SHUFFLE [RS_130]
+                    SHUFFLE [RS_133]
                       PartitionCols:_col0
-                      Filter Operator [FIL_41] (rows=116159124 width=88)
-                        predicate:(_col7 > 0)
-                        Select Operator [SEL_283] (rows=348477374 width=88)
-                          Output:["_col0","_col7"]
-                          Group By Operator [GBY_40] (rows=348477374 width=88)
-                            Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7"],aggregations:["sum(VALUE._col0)"],keys:KEY._col0, KEY._col1, KEY._col2, KEY._col3, KEY._col4, KEY._col5, KEY._col6
-                          <-Reducer 12 [SIMPLE_EDGE]
-                            SHUFFLE [RS_39]
-                              PartitionCols:_col0, _col1, _col2, _col3, _col4, _col5, _col6
-                              Group By Operator [GBY_38] (rows=696954748 width=88)
-                                Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7"],aggregations:["sum(_col7)"],keys:_col0, _col1, _col2, _col3, _col4, _col5, _col6
-                                Select Operator [SEL_36] (rows=696954748 width=88)
-                                  Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7"]
-                                  Merge Join Operator [MERGEJOIN_287] (rows=696954748 width=88)
-                                    Conds:RS_33._col1=RS_34._col0(Inner),Output:["_col2","_col3","_col4","_col5","_col9","_col10","_col11","_col12","_col13","_col14","_col15"]
-                                  <-Map 23 [SIMPLE_EDGE]
-                                    SHUFFLE [RS_34]
-                                      PartitionCols:_col0
-                                      Select Operator [SEL_8] (rows=80000000 width=860)
-                                        Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7"]
-                                        Filter Operator [FIL_265] (rows=80000000 width=860)
-                                          predicate:(c_customer_sk is not null and c_customer_id is not null)
-                                          TableScan [TS_6] (rows=80000000 width=860)
-                                            default@customer,customer,Tbl:COMPLETE,Col:NONE,Output:["c_customer_sk","c_customer_id","c_first_name","c_last_name","c_preferred_cust_flag","c_birth_country","c_login","c_email_address"]
-                                  <-Reducer 11 [SIMPLE_EDGE]
-                                    SHUFFLE [RS_33]
-                                      PartitionCols:_col1
-                                      Merge Join Operator [MERGEJOIN_286] (rows=633595212 width=88)
-                                        Conds:RS_30._col0=RS_31._col0(Inner),Output:["_col1","_col2","_col3","_col4","_col5"]
-                                      <-Map 10 [SIMPLE_EDGE]
-                                        SHUFFLE [RS_31]
-                                          PartitionCols:_col0
-                                          Select Operator [SEL_26] (rows=36524 width=1119)
-                                            Output:["_col0"]
-                                            Filter Operator [FIL_267] (rows=36524 width=1119)
-                                              predicate:((d_year = 2001) and d_date_sk is not null)
-                                              TableScan [TS_3] (rows=73049 width=1119)
-                                                default@date_dim,date_dim,Tbl:COMPLETE,Col:NONE,Output:["d_date_sk","d_year"]
-                                      <-Map 24 [SIMPLE_EDGE]
-                                        SHUFFLE [RS_30]
-                                          PartitionCols:_col0
-                                          Select Operator [SEL_23] (rows=575995635 width=88)
-                                            Output:["_col0","_col1","_col2","_col3","_col4","_col5"]
-                                            Filter Operator [FIL_266] (rows=575995635 width=88)
-                                              predicate:(ss_customer_sk is not null and ss_sold_date_sk is not null)
-                                              TableScan [TS_21] (rows=575995635 width=88)
-                                                default@store_sales,store_sales,Tbl:COMPLETE,Col:NONE,Output:["ss_sold_date_sk","ss_customer_sk","ss_ext_discount_amt","ss_ext_sales_price","ss_ext_wholesale_cost","ss_ext_list_price"]
+                      Select Operator [SEL_107] (rows=174233858 width=135)
+                        Output:["_col0","_col7"]
+                        Group By Operator [GBY_106] (rows=174233858 width=135)
+                          Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7"],aggregations:["sum(VALUE._col0)"],keys:KEY._col0, KEY._col1, KEY._col2, KEY._col3, KEY._col4, KEY._col5, KEY._col6
+                        <-Reducer 12 [SIMPLE_EDGE]
+                          SHUFFLE [RS_105]
+                            PartitionCols:_col0, _col1, _col2, _col3, _col4, _col5, _col6
+                            Group By Operator [GBY_104] (rows=348467716 width=135)
+                              Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7"],aggregations:["sum(_col7)"],keys:_col0, _col1, _col2, _col3, _col4, _col5, _col6
+                              Select Operator [SEL_102] (rows=348467716 width=135)
+                                Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7"]
+                                Merge Join Operator [MERGEJOIN_293] (rows=348467716 width=135)
+                                  Conds:RS_99._col1=RS_100._col0(Inner),Output:["_col2","_col3","_col4","_col5","_col9","_col10","_col11","_col12","_col13","_col14","_col15"]
+                                <-Map 25 [SIMPLE_EDGE]
+                                  SHUFFLE [RS_100]
+                                    PartitionCols:_col0
+                                    Select Operator [SEL_116] (rows=80000000 width=860)
+                                      Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7"]
+                                      Filter Operator [FIL_280] (rows=80000000 width=860)
+                                        predicate:(c_customer_sk is not null and c_customer_id is not null)
+                                        TableScan [TS_114] (rows=80000000 width=860)
+                                          default@customer,customer,Tbl:COMPLETE,Col:NONE,Output:["c_customer_sk","c_customer_id","c_first_name","c_last_name","c_preferred_cust_flag","c_birth_country","c_login","c_email_address"]
+                                <-Reducer 11 [SIMPLE_EDGE]
+                                  SHUFFLE [RS_99]
+                                    PartitionCols:_col1
+                                    Merge Join Operator [MERGEJOIN_292] (rows=316788826 width=135)
+                                      Conds:RS_96._col0=RS_97._col0(Inner),Output:["_col1","_col2","_col3","_col4","_col5"]
+                                    <-Map 24 [SIMPLE_EDGE]
+                                      SHUFFLE [RS_97]
+                                        PartitionCols:_col0
+                                        Select Operator [SEL_113] (rows=36524 width=1119)
+                                          Output:["_col0"]
+                                          Filter Operator [FIL_279] (rows=36524 width=1119)
+                                            predicate:((d_year = 2002) and d_date_sk is not null)
+                                            TableScan [TS_111] (rows=73049 width=1119)
+                                              default@date_dim,date_dim,Tbl:COMPLETE,Col:NONE,Output:["d_date_sk","d_year"]
+                                    <-Map 10 [SIMPLE_EDGE]
+                                      SHUFFLE [RS_96]
+                                        PartitionCols:_col0
+                                        Select Operator [SEL_89] (rows=287989836 width=135)
+                                          Output:["_col0","_col1","_col2","_col3","_col4","_col5"]
+                                          Filter Operator [FIL_275] (rows=287989836 width=135)
+                                            predicate:(cs_bill_customer_sk is not null and cs_sold_date_sk is not null)
+                                            TableScan [TS_87] (rows=287989836 width=135)
+                                              default@catalog_sales,catalog_sales,Tbl:COMPLETE,Col:NONE,Output:["cs_sold_date_sk","cs_bill_customer_sk","cs_ext_discount_amt","cs_ext_sales_price","cs_ext_wholesale_cost","cs_ext_list_price"]
                   <-Reducer 16 [SIMPLE_EDGE]
                     SHUFFLE [RS_131]
                       PartitionCols:_col0
@@ -324,77 +322,35 @@ Stage-0
                                   Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7"]
                                   Merge Join Operator [MERGEJOIN_289] (rows=348467716 width=135)
                                     Conds:RS_55._col1=RS_56._col0(Inner),Output:["_col2","_col3","_col4","_col5","_col9","_col10","_col11","_col12","_col13","_col14","_col15"]
-                                  <-Map 23 [SIMPLE_EDGE]
+                                  <-Map 25 [SIMPLE_EDGE]
                                     SHUFFLE [RS_56]
                                       PartitionCols:_col0
-                                       Please refer to the previous Select Operator [SEL_8]
+                                       Please refer to the previous Select Operator [SEL_116]
                                   <-Reducer 14 [SIMPLE_EDGE]
                                     SHUFFLE [RS_55]
                                       PartitionCols:_col1
                                       Merge Join Operator [MERGEJOIN_288] (rows=316788826 width=135)
                                         Conds:RS_52._col0=RS_53._col0(Inner),Output:["_col1","_col2","_col3","_col4","_col5"]
-                                      <-Map 10 [SIMPLE_EDGE]
+                                      <-Map 24 [SIMPLE_EDGE]
                                         SHUFFLE [RS_53]
                                           PartitionCols:_col0
                                           Select Operator [SEL_48] (rows=36524 width=1119)
                                             Output:["_col0"]
                                             Filter Operator [FIL_270] (rows=36524 width=1119)
                                               predicate:((d_year = 2001) and d_date_sk is not null)
-                                               Please refer to the previous TableScan [TS_3]
-                                      <-Map 25 [SIMPLE_EDGE]
+                                               Please refer to the previous TableScan [TS_111]
+                                      <-Map 10 [SIMPLE_EDGE]
                                         SHUFFLE [RS_52]
                                           PartitionCols:_col0
-                                          Select Operator [SEL_45] (rows=287989836 width=135)
-                                            Output:["_col0","_col1","_col2","_col3","_col4","_col5"]
-                                            Filter Operator [FIL_269] (rows=287989836 width=135)
-                                              predicate:(cs_bill_customer_sk is not null and cs_sold_date_sk is not null)
-                                              TableScan [TS_43] (rows=287989836 width=135)
-                                                default@catalog_sales,catalog_sales,Tbl:COMPLETE,Col:NONE,Output:["cs_sold_date_sk","cs_bill_customer_sk","cs_ext_discount_amt","cs_ext_sales_price","cs_ext_wholesale_cost","cs_ext_list_price"]
-                  <-Reducer 19 [SIMPLE_EDGE]
-                    SHUFFLE [RS_133]
-                      PartitionCols:_col0
-                      Select Operator [SEL_107] (rows=174233858 width=135)
-                        Output:["_col0","_col7"]
-                        Group By Operator [GBY_106] (rows=174233858 width=135)
-                          Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7"],aggregations:["sum(VALUE._col0)"],keys:KEY._col0, KEY._col1, KEY._col2, KEY._col3, KEY._col4, KEY._col5, KEY._col6
-                        <-Reducer 18 [SIMPLE_EDGE]
-                          SHUFFLE [RS_105]
-                            PartitionCols:_col0, _col1, _col2, _col3, _col4, _col5, _col6
-                            Group By Operator [GBY_104] (rows=348467716 width=135)
-                              Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7"],aggregations:["sum(_col7)"],keys:_col0, _col1, _col2, _col3, _col4, _col5, _col6
-                              Select Operator [SEL_102] (rows=348467716 width=135)
-                                Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7"]
-                                Merge Join Operator [MERGEJOIN_293] (rows=348467716 width=135)
-                                  Conds:RS_99._col1=RS_100._col0(Inner),Output:["_col2","_col3","_col4","_col5","_col9","_col10","_col11","_col12","_col13","_col14","_col15"]
-                                <-Map 23 [SIMPLE_EDGE]
-                                  SHUFFLE [RS_100]
-                                    PartitionCols:_col0
-                                     Please refer to the previous Select Operator [SEL_8]
-                                <-Reducer 17 [SIMPLE_EDGE]
-                                  SHUFFLE [RS_99]
-                                    PartitionCols:_col1
-                                    Merge Join Operator [MERGEJOIN_292] (rows=316788826 width=135)
-                                      Conds:RS_96._col0=RS_97._col0(Inner),Output:["_col1","_col2","_col3","_col4","_col5"]
-                                    <-Map 10 [SIMPLE_EDGE]
-                                      SHUFFLE [RS_97]
-                                        PartitionCols:_col0
-                                        Select Operator [SEL_92] (rows=36524 width=1119)
-                                          Output:["_col0"]
-                                          Filter Operator [FIL_276] (rows=36524 width=1119)
-                                            predicate:((d_year = 2002) and d_date_sk is not null)
-                                             Please refer to the previous TableScan [TS_3]
-                                    <-Map 25 [SIMPLE_EDGE]
-                                      SHUFFLE [RS_96]
-                                        PartitionCols:_col0
-                                         Please refer to the previous Select Operator [SEL_45]
-                  <-Reducer 22 [SIMPLE_EDGE]
+                                           Please refer to the previous Select Operator [SEL_89]
+                  <-Reducer 20 [SIMPLE_EDGE]
                     SHUFFLE [RS_134]
                       PartitionCols:_col0
                       Select Operator [SEL_128] (rows=348477374 width=88)
                         Output:["_col0","_col3","_col7"]
                         Group By Operator [GBY_127] (rows=348477374 width=88)
                           Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7"],aggregations:["sum(VALUE._col0)"],keys:KEY._col0, KEY._col1, KEY._col2, KEY._col3, KEY._col4, KEY._col5, KEY._col6
-                        <-Reducer 21 [SIMPLE_EDGE]
+                        <-Reducer 19 [SIMPLE_EDGE]
                           SHUFFLE [RS_126]
                             PartitionCols:_col0, _col1, _col2, _col3, _col4, _col5, _col6
                             Group By Operator [GBY_125] (rows=696954748 width=88)
@@ -403,27 +359,67 @@ Stage-0
                                 Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7"]
                                 Merge Join Operator [MERGEJOIN_295] (rows=696954748 width=88)
                                   Conds:RS_120._col1=RS_121._col0(Inner),Output:["_col2","_col3","_col4","_col5","_col9","_col10","_col11","_col12","_col13","_col14","_col15"]
-                                <-Map 23 [SIMPLE_EDGE]
+                                <-Map 25 [SIMPLE_EDGE]
                                   SHUFFLE [RS_121]
                                     PartitionCols:_col0
-                                     Please refer to the previous Select Operator [SEL_8]
-                                <-Reducer 20 [SIMPLE_EDGE]
+                                     Please refer to the previous Select Operator [SEL_116]
+                                <-Reducer 18 [SIMPLE_EDGE]
                                   SHUFFLE [RS_120]
                                     PartitionCols:_col1
                                     Merge Join Operator [MERGEJOIN_294] (rows=633595212 width=88)
                                       Conds:RS_117._col0=RS_118._col0(Inner),Output:["_col1","_col2","_col3","_col4","_col5"]
-                                    <-Map 10 [SIMPLE_EDGE]
+                                    <-Map 24 [SIMPLE_EDGE]
                                       SHUFFLE [RS_118]
                                         PartitionCols:_col0
-                                        Select Operator [SEL_113] (rows=36524 width=1119)
-                                          Output:["_col0"]
-                                          Filter Operator [FIL_279] (rows=36524 width=1119)
-                                            predicate:((d_year = 2002) and d_date_sk is not null)
-                                             Please refer to the previous TableScan [TS_3]
-                                    <-Map 24 [SIMPLE_EDGE]
+                                         Please refer to the previous Select Operator [SEL_113]
+                                    <-Map 17 [SIMPLE_EDGE]
                                       SHUFFLE [RS_117]
                                         PartitionCols:_col0
-                                         Please refer to the previous Select Operator [SEL_23]
+                                        Select Operator [SEL_110] (rows=575995635 width=88)
+                                          Output:["_col0","_col1","_col2","_col3","_col4","_col5"]
+                                          Filter Operator [FIL_278] (rows=575995635 width=88)
+                                            predicate:(ss_customer_sk is not null and ss_sold_date_sk is not null)
+                                            TableScan [TS_108] (rows=575995635 width=88)
+                                              default@store_sales,store_sales,Tbl:COMPLETE,Col:NONE,Output:["ss_sold_date_sk","ss_customer_sk","ss_ext_discount_amt","ss_ext_sales_price","ss_ext_wholesale_cost","ss_ext_list_price"]
+                  <-Reducer 23 [SIMPLE_EDGE]
+                    SHUFFLE [RS_130]
+                      PartitionCols:_col0
+                      Filter Operator [FIL_41] (rows=116159124 width=88)
+                        predicate:(_col7 > 0)
+                        Select Operator [SEL_283] (rows=348477374 width=88)
+                          Output:["_col0","_col7"]
+                          Group By Operator [GBY_40] (rows=348477374 width=88)
+                            Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7"],aggregations:["sum(VALUE._col0)"],keys:KEY._col0, KEY._col1, KEY._col2, KEY._col3, KEY._col4, KEY._col5, KEY._col6
+                          <-Reducer 22 [SIMPLE_EDGE]
+                            SHUFFLE [RS_39]
+                              PartitionCols:_col0, _col1, _col2, _col3, _col4, _col5, _col6
+                              Group By Operator [GBY_38] (rows=696954748 width=88)
+                                Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7"],aggregations:["sum(_col7)"],keys:_col0, _col1, _col2, _col3, _col4, _col5, _col6
+                                Select Operator [SEL_36] (rows=696954748 width=88)
+                                  Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7"]
+                                  Merge Join Operator [MERGEJOIN_287] (rows=696954748 width=88)
+                                    Conds:RS_33._col1=RS_34._col0(Inner),Output:["_col2","_col3","_col4","_col5","_col9","_col10","_col11","_col12","_col13","_col14","_col15"]
+                                  <-Map 25 [SIMPLE_EDGE]
+                                    SHUFFLE [RS_34]
+                                      PartitionCols:_col0
+                                       Please refer to the previous Select Operator [SEL_116]
+                                  <-Reducer 21 [SIMPLE_EDGE]
+                                    SHUFFLE [RS_33]
+                                      PartitionCols:_col1
+                                      Merge Join Operator [MERGEJOIN_286] (rows=633595212 width=88)
+                                        Conds:RS_30._col0=RS_31._col0(Inner),Output:["_col1","_col2","_col3","_col4","_col5"]
+                                      <-Map 24 [SIMPLE_EDGE]
+                                        SHUFFLE [RS_31]
+                                          PartitionCols:_col0
+                                          Select Operator [SEL_26] (rows=36524 width=1119)
+                                            Output:["_col0"]
+                                            Filter Operator [FIL_267] (rows=36524 width=1119)
+                                              predicate:((d_year = 2001) and d_date_sk is not null)
+                                               Please refer to the previous TableScan [TS_111]
+                                      <-Map 17 [SIMPLE_EDGE]
+                                        SHUFFLE [RS_30]
+                                          PartitionCols:_col0
+                                           Please refer to the previous Select Operator [SEL_110]
                   <-Reducer 4 [SIMPLE_EDGE]
                     SHUFFLE [RS_129]
                       PartitionCols:_col0
@@ -440,23 +436,19 @@ Stage-0
                                 Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7"]
                                 Merge Join Operator [MERGEJOIN_285] (rows=174243235 width=135)
                                   Conds:RS_12._col1=RS_13._col0(Inner),Output:["_col2","_col3","_col4","_col5","_col9","_col10","_col11","_col12","_col13","_col14","_col15"]
-                                <-Map 23 [SIMPLE_EDGE]
+                                <-Map 25 [SIMPLE_EDGE]
                                   SHUFFLE [RS_13]
                                     PartitionCols:_col0
-                                     Please refer to the previous Select Operator [SEL_8]
+                                     Please refer to the previous Select Operator [SEL_116]
                                 <-Reducer 2 [SIMPLE_EDGE]
                                   SHUFFLE [RS_12]
                                     PartitionCols:_col1
                                     Merge Join Operator [MERGEJOIN_284] (rows=158402938 width=135)
                                       Conds:RS_9._col0=RS_10._col0(Inner),Output:["_col1","_col2","_col3","_col4","_col5"]
-                                    <-Map 10 [SIMPLE_EDGE]
+                                    <-Map 24 [SIMPLE_EDGE]
                                       SHUFFLE [RS_10]
                                         PartitionCols:_col0
-                                        Select Operator [SEL_5] (rows=36524 width=1119)
-                                          Output:["_col0"]
-                                          Filter Operator [FIL_264] (rows=36524 width=1119)
-                                            predicate:((d_year = 2002) and d_date_sk is not null)
-                                             Please refer to the previous TableScan [TS_3]
+                                         Please refer to the previous Select Operator [SEL_113]
                                     <-Map 1 [SIMPLE_EDGE]
                                       SHUFFLE [RS_9]
                                         PartitionCols:_col0
@@ -484,23 +476,23 @@ Stage-0
                                   Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7"]
                                   Merge Join Operator [MERGEJOIN_291] (rows=174243235 width=135)
                                     Conds:RS_77._col1=RS_78._col0(Inner),Output:["_col2","_col3","_col4","_col5","_col9","_col10","_col11","_col12","_col13","_col14","_col15"]
-                                  <-Map 23 [SIMPLE_EDGE]
+                                  <-Map 25 [SIMPLE_EDGE]
                                     SHUFFLE [RS_78]
                                       PartitionCols:_col0
-                                       Please refer to the previous Select Operator [SEL_8]
+                                       Please refer to the previous Select Operator [SEL_116]
                                   <-Reducer 7 [SIMPLE_EDGE]
                                     SHUFFLE [RS_77]
                                       PartitionCols:_col1
                                       Merge Join Operator [MERGEJOIN_290] (rows=158402938 width=135)
                                         Conds:RS_74._col0=RS_75._col0(Inner),Output:["_col1","_col2","_col3","_col4","_col5"]
-                                      <-Map 10 [SIMPLE_EDGE]
+                                      <-Map 24 [SIMPLE_EDGE]
                                         SHUFFLE [RS_75]
                                           PartitionCols:_col0
                                           Select Operator [SEL_70] (rows=36524 width=1119)
                                             Output:["_col0"]
                                             Filter Operator [FIL_273] (rows=36524 width=1119)
                                               predicate:((d_year = 2001) and d_date_sk is not null)
-                                               Please refer to the previous TableScan [TS_3]
+                                               Please refer to the previous TableScan [TS_111]
                                       <-Map 1 [SIMPLE_EDGE]
                                         SHUFFLE [RS_74]
                                           PartitionCols:_col0
diff --git a/ql/src/test/results/clientpositive/perf/query47.q.out b/ql/src/test/results/clientpositive/perf/query47.q.out
index efbd89cc4f..1d4f36be1d 100644
--- a/ql/src/test/results/clientpositive/perf/query47.q.out
+++ b/ql/src/test/results/clientpositive/perf/query47.q.out
@@ -105,10 +105,10 @@ Reducer 10 <- Map 21 (SIMPLE_EDGE), Reducer 9 (SIMPLE_EDGE)
 Reducer 11 <- Map 22 (SIMPLE_EDGE), Reducer 10 (SIMPLE_EDGE)
 Reducer 12 <- Reducer 11 (SIMPLE_EDGE)
 Reducer 13 <- Reducer 12 (SIMPLE_EDGE)
-Reducer 14 <- Reducer 13 (SIMPLE_EDGE)
-Reducer 15 <- Map 1 (SIMPLE_EDGE), Map 20 (SIMPLE_EDGE)
-Reducer 16 <- Map 21 (SIMPLE_EDGE), Reducer 15 (SIMPLE_EDGE)
-Reducer 17 <- Map 22 (SIMPLE_EDGE), Reducer 16 (SIMPLE_EDGE)
+Reducer 14 <- Map 1 (SIMPLE_EDGE), Map 20 (SIMPLE_EDGE)
+Reducer 15 <- Map 21 (SIMPLE_EDGE), Reducer 14 (SIMPLE_EDGE)
+Reducer 16 <- Map 22 (SIMPLE_EDGE), Reducer 15 (SIMPLE_EDGE)
+Reducer 17 <- Reducer 16 (SIMPLE_EDGE)
 Reducer 18 <- Reducer 17 (SIMPLE_EDGE)
 Reducer 19 <- Reducer 18 (SIMPLE_EDGE)
 Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 20 (SIMPLE_EDGE)
@@ -116,7 +116,7 @@ Reducer 3 <- Map 21 (SIMPLE_EDGE), Reducer 2 (SIMPLE_EDGE)
 Reducer 4 <- Map 22 (SIMPLE_EDGE), Reducer 3 (SIMPLE_EDGE)
 Reducer 5 <- Reducer 4 (SIMPLE_EDGE)
 Reducer 6 <- Reducer 5 (SIMPLE_EDGE)
-Reducer 7 <- Reducer 14 (SIMPLE_EDGE), Reducer 19 (SIMPLE_EDGE), Reducer 6 (SIMPLE_EDGE)
+Reducer 7 <- Reducer 13 (SIMPLE_EDGE), Reducer 19 (SIMPLE_EDGE), Reducer 6 (SIMPLE_EDGE)
 Reducer 8 <- Reducer 7 (SIMPLE_EDGE)
 Reducer 9 <- Map 1 (SIMPLE_EDGE), Map 20 (SIMPLE_EDGE)
 
@@ -136,7 +136,78 @@ Stage-0
                 Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7"]
                 Merge Join Operator [MERGEJOIN_189] (rows=843315280 width=88)
                   Conds:RS_103._col0, _col1, _col2, _col3, (_col7 + 1)=RS_104._col0, _col1, _col2, _col3, _col8(Inner),RS_104._col0, _col1, _col2, _col3, _col8=RS_105._col0, _col1, _col2, _col3, (_col7 - 1)(Inner),Output:["_col6","_col8","_col12","_col13","_col14","_col15","_col23"]
-                <-Reducer 14 [SIMPLE_EDGE]
+                <-Reducer 13 [SIMPLE_EDGE]
+                  SHUFFLE [RS_103]
+                    PartitionCols:_col0, _col1, _col2, _col3, (_col7 + 1)
+                    Select Operator [SEL_29] (rows=383325119 width=88)
+                      Output:["_col0","_col1","_col2","_col3","_col6","_col7"]
+                      Filter Operator [FIL_164] (rows=383325119 width=88)
+                        predicate:rank_window_0 is not null
+                        PTF Operator [PTF_28] (rows=383325119 width=88)
+                          Function definitions:[{},{"name:":"windowingtablefunction","order by:":"_col4 ASC NULLS FIRST, _col5 ASC NULLS FIRST","partition by:":"_col0, _col1, _col2, _col3"}]
+                          Select Operator [SEL_27] (rows=383325119 width=88)
+                            Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6"]
+                          <-Reducer 12 [SIMPLE_EDGE]
+                            SHUFFLE [RS_26]
+                              PartitionCols:_col0, _col1, _col2, _col3
+                              Select Operator [SEL_25] (rows=383325119 width=88)
+                                Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6"]
+                                Group By Operator [GBY_24] (rows=383325119 width=88)
+                                  Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6"],aggregations:["sum(VALUE._col0)"],keys:KEY._col0, KEY._col1, KEY._col2, KEY._col3, KEY._col4, KEY._col5
+                                <-Reducer 11 [SIMPLE_EDGE]
+                                  SHUFFLE [RS_23]
+                                    PartitionCols:_col0, _col1, _col2, _col3, _col4, _col5
+                                    Group By Operator [GBY_22] (rows=766650239 width=88)
+                                      Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6"],aggregations:["sum(_col3)"],keys:_col5, _col6, _col8, _col9, _col11, _col12
+                                      Merge Join Operator [MERGEJOIN_182] (rows=766650239 width=88)
+                                        Conds:RS_18._col2=RS_19._col0(Inner),Output:["_col3","_col5","_col6","_col8","_col9","_col11","_col12"]
+                                      <-Map 22 [SIMPLE_EDGE]
+                                        SHUFFLE [RS_19]
+                                          PartitionCols:_col0
+                                          Select Operator [SEL_81] (rows=1704 width=1910)
+                                            Output:["_col0","_col1","_col2"]
+                                            Filter Operator [FIL_179] (rows=1704 width=1910)
+                                              predicate:(s_store_sk is not null and s_store_name is not null and s_company_name is not null)
+                                              TableScan [TS_79] (rows=1704 width=1910)
+                                                default@store,store,Tbl:COMPLETE,Col:NONE,Output:["s_store_sk","s_store_name","s_company_name"]
+                                      <-Reducer 10 [SIMPLE_EDGE]
+                                        SHUFFLE [RS_18]
+                                          PartitionCols:_col2
+                                          Merge Join Operator [MERGEJOIN_181] (rows=696954748 width=88)
+                                            Conds:RS_15._col1=RS_16._col0(Inner),Output:["_col2","_col3","_col5","_col6","_col8","_col9"]
+                                          <-Map 21 [SIMPLE_EDGE]
+                                            SHUFFLE [RS_16]
+                                              PartitionCols:_col0
+                                              Select Operator [SEL_78] (rows=462000 width=1436)
+                                                Output:["_col0","_col1","_col2"]
+                                                Filter Operator [FIL_178] (rows=462000 width=1436)
+                                                  predicate:(i_item_sk is not null and i_category is not null and i_brand is not null)
+                                                  TableScan [TS_76] (rows=462000 width=1436)
+                                                    default@item,item,Tbl:COMPLETE,Col:NONE,Output:["i_item_sk","i_brand","i_category"]
+                                          <-Reducer 9 [SIMPLE_EDGE]
+                                            SHUFFLE [RS_15]
+                                              PartitionCols:_col1
+                                              Merge Join Operator [MERGEJOIN_180] (rows=633595212 width=88)
+                                                Conds:RS_12._col0=RS_13._col0(Inner),Output:["_col1","_col2","_col3","_col5","_col6"]
+                                              <-Map 1 [SIMPLE_EDGE]
+                                                SHUFFLE [RS_12]
+                                                  PartitionCols:_col0
+                                                  Select Operator [SEL_72] (rows=575995635 width=88)
+                                                    Output:["_col0","_col1","_col2","_col3"]
+                                                    Filter Operator [FIL_176] (rows=575995635 width=88)
+                                                      predicate:(ss_item_sk is not null and ss_sold_date_sk is not null and ss_store_sk is not null)
+                                                      TableScan [TS_70] (rows=575995635 width=88)
+                                                        default@store_sales,store_sales,Tbl:COMPLETE,Col:NONE,Output:["ss_sold_date_sk","ss_item_sk","ss_store_sk","ss_sales_price"]
+                                              <-Map 20 [SIMPLE_EDGE]
+                                                SHUFFLE [RS_13]
+                                                  PartitionCols:_col0
+                                                  Select Operator [SEL_75] (rows=73048 width=1119)
+                                                    Output:["_col0","_col1","_col2"]
+                                                    Filter Operator [FIL_177] (rows=73048 width=1119)
+                                                      predicate:(((d_year = 2000) or ((d_year = 1999) and (d_moy = 12)) or ((d_year = 2001) and (d_moy = 1))) and d_date_sk is not null)
+                                                      TableScan [TS_73] (rows=73049 width=1119)
+                                                        default@date_dim,date_dim,Tbl:COMPLETE,Col:NONE,Output:["d_date_sk","d_year","d_moy"]
+                <-Reducer 19 [SIMPLE_EDGE]
                   SHUFFLE [RS_104]
                     PartitionCols:_col0, _col1, _col2, _col3, _col8
                     Select Operator [SEL_67] (rows=31943759 width=88)
@@ -151,7 +222,7 @@ Stage-0
                               Function definitions:[{},{"name:":"windowingtablefunction","order by:":"_col5 ASC NULLS FIRST, _col6 ASC NULLS FIRST","partition by:":"_col1, _col2, _col3, _col4"}]
                               Select Operator [SEL_64] (rows=383325119 width=88)
                                 Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7"]
-                              <-Reducer 13 [SIMPLE_EDGE]
+                              <-Reducer 18 [SIMPLE_EDGE]
                                 SHUFFLE [RS_63]
                                   PartitionCols:_col0, _col1, _col2, _col3
                                   Select Operator [SEL_62] (rows=383325119 width=88)
@@ -160,14 +231,14 @@ Stage-0
                                       Function definitions:[{},{"name:":"windowingtablefunction","order by:":"_col0 ASC NULLS FIRST, _col1 ASC NULLS FIRST, _col2 ASC NULLS FIRST, _col3 ASC NULLS FIRST, _col4 ASC NULLS FIRST","partition by:":"_col0, _col1, _col2, _col3, _col4"}]
                                       Select Operator [SEL_60] (rows=383325119 width=88)
                                         Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6"]
-                                      <-Reducer 12 [SIMPLE_EDGE]
+                                      <-Reducer 17 [SIMPLE_EDGE]
                                         SHUFFLE [RS_59]
                                           PartitionCols:_col0, _col1, _col2, _col3, _col4
                                           Select Operator [SEL_58] (rows=383325119 width=88)
                                             Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6"]
                                             Group By Operator [GBY_57] (rows=383325119 width=88)
                                               Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6"],aggregations:["sum(VALUE._col0)"],keys:KEY._col0, KEY._col1, KEY._col2, KEY._col3, KEY._col4, KEY._col5
-                                            <-Reducer 11 [SIMPLE_EDGE]
+                                            <-Reducer 16 [SIMPLE_EDGE]
                                               SHUFFLE [RS_56]
                                                 PartitionCols:_col0, _col1, _col2, _col3, _col4, _col5
                                                 Group By Operator [GBY_55] (rows=766650239 width=88)
@@ -177,13 +248,8 @@ Stage-0
                                                   <-Map 22 [SIMPLE_EDGE]
                                                     SHUFFLE [RS_52]
                                                       PartitionCols:_col0
-                                                      Select Operator [SEL_11] (rows=1704 width=1910)
-                                                        Output:["_col0","_col1","_col2"]
-                                                        Filter Operator [FIL_168] (rows=1704 width=1910)
-                                                          predicate:(s_store_sk is not null and s_store_name is not null and s_company_name is not null)
-                                                          TableScan [TS_9] (rows=1704 width=1910)
-                                                            default@store,store,Tbl:COMPLETE,Col:NONE,Output:["s_store_sk","s_store_name","s_company_name"]
-                                                  <-Reducer 10 [SIMPLE_EDGE]
+                                                       Please refer to the previous Select Operator [SEL_81]
+                                                  <-Reducer 15 [SIMPLE_EDGE]
                                                     SHUFFLE [RS_51]
                                                       PartitionCols:_col2
                                                       Merge Join Operator [MERGEJOIN_184] (rows=696954748 width=88)
@@ -191,13 +257,8 @@ Stage-0
                                                       <-Map 21 [SIMPLE_EDGE]
                                                         SHUFFLE [RS_49]
                                                           PartitionCols:_col0
-                                                          Select Operator [SEL_8] (rows=462000 width=1436)
-                                                            Output:["_col0","_col1","_col2"]
-                                                            Filter Operator [FIL_167] (rows=462000 width=1436)
-                                                              predicate:(i_item_sk is not null and i_category is not null and i_brand is not null)
-                                                              TableScan [TS_6] (rows=462000 width=1436)
-                                                                default@item,item,Tbl:COMPLETE,Col:NONE,Output:["i_item_sk","i_brand","i_category"]
-                                                      <-Reducer 9 [SIMPLE_EDGE]
+                                                           Please refer to the previous Select Operator [SEL_78]
+                                                      <-Reducer 14 [SIMPLE_EDGE]
                                                         SHUFFLE [RS_48]
                                                           PartitionCols:_col1
                                                           Merge Join Operator [MERGEJOIN_183] (rows=633595212 width=88)
@@ -205,22 +266,12 @@ Stage-0
                                                           <-Map 1 [SIMPLE_EDGE]
                                                             SHUFFLE [RS_45]
                                                               PartitionCols:_col0
-                                                              Select Operator [SEL_2] (rows=575995635 width=88)
-                                                                Output:["_col0","_col1","_col2","_col3"]
-                                                                Filter Operator [FIL_165] (rows=575995635 width=88)
-                                                                  predicate:(ss_item_sk is not null and ss_sold_date_sk is not null and ss_store_sk is not null)
-                                                                  TableScan [TS_0] (rows=575995635 width=88)
-                                                                    default@store_sales,store_sales,Tbl:COMPLETE,Col:NONE,Output:["ss_sold_date_sk","ss_item_sk","ss_store_sk","ss_sales_price"]
+                                                               Please refer to the previous Select Operator [SEL_72]
                                                           <-Map 20 [SIMPLE_EDGE]
                                                             SHUFFLE [RS_46]
                                                               PartitionCols:_col0
-                                                              Select Operator [SEL_5] (rows=73048 width=1119)
-                                                                Output:["_col0","_col1","_col2"]
-                                                                Filter Operator [FIL_166] (rows=73048 width=1119)
-                                                                  predicate:(((d_year = 2000) or ((d_year = 1999) and (d_moy = 12)) or ((d_year = 2001) and (d_moy = 1))) and d_date_sk is not null)
-                                                                  TableScan [TS_3] (rows=73049 width=1119)
-                                                                    default@date_dim,date_dim,Tbl:COMPLETE,Col:NONE,Output:["d_date_sk","d_year","d_moy"]
-                <-Reducer 19 [SIMPLE_EDGE]
+                                                               Please refer to the previous Select Operator [SEL_75]
+                <-Reducer 6 [SIMPLE_EDGE]
                   SHUFFLE [RS_105]
                     PartitionCols:_col0, _col1, _col2, _col3, (_col7 - 1)
                     Select Operator [SEL_99] (rows=383325119 width=88)
@@ -231,14 +282,14 @@ Stage-0
                           Function definitions:[{},{"name:":"windowingtablefunction","order by:":"_col4 ASC NULLS FIRST, _col5 ASC NULLS FIRST","partition by:":"_col0, _col1, _col2, _col3"}]
                           Select Operator [SEL_97] (rows=383325119 width=88)
                             Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6"]
-                          <-Reducer 18 [SIMPLE_EDGE]
+                          <-Reducer 5 [SIMPLE_EDGE]
                             SHUFFLE [RS_96]
                               PartitionCols:_col0, _col1, _col2, _col3
                               Select Operator [SEL_95] (rows=383325119 width=88)
                                 Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6"]
                                 Group By Operator [GBY_94] (rows=383325119 width=88)
                                   Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6"],aggregations:["sum(VALUE._col0)"],keys:KEY._col0, KEY._col1, KEY._col2, KEY._col3, KEY._col4, KEY._col5
-                                <-Reducer 17 [SIMPLE_EDGE]
+                                <-Reducer 4 [SIMPLE_EDGE]
                                   SHUFFLE [RS_93]
                                     PartitionCols:_col0, _col1, _col2, _col3, _col4, _col5
                                     Group By Operator [GBY_92] (rows=766650239 width=88)
@@ -248,8 +299,8 @@ Stage-0
                                       <-Map 22 [SIMPLE_EDGE]
                                         SHUFFLE [RS_89]
                                           PartitionCols:_col0
-                                           Please refer to the previous Select Operator [SEL_11]
-                                      <-Reducer 16 [SIMPLE_EDGE]
+                                           Please refer to the previous Select Operator [SEL_81]
+                                      <-Reducer 3 [SIMPLE_EDGE]
                                         SHUFFLE [RS_88]
                                           PartitionCols:_col2
                                           Merge Join Operator [MERGEJOIN_187] (rows=696954748 width=88)
@@ -257,8 +308,8 @@ Stage-0
                                           <-Map 21 [SIMPLE_EDGE]
                                             SHUFFLE [RS_86]
                                               PartitionCols:_col0
-                                               Please refer to the previous Select Operator [SEL_8]
-                                          <-Reducer 15 [SIMPLE_EDGE]
+                                               Please refer to the previous Select Operator [SEL_78]
+                                          <-Reducer 2 [SIMPLE_EDGE]
                                             SHUFFLE [RS_85]
                                               PartitionCols:_col1
                                               Merge Join Operator [MERGEJOIN_186] (rows=633595212 width=88)
@@ -266,60 +317,9 @@ Stage-0
                                               <-Map 1 [SIMPLE_EDGE]
                                                 SHUFFLE [RS_82]
                                                   PartitionCols:_col0
-                                                   Please refer to the previous Select Operator [SEL_2]
+                                                   Please refer to the previous Select Operator [SEL_72]
                                               <-Map 20 [SIMPLE_EDGE]
                                                 SHUFFLE [RS_83]
                                                   PartitionCols:_col0
-                                                   Please refer to the previous Select Operator [SEL_5]
-                <-Reducer 6 [SIMPLE_EDGE]
-                  SHUFFLE [RS_103]
-                    PartitionCols:_col0, _col1, _col2, _col3, (_col7 + 1)
-                    Select Operator [SEL_29] (rows=383325119 width=88)
-                      Output:["_col0","_col1","_col2","_col3","_col6","_col7"]
-                      Filter Operator [FIL_164] (rows=383325119 width=88)
-                        predicate:rank_window_0 is not null
-                        PTF Operator [PTF_28] (rows=383325119 width=88)
-                          Function definitions:[{},{"name:":"windowingtablefunction","order by:":"_col4 ASC NULLS FIRST, _col5 ASC NULLS FIRST","partition by:":"_col0, _col1, _col2, _col3"}]
-                          Select Operator [SEL_27] (rows=383325119 width=88)
-                            Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6"]
-                          <-Reducer 5 [SIMPLE_EDGE]
-                            SHUFFLE [RS_26]
-                              PartitionCols:_col0, _col1, _col2, _col3
-                              Select Operator [SEL_25] (rows=383325119 width=88)
-                                Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6"]
-                                Group By Operator [GBY_24] (rows=383325119 width=88)
-                                  Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6"],aggregations:["sum(VALUE._col0)"],keys:KEY._col0, KEY._col1, KEY._col2, KEY._col3, KEY._col4, KEY._col5
-                                <-Reducer 4 [SIMPLE_EDGE]
-                                  SHUFFLE [RS_23]
-                                    PartitionCols:_col0, _col1, _col2, _col3, _col4, _col5
-                                    Group By Operator [GBY_22] (rows=766650239 width=88)
-                                      Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6"],aggregations:["sum(_col3)"],keys:_col5, _col6, _col8, _col9, _col11, _col12
-                                      Merge Join Operator [MERGEJOIN_182] (rows=766650239 width=88)
-                                        Conds:RS_18._col2=RS_19._col0(Inner),Output:["_col3","_col5","_col6","_col8","_col9","_col11","_col12"]
-                                      <-Map 22 [SIMPLE_EDGE]
-                                        SHUFFLE [RS_19]
-                                          PartitionCols:_col0
-                                           Please refer to the previous Select Operator [SEL_11]
-                                      <-Reducer 3 [SIMPLE_EDGE]
-                                        SHUFFLE [RS_18]
-                                          PartitionCols:_col2
-                                          Merge Join Operator [MERGEJOIN_181] (rows=696954748 width=88)
-                                            Conds:RS_15._col1=RS_16._col0(Inner),Output:["_col2","_col3","_col5","_col6","_col8","_col9"]
-                                          <-Map 21 [SIMPLE_EDGE]
-                                            SHUFFLE [RS_16]
-                                              PartitionCols:_col0
-                                               Please refer to the previous Select Operator [SEL_8]
-                                          <-Reducer 2 [SIMPLE_EDGE]
-                                            SHUFFLE [RS_15]
-                                              PartitionCols:_col1
-                                              Merge Join Operator [MERGEJOIN_180] (rows=633595212 width=88)
-                                                Conds:RS_12._col0=RS_13._col0(Inner),Output:["_col1","_col2","_col3","_col5","_col6"]
-                                              <-Map 1 [SIMPLE_EDGE]
-                                                SHUFFLE [RS_12]
-                                                  PartitionCols:_col0
-                                                   Please refer to the previous Select Operator [SEL_2]
-                                              <-Map 20 [SIMPLE_EDGE]
-                                                SHUFFLE [RS_13]
-                                                  PartitionCols:_col0
-                                                   Please refer to the previous Select Operator [SEL_5]
+                                                   Please refer to the previous Select Operator [SEL_75]
 
diff --git a/ql/src/test/results/clientpositive/perf/query54.q.out b/ql/src/test/results/clientpositive/perf/query54.q.out
index fe0bbf9f63..be2a13e771 100644
--- a/ql/src/test/results/clientpositive/perf/query54.q.out
+++ b/ql/src/test/results/clientpositive/perf/query54.q.out
@@ -1,7 +1,7 @@
-Warning: Shuffle Join MERGEJOIN[183][tables = [$hdt$_1, $hdt$_2]] in Stage 'Reducer 3' is a cross product
-Warning: Shuffle Join MERGEJOIN[184][tables = [$hdt$_0, $hdt$_1, $hdt$_2, $hdt$_3]] in Stage 'Reducer 12' is a cross product
-Warning: Shuffle Join MERGEJOIN[185][tables = [$hdt$_0, $hdt$_1, $hdt$_2, $hdt$_3, $hdt$_4]] in Stage 'Reducer 13' is a cross product
-Warning: Shuffle Join MERGEJOIN[186][tables = [$hdt$_1, $hdt$_2, $hdt$_0]] in Stage 'Reducer 4' is a cross product
+Warning: Shuffle Join MERGEJOIN[184][tables = [$hdt$_0, $hdt$_1, $hdt$_2, $hdt$_3]] in Stage 'Reducer 4' is a cross product
+Warning: Shuffle Join MERGEJOIN[185][tables = [$hdt$_0, $hdt$_1, $hdt$_2, $hdt$_3, $hdt$_4]] in Stage 'Reducer 5' is a cross product
+Warning: Shuffle Join MERGEJOIN[183][tables = [$hdt$_1, $hdt$_2]] in Stage 'Reducer 30' is a cross product
+Warning: Shuffle Join MERGEJOIN[186][tables = [$hdt$_1, $hdt$_2, $hdt$_0]] in Stage 'Reducer 6' is a cross product
 PREHOOK: query: explain
 with my_customers as (
  select distinct c_customer_sk
@@ -115,47 +115,47 @@ POSTHOOK: type: QUERY
 Plan optimized by CBO.
 
 Vertex dependency in root stage
-Map 23 <- Union 24 (CONTAINS)
-Map 29 <- Union 24 (CONTAINS)
-Reducer 10 <- Map 1 (SIMPLE_EDGE)
-Reducer 11 <- Reducer 10 (CUSTOM_SIMPLE_EDGE)
-Reducer 12 <- Reducer 11 (CUSTOM_SIMPLE_EDGE), Reducer 17 (CUSTOM_SIMPLE_EDGE)
-Reducer 13 <- Reducer 12 (CUSTOM_SIMPLE_EDGE), Reducer 14 (CUSTOM_SIMPLE_EDGE)
-Reducer 14 <- Map 1 (SIMPLE_EDGE)
-Reducer 16 <- Map 15 (SIMPLE_EDGE), Map 18 (SIMPLE_EDGE)
-Reducer 17 <- Reducer 16 (SIMPLE_EDGE), Reducer 21 (SIMPLE_EDGE)
-Reducer 2 <- Map 1 (SIMPLE_EDGE)
-Reducer 20 <- Map 19 (SIMPLE_EDGE), Map 22 (SIMPLE_EDGE)
-Reducer 21 <- Reducer 20 (SIMPLE_EDGE), Reducer 28 (SIMPLE_EDGE)
-Reducer 25 <- Map 30 (SIMPLE_EDGE), Union 24 (SIMPLE_EDGE)
-Reducer 26 <- Map 31 (SIMPLE_EDGE), Reducer 25 (SIMPLE_EDGE)
-Reducer 27 <- Map 32 (SIMPLE_EDGE), Reducer 26 (SIMPLE_EDGE)
-Reducer 28 <- Reducer 27 (SIMPLE_EDGE)
-Reducer 3 <- Reducer 2 (CUSTOM_SIMPLE_EDGE), Reducer 9 (CUSTOM_SIMPLE_EDGE)
-Reducer 4 <- Reducer 13 (CUSTOM_SIMPLE_EDGE), Reducer 3 (CUSTOM_SIMPLE_EDGE)
-Reducer 5 <- Reducer 4 (SIMPLE_EDGE)
-Reducer 6 <- Reducer 5 (SIMPLE_EDGE)
+Map 15 <- Union 16 (CONTAINS)
+Map 21 <- Union 16 (CONTAINS)
+Reducer 12 <- Map 11 (SIMPLE_EDGE), Map 14 (SIMPLE_EDGE)
+Reducer 13 <- Reducer 12 (SIMPLE_EDGE), Reducer 20 (SIMPLE_EDGE)
+Reducer 17 <- Map 22 (SIMPLE_EDGE), Union 16 (SIMPLE_EDGE)
+Reducer 18 <- Map 23 (SIMPLE_EDGE), Reducer 17 (SIMPLE_EDGE)
+Reducer 19 <- Map 24 (SIMPLE_EDGE), Reducer 18 (SIMPLE_EDGE)
+Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 10 (SIMPLE_EDGE)
+Reducer 20 <- Reducer 19 (SIMPLE_EDGE)
+Reducer 26 <- Map 25 (SIMPLE_EDGE)
+Reducer 27 <- Reducer 26 (CUSTOM_SIMPLE_EDGE)
+Reducer 28 <- Map 25 (SIMPLE_EDGE)
+Reducer 29 <- Map 25 (SIMPLE_EDGE)
+Reducer 3 <- Reducer 13 (SIMPLE_EDGE), Reducer 2 (SIMPLE_EDGE)
+Reducer 30 <- Reducer 29 (CUSTOM_SIMPLE_EDGE), Reducer 32 (CUSTOM_SIMPLE_EDGE)
+Reducer 31 <- Map 25 (SIMPLE_EDGE)
+Reducer 32 <- Reducer 31 (CUSTOM_SIMPLE_EDGE)
+Reducer 4 <- Reducer 27 (CUSTOM_SIMPLE_EDGE), Reducer 3 (CUSTOM_SIMPLE_EDGE)
+Reducer 5 <- Reducer 28 (CUSTOM_SIMPLE_EDGE), Reducer 4 (CUSTOM_SIMPLE_EDGE)
+Reducer 6 <- Reducer 30 (CUSTOM_SIMPLE_EDGE), Reducer 5 (CUSTOM_SIMPLE_EDGE)
 Reducer 7 <- Reducer 6 (SIMPLE_EDGE)
-Reducer 8 <- Map 1 (SIMPLE_EDGE)
-Reducer 9 <- Reducer 8 (CUSTOM_SIMPLE_EDGE)
+Reducer 8 <- Reducer 7 (SIMPLE_EDGE)
+Reducer 9 <- Reducer 8 (SIMPLE_EDGE)
 
 Stage-0
   Fetch Operator
     limit:100
     Stage-1
-      Reducer 7
+      Reducer 9
       File Output Operator [FS_130]
         Limit [LIM_129] (rows=100 width=158)
           Number of rows:100
           Select Operator [SEL_128] (rows=1614130953450400 width=158)
             Output:["_col0","_col1","_col2"]
-          <-Reducer 6 [SIMPLE_EDGE]
+          <-Reducer 8 [SIMPLE_EDGE]
             SHUFFLE [RS_127]
               Select Operator [SEL_126] (rows=1614130953450400 width=158)
                 Output:["_col0","_col1","_col2"]
                 Group By Operator [GBY_125] (rows=1614130953450400 width=158)
                   Output:["_col0","_col1"],aggregations:["count(VALUE._col0)"],keys:KEY._col0
-                <-Reducer 5 [SIMPLE_EDGE]
+                <-Reducer 7 [SIMPLE_EDGE]
                   SHUFFLE [RS_124]
                     PartitionCols:_col0
                     Group By Operator [GBY_123] (rows=3228261906900801 width=158)
@@ -164,7 +164,7 @@ Stage-0
                         Output:["_col0"]
                         Group By Operator [GBY_120] (rows=3228261906900801 width=158)
                           Output:["_col0","_col1"],aggregations:["sum(VALUE._col0)"],keys:KEY._col0
-                        <-Reducer 4 [SIMPLE_EDGE]
+                        <-Reducer 6 [SIMPLE_EDGE]
                           SHUFFLE [RS_119]
                             PartitionCols:_col0
                             Group By Operator [GBY_118] (rows=6456523813801603 width=158)
@@ -177,79 +177,102 @@ Stage-0
                                     Output:["_col0","_col4","_col11","_col13","_col15"]
                                     Merge Join Operator [MERGEJOIN_186] (rows=58108714324214428 width=158)
                                       Conds:(Inner),Output:["_col0","_col2","_col6","_col13","_col15"]
-                                    <-Reducer 13 [CUSTOM_SIMPLE_EDGE]
+                                    <-Reducer 30 [CUSTOM_SIMPLE_EDGE]
+                                      PARTITION_ONLY_SHUFFLE [RS_112]
+                                        Merge Join Operator [MERGEJOIN_183] (rows=9131 width=1128)
+                                          Conds:(Right Outer),Output:["_col0"]
+                                        <-Reducer 29 [CUSTOM_SIMPLE_EDGE]
+                                          PARTITION_ONLY_SHUFFLE [RS_109]
+                                            Group By Operator [GBY_6] (rows=9131 width=1119)
+                                              Output:["_col0"],keys:KEY._col0
+                                            <-Map 25 [SIMPLE_EDGE]
+                                              SHUFFLE [RS_5]
+                                                PartitionCols:_col0
+                                                Group By Operator [GBY_4] (rows=18262 width=1119)
+                                                  Output:["_col0"],keys:_col0
+                                                  Select Operator [SEL_2] (rows=18262 width=1119)
+                                                    Output:["_col0"]
+                                                    Filter Operator [FIL_174] (rows=18262 width=1119)
+                                                      predicate:((d_year = 1999) and (d_moy = 3))
+                                                      TableScan [TS_73] (rows=73049 width=1119)
+                                                        default@date_dim,date_dim,Tbl:COMPLETE,Col:NONE,Output:["d_month_seq","d_year","d_moy"]
+                                        <-Reducer 32 [CUSTOM_SIMPLE_EDGE]
+                                          PARTITION_ONLY_SHUFFLE [RS_110]
+                                            Select Operator [SEL_22] (rows=1 width=8)
+                                              Filter Operator [FIL_21] (rows=1 width=8)
+                                                predicate:(sq_count_check(_col0) <= 1)
+                                                Group By Operator [GBY_19] (rows=1 width=8)
+                                                  Output:["_col0"],aggregations:["count(VALUE._col0)"]
+                                                <-Reducer 31 [CUSTOM_SIMPLE_EDGE]
+                                                  PARTITION_ONLY_SHUFFLE [RS_18]
+                                                    Group By Operator [GBY_17] (rows=1 width=8)
+                                                      Output:["_col0"],aggregations:["count()"]
+                                                      Select Operator [SEL_15] (rows=9131 width=1119)
+                                                        Group By Operator [GBY_14] (rows=9131 width=1119)
+                                                          Output:["_col0"],keys:KEY._col0
+                                                        <-Map 25 [SIMPLE_EDGE]
+                                                          SHUFFLE [RS_13]
+                                                            PartitionCols:_col0
+                                                            Group By Operator [GBY_12] (rows=18262 width=1119)
+                                                              Output:["_col0"],keys:_col0
+                                                              Select Operator [SEL_10] (rows=18262 width=1119)
+                                                                Output:["_col0"]
+                                                                 Please refer to the previous Filter Operator [FIL_174]
+                                    <-Reducer 5 [CUSTOM_SIMPLE_EDGE]
                                       PARTITION_ONLY_SHUFFLE [RS_113]
                                         Select Operator [SEL_108] (rows=6363893803988 width=1217)
                                           Output:["_col0","_col4","_col11","_col13"]
                                           Merge Join Operator [MERGEJOIN_185] (rows=6363893803988 width=1217)
                                             Conds:(Left Outer),Output:["_col2","_col4","_col10","_col13"]
-                                          <-Reducer 12 [CUSTOM_SIMPLE_EDGE]
+                                          <-Reducer 28 [CUSTOM_SIMPLE_EDGE]
+                                            PARTITION_ONLY_SHUFFLE [RS_106]
+                                              Group By Operator [GBY_94] (rows=9131 width=1119)
+                                                Output:["_col0"],keys:KEY._col0
+                                              <-Map 25 [SIMPLE_EDGE]
+                                                SHUFFLE [RS_93]
+                                                  PartitionCols:_col0
+                                                  Group By Operator [GBY_77] (rows=18262 width=1119)
+                                                    Output:["_col0"],keys:_col0
+                                                    Select Operator [SEL_75] (rows=18262 width=1119)
+                                                      Output:["_col0"]
+                                                       Please refer to the previous Filter Operator [FIL_174]
+                                          <-Reducer 4 [CUSTOM_SIMPLE_EDGE]
                                             PARTITION_ONLY_SHUFFLE [RS_105]
                                               Merge Join Operator [MERGEJOIN_184] (rows=696954748 width=97)
                                                 Conds:(Inner),Output:["_col2","_col4","_col10"]
-                                              <-Reducer 11 [CUSTOM_SIMPLE_EDGE]
+                                              <-Reducer 27 [CUSTOM_SIMPLE_EDGE]
                                                 PARTITION_ONLY_SHUFFLE [RS_103]
                                                   Select Operator [SEL_87] (rows=1 width=8)
                                                     Filter Operator [FIL_86] (rows=1 width=8)
                                                       predicate:(sq_count_check(_col0) <= 1)
                                                       Group By Operator [GBY_84] (rows=1 width=8)
                                                         Output:["_col0"],aggregations:["count(VALUE._col0)"]
-                                                      <-Reducer 10 [CUSTOM_SIMPLE_EDGE]
+                                                      <-Reducer 26 [CUSTOM_SIMPLE_EDGE]
                                                         PARTITION_ONLY_SHUFFLE [RS_83]
                                                           Group By Operator [GBY_82] (rows=1 width=8)
                                                             Output:["_col0"],aggregations:["count()"]
                                                             Select Operator [SEL_80] (rows=9131 width=1119)
                                                               Group By Operator [GBY_79] (rows=9131 width=1119)
                                                                 Output:["_col0"],keys:KEY._col0
-                                                              <-Map 1 [SIMPLE_EDGE]
+                                                              <-Map 25 [SIMPLE_EDGE]
                                                                 SHUFFLE [RS_78]
                                                                   PartitionCols:_col0
-                                                                  Group By Operator [GBY_77] (rows=18262 width=1119)
-                                                                    Output:["_col0"],keys:_col0
-                                                                    Select Operator [SEL_75] (rows=18262 width=1119)
-                                                                      Output:["_col0"]
-                                                                      Filter Operator [FIL_163] (rows=18262 width=1119)
-                                                                        predicate:((d_year = 1999) and (d_moy = 3))
-                                                                        TableScan [TS_0] (rows=73049 width=1119)
-                                                                          default@date_dim,date_dim,Tbl:COMPLETE,Col:NONE,Output:["d_month_seq","d_year","d_moy"]
-                                              <-Reducer 17 [CUSTOM_SIMPLE_EDGE]
+                                                                   Please refer to the previous Group By Operator [GBY_77]
+                                              <-Reducer 3 [CUSTOM_SIMPLE_EDGE]
                                                 PARTITION_ONLY_SHUFFLE [RS_102]
                                                   Merge Join Operator [MERGEJOIN_182] (rows=696954748 width=88)
                                                     Conds:RS_99._col1=RS_100._col5(Inner),Output:["_col2","_col4","_col10"]
-                                                  <-Reducer 16 [SIMPLE_EDGE]
-                                                    SHUFFLE [RS_99]
-                                                      PartitionCols:_col1
-                                                      Merge Join Operator [MERGEJOIN_176] (rows=633595212 width=88)
-                                                        Conds:RS_96._col0=RS_97._col0(Inner),Output:["_col1","_col2","_col4"]
-                                                      <-Map 15 [SIMPLE_EDGE]
-                                                        SHUFFLE [RS_96]
-                                                          PartitionCols:_col0
-                                                          Select Operator [SEL_25] (rows=575995635 width=88)
-                                                            Output:["_col0","_col1","_col2"]
-                                                            Filter Operator [FIL_165] (rows=575995635 width=88)
-                                                              predicate:(ss_customer_sk is not null and ss_sold_date_sk is not null)
-                                                              TableScan [TS_23] (rows=575995635 width=88)
-                                                                default@store_sales,store_sales,Tbl:COMPLETE,Col:NONE,Output:["ss_sold_date_sk","ss_customer_sk","ss_ext_sales_price"]
-                                                      <-Map 18 [SIMPLE_EDGE]
-                                                        SHUFFLE [RS_97]
-                                                          PartitionCols:_col0
-                                                          Select Operator [SEL_28] (rows=73049 width=1119)
-                                                            Output:["_col0","_col1"]
-                                                            Filter Operator [FIL_166] (rows=73049 width=1119)
-                                                              predicate:d_date_sk is not null
-                                                              TableScan [TS_26] (rows=73049 width=1119)
-                                                                default@date_dim,date_dim,Tbl:COMPLETE,Col:NONE,Output:["d_date_sk","d_month_seq"]
-                                                  <-Reducer 21 [SIMPLE_EDGE]
+                                                  <-Reducer 13 [SIMPLE_EDGE]
                                                     SHUFFLE [RS_100]
                                                       PartitionCols:_col5
                                                       Merge Join Operator [MERGEJOIN_181] (rows=316240138 width=135)
                                                         Conds:RS_69._col0=RS_70._col1(Inner),Output:["_col5"]
-                                                      <-Reducer 20 [SIMPLE_EDGE]
+                                                      <-Reducer 12 [SIMPLE_EDGE]
                                                         SHUFFLE [RS_69]
                                                           PartitionCols:_col0
                                                           Merge Join Operator [MERGEJOIN_177] (rows=44000000 width=1014)
                                                             Conds:RS_66._col1, _col2=RS_67._col0, _col1(Inner),Output:["_col0"]
-                                                          <-Map 19 [SIMPLE_EDGE]
+                                                          <-Map 11 [SIMPLE_EDGE]
                                                             SHUFFLE [RS_66]
                                                               PartitionCols:_col1, _col2
                                                               Select Operator [SEL_31] (rows=40000000 width=1014)
@@ -258,7 +281,7 @@ Stage-0
                                                                   predicate:(ca_address_sk is not null and ca_county is not null and ca_state is not null)
                                                                   TableScan [TS_29] (rows=40000000 width=1014)
                                                                     default@customer_address,customer_address,Tbl:COMPLETE,Col:NONE,Output:["ca_address_sk","ca_county","ca_state"]
-                                                          <-Map 22 [SIMPLE_EDGE]
+                                                          <-Map 14 [SIMPLE_EDGE]
                                                             SHUFFLE [RS_67]
                                                               PartitionCols:_col0, _col1
                                                               Select Operator [SEL_34] (rows=1704 width=1910)
@@ -267,21 +290,21 @@ Stage-0
                                                                   predicate:(s_county is not null and s_state is not null)
                                                                   TableScan [TS_32] (rows=1704 width=1910)
                                                                     default@store,store,Tbl:COMPLETE,Col:NONE,Output:["s_county","s_state"]
-                                                      <-Reducer 28 [SIMPLE_EDGE]
+                                                      <-Reducer 20 [SIMPLE_EDGE]
                                                         SHUFFLE [RS_70]
                                                           PartitionCols:_col1
                                                           Select Operator [SEL_65] (rows=287491029 width=135)
                                                             Output:["_col0","_col1"]
                                                             Group By Operator [GBY_64] (rows=287491029 width=135)
                                                               Output:["_col0","_col1"],keys:KEY._col0, KEY._col1
-                                                            <-Reducer 27 [SIMPLE_EDGE]
+                                                            <-Reducer 19 [SIMPLE_EDGE]
                                                               SHUFFLE [RS_63]
                                                                 PartitionCols:_col0, _col1
                                                                 Group By Operator [GBY_62] (rows=574982058 width=135)
                                                                   Output:["_col0","_col1"],keys:_col10, _col9
                                                                   Merge Join Operator [MERGEJOIN_180] (rows=574982058 width=135)
                                                                     Conds:RS_58._col1=RS_59._col0(Inner),Output:["_col9","_col10"]
-                                                                  <-Map 32 [SIMPLE_EDGE]
+                                                                  <-Map 24 [SIMPLE_EDGE]
                                                                     SHUFFLE [RS_59]
                                                                       PartitionCols:_col0
                                                                       Select Operator [SEL_51] (rows=80000000 width=860)
@@ -290,12 +313,12 @@ Stage-0
                                                                           predicate:(c_customer_sk is not null and c_current_addr_sk is not null)
                                                                           TableScan [TS_49] (rows=80000000 width=860)
                                                                             default@customer,customer,Tbl:COMPLETE,Col:NONE,Output:["c_customer_sk","c_current_addr_sk"]
-                                                                  <-Reducer 26 [SIMPLE_EDGE]
+                                                                  <-Reducer 18 [SIMPLE_EDGE]
                                                                     SHUFFLE [RS_58]
                                                                       PartitionCols:_col1
                                                                       Merge Join Operator [MERGEJOIN_179] (rows=522710951 width=135)
                                                                         Conds:RS_55._col2=RS_56._col0(Inner),Output:["_col1"]
-                                                                      <-Map 31 [SIMPLE_EDGE]
+                                                                      <-Map 23 [SIMPLE_EDGE]
                                                                         SHUFFLE [RS_56]
                                                                           PartitionCols:_col0
                                                                           Select Operator [SEL_48] (rows=115500 width=1436)
@@ -304,12 +327,12 @@ Stage-0
                                                                               predicate:((i_category = 'Jewelry') and (i_class = 'consignment') and i_item_sk is not null)
                                                                               TableScan [TS_46] (rows=462000 width=1436)
                                                                                 default@item,item,Tbl:COMPLETE,Col:NONE,Output:["i_item_sk","i_class","i_category"]
-                                                                      <-Reducer 25 [SIMPLE_EDGE]
+                                                                      <-Reducer 17 [SIMPLE_EDGE]
                                                                         SHUFFLE [RS_55]
                                                                           PartitionCols:_col2
                                                                           Merge Join Operator [MERGEJOIN_178] (rows=475191764 width=135)
-                                                                            Conds:Union 24._col0=RS_53._col0(Inner),Output:["_col1","_col2"]
-                                                                          <-Map 30 [SIMPLE_EDGE]
+                                                                            Conds:Union 16._col0=RS_53._col0(Inner),Output:["_col1","_col2"]
+                                                                          <-Map 22 [SIMPLE_EDGE]
                                                                             SHUFFLE [RS_53]
                                                                               PartitionCols:_col0
                                                                               Select Operator [SEL_45] (rows=18262 width=1119)
@@ -318,8 +341,8 @@ Stage-0
                                                                                   predicate:((d_moy = 3) and (d_year = 1999) and d_date_sk is not null)
                                                                                   TableScan [TS_43] (rows=73049 width=1119)
                                                                                     default@date_dim,date_dim,Tbl:COMPLETE,Col:NONE,Output:["d_date_sk","d_year","d_moy"]
-                                                                          <-Union 24 [SIMPLE_EDGE]
-                                                                            <-Map 23 [CONTAINS]
+                                                                          <-Union 16 [SIMPLE_EDGE]
+                                                                            <-Map 15 [CONTAINS]
                                                                               Reduce Output Operator [RS_52]
                                                                                 PartitionCols:_col0
                                                                                 Select Operator [SEL_37] (rows=287989836 width=135)
@@ -328,7 +351,7 @@ Stage-0
                                                                                     predicate:(cs_item_sk is not null and cs_sold_date_sk is not null and cs_bill_customer_sk is not null)
                                                                                     TableScan [TS_35] (rows=287989836 width=135)
                                                                                       Output:["cs_sold_date_sk","cs_bill_customer_sk","cs_item_sk"]
-                                                                            <-Map 29 [CONTAINS]
+                                                                            <-Map 21 [CONTAINS]
                                                                               Reduce Output Operator [RS_52]
                                                                                 PartitionCols:_col0
                                                                                 Select Operator [SEL_40] (rows=144002668 width=135)
@@ -337,50 +360,27 @@ Stage-0
                                                                                     predicate:(ws_item_sk is not null and ws_sold_date_sk is not null and ws_bill_customer_sk is not null)
                                                                                     TableScan [TS_38] (rows=144002668 width=135)
                                                                                       Output:["ws_sold_date_sk","ws_item_sk","ws_bill_customer_sk"]
-                                          <-Reducer 14 [CUSTOM_SIMPLE_EDGE]
-                                            PARTITION_ONLY_SHUFFLE [RS_106]
-                                              Group By Operator [GBY_94] (rows=9131 width=1119)
-                                                Output:["_col0"],keys:KEY._col0
-                                              <-Map 1 [SIMPLE_EDGE]
-                                                SHUFFLE [RS_93]
-                                                  PartitionCols:_col0
-                                                  Group By Operator [GBY_92] (rows=18262 width=1119)
-                                                    Output:["_col0"],keys:_col0
-                                                    Select Operator [SEL_90] (rows=18262 width=1119)
-                                                      Output:["_col0"]
-                                                       Please refer to the previous Filter Operator [FIL_163]
-                                    <-Reducer 3 [CUSTOM_SIMPLE_EDGE]
-                                      PARTITION_ONLY_SHUFFLE [RS_112]
-                                        Merge Join Operator [MERGEJOIN_183] (rows=9131 width=1128)
-                                          Conds:(Right Outer),Output:["_col0"]
-                                        <-Reducer 2 [CUSTOM_SIMPLE_EDGE]
-                                          PARTITION_ONLY_SHUFFLE [RS_109]
-                                            Group By Operator [GBY_6] (rows=9131 width=1119)
-                                              Output:["_col0"],keys:KEY._col0
-                                            <-Map 1 [SIMPLE_EDGE]
-                                              SHUFFLE [RS_5]
-                                                PartitionCols:_col0
-                                                Group By Operator [GBY_4] (rows=18262 width=1119)
-                                                  Output:["_col0"],keys:_col0
-                                                  Select Operator [SEL_2] (rows=18262 width=1119)
-                                                    Output:["_col0"]
-                                                     Please refer to the previous Filter Operator [FIL_163]
-                                        <-Reducer 9 [CUSTOM_SIMPLE_EDGE]
-                                          PARTITION_ONLY_SHUFFLE [RS_110]
-                                            Select Operator [SEL_22] (rows=1 width=8)
-                                              Filter Operator [FIL_21] (rows=1 width=8)
-                                                predicate:(sq_count_check(_col0) <= 1)
-                                                Group By Operator [GBY_19] (rows=1 width=8)
-                                                  Output:["_col0"],aggregations:["count(VALUE._col0)"]
-                                                <-Reducer 8 [CUSTOM_SIMPLE_EDGE]
-                                                  PARTITION_ONLY_SHUFFLE [RS_18]
-                                                    Group By Operator [GBY_17] (rows=1 width=8)
-                                                      Output:["_col0"],aggregations:["count()"]
-                                                      Select Operator [SEL_15] (rows=9131 width=1119)
-                                                        Group By Operator [GBY_14] (rows=9131 width=1119)
-                                                          Output:["_col0"],keys:KEY._col0
-                                                        <-Map 1 [SIMPLE_EDGE]
-                                                          SHUFFLE [RS_13]
-                                                            PartitionCols:_col0
-                                                             Please refer to the previous Group By Operator [GBY_4]
+                                                  <-Reducer 2 [SIMPLE_EDGE]
+                                                    SHUFFLE [RS_99]
+                                                      PartitionCols:_col1
+                                                      Merge Join Operator [MERGEJOIN_176] (rows=633595212 width=88)
+                                                        Conds:RS_96._col0=RS_97._col0(Inner),Output:["_col1","_col2","_col4"]
+                                                      <-Map 1 [SIMPLE_EDGE]
+                                                        SHUFFLE [RS_96]
+                                                          PartitionCols:_col0
+                                                          Select Operator [SEL_25] (rows=575995635 width=88)
+                                                            Output:["_col0","_col1","_col2"]
+                                                            Filter Operator [FIL_165] (rows=575995635 width=88)
+                                                              predicate:(ss_customer_sk is not null and ss_sold_date_sk is not null)
+                                                              TableScan [TS_23] (rows=575995635 width=88)
+                                                                default@store_sales,store_sales,Tbl:COMPLETE,Col:NONE,Output:["ss_sold_date_sk","ss_customer_sk","ss_ext_sales_price"]
+                                                      <-Map 10 [SIMPLE_EDGE]
+                                                        SHUFFLE [RS_97]
+                                                          PartitionCols:_col0
+                                                          Select Operator [SEL_28] (rows=73049 width=1119)
+                                                            Output:["_col0","_col1"]
+                                                            Filter Operator [FIL_166] (rows=73049 width=1119)
+                                                              predicate:d_date_sk is not null
+                                                              TableScan [TS_26] (rows=73049 width=1119)
+                                                                default@date_dim,date_dim,Tbl:COMPLETE,Col:NONE,Output:["d_date_sk","d_month_seq"]
 
diff --git a/ql/src/test/results/clientpositive/perf/query57.q.out b/ql/src/test/results/clientpositive/perf/query57.q.out
index 372e76087f..e9630de9ac 100644
--- a/ql/src/test/results/clientpositive/perf/query57.q.out
+++ b/ql/src/test/results/clientpositive/perf/query57.q.out
@@ -99,10 +99,10 @@ Reducer 10 <- Map 21 (SIMPLE_EDGE), Reducer 9 (SIMPLE_EDGE)
 Reducer 11 <- Map 22 (SIMPLE_EDGE), Reducer 10 (SIMPLE_EDGE)
 Reducer 12 <- Reducer 11 (SIMPLE_EDGE)
 Reducer 13 <- Reducer 12 (SIMPLE_EDGE)
-Reducer 14 <- Reducer 13 (SIMPLE_EDGE)
-Reducer 15 <- Map 1 (SIMPLE_EDGE), Map 20 (SIMPLE_EDGE)
-Reducer 16 <- Map 21 (SIMPLE_EDGE), Reducer 15 (SIMPLE_EDGE)
-Reducer 17 <- Map 22 (SIMPLE_EDGE), Reducer 16 (SIMPLE_EDGE)
+Reducer 14 <- Map 1 (SIMPLE_EDGE), Map 20 (SIMPLE_EDGE)
+Reducer 15 <- Map 21 (SIMPLE_EDGE), Reducer 14 (SIMPLE_EDGE)
+Reducer 16 <- Map 22 (SIMPLE_EDGE), Reducer 15 (SIMPLE_EDGE)
+Reducer 17 <- Reducer 16 (SIMPLE_EDGE)
 Reducer 18 <- Reducer 17 (SIMPLE_EDGE)
 Reducer 19 <- Reducer 18 (SIMPLE_EDGE)
 Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 20 (SIMPLE_EDGE)
@@ -110,7 +110,7 @@ Reducer 3 <- Map 21 (SIMPLE_EDGE), Reducer 2 (SIMPLE_EDGE)
 Reducer 4 <- Map 22 (SIMPLE_EDGE), Reducer 3 (SIMPLE_EDGE)
 Reducer 5 <- Reducer 4 (SIMPLE_EDGE)
 Reducer 6 <- Reducer 5 (SIMPLE_EDGE)
-Reducer 7 <- Reducer 14 (SIMPLE_EDGE), Reducer 19 (SIMPLE_EDGE), Reducer 6 (SIMPLE_EDGE)
+Reducer 7 <- Reducer 13 (SIMPLE_EDGE), Reducer 19 (SIMPLE_EDGE), Reducer 6 (SIMPLE_EDGE)
 Reducer 8 <- Reducer 7 (SIMPLE_EDGE)
 Reducer 9 <- Map 1 (SIMPLE_EDGE), Map 20 (SIMPLE_EDGE)
 
@@ -130,7 +130,78 @@ Stage-0
                 Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7","_col8"]
                 Merge Join Operator [MERGEJOIN_189] (rows=421645952 width=135)
                   Conds:RS_103._col0, _col2, _col1, (_col6 + 1)=RS_104._col0, _col2, _col1, _col7(Inner),RS_104._col0, _col2, _col1, _col7=RS_105._col0, _col2, _col1, (_col6 - 1)(Inner),Output:["_col5","_col7","_col8","_col10","_col11","_col12","_col13","_col20"]
-                <-Reducer 14 [SIMPLE_EDGE]
+                <-Reducer 13 [SIMPLE_EDGE]
+                  SHUFFLE [RS_103]
+                    PartitionCols:_col0, _col2, _col1, (_col6 + 1)
+                    Select Operator [SEL_29] (rows=191657247 width=135)
+                      Output:["_col0","_col1","_col2","_col5","_col6"]
+                      Filter Operator [FIL_164] (rows=191657247 width=135)
+                        predicate:rank_window_0 is not null
+                        PTF Operator [PTF_28] (rows=191657247 width=135)
+                          Function definitions:[{},{"name:":"windowingtablefunction","order by:":"_col3 ASC NULLS FIRST, _col4 ASC NULLS FIRST","partition by:":"_col0, _col1, _col2"}]
+                          Select Operator [SEL_27] (rows=191657247 width=135)
+                            Output:["_col0","_col1","_col2","_col3","_col4","_col5"]
+                          <-Reducer 12 [SIMPLE_EDGE]
+                            SHUFFLE [RS_26]
+                              PartitionCols:_col0, _col1, _col2
+                              Select Operator [SEL_25] (rows=191657247 width=135)
+                                Output:["_col0","_col1","_col2","_col3","_col4","_col5"]
+                                Group By Operator [GBY_24] (rows=191657247 width=135)
+                                  Output:["_col0","_col1","_col2","_col3","_col4","_col5"],aggregations:["sum(VALUE._col0)"],keys:KEY._col0, KEY._col1, KEY._col2, KEY._col3, KEY._col4
+                                <-Reducer 11 [SIMPLE_EDGE]
+                                  SHUFFLE [RS_23]
+                                    PartitionCols:_col0, _col1, _col2, _col3, _col4
+                                    Group By Operator [GBY_22] (rows=383314495 width=135)
+                                      Output:["_col0","_col1","_col2","_col3","_col4","_col5"],aggregations:["sum(_col3)"],keys:_col5, _col6, _col8, _col10, _col11
+                                      Merge Join Operator [MERGEJOIN_182] (rows=383314495 width=135)
+                                        Conds:RS_18._col2=RS_19._col0(Inner),Output:["_col3","_col5","_col6","_col8","_col10","_col11"]
+                                      <-Map 22 [SIMPLE_EDGE]
+                                        SHUFFLE [RS_19]
+                                          PartitionCols:_col0
+                                          Select Operator [SEL_81] (rows=462000 width=1436)
+                                            Output:["_col0","_col1","_col2"]
+                                            Filter Operator [FIL_179] (rows=462000 width=1436)
+                                              predicate:(i_item_sk is not null and i_category is not null and i_brand is not null)
+                                              TableScan [TS_79] (rows=462000 width=1436)
+                                                default@item,item,Tbl:COMPLETE,Col:NONE,Output:["i_item_sk","i_brand","i_category"]
+                                      <-Reducer 10 [SIMPLE_EDGE]
+                                        SHUFFLE [RS_18]
+                                          PartitionCols:_col2
+                                          Merge Join Operator [MERGEJOIN_181] (rows=348467716 width=135)
+                                            Conds:RS_15._col1=RS_16._col0(Inner),Output:["_col2","_col3","_col5","_col6","_col8"]
+                                          <-Map 21 [SIMPLE_EDGE]
+                                            SHUFFLE [RS_16]
+                                              PartitionCols:_col0
+                                              Select Operator [SEL_78] (rows=60 width=2045)
+                                                Output:["_col0","_col1"]
+                                                Filter Operator [FIL_178] (rows=60 width=2045)
+                                                  predicate:(cc_call_center_sk is not null and cc_name is not null)
+                                                  TableScan [TS_76] (rows=60 width=2045)
+                                                    default@call_center,call_center,Tbl:COMPLETE,Col:NONE,Output:["cc_call_center_sk","cc_name"]
+                                          <-Reducer 9 [SIMPLE_EDGE]
+                                            SHUFFLE [RS_15]
+                                              PartitionCols:_col1
+                                              Merge Join Operator [MERGEJOIN_180] (rows=316788826 width=135)
+                                                Conds:RS_12._col0=RS_13._col0(Inner),Output:["_col1","_col2","_col3","_col5","_col6"]
+                                              <-Map 1 [SIMPLE_EDGE]
+                                                SHUFFLE [RS_12]
+                                                  PartitionCols:_col0
+                                                  Select Operator [SEL_72] (rows=287989836 width=135)
+                                                    Output:["_col0","_col1","_col2","_col3"]
+                                                    Filter Operator [FIL_176] (rows=287989836 width=135)
+                                                      predicate:(cs_item_sk is not null and cs_sold_date_sk is not null and cs_call_center_sk is not null)
+                                                      TableScan [TS_70] (rows=287989836 width=135)
+                                                        default@catalog_sales,catalog_sales,Tbl:COMPLETE,Col:NONE,Output:["cs_sold_date_sk","cs_call_center_sk","cs_item_sk","cs_sales_price"]
+                                              <-Map 20 [SIMPLE_EDGE]
+                                                SHUFFLE [RS_13]
+                                                  PartitionCols:_col0
+                                                  Select Operator [SEL_75] (rows=73048 width=1119)
+                                                    Output:["_col0","_col1","_col2"]
+                                                    Filter Operator [FIL_177] (rows=73048 width=1119)
+                                                      predicate:(((d_year = 2000) or ((d_year = 1999) and (d_moy = 12)) or ((d_year = 2001) and (d_moy = 1))) and d_date_sk is not null)
+                                                      TableScan [TS_73] (rows=73049 width=1119)
+                                                        default@date_dim,date_dim,Tbl:COMPLETE,Col:NONE,Output:["d_date_sk","d_year","d_moy"]
+                <-Reducer 19 [SIMPLE_EDGE]
                   SHUFFLE [RS_104]
                     PartitionCols:_col0, _col2, _col1, _col7
                     Select Operator [SEL_67] (rows=15971437 width=135)
@@ -145,7 +216,7 @@ Stage-0
                               Function definitions:[{},{"name:":"windowingtablefunction","order by:":"_col4 ASC NULLS FIRST, _col5 ASC NULLS FIRST","partition by:":"_col1, _col2, _col3"}]
                               Select Operator [SEL_64] (rows=191657247 width=135)
                                 Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6"]
-                              <-Reducer 13 [SIMPLE_EDGE]
+                              <-Reducer 18 [SIMPLE_EDGE]
                                 SHUFFLE [RS_63]
                                   PartitionCols:_col0, _col1, _col2
                                   Select Operator [SEL_62] (rows=191657247 width=135)
@@ -154,14 +225,14 @@ Stage-0
                                       Function definitions:[{},{"name:":"windowingtablefunction","order by:":"_col0 ASC NULLS FIRST, _col1 ASC NULLS FIRST, _col2 ASC NULLS FIRST, _col3 ASC NULLS FIRST","partition by:":"_col0, _col1, _col2, _col3"}]
                                       Select Operator [SEL_60] (rows=191657247 width=135)
                                         Output:["_col0","_col1","_col2","_col3","_col4","_col5"]
-                                      <-Reducer 12 [SIMPLE_EDGE]
+                                      <-Reducer 17 [SIMPLE_EDGE]
                                         SHUFFLE [RS_59]
                                           PartitionCols:_col0, _col1, _col2, _col3
                                           Select Operator [SEL_58] (rows=191657247 width=135)
                                             Output:["_col0","_col1","_col2","_col3","_col4","_col5"]
                                             Group By Operator [GBY_57] (rows=191657247 width=135)
                                               Output:["_col0","_col1","_col2","_col3","_col4","_col5"],aggregations:["sum(VALUE._col0)"],keys:KEY._col0, KEY._col1, KEY._col2, KEY._col3, KEY._col4
-                                            <-Reducer 11 [SIMPLE_EDGE]
+                                            <-Reducer 16 [SIMPLE_EDGE]
                                               SHUFFLE [RS_56]
                                                 PartitionCols:_col0, _col1, _col2, _col3, _col4
                                                 Group By Operator [GBY_55] (rows=383314495 width=135)
@@ -171,13 +242,8 @@ Stage-0
                                                   <-Map 22 [SIMPLE_EDGE]
                                                     SHUFFLE [RS_52]
                                                       PartitionCols:_col0
-                                                      Select Operator [SEL_11] (rows=462000 width=1436)
-                                                        Output:["_col0","_col1","_col2"]
-                                                        Filter Operator [FIL_168] (rows=462000 width=1436)
-                                                          predicate:(i_item_sk is not null and i_category is not null and i_brand is not null)
-                                                          TableScan [TS_9] (rows=462000 width=1436)
-                                                            default@item,item,Tbl:COMPLETE,Col:NONE,Output:["i_item_sk","i_brand","i_category"]
-                                                  <-Reducer 10 [SIMPLE_EDGE]
+                                                       Please refer to the previous Select Operator [SEL_81]
+                                                  <-Reducer 15 [SIMPLE_EDGE]
                                                     SHUFFLE [RS_51]
                                                       PartitionCols:_col2
                                                       Merge Join Operator [MERGEJOIN_184] (rows=348467716 width=135)
@@ -185,13 +251,8 @@ Stage-0
                                                       <-Map 21 [SIMPLE_EDGE]
                                                         SHUFFLE [RS_49]
                                                           PartitionCols:_col0
-                                                          Select Operator [SEL_8] (rows=60 width=2045)
-                                                            Output:["_col0","_col1"]
-                                                            Filter Operator [FIL_167] (rows=60 width=2045)
-                                                              predicate:(cc_call_center_sk is not null and cc_name is not null)
-                                                              TableScan [TS_6] (rows=60 width=2045)
-                                                                default@call_center,call_center,Tbl:COMPLETE,Col:NONE,Output:["cc_call_center_sk","cc_name"]
-                                                      <-Reducer 9 [SIMPLE_EDGE]
+                                                           Please refer to the previous Select Operator [SEL_78]
+                                                      <-Reducer 14 [SIMPLE_EDGE]
                                                         SHUFFLE [RS_48]
                                                           PartitionCols:_col1
                                                           Merge Join Operator [MERGEJOIN_183] (rows=316788826 width=135)
@@ -199,22 +260,12 @@ Stage-0
                                                           <-Map 1 [SIMPLE_EDGE]
                                                             SHUFFLE [RS_45]
                                                               PartitionCols:_col0
-                                                              Select Operator [SEL_2] (rows=287989836 width=135)
-                                                                Output:["_col0","_col1","_col2","_col3"]
-                                                                Filter Operator [FIL_165] (rows=287989836 width=135)
-                                                                  predicate:(cs_item_sk is not null and cs_sold_date_sk is not null and cs_call_center_sk is not null)
-                                                                  TableScan [TS_0] (rows=287989836 width=135)
-                                                                    default@catalog_sales,catalog_sales,Tbl:COMPLETE,Col:NONE,Output:["cs_sold_date_sk","cs_call_center_sk","cs_item_sk","cs_sales_price"]
+                                                               Please refer to the previous Select Operator [SEL_72]
                                                           <-Map 20 [SIMPLE_EDGE]
                                                             SHUFFLE [RS_46]
                                                               PartitionCols:_col0
-                                                              Select Operator [SEL_5] (rows=73048 width=1119)
-                                                                Output:["_col0","_col1","_col2"]
-                                                                Filter Operator [FIL_166] (rows=73048 width=1119)
-                                                                  predicate:(((d_year = 2000) or ((d_year = 1999) and (d_moy = 12)) or ((d_year = 2001) and (d_moy = 1))) and d_date_sk is not null)
-                                                                  TableScan [TS_3] (rows=73049 width=1119)
-                                                                    default@date_dim,date_dim,Tbl:COMPLETE,Col:NONE,Output:["d_date_sk","d_year","d_moy"]
-                <-Reducer 19 [SIMPLE_EDGE]
+                                                               Please refer to the previous Select Operator [SEL_75]
+                <-Reducer 6 [SIMPLE_EDGE]
                   SHUFFLE [RS_105]
                     PartitionCols:_col0, _col2, _col1, (_col6 - 1)
                     Select Operator [SEL_99] (rows=191657247 width=135)
@@ -225,14 +276,14 @@ Stage-0
                           Function definitions:[{},{"name:":"windowingtablefunction","order by:":"_col3 ASC NULLS FIRST, _col4 ASC NULLS FIRST","partition by:":"_col0, _col1, _col2"}]
                           Select Operator [SEL_97] (rows=191657247 width=135)
                             Output:["_col0","_col1","_col2","_col3","_col4","_col5"]
-                          <-Reducer 18 [SIMPLE_EDGE]
+                          <-Reducer 5 [SIMPLE_EDGE]
                             SHUFFLE [RS_96]
                               PartitionCols:_col0, _col1, _col2
                               Select Operator [SEL_95] (rows=191657247 width=135)
                                 Output:["_col0","_col1","_col2","_col3","_col4","_col5"]
                                 Group By Operator [GBY_94] (rows=191657247 width=135)
                                   Output:["_col0","_col1","_col2","_col3","_col4","_col5"],aggregations:["sum(VALUE._col0)"],keys:KEY._col0, KEY._col1, KEY._col2, KEY._col3, KEY._col4
-                                <-Reducer 17 [SIMPLE_EDGE]
+                                <-Reducer 4 [SIMPLE_EDGE]
                                   SHUFFLE [RS_93]
                                     PartitionCols:_col0, _col1, _col2, _col3, _col4
                                     Group By Operator [GBY_92] (rows=383314495 width=135)
@@ -242,8 +293,8 @@ Stage-0
                                       <-Map 22 [SIMPLE_EDGE]
                                         SHUFFLE [RS_89]
                                           PartitionCols:_col0
-                                           Please refer to the previous Select Operator [SEL_11]
-                                      <-Reducer 16 [SIMPLE_EDGE]
+                                           Please refer to the previous Select Operator [SEL_81]
+                                      <-Reducer 3 [SIMPLE_EDGE]
                                         SHUFFLE [RS_88]
                                           PartitionCols:_col2
                                           Merge Join Operator [MERGEJOIN_187] (rows=348467716 width=135)
@@ -251,8 +302,8 @@ Stage-0
                                           <-Map 21 [SIMPLE_EDGE]
                                             SHUFFLE [RS_86]
                                               PartitionCols:_col0
-                                               Please refer to the previous Select Operator [SEL_8]
-                                          <-Reducer 15 [SIMPLE_EDGE]
+                                               Please refer to the previous Select Operator [SEL_78]
+                                          <-Reducer 2 [SIMPLE_EDGE]
                                             SHUFFLE [RS_85]
                                               PartitionCols:_col1
                                               Merge Join Operator [MERGEJOIN_186] (rows=316788826 width=135)
@@ -260,60 +311,9 @@ Stage-0
                                               <-Map 1 [SIMPLE_EDGE]
                                                 SHUFFLE [RS_82]
                                                   PartitionCols:_col0
-                                                   Please refer to the previous Select Operator [SEL_2]
+                                                   Please refer to the previous Select Operator [SEL_72]
                                               <-Map 20 [SIMPLE_EDGE]
                                                 SHUFFLE [RS_83]
                                                   PartitionCols:_col0
-                                                   Please refer to the previous Select Operator [SEL_5]
-                <-Reducer 6 [SIMPLE_EDGE]
-                  SHUFFLE [RS_103]
-                    PartitionCols:_col0, _col2, _col1, (_col6 + 1)
-                    Select Operator [SEL_29] (rows=191657247 width=135)
-                      Output:["_col0","_col1","_col2","_col5","_col6"]
-                      Filter Operator [FIL_164] (rows=191657247 width=135)
-                        predicate:rank_window_0 is not null
-                        PTF Operator [PTF_28] (rows=191657247 width=135)
-                          Function definitions:[{},{"name:":"windowingtablefunction","order by:":"_col3 ASC NULLS FIRST, _col4 ASC NULLS FIRST","partition by:":"_col0, _col1, _col2"}]
-                          Select Operator [SEL_27] (rows=191657247 width=135)
-                            Output:["_col0","_col1","_col2","_col3","_col4","_col5"]
-                          <-Reducer 5 [SIMPLE_EDGE]
-                            SHUFFLE [RS_26]
-                              PartitionCols:_col0, _col1, _col2
-                              Select Operator [SEL_25] (rows=191657247 width=135)
-                                Output:["_col0","_col1","_col2","_col3","_col4","_col5"]
-                                Group By Operator [GBY_24] (rows=191657247 width=135)
-                                  Output:["_col0","_col1","_col2","_col3","_col4","_col5"],aggregations:["sum(VALUE._col0)"],keys:KEY._col0, KEY._col1, KEY._col2, KEY._col3, KEY._col4
-                                <-Reducer 4 [SIMPLE_EDGE]
-                                  SHUFFLE [RS_23]
-                                    PartitionCols:_col0, _col1, _col2, _col3, _col4
-                                    Group By Operator [GBY_22] (rows=383314495 width=135)
-                                      Output:["_col0","_col1","_col2","_col3","_col4","_col5"],aggregations:["sum(_col3)"],keys:_col5, _col6, _col8, _col10, _col11
-                                      Merge Join Operator [MERGEJOIN_182] (rows=383314495 width=135)
-                                        Conds:RS_18._col2=RS_19._col0(Inner),Output:["_col3","_col5","_col6","_col8","_col10","_col11"]
-                                      <-Map 22 [SIMPLE_EDGE]
-                                        SHUFFLE [RS_19]
-                                          PartitionCols:_col0
-                                           Please refer to the previous Select Operator [SEL_11]
-                                      <-Reducer 3 [SIMPLE_EDGE]
-                                        SHUFFLE [RS_18]
-                                          PartitionCols:_col2
-                                          Merge Join Operator [MERGEJOIN_181] (rows=348467716 width=135)
-                                            Conds:RS_15._col1=RS_16._col0(Inner),Output:["_col2","_col3","_col5","_col6","_col8"]
-                                          <-Map 21 [SIMPLE_EDGE]
-                                            SHUFFLE [RS_16]
-                                              PartitionCols:_col0
-                                               Please refer to the previous Select Operator [SEL_8]
-                                          <-Reducer 2 [SIMPLE_EDGE]
-                                            SHUFFLE [RS_15]
-                                              PartitionCols:_col1
-                                              Merge Join Operator [MERGEJOIN_180] (rows=316788826 width=135)
-                                                Conds:RS_12._col0=RS_13._col0(Inner),Output:["_col1","_col2","_col3","_col5","_col6"]
-                                              <-Map 1 [SIMPLE_EDGE]
-                                                SHUFFLE [RS_12]
-                                                  PartitionCols:_col0
-                                                   Please refer to the previous Select Operator [SEL_2]
-                                              <-Map 20 [SIMPLE_EDGE]
-                                                SHUFFLE [RS_13]
-                                                  PartitionCols:_col0
-                                                   Please refer to the previous Select Operator [SEL_5]
+                                                   Please refer to the previous Select Operator [SEL_75]
 
diff --git a/ql/src/test/results/clientpositive/perf/query58.q.out b/ql/src/test/results/clientpositive/perf/query58.q.out
index 7be1ff5da0..ca1a5b35aa 100644
--- a/ql/src/test/results/clientpositive/perf/query58.q.out
+++ b/ql/src/test/results/clientpositive/perf/query58.q.out
@@ -222,7 +222,7 @@ Stage-0
                                                 Output:["_col0","_col1"]
                                                 Filter Operator [FIL_257] (rows=73049 width=1119)
                                                   predicate:(d_week_seq is not null and d_date is not null)
-                                                  TableScan [TS_18] (rows=73049 width=1119)
+                                                  TableScan [TS_21] (rows=73049 width=1119)
                                                     default@date_dim,date_dim,Tbl:COMPLETE,Col:NONE,Output:["d_date","d_week_seq"]
                                           <-Reducer 24 [SIMPLE_EDGE]
                                             SHUFFLE [RS_77]
@@ -235,7 +235,7 @@ Stage-0
                                                     Output:["_col0"]
                                                     Filter Operator [FIL_256] (rows=36524 width=1119)
                                                       predicate:((d_date = '1998-02-19') and d_week_seq is not null)
-                                                       Please refer to the previous TableScan [TS_18]
+                                                       Please refer to the previous TableScan [TS_21]
                                               <-Reducer 23 [CUSTOM_SIMPLE_EDGE]
                                                 PARTITION_ONLY_SHUFFLE [RS_74]
                                                   Select Operator [SEL_67] (rows=1 width=8)
@@ -333,7 +333,7 @@ Stage-0
                                                 Output:["_col0","_col1"]
                                                 Filter Operator [FIL_263] (rows=73049 width=1119)
                                                   predicate:(d_week_seq is not null and d_date is not null)
-                                                   Please refer to the previous TableScan [TS_18]
+                                                   Please refer to the previous TableScan [TS_21]
                                           <-Reducer 28 [SIMPLE_EDGE]
                                             SHUFFLE [RS_127]
                                               PartitionCols:_col1
@@ -345,7 +345,7 @@ Stage-0
                                                     Output:["_col0"]
                                                     Filter Operator [FIL_262] (rows=36524 width=1119)
                                                       predicate:((d_date = '1998-02-19') and d_week_seq is not null)
-                                                       Please refer to the previous TableScan [TS_18]
+                                                       Please refer to the previous TableScan [TS_21]
                                               <-Reducer 27 [CUSTOM_SIMPLE_EDGE]
                                                 PARTITION_ONLY_SHUFFLE [RS_124]
                                                   Select Operator [SEL_117] (rows=1 width=8)
@@ -396,7 +396,7 @@ Stage-0
                                                 Output:["_col0","_col1"]
                                                 Filter Operator [FIL_251] (rows=73049 width=1119)
                                                   predicate:(d_week_seq is not null and d_date is not null)
-                                                   Please refer to the previous TableScan [TS_18]
+                                                   Please refer to the previous TableScan [TS_21]
                                           <-Reducer 20 [SIMPLE_EDGE]
                                             SHUFFLE [RS_27]
                                               PartitionCols:_col1
@@ -408,7 +408,7 @@ Stage-0
                                                     Output:["_col0"]
                                                     Filter Operator [FIL_250] (rows=36524 width=1119)
                                                       predicate:((d_date = '1998-02-19') and d_week_seq is not null)
-                                                       Please refer to the previous TableScan [TS_18]
+                                                       Please refer to the previous TableScan [TS_21]
                                               <-Reducer 19 [CUSTOM_SIMPLE_EDGE]
                                                 PARTITION_ONLY_SHUFFLE [RS_24]
                                                   Select Operator [SEL_17] (rows=1 width=8)
diff --git a/ql/src/test/results/clientpositive/perf/query64.q.out b/ql/src/test/results/clientpositive/perf/query64.q.out
index 8afb008db1..2559d9263a 100644
--- a/ql/src/test/results/clientpositive/perf/query64.q.out
+++ b/ql/src/test/results/clientpositive/perf/query64.q.out
@@ -243,41 +243,41 @@ Reducer 12 <- Map 1 (SIMPLE_EDGE), Map 20 (SIMPLE_EDGE)
 Reducer 13 <- Map 20 (SIMPLE_EDGE), Reducer 12 (SIMPLE_EDGE)
 Reducer 14 <- Reducer 13 (SIMPLE_EDGE), Reducer 38 (SIMPLE_EDGE)
 Reducer 15 <- Map 41 (SIMPLE_EDGE), Reducer 14 (SIMPLE_EDGE)
-Reducer 16 <- Map 42 (SIMPLE_EDGE), Reducer 15 (SIMPLE_EDGE)
+Reducer 16 <- Map 55 (SIMPLE_EDGE), Reducer 15 (SIMPLE_EDGE)
 Reducer 17 <- Reducer 16 (SIMPLE_EDGE), Reducer 34 (SIMPLE_EDGE)
-Reducer 18 <- Map 42 (SIMPLE_EDGE), Reducer 17 (SIMPLE_EDGE)
+Reducer 18 <- Map 55 (SIMPLE_EDGE), Reducer 17 (SIMPLE_EDGE)
 Reducer 19 <- Reducer 18 (SIMPLE_EDGE)
 Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 20 (SIMPLE_EDGE)
-Reducer 21 <- Map 20 (SIMPLE_EDGE), Reducer 44 (SIMPLE_EDGE)
-Reducer 22 <- Map 47 (SIMPLE_EDGE), Reducer 21 (SIMPLE_EDGE)
+Reducer 21 <- Map 20 (SIMPLE_EDGE), Reducer 43 (SIMPLE_EDGE)
+Reducer 22 <- Map 46 (SIMPLE_EDGE), Reducer 21 (SIMPLE_EDGE)
 Reducer 23 <- Reducer 22 (SIMPLE_EDGE), Reducer 37 (SIMPLE_EDGE)
-Reducer 24 <- Reducer 23 (SIMPLE_EDGE), Reducer 50 (ONE_TO_ONE_EDGE)
-Reducer 25 <- Map 54 (SIMPLE_EDGE), Reducer 24 (SIMPLE_EDGE)
+Reducer 24 <- Reducer 23 (SIMPLE_EDGE), Reducer 49 (ONE_TO_ONE_EDGE)
+Reducer 25 <- Map 53 (SIMPLE_EDGE), Reducer 24 (SIMPLE_EDGE)
 Reducer 26 <- Map 41 (SIMPLE_EDGE), Reducer 25 (SIMPLE_EDGE)
-Reducer 27 <- Map 55 (SIMPLE_EDGE), Reducer 26 (SIMPLE_EDGE)
-Reducer 28 <- Map 20 (SIMPLE_EDGE), Reducer 45 (SIMPLE_EDGE)
-Reducer 29 <- Map 47 (SIMPLE_EDGE), Reducer 28 (SIMPLE_EDGE)
+Reducer 27 <- Map 54 (SIMPLE_EDGE), Reducer 26 (SIMPLE_EDGE)
+Reducer 28 <- Map 20 (SIMPLE_EDGE), Reducer 44 (SIMPLE_EDGE)
+Reducer 29 <- Map 46 (SIMPLE_EDGE), Reducer 28 (SIMPLE_EDGE)
 Reducer 3 <- Map 20 (SIMPLE_EDGE), Reducer 2 (SIMPLE_EDGE)
 Reducer 30 <- Reducer 29 (SIMPLE_EDGE), Reducer 39 (SIMPLE_EDGE)
-Reducer 31 <- Reducer 30 (SIMPLE_EDGE), Reducer 52 (ONE_TO_ONE_EDGE)
-Reducer 32 <- Map 54 (SIMPLE_EDGE), Reducer 31 (SIMPLE_EDGE)
+Reducer 31 <- Reducer 30 (SIMPLE_EDGE), Reducer 51 (ONE_TO_ONE_EDGE)
+Reducer 32 <- Map 53 (SIMPLE_EDGE), Reducer 31 (SIMPLE_EDGE)
 Reducer 33 <- Map 41 (SIMPLE_EDGE), Reducer 32 (SIMPLE_EDGE)
-Reducer 34 <- Map 55 (SIMPLE_EDGE), Reducer 33 (SIMPLE_EDGE)
+Reducer 34 <- Map 54 (SIMPLE_EDGE), Reducer 33 (SIMPLE_EDGE)
 Reducer 36 <- Map 35 (SIMPLE_EDGE), Map 40 (SIMPLE_EDGE)
 Reducer 37 <- Map 35 (SIMPLE_EDGE), Map 40 (SIMPLE_EDGE)
 Reducer 38 <- Map 35 (SIMPLE_EDGE), Map 40 (SIMPLE_EDGE)
 Reducer 39 <- Map 35 (SIMPLE_EDGE), Map 40 (SIMPLE_EDGE)
 Reducer 4 <- Reducer 3 (SIMPLE_EDGE), Reducer 36 (SIMPLE_EDGE)
-Reducer 44 <- Map 43 (SIMPLE_EDGE), Map 46 (SIMPLE_EDGE)
-Reducer 45 <- Map 43 (SIMPLE_EDGE), Map 46 (SIMPLE_EDGE)
-Reducer 49 <- Map 48 (SIMPLE_EDGE), Map 53 (SIMPLE_EDGE)
+Reducer 43 <- Map 42 (SIMPLE_EDGE), Map 45 (SIMPLE_EDGE)
+Reducer 44 <- Map 42 (SIMPLE_EDGE), Map 45 (SIMPLE_EDGE)
+Reducer 48 <- Map 47 (SIMPLE_EDGE), Map 52 (SIMPLE_EDGE)
+Reducer 49 <- Reducer 48 (SIMPLE_EDGE)
 Reducer 5 <- Map 41 (SIMPLE_EDGE), Reducer 4 (SIMPLE_EDGE)
-Reducer 50 <- Reducer 49 (SIMPLE_EDGE)
-Reducer 51 <- Map 48 (SIMPLE_EDGE), Map 53 (SIMPLE_EDGE)
-Reducer 52 <- Reducer 51 (SIMPLE_EDGE)
-Reducer 6 <- Map 42 (SIMPLE_EDGE), Reducer 5 (SIMPLE_EDGE)
+Reducer 50 <- Map 47 (SIMPLE_EDGE), Map 52 (SIMPLE_EDGE)
+Reducer 51 <- Reducer 50 (SIMPLE_EDGE)
+Reducer 6 <- Map 55 (SIMPLE_EDGE), Reducer 5 (SIMPLE_EDGE)
 Reducer 7 <- Reducer 27 (SIMPLE_EDGE), Reducer 6 (SIMPLE_EDGE)
-Reducer 8 <- Map 42 (SIMPLE_EDGE), Reducer 7 (SIMPLE_EDGE)
+Reducer 8 <- Map 55 (SIMPLE_EDGE), Reducer 7 (SIMPLE_EDGE)
 Reducer 9 <- Reducer 8 (SIMPLE_EDGE)
 
 Stage-0
@@ -314,15 +314,15 @@ Stage-0
                                 predicate:(_col56 <> _col19)
                                 Merge Join Operator [MERGEJOIN_614] (rows=1493984654 width=88)
                                   Conds:RS_246._col37=RS_247._col0(Inner),Output:["_col7","_col9","_col14","_col15","_col16","_col17","_col19","_col23","_col24","_col25","_col26","_col28","_col29","_col43","_col44","_col45","_col46","_col49","_col56"]
-                                <-Map 42 [SIMPLE_EDGE]
+                                <-Map 55 [SIMPLE_EDGE]
                                   SHUFFLE [RS_247]
                                     PartitionCols:_col0
-                                    Select Operator [SEL_24] (rows=1861800 width=385)
+                                    Select Operator [SEL_99] (rows=1861800 width=385)
                                       Output:["_col0","_col1"]
-                                      Filter Operator [FIL_547] (rows=1861800 width=385)
+                                      Filter Operator [FIL_559] (rows=1861800 width=385)
                                         predicate:cd_demo_sk is not null
-                                        TableScan [TS_22] (rows=1861800 width=385)
-                                          default@customer_demographics,cd2,Tbl:COMPLETE,Col:NONE,Output:["cd_demo_sk","cd_marital_status"]
+                                        TableScan [TS_97] (rows=1861800 width=385)
+                                          default@customer_demographics,cd1,Tbl:COMPLETE,Col:NONE,Output:["cd_demo_sk","cd_marital_status"]
                                 <-Reducer 17 [SIMPLE_EDGE]
                                   SHUFFLE [RS_246]
                                     PartitionCols:_col37
@@ -333,10 +333,10 @@ Stage-0
                                         PartitionCols:_col0
                                         Merge Join Operator [MERGEJOIN_602] (rows=128840811 width=860)
                                           Conds:RS_240._col1=RS_241._col0(Inner),Output:["_col0","_col7","_col9","_col14","_col15","_col16","_col17","_col19"]
-                                        <-Map 42 [SIMPLE_EDGE]
+                                        <-Map 55 [SIMPLE_EDGE]
                                           SHUFFLE [RS_241]
                                             PartitionCols:_col0
-                                             Please refer to the previous Select Operator [SEL_24]
+                                             Please refer to the previous Select Operator [SEL_99]
                                         <-Reducer 15 [SIMPLE_EDGE]
                                           SHUFFLE [RS_240]
                                             PartitionCols:_col1
@@ -422,7 +422,7 @@ Stage-0
                                           Output:["_col3","_col4","_col5","_col6","_col8","_col9","_col16","_col17","_col23","_col24","_col25","_col26","_col29"]
                                           Merge Join Operator [MERGEJOIN_612] (rows=1234698008 width=88)
                                             Conds:RS_221._col5, _col12=RS_222._col0, _col1(Inner),Output:["_col6","_col7","_col13","_col14","_col15","_col16","_col19","_col26","_col27","_col29","_col30","_col31","_col32"]
-                                          <-Map 55 [SIMPLE_EDGE]
+                                          <-Map 54 [SIMPLE_EDGE]
                                             SHUFFLE [RS_222]
                                               PartitionCols:_col0, _col1
                                               Select Operator [SEL_77] (rows=57591150 width=77)
@@ -445,7 +445,7 @@ Stage-0
                                                   PartitionCols:_col9
                                                   Merge Join Operator [MERGEJOIN_610] (rows=1020411534 width=88)
                                                     Conds:RS_215._col10=RS_216._col0(Inner),Output:["_col5","_col6","_col7","_col9","_col12","_col13","_col14","_col15","_col16","_col19","_col26","_col27"]
-                                                  <-Map 54 [SIMPLE_EDGE]
+                                                  <-Map 53 [SIMPLE_EDGE]
                                                     SHUFFLE [RS_216]
                                                       PartitionCols:_col0
                                                       Select Operator [SEL_71] (rows=1704 width=1910)
@@ -471,7 +471,7 @@ Stage-0
                                                                 Output:["_col2","_col3","_col4","_col5","_col6","_col7","_col9","_col10","_col11","_col12","_col13","_col16"]
                                                                 Merge Join Operator [MERGEJOIN_606] (rows=766650239 width=88)
                                                                   Conds:RS_177._col7=RS_178._col0(Inner),Output:["_col1","_col2","_col3","_col4","_col5","_col6","_col8","_col9","_col10","_col11","_col12","_col15"]
-                                                                <-Map 47 [SIMPLE_EDGE]
+                                                                <-Map 46 [SIMPLE_EDGE]
                                                                   SHUFFLE [RS_178]
                                                                     PartitionCols:_col0
                                                                     Select Operator [SEL_42] (rows=2300 width=1179)
@@ -493,12 +493,12 @@ Stage-0
                                                                           Filter Operator [FIL_571] (rows=36524 width=1119)
                                                                             predicate:((d_year = 2001) and d_date_sk is not null)
                                                                              Please refer to the previous TableScan [TS_3]
-                                                                    <-Reducer 45 [SIMPLE_EDGE]
+                                                                    <-Reducer 44 [SIMPLE_EDGE]
                                                                       SHUFFLE [RS_174]
                                                                         PartitionCols:_col0
                                                                         Merge Join Operator [MERGEJOIN_604] (rows=633595212 width=88)
                                                                           Conds:RS_171._col1=RS_172._col0(Inner),Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7","_col8","_col9","_col10","_col11","_col12","_col15"]
-                                                                        <-Map 43 [SIMPLE_EDGE]
+                                                                        <-Map 42 [SIMPLE_EDGE]
                                                                           SHUFFLE [RS_171]
                                                                             PartitionCols:_col1
                                                                             Select Operator [SEL_33] (rows=575995635 width=88)
@@ -507,7 +507,7 @@ Stage-0
                                                                                 predicate:(ss_item_sk is not null and ss_ticket_number is not null and ss_sold_date_sk is not null and ss_store_sk is not null and ss_customer_sk is not null and ss_cdemo_sk is not null and ss_promo_sk is not null and ss_hdemo_sk is not null and ss_addr_sk is not null)
                                                                                 TableScan [TS_31] (rows=575995635 width=88)
                                                                                   default@store_sales,store_sales,Tbl:COMPLETE,Col:NONE,Output:["ss_sold_date_sk","ss_item_sk","ss_customer_sk","ss_cdemo_sk","ss_hdemo_sk","ss_addr_sk","ss_store_sk","ss_promo_sk","ss_ticket_number","ss_wholesale_cost","ss_list_price","ss_coupon_amt"]
-                                                                        <-Map 46 [SIMPLE_EDGE]
+                                                                        <-Map 45 [SIMPLE_EDGE]
                                                                           SHUFFLE [RS_172]
                                                                             PartitionCols:_col0
                                                                             Select Operator [SEL_36] (rows=2851 width=1436)
@@ -529,7 +529,7 @@ Stage-0
                                                                 SHUFFLE [RS_207]
                                                                   PartitionCols:_col0
                                                                    Please refer to the previous Select Operator [SEL_14]
-                                                      <-Reducer 52 [ONE_TO_ONE_EDGE]
+                                                      <-Reducer 51 [ONE_TO_ONE_EDGE]
                                                         FORWARD [RS_213]
                                                           PartitionCols:_col0
                                                           Select Operator [SEL_196] (rows=52798137 width=135)
@@ -538,7 +538,7 @@ Stage-0
                                                               predicate:(_col1 > (2 * _col2))
                                                               Group By Operator [GBY_194] (rows=158394413 width=135)
                                                                 Output:["_col0","_col1","_col2"],aggregations:["sum(VALUE._col0)","sum(VALUE._col1)"],keys:KEY._col0
-                                                              <-Reducer 51 [SIMPLE_EDGE]
+                                                              <-Reducer 50 [SIMPLE_EDGE]
                                                                 SHUFFLE [RS_193]
                                                                   PartitionCols:_col0
                                                                   Group By Operator [GBY_192] (rows=316788826 width=135)
@@ -547,7 +547,7 @@ Stage-0
                                                                       Output:["_col0","_col1","_col2"]
                                                                       Merge Join Operator [MERGEJOIN_607] (rows=316788826 width=135)
                                                                         Conds:RS_187._col0, _col1=RS_188._col0, _col1(Inner),Output:["_col0","_col2","_col5","_col6","_col7"]
-                                                                      <-Map 48 [SIMPLE_EDGE]
+                                                                      <-Map 47 [SIMPLE_EDGE]
                                                                         SHUFFLE [RS_187]
                                                                           PartitionCols:_col0, _col1
                                                                           Select Operator [SEL_55] (rows=287989836 width=135)
@@ -556,7 +556,7 @@ Stage-0
                                                                               predicate:(cs_item_sk is not null and cs_order_number is not null)
                                                                               TableScan [TS_53] (rows=287989836 width=135)
                                                                                 default@catalog_sales,catalog_sales,Tbl:COMPLETE,Col:NONE,Output:["cs_item_sk","cs_order_number","cs_ext_list_price"]
-                                                                      <-Map 53 [SIMPLE_EDGE]
+                                                                      <-Map 52 [SIMPLE_EDGE]
                                                                         SHUFFLE [RS_188]
                                                                           PartitionCols:_col0, _col1
                                                                           Select Operator [SEL_58] (rows=28798881 width=106)
@@ -583,10 +583,10 @@ Stage-0
                                 predicate:(_col56 <> _col19)
                                 Merge Join Operator [MERGEJOIN_596] (rows=1493984654 width=88)
                                   Conds:RS_118._col37=RS_119._col0(Inner),Output:["_col7","_col9","_col14","_col15","_col16","_col17","_col19","_col23","_col24","_col25","_col26","_col28","_col29","_col43","_col44","_col45","_col46","_col49","_col56"]
-                                <-Map 42 [SIMPLE_EDGE]
+                                <-Map 55 [SIMPLE_EDGE]
                                   SHUFFLE [RS_119]
                                     PartitionCols:_col0
-                                     Please refer to the previous Select Operator [SEL_24]
+                                     Please refer to the previous Select Operator [SEL_99]
                                 <-Reducer 7 [SIMPLE_EDGE]
                                   SHUFFLE [RS_118]
                                     PartitionCols:_col37
@@ -599,7 +599,7 @@ Stage-0
                                           Output:["_col3","_col4","_col5","_col6","_col8","_col9","_col16","_col17","_col23","_col24","_col25","_col26","_col29"]
                                           Merge Join Operator [MERGEJOIN_594] (rows=1234698008 width=88)
                                             Conds:RS_93._col5, _col12=RS_94._col0, _col1(Inner),Output:["_col6","_col7","_col13","_col14","_col15","_col16","_col19","_col26","_col27","_col29","_col30","_col31","_col32"]
-                                          <-Map 55 [SIMPLE_EDGE]
+                                          <-Map 54 [SIMPLE_EDGE]
                                             SHUFFLE [RS_94]
                                               PartitionCols:_col0, _col1
                                                Please refer to the previous Select Operator [SEL_77]
@@ -617,7 +617,7 @@ Stage-0
                                                   PartitionCols:_col9
                                                   Merge Join Operator [MERGEJOIN_592] (rows=1020411534 width=88)
                                                     Conds:RS_87._col10=RS_88._col0(Inner),Output:["_col5","_col6","_col7","_col9","_col12","_col13","_col14","_col15","_col16","_col19","_col26","_col27"]
-                                                  <-Map 54 [SIMPLE_EDGE]
+                                                  <-Map 53 [SIMPLE_EDGE]
                                                     SHUFFLE [RS_88]
                                                       PartitionCols:_col0
                                                        Please refer to the previous Select Operator [SEL_71]
@@ -638,7 +638,7 @@ Stage-0
                                                                 Output:["_col2","_col3","_col4","_col5","_col6","_col7","_col9","_col10","_col11","_col12","_col13","_col16"]
                                                                 Merge Join Operator [MERGEJOIN_588] (rows=766650239 width=88)
                                                                   Conds:RS_49._col7=RS_50._col0(Inner),Output:["_col1","_col2","_col3","_col4","_col5","_col6","_col8","_col9","_col10","_col11","_col12","_col15"]
-                                                                <-Map 47 [SIMPLE_EDGE]
+                                                                <-Map 46 [SIMPLE_EDGE]
                                                                   SHUFFLE [RS_50]
                                                                     PartitionCols:_col0
                                                                      Please refer to the previous Select Operator [SEL_42]
@@ -655,16 +655,16 @@ Stage-0
                                                                           Filter Operator [FIL_552] (rows=36524 width=1119)
                                                                             predicate:((d_year = 2000) and d_date_sk is not null)
                                                                              Please refer to the previous TableScan [TS_3]
-                                                                    <-Reducer 44 [SIMPLE_EDGE]
+                                                                    <-Reducer 43 [SIMPLE_EDGE]
                                                                       SHUFFLE [RS_46]
                                                                         PartitionCols:_col0
                                                                         Merge Join Operator [MERGEJOIN_586] (rows=633595212 width=88)
                                                                           Conds:RS_43._col1=RS_44._col0(Inner),Output:["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7","_col8","_col9","_col10","_col11","_col12","_col15"]
-                                                                        <-Map 43 [SIMPLE_EDGE]
+                                                                        <-Map 42 [SIMPLE_EDGE]
                                                                           SHUFFLE [RS_43]
                                                                             PartitionCols:_col1
                                                                              Please refer to the previous Select Operator [SEL_33]
-                                                                        <-Map 46 [SIMPLE_EDGE]
+                                                                        <-Map 45 [SIMPLE_EDGE]
                                                                           SHUFFLE [RS_44]
                                                                             PartitionCols:_col0
                                                                              Please refer to the previous Select Operator [SEL_36]
@@ -681,7 +681,7 @@ Stage-0
                                                                 SHUFFLE [RS_79]
                                                                   PartitionCols:_col0
                                                                    Please refer to the previous Select Operator [SEL_14]
-                                                      <-Reducer 50 [ONE_TO_ONE_EDGE]
+                                                      <-Reducer 49 [ONE_TO_ONE_EDGE]
                                                         FORWARD [RS_85]
                                                           PartitionCols:_col0
                                                           Select Operator [SEL_68] (rows=52798137 width=135)
@@ -690,7 +690,7 @@ Stage-0
                                                               predicate:(_col1 > (2 * _col2))
                                                               Group By Operator [GBY_66] (rows=158394413 width=135)
                                                                 Output:["_col0","_col1","_col2"],aggregations:["sum(VALUE._col0)","sum(VALUE._col1)"],keys:KEY._col0
-                                                              <-Reducer 49 [SIMPLE_EDGE]
+                                                              <-Reducer 48 [SIMPLE_EDGE]
                                                                 SHUFFLE [RS_65]
                                                                   PartitionCols:_col0
                                                                   Group By Operator [GBY_64] (rows=316788826 width=135)
@@ -699,11 +699,11 @@ Stage-0
                                                                       Output:["_col0","_col1","_col2"]
                                                                       Merge Join Operator [MERGEJOIN_589] (rows=316788826 width=135)
                                                                         Conds:RS_59._col0, _col1=RS_60._col0, _col1(Inner),Output:["_col0","_col2","_col5","_col6","_col7"]
-                                                                      <-Map 48 [SIMPLE_EDGE]
+                                                                      <-Map 47 [SIMPLE_EDGE]
                                                                         SHUFFLE [RS_59]
                                                                           PartitionCols:_col0, _col1
                                                                            Please refer to the previous Select Operator [SEL_55]
-                                                                      <-Map 53 [SIMPLE_EDGE]
+                                                                      <-Map 52 [SIMPLE_EDGE]
                                                                         SHUFFLE [RS_60]
                                                                           PartitionCols:_col0, _col1
                                                                            Please refer to the previous Select Operator [SEL_58]
@@ -712,10 +712,10 @@ Stage-0
                                         PartitionCols:_col0
                                         Merge Join Operator [MERGEJOIN_584] (rows=128840811 width=860)
                                           Conds:RS_112._col1=RS_113._col0(Inner),Output:["_col0","_col7","_col9","_col14","_col15","_col16","_col17","_col19"]
-                                        <-Map 42 [SIMPLE_EDGE]
+                                        <-Map 55 [SIMPLE_EDGE]
                                           SHUFFLE [RS_113]
                                             PartitionCols:_col0
-                                             Please refer to the previous Select Operator [SEL_24]
+                                             Please refer to the previous Select Operator [SEL_99]
                                         <-Reducer 5 [SIMPLE_EDGE]
                                           SHUFFLE [RS_112]
                                             PartitionCols:_col1
diff --git a/ql/src/test/results/clientpositive/perf/query74.q.out b/ql/src/test/results/clientpositive/perf/query74.q.out
index 9dddd6a9be..1073c4a087 100644
--- a/ql/src/test/results/clientpositive/perf/query74.q.out
+++ b/ql/src/test/results/clientpositive/perf/query74.q.out
@@ -121,19 +121,19 @@ POSTHOOK: type: QUERY
 Plan optimized by CBO.
 
 Vertex dependency in root stage
-Reducer 11 <- Map 10 (SIMPLE_EDGE), Map 18 (SIMPLE_EDGE)
-Reducer 12 <- Map 17 (SIMPLE_EDGE), Reducer 11 (SIMPLE_EDGE)
+Reducer 11 <- Map 10 (SIMPLE_EDGE), Map 17 (SIMPLE_EDGE)
+Reducer 12 <- Map 18 (SIMPLE_EDGE), Reducer 11 (SIMPLE_EDGE)
 Reducer 13 <- Reducer 12 (SIMPLE_EDGE)
-Reducer 14 <- Map 10 (SIMPLE_EDGE), Map 18 (SIMPLE_EDGE)
-Reducer 15 <- Map 17 (SIMPLE_EDGE), Reducer 14 (SIMPLE_EDGE)
+Reducer 14 <- Map 10 (SIMPLE_EDGE), Map 17 (SIMPLE_EDGE)
+Reducer 15 <- Map 18 (SIMPLE_EDGE), Reducer 14 (SIMPLE_EDGE)
 Reducer 16 <- Reducer 15 (SIMPLE_EDGE)
-Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 10 (SIMPLE_EDGE)
-Reducer 3 <- Map 17 (SIMPLE_EDGE), Reducer 2 (SIMPLE_EDGE)
+Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 17 (SIMPLE_EDGE)
+Reducer 3 <- Map 18 (SIMPLE_EDGE), Reducer 2 (SIMPLE_EDGE)
 Reducer 4 <- Reducer 3 (SIMPLE_EDGE)
 Reducer 5 <- Reducer 13 (SIMPLE_EDGE), Reducer 16 (SIMPLE_EDGE), Reducer 4 (SIMPLE_EDGE), Reducer 9 (SIMPLE_EDGE)
 Reducer 6 <- Reducer 5 (SIMPLE_EDGE)
-Reducer 7 <- Map 1 (SIMPLE_EDGE), Map 10 (SIMPLE_EDGE)
-Reducer 8 <- Map 17 (SIMPLE_EDGE), Reducer 7 (SIMPLE_EDGE)
+Reducer 7 <- Map 1 (SIMPLE_EDGE), Map 17 (SIMPLE_EDGE)
+Reducer 8 <- Map 18 (SIMPLE_EDGE), Reducer 7 (SIMPLE_EDGE)
 Reducer 9 <- Reducer 8 (SIMPLE_EDGE)
 
 Stage-0
@@ -155,6 +155,52 @@ Stage-0
                   Merge Join Operator [MERGEJOIN_171] (rows=1149975359 width=88)
                     Conds:RS_82._col0=RS_83._col0(Inner),RS_83._col0=RS_84._col0(Inner),RS_83._col0=RS_85._col0(Inner),Output:["_col4","_col9","_col14","_col15","_col16","_col17","_col19"]
                   <-Reducer 13 [SIMPLE_EDGE]
+                    SHUFFLE [RS_85]
+                      PartitionCols:_col0
+                      Select Operator [SEL_81] (rows=348477374 width=88)
+                        Output:["_col0","_col1","_col2","_col4"]
+                        Group By Operator [GBY_80] (rows=348477374 width=88)
+                          Output:["_col0","_col1","_col2","_col3","_col4"],aggregations:["max(VALUE._col0)"],keys:KEY._col0, KEY._col1, KEY._col2, KEY._col3
+                        <-Reducer 12 [SIMPLE_EDGE]
+                          SHUFFLE [RS_79]
+                            PartitionCols:_col0, _col1, _col2, _col3
+                            Group By Operator [GBY_78] (rows=696954748 width=88)
+                              Output:["_col0","_col1","_col2","_col3","_col4"],aggregations:["max(_col2)"],keys:_col6, _col7, _col8, _col4
+                              Merge Join Operator [MERGEJOIN_170] (rows=696954748 width=88)
+                                Conds:RS_74._col1=RS_75._col0(Inner),Output:["_col2","_col4","_col6","_col7","_col8"]
+                              <-Map 18 [SIMPLE_EDGE]
+                                SHUFFLE [RS_75]
+                                  PartitionCols:_col0
+                                  Select Operator [SEL_70] (rows=80000000 width=860)
+                                    Output:["_col0","_col1","_col2","_col3"]
+                                    Filter Operator [FIL_160] (rows=80000000 width=860)
+                                      predicate:(c_customer_sk is not null and c_customer_id is not null)
+                                      TableScan [TS_68] (rows=80000000 width=860)
+                                        default@customer,customer,Tbl:COMPLETE,Col:NONE,Output:["c_customer_sk","c_customer_id","c_first_name","c_last_name"]
+                              <-Reducer 11 [SIMPLE_EDGE]
+                                SHUFFLE [RS_74]
+                                  PartitionCols:_col1
+                                  Merge Join Operator [MERGEJOIN_169] (rows=633595212 width=88)
+                                    Conds:RS_71._col0=RS_72._col0(Inner),Output:["_col1","_col2","_col4"]
+                                  <-Map 17 [SIMPLE_EDGE]
+                                    SHUFFLE [RS_72]
+                                      PartitionCols:_col0
+                                      Select Operator [SEL_67] (rows=18262 width=1119)
+                                        Output:["_col0","_col1"]
+                                        Filter Operator [FIL_159] (rows=18262 width=1119)
+                                          predicate:((d_year) IN (2001, 2002) and (d_year = 2002) and d_date_sk is not null)
+                                          TableScan [TS_65] (rows=73049 width=1119)
+                                            default@date_dim,date_dim,Tbl:COMPLETE,Col:NONE,Output:["d_date_sk","d_year"]
+                                  <-Map 10 [SIMPLE_EDGE]
+                                    SHUFFLE [RS_71]
+                                      PartitionCols:_col0
+                                      Select Operator [SEL_64] (rows=575995635 width=88)
+                                        Output:["_col0","_col1","_col2"]
+                                        Filter Operator [FIL_158] (rows=575995635 width=88)
+                                          predicate:(ss_customer_sk is not null and ss_sold_date_sk is not null)
+                                          TableScan [TS_62] (rows=575995635 width=88)
+                                            default@store_sales,store_sales,Tbl:COMPLETE,Col:NONE,Output:["ss_sold_date_sk","ss_customer_sk","ss_net_paid"]
+                  <-Reducer 16 [SIMPLE_EDGE]
                     SHUFFLE [RS_83]
                       PartitionCols:_col0
                       Filter Operator [FIL_39] (rows=116159124 width=88)
@@ -163,80 +209,34 @@ Stage-0
                           Output:["_col0","_col4"]
                           Group By Operator [GBY_38] (rows=348477374 width=88)
                             Output:["_col0","_col1","_col2","_col3","_col4"],aggregations:["max(VALUE._col0)"],keys:KEY._col0, KEY._col1, KEY._col2, KEY._col3
-                          <-Reducer 12 [SIMPLE_EDGE]
+                          <-Reducer 15 [SIMPLE_EDGE]
                             SHUFFLE [RS_37]
                               PartitionCols:_col0, _col1, _col2, _col3
                               Group By Operator [GBY_36] (rows=696954748 width=88)
                                 Output:["_col0","_col1","_col2","_col3","_col4"],aggregations:["max(_col2)"],keys:_col6, _col7, _col8, _col4
                                 Merge Join Operator [MERGEJOIN_166] (rows=696954748 width=88)
                                   Conds:RS_32._col1=RS_33._col0(Inner),Output:["_col2","_col4","_col6","_col7","_col8"]
-                                <-Map 17 [SIMPLE_EDGE]
+                                <-Map 18 [SIMPLE_EDGE]
                                   SHUFFLE [RS_33]
                                     PartitionCols:_col0
-                                    Select Operator [SEL_8] (rows=80000000 width=860)
-                                      Output:["_col0","_col1","_col2","_col3"]
-                                      Filter Operator [FIL_151] (rows=80000000 width=860)
-                                        predicate:(c_customer_sk is not null and c_customer_id is not null)
-                                        TableScan [TS_6] (rows=80000000 width=860)
-                                          default@customer,customer,Tbl:COMPLETE,Col:NONE,Output:["c_customer_sk","c_customer_id","c_first_name","c_last_name"]
-                                <-Reducer 11 [SIMPLE_EDGE]
+                                     Please refer to the previous Select Operator [SEL_70]
+                                <-Reducer 14 [SIMPLE_EDGE]
                                   SHUFFLE [RS_32]
                                     PartitionCols:_col1
                                     Merge Join Operator [MERGEJOIN_165] (rows=633595212 width=88)
                                       Conds:RS_29._col0=RS_30._col0(Inner),Output:["_col1","_col2","_col4"]
-                                    <-Map 10 [SIMPLE_EDGE]
+                                    <-Map 17 [SIMPLE_EDGE]
                                       SHUFFLE [RS_30]
                                         PartitionCols:_col0
                                         Select Operator [SEL_25] (rows=18262 width=1119)
                                           Output:["_col0","_col1"]
                                           Filter Operator [FIL_153] (rows=18262 width=1119)
                                             predicate:((d_year) IN (2001, 2002) and (d_year = 2001) and d_date_sk is not null)
-                                            TableScan [TS_3] (rows=73049 width=1119)
-                                              default@date_dim,date_dim,Tbl:COMPLETE,Col:NONE,Output:["d_date_sk","d_year"]
-                                    <-Map 18 [SIMPLE_EDGE]
+                                             Please refer to the previous TableScan [TS_65]
+                                    <-Map 10 [SIMPLE_EDGE]
                                       SHUFFLE [RS_29]
                                         PartitionCols:_col0
-                                        Select Operator [SEL_22] (rows=575995635 width=88)
-                                          Output:["_col0","_col1","_col2"]
-                                          Filter Operator [FIL_152] (rows=575995635 width=88)
-                                            predicate:(ss_customer_sk is not null and ss_sold_date_sk is not null)
-                                            TableScan [TS_20] (rows=575995635 width=88)
-                                              default@store_sales,store_sales,Tbl:COMPLETE,Col:NONE,Output:["ss_sold_date_sk","ss_customer_sk","ss_net_paid"]
-                  <-Reducer 16 [SIMPLE_EDGE]
-                    SHUFFLE [RS_85]
-                      PartitionCols:_col0
-                      Select Operator [SEL_81] (rows=348477374 width=88)
-                        Output:["_col0","_col1","_col2","_col4"]
-                        Group By Operator [GBY_80] (rows=348477374 width=88)
-                          Output:["_col0","_col1","_col2","_col3","_col4"],aggregations:["max(VALUE._col0)"],keys:KEY._col0, KEY._col1, KEY._col2, KEY._col3
-                        <-Reducer 15 [SIMPLE_EDGE]
-                          SHUFFLE [RS_79]
-                            PartitionCols:_col0, _col1, _col2, _col3
-                            Group By Operator [GBY_78] (rows=696954748 width=88)
-                              Output:["_col0","_col1","_col2","_col3","_col4"],aggregations:["max(_col2)"],keys:_col6, _col7, _col8, _col4
-                              Merge Join Operator [MERGEJOIN_170] (rows=696954748 width=88)
-                                Conds:RS_74._col1=RS_75._col0(Inner),Output:["_col2","_col4","_col6","_col7","_col8"]
-                              <-Map 17 [SIMPLE_EDGE]
-                                SHUFFLE [RS_75]
-                                  PartitionCols:_col0
-                                   Please refer to the previous Select Operator [SEL_8]
-                              <-Reducer 14 [SIMPLE_EDGE]
-                                SHUFFLE [RS_74]
-                                  PartitionCols:_col1
-                                  Merge Join Operator [MERGEJOIN_169] (rows=633595212 width=88)
-                                    Conds:RS_71._col0=RS_72._col0(Inner),Output:["_col1","_col2","_col4"]
-                                  <-Map 10 [SIMPLE_EDGE]
-                                    SHUFFLE [RS_72]
-                                      PartitionCols:_col0
-                                      Select Operator [SEL_67] (rows=18262 width=1119)
-                                        Output:["_col0","_col1"]
-                                        Filter Operator [FIL_159] (rows=18262 width=1119)
-                                          predicate:((d_year) IN (2001, 2002) and (d_year = 2002) and d_date_sk is not null)
-                                           Please refer to the previous TableScan [TS_3]
-                                  <-Map 18 [SIMPLE_EDGE]
-                                    SHUFFLE [RS_71]
-                                      PartitionCols:_col0
-                                       Please refer to the previous Select Operator [SEL_22]
+                                         Please refer to the previous Select Operator [SEL_64]
                   <-Reducer 4 [SIMPLE_EDGE]
                     SHUFFLE [RS_82]
                       PartitionCols:_col0
@@ -251,23 +251,19 @@ Stage-0
                               Output:["_col0","_col1","_col2","_col3","_col4"],aggregations:["max(_col2)"],keys:_col6, _col7, _col8, _col4
                               Merge Join Operator [MERGEJOIN_164] (rows=174243235 width=135)
                                 Conds:RS_12._col1=RS_13._col0(Inner),Output:["_col2","_col4","_col6","_col7","_col8"]
-                              <-Map 17 [SIMPLE_EDGE]
+                              <-Map 18 [SIMPLE_EDGE]
                                 SHUFFLE [RS_13]
                                   PartitionCols:_col0
-                                   Please refer to the previous Select Operator [SEL_8]
+                                   Please refer to the previous Select Operator [SEL_70]
                               <-Reducer 2 [SIMPLE_EDGE]
                                 SHUFFLE [RS_12]
                                   PartitionCols:_col1
                                   Merge Join Operator [MERGEJOIN_163] (rows=158402938 width=135)
                                     Conds:RS_9._col0=RS_10._col0(Inner),Output:["_col1","_col2","_col4"]
-                                  <-Map 10 [SIMPLE_EDGE]
+                                  <-Map 17 [SIMPLE_EDGE]
                                     SHUFFLE [RS_10]
                                       PartitionCols:_col0
-                                      Select Operator [SEL_5] (rows=18262 width=1119)
-                                        Output:["_col0","_col1"]
-                                        Filter Operator [FIL_150] (rows=18262 width=1119)
-                                          predicate:((d_year) IN (2001, 2002) and (d_year = 2002) and d_date_sk is not null)
-                                           Please refer to the previous TableScan [TS_3]
+                                       Please refer to the previous Select Operator [SEL_67]
                                   <-Map 1 [SIMPLE_EDGE]
                                     SHUFFLE [RS_9]
                                       PartitionCols:_col0
@@ -293,23 +289,23 @@ Stage-0
                                 Output:["_col0","_col1","_col2","_col3","_col4"],aggregations:["max(_col2)"],keys:_col6, _col7, _col8, _col4
                                 Merge Join Operator [MERGEJOIN_168] (rows=174243235 width=135)
                                   Conds:RS_53._col1=RS_54._col0(Inner),Output:["_col2","_col4","_col6","_col7","_col8"]
-                                <-Map 17 [SIMPLE_EDGE]
+                                <-Map 18 [SIMPLE_EDGE]
                                   SHUFFLE [RS_54]
                                     PartitionCols:_col0
-                                     Please refer to the previous Select Operator [SEL_8]
+                                     Please refer to the previous Select Operator [SEL_70]
                                 <-Reducer 7 [SIMPLE_EDGE]
                                   SHUFFLE [RS_53]
                                     PartitionCols:_col1
                                     Merge Join Operator [MERGEJOIN_167] (rows=158402938 width=135)
                                       Conds:RS_50._col0=RS_51._col0(Inner),Output:["_col1","_col2","_col4"]
-                                    <-Map 10 [SIMPLE_EDGE]
+                                    <-Map 17 [SIMPLE_EDGE]
                                       SHUFFLE [RS_51]
                                         PartitionCols:_col0
                                         Select Operator [SEL_46] (rows=18262 width=1119)
                                           Output:["_col0","_col1"]
                                           Filter Operator [FIL_156] (rows=18262 width=1119)
                                             predicate:((d_year) IN (2001, 2002) and (d_year = 2001) and d_date_sk is not null)
-                                             Please refer to the previous TableScan [TS_3]
+                                             Please refer to the previous TableScan [TS_65]
                                     <-Map 1 [SIMPLE_EDGE]
                                       SHUFFLE [RS_50]
                                         PartitionCols:_col0
diff --git a/ql/src/test/results/clientpositive/perf/query85.q.out b/ql/src/test/results/clientpositive/perf/query85.q.out
index ebc4ac4327..8df7be673a 100644
--- a/ql/src/test/results/clientpositive/perf/query85.q.out
+++ b/ql/src/test/results/clientpositive/perf/query85.q.out
@@ -203,12 +203,12 @@ Stage-0
                       <-Map 16 [SIMPLE_EDGE]
                         SHUFFLE [RS_45]
                           PartitionCols:_col0, _col1, _col2
-                          Select Operator [SEL_20] (rows=1861800 width=385)
+                          Select Operator [SEL_23] (rows=1861800 width=385)
                             Output:["_col0","_col1","_col2"]
-                            Filter Operator [FIL_98] (rows=1861800 width=385)
+                            Filter Operator [FIL_99] (rows=1861800 width=385)
                               predicate:(((cd_education_status = '4 yr Degree') or (cd_education_status = 'Primary') or (cd_education_status = 'Advanced Degree')) and ((cd_marital_status = 'M') or (cd_marital_status = 'D') or (cd_marital_status = 'U')) and cd_demo_sk is not null and cd_marital_status is not null and cd_education_status is not null)
-                              TableScan [TS_18] (rows=1861800 width=385)
-                                default@customer_demographics,cd1,Tbl:COMPLETE,Col:NONE,Output:["cd_demo_sk","cd_marital_status","cd_education_status"]
+                              TableScan [TS_21] (rows=1861800 width=385)
+                                default@customer_demographics,cd2,Tbl:COMPLETE,Col:NONE,Output:["cd_demo_sk","cd_marital_status","cd_education_status"]
                       <-Reducer 7 [SIMPLE_EDGE]
                         SHUFFLE [RS_44]
                           PartitionCols:_col3, _col24, _col25
@@ -219,7 +219,7 @@ Stage-0
                             <-Map 16 [SIMPLE_EDGE]
                               SHUFFLE [RS_41]
                                 PartitionCols:_col0
-                                 Please refer to the previous Select Operator [SEL_20]
+                                 Please refer to the previous Select Operator [SEL_23]
                             <-Reducer 6 [SIMPLE_EDGE]
                               SHUFFLE [RS_40]
                                 PartitionCols:_col1
diff --git a/ql/src/test/results/clientpositive/perf/query9.q.out b/ql/src/test/results/clientpositive/perf/query9.q.out
index 425163e198..24de6f2e3a 100644
--- a/ql/src/test/results/clientpositive/perf/query9.q.out
+++ b/ql/src/test/results/clientpositive/perf/query9.q.out
@@ -114,16 +114,16 @@ POSTHOOK: type: QUERY
 Plan optimized by CBO.
 
 Vertex dependency in root stage
-Reducer 10 <- Reducer 32 (CUSTOM_SIMPLE_EDGE), Reducer 9 (CUSTOM_SIMPLE_EDGE)
-Reducer 11 <- Reducer 10 (CUSTOM_SIMPLE_EDGE), Reducer 21 (CUSTOM_SIMPLE_EDGE)
-Reducer 12 <- Reducer 11 (CUSTOM_SIMPLE_EDGE), Reducer 27 (CUSTOM_SIMPLE_EDGE)
-Reducer 13 <- Reducer 12 (CUSTOM_SIMPLE_EDGE), Reducer 33 (CUSTOM_SIMPLE_EDGE)
-Reducer 14 <- Reducer 13 (CUSTOM_SIMPLE_EDGE), Reducer 22 (CUSTOM_SIMPLE_EDGE)
-Reducer 15 <- Reducer 14 (CUSTOM_SIMPLE_EDGE), Reducer 28 (CUSTOM_SIMPLE_EDGE)
-Reducer 16 <- Reducer 15 (CUSTOM_SIMPLE_EDGE), Reducer 34 (CUSTOM_SIMPLE_EDGE)
+Reducer 10 <- Reducer 34 (CUSTOM_SIMPLE_EDGE), Reducer 9 (CUSTOM_SIMPLE_EDGE)
+Reducer 11 <- Reducer 10 (CUSTOM_SIMPLE_EDGE), Reducer 18 (CUSTOM_SIMPLE_EDGE)
+Reducer 12 <- Reducer 11 (CUSTOM_SIMPLE_EDGE), Reducer 24 (CUSTOM_SIMPLE_EDGE)
+Reducer 13 <- Reducer 12 (CUSTOM_SIMPLE_EDGE), Reducer 30 (CUSTOM_SIMPLE_EDGE)
+Reducer 14 <- Reducer 13 (CUSTOM_SIMPLE_EDGE), Reducer 19 (CUSTOM_SIMPLE_EDGE)
+Reducer 15 <- Reducer 14 (CUSTOM_SIMPLE_EDGE), Reducer 25 (CUSTOM_SIMPLE_EDGE)
+Reducer 16 <- Reducer 15 (CUSTOM_SIMPLE_EDGE), Reducer 31 (CUSTOM_SIMPLE_EDGE)
 Reducer 18 <- Map 17 (CUSTOM_SIMPLE_EDGE)
 Reducer 19 <- Map 17 (CUSTOM_SIMPLE_EDGE)
-Reducer 2 <- Map 1 (CUSTOM_SIMPLE_EDGE), Reducer 18 (CUSTOM_SIMPLE_EDGE)
+Reducer 2 <- Map 1 (CUSTOM_SIMPLE_EDGE), Reducer 20 (CUSTOM_SIMPLE_EDGE)
 Reducer 20 <- Map 17 (CUSTOM_SIMPLE_EDGE)
 Reducer 21 <- Map 17 (CUSTOM_SIMPLE_EDGE)
 Reducer 22 <- Map 17 (CUSTOM_SIMPLE_EDGE)
@@ -132,18 +132,18 @@ Reducer 25 <- Map 23 (CUSTOM_SIMPLE_EDGE)
 Reducer 26 <- Map 23 (CUSTOM_SIMPLE_EDGE)
 Reducer 27 <- Map 23 (CUSTOM_SIMPLE_EDGE)
 Reducer 28 <- Map 23 (CUSTOM_SIMPLE_EDGE)
-Reducer 3 <- Reducer 2 (CUSTOM_SIMPLE_EDGE), Reducer 24 (CUSTOM_SIMPLE_EDGE)
+Reducer 3 <- Reducer 2 (CUSTOM_SIMPLE_EDGE), Reducer 26 (CUSTOM_SIMPLE_EDGE)
 Reducer 30 <- Map 29 (CUSTOM_SIMPLE_EDGE)
 Reducer 31 <- Map 29 (CUSTOM_SIMPLE_EDGE)
 Reducer 32 <- Map 29 (CUSTOM_SIMPLE_EDGE)
 Reducer 33 <- Map 29 (CUSTOM_SIMPLE_EDGE)
 Reducer 34 <- Map 29 (CUSTOM_SIMPLE_EDGE)
-Reducer 4 <- Reducer 3 (CUSTOM_SIMPLE_EDGE), Reducer 30 (CUSTOM_SIMPLE_EDGE)
-Reducer 5 <- Reducer 19 (CUSTOM_SIMPLE_EDGE), Reducer 4 (CUSTOM_SIMPLE_EDGE)
-Reducer 6 <- Reducer 25 (CUSTOM_SIMPLE_EDGE), Reducer 5 (CUSTOM_SIMPLE_EDGE)
-Reducer 7 <- Reducer 31 (CUSTOM_SIMPLE_EDGE), Reducer 6 (CUSTOM_SIMPLE_EDGE)
-Reducer 8 <- Reducer 20 (CUSTOM_SIMPLE_EDGE), Reducer 7 (CUSTOM_SIMPLE_EDGE)
-Reducer 9 <- Reducer 26 (CUSTOM_SIMPLE_EDGE), Reducer 8 (CUSTOM_SIMPLE_EDGE)
+Reducer 4 <- Reducer 3 (CUSTOM_SIMPLE_EDGE), Reducer 32 (CUSTOM_SIMPLE_EDGE)
+Reducer 5 <- Reducer 21 (CUSTOM_SIMPLE_EDGE), Reducer 4 (CUSTOM_SIMPLE_EDGE)
+Reducer 6 <- Reducer 27 (CUSTOM_SIMPLE_EDGE), Reducer 5 (CUSTOM_SIMPLE_EDGE)
+Reducer 7 <- Reducer 33 (CUSTOM_SIMPLE_EDGE), Reducer 6 (CUSTOM_SIMPLE_EDGE)
+Reducer 8 <- Reducer 22 (CUSTOM_SIMPLE_EDGE), Reducer 7 (CUSTOM_SIMPLE_EDGE)
+Reducer 9 <- Reducer 28 (CUSTOM_SIMPLE_EDGE), Reducer 8 (CUSTOM_SIMPLE_EDGE)
 
 Stage-0
   Fetch Operator
@@ -179,7 +179,7 @@ Stage-0
                                 PARTITION_ONLY_SHUFFLE [RS_135]
                                   Merge Join Operator [MERGEJOIN_179] (rows=36 width=1961)
                                     Conds:(Left Outer),Output:["_col1","_col2","_col3","_col4","_col5","_col6","_col7","_col8","_col9"]
-                                  <-Reducer 32 [CUSTOM_SIMPLE_EDGE]
+                                  <-Reducer 34 [CUSTOM_SIMPLE_EDGE]
                                     PARTITION_ONLY_SHUFFLE [RS_133]
                                       Group By Operator [GBY_64] (rows=1 width=288)
                                         Output:["_col0"],aggregations:["avg(VALUE._col0)"]
@@ -191,13 +191,13 @@ Stage-0
                                               Output:["ss_net_paid_inc_tax"]
                                               Filter Operator [FIL_164] (rows=63999515 width=88)
                                                 predicate:ss_quantity BETWEEN 41 AND 60
-                                                TableScan [TS_17] (rows=575995635 width=88)
+                                                TableScan [TS_80] (rows=575995635 width=88)
                                                   default@store_sales,store_sales,Tbl:COMPLETE,Col:NONE,Output:["ss_quantity","ss_net_paid_inc_tax"]
                                   <-Reducer 9 [CUSTOM_SIMPLE_EDGE]
                                     PARTITION_ONLY_SHUFFLE [RS_132]
                                       Merge Join Operator [MERGEJOIN_178] (rows=36 width=1672)
                                         Conds:(Left Outer),Output:["_col1","_col2","_col3","_col4","_col5","_col6","_col7","_col8"]
-                                      <-Reducer 26 [CUSTOM_SIMPLE_EDGE]
+                                      <-Reducer 28 [CUSTOM_SIMPLE_EDGE]
                                         PARTITION_ONLY_SHUFFLE [RS_130]
                                           Group By Operator [GBY_57] (rows=1 width=288)
                                             Output:["_col0"],aggregations:["avg(VALUE._col0)"]
@@ -209,13 +209,13 @@ Stage-0
                                                   Output:["ss_ext_list_price"]
                                                   Filter Operator [FIL_163] (rows=63999515 width=88)
                                                     predicate:ss_quantity BETWEEN 41 AND 60
-                                                    TableScan [TS_10] (rows=575995635 width=88)
+                                                    TableScan [TS_73] (rows=575995635 width=88)
                                                       default@store_sales,store_sales,Tbl:COMPLETE,Col:NONE,Output:["ss_quantity","ss_ext_list_price"]
                                       <-Reducer 8 [CUSTOM_SIMPLE_EDGE]
                                         PARTITION_ONLY_SHUFFLE [RS_129]
                                           Merge Join Operator [MERGEJOIN_177] (rows=36 width=1383)
                                             Conds:(Left Outer),Output:["_col1","_col2","_col3","_col4","_col5","_col6","_col7"]
-                                          <-Reducer 20 [CUSTOM_SIMPLE_EDGE]
+                                          <-Reducer 22 [CUSTOM_SIMPLE_EDGE]
                                             PARTITION_ONLY_SHUFFLE [RS_127]
                                               Group By Operator [GBY_50] (rows=1 width=8)
                                                 Output:["_col0"],aggregations:["count(VALUE._col0)"]
@@ -226,13 +226,13 @@ Stage-0
                                                     Select Operator [SEL_47] (rows=63999515 width=88)
                                                       Filter Operator [FIL_162] (rows=63999515 width=88)
                                                         predicate:ss_quantity BETWEEN 41 AND 60
-                                                        TableScan [TS_3] (rows=575995635 width=88)
+                                                        TableScan [TS_66] (rows=575995635 width=88)
                                                           default@store_sales,store_sales,Tbl:COMPLETE,Col:NONE,Output:["ss_quantity"]
                                           <-Reducer 7 [CUSTOM_SIMPLE_EDGE]
                                             PARTITION_ONLY_SHUFFLE [RS_126]
                                               Merge Join Operator [MERGEJOIN_176] (rows=36 width=1374)
                                                 Conds:(Left Outer),Output:["_col1","_col2","_col3","_col4","_col5","_col6"]
-                                              <-Reducer 31 [CUSTOM_SIMPLE_EDGE]
+                                              <-Reducer 33 [CUSTOM_SIMPLE_EDGE]
                                                 PARTITION_ONLY_SHUFFLE [RS_124]
                                                   Group By Operator [GBY_43] (rows=1 width=288)
                                                     Output:["_col0"],aggregations:["avg(VALUE._col0)"]
@@ -244,12 +244,12 @@ Stage-0
                                                           Output:["ss_net_paid_inc_tax"]
                                                           Filter Operator [FIL_161] (rows=63999515 width=88)
                                                             predicate:ss_quantity BETWEEN 21 AND 40
-                                                             Please refer to the previous TableScan [TS_17]
+                                                             Please refer to the previous TableScan [TS_80]
                                               <-Reducer 6 [CUSTOM_SIMPLE_EDGE]
                                                 PARTITION_ONLY_SHUFFLE [RS_123]
                                                   Merge Join Operator [MERGEJOIN_175] (rows=36 width=1085)
                                                     Conds:(Left Outer),Output:["_col1","_col2","_col3","_col4","_col5"]
-                                                  <-Reducer 25 [CUSTOM_SIMPLE_EDGE]
+                                                  <-Reducer 27 [CUSTOM_SIMPLE_EDGE]
                                                     PARTITION_ONLY_SHUFFLE [RS_121]
                                                       Group By Operator [GBY_36] (rows=1 width=288)
                                                         Output:["_col0"],aggregations:["avg(VALUE._col0)"]
@@ -261,12 +261,12 @@ Stage-0
                                                               Output:["ss_ext_list_price"]
                                                               Filter Operator [FIL_160] (rows=63999515 width=88)
                                                                 predicate:ss_quantity BETWEEN 21 AND 40
-                                                                 Please refer to the previous TableScan [TS_10]
+                                                                 Please refer to the previous TableScan [TS_73]
                                                   <-Reducer 5 [CUSTOM_SIMPLE_EDGE]
                                                     PARTITION_ONLY_SHUFFLE [RS_120]
                                                       Merge Join Operator [MERGEJOIN_174] (rows=36 width=796)
                                                         Conds:(Left Outer),Output:["_col1","_col2","_col3","_col4"]
-                                                      <-Reducer 19 [CUSTOM_SIMPLE_EDGE]
+                                                      <-Reducer 21 [CUSTOM_SIMPLE_EDGE]
                                                         PARTITION_ONLY_SHUFFLE [RS_118]
                                                           Group By Operator [GBY_29] (rows=1 width=8)
                                                             Output:["_col0"],aggregations:["count(VALUE._col0)"]
@@ -277,7 +277,7 @@ Stage-0
                                                                 Select Operator [SEL_26] (rows=63999515 width=88)
                                                                   Filter Operator [FIL_159] (rows=63999515 width=88)
                                                                     predicate:ss_quantity BETWEEN 21 AND 40
-                                                                     Please refer to the previous TableScan [TS_3]
+                                                                     Please refer to the previous TableScan [TS_66]
                                                       <-Reducer 4 [CUSTOM_SIMPLE_EDGE]
                                                         PARTITION_ONLY_SHUFFLE [RS_117]
                                                           Merge Join Operator [MERGEJOIN_173] (rows=36 width=787)
@@ -297,7 +297,7 @@ Stage-0
                                                                           predicate:(r_reason_sk = 1)
                                                                           TableScan [TS_0] (rows=72 width=200)
                                                                             default@reason,reason,Tbl:COMPLETE,Col:NONE,Output:["r_reason_sk"]
-                                                                  <-Reducer 18 [CUSTOM_SIMPLE_EDGE]
+                                                                  <-Reducer 20 [CUSTOM_SIMPLE_EDGE]
                                                                     PARTITION_ONLY_SHUFFLE [RS_109]
                                                                       Group By Operator [GBY_8] (rows=1 width=8)
                                                                         Output:["_col0"],aggregations:["count(VALUE._col0)"]
@@ -308,8 +308,8 @@ Stage-0
                                                                             Select Operator [SEL_5] (rows=63999515 width=88)
                                                                               Filter Operator [FIL_156] (rows=63999515 width=88)
                                                                                 predicate:ss_quantity BETWEEN 1 AND 20
-                                                                                 Please refer to the previous TableScan [TS_3]
-                                                              <-Reducer 24 [CUSTOM_SIMPLE_EDGE]
+                                                                                 Please refer to the previous TableScan [TS_66]
+                                                              <-Reducer 26 [CUSTOM_SIMPLE_EDGE]
                                                                 PARTITION_ONLY_SHUFFLE [RS_112]
                                                                   Group By Operator [GBY_15] (rows=1 width=288)
                                                                     Output:["_col0"],aggregations:["avg(VALUE._col0)"]
@@ -321,8 +321,8 @@ Stage-0
                                                                           Output:["ss_ext_list_price"]
                                                                           Filter Operator [FIL_157] (rows=63999515 width=88)
                                                                             predicate:ss_quantity BETWEEN 1 AND 20
-                                                                             Please refer to the previous TableScan [TS_10]
-                                                          <-Reducer 30 [CUSTOM_SIMPLE_EDGE]
+                                                                             Please refer to the previous TableScan [TS_73]
+                                                          <-Reducer 32 [CUSTOM_SIMPLE_EDGE]
                                                             PARTITION_ONLY_SHUFFLE [RS_115]
                                                               Group By Operator [GBY_22] (rows=1 width=288)
                                                                 Output:["_col0"],aggregations:["avg(VALUE._col0)"]
@@ -334,8 +334,8 @@ Stage-0
                                                                       Output:["ss_net_paid_inc_tax"]
                                                                       Filter Operator [FIL_158] (rows=63999515 width=88)
                                                                         predicate:ss_quantity BETWEEN 1 AND 20
-                                                                         Please refer to the previous TableScan [TS_17]
-                              <-Reducer 21 [CUSTOM_SIMPLE_EDGE]
+                                                                         Please refer to the previous TableScan [TS_80]
+                              <-Reducer 18 [CUSTOM_SIMPLE_EDGE]
                                 PARTITION_ONLY_SHUFFLE [RS_136]
                                   Group By Operator [GBY_71] (rows=1 width=8)
                                     Output:["_col0"],aggregations:["count(VALUE._col0)"]
@@ -346,8 +346,8 @@ Stage-0
                                         Select Operator [SEL_68] (rows=63999515 width=88)
                                           Filter Operator [FIL_165] (rows=63999515 width=88)
                                             predicate:ss_quantity BETWEEN 61 AND 80
-                                             Please refer to the previous TableScan [TS_3]
-                          <-Reducer 27 [CUSTOM_SIMPLE_EDGE]
+                                             Please refer to the previous TableScan [TS_66]
+                          <-Reducer 24 [CUSTOM_SIMPLE_EDGE]
                             PARTITION_ONLY_SHUFFLE [RS_139]
                               Group By Operator [GBY_78] (rows=1 width=288)
                                 Output:["_col0"],aggregations:["avg(VALUE._col0)"]
@@ -359,8 +359,8 @@ Stage-0
                                       Output:["ss_ext_list_price"]
                                       Filter Operator [FIL_166] (rows=63999515 width=88)
                                         predicate:ss_quantity BETWEEN 61 AND 80
-                                         Please refer to the previous TableScan [TS_10]
-                      <-Reducer 33 [CUSTOM_SIMPLE_EDGE]
+                                         Please refer to the previous TableScan [TS_73]
+                      <-Reducer 30 [CUSTOM_SIMPLE_EDGE]
                         PARTITION_ONLY_SHUFFLE [RS_142]
                           Group By Operator [GBY_85] (rows=1 width=288)
                             Output:["_col0"],aggregations:["avg(VALUE._col0)"]
@@ -372,8 +372,8 @@ Stage-0
                                   Output:["ss_net_paid_inc_tax"]
                                   Filter Operator [FIL_167] (rows=63999515 width=88)
                                     predicate:ss_quantity BETWEEN 61 AND 80
-                                     Please refer to the previous TableScan [TS_17]
-                  <-Reducer 22 [CUSTOM_SIMPLE_EDGE]
+                                     Please refer to the previous TableScan [TS_80]
+                  <-Reducer 19 [CUSTOM_SIMPLE_EDGE]
                     PARTITION_ONLY_SHUFFLE [RS_145]
                       Group By Operator [GBY_92] (rows=1 width=8)
                         Output:["_col0"],aggregations:["count(VALUE._col0)"]
@@ -384,8 +384,8 @@ Stage-0
                             Select Operator [SEL_89] (rows=63999515 width=88)
                               Filter Operator [FIL_168] (rows=63999515 width=88)
                                 predicate:ss_quantity BETWEEN 81 AND 100
-                                 Please refer to the previous TableScan [TS_3]
-              <-Reducer 28 [CUSTOM_SIMPLE_EDGE]
+                                 Please refer to the previous TableScan [TS_66]
+              <-Reducer 25 [CUSTOM_SIMPLE_EDGE]
                 PARTITION_ONLY_SHUFFLE [RS_148]
                   Group By Operator [GBY_99] (rows=1 width=288)
                     Output:["_col0"],aggregations:["avg(VALUE._col0)"]
@@ -397,8 +397,8 @@ Stage-0
                           Output:["ss_ext_list_price"]
                           Filter Operator [FIL_169] (rows=63999515 width=88)
                             predicate:ss_quantity BETWEEN 81 AND 100
-                             Please refer to the previous TableScan [TS_10]
-          <-Reducer 34 [CUSTOM_SIMPLE_EDGE]
+                             Please refer to the previous TableScan [TS_73]
+          <-Reducer 31 [CUSTOM_SIMPLE_EDGE]
             PARTITION_ONLY_SHUFFLE [RS_151]
               Group By Operator [GBY_106] (rows=1 width=288)
                 Output:["_col0"],aggregations:["avg(VALUE._col0)"]
@@ -410,5 +410,5 @@ Stage-0
                       Output:["ss_net_paid_inc_tax"]
                       Filter Operator [FIL_170] (rows=63999515 width=88)
                         predicate:ss_quantity BETWEEN 81 AND 100
-                         Please refer to the previous TableScan [TS_17]
+                         Please refer to the previous TableScan [TS_80]
 
diff --git a/ql/src/test/results/clientpositive/perf/query95.q.out b/ql/src/test/results/clientpositive/perf/query95.q.out
index f036a4761f..8264f09afc 100644
--- a/ql/src/test/results/clientpositive/perf/query95.q.out
+++ b/ql/src/test/results/clientpositive/perf/query95.q.out
@@ -64,14 +64,14 @@ Plan optimized by CBO.
 
 Vertex dependency in root stage
 Reducer 13 <- Map 12 (SIMPLE_EDGE), Map 18 (SIMPLE_EDGE)
-Reducer 14 <- Reducer 13 (SIMPLE_EDGE)
-Reducer 15 <- Map 12 (SIMPLE_EDGE), Map 18 (SIMPLE_EDGE)
-Reducer 16 <- Map 19 (SIMPLE_EDGE), Reducer 15 (SIMPLE_EDGE)
+Reducer 14 <- Map 19 (SIMPLE_EDGE), Reducer 13 (SIMPLE_EDGE)
+Reducer 15 <- Reducer 14 (SIMPLE_EDGE)
+Reducer 16 <- Map 12 (SIMPLE_EDGE), Map 18 (SIMPLE_EDGE)
 Reducer 17 <- Reducer 16 (SIMPLE_EDGE)
 Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 9 (SIMPLE_EDGE)
 Reducer 3 <- Map 10 (SIMPLE_EDGE), Reducer 2 (SIMPLE_EDGE)
 Reducer 4 <- Map 11 (SIMPLE_EDGE), Reducer 3 (SIMPLE_EDGE)
-Reducer 5 <- Reducer 14 (ONE_TO_ONE_EDGE), Reducer 17 (ONE_TO_ONE_EDGE), Reducer 4 (SIMPLE_EDGE)
+Reducer 5 <- Reducer 15 (ONE_TO_ONE_EDGE), Reducer 17 (ONE_TO_ONE_EDGE), Reducer 4 (SIMPLE_EDGE)
 Reducer 6 <- Reducer 5 (SIMPLE_EDGE)
 Reducer 7 <- Reducer 6 (CUSTOM_SIMPLE_EDGE)
 Reducer 8 <- Reducer 7 (SIMPLE_EDGE)
@@ -105,46 +105,12 @@ Stage-0
                             Output:["_col0","_col2","_col3"],aggregations:["sum(_col4)","sum(_col5)"],keys:_col3
                             Merge Join Operator [MERGEJOIN_127] (rows=421668645 width=135)
                               Conds:RS_58._col3=RS_59._col0(Inner),RS_58._col3=RS_60._col0(Inner),Output:["_col3","_col4","_col5"]
-                            <-Reducer 14 [ONE_TO_ONE_EDGE]
-                              FORWARD [RS_59]
-                                PartitionCols:_col0
-                                Group By Operator [GBY_25] (rows=79201469 width=135)
-                                  Output:["_col0"],keys:KEY._col0
-                                <-Reducer 13 [SIMPLE_EDGE]
-                                  SHUFFLE [RS_24]
-                                    PartitionCols:_col0
-                                    Group By Operator [GBY_23] (rows=158402938 width=135)
-                                      Output:["_col0"],keys:_col1
-                                      Select Operator [SEL_22] (rows=158402938 width=135)
-                                        Output:["_col1"]
-                                        Filter Operator [FIL_21] (rows=158402938 width=135)
-                                          predicate:(_col0 <> _col2)
-                                          Merge Join Operator [MERGEJOIN_124] (rows=158402938 width=135)
-                                            Conds:RS_18._col1=RS_19._col1(Inner),Output:["_col0","_col1","_col2"]
-                                          <-Map 12 [SIMPLE_EDGE]
-                                            SHUFFLE [RS_18]
-                                              PartitionCols:_col1
-                                              Select Operator [SEL_14] (rows=144002668 width=135)
-                                                Output:["_col0","_col1"]
-                                                Filter Operator [FIL_110] (rows=144002668 width=135)
-                                                  predicate:ws_order_number is not null
-                                                  TableScan [TS_12] (rows=144002668 width=135)
-                                                    default@web_sales,ws1,Tbl:COMPLETE,Col:NONE,Output:["ws_warehouse_sk","ws_order_number"]
-                                          <-Map 18 [SIMPLE_EDGE]
-                                            SHUFFLE [RS_19]
-                                              PartitionCols:_col1
-                                              Select Operator [SEL_17] (rows=144002668 width=135)
-                                                Output:["_col0","_col1"]
-                                                Filter Operator [FIL_111] (rows=144002668 width=135)
-                                                  predicate:ws_order_number is not null
-                                                  TableScan [TS_15] (rows=144002668 width=135)
-                                                    default@web_sales,ws2,Tbl:COMPLETE,Col:NONE,Output:["ws_warehouse_sk","ws_order_number"]
-                            <-Reducer 17 [ONE_TO_ONE_EDGE]
+                            <-Reducer 15 [ONE_TO_ONE_EDGE]
                               FORWARD [RS_60]
                                 PartitionCols:_col0
                                 Group By Operator [GBY_47] (rows=87121617 width=135)
                                   Output:["_col0"],keys:KEY._col0
-                                <-Reducer 16 [SIMPLE_EDGE]
+                                <-Reducer 14 [SIMPLE_EDGE]
                                   SHUFFLE [RS_46]
                                     PartitionCols:_col0
                                     Group By Operator [GBY_45] (rows=174243235 width=135)
@@ -160,7 +126,7 @@ Stage-0
                                               predicate:wr_order_number is not null
                                               TableScan [TS_38] (rows=14398467 width=92)
                                                 default@web_returns,web_returns,Tbl:COMPLETE,Col:NONE,Output:["wr_order_number"]
-                                      <-Reducer 15 [SIMPLE_EDGE]
+                                      <-Reducer 13 [SIMPLE_EDGE]
                                         SHUFFLE [RS_41]
                                           PartitionCols:_col0
                                           Select Operator [SEL_37] (rows=158402938 width=135)
@@ -172,11 +138,45 @@ Stage-0
                                               <-Map 12 [SIMPLE_EDGE]
                                                 SHUFFLE [RS_33]
                                                   PartitionCols:_col1
-                                                   Please refer to the previous Select Operator [SEL_14]
+                                                  Select Operator [SEL_29] (rows=144002668 width=135)
+                                                    Output:["_col0","_col1"]
+                                                    Filter Operator [FIL_112] (rows=144002668 width=135)
+                                                      predicate:ws_order_number is not null
+                                                      TableScan [TS_27] (rows=144002668 width=135)
+                                                        default@web_sales,ws1,Tbl:COMPLETE,Col:NONE,Output:["ws_warehouse_sk","ws_order_number"]
                                               <-Map 18 [SIMPLE_EDGE]
                                                 SHUFFLE [RS_34]
                                                   PartitionCols:_col1
-                                                   Please refer to the previous Select Operator [SEL_17]
+                                                  Select Operator [SEL_32] (rows=144002668 width=135)
+                                                    Output:["_col0","_col1"]
+                                                    Filter Operator [FIL_113] (rows=144002668 width=135)
+                                                      predicate:ws_order_number is not null
+                                                      TableScan [TS_30] (rows=144002668 width=135)
+                                                        default@web_sales,ws2,Tbl:COMPLETE,Col:NONE,Output:["ws_warehouse_sk","ws_order_number"]
+                            <-Reducer 17 [ONE_TO_ONE_EDGE]
+                              FORWARD [RS_59]
+                                PartitionCols:_col0
+                                Group By Operator [GBY_25] (rows=79201469 width=135)
+                                  Output:["_col0"],keys:KEY._col0
+                                <-Reducer 16 [SIMPLE_EDGE]
+                                  SHUFFLE [RS_24]
+                                    PartitionCols:_col0
+                                    Group By Operator [GBY_23] (rows=158402938 width=135)
+                                      Output:["_col0"],keys:_col1
+                                      Select Operator [SEL_22] (rows=158402938 width=135)
+                                        Output:["_col1"]
+                                        Filter Operator [FIL_21] (rows=158402938 width=135)
+                                          predicate:(_col0 <> _col2)
+                                          Merge Join Operator [MERGEJOIN_124] (rows=158402938 width=135)
+                                            Conds:RS_18._col1=RS_19._col1(Inner),Output:["_col0","_col1","_col2"]
+                                          <-Map 12 [SIMPLE_EDGE]
+                                            SHUFFLE [RS_18]
+                                              PartitionCols:_col1
+                                               Please refer to the previous Select Operator [SEL_29]
+                                          <-Map 18 [SIMPLE_EDGE]
+                                            SHUFFLE [RS_19]
+                                              PartitionCols:_col1
+                                               Please refer to the previous Select Operator [SEL_32]
                             <-Reducer 4 [SIMPLE_EDGE]
                               SHUFFLE [RS_58]
                                 PartitionCols:_col3
