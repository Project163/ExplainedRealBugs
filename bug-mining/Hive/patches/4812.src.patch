diff --git a/ql/src/java/org/apache/hadoop/hive/ql/udf/ptf/WindowingTableFunction.java b/ql/src/java/org/apache/hadoop/hive/ql/udf/ptf/WindowingTableFunction.java
index 3a2bc4fcc3..e9f8ff959e 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/udf/ptf/WindowingTableFunction.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/udf/ptf/WindowingTableFunction.java
@@ -1567,7 +1567,13 @@ public Object next() {
             wFn.getWFnEval().aggregate(aggBuffers[j], args[j]);
             Object out = ((ISupportStreamingModeForWindowing) wFn.getWFnEval())
                 .getNextResult(aggBuffers[j]);
-            out = ObjectInspectorUtils.copyToStandardObject(out, wFn.getOI());
+            if (out != null) {
+              if (out == ISupportStreamingModeForWindowing.NULL_RESULT) {
+                out = null;
+              } else {
+                out = ObjectInspectorUtils.copyToStandardObject(out, wFn.getOI());
+              }
+            }
             output.set(j, out);
           } else {
             Range rng = getRange(wFn, currIdx, iPart);
