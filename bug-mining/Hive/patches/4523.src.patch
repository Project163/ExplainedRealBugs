diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/tez/DynamicPartitionPruner.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/tez/DynamicPartitionPruner.java
index 3f1635938b..9e1bf0b60e 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/tez/DynamicPartitionPruner.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/tez/DynamicPartitionPruner.java
@@ -481,7 +481,9 @@ public void addEvent(InputInitializerEvent event) {
       if (sourcesWaitingForEvents.contains(event.getSourceVertexName())) {
         ++totalEventCount;
         numEventsSeenPerSource.get(event.getSourceVertexName()).increment();
-        queue.offer(event);
+        if(!queue.offer(event)) {
+          throw new IllegalStateException("Queue full");
+        }
         checkForSourceCompletion(event.getSourceVertexName());
       }
     }
@@ -511,7 +513,9 @@ private void checkForSourceCompletion(String name) {
         sourcesWaitingForEvents.remove(name);
         if (sourcesWaitingForEvents.isEmpty()) {
           // we've got what we need; mark the queue
-          queue.offer(endOfEvents);
+          if(!queue.offer(endOfEvents)) {
+            throw new IllegalStateException("Queue full");
+          }
         } else {
           LOG.info("Waiting for " + sourcesWaitingForEvents.size() + " sources.");
         }
