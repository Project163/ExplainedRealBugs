diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/CommonJoinOperator.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/CommonJoinOperator.java
index 43231af4e7..5446c4058c 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/CommonJoinOperator.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/CommonJoinOperator.java
@@ -682,6 +682,12 @@ private void genAllOneUniqueJoinObject()
   }
 
   protected void checkAndGenObject() throws HiveException {
+    if (state == State.CLOSE) {
+      LOG.warn("checkAndGenObject is called after operator " +
+          id + " " + getName() + " closed");
+      return;
+    }
+
     if (condn[0].getType() == JoinDesc.UNIQUE_JOIN) {
 
       // Check if results need to be emitted.
