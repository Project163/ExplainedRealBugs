diff --git a/jdbc/src/test/org/apache/hadoop/hive/jdbc/TestJdbcDriver.java b/jdbc/src/test/org/apache/hadoop/hive/jdbc/TestJdbcDriver.java
index e744d1129e..4972754794 100644
--- a/jdbc/src/test/org/apache/hadoop/hive/jdbc/TestJdbcDriver.java
+++ b/jdbc/src/test/org/apache/hadoop/hive/jdbc/TestJdbcDriver.java
@@ -18,6 +18,8 @@
 
 package org.apache.hadoop.hive.jdbc;
 
+import static org.apache.hadoop.hive.ql.processors.SetProcessor.SET_COLUMN_NAME;
+
 import java.sql.Connection;
 import java.sql.DatabaseMetaData;
 import java.sql.DriverManager;
@@ -1008,4 +1010,28 @@ private static void assertDpi(DriverPropertyInfo dpi, String name,
     assertEquals("Invalid DriverPropertyInfo value", value, dpi.value);
     assertEquals("Invalid DriverPropertyInfo required", false, dpi.required);
   }
+
+
+  /**
+   * validate schema generated by "set" command
+   * @throws SQLException
+   */
+public void testSetCommand() throws SQLException {
+  // execute set command
+  String sql = "set -v";
+  Statement stmt = con.createStatement();
+  ResultSet res = stmt.executeQuery(sql);
+
+  // Validate resultset columns
+  ResultSetMetaData md = res.getMetaData() ;
+  assertEquals(1, md.getColumnCount());
+  assertEquals(SET_COLUMN_NAME, md.getColumnLabel(1));
+
+  //check if there is data in the resultset
+  assertTrue("Nothing returned by set -v", res.next());
+
+  res.close();
+  stmt.close();
+  }
+
 }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/processors/CommandProcessorResponse.java b/ql/src/java/org/apache/hadoop/hive/ql/processors/CommandProcessorResponse.java
index 4f7f472d2e..2eb44383b4 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/processors/CommandProcessorResponse.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/processors/CommandProcessorResponse.java
@@ -18,6 +18,8 @@
 
 package org.apache.hadoop.hive.ql.processors;
 
+import org.apache.hadoop.hive.metastore.api.Schema;
+
 /**
  * Encapsulates the basic response info returned by classes the implement the
  * <code>CommandProcessor</code> interfaace. Typically <code>errorMessage</code>
@@ -28,18 +30,25 @@ public class CommandProcessorResponse {
   private int responseCode;
   private String errorMessage;
   private String SQLState;
+  private Schema resSchema;
 
   public CommandProcessorResponse(int responseCode) {
     this(responseCode, null, null);
   }
 
   public CommandProcessorResponse(int responseCode, String errorMessage, String SQLState) {
+    this(responseCode, errorMessage, SQLState, null);
+  }
+
+  public CommandProcessorResponse(int responseCode, String errorMessage, String SQLState, Schema schema) {
     this.responseCode = responseCode;
     this.errorMessage = errorMessage;
     this.SQLState = SQLState;
+    this.resSchema = schema;
   }
 
   public int getResponseCode() { return responseCode; }
   public String getErrorMessage() { return errorMessage; }
   public String getSQLState() { return SQLState; }
+  public Schema getSchema() { return resSchema; }
 }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/processors/SetProcessor.java b/ql/src/java/org/apache/hadoop/hive/ql/processors/SetProcessor.java
index 9ca5ca4ce6..de3ab8ebb2 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/processors/SetProcessor.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/processors/SetProcessor.java
@@ -18,11 +18,17 @@
 
 package org.apache.hadoop.hive.ql.processors;
 
+import static org.apache.hadoop.hive.serde.Constants.STRING_TYPE_NAME;
+import static org.apache.hadoop.hive.serde.Constants.SERIALIZATION_NULL_FORMAT;
+import static org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe.defaultNullString;
+
 import java.util.Map;
 import java.util.Properties;
 import java.util.SortedMap;
 import java.util.TreeMap;
 
+import org.apache.hadoop.hive.metastore.api.Schema;
+import org.apache.hadoop.hive.metastore.api.FieldSchema;
 import org.apache.hadoop.hive.ql.parse.VariableSubstitution;
 import org.apache.hadoop.hive.ql.session.SessionState;
 
@@ -37,6 +43,7 @@ public class SetProcessor implements CommandProcessor {
   public static final String SYSTEM_PREFIX = "system:";
   public static final String HIVECONF_PREFIX = "hiveconf:";
   public static final String HIVEVAR_PREFIX = "hivevar:";
+  public static final String SET_COLUMN_NAME = "set";
 
   public static boolean getBoolean(String value) {
     if (value.equals("on") || value.equals("true")) {
@@ -183,16 +190,17 @@ private CommandProcessorResponse getVariable(String varname){
 
   public CommandProcessorResponse run(String command) {
     SessionState ss = SessionState.get();
+    Schema sch = getSchema();
 
     String nwcmd = command.trim();
     if (nwcmd.equals("")) {
       dumpOptions(ss.getConf().getChangedProperties());
-      return new CommandProcessorResponse(0);
+      return new CommandProcessorResponse(0, null, null, sch);
     }
 
     if (nwcmd.equals("-v")) {
       dumpOptions(ss.getConf().getAllProperties());
-      return new CommandProcessorResponse(0);
+      return new CommandProcessorResponse(0, null, null, sch);
     }
 
     String[] part = new String[2];
@@ -216,4 +224,19 @@ public CommandProcessorResponse run(String command) {
     }
 
   }
+
+// create a Schema object containing the give column
+  private Schema getSchema() {
+    Schema sch = new Schema();
+    FieldSchema tmpFieldSchema = new FieldSchema();
+
+    tmpFieldSchema.setName(SET_COLUMN_NAME);
+
+    tmpFieldSchema.setType(STRING_TYPE_NAME);
+    sch.putToProperties(SERIALIZATION_NULL_FORMAT, defaultNullString);
+    sch.addToFieldSchemas(tmpFieldSchema);
+
+    return sch;
+  }
+
 }
diff --git a/service/src/java/org/apache/hadoop/hive/service/HiveServer.java b/service/src/java/org/apache/hadoop/hive/service/HiveServer.java
index 95f322ade0..4210f049fa 100644
--- a/service/src/java/org/apache/hadoop/hive/service/HiveServer.java
+++ b/service/src/java/org/apache/hadoop/hive/service/HiveServer.java
@@ -96,6 +96,7 @@ public static class HiveServerHandler extends HiveMetaStore.HMSHandler
      * It is the instance of the last Hive query.
      */
     private Driver driver;
+    private CommandProcessorResponse response;
     /**
      * For processors other than Hive queries (Driver), they output to session.out (a temp file)
      * first and the fetchOne/fetchN/fetchAll functions get the output from pipeIn.
@@ -177,7 +178,6 @@ public void execute(String cmd) throws HiveServerException, TException {
 
       try {
         CommandProcessor proc = CommandProcessorFactory.get(tokens[0]);
-        CommandProcessorResponse response = null;
         if (proc != null) {
           if (proc instanceof Driver) {
             isHiveQuery = true;
@@ -273,8 +273,14 @@ public HiveClusterStatus getClusterStatus() throws HiveServerException,
      */
     public Schema getSchema() throws HiveServerException, TException {
       if (!isHiveQuery) {
-        // Return empty schema if the last command was not a Hive query
-        return new Schema();
+        Schema schema = response.getSchema();
+        if (schema == null) {
+          // Return empty schema if the last command was not a Hive query
+          return new Schema();
+        }
+        else {
+          return schema;
+        }
       }
 
       assert driver != null: "getSchema() is called on a Hive query and driver is NULL.";
