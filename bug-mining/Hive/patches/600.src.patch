diff --git a/ql/src/java/org/apache/hadoop/hive/ql/plan/ConditionalResolverCommonJoin.java b/ql/src/java/org/apache/hadoop/hive/ql/plan/ConditionalResolverCommonJoin.java
index 0590998798..9d131a2f5a 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/plan/ConditionalResolverCommonJoin.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/plan/ConditionalResolverCommonJoin.java
@@ -212,6 +212,7 @@ private String resolveMapJoinTask(
         AliasFileSizePair pair = aliasFileSizeList.get(idx);
         String alias = pair.alias;
         long size = pair.size;
+        idx--;
         if (!bigAliasFound && aliasToTask.get(alias) != null) {
           // got the big table
           bigAliasFound = true;
@@ -219,7 +220,6 @@ private String resolveMapJoinTask(
           continue;
         }
         smallTablesFileSizeSum += size;
-        idx--;
       }
 
       // compare with threshold
