diff --git a/CHANGES.txt b/CHANGES.txt
index 24b99e0adc..2a6762476f 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -229,6 +229,9 @@ Trunk -  Unreleased
     the correct directory
     (Ning Zhang via jvs)
 
+    HIVE-1601. Hadoop 0.17 ant test broken by HIVE-1523
+    (Joydeep Sen Sarma via jvs)
+
 Release 0.6.0 -  Unreleased
 
   INCOMPATIBLE CHANGES
diff --git a/build-common.xml b/build-common.xml
index b236a91f2d..0b766881a1 100644
--- a/build-common.xml
+++ b/build-common.xml
@@ -64,6 +64,12 @@
     <path refid="classpath"/>
   </path>
 
+  <taskdef resource="net/sf/antcontrib/antcontrib.properties">
+    <classpath>
+      <pathelement location="${hive.root}/testlibs/ant-contrib-1.0b3.jar"/>
+    </classpath>
+  </taskdef>
+
   <!-- IVY properties set here -->
   <property name="build.ivy.dir" location="${build.dir.hive}/ivy"/>
   <property name="build.ivy.lib.dir" location="${build.ivy.dir}/lib"/>
diff --git a/ql/build.xml b/ql/build.xml
index 5a48ee16b6..28fc7c39ae 100644
--- a/ql/build.xml
+++ b/ql/build.xml
@@ -49,7 +49,7 @@
     <pathelement location="${common.jar}"/>
     <fileset dir="${hive.root}" includes="testlibs/*.jar"/>
     <fileset dir="${hadoop.root}/lib" includes="*.jar"/>
-    <fileset dir="${hadoop.root}/lib/jsp-2.1" includes="*.jar"/>
+    <fileset dir="${hadoop.root}/lib" includes="jsp-2.1/*.jar"/>
     <path refid="classpath"/>
   </path>
 
@@ -97,17 +97,24 @@
               hadoopVersion="${hadoopVersion}"
     />
 
-    <qtestgen outputDirectory="${test.build.src}/org/apache/hadoop/hive/cli" 
-              templatePath="${ql.test.template.dir}" template="TestCliDriver.vm" 
-              queryDirectory="${ql.test.query.clientpositive.dir}" 
-              queryFile="${minimr.query.files}"
-              queryFileRegex="${qfile_regex}"
-              clusterMode="miniMR"
-              resultsDirectory="${ql.test.results.clientpositive.dir}" className="TestMinimrCliDriver"
-              logFile="${test.log.dir}/testminimrclidrivergen.log"
-              logDirectory="${test.log.dir}/clientpositive"
-              hadoopVersion="${hadoopVersion}"
-    />
+    <if>
+      <not>
+        <matches string="${hadoop.version.ant-internal}" pattern="^0\.17\..*" />
+      </not>
+      <then>
+        <qtestgen outputDirectory="${test.build.src}/org/apache/hadoop/hive/cli" 
+                  templatePath="${ql.test.template.dir}" template="TestCliDriver.vm" 
+                  queryDirectory="${ql.test.query.clientpositive.dir}" 
+                  queryFile="${minimr.query.files}"
+                  queryFileRegex="${qfile_regex}"
+                  clusterMode="miniMR"
+                  resultsDirectory="${ql.test.results.clientpositive.dir}" className="TestMinimrCliDriver"
+                  logFile="${test.log.dir}/testminimrclidrivergen.log"
+                  logDirectory="${test.log.dir}/clientpositive"
+                  hadoopVersion="${hadoopVersion}"
+                  />
+      </then>
+    </if>
 
     <qtestgen outputDirectory="${test.build.src}/org/apache/hadoop/hive/cli" 
               templatePath="${ql.test.template.dir}" template="TestNegativeCliDriver.vm" 
diff --git a/testlibs/ant-contrib-1.0b3.jar b/testlibs/ant-contrib-1.0b3.jar
new file mode 100644
index 0000000000..062537661a
Binary files /dev/null and b/testlibs/ant-contrib-1.0b3.jar differ
diff --git a/testlibs/ant-contrib.LICENSE.txt b/testlibs/ant-contrib.LICENSE.txt
new file mode 100644
index 0000000000..4d8c2fb7a1
--- /dev/null
+++ b/testlibs/ant-contrib.LICENSE.txt
@@ -0,0 +1,47 @@
+/*
+ * The Apache Software License, Version 1.1
+ *
+ * Copyright (c) 2001-2003 Ant-Contrib project.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ *
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer. 
+ *
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in
+ *    the documentation and/or other materials provided with the
+ *    distribution.
+ *
+ * 3. The end-user documentation included with the redistribution, if
+ *    any, must include the following acknowlegement:  
+ *       "This product includes software developed by the 
+ *        Ant-Contrib project (http://sourceforge.net/projects/ant-contrib)."
+ *    Alternately, this acknowlegement may appear in the software itself,
+ *    if and wherever such third-party acknowlegements normally appear.
+ *
+ * 4. The name Ant-Contrib must not be used to endorse or promote products 
+ *    derived from this software without prior written permission. For
+ *    written permission, please contact
+ *    ant-contrib-developers@lists.sourceforge.net.
+ *
+ * 5. Products derived from this software may not be called "Ant-Contrib"
+ *    nor may "Ant-Contrib" appear in their names without prior written
+ *    permission of the Ant-Contrib project.
+ *
+ * THIS SOFTWARE IS PROVIDED ``AS IS'' AND ANY EXPRESSED OR IMPLIED
+ * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
+ * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
+ * DISCLAIMED.  IN NO EVENT SHALL THE ANT-CONTRIB PROJECT OR ITS
+ * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
+ * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
+ * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF
+ * USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
+ * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
+ * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT
+ * OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ * ====================================================================
+ */
