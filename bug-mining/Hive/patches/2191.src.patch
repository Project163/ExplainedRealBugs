diff --git a/ql/src/java/org/apache/hadoop/hive/ql/index/AggregateIndexHandler.java b/ql/src/java/org/apache/hadoop/hive/ql/index/AggregateIndexHandler.java
index c39e82300d..6894c811ff 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/index/AggregateIndexHandler.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/index/AggregateIndexHandler.java
@@ -23,6 +23,7 @@
 import java.util.Map;
 import java.util.Set;
 
+import org.apache.hadoop.hive.common.StatsSetupConst;
 import org.apache.hadoop.hive.conf.HiveConf;
 import org.apache.hadoop.hive.metastore.api.FieldSchema;
 import org.apache.hadoop.hive.metastore.api.Index;
@@ -155,7 +156,7 @@ protected Task<?> getIndexBuilderMapRedTask(Set<ReadEntity> inputs,
       builderConf.setBoolVar(HiveConf.ConfVars.HIVEMERGETEZFILES, false);
       Task<?> rootTask = IndexUtils.createRootTask(builderConf, inputs, outputs,
           command, (LinkedHashMap<String, String>) partSpec, indexTableName, dbName);
-
+      super.setStatsDir(builderConf);
       return rootTask;
     }
   }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/index/TableBasedIndexHandler.java b/ql/src/java/org/apache/hadoop/hive/ql/index/TableBasedIndexHandler.java
index 4a77645557..3c1362eee5 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/index/TableBasedIndexHandler.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/index/TableBasedIndexHandler.java
@@ -26,6 +26,8 @@
 import java.util.Map.Entry;
 
 import org.apache.hadoop.conf.Configuration;
+import org.apache.hadoop.hive.common.StatsSetupConst;
+import org.apache.hadoop.hive.conf.HiveConf;
 import org.apache.hadoop.hive.metastore.api.FieldSchema;
 import org.apache.hadoop.hive.ql.exec.Task;
 import org.apache.hadoop.hive.ql.exec.Utilities;
@@ -103,6 +105,13 @@ abstract protected Task<?> getIndexBuilderMapRedTask(Set<ReadEntity> inputs, Set
       PartitionDesc indexTblPartDesc, String indexTableName,
       PartitionDesc baseTablePartDesc, String baseTableName, String dbName) throws HiveException;
 
+  protected void setStatsDir(HiveConf builderConf) {
+    String statsDir;
+    if ((statsDir = builderConf.get(StatsSetupConst.STATS_TMP_LOC)) != null) {
+      getConf().set(StatsSetupConst.STATS_TMP_LOC, statsDir);
+    }
+   }
+
   protected List<String> getPartKVPairStringArray(
       LinkedHashMap<String, String> partSpec) {
     List<String> ret = new ArrayList<String>(partSpec.size());
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapIndexHandler.java b/ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapIndexHandler.java
index 0af8d7d6b9..27e251c32c 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapIndexHandler.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/index/bitmap/BitmapIndexHandler.java
@@ -28,6 +28,7 @@
 import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
 import org.apache.hadoop.conf.Configuration;
+import org.apache.hadoop.hive.common.StatsSetupConst;
 import org.apache.hadoop.hive.conf.HiveConf;
 import org.apache.hadoop.hive.metastore.api.FieldSchema;
 import org.apache.hadoop.hive.metastore.api.Index;
@@ -285,8 +286,8 @@ protected Task<?> getIndexBuilderMapRedTask(Set<ReadEntity> inputs, Set<WriteEnt
     }
 
     Task<?> rootTask = IndexUtils.createRootTask(builderConf, inputs, outputs,
-        command, (LinkedHashMap<String, String>) partSpec, indexTableName, dbName);
-
+        command, partSpec, indexTableName, dbName);
+    super.setStatsDir(builderConf);
     return rootTask;
   }
 
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/index/compact/CompactIndexHandler.java b/ql/src/java/org/apache/hadoop/hive/ql/index/compact/CompactIndexHandler.java
index 0135a71fa1..e7434a376c 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/index/compact/CompactIndexHandler.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/index/compact/CompactIndexHandler.java
@@ -28,6 +28,7 @@
 import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
 import org.apache.hadoop.conf.Configuration;
+import org.apache.hadoop.hive.common.StatsSetupConst;
 import org.apache.hadoop.hive.conf.HiveConf;
 import org.apache.hadoop.hive.conf.HiveConf.ConfVars;
 import org.apache.hadoop.hive.metastore.api.FieldSchema;
@@ -147,6 +148,7 @@ protected Task<?> getIndexBuilderMapRedTask(Set<ReadEntity> inputs, Set<WriteEnt
     builderConf.setBoolVar(HiveConf.ConfVars.HIVEMERGETEZFILES, false);
     Task<?> rootTask = IndexUtils.createRootTask(builderConf, inputs, outputs,
         command, partSpec, indexTableName, dbName);
+    super.setStatsDir(builderConf);
     return rootTask;
   }
 
diff --git a/ql/src/test/queries/clientnegative/index_compact_entry_limit.q b/ql/src/test/queries/clientnegative/index_compact_entry_limit.q
index 7d003e3e4b..5bb889c027 100644
--- a/ql/src/test/queries/clientnegative/index_compact_entry_limit.q
+++ b/ql/src/test/queries/clientnegative/index_compact_entry_limit.q
@@ -1,3 +1,4 @@
+set hive.stats.dbclass=fs;
 drop index src_index on src;
 
 CREATE INDEX src_index ON TABLE src(key) as 'COMPACT' WITH DEFERRED REBUILD;
diff --git a/ql/src/test/queries/clientnegative/index_compact_size_limit.q b/ql/src/test/queries/clientnegative/index_compact_size_limit.q
index d79674539a..c6600e69b6 100644
--- a/ql/src/test/queries/clientnegative/index_compact_size_limit.q
+++ b/ql/src/test/queries/clientnegative/index_compact_size_limit.q
@@ -1,3 +1,4 @@
+set hive.stats.dbclass=fs;
 drop index src_index on src;
 
 CREATE INDEX src_index ON TABLE src(key) as 'COMPACT' WITH DEFERRED REBUILD;
diff --git a/ql/src/test/queries/clientpositive/authorization_index.q b/ql/src/test/queries/clientpositive/authorization_index.q
index b3a8e84122..1f177ffd1f 100644
--- a/ql/src/test/queries/clientpositive/authorization_index.q
+++ b/ql/src/test/queries/clientpositive/authorization_index.q
@@ -1,6 +1,6 @@
 set hive.security.authorization.manager=org.apache.hadoop.hive.ql.security.authorization.plugin.sqlstd.SQLStdHiveAuthorizerFactoryForTest;
 set hive.security.authenticator.manager=org.apache.hadoop.hive.ql.security.SessionStateConfigUserAuthenticator;
-
+set hive.stats.dbclass=fs;
 set hive.security.authorization.enabled=true;
 create table t1 (a int);
 create index t1_index on table t1(a) as 'COMPACT' WITH DEFERRED REBUILD;
diff --git a/ql/src/test/queries/clientpositive/database_drop.q b/ql/src/test/queries/clientpositive/database_drop.q
index 0e5fe6fec0..1371273245 100644
--- a/ql/src/test/queries/clientpositive/database_drop.q
+++ b/ql/src/test/queries/clientpositive/database_drop.q
@@ -8,6 +8,7 @@ CREATE DATABASE db5;
 SHOW DATABASES;
 USE db5;
 
+set hive.stats.dbclass=fs;
 dfs ${system:test.dfs.mkdir} ${system:test.tmp.dir}/dbcascade/temp;
 dfs -rmr ${system:test.tmp.dir}/dbcascade;
 dfs ${system:test.dfs.mkdir} ${system:test.tmp.dir}/dbcascade;
diff --git a/ql/src/test/queries/clientpositive/index_auth.q b/ql/src/test/queries/clientpositive/index_auth.q
index 413b37e580..03d77f1f19 100644
--- a/ql/src/test/queries/clientpositive/index_auth.q
+++ b/ql/src/test/queries/clientpositive/index_auth.q
@@ -1,3 +1,4 @@
+set hive.stats.dbclass=fs;
 SET hive.input.format=org.apache.hadoop.hive.ql.io.HiveInputFormat;
 create table foobar(key int, value string) PARTITIONED BY (ds string, hr string);
 alter table foobar add partition (ds='2008-04-08',hr='12');
diff --git a/ql/src/test/queries/clientpositive/index_auto.q b/ql/src/test/queries/clientpositive/index_auto.q
index cb8a1d6293..77733aac02 100644
--- a/ql/src/test/queries/clientpositive/index_auto.q
+++ b/ql/src/test/queries/clientpositive/index_auto.q
@@ -3,6 +3,7 @@
 -- without indexing
 SELECT key, value FROM src WHERE key > 80 AND key < 100 ORDER BY key;
 
+set hive.stats.dbclass=fs;
 CREATE INDEX src_index ON TABLE src(key) as 'COMPACT' WITH DEFERRED REBUILD;
 ALTER INDEX src_index ON src REBUILD;
 
@@ -25,4 +26,4 @@ SET hive.optimize.index.filter.compact.minsize=0;
 EXPLAIN SELECT key, value FROM src WHERE key > 80 AND key < 100 ORDER BY key;
 SELECT key, value FROM src WHERE key > 80 AND key < 100 ORDER BY key;
 
-DROP INDEX src_index on src;
\ No newline at end of file
+DROP INDEX src_index on src;
diff --git a/ql/src/test/queries/clientpositive/index_auto_empty.q b/ql/src/test/queries/clientpositive/index_auto_empty.q
index cb32162d40..41f4a40823 100644
--- a/ql/src/test/queries/clientpositive/index_auto_empty.q
+++ b/ql/src/test/queries/clientpositive/index_auto_empty.q
@@ -3,6 +3,7 @@
 -- Create temp, and populate it with some values in src.
 CREATE TABLE temp(key STRING, val STRING) STORED AS TEXTFILE;
 
+set hive.stats.dbclass=fs;
 -- Build an index on temp.
 CREATE INDEX temp_index ON TABLE temp(key) as 'COMPACT' WITH DEFERRED REBUILD;
 ALTER INDEX temp_index ON temp REBUILD;
diff --git a/ql/src/test/queries/clientpositive/index_auto_file_format.q b/ql/src/test/queries/clientpositive/index_auto_file_format.q
index 790e6c223f..2967bd60d8 100644
--- a/ql/src/test/queries/clientpositive/index_auto_file_format.q
+++ b/ql/src/test/queries/clientpositive/index_auto_file_format.q
@@ -1,3 +1,4 @@
+set hive.stats.dbclass=fs;
 -- test automatic use of index on different file formats
 CREATE INDEX src_index ON TABLE src(key) as 'COMPACT' WITH DEFERRED REBUILD;
 ALTER INDEX src_index ON src REBUILD;
@@ -16,4 +17,4 @@ SET hive.optimize.index.filter.compact.minsize=0;
 EXPLAIN SELECT key, value FROM src WHERE key=86 ORDER BY key;
 SELECT key, value FROM src WHERE key=86 ORDER BY key;
 
-DROP INDEX src_index on src;
\ No newline at end of file
+DROP INDEX src_index on src;
diff --git a/ql/src/test/queries/clientpositive/index_auto_mult_tables.q b/ql/src/test/queries/clientpositive/index_auto_mult_tables.q
index 2bf8481f1d..a672e06e79 100644
--- a/ql/src/test/queries/clientpositive/index_auto_mult_tables.q
+++ b/ql/src/test/queries/clientpositive/index_auto_mult_tables.q
@@ -4,6 +4,7 @@
 EXPLAIN SELECT a.key, a.value FROM src a JOIN srcpart b ON (a.key = b.key) WHERE a.key > 80 AND a.key < 100 AND b.key > 70 AND b.key < 90 ORDER BY a.key;
 SELECT a.key, a.value FROM src a JOIN srcpart b ON (a.key = b.key) WHERE a.key > 80 AND a.key < 100 AND b.key > 70 AND b.key < 90 ORDER BY a.key;
 
+set hive.stats.dbclass=fs;
 
 CREATE INDEX src_index ON TABLE src(key) as 'BITMAP' WITH DEFERRED REBUILD;
 ALTER INDEX src_index ON src REBUILD;
diff --git a/ql/src/test/queries/clientpositive/index_auto_mult_tables_compact.q b/ql/src/test/queries/clientpositive/index_auto_mult_tables_compact.q
index 808a04cc36..d78e0fd58a 100644
--- a/ql/src/test/queries/clientpositive/index_auto_mult_tables_compact.q
+++ b/ql/src/test/queries/clientpositive/index_auto_mult_tables_compact.q
@@ -4,6 +4,7 @@
 EXPLAIN SELECT a.key, a.value FROM src a JOIN srcpart b ON (a.key = b.key) WHERE a.key > 80 AND a.key < 100 AND b.key > 70 AND b.key < 90 ORDER BY a.key;
 SELECT a.key, a.value FROM src a JOIN srcpart b ON (a.key = b.key) WHERE a.key > 80 AND a.key < 100 AND b.key > 70 AND b.key < 90 ORDER BY a.key;
 
+set hive.stats.dbclass=fs;
 
 CREATE INDEX src_index ON TABLE src(key) as 'COMPACT' WITH DEFERRED REBUILD;
 ALTER INDEX src_index ON src REBUILD;
diff --git a/ql/src/test/queries/clientpositive/index_auto_multiple.q b/ql/src/test/queries/clientpositive/index_auto_multiple.q
index 06e97fa76b..f0a91b4b8a 100644
--- a/ql/src/test/queries/clientpositive/index_auto_multiple.q
+++ b/ql/src/test/queries/clientpositive/index_auto_multiple.q
@@ -1,3 +1,4 @@
+set hive.stats.dbclass=fs;
 -- With multiple indexes, make sure we choose which to use in a consistent order
 
 CREATE INDEX src_key_index ON TABLE src(key) as 'COMPACT' WITH DEFERRED REBUILD;
@@ -13,4 +14,4 @@ EXPLAIN SELECT key, value FROM src WHERE key=86 ORDER BY key;
 SELECT key, value FROM src WHERE key=86 ORDER BY key;
 
 DROP INDEX src_key_index ON src;
-DROP INDEX src_val_index ON src;
\ No newline at end of file
+DROP INDEX src_val_index ON src;
diff --git a/ql/src/test/queries/clientpositive/index_auto_partitioned.q b/ql/src/test/queries/clientpositive/index_auto_partitioned.q
index 5013d29e73..70166b36c5 100644
--- a/ql/src/test/queries/clientpositive/index_auto_partitioned.q
+++ b/ql/src/test/queries/clientpositive/index_auto_partitioned.q
@@ -1,3 +1,4 @@
+set hive.stats.dbclass=fs;
 -- test automatic use of index on table with partitions
 CREATE INDEX src_part_index ON TABLE srcpart(key) as 'COMPACT' WITH DEFERRED REBUILD;
 ALTER INDEX src_part_index ON srcpart REBUILD;
diff --git a/ql/src/test/queries/clientpositive/index_auto_self_join.q b/ql/src/test/queries/clientpositive/index_auto_self_join.q
index 0984a4a21b..1d9efbbc6d 100644
--- a/ql/src/test/queries/clientpositive/index_auto_self_join.q
+++ b/ql/src/test/queries/clientpositive/index_auto_self_join.q
@@ -3,6 +3,7 @@
 EXPLAIN SELECT a.key, b.key FROM src a JOIN src b ON (a.value = b.value) WHERE a.key > 80 AND a.key < 100 AND b.key > 70 AND b.key < 90 ORDER BY a.key;
 SELECT a.key, b.key FROM src a JOIN src b ON (a.value = b.value) WHERE a.key > 80 AND a.key < 100 AND b.key > 70 AND b.key < 90 ORDER BY a.key;
 
+set hive.stats.dbclass=fs;
 CREATE INDEX src_index ON TABLE src(key) as 'BITMAP' WITH DEFERRED REBUILD;
 ALTER INDEX src_index ON src REBUILD;
 
diff --git a/ql/src/test/queries/clientpositive/index_auto_unused.q b/ql/src/test/queries/clientpositive/index_auto_unused.q
index d8f3eda181..acd4194b0e 100644
--- a/ql/src/test/queries/clientpositive/index_auto_unused.q
+++ b/ql/src/test/queries/clientpositive/index_auto_unused.q
@@ -1,3 +1,4 @@
+set hive.stats.dbclass=fs;
 -- test cases where the index should not be used automatically
 
 CREATE INDEX src_index ON TABLE src(key) as 'COMPACT' WITH DEFERRED REBUILD;
diff --git a/ql/src/test/queries/clientpositive/index_bitmap.q b/ql/src/test/queries/clientpositive/index_bitmap.q
index f9deb28839..673c835fb9 100644
--- a/ql/src/test/queries/clientpositive/index_bitmap.q
+++ b/ql/src/test/queries/clientpositive/index_bitmap.q
@@ -1,3 +1,4 @@
+set hive.stats.dbclass=fs;
 DROP INDEX srcpart_index_proj on srcpart;
 
 EXPLAIN
diff --git a/ql/src/test/queries/clientpositive/index_bitmap1.q b/ql/src/test/queries/clientpositive/index_bitmap1.q
index 55633d9225..adec8f1b3b 100644
--- a/ql/src/test/queries/clientpositive/index_bitmap1.q
+++ b/ql/src/test/queries/clientpositive/index_bitmap1.q
@@ -1,3 +1,4 @@
+set hive.stats.dbclass=fs;
 EXPLAIN
 CREATE INDEX src_index ON TABLE src(key) as 'BITMAP' WITH DEFERRED REBUILD;
 CREATE INDEX src_index ON TABLE src(key) as 'BITMAP' WITH DEFERRED REBUILD;
diff --git a/ql/src/test/queries/clientpositive/index_bitmap2.q b/ql/src/test/queries/clientpositive/index_bitmap2.q
index bd15a21fa4..1ffa6eeebb 100644
--- a/ql/src/test/queries/clientpositive/index_bitmap2.q
+++ b/ql/src/test/queries/clientpositive/index_bitmap2.q
@@ -1,3 +1,4 @@
+set hive.stats.dbclass=fs;
 EXPLAIN
 CREATE INDEX src1_index ON TABLE src(key) as 'BITMAP' WITH DEFERRED REBUILD;
 EXPLAIN
diff --git a/ql/src/test/queries/clientpositive/index_bitmap_auto_partitioned.q b/ql/src/test/queries/clientpositive/index_bitmap_auto_partitioned.q
index 90d7987594..3b310cee4c 100644
--- a/ql/src/test/queries/clientpositive/index_bitmap_auto_partitioned.q
+++ b/ql/src/test/queries/clientpositive/index_bitmap_auto_partitioned.q
@@ -1,3 +1,4 @@
+set hive.stats.dbclass=fs;
 -- test automatic use of index on table with partitions
 CREATE INDEX src_part_index ON TABLE srcpart(key) as 'BITMAP' WITH DEFERRED REBUILD;
 ALTER INDEX src_part_index ON srcpart REBUILD;
diff --git a/ql/src/test/queries/clientpositive/index_bitmap_compression.q b/ql/src/test/queries/clientpositive/index_bitmap_compression.q
index 2f5e5d4fb2..32ecfb9db8 100644
--- a/ql/src/test/queries/clientpositive/index_bitmap_compression.q
+++ b/ql/src/test/queries/clientpositive/index_bitmap_compression.q
@@ -1,3 +1,4 @@
+set hive.stats.dbclass=fs;
 SET hive.exec.compress.result=true;
 CREATE INDEX src_index ON TABLE src(key) as 'BITMAP' WITH DEFERRED REBUILD;
 ALTER INDEX src_index ON src REBUILD;
diff --git a/ql/src/test/queries/clientpositive/index_bitmap_rc.q b/ql/src/test/queries/clientpositive/index_bitmap_rc.q
index 054df51c32..26a351ea31 100644
--- a/ql/src/test/queries/clientpositive/index_bitmap_rc.q
+++ b/ql/src/test/queries/clientpositive/index_bitmap_rc.q
@@ -1,3 +1,4 @@
+set hive.stats.dbclass=fs;
 CREATE TABLE srcpart_rc (key int, value string) PARTITIONED BY (ds string, hr int) STORED AS RCFILE;
 
 INSERT OVERWRITE TABLE srcpart_rc PARTITION (ds='2008-04-08', hr=11) SELECT key, value FROM srcpart WHERE ds = '2008-04-08' AND hr = 11;
diff --git a/ql/src/test/queries/clientpositive/index_compact.q b/ql/src/test/queries/clientpositive/index_compact.q
index a936f1127f..98cbec147d 100644
--- a/ql/src/test/queries/clientpositive/index_compact.q
+++ b/ql/src/test/queries/clientpositive/index_compact.q
@@ -1,3 +1,4 @@
+set hive.stats.dbclass=fs;
 DROP INDEX srcpart_index_proj on srcpart;
 
 EXPLAIN
diff --git a/ql/src/test/queries/clientpositive/index_compact_1.q b/ql/src/test/queries/clientpositive/index_compact_1.q
index 837033be40..97276f488e 100644
--- a/ql/src/test/queries/clientpositive/index_compact_1.q
+++ b/ql/src/test/queries/clientpositive/index_compact_1.q
@@ -1,3 +1,4 @@
+set hive.stats.dbclass=fs;
 EXPLAIN
 CREATE INDEX src_index ON TABLE src(key) as 'COMPACT' WITH DEFERRED REBUILD;
 CREATE INDEX src_index ON TABLE src(key) as 'COMPACT' WITH DEFERRED REBUILD;
diff --git a/ql/src/test/queries/clientpositive/index_compact_2.q b/ql/src/test/queries/clientpositive/index_compact_2.q
index 56119ac11f..1eb3f5c3db 100644
--- a/ql/src/test/queries/clientpositive/index_compact_2.q
+++ b/ql/src/test/queries/clientpositive/index_compact_2.q
@@ -1,3 +1,4 @@
+set hive.stats.dbclass=fs;
 CREATE TABLE srcpart_rc (key int, value string) PARTITIONED BY (ds string, hr int) STORED AS RCFILE;
 
 INSERT OVERWRITE TABLE srcpart_rc PARTITION (ds='2008-04-08', hr=11) SELECT key, value FROM srcpart WHERE ds = '2008-04-08' AND hr = 11;
@@ -42,4 +43,4 @@ SET hive.input.format=org.apache.hadoop.hive.ql.io.HiveInputFormat;
 SELECT key, value FROM srcpart_rc WHERE key=100 ORDER BY key;
 
 DROP INDEX srcpart_rc_index on srcpart_rc;
-DROP TABLE srcpart_rc;
\ No newline at end of file
+DROP TABLE srcpart_rc;
diff --git a/ql/src/test/queries/clientpositive/index_compact_3.q b/ql/src/test/queries/clientpositive/index_compact_3.q
index f3fcb4af3d..599b4ac114 100644
--- a/ql/src/test/queries/clientpositive/index_compact_3.q
+++ b/ql/src/test/queries/clientpositive/index_compact_3.q
@@ -1,3 +1,4 @@
+set hive.stats.dbclass=fs;
 CREATE TABLE src_index_test_rc (key int, value string) STORED AS RCFILE;
 
 INSERT OVERWRITE TABLE src_index_test_rc SELECT * FROM src;
@@ -16,4 +17,4 @@ SET hive.input.format=org.apache.hadoop.hive.ql.io.HiveInputFormat;
 SELECT key, value FROM src_index_test_rc WHERE key=100 ORDER BY key;
 
 DROP INDEX src_index on src_index_test_rc;
-DROP TABLE src_index_test_rc;
\ No newline at end of file
+DROP TABLE src_index_test_rc;
diff --git a/ql/src/test/queries/clientpositive/index_compact_binary_search.q b/ql/src/test/queries/clientpositive/index_compact_binary_search.q
index d0d9a32adc..e72b27c781 100644
--- a/ql/src/test/queries/clientpositive/index_compact_binary_search.q
+++ b/ql/src/test/queries/clientpositive/index_compact_binary_search.q
@@ -1,6 +1,6 @@
 SET hive.input.format=org.apache.hadoop.hive.ql.io.HiveInputFormat;
 SET hive.default.fileformat=TextFile;
-
+set hive.stats.dbclass=fs;
 CREATE INDEX src_index ON TABLE src(key) as 'COMPACT' WITH DEFERRED REBUILD;
 ALTER INDEX src_index ON src REBUILD;
 
@@ -129,4 +129,4 @@ SELECT * FROM src WHERE key >= '9';
 
 SET hive.exec.post.hooks=;
 
-DROP INDEX src_index ON src;
\ No newline at end of file
+DROP INDEX src_index ON src;
diff --git a/ql/src/test/queries/clientpositive/index_compression.q b/ql/src/test/queries/clientpositive/index_compression.q
index 84ed3cc932..963b8f74e5 100644
--- a/ql/src/test/queries/clientpositive/index_compression.q
+++ b/ql/src/test/queries/clientpositive/index_compression.q
@@ -1,4 +1,5 @@
 SET hive.exec.compress.result=true;
+set hive.stats.dbclass=fs;
 CREATE INDEX src_index ON TABLE src(key) as 'COMPACT' WITH DEFERRED REBUILD;
 ALTER INDEX src_index ON src REBUILD;
 
diff --git a/ql/src/test/queries/clientpositive/index_creation.q b/ql/src/test/queries/clientpositive/index_creation.q
index 062821e870..ef020b63d5 100644
--- a/ql/src/test/queries/clientpositive/index_creation.q
+++ b/ql/src/test/queries/clientpositive/index_creation.q
@@ -1,3 +1,4 @@
+set hive.stats.dbclass=fs;
 drop index src_index_2 on src;
 drop index src_index_3 on src;
 drop index src_index_4 on src;
diff --git a/ql/src/test/queries/clientpositive/index_serde.q b/ql/src/test/queries/clientpositive/index_serde.q
index d160a6fb44..20186a7400 100644
--- a/ql/src/test/queries/clientpositive/index_serde.q
+++ b/ql/src/test/queries/clientpositive/index_serde.q
@@ -1,3 +1,4 @@
+set hive.stats.dbclass=fs;
 -- Want to ensure we can build and use indices on tables stored with SerDes
 -- Build the (Avro backed) table
 CREATE TABLE doctors 
diff --git a/ql/src/test/queries/clientpositive/index_stale.q b/ql/src/test/queries/clientpositive/index_stale.q
index 82e15b97b6..ecab2b7f6b 100644
--- a/ql/src/test/queries/clientpositive/index_stale.q
+++ b/ql/src/test/queries/clientpositive/index_stale.q
@@ -1,3 +1,4 @@
+set hive.stats.dbclass=fs;
 -- test that stale indexes are not used
 
 CREATE TABLE temp(key STRING, val STRING) STORED AS TEXTFILE;
diff --git a/ql/src/test/queries/clientpositive/index_stale_partitioned.q b/ql/src/test/queries/clientpositive/index_stale_partitioned.q
index e7cfeff31f..a93ccf7f95 100644
--- a/ql/src/test/queries/clientpositive/index_stale_partitioned.q
+++ b/ql/src/test/queries/clientpositive/index_stale_partitioned.q
@@ -1,3 +1,4 @@
+set hive.stats.dbclass=fs;
 -- Test if index is actually being used.
 
 -- Create temp, and populate it with some values in src.
diff --git a/ql/src/test/queries/clientpositive/show_indexes_edge_cases.q b/ql/src/test/queries/clientpositive/show_indexes_edge_cases.q
index 5fcdf97e2d..9758c16caa 100644
--- a/ql/src/test/queries/clientpositive/show_indexes_edge_cases.q
+++ b/ql/src/test/queries/clientpositive/show_indexes_edge_cases.q
@@ -1,3 +1,4 @@
+set hive.stats.dbclass=fs;
 DROP TABLE show_idx_empty;
 DROP TABLE show_idx_full;
 
@@ -24,4 +25,4 @@ SHOW INDEXES ON show_idx_empty;
 DROP INDEX idx_1 on show_idx_full;
 DROP INDEX idx_2 on show_idx_full;
 DROP TABLE show_idx_empty;
-DROP TABLE show_idx_full;
\ No newline at end of file
+DROP TABLE show_idx_full;
diff --git a/ql/src/test/queries/clientpositive/show_indexes_syntax.q b/ql/src/test/queries/clientpositive/show_indexes_syntax.q
index ab588937e1..bb43c5e138 100644
--- a/ql/src/test/queries/clientpositive/show_indexes_syntax.q
+++ b/ql/src/test/queries/clientpositive/show_indexes_syntax.q
@@ -1,3 +1,4 @@
+set hive.stats.dbclass=fs;
 DROP TABLE show_idx_t1;
 
 CREATE TABLE show_idx_t1(KEY STRING, VALUE STRING);
diff --git a/ql/src/test/queries/clientpositive/union_view.q b/ql/src/test/queries/clientpositive/union_view.q
index 4f8bafe37a..b727199cf4 100644
--- a/ql/src/test/queries/clientpositive/union_view.q
+++ b/ql/src/test/queries/clientpositive/union_view.q
@@ -1,3 +1,4 @@
+set hive.stats.dbclass=fs;
 CREATE TABLE src_union_1 (key int, value string) PARTITIONED BY (ds string);
 CREATE INDEX src_union_1_key_idx ON TABLE src_union_1(key) AS 'COMPACT' WITH DEFERRED REBUILD;
 
