diff --git a/druid-handler/src/java/org/apache/hadoop/hive/druid/security/KerberosHttpClient.java b/druid-handler/src/java/org/apache/hadoop/hive/druid/security/KerberosHttpClient.java
index 71bb8a2aa0..e7b3d99a3e 100644
--- a/druid-handler/src/java/org/apache/hadoop/hive/druid/security/KerberosHttpClient.java
+++ b/druid-handler/src/java/org/apache/hadoop/hive/druid/security/KerberosHttpClient.java
@@ -100,6 +100,7 @@ private <Intermediate, Final> void inner_go(
         );
         // Assuming that a valid UGI with kerberos cred is created by HS2 or LLAP
         UserGroupInformation currentUser = UserGroupInformation.getCurrentUser();
+        currentUser.checkTGTAndReloginFromKeytab();
         log.debug("The user credential is {}", currentUser);
         String challenge = currentUser.doAs(new PrivilegedExceptionAction<String>()
         {
diff --git a/druid-handler/src/java/org/apache/hadoop/hive/druid/security/ResponseCookieHandler.java b/druid-handler/src/java/org/apache/hadoop/hive/druid/security/ResponseCookieHandler.java
index b84c5e4717..9d3798fdb5 100644
--- a/druid-handler/src/java/org/apache/hadoop/hive/druid/security/ResponseCookieHandler.java
+++ b/druid-handler/src/java/org/apache/hadoop/hive/druid/security/ResponseCookieHandler.java
@@ -18,7 +18,6 @@
 
 package org.apache.hadoop.hive.druid.security;
 
-import com.google.common.base.Function;
 import com.google.common.collect.Maps;
 import com.metamx.http.client.response.ClientResponse;
 import com.metamx.http.client.response.HttpResponseHandler;
@@ -31,7 +30,6 @@
 import java.io.IOException;
 import java.net.CookieManager;
 import java.net.URI;
-import java.util.List;
 
 public class ResponseCookieHandler<Intermediate, Final> implements HttpResponseHandler<Intermediate, Final>
 {
@@ -53,14 +51,7 @@ public ClientResponse<Intermediate> handleResponse(HttpResponse httpResponse)
   {
     try {
       final HttpHeaders headers = httpResponse.headers();
-      manager.put(uri, Maps.asMap(headers.names(), new Function<String, List<String>>()
-      {
-        @Override
-        public List<String> apply(String input)
-        {
-          return headers.getAll(input);
-        }
-      }));
+      manager.put(uri, Maps.asMap(headers.names(), input -> headers.getAll(input)));
     }
     catch (IOException e) {
       log.error("Error while processing Cookies from header", e);
