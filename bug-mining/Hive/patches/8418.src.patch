diff --git a/beeline/src/java/org/apache/hive/beeline/schematool/HiveSchemaTool.java b/beeline/src/java/org/apache/hive/beeline/schematool/HiveSchemaTool.java
index a20e1fcf3f..eef449e3dd 100644
--- a/beeline/src/java/org/apache/hive/beeline/schematool/HiveSchemaTool.java
+++ b/beeline/src/java/org/apache/hive/beeline/schematool/HiveSchemaTool.java
@@ -75,8 +75,14 @@ protected void execSql(String scriptDir, String scriptFile)
     // write out the buffer into a file. Add beeline commands for autocommit and close
     FileWriter fstream = new FileWriter(tmpFile.getPath());
     BufferedWriter out = new BufferedWriter(fstream);
-    out.write("!autocommit on" + System.getProperty("line.separator"));
-    out.write(sqlCommands);
+    if (!dbType.equalsIgnoreCase(HiveSchemaHelper.DB_HIVE)) {
+      out.write("!autocommit off" + System.getProperty("line.separator"));
+      out.write(sqlCommands);
+      out.write("!commit" + System.getProperty("line.separator"));
+    } else {
+      out.write("!autocommit on" + System.getProperty("line.separator"));
+      out.write(sqlCommands);
+    }
     out.write("!closeall" + System.getProperty("line.separator"));
     out.close();
     execSql(tmpFile.getPath());
