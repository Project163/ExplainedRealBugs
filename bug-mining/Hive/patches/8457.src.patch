diff --git a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/SamplePruner.java b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/SamplePruner.java
index b3aac5c1b2..c7fc24cb48 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/SamplePruner.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/SamplePruner.java
@@ -27,6 +27,7 @@
 import java.util.Map;
 import java.util.Stack;
 
+import org.apache.hadoop.hive.common.FileUtils;
 import org.apache.hadoop.hive.metastore.TableType;
 import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
@@ -260,7 +261,7 @@ public static AddPathReturnStatus addPath(FileSystem fs, String pathPattern, lon
       Collection<Path> retPathList)
       throws IOException {
     LOG.info("Path pattern = " + pathPattern);
-    FileStatus srcs[] = fs.globStatus(new Path(pathPattern));
+    FileStatus srcs[] = fs.globStatus(new Path(pathPattern), FileUtils.HIDDEN_FILES_PATH_FILTER);
     Arrays.sort(srcs);
 
     boolean hasFile = false, allFile = true;
diff --git a/ql/src/test/queries/clientpositive/global_limit.q b/ql/src/test/queries/clientpositive/global_limit.q
index eefaffda09..16748583f3 100644
--- a/ql/src/test/queries/clientpositive/global_limit.q
+++ b/ql/src/test/queries/clientpositive/global_limit.q
@@ -15,6 +15,7 @@ load data local inpath '../../data/files/srcbucket20.txt' INTO TABLE gl_src1;
 load data local inpath '../../data/files/srcbucket20.txt' INTO TABLE gl_src1;
 load data local inpath '../../data/files/srcbucket20.txt' INTO TABLE gl_src1;
 
+dfs -touchz ${hiveconf:hive.metastore.warehouse.dir}/gl_src1/_SUCCESS;
 
 
 
