diff --git a/hcatalog/hcatalog-pig-adapter/src/test/java/org/apache/hive/hcatalog/pig/TestHCatLoaderEncryption.java b/hcatalog/hcatalog-pig-adapter/src/test/java/org/apache/hive/hcatalog/pig/TestHCatLoaderEncryption.java
index 3b8076bf50..df3b72a119 100644
--- a/hcatalog/hcatalog-pig-adapter/src/test/java/org/apache/hive/hcatalog/pig/TestHCatLoaderEncryption.java
+++ b/hcatalog/hcatalog-pig-adapter/src/test/java/org/apache/hive/hcatalog/pig/TestHCatLoaderEncryption.java
@@ -426,6 +426,9 @@ public void tearDown() throws Exception {
       }
     } finally {
       FileUtils.deleteDirectory(new File(TEST_DATA_DIR));
+      if (dfs != null) {
+        dfs.shutdown();
+      }
     }
   }
 
