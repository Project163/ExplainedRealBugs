diff --git a/CHANGES.txt b/CHANGES.txt
index ec4f15beef..7dd63df9c8 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -428,6 +428,9 @@ Trunk -  Unreleased
     HIVE-1116. Bug in renames for tables created with 'create table like'
     (John Sichi via namit)
 
+    HIVE-1322. Cached FileSystem can lead to persistant IOExceptions
+    (Paul Yang via namit)
+
 Release 0.5.0 -  Unreleased
 
   INCOMPATIBLE CHANGES
diff --git a/metastore/src/java/org/apache/hadoop/hive/metastore/HiveAlterHandler.java b/metastore/src/java/org/apache/hadoop/hive/metastore/HiveAlterHandler.java
index f52733d53c..e0931c9ca3 100644
--- a/metastore/src/java/org/apache/hadoop/hive/metastore/HiveAlterHandler.java
+++ b/metastore/src/java/org/apache/hadoop/hive/metastore/HiveAlterHandler.java
@@ -138,6 +138,8 @@ public void alterTable(RawStore msdb, Warehouse wh, String dbname,
                 + " already exists : " + destPath);
           }
         } catch (IOException e) {
+          Warehouse.closeFs(srcFs);
+          Warehouse.closeFs(destFs);
           throw new InvalidOperationException("Unable to access new location "
               + destPath + " for table " + newt.getDbName() + "."
               + newt.getTableName());
diff --git a/metastore/src/java/org/apache/hadoop/hive/metastore/Warehouse.java b/metastore/src/java/org/apache/hadoop/hive/metastore/Warehouse.java
index 8d619d2959..e73ee3150b 100755
--- a/metastore/src/java/org/apache/hadoop/hive/metastore/Warehouse.java
+++ b/metastore/src/java/org/apache/hadoop/hive/metastore/Warehouse.java
@@ -61,7 +61,7 @@ public Warehouse(Configuration conf) throws MetaException {
   }
 
   /**
-   * Helper function to convert IOException to MetaException
+   * Helper functions to convert IOException to MetaException
    */
   public FileSystem getFs(Path f) throws MetaException {
     try {
@@ -72,6 +72,17 @@ public FileSystem getFs(Path f) throws MetaException {
     return null;
   }
 
+  public static void closeFs(FileSystem fs) throws MetaException {
+    try {
+      if (fs != null) {
+        fs.close();
+      }
+    } catch (IOException e) {
+      MetaStoreUtils.logAndThrowMetaException(e);
+    }
+  }
+
+
   /**
    * Hadoop File System reverse lookups paths with raw ip addresses The File
    * System URI always contains the canonical DNS name of the Namenode.
@@ -118,11 +129,13 @@ public Path getDefaultTablePath(String dbName, String tableName)
   }
 
   public boolean mkdirs(Path f) throws MetaException {
+    FileSystem fs = null;
     try {
-      FileSystem fs = getFs(f);
+      fs = getFs(f);
       LOG.debug("Creating directory if it doesn't exist: " + f);
       return (fs.mkdirs(f) || fs.getFileStatus(f).isDir());
     } catch (IOException e) {
+      closeFs(fs);
       MetaStoreUtils.logAndThrowMetaException(e);
     }
     return false;
@@ -130,8 +143,9 @@ public boolean mkdirs(Path f) throws MetaException {
 
   public boolean deleteDir(Path f, boolean recursive) throws MetaException {
     LOG.info("deleting  " + f);
+    FileSystem fs = null;
     try {
-      FileSystem fs = getFs(f);
+      fs = getFs(f);
       if (!fs.exists(f)) {
         return false;
       }
@@ -157,6 +171,7 @@ public boolean deleteDir(Path f, boolean recursive) throws MetaException {
     } catch (FileNotFoundException e) {
       return true; // ok even if there is not data
     } catch (IOException e) {
+      closeFs(fs);
       MetaStoreUtils.logAndThrowMetaException(e);
     }
     return false;
@@ -286,8 +301,9 @@ public Path getPartitionPath(Path tblPath, LinkedHashMap<String, String> pm)
   }
 
   public boolean isDir(Path f) throws MetaException {
+    FileSystem fs = null;
     try {
-      FileSystem fs = getFs(f);
+      fs = getFs(f);
       FileStatus fstatus = fs.getFileStatus(f);
       if (!fstatus.isDir()) {
         return false;
@@ -295,6 +311,7 @@ public boolean isDir(Path f) throws MetaException {
     } catch (FileNotFoundException e) {
       return false;
     } catch (IOException e) {
+      closeFs(fs);
       MetaStoreUtils.logAndThrowMetaException(e);
     }
     return true;
