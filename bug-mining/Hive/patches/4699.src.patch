diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/vector/VectorMapOperator.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/vector/VectorMapOperator.java
index acad263881..0f55c00d6a 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/vector/VectorMapOperator.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/vector/VectorMapOperator.java
@@ -768,6 +768,9 @@ public void process(Writable value) throws HiveException {
            * We pass the VectorizedRowBatch through here.
            */
           batchCounter++;
+          if (value != null) {
+            numRows += ((VectorizedRowBatch) value).size;
+          }
           oneRootOperator.process(value, 0);
           if (oneRootOperator.getDone()) {
             setDone(true);
@@ -785,6 +788,7 @@ public void process(Writable value) throws HiveException {
               currentReadType == VectorMapOperatorReadType.ROW_DESERIALIZE);
 
           if (deserializerBatch.size == deserializerBatch.DEFAULT_SIZE) {
+            numRows += deserializerBatch.size;
 
             /*
              * Feed current full batch to operator tree.
@@ -874,6 +878,7 @@ public void closeOp(boolean abort) throws HiveException {
     if (!abort && oneRootOperator != null && !oneRootOperator.getDone() &&
         currentReadType != VectorMapOperatorReadType.VECTORIZED_INPUT_FILE_FORMAT) {
       if (deserializerBatch.size > 0) {
+        numRows += deserializerBatch.size;
         batchCounter++;
         oneRootOperator.process(deserializerBatch, 0);
         deserializerBatch.size = 0;
