diff --git a/CHANGES.txt b/CHANGES.txt
index c39738e782..5b7b155802 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -357,6 +357,9 @@ Trunk - Unreleased
 
     HIVE-160. Bug in sampling for subqueries. (Raghu Murthy via namit)
 
+    HIVE-636. Fix concatenation task with partitioned table.
+    (Namit Jain via zshao)
+
     HIVE-641. fix test udf_reverse.q
     (Emil Ibrishimov via namit)
 
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRFileSink1.java b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRFileSink1.java
index 697102dcc7..99b8243d25 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRFileSink1.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRFileSink1.java
@@ -147,9 +147,11 @@ private void createMergeJob(FileSinkOperator fsOp, GenMRProcContext ctx, String
         new extractDesc(new exprNodeColumnDesc(TypeInfoFactory.stringTypeInfo, Utilities.ReduceField.VALUE.toString())),
         new RowSchema(out_rwsch.getColumnInfos()));
     
+    tableDesc ts = (tableDesc)fsConf.getTableInfo().clone();
+    fsConf.getTableInfo().getProperties().remove(org.apache.hadoop.hive.metastore.api.Constants.META_TABLE_PARTITION_COLUMNS);
     FileSinkOperator newOutput = 
       (FileSinkOperator)OperatorFactory.getAndMakeChild(
-         new fileSinkDesc(finalName, fsConf.getTableInfo(), 
+         new fileSinkDesc(finalName, ts, 
                           parseCtx.getConf().getBoolVar(HiveConf.ConfVars.COMPRESSINTERMEDIATE)),
          fsRS, extract);
 
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/plan/tableDesc.java b/ql/src/java/org/apache/hadoop/hive/ql/plan/tableDesc.java
index f0c7b07d7b..cf49866f79 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/plan/tableDesc.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/plan/tableDesc.java
@@ -19,15 +19,15 @@
 package org.apache.hadoop.hive.ql.plan;
 
 import java.io.Serializable;
+import java.util.Enumeration;
+import java.util.Properties;
 
 import org.apache.hadoop.mapred.InputFormat;
-import org.apache.hadoop.mapred.OutputFormat;
 import org.apache.hadoop.hive.ql.io.HiveFileFormatUtils;
 import org.apache.hadoop.hive.ql.io.HiveOutputFormat;
 import org.apache.hadoop.hive.serde2.Deserializer;
-import org.apache.hadoop.hive.serde2.SerDe;
 
-public class tableDesc implements Serializable {
+public class tableDesc implements Serializable, Cloneable {
   private static final long serialVersionUID = 1L;
   private Class<? extends Deserializer> deserializerClass;
   private Class<? extends InputFormat> inputFileFormatClass;
@@ -50,7 +50,7 @@ public tableDesc(
   public Class<? extends Deserializer> getDeserializerClass() {
     return this.deserializerClass;
   }
-  public void setDeserializerClass(final Class<? extends SerDe> serdeClass) {
+  public void setDeserializerClass(final Class<? extends Deserializer> serdeClass) {
     this.deserializerClass = serdeClass;
   }
   public Class<? extends InputFormat> getInputFileFormatClass() {
@@ -109,4 +109,21 @@ public String getInputFileFormatClassName() {
   public String getOutputFileFormatClassName() {
     return getOutputFileFormatClass().getName();
   }
+  
+  public Object clone() {
+    tableDesc ret = new tableDesc();
+    ret.setSerdeClassName(serdeClassName);
+    ret.setDeserializerClass(deserializerClass);
+    ret.setInputFileFormatClass(inputFileFormatClass);
+    ret.setOutputFileFormatClass(outputFileFormatClass);
+    Properties newProp = new Properties();
+    Enumeration<Object> keysProp = properties.keys(); 
+    while (keysProp.hasMoreElements()) {
+      Object key = keysProp.nextElement();
+      newProp.put(key, properties.get(key));
+    }
+
+    ret.setProperties(newProp);
+    return ret;
+  }
 }
diff --git a/ql/src/test/results/compiler/plan/case_sensitivity.q.xml b/ql/src/test/results/compiler/plan/case_sensitivity.q.xml
index f77ff96ed1..a2a37319bb 100644
--- a/ql/src/test/results/compiler/plan/case_sensitivity.q.xml
+++ b/ql/src/test/results/compiler/plan/case_sensitivity.q.xml
@@ -30,7 +30,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/555968808/10000</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/763950704/10000</string> 
               </void> 
               <void property="table"> 
                <object id="tableDesc0" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -83,7 +83,7 @@
                   </void> 
                   <void method="put"> 
                    <string>location</string> 
-                   <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/dest1</string> 
+                   <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/dest1</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -93,7 +93,7 @@
                </object> 
               </void> 
               <void property="tmpDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/555968808/10001</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/763950704/10001</string> 
               </void> 
              </object> 
             </void> 
@@ -121,10 +121,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/561779002/10002</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1565488649/10002</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/555968808/10000</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/763950704/10000</string> 
               </void> 
              </object> 
             </void> 
@@ -142,7 +142,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/561779002/10002</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1565488649/10002</string> 
                <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -342,10 +342,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/561779002/10002</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1565488649/10002</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/561779002/10002</string> 
+                 <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1565488649/10002</string> 
                 </void> 
                </object> 
               </void> 
@@ -354,7 +354,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/561779002/10002</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1565488649/10002</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object idref="tableDesc0"/> 
@@ -372,10 +372,67 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/555968808/10000</string> 
+                     <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/763950704/10000</string> 
                     </void> 
                     <void property="tableInfo"> 
-                     <object idref="tableDesc0"/> 
+                     <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
+                      <void property="deserializerClass"> 
+                       <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
+                      </void> 
+                      <void property="inputFileFormatClass"> 
+                       <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                      </void> 
+                      <void property="outputFileFormatClass"> 
+                       <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                      </void> 
+                      <void property="properties"> 
+                       <object class="java.util.Properties"> 
+                        <void method="put"> 
+                         <string>name</string> 
+                         <string>dest1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>columns.types</string> 
+                         <string>string:string</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.ddl</string> 
+                         <string>struct dest1 { string key, string value}</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.format</string> 
+                         <string>1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>columns</string> 
+                         <string>key,value</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>bucket_count</string> 
+                         <string>-1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.lib</string> 
+                         <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>file.inputformat</string> 
+                         <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>location</string> 
+                         <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/dest1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>file.outputformat</string> 
+                         <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="serdeClassName"> 
+                       <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                      </void> 
+                     </object> 
                     </void> 
                    </object> 
                   </void> 
@@ -467,7 +524,7 @@
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
         <void property="dir"> 
-         <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/561779002/10002</string> 
+         <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1565488649/10002</string> 
         </void> 
         <void property="listTasks"> 
          <object idref="ArrayList0"/> 
@@ -559,7 +616,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/src_thrift</string> 
+            <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/src_thrift</string> 
            </void> 
           </object> 
          </void> 
@@ -598,7 +655,7 @@
                            <int>1</int> 
                           </void> 
                           <void property="dirName"> 
-                           <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/561779002/10002</string> 
+                           <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1565488649/10002</string> 
                           </void> 
                           <void property="tableInfo"> 
                            <object idref="tableDesc0"/> 
@@ -1053,7 +1110,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/src_thrift</string> 
+       <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/src_thrift</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>src_thrift</string> 
@@ -1065,7 +1122,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/src_thrift</string> 
+       <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/src_thrift</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/input1.q.xml b/ql/src/test/results/compiler/plan/input1.q.xml
index c60cc95bdb..7198110c41 100755
--- a/ql/src/test/results/compiler/plan/input1.q.xml
+++ b/ql/src/test/results/compiler/plan/input1.q.xml
@@ -30,7 +30,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/2058797514/10000</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/983045819/10000</string> 
               </void> 
               <void property="table"> 
                <object id="tableDesc0" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -83,7 +83,7 @@
                   </void> 
                   <void method="put"> 
                    <string>location</string> 
-                   <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/dest1</string> 
+                   <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/dest1</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -93,7 +93,7 @@
                </object> 
               </void> 
               <void property="tmpDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/2058797514/10001</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/983045819/10001</string> 
               </void> 
              </object> 
             </void> 
@@ -121,10 +121,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/23190357/10002</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1046375614/10002</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/2058797514/10000</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/983045819/10000</string> 
               </void> 
              </object> 
             </void> 
@@ -142,7 +142,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/23190357/10002</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1046375614/10002</string> 
                <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -342,10 +342,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/23190357/10002</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1046375614/10002</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/23190357/10002</string> 
+                 <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1046375614/10002</string> 
                 </void> 
                </object> 
               </void> 
@@ -354,7 +354,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/23190357/10002</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1046375614/10002</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object idref="tableDesc0"/> 
@@ -372,10 +372,67 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/2058797514/10000</string> 
+                     <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/983045819/10000</string> 
                     </void> 
                     <void property="tableInfo"> 
-                     <object idref="tableDesc0"/> 
+                     <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
+                      <void property="deserializerClass"> 
+                       <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
+                      </void> 
+                      <void property="inputFileFormatClass"> 
+                       <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                      </void> 
+                      <void property="outputFileFormatClass"> 
+                       <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                      </void> 
+                      <void property="properties"> 
+                       <object class="java.util.Properties"> 
+                        <void method="put"> 
+                         <string>name</string> 
+                         <string>dest1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>columns.types</string> 
+                         <string>string:string</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.ddl</string> 
+                         <string>struct dest1 { string key, string value}</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.format</string> 
+                         <string>1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>columns</string> 
+                         <string>key,value</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>bucket_count</string> 
+                         <string>-1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.lib</string> 
+                         <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>file.inputformat</string> 
+                         <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>location</string> 
+                         <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/dest1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>file.outputformat</string> 
+                         <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="serdeClassName"> 
+                       <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                      </void> 
+                     </object> 
                     </void> 
                    </object> 
                   </void> 
@@ -463,7 +520,7 @@
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
         <void property="dir"> 
-         <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/23190357/10002</string> 
+         <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1046375614/10002</string> 
         </void> 
         <void property="listTasks"> 
          <object idref="ArrayList0"/> 
@@ -551,7 +608,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/src</string> 
+            <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/src</string> 
            </void> 
           </object> 
          </void> 
@@ -590,7 +647,7 @@
                            <int>1</int> 
                           </void> 
                           <void property="dirName"> 
-                           <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/23190357/10002</string> 
+                           <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1046375614/10002</string> 
                           </void> 
                           <void property="tableInfo"> 
                            <object idref="tableDesc0"/> 
@@ -963,7 +1020,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/src</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>src</string> 
@@ -975,7 +1032,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/src</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/input2.q.xml b/ql/src/test/results/compiler/plan/input2.q.xml
index f41ef78330..ebca0939dc 100755
--- a/ql/src/test/results/compiler/plan/input2.q.xml
+++ b/ql/src/test/results/compiler/plan/input2.q.xml
@@ -30,7 +30,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1748116396/10000</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1231242820/10000</string> 
               </void> 
               <void property="table"> 
                <object id="tableDesc0" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -83,7 +83,7 @@
                   </void> 
                   <void method="put"> 
                    <string>location</string> 
-                   <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/dest1</string> 
+                   <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/dest1</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -93,7 +93,7 @@
                </object> 
               </void> 
               <void property="tmpDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1748116396/10001</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1231242820/10001</string> 
               </void> 
              </object> 
             </void> 
@@ -121,10 +121,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1978910505/10006</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1773686843/10006</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1748116396/10000</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1231242820/10000</string> 
               </void> 
              </object> 
             </void> 
@@ -142,7 +142,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1978910505/10006</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1773686843/10006</string> 
                <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -342,10 +342,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1978910505/10006</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1773686843/10006</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1978910505/10006</string> 
+                 <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1773686843/10006</string> 
                 </void> 
                </object> 
               </void> 
@@ -354,7 +354,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1978910505/10006</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1773686843/10006</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object idref="tableDesc0"/> 
@@ -372,10 +372,67 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1748116396/10000</string> 
+                     <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1231242820/10000</string> 
                     </void> 
                     <void property="tableInfo"> 
-                     <object idref="tableDesc0"/> 
+                     <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
+                      <void property="deserializerClass"> 
+                       <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
+                      </void> 
+                      <void property="inputFileFormatClass"> 
+                       <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                      </void> 
+                      <void property="outputFileFormatClass"> 
+                       <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                      </void> 
+                      <void property="properties"> 
+                       <object class="java.util.Properties"> 
+                        <void method="put"> 
+                         <string>name</string> 
+                         <string>dest1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>columns.types</string> 
+                         <string>string:string</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.ddl</string> 
+                         <string>struct dest1 { string key, string value}</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.format</string> 
+                         <string>1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>columns</string> 
+                         <string>key,value</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>bucket_count</string> 
+                         <string>-1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.lib</string> 
+                         <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>file.inputformat</string> 
+                         <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>location</string> 
+                         <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/dest1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>file.outputformat</string> 
+                         <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="serdeClassName"> 
+                       <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                      </void> 
+                     </object> 
                     </void> 
                    </object> 
                   </void> 
@@ -463,7 +520,7 @@
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
         <void property="dir"> 
-         <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1978910505/10006</string> 
+         <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1773686843/10006</string> 
         </void> 
         <void property="listTasks"> 
          <object idref="ArrayList0"/> 
@@ -513,7 +570,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1748116396/10002</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1231242820/10002</string> 
               </void> 
               <void property="table"> 
                <object id="tableDesc3" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -566,7 +623,7 @@
                   </void> 
                   <void method="put"> 
                    <string>location</string> 
-                   <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/dest2</string> 
+                   <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/dest2</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -576,7 +633,7 @@
                </object> 
               </void> 
               <void property="tmpDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1748116396/10003</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1231242820/10003</string> 
               </void> 
              </object> 
             </void> 
@@ -604,10 +661,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1978910505/10007</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1773686843/10007</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1748116396/10002</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1231242820/10002</string> 
               </void> 
              </object> 
             </void> 
@@ -625,7 +682,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1978910505/10007</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1773686843/10007</string> 
                <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -817,10 +874,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1978910505/10007</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1773686843/10007</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1978910505/10007</string> 
+                 <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1773686843/10007</string> 
                 </void> 
                </object> 
               </void> 
@@ -829,7 +886,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1978910505/10007</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1773686843/10007</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object idref="tableDesc3"/> 
@@ -847,10 +904,67 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1748116396/10002</string> 
+                     <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1231242820/10002</string> 
                     </void> 
                     <void property="tableInfo"> 
-                     <object idref="tableDesc3"/> 
+                     <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
+                      <void property="deserializerClass"> 
+                       <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
+                      </void> 
+                      <void property="inputFileFormatClass"> 
+                       <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                      </void> 
+                      <void property="outputFileFormatClass"> 
+                       <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                      </void> 
+                      <void property="properties"> 
+                       <object class="java.util.Properties"> 
+                        <void method="put"> 
+                         <string>name</string> 
+                         <string>dest2</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>columns.types</string> 
+                         <string>string:string</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.ddl</string> 
+                         <string>struct dest2 { string key, string value}</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.format</string> 
+                         <string>1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>columns</string> 
+                         <string>key,value</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>bucket_count</string> 
+                         <string>-1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.lib</string> 
+                         <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>file.inputformat</string> 
+                         <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>location</string> 
+                         <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/dest2</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>file.outputformat</string> 
+                         <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="serdeClassName"> 
+                       <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                      </void> 
+                     </object> 
                     </void> 
                    </object> 
                   </void> 
@@ -938,7 +1052,7 @@
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
         <void property="dir"> 
-         <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1978910505/10007</string> 
+         <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1773686843/10007</string> 
         </void> 
         <void property="listTasks"> 
          <object idref="ArrayList1"/> 
@@ -997,7 +1111,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1748116396/10004</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1231242820/10004</string> 
               </void> 
               <void property="table"> 
                <object id="tableDesc6" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -1032,10 +1146,6 @@
                    <string>columns</string> 
                    <string>key,value</string> 
                   </void> 
-                  <void method="put"> 
-                   <string>partition_columns</string> 
-                   <string>ds/hr</string> 
-                  </void> 
                   <void method="put"> 
                    <string>bucket_count</string> 
                    <string>-1</string> 
@@ -1054,7 +1164,7 @@
                   </void> 
                   <void method="put"> 
                    <string>location</string> 
-                   <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/dest3</string> 
+                   <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/dest3</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -1064,7 +1174,7 @@
                </object> 
               </void> 
               <void property="tmpDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1748116396/10005</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1231242820/10005</string> 
               </void> 
              </object> 
             </void> 
@@ -1092,10 +1202,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1978910505/10008</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1773686843/10008</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1748116396/10004</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1231242820/10004</string> 
               </void> 
              </object> 
             </void> 
@@ -1113,7 +1223,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1978910505/10008</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1773686843/10008</string> 
                <object id="TableScanOperator2" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -1305,10 +1415,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1978910505/10008</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1773686843/10008</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1978910505/10008</string> 
+                 <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1773686843/10008</string> 
                 </void> 
                </object> 
               </void> 
@@ -1317,7 +1427,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1978910505/10008</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1773686843/10008</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object idref="tableDesc6"/> 
@@ -1335,10 +1445,71 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1748116396/10004</string> 
+                     <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1231242820/10004</string> 
                     </void> 
                     <void property="tableInfo"> 
-                     <object idref="tableDesc6"/> 
+                     <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
+                      <void property="deserializerClass"> 
+                       <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
+                      </void> 
+                      <void property="inputFileFormatClass"> 
+                       <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                      </void> 
+                      <void property="outputFileFormatClass"> 
+                       <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                      </void> 
+                      <void property="properties"> 
+                       <object class="java.util.Properties"> 
+                        <void method="put"> 
+                         <string>name</string> 
+                         <string>dest3</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>columns.types</string> 
+                         <string>string:string</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.ddl</string> 
+                         <string>struct dest3 { string key, string value}</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.format</string> 
+                         <string>1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>columns</string> 
+                         <string>key,value</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>partition_columns</string> 
+                         <string>ds/hr</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>bucket_count</string> 
+                         <string>-1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.lib</string> 
+                         <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>file.inputformat</string> 
+                         <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>location</string> 
+                         <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/dest3</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>file.outputformat</string> 
+                         <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="serdeClassName"> 
+                       <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                      </void> 
+                     </object> 
                     </void> 
                    </object> 
                   </void> 
@@ -1430,7 +1601,7 @@
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
         <void property="dir"> 
-         <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1978910505/10008</string> 
+         <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1773686843/10008</string> 
         </void> 
         <void property="listTasks"> 
          <object idref="ArrayList2"/> 
@@ -1518,7 +1689,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/src</string> 
+            <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/src</string> 
            </void> 
           </object> 
          </void> 
@@ -1553,7 +1724,7 @@
                        <int>1</int> 
                       </void> 
                       <void property="dirName"> 
-                       <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1978910505/10006</string> 
+                       <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1773686843/10006</string> 
                       </void> 
                       <void property="tableInfo"> 
                        <object idref="tableDesc0"/> 
@@ -1822,7 +1993,7 @@
                        <int>2</int> 
                       </void> 
                       <void property="dirName"> 
-                       <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1978910505/10007</string> 
+                       <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1773686843/10007</string> 
                       </void> 
                       <void property="tableInfo"> 
                        <object idref="tableDesc3"/> 
@@ -2185,7 +2356,7 @@
                        <int>3</int> 
                       </void> 
                       <void property="dirName"> 
-                       <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1978910505/10008</string> 
+                       <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1773686843/10008</string> 
                       </void> 
                       <void property="tableInfo"> 
                        <object idref="tableDesc6"/> 
@@ -2436,7 +2607,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/src</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>src</string> 
@@ -2448,7 +2619,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/src</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/input3.q.xml b/ql/src/test/results/compiler/plan/input3.q.xml
index 7236caaf4e..afbf815072 100755
--- a/ql/src/test/results/compiler/plan/input3.q.xml
+++ b/ql/src/test/results/compiler/plan/input3.q.xml
@@ -30,7 +30,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1671812987/10000</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/943669715/10000</string> 
               </void> 
               <void property="table"> 
                <object id="tableDesc0" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -83,7 +83,7 @@
                   </void> 
                   <void method="put"> 
                    <string>location</string> 
-                   <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/dest1</string> 
+                   <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/dest1</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -93,7 +93,7 @@
                </object> 
               </void> 
               <void property="tmpDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1671812987/10001</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/943669715/10001</string> 
               </void> 
              </object> 
             </void> 
@@ -121,10 +121,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1582503596/10007</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/554607221/10007</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1671812987/10000</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/943669715/10000</string> 
               </void> 
              </object> 
             </void> 
@@ -142,7 +142,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1582503596/10007</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/554607221/10007</string> 
                <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -342,10 +342,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1582503596/10007</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/554607221/10007</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1582503596/10007</string> 
+                 <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/554607221/10007</string> 
                 </void> 
                </object> 
               </void> 
@@ -354,7 +354,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1582503596/10007</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/554607221/10007</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object idref="tableDesc0"/> 
@@ -372,10 +372,67 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1671812987/10000</string> 
+                     <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/943669715/10000</string> 
                     </void> 
                     <void property="tableInfo"> 
-                     <object idref="tableDesc0"/> 
+                     <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
+                      <void property="deserializerClass"> 
+                       <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
+                      </void> 
+                      <void property="inputFileFormatClass"> 
+                       <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                      </void> 
+                      <void property="outputFileFormatClass"> 
+                       <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                      </void> 
+                      <void property="properties"> 
+                       <object class="java.util.Properties"> 
+                        <void method="put"> 
+                         <string>name</string> 
+                         <string>dest1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>columns.types</string> 
+                         <string>string:string</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.ddl</string> 
+                         <string>struct dest1 { string key, string value}</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.format</string> 
+                         <string>1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>columns</string> 
+                         <string>key,value</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>bucket_count</string> 
+                         <string>-1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.lib</string> 
+                         <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>file.inputformat</string> 
+                         <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>location</string> 
+                         <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/dest1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>file.outputformat</string> 
+                         <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="serdeClassName"> 
+                       <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                      </void> 
+                     </object> 
                     </void> 
                    </object> 
                   </void> 
@@ -463,7 +520,7 @@
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
         <void property="dir"> 
-         <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1582503596/10007</string> 
+         <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/554607221/10007</string> 
         </void> 
         <void property="listTasks"> 
          <object idref="ArrayList0"/> 
@@ -513,7 +570,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1671812987/10002</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/943669715/10002</string> 
               </void> 
               <void property="table"> 
                <object id="tableDesc3" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -566,7 +623,7 @@
                   </void> 
                   <void method="put"> 
                    <string>location</string> 
-                   <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/dest2</string> 
+                   <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/dest2</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -576,7 +633,7 @@
                </object> 
               </void> 
               <void property="tmpDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1671812987/10003</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/943669715/10003</string> 
               </void> 
              </object> 
             </void> 
@@ -604,10 +661,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1582503596/10008</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/554607221/10008</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1671812987/10002</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/943669715/10002</string> 
               </void> 
              </object> 
             </void> 
@@ -625,7 +682,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1582503596/10008</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/554607221/10008</string> 
                <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -817,10 +874,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1582503596/10008</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/554607221/10008</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1582503596/10008</string> 
+                 <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/554607221/10008</string> 
                 </void> 
                </object> 
               </void> 
@@ -829,7 +886,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1582503596/10008</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/554607221/10008</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object idref="tableDesc3"/> 
@@ -847,10 +904,67 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1671812987/10002</string> 
+                     <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/943669715/10002</string> 
                     </void> 
                     <void property="tableInfo"> 
-                     <object idref="tableDesc3"/> 
+                     <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
+                      <void property="deserializerClass"> 
+                       <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
+                      </void> 
+                      <void property="inputFileFormatClass"> 
+                       <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                      </void> 
+                      <void property="outputFileFormatClass"> 
+                       <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                      </void> 
+                      <void property="properties"> 
+                       <object class="java.util.Properties"> 
+                        <void method="put"> 
+                         <string>name</string> 
+                         <string>dest2</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>columns.types</string> 
+                         <string>string:string</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.ddl</string> 
+                         <string>struct dest2 { string key, string value}</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.format</string> 
+                         <string>1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>columns</string> 
+                         <string>key,value</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>bucket_count</string> 
+                         <string>-1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.lib</string> 
+                         <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>file.inputformat</string> 
+                         <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>location</string> 
+                         <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/dest2</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>file.outputformat</string> 
+                         <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="serdeClassName"> 
+                       <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                      </void> 
+                     </object> 
                     </void> 
                    </object> 
                   </void> 
@@ -938,7 +1052,7 @@
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
         <void property="dir"> 
-         <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1582503596/10008</string> 
+         <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/554607221/10008</string> 
         </void> 
         <void property="listTasks"> 
          <object idref="ArrayList1"/> 
@@ -997,7 +1111,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1671812987/10004</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/943669715/10004</string> 
               </void> 
               <void property="table"> 
                <object id="tableDesc6" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -1032,10 +1146,6 @@
                    <string>columns</string> 
                    <string>key,value</string> 
                   </void> 
-                  <void method="put"> 
-                   <string>partition_columns</string> 
-                   <string>ds/hr</string> 
-                  </void> 
                   <void method="put"> 
                    <string>bucket_count</string> 
                    <string>-1</string> 
@@ -1054,7 +1164,7 @@
                   </void> 
                   <void method="put"> 
                    <string>location</string> 
-                   <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/dest3</string> 
+                   <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/dest3</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -1064,7 +1174,7 @@
                </object> 
               </void> 
               <void property="tmpDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1671812987/10005</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/943669715/10005</string> 
               </void> 
              </object> 
             </void> 
@@ -1092,10 +1202,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1582503596/10009</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/554607221/10009</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1671812987/10004</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/943669715/10004</string> 
               </void> 
              </object> 
             </void> 
@@ -1113,7 +1223,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1582503596/10009</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/554607221/10009</string> 
                <object id="TableScanOperator2" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -1305,10 +1415,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1582503596/10009</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/554607221/10009</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1582503596/10009</string> 
+                 <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/554607221/10009</string> 
                 </void> 
                </object> 
               </void> 
@@ -1317,7 +1427,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1582503596/10009</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/554607221/10009</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object idref="tableDesc6"/> 
@@ -1335,10 +1445,71 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1671812987/10004</string> 
+                     <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/943669715/10004</string> 
                     </void> 
                     <void property="tableInfo"> 
-                     <object idref="tableDesc6"/> 
+                     <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
+                      <void property="deserializerClass"> 
+                       <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
+                      </void> 
+                      <void property="inputFileFormatClass"> 
+                       <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                      </void> 
+                      <void property="outputFileFormatClass"> 
+                       <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                      </void> 
+                      <void property="properties"> 
+                       <object class="java.util.Properties"> 
+                        <void method="put"> 
+                         <string>name</string> 
+                         <string>dest3</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>columns.types</string> 
+                         <string>string:string</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.ddl</string> 
+                         <string>struct dest3 { string key, string value}</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.format</string> 
+                         <string>1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>columns</string> 
+                         <string>key,value</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>partition_columns</string> 
+                         <string>ds/hr</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>bucket_count</string> 
+                         <string>-1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.lib</string> 
+                         <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>file.inputformat</string> 
+                         <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>location</string> 
+                         <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/dest3</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>file.outputformat</string> 
+                         <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="serdeClassName"> 
+                       <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                      </void> 
+                     </object> 
                     </void> 
                    </object> 
                   </void> 
@@ -1430,7 +1601,7 @@
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
         <void property="dir"> 
-         <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1582503596/10009</string> 
+         <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/554607221/10009</string> 
         </void> 
         <void property="listTasks"> 
          <object idref="ArrayList2"/> 
@@ -1483,7 +1654,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1671812987/10006</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/943669715/10006</string> 
               </void> 
               <void property="targetDir"> 
                <string>../../../../build/contrib/hive/ql/test/data/warehouse/dest4.out</string> 
@@ -1514,10 +1685,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1582503596/10010</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/554607221/10010</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1671812987/10006</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/943669715/10006</string> 
               </void> 
              </object> 
             </void> 
@@ -1535,7 +1706,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1582503596/10010</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/554607221/10010</string> 
                <object id="TableScanOperator3" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -1704,10 +1875,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1582503596/10010</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/554607221/10010</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1582503596/10010</string> 
+                 <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/554607221/10010</string> 
                 </void> 
                </object> 
               </void> 
@@ -1716,7 +1887,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1582503596/10010</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/554607221/10010</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object id="tableDesc11" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -1760,10 +1931,36 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1671812987/10006</string> 
+                     <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/943669715/10006</string> 
                     </void> 
                     <void property="tableInfo"> 
-                     <object idref="tableDesc11"/> 
+                     <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
+                      <void property="deserializerClass"> 
+                       <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
+                      </void> 
+                      <void property="inputFileFormatClass"> 
+                       <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                      </void> 
+                      <void property="outputFileFormatClass"> 
+                       <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                      </void> 
+                      <void property="properties"> 
+                       <object class="java.util.Properties"> 
+                        <void method="put"> 
+                         <string>columns</string> 
+                         <string>src.value</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.format</string> 
+                         <string>1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>columns.types</string> 
+                         <string>string</string> 
+                        </void> 
+                       </object> 
+                      </void> 
+                     </object> 
                     </void> 
                    </object> 
                   </void> 
@@ -1841,7 +2038,7 @@
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
         <void property="dir"> 
-         <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1582503596/10010</string> 
+         <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/554607221/10010</string> 
         </void> 
         <void property="listTasks"> 
          <object idref="ArrayList3"/> 
@@ -1929,7 +2126,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/src</string> 
+            <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/src</string> 
            </void> 
           </object> 
          </void> 
@@ -1964,7 +2161,7 @@
                        <int>1</int> 
                       </void> 
                       <void property="dirName"> 
-                       <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1582503596/10007</string> 
+                       <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/554607221/10007</string> 
                       </void> 
                       <void property="tableInfo"> 
                        <object idref="tableDesc0"/> 
@@ -2233,7 +2430,7 @@
                        <int>2</int> 
                       </void> 
                       <void property="dirName"> 
-                       <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1582503596/10008</string> 
+                       <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/554607221/10008</string> 
                       </void> 
                       <void property="tableInfo"> 
                        <object idref="tableDesc3"/> 
@@ -2596,7 +2793,7 @@
                        <int>3</int> 
                       </void> 
                       <void property="dirName"> 
-                       <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1582503596/10009</string> 
+                       <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/554607221/10009</string> 
                       </void> 
                       <void property="tableInfo"> 
                        <object idref="tableDesc6"/> 
@@ -2959,7 +3156,7 @@
                        <int>4</int> 
                       </void> 
                       <void property="dirName"> 
-                       <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1582503596/10010</string> 
+                       <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/554607221/10010</string> 
                       </void> 
                       <void property="tableInfo"> 
                        <object idref="tableDesc11"/> 
@@ -3183,7 +3380,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/src</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>src</string> 
@@ -3195,7 +3392,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/src</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/input6.q.xml b/ql/src/test/results/compiler/plan/input6.q.xml
index e915e68d8d..d5c673c6ab 100644
--- a/ql/src/test/results/compiler/plan/input6.q.xml
+++ b/ql/src/test/results/compiler/plan/input6.q.xml
@@ -30,7 +30,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/592248541/10000</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/859581041/10000</string> 
               </void> 
               <void property="table"> 
                <object id="tableDesc0" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -83,7 +83,7 @@
                   </void> 
                   <void method="put"> 
                    <string>location</string> 
-                   <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/dest1</string> 
+                   <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/dest1</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -93,7 +93,7 @@
                </object> 
               </void> 
               <void property="tmpDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/592248541/10001</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/859581041/10001</string> 
               </void> 
              </object> 
             </void> 
@@ -121,10 +121,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/755430438/10002</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/193107959/10002</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/592248541/10000</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/859581041/10000</string> 
               </void> 
              </object> 
             </void> 
@@ -142,7 +142,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/755430438/10002</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/193107959/10002</string> 
                <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -342,10 +342,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/755430438/10002</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/193107959/10002</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/755430438/10002</string> 
+                 <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/193107959/10002</string> 
                 </void> 
                </object> 
               </void> 
@@ -354,7 +354,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/755430438/10002</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/193107959/10002</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object idref="tableDesc0"/> 
@@ -372,10 +372,67 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/592248541/10000</string> 
+                     <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/859581041/10000</string> 
                     </void> 
                     <void property="tableInfo"> 
-                     <object idref="tableDesc0"/> 
+                     <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
+                      <void property="deserializerClass"> 
+                       <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
+                      </void> 
+                      <void property="inputFileFormatClass"> 
+                       <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                      </void> 
+                      <void property="outputFileFormatClass"> 
+                       <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                      </void> 
+                      <void property="properties"> 
+                       <object class="java.util.Properties"> 
+                        <void method="put"> 
+                         <string>name</string> 
+                         <string>dest1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>columns.types</string> 
+                         <string>string:string</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.ddl</string> 
+                         <string>struct dest1 { string key, string value}</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.format</string> 
+                         <string>1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>columns</string> 
+                         <string>key,value</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>bucket_count</string> 
+                         <string>-1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.lib</string> 
+                         <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>file.inputformat</string> 
+                         <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>location</string> 
+                         <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/dest1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>file.outputformat</string> 
+                         <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="serdeClassName"> 
+                       <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                      </void> 
+                     </object> 
                     </void> 
                    </object> 
                   </void> 
@@ -463,7 +520,7 @@
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
         <void property="dir"> 
-         <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/755430438/10002</string> 
+         <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/193107959/10002</string> 
         </void> 
         <void property="listTasks"> 
          <object idref="ArrayList0"/> 
@@ -551,7 +608,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/src1</string> 
+            <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/src1</string> 
            </void> 
           </object> 
          </void> 
@@ -590,7 +647,7 @@
                            <int>1</int> 
                           </void> 
                           <void property="dirName"> 
-                           <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/755430438/10002</string> 
+                           <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/193107959/10002</string> 
                           </void> 
                           <void property="tableInfo"> 
                            <object idref="tableDesc0"/> 
@@ -841,7 +898,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/src1</string> 
+       <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/src1</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>src1</string> 
@@ -853,7 +910,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/src1</string> 
+       <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/src1</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/input7.q.xml b/ql/src/test/results/compiler/plan/input7.q.xml
index 88609e3326..ace478bd25 100644
--- a/ql/src/test/results/compiler/plan/input7.q.xml
+++ b/ql/src/test/results/compiler/plan/input7.q.xml
@@ -30,7 +30,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1592867025/10000</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/471888232/10000</string> 
               </void> 
               <void property="table"> 
                <object id="tableDesc0" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -83,7 +83,7 @@
                   </void> 
                   <void method="put"> 
                    <string>location</string> 
-                   <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/dest1</string> 
+                   <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/dest1</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -93,7 +93,7 @@
                </object> 
               </void> 
               <void property="tmpDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1592867025/10001</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/471888232/10001</string> 
               </void> 
              </object> 
             </void> 
@@ -121,10 +121,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1183740593/10002</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1506551529/10002</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1592867025/10000</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/471888232/10000</string> 
               </void> 
              </object> 
             </void> 
@@ -142,7 +142,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1183740593/10002</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1506551529/10002</string> 
                <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -342,10 +342,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1183740593/10002</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1506551529/10002</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1183740593/10002</string> 
+                 <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1506551529/10002</string> 
                 </void> 
                </object> 
               </void> 
@@ -354,7 +354,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1183740593/10002</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1506551529/10002</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object idref="tableDesc0"/> 
@@ -372,10 +372,67 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1592867025/10000</string> 
+                     <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/471888232/10000</string> 
                     </void> 
                     <void property="tableInfo"> 
-                     <object idref="tableDesc0"/> 
+                     <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
+                      <void property="deserializerClass"> 
+                       <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
+                      </void> 
+                      <void property="inputFileFormatClass"> 
+                       <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                      </void> 
+                      <void property="outputFileFormatClass"> 
+                       <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                      </void> 
+                      <void property="properties"> 
+                       <object class="java.util.Properties"> 
+                        <void method="put"> 
+                         <string>name</string> 
+                         <string>dest1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>columns.types</string> 
+                         <string>string:string</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.ddl</string> 
+                         <string>struct dest1 { string key, string value}</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.format</string> 
+                         <string>1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>columns</string> 
+                         <string>key,value</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>bucket_count</string> 
+                         <string>-1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.lib</string> 
+                         <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>file.inputformat</string> 
+                         <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>location</string> 
+                         <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/dest1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>file.outputformat</string> 
+                         <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="serdeClassName"> 
+                       <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                      </void> 
+                     </object> 
                     </void> 
                    </object> 
                   </void> 
@@ -467,7 +524,7 @@
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
         <void property="dir"> 
-         <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1183740593/10002</string> 
+         <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1506551529/10002</string> 
         </void> 
         <void property="listTasks"> 
          <object idref="ArrayList0"/> 
@@ -555,7 +612,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/src1</string> 
+            <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/src1</string> 
            </void> 
           </object> 
          </void> 
@@ -586,7 +643,7 @@
                    <int>1</int> 
                   </void> 
                   <void property="dirName"> 
-                   <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1183740593/10002</string> 
+                   <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1506551529/10002</string> 
                   </void> 
                   <void property="tableInfo"> 
                    <object idref="tableDesc0"/> 
@@ -735,7 +792,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/src1</string> 
+       <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/src1</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>src1</string> 
@@ -747,7 +804,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/src1</string> 
+       <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/src1</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/input9.q.xml b/ql/src/test/results/compiler/plan/input9.q.xml
index 58440bc52f..ce26f412e6 100644
--- a/ql/src/test/results/compiler/plan/input9.q.xml
+++ b/ql/src/test/results/compiler/plan/input9.q.xml
@@ -30,7 +30,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1760764346/10000</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/120413419/10000</string> 
               </void> 
               <void property="table"> 
                <object id="tableDesc0" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -83,7 +83,7 @@
                   </void> 
                   <void method="put"> 
                    <string>location</string> 
-                   <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/dest1</string> 
+                   <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/dest1</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -93,7 +93,7 @@
                </object> 
               </void> 
               <void property="tmpDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1760764346/10001</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/120413419/10001</string> 
               </void> 
              </object> 
             </void> 
@@ -121,10 +121,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/462891853/10002</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1640616512/10002</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1760764346/10000</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/120413419/10000</string> 
               </void> 
              </object> 
             </void> 
@@ -142,7 +142,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/462891853/10002</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1640616512/10002</string> 
                <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -342,10 +342,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/462891853/10002</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1640616512/10002</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/462891853/10002</string> 
+                 <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1640616512/10002</string> 
                 </void> 
                </object> 
               </void> 
@@ -354,7 +354,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/462891853/10002</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1640616512/10002</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object idref="tableDesc0"/> 
@@ -372,10 +372,67 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1760764346/10000</string> 
+                     <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/120413419/10000</string> 
                     </void> 
                     <void property="tableInfo"> 
-                     <object idref="tableDesc0"/> 
+                     <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
+                      <void property="deserializerClass"> 
+                       <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
+                      </void> 
+                      <void property="inputFileFormatClass"> 
+                       <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                      </void> 
+                      <void property="outputFileFormatClass"> 
+                       <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                      </void> 
+                      <void property="properties"> 
+                       <object class="java.util.Properties"> 
+                        <void method="put"> 
+                         <string>name</string> 
+                         <string>dest1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>columns.types</string> 
+                         <string>string:string</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.ddl</string> 
+                         <string>struct dest1 { string key, string value}</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.format</string> 
+                         <string>1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>columns</string> 
+                         <string>key,value</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>bucket_count</string> 
+                         <string>-1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.lib</string> 
+                         <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>file.inputformat</string> 
+                         <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>location</string> 
+                         <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/dest1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>file.outputformat</string> 
+                         <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="serdeClassName"> 
+                       <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                      </void> 
+                     </object> 
                     </void> 
                    </object> 
                   </void> 
@@ -467,7 +524,7 @@
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
         <void property="dir"> 
-         <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/462891853/10002</string> 
+         <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1640616512/10002</string> 
         </void> 
         <void property="listTasks"> 
          <object idref="ArrayList0"/> 
@@ -555,7 +612,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/src1</string> 
+            <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/src1</string> 
            </void> 
           </object> 
          </void> 
@@ -594,7 +651,7 @@
                            <int>1</int> 
                           </void> 
                           <void property="dirName"> 
-                           <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/462891853/10002</string> 
+                           <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1640616512/10002</string> 
                           </void> 
                           <void property="tableInfo"> 
                            <object idref="tableDesc0"/> 
@@ -863,7 +920,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/src1</string> 
+       <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/src1</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>src1</string> 
@@ -875,7 +932,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/src1</string> 
+       <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/src1</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/input_testsequencefile.q.xml b/ql/src/test/results/compiler/plan/input_testsequencefile.q.xml
index 8db681dda7..320eda090e 100644
--- a/ql/src/test/results/compiler/plan/input_testsequencefile.q.xml
+++ b/ql/src/test/results/compiler/plan/input_testsequencefile.q.xml
@@ -30,7 +30,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/290562073/10000</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/967650497/10000</string> 
               </void> 
               <void property="table"> 
                <object id="tableDesc0" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -83,7 +83,7 @@
                   </void> 
                   <void method="put"> 
                    <string>location</string> 
-                   <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/dest4_sequencefile</string> 
+                   <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/dest4_sequencefile</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -93,7 +93,7 @@
                </object> 
               </void> 
               <void property="tmpDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/290562073/10001</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/967650497/10001</string> 
               </void> 
              </object> 
             </void> 
@@ -121,10 +121,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1328031115/10002</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1146419397/10002</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/290562073/10000</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/967650497/10000</string> 
               </void> 
              </object> 
             </void> 
@@ -142,7 +142,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1328031115/10002</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1146419397/10002</string> 
                <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -342,10 +342,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1328031115/10002</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1146419397/10002</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1328031115/10002</string> 
+                 <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1146419397/10002</string> 
                 </void> 
                </object> 
               </void> 
@@ -354,7 +354,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1328031115/10002</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1146419397/10002</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object idref="tableDesc0"/> 
@@ -372,10 +372,67 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/290562073/10000</string> 
+                     <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/967650497/10000</string> 
                     </void> 
                     <void property="tableInfo"> 
-                     <object idref="tableDesc0"/> 
+                     <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
+                      <void property="deserializerClass"> 
+                       <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
+                      </void> 
+                      <void property="inputFileFormatClass"> 
+                       <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                      </void> 
+                      <void property="outputFileFormatClass"> 
+                       <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                      </void> 
+                      <void property="properties"> 
+                       <object class="java.util.Properties"> 
+                        <void method="put"> 
+                         <string>name</string> 
+                         <string>dest4_sequencefile</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>columns.types</string> 
+                         <string>string:string</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.ddl</string> 
+                         <string>struct dest4_sequencefile { string key, string value}</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.format</string> 
+                         <string>1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>columns</string> 
+                         <string>key,value</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>bucket_count</string> 
+                         <string>-1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.lib</string> 
+                         <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>file.inputformat</string> 
+                         <string>org.apache.hadoop.mapred.SequenceFileInputFormat</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>location</string> 
+                         <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/dest4_sequencefile</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>file.outputformat</string> 
+                         <string>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</string> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="serdeClassName"> 
+                       <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                      </void> 
+                     </object> 
                     </void> 
                    </object> 
                   </void> 
@@ -463,7 +520,7 @@
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
         <void property="dir"> 
-         <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1328031115/10002</string> 
+         <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1146419397/10002</string> 
         </void> 
         <void property="listTasks"> 
          <object idref="ArrayList0"/> 
@@ -551,7 +608,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/src</string> 
+            <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/src</string> 
            </void> 
           </object> 
          </void> 
@@ -582,7 +639,7 @@
                    <int>1</int> 
                   </void> 
                   <void property="dirName"> 
-                   <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1328031115/10002</string> 
+                   <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1146419397/10002</string> 
                   </void> 
                   <void property="tableInfo"> 
                    <object idref="tableDesc0"/> 
@@ -737,7 +794,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/src</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>src</string> 
@@ -749,7 +806,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/src</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/sample2.q.xml b/ql/src/test/results/compiler/plan/sample2.q.xml
index ec00deacc3..974579ea61 100644
--- a/ql/src/test/results/compiler/plan/sample2.q.xml
+++ b/ql/src/test/results/compiler/plan/sample2.q.xml
@@ -30,7 +30,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1927782633/10000</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1490423752/10000</string> 
               </void> 
               <void property="table"> 
                <object id="tableDesc0" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -83,7 +83,7 @@
                   </void> 
                   <void method="put"> 
                    <string>location</string> 
-                   <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/dest1</string> 
+                   <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/dest1</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -93,7 +93,7 @@
                </object> 
               </void> 
               <void property="tmpDir"> 
-               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1927782633/10001</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1490423752/10001</string> 
               </void> 
              </object> 
             </void> 
@@ -121,10 +121,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1976066542/10002</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1313373355/10002</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1927782633/10000</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1490423752/10000</string> 
               </void> 
              </object> 
             </void> 
@@ -142,7 +142,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1976066542/10002</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1313373355/10002</string> 
                <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -342,10 +342,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1976066542/10002</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1313373355/10002</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1976066542/10002</string> 
+                 <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1313373355/10002</string> 
                 </void> 
                </object> 
               </void> 
@@ -354,7 +354,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1976066542/10002</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1313373355/10002</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object idref="tableDesc0"/> 
@@ -372,10 +372,67 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1927782633/10000</string> 
+                     <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1490423752/10000</string> 
                     </void> 
                     <void property="tableInfo"> 
-                     <object idref="tableDesc0"/> 
+                     <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
+                      <void property="deserializerClass"> 
+                       <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
+                      </void> 
+                      <void property="inputFileFormatClass"> 
+                       <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                      </void> 
+                      <void property="outputFileFormatClass"> 
+                       <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                      </void> 
+                      <void property="properties"> 
+                       <object class="java.util.Properties"> 
+                        <void method="put"> 
+                         <string>name</string> 
+                         <string>dest1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>columns.types</string> 
+                         <string>string:string</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.ddl</string> 
+                         <string>struct dest1 { string key, string value}</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.format</string> 
+                         <string>1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>columns</string> 
+                         <string>key,value</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>bucket_count</string> 
+                         <string>-1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.lib</string> 
+                         <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>file.inputformat</string> 
+                         <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>location</string> 
+                         <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/dest1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>file.outputformat</string> 
+                         <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="serdeClassName"> 
+                       <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                      </void> 
+                     </object> 
                     </void> 
                    </object> 
                   </void> 
@@ -467,7 +524,7 @@
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
         <void property="dir"> 
-         <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1976066542/10002</string> 
+         <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1313373355/10002</string> 
         </void> 
         <void property="listTasks"> 
          <object idref="ArrayList0"/> 
@@ -559,7 +616,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/srcbucket</string> 
+            <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/srcbucket</string> 
            </void> 
           </object> 
          </void> 
@@ -598,7 +655,7 @@
                            <int>1</int> 
                           </void> 
                           <void property="dirName"> 
-                           <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1976066542/10002</string> 
+                           <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1313373355/10002</string> 
                           </void> 
                           <void property="tableInfo"> 
                            <object idref="tableDesc0"/> 
@@ -1037,7 +1094,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt</string> 
+       <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>s</string> 
@@ -1049,7 +1106,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt</string> 
+       <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/sample3.q.xml b/ql/src/test/results/compiler/plan/sample3.q.xml
index 5c0ac452da..80189aa38b 100644
--- a/ql/src/test/results/compiler/plan/sample3.q.xml
+++ b/ql/src/test/results/compiler/plan/sample3.q.xml
@@ -30,7 +30,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1065018374/10000</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1719224789/10000</string> 
               </void> 
               <void property="table"> 
                <object id="tableDesc0" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -83,7 +83,7 @@
                   </void> 
                   <void method="put"> 
                    <string>location</string> 
-                   <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/dest1</string> 
+                   <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/dest1</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -93,7 +93,7 @@
                </object> 
               </void> 
               <void property="tmpDir"> 
-               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1065018374/10001</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1719224789/10001</string> 
               </void> 
              </object> 
             </void> 
@@ -121,10 +121,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1846470159/10002</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/2025285331/10002</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1065018374/10000</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1719224789/10000</string> 
               </void> 
              </object> 
             </void> 
@@ -142,7 +142,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1846470159/10002</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/2025285331/10002</string> 
                <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -342,10 +342,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1846470159/10002</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/2025285331/10002</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1846470159/10002</string> 
+                 <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/2025285331/10002</string> 
                 </void> 
                </object> 
               </void> 
@@ -354,7 +354,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1846470159/10002</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/2025285331/10002</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object idref="tableDesc0"/> 
@@ -372,10 +372,67 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1065018374/10000</string> 
+                     <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1719224789/10000</string> 
                     </void> 
                     <void property="tableInfo"> 
-                     <object idref="tableDesc0"/> 
+                     <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
+                      <void property="deserializerClass"> 
+                       <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
+                      </void> 
+                      <void property="inputFileFormatClass"> 
+                       <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                      </void> 
+                      <void property="outputFileFormatClass"> 
+                       <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                      </void> 
+                      <void property="properties"> 
+                       <object class="java.util.Properties"> 
+                        <void method="put"> 
+                         <string>name</string> 
+                         <string>dest1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>columns.types</string> 
+                         <string>string:string</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.ddl</string> 
+                         <string>struct dest1 { string key, string value}</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.format</string> 
+                         <string>1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>columns</string> 
+                         <string>key,value</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>bucket_count</string> 
+                         <string>-1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.lib</string> 
+                         <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>file.inputformat</string> 
+                         <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>location</string> 
+                         <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/dest1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>file.outputformat</string> 
+                         <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="serdeClassName"> 
+                       <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                      </void> 
+                     </object> 
                     </void> 
                    </object> 
                   </void> 
@@ -467,7 +524,7 @@
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
         <void property="dir"> 
-         <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1846470159/10002</string> 
+         <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/2025285331/10002</string> 
         </void> 
         <void property="listTasks"> 
          <object idref="ArrayList0"/> 
@@ -559,7 +616,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/srcbucket</string> 
+            <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/srcbucket</string> 
            </void> 
           </object> 
          </void> 
@@ -598,7 +655,7 @@
                            <int>1</int> 
                           </void> 
                           <void property="dirName"> 
-                           <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1846470159/10002</string> 
+                           <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/2025285331/10002</string> 
                           </void> 
                           <void property="tableInfo"> 
                            <object idref="tableDesc0"/> 
@@ -1057,7 +1114,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/srcbucket</string> 
+       <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/srcbucket</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>s</string> 
@@ -1069,7 +1126,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/srcbucket</string> 
+       <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/srcbucket</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/sample4.q.xml b/ql/src/test/results/compiler/plan/sample4.q.xml
index cc3a56a1ef..fc35d88d53 100644
--- a/ql/src/test/results/compiler/plan/sample4.q.xml
+++ b/ql/src/test/results/compiler/plan/sample4.q.xml
@@ -30,7 +30,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/215193431/10000</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/487130226/10000</string> 
               </void> 
               <void property="table"> 
                <object id="tableDesc0" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -83,7 +83,7 @@
                   </void> 
                   <void method="put"> 
                    <string>location</string> 
-                   <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/dest1</string> 
+                   <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/dest1</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -93,7 +93,7 @@
                </object> 
               </void> 
               <void property="tmpDir"> 
-               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/215193431/10001</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/487130226/10001</string> 
               </void> 
              </object> 
             </void> 
@@ -121,10 +121,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1178789084/10002</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/667179734/10002</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/215193431/10000</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/487130226/10000</string> 
               </void> 
              </object> 
             </void> 
@@ -142,7 +142,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1178789084/10002</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/667179734/10002</string> 
                <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -342,10 +342,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1178789084/10002</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/667179734/10002</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1178789084/10002</string> 
+                 <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/667179734/10002</string> 
                 </void> 
                </object> 
               </void> 
@@ -354,7 +354,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1178789084/10002</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/667179734/10002</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object idref="tableDesc0"/> 
@@ -372,10 +372,67 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/215193431/10000</string> 
+                     <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/487130226/10000</string> 
                     </void> 
                     <void property="tableInfo"> 
-                     <object idref="tableDesc0"/> 
+                     <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
+                      <void property="deserializerClass"> 
+                       <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
+                      </void> 
+                      <void property="inputFileFormatClass"> 
+                       <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                      </void> 
+                      <void property="outputFileFormatClass"> 
+                       <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                      </void> 
+                      <void property="properties"> 
+                       <object class="java.util.Properties"> 
+                        <void method="put"> 
+                         <string>name</string> 
+                         <string>dest1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>columns.types</string> 
+                         <string>string:string</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.ddl</string> 
+                         <string>struct dest1 { string key, string value}</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.format</string> 
+                         <string>1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>columns</string> 
+                         <string>key,value</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>bucket_count</string> 
+                         <string>-1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.lib</string> 
+                         <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>file.inputformat</string> 
+                         <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>location</string> 
+                         <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/dest1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>file.outputformat</string> 
+                         <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="serdeClassName"> 
+                       <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                      </void> 
+                     </object> 
                     </void> 
                    </object> 
                   </void> 
@@ -467,7 +524,7 @@
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
         <void property="dir"> 
-         <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1178789084/10002</string> 
+         <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/667179734/10002</string> 
         </void> 
         <void property="listTasks"> 
          <object idref="ArrayList0"/> 
@@ -559,7 +616,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/srcbucket</string> 
+            <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/srcbucket</string> 
            </void> 
           </object> 
          </void> 
@@ -598,7 +655,7 @@
                            <int>1</int> 
                           </void> 
                           <void property="dirName"> 
-                           <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1178789084/10002</string> 
+                           <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/667179734/10002</string> 
                           </void> 
                           <void property="tableInfo"> 
                            <object idref="tableDesc0"/> 
@@ -1037,7 +1094,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt</string> 
+       <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>s</string> 
@@ -1049,7 +1106,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt</string> 
+       <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/sample5.q.xml b/ql/src/test/results/compiler/plan/sample5.q.xml
index e44e671a5e..3cc50cb37a 100644
--- a/ql/src/test/results/compiler/plan/sample5.q.xml
+++ b/ql/src/test/results/compiler/plan/sample5.q.xml
@@ -30,7 +30,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/846885962/10000</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/707138646/10000</string> 
               </void> 
               <void property="table"> 
                <object id="tableDesc0" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -83,7 +83,7 @@
                   </void> 
                   <void method="put"> 
                    <string>location</string> 
-                   <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/dest1</string> 
+                   <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/dest1</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -93,7 +93,7 @@
                </object> 
               </void> 
               <void property="tmpDir"> 
-               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/846885962/10001</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/707138646/10001</string> 
               </void> 
              </object> 
             </void> 
@@ -121,10 +121,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/922690588/10002</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1776114372/10002</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/846885962/10000</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/707138646/10000</string> 
               </void> 
              </object> 
             </void> 
@@ -142,7 +142,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/922690588/10002</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1776114372/10002</string> 
                <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -342,10 +342,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/922690588/10002</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1776114372/10002</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/922690588/10002</string> 
+                 <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1776114372/10002</string> 
                 </void> 
                </object> 
               </void> 
@@ -354,7 +354,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/922690588/10002</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1776114372/10002</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object idref="tableDesc0"/> 
@@ -372,10 +372,67 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/846885962/10000</string> 
+                     <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/707138646/10000</string> 
                     </void> 
                     <void property="tableInfo"> 
-                     <object idref="tableDesc0"/> 
+                     <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
+                      <void property="deserializerClass"> 
+                       <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
+                      </void> 
+                      <void property="inputFileFormatClass"> 
+                       <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                      </void> 
+                      <void property="outputFileFormatClass"> 
+                       <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                      </void> 
+                      <void property="properties"> 
+                       <object class="java.util.Properties"> 
+                        <void method="put"> 
+                         <string>name</string> 
+                         <string>dest1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>columns.types</string> 
+                         <string>string:string</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.ddl</string> 
+                         <string>struct dest1 { string key, string value}</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.format</string> 
+                         <string>1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>columns</string> 
+                         <string>key,value</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>bucket_count</string> 
+                         <string>-1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.lib</string> 
+                         <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>file.inputformat</string> 
+                         <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>location</string> 
+                         <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/dest1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>file.outputformat</string> 
+                         <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="serdeClassName"> 
+                       <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                      </void> 
+                     </object> 
                     </void> 
                    </object> 
                   </void> 
@@ -467,7 +524,7 @@
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
         <void property="dir"> 
-         <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/922690588/10002</string> 
+         <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1776114372/10002</string> 
         </void> 
         <void property="listTasks"> 
          <object idref="ArrayList0"/> 
@@ -559,7 +616,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/srcbucket</string> 
+            <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/srcbucket</string> 
            </void> 
           </object> 
          </void> 
@@ -598,7 +655,7 @@
                            <int>1</int> 
                           </void> 
                           <void property="dirName"> 
-                           <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/922690588/10002</string> 
+                           <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1776114372/10002</string> 
                           </void> 
                           <void property="tableInfo"> 
                            <object idref="tableDesc0"/> 
@@ -1037,7 +1094,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/srcbucket</string> 
+       <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/srcbucket</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>s</string> 
@@ -1049,7 +1106,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/srcbucket</string> 
+       <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/srcbucket</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/sample6.q.xml b/ql/src/test/results/compiler/plan/sample6.q.xml
index 1e7ac64550..4983839a75 100644
--- a/ql/src/test/results/compiler/plan/sample6.q.xml
+++ b/ql/src/test/results/compiler/plan/sample6.q.xml
@@ -30,7 +30,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1218577077/10000</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/950802647/10000</string> 
               </void> 
               <void property="table"> 
                <object id="tableDesc0" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -83,7 +83,7 @@
                   </void> 
                   <void method="put"> 
                    <string>location</string> 
-                   <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/dest1</string> 
+                   <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/dest1</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -93,7 +93,7 @@
                </object> 
               </void> 
               <void property="tmpDir"> 
-               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1218577077/10001</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/950802647/10001</string> 
               </void> 
              </object> 
             </void> 
@@ -121,10 +121,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/2128074916/10002</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1635011117/10002</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1218577077/10000</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/950802647/10000</string> 
               </void> 
              </object> 
             </void> 
@@ -142,7 +142,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/2128074916/10002</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1635011117/10002</string> 
                <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -342,10 +342,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/2128074916/10002</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1635011117/10002</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/2128074916/10002</string> 
+                 <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1635011117/10002</string> 
                 </void> 
                </object> 
               </void> 
@@ -354,7 +354,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/2128074916/10002</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1635011117/10002</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object idref="tableDesc0"/> 
@@ -372,10 +372,67 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1218577077/10000</string> 
+                     <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/950802647/10000</string> 
                     </void> 
                     <void property="tableInfo"> 
-                     <object idref="tableDesc0"/> 
+                     <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
+                      <void property="deserializerClass"> 
+                       <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
+                      </void> 
+                      <void property="inputFileFormatClass"> 
+                       <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                      </void> 
+                      <void property="outputFileFormatClass"> 
+                       <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                      </void> 
+                      <void property="properties"> 
+                       <object class="java.util.Properties"> 
+                        <void method="put"> 
+                         <string>name</string> 
+                         <string>dest1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>columns.types</string> 
+                         <string>string:string</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.ddl</string> 
+                         <string>struct dest1 { string key, string value}</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.format</string> 
+                         <string>1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>columns</string> 
+                         <string>key,value</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>bucket_count</string> 
+                         <string>-1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.lib</string> 
+                         <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>file.inputformat</string> 
+                         <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>location</string> 
+                         <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/dest1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>file.outputformat</string> 
+                         <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="serdeClassName"> 
+                       <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                      </void> 
+                     </object> 
                     </void> 
                    </object> 
                   </void> 
@@ -467,7 +524,7 @@
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
         <void property="dir"> 
-         <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/2128074916/10002</string> 
+         <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1635011117/10002</string> 
         </void> 
         <void property="listTasks"> 
          <object idref="ArrayList0"/> 
@@ -559,7 +616,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/srcbucket</string> 
+            <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/srcbucket</string> 
            </void> 
           </object> 
          </void> 
@@ -598,7 +655,7 @@
                            <int>1</int> 
                           </void> 
                           <void property="dirName"> 
-                           <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/2128074916/10002</string> 
+                           <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1635011117/10002</string> 
                           </void> 
                           <void property="tableInfo"> 
                            <object idref="tableDesc0"/> 
@@ -1037,7 +1094,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt</string> 
+       <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>s</string> 
@@ -1049,7 +1106,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt</string> 
+       <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/sample7.q.xml b/ql/src/test/results/compiler/plan/sample7.q.xml
index 0f61ceed36..a78918cf4a 100644
--- a/ql/src/test/results/compiler/plan/sample7.q.xml
+++ b/ql/src/test/results/compiler/plan/sample7.q.xml
@@ -30,7 +30,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/598613180/10000</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/274403833/10000</string> 
               </void> 
               <void property="table"> 
                <object id="tableDesc0" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -83,7 +83,7 @@
                   </void> 
                   <void method="put"> 
                    <string>location</string> 
-                   <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/dest1</string> 
+                   <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/dest1</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -93,7 +93,7 @@
                </object> 
               </void> 
               <void property="tmpDir"> 
-               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/598613180/10001</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/274403833/10001</string> 
               </void> 
              </object> 
             </void> 
@@ -121,10 +121,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/775500580/10002</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/240735029/10002</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/598613180/10000</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/274403833/10000</string> 
               </void> 
              </object> 
             </void> 
@@ -142,7 +142,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/775500580/10002</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/240735029/10002</string> 
                <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -342,10 +342,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/775500580/10002</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/240735029/10002</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/775500580/10002</string> 
+                 <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/240735029/10002</string> 
                 </void> 
                </object> 
               </void> 
@@ -354,7 +354,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/775500580/10002</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/240735029/10002</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object idref="tableDesc0"/> 
@@ -372,10 +372,67 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/598613180/10000</string> 
+                     <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/274403833/10000</string> 
                     </void> 
                     <void property="tableInfo"> 
-                     <object idref="tableDesc0"/> 
+                     <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
+                      <void property="deserializerClass"> 
+                       <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
+                      </void> 
+                      <void property="inputFileFormatClass"> 
+                       <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                      </void> 
+                      <void property="outputFileFormatClass"> 
+                       <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                      </void> 
+                      <void property="properties"> 
+                       <object class="java.util.Properties"> 
+                        <void method="put"> 
+                         <string>name</string> 
+                         <string>dest1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>columns.types</string> 
+                         <string>string:string</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.ddl</string> 
+                         <string>struct dest1 { string key, string value}</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.format</string> 
+                         <string>1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>columns</string> 
+                         <string>key,value</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>bucket_count</string> 
+                         <string>-1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.lib</string> 
+                         <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>file.inputformat</string> 
+                         <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>location</string> 
+                         <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/dest1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>file.outputformat</string> 
+                         <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="serdeClassName"> 
+                       <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                      </void> 
+                     </object> 
                     </void> 
                    </object> 
                   </void> 
@@ -467,7 +524,7 @@
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
         <void property="dir"> 
-         <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/775500580/10002</string> 
+         <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/240735029/10002</string> 
         </void> 
         <void property="listTasks"> 
          <object idref="ArrayList0"/> 
@@ -559,7 +616,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/srcbucket</string> 
+            <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/srcbucket</string> 
            </void> 
           </object> 
          </void> 
@@ -602,7 +659,7 @@
                                <int>1</int> 
                               </void> 
                               <void property="dirName"> 
-                               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/775500580/10002</string> 
+                               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/240735029/10002</string> 
                               </void> 
                               <void property="tableInfo"> 
                                <object idref="tableDesc0"/> 
@@ -1174,7 +1231,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt</string> 
+       <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>s</string> 
@@ -1186,7 +1243,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt</string> 
+       <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/subq.q.xml b/ql/src/test/results/compiler/plan/subq.q.xml
index 6d36943a49..85ef86de71 100644
--- a/ql/src/test/results/compiler/plan/subq.q.xml
+++ b/ql/src/test/results/compiler/plan/subq.q.xml
@@ -33,7 +33,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/837861575/10000</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1374780294/10000</string> 
               </void> 
               <void property="targetDir"> 
                <string>../build/ql/test/data/warehouse/union.out</string> 
@@ -64,10 +64,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1594471324/10001</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/604868872/10001</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/837861575/10000</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1374780294/10000</string> 
               </void> 
              </object> 
             </void> 
@@ -85,7 +85,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1594471324/10001</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/604868872/10001</string> 
                <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -285,10 +285,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1594471324/10001</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/604868872/10001</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1594471324/10001</string> 
+                 <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/604868872/10001</string> 
                 </void> 
                </object> 
               </void> 
@@ -297,7 +297,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1594471324/10001</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/604868872/10001</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object id="tableDesc2" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -341,10 +341,36 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/837861575/10000</string> 
+                     <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1374780294/10000</string> 
                     </void> 
                     <void property="tableInfo"> 
-                     <object idref="tableDesc2"/> 
+                     <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
+                      <void property="deserializerClass"> 
+                       <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
+                      </void> 
+                      <void property="inputFileFormatClass"> 
+                       <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                      </void> 
+                      <void property="outputFileFormatClass"> 
+                       <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                      </void> 
+                      <void property="properties"> 
+                       <object class="java.util.Properties"> 
+                        <void method="put"> 
+                         <string>columns</string> 
+                         <string>unioninput.key,unioninput.value</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.format</string> 
+                         <string>1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>columns.types</string> 
+                         <string>string:string</string> 
+                        </void> 
+                       </object> 
+                      </void> 
+                     </object> 
                     </void> 
                    </object> 
                   </void> 
@@ -432,7 +458,7 @@
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
         <void property="dir"> 
-         <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1594471324/10001</string> 
+         <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/604868872/10001</string> 
         </void> 
         <void property="listTasks"> 
          <object idref="ArrayList0"/> 
@@ -520,7 +546,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/src</string> 
+            <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/src</string> 
            </void> 
           </object> 
          </void> 
@@ -563,7 +589,7 @@
                                <int>1</int> 
                               </void> 
                               <void property="dirName"> 
-                               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1594471324/10001</string> 
+                               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/604868872/10001</string> 
                               </void> 
                               <void property="tableInfo"> 
                                <object idref="tableDesc2"/> 
@@ -1031,7 +1057,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/src</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>unioninput:src</string> 
@@ -1043,7 +1069,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/src</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/union.q.xml b/ql/src/test/results/compiler/plan/union.q.xml
index 89610376b9..a94354bb7b 100644
--- a/ql/src/test/results/compiler/plan/union.q.xml
+++ b/ql/src/test/results/compiler/plan/union.q.xml
@@ -33,7 +33,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1543656547/10000</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1824776098/10000</string> 
               </void> 
               <void property="targetDir"> 
                <string>../build/ql/test/data/warehouse/union.out</string> 
@@ -64,10 +64,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/289003521/10001</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/555401062/10001</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1543656547/10000</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1824776098/10000</string> 
               </void> 
              </object> 
             </void> 
@@ -85,7 +85,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/289003521/10001</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/555401062/10001</string> 
                <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -285,10 +285,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/289003521/10001</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/555401062/10001</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/289003521/10001</string> 
+                 <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/555401062/10001</string> 
                 </void> 
                </object> 
               </void> 
@@ -297,7 +297,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/289003521/10001</string> 
+               <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/555401062/10001</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object id="tableDesc2" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -341,10 +341,36 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/1543656547/10000</string> 
+                     <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/1824776098/10000</string> 
                     </void> 
                     <void property="tableInfo"> 
-                     <object idref="tableDesc2"/> 
+                     <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
+                      <void property="deserializerClass"> 
+                       <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
+                      </void> 
+                      <void property="inputFileFormatClass"> 
+                       <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                      </void> 
+                      <void property="outputFileFormatClass"> 
+                       <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                      </void> 
+                      <void property="properties"> 
+                       <object class="java.util.Properties"> 
+                        <void method="put"> 
+                         <string>columns</string> 
+                         <string>unioninput.key,unioninput.value</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>serialization.format</string> 
+                         <string>1</string> 
+                        </void> 
+                        <void method="put"> 
+                         <string>columns.types</string> 
+                         <string>string:string</string> 
+                        </void> 
+                       </object> 
+                      </void> 
+                     </object> 
                     </void> 
                    </object> 
                   </void> 
@@ -432,7 +458,7 @@
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
         <void property="dir"> 
-         <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/289003521/10001</string> 
+         <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/555401062/10001</string> 
         </void> 
         <void property="listTasks"> 
          <object idref="ArrayList0"/> 
@@ -520,7 +546,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/src</string> 
+            <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/src</string> 
            </void> 
           </object> 
          </void> 
@@ -588,7 +614,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/src</string> 
+            <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/src</string> 
            </void> 
           </object> 
          </void> 
@@ -635,7 +661,7 @@
                                    <int>1</int> 
                                   </void> 
                                   <void property="dirName"> 
-                                   <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/tmp/289003521/10001</string> 
+                                   <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/tmp/555401062/10001</string> 
                                   </void> 
                                   <void property="tableInfo"> 
                                    <object idref="tableDesc2"/> 
@@ -1495,7 +1521,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/src</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>null-subquery1:unioninput-subquery1:src</string> 
@@ -1510,7 +1536,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/zshao/tools/522-trunk-apache-hive/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/deploy/hive1/tools/ahive1-trunk-apache-hive/build/ql/test/data/warehouse/src</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
