diff --git a/ql/src/test/queries/clientpositive/alter_merge_2_orc.q b/ql/src/test/queries/clientpositive/alter_merge_2_orc.q
index 580b53566e..990ae6b109 100644
--- a/ql/src/test/queries/clientpositive/alter_merge_2_orc.q
+++ b/ql/src/test/queries/clientpositive/alter_merge_2_orc.q
@@ -3,9 +3,9 @@ create table src_orc_merge_test_part(key int, value string) partitioned by (ds s
 alter table src_orc_merge_test_part add partition (ds='2012-01-03', ts='2012-01-03+14:46:31');
 desc extended src_orc_merge_test_part partition (ds='2012-01-03', ts='2012-01-03+14:46:31');
 
-insert overwrite table src_orc_merge_test_part partition(ds='2012-01-03', ts='2012-01-03+14:46:31') select * from src;
-insert into table src_orc_merge_test_part partition(ds='2012-01-03', ts='2012-01-03+14:46:31') select * from src limit 100;
-insert into table src_orc_merge_test_part partition(ds='2012-01-03', ts='2012-01-03+14:46:31') select * from src limit 10;
+insert overwrite table src_orc_merge_test_part partition(ds='2012-01-03', ts='2012-01-03+14:46:31') select * from src order by key, value;
+insert into table src_orc_merge_test_part partition(ds='2012-01-03', ts='2012-01-03+14:46:31') select * from src order by key, value limit 100;
+insert into table src_orc_merge_test_part partition(ds='2012-01-03', ts='2012-01-03+14:46:31') select * from src order by key, value limit 10;
 
 select count(1) from src_orc_merge_test_part where ds='2012-01-03' and ts='2012-01-03+14:46:31';
 select sum(hash(key)), sum(hash(value)) from src_orc_merge_test_part where ds='2012-01-03' and ts='2012-01-03+14:46:31';
diff --git a/ql/src/test/queries/clientpositive/auto_join0.q b/ql/src/test/queries/clientpositive/auto_join0.q
index 84731dbce4..008f9e30b5 100644
--- a/ql/src/test/queries/clientpositive/auto_join0.q
+++ b/ql/src/test/queries/clientpositive/auto_join0.q
@@ -1,14 +1,15 @@
-
 set hive.auto.convert.join = true;
 
+-- SORT_QUERY_RESULTS
+
 explain 
 select sum(hash(a.k1,a.v1,a.k2, a.v2))
 from (
 SELECT src1.key as k1, src1.value as v1, 
        src2.key as k2, src2.value as v2 FROM 
-  (SELECT * FROM src WHERE src.key < 10) src1 
+  (SELECT * FROM src WHERE src.key < 10 order by src.key, src.value) src1
     JOIN 
-  (SELECT * FROM src WHERE src.key < 10) src2
+  (SELECT * FROM src WHERE src.key < 10 order by src.key, src.value) src2
   SORT BY k1, v1, k2, v2
 ) a;
 
@@ -16,8 +17,8 @@ select sum(hash(a.k1,a.v1,a.k2, a.v2))
 from (
 SELECT src1.key as k1, src1.value as v1, 
        src2.key as k2, src2.value as v2 FROM 
-  (SELECT * FROM src WHERE src.key < 10) src1 
+  (SELECT * FROM src WHERE src.key < 10 order by src.key, src.value) src1
     JOIN 
-  (SELECT * FROM src WHERE src.key < 10) src2
+  (SELECT * FROM src WHERE src.key < 10 order by src.key, src.value) src2
   SORT BY k1, v1, k2, v2
 ) a;
diff --git a/ql/src/test/queries/clientpositive/auto_join1.q b/ql/src/test/queries/clientpositive/auto_join1.q
index 2062a28b46..7414005ab6 100644
--- a/ql/src/test/queries/clientpositive/auto_join1.q
+++ b/ql/src/test/queries/clientpositive/auto_join1.q
@@ -1,5 +1,7 @@
 set hive.auto.convert.join =true;
 
+-- SORT_QUERY_RESULTS
+
 CREATE TABLE dest_j1(key INT, value STRING) STORED AS TEXTFILE;
 
 explain
diff --git a/ql/src/test/queries/clientpositive/auto_sortmerge_join_5.q b/ql/src/test/queries/clientpositive/auto_sortmerge_join_5.q
index 98d6df9b19..75c930c066 100644
--- a/ql/src/test/queries/clientpositive/auto_sortmerge_join_5.q
+++ b/ql/src/test/queries/clientpositive/auto_sortmerge_join_5.q
@@ -1,4 +1,7 @@
 -- small no part, 4 bucket & big no part, 2 bucket
+
+-- SORT_QUERY_RESULTS
+
 CREATE TABLE bucket_small (key string, value string) CLUSTERED BY (key) SORTED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE;
 load data local inpath '../../data/files/smallsrcsortbucket1outof4.txt' INTO TABLE bucket_small;
 load data local inpath '../../data/files/smallsrcsortbucket2outof4.txt' INTO TABLE bucket_small;
diff --git a/ql/src/test/queries/clientpositive/cbo_gby.q b/ql/src/test/queries/clientpositive/cbo_gby.q
index e0eed08071..73c8c6a12e 100644
--- a/ql/src/test/queries/clientpositive/cbo_gby.q
+++ b/ql/src/test/queries/clientpositive/cbo_gby.q
@@ -4,8 +4,11 @@ set hive.exec.check.crossproducts=false;
 set hive.stats.fetch.column.stats=true;
 set hive.auto.convert.join=false;
 
+-- SORT_QUERY_RESULTS
+
 -- 6. Test Select + TS + Join + Fil + GB + GB Having
 select key, (c_int+1)+2 as x, sum(c_int) from cbo_t1 group by c_float, cbo_t1.c_int, key;
+
 select x, y, count(*) from (select key, (c_int+c_float+1+2) as x, sum(c_int) as y from cbo_t1 group by c_float, cbo_t1.c_int, key) R group by y, x;
 
 select cbo_t3.c_int, c, count(*) from (select key as a, c_int+1 as b, sum(c_int) as c from cbo_t1 where (cbo_t1.c_int + 1 >= 0) and (cbo_t1.c_int > 0 or cbo_t1.c_float >= 0) group by c_float, cbo_t1.c_int, key order by a) cbo_t1 join (select key as p, c_int+1 as q, sum(c_int) as r from cbo_t2 where (cbo_t2.c_int + 1 >= 0) and (cbo_t2.c_int > 0 or cbo_t2.c_float >= 0)  group by c_float, cbo_t2.c_int, key order by q/10 desc, r asc) cbo_t2 on cbo_t1.a=p join cbo_t3 on cbo_t1.a=key where (b + cbo_t2.q >= 0) and (b > 0 or c_int >= 0) group by cbo_t3.c_int, c order by cbo_t3.c_int+c desc, c;
diff --git a/ql/src/test/queries/clientpositive/cbo_udf_udaf.q b/ql/src/test/queries/clientpositive/cbo_udf_udaf.q
index 093bcc9c9b..16d9bb9997 100644
--- a/ql/src/test/queries/clientpositive/cbo_udf_udaf.q
+++ b/ql/src/test/queries/clientpositive/cbo_udf_udaf.q
@@ -4,6 +4,8 @@ set hive.exec.check.crossproducts=false;
 set hive.stats.fetch.column.stats=true;
 set hive.auto.convert.join=false;
 
+-- SORT_QUERY_RESULTS
+
 -- 8. Test UDF/UDAF
 select count(*), count(c_int), sum(c_int), avg(c_int), max(c_int), min(c_int) from cbo_t1;
 select count(*), count(c_int) as a, sum(c_int), avg(c_int), max(c_int), min(c_int), case c_int when 0  then 1 when 1 then 2 else 3 end, sum(case c_int when 0  then 1 when 1 then 2 else 3 end) from cbo_t1 group by c_int order by a;
diff --git a/ql/src/test/queries/clientpositive/cbo_windowing.q b/ql/src/test/queries/clientpositive/cbo_windowing.q
index fb4fe56f34..4ccc891adb 100644
--- a/ql/src/test/queries/clientpositive/cbo_windowing.q
+++ b/ql/src/test/queries/clientpositive/cbo_windowing.q
@@ -5,6 +5,8 @@ set hive.stats.fetch.column.stats=true;
 set hive.auto.convert.join=false;
 
 -- 9. Test Windowing Functions
+-- SORT_QUERY_RESULTS
+
 select count(c_int) over() from cbo_t1;
 select count(c_int) over(), sum(c_float) over(), max(c_int) over(), min(c_int) over(), row_number() over(), rank() over(), dense_rank() over(), percent_rank() over(), lead(c_int, 2, c_int) over(), lag(c_float, 2, c_float) over() from cbo_t1;
 select * from (select count(c_int) over(), sum(c_float) over(), max(c_int) over(), min(c_int) over(), row_number() over(), rank() over(), dense_rank() over(), percent_rank() over(), lead(c_int, 2, c_int) over(), lag(c_float, 2, c_float) over() from cbo_t1) cbo_t1;
diff --git a/ql/src/test/queries/clientpositive/cross_product_check_1.q b/ql/src/test/queries/clientpositive/cross_product_check_1.q
index fb38c947b3..17a8833de3 100644
--- a/ql/src/test/queries/clientpositive/cross_product_check_1.q
+++ b/ql/src/test/queries/clientpositive/cross_product_check_1.q
@@ -1,3 +1,4 @@
+-- SORT_QUERY_RESULTS
 
 create table A as
 select * from src;
@@ -14,13 +15,13 @@ explain select * from B d1 join B d2 on d1.key = d2.key join A;
 
 explain select * from A join 
          (select d1.key 
-          from B d1 join B d2 on d1.key = d2.key 
+          from B d1 join B d2 on d1.key = d2.key
           where 1 = 1 group by d1.key) od1;
-          
-explain select * from A join (select d1.key from B d1 join B d2 where 1 = 1 group by d1.key) od1;
+
+explain select * from A join (select d1.key from B d1 join B d2 where 1 = 1  group by d1.key) od1;
 
 explain select * from 
-(select A.key from A group by key) ss join 
+(select A.key from A  group by key) ss join
 (select d1.key from B d1 join B d2 on d1.key = d2.key where 1 = 1 group by d1.key) od1;
 
 
diff --git a/ql/src/test/queries/clientpositive/cross_product_check_2.q b/ql/src/test/queries/clientpositive/cross_product_check_2.q
index 479d57137e..de6b7f22b9 100644
--- a/ql/src/test/queries/clientpositive/cross_product_check_2.q
+++ b/ql/src/test/queries/clientpositive/cross_product_check_2.q
@@ -1,8 +1,10 @@
+-- SORT_QUERY_RESULTS
+
 create table A as
 select * from src;
 
 create table B as
-select * from src
+select * from src order by key
 limit 10;
 
 set hive.auto.convert.join=true;
@@ -17,7 +19,7 @@ explain select * from A join
          (select d1.key 
           from B d1 join B d2 on d1.key = d2.key 
           where 1 = 1 group by d1.key) od1;
-          
+
 explain select * from A join (select d1.key from B d1 join B d2 where 1 = 1 group by d1.key) od1;
 
 explain select * from 
diff --git a/ql/src/test/queries/clientpositive/ctas.q b/ql/src/test/queries/clientpositive/ctas.q
index b6de233481..3435d03f46 100644
--- a/ql/src/test/queries/clientpositive/ctas.q
+++ b/ql/src/test/queries/clientpositive/ctas.q
@@ -1,4 +1,5 @@
 -- EXCLUDE_HADOOP_MAJOR_VERSIONS( 0.20S)
+-- SORT_QUERY_RESULTS
 
 create table nzhang_Tmp(a int, b string);
 select * from nzhang_Tmp;
diff --git a/ql/src/test/queries/clientpositive/dynpart_sort_optimization2.q b/ql/src/test/queries/clientpositive/dynpart_sort_optimization2.q
index 70c795d8cf..58319e351c 100644
--- a/ql/src/test/queries/clientpositive/dynpart_sort_optimization2.q
+++ b/ql/src/test/queries/clientpositive/dynpart_sort_optimization2.q
@@ -8,6 +8,8 @@ set hive.enforce.sorting=false;
 set hive.exec.submitviachild=true;
 set hive.exec.submit.local.task.via.child=true;
 
+-- SORT_QUERY_RESULTS
+
 drop table ss;
 drop table ss_orc;
 drop table ss_part;
@@ -223,7 +225,7 @@ select
     "day" `day`
 from src
 group by "day", key;
-select * from hive13_dp1 limit 5;
+select * from hive13_dp1 order by k1, k2 limit 5;
 
 set hive.optimize.sort.dynamic.partition=true;
 explain insert overwrite table `hive13_dp1` partition(`day`)
@@ -241,6 +243,7 @@ select
     "day" `day`
 from src
 group by "day", key;
-select * from hive13_dp1 limit 5;
+
+select * from hive13_dp1 order by k1, k2 limit 5;
 
 drop table hive13_dp1;
diff --git a/ql/src/test/queries/clientpositive/explainuser_2.q b/ql/src/test/queries/clientpositive/explainuser_2.q
index 6e98fa0a11..560a086869 100644
--- a/ql/src/test/queries/clientpositive/explainuser_2.q
+++ b/ql/src/test/queries/clientpositive/explainuser_2.q
@@ -1,6 +1,8 @@
 set hive.explain.user=true;
 set hive.metastore.aggregate.stats.cache.enabled=false;
 
+-- SORT_QUERY_RESULTS
+
 CREATE TABLE dest_j1(key STRING, value STRING, val2 STRING) STORED AS TEXTFILE;
 
 CREATE TABLE ss(k1 STRING,v1 STRING,k2 STRING,v2 STRING,k3 STRING,v3 STRING) STORED AS TEXTFILE;
@@ -81,7 +83,6 @@ SELECT x.key, z.value, y.value
 FROM src1 x JOIN src y ON (x.key = y.key) 
 JOIN (select * from src1 union select * from src)z ON (x.value = z.value);
 
-
 explain
 SELECT x.key, y.value
 FROM src1 x JOIN src y ON (x.key = y.key) 
@@ -100,7 +101,6 @@ set hive.auto.convert.join=true;
 set hive.auto.convert.join.noconditionaltask=true;
 set hive.auto.convert.join.noconditionaltask.size=10000;
 
-
 EXPLAIN
 SELECT x.key, z.value, y.value
 FROM src1 x JOIN src y ON (x.key = y.key) 
@@ -143,7 +143,6 @@ SELECT x.key, z.value, y.value
 FROM src1 x JOIN src y ON (x.key = y.key) 
 JOIN (select * from src1 union select * from src)z ON (x.value = z.value);
 
-
 explain
 SELECT x.key, y.value
 FROM src1 x JOIN src y ON (x.key = y.key) 
@@ -194,7 +193,6 @@ set hive.auto.convert.sortmerge.join = true;
 
 set hive.auto.convert.join.noconditionaltask.size=500;
 
-
 explain 
 select s1.key as key, s1.value as value from tab s1 join tab s3 on s1.key=s3.key;
 
@@ -213,7 +211,6 @@ UNION  ALL
 select s2.key as key, s2.value as value from tab s2
 ) a join tab_part b on (a.key = b.key);
 
-
 explain
 select count(*) from (select s1.key as key, s1.value as value from tab s1 join tab s3 on s1.key=s3.key join tab s2 on s1.value=s2.value
 UNION  ALL
diff --git a/ql/src/test/queries/clientpositive/filter_join_breaktask2.q b/ql/src/test/queries/clientpositive/filter_join_breaktask2.q
index 4c99f7727c..a7b32213c0 100644
--- a/ql/src/test/queries/clientpositive/filter_join_breaktask2.q
+++ b/ql/src/test/queries/clientpositive/filter_join_breaktask2.q
@@ -1,3 +1,5 @@
+-- SORT_QUERY_RESULTS
+
 create table T1(c1 string, c2 string, c3 string, c4 string, c5 string, c6 string, c7 string) 
 partitioned by (ds string);
 
diff --git a/ql/src/test/queries/clientpositive/insert_into1.q b/ql/src/test/queries/clientpositive/insert_into1.q
index f19506abf4..7271a07e41 100644
--- a/ql/src/test/queries/clientpositive/insert_into1.q
+++ b/ql/src/test/queries/clientpositive/insert_into1.q
@@ -1,18 +1,21 @@
 set hive.compute.query.using.stats=true;
+
+-- SORT_QUERY_RESULTS
+
 DROP TABLE insert_into1;
 
 CREATE TABLE insert_into1 (key int, value string);
 
-EXPLAIN INSERT INTO TABLE insert_into1 SELECT * from src LIMIT 100;
-INSERT INTO TABLE insert_into1 SELECT * from src LIMIT 100;
+EXPLAIN INSERT INTO TABLE insert_into1 SELECT * from src ORDER BY key LIMIT 100;
+INSERT INTO TABLE insert_into1 SELECT * from src ORDER BY key LIMIT 100;
 SELECT SUM(HASH(c)) FROM (
     SELECT TRANSFORM(*) USING 'tr \t _' AS (c) FROM insert_into1
 ) t;
 explain 
 select count(*) from insert_into1;
 select count(*) from insert_into1;
-EXPLAIN INSERT INTO TABLE insert_into1 SELECT * FROM src LIMIT 100;
-INSERT INTO TABLE insert_into1 SELECT * FROM src LIMIT 100;
+EXPLAIN INSERT INTO TABLE insert_into1 SELECT * FROM src ORDER BY key LIMIT 100;
+INSERT INTO TABLE insert_into1 SELECT * FROM src ORDER BY key LIMIT 100;
 SELECT SUM(HASH(c)) FROM (
     SELECT TRANSFORM(*) USING 'tr \t _' AS (c) FROM insert_into1
 ) t;
@@ -21,8 +24,8 @@ explain
 SELECT COUNT(*) FROM insert_into1;
 select count(*) from insert_into1;
 
-EXPLAIN INSERT OVERWRITE TABLE insert_into1 SELECT * FROM src LIMIT 10;
-INSERT OVERWRITE TABLE insert_into1 SELECT * FROM src LIMIT 10;
+EXPLAIN INSERT OVERWRITE TABLE insert_into1 SELECT * FROM src ORDER BY key LIMIT 10;
+INSERT OVERWRITE TABLE insert_into1 SELECT * FROM src ORDER BY key LIMIT 10;
 SELECT SUM(HASH(c)) FROM (
     SELECT TRANSFORM(*) USING 'tr \t _' AS (c) FROM insert_into1
 ) t;
diff --git a/ql/src/test/queries/clientpositive/insert_into2.q b/ql/src/test/queries/clientpositive/insert_into2.q
index 1cbe391adf..a53f7f4b20 100644
--- a/ql/src/test/queries/clientpositive/insert_into2.q
+++ b/ql/src/test/queries/clientpositive/insert_into2.q
@@ -4,12 +4,12 @@ CREATE TABLE insert_into2 (key int, value string)
   PARTITIONED BY (ds string);
 
 EXPLAIN INSERT INTO TABLE insert_into2 PARTITION (ds='1') 
-  SELECT * FROM src LIMIT 100;
-INSERT INTO TABLE insert_into2 PARTITION (ds='1') SELECT * FROM src limit 100;
+  SELECT * FROM src order by key LIMIT 100;
+INSERT INTO TABLE insert_into2 PARTITION (ds='1') SELECT * FROM src order by key limit 100;
 explain
 select count (*) from insert_into2 where ds = '1';
 select count (*) from insert_into2 where ds = '1';
-INSERT INTO TABLE insert_into2 PARTITION (ds='1') SELECT * FROM src limit 100;
+INSERT INTO TABLE insert_into2 PARTITION (ds='1') SELECT * FROM src order by key limit 100;
 explain
 SELECT COUNT(*) FROM insert_into2 WHERE ds='1';
 SELECT COUNT(*) FROM insert_into2 WHERE ds='1';
@@ -18,9 +18,9 @@ SELECT SUM(HASH(c)) FROM (
 ) t;
 
 EXPLAIN INSERT OVERWRITE TABLE insert_into2 PARTITION (ds='2')
-  SELECT * FROM src LIMIT 100;
+  SELECT * FROM src order by key LIMIT 100;
 INSERT OVERWRITE TABLE insert_into2 PARTITION (ds='2')
-  SELECT * FROM src LIMIT 100;
+  SELECT * FROM src order by key LIMIT 100;
 
 SELECT SUM(HASH(c)) FROM (
     SELECT TRANSFORM(*) USING 'tr \t _' AS (c) FROM insert_into2
@@ -30,9 +30,9 @@ SELECT COUNT(*) FROM insert_into2 WHERE ds='2';
 SELECT COUNT(*) FROM insert_into2 WHERE ds='2';
 
 EXPLAIN INSERT OVERWRITE TABLE insert_into2 PARTITION (ds='2')
-  SELECT * FROM src LIMIT 50;
+  SELECT * FROM src order by key LIMIT 50;
 INSERT OVERWRITE TABLE insert_into2 PARTITION (ds='2')
-  SELECT * FROM src LIMIT 50;
+  SELECT * FROM src order by key LIMIT 50;
 SELECT SUM(HASH(c)) FROM (
     SELECT TRANSFORM(*) USING 'tr \t _' AS (c) FROM insert_into2
 ) t;
diff --git a/ql/src/test/queries/clientpositive/insert_nonacid_from_acid.q b/ql/src/test/queries/clientpositive/insert_nonacid_from_acid.q
index 1bb2ee3bd3..639cb312a0 100644
--- a/ql/src/test/queries/clientpositive/insert_nonacid_from_acid.q
+++ b/ql/src/test/queries/clientpositive/insert_nonacid_from_acid.q
@@ -2,6 +2,8 @@ set hive.support.concurrency=true;
 set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DbTxnManager;
 set hive.enforce.bucketing=true;
 
+-- SORT_QUERY_RESULTS
+
 -- This test checks that selecting from an acid table and inserting into a non-acid table works.
 create table sample_06(name varchar(50), age int, gpa decimal(3, 2)) clustered by (age) into 2 buckets stored as orc TBLPROPERTIES ("transactional"="true"); 
 insert into table sample_06 values ('aaa', 35, 3.00), ('bbb', 32, 3.00), ('ccc', 32, 3.00), ('ddd', 35, 3.00), ('eee', 32, 3.00); 
diff --git a/ql/src/test/queries/clientpositive/join_merge_multi_expressions.q b/ql/src/test/queries/clientpositive/join_merge_multi_expressions.q
index dcab3130d7..7bbfbc76c4 100644
--- a/ql/src/test/queries/clientpositive/join_merge_multi_expressions.q
+++ b/ql/src/test/queries/clientpositive/join_merge_multi_expressions.q
@@ -1,3 +1,4 @@
+-- SORT_QUERY_RESULTS
 explain
 select count(*) from srcpart a join srcpart b on a.key = b.key and a.hr = b.hr join srcpart c on a.hr = c.hr and a.key = c.key;
 select count(*) from srcpart a join srcpart b on a.key = b.key and a.hr = b.hr join srcpart c on a.hr = c.hr and a.key = c.key;
diff --git a/ql/src/test/queries/clientpositive/join_nullsafe.q b/ql/src/test/queries/clientpositive/join_nullsafe.q
index 78a65d6170..46bbadd105 100644
--- a/ql/src/test/queries/clientpositive/join_nullsafe.q
+++ b/ql/src/test/queries/clientpositive/join_nullsafe.q
@@ -5,6 +5,7 @@ LOAD DATA LOCAL INPATH '../../data/files/in8.txt' INTO TABLE myinput1;
 
 -- merging
 explain select * from myinput1 a join myinput1 b on a.key<=>b.value;
+-- SORT_QUERY_RESULTS
 select * from myinput1 a join myinput1 b on a.key<=>b.value;
 
 explain select * from myinput1 a join myinput1 b on a.key<=>b.value join myinput1 c on a.key=c.key;
@@ -14,6 +15,7 @@ explain select * from myinput1 a join myinput1 b on a.key<=>b.value join myinput
 select * from myinput1 a join myinput1 b on a.key<=>b.value join myinput1 c on a.key<=>c.key;
 
 explain select * from myinput1 a join myinput1 b on a.key<=>b.value AND a.value=b.key join myinput1 c on a.key<=>c.key AND a.value=c.value;
+
 select * from myinput1 a join myinput1 b on a.key<=>b.value AND a.value=b.key join myinput1 c on a.key<=>c.key AND a.value=c.value;
 
 explain select * from myinput1 a join myinput1 b on a.key<=>b.value AND a.value<=>b.key join myinput1 c on a.key<=>c.key AND a.value<=>c.value;
diff --git a/ql/src/test/queries/clientpositive/mapjoin_decimal.q b/ql/src/test/queries/clientpositive/mapjoin_decimal.q
index e0babb9d2d..72998088f5 100644
--- a/ql/src/test/queries/clientpositive/mapjoin_decimal.q
+++ b/ql/src/test/queries/clientpositive/mapjoin_decimal.q
@@ -26,12 +26,12 @@ CREATE TABLE t2(dec decimal(4,0)) STORED AS ORC;
 INSERT INTO TABLE t2 select dec from over1k;
 
 explain
-select t1.dec, t2.dec from t1 join t2 on (t1.dec=t2.dec);
+select t1.dec, t2.dec from t1 join t2 on (t1.dec=t2.dec) order by t1.dec;
 
 set hive.mapjoin.optimized.hashtable=false;
 
-select t1.dec, t2.dec from t1 join t2 on (t1.dec=t2.dec);
+select t1.dec, t2.dec from t1 join t2 on (t1.dec=t2.dec) order by t1.dec;
 
 set hive.mapjoin.optimized.hashtable=true;
 
-select t1.dec, t2.dec from t1 join t2 on (t1.dec=t2.dec);
+select t1.dec, t2.dec from t1 join t2 on (t1.dec=t2.dec) order by t1.dec;
diff --git a/ql/src/test/queries/clientpositive/mrr.q b/ql/src/test/queries/clientpositive/mrr.q
index a3007ffe65..bd379d2ec2 100644
--- a/ql/src/test/queries/clientpositive/mrr.q
+++ b/ql/src/test/queries/clientpositive/mrr.q
@@ -1,4 +1,6 @@
 -- simple query with multiple reduce stages
+-- SORT_QUERY_RESULTS
+
 EXPLAIN SELECT key, count(value) as cnt FROM src GROUP BY key ORDER BY cnt;
 SELECT key, count(value) as cnt FROM src GROUP BY key ORDER BY cnt;
 
diff --git a/ql/src/test/queries/clientpositive/orc_merge1.q b/ql/src/test/queries/clientpositive/orc_merge1.q
index 410ef0be21..1c0bf4185f 100644
--- a/ql/src/test/queries/clientpositive/orc_merge1.q
+++ b/ql/src/test/queries/clientpositive/orc_merge1.q
@@ -10,6 +10,8 @@ set hive.merge.tezfiles=false;
 set hive.merge.mapfiles=false;
 set hive.merge.mapredfiles=false;
 
+-- SORT_QUERY_RESULTS
+
 DROP TABLE orcfile_merge1;
 DROP TABLE orcfile_merge1b;
 DROP TABLE orcfile_merge1c;
diff --git a/ql/src/test/queries/clientpositive/partition_date2.q b/ql/src/test/queries/clientpositive/partition_date2.q
index c932ed1023..51ac2cd44d 100644
--- a/ql/src/test/queries/clientpositive/partition_date2.q
+++ b/ql/src/test/queries/clientpositive/partition_date2.q
@@ -1,3 +1,5 @@
+-- SORT_QUERY_RESULTS
+
 drop table partition_date2_1;
 
 create table partition_date2_1 (key string, value string) partitioned by (dt date, region int);
diff --git a/ql/src/test/queries/clientpositive/script_env_var1.q b/ql/src/test/queries/clientpositive/script_env_var1.q
index 0148905080..77d9945541 100644
--- a/ql/src/test/queries/clientpositive/script_env_var1.q
+++ b/ql/src/test/queries/clientpositive/script_env_var1.q
@@ -1,5 +1,5 @@
 -- Verifies that script operator ID environment variables have unique values
 -- in each instance of the script operator.
 SELECT count(1) FROM
-( SELECT * FROM (SELECT TRANSFORM('echo $HIVE_SCRIPT_OPERATOR_ID') USING 'sh' AS key FROM src LIMIT 1)x UNION ALL
-  SELECT * FROM (SELECT TRANSFORM('echo $HIVE_SCRIPT_OPERATOR_ID') USING 'sh' AS key FROM src LIMIT 1)y ) a GROUP BY key;
+( SELECT * FROM (SELECT TRANSFORM('echo $HIVE_SCRIPT_OPERATOR_ID') USING 'sh' AS key FROM src order by key LIMIT 1)x UNION ALL
+  SELECT * FROM (SELECT TRANSFORM('echo $HIVE_SCRIPT_OPERATOR_ID') USING 'sh' AS key FROM src order by key LIMIT 1)y ) a GROUP BY key;
diff --git a/ql/src/test/queries/clientpositive/selectDistinctStar.q b/ql/src/test/queries/clientpositive/selectDistinctStar.q
index e06f167d5d..300d7e0297 100644
--- a/ql/src/test/queries/clientpositive/selectDistinctStar.q
+++ b/ql/src/test/queries/clientpositive/selectDistinctStar.q
@@ -1,3 +1,5 @@
+-- SORT_QUERY_RESULTS
+
 explain select distinct src.* from src;
 
 select distinct src.* from src;
diff --git a/ql/src/test/queries/clientpositive/skewjoin.q b/ql/src/test/queries/clientpositive/skewjoin.q
index 47535eab63..6d43ea8d48 100644
--- a/ql/src/test/queries/clientpositive/skewjoin.q
+++ b/ql/src/test/queries/clientpositive/skewjoin.q
@@ -1,11 +1,7 @@
 set hive.optimize.skewjoin = true;
 set hive.skewjoin.key = 2;
 
-
-
-
-
-
+-- SORT_QUERY_RESULTS
 
 CREATE TABLE T1(key STRING, val STRING) STORED AS TEXTFILE;
 CREATE TABLE T2(key STRING, val STRING) STORED AS TEXTFILE;
@@ -18,7 +14,6 @@ LOAD DATA LOCAL INPATH '../../data/files/T2.txt' INTO TABLE T2;
 LOAD DATA LOCAL INPATH '../../data/files/T3.txt' INTO TABLE T3;
 LOAD DATA LOCAL INPATH '../../data/files/T1.txt' INTO TABLE T4;
 
-
 EXPLAIN
 FROM src src1 JOIN src src2 ON (src1.key = src2.key)
 INSERT OVERWRITE TABLE dest_j1 SELECT src1.key, src2.value;
@@ -28,7 +23,6 @@ INSERT OVERWRITE TABLE dest_j1 SELECT src1.key, src2.value;
 
 SELECT sum(hash(key)), sum(hash(value)) FROM dest_j1;
 
-
 EXPLAIN
 SELECT /*+ STREAMTABLE(a) */ *
 FROM T1 a JOIN T2 b ON a.key = b.key
@@ -51,7 +45,6 @@ FROM T1 a JOIN T2 b ON a.key = b.key
           JOIN T3 c ON b.key = c.key
           JOIN T4 d ON c.key = d.key;
 
-
 EXPLAIN FROM T1 a JOIN src c ON c.key+1=a.key SELECT /*+ STREAMTABLE(a) */ sum(hash(a.key)), sum(hash(a.val)), sum(hash(c.key));
 FROM T1 a JOIN src c ON c.key+1=a.key SELECT /*+ STREAMTABLE(a) */ sum(hash(a.key)), sum(hash(a.val)), sum(hash(c.key));
 
@@ -69,7 +62,6 @@ JOIN
 ON (x.key = Y.key)
 SELECT sum(hash(Y.key)), sum(hash(Y.value));
 
-
 EXPLAIN FROM 
 (SELECT src.* FROM src) x
 JOIN 
@@ -84,7 +76,6 @@ JOIN
 ON (x.key = Y.key and substring(x.value, 5)=substring(y.value, 5)+1)
 SELECT sum(hash(Y.key)), sum(hash(Y.value));
 
-
 EXPLAIN
 SELECT sum(hash(src1.c1)), sum(hash(src2.c4)) 
 FROM
diff --git a/ql/src/test/queries/clientpositive/subquery_exists.q b/ql/src/test/queries/clientpositive/subquery_exists.q
index b16584e00e..103663eb23 100644
--- a/ql/src/test/queries/clientpositive/subquery_exists.q
+++ b/ql/src/test/queries/clientpositive/subquery_exists.q
@@ -1,6 +1,7 @@
 -- SORT_QUERY_RESULTS
 
 -- no agg, corr
+-- SORT_QUERY_RESULTS
 explain
 select * 
 from src b 
diff --git a/ql/src/test/queries/clientpositive/temp_table.q b/ql/src/test/queries/clientpositive/temp_table.q
index 96670704eb..ac0acb1474 100644
--- a/ql/src/test/queries/clientpositive/temp_table.q
+++ b/ql/src/test/queries/clientpositive/temp_table.q
@@ -7,8 +7,8 @@ CREATE TEMPORARY TABLE bar AS SELECT * FROM src WHERE key % 2 = 1;
 DESCRIBE foo;
 DESCRIBE bar;
 
-explain select * from foo limit 10;
-select * from foo limit 10;
+explain select * from foo order by key limit 10;
+select * from foo order by key limit 10;
 
 explain select * from (select * from foo union all select * from bar) u order by key limit 10;
 select * from (select * from foo union all select * from bar) u order by key limit 10;
@@ -22,7 +22,7 @@ select * from bay;
 
 INSERT OVERWRITE TABLE bay SELECT * FROM src ORDER BY key;
 
-select * from bay limit 10;
+select * from bay order by key limit 10;
 
 SHOW TABLES;
 
diff --git a/ql/src/test/queries/clientpositive/tez_dml.q b/ql/src/test/queries/clientpositive/tez_dml.q
index 87d251f40f..d8480cc782 100644
--- a/ql/src/test/queries/clientpositive/tez_dml.q
+++ b/ql/src/test/queries/clientpositive/tez_dml.q
@@ -1,6 +1,8 @@
 set hive.exec.dynamic.partition.mode=nonstrict;
 
 -- CTAS
+-- SORT_QUERY_RESULTS
+
 EXPLAIN CREATE TABLE tmp_src AS SELECT * FROM (SELECT value, count(value) AS cnt FROM src GROUP BY value) f1 ORDER BY cnt;
 CREATE TABLE tmp_src AS SELECT * FROM (SELECT value, count(value) AS cnt FROM src GROUP BY value) f1 ORDER BY cnt;
 
diff --git a/ql/src/test/queries/clientpositive/tez_join_hash.q b/ql/src/test/queries/clientpositive/tez_join_hash.q
index 67d89f8840..73cd53e918 100644
--- a/ql/src/test/queries/clientpositive/tez_join_hash.q
+++ b/ql/src/test/queries/clientpositive/tez_join_hash.q
@@ -1,3 +1,5 @@
+-- SORT_QUERY_RESULTS
+
 create table orc_src (key string, value string) STORED AS ORC;
 insert into table orc_src select * from src;
 
diff --git a/ql/src/test/queries/clientpositive/tez_joins_explain.q b/ql/src/test/queries/clientpositive/tez_joins_explain.q
index 7d3b8f6aa0..4b6b0ca3c8 100644
--- a/ql/src/test/queries/clientpositive/tez_joins_explain.q
+++ b/ql/src/test/queries/clientpositive/tez_joins_explain.q
@@ -1,5 +1,4 @@
 -- SORT_QUERY_RESULTS
-
 explain
 select * from (select b.key, b.value from src1 a left outer join src b on (a.key = b.key) order by b.key) x right outer join src c on (x.value = c.value) order by x.key;
 
diff --git a/ql/src/test/queries/clientpositive/tez_multi_union.q b/ql/src/test/queries/clientpositive/tez_multi_union.q
index 28fdfea969..9dd3c8da0a 100644
--- a/ql/src/test/queries/clientpositive/tez_multi_union.q
+++ b/ql/src/test/queries/clientpositive/tez_multi_union.q
@@ -1,3 +1,4 @@
+-- SORT_QUERY_RESULTS
 select key from
 (
 select key from src
diff --git a/ql/src/test/queries/clientpositive/tez_schema_evolution.q b/ql/src/test/queries/clientpositive/tez_schema_evolution.q
index 2f1c73f8e5..632878aa25 100644
--- a/ql/src/test/queries/clientpositive/tez_schema_evolution.q
+++ b/ql/src/test/queries/clientpositive/tez_schema_evolution.q
@@ -1,14 +1,16 @@
+-- SORT_QUERY_RESULTS
+
 create table test (key int, value string) partitioned by (p int) stored as textfile;
 
-insert into table test partition (p=1) select * from src limit 10;
+insert into table test partition (p=1) select * from src order by key limit 10;
 
 alter table test set fileformat orc;
 
-insert into table test partition (p=2) select * from src limit 10;
+insert into table test partition (p=2) select * from src order by key limit 10;
 
 describe test;
 
-select * from test where p=1 and key > 0;
-select * from test where p=2 and key > 0;
-select * from test where key > 0;
+select * from test where p=1 and key > 0 order by key;
+select * from test where p=2 and key > 0 order by key;
+select * from test where key > 0 order by key;
 
diff --git a/ql/src/test/queries/clientpositive/update_all_partitioned.q b/ql/src/test/queries/clientpositive/update_all_partitioned.q
index b4079854d9..e191d0ad43 100644
--- a/ql/src/test/queries/clientpositive/update_all_partitioned.q
+++ b/ql/src/test/queries/clientpositive/update_all_partitioned.q
@@ -4,8 +4,8 @@ set hive.enforce.bucketing=true;
 
 create table acid_uap(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true');
 
-insert into table acid_uap partition (ds='today') select cint, cast(cstring1 as varchar(128)) from alltypesorc where cint is not null and cint < 0 order by cint limit 10;
-insert into table acid_uap partition (ds='tomorrow') select cint, cast(cstring1 as varchar(128)) from alltypesorc where cint is not null and cint > 10 order by cint limit 10;
+insert into table acid_uap partition (ds='today') select cint, cast(cstring1 as varchar(128)) as cs from alltypesorc where cint is not null and cint < 0 order by cint, cs limit 10;
+insert into table acid_uap partition (ds='tomorrow') select cint, cast(cstring1 as varchar(128)) as cs from alltypesorc where cint is not null and cint > 10 order by cint, cs limit 10;
 
 select a,b,ds from acid_uap order by a,b;
 
diff --git a/ql/src/test/queries/clientpositive/update_where_partitioned.q b/ql/src/test/queries/clientpositive/update_where_partitioned.q
index 858cebbb70..157712f5e8 100644
--- a/ql/src/test/queries/clientpositive/update_where_partitioned.q
+++ b/ql/src/test/queries/clientpositive/update_where_partitioned.q
@@ -4,8 +4,8 @@ set hive.enforce.bucketing=true;
 
 create table acid_uwp(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true');
 
-insert into table acid_uwp partition (ds='today') select cint, cast(cstring1 as varchar(128)) from alltypesorc where cint is not null and cint < 0 order by cint limit 10;
-insert into table acid_uwp partition (ds='tomorrow') select cint, cast(cstring1 as varchar(128)) from alltypesorc where cint is not null and cint > 100 order by cint limit 10;
+insert into table acid_uwp partition (ds='today') select cint, cast(cstring1 as varchar(128)) as cs from alltypesorc where cint is not null and cint < 0 order by cint, cs limit 10;
+insert into table acid_uwp partition (ds='tomorrow') select cint, cast(cstring1 as varchar(128)) as cs from alltypesorc where cint is not null and cint > 100 order by cint, cs limit 10;
 
 select a,b,ds from acid_uwp order by a, ds, b;
 
diff --git a/ql/src/test/queries/clientpositive/vector_data_types.q b/ql/src/test/queries/clientpositive/vector_data_types.q
index 61356fa661..c7a9c4ca32 100644
--- a/ql/src/test/queries/clientpositive/vector_data_types.q
+++ b/ql/src/test/queries/clientpositive/vector_data_types.q
@@ -36,18 +36,18 @@ INSERT INTO TABLE over1korc SELECT * FROM over1k;
 
 SET hive.vectorized.execution.enabled=false;
 
-EXPLAIN SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY i LIMIT 20;
+EXPLAIN SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY t, si, i LIMIT 20;
 
-SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY i LIMIT 20;
+SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY t, si, i LIMIT 20;
 
 SELECT SUM(HASH(*))
-FROM (SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY i) as q;
+FROM (SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY t, si, i) as q;
 
 SET hive.vectorized.execution.enabled=true;
 
-EXPLAIN select t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY i LIMIT 20;
+EXPLAIN select t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY t, si, i LIMIT 20;
 
-SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY i LIMIT 20;
+SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY t, si, i LIMIT 20;
 
 SELECT SUM(HASH(*))
-FROM (SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY i) as q;
\ No newline at end of file
+FROM (SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY t, si, i) as q;
\ No newline at end of file
diff --git a/ql/src/test/queries/clientpositive/vector_null_projection.q b/ql/src/test/queries/clientpositive/vector_null_projection.q
index 765e45f8bf..bab496ef52 100644
--- a/ql/src/test/queries/clientpositive/vector_null_projection.q
+++ b/ql/src/test/queries/clientpositive/vector_null_projection.q
@@ -1,6 +1,8 @@
 SET hive.vectorized.execution.enabled=true;
 set hive.fetch.task.conversion=none;
 
+-- SORT_QUERY_RESULTS
+
 create table a(s string) stored as orc;
 create table b(s string) stored as orc;
 insert into table a values('aaa');
diff --git a/ql/src/test/queries/clientpositive/vector_outer_join1.q b/ql/src/test/queries/clientpositive/vector_outer_join1.q
index a352cd7aec..5a1aa0bcd0 100644
--- a/ql/src/test/queries/clientpositive/vector_outer_join1.q
+++ b/ql/src/test/queries/clientpositive/vector_outer_join1.q
@@ -1,10 +1,10 @@
 SET hive.vectorized.execution.enabled=true;
 SET hive.auto.convert.join=true;
 
-create table small_alltypesorc1a as select * from alltypesorc where cint is not null and ctinyint is not null limit 5;
-create table small_alltypesorc2a as select * from alltypesorc where cint is null and ctinyint is not null limit 5;
-create table small_alltypesorc3a as select * from alltypesorc where cint is not null and ctinyint is null limit 5;
-create table small_alltypesorc4a as select * from alltypesorc where cint is null and ctinyint is null limit 5;
+create table small_alltypesorc1a as select * from alltypesorc where cint is not null and ctinyint is not null order by cint, ctinyint limit 5;
+create table small_alltypesorc2a as select * from alltypesorc where cint is null and ctinyint is not null order by cint, ctinyint limit 5;
+create table small_alltypesorc3a as select * from alltypesorc where cint is not null and ctinyint is null order by cint, ctinyint limit 5;
+create table small_alltypesorc4a as select * from alltypesorc where cint is null and ctinyint is null order by cint, ctinyint limit 5;
 
 create table small_alltypesorc_a stored as orc as select * from 
 (select * from (select * from small_alltypesorc1a) sq1
diff --git a/ql/src/test/queries/clientpositive/vector_outer_join2.q b/ql/src/test/queries/clientpositive/vector_outer_join2.q
index 76aa2fd129..b3503fda11 100644
--- a/ql/src/test/queries/clientpositive/vector_outer_join2.q
+++ b/ql/src/test/queries/clientpositive/vector_outer_join2.q
@@ -2,10 +2,10 @@ SET hive.vectorized.execution.enabled=true;
 SET hive.auto.convert.join=true;
 SET hive.vectorized.execution.mapjoin.native.enabled=true;
 
-create table small_alltypesorc1a as select * from alltypesorc where cint is not null and ctinyint is not null limit 5;
-create table small_alltypesorc2a as select * from alltypesorc where cint is null and ctinyint is not null limit 5;
-create table small_alltypesorc3a as select * from alltypesorc where cint is not null and ctinyint is null limit 5;
-create table small_alltypesorc4a as select * from alltypesorc where cint is null and ctinyint is null limit 5;
+create table small_alltypesorc1a as select * from alltypesorc where cint is not null and ctinyint is not null order by cint, ctinyint limit 5;
+create table small_alltypesorc2a as select * from alltypesorc where cint is null and ctinyint is not null order by cint, ctinyint limit 5;
+create table small_alltypesorc3a as select * from alltypesorc where cint is not null and ctinyint is null order by cint, ctinyint limit 5;
+create table small_alltypesorc4a as select * from alltypesorc where cint is null and ctinyint is null order by cint, ctinyint limit 5;
 
 create table small_alltypesorc_a stored as orc as select * from 
 (select * from (select * from small_alltypesorc1a) sq1
diff --git a/ql/src/test/queries/clientpositive/vector_outer_join3.q b/ql/src/test/queries/clientpositive/vector_outer_join3.q
index 81161cff34..a612ab078e 100644
--- a/ql/src/test/queries/clientpositive/vector_outer_join3.q
+++ b/ql/src/test/queries/clientpositive/vector_outer_join3.q
@@ -2,10 +2,10 @@ SET hive.vectorized.execution.enabled=true;
 SET hive.auto.convert.join=true;
 SET hive.vectorized.execution.mapjoin.native.enabled=true;
 
-create table small_alltypesorc1a as select * from alltypesorc where cint is not null and ctinyint is not null limit 5;
-create table small_alltypesorc2a as select * from alltypesorc where cint is null and ctinyint is not null limit 5;
-create table small_alltypesorc3a as select * from alltypesorc where cint is not null and ctinyint is null limit 5;
-create table small_alltypesorc4a as select * from alltypesorc where cint is null and ctinyint is null limit 5;
+create table small_alltypesorc1a as select * from alltypesorc where cint is not null and ctinyint is not null order by cint, ctinyint limit 5;
+create table small_alltypesorc2a as select * from alltypesorc where cint is null and ctinyint is not null order by cint, ctinyint limit 5;
+create table small_alltypesorc3a as select * from alltypesorc where cint is not null and ctinyint is null order by cint, ctinyint limit 5;
+create table small_alltypesorc4a as select * from alltypesorc where cint is null and ctinyint is null order by cint, ctinyint limit 5;
 
 create table small_alltypesorc_a stored as orc as select * from 
 (select * from (select * from small_alltypesorc1a) sq1
diff --git a/ql/src/test/queries/clientpositive/vectorization_part_project.q b/ql/src/test/queries/clientpositive/vectorization_part_project.q
index c68ce56fd4..e925ea891d 100644
--- a/ql/src/test/queries/clientpositive/vectorization_part_project.q
+++ b/ql/src/test/queries/clientpositive/vectorization_part_project.q
@@ -1,7 +1,7 @@
 SET hive.vectorized.execution.enabled=true;
 CREATE TABLE alltypesorc_part(ctinyint tinyint, csmallint smallint, cint int, cbigint bigint, cfloat float, cdouble double, cstring1 string, cstring2 string, ctimestamp1 timestamp, ctimestamp2 timestamp, cboolean1 boolean, cboolean2 boolean) partitioned by (ds string) STORED AS ORC;
-insert overwrite table alltypesorc_part partition (ds='2011') select * from alltypesorc limit 100;
-insert overwrite table alltypesorc_part partition (ds='2012') select * from alltypesorc limit 100;
+insert overwrite table alltypesorc_part partition (ds='2011') select * from alltypesorc order by ctinyint, cint, cbigint limit 100;
+insert overwrite table alltypesorc_part partition (ds='2012') select * from alltypesorc order by ctinyint, cint, cbigint limit 100;
 
 explain select (cdouble+2) c1 from alltypesorc_part order by c1 limit 10;
 select (cdouble+2) c1 from alltypesorc_part order by c1 limit 10;
diff --git a/ql/src/test/queries/clientpositive/vectorized_distinct_gby.q b/ql/src/test/queries/clientpositive/vectorized_distinct_gby.q
index 6e622007e5..2553e9fc56 100644
--- a/ql/src/test/queries/clientpositive/vectorized_distinct_gby.q
+++ b/ql/src/test/queries/clientpositive/vectorized_distinct_gby.q
@@ -3,7 +3,7 @@ SET hive.vectorized.execution.enabled=true;
 SET hive.map.groupby.sorted=true;
 
 create table dtest(a int, b int) clustered by (a) sorted by (a) into 1 buckets stored as orc;
-insert into table dtest select c,b from (select array(300,300,300,300,300) as a, 1 as b from src limit 1) y lateral view  explode(a) t1 as c;
+insert into table dtest select c,b from (select array(300,300,300,300,300) as a, 1 as b from src order by a limit 1) y lateral view  explode(a) t1 as c;
 
 explain select sum(distinct a), count(distinct a) from dtest;
 select sum(distinct a), count(distinct a) from dtest;
diff --git a/ql/src/test/queries/clientpositive/vectorized_mapjoin.q b/ql/src/test/queries/clientpositive/vectorized_mapjoin.q
index e5e15abb02..10277e5c04 100644
--- a/ql/src/test/queries/clientpositive/vectorized_mapjoin.q
+++ b/ql/src/test/queries/clientpositive/vectorized_mapjoin.q
@@ -3,6 +3,8 @@ SET hive.auto.convert.join=true;
 SET hive.auto.convert.join.noconditionaltask=true;
 SET hive.auto.convert.join.noconditionaltask.size=1000000000;
 
+-- SORT_QUERY_RESULTS
+
 EXPLAIN SELECT COUNT(t1.cint), MAX(t2.cint), MIN(t1.cint), AVG(t1.cint+t2.cint)
   FROM alltypesorc t1
   JOIN alltypesorc t2 ON t1.cint = t2.cint;
diff --git a/ql/src/test/queries/clientpositive/vectorized_nested_mapjoin.q b/ql/src/test/queries/clientpositive/vectorized_nested_mapjoin.q
index e7e4b3340d..ebf5902c92 100644
--- a/ql/src/test/queries/clientpositive/vectorized_nested_mapjoin.q
+++ b/ql/src/test/queries/clientpositive/vectorized_nested_mapjoin.q
@@ -3,6 +3,8 @@ SET hive.auto.convert.join=true;
 SET hive.auto.convert.join.noconditionaltask=true;
 SET hive.auto.convert.join.noconditionaltask.size=1000000000;
 
+-- SORT_QUERY_RESULTS
+
 explain select sum(t1.td) from (select  v1.csmallint as tsi, v1.cdouble as td from alltypesorc v1, alltypesorc v2 where v1.ctinyint=v2.ctinyint) t1 join alltypesorc v3 on t1.tsi=v3.csmallint;
 
 select sum(t1.td) from (select  v1.csmallint as tsi, v1.cdouble as td from alltypesorc v1, alltypesorc v2 where v1.ctinyint=v2.ctinyint) t1 join alltypesorc v3 on t1.tsi=v3.csmallint;
diff --git a/ql/src/test/queries/clientpositive/vectorized_rcfile_columnar.q b/ql/src/test/queries/clientpositive/vectorized_rcfile_columnar.q
index 488d2f3885..dc124b180b 100644
--- a/ql/src/test/queries/clientpositive/vectorized_rcfile_columnar.q
+++ b/ql/src/test/queries/clientpositive/vectorized_rcfile_columnar.q
@@ -9,7 +9,7 @@ STORED AS
   OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.RCFileOutputFormat';
 
 FROM src
-INSERT OVERWRITE TABLE columnTable SELECT src.key, src.value LIMIT 10;
+INSERT OVERWRITE TABLE columnTable SELECT src.key, src.value ORDER BY src.key, src.value LIMIT 10;
 describe columnTable;
 
 SET hive.vectorized.execution.enabled=true;
diff --git a/ql/src/test/queries/clientpositive/vectorized_shufflejoin.q b/ql/src/test/queries/clientpositive/vectorized_shufflejoin.q
index 6b60aa08c5..c9851d2ed6 100644
--- a/ql/src/test/queries/clientpositive/vectorized_shufflejoin.q
+++ b/ql/src/test/queries/clientpositive/vectorized_shufflejoin.q
@@ -1,10 +1,12 @@
 SET hive.vectorized.execution.enabled=true;
 SET hive.auto.convert.join=false;
 
-EXPLAIN SELECT COUNT(t1.cint), MAX(t2.cint), MIN(t1.cint), AVG(t1.cint+t2.cint)
+-- SORT_QUERY_RESULTS
+
+EXPLAIN SELECT COUNT(t1.cint) AS CNT, MAX(t2.cint) , MIN(t1.cint), AVG(t1.cint+t2.cint)
   FROM alltypesorc t1
-  JOIN alltypesorc t2 ON t1.cint = t2.cint;
+  JOIN alltypesorc t2 ON t1.cint = t2.cint order by CNT;
 
-SELECT COUNT(t1.cint), MAX(t2.cint), MIN(t1.cint), AVG(t1.cint+t2.cint)
+SELECT COUNT(t1.cint), MAX(t2.cint) AS CNT, MIN(t1.cint), AVG(t1.cint+t2.cint)
   FROM alltypesorc t1
-  JOIN alltypesorc t2 ON t1.cint = t2.cint;  
\ No newline at end of file
+  JOIN alltypesorc t2 ON t1.cint = t2.cint order by CNT;
\ No newline at end of file
diff --git a/ql/src/test/queries/clientpositive/vectorized_timestamp_funcs.q b/ql/src/test/queries/clientpositive/vectorized_timestamp_funcs.q
index a6b77614d8..c27697ad8d 100644
--- a/ql/src/test/queries/clientpositive/vectorized_timestamp_funcs.q
+++ b/ql/src/test/queries/clientpositive/vectorized_timestamp_funcs.q
@@ -7,9 +7,10 @@ CREATE TABLE alltypesorc_string(ctimestamp1 timestamp, stimestamp1 string) STORE
 
 INSERT OVERWRITE TABLE alltypesorc_string
 SELECT
-  to_utc_timestamp(ctimestamp1, 'America/Los_Angeles'),
-  CAST(to_utc_timestamp(ctimestamp1, 'America/Los_Angeles') AS STRING)
+  to_utc_timestamp(ctimestamp1, 'America/Los_Angeles') AS toutc,
+  CAST(to_utc_timestamp(ctimestamp1, 'America/Los_Angeles') AS STRING) as cst
 FROM alltypesorc
+ORDER BY toutc, cst
 LIMIT 40;
 
 SET hive.vectorized.execution.enabled = true;
diff --git a/ql/src/test/results/clientpositive/alter_merge_2_orc.q.out b/ql/src/test/results/clientpositive/alter_merge_2_orc.q.out
index 1ccae8e944..7e30942696 100644
--- a/ql/src/test/results/clientpositive/alter_merge_2_orc.q.out
+++ b/ql/src/test/results/clientpositive/alter_merge_2_orc.q.out
@@ -31,31 +31,31 @@ ds                  	string
 ts                  	string              	                    
 	 	 
 #### A masked pattern was here ####
-PREHOOK: query: insert overwrite table src_orc_merge_test_part partition(ds='2012-01-03', ts='2012-01-03+14:46:31') select * from src
+PREHOOK: query: insert overwrite table src_orc_merge_test_part partition(ds='2012-01-03', ts='2012-01-03+14:46:31') select * from src order by key, value
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
 PREHOOK: Output: default@src_orc_merge_test_part@ds=2012-01-03/ts=2012-01-03+14%3A46%3A31
-POSTHOOK: query: insert overwrite table src_orc_merge_test_part partition(ds='2012-01-03', ts='2012-01-03+14:46:31') select * from src
+POSTHOOK: query: insert overwrite table src_orc_merge_test_part partition(ds='2012-01-03', ts='2012-01-03+14:46:31') select * from src order by key, value
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 POSTHOOK: Output: default@src_orc_merge_test_part@ds=2012-01-03/ts=2012-01-03+14%3A46%3A31
 POSTHOOK: Lineage: src_orc_merge_test_part PARTITION(ds=2012-01-03,ts=2012-01-03+14:46:31).key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: src_orc_merge_test_part PARTITION(ds=2012-01-03,ts=2012-01-03+14:46:31).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
-PREHOOK: query: insert into table src_orc_merge_test_part partition(ds='2012-01-03', ts='2012-01-03+14:46:31') select * from src limit 100
+PREHOOK: query: insert into table src_orc_merge_test_part partition(ds='2012-01-03', ts='2012-01-03+14:46:31') select * from src order by key, value limit 100
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
 PREHOOK: Output: default@src_orc_merge_test_part@ds=2012-01-03/ts=2012-01-03+14%3A46%3A31
-POSTHOOK: query: insert into table src_orc_merge_test_part partition(ds='2012-01-03', ts='2012-01-03+14:46:31') select * from src limit 100
+POSTHOOK: query: insert into table src_orc_merge_test_part partition(ds='2012-01-03', ts='2012-01-03+14:46:31') select * from src order by key, value limit 100
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 POSTHOOK: Output: default@src_orc_merge_test_part@ds=2012-01-03/ts=2012-01-03+14%3A46%3A31
 POSTHOOK: Lineage: src_orc_merge_test_part PARTITION(ds=2012-01-03,ts=2012-01-03+14:46:31).key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: src_orc_merge_test_part PARTITION(ds=2012-01-03,ts=2012-01-03+14:46:31).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
-PREHOOK: query: insert into table src_orc_merge_test_part partition(ds='2012-01-03', ts='2012-01-03+14:46:31') select * from src limit 10
+PREHOOK: query: insert into table src_orc_merge_test_part partition(ds='2012-01-03', ts='2012-01-03+14:46:31') select * from src order by key, value limit 10
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
 PREHOOK: Output: default@src_orc_merge_test_part@ds=2012-01-03/ts=2012-01-03+14%3A46%3A31
-POSTHOOK: query: insert into table src_orc_merge_test_part partition(ds='2012-01-03', ts='2012-01-03+14:46:31') select * from src limit 10
+POSTHOOK: query: insert into table src_orc_merge_test_part partition(ds='2012-01-03', ts='2012-01-03+14:46:31') select * from src order by key, value limit 10
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 POSTHOOK: Output: default@src_orc_merge_test_part@ds=2012-01-03/ts=2012-01-03+14%3A46%3A31
@@ -82,7 +82,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src_orc_merge_test_part
 POSTHOOK: Input: default@src_orc_merge_test_part@ds=2012-01-03/ts=2012-01-03+14%3A46%3A31
 #### A masked pattern was here ####
-159653	47778930280
+143807	50348357904
 PREHOOK: query: alter table src_orc_merge_test_part partition (ds='2012-01-03', ts='2012-01-03+14:46:31') concatenate
 PREHOOK: type: ALTER_PARTITION_MERGE
 PREHOOK: Input: default@src_orc_merge_test_part
@@ -112,7 +112,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src_orc_merge_test_part
 POSTHOOK: Input: default@src_orc_merge_test_part@ds=2012-01-03/ts=2012-01-03+14%3A46%3A31
 #### A masked pattern was here ####
-159653	47778930280
+143807	50348357904
 PREHOOK: query: drop table src_orc_merge_test_part
 PREHOOK: type: DROPTABLE
 PREHOOK: Input: default@src_orc_merge_test_part
diff --git a/ql/src/test/results/clientpositive/auto_join0.q.out b/ql/src/test/results/clientpositive/auto_join0.q.out
index b0118cec49..10859b8d04 100644
--- a/ql/src/test/results/clientpositive/auto_join0.q.out
+++ b/ql/src/test/results/clientpositive/auto_join0.q.out
@@ -1,41 +1,49 @@
-Warning: Map Join MAPJOIN[24][bigTable=?] in task 'Stage-2:MAPRED' is a cross product
-PREHOOK: query: explain 
+Warning: Map Join MAPJOIN[45][bigTable=?] in task 'Stage-7:MAPRED' is a cross product
+Warning: Map Join MAPJOIN[38][bigTable=?] in task 'Stage-6:MAPRED' is a cross product
+Warning: Shuffle Join JOIN[12][tables = [src1, src2]] in Stage 'Stage-2:MAPRED' is a cross product
+PREHOOK: query: -- SORT_QUERY_RESULTS
+
+explain 
 select sum(hash(a.k1,a.v1,a.k2, a.v2))
 from (
 SELECT src1.key as k1, src1.value as v1, 
        src2.key as k2, src2.value as v2 FROM 
-  (SELECT * FROM src WHERE src.key < 10) src1 
+  (SELECT * FROM src WHERE src.key < 10 order by src.key, src.value) src1
     JOIN 
-  (SELECT * FROM src WHERE src.key < 10) src2
+  (SELECT * FROM src WHERE src.key < 10 order by src.key, src.value) src2
   SORT BY k1, v1, k2, v2
 ) a
 PREHOOK: type: QUERY
-POSTHOOK: query: explain 
+POSTHOOK: query: -- SORT_QUERY_RESULTS
+
+explain 
 select sum(hash(a.k1,a.v1,a.k2, a.v2))
 from (
 SELECT src1.key as k1, src1.value as v1, 
        src2.key as k2, src2.value as v2 FROM 
-  (SELECT * FROM src WHERE src.key < 10) src1 
+  (SELECT * FROM src WHERE src.key < 10 order by src.key, src.value) src1
     JOIN 
-  (SELECT * FROM src WHERE src.key < 10) src2
+  (SELECT * FROM src WHERE src.key < 10 order by src.key, src.value) src2
   SORT BY k1, v1, k2, v2
 ) a
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
-  Stage-6 is a root stage
-  Stage-2 depends on stages: Stage-6
-  Stage-3 depends on stages: Stage-2
-  Stage-0 depends on stages: Stage-3
+  Stage-1 is a root stage
+  Stage-8 depends on stages: Stage-1, Stage-5 , consists of Stage-9, Stage-10, Stage-2
+  Stage-9 has a backup stage: Stage-2
+  Stage-6 depends on stages: Stage-9
+  Stage-3 depends on stages: Stage-2, Stage-6, Stage-7
+  Stage-4 depends on stages: Stage-3
+  Stage-10 has a backup stage: Stage-2
+  Stage-7 depends on stages: Stage-10
+  Stage-2
+  Stage-5 is a root stage
+  Stage-0 depends on stages: Stage-4
 
 STAGE PLANS:
-  Stage: Stage-6
-    Map Reduce Local Work
-      Alias -> Map Local Tables:
-        a:src1:src 
-          Fetch Operator
-            limit: -1
-      Alias -> Map Local Operator Tree:
-        a:src1:src 
+  Stage: Stage-1
+    Map Reduce
+      Map Operator Tree:
           TableScan
             alias: src
             Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
@@ -46,38 +54,68 @@ STAGE PLANS:
                 expressions: key (type: string), value (type: string)
                 outputColumnNames: _col0, _col1
                 Statistics: Num rows: 166 Data size: 1763 Basic stats: COMPLETE Column stats: NONE
-                HashTable Sink Operator
-                  keys:
-                    0 
-                    1 
+                Reduce Output Operator
+                  key expressions: _col0 (type: string), _col1 (type: string)
+                  sort order: ++
+                  Statistics: Num rows: 166 Data size: 1763 Basic stats: COMPLETE Column stats: NONE
+      Reduce Operator Tree:
+        Select Operator
+          expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string)
+          outputColumnNames: _col0, _col1
+          Statistics: Num rows: 166 Data size: 1763 Basic stats: COMPLETE Column stats: NONE
+          File Output Operator
+            compressed: false
+            table:
+                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
 
-  Stage: Stage-2
+  Stage: Stage-8
+    Conditional Operator
+
+  Stage: Stage-9
+    Map Reduce Local Work
+      Alias -> Map Local Tables:
+        a:$INTNAME1 
+          Fetch Operator
+            limit: -1
+      Alias -> Map Local Operator Tree:
+        a:$INTNAME1 
+          TableScan
+            HashTable Sink Operator
+              keys:
+                0 
+                1 
+
+  Stage: Stage-6
     Map Reduce
       Map Operator Tree:
           TableScan
-            alias: src
-            Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
-            Filter Operator
-              predicate: (key < 10) (type: boolean)
-              Statistics: Num rows: 166 Data size: 1763 Basic stats: COMPLETE Column stats: NONE
-              Select Operator
-                expressions: key (type: string), value (type: string)
-                outputColumnNames: _col0, _col1
-                Statistics: Num rows: 166 Data size: 1763 Basic stats: COMPLETE Column stats: NONE
-                Map Join Operator
-                  condition map:
-                       Inner Join 0 to 1
-                  keys:
-                    0 
-                    1 
-                  outputColumnNames: _col0, _col1, _col2, _col3
-                  Statistics: Num rows: 182 Data size: 1939 Basic stats: COMPLETE Column stats: NONE
-                  Reduce Output Operator
-                    key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string)
-                    sort order: ++++
-                    Statistics: Num rows: 182 Data size: 1939 Basic stats: COMPLETE Column stats: NONE
+            Map Join Operator
+              condition map:
+                   Inner Join 0 to 1
+              keys:
+                0 
+                1 
+              outputColumnNames: _col0, _col1, _col2, _col3
+              Statistics: Num rows: 182 Data size: 1939 Basic stats: COMPLETE Column stats: NONE
+              File Output Operator
+                compressed: false
+                table:
+                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
       Local Work:
         Map Reduce Local Work
+
+  Stage: Stage-3
+    Map Reduce
+      Map Operator Tree:
+          TableScan
+            Reduce Output Operator
+              key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string)
+              sort order: ++++
+              Statistics: Num rows: 182 Data size: 1939 Basic stats: COMPLETE Column stats: NONE
       Reduce Operator Tree:
         Select Operator
           expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), KEY.reducesinkkey2 (type: string), KEY.reducesinkkey3 (type: string)
@@ -95,7 +133,7 @@ STAGE PLANS:
                   output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                   serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
 
-  Stage: Stage-3
+  Stage: Stage-4
     Map Reduce
       Map Operator Tree:
           TableScan
@@ -117,20 +155,115 @@ STAGE PLANS:
                 output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                 serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
 
+  Stage: Stage-10
+    Map Reduce Local Work
+      Alias -> Map Local Tables:
+        a:$INTNAME 
+          Fetch Operator
+            limit: -1
+      Alias -> Map Local Operator Tree:
+        a:$INTNAME 
+          TableScan
+            HashTable Sink Operator
+              keys:
+                0 
+                1 
+
+  Stage: Stage-7
+    Map Reduce
+      Map Operator Tree:
+          TableScan
+            Map Join Operator
+              condition map:
+                   Inner Join 0 to 1
+              keys:
+                0 
+                1 
+              outputColumnNames: _col0, _col1, _col2, _col3
+              Statistics: Num rows: 182 Data size: 1939 Basic stats: COMPLETE Column stats: NONE
+              File Output Operator
+                compressed: false
+                table:
+                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+                    serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
+      Local Work:
+        Map Reduce Local Work
+
+  Stage: Stage-2
+    Map Reduce
+      Map Operator Tree:
+          TableScan
+            Reduce Output Operator
+              sort order: 
+              Statistics: Num rows: 166 Data size: 1763 Basic stats: COMPLETE Column stats: NONE
+              value expressions: _col0 (type: string), _col1 (type: string)
+          TableScan
+            Reduce Output Operator
+              sort order: 
+              Statistics: Num rows: 166 Data size: 1763 Basic stats: COMPLETE Column stats: NONE
+              value expressions: _col0 (type: string), _col1 (type: string)
+      Reduce Operator Tree:
+        Join Operator
+          condition map:
+               Inner Join 0 to 1
+          keys:
+            0 
+            1 
+          outputColumnNames: _col0, _col1, _col2, _col3
+          Statistics: Num rows: 182 Data size: 1939 Basic stats: COMPLETE Column stats: NONE
+          File Output Operator
+            compressed: false
+            table:
+                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
+
+  Stage: Stage-5
+    Map Reduce
+      Map Operator Tree:
+          TableScan
+            alias: src
+            Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
+            Filter Operator
+              predicate: (key < 10) (type: boolean)
+              Statistics: Num rows: 166 Data size: 1763 Basic stats: COMPLETE Column stats: NONE
+              Select Operator
+                expressions: key (type: string), value (type: string)
+                outputColumnNames: _col0, _col1
+                Statistics: Num rows: 166 Data size: 1763 Basic stats: COMPLETE Column stats: NONE
+                Reduce Output Operator
+                  key expressions: _col0 (type: string), _col1 (type: string)
+                  sort order: ++
+                  Statistics: Num rows: 166 Data size: 1763 Basic stats: COMPLETE Column stats: NONE
+      Reduce Operator Tree:
+        Select Operator
+          expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string)
+          outputColumnNames: _col0, _col1
+          Statistics: Num rows: 166 Data size: 1763 Basic stats: COMPLETE Column stats: NONE
+          File Output Operator
+            compressed: false
+            table:
+                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
+
   Stage: Stage-0
     Fetch Operator
       limit: -1
       Processor Tree:
         ListSink
 
-Warning: Map Join MAPJOIN[24][bigTable=?] in task 'Stage-2:MAPRED' is a cross product
+Warning: Map Join MAPJOIN[45][bigTable=?] in task 'Stage-7:MAPRED' is a cross product
+Warning: Map Join MAPJOIN[38][bigTable=?] in task 'Stage-6:MAPRED' is a cross product
+Warning: Shuffle Join JOIN[12][tables = [src1, src2]] in Stage 'Stage-2:MAPRED' is a cross product
 PREHOOK: query: select sum(hash(a.k1,a.v1,a.k2, a.v2))
 from (
 SELECT src1.key as k1, src1.value as v1, 
        src2.key as k2, src2.value as v2 FROM 
-  (SELECT * FROM src WHERE src.key < 10) src1 
+  (SELECT * FROM src WHERE src.key < 10 order by src.key, src.value) src1
     JOIN 
-  (SELECT * FROM src WHERE src.key < 10) src2
+  (SELECT * FROM src WHERE src.key < 10 order by src.key, src.value) src2
   SORT BY k1, v1, k2, v2
 ) a
 PREHOOK: type: QUERY
@@ -140,9 +273,9 @@ POSTHOOK: query: select sum(hash(a.k1,a.v1,a.k2, a.v2))
 from (
 SELECT src1.key as k1, src1.value as v1, 
        src2.key as k2, src2.value as v2 FROM 
-  (SELECT * FROM src WHERE src.key < 10) src1 
+  (SELECT * FROM src WHERE src.key < 10 order by src.key, src.value) src1
     JOIN 
-  (SELECT * FROM src WHERE src.key < 10) src2
+  (SELECT * FROM src WHERE src.key < 10 order by src.key, src.value) src2
   SORT BY k1, v1, k2, v2
 ) a
 POSTHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/auto_join1.q.out b/ql/src/test/results/clientpositive/auto_join1.q.out
index 5fb0b6f0db..48ad641788 100644
--- a/ql/src/test/results/clientpositive/auto_join1.q.out
+++ b/ql/src/test/results/clientpositive/auto_join1.q.out
@@ -1,8 +1,12 @@
-PREHOOK: query: CREATE TABLE dest_j1(key INT, value STRING) STORED AS TEXTFILE
+PREHOOK: query: -- SORT_QUERY_RESULTS
+
+CREATE TABLE dest_j1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@dest_j1
-POSTHOOK: query: CREATE TABLE dest_j1(key INT, value STRING) STORED AS TEXTFILE
+POSTHOOK: query: -- SORT_QUERY_RESULTS
+
+CREATE TABLE dest_j1(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@dest_j1
diff --git a/ql/src/test/results/clientpositive/auto_sortmerge_join_5.q.out b/ql/src/test/results/clientpositive/auto_sortmerge_join_5.q.out
index 3c2951a6d5..230158b675 100644
--- a/ql/src/test/results/clientpositive/auto_sortmerge_join_5.q.out
+++ b/ql/src/test/results/clientpositive/auto_sortmerge_join_5.q.out
@@ -1,9 +1,15 @@
 PREHOOK: query: -- small no part, 4 bucket & big no part, 2 bucket
+
+-- SORT_QUERY_RESULTS
+
 CREATE TABLE bucket_small (key string, value string) CLUSTERED BY (key) SORTED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@bucket_small
 POSTHOOK: query: -- small no part, 4 bucket & big no part, 2 bucket
+
+-- SORT_QUERY_RESULTS
+
 CREATE TABLE bucket_small (key string, value string) CLUSTERED BY (key) SORTED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/cbo_gby.q.out b/ql/src/test/results/clientpositive/cbo_gby.q.out
index 3dc89145d7..04597a7bfb 100644
--- a/ql/src/test/results/clientpositive/cbo_gby.q.out
+++ b/ql/src/test/results/clientpositive/cbo_gby.q.out
@@ -1,20 +1,24 @@
-PREHOOK: query: -- 6. Test Select + TS + Join + Fil + GB + GB Having
+PREHOOK: query: -- SORT_QUERY_RESULTS
+
+-- 6. Test Select + TS + Join + Fil + GB + GB Having
 select key, (c_int+1)+2 as x, sum(c_int) from cbo_t1 group by c_float, cbo_t1.c_int, key
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cbo_t1
 PREHOOK: Input: default@cbo_t1@dt=2014
 #### A masked pattern was here ####
-POSTHOOK: query: -- 6. Test Select + TS + Join + Fil + GB + GB Having
+POSTHOOK: query: -- SORT_QUERY_RESULTS
+
+-- 6. Test Select + TS + Join + Fil + GB + GB Having
 select key, (c_int+1)+2 as x, sum(c_int) from cbo_t1 group by c_float, cbo_t1.c_int, key
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@cbo_t1
 POSTHOOK: Input: default@cbo_t1@dt=2014
 #### A masked pattern was here ####
-NULL	NULL	NULL
  1	4	2
  1 	4	2
 1	4	12
 1 	4	2
+NULL	NULL	NULL
 PREHOOK: query: select x, y, count(*) from (select key, (c_int+c_float+1+2) as x, sum(c_int) as y from cbo_t1 group by c_float, cbo_t1.c_int, key) R group by y, x
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cbo_t1
@@ -25,9 +29,9 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@cbo_t1
 POSTHOOK: Input: default@cbo_t1@dt=2014
 #### A masked pattern was here ####
-NULL	NULL	1
-5.0	2	3
 5.0	12	1
+5.0	2	3
+NULL	NULL	1
 PREHOOK: query: select cbo_t3.c_int, c, count(*) from (select key as a, c_int+1 as b, sum(c_int) as c from cbo_t1 where (cbo_t1.c_int + 1 >= 0) and (cbo_t1.c_int > 0 or cbo_t1.c_float >= 0) group by c_float, cbo_t1.c_int, key order by a) cbo_t1 join (select key as p, c_int+1 as q, sum(c_int) as r from cbo_t2 where (cbo_t2.c_int + 1 >= 0) and (cbo_t2.c_int > 0 or cbo_t2.c_float >= 0)  group by c_float, cbo_t2.c_int, key order by q/10 desc, r asc) cbo_t2 on cbo_t1.a=p join cbo_t3 on cbo_t1.a=key where (b + cbo_t2.q >= 0) and (b > 0 or c_int >= 0) group by cbo_t3.c_int, c order by cbo_t3.c_int+c desc, c
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cbo_t1
@@ -80,8 +84,8 @@ POSTHOOK: Input: default@cbo_t2
 POSTHOOK: Input: default@cbo_t2@dt=2014
 POSTHOOK: Input: default@cbo_t3
 #### A masked pattern was here ####
-1	2	6
 1	12	6
+1	2	6
 PREHOOK: query: select cbo_t3.c_int, c, count(*) from (select key as a, c_int+1 as b, sum(c_int) as c from cbo_t1 where (cbo_t1.c_int + 1 >= 0) and (cbo_t1.c_int > 0 or cbo_t1.c_float >= 0)  group by c_float, cbo_t1.c_int, key having cbo_t1.c_float > 0 and (c_int >=1 or c_float >= 1) and (c_int + c_float) >= 0 order by c+a desc) cbo_t1 full outer join (select key as p, c_int+1 as q, sum(c_int) as r from cbo_t2 where (cbo_t2.c_int + 1 >= 0) and (cbo_t2.c_int > 0 or cbo_t2.c_float >= 0)  group by c_float, cbo_t2.c_int, key having cbo_t2.c_float > 0 and (c_int >=1 or c_float >= 1) and (c_int + c_float) >= 0 order by p+q desc, r asc) cbo_t2 on cbo_t1.a=p full outer join cbo_t3 on cbo_t1.a=key where (b + cbo_t2.q >= 0) and (b > 0 or c_int >= 0) group by cbo_t3.c_int, c having cbo_t3.c_int > 0 and (c_int >=1 or c >= 1) and (c_int + c) >= 0 order by cbo_t3.c_int
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cbo_t1
@@ -116,5 +120,5 @@ POSTHOOK: Input: default@cbo_t2
 POSTHOOK: Input: default@cbo_t2@dt=2014
 POSTHOOK: Input: default@cbo_t3
 #### A masked pattern was here ####
-1	2	6
 1	12	6
+1	2	6
diff --git a/ql/src/test/results/clientpositive/cbo_udf_udaf.q.out b/ql/src/test/results/clientpositive/cbo_udf_udaf.q.out
index ded043f626..156d02f31e 100644
--- a/ql/src/test/results/clientpositive/cbo_udf_udaf.q.out
+++ b/ql/src/test/results/clientpositive/cbo_udf_udaf.q.out
@@ -1,10 +1,14 @@
-PREHOOK: query: -- 8. Test UDF/UDAF
+PREHOOK: query: -- SORT_QUERY_RESULTS
+
+-- 8. Test UDF/UDAF
 select count(*), count(c_int), sum(c_int), avg(c_int), max(c_int), min(c_int) from cbo_t1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cbo_t1
 PREHOOK: Input: default@cbo_t1@dt=2014
 #### A masked pattern was here ####
-POSTHOOK: query: -- 8. Test UDF/UDAF
+POSTHOOK: query: -- SORT_QUERY_RESULTS
+
+-- 8. Test UDF/UDAF
 select count(*), count(c_int), sum(c_int), avg(c_int), max(c_int), min(c_int) from cbo_t1
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@cbo_t1
@@ -21,8 +25,8 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@cbo_t1
 POSTHOOK: Input: default@cbo_t1@dt=2014
 #### A masked pattern was here ####
-2	0	NULL	NULL	NULL	NULL	3	6
 18	18	18	1.0	1	1	2	36
+2	0	NULL	NULL	NULL	NULL	3	6
 PREHOOK: query: select * from (select count(*) as a, count(distinct c_int) as b, sum(c_int) as c, avg(c_int) as d, max(c_int) as e, min(c_int) as f from cbo_t1) cbo_t1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cbo_t1
@@ -44,8 +48,8 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@cbo_t1
 POSTHOOK: Input: default@cbo_t1@dt=2014
 #### A masked pattern was here ####
-2	0	NULL	NULL	NULL	NULL	3	6
 18	1	18	1.0	1	1	2	36
+2	0	NULL	NULL	NULL	NULL	3	6
 PREHOOK: query: select f,a,e,b from (select count(*) as a, count(c_int) as b, sum(c_int) as c, avg(c_int) as d, max(c_int) as e, min(c_int) as f from cbo_t1) cbo_t1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cbo_t1
@@ -78,11 +82,11 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@cbo_t1
 POSTHOOK: Input: default@cbo_t1@dt=2014
 #### A masked pattern was here ####
-NULL	0	NULL
-1 	2	1.0
- 1 	2	1.0
  1	2	1.0
+ 1 	2	1.0
 1	12	1.0
+1 	2	1.0
+NULL	0	NULL
 PREHOOK: query: select count(distinct c_int) as a, avg(c_float) from cbo_t1 group by c_float order by a
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cbo_t1
diff --git a/ql/src/test/results/clientpositive/cbo_windowing.q.out b/ql/src/test/results/clientpositive/cbo_windowing.q.out
index 1a274b0839..57201b5784 100644
--- a/ql/src/test/results/clientpositive/cbo_windowing.q.out
+++ b/ql/src/test/results/clientpositive/cbo_windowing.q.out
@@ -1,10 +1,14 @@
 PREHOOK: query: -- 9. Test Windowing Functions
+-- SORT_QUERY_RESULTS
+
 select count(c_int) over() from cbo_t1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cbo_t1
 PREHOOK: Input: default@cbo_t1@dt=2014
 #### A masked pattern was here ####
 POSTHOOK: query: -- 9. Test Windowing Functions
+-- SORT_QUERY_RESULTS
+
 select count(c_int) over() from cbo_t1
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@cbo_t1
@@ -41,14 +45,6 @@ POSTHOOK: Input: default@cbo_t1
 POSTHOOK: Input: default@cbo_t1@dt=2014
 #### A masked pattern was here ####
 18	18.0	1	1	1	1	1	0.0	1	NULL
-18	18.0	1	1	2	1	1	0.0	1	NULL
-18	18.0	1	1	3	1	1	0.0	1	NULL
-18	18.0	1	1	4	1	1	0.0	1	NULL
-18	18.0	1	1	5	1	1	0.0	1	1.0
-18	18.0	1	1	6	1	1	0.0	1	1.0
-18	18.0	1	1	7	1	1	0.0	1	1.0
-18	18.0	1	1	8	1	1	0.0	1	1.0
-18	18.0	1	1	9	1	1	0.0	1	1.0
 18	18.0	1	1	10	1	1	0.0	1	1.0
 18	18.0	1	1	11	1	1	0.0	1	1.0
 18	18.0	1	1	12	1	1	0.0	1	1.0
@@ -59,7 +55,15 @@ POSTHOOK: Input: default@cbo_t1@dt=2014
 18	18.0	1	1	17	1	1	0.0	1	1.0
 18	18.0	1	1	18	1	1	0.0	1	1.0
 18	18.0	1	1	19	1	1	0.0	1	1.0
+18	18.0	1	1	2	1	1	0.0	1	NULL
 18	18.0	1	1	20	1	1	0.0	1	1.0
+18	18.0	1	1	3	1	1	0.0	1	NULL
+18	18.0	1	1	4	1	1	0.0	1	NULL
+18	18.0	1	1	5	1	1	0.0	1	1.0
+18	18.0	1	1	6	1	1	0.0	1	1.0
+18	18.0	1	1	7	1	1	0.0	1	1.0
+18	18.0	1	1	8	1	1	0.0	1	1.0
+18	18.0	1	1	9	1	1	0.0	1	1.0
 PREHOOK: query: select * from (select count(c_int) over(), sum(c_float) over(), max(c_int) over(), min(c_int) over(), row_number() over(), rank() over(), dense_rank() over(), percent_rank() over(), lead(c_int, 2, c_int) over(), lag(c_float, 2, c_float) over() from cbo_t1) cbo_t1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cbo_t1
@@ -71,14 +75,6 @@ POSTHOOK: Input: default@cbo_t1
 POSTHOOK: Input: default@cbo_t1@dt=2014
 #### A masked pattern was here ####
 18	18.0	1	1	1	1	1	0.0	1	NULL
-18	18.0	1	1	2	1	1	0.0	1	NULL
-18	18.0	1	1	3	1	1	0.0	1	NULL
-18	18.0	1	1	4	1	1	0.0	1	NULL
-18	18.0	1	1	5	1	1	0.0	1	1.0
-18	18.0	1	1	6	1	1	0.0	1	1.0
-18	18.0	1	1	7	1	1	0.0	1	1.0
-18	18.0	1	1	8	1	1	0.0	1	1.0
-18	18.0	1	1	9	1	1	0.0	1	1.0
 18	18.0	1	1	10	1	1	0.0	1	1.0
 18	18.0	1	1	11	1	1	0.0	1	1.0
 18	18.0	1	1	12	1	1	0.0	1	1.0
@@ -89,7 +85,15 @@ POSTHOOK: Input: default@cbo_t1@dt=2014
 18	18.0	1	1	17	1	1	0.0	1	1.0
 18	18.0	1	1	18	1	1	0.0	1	1.0
 18	18.0	1	1	19	1	1	0.0	1	1.0
+18	18.0	1	1	2	1	1	0.0	1	NULL
 18	18.0	1	1	20	1	1	0.0	1	1.0
+18	18.0	1	1	3	1	1	0.0	1	NULL
+18	18.0	1	1	4	1	1	0.0	1	NULL
+18	18.0	1	1	5	1	1	0.0	1	1.0
+18	18.0	1	1	6	1	1	0.0	1	1.0
+18	18.0	1	1	7	1	1	0.0	1	1.0
+18	18.0	1	1	8	1	1	0.0	1	1.0
+18	18.0	1	1	9	1	1	0.0	1	1.0
 PREHOOK: query: select x from (select count(c_int) over() as x, sum(c_float) over() from cbo_t1) cbo_t1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cbo_t1
@@ -171,13 +175,16 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@cbo_t1
 POSTHOOK: Input: default@cbo_t1@dt=2014
 #### A masked pattern was here ####
-NULL	NULL	0	NULL	NULL	NULL	NULL	NULL	NULL
-NULL	NULL	0	NULL	NULL	NULL	NULL	NULL	NULL
 1	1	1	1.0	1.0	1.0	1.0	1.0	1.0
-1	1	2	1.0	2.0	1.0	2.0	1.0	1.0
 1	1	1	1.0	1.0	1.0	1.0	1.0	1.0
-1	1	2	1.0	2.0	1.0	2.0	1.0	1.0
 1	1	1	1.0	1.0	1.0	1.0	1.0	1.0
+1	1	1	1.0	1.0	1.0	1.0	1.0	1.0
+1	1	2	1.0	10.0	1.0	2.0	1.0	1.0
+1	1	2	1.0	11.0	1.0	2.0	1.0	1.0
+1	1	2	1.0	12.0	1.0	2.0	1.0	1.0
+1	1	2	1.0	2.0	1.0	2.0	1.0	1.0
+1	1	2	1.0	2.0	1.0	2.0	1.0	1.0
+1	1	2	1.0	2.0	1.0	2.0	1.0	1.0
 1	1	2	1.0	2.0	1.0	2.0	1.0	1.0
 1	1	2	1.0	3.0	1.0	2.0	1.0	1.0
 1	1	2	1.0	4.0	1.0	2.0	1.0	1.0
@@ -186,11 +193,8 @@ NULL	NULL	0	NULL	NULL	NULL	NULL	NULL	NULL
 1	1	2	1.0	7.0	1.0	2.0	1.0	1.0
 1	1	2	1.0	8.0	1.0	2.0	1.0	1.0
 1	1	2	1.0	9.0	1.0	2.0	1.0	1.0
-1	1	2	1.0	10.0	1.0	2.0	1.0	1.0
-1	1	2	1.0	11.0	1.0	2.0	1.0	1.0
-1	1	2	1.0	12.0	1.0	2.0	1.0	1.0
-1	1	1	1.0	1.0	1.0	1.0	1.0	1.0
-1	1	2	1.0	2.0	1.0	2.0	1.0	1.0
+NULL	NULL	0	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	0	NULL	NULL	NULL	NULL	NULL	NULL
 PREHOOK: query: select i, a, h, b, c, d, e, f, g, a as x, a +1 as y from (select max(c_int) over (partition by key order by value range UNBOUNDED PRECEDING) a, min(c_int) over (partition by key order by value range current row) b, count(c_int) over(partition by key order by value range 1 PRECEDING) c, avg(value) over (partition by key order by value range between unbounded preceding and unbounded following) d, sum(value) over (partition by key order by value range between unbounded preceding and current row) e, avg(c_float) over (partition by key order by value range between 1 preceding and unbounded following) f, sum(c_float) over (partition by key order by value range between 1 preceding and current row) g, max(c_float) over (partition by key order by value range between 1 preceding and unbounded following) h, min(c_float) over (partition by key order by value range between 1 preceding and 1 following) i from cbo_t1) cbo_t1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cbo_t1
@@ -201,12 +205,6 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@cbo_t1
 POSTHOOK: Input: default@cbo_t1@dt=2014
 #### A masked pattern was here ####
-NULL	NULL	NULL	NULL	0	NULL	NULL	NULL	NULL	NULL	NULL
-NULL	NULL	NULL	NULL	0	NULL	NULL	NULL	NULL	NULL	NULL
-1.0	1	1.0	1	2	1.0	2.0	1.0	2.0	1	2
-1.0	1	1.0	1	2	1.0	2.0	1.0	2.0	1	2
-1.0	1	1.0	1	2	1.0	2.0	1.0	2.0	1	2
-1.0	1	1.0	1	2	1.0	2.0	1.0	2.0	1	2
 1.0	1	1.0	1	12	1.0	12.0	1.0	12.0	1	2
 1.0	1	1.0	1	12	1.0	12.0	1.0	12.0	1	2
 1.0	1	1.0	1	12	1.0	12.0	1.0	12.0	1	2
@@ -221,6 +219,12 @@ NULL	NULL	NULL	NULL	0	NULL	NULL	NULL	NULL	NULL	NULL
 1.0	1	1.0	1	12	1.0	12.0	1.0	12.0	1	2
 1.0	1	1.0	1	2	1.0	2.0	1.0	2.0	1	2
 1.0	1	1.0	1	2	1.0	2.0	1.0	2.0	1	2
+1.0	1	1.0	1	2	1.0	2.0	1.0	2.0	1	2
+1.0	1	1.0	1	2	1.0	2.0	1.0	2.0	1	2
+1.0	1	1.0	1	2	1.0	2.0	1.0	2.0	1	2
+1.0	1	1.0	1	2	1.0	2.0	1.0	2.0	1	2
+NULL	NULL	NULL	NULL	0	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	0	NULL	NULL	NULL	NULL	NULL	NULL
 PREHOOK: query: select *, rank() over(partition by key order by value) as rr from src1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src1
diff --git a/ql/src/test/results/clientpositive/cross_product_check_1.q.out b/ql/src/test/results/clientpositive/cross_product_check_1.q.out
index b83cb6f226..3ab418a0ed 100644
--- a/ql/src/test/results/clientpositive/cross_product_check_1.q.out
+++ b/ql/src/test/results/clientpositive/cross_product_check_1.q.out
@@ -1,10 +1,14 @@
-PREHOOK: query: create table A as
+PREHOOK: query: -- SORT_QUERY_RESULTS
+
+create table A as
 select * from src
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
 PREHOOK: Output: database:default
 PREHOOK: Output: default@A
-POSTHOOK: query: create table A as
+POSTHOOK: query: -- SORT_QUERY_RESULTS
+
+create table A as
 select * from src
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
@@ -181,12 +185,12 @@ STAGE PLANS:
 Warning: Shuffle Join JOIN[16][tables = [a, od1]] in Stage 'Stage-3:MAPRED' is a cross product
 PREHOOK: query: explain select * from A join 
          (select d1.key 
-          from B d1 join B d2 on d1.key = d2.key 
+          from B d1 join B d2 on d1.key = d2.key
           where 1 = 1 group by d1.key) od1
 PREHOOK: type: QUERY
 POSTHOOK: query: explain select * from A join 
          (select d1.key 
-          from B d1 join B d2 on d1.key = d2.key 
+          from B d1 join B d2 on d1.key = d2.key
           where 1 = 1 group by d1.key) od1
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
@@ -308,9 +312,9 @@ STAGE PLANS:
 
 Warning: Shuffle Join JOIN[14][tables = [a, od1]] in Stage 'Stage-3:MAPRED' is a cross product
 Warning: Shuffle Join JOIN[4][tables = [d1, d2]] in Stage 'Stage-1:MAPRED' is a cross product
-PREHOOK: query: explain select * from A join (select d1.key from B d1 join B d2 where 1 = 1 group by d1.key) od1
+PREHOOK: query: explain select * from A join (select d1.key from B d1 join B d2 where 1 = 1  group by d1.key) od1
 PREHOOK: type: QUERY
-POSTHOOK: query: explain select * from A join (select d1.key from B d1 join B d2 where 1 = 1 group by d1.key) od1
+POSTHOOK: query: explain select * from A join (select d1.key from B d1 join B d2 where 1 = 1  group by d1.key) od1
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
@@ -422,11 +426,11 @@ STAGE PLANS:
 
 Warning: Shuffle Join JOIN[21][tables = [ss, od1]] in Stage 'Stage-2:MAPRED' is a cross product
 PREHOOK: query: explain select * from 
-(select A.key from A group by key) ss join 
+(select A.key from A  group by key) ss join
 (select d1.key from B d1 join B d2 on d1.key = d2.key where 1 = 1 group by d1.key) od1
 PREHOOK: type: QUERY
 POSTHOOK: query: explain select * from 
-(select A.key from A group by key) ss join 
+(select A.key from A  group by key) ss join
 (select d1.key from B d1 join B d2 on d1.key = d2.key where 1 = 1 group by d1.key) od1
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
diff --git a/ql/src/test/results/clientpositive/cross_product_check_2.q.out b/ql/src/test/results/clientpositive/cross_product_check_2.q.out
index 02b03d77ad..6910b40338 100644
--- a/ql/src/test/results/clientpositive/cross_product_check_2.q.out
+++ b/ql/src/test/results/clientpositive/cross_product_check_2.q.out
@@ -1,24 +1,28 @@
-PREHOOK: query: create table A as
+PREHOOK: query: -- SORT_QUERY_RESULTS
+
+create table A as
 select * from src
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
 PREHOOK: Output: database:default
 PREHOOK: Output: default@A
-POSTHOOK: query: create table A as
+POSTHOOK: query: -- SORT_QUERY_RESULTS
+
+create table A as
 select * from src
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@A
 PREHOOK: query: create table B as
-select * from src
+select * from src order by key
 limit 10
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
 PREHOOK: Output: database:default
 PREHOOK: Output: default@B
 POSTHOOK: query: create table B as
-select * from src
+select * from src order by key
 limit 10
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
@@ -45,11 +49,11 @@ STAGE PLANS:
         $hdt$_1:b 
           TableScan
             alias: b
-            Statistics: Num rows: 10 Data size: 104 Basic stats: COMPLETE Column stats: NONE
+            Statistics: Num rows: 10 Data size: 96 Basic stats: COMPLETE Column stats: NONE
             Select Operator
               expressions: key (type: string), value (type: string)
               outputColumnNames: _col0, _col1
-              Statistics: Num rows: 10 Data size: 104 Basic stats: COMPLETE Column stats: NONE
+              Statistics: Num rows: 10 Data size: 96 Basic stats: COMPLETE Column stats: NONE
               HashTable Sink Operator
                 keys:
                   0 
@@ -121,10 +125,10 @@ STAGE PLANS:
         d1 
           TableScan
             alias: d1
-            Statistics: Num rows: 10 Data size: 104 Basic stats: COMPLETE Column stats: NONE
+            Statistics: Num rows: 10 Data size: 96 Basic stats: COMPLETE Column stats: NONE
             Filter Operator
               predicate: key is not null (type: boolean)
-              Statistics: Num rows: 5 Data size: 52 Basic stats: COMPLETE Column stats: NONE
+              Statistics: Num rows: 5 Data size: 48 Basic stats: COMPLETE Column stats: NONE
               HashTable Sink Operator
                 keys:
                   0 key (type: string)
@@ -135,10 +139,10 @@ STAGE PLANS:
       Map Operator Tree:
           TableScan
             alias: d2
-            Statistics: Num rows: 10 Data size: 104 Basic stats: COMPLETE Column stats: NONE
+            Statistics: Num rows: 10 Data size: 96 Basic stats: COMPLETE Column stats: NONE
             Filter Operator
               predicate: key is not null (type: boolean)
-              Statistics: Num rows: 5 Data size: 52 Basic stats: COMPLETE Column stats: NONE
+              Statistics: Num rows: 5 Data size: 48 Basic stats: COMPLETE Column stats: NONE
               Map Join Operator
                 condition map:
                      Inner Join 0 to 1
@@ -146,7 +150,7 @@ STAGE PLANS:
                   0 key (type: string)
                   1 key (type: string)
                 outputColumnNames: _col0, _col1, _col5, _col6
-                Statistics: Num rows: 5 Data size: 57 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 5 Data size: 52 Basic stats: COMPLETE Column stats: NONE
                 Map Join Operator
                   condition map:
                        Inner Join 0 to 1
@@ -204,10 +208,10 @@ STAGE PLANS:
         od1:d1 
           TableScan
             alias: d1
-            Statistics: Num rows: 10 Data size: 104 Basic stats: COMPLETE Column stats: NONE
+            Statistics: Num rows: 10 Data size: 96 Basic stats: COMPLETE Column stats: NONE
             Filter Operator
               predicate: key is not null (type: boolean)
-              Statistics: Num rows: 5 Data size: 52 Basic stats: COMPLETE Column stats: NONE
+              Statistics: Num rows: 5 Data size: 48 Basic stats: COMPLETE Column stats: NONE
               HashTable Sink Operator
                 keys:
                   0 key (type: string)
@@ -218,10 +222,10 @@ STAGE PLANS:
       Map Operator Tree:
           TableScan
             alias: d2
-            Statistics: Num rows: 10 Data size: 104 Basic stats: COMPLETE Column stats: NONE
+            Statistics: Num rows: 10 Data size: 96 Basic stats: COMPLETE Column stats: NONE
             Filter Operator
               predicate: key is not null (type: boolean)
-              Statistics: Num rows: 5 Data size: 52 Basic stats: COMPLETE Column stats: NONE
+              Statistics: Num rows: 5 Data size: 48 Basic stats: COMPLETE Column stats: NONE
               Map Join Operator
                 condition map:
                      Inner Join 0 to 1
@@ -229,17 +233,17 @@ STAGE PLANS:
                   0 key (type: string)
                   1 key (type: string)
                 outputColumnNames: _col0
-                Statistics: Num rows: 5 Data size: 57 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 5 Data size: 52 Basic stats: COMPLETE Column stats: NONE
                 Group By Operator
                   keys: _col0 (type: string)
                   mode: hash
                   outputColumnNames: _col0
-                  Statistics: Num rows: 5 Data size: 57 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 5 Data size: 52 Basic stats: COMPLETE Column stats: NONE
                   Reduce Output Operator
                     key expressions: _col0 (type: string)
                     sort order: +
                     Map-reduce partition columns: _col0 (type: string)
-                    Statistics: Num rows: 5 Data size: 57 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 5 Data size: 52 Basic stats: COMPLETE Column stats: NONE
       Local Work:
         Map Reduce Local Work
       Reduce Operator Tree:
@@ -247,7 +251,7 @@ STAGE PLANS:
           keys: KEY._col0 (type: string)
           mode: mergepartial
           outputColumnNames: _col0
-          Statistics: Num rows: 2 Data size: 22 Basic stats: COMPLETE Column stats: NONE
+          Statistics: Num rows: 2 Data size: 20 Basic stats: COMPLETE Column stats: NONE
           File Output Operator
             compressed: false
             table:
@@ -327,7 +331,7 @@ STAGE PLANS:
         od1:d1 
           TableScan
             alias: d1
-            Statistics: Num rows: 10 Data size: 104 Basic stats: COMPLETE Column stats: NONE
+            Statistics: Num rows: 10 Data size: 96 Basic stats: COMPLETE Column stats: NONE
             HashTable Sink Operator
               keys:
                 0 
@@ -338,7 +342,7 @@ STAGE PLANS:
       Map Operator Tree:
           TableScan
             alias: d2
-            Statistics: Num rows: 10 Data size: 104 Basic stats: COMPLETE Column stats: COMPLETE
+            Statistics: Num rows: 10 Data size: 96 Basic stats: COMPLETE Column stats: COMPLETE
             Map Join Operator
               condition map:
                    Inner Join 0 to 1
@@ -346,17 +350,17 @@ STAGE PLANS:
                 0 
                 1 
               outputColumnNames: _col0
-              Statistics: Num rows: 11 Data size: 114 Basic stats: COMPLETE Column stats: NONE
+              Statistics: Num rows: 11 Data size: 105 Basic stats: COMPLETE Column stats: NONE
               Group By Operator
                 keys: _col0 (type: string)
                 mode: hash
                 outputColumnNames: _col0
-                Statistics: Num rows: 11 Data size: 114 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 11 Data size: 105 Basic stats: COMPLETE Column stats: NONE
                 Reduce Output Operator
                   key expressions: _col0 (type: string)
                   sort order: +
                   Map-reduce partition columns: _col0 (type: string)
-                  Statistics: Num rows: 11 Data size: 114 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 11 Data size: 105 Basic stats: COMPLETE Column stats: NONE
       Local Work:
         Map Reduce Local Work
       Reduce Operator Tree:
@@ -364,7 +368,7 @@ STAGE PLANS:
           keys: KEY._col0 (type: string)
           mode: mergepartial
           outputColumnNames: _col0
-          Statistics: Num rows: 5 Data size: 51 Basic stats: COMPLETE Column stats: NONE
+          Statistics: Num rows: 5 Data size: 47 Basic stats: COMPLETE Column stats: NONE
           File Output Operator
             compressed: false
             table:
@@ -563,7 +567,7 @@ STAGE PLANS:
           TableScan
             Reduce Output Operator
               sort order: 
-              Statistics: Num rows: 2 Data size: 22 Basic stats: COMPLETE Column stats: NONE
+              Statistics: Num rows: 2 Data size: 20 Basic stats: COMPLETE Column stats: NONE
               value expressions: _col0 (type: string)
       Reduce Operator Tree:
         Join Operator
@@ -592,10 +596,10 @@ STAGE PLANS:
         od1:d1 
           TableScan
             alias: d1
-            Statistics: Num rows: 10 Data size: 104 Basic stats: COMPLETE Column stats: NONE
+            Statistics: Num rows: 10 Data size: 96 Basic stats: COMPLETE Column stats: NONE
             Filter Operator
               predicate: key is not null (type: boolean)
-              Statistics: Num rows: 5 Data size: 52 Basic stats: COMPLETE Column stats: NONE
+              Statistics: Num rows: 5 Data size: 48 Basic stats: COMPLETE Column stats: NONE
               HashTable Sink Operator
                 keys:
                   0 key (type: string)
@@ -606,10 +610,10 @@ STAGE PLANS:
       Map Operator Tree:
           TableScan
             alias: d2
-            Statistics: Num rows: 10 Data size: 104 Basic stats: COMPLETE Column stats: NONE
+            Statistics: Num rows: 10 Data size: 96 Basic stats: COMPLETE Column stats: NONE
             Filter Operator
               predicate: key is not null (type: boolean)
-              Statistics: Num rows: 5 Data size: 52 Basic stats: COMPLETE Column stats: NONE
+              Statistics: Num rows: 5 Data size: 48 Basic stats: COMPLETE Column stats: NONE
               Map Join Operator
                 condition map:
                      Inner Join 0 to 1
@@ -617,17 +621,17 @@ STAGE PLANS:
                   0 key (type: string)
                   1 key (type: string)
                 outputColumnNames: _col0
-                Statistics: Num rows: 5 Data size: 57 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 5 Data size: 52 Basic stats: COMPLETE Column stats: NONE
                 Group By Operator
                   keys: _col0 (type: string)
                   mode: hash
                   outputColumnNames: _col0
-                  Statistics: Num rows: 5 Data size: 57 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 5 Data size: 52 Basic stats: COMPLETE Column stats: NONE
                   Reduce Output Operator
                     key expressions: _col0 (type: string)
                     sort order: +
                     Map-reduce partition columns: _col0 (type: string)
-                    Statistics: Num rows: 5 Data size: 57 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 5 Data size: 52 Basic stats: COMPLETE Column stats: NONE
       Local Work:
         Map Reduce Local Work
       Reduce Operator Tree:
@@ -635,7 +639,7 @@ STAGE PLANS:
           keys: KEY._col0 (type: string)
           mode: mergepartial
           outputColumnNames: _col0
-          Statistics: Num rows: 2 Data size: 22 Basic stats: COMPLETE Column stats: NONE
+          Statistics: Num rows: 2 Data size: 20 Basic stats: COMPLETE Column stats: NONE
           File Output Operator
             compressed: false
             table:
diff --git a/ql/src/test/results/clientpositive/ctas.q.out b/ql/src/test/results/clientpositive/ctas.q.out
index 586a832d6c..6f17a74b33 100644
--- a/ql/src/test/results/clientpositive/ctas.q.out
+++ b/ql/src/test/results/clientpositive/ctas.q.out
@@ -1,10 +1,12 @@
 PREHOOK: query: -- EXCLUDE_HADOOP_MAJOR_VERSIONS( 0.20S)
+-- SORT_QUERY_RESULTS
 
 create table nzhang_Tmp(a int, b string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@nzhang_Tmp
 POSTHOOK: query: -- EXCLUDE_HADOOP_MAJOR_VERSIONS( 0.20S)
+-- SORT_QUERY_RESULTS
 
 create table nzhang_Tmp(a int, b string)
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/dynpart_sort_optimization2.q.out b/ql/src/test/results/clientpositive/dynpart_sort_optimization2.q.out
index 153e9bf9cd..1ec7556c34 100644
--- a/ql/src/test/results/clientpositive/dynpart_sort_optimization2.q.out
+++ b/ql/src/test/results/clientpositive/dynpart_sort_optimization2.q.out
@@ -1,6 +1,10 @@
-PREHOOK: query: drop table ss
+PREHOOK: query: -- SORT_QUERY_RESULTS
+
+drop table ss
 PREHOOK: type: DROPTABLE
-POSTHOOK: query: drop table ss
+POSTHOOK: query: -- SORT_QUERY_RESULTS
+
+drop table ss
 POSTHOOK: type: DROPTABLE
 PREHOOK: query: drop table ss_orc
 PREHOOK: type: DROPTABLE
@@ -213,17 +217,17 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@ss_part
 POSTHOOK: Input: default@ss_part@ss_sold_date_sk=2452617
 #### A masked pattern was here ####
+10022.63	3952.8	2452617
+1765.07	-4648.8	2452617
 2.1	-2026.3	2452617
 2.99	-11.32	2452617
-85.8	25.61	2452617
-552.96	-1363.84	2452617
-565.92	196.48	2452617
-879.07	-2185.76	2452617
-1765.07	-4648.8	2452617
 3423.95	-3164.07	2452617
 5362.01	-600.28	2452617
+552.96	-1363.84	2452617
+565.92	196.48	2452617
 7412.83	2071.68	2452617
-10022.63	3952.8	2452617
+85.8	25.61	2452617
+879.07	-2185.76	2452617
 PREHOOK: query: desc formatted ss_part partition(ss_sold_date_sk=2452638)
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@ss_part
@@ -276,18 +280,18 @@ POSTHOOK: Input: default@ss_part
 POSTHOOK: Input: default@ss_part@ss_sold_date_sk=2452638
 #### A masked pattern was here ####
 0.15	-241.22	2452638
+10171.1	660.48	2452638
+1327.08	57.97	2452638
+1413.19	178.08	2452638
 150.39	-162.12	2452638
+1524.33	494.37	2452638
 156.67	-4626.56	2452638
 181.03	-207.24	2452638
+1971.35	-488.25	2452638
 267.01	-3266.36	2452638
 317.87	-3775.38	2452638
-1327.08	57.97	2452638
-1413.19	178.08	2452638
-1524.33	494.37	2452638
-1971.35	-488.25	2452638
 4133.98	-775.72	2452638
 4329.49	-4000.51	2452638
-10171.1	660.48	2452638
 PREHOOK: query: explain insert overwrite table ss_part partition (ss_sold_date_sk)
 select ss_net_paid_inc_tax,
   ss_net_profit,
@@ -435,16 +439,16 @@ POSTHOOK: Input: default@ss_part
 POSTHOOK: Input: default@ss_part@ss_sold_date_sk=2452617
 #### A masked pattern was here ####
 10022.63	3952.8	2452617
+1765.07	-4648.8	2452617
+2.1	-2026.3	2452617
 2.99	-11.32	2452617
 3423.95	-3164.07	2452617
 5362.01	-600.28	2452617
+552.96	-1363.84	2452617
 565.92	196.48	2452617
-85.8	25.61	2452617
 7412.83	2071.68	2452617
+85.8	25.61	2452617
 879.07	-2185.76	2452617
-1765.07	-4648.8	2452617
-552.96	-1363.84	2452617
-2.1	-2026.3	2452617
 PREHOOK: query: desc formatted ss_part partition(ss_sold_date_sk=2452638)
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@ss_part
@@ -496,19 +500,19 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@ss_part
 POSTHOOK: Input: default@ss_part@ss_sold_date_sk=2452638
 #### A masked pattern was here ####
-4329.49	-4000.51	2452638
+0.15	-241.22	2452638
+10171.1	660.48	2452638
+1327.08	57.97	2452638
 1413.19	178.08	2452638
 150.39	-162.12	2452638
 1524.33	494.37	2452638
-0.15	-241.22	2452638
-267.01	-3266.36	2452638
+156.67	-4626.56	2452638
 181.03	-207.24	2452638
 1971.35	-488.25	2452638
-1327.08	57.97	2452638
-156.67	-4626.56	2452638
+267.01	-3266.36	2452638
 317.87	-3775.38	2452638
-10171.1	660.48	2452638
 4133.98	-775.72	2452638
+4329.49	-4000.51	2452638
 PREHOOK: query: -- SORT DYNAMIC PARTITION DISABLED
 
 explain insert overwrite table ss_part partition (ss_sold_date_sk)
@@ -676,17 +680,17 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@ss_part
 POSTHOOK: Input: default@ss_part@ss_sold_date_sk=2452617
 #### A masked pattern was here ####
+10022.63	3952.8	2452617
+1765.07	-4648.8	2452617
 2.1	-2026.3	2452617
 2.99	-11.32	2452617
-85.8	25.61	2452617
-552.96	-1363.84	2452617
-565.92	196.48	2452617
-879.07	-2185.76	2452617
-1765.07	-4648.8	2452617
 3423.95	-3164.07	2452617
 5362.01	-600.28	2452617
+552.96	-1363.84	2452617
+565.92	196.48	2452617
 7412.83	2071.68	2452617
-10022.63	3952.8	2452617
+85.8	25.61	2452617
+879.07	-2185.76	2452617
 PREHOOK: query: desc formatted ss_part partition(ss_sold_date_sk=2452638)
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@ss_part
@@ -739,18 +743,18 @@ POSTHOOK: Input: default@ss_part
 POSTHOOK: Input: default@ss_part@ss_sold_date_sk=2452638
 #### A masked pattern was here ####
 0.15	-241.22	2452638
+10171.1	660.48	2452638
+1327.08	57.97	2452638
+1413.19	178.08	2452638
 150.39	-162.12	2452638
+1524.33	494.37	2452638
 156.67	-4626.56	2452638
 181.03	-207.24	2452638
+1971.35	-488.25	2452638
 267.01	-3266.36	2452638
 317.87	-3775.38	2452638
-1327.08	57.97	2452638
-1413.19	178.08	2452638
-1524.33	494.37	2452638
-1971.35	-488.25	2452638
 4133.98	-775.72	2452638
 4329.49	-4000.51	2452638
-10171.1	660.48	2452638
 PREHOOK: query: explain insert overwrite table ss_part partition (ss_sold_date_sk)
 select ss_net_paid_inc_tax,
   ss_net_profit,
@@ -896,17 +900,17 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@ss_part
 POSTHOOK: Input: default@ss_part@ss_sold_date_sk=2452617
 #### A masked pattern was here ####
+10022.63	3952.8	2452617
+1765.07	-4648.8	2452617
+2.1	-2026.3	2452617
+2.99	-11.32	2452617
 3423.95	-3164.07	2452617
 5362.01	-600.28	2452617
+552.96	-1363.84	2452617
 565.92	196.48	2452617
-85.8	25.61	2452617
 7412.83	2071.68	2452617
+85.8	25.61	2452617
 879.07	-2185.76	2452617
-1765.07	-4648.8	2452617
-552.96	-1363.84	2452617
-2.1	-2026.3	2452617
-10022.63	3952.8	2452617
-2.99	-11.32	2452617
 PREHOOK: query: desc formatted ss_part partition(ss_sold_date_sk=2452638)
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@ss_part
@@ -958,19 +962,19 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@ss_part
 POSTHOOK: Input: default@ss_part@ss_sold_date_sk=2452638
 #### A masked pattern was here ####
-4329.49	-4000.51	2452638
+0.15	-241.22	2452638
+10171.1	660.48	2452638
+1327.08	57.97	2452638
 1413.19	178.08	2452638
 150.39	-162.12	2452638
 1524.33	494.37	2452638
-0.15	-241.22	2452638
-267.01	-3266.36	2452638
+156.67	-4626.56	2452638
 181.03	-207.24	2452638
 1971.35	-488.25	2452638
-1327.08	57.97	2452638
-156.67	-4626.56	2452638
+267.01	-3266.36	2452638
 317.87	-3775.38	2452638
-10171.1	660.48	2452638
 4133.98	-775.72	2452638
+4329.49	-4000.51	2452638
 PREHOOK: query: -- VECTORIZATION IS ENABLED
 
 create table ss_orc (
@@ -1194,17 +1198,17 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@ss_part_orc
 POSTHOOK: Input: default@ss_part_orc@ss_sold_date_sk=2452617
 #### A masked pattern was here ####
+10022.63	3952.8	2452617
+1765.07	-4648.8	2452617
 2.1	-2026.3	2452617
 2.99	-11.32	2452617
-85.8	25.61	2452617
-552.96	-1363.84	2452617
-565.92	196.48	2452617
-879.07	-2185.76	2452617
-1765.07	-4648.8	2452617
 3423.95	-3164.07	2452617
 5362.01	-600.28	2452617
+552.96	-1363.84	2452617
+565.92	196.48	2452617
 7412.83	2071.68	2452617
-10022.63	3952.8	2452617
+85.8	25.61	2452617
+879.07	-2185.76	2452617
 PREHOOK: query: desc formatted ss_part_orc partition(ss_sold_date_sk=2452638)
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@ss_part_orc
@@ -1257,18 +1261,18 @@ POSTHOOK: Input: default@ss_part_orc
 POSTHOOK: Input: default@ss_part_orc@ss_sold_date_sk=2452638
 #### A masked pattern was here ####
 0.15	-241.22	2452638
+10171.1	660.48	2452638
+1327.08	57.97	2452638
+1413.19	178.08	2452638
 150.39	-162.12	2452638
+1524.33	494.37	2452638
 156.67	-4626.56	2452638
 181.03	-207.24	2452638
+1971.35	-488.25	2452638
 267.01	-3266.36	2452638
 317.87	-3775.38	2452638
-1327.08	57.97	2452638
-1413.19	178.08	2452638
-1524.33	494.37	2452638
-1971.35	-488.25	2452638
 4133.98	-775.72	2452638
 4329.49	-4000.51	2452638
-10171.1	660.48	2452638
 PREHOOK: query: explain insert overwrite table ss_part_orc partition (ss_sold_date_sk)
 select ss_net_paid_inc_tax,
   ss_net_profit,
@@ -1415,17 +1419,17 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@ss_part_orc
 POSTHOOK: Input: default@ss_part_orc@ss_sold_date_sk=2452617
 #### A masked pattern was here ####
+10022.63	3952.8	2452617
+1765.07	-4648.8	2452617
+2.1	-2026.3	2452617
+2.99	-11.32	2452617
 3423.95	-3164.07	2452617
 5362.01	-600.28	2452617
+552.96	-1363.84	2452617
 565.92	196.48	2452617
-85.8	25.61	2452617
 7412.83	2071.68	2452617
+85.8	25.61	2452617
 879.07	-2185.76	2452617
-1765.07	-4648.8	2452617
-552.96	-1363.84	2452617
-2.1	-2026.3	2452617
-10022.63	3952.8	2452617
-2.99	-11.32	2452617
 PREHOOK: query: desc formatted ss_part_orc partition(ss_sold_date_sk=2452638)
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@ss_part_orc
@@ -1477,19 +1481,19 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@ss_part_orc
 POSTHOOK: Input: default@ss_part_orc@ss_sold_date_sk=2452638
 #### A masked pattern was here ####
-4329.49	-4000.51	2452638
+0.15	-241.22	2452638
+10171.1	660.48	2452638
+1327.08	57.97	2452638
 1413.19	178.08	2452638
 150.39	-162.12	2452638
 1524.33	494.37	2452638
-0.15	-241.22	2452638
-267.01	-3266.36	2452638
+156.67	-4626.56	2452638
 181.03	-207.24	2452638
 1971.35	-488.25	2452638
-1327.08	57.97	2452638
-156.67	-4626.56	2452638
+267.01	-3266.36	2452638
 317.87	-3775.38	2452638
-10171.1	660.48	2452638
 4133.98	-775.72	2452638
+4329.49	-4000.51	2452638
 PREHOOK: query: drop table ss_orc
 PREHOOK: type: DROPTABLE
 PREHOOK: Input: default@ss_orc
@@ -1629,21 +1633,21 @@ POSTHOOK: Input: default@src
 POSTHOOK: Output: default@hive13_dp1@day=day
 POSTHOOK: Lineage: hive13_dp1 PARTITION(day=day).k1 EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: hive13_dp1 PARTITION(day=day).k2 EXPRESSION [(src)src.FieldSchema(name:value, type:string, comment:default), ]
-PREHOOK: query: select * from hive13_dp1 limit 5
+PREHOOK: query: select * from hive13_dp1 order by k1, k2 limit 5
 PREHOOK: type: QUERY
 PREHOOK: Input: default@hive13_dp1
 PREHOOK: Input: default@hive13_dp1@day=day
 #### A masked pattern was here ####
-POSTHOOK: query: select * from hive13_dp1 limit 5
+POSTHOOK: query: select * from hive13_dp1 order by k1, k2 limit 5
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@hive13_dp1
 POSTHOOK: Input: default@hive13_dp1@day=day
 #### A masked pattern was here ####
 0	3	day
-10	1	day
-100	2	day
-103	2	day
-104	2	day
+2	1	day
+4	1	day
+5	3	day
+8	1	day
 PREHOOK: query: explain insert overwrite table `hive13_dp1` partition(`day`)
 select
     key k1,
@@ -1745,21 +1749,21 @@ POSTHOOK: Input: default@src
 POSTHOOK: Output: default@hive13_dp1@day=day
 POSTHOOK: Lineage: hive13_dp1 PARTITION(day=day).k1 EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: hive13_dp1 PARTITION(day=day).k2 EXPRESSION [(src)src.FieldSchema(name:value, type:string, comment:default), ]
-PREHOOK: query: select * from hive13_dp1 limit 5
+PREHOOK: query: select * from hive13_dp1 order by k1, k2 limit 5
 PREHOOK: type: QUERY
 PREHOOK: Input: default@hive13_dp1
 PREHOOK: Input: default@hive13_dp1@day=day
 #### A masked pattern was here ####
-POSTHOOK: query: select * from hive13_dp1 limit 5
+POSTHOOK: query: select * from hive13_dp1 order by k1, k2 limit 5
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@hive13_dp1
 POSTHOOK: Input: default@hive13_dp1@day=day
 #### A masked pattern was here ####
 0	3	day
-10	1	day
-100	2	day
-103	2	day
-104	2	day
+2	1	day
+4	1	day
+5	3	day
+8	1	day
 PREHOOK: query: drop table hive13_dp1
 PREHOOK: type: DROPTABLE
 PREHOOK: Input: default@hive13_dp1
diff --git a/ql/src/test/results/clientpositive/filter_join_breaktask2.q.out b/ql/src/test/results/clientpositive/filter_join_breaktask2.q.out
index 6a2396e946..af85af972e 100644
--- a/ql/src/test/results/clientpositive/filter_join_breaktask2.q.out
+++ b/ql/src/test/results/clientpositive/filter_join_breaktask2.q.out
@@ -1,9 +1,13 @@
-PREHOOK: query: create table T1(c1 string, c2 string, c3 string, c4 string, c5 string, c6 string, c7 string) 
+PREHOOK: query: -- SORT_QUERY_RESULTS
+
+create table T1(c1 string, c2 string, c3 string, c4 string, c5 string, c6 string, c7 string) 
 partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@T1
-POSTHOOK: query: create table T1(c1 string, c2 string, c3 string, c4 string, c5 string, c6 string, c7 string) 
+POSTHOOK: query: -- SORT_QUERY_RESULTS
+
+create table T1(c1 string, c2 string, c3 string, c4 string, c5 string, c6 string, c7 string) 
 partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/insert_into1.q.out b/ql/src/test/results/clientpositive/insert_into1.q.out
index 9e5f3bb92e..2b5cbcada7 100644
--- a/ql/src/test/results/clientpositive/insert_into1.q.out
+++ b/ql/src/test/results/clientpositive/insert_into1.q.out
@@ -1,6 +1,10 @@
-PREHOOK: query: DROP TABLE insert_into1
+PREHOOK: query: -- SORT_QUERY_RESULTS
+
+DROP TABLE insert_into1
 PREHOOK: type: DROPTABLE
-POSTHOOK: query: DROP TABLE insert_into1
+POSTHOOK: query: -- SORT_QUERY_RESULTS
+
+DROP TABLE insert_into1
 POSTHOOK: type: DROPTABLE
 PREHOOK: query: CREATE TABLE insert_into1 (key int, value string)
 PREHOOK: type: CREATETABLE
@@ -10,9 +14,9 @@ POSTHOOK: query: CREATE TABLE insert_into1 (key int, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@insert_into1
-PREHOOK: query: EXPLAIN INSERT INTO TABLE insert_into1 SELECT * from src LIMIT 100
+PREHOOK: query: EXPLAIN INSERT INTO TABLE insert_into1 SELECT * from src ORDER BY key LIMIT 100
 PREHOOK: type: QUERY
-POSTHOOK: query: EXPLAIN INSERT INTO TABLE insert_into1 SELECT * from src LIMIT 100
+POSTHOOK: query: EXPLAIN INSERT INTO TABLE insert_into1 SELECT * from src ORDER BY key LIMIT 100
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
@@ -30,18 +34,16 @@ STAGE PLANS:
               expressions: key (type: string), value (type: string)
               outputColumnNames: _col0, _col1
               Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
-              Limit
-                Number of rows: 100
-                Statistics: Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
-                Reduce Output Operator
-                  sort order: 
-                  Statistics: Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
-                  value expressions: _col0 (type: string), _col1 (type: string)
+              Reduce Output Operator
+                key expressions: _col0 (type: string)
+                sort order: +
+                Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
+                value expressions: _col1 (type: string)
       Reduce Operator Tree:
         Select Operator
-          expressions: VALUE._col0 (type: string), VALUE._col1 (type: string)
+          expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string)
           outputColumnNames: _col0, _col1
-          Statistics: Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
+          Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
           Limit
             Number of rows: 100
             Statistics: Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
@@ -71,11 +73,11 @@ STAGE PLANS:
   Stage: Stage-2
     Stats-Aggr Operator
 
-PREHOOK: query: INSERT INTO TABLE insert_into1 SELECT * from src LIMIT 100
+PREHOOK: query: INSERT INTO TABLE insert_into1 SELECT * from src ORDER BY key LIMIT 100
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
 PREHOOK: Output: default@insert_into1
-POSTHOOK: query: INSERT INTO TABLE insert_into1 SELECT * from src LIMIT 100
+POSTHOOK: query: INSERT INTO TABLE insert_into1 SELECT * from src ORDER BY key LIMIT 100
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 POSTHOOK: Output: default@insert_into1
@@ -93,7 +95,7 @@ POSTHOOK: query: SELECT SUM(HASH(c)) FROM (
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@insert_into1
 #### A masked pattern was here ####
-10226524244
+-1142373758
 PREHOOK: query: explain 
 select count(*) from insert_into1
 PREHOOK: type: QUERY
@@ -119,9 +121,9 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@insert_into1
 #### A masked pattern was here ####
 100
-PREHOOK: query: EXPLAIN INSERT INTO TABLE insert_into1 SELECT * FROM src LIMIT 100
+PREHOOK: query: EXPLAIN INSERT INTO TABLE insert_into1 SELECT * FROM src ORDER BY key LIMIT 100
 PREHOOK: type: QUERY
-POSTHOOK: query: EXPLAIN INSERT INTO TABLE insert_into1 SELECT * FROM src LIMIT 100
+POSTHOOK: query: EXPLAIN INSERT INTO TABLE insert_into1 SELECT * FROM src ORDER BY key LIMIT 100
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
@@ -139,18 +141,16 @@ STAGE PLANS:
               expressions: key (type: string), value (type: string)
               outputColumnNames: _col0, _col1
               Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
-              Limit
-                Number of rows: 100
-                Statistics: Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
-                Reduce Output Operator
-                  sort order: 
-                  Statistics: Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
-                  value expressions: _col0 (type: string), _col1 (type: string)
+              Reduce Output Operator
+                key expressions: _col0 (type: string)
+                sort order: +
+                Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
+                value expressions: _col1 (type: string)
       Reduce Operator Tree:
         Select Operator
-          expressions: VALUE._col0 (type: string), VALUE._col1 (type: string)
+          expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string)
           outputColumnNames: _col0, _col1
-          Statistics: Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
+          Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
           Limit
             Number of rows: 100
             Statistics: Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
@@ -180,11 +180,11 @@ STAGE PLANS:
   Stage: Stage-2
     Stats-Aggr Operator
 
-PREHOOK: query: INSERT INTO TABLE insert_into1 SELECT * FROM src LIMIT 100
+PREHOOK: query: INSERT INTO TABLE insert_into1 SELECT * FROM src ORDER BY key LIMIT 100
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
 PREHOOK: Output: default@insert_into1
-POSTHOOK: query: INSERT INTO TABLE insert_into1 SELECT * FROM src LIMIT 100
+POSTHOOK: query: INSERT INTO TABLE insert_into1 SELECT * FROM src ORDER BY key LIMIT 100
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 POSTHOOK: Output: default@insert_into1
@@ -202,7 +202,7 @@ POSTHOOK: query: SELECT SUM(HASH(c)) FROM (
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@insert_into1
 #### A masked pattern was here ####
-20453048488
+-2284747516
 PREHOOK: query: explain
 SELECT COUNT(*) FROM insert_into1
 PREHOOK: type: QUERY
@@ -228,9 +228,9 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@insert_into1
 #### A masked pattern was here ####
 200
-PREHOOK: query: EXPLAIN INSERT OVERWRITE TABLE insert_into1 SELECT * FROM src LIMIT 10
+PREHOOK: query: EXPLAIN INSERT OVERWRITE TABLE insert_into1 SELECT * FROM src ORDER BY key LIMIT 10
 PREHOOK: type: QUERY
-POSTHOOK: query: EXPLAIN INSERT OVERWRITE TABLE insert_into1 SELECT * FROM src LIMIT 10
+POSTHOOK: query: EXPLAIN INSERT OVERWRITE TABLE insert_into1 SELECT * FROM src ORDER BY key LIMIT 10
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
@@ -248,18 +248,16 @@ STAGE PLANS:
               expressions: key (type: string), value (type: string)
               outputColumnNames: _col0, _col1
               Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
-              Limit
-                Number of rows: 10
-                Statistics: Num rows: 10 Data size: 100 Basic stats: COMPLETE Column stats: NONE
-                Reduce Output Operator
-                  sort order: 
-                  Statistics: Num rows: 10 Data size: 100 Basic stats: COMPLETE Column stats: NONE
-                  value expressions: _col0 (type: string), _col1 (type: string)
+              Reduce Output Operator
+                key expressions: _col0 (type: string)
+                sort order: +
+                Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
+                value expressions: _col1 (type: string)
       Reduce Operator Tree:
         Select Operator
-          expressions: VALUE._col0 (type: string), VALUE._col1 (type: string)
+          expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string)
           outputColumnNames: _col0, _col1
-          Statistics: Num rows: 10 Data size: 100 Basic stats: COMPLETE Column stats: NONE
+          Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
           Limit
             Number of rows: 10
             Statistics: Num rows: 10 Data size: 100 Basic stats: COMPLETE Column stats: NONE
@@ -289,11 +287,11 @@ STAGE PLANS:
   Stage: Stage-2
     Stats-Aggr Operator
 
-PREHOOK: query: INSERT OVERWRITE TABLE insert_into1 SELECT * FROM src LIMIT 10
+PREHOOK: query: INSERT OVERWRITE TABLE insert_into1 SELECT * FROM src ORDER BY key LIMIT 10
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
 PREHOOK: Output: default@insert_into1
-POSTHOOK: query: INSERT OVERWRITE TABLE insert_into1 SELECT * FROM src LIMIT 10
+POSTHOOK: query: INSERT OVERWRITE TABLE insert_into1 SELECT * FROM src ORDER BY key LIMIT 10
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 POSTHOOK: Output: default@insert_into1
@@ -311,7 +309,7 @@ POSTHOOK: query: SELECT SUM(HASH(c)) FROM (
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@insert_into1
 #### A masked pattern was here ####
--826625916
+-2693537120
 PREHOOK: query: explain
 SELECT COUNT(*) FROM insert_into1
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/insert_into2.q.out b/ql/src/test/results/clientpositive/insert_into2.q.out
index acbedb5af1..cc7e135305 100644
--- a/ql/src/test/results/clientpositive/insert_into2.q.out
+++ b/ql/src/test/results/clientpositive/insert_into2.q.out
@@ -13,10 +13,10 @@ POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@insert_into2
 PREHOOK: query: EXPLAIN INSERT INTO TABLE insert_into2 PARTITION (ds='1') 
-  SELECT * FROM src LIMIT 100
+  SELECT * FROM src order by key LIMIT 100
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN INSERT INTO TABLE insert_into2 PARTITION (ds='1') 
-  SELECT * FROM src LIMIT 100
+  SELECT * FROM src order by key LIMIT 100
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
@@ -34,18 +34,16 @@ STAGE PLANS:
               expressions: key (type: string), value (type: string)
               outputColumnNames: _col0, _col1
               Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
-              Limit
-                Number of rows: 100
-                Statistics: Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
-                Reduce Output Operator
-                  sort order: 
-                  Statistics: Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
-                  value expressions: _col0 (type: string), _col1 (type: string)
+              Reduce Output Operator
+                key expressions: _col0 (type: string)
+                sort order: +
+                Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
+                value expressions: _col1 (type: string)
       Reduce Operator Tree:
         Select Operator
-          expressions: VALUE._col0 (type: string), VALUE._col1 (type: string)
+          expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string)
           outputColumnNames: _col0, _col1
-          Statistics: Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
+          Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
           Limit
             Number of rows: 100
             Statistics: Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
@@ -77,11 +75,11 @@ STAGE PLANS:
   Stage: Stage-2
     Stats-Aggr Operator
 
-PREHOOK: query: INSERT INTO TABLE insert_into2 PARTITION (ds='1') SELECT * FROM src limit 100
+PREHOOK: query: INSERT INTO TABLE insert_into2 PARTITION (ds='1') SELECT * FROM src order by key limit 100
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
 PREHOOK: Output: default@insert_into2@ds=1
-POSTHOOK: query: INSERT INTO TABLE insert_into2 PARTITION (ds='1') SELECT * FROM src limit 100
+POSTHOOK: query: INSERT INTO TABLE insert_into2 PARTITION (ds='1') SELECT * FROM src order by key limit 100
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 POSTHOOK: Output: default@insert_into2@ds=1
@@ -112,11 +110,11 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@insert_into2
 #### A masked pattern was here ####
 100
-PREHOOK: query: INSERT INTO TABLE insert_into2 PARTITION (ds='1') SELECT * FROM src limit 100
+PREHOOK: query: INSERT INTO TABLE insert_into2 PARTITION (ds='1') SELECT * FROM src order by key limit 100
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
 PREHOOK: Output: default@insert_into2@ds=1
-POSTHOOK: query: INSERT INTO TABLE insert_into2 PARTITION (ds='1') SELECT * FROM src limit 100
+POSTHOOK: query: INSERT INTO TABLE insert_into2 PARTITION (ds='1') SELECT * FROM src order by key limit 100
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 POSTHOOK: Output: default@insert_into2@ds=1
@@ -161,12 +159,12 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@insert_into2
 POSTHOOK: Input: default@insert_into2@ds=1
 #### A masked pattern was here ####
--24159954504
+-39568181484
 PREHOOK: query: EXPLAIN INSERT OVERWRITE TABLE insert_into2 PARTITION (ds='2')
-  SELECT * FROM src LIMIT 100
+  SELECT * FROM src order by key LIMIT 100
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN INSERT OVERWRITE TABLE insert_into2 PARTITION (ds='2')
-  SELECT * FROM src LIMIT 100
+  SELECT * FROM src order by key LIMIT 100
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
@@ -184,18 +182,16 @@ STAGE PLANS:
               expressions: key (type: string), value (type: string)
               outputColumnNames: _col0, _col1
               Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
-              Limit
-                Number of rows: 100
-                Statistics: Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
-                Reduce Output Operator
-                  sort order: 
-                  Statistics: Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
-                  value expressions: _col0 (type: string), _col1 (type: string)
+              Reduce Output Operator
+                key expressions: _col0 (type: string)
+                sort order: +
+                Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
+                value expressions: _col1 (type: string)
       Reduce Operator Tree:
         Select Operator
-          expressions: VALUE._col0 (type: string), VALUE._col1 (type: string)
+          expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string)
           outputColumnNames: _col0, _col1
-          Statistics: Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
+          Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
           Limit
             Number of rows: 100
             Statistics: Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
@@ -228,12 +224,12 @@ STAGE PLANS:
     Stats-Aggr Operator
 
 PREHOOK: query: INSERT OVERWRITE TABLE insert_into2 PARTITION (ds='2')
-  SELECT * FROM src LIMIT 100
+  SELECT * FROM src order by key LIMIT 100
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
 PREHOOK: Output: default@insert_into2@ds=2
 POSTHOOK: query: INSERT OVERWRITE TABLE insert_into2 PARTITION (ds='2')
-  SELECT * FROM src LIMIT 100
+  SELECT * FROM src order by key LIMIT 100
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 POSTHOOK: Output: default@insert_into2@ds=2
@@ -255,7 +251,7 @@ POSTHOOK: Input: default@insert_into2
 POSTHOOK: Input: default@insert_into2@ds=1
 POSTHOOK: Input: default@insert_into2@ds=2
 #### A masked pattern was here ####
--36239931656
+-59352272126
 PREHOOK: query: explain
 SELECT COUNT(*) FROM insert_into2 WHERE ds='2'
 PREHOOK: type: QUERY
@@ -282,10 +278,10 @@ POSTHOOK: Input: default@insert_into2
 #### A masked pattern was here ####
 100
 PREHOOK: query: EXPLAIN INSERT OVERWRITE TABLE insert_into2 PARTITION (ds='2')
-  SELECT * FROM src LIMIT 50
+  SELECT * FROM src order by key LIMIT 50
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN INSERT OVERWRITE TABLE insert_into2 PARTITION (ds='2')
-  SELECT * FROM src LIMIT 50
+  SELECT * FROM src order by key LIMIT 50
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
@@ -303,18 +299,16 @@ STAGE PLANS:
               expressions: key (type: string), value (type: string)
               outputColumnNames: _col0, _col1
               Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
-              Limit
-                Number of rows: 50
-                Statistics: Num rows: 50 Data size: 500 Basic stats: COMPLETE Column stats: NONE
-                Reduce Output Operator
-                  sort order: 
-                  Statistics: Num rows: 50 Data size: 500 Basic stats: COMPLETE Column stats: NONE
-                  value expressions: _col0 (type: string), _col1 (type: string)
+              Reduce Output Operator
+                key expressions: _col0 (type: string)
+                sort order: +
+                Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
+                value expressions: _col1 (type: string)
       Reduce Operator Tree:
         Select Operator
-          expressions: VALUE._col0 (type: string), VALUE._col1 (type: string)
+          expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string)
           outputColumnNames: _col0, _col1
-          Statistics: Num rows: 50 Data size: 500 Basic stats: COMPLETE Column stats: NONE
+          Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
           Limit
             Number of rows: 50
             Statistics: Num rows: 50 Data size: 500 Basic stats: COMPLETE Column stats: NONE
@@ -347,12 +341,12 @@ STAGE PLANS:
     Stats-Aggr Operator
 
 PREHOOK: query: INSERT OVERWRITE TABLE insert_into2 PARTITION (ds='2')
-  SELECT * FROM src LIMIT 50
+  SELECT * FROM src order by key LIMIT 50
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
 PREHOOK: Output: default@insert_into2@ds=2
 POSTHOOK: query: INSERT OVERWRITE TABLE insert_into2 PARTITION (ds='2')
-  SELECT * FROM src LIMIT 50
+  SELECT * FROM src order by key LIMIT 50
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 POSTHOOK: Output: default@insert_into2@ds=2
@@ -374,7 +368,7 @@ POSTHOOK: Input: default@insert_into2
 POSTHOOK: Input: default@insert_into2@ds=1
 POSTHOOK: Input: default@insert_into2@ds=2
 #### A masked pattern was here ####
--27100860056
+-33609711132
 PREHOOK: query: explain
 SELECT COUNT(*) FROM insert_into2 WHERE ds='2'
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/insert_nonacid_from_acid.q.out b/ql/src/test/results/clientpositive/insert_nonacid_from_acid.q.out
index 8d36ae46a6..1f613c4d0c 100644
--- a/ql/src/test/results/clientpositive/insert_nonacid_from_acid.q.out
+++ b/ql/src/test/results/clientpositive/insert_nonacid_from_acid.q.out
@@ -1,9 +1,13 @@
-PREHOOK: query: -- This test checks that selecting from an acid table and inserting into a non-acid table works.
+PREHOOK: query: -- SORT_QUERY_RESULTS
+
+-- This test checks that selecting from an acid table and inserting into a non-acid table works.
 create table sample_06(name varchar(50), age int, gpa decimal(3, 2)) clustered by (age) into 2 buckets stored as orc TBLPROPERTIES ("transactional"="true")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@sample_06
-POSTHOOK: query: -- This test checks that selecting from an acid table and inserting into a non-acid table works.
+POSTHOOK: query: -- SORT_QUERY_RESULTS
+
+-- This test checks that selecting from an acid table and inserting into a non-acid table works.
 create table sample_06(name varchar(50), age int, gpa decimal(3, 2)) clustered by (age) into 2 buckets stored as orc TBLPROPERTIES ("transactional"="true")
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -27,11 +31,11 @@ POSTHOOK: query: select * from sample_06 where gpa = 3.00
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@sample_06
 #### A masked pattern was here ####
-eee	32	3
-ccc	32	3
+aaa	35	3
 bbb	32	3
+ccc	32	3
 ddd	35	3
-aaa	35	3
+eee	32	3
 PREHOOK: query: create table tab1 (name varchar(50), age int, gpa decimal(3, 2))
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
@@ -59,8 +63,8 @@ POSTHOOK: query: select * from tab1
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@tab1
 #### A masked pattern was here ####
-eee	32	3
-ccc	32	3
+aaa	35	3
 bbb	32	3
+ccc	32	3
 ddd	35	3
-aaa	35	3
+eee	32	3
diff --git a/ql/src/test/results/clientpositive/join_merge_multi_expressions.q.out b/ql/src/test/results/clientpositive/join_merge_multi_expressions.q.out
index 0bd2a16ce0..b73643e297 100644
--- a/ql/src/test/results/clientpositive/join_merge_multi_expressions.q.out
+++ b/ql/src/test/results/clientpositive/join_merge_multi_expressions.q.out
@@ -1,7 +1,9 @@
-PREHOOK: query: explain
+PREHOOK: query: -- SORT_QUERY_RESULTS
+explain
 select count(*) from srcpart a join srcpart b on a.key = b.key and a.hr = b.hr join srcpart c on a.hr = c.hr and a.key = c.key
 PREHOOK: type: QUERY
-POSTHOOK: query: explain
+POSTHOOK: query: -- SORT_QUERY_RESULTS
+explain
 select count(*) from srcpart a join srcpart b on a.key = b.key and a.hr = b.hr join srcpart c on a.hr = c.hr and a.key = c.key
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
diff --git a/ql/src/test/results/clientpositive/join_nullsafe.q.out b/ql/src/test/results/clientpositive/join_nullsafe.q.out
index 27ceae57d0..b6557a25f4 100644
--- a/ql/src/test/results/clientpositive/join_nullsafe.q.out
+++ b/ql/src/test/results/clientpositive/join_nullsafe.q.out
@@ -78,11 +78,13 @@ STAGE PLANS:
       Processor Tree:
         ListSink
 
-PREHOOK: query: select * from myinput1 a join myinput1 b on a.key<=>b.value
+PREHOOK: query: -- SORT_QUERY_RESULTS
+select * from myinput1 a join myinput1 b on a.key<=>b.value
 PREHOOK: type: QUERY
 PREHOOK: Input: default@myinput1
 #### A masked pattern was here ####
-POSTHOOK: query: select * from myinput1 a join myinput1 b on a.key<=>b.value
+POSTHOOK: query: -- SORT_QUERY_RESULTS
+select * from myinput1 a join myinput1 b on a.key<=>b.value
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@myinput1
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/orc_merge1.q.out b/ql/src/test/results/clientpositive/orc_merge1.q.out
index 2927791dcb..3f047dae20 100644
--- a/ql/src/test/results/clientpositive/orc_merge1.q.out
+++ b/ql/src/test/results/clientpositive/orc_merge1.q.out
@@ -1,6 +1,10 @@
-PREHOOK: query: DROP TABLE orcfile_merge1
+PREHOOK: query: -- SORT_QUERY_RESULTS
+
+DROP TABLE orcfile_merge1
 PREHOOK: type: DROPTABLE
-POSTHOOK: query: DROP TABLE orcfile_merge1
+POSTHOOK: query: -- SORT_QUERY_RESULTS
+
+DROP TABLE orcfile_merge1
 POSTHOOK: type: DROPTABLE
 PREHOOK: query: DROP TABLE orcfile_merge1b
 PREHOOK: type: DROPTABLE
diff --git a/ql/src/test/results/clientpositive/partition_date2.q.out b/ql/src/test/results/clientpositive/partition_date2.q.out
index bf3a59d581..3bd1f495d1 100644
--- a/ql/src/test/results/clientpositive/partition_date2.q.out
+++ b/ql/src/test/results/clientpositive/partition_date2.q.out
@@ -1,6 +1,10 @@
-PREHOOK: query: drop table partition_date2_1
+PREHOOK: query: -- SORT_QUERY_RESULTS
+
+drop table partition_date2_1
 PREHOOK: type: DROPTABLE
-POSTHOOK: query: drop table partition_date2_1
+POSTHOOK: query: -- SORT_QUERY_RESULTS
+
+drop table partition_date2_1
 POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table partition_date2_1 (key string, value string) partitioned by (dt date, region int)
 PREHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/script_env_var1.q.out b/ql/src/test/results/clientpositive/script_env_var1.q.out
index 5ab1c20c9c..cd39eb893d 100644
--- a/ql/src/test/results/clientpositive/script_env_var1.q.out
+++ b/ql/src/test/results/clientpositive/script_env_var1.q.out
@@ -1,16 +1,16 @@
 PREHOOK: query: -- Verifies that script operator ID environment variables have unique values
 -- in each instance of the script operator.
 SELECT count(1) FROM
-( SELECT * FROM (SELECT TRANSFORM('echo $HIVE_SCRIPT_OPERATOR_ID') USING 'sh' AS key FROM src LIMIT 1)x UNION ALL
-  SELECT * FROM (SELECT TRANSFORM('echo $HIVE_SCRIPT_OPERATOR_ID') USING 'sh' AS key FROM src LIMIT 1)y ) a GROUP BY key
+( SELECT * FROM (SELECT TRANSFORM('echo $HIVE_SCRIPT_OPERATOR_ID') USING 'sh' AS key FROM src order by key LIMIT 1)x UNION ALL
+  SELECT * FROM (SELECT TRANSFORM('echo $HIVE_SCRIPT_OPERATOR_ID') USING 'sh' AS key FROM src order by key LIMIT 1)y ) a GROUP BY key
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
 #### A masked pattern was here ####
 POSTHOOK: query: -- Verifies that script operator ID environment variables have unique values
 -- in each instance of the script operator.
 SELECT count(1) FROM
-( SELECT * FROM (SELECT TRANSFORM('echo $HIVE_SCRIPT_OPERATOR_ID') USING 'sh' AS key FROM src LIMIT 1)x UNION ALL
-  SELECT * FROM (SELECT TRANSFORM('echo $HIVE_SCRIPT_OPERATOR_ID') USING 'sh' AS key FROM src LIMIT 1)y ) a GROUP BY key
+( SELECT * FROM (SELECT TRANSFORM('echo $HIVE_SCRIPT_OPERATOR_ID') USING 'sh' AS key FROM src order by key LIMIT 1)x UNION ALL
+  SELECT * FROM (SELECT TRANSFORM('echo $HIVE_SCRIPT_OPERATOR_ID') USING 'sh' AS key FROM src order by key LIMIT 1)y ) a GROUP BY key
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/selectDistinctStar.q.out b/ql/src/test/results/clientpositive/selectDistinctStar.q.out
index 4c8564eba5..8867b8d12f 100644
--- a/ql/src/test/results/clientpositive/selectDistinctStar.q.out
+++ b/ql/src/test/results/clientpositive/selectDistinctStar.q.out
@@ -1,6 +1,10 @@
-PREHOOK: query: explain select distinct src.* from src
+PREHOOK: query: -- SORT_QUERY_RESULTS
+
+explain select distinct src.* from src
 PREHOOK: type: QUERY
-POSTHOOK: query: explain select distinct src.* from src
+POSTHOOK: query: -- SORT_QUERY_RESULTS
+
+explain select distinct src.* from src
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
@@ -1399,6 +1403,13 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 POSTHOOK: Input: default@src1
 #### A masked pattern was here ####
+	
+	val_165
+	val_193
+	val_265
+	val_27
+	val_409
+	val_484
 0	val_0
 10	val_10
 100	val_100
@@ -1416,6 +1427,7 @@ POSTHOOK: Input: default@src1
 120	val_120
 125	val_125
 126	val_126
+128	
 128	val_128
 129	val_129
 131	val_131
@@ -1427,9 +1439,11 @@ POSTHOOK: Input: default@src1
 143	val_143
 145	val_145
 146	val_146
+146	val_146
 149	val_149
 15	val_15
 150	val_150
+150	val_150
 152	val_152
 153	val_153
 155	val_155
@@ -1482,6 +1496,7 @@ POSTHOOK: Input: default@src1
 208	val_208
 209	val_209
 213	val_213
+213	val_213
 214	val_214
 216	val_216
 217	val_217
@@ -1490,6 +1505,7 @@ POSTHOOK: Input: default@src1
 221	val_221
 222	val_222
 223	val_223
+224	
 224	val_224
 226	val_226
 228	val_228
@@ -1499,6 +1515,7 @@ POSTHOOK: Input: default@src1
 235	val_235
 237	val_237
 238	val_238
+238	val_238
 239	val_239
 24	val_24
 241	val_241
@@ -1509,6 +1526,7 @@ POSTHOOK: Input: default@src1
 249	val_249
 252	val_252
 255	val_255
+255	val_255
 256	val_256
 257	val_257
 258	val_258
@@ -1521,10 +1539,12 @@ POSTHOOK: Input: default@src1
 27	val_27
 272	val_272
 273	val_273
+273	val_273
 274	val_274
 275	val_275
 277	val_277
 278	val_278
+278	val_278
 28	val_28
 280	val_280
 281	val_281
@@ -1549,6 +1569,7 @@ POSTHOOK: Input: default@src1
 309	val_309
 310	val_310
 311	val_311
+311	val_311
 315	val_315
 316	val_316
 317	val_317
@@ -1583,6 +1604,7 @@ POSTHOOK: Input: default@src1
 366	val_366
 367	val_367
 368	val_368
+369	
 369	val_369
 37	val_37
 373	val_373
@@ -1605,10 +1627,12 @@ POSTHOOK: Input: default@src1
 4	val_4
 400	val_400
 401	val_401
+401	val_401
 402	val_402
 403	val_403
 404	val_404
 406	val_406
+406	val_406
 407	val_407
 409	val_409
 41	val_41
@@ -1685,6 +1709,7 @@ POSTHOOK: Input: default@src1
 64	val_64
 65	val_65
 66	val_66
+66	val_66
 67	val_67
 69	val_69
 70	val_70
@@ -1708,27 +1733,6 @@ POSTHOOK: Input: default@src1
 96	val_96
 97	val_97
 98	val_98
-	
-	val_165
-	val_193
-	val_265
-	val_27
-	val_409
-	val_484
-128	
-146	val_146
-150	val_150
-213	val_213
-224	
-238	val_238
-255	val_255
-273	val_273
-278	val_278
-311	val_311
-369	
-401	val_401
-406	val_406
-66	val_66
 98	val_98
 PREHOOK: query: select distinct * from src join src1 on src.key=src1.key
 PREHOOK: type: QUERY
@@ -3830,6 +3834,13 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 POSTHOOK: Input: default@src1
 #### A masked pattern was here ####
+	
+	val_165
+	val_193
+	val_265
+	val_27
+	val_409
+	val_484
 0	val_0
 10	val_10
 100	val_100
@@ -3847,6 +3858,7 @@ POSTHOOK: Input: default@src1
 120	val_120
 125	val_125
 126	val_126
+128	
 128	val_128
 129	val_129
 131	val_131
@@ -3858,9 +3870,11 @@ POSTHOOK: Input: default@src1
 143	val_143
 145	val_145
 146	val_146
+146	val_146
 149	val_149
 15	val_15
 150	val_150
+150	val_150
 152	val_152
 153	val_153
 155	val_155
@@ -3913,6 +3927,7 @@ POSTHOOK: Input: default@src1
 208	val_208
 209	val_209
 213	val_213
+213	val_213
 214	val_214
 216	val_216
 217	val_217
@@ -3921,6 +3936,7 @@ POSTHOOK: Input: default@src1
 221	val_221
 222	val_222
 223	val_223
+224	
 224	val_224
 226	val_226
 228	val_228
@@ -3930,6 +3946,7 @@ POSTHOOK: Input: default@src1
 235	val_235
 237	val_237
 238	val_238
+238	val_238
 239	val_239
 24	val_24
 241	val_241
@@ -3940,6 +3957,7 @@ POSTHOOK: Input: default@src1
 249	val_249
 252	val_252
 255	val_255
+255	val_255
 256	val_256
 257	val_257
 258	val_258
@@ -3952,10 +3970,12 @@ POSTHOOK: Input: default@src1
 27	val_27
 272	val_272
 273	val_273
+273	val_273
 274	val_274
 275	val_275
 277	val_277
 278	val_278
+278	val_278
 28	val_28
 280	val_280
 281	val_281
@@ -3980,6 +4000,7 @@ POSTHOOK: Input: default@src1
 309	val_309
 310	val_310
 311	val_311
+311	val_311
 315	val_315
 316	val_316
 317	val_317
@@ -4014,6 +4035,7 @@ POSTHOOK: Input: default@src1
 366	val_366
 367	val_367
 368	val_368
+369	
 369	val_369
 37	val_37
 373	val_373
@@ -4036,10 +4058,12 @@ POSTHOOK: Input: default@src1
 4	val_4
 400	val_400
 401	val_401
+401	val_401
 402	val_402
 403	val_403
 404	val_404
 406	val_406
+406	val_406
 407	val_407
 409	val_409
 41	val_41
@@ -4116,6 +4140,7 @@ POSTHOOK: Input: default@src1
 64	val_64
 65	val_65
 66	val_66
+66	val_66
 67	val_67
 69	val_69
 70	val_70
@@ -4139,27 +4164,6 @@ POSTHOOK: Input: default@src1
 96	val_96
 97	val_97
 98	val_98
-	
-	val_165
-	val_193
-	val_265
-	val_27
-	val_409
-	val_484
-128	
-146	val_146
-150	val_150
-213	val_213
-224	
-238	val_238
-255	val_255
-273	val_273
-278	val_278
-311	val_311
-369	
-401	val_401
-406	val_406
-66	val_66
 98	val_98
 PREHOOK: query: select distinct * from src join src1 on src.key=src1.key
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/skewjoin.q.out b/ql/src/test/results/clientpositive/skewjoin.q.out
index c6f76af694..1b56d5f2fd 100644
--- a/ql/src/test/results/clientpositive/skewjoin.q.out
+++ b/ql/src/test/results/clientpositive/skewjoin.q.out
@@ -1,8 +1,12 @@
-PREHOOK: query: CREATE TABLE T1(key STRING, val STRING) STORED AS TEXTFILE
+PREHOOK: query: -- SORT_QUERY_RESULTS
+
+CREATE TABLE T1(key STRING, val STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@T1
-POSTHOOK: query: CREATE TABLE T1(key STRING, val STRING) STORED AS TEXTFILE
+POSTHOOK: query: -- SORT_QUERY_RESULTS
+
+CREATE TABLE T1(key STRING, val STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@T1
diff --git a/ql/src/test/results/clientpositive/spark/auto_join0.q.out b/ql/src/test/results/clientpositive/spark/auto_join0.q.out
index c3979f4cd2..d4a2301746 100644
--- a/ql/src/test/results/clientpositive/spark/auto_join0.q.out
+++ b/ql/src/test/results/clientpositive/spark/auto_join0.q.out
@@ -1,23 +1,27 @@
-Warning: Map Join MAPJOIN[20][bigTable=?] in task 'Stage-1:MAPRED' is a cross product
-PREHOOK: query: explain 
+Warning: Map Join MAPJOIN[24][bigTable=?] in task 'Stage-1:MAPRED' is a cross product
+PREHOOK: query: -- SORT_QUERY_RESULTS
+
+explain 
 select sum(hash(a.k1,a.v1,a.k2, a.v2))
 from (
 SELECT src1.key as k1, src1.value as v1, 
        src2.key as k2, src2.value as v2 FROM 
-  (SELECT * FROM src WHERE src.key < 10) src1 
+  (SELECT * FROM src WHERE src.key < 10 order by src.key, src.value) src1
     JOIN 
-  (SELECT * FROM src WHERE src.key < 10) src2
+  (SELECT * FROM src WHERE src.key < 10 order by src.key, src.value) src2
   SORT BY k1, v1, k2, v2
 ) a
 PREHOOK: type: QUERY
-POSTHOOK: query: explain 
+POSTHOOK: query: -- SORT_QUERY_RESULTS
+
+explain 
 select sum(hash(a.k1,a.v1,a.k2, a.v2))
 from (
 SELECT src1.key as k1, src1.value as v1, 
        src2.key as k2, src2.value as v2 FROM 
-  (SELECT * FROM src WHERE src.key < 10) src1 
+  (SELECT * FROM src WHERE src.key < 10 order by src.key, src.value) src1
     JOIN 
-  (SELECT * FROM src WHERE src.key < 10) src2
+  (SELECT * FROM src WHERE src.key < 10 order by src.key, src.value) src2
   SORT BY k1, v1, k2, v2
 ) a
 POSTHOOK: type: QUERY
@@ -29,9 +33,11 @@ STAGE DEPENDENCIES:
 STAGE PLANS:
   Stage: Stage-2
     Spark
+      Edges:
+        Reducer 6 <- Map 5 (SORT, 1)
 #### A masked pattern was here ####
       Vertices:
-        Map 4 
+        Map 5 
             Map Operator Tree:
                 TableScan
                   alias: src
@@ -43,18 +49,29 @@ STAGE PLANS:
                       expressions: key (type: string), value (type: string)
                       outputColumnNames: _col0, _col1
                       Statistics: Num rows: 166 Data size: 1763 Basic stats: COMPLETE Column stats: NONE
-                      Spark HashTable Sink Operator
-                        keys:
-                          0 
-                          1 
+                      Reduce Output Operator
+                        key expressions: _col0 (type: string), _col1 (type: string)
+                        sort order: ++
+                        Statistics: Num rows: 166 Data size: 1763 Basic stats: COMPLETE Column stats: NONE
+        Reducer 6 
             Local Work:
               Map Reduce Local Work
+            Reduce Operator Tree:
+              Select Operator
+                expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string)
+                outputColumnNames: _col0, _col1
+                Statistics: Num rows: 166 Data size: 1763 Basic stats: COMPLETE Column stats: NONE
+                Spark HashTable Sink Operator
+                  keys:
+                    0 
+                    1 
 
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (PARTITION-LEVEL SORT, 2)
-        Reducer 3 <- Reducer 2 (GROUP, 1)
+        Reducer 2 <- Map 1 (SORT, 1)
+        Reducer 3 <- Reducer 2 (PARTITION-LEVEL SORT, 2)
+        Reducer 4 <- Reducer 3 (GROUP, 1)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -69,23 +86,33 @@ STAGE PLANS:
                       expressions: key (type: string), value (type: string)
                       outputColumnNames: _col0, _col1
                       Statistics: Num rows: 166 Data size: 1763 Basic stats: COMPLETE Column stats: NONE
-                      Map Join Operator
-                        condition map:
-                             Inner Join 0 to 1
-                        keys:
-                          0 
-                          1 
-                        outputColumnNames: _col0, _col1, _col2, _col3
-                        input vertices:
-                          1 Map 4
-                        Statistics: Num rows: 182 Data size: 1939 Basic stats: COMPLETE Column stats: NONE
-                        Reduce Output Operator
-                          key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string)
-                          sort order: ++++
-                          Statistics: Num rows: 182 Data size: 1939 Basic stats: COMPLETE Column stats: NONE
+                      Reduce Output Operator
+                        key expressions: _col0 (type: string), _col1 (type: string)
+                        sort order: ++
+                        Statistics: Num rows: 166 Data size: 1763 Basic stats: COMPLETE Column stats: NONE
+        Reducer 2 
             Local Work:
               Map Reduce Local Work
-        Reducer 2 
+            Reduce Operator Tree:
+              Select Operator
+                expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string)
+                outputColumnNames: _col0, _col1
+                Statistics: Num rows: 166 Data size: 1763 Basic stats: COMPLETE Column stats: NONE
+                Map Join Operator
+                  condition map:
+                       Inner Join 0 to 1
+                  keys:
+                    0 
+                    1 
+                  outputColumnNames: _col0, _col1, _col2, _col3
+                  input vertices:
+                    1 Reducer 6
+                  Statistics: Num rows: 182 Data size: 1939 Basic stats: COMPLETE Column stats: NONE
+                  Reduce Output Operator
+                    key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string)
+                    sort order: ++++
+                    Statistics: Num rows: 182 Data size: 1939 Basic stats: COMPLETE Column stats: NONE
+        Reducer 3 
             Reduce Operator Tree:
               Select Operator
                 expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), KEY.reducesinkkey2 (type: string), KEY.reducesinkkey3 (type: string)
@@ -100,7 +127,7 @@ STAGE PLANS:
                     sort order: 
                     Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                     value expressions: _col0 (type: bigint)
-        Reducer 3 
+        Reducer 4 
             Reduce Operator Tree:
               Group By Operator
                 aggregations: sum(VALUE._col0)
@@ -121,14 +148,14 @@ STAGE PLANS:
       Processor Tree:
         ListSink
 
-Warning: Map Join MAPJOIN[20][bigTable=?] in task 'Stage-1:MAPRED' is a cross product
+Warning: Map Join MAPJOIN[24][bigTable=?] in task 'Stage-1:MAPRED' is a cross product
 PREHOOK: query: select sum(hash(a.k1,a.v1,a.k2, a.v2))
 from (
 SELECT src1.key as k1, src1.value as v1, 
        src2.key as k2, src2.value as v2 FROM 
-  (SELECT * FROM src WHERE src.key < 10) src1 
+  (SELECT * FROM src WHERE src.key < 10 order by src.key, src.value) src1
     JOIN 
-  (SELECT * FROM src WHERE src.key < 10) src2
+  (SELECT * FROM src WHERE src.key < 10 order by src.key, src.value) src2
   SORT BY k1, v1, k2, v2
 ) a
 PREHOOK: type: QUERY
@@ -138,9 +165,9 @@ POSTHOOK: query: select sum(hash(a.k1,a.v1,a.k2, a.v2))
 from (
 SELECT src1.key as k1, src1.value as v1, 
        src2.key as k2, src2.value as v2 FROM 
-  (SELECT * FROM src WHERE src.key < 10) src1 
+  (SELECT * FROM src WHERE src.key < 10 order by src.key, src.value) src1
     JOIN 
-  (SELECT * FROM src WHERE src.key < 10) src2
+  (SELECT * FROM src WHERE src.key < 10 order by src.key, src.value) src2
   SORT BY k1, v1, k2, v2
 ) a
 POSTHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/spark/auto_join1.q.out b/ql/src/test/results/clientpositive/spark/auto_join1.q.out
index b640b9df58..d9215f85b5 100644
--- a/ql/src/test/results/clientpositive/spark/auto_join1.q.out
+++ b/ql/src/test/results/clientpositive/spark/auto_join1.q.out
@@ -1,8 +1,12 @@
-PREHOOK: query: CREATE TABLE dest_j1(key INT, value STRING) STORED AS TEXTFILE
+PREHOOK: query: -- SORT_QUERY_RESULTS
+
+CREATE TABLE dest_j1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@dest_j1
-POSTHOOK: query: CREATE TABLE dest_j1(key INT, value STRING) STORED AS TEXTFILE
+POSTHOOK: query: -- SORT_QUERY_RESULTS
+
+CREATE TABLE dest_j1(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@dest_j1
diff --git a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_5.q.out b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_5.q.out
index 3eceb0bc65..e3a5710cd8 100644
--- a/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_5.q.out
+++ b/ql/src/test/results/clientpositive/spark/auto_sortmerge_join_5.q.out
@@ -1,9 +1,15 @@
 PREHOOK: query: -- small no part, 4 bucket & big no part, 2 bucket
+
+-- SORT_QUERY_RESULTS
+
 CREATE TABLE bucket_small (key string, value string) CLUSTERED BY (key) SORTED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@bucket_small
 POSTHOOK: query: -- small no part, 4 bucket & big no part, 2 bucket
+
+-- SORT_QUERY_RESULTS
+
 CREATE TABLE bucket_small (key string, value string) CLUSTERED BY (key) SORTED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/spark/cbo_gby.q.out b/ql/src/test/results/clientpositive/spark/cbo_gby.q.out
index 9ca8a881cb..04597a7bfb 100644
--- a/ql/src/test/results/clientpositive/spark/cbo_gby.q.out
+++ b/ql/src/test/results/clientpositive/spark/cbo_gby.q.out
@@ -1,20 +1,24 @@
-PREHOOK: query: -- 6. Test Select + TS + Join + Fil + GB + GB Having
+PREHOOK: query: -- SORT_QUERY_RESULTS
+
+-- 6. Test Select + TS + Join + Fil + GB + GB Having
 select key, (c_int+1)+2 as x, sum(c_int) from cbo_t1 group by c_float, cbo_t1.c_int, key
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cbo_t1
 PREHOOK: Input: default@cbo_t1@dt=2014
 #### A masked pattern was here ####
-POSTHOOK: query: -- 6. Test Select + TS + Join + Fil + GB + GB Having
+POSTHOOK: query: -- SORT_QUERY_RESULTS
+
+-- 6. Test Select + TS + Join + Fil + GB + GB Having
 select key, (c_int+1)+2 as x, sum(c_int) from cbo_t1 group by c_float, cbo_t1.c_int, key
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@cbo_t1
 POSTHOOK: Input: default@cbo_t1@dt=2014
 #### A masked pattern was here ####
-1	4	12
- 1 	4	2
-NULL	NULL	NULL
  1	4	2
+ 1 	4	2
+1	4	12
 1 	4	2
+NULL	NULL	NULL
 PREHOOK: query: select x, y, count(*) from (select key, (c_int+c_float+1+2) as x, sum(c_int) as y from cbo_t1 group by c_float, cbo_t1.c_int, key) R group by y, x
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cbo_t1
@@ -25,9 +29,9 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@cbo_t1
 POSTHOOK: Input: default@cbo_t1@dt=2014
 #### A masked pattern was here ####
+5.0	12	1
 5.0	2	3
 NULL	NULL	1
-5.0	12	1
 PREHOOK: query: select cbo_t3.c_int, c, count(*) from (select key as a, c_int+1 as b, sum(c_int) as c from cbo_t1 where (cbo_t1.c_int + 1 >= 0) and (cbo_t1.c_int > 0 or cbo_t1.c_float >= 0) group by c_float, cbo_t1.c_int, key order by a) cbo_t1 join (select key as p, c_int+1 as q, sum(c_int) as r from cbo_t2 where (cbo_t2.c_int + 1 >= 0) and (cbo_t2.c_int > 0 or cbo_t2.c_float >= 0)  group by c_float, cbo_t2.c_int, key order by q/10 desc, r asc) cbo_t2 on cbo_t1.a=p join cbo_t3 on cbo_t1.a=key where (b + cbo_t2.q >= 0) and (b > 0 or c_int >= 0) group by cbo_t3.c_int, c order by cbo_t3.c_int+c desc, c
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cbo_t1
@@ -62,8 +66,8 @@ POSTHOOK: Input: default@cbo_t2
 POSTHOOK: Input: default@cbo_t2@dt=2014
 POSTHOOK: Input: default@cbo_t3
 #### A masked pattern was here ####
-1	2	6
 1	12	6
+1	2	6
 PREHOOK: query: select cbo_t3.c_int, c, count(*) from (select key as a, c_int+1 as b, sum(c_int) as c from cbo_t1 where (cbo_t1.c_int + 1 >= 0) and (cbo_t1.c_int > 0 or cbo_t1.c_float >= 0)  group by c_float, cbo_t1.c_int, key having cbo_t1.c_float > 0 and (c_int >=1 or c_float >= 1) and (c_int + c_float) >= 0 order by b+c, a desc) cbo_t1 right outer join (select key as p, c_int+1 as q, sum(c_int) as r from cbo_t2 where (cbo_t2.c_int + 1 >= 0) and (cbo_t2.c_int > 0 or cbo_t2.c_float >= 0)  group by c_float, cbo_t2.c_int, key having cbo_t2.c_float > 0 and (c_int >=1 or c_float >= 1) and (c_int + c_float) >= 0) cbo_t2 on cbo_t1.a=p right outer join cbo_t3 on cbo_t1.a=key where (b + cbo_t2.q >= 2) and (b > 0 or c_int >= 0) group by cbo_t3.c_int, c
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cbo_t1
@@ -80,8 +84,8 @@ POSTHOOK: Input: default@cbo_t2
 POSTHOOK: Input: default@cbo_t2@dt=2014
 POSTHOOK: Input: default@cbo_t3
 #### A masked pattern was here ####
-1	2	6
 1	12	6
+1	2	6
 PREHOOK: query: select cbo_t3.c_int, c, count(*) from (select key as a, c_int+1 as b, sum(c_int) as c from cbo_t1 where (cbo_t1.c_int + 1 >= 0) and (cbo_t1.c_int > 0 or cbo_t1.c_float >= 0)  group by c_float, cbo_t1.c_int, key having cbo_t1.c_float > 0 and (c_int >=1 or c_float >= 1) and (c_int + c_float) >= 0 order by c+a desc) cbo_t1 full outer join (select key as p, c_int+1 as q, sum(c_int) as r from cbo_t2 where (cbo_t2.c_int + 1 >= 0) and (cbo_t2.c_int > 0 or cbo_t2.c_float >= 0)  group by c_float, cbo_t2.c_int, key having cbo_t2.c_float > 0 and (c_int >=1 or c_float >= 1) and (c_int + c_float) >= 0 order by p+q desc, r asc) cbo_t2 on cbo_t1.a=p full outer join cbo_t3 on cbo_t1.a=key where (b + cbo_t2.q >= 0) and (b > 0 or c_int >= 0) group by cbo_t3.c_int, c having cbo_t3.c_int > 0 and (c_int >=1 or c >= 1) and (c_int + c) >= 0 order by cbo_t3.c_int
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cbo_t1
@@ -98,8 +102,8 @@ POSTHOOK: Input: default@cbo_t2
 POSTHOOK: Input: default@cbo_t2@dt=2014
 POSTHOOK: Input: default@cbo_t3
 #### A masked pattern was here ####
-1	2	6
 1	12	6
+1	2	6
 PREHOOK: query: select cbo_t3.c_int, c, count(*) from (select key as a, c_int+1 as b, sum(c_int) as c from cbo_t1 where (cbo_t1.c_int + 1 >= 0) and (cbo_t1.c_int > 0 or cbo_t1.c_float >= 0)  group by c_float, cbo_t1.c_int, key having cbo_t1.c_float > 0 and (c_int >=1 or c_float >= 1) and (c_int + c_float) >= 0) cbo_t1 join (select key as p, c_int+1 as q, sum(c_int) as r from cbo_t2 where (cbo_t2.c_int + 1 >= 0) and (cbo_t2.c_int > 0 or cbo_t2.c_float >= 0)  group by c_float, cbo_t2.c_int, key having cbo_t2.c_float > 0 and (c_int >=1 or c_float >= 1) and (c_int + c_float) >= 0) cbo_t2 on cbo_t1.a=p join cbo_t3 on cbo_t1.a=key where (b + cbo_t2.q >= 0) and (b > 0 or c_int >= 0) group by cbo_t3.c_int, c
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cbo_t1
@@ -116,5 +120,5 @@ POSTHOOK: Input: default@cbo_t2
 POSTHOOK: Input: default@cbo_t2@dt=2014
 POSTHOOK: Input: default@cbo_t3
 #### A masked pattern was here ####
-1	2	6
 1	12	6
+1	2	6
diff --git a/ql/src/test/results/clientpositive/spark/cbo_udf_udaf.q.out b/ql/src/test/results/clientpositive/spark/cbo_udf_udaf.q.out
index ded043f626..156d02f31e 100644
--- a/ql/src/test/results/clientpositive/spark/cbo_udf_udaf.q.out
+++ b/ql/src/test/results/clientpositive/spark/cbo_udf_udaf.q.out
@@ -1,10 +1,14 @@
-PREHOOK: query: -- 8. Test UDF/UDAF
+PREHOOK: query: -- SORT_QUERY_RESULTS
+
+-- 8. Test UDF/UDAF
 select count(*), count(c_int), sum(c_int), avg(c_int), max(c_int), min(c_int) from cbo_t1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cbo_t1
 PREHOOK: Input: default@cbo_t1@dt=2014
 #### A masked pattern was here ####
-POSTHOOK: query: -- 8. Test UDF/UDAF
+POSTHOOK: query: -- SORT_QUERY_RESULTS
+
+-- 8. Test UDF/UDAF
 select count(*), count(c_int), sum(c_int), avg(c_int), max(c_int), min(c_int) from cbo_t1
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@cbo_t1
@@ -21,8 +25,8 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@cbo_t1
 POSTHOOK: Input: default@cbo_t1@dt=2014
 #### A masked pattern was here ####
-2	0	NULL	NULL	NULL	NULL	3	6
 18	18	18	1.0	1	1	2	36
+2	0	NULL	NULL	NULL	NULL	3	6
 PREHOOK: query: select * from (select count(*) as a, count(distinct c_int) as b, sum(c_int) as c, avg(c_int) as d, max(c_int) as e, min(c_int) as f from cbo_t1) cbo_t1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cbo_t1
@@ -44,8 +48,8 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@cbo_t1
 POSTHOOK: Input: default@cbo_t1@dt=2014
 #### A masked pattern was here ####
-2	0	NULL	NULL	NULL	NULL	3	6
 18	1	18	1.0	1	1	2	36
+2	0	NULL	NULL	NULL	NULL	3	6
 PREHOOK: query: select f,a,e,b from (select count(*) as a, count(c_int) as b, sum(c_int) as c, avg(c_int) as d, max(c_int) as e, min(c_int) as f from cbo_t1) cbo_t1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cbo_t1
@@ -78,11 +82,11 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@cbo_t1
 POSTHOOK: Input: default@cbo_t1@dt=2014
 #### A masked pattern was here ####
-NULL	0	NULL
-1 	2	1.0
- 1 	2	1.0
  1	2	1.0
+ 1 	2	1.0
 1	12	1.0
+1 	2	1.0
+NULL	0	NULL
 PREHOOK: query: select count(distinct c_int) as a, avg(c_float) from cbo_t1 group by c_float order by a
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cbo_t1
diff --git a/ql/src/test/results/clientpositive/spark/cross_product_check_1.q.out b/ql/src/test/results/clientpositive/spark/cross_product_check_1.q.out
index bd4b5cb01a..ff5891087d 100644
--- a/ql/src/test/results/clientpositive/spark/cross_product_check_1.q.out
+++ b/ql/src/test/results/clientpositive/spark/cross_product_check_1.q.out
@@ -1,10 +1,14 @@
-PREHOOK: query: create table A as
+PREHOOK: query: -- SORT_QUERY_RESULTS
+
+create table A as
 select * from src
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
 PREHOOK: Output: database:default
 PREHOOK: Output: default@A
-POSTHOOK: query: create table A as
+POSTHOOK: query: -- SORT_QUERY_RESULTS
+
+create table A as
 select * from src
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
@@ -185,12 +189,12 @@ STAGE PLANS:
 Warning: Shuffle Join JOIN[16][tables = [a, od1]] in Work 'Reducer 4' is a cross product
 PREHOOK: query: explain select * from A join 
          (select d1.key 
-          from B d1 join B d2 on d1.key = d2.key 
+          from B d1 join B d2 on d1.key = d2.key
           where 1 = 1 group by d1.key) od1
 PREHOOK: type: QUERY
 POSTHOOK: query: explain select * from A join 
          (select d1.key 
-          from B d1 join B d2 on d1.key = d2.key 
+          from B d1 join B d2 on d1.key = d2.key
           where 1 = 1 group by d1.key) od1
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
@@ -302,9 +306,9 @@ STAGE PLANS:
 
 Warning: Shuffle Join JOIN[4][tables = [d1, d2]] in Work 'Reducer 2' is a cross product
 Warning: Shuffle Join JOIN[14][tables = [a, od1]] in Work 'Reducer 4' is a cross product
-PREHOOK: query: explain select * from A join (select d1.key from B d1 join B d2 where 1 = 1 group by d1.key) od1
+PREHOOK: query: explain select * from A join (select d1.key from B d1 join B d2 where 1 = 1  group by d1.key) od1
 PREHOOK: type: QUERY
-POSTHOOK: query: explain select * from A join (select d1.key from B d1 join B d2 where 1 = 1 group by d1.key) od1
+POSTHOOK: query: explain select * from A join (select d1.key from B d1 join B d2 where 1 = 1  group by d1.key) od1
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
@@ -406,11 +410,11 @@ STAGE PLANS:
 
 Warning: Shuffle Join JOIN[21][tables = [ss, od1]] in Work 'Reducer 3' is a cross product
 PREHOOK: query: explain select * from 
-(select A.key from A group by key) ss join 
+(select A.key from A  group by key) ss join
 (select d1.key from B d1 join B d2 on d1.key = d2.key where 1 = 1 group by d1.key) od1
 PREHOOK: type: QUERY
 POSTHOOK: query: explain select * from 
-(select A.key from A group by key) ss join 
+(select A.key from A  group by key) ss join
 (select d1.key from B d1 join B d2 on d1.key = d2.key where 1 = 1 group by d1.key) od1
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
diff --git a/ql/src/test/results/clientpositive/spark/cross_product_check_2.q.out b/ql/src/test/results/clientpositive/spark/cross_product_check_2.q.out
index 7f3f13013a..6c4e659496 100644
--- a/ql/src/test/results/clientpositive/spark/cross_product_check_2.q.out
+++ b/ql/src/test/results/clientpositive/spark/cross_product_check_2.q.out
@@ -1,24 +1,28 @@
-PREHOOK: query: create table A as
+PREHOOK: query: -- SORT_QUERY_RESULTS
+
+create table A as
 select * from src
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
 PREHOOK: Output: database:default
 PREHOOK: Output: default@A
-POSTHOOK: query: create table A as
+POSTHOOK: query: -- SORT_QUERY_RESULTS
+
+create table A as
 select * from src
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@A
 PREHOOK: query: create table B as
-select * from src
+select * from src order by key
 limit 10
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
 PREHOOK: Output: database:default
 PREHOOK: Output: default@B
 POSTHOOK: query: create table B as
-select * from src
+select * from src order by key
 limit 10
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
@@ -43,7 +47,7 @@ STAGE PLANS:
             Map Operator Tree:
                 TableScan
                   alias: b
-                  Statistics: Num rows: 10 Data size: 104 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 10 Data size: 96 Basic stats: COMPLETE Column stats: NONE
                   Spark HashTable Sink Operator
                     keys:
                       0 
@@ -110,10 +114,10 @@ STAGE PLANS:
             Map Operator Tree:
                 TableScan
                   alias: d2
-                  Statistics: Num rows: 10 Data size: 104 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 10 Data size: 96 Basic stats: COMPLETE Column stats: NONE
                   Filter Operator
                     predicate: key is not null (type: boolean)
-                    Statistics: Num rows: 5 Data size: 52 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 5 Data size: 48 Basic stats: COMPLETE Column stats: NONE
                     Spark HashTable Sink Operator
                       keys:
                         0 key (type: string)
@@ -129,10 +133,10 @@ STAGE PLANS:
             Map Operator Tree:
                 TableScan
                   alias: d1
-                  Statistics: Num rows: 10 Data size: 104 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 10 Data size: 96 Basic stats: COMPLETE Column stats: NONE
                   Filter Operator
                     predicate: key is not null (type: boolean)
-                    Statistics: Num rows: 5 Data size: 52 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 5 Data size: 48 Basic stats: COMPLETE Column stats: NONE
                     Map Join Operator
                       condition map:
                            Inner Join 0 to 1
@@ -142,7 +146,7 @@ STAGE PLANS:
                       outputColumnNames: _col0, _col1, _col5, _col6
                       input vertices:
                         1 Map 2
-                      Statistics: Num rows: 5 Data size: 57 Basic stats: COMPLETE Column stats: NONE
+                      Statistics: Num rows: 5 Data size: 52 Basic stats: COMPLETE Column stats: NONE
                       Spark HashTable Sink Operator
                         keys:
                           0 
@@ -215,10 +219,10 @@ STAGE PLANS:
             Map Operator Tree:
                 TableScan
                   alias: d2
-                  Statistics: Num rows: 10 Data size: 104 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 10 Data size: 96 Basic stats: COMPLETE Column stats: NONE
                   Filter Operator
                     predicate: key is not null (type: boolean)
-                    Statistics: Num rows: 5 Data size: 52 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 5 Data size: 48 Basic stats: COMPLETE Column stats: NONE
                     Spark HashTable Sink Operator
                       keys:
                         0 key (type: string)
@@ -236,10 +240,10 @@ STAGE PLANS:
             Map Operator Tree:
                 TableScan
                   alias: d1
-                  Statistics: Num rows: 10 Data size: 104 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 10 Data size: 96 Basic stats: COMPLETE Column stats: NONE
                   Filter Operator
                     predicate: key is not null (type: boolean)
-                    Statistics: Num rows: 5 Data size: 52 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 5 Data size: 48 Basic stats: COMPLETE Column stats: NONE
                     Map Join Operator
                       condition map:
                            Inner Join 0 to 1
@@ -249,17 +253,17 @@ STAGE PLANS:
                       outputColumnNames: _col0
                       input vertices:
                         1 Map 3
-                      Statistics: Num rows: 5 Data size: 57 Basic stats: COMPLETE Column stats: NONE
+                      Statistics: Num rows: 5 Data size: 52 Basic stats: COMPLETE Column stats: NONE
                       Group By Operator
                         keys: _col0 (type: string)
                         mode: hash
                         outputColumnNames: _col0
-                        Statistics: Num rows: 5 Data size: 57 Basic stats: COMPLETE Column stats: NONE
+                        Statistics: Num rows: 5 Data size: 52 Basic stats: COMPLETE Column stats: NONE
                         Reduce Output Operator
                           key expressions: _col0 (type: string)
                           sort order: +
                           Map-reduce partition columns: _col0 (type: string)
-                          Statistics: Num rows: 5 Data size: 57 Basic stats: COMPLETE Column stats: NONE
+                          Statistics: Num rows: 5 Data size: 52 Basic stats: COMPLETE Column stats: NONE
             Local Work:
               Map Reduce Local Work
         Reducer 2 
@@ -270,7 +274,7 @@ STAGE PLANS:
                 keys: KEY._col0 (type: string)
                 mode: mergepartial
                 outputColumnNames: _col0
-                Statistics: Num rows: 2 Data size: 22 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 2 Data size: 20 Basic stats: COMPLETE Column stats: NONE
                 Spark HashTable Sink Operator
                   keys:
                     0 
@@ -336,7 +340,7 @@ STAGE PLANS:
             Map Operator Tree:
                 TableScan
                   alias: d2
-                  Statistics: Num rows: 10 Data size: 104 Basic stats: COMPLETE Column stats: COMPLETE
+                  Statistics: Num rows: 10 Data size: 96 Basic stats: COMPLETE Column stats: COMPLETE
                   Spark HashTable Sink Operator
                     keys:
                       0 
@@ -354,7 +358,7 @@ STAGE PLANS:
             Map Operator Tree:
                 TableScan
                   alias: d1
-                  Statistics: Num rows: 10 Data size: 104 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 10 Data size: 96 Basic stats: COMPLETE Column stats: NONE
                   Map Join Operator
                     condition map:
                          Inner Join 0 to 1
@@ -364,17 +368,17 @@ STAGE PLANS:
                     outputColumnNames: _col0
                     input vertices:
                       1 Map 3
-                    Statistics: Num rows: 11 Data size: 114 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 11 Data size: 105 Basic stats: COMPLETE Column stats: NONE
                     Group By Operator
                       keys: _col0 (type: string)
                       mode: hash
                       outputColumnNames: _col0
-                      Statistics: Num rows: 11 Data size: 114 Basic stats: COMPLETE Column stats: NONE
+                      Statistics: Num rows: 11 Data size: 105 Basic stats: COMPLETE Column stats: NONE
                       Reduce Output Operator
                         key expressions: _col0 (type: string)
                         sort order: +
                         Map-reduce partition columns: _col0 (type: string)
-                        Statistics: Num rows: 11 Data size: 114 Basic stats: COMPLETE Column stats: NONE
+                        Statistics: Num rows: 11 Data size: 105 Basic stats: COMPLETE Column stats: NONE
             Local Work:
               Map Reduce Local Work
         Reducer 2 
@@ -385,7 +389,7 @@ STAGE PLANS:
                 keys: KEY._col0 (type: string)
                 mode: mergepartial
                 outputColumnNames: _col0
-                Statistics: Num rows: 5 Data size: 51 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 5 Data size: 47 Basic stats: COMPLETE Column stats: NONE
                 Spark HashTable Sink Operator
                   keys:
                     0 
@@ -454,10 +458,10 @@ STAGE PLANS:
             Map Operator Tree:
                 TableScan
                   alias: d2
-                  Statistics: Num rows: 10 Data size: 104 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 10 Data size: 96 Basic stats: COMPLETE Column stats: NONE
                   Filter Operator
                     predicate: key is not null (type: boolean)
-                    Statistics: Num rows: 5 Data size: 52 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 5 Data size: 48 Basic stats: COMPLETE Column stats: NONE
                     Spark HashTable Sink Operator
                       keys:
                         0 key (type: string)
@@ -475,10 +479,10 @@ STAGE PLANS:
             Map Operator Tree:
                 TableScan
                   alias: d1
-                  Statistics: Num rows: 10 Data size: 104 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 10 Data size: 96 Basic stats: COMPLETE Column stats: NONE
                   Filter Operator
                     predicate: key is not null (type: boolean)
-                    Statistics: Num rows: 5 Data size: 52 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 5 Data size: 48 Basic stats: COMPLETE Column stats: NONE
                     Map Join Operator
                       condition map:
                            Inner Join 0 to 1
@@ -488,17 +492,17 @@ STAGE PLANS:
                       outputColumnNames: _col0
                       input vertices:
                         1 Map 5
-                      Statistics: Num rows: 5 Data size: 57 Basic stats: COMPLETE Column stats: NONE
+                      Statistics: Num rows: 5 Data size: 52 Basic stats: COMPLETE Column stats: NONE
                       Group By Operator
                         keys: _col0 (type: string)
                         mode: hash
                         outputColumnNames: _col0
-                        Statistics: Num rows: 5 Data size: 57 Basic stats: COMPLETE Column stats: NONE
+                        Statistics: Num rows: 5 Data size: 52 Basic stats: COMPLETE Column stats: NONE
                         Reduce Output Operator
                           key expressions: _col0 (type: string)
                           sort order: +
                           Map-reduce partition columns: _col0 (type: string)
-                          Statistics: Num rows: 5 Data size: 57 Basic stats: COMPLETE Column stats: NONE
+                          Statistics: Num rows: 5 Data size: 52 Basic stats: COMPLETE Column stats: NONE
             Local Work:
               Map Reduce Local Work
         Reducer 4 
@@ -509,7 +513,7 @@ STAGE PLANS:
                 keys: KEY._col0 (type: string)
                 mode: mergepartial
                 outputColumnNames: _col0
-                Statistics: Num rows: 2 Data size: 22 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 2 Data size: 20 Basic stats: COMPLETE Column stats: NONE
                 Spark HashTable Sink Operator
                   keys:
                     0 
diff --git a/ql/src/test/results/clientpositive/spark/ctas.q.out b/ql/src/test/results/clientpositive/spark/ctas.q.out
index bcd663a695..cebe3ab6d1 100644
--- a/ql/src/test/results/clientpositive/spark/ctas.q.out
+++ b/ql/src/test/results/clientpositive/spark/ctas.q.out
@@ -1,10 +1,12 @@
 PREHOOK: query: -- EXCLUDE_HADOOP_MAJOR_VERSIONS( 0.20S)
+-- SORT_QUERY_RESULTS
 
 create table nzhang_Tmp(a int, b string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@nzhang_Tmp
 POSTHOOK: query: -- EXCLUDE_HADOOP_MAJOR_VERSIONS( 0.20S)
+-- SORT_QUERY_RESULTS
 
 create table nzhang_Tmp(a int, b string)
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/spark/filter_join_breaktask2.q.out b/ql/src/test/results/clientpositive/spark/filter_join_breaktask2.q.out
index 6a2396e946..af85af972e 100644
--- a/ql/src/test/results/clientpositive/spark/filter_join_breaktask2.q.out
+++ b/ql/src/test/results/clientpositive/spark/filter_join_breaktask2.q.out
@@ -1,9 +1,13 @@
-PREHOOK: query: create table T1(c1 string, c2 string, c3 string, c4 string, c5 string, c6 string, c7 string) 
+PREHOOK: query: -- SORT_QUERY_RESULTS
+
+create table T1(c1 string, c2 string, c3 string, c4 string, c5 string, c6 string, c7 string) 
 partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@T1
-POSTHOOK: query: create table T1(c1 string, c2 string, c3 string, c4 string, c5 string, c6 string, c7 string) 
+POSTHOOK: query: -- SORT_QUERY_RESULTS
+
+create table T1(c1 string, c2 string, c3 string, c4 string, c5 string, c6 string, c7 string) 
 partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/spark/insert_into1.q.out b/ql/src/test/results/clientpositive/spark/insert_into1.q.out
index e7f7d8f3da..f407c8d0ee 100644
--- a/ql/src/test/results/clientpositive/spark/insert_into1.q.out
+++ b/ql/src/test/results/clientpositive/spark/insert_into1.q.out
@@ -1,6 +1,10 @@
-PREHOOK: query: DROP TABLE insert_into1
+PREHOOK: query: -- SORT_QUERY_RESULTS
+
+DROP TABLE insert_into1
 PREHOOK: type: DROPTABLE
-POSTHOOK: query: DROP TABLE insert_into1
+POSTHOOK: query: -- SORT_QUERY_RESULTS
+
+DROP TABLE insert_into1
 POSTHOOK: type: DROPTABLE
 PREHOOK: query: CREATE TABLE insert_into1 (key int, value string)
 PREHOOK: type: CREATETABLE
@@ -10,9 +14,9 @@ POSTHOOK: query: CREATE TABLE insert_into1 (key int, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@insert_into1
-PREHOOK: query: EXPLAIN INSERT INTO TABLE insert_into1 SELECT * from src LIMIT 100
+PREHOOK: query: EXPLAIN INSERT INTO TABLE insert_into1 SELECT * from src ORDER BY key LIMIT 100
 PREHOOK: type: QUERY
-POSTHOOK: query: EXPLAIN INSERT INTO TABLE insert_into1 SELECT * from src LIMIT 100
+POSTHOOK: query: EXPLAIN INSERT INTO TABLE insert_into1 SELECT * from src ORDER BY key LIMIT 100
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
@@ -23,7 +27,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 1)
+        Reducer 2 <- Map 1 (SORT, 1)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -35,19 +39,17 @@ STAGE PLANS:
                     expressions: key (type: string), value (type: string)
                     outputColumnNames: _col0, _col1
                     Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
-                    Limit
-                      Number of rows: 100
-                      Statistics: Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
-                      Reduce Output Operator
-                        sort order: 
-                        Statistics: Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
-                        value expressions: _col0 (type: string), _col1 (type: string)
+                    Reduce Output Operator
+                      key expressions: _col0 (type: string)
+                      sort order: +
+                      Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
+                      value expressions: _col1 (type: string)
         Reducer 2 
             Reduce Operator Tree:
               Select Operator
-                expressions: VALUE._col0 (type: string), VALUE._col1 (type: string)
+                expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string)
                 outputColumnNames: _col0, _col1
-                Statistics: Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                 Limit
                   Number of rows: 100
                   Statistics: Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
@@ -77,11 +79,11 @@ STAGE PLANS:
   Stage: Stage-2
     Stats-Aggr Operator
 
-PREHOOK: query: INSERT INTO TABLE insert_into1 SELECT * from src LIMIT 100
+PREHOOK: query: INSERT INTO TABLE insert_into1 SELECT * from src ORDER BY key LIMIT 100
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
 PREHOOK: Output: default@insert_into1
-POSTHOOK: query: INSERT INTO TABLE insert_into1 SELECT * from src LIMIT 100
+POSTHOOK: query: INSERT INTO TABLE insert_into1 SELECT * from src ORDER BY key LIMIT 100
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 POSTHOOK: Output: default@insert_into1
@@ -99,7 +101,7 @@ POSTHOOK: query: SELECT SUM(HASH(c)) FROM (
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@insert_into1
 #### A masked pattern was here ####
-10226524244
+-1142373758
 PREHOOK: query: explain 
 select count(*) from insert_into1
 PREHOOK: type: QUERY
@@ -125,9 +127,9 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@insert_into1
 #### A masked pattern was here ####
 100
-PREHOOK: query: EXPLAIN INSERT INTO TABLE insert_into1 SELECT * FROM src LIMIT 100
+PREHOOK: query: EXPLAIN INSERT INTO TABLE insert_into1 SELECT * FROM src ORDER BY key LIMIT 100
 PREHOOK: type: QUERY
-POSTHOOK: query: EXPLAIN INSERT INTO TABLE insert_into1 SELECT * FROM src LIMIT 100
+POSTHOOK: query: EXPLAIN INSERT INTO TABLE insert_into1 SELECT * FROM src ORDER BY key LIMIT 100
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
@@ -138,7 +140,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 1)
+        Reducer 2 <- Map 1 (SORT, 1)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -150,19 +152,17 @@ STAGE PLANS:
                     expressions: key (type: string), value (type: string)
                     outputColumnNames: _col0, _col1
                     Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
-                    Limit
-                      Number of rows: 100
-                      Statistics: Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
-                      Reduce Output Operator
-                        sort order: 
-                        Statistics: Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
-                        value expressions: _col0 (type: string), _col1 (type: string)
+                    Reduce Output Operator
+                      key expressions: _col0 (type: string)
+                      sort order: +
+                      Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
+                      value expressions: _col1 (type: string)
         Reducer 2 
             Reduce Operator Tree:
               Select Operator
-                expressions: VALUE._col0 (type: string), VALUE._col1 (type: string)
+                expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string)
                 outputColumnNames: _col0, _col1
-                Statistics: Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                 Limit
                   Number of rows: 100
                   Statistics: Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
@@ -192,11 +192,11 @@ STAGE PLANS:
   Stage: Stage-2
     Stats-Aggr Operator
 
-PREHOOK: query: INSERT INTO TABLE insert_into1 SELECT * FROM src LIMIT 100
+PREHOOK: query: INSERT INTO TABLE insert_into1 SELECT * FROM src ORDER BY key LIMIT 100
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
 PREHOOK: Output: default@insert_into1
-POSTHOOK: query: INSERT INTO TABLE insert_into1 SELECT * FROM src LIMIT 100
+POSTHOOK: query: INSERT INTO TABLE insert_into1 SELECT * FROM src ORDER BY key LIMIT 100
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 POSTHOOK: Output: default@insert_into1
@@ -214,7 +214,7 @@ POSTHOOK: query: SELECT SUM(HASH(c)) FROM (
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@insert_into1
 #### A masked pattern was here ####
-20453048488
+-2284747516
 PREHOOK: query: explain
 SELECT COUNT(*) FROM insert_into1
 PREHOOK: type: QUERY
@@ -240,9 +240,9 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@insert_into1
 #### A masked pattern was here ####
 200
-PREHOOK: query: EXPLAIN INSERT OVERWRITE TABLE insert_into1 SELECT * FROM src LIMIT 10
+PREHOOK: query: EXPLAIN INSERT OVERWRITE TABLE insert_into1 SELECT * FROM src ORDER BY key LIMIT 10
 PREHOOK: type: QUERY
-POSTHOOK: query: EXPLAIN INSERT OVERWRITE TABLE insert_into1 SELECT * FROM src LIMIT 10
+POSTHOOK: query: EXPLAIN INSERT OVERWRITE TABLE insert_into1 SELECT * FROM src ORDER BY key LIMIT 10
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
@@ -253,7 +253,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 1)
+        Reducer 2 <- Map 1 (SORT, 1)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -265,19 +265,17 @@ STAGE PLANS:
                     expressions: key (type: string), value (type: string)
                     outputColumnNames: _col0, _col1
                     Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
-                    Limit
-                      Number of rows: 10
-                      Statistics: Num rows: 10 Data size: 100 Basic stats: COMPLETE Column stats: NONE
-                      Reduce Output Operator
-                        sort order: 
-                        Statistics: Num rows: 10 Data size: 100 Basic stats: COMPLETE Column stats: NONE
-                        value expressions: _col0 (type: string), _col1 (type: string)
+                    Reduce Output Operator
+                      key expressions: _col0 (type: string)
+                      sort order: +
+                      Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
+                      value expressions: _col1 (type: string)
         Reducer 2 
             Reduce Operator Tree:
               Select Operator
-                expressions: VALUE._col0 (type: string), VALUE._col1 (type: string)
+                expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string)
                 outputColumnNames: _col0, _col1
-                Statistics: Num rows: 10 Data size: 100 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                 Limit
                   Number of rows: 10
                   Statistics: Num rows: 10 Data size: 100 Basic stats: COMPLETE Column stats: NONE
@@ -307,11 +305,11 @@ STAGE PLANS:
   Stage: Stage-2
     Stats-Aggr Operator
 
-PREHOOK: query: INSERT OVERWRITE TABLE insert_into1 SELECT * FROM src LIMIT 10
+PREHOOK: query: INSERT OVERWRITE TABLE insert_into1 SELECT * FROM src ORDER BY key LIMIT 10
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
 PREHOOK: Output: default@insert_into1
-POSTHOOK: query: INSERT OVERWRITE TABLE insert_into1 SELECT * FROM src LIMIT 10
+POSTHOOK: query: INSERT OVERWRITE TABLE insert_into1 SELECT * FROM src ORDER BY key LIMIT 10
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 POSTHOOK: Output: default@insert_into1
@@ -329,7 +327,7 @@ POSTHOOK: query: SELECT SUM(HASH(c)) FROM (
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@insert_into1
 #### A masked pattern was here ####
--826625916
+-2693537120
 PREHOOK: query: explain
 SELECT COUNT(*) FROM insert_into1
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/spark/insert_into2.q.out b/ql/src/test/results/clientpositive/spark/insert_into2.q.out
index 8c5e1c3e08..578fae2d63 100644
--- a/ql/src/test/results/clientpositive/spark/insert_into2.q.out
+++ b/ql/src/test/results/clientpositive/spark/insert_into2.q.out
@@ -13,10 +13,10 @@ POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@insert_into2
 PREHOOK: query: EXPLAIN INSERT INTO TABLE insert_into2 PARTITION (ds='1') 
-  SELECT * FROM src LIMIT 100
+  SELECT * FROM src order by key LIMIT 100
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN INSERT INTO TABLE insert_into2 PARTITION (ds='1') 
-  SELECT * FROM src LIMIT 100
+  SELECT * FROM src order by key LIMIT 100
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
@@ -27,7 +27,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 1)
+        Reducer 2 <- Map 1 (SORT, 1)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -39,19 +39,17 @@ STAGE PLANS:
                     expressions: key (type: string), value (type: string)
                     outputColumnNames: _col0, _col1
                     Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
-                    Limit
-                      Number of rows: 100
-                      Statistics: Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
-                      Reduce Output Operator
-                        sort order: 
-                        Statistics: Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
-                        value expressions: _col0 (type: string), _col1 (type: string)
+                    Reduce Output Operator
+                      key expressions: _col0 (type: string)
+                      sort order: +
+                      Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
+                      value expressions: _col1 (type: string)
         Reducer 2 
             Reduce Operator Tree:
               Select Operator
-                expressions: VALUE._col0 (type: string), VALUE._col1 (type: string)
+                expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string)
                 outputColumnNames: _col0, _col1
-                Statistics: Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                 Limit
                   Number of rows: 100
                   Statistics: Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
@@ -83,11 +81,11 @@ STAGE PLANS:
   Stage: Stage-2
     Stats-Aggr Operator
 
-PREHOOK: query: INSERT INTO TABLE insert_into2 PARTITION (ds='1') SELECT * FROM src limit 100
+PREHOOK: query: INSERT INTO TABLE insert_into2 PARTITION (ds='1') SELECT * FROM src order by key limit 100
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
 PREHOOK: Output: default@insert_into2@ds=1
-POSTHOOK: query: INSERT INTO TABLE insert_into2 PARTITION (ds='1') SELECT * FROM src limit 100
+POSTHOOK: query: INSERT INTO TABLE insert_into2 PARTITION (ds='1') SELECT * FROM src order by key limit 100
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 POSTHOOK: Output: default@insert_into2@ds=1
@@ -118,11 +116,11 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@insert_into2
 #### A masked pattern was here ####
 100
-PREHOOK: query: INSERT INTO TABLE insert_into2 PARTITION (ds='1') SELECT * FROM src limit 100
+PREHOOK: query: INSERT INTO TABLE insert_into2 PARTITION (ds='1') SELECT * FROM src order by key limit 100
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
 PREHOOK: Output: default@insert_into2@ds=1
-POSTHOOK: query: INSERT INTO TABLE insert_into2 PARTITION (ds='1') SELECT * FROM src limit 100
+POSTHOOK: query: INSERT INTO TABLE insert_into2 PARTITION (ds='1') SELECT * FROM src order by key limit 100
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 POSTHOOK: Output: default@insert_into2@ds=1
@@ -167,12 +165,12 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@insert_into2
 POSTHOOK: Input: default@insert_into2@ds=1
 #### A masked pattern was here ####
--24159954504
+-39568181484
 PREHOOK: query: EXPLAIN INSERT OVERWRITE TABLE insert_into2 PARTITION (ds='2')
-  SELECT * FROM src LIMIT 100
+  SELECT * FROM src order by key LIMIT 100
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN INSERT OVERWRITE TABLE insert_into2 PARTITION (ds='2')
-  SELECT * FROM src LIMIT 100
+  SELECT * FROM src order by key LIMIT 100
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
@@ -183,7 +181,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 1)
+        Reducer 2 <- Map 1 (SORT, 1)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -195,19 +193,17 @@ STAGE PLANS:
                     expressions: key (type: string), value (type: string)
                     outputColumnNames: _col0, _col1
                     Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
-                    Limit
-                      Number of rows: 100
-                      Statistics: Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
-                      Reduce Output Operator
-                        sort order: 
-                        Statistics: Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
-                        value expressions: _col0 (type: string), _col1 (type: string)
+                    Reduce Output Operator
+                      key expressions: _col0 (type: string)
+                      sort order: +
+                      Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
+                      value expressions: _col1 (type: string)
         Reducer 2 
             Reduce Operator Tree:
               Select Operator
-                expressions: VALUE._col0 (type: string), VALUE._col1 (type: string)
+                expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string)
                 outputColumnNames: _col0, _col1
-                Statistics: Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                 Limit
                   Number of rows: 100
                   Statistics: Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
@@ -240,12 +236,12 @@ STAGE PLANS:
     Stats-Aggr Operator
 
 PREHOOK: query: INSERT OVERWRITE TABLE insert_into2 PARTITION (ds='2')
-  SELECT * FROM src LIMIT 100
+  SELECT * FROM src order by key LIMIT 100
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
 PREHOOK: Output: default@insert_into2@ds=2
 POSTHOOK: query: INSERT OVERWRITE TABLE insert_into2 PARTITION (ds='2')
-  SELECT * FROM src LIMIT 100
+  SELECT * FROM src order by key LIMIT 100
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 POSTHOOK: Output: default@insert_into2@ds=2
@@ -267,7 +263,7 @@ POSTHOOK: Input: default@insert_into2
 POSTHOOK: Input: default@insert_into2@ds=1
 POSTHOOK: Input: default@insert_into2@ds=2
 #### A masked pattern was here ####
--36239931656
+-59352272126
 PREHOOK: query: explain
 SELECT COUNT(*) FROM insert_into2 WHERE ds='2'
 PREHOOK: type: QUERY
@@ -294,10 +290,10 @@ POSTHOOK: Input: default@insert_into2
 #### A masked pattern was here ####
 100
 PREHOOK: query: EXPLAIN INSERT OVERWRITE TABLE insert_into2 PARTITION (ds='2')
-  SELECT * FROM src LIMIT 50
+  SELECT * FROM src order by key LIMIT 50
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN INSERT OVERWRITE TABLE insert_into2 PARTITION (ds='2')
-  SELECT * FROM src LIMIT 50
+  SELECT * FROM src order by key LIMIT 50
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
@@ -308,7 +304,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 1)
+        Reducer 2 <- Map 1 (SORT, 1)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -320,19 +316,17 @@ STAGE PLANS:
                     expressions: key (type: string), value (type: string)
                     outputColumnNames: _col0, _col1
                     Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
-                    Limit
-                      Number of rows: 50
-                      Statistics: Num rows: 50 Data size: 500 Basic stats: COMPLETE Column stats: NONE
-                      Reduce Output Operator
-                        sort order: 
-                        Statistics: Num rows: 50 Data size: 500 Basic stats: COMPLETE Column stats: NONE
-                        value expressions: _col0 (type: string), _col1 (type: string)
+                    Reduce Output Operator
+                      key expressions: _col0 (type: string)
+                      sort order: +
+                      Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
+                      value expressions: _col1 (type: string)
         Reducer 2 
             Reduce Operator Tree:
               Select Operator
-                expressions: VALUE._col0 (type: string), VALUE._col1 (type: string)
+                expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string)
                 outputColumnNames: _col0, _col1
-                Statistics: Num rows: 50 Data size: 500 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                 Limit
                   Number of rows: 50
                   Statistics: Num rows: 50 Data size: 500 Basic stats: COMPLETE Column stats: NONE
@@ -365,12 +359,12 @@ STAGE PLANS:
     Stats-Aggr Operator
 
 PREHOOK: query: INSERT OVERWRITE TABLE insert_into2 PARTITION (ds='2')
-  SELECT * FROM src LIMIT 50
+  SELECT * FROM src order by key LIMIT 50
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
 PREHOOK: Output: default@insert_into2@ds=2
 POSTHOOK: query: INSERT OVERWRITE TABLE insert_into2 PARTITION (ds='2')
-  SELECT * FROM src LIMIT 50
+  SELECT * FROM src order by key LIMIT 50
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 POSTHOOK: Output: default@insert_into2@ds=2
@@ -392,7 +386,7 @@ POSTHOOK: Input: default@insert_into2
 POSTHOOK: Input: default@insert_into2@ds=1
 POSTHOOK: Input: default@insert_into2@ds=2
 #### A masked pattern was here ####
--27100860056
+-33609711132
 PREHOOK: query: explain
 SELECT COUNT(*) FROM insert_into2 WHERE ds='2'
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/spark/join_merge_multi_expressions.q.out b/ql/src/test/results/clientpositive/spark/join_merge_multi_expressions.q.out
index 9eb15ecf6f..a18d82efe8 100644
--- a/ql/src/test/results/clientpositive/spark/join_merge_multi_expressions.q.out
+++ b/ql/src/test/results/clientpositive/spark/join_merge_multi_expressions.q.out
@@ -1,7 +1,9 @@
-PREHOOK: query: explain
+PREHOOK: query: -- SORT_QUERY_RESULTS
+explain
 select count(*) from srcpart a join srcpart b on a.key = b.key and a.hr = b.hr join srcpart c on a.hr = c.hr and a.key = c.key
 PREHOOK: type: QUERY
-POSTHOOK: query: explain
+POSTHOOK: query: -- SORT_QUERY_RESULTS
+explain
 select count(*) from srcpart a join srcpart b on a.key = b.key and a.hr = b.hr join srcpart c on a.hr = c.hr and a.key = c.key
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
diff --git a/ql/src/test/results/clientpositive/spark/join_nullsafe.q.out b/ql/src/test/results/clientpositive/spark/join_nullsafe.q.out
index 70459f7455..c9e7a5cac2 100644
--- a/ql/src/test/results/clientpositive/spark/join_nullsafe.q.out
+++ b/ql/src/test/results/clientpositive/spark/join_nullsafe.q.out
@@ -86,11 +86,13 @@ STAGE PLANS:
       Processor Tree:
         ListSink
 
-PREHOOK: query: select * from myinput1 a join myinput1 b on a.key<=>b.value
+PREHOOK: query: -- SORT_QUERY_RESULTS
+select * from myinput1 a join myinput1 b on a.key<=>b.value
 PREHOOK: type: QUERY
 PREHOOK: Input: default@myinput1
 #### A masked pattern was here ####
-POSTHOOK: query: select * from myinput1 a join myinput1 b on a.key<=>b.value
+POSTHOOK: query: -- SORT_QUERY_RESULTS
+select * from myinput1 a join myinput1 b on a.key<=>b.value
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@myinput1
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/spark/mapjoin_decimal.q.out b/ql/src/test/results/clientpositive/spark/mapjoin_decimal.q.out
index 3fafe1f4bd..20b188b9fe 100644
--- a/ql/src/test/results/clientpositive/spark/mapjoin_decimal.q.out
+++ b/ql/src/test/results/clientpositive/spark/mapjoin_decimal.q.out
@@ -77,10 +77,10 @@ POSTHOOK: Input: default@over1k
 POSTHOOK: Output: default@t2
 POSTHOOK: Lineage: t2.dec EXPRESSION [(over1k)over1k.FieldSchema(name:dec, type:decimal(4,2), comment:null), ]
 PREHOOK: query: explain
-select t1.dec, t2.dec from t1 join t2 on (t1.dec=t2.dec)
+select t1.dec, t2.dec from t1 join t2 on (t1.dec=t2.dec) order by t1.dec
 PREHOOK: type: QUERY
 POSTHOOK: query: explain
-select t1.dec, t2.dec from t1 join t2 on (t1.dec=t2.dec)
+select t1.dec, t2.dec from t1 join t2 on (t1.dec=t2.dec) order by t1.dec
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
@@ -92,7 +92,7 @@ STAGE PLANS:
     Spark
 #### A masked pattern was here ####
       Vertices:
-        Map 2 
+        Map 3 
             Map Operator Tree:
                 TableScan
                   alias: t2
@@ -109,6 +109,8 @@ STAGE PLANS:
 
   Stage: Stage-1
     Spark
+      Edges:
+        Reducer 2 <- Map 1 (SORT, 1)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -127,21 +129,32 @@ STAGE PLANS:
                         1 dec (type: decimal(6,2))
                       outputColumnNames: _col0, _col4
                       input vertices:
-                        1 Map 2
+                        1 Map 3
                       Statistics: Num rows: 577 Data size: 64680 Basic stats: COMPLETE Column stats: NONE
                       Select Operator
                         expressions: _col0 (type: decimal(4,2)), _col4 (type: decimal(4,0))
                         outputColumnNames: _col0, _col1
                         Statistics: Num rows: 577 Data size: 64680 Basic stats: COMPLETE Column stats: NONE
-                        File Output Operator
-                          compressed: false
+                        Reduce Output Operator
+                          key expressions: _col0 (type: decimal(4,2))
+                          sort order: +
                           Statistics: Num rows: 577 Data size: 64680 Basic stats: COMPLETE Column stats: NONE
-                          table:
-                              input format: org.apache.hadoop.mapred.TextInputFormat
-                              output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                              serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                          value expressions: _col1 (type: decimal(4,0))
             Local Work:
               Map Reduce Local Work
+        Reducer 2 
+            Reduce Operator Tree:
+              Select Operator
+                expressions: KEY.reducesinkkey0 (type: decimal(4,2)), VALUE._col0 (type: decimal(4,0))
+                outputColumnNames: _col0, _col1
+                Statistics: Num rows: 577 Data size: 64680 Basic stats: COMPLETE Column stats: NONE
+                File Output Operator
+                  compressed: false
+                  Statistics: Num rows: 577 Data size: 64680 Basic stats: COMPLETE Column stats: NONE
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
 
   Stage: Stage-0
     Fetch Operator
@@ -149,12 +162,12 @@ STAGE PLANS:
       Processor Tree:
         ListSink
 
-PREHOOK: query: select t1.dec, t2.dec from t1 join t2 on (t1.dec=t2.dec)
+PREHOOK: query: select t1.dec, t2.dec from t1 join t2 on (t1.dec=t2.dec) order by t1.dec
 PREHOOK: type: QUERY
 PREHOOK: Input: default@t1
 PREHOOK: Input: default@t2
 #### A masked pattern was here ####
-POSTHOOK: query: select t1.dec, t2.dec from t1 join t2 on (t1.dec=t2.dec)
+POSTHOOK: query: select t1.dec, t2.dec from t1 join t2 on (t1.dec=t2.dec) order by t1.dec
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@t1
 POSTHOOK: Input: default@t2
@@ -265,12 +278,12 @@ POSTHOOK: Input: default@t2
 9	9
 9	9
 9	9
-PREHOOK: query: select t1.dec, t2.dec from t1 join t2 on (t1.dec=t2.dec)
+PREHOOK: query: select t1.dec, t2.dec from t1 join t2 on (t1.dec=t2.dec) order by t1.dec
 PREHOOK: type: QUERY
 PREHOOK: Input: default@t1
 PREHOOK: Input: default@t2
 #### A masked pattern was here ####
-POSTHOOK: query: select t1.dec, t2.dec from t1 join t2 on (t1.dec=t2.dec)
+POSTHOOK: query: select t1.dec, t2.dec from t1 join t2 on (t1.dec=t2.dec) order by t1.dec
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@t1
 POSTHOOK: Input: default@t2
diff --git a/ql/src/test/results/clientpositive/spark/script_env_var1.q.out b/ql/src/test/results/clientpositive/spark/script_env_var1.q.out
index 5ab1c20c9c..cd39eb893d 100644
--- a/ql/src/test/results/clientpositive/spark/script_env_var1.q.out
+++ b/ql/src/test/results/clientpositive/spark/script_env_var1.q.out
@@ -1,16 +1,16 @@
 PREHOOK: query: -- Verifies that script operator ID environment variables have unique values
 -- in each instance of the script operator.
 SELECT count(1) FROM
-( SELECT * FROM (SELECT TRANSFORM('echo $HIVE_SCRIPT_OPERATOR_ID') USING 'sh' AS key FROM src LIMIT 1)x UNION ALL
-  SELECT * FROM (SELECT TRANSFORM('echo $HIVE_SCRIPT_OPERATOR_ID') USING 'sh' AS key FROM src LIMIT 1)y ) a GROUP BY key
+( SELECT * FROM (SELECT TRANSFORM('echo $HIVE_SCRIPT_OPERATOR_ID') USING 'sh' AS key FROM src order by key LIMIT 1)x UNION ALL
+  SELECT * FROM (SELECT TRANSFORM('echo $HIVE_SCRIPT_OPERATOR_ID') USING 'sh' AS key FROM src order by key LIMIT 1)y ) a GROUP BY key
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
 #### A masked pattern was here ####
 POSTHOOK: query: -- Verifies that script operator ID environment variables have unique values
 -- in each instance of the script operator.
 SELECT count(1) FROM
-( SELECT * FROM (SELECT TRANSFORM('echo $HIVE_SCRIPT_OPERATOR_ID') USING 'sh' AS key FROM src LIMIT 1)x UNION ALL
-  SELECT * FROM (SELECT TRANSFORM('echo $HIVE_SCRIPT_OPERATOR_ID') USING 'sh' AS key FROM src LIMIT 1)y ) a GROUP BY key
+( SELECT * FROM (SELECT TRANSFORM('echo $HIVE_SCRIPT_OPERATOR_ID') USING 'sh' AS key FROM src order by key LIMIT 1)x UNION ALL
+  SELECT * FROM (SELECT TRANSFORM('echo $HIVE_SCRIPT_OPERATOR_ID') USING 'sh' AS key FROM src order by key LIMIT 1)y ) a GROUP BY key
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/spark/skewjoin.q.out b/ql/src/test/results/clientpositive/spark/skewjoin.q.out
index 32bbc952e0..5fb2ecb92a 100644
--- a/ql/src/test/results/clientpositive/spark/skewjoin.q.out
+++ b/ql/src/test/results/clientpositive/spark/skewjoin.q.out
@@ -1,8 +1,12 @@
-PREHOOK: query: CREATE TABLE T1(key STRING, val STRING) STORED AS TEXTFILE
+PREHOOK: query: -- SORT_QUERY_RESULTS
+
+CREATE TABLE T1(key STRING, val STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@T1
-POSTHOOK: query: CREATE TABLE T1(key STRING, val STRING) STORED AS TEXTFILE
+POSTHOOK: query: -- SORT_QUERY_RESULTS
+
+CREATE TABLE T1(key STRING, val STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@T1
diff --git a/ql/src/test/results/clientpositive/spark/subquery_exists.q.out b/ql/src/test/results/clientpositive/spark/subquery_exists.q.out
index 0b8871589c..854ca14cfe 100644
--- a/ql/src/test/results/clientpositive/spark/subquery_exists.q.out
+++ b/ql/src/test/results/clientpositive/spark/subquery_exists.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: -- SORT_QUERY_RESULTS
 
 -- no agg, corr
+-- SORT_QUERY_RESULTS
 explain
 select * 
 from src b 
@@ -13,6 +14,7 @@ PREHOOK: type: QUERY
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 -- no agg, corr
+-- SORT_QUERY_RESULTS
 explain
 select * 
 from src b 
diff --git a/ql/src/test/results/clientpositive/spark/temp_table.q.out b/ql/src/test/results/clientpositive/spark/temp_table.q.out
index 73d33eea36..30563b2a72 100644
--- a/ql/src/test/results/clientpositive/spark/temp_table.q.out
+++ b/ql/src/test/results/clientpositive/spark/temp_table.q.out
@@ -146,48 +146,76 @@ POSTHOOK: type: DESCTABLE
 POSTHOOK: Input: default@bar
 key                 	string              	                    
 value               	string              	                    
-PREHOOK: query: explain select * from foo limit 10
+PREHOOK: query: explain select * from foo order by key limit 10
 PREHOOK: type: QUERY
-POSTHOOK: query: explain select * from foo limit 10
+POSTHOOK: query: explain select * from foo order by key limit 10
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
-  Stage-0 is a root stage
+  Stage-1 is a root stage
+  Stage-0 depends on stages: Stage-1
 
 STAGE PLANS:
+  Stage: Stage-1
+    Spark
+      Edges:
+        Reducer 2 <- Map 1 (SORT, 1)
+#### A masked pattern was here ####
+      Vertices:
+        Map 1 
+            Map Operator Tree:
+                TableScan
+                  alias: foo
+                  Statistics: Num rows: 247 Data size: 2609 Basic stats: COMPLETE Column stats: NONE
+                  Select Operator
+                    expressions: key (type: string), value (type: string)
+                    outputColumnNames: _col0, _col1
+                    Statistics: Num rows: 247 Data size: 2609 Basic stats: COMPLETE Column stats: NONE
+                    Reduce Output Operator
+                      key expressions: _col0 (type: string)
+                      sort order: +
+                      Statistics: Num rows: 247 Data size: 2609 Basic stats: COMPLETE Column stats: NONE
+                      value expressions: _col1 (type: string)
+        Reducer 2 
+            Reduce Operator Tree:
+              Select Operator
+                expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string)
+                outputColumnNames: _col0, _col1
+                Statistics: Num rows: 247 Data size: 2609 Basic stats: COMPLETE Column stats: NONE
+                Limit
+                  Number of rows: 10
+                  Statistics: Num rows: 10 Data size: 100 Basic stats: COMPLETE Column stats: NONE
+                  File Output Operator
+                    compressed: false
+                    Statistics: Num rows: 10 Data size: 100 Basic stats: COMPLETE Column stats: NONE
+                    table:
+                        input format: org.apache.hadoop.mapred.TextInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+
   Stage: Stage-0
     Fetch Operator
       limit: 10
       Processor Tree:
-        TableScan
-          alias: foo
-          Statistics: Num rows: 247 Data size: 2609 Basic stats: COMPLETE Column stats: NONE
-          Select Operator
-            expressions: key (type: string), value (type: string)
-            outputColumnNames: _col0, _col1
-            Statistics: Num rows: 247 Data size: 2609 Basic stats: COMPLETE Column stats: NONE
-            Limit
-              Number of rows: 10
-              Statistics: Num rows: 10 Data size: 100 Basic stats: COMPLETE Column stats: NONE
-              ListSink
+        ListSink
 
-PREHOOK: query: select * from foo limit 10
+PREHOOK: query: select * from foo order by key limit 10
 PREHOOK: type: QUERY
 PREHOOK: Input: default@foo
 #### A masked pattern was here ####
-POSTHOOK: query: select * from foo limit 10
+POSTHOOK: query: select * from foo order by key limit 10
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@foo
 #### A masked pattern was here ####
-238	val_238
-86	val_86
-278	val_278
-98	val_98
-484	val_484
-150	val_150
-224	val_224
-66	val_66
-128	val_128
-146	val_146
+0	val_0
+0	val_0
+0	val_0
+10	val_10
+100	val_100
+100	val_100
+104	val_104
+104	val_104
+114	val_114
+116	val_116
 PREHOOK: query: explain select * from (select * from foo union all select * from bar) u order by key limit 10
 PREHOOK: type: QUERY
 POSTHOOK: query: explain select * from (select * from foo union all select * from bar) u order by key limit 10
@@ -318,11 +346,11 @@ POSTHOOK: Input: default@src
 POSTHOOK: Output: default@bay
 POSTHOOK: Lineage: bay.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: bay.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
-PREHOOK: query: select * from bay limit 10
+PREHOOK: query: select * from bay order by key limit 10
 PREHOOK: type: QUERY
 PREHOOK: Input: default@bay
 #### A masked pattern was here ####
-POSTHOOK: query: select * from bay limit 10
+POSTHOOK: query: select * from bay order by key limit 10
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@bay
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/spark/tez_joins_explain.q.out b/ql/src/test/results/clientpositive/spark/tez_joins_explain.q.out
index ad3048b9c2..7bd894b7ca 100644
--- a/ql/src/test/results/clientpositive/spark/tez_joins_explain.q.out
+++ b/ql/src/test/results/clientpositive/spark/tez_joins_explain.q.out
@@ -1,10 +1,8 @@
 PREHOOK: query: -- SORT_QUERY_RESULTS
-
 explain
 select * from (select b.key, b.value from src1 a left outer join src b on (a.key = b.key) order by b.key) x right outer join src c on (x.value = c.value) order by x.key
 PREHOOK: type: QUERY
 POSTHOOK: query: -- SORT_QUERY_RESULTS
-
 explain
 select * from (select b.key, b.value from src1 a left outer join src b on (a.key = b.key) order by b.key) x right outer join src c on (x.value = c.value) order by x.key
 POSTHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/spark/vector_data_types.q.out b/ql/src/test/results/clientpositive/spark/vector_data_types.q.out
index 98cfb7d537..a9599640c8 100644
--- a/ql/src/test/results/clientpositive/spark/vector_data_types.q.out
+++ b/ql/src/test/results/clientpositive/spark/vector_data_types.q.out
@@ -97,9 +97,9 @@ POSTHOOK: Lineage: over1korc.s SIMPLE [(over1k)over1k.FieldSchema(name:s, type:s
 POSTHOOK: Lineage: over1korc.si SIMPLE [(over1k)over1k.FieldSchema(name:si, type:smallint, comment:null), ]
 POSTHOOK: Lineage: over1korc.t SIMPLE [(over1k)over1k.FieldSchema(name:t, type:tinyint, comment:null), ]
 POSTHOOK: Lineage: over1korc.ts SIMPLE [(over1k)over1k.FieldSchema(name:ts, type:timestamp, comment:null), ]
-PREHOOK: query: EXPLAIN SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY i LIMIT 20
+PREHOOK: query: EXPLAIN SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY t, si, i LIMIT 20
 PREHOOK: type: QUERY
-POSTHOOK: query: EXPLAIN SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY i LIMIT 20
+POSTHOOK: query: EXPLAIN SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY t, si, i LIMIT 20
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
@@ -122,14 +122,14 @@ STAGE PLANS:
                     outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
                     Statistics: Num rows: 1049 Data size: 311170 Basic stats: COMPLETE Column stats: NONE
                     Reduce Output Operator
-                      key expressions: _col2 (type: int)
-                      sort order: +
+                      key expressions: _col0 (type: tinyint), _col1 (type: smallint), _col2 (type: int)
+                      sort order: +++
                       Statistics: Num rows: 1049 Data size: 311170 Basic stats: COMPLETE Column stats: NONE
-                      value expressions: _col0 (type: tinyint), _col1 (type: smallint), _col3 (type: bigint), _col4 (type: float), _col5 (type: double), _col6 (type: boolean), _col7 (type: string), _col8 (type: timestamp), _col9 (type: decimal(4,2)), _col10 (type: binary)
+                      value expressions: _col3 (type: bigint), _col4 (type: float), _col5 (type: double), _col6 (type: boolean), _col7 (type: string), _col8 (type: timestamp), _col9 (type: decimal(4,2)), _col10 (type: binary)
         Reducer 2 
             Reduce Operator Tree:
               Select Operator
-                expressions: VALUE._col0 (type: tinyint), VALUE._col1 (type: smallint), KEY.reducesinkkey0 (type: int), VALUE._col2 (type: bigint), VALUE._col3 (type: float), VALUE._col4 (type: double), VALUE._col5 (type: boolean), VALUE._col6 (type: string), VALUE._col7 (type: timestamp), VALUE._col8 (type: decimal(4,2)), VALUE._col9 (type: binary)
+                expressions: KEY.reducesinkkey0 (type: tinyint), KEY.reducesinkkey1 (type: smallint), KEY.reducesinkkey2 (type: int), VALUE._col0 (type: bigint), VALUE._col1 (type: float), VALUE._col2 (type: double), VALUE._col3 (type: boolean), VALUE._col4 (type: string), VALUE._col5 (type: timestamp), VALUE._col6 (type: decimal(4,2)), VALUE._col7 (type: binary)
                 outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
                 Statistics: Num rows: 1049 Data size: 311170 Basic stats: COMPLETE Column stats: NONE
                 Limit
@@ -149,48 +149,48 @@ STAGE PLANS:
       Processor Tree:
         ListSink
 
-PREHOOK: query: SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY i LIMIT 20
+PREHOOK: query: SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY t, si, i LIMIT 20
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over1korc
 #### A masked pattern was here ####
-POSTHOOK: query: SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY i LIMIT 20
+POSTHOOK: query: SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY t, si, i LIMIT 20
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1korc
 #### A masked pattern was here ####
+NULL	374	65560	4294967516	65.43	22.48	true	oscar quirinius	2013-03-01 09:11:58.703316	16.86	mathematics
 NULL	409	65536	4294967490	46.97	25.92	false	fred miller	2013-03-01 09:11:58.703116	33.45	history
-18	280	65536	4294967320	32.92	45.94	false	holly white	2013-03-01 09:11:58.703086	58.86	topology
-69	489	65536	4294967404	33.52	17.99	false	oscar ichabod	2013-03-01 09:11:58.703247	32.68	topology
-108	301	65536	4294967357	90.05	17.59	true	ethan johnson	2013-03-01 09:11:58.703271	75.7	undecided
-27	405	65536	4294967508	82.24	29.41	true	oscar ovid	2013-03-01 09:11:58.703166	16.85	biology
-42	495	65536	4294967431	43.57	46.81	false	tom johnson	2013-03-01 09:11:58.703245	62.25	american history
-118	497	65536	4294967381	50.32	12.72	false	david nixon	2013-03-01 09:11:58.703285	83.48	values clariffication
-72	267	65537	4294967460	55.2	42.89	false	oscar carson	2013-03-01 09:11:58.703153	51.91	topology
-22	264	65537	4294967419	8.07	10.71	false	david xylophone	2013-03-01 09:11:58.703136	11.87	undecided
-63	458	65537	4294967463	21.94	49.71	true	fred van buren	2013-03-01 09:11:58.703278	99.34	wind surfing
-121	355	65537	4294967437	85.9	10.99	true	calvin brown	2013-03-01 09:11:58.703254	4.49	yard duty
-59	431	65537	4294967326	11.34	2.9	true	oscar robinson	2013-03-01 09:11:58.703161	81.04	zync studies
-83	353	65538	4294967339	0.08	23.91	true	holly thompson	2013-03-01 09:11:58.703157	30.27	quiet hour
-109	376	65538	4294967453	59.61	35.62	true	priscilla xylophone	2013-03-01 09:11:58.703286	9.53	study skills
-101	283	65538	4294967527	84.03	27.29	true	yuri brown	2013-03-01 09:11:58.703306	44.24	biology
-120	331	65539	4294967324	88.02	40.94	true	holly nixon	2013-03-01 09:11:58.703262	96.64	yard duty
-70	430	65539	4294967534	18.89	43.84	true	tom carson	2013-03-01 09:11:58.703182	21.93	joggying
-29	331	65539	4294967420	73.18	28.96	true	ethan brown	2013-03-01 09:11:58.703094	58.85	zync studies
-71	298	65540	4294967510	91.63	9.6	false	gabriella zipper	2013-03-01 09:11:58.70314	68.14	geology
-89	466	65541	4294967468	85.51	19.79	true	calvin davidson	2013-03-01 09:11:58.703113	35.38	philosophy
+NULL	473	65720	4294967324	80.74	40.6	false	holly falkner	2013-03-01 09:11:58.703111	18.8	mathematics
+-3	275	65622	4294967302	71.78	8.49	false	wendy robinson	2013-03-01 09:11:58.703294	95.39	undecided
+-3	344	65733	4294967363	0.56	11.96	true	rachel thompson	2013-03-01 09:11:58.703276	88.46	wind surfing
+-3	376	65548	4294967431	96.78	43.23	false	fred ellison	2013-03-01 09:11:58.703233	75.39	education
+-3	438	65618	4294967398	62.39	4.62	false	victor xylophone	2013-03-01 09:11:58.703135	88.38	values clariffication
+-3	458	65696	4294967418	45.24	8.49	false	irene ellison	2013-03-01 09:11:58.703092	54.02	american history
+-3	467	65575	4294967437	81.64	23.53	true	tom hernandez	2013-03-01 09:11:58.703188	32.85	study skills
+-2	261	65603	4294967332	39.18	28.98	false	fred polk	2013-03-01 09:11:58.70331	69.26	opthamology
+-2	269	65681	4294967544	99.24	28.19	false	rachel falkner	2013-03-01 09:11:58.703089	41.57	quiet hour
+-2	288	65658	4294967383	53.78	19.92	false	holly nixon	2013-03-01 09:11:58.703224	42.93	industrial engineering
+-2	304	65629	4294967386	84.38	33.49	false	zach garcia	2013-03-01 09:11:58.703264	56.99	chemistry
+-2	340	65627	4294967533	76.52	21.91	true	quinn laertes	2013-03-01 09:11:58.703178	93.29	xylophone band
+-2	427	65666	4294967465	19.69	33.24	true	bob xylophone	2013-03-01 09:11:58.703219	32.73	joggying
+-2	429	65664	4294967441	45.19	40.43	false	wendy king	2013-03-01 09:11:58.703265	11.46	industrial engineering
+-2	461	65648	4294967425	58.52	24.85	false	rachel thompson	2013-03-01 09:11:58.703318	85.62	zync studies
+-1	268	65778	4294967418	56.33	44.73	true	calvin falkner	2013-03-01 09:11:58.70322	7.37	history
+-1	281	65643	4294967323	15.1	45.0	false	irene nixon	2013-03-01 09:11:58.703223	80.96	undecided
+-1	300	65663	4294967343	71.26	34.62	true	calvin ovid	2013-03-01 09:11:58.703262	78.56	study skills
 PREHOOK: query: SELECT SUM(HASH(*))
-FROM (SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY i) as q
+FROM (SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY t, si, i) as q
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over1korc
 #### A masked pattern was here ####
 POSTHOOK: query: SELECT SUM(HASH(*))
-FROM (SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY i) as q
+FROM (SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY t, si, i) as q
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1korc
 #### A masked pattern was here ####
 -17045922556
-PREHOOK: query: EXPLAIN select t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY i LIMIT 20
+PREHOOK: query: EXPLAIN select t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY t, si, i LIMIT 20
 PREHOOK: type: QUERY
-POSTHOOK: query: EXPLAIN select t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY i LIMIT 20
+POSTHOOK: query: EXPLAIN select t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY t, si, i LIMIT 20
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
@@ -213,15 +213,15 @@ STAGE PLANS:
                     outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
                     Statistics: Num rows: 1049 Data size: 311170 Basic stats: COMPLETE Column stats: NONE
                     Reduce Output Operator
-                      key expressions: _col2 (type: int)
-                      sort order: +
+                      key expressions: _col0 (type: tinyint), _col1 (type: smallint), _col2 (type: int)
+                      sort order: +++
                       Statistics: Num rows: 1049 Data size: 311170 Basic stats: COMPLETE Column stats: NONE
-                      value expressions: _col0 (type: tinyint), _col1 (type: smallint), _col3 (type: bigint), _col4 (type: float), _col5 (type: double), _col6 (type: boolean), _col7 (type: string), _col8 (type: timestamp), _col9 (type: decimal(4,2)), _col10 (type: binary)
+                      value expressions: _col3 (type: bigint), _col4 (type: float), _col5 (type: double), _col6 (type: boolean), _col7 (type: string), _col8 (type: timestamp), _col9 (type: decimal(4,2)), _col10 (type: binary)
             Execution mode: vectorized
         Reducer 2 
             Reduce Operator Tree:
               Select Operator
-                expressions: VALUE._col0 (type: tinyint), VALUE._col1 (type: smallint), KEY.reducesinkkey0 (type: int), VALUE._col2 (type: bigint), VALUE._col3 (type: float), VALUE._col4 (type: double), VALUE._col5 (type: boolean), VALUE._col6 (type: string), VALUE._col7 (type: timestamp), VALUE._col8 (type: decimal(4,2)), VALUE._col9 (type: binary)
+                expressions: KEY.reducesinkkey0 (type: tinyint), KEY.reducesinkkey1 (type: smallint), KEY.reducesinkkey2 (type: int), VALUE._col0 (type: bigint), VALUE._col1 (type: float), VALUE._col2 (type: double), VALUE._col3 (type: boolean), VALUE._col4 (type: string), VALUE._col5 (type: timestamp), VALUE._col6 (type: decimal(4,2)), VALUE._col7 (type: binary)
                 outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
                 Statistics: Num rows: 1049 Data size: 311170 Basic stats: COMPLETE Column stats: NONE
                 Limit
@@ -242,41 +242,41 @@ STAGE PLANS:
       Processor Tree:
         ListSink
 
-PREHOOK: query: SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY i LIMIT 20
+PREHOOK: query: SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY t, si, i LIMIT 20
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over1korc
 #### A masked pattern was here ####
-POSTHOOK: query: SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY i LIMIT 20
+POSTHOOK: query: SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY t, si, i LIMIT 20
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1korc
 #### A masked pattern was here ####
+NULL	374	65560	4294967516	65.43	22.48	true	oscar quirinius	2013-03-01 09:11:58.703316	16.86	mathematics
 NULL	409	65536	4294967490	46.97	25.92	false	fred miller	2013-03-01 09:11:58.703116	33.45	history
-18	280	65536	4294967320	32.92	45.94	false	holly white	2013-03-01 09:11:58.703086	58.86	topology
-69	489	65536	4294967404	33.52	17.99	false	oscar ichabod	2013-03-01 09:11:58.703247	32.68	topology
-108	301	65536	4294967357	90.05	17.59	true	ethan johnson	2013-03-01 09:11:58.703271	75.7	undecided
-27	405	65536	4294967508	82.24	29.41	true	oscar ovid	2013-03-01 09:11:58.703166	16.85	biology
-42	495	65536	4294967431	43.57	46.81	false	tom johnson	2013-03-01 09:11:58.703245	62.25	american history
-118	497	65536	4294967381	50.32	12.72	false	david nixon	2013-03-01 09:11:58.703285	83.48	values clariffication
-72	267	65537	4294967460	55.2	42.89	false	oscar carson	2013-03-01 09:11:58.703153	51.91	topology
-22	264	65537	4294967419	8.07	10.71	false	david xylophone	2013-03-01 09:11:58.703136	11.87	undecided
-63	458	65537	4294967463	21.94	49.71	true	fred van buren	2013-03-01 09:11:58.703278	99.34	wind surfing
-121	355	65537	4294967437	85.9	10.99	true	calvin brown	2013-03-01 09:11:58.703254	4.49	yard duty
-59	431	65537	4294967326	11.34	2.9	true	oscar robinson	2013-03-01 09:11:58.703161	81.04	zync studies
-83	353	65538	4294967339	0.08	23.91	true	holly thompson	2013-03-01 09:11:58.703157	30.27	quiet hour
-109	376	65538	4294967453	59.61	35.62	true	priscilla xylophone	2013-03-01 09:11:58.703286	9.53	study skills
-101	283	65538	4294967527	84.03	27.29	true	yuri brown	2013-03-01 09:11:58.703306	44.24	biology
-120	331	65539	4294967324	88.02	40.94	true	holly nixon	2013-03-01 09:11:58.703262	96.64	yard duty
-70	430	65539	4294967534	18.89	43.84	true	tom carson	2013-03-01 09:11:58.703182	21.93	joggying
-29	331	65539	4294967420	73.18	28.96	true	ethan brown	2013-03-01 09:11:58.703094	58.85	zync studies
-71	298	65540	4294967510	91.63	9.6	false	gabriella zipper	2013-03-01 09:11:58.70314	68.14	geology
-89	466	65541	4294967468	85.51	19.79	true	calvin davidson	2013-03-01 09:11:58.703113	35.38	philosophy
+NULL	473	65720	4294967324	80.74	40.6	false	holly falkner	2013-03-01 09:11:58.703111	18.8	mathematics
+-3	275	65622	4294967302	71.78	8.49	false	wendy robinson	2013-03-01 09:11:58.703294	95.39	undecided
+-3	344	65733	4294967363	0.56	11.96	true	rachel thompson	2013-03-01 09:11:58.703276	88.46	wind surfing
+-3	376	65548	4294967431	96.78	43.23	false	fred ellison	2013-03-01 09:11:58.703233	75.39	education
+-3	438	65618	4294967398	62.39	4.62	false	victor xylophone	2013-03-01 09:11:58.703135	88.38	values clariffication
+-3	458	65696	4294967418	45.24	8.49	false	irene ellison	2013-03-01 09:11:58.703092	54.02	american history
+-3	467	65575	4294967437	81.64	23.53	true	tom hernandez	2013-03-01 09:11:58.703188	32.85	study skills
+-2	261	65603	4294967332	39.18	28.98	false	fred polk	2013-03-01 09:11:58.70331	69.26	opthamology
+-2	269	65681	4294967544	99.24	28.19	false	rachel falkner	2013-03-01 09:11:58.703089	41.57	quiet hour
+-2	288	65658	4294967383	53.78	19.92	false	holly nixon	2013-03-01 09:11:58.703224	42.93	industrial engineering
+-2	304	65629	4294967386	84.38	33.49	false	zach garcia	2013-03-01 09:11:58.703264	56.99	chemistry
+-2	340	65627	4294967533	76.52	21.91	true	quinn laertes	2013-03-01 09:11:58.703178	93.29	xylophone band
+-2	427	65666	4294967465	19.69	33.24	true	bob xylophone	2013-03-01 09:11:58.703219	32.73	joggying
+-2	429	65664	4294967441	45.19	40.43	false	wendy king	2013-03-01 09:11:58.703265	11.46	industrial engineering
+-2	461	65648	4294967425	58.52	24.85	false	rachel thompson	2013-03-01 09:11:58.703318	85.62	zync studies
+-1	268	65778	4294967418	56.33	44.73	true	calvin falkner	2013-03-01 09:11:58.70322	7.37	history
+-1	281	65643	4294967323	15.1	45.0	false	irene nixon	2013-03-01 09:11:58.703223	80.96	undecided
+-1	300	65663	4294967343	71.26	34.62	true	calvin ovid	2013-03-01 09:11:58.703262	78.56	study skills
 PREHOOK: query: SELECT SUM(HASH(*))
-FROM (SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY i) as q
+FROM (SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY t, si, i) as q
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over1korc
 #### A masked pattern was here ####
 POSTHOOK: query: SELECT SUM(HASH(*))
-FROM (SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY i) as q
+FROM (SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY t, si, i) as q
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1korc
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/spark/vectorization_part_project.q.out b/ql/src/test/results/clientpositive/spark/vectorization_part_project.q.out
index 0f10727326..f92e82346d 100644
--- a/ql/src/test/results/clientpositive/spark/vectorization_part_project.q.out
+++ b/ql/src/test/results/clientpositive/spark/vectorization_part_project.q.out
@@ -6,11 +6,11 @@ POSTHOOK: query: CREATE TABLE alltypesorc_part(ctinyint tinyint, csmallint small
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@alltypesorc_part
-PREHOOK: query: insert overwrite table alltypesorc_part partition (ds='2011') select * from alltypesorc limit 100
+PREHOOK: query: insert overwrite table alltypesorc_part partition (ds='2011') select * from alltypesorc order by ctinyint, cint, cbigint limit 100
 PREHOOK: type: QUERY
 PREHOOK: Input: default@alltypesorc
 PREHOOK: Output: default@alltypesorc_part@ds=2011
-POSTHOOK: query: insert overwrite table alltypesorc_part partition (ds='2011') select * from alltypesorc limit 100
+POSTHOOK: query: insert overwrite table alltypesorc_part partition (ds='2011') select * from alltypesorc order by ctinyint, cint, cbigint limit 100
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc
 POSTHOOK: Output: default@alltypesorc_part@ds=2011
@@ -26,11 +26,11 @@ POSTHOOK: Lineage: alltypesorc_part PARTITION(ds=2011).cstring2 SIMPLE [(alltype
 POSTHOOK: Lineage: alltypesorc_part PARTITION(ds=2011).ctimestamp1 SIMPLE [(alltypesorc)alltypesorc.FieldSchema(name:ctimestamp1, type:timestamp, comment:null), ]
 POSTHOOK: Lineage: alltypesorc_part PARTITION(ds=2011).ctimestamp2 SIMPLE [(alltypesorc)alltypesorc.FieldSchema(name:ctimestamp2, type:timestamp, comment:null), ]
 POSTHOOK: Lineage: alltypesorc_part PARTITION(ds=2011).ctinyint SIMPLE [(alltypesorc)alltypesorc.FieldSchema(name:ctinyint, type:tinyint, comment:null), ]
-PREHOOK: query: insert overwrite table alltypesorc_part partition (ds='2012') select * from alltypesorc limit 100
+PREHOOK: query: insert overwrite table alltypesorc_part partition (ds='2012') select * from alltypesorc order by ctinyint, cint, cbigint limit 100
 PREHOOK: type: QUERY
 PREHOOK: Input: default@alltypesorc
 PREHOOK: Output: default@alltypesorc_part@ds=2012
-POSTHOOK: query: insert overwrite table alltypesorc_part partition (ds='2012') select * from alltypesorc limit 100
+POSTHOOK: query: insert overwrite table alltypesorc_part partition (ds='2012') select * from alltypesorc order by ctinyint, cint, cbigint limit 100
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc
 POSTHOOK: Output: default@alltypesorc_part@ds=2012
@@ -65,28 +65,28 @@ STAGE PLANS:
             Map Operator Tree:
                 TableScan
                   alias: alltypesorc_part
-                  Statistics: Num rows: 200 Data size: 41576 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 200 Data size: 54496 Basic stats: COMPLETE Column stats: NONE
                   Select Operator
                     expressions: (cdouble + 2) (type: double)
                     outputColumnNames: _col0
-                    Statistics: Num rows: 200 Data size: 41576 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 200 Data size: 54496 Basic stats: COMPLETE Column stats: NONE
                     Reduce Output Operator
                       key expressions: _col0 (type: double)
                       sort order: +
-                      Statistics: Num rows: 200 Data size: 41576 Basic stats: COMPLETE Column stats: NONE
+                      Statistics: Num rows: 200 Data size: 54496 Basic stats: COMPLETE Column stats: NONE
             Execution mode: vectorized
         Reducer 2 
             Reduce Operator Tree:
               Select Operator
                 expressions: KEY.reducesinkkey0 (type: double)
                 outputColumnNames: _col0
-                Statistics: Num rows: 200 Data size: 41576 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 200 Data size: 54496 Basic stats: COMPLETE Column stats: NONE
                 Limit
                   Number of rows: 10
-                  Statistics: Num rows: 10 Data size: 2070 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 10 Data size: 2720 Basic stats: COMPLETE Column stats: NONE
                   File Output Operator
                     compressed: false
-                    Statistics: Num rows: 10 Data size: 2070 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 10 Data size: 2720 Basic stats: COMPLETE Column stats: NONE
                     table:
                         input format: org.apache.hadoop.mapred.TextInputFormat
                         output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -111,13 +111,13 @@ POSTHOOK: Input: default@alltypesorc_part
 POSTHOOK: Input: default@alltypesorc_part@ds=2011
 POSTHOOK: Input: default@alltypesorc_part@ds=2012
 #### A masked pattern was here ####
--15910.0
--15910.0
--15811.0
--15811.0
--15788.0
--15788.0
--15547.0
--15547.0
--15429.0
--15429.0
+NULL
+NULL
+-15863.0
+-15863.0
+-14988.0
+-14988.0
+-14646.0
+-14646.0
+-14236.0
+-14236.0
diff --git a/ql/src/test/results/clientpositive/spark/vectorized_mapjoin.q.out b/ql/src/test/results/clientpositive/spark/vectorized_mapjoin.q.out
index 29c6c56090..78b0b37e48 100644
--- a/ql/src/test/results/clientpositive/spark/vectorized_mapjoin.q.out
+++ b/ql/src/test/results/clientpositive/spark/vectorized_mapjoin.q.out
@@ -1,8 +1,12 @@
-PREHOOK: query: EXPLAIN SELECT COUNT(t1.cint), MAX(t2.cint), MIN(t1.cint), AVG(t1.cint+t2.cint)
+PREHOOK: query: -- SORT_QUERY_RESULTS
+
+EXPLAIN SELECT COUNT(t1.cint), MAX(t2.cint), MIN(t1.cint), AVG(t1.cint+t2.cint)
   FROM alltypesorc t1
   JOIN alltypesorc t2 ON t1.cint = t2.cint
 PREHOOK: type: QUERY
-POSTHOOK: query: EXPLAIN SELECT COUNT(t1.cint), MAX(t2.cint), MIN(t1.cint), AVG(t1.cint+t2.cint)
+POSTHOOK: query: -- SORT_QUERY_RESULTS
+
+EXPLAIN SELECT COUNT(t1.cint), MAX(t2.cint), MIN(t1.cint), AVG(t1.cint+t2.cint)
   FROM alltypesorc t1
   JOIN alltypesorc t2 ON t1.cint = t2.cint
 POSTHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/spark/vectorized_nested_mapjoin.q.out b/ql/src/test/results/clientpositive/spark/vectorized_nested_mapjoin.q.out
index c50f6cf348..a25d540730 100644
--- a/ql/src/test/results/clientpositive/spark/vectorized_nested_mapjoin.q.out
+++ b/ql/src/test/results/clientpositive/spark/vectorized_nested_mapjoin.q.out
@@ -1,6 +1,10 @@
-PREHOOK: query: explain select sum(t1.td) from (select  v1.csmallint as tsi, v1.cdouble as td from alltypesorc v1, alltypesorc v2 where v1.ctinyint=v2.ctinyint) t1 join alltypesorc v3 on t1.tsi=v3.csmallint
+PREHOOK: query: -- SORT_QUERY_RESULTS
+
+explain select sum(t1.td) from (select  v1.csmallint as tsi, v1.cdouble as td from alltypesorc v1, alltypesorc v2 where v1.ctinyint=v2.ctinyint) t1 join alltypesorc v3 on t1.tsi=v3.csmallint
 PREHOOK: type: QUERY
-POSTHOOK: query: explain select sum(t1.td) from (select  v1.csmallint as tsi, v1.cdouble as td from alltypesorc v1, alltypesorc v2 where v1.ctinyint=v2.ctinyint) t1 join alltypesorc v3 on t1.tsi=v3.csmallint
+POSTHOOK: query: -- SORT_QUERY_RESULTS
+
+explain select sum(t1.td) from (select  v1.csmallint as tsi, v1.cdouble as td from alltypesorc v1, alltypesorc v2 where v1.ctinyint=v2.ctinyint) t1 join alltypesorc v3 on t1.tsi=v3.csmallint
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
   Stage-2 is a root stage
diff --git a/ql/src/test/results/clientpositive/spark/vectorized_rcfile_columnar.q.out b/ql/src/test/results/clientpositive/spark/vectorized_rcfile_columnar.q.out
index ee8959be94..c35173edde 100644
--- a/ql/src/test/results/clientpositive/spark/vectorized_rcfile_columnar.q.out
+++ b/ql/src/test/results/clientpositive/spark/vectorized_rcfile_columnar.q.out
@@ -23,12 +23,12 @@ POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@columnTable
 PREHOOK: query: FROM src
-INSERT OVERWRITE TABLE columnTable SELECT src.key, src.value LIMIT 10
+INSERT OVERWRITE TABLE columnTable SELECT src.key, src.value ORDER BY src.key, src.value LIMIT 10
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
 PREHOOK: Output: default@columntable
 POSTHOOK: query: FROM src
-INSERT OVERWRITE TABLE columnTable SELECT src.key, src.value LIMIT 10
+INSERT OVERWRITE TABLE columnTable SELECT src.key, src.value ORDER BY src.key, src.value LIMIT 10
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 POSTHOOK: Output: default@columntable
@@ -50,13 +50,13 @@ POSTHOOK: query: SELECT key, value FROM columnTable ORDER BY key
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@columntable
 #### A masked pattern was here ####
-165	val_165
-238	val_238
-255	val_255
-27	val_27
-278	val_278
-311	val_311
-409	val_409
-484	val_484
-86	val_86
-98	val_98
+0	val_0
+0	val_0
+0	val_0
+10	val_10
+100	val_100
+100	val_100
+103	val_103
+103	val_103
+104	val_104
+104	val_104
diff --git a/ql/src/test/results/clientpositive/spark/vectorized_shufflejoin.q.out b/ql/src/test/results/clientpositive/spark/vectorized_shufflejoin.q.out
index 720a1a6b67..b84a4c37a3 100644
--- a/ql/src/test/results/clientpositive/spark/vectorized_shufflejoin.q.out
+++ b/ql/src/test/results/clientpositive/spark/vectorized_shufflejoin.q.out
@@ -1,10 +1,14 @@
-PREHOOK: query: EXPLAIN SELECT COUNT(t1.cint), MAX(t2.cint), MIN(t1.cint), AVG(t1.cint+t2.cint)
+PREHOOK: query: -- SORT_QUERY_RESULTS
+
+EXPLAIN SELECT COUNT(t1.cint) AS CNT, MAX(t2.cint) , MIN(t1.cint), AVG(t1.cint+t2.cint)
   FROM alltypesorc t1
-  JOIN alltypesorc t2 ON t1.cint = t2.cint
+  JOIN alltypesorc t2 ON t1.cint = t2.cint order by CNT
 PREHOOK: type: QUERY
-POSTHOOK: query: EXPLAIN SELECT COUNT(t1.cint), MAX(t2.cint), MIN(t1.cint), AVG(t1.cint+t2.cint)
+POSTHOOK: query: -- SORT_QUERY_RESULTS
+
+EXPLAIN SELECT COUNT(t1.cint) AS CNT, MAX(t2.cint) , MIN(t1.cint), AVG(t1.cint+t2.cint)
   FROM alltypesorc t1
-  JOIN alltypesorc t2 ON t1.cint = t2.cint
+  JOIN alltypesorc t2 ON t1.cint = t2.cint order by CNT
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
@@ -14,8 +18,9 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (PARTITION-LEVEL SORT, 2), Map 4 (PARTITION-LEVEL SORT, 2)
+        Reducer 2 <- Map 1 (PARTITION-LEVEL SORT, 2), Map 5 (PARTITION-LEVEL SORT, 2)
         Reducer 3 <- Reducer 2 (GROUP, 1)
+        Reducer 4 <- Reducer 3 (SORT, 1)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -32,7 +37,7 @@ STAGE PLANS:
                       Map-reduce partition columns: cint (type: int)
                       Statistics: Num rows: 6144 Data size: 188618 Basic stats: COMPLETE Column stats: NONE
             Execution mode: vectorized
-        Map 4 
+        Map 5 
             Map Operator Tree:
                 TableScan
                   alias: t2
@@ -72,6 +77,17 @@ STAGE PLANS:
                 mode: mergepartial
                 outputColumnNames: _col0, _col1, _col2, _col3
                 Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: NONE
+                Reduce Output Operator
+                  key expressions: _col0 (type: bigint)
+                  sort order: +
+                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: NONE
+                  value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: double)
+        Reducer 4 
+            Reduce Operator Tree:
+              Select Operator
+                expressions: KEY.reducesinkkey0 (type: bigint), VALUE._col0 (type: int), VALUE._col1 (type: int), VALUE._col2 (type: double)
+                outputColumnNames: _col0, _col1, _col2, _col3
+                Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: NONE
                 File Output Operator
                   compressed: false
                   Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: NONE
@@ -79,6 +95,7 @@ STAGE PLANS:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+            Execution mode: vectorized
 
   Stage: Stage-0
     Fetch Operator
@@ -86,15 +103,15 @@ STAGE PLANS:
       Processor Tree:
         ListSink
 
-PREHOOK: query: SELECT COUNT(t1.cint), MAX(t2.cint), MIN(t1.cint), AVG(t1.cint+t2.cint)
+PREHOOK: query: SELECT COUNT(t1.cint), MAX(t2.cint) AS CNT, MIN(t1.cint), AVG(t1.cint+t2.cint)
   FROM alltypesorc t1
-  JOIN alltypesorc t2 ON t1.cint = t2.cint
+  JOIN alltypesorc t2 ON t1.cint = t2.cint order by CNT
 PREHOOK: type: QUERY
 PREHOOK: Input: default@alltypesorc
 #### A masked pattern was here ####
-POSTHOOK: query: SELECT COUNT(t1.cint), MAX(t2.cint), MIN(t1.cint), AVG(t1.cint+t2.cint)
+POSTHOOK: query: SELECT COUNT(t1.cint), MAX(t2.cint) AS CNT, MIN(t1.cint), AVG(t1.cint+t2.cint)
   FROM alltypesorc t1
-  JOIN alltypesorc t2 ON t1.cint = t2.cint
+  JOIN alltypesorc t2 ON t1.cint = t2.cint order by CNT
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/spark/vectorized_timestamp_funcs.q.out b/ql/src/test/results/clientpositive/spark/vectorized_timestamp_funcs.q.out
index e9bef38b42..ed1ba4bd2b 100644
--- a/ql/src/test/results/clientpositive/spark/vectorized_timestamp_funcs.q.out
+++ b/ql/src/test/results/clientpositive/spark/vectorized_timestamp_funcs.q.out
@@ -18,18 +18,20 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@alltypesorc_string
 PREHOOK: query: INSERT OVERWRITE TABLE alltypesorc_string
 SELECT
-  to_utc_timestamp(ctimestamp1, 'America/Los_Angeles'),
-  CAST(to_utc_timestamp(ctimestamp1, 'America/Los_Angeles') AS STRING)
+  to_utc_timestamp(ctimestamp1, 'America/Los_Angeles') AS toutc,
+  CAST(to_utc_timestamp(ctimestamp1, 'America/Los_Angeles') AS STRING) as cst
 FROM alltypesorc
+ORDER BY toutc, cst
 LIMIT 40
 PREHOOK: type: QUERY
 PREHOOK: Input: default@alltypesorc
 PREHOOK: Output: default@alltypesorc_string
 POSTHOOK: query: INSERT OVERWRITE TABLE alltypesorc_string
 SELECT
-  to_utc_timestamp(ctimestamp1, 'America/Los_Angeles'),
-  CAST(to_utc_timestamp(ctimestamp1, 'America/Los_Angeles') AS STRING)
+  to_utc_timestamp(ctimestamp1, 'America/Los_Angeles') AS toutc,
+  CAST(to_utc_timestamp(ctimestamp1, 'America/Los_Angeles') AS STRING) as cst
 FROM alltypesorc
+ORDER BY toutc, cst
 LIMIT 40
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc
@@ -112,15 +114,15 @@ STAGE PLANS:
             Map Operator Tree:
                 TableScan
                   alias: alltypesorc_string
-                  Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
                   Select Operator
                     expressions: to_unix_timestamp(ctimestamp1) (type: bigint), year(ctimestamp1) (type: int), month(ctimestamp1) (type: int), day(ctimestamp1) (type: int), dayofmonth(ctimestamp1) (type: int), weekofyear(ctimestamp1) (type: int), hour(ctimestamp1) (type: int), minute(ctimestamp1) (type: int), second(ctimestamp1) (type: int)
                     outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
-                    Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
                     Reduce Output Operator
                       key expressions: _col0 (type: bigint)
                       sort order: +
-                      Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+                      Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
                       value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: int), _col6 (type: int), _col7 (type: int), _col8 (type: int)
             Execution mode: vectorized
         Reducer 2 
@@ -128,10 +130,10 @@ STAGE PLANS:
               Select Operator
                 expressions: KEY.reducesinkkey0 (type: bigint), VALUE._col0 (type: int), VALUE._col1 (type: int), VALUE._col2 (type: int), VALUE._col3 (type: int), VALUE._col4 (type: int), VALUE._col5 (type: int), VALUE._col6 (type: int), VALUE._col7 (type: int)
                 outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
-                Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
                 File Output Operator
                   compressed: false
-                  Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
                   table:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -175,45 +177,45 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc_string
 #### A masked pattern was here ####
 NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
-28784	1969	12	31	31	1	23	59	44
-28784	1969	12	31	31	1	23	59	44
-28784	1969	12	31	31	1	23	59	44
-28784	1969	12	31	31	1	23	59	44
-28785	1969	12	31	31	1	23	59	45
-28786	1969	12	31	31	1	23	59	46
-28787	1969	12	31	31	1	23	59	47
-28788	1969	12	31	31	1	23	59	48
-28789	1969	12	31	31	1	23	59	49
-28789	1969	12	31	31	1	23	59	49
-28790	1969	12	31	31	1	23	59	50
-28792	1969	12	31	31	1	23	59	52
-28792	1969	12	31	31	1	23	59	52
-28792	1969	12	31	31	1	23	59	52
-28792	1969	12	31	31	1	23	59	52
-28795	1969	12	31	31	1	23	59	55
-28795	1969	12	31	31	1	23	59	55
-28795	1969	12	31	31	1	23	59	55
-28798	1969	12	31	31	1	23	59	58
-28798	1969	12	31	31	1	23	59	58
-28800	1970	1	1	1	1	0	0	0
-28800	1970	1	1	1	1	0	0	0
-28802	1970	1	1	1	1	0	0	2
-28803	1970	1	1	1	1	0	0	3
-28804	1970	1	1	1	1	0	0	4
-28804	1970	1	1	1	1	0	0	4
-28805	1970	1	1	1	1	0	0	5
-28805	1970	1	1	1	1	0	0	5
-28806	1970	1	1	1	1	0	0	6
-28807	1970	1	1	1	1	0	0	7
-28807	1970	1	1	1	1	0	0	7
-28807	1970	1	1	1	1	0	0	7
-28808	1970	1	1	1	1	0	0	8
-28808	1970	1	1	1	1	0	0	8
-28809	1970	1	1	1	1	0	0	9
-28811	1970	1	1	1	1	0	0	11
-28813	1970	1	1	1	1	0	0	13
-28814	1970	1	1	1	1	0	0	14
-28815	1970	1	1	1	1	0	0	15
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
 PREHOOK: query: EXPLAIN SELECT
   to_unix_timestamp(stimestamp1) AS c1,
   year(stimestamp1),
@@ -255,15 +257,15 @@ STAGE PLANS:
             Map Operator Tree:
                 TableScan
                   alias: alltypesorc_string
-                  Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
                   Select Operator
                     expressions: to_unix_timestamp(stimestamp1) (type: bigint), year(stimestamp1) (type: int), month(stimestamp1) (type: int), day(stimestamp1) (type: int), dayofmonth(stimestamp1) (type: int), weekofyear(stimestamp1) (type: int), hour(stimestamp1) (type: int), minute(stimestamp1) (type: int), second(stimestamp1) (type: int)
                     outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
-                    Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
                     Reduce Output Operator
                       key expressions: _col0 (type: bigint)
                       sort order: +
-                      Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+                      Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
                       value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: int), _col6 (type: int), _col7 (type: int), _col8 (type: int)
             Execution mode: vectorized
         Reducer 2 
@@ -271,10 +273,10 @@ STAGE PLANS:
               Select Operator
                 expressions: KEY.reducesinkkey0 (type: bigint), VALUE._col0 (type: int), VALUE._col1 (type: int), VALUE._col2 (type: int), VALUE._col3 (type: int), VALUE._col4 (type: int), VALUE._col5 (type: int), VALUE._col6 (type: int), VALUE._col7 (type: int)
                 outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
-                Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
                 File Output Operator
                   compressed: false
-                  Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
                   table:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -318,45 +320,45 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc_string
 #### A masked pattern was here ####
 NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
-28784	1969	12	31	31	1	23	59	44
-28784	1969	12	31	31	1	23	59	44
-28784	1969	12	31	31	1	23	59	44
-28784	1969	12	31	31	1	23	59	44
-28785	1969	12	31	31	1	23	59	45
-28786	1969	12	31	31	1	23	59	46
-28787	1969	12	31	31	1	23	59	47
-28788	1969	12	31	31	1	23	59	48
-28789	1969	12	31	31	1	23	59	49
-28789	1969	12	31	31	1	23	59	49
-28790	1969	12	31	31	1	23	59	50
-28792	1969	12	31	31	1	23	59	52
-28792	1969	12	31	31	1	23	59	52
-28792	1969	12	31	31	1	23	59	52
-28792	1969	12	31	31	1	23	59	52
-28795	1969	12	31	31	1	23	59	55
-28795	1969	12	31	31	1	23	59	55
-28795	1969	12	31	31	1	23	59	55
-28798	1969	12	31	31	1	23	59	58
-28798	1969	12	31	31	1	23	59	58
-28800	1970	1	1	1	1	0	0	0
-28800	1970	1	1	1	1	0	0	0
-28802	1970	1	1	1	1	0	0	2
-28803	1970	1	1	1	1	0	0	3
-28804	1970	1	1	1	1	0	0	4
-28804	1970	1	1	1	1	0	0	4
-28805	1970	1	1	1	1	0	0	5
-28805	1970	1	1	1	1	0	0	5
-28806	1970	1	1	1	1	0	0	6
-28807	1970	1	1	1	1	0	0	7
-28807	1970	1	1	1	1	0	0	7
-28807	1970	1	1	1	1	0	0	7
-28808	1970	1	1	1	1	0	0	8
-28808	1970	1	1	1	1	0	0	8
-28809	1970	1	1	1	1	0	0	9
-28811	1970	1	1	1	1	0	0	11
-28813	1970	1	1	1	1	0	0	13
-28814	1970	1	1	1	1	0	0	14
-28815	1970	1	1	1	1	0	0	15
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
 PREHOOK: query: EXPLAIN SELECT
   to_unix_timestamp(ctimestamp1) = to_unix_timestamp(stimestamp1) AS c1,
   year(ctimestamp1) = year(stimestamp1),
@@ -398,15 +400,15 @@ STAGE PLANS:
             Map Operator Tree:
                 TableScan
                   alias: alltypesorc_string
-                  Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
                   Select Operator
                     expressions: (to_unix_timestamp(ctimestamp1) = to_unix_timestamp(stimestamp1)) (type: boolean), (year(ctimestamp1) = year(stimestamp1)) (type: boolean), (month(ctimestamp1) = month(stimestamp1)) (type: boolean), (day(ctimestamp1) = day(stimestamp1)) (type: boolean), (dayofmonth(ctimestamp1) = dayofmonth(stimestamp1)) (type: boolean), (weekofyear(ctimestamp1) = weekofyear(stimestamp1)) (type: boolean), (hour(ctimestamp1) = hour(stimestamp1)) (type: boolean), (minute(ctimestamp1) = minute(stimestamp1)) (type: boolean), (second(ctimestamp1) = second(stimestamp1)) (type: boolean)
                     outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
-                    Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
                     Reduce Output Operator
                       key expressions: _col0 (type: boolean)
                       sort order: +
-                      Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+                      Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
                       value expressions: _col1 (type: boolean), _col2 (type: boolean), _col3 (type: boolean), _col4 (type: boolean), _col5 (type: boolean), _col6 (type: boolean), _col7 (type: boolean), _col8 (type: boolean)
             Execution mode: vectorized
         Reducer 2 
@@ -414,10 +416,10 @@ STAGE PLANS:
               Select Operator
                 expressions: KEY.reducesinkkey0 (type: boolean), VALUE._col0 (type: boolean), VALUE._col1 (type: boolean), VALUE._col2 (type: boolean), VALUE._col3 (type: boolean), VALUE._col4 (type: boolean), VALUE._col5 (type: boolean), VALUE._col6 (type: boolean), VALUE._col7 (type: boolean)
                 outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
-                Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
                 File Output Operator
                   compressed: false
-                  Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
                   table:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -463,45 +465,45 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc_string
 #### A masked pattern was here ####
 NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
 PREHOOK: query: -- Wrong format. Should all be NULL.
 EXPLAIN SELECT
   to_unix_timestamp(stimestamp1) AS c1,
@@ -639,11 +641,11 @@ STAGE PLANS:
             Map Operator Tree:
                 TableScan
                   alias: alltypesorc_string
-                  Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
                   Select Operator
                     expressions: ctimestamp1 (type: timestamp)
                     outputColumnNames: ctimestamp1
-                    Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
                     Group By Operator
                       aggregations: min(ctimestamp1), max(ctimestamp1), count(ctimestamp1), count()
                       mode: hash
@@ -694,7 +696,7 @@ FROM alltypesorc_string
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc_string
 #### A masked pattern was here ####
-1969-12-31 23:59:44.088	1970-01-01 00:00:15.007	39	40
+NULL	NULL	0	40
 PREHOOK: query: -- SUM of timestamps are not vectorized reduce-side because they produce a double instead of a long (HIVE-8211)...
 EXPLAIN SELECT
   round(sum(ctimestamp1), 3)
@@ -720,11 +722,11 @@ STAGE PLANS:
             Map Operator Tree:
                 TableScan
                   alias: alltypesorc_string
-                  Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
                   Select Operator
                     expressions: ctimestamp1 (type: timestamp)
                     outputColumnNames: ctimestamp1
-                    Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
                     Group By Operator
                       aggregations: sum(ctimestamp1)
                       mode: hash
@@ -772,7 +774,7 @@ FROM alltypesorc_string
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc_string
 #### A masked pattern was here ####
-1123143.857
+NULL
 PREHOOK: query: EXPLAIN SELECT
   round(avg(ctimestamp1), 0),
   variance(ctimestamp1) between 8.97077295279421E19 and 8.97077295279422E19,
@@ -810,11 +812,11 @@ STAGE PLANS:
             Map Operator Tree:
                 TableScan
                   alias: alltypesorc_string
-                  Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
                   Select Operator
                     expressions: ctimestamp1 (type: timestamp)
                     outputColumnNames: ctimestamp1
-                    Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
                     Group By Operator
                       aggregations: avg(ctimestamp1), variance(ctimestamp1), var_pop(ctimestamp1), var_samp(ctimestamp1), std(ctimestamp1), stddev(ctimestamp1), stddev_pop(ctimestamp1), stddev_samp(ctimestamp1)
                       mode: hash
@@ -876,4 +878,4 @@ FROM alltypesorc_string
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc_string
 #### A masked pattern was here ####
-2.8798560435897E13	true	true	true	9.471416447815E9	9.471416447815E9	9.471416447815E9	9.595231068211E9
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
diff --git a/ql/src/test/results/clientpositive/subquery_exists.q.out b/ql/src/test/results/clientpositive/subquery_exists.q.out
index da18d2f4c3..776b145b86 100644
--- a/ql/src/test/results/clientpositive/subquery_exists.q.out
+++ b/ql/src/test/results/clientpositive/subquery_exists.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: -- SORT_QUERY_RESULTS
 
 -- no agg, corr
+-- SORT_QUERY_RESULTS
 explain
 select * 
 from src b 
@@ -13,6 +14,7 @@ PREHOOK: type: QUERY
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 -- no agg, corr
+-- SORT_QUERY_RESULTS
 explain
 select * 
 from src b 
diff --git a/ql/src/test/results/clientpositive/temp_table.q.out b/ql/src/test/results/clientpositive/temp_table.q.out
index cad71fdc71..2c5730d74e 100644
--- a/ql/src/test/results/clientpositive/temp_table.q.out
+++ b/ql/src/test/results/clientpositive/temp_table.q.out
@@ -228,48 +228,70 @@ POSTHOOK: type: DESCTABLE
 POSTHOOK: Input: default@bar
 key                 	string              	                    
 value               	string              	                    
-PREHOOK: query: explain select * from foo limit 10
+PREHOOK: query: explain select * from foo order by key limit 10
 PREHOOK: type: QUERY
-POSTHOOK: query: explain select * from foo limit 10
+POSTHOOK: query: explain select * from foo order by key limit 10
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
-  Stage-0 is a root stage
+  Stage-1 is a root stage
+  Stage-0 depends on stages: Stage-1
 
 STAGE PLANS:
+  Stage: Stage-1
+    Map Reduce
+      Map Operator Tree:
+          TableScan
+            alias: foo
+            Statistics: Num rows: 247 Data size: 2609 Basic stats: COMPLETE Column stats: NONE
+            Select Operator
+              expressions: key (type: string), value (type: string)
+              outputColumnNames: _col0, _col1
+              Statistics: Num rows: 247 Data size: 2609 Basic stats: COMPLETE Column stats: NONE
+              Reduce Output Operator
+                key expressions: _col0 (type: string)
+                sort order: +
+                Statistics: Num rows: 247 Data size: 2609 Basic stats: COMPLETE Column stats: NONE
+                value expressions: _col1 (type: string)
+      Reduce Operator Tree:
+        Select Operator
+          expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string)
+          outputColumnNames: _col0, _col1
+          Statistics: Num rows: 247 Data size: 2609 Basic stats: COMPLETE Column stats: NONE
+          Limit
+            Number of rows: 10
+            Statistics: Num rows: 10 Data size: 100 Basic stats: COMPLETE Column stats: NONE
+            File Output Operator
+              compressed: false
+              Statistics: Num rows: 10 Data size: 100 Basic stats: COMPLETE Column stats: NONE
+              table:
+                  input format: org.apache.hadoop.mapred.TextInputFormat
+                  output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+
   Stage: Stage-0
     Fetch Operator
       limit: 10
       Processor Tree:
-        TableScan
-          alias: foo
-          Statistics: Num rows: 247 Data size: 2609 Basic stats: COMPLETE Column stats: NONE
-          Select Operator
-            expressions: key (type: string), value (type: string)
-            outputColumnNames: _col0, _col1
-            Statistics: Num rows: 247 Data size: 2609 Basic stats: COMPLETE Column stats: NONE
-            Limit
-              Number of rows: 10
-              Statistics: Num rows: 10 Data size: 100 Basic stats: COMPLETE Column stats: NONE
-              ListSink
+        ListSink
 
-PREHOOK: query: select * from foo limit 10
+PREHOOK: query: select * from foo order by key limit 10
 PREHOOK: type: QUERY
 PREHOOK: Input: default@foo
 #### A masked pattern was here ####
-POSTHOOK: query: select * from foo limit 10
+POSTHOOK: query: select * from foo order by key limit 10
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@foo
 #### A masked pattern was here ####
-238	val_238
-86	val_86
-278	val_278
-98	val_98
-484	val_484
-150	val_150
-224	val_224
-66	val_66
-128	val_128
-146	val_146
+0	val_0
+0	val_0
+0	val_0
+10	val_10
+100	val_100
+100	val_100
+104	val_104
+104	val_104
+114	val_114
+116	val_116
 PREHOOK: query: explain select * from (select * from foo union all select * from bar) u order by key limit 10
 PREHOOK: type: QUERY
 POSTHOOK: query: explain select * from (select * from foo union all select * from bar) u order by key limit 10
@@ -396,11 +418,11 @@ POSTHOOK: Input: default@src
 POSTHOOK: Output: default@bay
 POSTHOOK: Lineage: bay.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: bay.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
-PREHOOK: query: select * from bay limit 10
+PREHOOK: query: select * from bay order by key limit 10
 PREHOOK: type: QUERY
 PREHOOK: Input: default@bay
 #### A masked pattern was here ####
-POSTHOOK: query: select * from bay limit 10
+POSTHOOK: query: select * from bay order by key limit 10
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@bay
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/tez/alter_merge_2_orc.q.out b/ql/src/test/results/clientpositive/tez/alter_merge_2_orc.q.out
index 1ccae8e944..7e30942696 100644
--- a/ql/src/test/results/clientpositive/tez/alter_merge_2_orc.q.out
+++ b/ql/src/test/results/clientpositive/tez/alter_merge_2_orc.q.out
@@ -31,31 +31,31 @@ ds                  	string
 ts                  	string              	                    
 	 	 
 #### A masked pattern was here ####
-PREHOOK: query: insert overwrite table src_orc_merge_test_part partition(ds='2012-01-03', ts='2012-01-03+14:46:31') select * from src
+PREHOOK: query: insert overwrite table src_orc_merge_test_part partition(ds='2012-01-03', ts='2012-01-03+14:46:31') select * from src order by key, value
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
 PREHOOK: Output: default@src_orc_merge_test_part@ds=2012-01-03/ts=2012-01-03+14%3A46%3A31
-POSTHOOK: query: insert overwrite table src_orc_merge_test_part partition(ds='2012-01-03', ts='2012-01-03+14:46:31') select * from src
+POSTHOOK: query: insert overwrite table src_orc_merge_test_part partition(ds='2012-01-03', ts='2012-01-03+14:46:31') select * from src order by key, value
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 POSTHOOK: Output: default@src_orc_merge_test_part@ds=2012-01-03/ts=2012-01-03+14%3A46%3A31
 POSTHOOK: Lineage: src_orc_merge_test_part PARTITION(ds=2012-01-03,ts=2012-01-03+14:46:31).key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: src_orc_merge_test_part PARTITION(ds=2012-01-03,ts=2012-01-03+14:46:31).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
-PREHOOK: query: insert into table src_orc_merge_test_part partition(ds='2012-01-03', ts='2012-01-03+14:46:31') select * from src limit 100
+PREHOOK: query: insert into table src_orc_merge_test_part partition(ds='2012-01-03', ts='2012-01-03+14:46:31') select * from src order by key, value limit 100
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
 PREHOOK: Output: default@src_orc_merge_test_part@ds=2012-01-03/ts=2012-01-03+14%3A46%3A31
-POSTHOOK: query: insert into table src_orc_merge_test_part partition(ds='2012-01-03', ts='2012-01-03+14:46:31') select * from src limit 100
+POSTHOOK: query: insert into table src_orc_merge_test_part partition(ds='2012-01-03', ts='2012-01-03+14:46:31') select * from src order by key, value limit 100
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 POSTHOOK: Output: default@src_orc_merge_test_part@ds=2012-01-03/ts=2012-01-03+14%3A46%3A31
 POSTHOOK: Lineage: src_orc_merge_test_part PARTITION(ds=2012-01-03,ts=2012-01-03+14:46:31).key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: src_orc_merge_test_part PARTITION(ds=2012-01-03,ts=2012-01-03+14:46:31).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
-PREHOOK: query: insert into table src_orc_merge_test_part partition(ds='2012-01-03', ts='2012-01-03+14:46:31') select * from src limit 10
+PREHOOK: query: insert into table src_orc_merge_test_part partition(ds='2012-01-03', ts='2012-01-03+14:46:31') select * from src order by key, value limit 10
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
 PREHOOK: Output: default@src_orc_merge_test_part@ds=2012-01-03/ts=2012-01-03+14%3A46%3A31
-POSTHOOK: query: insert into table src_orc_merge_test_part partition(ds='2012-01-03', ts='2012-01-03+14:46:31') select * from src limit 10
+POSTHOOK: query: insert into table src_orc_merge_test_part partition(ds='2012-01-03', ts='2012-01-03+14:46:31') select * from src order by key, value limit 10
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 POSTHOOK: Output: default@src_orc_merge_test_part@ds=2012-01-03/ts=2012-01-03+14%3A46%3A31
@@ -82,7 +82,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src_orc_merge_test_part
 POSTHOOK: Input: default@src_orc_merge_test_part@ds=2012-01-03/ts=2012-01-03+14%3A46%3A31
 #### A masked pattern was here ####
-159653	47778930280
+143807	50348357904
 PREHOOK: query: alter table src_orc_merge_test_part partition (ds='2012-01-03', ts='2012-01-03+14:46:31') concatenate
 PREHOOK: type: ALTER_PARTITION_MERGE
 PREHOOK: Input: default@src_orc_merge_test_part
@@ -112,7 +112,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src_orc_merge_test_part
 POSTHOOK: Input: default@src_orc_merge_test_part@ds=2012-01-03/ts=2012-01-03+14%3A46%3A31
 #### A masked pattern was here ####
-159653	47778930280
+143807	50348357904
 PREHOOK: query: drop table src_orc_merge_test_part
 PREHOOK: type: DROPTABLE
 PREHOOK: Input: default@src_orc_merge_test_part
diff --git a/ql/src/test/results/clientpositive/tez/auto_join0.q.out b/ql/src/test/results/clientpositive/tez/auto_join0.q.out
index cea6f998c9..beaac1712f 100644
--- a/ql/src/test/results/clientpositive/tez/auto_join0.q.out
+++ b/ql/src/test/results/clientpositive/tez/auto_join0.q.out
@@ -1,23 +1,27 @@
-Warning: Map Join MAPJOIN[20][bigTable=?] in task 'Map 1' is a cross product
-PREHOOK: query: explain 
+Warning: Map Join MAPJOIN[24][bigTable=?] in task 'Reducer 2' is a cross product
+PREHOOK: query: -- SORT_QUERY_RESULTS
+
+explain 
 select sum(hash(a.k1,a.v1,a.k2, a.v2))
 from (
 SELECT src1.key as k1, src1.value as v1, 
        src2.key as k2, src2.value as v2 FROM 
-  (SELECT * FROM src WHERE src.key < 10) src1 
+  (SELECT * FROM src WHERE src.key < 10 order by src.key, src.value) src1
     JOIN 
-  (SELECT * FROM src WHERE src.key < 10) src2
+  (SELECT * FROM src WHERE src.key < 10 order by src.key, src.value) src2
   SORT BY k1, v1, k2, v2
 ) a
 PREHOOK: type: QUERY
-POSTHOOK: query: explain 
+POSTHOOK: query: -- SORT_QUERY_RESULTS
+
+explain 
 select sum(hash(a.k1,a.v1,a.k2, a.v2))
 from (
 SELECT src1.key as k1, src1.value as v1, 
        src2.key as k2, src2.value as v2 FROM 
-  (SELECT * FROM src WHERE src.key < 10) src1 
+  (SELECT * FROM src WHERE src.key < 10 order by src.key, src.value) src1
     JOIN 
-  (SELECT * FROM src WHERE src.key < 10) src2
+  (SELECT * FROM src WHERE src.key < 10 order by src.key, src.value) src2
   SORT BY k1, v1, k2, v2
 ) a
 POSTHOOK: type: QUERY
@@ -29,9 +33,10 @@ STAGE PLANS:
   Stage: Stage-1
     Tez
       Edges:
-        Map 1 <- Map 4 (BROADCAST_EDGE)
-        Reducer 2 <- Map 1 (SIMPLE_EDGE)
+        Reducer 2 <- Map 1 (SIMPLE_EDGE), Reducer 6 (BROADCAST_EDGE)
         Reducer 3 <- Reducer 2 (SIMPLE_EDGE)
+        Reducer 4 <- Reducer 3 (SIMPLE_EDGE)
+        Reducer 6 <- Map 5 (SIMPLE_EDGE)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -46,22 +51,11 @@ STAGE PLANS:
                       expressions: key (type: string), value (type: string)
                       outputColumnNames: _col0, _col1
                       Statistics: Num rows: 166 Data size: 1763 Basic stats: COMPLETE Column stats: NONE
-                      Map Join Operator
-                        condition map:
-                             Inner Join 0 to 1
-                        keys:
-                          0 
-                          1 
-                        outputColumnNames: _col0, _col1, _col2, _col3
-                        input vertices:
-                          1 Map 4
-                        Statistics: Num rows: 182 Data size: 1939 Basic stats: COMPLETE Column stats: NONE
-                        HybridGraceHashJoin: true
-                        Reduce Output Operator
-                          key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string)
-                          sort order: ++++
-                          Statistics: Num rows: 182 Data size: 1939 Basic stats: COMPLETE Column stats: NONE
-        Map 4 
+                      Reduce Output Operator
+                        key expressions: _col0 (type: string), _col1 (type: string)
+                        sort order: ++
+                        Statistics: Num rows: 166 Data size: 1763 Basic stats: COMPLETE Column stats: NONE
+        Map 5 
             Map Operator Tree:
                 TableScan
                   alias: src
@@ -74,10 +68,31 @@ STAGE PLANS:
                       outputColumnNames: _col0, _col1
                       Statistics: Num rows: 166 Data size: 1763 Basic stats: COMPLETE Column stats: NONE
                       Reduce Output Operator
-                        sort order: 
+                        key expressions: _col0 (type: string), _col1 (type: string)
+                        sort order: ++
                         Statistics: Num rows: 166 Data size: 1763 Basic stats: COMPLETE Column stats: NONE
-                        value expressions: _col0 (type: string), _col1 (type: string)
         Reducer 2 
+            Reduce Operator Tree:
+              Select Operator
+                expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string)
+                outputColumnNames: _col0, _col1
+                Statistics: Num rows: 166 Data size: 1763 Basic stats: COMPLETE Column stats: NONE
+                Map Join Operator
+                  condition map:
+                       Inner Join 0 to 1
+                  keys:
+                    0 
+                    1 
+                  outputColumnNames: _col0, _col1, _col2, _col3
+                  input vertices:
+                    1 Reducer 6
+                  Statistics: Num rows: 182 Data size: 1939 Basic stats: COMPLETE Column stats: NONE
+                  HybridGraceHashJoin: true
+                  Reduce Output Operator
+                    key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: string), _col3 (type: string)
+                    sort order: ++++
+                    Statistics: Num rows: 182 Data size: 1939 Basic stats: COMPLETE Column stats: NONE
+        Reducer 3 
             Reduce Operator Tree:
               Select Operator
                 expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), KEY.reducesinkkey2 (type: string), KEY.reducesinkkey3 (type: string)
@@ -92,7 +107,7 @@ STAGE PLANS:
                     sort order: 
                     Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                     value expressions: _col0 (type: bigint)
-        Reducer 3 
+        Reducer 4 
             Reduce Operator Tree:
               Group By Operator
                 aggregations: sum(VALUE._col0)
@@ -106,6 +121,16 @@ STAGE PLANS:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+        Reducer 6 
+            Reduce Operator Tree:
+              Select Operator
+                expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string)
+                outputColumnNames: _col0, _col1
+                Statistics: Num rows: 166 Data size: 1763 Basic stats: COMPLETE Column stats: NONE
+                Reduce Output Operator
+                  sort order: 
+                  Statistics: Num rows: 166 Data size: 1763 Basic stats: COMPLETE Column stats: NONE
+                  value expressions: _col0 (type: string), _col1 (type: string)
 
   Stage: Stage-0
     Fetch Operator
@@ -113,14 +138,14 @@ STAGE PLANS:
       Processor Tree:
         ListSink
 
-Warning: Map Join MAPJOIN[20][bigTable=?] in task 'Map 1' is a cross product
+Warning: Map Join MAPJOIN[24][bigTable=?] in task 'Reducer 2' is a cross product
 PREHOOK: query: select sum(hash(a.k1,a.v1,a.k2, a.v2))
 from (
 SELECT src1.key as k1, src1.value as v1, 
        src2.key as k2, src2.value as v2 FROM 
-  (SELECT * FROM src WHERE src.key < 10) src1 
+  (SELECT * FROM src WHERE src.key < 10 order by src.key, src.value) src1
     JOIN 
-  (SELECT * FROM src WHERE src.key < 10) src2
+  (SELECT * FROM src WHERE src.key < 10 order by src.key, src.value) src2
   SORT BY k1, v1, k2, v2
 ) a
 PREHOOK: type: QUERY
@@ -130,9 +155,9 @@ POSTHOOK: query: select sum(hash(a.k1,a.v1,a.k2, a.v2))
 from (
 SELECT src1.key as k1, src1.value as v1, 
        src2.key as k2, src2.value as v2 FROM 
-  (SELECT * FROM src WHERE src.key < 10) src1 
+  (SELECT * FROM src WHERE src.key < 10 order by src.key, src.value) src1
     JOIN 
-  (SELECT * FROM src WHERE src.key < 10) src2
+  (SELECT * FROM src WHERE src.key < 10 order by src.key, src.value) src2
   SORT BY k1, v1, k2, v2
 ) a
 POSTHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/tez/auto_join1.q.out b/ql/src/test/results/clientpositive/tez/auto_join1.q.out
index 078d504f5d..41cbcc7f7b 100644
--- a/ql/src/test/results/clientpositive/tez/auto_join1.q.out
+++ b/ql/src/test/results/clientpositive/tez/auto_join1.q.out
@@ -1,8 +1,12 @@
-PREHOOK: query: CREATE TABLE dest_j1(key INT, value STRING) STORED AS TEXTFILE
+PREHOOK: query: -- SORT_QUERY_RESULTS
+
+CREATE TABLE dest_j1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@dest_j1
-POSTHOOK: query: CREATE TABLE dest_j1(key INT, value STRING) STORED AS TEXTFILE
+POSTHOOK: query: -- SORT_QUERY_RESULTS
+
+CREATE TABLE dest_j1(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@dest_j1
diff --git a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_5.q.out b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_5.q.out
index adcc1fa03e..4d85837327 100644
--- a/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_5.q.out
+++ b/ql/src/test/results/clientpositive/tez/auto_sortmerge_join_5.q.out
@@ -1,9 +1,15 @@
 PREHOOK: query: -- small no part, 4 bucket & big no part, 2 bucket
+
+-- SORT_QUERY_RESULTS
+
 CREATE TABLE bucket_small (key string, value string) CLUSTERED BY (key) SORTED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@bucket_small
 POSTHOOK: query: -- small no part, 4 bucket & big no part, 2 bucket
+
+-- SORT_QUERY_RESULTS
+
 CREATE TABLE bucket_small (key string, value string) CLUSTERED BY (key) SORTED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/tez/cbo_gby.q.out b/ql/src/test/results/clientpositive/tez/cbo_gby.q.out
index 3dc89145d7..04597a7bfb 100644
--- a/ql/src/test/results/clientpositive/tez/cbo_gby.q.out
+++ b/ql/src/test/results/clientpositive/tez/cbo_gby.q.out
@@ -1,20 +1,24 @@
-PREHOOK: query: -- 6. Test Select + TS + Join + Fil + GB + GB Having
+PREHOOK: query: -- SORT_QUERY_RESULTS
+
+-- 6. Test Select + TS + Join + Fil + GB + GB Having
 select key, (c_int+1)+2 as x, sum(c_int) from cbo_t1 group by c_float, cbo_t1.c_int, key
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cbo_t1
 PREHOOK: Input: default@cbo_t1@dt=2014
 #### A masked pattern was here ####
-POSTHOOK: query: -- 6. Test Select + TS + Join + Fil + GB + GB Having
+POSTHOOK: query: -- SORT_QUERY_RESULTS
+
+-- 6. Test Select + TS + Join + Fil + GB + GB Having
 select key, (c_int+1)+2 as x, sum(c_int) from cbo_t1 group by c_float, cbo_t1.c_int, key
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@cbo_t1
 POSTHOOK: Input: default@cbo_t1@dt=2014
 #### A masked pattern was here ####
-NULL	NULL	NULL
  1	4	2
  1 	4	2
 1	4	12
 1 	4	2
+NULL	NULL	NULL
 PREHOOK: query: select x, y, count(*) from (select key, (c_int+c_float+1+2) as x, sum(c_int) as y from cbo_t1 group by c_float, cbo_t1.c_int, key) R group by y, x
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cbo_t1
@@ -25,9 +29,9 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@cbo_t1
 POSTHOOK: Input: default@cbo_t1@dt=2014
 #### A masked pattern was here ####
-NULL	NULL	1
-5.0	2	3
 5.0	12	1
+5.0	2	3
+NULL	NULL	1
 PREHOOK: query: select cbo_t3.c_int, c, count(*) from (select key as a, c_int+1 as b, sum(c_int) as c from cbo_t1 where (cbo_t1.c_int + 1 >= 0) and (cbo_t1.c_int > 0 or cbo_t1.c_float >= 0) group by c_float, cbo_t1.c_int, key order by a) cbo_t1 join (select key as p, c_int+1 as q, sum(c_int) as r from cbo_t2 where (cbo_t2.c_int + 1 >= 0) and (cbo_t2.c_int > 0 or cbo_t2.c_float >= 0)  group by c_float, cbo_t2.c_int, key order by q/10 desc, r asc) cbo_t2 on cbo_t1.a=p join cbo_t3 on cbo_t1.a=key where (b + cbo_t2.q >= 0) and (b > 0 or c_int >= 0) group by cbo_t3.c_int, c order by cbo_t3.c_int+c desc, c
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cbo_t1
@@ -80,8 +84,8 @@ POSTHOOK: Input: default@cbo_t2
 POSTHOOK: Input: default@cbo_t2@dt=2014
 POSTHOOK: Input: default@cbo_t3
 #### A masked pattern was here ####
-1	2	6
 1	12	6
+1	2	6
 PREHOOK: query: select cbo_t3.c_int, c, count(*) from (select key as a, c_int+1 as b, sum(c_int) as c from cbo_t1 where (cbo_t1.c_int + 1 >= 0) and (cbo_t1.c_int > 0 or cbo_t1.c_float >= 0)  group by c_float, cbo_t1.c_int, key having cbo_t1.c_float > 0 and (c_int >=1 or c_float >= 1) and (c_int + c_float) >= 0 order by c+a desc) cbo_t1 full outer join (select key as p, c_int+1 as q, sum(c_int) as r from cbo_t2 where (cbo_t2.c_int + 1 >= 0) and (cbo_t2.c_int > 0 or cbo_t2.c_float >= 0)  group by c_float, cbo_t2.c_int, key having cbo_t2.c_float > 0 and (c_int >=1 or c_float >= 1) and (c_int + c_float) >= 0 order by p+q desc, r asc) cbo_t2 on cbo_t1.a=p full outer join cbo_t3 on cbo_t1.a=key where (b + cbo_t2.q >= 0) and (b > 0 or c_int >= 0) group by cbo_t3.c_int, c having cbo_t3.c_int > 0 and (c_int >=1 or c >= 1) and (c_int + c) >= 0 order by cbo_t3.c_int
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cbo_t1
@@ -116,5 +120,5 @@ POSTHOOK: Input: default@cbo_t2
 POSTHOOK: Input: default@cbo_t2@dt=2014
 POSTHOOK: Input: default@cbo_t3
 #### A masked pattern was here ####
-1	2	6
 1	12	6
+1	2	6
diff --git a/ql/src/test/results/clientpositive/tez/cbo_udf_udaf.q.out b/ql/src/test/results/clientpositive/tez/cbo_udf_udaf.q.out
index ded043f626..156d02f31e 100644
--- a/ql/src/test/results/clientpositive/tez/cbo_udf_udaf.q.out
+++ b/ql/src/test/results/clientpositive/tez/cbo_udf_udaf.q.out
@@ -1,10 +1,14 @@
-PREHOOK: query: -- 8. Test UDF/UDAF
+PREHOOK: query: -- SORT_QUERY_RESULTS
+
+-- 8. Test UDF/UDAF
 select count(*), count(c_int), sum(c_int), avg(c_int), max(c_int), min(c_int) from cbo_t1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cbo_t1
 PREHOOK: Input: default@cbo_t1@dt=2014
 #### A masked pattern was here ####
-POSTHOOK: query: -- 8. Test UDF/UDAF
+POSTHOOK: query: -- SORT_QUERY_RESULTS
+
+-- 8. Test UDF/UDAF
 select count(*), count(c_int), sum(c_int), avg(c_int), max(c_int), min(c_int) from cbo_t1
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@cbo_t1
@@ -21,8 +25,8 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@cbo_t1
 POSTHOOK: Input: default@cbo_t1@dt=2014
 #### A masked pattern was here ####
-2	0	NULL	NULL	NULL	NULL	3	6
 18	18	18	1.0	1	1	2	36
+2	0	NULL	NULL	NULL	NULL	3	6
 PREHOOK: query: select * from (select count(*) as a, count(distinct c_int) as b, sum(c_int) as c, avg(c_int) as d, max(c_int) as e, min(c_int) as f from cbo_t1) cbo_t1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cbo_t1
@@ -44,8 +48,8 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@cbo_t1
 POSTHOOK: Input: default@cbo_t1@dt=2014
 #### A masked pattern was here ####
-2	0	NULL	NULL	NULL	NULL	3	6
 18	1	18	1.0	1	1	2	36
+2	0	NULL	NULL	NULL	NULL	3	6
 PREHOOK: query: select f,a,e,b from (select count(*) as a, count(c_int) as b, sum(c_int) as c, avg(c_int) as d, max(c_int) as e, min(c_int) as f from cbo_t1) cbo_t1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cbo_t1
@@ -78,11 +82,11 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@cbo_t1
 POSTHOOK: Input: default@cbo_t1@dt=2014
 #### A masked pattern was here ####
-NULL	0	NULL
-1 	2	1.0
- 1 	2	1.0
  1	2	1.0
+ 1 	2	1.0
 1	12	1.0
+1 	2	1.0
+NULL	0	NULL
 PREHOOK: query: select count(distinct c_int) as a, avg(c_float) from cbo_t1 group by c_float order by a
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cbo_t1
diff --git a/ql/src/test/results/clientpositive/tez/cbo_windowing.q.out b/ql/src/test/results/clientpositive/tez/cbo_windowing.q.out
index 1a274b0839..57201b5784 100644
--- a/ql/src/test/results/clientpositive/tez/cbo_windowing.q.out
+++ b/ql/src/test/results/clientpositive/tez/cbo_windowing.q.out
@@ -1,10 +1,14 @@
 PREHOOK: query: -- 9. Test Windowing Functions
+-- SORT_QUERY_RESULTS
+
 select count(c_int) over() from cbo_t1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cbo_t1
 PREHOOK: Input: default@cbo_t1@dt=2014
 #### A masked pattern was here ####
 POSTHOOK: query: -- 9. Test Windowing Functions
+-- SORT_QUERY_RESULTS
+
 select count(c_int) over() from cbo_t1
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@cbo_t1
@@ -41,14 +45,6 @@ POSTHOOK: Input: default@cbo_t1
 POSTHOOK: Input: default@cbo_t1@dt=2014
 #### A masked pattern was here ####
 18	18.0	1	1	1	1	1	0.0	1	NULL
-18	18.0	1	1	2	1	1	0.0	1	NULL
-18	18.0	1	1	3	1	1	0.0	1	NULL
-18	18.0	1	1	4	1	1	0.0	1	NULL
-18	18.0	1	1	5	1	1	0.0	1	1.0
-18	18.0	1	1	6	1	1	0.0	1	1.0
-18	18.0	1	1	7	1	1	0.0	1	1.0
-18	18.0	1	1	8	1	1	0.0	1	1.0
-18	18.0	1	1	9	1	1	0.0	1	1.0
 18	18.0	1	1	10	1	1	0.0	1	1.0
 18	18.0	1	1	11	1	1	0.0	1	1.0
 18	18.0	1	1	12	1	1	0.0	1	1.0
@@ -59,7 +55,15 @@ POSTHOOK: Input: default@cbo_t1@dt=2014
 18	18.0	1	1	17	1	1	0.0	1	1.0
 18	18.0	1	1	18	1	1	0.0	1	1.0
 18	18.0	1	1	19	1	1	0.0	1	1.0
+18	18.0	1	1	2	1	1	0.0	1	NULL
 18	18.0	1	1	20	1	1	0.0	1	1.0
+18	18.0	1	1	3	1	1	0.0	1	NULL
+18	18.0	1	1	4	1	1	0.0	1	NULL
+18	18.0	1	1	5	1	1	0.0	1	1.0
+18	18.0	1	1	6	1	1	0.0	1	1.0
+18	18.0	1	1	7	1	1	0.0	1	1.0
+18	18.0	1	1	8	1	1	0.0	1	1.0
+18	18.0	1	1	9	1	1	0.0	1	1.0
 PREHOOK: query: select * from (select count(c_int) over(), sum(c_float) over(), max(c_int) over(), min(c_int) over(), row_number() over(), rank() over(), dense_rank() over(), percent_rank() over(), lead(c_int, 2, c_int) over(), lag(c_float, 2, c_float) over() from cbo_t1) cbo_t1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cbo_t1
@@ -71,14 +75,6 @@ POSTHOOK: Input: default@cbo_t1
 POSTHOOK: Input: default@cbo_t1@dt=2014
 #### A masked pattern was here ####
 18	18.0	1	1	1	1	1	0.0	1	NULL
-18	18.0	1	1	2	1	1	0.0	1	NULL
-18	18.0	1	1	3	1	1	0.0	1	NULL
-18	18.0	1	1	4	1	1	0.0	1	NULL
-18	18.0	1	1	5	1	1	0.0	1	1.0
-18	18.0	1	1	6	1	1	0.0	1	1.0
-18	18.0	1	1	7	1	1	0.0	1	1.0
-18	18.0	1	1	8	1	1	0.0	1	1.0
-18	18.0	1	1	9	1	1	0.0	1	1.0
 18	18.0	1	1	10	1	1	0.0	1	1.0
 18	18.0	1	1	11	1	1	0.0	1	1.0
 18	18.0	1	1	12	1	1	0.0	1	1.0
@@ -89,7 +85,15 @@ POSTHOOK: Input: default@cbo_t1@dt=2014
 18	18.0	1	1	17	1	1	0.0	1	1.0
 18	18.0	1	1	18	1	1	0.0	1	1.0
 18	18.0	1	1	19	1	1	0.0	1	1.0
+18	18.0	1	1	2	1	1	0.0	1	NULL
 18	18.0	1	1	20	1	1	0.0	1	1.0
+18	18.0	1	1	3	1	1	0.0	1	NULL
+18	18.0	1	1	4	1	1	0.0	1	NULL
+18	18.0	1	1	5	1	1	0.0	1	1.0
+18	18.0	1	1	6	1	1	0.0	1	1.0
+18	18.0	1	1	7	1	1	0.0	1	1.0
+18	18.0	1	1	8	1	1	0.0	1	1.0
+18	18.0	1	1	9	1	1	0.0	1	1.0
 PREHOOK: query: select x from (select count(c_int) over() as x, sum(c_float) over() from cbo_t1) cbo_t1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cbo_t1
@@ -171,13 +175,16 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@cbo_t1
 POSTHOOK: Input: default@cbo_t1@dt=2014
 #### A masked pattern was here ####
-NULL	NULL	0	NULL	NULL	NULL	NULL	NULL	NULL
-NULL	NULL	0	NULL	NULL	NULL	NULL	NULL	NULL
 1	1	1	1.0	1.0	1.0	1.0	1.0	1.0
-1	1	2	1.0	2.0	1.0	2.0	1.0	1.0
 1	1	1	1.0	1.0	1.0	1.0	1.0	1.0
-1	1	2	1.0	2.0	1.0	2.0	1.0	1.0
 1	1	1	1.0	1.0	1.0	1.0	1.0	1.0
+1	1	1	1.0	1.0	1.0	1.0	1.0	1.0
+1	1	2	1.0	10.0	1.0	2.0	1.0	1.0
+1	1	2	1.0	11.0	1.0	2.0	1.0	1.0
+1	1	2	1.0	12.0	1.0	2.0	1.0	1.0
+1	1	2	1.0	2.0	1.0	2.0	1.0	1.0
+1	1	2	1.0	2.0	1.0	2.0	1.0	1.0
+1	1	2	1.0	2.0	1.0	2.0	1.0	1.0
 1	1	2	1.0	2.0	1.0	2.0	1.0	1.0
 1	1	2	1.0	3.0	1.0	2.0	1.0	1.0
 1	1	2	1.0	4.0	1.0	2.0	1.0	1.0
@@ -186,11 +193,8 @@ NULL	NULL	0	NULL	NULL	NULL	NULL	NULL	NULL
 1	1	2	1.0	7.0	1.0	2.0	1.0	1.0
 1	1	2	1.0	8.0	1.0	2.0	1.0	1.0
 1	1	2	1.0	9.0	1.0	2.0	1.0	1.0
-1	1	2	1.0	10.0	1.0	2.0	1.0	1.0
-1	1	2	1.0	11.0	1.0	2.0	1.0	1.0
-1	1	2	1.0	12.0	1.0	2.0	1.0	1.0
-1	1	1	1.0	1.0	1.0	1.0	1.0	1.0
-1	1	2	1.0	2.0	1.0	2.0	1.0	1.0
+NULL	NULL	0	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	0	NULL	NULL	NULL	NULL	NULL	NULL
 PREHOOK: query: select i, a, h, b, c, d, e, f, g, a as x, a +1 as y from (select max(c_int) over (partition by key order by value range UNBOUNDED PRECEDING) a, min(c_int) over (partition by key order by value range current row) b, count(c_int) over(partition by key order by value range 1 PRECEDING) c, avg(value) over (partition by key order by value range between unbounded preceding and unbounded following) d, sum(value) over (partition by key order by value range between unbounded preceding and current row) e, avg(c_float) over (partition by key order by value range between 1 preceding and unbounded following) f, sum(c_float) over (partition by key order by value range between 1 preceding and current row) g, max(c_float) over (partition by key order by value range between 1 preceding and unbounded following) h, min(c_float) over (partition by key order by value range between 1 preceding and 1 following) i from cbo_t1) cbo_t1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@cbo_t1
@@ -201,12 +205,6 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@cbo_t1
 POSTHOOK: Input: default@cbo_t1@dt=2014
 #### A masked pattern was here ####
-NULL	NULL	NULL	NULL	0	NULL	NULL	NULL	NULL	NULL	NULL
-NULL	NULL	NULL	NULL	0	NULL	NULL	NULL	NULL	NULL	NULL
-1.0	1	1.0	1	2	1.0	2.0	1.0	2.0	1	2
-1.0	1	1.0	1	2	1.0	2.0	1.0	2.0	1	2
-1.0	1	1.0	1	2	1.0	2.0	1.0	2.0	1	2
-1.0	1	1.0	1	2	1.0	2.0	1.0	2.0	1	2
 1.0	1	1.0	1	12	1.0	12.0	1.0	12.0	1	2
 1.0	1	1.0	1	12	1.0	12.0	1.0	12.0	1	2
 1.0	1	1.0	1	12	1.0	12.0	1.0	12.0	1	2
@@ -221,6 +219,12 @@ NULL	NULL	NULL	NULL	0	NULL	NULL	NULL	NULL	NULL	NULL
 1.0	1	1.0	1	12	1.0	12.0	1.0	12.0	1	2
 1.0	1	1.0	1	2	1.0	2.0	1.0	2.0	1	2
 1.0	1	1.0	1	2	1.0	2.0	1.0	2.0	1	2
+1.0	1	1.0	1	2	1.0	2.0	1.0	2.0	1	2
+1.0	1	1.0	1	2	1.0	2.0	1.0	2.0	1	2
+1.0	1	1.0	1	2	1.0	2.0	1.0	2.0	1	2
+1.0	1	1.0	1	2	1.0	2.0	1.0	2.0	1	2
+NULL	NULL	NULL	NULL	0	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	0	NULL	NULL	NULL	NULL	NULL	NULL
 PREHOOK: query: select *, rank() over(partition by key order by value) as rr from src1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src1
diff --git a/ql/src/test/results/clientpositive/tez/cross_product_check_1.q.out b/ql/src/test/results/clientpositive/tez/cross_product_check_1.q.out
index 9274a59d6f..35c4ea81a9 100644
--- a/ql/src/test/results/clientpositive/tez/cross_product_check_1.q.out
+++ b/ql/src/test/results/clientpositive/tez/cross_product_check_1.q.out
@@ -1,10 +1,14 @@
-PREHOOK: query: create table A as
+PREHOOK: query: -- SORT_QUERY_RESULTS
+
+create table A as
 select * from src
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
 PREHOOK: Output: database:default
 PREHOOK: Output: default@A
-POSTHOOK: query: create table A as
+POSTHOOK: query: -- SORT_QUERY_RESULTS
+
+create table A as
 select * from src
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
@@ -189,12 +193,12 @@ STAGE PLANS:
 Warning: Shuffle Join MERGEJOIN[24][tables = [a, od1]] in Stage 'Reducer 4' is a cross product
 PREHOOK: query: explain select * from A join 
          (select d1.key 
-          from B d1 join B d2 on d1.key = d2.key 
+          from B d1 join B d2 on d1.key = d2.key
           where 1 = 1 group by d1.key) od1
 PREHOOK: type: QUERY
 POSTHOOK: query: explain select * from A join 
          (select d1.key 
-          from B d1 join B d2 on d1.key = d2.key 
+          from B d1 join B d2 on d1.key = d2.key
           where 1 = 1 group by d1.key) od1
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
@@ -306,9 +310,9 @@ STAGE PLANS:
 
 Warning: Shuffle Join MERGEJOIN[17][tables = [d1, d2]] in Stage 'Reducer 2' is a cross product
 Warning: Shuffle Join MERGEJOIN[18][tables = [a, od1]] in Stage 'Reducer 4' is a cross product
-PREHOOK: query: explain select * from A join (select d1.key from B d1 join B d2 where 1 = 1 group by d1.key) od1
+PREHOOK: query: explain select * from A join (select d1.key from B d1 join B d2 where 1 = 1  group by d1.key) od1
 PREHOOK: type: QUERY
-POSTHOOK: query: explain select * from A join (select d1.key from B d1 join B d2 where 1 = 1 group by d1.key) od1
+POSTHOOK: query: explain select * from A join (select d1.key from B d1 join B d2 where 1 = 1  group by d1.key) od1
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
@@ -410,11 +414,11 @@ STAGE PLANS:
 
 Warning: Shuffle Join MERGEJOIN[29][tables = [ss, od1]] in Stage 'Reducer 3' is a cross product
 PREHOOK: query: explain select * from 
-(select A.key from A group by key) ss join 
+(select A.key from A  group by key) ss join
 (select d1.key from B d1 join B d2 on d1.key = d2.key where 1 = 1 group by d1.key) od1
 PREHOOK: type: QUERY
 POSTHOOK: query: explain select * from 
-(select A.key from A group by key) ss join 
+(select A.key from A  group by key) ss join
 (select d1.key from B d1 join B d2 on d1.key = d2.key where 1 = 1 group by d1.key) od1
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
diff --git a/ql/src/test/results/clientpositive/tez/cross_product_check_2.q.out b/ql/src/test/results/clientpositive/tez/cross_product_check_2.q.out
index f732a8d7a0..14dd820eb4 100644
--- a/ql/src/test/results/clientpositive/tez/cross_product_check_2.q.out
+++ b/ql/src/test/results/clientpositive/tez/cross_product_check_2.q.out
@@ -1,24 +1,28 @@
-PREHOOK: query: create table A as
+PREHOOK: query: -- SORT_QUERY_RESULTS
+
+create table A as
 select * from src
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
 PREHOOK: Output: database:default
 PREHOOK: Output: default@A
-POSTHOOK: query: create table A as
+POSTHOOK: query: -- SORT_QUERY_RESULTS
+
+create table A as
 select * from src
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@A
 PREHOOK: query: create table B as
-select * from src
+select * from src order by key
 limit 10
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
 PREHOOK: Output: database:default
 PREHOOK: Output: default@B
 POSTHOOK: query: create table B as
-select * from src
+select * from src order by key
 limit 10
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
@@ -71,14 +75,14 @@ STAGE PLANS:
             Map Operator Tree:
                 TableScan
                   alias: b
-                  Statistics: Num rows: 10 Data size: 104 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 10 Data size: 96 Basic stats: COMPLETE Column stats: NONE
                   Select Operator
                     expressions: key (type: string), value (type: string)
                     outputColumnNames: _col0, _col1
-                    Statistics: Num rows: 10 Data size: 104 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 10 Data size: 96 Basic stats: COMPLETE Column stats: NONE
                     Reduce Output Operator
                       sort order: 
-                      Statistics: Num rows: 10 Data size: 104 Basic stats: COMPLETE Column stats: NONE
+                      Statistics: Num rows: 10 Data size: 96 Basic stats: COMPLETE Column stats: NONE
                       value expressions: _col0 (type: string), _col1 (type: string)
 
   Stage: Stage-0
@@ -108,10 +112,10 @@ STAGE PLANS:
             Map Operator Tree:
                 TableScan
                   alias: d1
-                  Statistics: Num rows: 10 Data size: 104 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 10 Data size: 96 Basic stats: COMPLETE Column stats: NONE
                   Filter Operator
                     predicate: key is not null (type: boolean)
-                    Statistics: Num rows: 5 Data size: 52 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 5 Data size: 48 Basic stats: COMPLETE Column stats: NONE
                     Map Join Operator
                       condition map:
                            Inner Join 0 to 1
@@ -121,25 +125,25 @@ STAGE PLANS:
                       outputColumnNames: _col0, _col1, _col5, _col6
                       input vertices:
                         1 Map 2
-                      Statistics: Num rows: 5 Data size: 57 Basic stats: COMPLETE Column stats: NONE
+                      Statistics: Num rows: 5 Data size: 52 Basic stats: COMPLETE Column stats: NONE
                       HybridGraceHashJoin: true
                       Reduce Output Operator
                         sort order: 
-                        Statistics: Num rows: 5 Data size: 57 Basic stats: COMPLETE Column stats: NONE
+                        Statistics: Num rows: 5 Data size: 52 Basic stats: COMPLETE Column stats: NONE
                         value expressions: _col0 (type: string), _col1 (type: string), _col5 (type: string), _col6 (type: string)
         Map 2 
             Map Operator Tree:
                 TableScan
                   alias: d2
-                  Statistics: Num rows: 10 Data size: 104 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 10 Data size: 96 Basic stats: COMPLETE Column stats: NONE
                   Filter Operator
                     predicate: key is not null (type: boolean)
-                    Statistics: Num rows: 5 Data size: 52 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 5 Data size: 48 Basic stats: COMPLETE Column stats: NONE
                     Reduce Output Operator
                       key expressions: key (type: string)
                       sort order: +
                       Map-reduce partition columns: key (type: string)
-                      Statistics: Num rows: 5 Data size: 52 Basic stats: COMPLETE Column stats: NONE
+                      Statistics: Num rows: 5 Data size: 48 Basic stats: COMPLETE Column stats: NONE
                       value expressions: value (type: string)
         Map 3 
             Map Operator Tree:
@@ -203,10 +207,10 @@ STAGE PLANS:
             Map Operator Tree:
                 TableScan
                   alias: d1
-                  Statistics: Num rows: 10 Data size: 104 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 10 Data size: 96 Basic stats: COMPLETE Column stats: NONE
                   Filter Operator
                     predicate: key is not null (type: boolean)
-                    Statistics: Num rows: 5 Data size: 52 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 5 Data size: 48 Basic stats: COMPLETE Column stats: NONE
                     Map Join Operator
                       condition map:
                            Inner Join 0 to 1
@@ -216,31 +220,31 @@ STAGE PLANS:
                       outputColumnNames: _col0
                       input vertices:
                         1 Map 3
-                      Statistics: Num rows: 5 Data size: 57 Basic stats: COMPLETE Column stats: NONE
+                      Statistics: Num rows: 5 Data size: 52 Basic stats: COMPLETE Column stats: NONE
                       HybridGraceHashJoin: true
                       Group By Operator
                         keys: _col0 (type: string)
                         mode: hash
                         outputColumnNames: _col0
-                        Statistics: Num rows: 5 Data size: 57 Basic stats: COMPLETE Column stats: NONE
+                        Statistics: Num rows: 5 Data size: 52 Basic stats: COMPLETE Column stats: NONE
                         Reduce Output Operator
                           key expressions: _col0 (type: string)
                           sort order: +
                           Map-reduce partition columns: _col0 (type: string)
-                          Statistics: Num rows: 5 Data size: 57 Basic stats: COMPLETE Column stats: NONE
+                          Statistics: Num rows: 5 Data size: 52 Basic stats: COMPLETE Column stats: NONE
         Map 3 
             Map Operator Tree:
                 TableScan
                   alias: d2
-                  Statistics: Num rows: 10 Data size: 104 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 10 Data size: 96 Basic stats: COMPLETE Column stats: NONE
                   Filter Operator
                     predicate: key is not null (type: boolean)
-                    Statistics: Num rows: 5 Data size: 52 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 5 Data size: 48 Basic stats: COMPLETE Column stats: NONE
                     Reduce Output Operator
                       key expressions: key (type: string)
                       sort order: +
                       Map-reduce partition columns: key (type: string)
-                      Statistics: Num rows: 5 Data size: 52 Basic stats: COMPLETE Column stats: NONE
+                      Statistics: Num rows: 5 Data size: 48 Basic stats: COMPLETE Column stats: NONE
         Map 4 
             Map Operator Tree:
                 TableScan
@@ -274,10 +278,10 @@ STAGE PLANS:
                 keys: KEY._col0 (type: string)
                 mode: mergepartial
                 outputColumnNames: _col0
-                Statistics: Num rows: 2 Data size: 22 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 2 Data size: 20 Basic stats: COMPLETE Column stats: NONE
                 Reduce Output Operator
                   sort order: 
-                  Statistics: Num rows: 2 Data size: 22 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 2 Data size: 20 Basic stats: COMPLETE Column stats: NONE
                   value expressions: _col0 (type: string)
 
   Stage: Stage-0
@@ -309,7 +313,7 @@ STAGE PLANS:
             Map Operator Tree:
                 TableScan
                   alias: d1
-                  Statistics: Num rows: 10 Data size: 104 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 10 Data size: 96 Basic stats: COMPLETE Column stats: NONE
                   Map Join Operator
                     condition map:
                          Inner Join 0 to 1
@@ -319,26 +323,26 @@ STAGE PLANS:
                     outputColumnNames: _col0
                     input vertices:
                       1 Map 3
-                    Statistics: Num rows: 11 Data size: 114 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 11 Data size: 105 Basic stats: COMPLETE Column stats: NONE
                     HybridGraceHashJoin: true
                     Group By Operator
                       keys: _col0 (type: string)
                       mode: hash
                       outputColumnNames: _col0
-                      Statistics: Num rows: 11 Data size: 114 Basic stats: COMPLETE Column stats: NONE
+                      Statistics: Num rows: 11 Data size: 105 Basic stats: COMPLETE Column stats: NONE
                       Reduce Output Operator
                         key expressions: _col0 (type: string)
                         sort order: +
                         Map-reduce partition columns: _col0 (type: string)
-                        Statistics: Num rows: 11 Data size: 114 Basic stats: COMPLETE Column stats: NONE
+                        Statistics: Num rows: 11 Data size: 105 Basic stats: COMPLETE Column stats: NONE
         Map 3 
             Map Operator Tree:
                 TableScan
                   alias: d2
-                  Statistics: Num rows: 10 Data size: 104 Basic stats: COMPLETE Column stats: COMPLETE
+                  Statistics: Num rows: 10 Data size: 96 Basic stats: COMPLETE Column stats: COMPLETE
                   Reduce Output Operator
                     sort order: 
-                    Statistics: Num rows: 10 Data size: 104 Basic stats: COMPLETE Column stats: COMPLETE
+                    Statistics: Num rows: 10 Data size: 96 Basic stats: COMPLETE Column stats: COMPLETE
         Map 4 
             Map Operator Tree:
                 TableScan
@@ -372,10 +376,10 @@ STAGE PLANS:
                 keys: KEY._col0 (type: string)
                 mode: mergepartial
                 outputColumnNames: _col0
-                Statistics: Num rows: 5 Data size: 51 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 5 Data size: 47 Basic stats: COMPLETE Column stats: NONE
                 Reduce Output Operator
                   sort order: 
-                  Statistics: Num rows: 5 Data size: 51 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 5 Data size: 47 Basic stats: COMPLETE Column stats: NONE
                   value expressions: _col0 (type: string)
 
   Stage: Stage-0
@@ -429,10 +433,10 @@ STAGE PLANS:
             Map Operator Tree:
                 TableScan
                   alias: d1
-                  Statistics: Num rows: 10 Data size: 104 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 10 Data size: 96 Basic stats: COMPLETE Column stats: NONE
                   Filter Operator
                     predicate: key is not null (type: boolean)
-                    Statistics: Num rows: 5 Data size: 52 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 5 Data size: 48 Basic stats: COMPLETE Column stats: NONE
                     Map Join Operator
                       condition map:
                            Inner Join 0 to 1
@@ -442,31 +446,31 @@ STAGE PLANS:
                       outputColumnNames: _col0
                       input vertices:
                         1 Map 5
-                      Statistics: Num rows: 5 Data size: 57 Basic stats: COMPLETE Column stats: NONE
+                      Statistics: Num rows: 5 Data size: 52 Basic stats: COMPLETE Column stats: NONE
                       HybridGraceHashJoin: true
                       Group By Operator
                         keys: _col0 (type: string)
                         mode: hash
                         outputColumnNames: _col0
-                        Statistics: Num rows: 5 Data size: 57 Basic stats: COMPLETE Column stats: NONE
+                        Statistics: Num rows: 5 Data size: 52 Basic stats: COMPLETE Column stats: NONE
                         Reduce Output Operator
                           key expressions: _col0 (type: string)
                           sort order: +
                           Map-reduce partition columns: _col0 (type: string)
-                          Statistics: Num rows: 5 Data size: 57 Basic stats: COMPLETE Column stats: NONE
+                          Statistics: Num rows: 5 Data size: 52 Basic stats: COMPLETE Column stats: NONE
         Map 5 
             Map Operator Tree:
                 TableScan
                   alias: d2
-                  Statistics: Num rows: 10 Data size: 104 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 10 Data size: 96 Basic stats: COMPLETE Column stats: NONE
                   Filter Operator
                     predicate: key is not null (type: boolean)
-                    Statistics: Num rows: 5 Data size: 52 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 5 Data size: 48 Basic stats: COMPLETE Column stats: NONE
                     Reduce Output Operator
                       key expressions: key (type: string)
                       sort order: +
                       Map-reduce partition columns: key (type: string)
-                      Statistics: Num rows: 5 Data size: 52 Basic stats: COMPLETE Column stats: NONE
+                      Statistics: Num rows: 5 Data size: 48 Basic stats: COMPLETE Column stats: NONE
         Reducer 2 
             Reduce Operator Tree:
               Group By Operator
@@ -498,10 +502,10 @@ STAGE PLANS:
                 keys: KEY._col0 (type: string)
                 mode: mergepartial
                 outputColumnNames: _col0
-                Statistics: Num rows: 2 Data size: 22 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 2 Data size: 20 Basic stats: COMPLETE Column stats: NONE
                 Reduce Output Operator
                   sort order: 
-                  Statistics: Num rows: 2 Data size: 22 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 2 Data size: 20 Basic stats: COMPLETE Column stats: NONE
                   value expressions: _col0 (type: string)
 
   Stage: Stage-0
diff --git a/ql/src/test/results/clientpositive/tez/ctas.q.out b/ql/src/test/results/clientpositive/tez/ctas.q.out
index d576fa5870..5e9aee2f1c 100644
--- a/ql/src/test/results/clientpositive/tez/ctas.q.out
+++ b/ql/src/test/results/clientpositive/tez/ctas.q.out
@@ -1,10 +1,12 @@
 PREHOOK: query: -- EXCLUDE_HADOOP_MAJOR_VERSIONS( 0.20S)
+-- SORT_QUERY_RESULTS
 
 create table nzhang_Tmp(a int, b string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@nzhang_Tmp
 POSTHOOK: query: -- EXCLUDE_HADOOP_MAJOR_VERSIONS( 0.20S)
+-- SORT_QUERY_RESULTS
 
 create table nzhang_Tmp(a int, b string)
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/tez/dynpart_sort_optimization2.q.out b/ql/src/test/results/clientpositive/tez/dynpart_sort_optimization2.q.out
index 5880ba084c..6b6d912b21 100644
--- a/ql/src/test/results/clientpositive/tez/dynpart_sort_optimization2.q.out
+++ b/ql/src/test/results/clientpositive/tez/dynpart_sort_optimization2.q.out
@@ -1,6 +1,10 @@
-PREHOOK: query: drop table ss
+PREHOOK: query: -- SORT_QUERY_RESULTS
+
+drop table ss
 PREHOOK: type: DROPTABLE
-POSTHOOK: query: drop table ss
+POSTHOOK: query: -- SORT_QUERY_RESULTS
+
+drop table ss
 POSTHOOK: type: DROPTABLE
 PREHOOK: query: drop table ss_orc
 PREHOOK: type: DROPTABLE
@@ -223,17 +227,17 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@ss_part
 POSTHOOK: Input: default@ss_part@ss_sold_date_sk=2452617
 #### A masked pattern was here ####
+10022.63	3952.8	2452617
+1765.07	-4648.8	2452617
 2.1	-2026.3	2452617
 2.99	-11.32	2452617
-85.8	25.61	2452617
-552.96	-1363.84	2452617
-565.92	196.48	2452617
-879.07	-2185.76	2452617
-1765.07	-4648.8	2452617
 3423.95	-3164.07	2452617
 5362.01	-600.28	2452617
+552.96	-1363.84	2452617
+565.92	196.48	2452617
 7412.83	2071.68	2452617
-10022.63	3952.8	2452617
+85.8	25.61	2452617
+879.07	-2185.76	2452617
 PREHOOK: query: desc formatted ss_part partition(ss_sold_date_sk=2452638)
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@ss_part
@@ -286,18 +290,18 @@ POSTHOOK: Input: default@ss_part
 POSTHOOK: Input: default@ss_part@ss_sold_date_sk=2452638
 #### A masked pattern was here ####
 0.15	-241.22	2452638
+10171.1	660.48	2452638
+1327.08	57.97	2452638
+1413.19	178.08	2452638
 150.39	-162.12	2452638
+1524.33	494.37	2452638
 156.67	-4626.56	2452638
 181.03	-207.24	2452638
+1971.35	-488.25	2452638
 267.01	-3266.36	2452638
 317.87	-3775.38	2452638
-1327.08	57.97	2452638
-1413.19	178.08	2452638
-1524.33	494.37	2452638
-1971.35	-488.25	2452638
 4133.98	-775.72	2452638
 4329.49	-4000.51	2452638
-10171.1	660.48	2452638
 PREHOOK: query: explain insert overwrite table ss_part partition (ss_sold_date_sk)
 select ss_net_paid_inc_tax,
   ss_net_profit,
@@ -455,16 +459,16 @@ POSTHOOK: Input: default@ss_part
 POSTHOOK: Input: default@ss_part@ss_sold_date_sk=2452617
 #### A masked pattern was here ####
 10022.63	3952.8	2452617
+1765.07	-4648.8	2452617
+2.1	-2026.3	2452617
 2.99	-11.32	2452617
 3423.95	-3164.07	2452617
 5362.01	-600.28	2452617
+552.96	-1363.84	2452617
 565.92	196.48	2452617
-85.8	25.61	2452617
 7412.83	2071.68	2452617
+85.8	25.61	2452617
 879.07	-2185.76	2452617
-1765.07	-4648.8	2452617
-552.96	-1363.84	2452617
-2.1	-2026.3	2452617
 PREHOOK: query: desc formatted ss_part partition(ss_sold_date_sk=2452638)
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@ss_part
@@ -516,19 +520,19 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@ss_part
 POSTHOOK: Input: default@ss_part@ss_sold_date_sk=2452638
 #### A masked pattern was here ####
-4329.49	-4000.51	2452638
+0.15	-241.22	2452638
+10171.1	660.48	2452638
+1327.08	57.97	2452638
 1413.19	178.08	2452638
 150.39	-162.12	2452638
 1524.33	494.37	2452638
-0.15	-241.22	2452638
-267.01	-3266.36	2452638
+156.67	-4626.56	2452638
 181.03	-207.24	2452638
 1971.35	-488.25	2452638
-1327.08	57.97	2452638
-156.67	-4626.56	2452638
+267.01	-3266.36	2452638
 317.87	-3775.38	2452638
-10171.1	660.48	2452638
 4133.98	-775.72	2452638
+4329.49	-4000.51	2452638
 PREHOOK: query: -- SORT DYNAMIC PARTITION DISABLED
 
 explain insert overwrite table ss_part partition (ss_sold_date_sk)
@@ -706,17 +710,17 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@ss_part
 POSTHOOK: Input: default@ss_part@ss_sold_date_sk=2452617
 #### A masked pattern was here ####
+10022.63	3952.8	2452617
+1765.07	-4648.8	2452617
 2.1	-2026.3	2452617
 2.99	-11.32	2452617
-85.8	25.61	2452617
-552.96	-1363.84	2452617
-565.92	196.48	2452617
-879.07	-2185.76	2452617
-1765.07	-4648.8	2452617
 3423.95	-3164.07	2452617
 5362.01	-600.28	2452617
+552.96	-1363.84	2452617
+565.92	196.48	2452617
 7412.83	2071.68	2452617
-10022.63	3952.8	2452617
+85.8	25.61	2452617
+879.07	-2185.76	2452617
 PREHOOK: query: desc formatted ss_part partition(ss_sold_date_sk=2452638)
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@ss_part
@@ -769,18 +773,18 @@ POSTHOOK: Input: default@ss_part
 POSTHOOK: Input: default@ss_part@ss_sold_date_sk=2452638
 #### A masked pattern was here ####
 0.15	-241.22	2452638
+10171.1	660.48	2452638
+1327.08	57.97	2452638
+1413.19	178.08	2452638
 150.39	-162.12	2452638
+1524.33	494.37	2452638
 156.67	-4626.56	2452638
 181.03	-207.24	2452638
+1971.35	-488.25	2452638
 267.01	-3266.36	2452638
 317.87	-3775.38	2452638
-1327.08	57.97	2452638
-1413.19	178.08	2452638
-1524.33	494.37	2452638
-1971.35	-488.25	2452638
 4133.98	-775.72	2452638
 4329.49	-4000.51	2452638
-10171.1	660.48	2452638
 PREHOOK: query: explain insert overwrite table ss_part partition (ss_sold_date_sk)
 select ss_net_paid_inc_tax,
   ss_net_profit,
@@ -936,17 +940,17 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@ss_part
 POSTHOOK: Input: default@ss_part@ss_sold_date_sk=2452617
 #### A masked pattern was here ####
+10022.63	3952.8	2452617
+1765.07	-4648.8	2452617
+2.1	-2026.3	2452617
+2.99	-11.32	2452617
 3423.95	-3164.07	2452617
 5362.01	-600.28	2452617
+552.96	-1363.84	2452617
 565.92	196.48	2452617
-85.8	25.61	2452617
 7412.83	2071.68	2452617
+85.8	25.61	2452617
 879.07	-2185.76	2452617
-1765.07	-4648.8	2452617
-552.96	-1363.84	2452617
-2.1	-2026.3	2452617
-10022.63	3952.8	2452617
-2.99	-11.32	2452617
 PREHOOK: query: desc formatted ss_part partition(ss_sold_date_sk=2452638)
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@ss_part
@@ -998,19 +1002,19 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@ss_part
 POSTHOOK: Input: default@ss_part@ss_sold_date_sk=2452638
 #### A masked pattern was here ####
-4329.49	-4000.51	2452638
+0.15	-241.22	2452638
+10171.1	660.48	2452638
+1327.08	57.97	2452638
 1413.19	178.08	2452638
 150.39	-162.12	2452638
 1524.33	494.37	2452638
-0.15	-241.22	2452638
-267.01	-3266.36	2452638
+156.67	-4626.56	2452638
 181.03	-207.24	2452638
 1971.35	-488.25	2452638
-1327.08	57.97	2452638
-156.67	-4626.56	2452638
+267.01	-3266.36	2452638
 317.87	-3775.38	2452638
-10171.1	660.48	2452638
 4133.98	-775.72	2452638
+4329.49	-4000.51	2452638
 PREHOOK: query: -- VECTORIZATION IS ENABLED
 
 create table ss_orc (
@@ -1245,17 +1249,17 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@ss_part_orc
 POSTHOOK: Input: default@ss_part_orc@ss_sold_date_sk=2452617
 #### A masked pattern was here ####
+10022.63	3952.8	2452617
+1765.07	-4648.8	2452617
 2.1	-2026.3	2452617
 2.99	-11.32	2452617
-85.8	25.61	2452617
-552.96	-1363.84	2452617
-565.92	196.48	2452617
-879.07	-2185.76	2452617
-1765.07	-4648.8	2452617
 3423.95	-3164.07	2452617
 5362.01	-600.28	2452617
+552.96	-1363.84	2452617
+565.92	196.48	2452617
 7412.83	2071.68	2452617
-10022.63	3952.8	2452617
+85.8	25.61	2452617
+879.07	-2185.76	2452617
 PREHOOK: query: desc formatted ss_part_orc partition(ss_sold_date_sk=2452638)
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@ss_part_orc
@@ -1308,18 +1312,18 @@ POSTHOOK: Input: default@ss_part_orc
 POSTHOOK: Input: default@ss_part_orc@ss_sold_date_sk=2452638
 #### A masked pattern was here ####
 0.15	-241.22	2452638
+10171.1	660.48	2452638
+1327.08	57.97	2452638
+1413.19	178.08	2452638
 150.39	-162.12	2452638
+1524.33	494.37	2452638
 156.67	-4626.56	2452638
 181.03	-207.24	2452638
+1971.35	-488.25	2452638
 267.01	-3266.36	2452638
 317.87	-3775.38	2452638
-1327.08	57.97	2452638
-1413.19	178.08	2452638
-1524.33	494.37	2452638
-1971.35	-488.25	2452638
 4133.98	-775.72	2452638
 4329.49	-4000.51	2452638
-10171.1	660.48	2452638
 PREHOOK: query: explain insert overwrite table ss_part_orc partition (ss_sold_date_sk)
 select ss_net_paid_inc_tax,
   ss_net_profit,
@@ -1477,17 +1481,17 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@ss_part_orc
 POSTHOOK: Input: default@ss_part_orc@ss_sold_date_sk=2452617
 #### A masked pattern was here ####
+10022.63	3952.8	2452617
+1765.07	-4648.8	2452617
+2.1	-2026.3	2452617
+2.99	-11.32	2452617
 3423.95	-3164.07	2452617
 5362.01	-600.28	2452617
+552.96	-1363.84	2452617
 565.92	196.48	2452617
-85.8	25.61	2452617
 7412.83	2071.68	2452617
+85.8	25.61	2452617
 879.07	-2185.76	2452617
-1765.07	-4648.8	2452617
-552.96	-1363.84	2452617
-2.1	-2026.3	2452617
-10022.63	3952.8	2452617
-2.99	-11.32	2452617
 PREHOOK: query: desc formatted ss_part_orc partition(ss_sold_date_sk=2452638)
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: default@ss_part_orc
@@ -1539,19 +1543,19 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@ss_part_orc
 POSTHOOK: Input: default@ss_part_orc@ss_sold_date_sk=2452638
 #### A masked pattern was here ####
-4329.49	-4000.51	2452638
+0.15	-241.22	2452638
+10171.1	660.48	2452638
+1327.08	57.97	2452638
 1413.19	178.08	2452638
 150.39	-162.12	2452638
 1524.33	494.37	2452638
-0.15	-241.22	2452638
-267.01	-3266.36	2452638
+156.67	-4626.56	2452638
 181.03	-207.24	2452638
 1971.35	-488.25	2452638
-1327.08	57.97	2452638
-156.67	-4626.56	2452638
+267.01	-3266.36	2452638
 317.87	-3775.38	2452638
-10171.1	660.48	2452638
 4133.98	-775.72	2452638
+4329.49	-4000.51	2452638
 PREHOOK: query: drop table ss_orc
 PREHOOK: type: DROPTABLE
 PREHOOK: Input: default@ss_orc
@@ -1702,21 +1706,21 @@ POSTHOOK: Input: default@src
 POSTHOOK: Output: default@hive13_dp1@day=day
 POSTHOOK: Lineage: hive13_dp1 PARTITION(day=day).k1 EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: hive13_dp1 PARTITION(day=day).k2 EXPRESSION [(src)src.FieldSchema(name:value, type:string, comment:default), ]
-PREHOOK: query: select * from hive13_dp1 limit 5
+PREHOOK: query: select * from hive13_dp1 order by k1, k2 limit 5
 PREHOOK: type: QUERY
 PREHOOK: Input: default@hive13_dp1
 PREHOOK: Input: default@hive13_dp1@day=day
 #### A masked pattern was here ####
-POSTHOOK: query: select * from hive13_dp1 limit 5
+POSTHOOK: query: select * from hive13_dp1 order by k1, k2 limit 5
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@hive13_dp1
 POSTHOOK: Input: default@hive13_dp1@day=day
 #### A masked pattern was here ####
 0	3	day
-10	1	day
-100	2	day
-103	2	day
-104	2	day
+2	1	day
+4	1	day
+5	3	day
+8	1	day
 PREHOOK: query: explain insert overwrite table `hive13_dp1` partition(`day`)
 select
     key k1,
@@ -1829,21 +1833,21 @@ POSTHOOK: Input: default@src
 POSTHOOK: Output: default@hive13_dp1@day=day
 POSTHOOK: Lineage: hive13_dp1 PARTITION(day=day).k1 EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: hive13_dp1 PARTITION(day=day).k2 EXPRESSION [(src)src.FieldSchema(name:value, type:string, comment:default), ]
-PREHOOK: query: select * from hive13_dp1 limit 5
+PREHOOK: query: select * from hive13_dp1 order by k1, k2 limit 5
 PREHOOK: type: QUERY
 PREHOOK: Input: default@hive13_dp1
 PREHOOK: Input: default@hive13_dp1@day=day
 #### A masked pattern was here ####
-POSTHOOK: query: select * from hive13_dp1 limit 5
+POSTHOOK: query: select * from hive13_dp1 order by k1, k2 limit 5
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@hive13_dp1
 POSTHOOK: Input: default@hive13_dp1@day=day
 #### A masked pattern was here ####
 0	3	day
-10	1	day
-100	2	day
-103	2	day
-104	2	day
+2	1	day
+4	1	day
+5	3	day
+8	1	day
 PREHOOK: query: drop table hive13_dp1
 PREHOOK: type: DROPTABLE
 PREHOOK: Input: default@hive13_dp1
diff --git a/ql/src/test/results/clientpositive/tez/explainuser_2.q.out b/ql/src/test/results/clientpositive/tez/explainuser_2.q.out
index 0511819cc2..03407146a0 100644
--- a/ql/src/test/results/clientpositive/tez/explainuser_2.q.out
+++ b/ql/src/test/results/clientpositive/tez/explainuser_2.q.out
@@ -1,8 +1,12 @@
-PREHOOK: query: CREATE TABLE dest_j1(key STRING, value STRING, val2 STRING) STORED AS TEXTFILE
+PREHOOK: query: -- SORT_QUERY_RESULTS
+
+CREATE TABLE dest_j1(key STRING, value STRING, val2 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@dest_j1
-POSTHOOK: query: CREATE TABLE dest_j1(key STRING, value STRING, val2 STRING) STORED AS TEXTFILE
+POSTHOOK: query: -- SORT_QUERY_RESULTS
+
+CREATE TABLE dest_j1(key STRING, value STRING, val2 STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@dest_j1
diff --git a/ql/src/test/results/clientpositive/tez/filter_join_breaktask2.q.out b/ql/src/test/results/clientpositive/tez/filter_join_breaktask2.q.out
index 6a2396e946..af85af972e 100644
--- a/ql/src/test/results/clientpositive/tez/filter_join_breaktask2.q.out
+++ b/ql/src/test/results/clientpositive/tez/filter_join_breaktask2.q.out
@@ -1,9 +1,13 @@
-PREHOOK: query: create table T1(c1 string, c2 string, c3 string, c4 string, c5 string, c6 string, c7 string) 
+PREHOOK: query: -- SORT_QUERY_RESULTS
+
+create table T1(c1 string, c2 string, c3 string, c4 string, c5 string, c6 string, c7 string) 
 partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@T1
-POSTHOOK: query: create table T1(c1 string, c2 string, c3 string, c4 string, c5 string, c6 string, c7 string) 
+POSTHOOK: query: -- SORT_QUERY_RESULTS
+
+create table T1(c1 string, c2 string, c3 string, c4 string, c5 string, c6 string, c7 string) 
 partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/tez/insert_into1.q.out b/ql/src/test/results/clientpositive/tez/insert_into1.q.out
index 359470b7da..3d576a4276 100644
--- a/ql/src/test/results/clientpositive/tez/insert_into1.q.out
+++ b/ql/src/test/results/clientpositive/tez/insert_into1.q.out
@@ -1,6 +1,10 @@
-PREHOOK: query: DROP TABLE insert_into1
+PREHOOK: query: -- SORT_QUERY_RESULTS
+
+DROP TABLE insert_into1
 PREHOOK: type: DROPTABLE
-POSTHOOK: query: DROP TABLE insert_into1
+POSTHOOK: query: -- SORT_QUERY_RESULTS
+
+DROP TABLE insert_into1
 POSTHOOK: type: DROPTABLE
 PREHOOK: query: CREATE TABLE insert_into1 (key int, value string)
 PREHOOK: type: CREATETABLE
@@ -10,9 +14,9 @@ POSTHOOK: query: CREATE TABLE insert_into1 (key int, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@insert_into1
-PREHOOK: query: EXPLAIN INSERT INTO TABLE insert_into1 SELECT * from src LIMIT 100
+PREHOOK: query: EXPLAIN INSERT INTO TABLE insert_into1 SELECT * from src ORDER BY key LIMIT 100
 PREHOOK: type: QUERY
-POSTHOOK: query: EXPLAIN INSERT INTO TABLE insert_into1 SELECT * from src LIMIT 100
+POSTHOOK: query: EXPLAIN INSERT INTO TABLE insert_into1 SELECT * from src ORDER BY key LIMIT 100
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
@@ -36,19 +40,17 @@ STAGE PLANS:
                     expressions: key (type: string), value (type: string)
                     outputColumnNames: _col0, _col1
                     Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
-                    Limit
-                      Number of rows: 100
-                      Statistics: Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
-                      Reduce Output Operator
-                        sort order: 
-                        Statistics: Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
-                        value expressions: _col0 (type: string), _col1 (type: string)
+                    Reduce Output Operator
+                      key expressions: _col0 (type: string)
+                      sort order: +
+                      Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
+                      value expressions: _col1 (type: string)
         Reducer 2 
             Reduce Operator Tree:
               Select Operator
-                expressions: VALUE._col0 (type: string), VALUE._col1 (type: string)
+                expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string)
                 outputColumnNames: _col0, _col1
-                Statistics: Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                 Limit
                   Number of rows: 100
                   Statistics: Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
@@ -81,11 +83,11 @@ STAGE PLANS:
   Stage: Stage-3
     Stats-Aggr Operator
 
-PREHOOK: query: INSERT INTO TABLE insert_into1 SELECT * from src LIMIT 100
+PREHOOK: query: INSERT INTO TABLE insert_into1 SELECT * from src ORDER BY key LIMIT 100
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
 PREHOOK: Output: default@insert_into1
-POSTHOOK: query: INSERT INTO TABLE insert_into1 SELECT * from src LIMIT 100
+POSTHOOK: query: INSERT INTO TABLE insert_into1 SELECT * from src ORDER BY key LIMIT 100
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 POSTHOOK: Output: default@insert_into1
@@ -103,7 +105,7 @@ POSTHOOK: query: SELECT SUM(HASH(c)) FROM (
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@insert_into1
 #### A masked pattern was here ####
-10226524244
+-1142373758
 PREHOOK: query: explain 
 select count(*) from insert_into1
 PREHOOK: type: QUERY
@@ -129,9 +131,9 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@insert_into1
 #### A masked pattern was here ####
 100
-PREHOOK: query: EXPLAIN INSERT INTO TABLE insert_into1 SELECT * FROM src LIMIT 100
+PREHOOK: query: EXPLAIN INSERT INTO TABLE insert_into1 SELECT * FROM src ORDER BY key LIMIT 100
 PREHOOK: type: QUERY
-POSTHOOK: query: EXPLAIN INSERT INTO TABLE insert_into1 SELECT * FROM src LIMIT 100
+POSTHOOK: query: EXPLAIN INSERT INTO TABLE insert_into1 SELECT * FROM src ORDER BY key LIMIT 100
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
@@ -155,19 +157,17 @@ STAGE PLANS:
                     expressions: key (type: string), value (type: string)
                     outputColumnNames: _col0, _col1
                     Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
-                    Limit
-                      Number of rows: 100
-                      Statistics: Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
-                      Reduce Output Operator
-                        sort order: 
-                        Statistics: Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
-                        value expressions: _col0 (type: string), _col1 (type: string)
+                    Reduce Output Operator
+                      key expressions: _col0 (type: string)
+                      sort order: +
+                      Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
+                      value expressions: _col1 (type: string)
         Reducer 2 
             Reduce Operator Tree:
               Select Operator
-                expressions: VALUE._col0 (type: string), VALUE._col1 (type: string)
+                expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string)
                 outputColumnNames: _col0, _col1
-                Statistics: Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                 Limit
                   Number of rows: 100
                   Statistics: Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
@@ -200,11 +200,11 @@ STAGE PLANS:
   Stage: Stage-3
     Stats-Aggr Operator
 
-PREHOOK: query: INSERT INTO TABLE insert_into1 SELECT * FROM src LIMIT 100
+PREHOOK: query: INSERT INTO TABLE insert_into1 SELECT * FROM src ORDER BY key LIMIT 100
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
 PREHOOK: Output: default@insert_into1
-POSTHOOK: query: INSERT INTO TABLE insert_into1 SELECT * FROM src LIMIT 100
+POSTHOOK: query: INSERT INTO TABLE insert_into1 SELECT * FROM src ORDER BY key LIMIT 100
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 POSTHOOK: Output: default@insert_into1
@@ -222,7 +222,7 @@ POSTHOOK: query: SELECT SUM(HASH(c)) FROM (
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@insert_into1
 #### A masked pattern was here ####
-20453048488
+-2284747516
 PREHOOK: query: explain
 SELECT COUNT(*) FROM insert_into1
 PREHOOK: type: QUERY
@@ -248,9 +248,9 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@insert_into1
 #### A masked pattern was here ####
 200
-PREHOOK: query: EXPLAIN INSERT OVERWRITE TABLE insert_into1 SELECT * FROM src LIMIT 10
+PREHOOK: query: EXPLAIN INSERT OVERWRITE TABLE insert_into1 SELECT * FROM src ORDER BY key LIMIT 10
 PREHOOK: type: QUERY
-POSTHOOK: query: EXPLAIN INSERT OVERWRITE TABLE insert_into1 SELECT * FROM src LIMIT 10
+POSTHOOK: query: EXPLAIN INSERT OVERWRITE TABLE insert_into1 SELECT * FROM src ORDER BY key LIMIT 10
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
@@ -274,19 +274,17 @@ STAGE PLANS:
                     expressions: key (type: string), value (type: string)
                     outputColumnNames: _col0, _col1
                     Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
-                    Limit
-                      Number of rows: 10
-                      Statistics: Num rows: 10 Data size: 100 Basic stats: COMPLETE Column stats: NONE
-                      Reduce Output Operator
-                        sort order: 
-                        Statistics: Num rows: 10 Data size: 100 Basic stats: COMPLETE Column stats: NONE
-                        value expressions: _col0 (type: string), _col1 (type: string)
+                    Reduce Output Operator
+                      key expressions: _col0 (type: string)
+                      sort order: +
+                      Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
+                      value expressions: _col1 (type: string)
         Reducer 2 
             Reduce Operator Tree:
               Select Operator
-                expressions: VALUE._col0 (type: string), VALUE._col1 (type: string)
+                expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string)
                 outputColumnNames: _col0, _col1
-                Statistics: Num rows: 10 Data size: 100 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                 Limit
                   Number of rows: 10
                   Statistics: Num rows: 10 Data size: 100 Basic stats: COMPLETE Column stats: NONE
@@ -319,11 +317,11 @@ STAGE PLANS:
   Stage: Stage-3
     Stats-Aggr Operator
 
-PREHOOK: query: INSERT OVERWRITE TABLE insert_into1 SELECT * FROM src LIMIT 10
+PREHOOK: query: INSERT OVERWRITE TABLE insert_into1 SELECT * FROM src ORDER BY key LIMIT 10
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
 PREHOOK: Output: default@insert_into1
-POSTHOOK: query: INSERT OVERWRITE TABLE insert_into1 SELECT * FROM src LIMIT 10
+POSTHOOK: query: INSERT OVERWRITE TABLE insert_into1 SELECT * FROM src ORDER BY key LIMIT 10
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 POSTHOOK: Output: default@insert_into1
@@ -341,7 +339,7 @@ POSTHOOK: query: SELECT SUM(HASH(c)) FROM (
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@insert_into1
 #### A masked pattern was here ####
--826625916
+-2693537120
 PREHOOK: query: explain
 SELECT COUNT(*) FROM insert_into1
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/tez/insert_into2.q.out b/ql/src/test/results/clientpositive/tez/insert_into2.q.out
index 6bfa25728d..2c7ec63247 100644
--- a/ql/src/test/results/clientpositive/tez/insert_into2.q.out
+++ b/ql/src/test/results/clientpositive/tez/insert_into2.q.out
@@ -13,10 +13,10 @@ POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@insert_into2
 PREHOOK: query: EXPLAIN INSERT INTO TABLE insert_into2 PARTITION (ds='1') 
-  SELECT * FROM src LIMIT 100
+  SELECT * FROM src order by key LIMIT 100
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN INSERT INTO TABLE insert_into2 PARTITION (ds='1') 
-  SELECT * FROM src LIMIT 100
+  SELECT * FROM src order by key LIMIT 100
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
@@ -40,19 +40,17 @@ STAGE PLANS:
                     expressions: key (type: string), value (type: string)
                     outputColumnNames: _col0, _col1
                     Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
-                    Limit
-                      Number of rows: 100
-                      Statistics: Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
-                      Reduce Output Operator
-                        sort order: 
-                        Statistics: Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
-                        value expressions: _col0 (type: string), _col1 (type: string)
+                    Reduce Output Operator
+                      key expressions: _col0 (type: string)
+                      sort order: +
+                      Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
+                      value expressions: _col1 (type: string)
         Reducer 2 
             Reduce Operator Tree:
               Select Operator
-                expressions: VALUE._col0 (type: string), VALUE._col1 (type: string)
+                expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string)
                 outputColumnNames: _col0, _col1
-                Statistics: Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                 Limit
                   Number of rows: 100
                   Statistics: Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
@@ -87,11 +85,11 @@ STAGE PLANS:
   Stage: Stage-3
     Stats-Aggr Operator
 
-PREHOOK: query: INSERT INTO TABLE insert_into2 PARTITION (ds='1') SELECT * FROM src limit 100
+PREHOOK: query: INSERT INTO TABLE insert_into2 PARTITION (ds='1') SELECT * FROM src order by key limit 100
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
 PREHOOK: Output: default@insert_into2@ds=1
-POSTHOOK: query: INSERT INTO TABLE insert_into2 PARTITION (ds='1') SELECT * FROM src limit 100
+POSTHOOK: query: INSERT INTO TABLE insert_into2 PARTITION (ds='1') SELECT * FROM src order by key limit 100
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 POSTHOOK: Output: default@insert_into2@ds=1
@@ -122,11 +120,11 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@insert_into2
 #### A masked pattern was here ####
 100
-PREHOOK: query: INSERT INTO TABLE insert_into2 PARTITION (ds='1') SELECT * FROM src limit 100
+PREHOOK: query: INSERT INTO TABLE insert_into2 PARTITION (ds='1') SELECT * FROM src order by key limit 100
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
 PREHOOK: Output: default@insert_into2@ds=1
-POSTHOOK: query: INSERT INTO TABLE insert_into2 PARTITION (ds='1') SELECT * FROM src limit 100
+POSTHOOK: query: INSERT INTO TABLE insert_into2 PARTITION (ds='1') SELECT * FROM src order by key limit 100
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 POSTHOOK: Output: default@insert_into2@ds=1
@@ -171,12 +169,12 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@insert_into2
 POSTHOOK: Input: default@insert_into2@ds=1
 #### A masked pattern was here ####
--24159954504
+-39568181484
 PREHOOK: query: EXPLAIN INSERT OVERWRITE TABLE insert_into2 PARTITION (ds='2')
-  SELECT * FROM src LIMIT 100
+  SELECT * FROM src order by key LIMIT 100
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN INSERT OVERWRITE TABLE insert_into2 PARTITION (ds='2')
-  SELECT * FROM src LIMIT 100
+  SELECT * FROM src order by key LIMIT 100
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
@@ -200,19 +198,17 @@ STAGE PLANS:
                     expressions: key (type: string), value (type: string)
                     outputColumnNames: _col0, _col1
                     Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
-                    Limit
-                      Number of rows: 100
-                      Statistics: Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
-                      Reduce Output Operator
-                        sort order: 
-                        Statistics: Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
-                        value expressions: _col0 (type: string), _col1 (type: string)
+                    Reduce Output Operator
+                      key expressions: _col0 (type: string)
+                      sort order: +
+                      Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
+                      value expressions: _col1 (type: string)
         Reducer 2 
             Reduce Operator Tree:
               Select Operator
-                expressions: VALUE._col0 (type: string), VALUE._col1 (type: string)
+                expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string)
                 outputColumnNames: _col0, _col1
-                Statistics: Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                 Limit
                   Number of rows: 100
                   Statistics: Num rows: 100 Data size: 1000 Basic stats: COMPLETE Column stats: NONE
@@ -248,12 +244,12 @@ STAGE PLANS:
     Stats-Aggr Operator
 
 PREHOOK: query: INSERT OVERWRITE TABLE insert_into2 PARTITION (ds='2')
-  SELECT * FROM src LIMIT 100
+  SELECT * FROM src order by key LIMIT 100
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
 PREHOOK: Output: default@insert_into2@ds=2
 POSTHOOK: query: INSERT OVERWRITE TABLE insert_into2 PARTITION (ds='2')
-  SELECT * FROM src LIMIT 100
+  SELECT * FROM src order by key LIMIT 100
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 POSTHOOK: Output: default@insert_into2@ds=2
@@ -275,7 +271,7 @@ POSTHOOK: Input: default@insert_into2
 POSTHOOK: Input: default@insert_into2@ds=1
 POSTHOOK: Input: default@insert_into2@ds=2
 #### A masked pattern was here ####
--36239931656
+-59352272126
 PREHOOK: query: explain
 SELECT COUNT(*) FROM insert_into2 WHERE ds='2'
 PREHOOK: type: QUERY
@@ -302,10 +298,10 @@ POSTHOOK: Input: default@insert_into2
 #### A masked pattern was here ####
 100
 PREHOOK: query: EXPLAIN INSERT OVERWRITE TABLE insert_into2 PARTITION (ds='2')
-  SELECT * FROM src LIMIT 50
+  SELECT * FROM src order by key LIMIT 50
 PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN INSERT OVERWRITE TABLE insert_into2 PARTITION (ds='2')
-  SELECT * FROM src LIMIT 50
+  SELECT * FROM src order by key LIMIT 50
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
@@ -329,19 +325,17 @@ STAGE PLANS:
                     expressions: key (type: string), value (type: string)
                     outputColumnNames: _col0, _col1
                     Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
-                    Limit
-                      Number of rows: 50
-                      Statistics: Num rows: 50 Data size: 500 Basic stats: COMPLETE Column stats: NONE
-                      Reduce Output Operator
-                        sort order: 
-                        Statistics: Num rows: 50 Data size: 500 Basic stats: COMPLETE Column stats: NONE
-                        value expressions: _col0 (type: string), _col1 (type: string)
+                    Reduce Output Operator
+                      key expressions: _col0 (type: string)
+                      sort order: +
+                      Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
+                      value expressions: _col1 (type: string)
         Reducer 2 
             Reduce Operator Tree:
               Select Operator
-                expressions: VALUE._col0 (type: string), VALUE._col1 (type: string)
+                expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string)
                 outputColumnNames: _col0, _col1
-                Statistics: Num rows: 50 Data size: 500 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                 Limit
                   Number of rows: 50
                   Statistics: Num rows: 50 Data size: 500 Basic stats: COMPLETE Column stats: NONE
@@ -377,12 +371,12 @@ STAGE PLANS:
     Stats-Aggr Operator
 
 PREHOOK: query: INSERT OVERWRITE TABLE insert_into2 PARTITION (ds='2')
-  SELECT * FROM src LIMIT 50
+  SELECT * FROM src order by key LIMIT 50
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
 PREHOOK: Output: default@insert_into2@ds=2
 POSTHOOK: query: INSERT OVERWRITE TABLE insert_into2 PARTITION (ds='2')
-  SELECT * FROM src LIMIT 50
+  SELECT * FROM src order by key LIMIT 50
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 POSTHOOK: Output: default@insert_into2@ds=2
@@ -404,7 +398,7 @@ POSTHOOK: Input: default@insert_into2
 POSTHOOK: Input: default@insert_into2@ds=1
 POSTHOOK: Input: default@insert_into2@ds=2
 #### A masked pattern was here ####
--27100860056
+-33609711132
 PREHOOK: query: explain
 SELECT COUNT(*) FROM insert_into2 WHERE ds='2'
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/tez/join_nullsafe.q.out b/ql/src/test/results/clientpositive/tez/join_nullsafe.q.out
index 6fadf5aa03..79ee3f0699 100644
--- a/ql/src/test/results/clientpositive/tez/join_nullsafe.q.out
+++ b/ql/src/test/results/clientpositive/tez/join_nullsafe.q.out
@@ -86,11 +86,13 @@ STAGE PLANS:
       Processor Tree:
         ListSink
 
-PREHOOK: query: select * from myinput1 a join myinput1 b on a.key<=>b.value
+PREHOOK: query: -- SORT_QUERY_RESULTS
+select * from myinput1 a join myinput1 b on a.key<=>b.value
 PREHOOK: type: QUERY
 PREHOOK: Input: default@myinput1
 #### A masked pattern was here ####
-POSTHOOK: query: select * from myinput1 a join myinput1 b on a.key<=>b.value
+POSTHOOK: query: -- SORT_QUERY_RESULTS
+select * from myinput1 a join myinput1 b on a.key<=>b.value
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@myinput1
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/tez/mapjoin_decimal.q.out b/ql/src/test/results/clientpositive/tez/mapjoin_decimal.q.out
index e9766db033..7ca537dc42 100644
--- a/ql/src/test/results/clientpositive/tez/mapjoin_decimal.q.out
+++ b/ql/src/test/results/clientpositive/tez/mapjoin_decimal.q.out
@@ -77,10 +77,10 @@ POSTHOOK: Input: default@over1k
 POSTHOOK: Output: default@t2
 POSTHOOK: Lineage: t2.dec EXPRESSION [(over1k)over1k.FieldSchema(name:dec, type:decimal(4,2), comment:null), ]
 PREHOOK: query: explain
-select t1.dec, t2.dec from t1 join t2 on (t1.dec=t2.dec)
+select t1.dec, t2.dec from t1 join t2 on (t1.dec=t2.dec) order by t1.dec
 PREHOOK: type: QUERY
 POSTHOOK: query: explain
-select t1.dec, t2.dec from t1 join t2 on (t1.dec=t2.dec)
+select t1.dec, t2.dec from t1 join t2 on (t1.dec=t2.dec) order by t1.dec
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
@@ -90,7 +90,8 @@ STAGE PLANS:
   Stage: Stage-1
     Tez
       Edges:
-        Map 1 <- Map 2 (BROADCAST_EDGE)
+        Map 1 <- Map 3 (BROADCAST_EDGE)
+        Reducer 2 <- Map 1 (SIMPLE_EDGE)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -109,21 +110,19 @@ STAGE PLANS:
                         1 dec (type: decimal(6,2))
                       outputColumnNames: _col0, _col4
                       input vertices:
-                        1 Map 2
+                        1 Map 3
                       Statistics: Num rows: 577 Data size: 64680 Basic stats: COMPLETE Column stats: NONE
                       HybridGraceHashJoin: true
                       Select Operator
                         expressions: _col0 (type: decimal(4,2)), _col4 (type: decimal(4,0))
                         outputColumnNames: _col0, _col1
                         Statistics: Num rows: 577 Data size: 64680 Basic stats: COMPLETE Column stats: NONE
-                        File Output Operator
-                          compressed: false
+                        Reduce Output Operator
+                          key expressions: _col0 (type: decimal(4,2))
+                          sort order: +
                           Statistics: Num rows: 577 Data size: 64680 Basic stats: COMPLETE Column stats: NONE
-                          table:
-                              input format: org.apache.hadoop.mapred.TextInputFormat
-                              output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                              serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-        Map 2 
+                          value expressions: _col1 (type: decimal(4,0))
+        Map 3 
             Map Operator Tree:
                 TableScan
                   alias: t2
@@ -137,6 +136,19 @@ STAGE PLANS:
                       Map-reduce partition columns: dec (type: decimal(6,2))
                       Statistics: Num rows: 525 Data size: 58800 Basic stats: COMPLETE Column stats: NONE
                       value expressions: dec (type: decimal(4,0))
+        Reducer 2 
+            Reduce Operator Tree:
+              Select Operator
+                expressions: KEY.reducesinkkey0 (type: decimal(4,2)), VALUE._col0 (type: decimal(4,0))
+                outputColumnNames: _col0, _col1
+                Statistics: Num rows: 577 Data size: 64680 Basic stats: COMPLETE Column stats: NONE
+                File Output Operator
+                  compressed: false
+                  Statistics: Num rows: 577 Data size: 64680 Basic stats: COMPLETE Column stats: NONE
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
 
   Stage: Stage-0
     Fetch Operator
@@ -144,12 +156,12 @@ STAGE PLANS:
       Processor Tree:
         ListSink
 
-PREHOOK: query: select t1.dec, t2.dec from t1 join t2 on (t1.dec=t2.dec)
+PREHOOK: query: select t1.dec, t2.dec from t1 join t2 on (t1.dec=t2.dec) order by t1.dec
 PREHOOK: type: QUERY
 PREHOOK: Input: default@t1
 PREHOOK: Input: default@t2
 #### A masked pattern was here ####
-POSTHOOK: query: select t1.dec, t2.dec from t1 join t2 on (t1.dec=t2.dec)
+POSTHOOK: query: select t1.dec, t2.dec from t1 join t2 on (t1.dec=t2.dec) order by t1.dec
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@t1
 POSTHOOK: Input: default@t2
@@ -260,12 +272,12 @@ POSTHOOK: Input: default@t2
 9	9
 9	9
 9	9
-PREHOOK: query: select t1.dec, t2.dec from t1 join t2 on (t1.dec=t2.dec)
+PREHOOK: query: select t1.dec, t2.dec from t1 join t2 on (t1.dec=t2.dec) order by t1.dec
 PREHOOK: type: QUERY
 PREHOOK: Input: default@t1
 PREHOOK: Input: default@t2
 #### A masked pattern was here ####
-POSTHOOK: query: select t1.dec, t2.dec from t1 join t2 on (t1.dec=t2.dec)
+POSTHOOK: query: select t1.dec, t2.dec from t1 join t2 on (t1.dec=t2.dec) order by t1.dec
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@t1
 POSTHOOK: Input: default@t2
diff --git a/ql/src/test/results/clientpositive/tez/mrr.q.out b/ql/src/test/results/clientpositive/tez/mrr.q.out
index d90b27f7ef..d42f9b06fd 100644
--- a/ql/src/test/results/clientpositive/tez/mrr.q.out
+++ b/ql/src/test/results/clientpositive/tez/mrr.q.out
@@ -1,7 +1,11 @@
 PREHOOK: query: -- simple query with multiple reduce stages
+-- SORT_QUERY_RESULTS
+
 EXPLAIN SELECT key, count(value) as cnt FROM src GROUP BY key ORDER BY cnt
 PREHOOK: type: QUERY
 POSTHOOK: query: -- simple query with multiple reduce stages
+-- SORT_QUERY_RESULTS
+
 EXPLAIN SELECT key, count(value) as cnt FROM src GROUP BY key ORDER BY cnt
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
@@ -78,337 +82,337 @@ POSTHOOK: query: SELECT key, count(value) as cnt FROM src GROUP BY key ORDER BY
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 #### A masked pattern was here ####
-490	1
-287	1
-286	1
-285	1
-284	1
-283	1
+0	3
+10	1
+100	2
+103	2
+104	2
+105	1
+11	1
+111	1
+113	2
 114	1
-487	1
-485	1
-28	1
-484	1
-181	1
-275	1
-274	1
-183	1
-483	1
-27	1
-266	1
-482	1
-263	1
-262	1
-260	1
-481	1
-258	1
-257	1
 116	1
-479	1
-252	1
-249	1
-248	1
-247	1
-244	1
-92	1
-241	1
-477	1
-475	1
-472	1
-470	1
-235	1
-47	1
-186	1
+118	2
+119	3
+12	2
+120	2
+125	2
 126	1
-228	1
-226	1
+128	3
+129	2
 131	1
-467	1
-222	1
 133	1
-82	1
-218	1
-80	1
-460	1
-214	1
-8	1
-78	1
-189	1
-457	1
-455	1
+134	2
 136	1
-202	1
-201	1
-453	1
-20	1
-2	1
-19	1
-452	1
-196	1
-449	1
-194	1
-190	1
-192	1
-448	1
-446	1
-444	1
-443	1
-44	1
-77	1
+137	2
+138	4
 143	1
-437	1
-436	1
-435	1
-432	1
 145	1
+146	2
+149	2
+15	2
 150	1
-43	1
-10	1
-427	1
-74	1
-421	1
-9	1
-419	1
-418	1
+152	2
 153	1
-105	1
-69	1
-411	1
-41	1
 155	1
-407	1
 156	1
-87	1
 157	1
-402	1
 158	1
-400	1
-4	1
-66	1
-65	1
 160	1
-64	1
-394	1
-393	1
-392	1
-389	1
-386	1
 162	1
-86	1
-379	1
-378	1
-377	1
-375	1
-374	1
-373	1
-57	1
 163	1
-368	1
-54	1
-366	1
-365	1
-364	1
-362	1
-360	1
-356	1
-53	1
-351	1
+164	2
+165	2
 166	1
+167	3
 168	1
-345	1
-85	1
-11	1
-341	1
-34	1
-339	1
-338	1
-336	1
-335	1
-111	1
-332	1
-497	1
-33	1
+169	4
 17	1
-496	1
-323	1
-495	1
-494	1
 170	1
-493	1
+172	2
+174	2
+175	2
+176	2
 177	1
-315	1
 178	1
-310	1
-96	1
-308	1
-491	1
-306	1
-305	1
-302	1
-30	1
-180	1
-296	1
-292	1
-291	1
-289	1
-98	2
-97	2
-95	2
-84	2
-83	2
-76	2
-72	2
-67	2
-58	2
-51	2
-492	2
-478	2
-463	2
-462	2
-459	2
-458	2
-439	2
-429	2
-424	2
-42	2
-414	2
-413	2
-404	2
-399	2
-397	2
-395	2
-382	2
-37	2
-367	2
-353	2
-344	2
-342	2
-333	2
-331	2
-325	2
-322	2
-321	2
-317	2
-309	2
-307	2
-288	2
-282	2
-281	2
-280	2
-278	2
-272	2
-265	2
-26	2
-256	2
-255	2
-242	2
-24	2
-239	2
-238	2
-237	2
-233	2
-229	2
-224	2
-223	2
-221	2
-219	2
-217	2
-216	2
-213	2
-209	2
-207	2
-205	2
-203	2
-200	2
-197	2
-195	2
-191	2
-18	2
 179	2
-176	2
-175	2
-174	2
-172	2
-165	2
-164	2
-152	2
-15	2
-149	2
-146	2
-137	2
-134	2
-129	2
-125	2
-120	2
-12	2
-118	2
-113	2
-104	2
-103	2
-100	2
-498	3
+18	2
+180	1
+181	1
+183	1
+186	1
+187	3
+189	1
+19	1
+190	1
+191	2
+192	1
+193	3
+194	1
+195	2
+196	1
+197	2
+199	3
+2	1
+20	1
+200	2
+201	1
+202	1
+203	2
+205	2
+207	2
+208	3
+209	2
+213	2
+214	1
+216	2
+217	2
+218	1
+219	2
+221	2
+222	1
+223	2
+224	2
+226	1
+228	1
+229	2
+230	5
+233	2
+235	1
+237	2
+238	2
+239	2
+24	2
+241	1
+242	2
+244	1
+247	1
+248	1
+249	1
+252	1
+255	2
+256	2
+257	1
+258	1
+26	2
+260	1
+262	1
+263	1
+265	2
+266	1
+27	1
+272	2
+273	3
+274	1
+275	1
+277	4
+278	2
+28	1
+280	2
+281	2
+282	2
+283	1
+284	1
+285	1
+286	1
+287	1
+288	2
+289	1
+291	1
+292	1
+296	1
+298	3
+30	1
+302	1
+305	1
+306	1
+307	2
+308	1
+309	2
+310	1
+311	3
+315	1
+316	3
+317	2
+318	3
+321	2
+322	2
+323	1
+325	2
+327	3
+33	1
+331	2
+332	1
+333	2
+335	1
+336	1
+338	1
+339	1
+34	1
+341	1
+342	2
+344	2
+345	1
+348	5
+35	3
+351	1
+353	2
+356	1
+360	1
+362	1
+364	1
+365	1
+366	1
+367	2
+368	1
 369	3
+37	2
+373	1
+374	1
+375	1
+377	1
+378	1
+379	1
+382	2
 384	3
+386	1
+389	1
+392	1
+393	1
+394	1
+395	2
 396	3
+397	2
+399	2
+4	1
+400	1
+401	5
+402	1
 403	3
+404	2
+406	4
+407	1
 409	3
+41	1
+411	1
+413	2
+414	2
 417	3
-5	3
+418	1
+419	1
+42	2
+421	1
+424	2
+427	1
+429	2
+43	1
 430	3
-70	3
-119	3
-0	3
 431	3
+432	1
+435	1
+436	1
+437	1
 438	3
-480	3
-193	3
-199	3
-208	3
-187	3
-273	3
-298	3
+439	2
+44	1
+443	1
+444	1
+446	1
+448	1
+449	1
+452	1
+453	1
 454	3
-311	3
-316	3
+455	1
+457	1
+458	2
+459	2
+460	1
+462	2
+463	2
 466	3
-90	3
-128	3
-318	3
-327	3
-167	3
-35	3
+467	1
 468	4
-489	4
-406	4
-169	4
-138	4
-277	4
 469	5
-401	5
-230	5
-348	5
-PREHOOK: query: -- join query with multiple reduce stages;
-EXPLAIN SELECT s2.key, count(distinct s2.value) as cnt FROM src s1 join src s2 on (s1.key = s2.key) GROUP BY s2.key ORDER BY cnt
-PREHOOK: type: QUERY
-POSTHOOK: query: -- join query with multiple reduce stages;
-EXPLAIN SELECT s2.key, count(distinct s2.value) as cnt FROM src s1 join src s2 on (s1.key = s2.key) GROUP BY s2.key ORDER BY cnt
-POSTHOOK: type: QUERY
-STAGE DEPENDENCIES:
-  Stage-1 is a root stage
-  Stage-0 depends on stages: Stage-1
-
-STAGE PLANS:
-  Stage: Stage-1
-    Tez
-      Edges:
-        Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 5 (SIMPLE_EDGE)
-        Reducer 3 <- Reducer 2 (SIMPLE_EDGE)
-        Reducer 4 <- Reducer 3 (SIMPLE_EDGE)
-#### A masked pattern was here ####
-      Vertices:
-        Map 1 
-            Map Operator Tree:
-                TableScan
+47	1
+470	1
+472	1
+475	1
+477	1
+478	2
+479	1
+480	3
+481	1
+482	1
+483	1
+484	1
+485	1
+487	1
+489	4
+490	1
+491	1
+492	2
+493	1
+494	1
+495	1
+496	1
+497	1
+498	3
+5	3
+51	2
+53	1
+54	1
+57	1
+58	2
+64	1
+65	1
+66	1
+67	2
+69	1
+70	3
+72	2
+74	1
+76	2
+77	1
+78	1
+8	1
+80	1
+82	1
+83	2
+84	2
+85	1
+86	1
+87	1
+9	1
+90	3
+92	1
+95	2
+96	1
+97	2
+98	2
+PREHOOK: query: -- join query with multiple reduce stages;
+EXPLAIN SELECT s2.key, count(distinct s2.value) as cnt FROM src s1 join src s2 on (s1.key = s2.key) GROUP BY s2.key ORDER BY cnt
+PREHOOK: type: QUERY
+POSTHOOK: query: -- join query with multiple reduce stages;
+EXPLAIN SELECT s2.key, count(distinct s2.value) as cnt FROM src s1 join src s2 on (s1.key = s2.key) GROUP BY s2.key ORDER BY cnt
+POSTHOOK: type: QUERY
+STAGE DEPENDENCIES:
+  Stage-1 is a root stage
+  Stage-0 depends on stages: Stage-1
+
+STAGE PLANS:
+  Stage: Stage-1
+    Tez
+      Edges:
+        Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 5 (SIMPLE_EDGE)
+        Reducer 3 <- Reducer 2 (SIMPLE_EDGE)
+        Reducer 4 <- Reducer 3 (SIMPLE_EDGE)
+#### A masked pattern was here ####
+      Vertices:
+        Map 1 
+            Map Operator Tree:
+                TableScan
                   alias: s1
                   Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                   Filter Operator
@@ -507,739 +511,739 @@ POSTHOOK: query: SELECT s2.key, count(distinct s2.value) as cnt FROM src s1 join
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 #### A masked pattern was here ####
-98	1
-97	1
-96	1
-95	1
-92	1
-90	1
-9	1
-87	1
-86	1
-85	1
-84	1
-83	1
-82	1
-80	1
-8	1
-78	1
-77	1
-76	1
-74	1
-72	1
-70	1
-69	1
-67	1
-66	1
-65	1
-64	1
-58	1
-57	1
-54	1
-53	1
-51	1
-5	1
-498	1
-497	1
-496	1
-495	1
-494	1
-493	1
-492	1
-491	1
-490	1
-489	1
-487	1
-485	1
-484	1
-483	1
-482	1
-481	1
-480	1
-479	1
-478	1
-477	1
-475	1
-472	1
-470	1
-47	1
-469	1
-468	1
-467	1
-466	1
-463	1
-462	1
-460	1
-459	1
-458	1
-457	1
-455	1
-454	1
-453	1
-452	1
-449	1
-448	1
-446	1
-444	1
-443	1
-44	1
-439	1
-438	1
-437	1
-436	1
-435	1
-432	1
-431	1
-430	1
-43	1
-429	1
-427	1
-424	1
-421	1
-42	1
-419	1
-418	1
-417	1
-414	1
-413	1
-411	1
-41	1
-409	1
-407	1
-406	1
-404	1
-403	1
-402	1
-401	1
-400	1
-4	1
-399	1
-397	1
-396	1
-395	1
-394	1
-393	1
-392	1
-389	1
-386	1
-384	1
-382	1
-379	1
-378	1
-377	1
-375	1
-374	1
-373	1
-37	1
-369	1
-368	1
-367	1
-366	1
-365	1
-364	1
-362	1
-360	1
-356	1
-353	1
-351	1
-35	1
-348	1
-345	1
-344	1
-342	1
-341	1
-34	1
-339	1
-338	1
-336	1
-335	1
-333	1
-332	1
-331	1
-33	1
-327	1
-325	1
-323	1
-322	1
-321	1
-318	1
-317	1
-316	1
-315	1
-311	1
-310	1
-309	1
-308	1
-307	1
-306	1
-305	1
-302	1
-30	1
-298	1
-296	1
-292	1
-291	1
-289	1
-288	1
-287	1
-286	1
-285	1
-284	1
-283	1
-282	1
-281	1
-280	1
-28	1
-278	1
-277	1
-275	1
-274	1
-273	1
-272	1
-27	1
-266	1
-265	1
-263	1
-262	1
-260	1
-26	1
-258	1
-257	1
-256	1
-255	1
-252	1
-249	1
-248	1
-247	1
-244	1
-242	1
-241	1
-24	1
-239	1
-238	1
-237	1
-235	1
-233	1
-230	1
-229	1
-228	1
-226	1
-224	1
-223	1
-222	1
-221	1
-219	1
-218	1
-217	1
-216	1
-214	1
-213	1
-209	1
-208	1
-207	1
-205	1
-203	1
-202	1
-201	1
-200	1
-20	1
-2	1
-199	1
-197	1
-196	1
-195	1
-194	1
-193	1
-192	1
-191	1
-190	1
-19	1
-189	1
-187	1
-186	1
-183	1
-181	1
-180	1
-18	1
-179	1
-178	1
-177	1
-176	1
-175	1
-174	1
-172	1
-170	1
-17	1
-169	1
-168	1
-167	1
-166	1
-165	1
-164	1
-163	1
-162	1
-160	1
-158	1
-157	1
-156	1
-155	1
-153	1
-152	1
-150	1
-15	1
-149	1
-146	1
-145	1
-143	1
-138	1
-137	1
-136	1
-134	1
-133	1
-131	1
-129	1
-128	1
-126	1
-125	1
-120	1
-12	1
-119	1
-118	1
-116	1
-114	1
-113	1
-111	1
-11	1
-105	1
-104	1
-103	1
-100	1
-10	1
 0	1
-PREHOOK: query: -- same query with broadcast join
-EXPLAIN SELECT s2.key, count(distinct s2.value) as cnt FROM src s1 join src s2 on (s1.key = s2.key) GROUP BY s2.key ORDER BY cnt
-PREHOOK: type: QUERY
-POSTHOOK: query: -- same query with broadcast join
-EXPLAIN SELECT s2.key, count(distinct s2.value) as cnt FROM src s1 join src s2 on (s1.key = s2.key) GROUP BY s2.key ORDER BY cnt
-POSTHOOK: type: QUERY
-STAGE DEPENDENCIES:
-  Stage-1 is a root stage
-  Stage-0 depends on stages: Stage-1
-
-STAGE PLANS:
-  Stage: Stage-1
-    Tez
-      Edges:
-        Map 1 <- Map 4 (BROADCAST_EDGE)
-        Reducer 2 <- Map 1 (SIMPLE_EDGE)
-        Reducer 3 <- Reducer 2 (SIMPLE_EDGE)
-#### A masked pattern was here ####
-      Vertices:
-        Map 1 
-            Map Operator Tree:
-                TableScan
-                  alias: s1
-                  Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
-                  Filter Operator
-                    predicate: key is not null (type: boolean)
-                    Statistics: Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
-                    Select Operator
-                      expressions: key (type: string), value (type: string)
-                      outputColumnNames: _col0, _col1
-                      Statistics: Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
-                      Map Join Operator
-                        condition map:
-                             Inner Join 0 to 1
-                        keys:
-                          0 _col0 (type: string)
-                          1 _col0 (type: string)
-                        outputColumnNames: _col0, _col1
-                        input vertices:
-                          1 Map 4
-                        Statistics: Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
-                        HybridGraceHashJoin: true
-                        Group By Operator
-                          keys: _col0 (type: string), _col1 (type: string)
-                          mode: hash
-                          outputColumnNames: _col0, _col1
-                          Statistics: Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
-                          Reduce Output Operator
-                            key expressions: _col0 (type: string), _col1 (type: string)
-                            sort order: ++
-                            Map-reduce partition columns: _col0 (type: string)
-                            Statistics: Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
-        Map 4 
-            Map Operator Tree:
-                TableScan
-                  alias: s1
-                  Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
-                  Filter Operator
-                    predicate: key is not null (type: boolean)
-                    Statistics: Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
-                    Select Operator
-                      expressions: key (type: string)
-                      outputColumnNames: _col0
-                      Statistics: Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
-                      Reduce Output Operator
-                        key expressions: _col0 (type: string)
-                        sort order: +
-                        Map-reduce partition columns: _col0 (type: string)
-                        Statistics: Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
-        Reducer 2 
-            Reduce Operator Tree:
-              Group By Operator
-                keys: KEY._col0 (type: string), KEY._col1 (type: string)
-                mode: mergepartial
-                outputColumnNames: _col0, _col1
-                Statistics: Num rows: 137 Data size: 1455 Basic stats: COMPLETE Column stats: NONE
-                Group By Operator
-                  aggregations: count(_col1)
-                  keys: _col0 (type: string)
-                  mode: complete
-                  outputColumnNames: _col0, _col1
-                  Statistics: Num rows: 68 Data size: 722 Basic stats: COMPLETE Column stats: NONE
-                  Reduce Output Operator
-                    key expressions: _col1 (type: bigint)
-                    sort order: +
-                    Statistics: Num rows: 68 Data size: 722 Basic stats: COMPLETE Column stats: NONE
-                    value expressions: _col0 (type: string)
-        Reducer 3 
-            Reduce Operator Tree:
-              Select Operator
-                expressions: VALUE._col0 (type: string), KEY.reducesinkkey0 (type: bigint)
-                outputColumnNames: _col0, _col1
-                Statistics: Num rows: 68 Data size: 722 Basic stats: COMPLETE Column stats: NONE
-                File Output Operator
-                  compressed: false
-                  Statistics: Num rows: 68 Data size: 722 Basic stats: COMPLETE Column stats: NONE
-                  table:
-                      input format: org.apache.hadoop.mapred.TextInputFormat
-                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-
-  Stage: Stage-0
-    Fetch Operator
-      limit: -1
-      Processor Tree:
-        ListSink
-
-PREHOOK: query: SELECT s2.key, count(distinct s2.value) as cnt FROM src s1 join src s2 on (s1.key = s2.key) GROUP BY s2.key ORDER BY cnt
-PREHOOK: type: QUERY
-PREHOOK: Input: default@src
-#### A masked pattern was here ####
-POSTHOOK: query: SELECT s2.key, count(distinct s2.value) as cnt FROM src s1 join src s2 on (s1.key = s2.key) GROUP BY s2.key ORDER BY cnt
-POSTHOOK: type: QUERY
-POSTHOOK: Input: default@src
-#### A masked pattern was here ####
-98	1
-97	1
-96	1
-95	1
-92	1
-90	1
-9	1
-87	1
-86	1
-85	1
-84	1
-83	1
-82	1
-80	1
-8	1
-78	1
-77	1
-76	1
-74	1
-72	1
-70	1
-69	1
-67	1
-66	1
-65	1
-64	1
-58	1
-57	1
-54	1
-53	1
-51	1
-5	1
-498	1
-497	1
-496	1
-495	1
-494	1
-493	1
-492	1
-491	1
-490	1
-489	1
-487	1
-485	1
-484	1
-483	1
-482	1
-481	1
-480	1
-479	1
-478	1
-477	1
-475	1
-472	1
-470	1
-47	1
-469	1
-468	1
-467	1
-466	1
-463	1
-462	1
-460	1
-459	1
-458	1
-457	1
-455	1
-454	1
-453	1
-452	1
-449	1
-448	1
-446	1
-444	1
-443	1
-44	1
-439	1
-438	1
-437	1
-436	1
-435	1
-432	1
-431	1
-430	1
-43	1
-429	1
-427	1
-424	1
-421	1
-42	1
-419	1
-418	1
-417	1
-414	1
-413	1
-411	1
-41	1
-409	1
-407	1
-406	1
-404	1
-403	1
-402	1
-401	1
-400	1
-4	1
-399	1
-397	1
-396	1
-395	1
-394	1
-393	1
-392	1
-389	1
-386	1
-384	1
-382	1
-379	1
-378	1
-377	1
-375	1
-374	1
-373	1
-37	1
-369	1
-368	1
-367	1
-366	1
-365	1
-364	1
-362	1
-360	1
-356	1
-353	1
-351	1
-35	1
-348	1
-345	1
-344	1
-342	1
-341	1
-34	1
-339	1
-338	1
-336	1
-335	1
-333	1
-332	1
-331	1
-33	1
-327	1
-325	1
-323	1
-322	1
-321	1
-318	1
-317	1
-316	1
-315	1
-311	1
-310	1
-309	1
-308	1
-307	1
-306	1
-305	1
-302	1
-30	1
-298	1
-296	1
-292	1
-291	1
-289	1
-288	1
-287	1
-286	1
-285	1
-284	1
-283	1
-282	1
-281	1
-280	1
-28	1
-278	1
-277	1
-275	1
-274	1
-273	1
-272	1
-27	1
-266	1
-265	1
-263	1
-262	1
-260	1
-26	1
-258	1
-257	1
-256	1
-255	1
-252	1
-249	1
-248	1
-247	1
-244	1
-242	1
-241	1
-24	1
-239	1
-238	1
-237	1
-235	1
-233	1
-230	1
-229	1
-228	1
-226	1
-224	1
-223	1
-222	1
-221	1
-219	1
-218	1
-217	1
-216	1
-214	1
-213	1
-209	1
-208	1
-207	1
-205	1
-203	1
-202	1
-201	1
-200	1
-20	1
-2	1
-199	1
-197	1
-196	1
-195	1
-194	1
-193	1
-192	1
-191	1
-190	1
-19	1
-189	1
-187	1
-186	1
-183	1
-181	1
-180	1
-18	1
-179	1
-178	1
-177	1
-176	1
-175	1
-174	1
-172	1
-170	1
-17	1
-169	1
-168	1
-167	1
-166	1
-165	1
-164	1
-163	1
-162	1
-160	1
-158	1
-157	1
-156	1
-155	1
-153	1
-152	1
-150	1
-15	1
-149	1
-146	1
-145	1
-143	1
-138	1
-137	1
-136	1
-134	1
-133	1
-131	1
-129	1
-128	1
-126	1
-125	1
-120	1
-12	1
-119	1
-118	1
-116	1
-114	1
-113	1
-111	1
-11	1
-105	1
-104	1
-103	1
-100	1
 10	1
+100	1
+103	1
+104	1
+105	1
+11	1
+111	1
+113	1
+114	1
+116	1
+118	1
+119	1
+12	1
+120	1
+125	1
+126	1
+128	1
+129	1
+131	1
+133	1
+134	1
+136	1
+137	1
+138	1
+143	1
+145	1
+146	1
+149	1
+15	1
+150	1
+152	1
+153	1
+155	1
+156	1
+157	1
+158	1
+160	1
+162	1
+163	1
+164	1
+165	1
+166	1
+167	1
+168	1
+169	1
+17	1
+170	1
+172	1
+174	1
+175	1
+176	1
+177	1
+178	1
+179	1
+18	1
+180	1
+181	1
+183	1
+186	1
+187	1
+189	1
+19	1
+190	1
+191	1
+192	1
+193	1
+194	1
+195	1
+196	1
+197	1
+199	1
+2	1
+20	1
+200	1
+201	1
+202	1
+203	1
+205	1
+207	1
+208	1
+209	1
+213	1
+214	1
+216	1
+217	1
+218	1
+219	1
+221	1
+222	1
+223	1
+224	1
+226	1
+228	1
+229	1
+230	1
+233	1
+235	1
+237	1
+238	1
+239	1
+24	1
+241	1
+242	1
+244	1
+247	1
+248	1
+249	1
+252	1
+255	1
+256	1
+257	1
+258	1
+26	1
+260	1
+262	1
+263	1
+265	1
+266	1
+27	1
+272	1
+273	1
+274	1
+275	1
+277	1
+278	1
+28	1
+280	1
+281	1
+282	1
+283	1
+284	1
+285	1
+286	1
+287	1
+288	1
+289	1
+291	1
+292	1
+296	1
+298	1
+30	1
+302	1
+305	1
+306	1
+307	1
+308	1
+309	1
+310	1
+311	1
+315	1
+316	1
+317	1
+318	1
+321	1
+322	1
+323	1
+325	1
+327	1
+33	1
+331	1
+332	1
+333	1
+335	1
+336	1
+338	1
+339	1
+34	1
+341	1
+342	1
+344	1
+345	1
+348	1
+35	1
+351	1
+353	1
+356	1
+360	1
+362	1
+364	1
+365	1
+366	1
+367	1
+368	1
+369	1
+37	1
+373	1
+374	1
+375	1
+377	1
+378	1
+379	1
+382	1
+384	1
+386	1
+389	1
+392	1
+393	1
+394	1
+395	1
+396	1
+397	1
+399	1
+4	1
+400	1
+401	1
+402	1
+403	1
+404	1
+406	1
+407	1
+409	1
+41	1
+411	1
+413	1
+414	1
+417	1
+418	1
+419	1
+42	1
+421	1
+424	1
+427	1
+429	1
+43	1
+430	1
+431	1
+432	1
+435	1
+436	1
+437	1
+438	1
+439	1
+44	1
+443	1
+444	1
+446	1
+448	1
+449	1
+452	1
+453	1
+454	1
+455	1
+457	1
+458	1
+459	1
+460	1
+462	1
+463	1
+466	1
+467	1
+468	1
+469	1
+47	1
+470	1
+472	1
+475	1
+477	1
+478	1
+479	1
+480	1
+481	1
+482	1
+483	1
+484	1
+485	1
+487	1
+489	1
+490	1
+491	1
+492	1
+493	1
+494	1
+495	1
+496	1
+497	1
+498	1
+5	1
+51	1
+53	1
+54	1
+57	1
+58	1
+64	1
+65	1
+66	1
+67	1
+69	1
+70	1
+72	1
+74	1
+76	1
+77	1
+78	1
+8	1
+80	1
+82	1
+83	1
+84	1
+85	1
+86	1
+87	1
+9	1
+90	1
+92	1
+95	1
+96	1
+97	1
+98	1
+PREHOOK: query: -- same query with broadcast join
+EXPLAIN SELECT s2.key, count(distinct s2.value) as cnt FROM src s1 join src s2 on (s1.key = s2.key) GROUP BY s2.key ORDER BY cnt
+PREHOOK: type: QUERY
+POSTHOOK: query: -- same query with broadcast join
+EXPLAIN SELECT s2.key, count(distinct s2.value) as cnt FROM src s1 join src s2 on (s1.key = s2.key) GROUP BY s2.key ORDER BY cnt
+POSTHOOK: type: QUERY
+STAGE DEPENDENCIES:
+  Stage-1 is a root stage
+  Stage-0 depends on stages: Stage-1
+
+STAGE PLANS:
+  Stage: Stage-1
+    Tez
+      Edges:
+        Map 1 <- Map 4 (BROADCAST_EDGE)
+        Reducer 2 <- Map 1 (SIMPLE_EDGE)
+        Reducer 3 <- Reducer 2 (SIMPLE_EDGE)
+#### A masked pattern was here ####
+      Vertices:
+        Map 1 
+            Map Operator Tree:
+                TableScan
+                  alias: s1
+                  Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
+                  Filter Operator
+                    predicate: key is not null (type: boolean)
+                    Statistics: Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
+                    Select Operator
+                      expressions: key (type: string), value (type: string)
+                      outputColumnNames: _col0, _col1
+                      Statistics: Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
+                      Map Join Operator
+                        condition map:
+                             Inner Join 0 to 1
+                        keys:
+                          0 _col0 (type: string)
+                          1 _col0 (type: string)
+                        outputColumnNames: _col0, _col1
+                        input vertices:
+                          1 Map 4
+                        Statistics: Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
+                        HybridGraceHashJoin: true
+                        Group By Operator
+                          keys: _col0 (type: string), _col1 (type: string)
+                          mode: hash
+                          outputColumnNames: _col0, _col1
+                          Statistics: Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
+                          Reduce Output Operator
+                            key expressions: _col0 (type: string), _col1 (type: string)
+                            sort order: ++
+                            Map-reduce partition columns: _col0 (type: string)
+                            Statistics: Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
+        Map 4 
+            Map Operator Tree:
+                TableScan
+                  alias: s1
+                  Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
+                  Filter Operator
+                    predicate: key is not null (type: boolean)
+                    Statistics: Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
+                    Select Operator
+                      expressions: key (type: string)
+                      outputColumnNames: _col0
+                      Statistics: Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
+                      Reduce Output Operator
+                        key expressions: _col0 (type: string)
+                        sort order: +
+                        Map-reduce partition columns: _col0 (type: string)
+                        Statistics: Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
+        Reducer 2 
+            Reduce Operator Tree:
+              Group By Operator
+                keys: KEY._col0 (type: string), KEY._col1 (type: string)
+                mode: mergepartial
+                outputColumnNames: _col0, _col1
+                Statistics: Num rows: 137 Data size: 1455 Basic stats: COMPLETE Column stats: NONE
+                Group By Operator
+                  aggregations: count(_col1)
+                  keys: _col0 (type: string)
+                  mode: complete
+                  outputColumnNames: _col0, _col1
+                  Statistics: Num rows: 68 Data size: 722 Basic stats: COMPLETE Column stats: NONE
+                  Reduce Output Operator
+                    key expressions: _col1 (type: bigint)
+                    sort order: +
+                    Statistics: Num rows: 68 Data size: 722 Basic stats: COMPLETE Column stats: NONE
+                    value expressions: _col0 (type: string)
+        Reducer 3 
+            Reduce Operator Tree:
+              Select Operator
+                expressions: VALUE._col0 (type: string), KEY.reducesinkkey0 (type: bigint)
+                outputColumnNames: _col0, _col1
+                Statistics: Num rows: 68 Data size: 722 Basic stats: COMPLETE Column stats: NONE
+                File Output Operator
+                  compressed: false
+                  Statistics: Num rows: 68 Data size: 722 Basic stats: COMPLETE Column stats: NONE
+                  table:
+                      input format: org.apache.hadoop.mapred.TextInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+
+  Stage: Stage-0
+    Fetch Operator
+      limit: -1
+      Processor Tree:
+        ListSink
+
+PREHOOK: query: SELECT s2.key, count(distinct s2.value) as cnt FROM src s1 join src s2 on (s1.key = s2.key) GROUP BY s2.key ORDER BY cnt
+PREHOOK: type: QUERY
+PREHOOK: Input: default@src
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT s2.key, count(distinct s2.value) as cnt FROM src s1 join src s2 on (s1.key = s2.key) GROUP BY s2.key ORDER BY cnt
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@src
+#### A masked pattern was here ####
 0	1
+10	1
+100	1
+103	1
+104	1
+105	1
+11	1
+111	1
+113	1
+114	1
+116	1
+118	1
+119	1
+12	1
+120	1
+125	1
+126	1
+128	1
+129	1
+131	1
+133	1
+134	1
+136	1
+137	1
+138	1
+143	1
+145	1
+146	1
+149	1
+15	1
+150	1
+152	1
+153	1
+155	1
+156	1
+157	1
+158	1
+160	1
+162	1
+163	1
+164	1
+165	1
+166	1
+167	1
+168	1
+169	1
+17	1
+170	1
+172	1
+174	1
+175	1
+176	1
+177	1
+178	1
+179	1
+18	1
+180	1
+181	1
+183	1
+186	1
+187	1
+189	1
+19	1
+190	1
+191	1
+192	1
+193	1
+194	1
+195	1
+196	1
+197	1
+199	1
+2	1
+20	1
+200	1
+201	1
+202	1
+203	1
+205	1
+207	1
+208	1
+209	1
+213	1
+214	1
+216	1
+217	1
+218	1
+219	1
+221	1
+222	1
+223	1
+224	1
+226	1
+228	1
+229	1
+230	1
+233	1
+235	1
+237	1
+238	1
+239	1
+24	1
+241	1
+242	1
+244	1
+247	1
+248	1
+249	1
+252	1
+255	1
+256	1
+257	1
+258	1
+26	1
+260	1
+262	1
+263	1
+265	1
+266	1
+27	1
+272	1
+273	1
+274	1
+275	1
+277	1
+278	1
+28	1
+280	1
+281	1
+282	1
+283	1
+284	1
+285	1
+286	1
+287	1
+288	1
+289	1
+291	1
+292	1
+296	1
+298	1
+30	1
+302	1
+305	1
+306	1
+307	1
+308	1
+309	1
+310	1
+311	1
+315	1
+316	1
+317	1
+318	1
+321	1
+322	1
+323	1
+325	1
+327	1
+33	1
+331	1
+332	1
+333	1
+335	1
+336	1
+338	1
+339	1
+34	1
+341	1
+342	1
+344	1
+345	1
+348	1
+35	1
+351	1
+353	1
+356	1
+360	1
+362	1
+364	1
+365	1
+366	1
+367	1
+368	1
+369	1
+37	1
+373	1
+374	1
+375	1
+377	1
+378	1
+379	1
+382	1
+384	1
+386	1
+389	1
+392	1
+393	1
+394	1
+395	1
+396	1
+397	1
+399	1
+4	1
+400	1
+401	1
+402	1
+403	1
+404	1
+406	1
+407	1
+409	1
+41	1
+411	1
+413	1
+414	1
+417	1
+418	1
+419	1
+42	1
+421	1
+424	1
+427	1
+429	1
+43	1
+430	1
+431	1
+432	1
+435	1
+436	1
+437	1
+438	1
+439	1
+44	1
+443	1
+444	1
+446	1
+448	1
+449	1
+452	1
+453	1
+454	1
+455	1
+457	1
+458	1
+459	1
+460	1
+462	1
+463	1
+466	1
+467	1
+468	1
+469	1
+47	1
+470	1
+472	1
+475	1
+477	1
+478	1
+479	1
+480	1
+481	1
+482	1
+483	1
+484	1
+485	1
+487	1
+489	1
+490	1
+491	1
+492	1
+493	1
+494	1
+495	1
+496	1
+497	1
+498	1
+5	1
+51	1
+53	1
+54	1
+57	1
+58	1
+64	1
+65	1
+66	1
+67	1
+69	1
+70	1
+72	1
+74	1
+76	1
+77	1
+78	1
+8	1
+80	1
+82	1
+83	1
+84	1
+85	1
+86	1
+87	1
+9	1
+90	1
+92	1
+95	1
+96	1
+97	1
+98	1
 PREHOOK: query: -- query with multiple branches in the task dag
 EXPLAIN
 SELECT * 
diff --git a/ql/src/test/results/clientpositive/tez/orc_merge1.q.out b/ql/src/test/results/clientpositive/tez/orc_merge1.q.out
index 3fffb4ef86..77ea36a775 100644
--- a/ql/src/test/results/clientpositive/tez/orc_merge1.q.out
+++ b/ql/src/test/results/clientpositive/tez/orc_merge1.q.out
@@ -1,6 +1,10 @@
-PREHOOK: query: DROP TABLE orcfile_merge1
+PREHOOK: query: -- SORT_QUERY_RESULTS
+
+DROP TABLE orcfile_merge1
 PREHOOK: type: DROPTABLE
-POSTHOOK: query: DROP TABLE orcfile_merge1
+POSTHOOK: query: -- SORT_QUERY_RESULTS
+
+DROP TABLE orcfile_merge1
 POSTHOOK: type: DROPTABLE
 PREHOOK: query: DROP TABLE orcfile_merge1b
 PREHOOK: type: DROPTABLE
diff --git a/ql/src/test/results/clientpositive/tez/script_env_var1.q.out b/ql/src/test/results/clientpositive/tez/script_env_var1.q.out
index 5ab1c20c9c..cd39eb893d 100644
--- a/ql/src/test/results/clientpositive/tez/script_env_var1.q.out
+++ b/ql/src/test/results/clientpositive/tez/script_env_var1.q.out
@@ -1,16 +1,16 @@
 PREHOOK: query: -- Verifies that script operator ID environment variables have unique values
 -- in each instance of the script operator.
 SELECT count(1) FROM
-( SELECT * FROM (SELECT TRANSFORM('echo $HIVE_SCRIPT_OPERATOR_ID') USING 'sh' AS key FROM src LIMIT 1)x UNION ALL
-  SELECT * FROM (SELECT TRANSFORM('echo $HIVE_SCRIPT_OPERATOR_ID') USING 'sh' AS key FROM src LIMIT 1)y ) a GROUP BY key
+( SELECT * FROM (SELECT TRANSFORM('echo $HIVE_SCRIPT_OPERATOR_ID') USING 'sh' AS key FROM src order by key LIMIT 1)x UNION ALL
+  SELECT * FROM (SELECT TRANSFORM('echo $HIVE_SCRIPT_OPERATOR_ID') USING 'sh' AS key FROM src order by key LIMIT 1)y ) a GROUP BY key
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
 #### A masked pattern was here ####
 POSTHOOK: query: -- Verifies that script operator ID environment variables have unique values
 -- in each instance of the script operator.
 SELECT count(1) FROM
-( SELECT * FROM (SELECT TRANSFORM('echo $HIVE_SCRIPT_OPERATOR_ID') USING 'sh' AS key FROM src LIMIT 1)x UNION ALL
-  SELECT * FROM (SELECT TRANSFORM('echo $HIVE_SCRIPT_OPERATOR_ID') USING 'sh' AS key FROM src LIMIT 1)y ) a GROUP BY key
+( SELECT * FROM (SELECT TRANSFORM('echo $HIVE_SCRIPT_OPERATOR_ID') USING 'sh' AS key FROM src order by key LIMIT 1)x UNION ALL
+  SELECT * FROM (SELECT TRANSFORM('echo $HIVE_SCRIPT_OPERATOR_ID') USING 'sh' AS key FROM src order by key LIMIT 1)y ) a GROUP BY key
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/tez/selectDistinctStar.q.out b/ql/src/test/results/clientpositive/tez/selectDistinctStar.q.out
index 2bccb8fe86..59c8f2a0b0 100644
--- a/ql/src/test/results/clientpositive/tez/selectDistinctStar.q.out
+++ b/ql/src/test/results/clientpositive/tez/selectDistinctStar.q.out
@@ -1,6 +1,10 @@
-PREHOOK: query: explain select distinct src.* from src
+PREHOOK: query: -- SORT_QUERY_RESULTS
+
+explain select distinct src.* from src
 PREHOOK: type: QUERY
-POSTHOOK: query: explain select distinct src.* from src
+POSTHOOK: query: -- SORT_QUERY_RESULTS
+
+explain select distinct src.* from src
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
@@ -1419,6 +1423,13 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 POSTHOOK: Input: default@src1
 #### A masked pattern was here ####
+	
+	val_165
+	val_193
+	val_265
+	val_27
+	val_409
+	val_484
 0	val_0
 10	val_10
 100	val_100
@@ -1436,6 +1447,7 @@ POSTHOOK: Input: default@src1
 120	val_120
 125	val_125
 126	val_126
+128	
 128	val_128
 129	val_129
 131	val_131
@@ -1447,9 +1459,11 @@ POSTHOOK: Input: default@src1
 143	val_143
 145	val_145
 146	val_146
+146	val_146
 149	val_149
 15	val_15
 150	val_150
+150	val_150
 152	val_152
 153	val_153
 155	val_155
@@ -1502,6 +1516,7 @@ POSTHOOK: Input: default@src1
 208	val_208
 209	val_209
 213	val_213
+213	val_213
 214	val_214
 216	val_216
 217	val_217
@@ -1510,6 +1525,7 @@ POSTHOOK: Input: default@src1
 221	val_221
 222	val_222
 223	val_223
+224	
 224	val_224
 226	val_226
 228	val_228
@@ -1519,6 +1535,7 @@ POSTHOOK: Input: default@src1
 235	val_235
 237	val_237
 238	val_238
+238	val_238
 239	val_239
 24	val_24
 241	val_241
@@ -1529,6 +1546,7 @@ POSTHOOK: Input: default@src1
 249	val_249
 252	val_252
 255	val_255
+255	val_255
 256	val_256
 257	val_257
 258	val_258
@@ -1541,10 +1559,12 @@ POSTHOOK: Input: default@src1
 27	val_27
 272	val_272
 273	val_273
+273	val_273
 274	val_274
 275	val_275
 277	val_277
 278	val_278
+278	val_278
 28	val_28
 280	val_280
 281	val_281
@@ -1569,6 +1589,7 @@ POSTHOOK: Input: default@src1
 309	val_309
 310	val_310
 311	val_311
+311	val_311
 315	val_315
 316	val_316
 317	val_317
@@ -1603,6 +1624,7 @@ POSTHOOK: Input: default@src1
 366	val_366
 367	val_367
 368	val_368
+369	
 369	val_369
 37	val_37
 373	val_373
@@ -1625,10 +1647,12 @@ POSTHOOK: Input: default@src1
 4	val_4
 400	val_400
 401	val_401
+401	val_401
 402	val_402
 403	val_403
 404	val_404
 406	val_406
+406	val_406
 407	val_407
 409	val_409
 41	val_41
@@ -1705,6 +1729,7 @@ POSTHOOK: Input: default@src1
 64	val_64
 65	val_65
 66	val_66
+66	val_66
 67	val_67
 69	val_69
 70	val_70
@@ -1728,27 +1753,6 @@ POSTHOOK: Input: default@src1
 96	val_96
 97	val_97
 98	val_98
-	
-	val_165
-	val_193
-	val_265
-	val_27
-	val_409
-	val_484
-128	
-146	val_146
-150	val_150
-213	val_213
-224	
-238	val_238
-255	val_255
-273	val_273
-278	val_278
-311	val_311
-369	
-401	val_401
-406	val_406
-66	val_66
 98	val_98
 PREHOOK: query: select distinct * from src join src1 on src.key=src1.key
 PREHOOK: type: QUERY
@@ -3870,6 +3874,13 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 POSTHOOK: Input: default@src1
 #### A masked pattern was here ####
+	
+	val_165
+	val_193
+	val_265
+	val_27
+	val_409
+	val_484
 0	val_0
 10	val_10
 100	val_100
@@ -3887,6 +3898,7 @@ POSTHOOK: Input: default@src1
 120	val_120
 125	val_125
 126	val_126
+128	
 128	val_128
 129	val_129
 131	val_131
@@ -3898,9 +3910,11 @@ POSTHOOK: Input: default@src1
 143	val_143
 145	val_145
 146	val_146
+146	val_146
 149	val_149
 15	val_15
 150	val_150
+150	val_150
 152	val_152
 153	val_153
 155	val_155
@@ -3953,6 +3967,7 @@ POSTHOOK: Input: default@src1
 208	val_208
 209	val_209
 213	val_213
+213	val_213
 214	val_214
 216	val_216
 217	val_217
@@ -3961,6 +3976,7 @@ POSTHOOK: Input: default@src1
 221	val_221
 222	val_222
 223	val_223
+224	
 224	val_224
 226	val_226
 228	val_228
@@ -3970,6 +3986,7 @@ POSTHOOK: Input: default@src1
 235	val_235
 237	val_237
 238	val_238
+238	val_238
 239	val_239
 24	val_24
 241	val_241
@@ -3980,6 +3997,7 @@ POSTHOOK: Input: default@src1
 249	val_249
 252	val_252
 255	val_255
+255	val_255
 256	val_256
 257	val_257
 258	val_258
@@ -3992,10 +4010,12 @@ POSTHOOK: Input: default@src1
 27	val_27
 272	val_272
 273	val_273
+273	val_273
 274	val_274
 275	val_275
 277	val_277
 278	val_278
+278	val_278
 28	val_28
 280	val_280
 281	val_281
@@ -4020,6 +4040,7 @@ POSTHOOK: Input: default@src1
 309	val_309
 310	val_310
 311	val_311
+311	val_311
 315	val_315
 316	val_316
 317	val_317
@@ -4054,6 +4075,7 @@ POSTHOOK: Input: default@src1
 366	val_366
 367	val_367
 368	val_368
+369	
 369	val_369
 37	val_37
 373	val_373
@@ -4076,10 +4098,12 @@ POSTHOOK: Input: default@src1
 4	val_4
 400	val_400
 401	val_401
+401	val_401
 402	val_402
 403	val_403
 404	val_404
 406	val_406
+406	val_406
 407	val_407
 409	val_409
 41	val_41
@@ -4156,6 +4180,7 @@ POSTHOOK: Input: default@src1
 64	val_64
 65	val_65
 66	val_66
+66	val_66
 67	val_67
 69	val_69
 70	val_70
@@ -4179,27 +4204,6 @@ POSTHOOK: Input: default@src1
 96	val_96
 97	val_97
 98	val_98
-	
-	val_165
-	val_193
-	val_265
-	val_27
-	val_409
-	val_484
-128	
-146	val_146
-150	val_150
-213	val_213
-224	
-238	val_238
-255	val_255
-273	val_273
-278	val_278
-311	val_311
-369	
-401	val_401
-406	val_406
-66	val_66
 98	val_98
 PREHOOK: query: select distinct * from src join src1 on src.key=src1.key
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/tez/skewjoin.q.out b/ql/src/test/results/clientpositive/tez/skewjoin.q.out
index 7923d15b56..ec368f99c1 100644
--- a/ql/src/test/results/clientpositive/tez/skewjoin.q.out
+++ b/ql/src/test/results/clientpositive/tez/skewjoin.q.out
@@ -1,8 +1,12 @@
-PREHOOK: query: CREATE TABLE T1(key STRING, val STRING) STORED AS TEXTFILE
+PREHOOK: query: -- SORT_QUERY_RESULTS
+
+CREATE TABLE T1(key STRING, val STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@T1
-POSTHOOK: query: CREATE TABLE T1(key STRING, val STRING) STORED AS TEXTFILE
+POSTHOOK: query: -- SORT_QUERY_RESULTS
+
+CREATE TABLE T1(key STRING, val STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@T1
diff --git a/ql/src/test/results/clientpositive/tez/subquery_exists.q.out b/ql/src/test/results/clientpositive/tez/subquery_exists.q.out
index f4e8df1776..503a5e943d 100644
--- a/ql/src/test/results/clientpositive/tez/subquery_exists.q.out
+++ b/ql/src/test/results/clientpositive/tez/subquery_exists.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: -- SORT_QUERY_RESULTS
 
 -- no agg, corr
+-- SORT_QUERY_RESULTS
 explain
 select * 
 from src b 
@@ -13,6 +14,7 @@ PREHOOK: type: QUERY
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 -- no agg, corr
+-- SORT_QUERY_RESULTS
 explain
 select * 
 from src b 
diff --git a/ql/src/test/results/clientpositive/tez/temp_table.q.out b/ql/src/test/results/clientpositive/tez/temp_table.q.out
index 1055a2255a..89c178455d 100644
--- a/ql/src/test/results/clientpositive/tez/temp_table.q.out
+++ b/ql/src/test/results/clientpositive/tez/temp_table.q.out
@@ -154,45 +154,76 @@ POSTHOOK: type: DESCTABLE
 POSTHOOK: Input: default@bar
 key                 	string              	                    
 value               	string              	                    
-PREHOOK: query: explain select * from foo limit 10
+PREHOOK: query: explain select * from foo order by key limit 10
 PREHOOK: type: QUERY
-POSTHOOK: query: explain select * from foo limit 10
+POSTHOOK: query: explain select * from foo order by key limit 10
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
-  Stage-0 is a root stage
+  Stage-1 is a root stage
+  Stage-0 depends on stages: Stage-1
 
 STAGE PLANS:
+  Stage: Stage-1
+    Tez
+      Edges:
+        Reducer 2 <- Map 1 (SIMPLE_EDGE)
+#### A masked pattern was here ####
+      Vertices:
+        Map 1 
+            Map Operator Tree:
+                TableScan
+                  alias: foo
+                  Statistics: Num rows: 247 Data size: 2609 Basic stats: COMPLETE Column stats: NONE
+                  Select Operator
+                    expressions: key (type: string), value (type: string)
+                    outputColumnNames: _col0, _col1
+                    Statistics: Num rows: 247 Data size: 2609 Basic stats: COMPLETE Column stats: NONE
+                    Reduce Output Operator
+                      key expressions: _col0 (type: string)
+                      sort order: +
+                      Statistics: Num rows: 247 Data size: 2609 Basic stats: COMPLETE Column stats: NONE
+                      value expressions: _col1 (type: string)
+        Reducer 2 
+            Reduce Operator Tree:
+              Select Operator
+                expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string)
+                outputColumnNames: _col0, _col1
+                Statistics: Num rows: 247 Data size: 2609 Basic stats: COMPLETE Column stats: NONE
+                Limit
+                  Number of rows: 10
+                  Statistics: Num rows: 10 Data size: 100 Basic stats: COMPLETE Column stats: NONE
+                  File Output Operator
+                    compressed: false
+                    Statistics: Num rows: 10 Data size: 100 Basic stats: COMPLETE Column stats: NONE
+                    table:
+                        input format: org.apache.hadoop.mapred.TextInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+
   Stage: Stage-0
     Fetch Operator
       limit: 10
       Processor Tree:
-        TableScan
-          alias: foo
-          Select Operator
-            expressions: key (type: string), value (type: string)
-            outputColumnNames: _col0, _col1
-            Limit
-              Number of rows: 10
-              ListSink
+        ListSink
 
-PREHOOK: query: select * from foo limit 10
+PREHOOK: query: select * from foo order by key limit 10
 PREHOOK: type: QUERY
 PREHOOK: Input: default@foo
 #### A masked pattern was here ####
-POSTHOOK: query: select * from foo limit 10
+POSTHOOK: query: select * from foo order by key limit 10
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@foo
 #### A masked pattern was here ####
-238	val_238
-86	val_86
-278	val_278
-98	val_98
-484	val_484
-150	val_150
-224	val_224
-66	val_66
-128	val_128
-146	val_146
+0	val_0
+0	val_0
+0	val_0
+10	val_10
+100	val_100
+100	val_100
+104	val_104
+104	val_104
+114	val_114
+116	val_116
 PREHOOK: query: explain select * from (select * from foo union all select * from bar) u order by key limit 10
 PREHOOK: type: QUERY
 POSTHOOK: query: explain select * from (select * from foo union all select * from bar) u order by key limit 10
@@ -327,11 +358,11 @@ POSTHOOK: Input: default@src
 POSTHOOK: Output: default@bay
 POSTHOOK: Lineage: bay.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: bay.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
-PREHOOK: query: select * from bay limit 10
+PREHOOK: query: select * from bay order by key limit 10
 PREHOOK: type: QUERY
 PREHOOK: Input: default@bay
 #### A masked pattern was here ####
-POSTHOOK: query: select * from bay limit 10
+POSTHOOK: query: select * from bay order by key limit 10
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@bay
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/tez/tez_dml.q.out b/ql/src/test/results/clientpositive/tez/tez_dml.q.out
index 4fe91f5c47..ae85292c6d 100644
--- a/ql/src/test/results/clientpositive/tez/tez_dml.q.out
+++ b/ql/src/test/results/clientpositive/tez/tez_dml.q.out
@@ -1,7 +1,11 @@
 PREHOOK: query: -- CTAS
+-- SORT_QUERY_RESULTS
+
 EXPLAIN CREATE TABLE tmp_src AS SELECT * FROM (SELECT value, count(value) AS cnt FROM src GROUP BY value) f1 ORDER BY cnt
 PREHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: query: -- CTAS
+-- SORT_QUERY_RESULTS
+
 EXPLAIN CREATE TABLE tmp_src AS SELECT * FROM (SELECT value, count(value) AS cnt FROM src GROUP BY value) f1 ORDER BY cnt
 POSTHOOK: type: CREATETABLE_AS_SELECT
 STAGE DEPENDENCIES:
@@ -107,337 +111,337 @@ POSTHOOK: query: SELECT * FROM tmp_src
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@tmp_src
 #### A masked pattern was here ####
-val_490	1
-val_287	1
-val_286	1
-val_285	1
-val_284	1
-val_283	1
+val_0	3
+val_10	1
+val_100	2
+val_103	2
+val_104	2
+val_105	1
+val_11	1
+val_111	1
+val_113	2
 val_114	1
-val_487	1
-val_485	1
-val_28	1
-val_484	1
-val_181	1
-val_275	1
-val_274	1
-val_183	1
-val_483	1
-val_27	1
-val_266	1
-val_482	1
-val_263	1
-val_262	1
-val_260	1
-val_481	1
-val_258	1
-val_257	1
 val_116	1
-val_479	1
-val_252	1
-val_249	1
-val_248	1
-val_247	1
-val_244	1
-val_92	1
-val_241	1
-val_477	1
-val_475	1
-val_472	1
-val_470	1
-val_235	1
-val_47	1
-val_186	1
+val_118	2
+val_119	3
+val_12	2
+val_120	2
+val_125	2
 val_126	1
-val_228	1
-val_226	1
+val_128	3
+val_129	2
 val_131	1
-val_467	1
-val_222	1
 val_133	1
-val_82	1
-val_218	1
-val_80	1
-val_460	1
-val_214	1
-val_8	1
-val_78	1
-val_189	1
-val_457	1
-val_455	1
+val_134	2
 val_136	1
-val_202	1
-val_201	1
-val_453	1
-val_20	1
-val_2	1
-val_19	1
-val_452	1
-val_196	1
-val_449	1
-val_194	1
-val_190	1
-val_192	1
-val_448	1
-val_446	1
-val_444	1
-val_443	1
-val_44	1
-val_77	1
+val_137	2
+val_138	4
 val_143	1
-val_437	1
-val_436	1
-val_435	1
-val_432	1
 val_145	1
+val_146	2
+val_149	2
+val_15	2
 val_150	1
-val_43	1
-val_10	1
-val_427	1
-val_74	1
-val_421	1
-val_9	1
-val_419	1
-val_418	1
+val_152	2
 val_153	1
-val_105	1
-val_69	1
-val_411	1
-val_41	1
 val_155	1
-val_407	1
 val_156	1
-val_87	1
 val_157	1
-val_402	1
 val_158	1
-val_400	1
-val_4	1
-val_66	1
-val_65	1
 val_160	1
-val_64	1
-val_394	1
-val_393	1
-val_392	1
-val_389	1
-val_386	1
 val_162	1
-val_86	1
-val_379	1
-val_378	1
-val_377	1
-val_375	1
-val_374	1
-val_373	1
-val_57	1
 val_163	1
-val_368	1
-val_54	1
-val_366	1
-val_365	1
-val_364	1
-val_362	1
-val_360	1
-val_356	1
-val_53	1
-val_351	1
+val_164	2
+val_165	2
 val_166	1
+val_167	3
 val_168	1
-val_345	1
-val_85	1
-val_11	1
-val_341	1
-val_34	1
-val_339	1
-val_338	1
-val_336	1
-val_335	1
-val_111	1
-val_332	1
-val_497	1
-val_33	1
+val_169	4
 val_17	1
-val_496	1
-val_323	1
-val_495	1
-val_494	1
 val_170	1
-val_493	1
+val_172	2
+val_174	2
+val_175	2
+val_176	2
 val_177	1
-val_315	1
 val_178	1
-val_310	1
-val_96	1
-val_308	1
-val_491	1
-val_306	1
-val_305	1
-val_302	1
-val_30	1
-val_180	1
-val_296	1
-val_292	1
-val_291	1
-val_289	1
-val_98	2
-val_97	2
-val_95	2
-val_84	2
-val_83	2
-val_76	2
-val_72	2
-val_67	2
-val_58	2
-val_51	2
-val_492	2
-val_478	2
-val_463	2
-val_462	2
-val_459	2
-val_458	2
-val_439	2
-val_429	2
-val_424	2
-val_42	2
-val_414	2
-val_413	2
-val_404	2
-val_399	2
-val_397	2
-val_395	2
-val_382	2
-val_37	2
-val_367	2
-val_353	2
-val_344	2
-val_342	2
-val_333	2
-val_331	2
-val_325	2
-val_322	2
-val_321	2
-val_317	2
-val_309	2
-val_307	2
-val_288	2
-val_282	2
-val_281	2
-val_280	2
-val_278	2
-val_272	2
-val_265	2
-val_26	2
-val_256	2
-val_255	2
-val_242	2
-val_24	2
-val_239	2
-val_238	2
-val_237	2
-val_233	2
-val_229	2
-val_224	2
-val_223	2
-val_221	2
-val_219	2
-val_217	2
-val_216	2
-val_213	2
-val_209	2
-val_207	2
-val_205	2
-val_203	2
-val_200	2
-val_197	2
-val_195	2
-val_191	2
-val_18	2
 val_179	2
-val_176	2
-val_175	2
-val_174	2
-val_172	2
-val_165	2
-val_164	2
-val_152	2
-val_15	2
-val_149	2
-val_146	2
-val_137	2
-val_134	2
-val_129	2
-val_125	2
-val_120	2
-val_12	2
-val_118	2
-val_113	2
-val_104	2
-val_103	2
-val_100	2
-val_498	3
+val_18	2
+val_180	1
+val_181	1
+val_183	1
+val_186	1
+val_187	3
+val_189	1
+val_19	1
+val_190	1
+val_191	2
+val_192	1
+val_193	3
+val_194	1
+val_195	2
+val_196	1
+val_197	2
+val_199	3
+val_2	1
+val_20	1
+val_200	2
+val_201	1
+val_202	1
+val_203	2
+val_205	2
+val_207	2
+val_208	3
+val_209	2
+val_213	2
+val_214	1
+val_216	2
+val_217	2
+val_218	1
+val_219	2
+val_221	2
+val_222	1
+val_223	2
+val_224	2
+val_226	1
+val_228	1
+val_229	2
+val_230	5
+val_233	2
+val_235	1
+val_237	2
+val_238	2
+val_239	2
+val_24	2
+val_241	1
+val_242	2
+val_244	1
+val_247	1
+val_248	1
+val_249	1
+val_252	1
+val_255	2
+val_256	2
+val_257	1
+val_258	1
+val_26	2
+val_260	1
+val_262	1
+val_263	1
+val_265	2
+val_266	1
+val_27	1
+val_272	2
+val_273	3
+val_274	1
+val_275	1
+val_277	4
+val_278	2
+val_28	1
+val_280	2
+val_281	2
+val_282	2
+val_283	1
+val_284	1
+val_285	1
+val_286	1
+val_287	1
+val_288	2
+val_289	1
+val_291	1
+val_292	1
+val_296	1
+val_298	3
+val_30	1
+val_302	1
+val_305	1
+val_306	1
+val_307	2
+val_308	1
+val_309	2
+val_310	1
+val_311	3
+val_315	1
+val_316	3
+val_317	2
+val_318	3
+val_321	2
+val_322	2
+val_323	1
+val_325	2
+val_327	3
+val_33	1
+val_331	2
+val_332	1
+val_333	2
+val_335	1
+val_336	1
+val_338	1
+val_339	1
+val_34	1
+val_341	1
+val_342	2
+val_344	2
+val_345	1
+val_348	5
+val_35	3
+val_351	1
+val_353	2
+val_356	1
+val_360	1
+val_362	1
+val_364	1
+val_365	1
+val_366	1
+val_367	2
+val_368	1
 val_369	3
+val_37	2
+val_373	1
+val_374	1
+val_375	1
+val_377	1
+val_378	1
+val_379	1
+val_382	2
 val_384	3
+val_386	1
+val_389	1
+val_392	1
+val_393	1
+val_394	1
+val_395	2
 val_396	3
+val_397	2
+val_399	2
+val_4	1
+val_400	1
+val_401	5
+val_402	1
 val_403	3
+val_404	2
+val_406	4
+val_407	1
 val_409	3
+val_41	1
+val_411	1
+val_413	2
+val_414	2
 val_417	3
-val_5	3
+val_418	1
+val_419	1
+val_42	2
+val_421	1
+val_424	2
+val_427	1
+val_429	2
+val_43	1
 val_430	3
-val_70	3
-val_119	3
-val_0	3
 val_431	3
+val_432	1
+val_435	1
+val_436	1
+val_437	1
 val_438	3
-val_480	3
-val_193	3
-val_199	3
-val_208	3
-val_187	3
-val_273	3
-val_298	3
+val_439	2
+val_44	1
+val_443	1
+val_444	1
+val_446	1
+val_448	1
+val_449	1
+val_452	1
+val_453	1
 val_454	3
-val_311	3
-val_316	3
+val_455	1
+val_457	1
+val_458	2
+val_459	2
+val_460	1
+val_462	2
+val_463	2
 val_466	3
-val_90	3
-val_128	3
-val_318	3
-val_327	3
-val_167	3
-val_35	3
+val_467	1
 val_468	4
-val_489	4
-val_406	4
-val_169	4
-val_138	4
-val_277	4
 val_469	5
-val_401	5
-val_230	5
-val_348	5
-PREHOOK: query: -- dyn partitions
-CREATE TABLE tmp_src_part (c string) PARTITIONED BY (d int)
-PREHOOK: type: CREATETABLE
-PREHOOK: Output: database:default
-PREHOOK: Output: default@tmp_src_part
-POSTHOOK: query: -- dyn partitions
-CREATE TABLE tmp_src_part (c string) PARTITIONED BY (d int)
-POSTHOOK: type: CREATETABLE
-POSTHOOK: Output: database:default
-POSTHOOK: Output: default@tmp_src_part
-PREHOOK: query: EXPLAIN INSERT INTO TABLE tmp_src_part PARTITION (d) SELECT * FROM tmp_src
-PREHOOK: type: QUERY
-POSTHOOK: query: EXPLAIN INSERT INTO TABLE tmp_src_part PARTITION (d) SELECT * FROM tmp_src
-POSTHOOK: type: QUERY
-STAGE DEPENDENCIES:
-  Stage-1 is a root stage
-  Stage-2 depends on stages: Stage-1
-  Stage-0 depends on stages: Stage-2
-  Stage-3 depends on stages: Stage-0
-
-STAGE PLANS:
-  Stage: Stage-1
+val_47	1
+val_470	1
+val_472	1
+val_475	1
+val_477	1
+val_478	2
+val_479	1
+val_480	3
+val_481	1
+val_482	1
+val_483	1
+val_484	1
+val_485	1
+val_487	1
+val_489	4
+val_490	1
+val_491	1
+val_492	2
+val_493	1
+val_494	1
+val_495	1
+val_496	1
+val_497	1
+val_498	3
+val_5	3
+val_51	2
+val_53	1
+val_54	1
+val_57	1
+val_58	2
+val_64	1
+val_65	1
+val_66	1
+val_67	2
+val_69	1
+val_70	3
+val_72	2
+val_74	1
+val_76	2
+val_77	1
+val_78	1
+val_8	1
+val_80	1
+val_82	1
+val_83	2
+val_84	2
+val_85	1
+val_86	1
+val_87	1
+val_9	1
+val_90	3
+val_92	1
+val_95	2
+val_96	1
+val_97	2
+val_98	2
+PREHOOK: query: -- dyn partitions
+CREATE TABLE tmp_src_part (c string) PARTITIONED BY (d int)
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@tmp_src_part
+POSTHOOK: query: -- dyn partitions
+CREATE TABLE tmp_src_part (c string) PARTITIONED BY (d int)
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@tmp_src_part
+PREHOOK: query: EXPLAIN INSERT INTO TABLE tmp_src_part PARTITION (d) SELECT * FROM tmp_src
+PREHOOK: type: QUERY
+POSTHOOK: query: EXPLAIN INSERT INTO TABLE tmp_src_part PARTITION (d) SELECT * FROM tmp_src
+POSTHOOK: type: QUERY
+STAGE DEPENDENCIES:
+  Stage-1 is a root stage
+  Stage-2 depends on stages: Stage-1
+  Stage-0 depends on stages: Stage-2
+  Stage-3 depends on stages: Stage-0
+
+STAGE PLANS:
+  Stage: Stage-1
     Tez
 #### A masked pattern was here ####
       Vertices:
@@ -512,315 +516,315 @@ POSTHOOK: Input: default@tmp_src_part@d=3
 POSTHOOK: Input: default@tmp_src_part@d=4
 POSTHOOK: Input: default@tmp_src_part@d=5
 #### A masked pattern was here ####
-val_490	1
-val_287	1
-val_286	1
-val_285	1
-val_284	1
-val_283	1
+val_0	3
+val_10	1
+val_100	2
+val_103	2
+val_104	2
+val_105	1
+val_11	1
+val_111	1
+val_113	2
 val_114	1
-val_487	1
-val_485	1
-val_28	1
-val_484	1
-val_181	1
-val_275	1
-val_274	1
-val_183	1
-val_483	1
-val_27	1
-val_266	1
-val_482	1
-val_263	1
-val_262	1
-val_260	1
-val_481	1
-val_258	1
-val_257	1
 val_116	1
-val_479	1
-val_252	1
-val_249	1
-val_248	1
-val_247	1
-val_244	1
-val_92	1
-val_241	1
-val_477	1
-val_475	1
-val_472	1
-val_470	1
-val_235	1
-val_47	1
-val_186	1
+val_118	2
+val_119	3
+val_12	2
+val_120	2
+val_125	2
 val_126	1
-val_228	1
-val_226	1
+val_128	3
+val_129	2
 val_131	1
-val_467	1
-val_222	1
 val_133	1
-val_82	1
-val_218	1
-val_80	1
-val_460	1
-val_214	1
-val_8	1
-val_78	1
-val_189	1
-val_457	1
-val_455	1
+val_134	2
 val_136	1
-val_202	1
-val_201	1
-val_453	1
-val_20	1
-val_2	1
-val_19	1
-val_452	1
-val_196	1
-val_449	1
-val_194	1
-val_190	1
-val_192	1
-val_448	1
-val_446	1
-val_444	1
-val_443	1
-val_44	1
-val_77	1
+val_137	2
+val_138	4
 val_143	1
-val_437	1
-val_436	1
-val_435	1
-val_432	1
 val_145	1
+val_146	2
+val_149	2
+val_15	2
 val_150	1
-val_43	1
-val_10	1
-val_427	1
-val_74	1
-val_421	1
-val_9	1
-val_419	1
-val_418	1
+val_152	2
 val_153	1
-val_105	1
-val_69	1
-val_411	1
-val_41	1
 val_155	1
-val_407	1
 val_156	1
-val_87	1
 val_157	1
-val_402	1
 val_158	1
-val_400	1
-val_4	1
-val_66	1
-val_65	1
 val_160	1
-val_64	1
-val_394	1
-val_393	1
-val_392	1
-val_389	1
-val_386	1
 val_162	1
-val_86	1
-val_379	1
-val_378	1
-val_377	1
-val_375	1
-val_374	1
-val_373	1
-val_57	1
 val_163	1
-val_368	1
-val_54	1
-val_366	1
-val_365	1
-val_364	1
-val_362	1
-val_360	1
-val_356	1
-val_53	1
-val_351	1
+val_164	2
+val_165	2
 val_166	1
+val_167	3
 val_168	1
-val_345	1
-val_85	1
-val_11	1
-val_341	1
-val_34	1
-val_339	1
-val_338	1
-val_336	1
-val_335	1
-val_111	1
-val_332	1
-val_497	1
-val_33	1
+val_169	4
 val_17	1
-val_496	1
-val_323	1
-val_495	1
-val_494	1
 val_170	1
-val_493	1
+val_172	2
+val_174	2
+val_175	2
+val_176	2
 val_177	1
-val_315	1
 val_178	1
-val_310	1
-val_96	1
-val_308	1
-val_491	1
-val_306	1
-val_305	1
-val_302	1
-val_30	1
+val_179	2
+val_18	2
 val_180	1
-val_296	1
-val_292	1
-val_291	1
+val_181	1
+val_183	1
+val_186	1
+val_187	3
+val_189	1
+val_19	1
+val_190	1
+val_191	2
+val_192	1
+val_193	3
+val_194	1
+val_195	2
+val_196	1
+val_197	2
+val_199	3
+val_2	1
+val_20	1
+val_200	2
+val_201	1
+val_202	1
+val_203	2
+val_205	2
+val_207	2
+val_208	3
+val_209	2
+val_213	2
+val_214	1
+val_216	2
+val_217	2
+val_218	1
+val_219	2
+val_221	2
+val_222	1
+val_223	2
+val_224	2
+val_226	1
+val_228	1
+val_229	2
+val_230	5
+val_233	2
+val_235	1
+val_237	2
+val_238	2
+val_239	2
+val_24	2
+val_241	1
+val_242	2
+val_244	1
+val_247	1
+val_248	1
+val_249	1
+val_252	1
+val_255	2
+val_256	2
+val_257	1
+val_258	1
+val_26	2
+val_260	1
+val_262	1
+val_263	1
+val_265	2
+val_266	1
+val_27	1
+val_272	2
+val_273	3
+val_274	1
+val_275	1
+val_277	4
+val_278	2
+val_28	1
+val_280	2
+val_281	2
+val_282	2
+val_283	1
+val_284	1
+val_285	1
+val_286	1
+val_287	1
+val_288	2
 val_289	1
-val_98	2
-val_97	2
-val_95	2
-val_84	2
-val_83	2
-val_76	2
-val_72	2
-val_67	2
-val_58	2
-val_51	2
-val_492	2
-val_478	2
-val_463	2
-val_462	2
-val_459	2
-val_458	2
-val_439	2
-val_429	2
-val_424	2
-val_42	2
-val_414	2
-val_413	2
-val_404	2
-val_399	2
-val_397	2
-val_395	2
-val_382	2
-val_37	2
-val_367	2
-val_353	2
-val_344	2
-val_342	2
-val_333	2
-val_331	2
-val_325	2
-val_322	2
-val_321	2
-val_317	2
-val_309	2
+val_291	1
+val_292	1
+val_296	1
+val_298	3
+val_30	1
+val_302	1
+val_305	1
+val_306	1
 val_307	2
-val_288	2
-val_282	2
-val_281	2
-val_280	2
-val_278	2
-val_272	2
-val_265	2
-val_26	2
-val_256	2
-val_255	2
-val_242	2
-val_24	2
-val_239	2
-val_238	2
-val_237	2
-val_233	2
-val_229	2
-val_224	2
-val_223	2
-val_221	2
-val_219	2
-val_217	2
-val_216	2
-val_213	2
-val_209	2
-val_207	2
-val_205	2
-val_203	2
-val_200	2
-val_197	2
-val_195	2
-val_191	2
-val_18	2
-val_179	2
-val_176	2
-val_175	2
-val_174	2
-val_172	2
-val_165	2
-val_164	2
-val_152	2
-val_15	2
-val_149	2
-val_146	2
-val_137	2
-val_134	2
-val_129	2
-val_125	2
-val_120	2
-val_12	2
-val_118	2
-val_113	2
-val_104	2
-val_103	2
-val_100	2
-val_498	3
+val_308	1
+val_309	2
+val_310	1
+val_311	3
+val_315	1
+val_316	3
+val_317	2
+val_318	3
+val_321	2
+val_322	2
+val_323	1
+val_325	2
+val_327	3
+val_33	1
+val_331	2
+val_332	1
+val_333	2
+val_335	1
+val_336	1
+val_338	1
+val_339	1
+val_34	1
+val_341	1
+val_342	2
+val_344	2
+val_345	1
+val_348	5
+val_35	3
+val_351	1
+val_353	2
+val_356	1
+val_360	1
+val_362	1
+val_364	1
+val_365	1
+val_366	1
+val_367	2
+val_368	1
 val_369	3
+val_37	2
+val_373	1
+val_374	1
+val_375	1
+val_377	1
+val_378	1
+val_379	1
+val_382	2
 val_384	3
+val_386	1
+val_389	1
+val_392	1
+val_393	1
+val_394	1
+val_395	2
 val_396	3
+val_397	2
+val_399	2
+val_4	1
+val_400	1
+val_401	5
+val_402	1
 val_403	3
+val_404	2
+val_406	4
+val_407	1
 val_409	3
+val_41	1
+val_411	1
+val_413	2
+val_414	2
 val_417	3
-val_5	3
+val_418	1
+val_419	1
+val_42	2
+val_421	1
+val_424	2
+val_427	1
+val_429	2
+val_43	1
 val_430	3
-val_70	3
-val_119	3
-val_0	3
 val_431	3
+val_432	1
+val_435	1
+val_436	1
+val_437	1
 val_438	3
-val_480	3
-val_193	3
-val_199	3
-val_208	3
-val_187	3
-val_273	3
-val_298	3
+val_439	2
+val_44	1
+val_443	1
+val_444	1
+val_446	1
+val_448	1
+val_449	1
+val_452	1
+val_453	1
 val_454	3
-val_311	3
-val_316	3
+val_455	1
+val_457	1
+val_458	2
+val_459	2
+val_460	1
+val_462	2
+val_463	2
 val_466	3
-val_90	3
-val_128	3
-val_318	3
-val_327	3
-val_167	3
-val_35	3
+val_467	1
 val_468	4
-val_489	4
-val_406	4
-val_169	4
-val_138	4
-val_277	4
 val_469	5
-val_401	5
-val_230	5
-val_348	5
+val_47	1
+val_470	1
+val_472	1
+val_475	1
+val_477	1
+val_478	2
+val_479	1
+val_480	3
+val_481	1
+val_482	1
+val_483	1
+val_484	1
+val_485	1
+val_487	1
+val_489	4
+val_490	1
+val_491	1
+val_492	2
+val_493	1
+val_494	1
+val_495	1
+val_496	1
+val_497	1
+val_498	3
+val_5	3
+val_51	2
+val_53	1
+val_54	1
+val_57	1
+val_58	2
+val_64	1
+val_65	1
+val_66	1
+val_67	2
+val_69	1
+val_70	3
+val_72	2
+val_74	1
+val_76	2
+val_77	1
+val_78	1
+val_8	1
+val_80	1
+val_82	1
+val_83	2
+val_84	2
+val_85	1
+val_86	1
+val_87	1
+val_9	1
+val_90	3
+val_92	1
+val_95	2
+val_96	1
+val_97	2
+val_98	2
 PREHOOK: query: -- multi insert
 CREATE TABLE even (c int, d string)
 PREHOOK: type: CREATETABLE
@@ -953,253 +957,253 @@ POSTHOOK: query: SELECT * FROM even
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@even
 #### A masked pattern was here ####
-238	val_238
-86	val_86
-278	val_278
-98	val_98
-484	val_484
-150	val_150
-224	val_224
-66	val_66
+0	val_0
+0	val_0
+0	val_0
+10	val_10
+100	val_100
+100	val_100
+104	val_104
+104	val_104
+114	val_114
+116	val_116
+118	val_118
+118	val_118
+12	val_12
+12	val_12
+120	val_120
+120	val_120
+126	val_126
+128	val_128
 128	val_128
+128	val_128
+134	val_134
+134	val_134
+136	val_136
+138	val_138
+138	val_138
+138	val_138
+138	val_138
 146	val_146
-406	val_406
-374	val_374
+146	val_146
+150	val_150
 152	val_152
-82	val_82
+152	val_152
+156	val_156
+158	val_158
+160	val_160
+162	val_162
+164	val_164
+164	val_164
 166	val_166
-430	val_430
-252	val_252
-292	val_292
-338	val_338
-446	val_446
-394	val_394
-482	val_482
+168	val_168
+170	val_170
+172	val_172
+172	val_172
 174	val_174
-494	val_494
-466	val_466
-208	val_208
 174	val_174
-396	val_396
-162	val_162
-266	val_266
-342	val_342
-0	val_0
-128	val_128
-316	val_316
-302	val_302
-438	val_438
-170	val_170
-20	val_20
-378	val_378
-92	val_92
-72	val_72
-4	val_4
-280	val_280
-208	val_208
-356	val_356
-382	val_382
-498	val_498
-386	val_386
-192	val_192
-286	val_286
 176	val_176
-54	val_54
-138	val_138
-216	val_216
-430	val_430
-278	val_278
 176	val_176
-318	val_318
-332	val_332
+178	val_178
+18	val_18
+18	val_18
 180	val_180
-284	val_284
-12	val_12
+186	val_186
+190	val_190
+192	val_192
+194	val_194
+196	val_196
+2	val_2
+20	val_20
+200	val_200
+200	val_200
+202	val_202
+208	val_208
+208	val_208
+208	val_208
+214	val_214
+216	val_216
+216	val_216
+218	val_218
+222	val_222
+224	val_224
+224	val_224
+226	val_226
+228	val_228
 230	val_230
-260	val_260
-404	val_404
-384	val_384
-272	val_272
-138	val_138
-84	val_84
-348	val_348
-466	val_466
-58	val_58
-8	val_8
 230	val_230
-208	val_208
-348	val_348
+230	val_230
+230	val_230
+230	val_230
+238	val_238
+238	val_238
 24	val_24
-172	val_172
-42	val_42
-158	val_158
-496	val_496
-0	val_0
-322	val_322
-468	val_468
-454	val_454
-100	val_100
-298	val_298
-418	val_418
-96	val_96
+24	val_24
+242	val_242
+242	val_242
+244	val_244
+248	val_248
+252	val_252
+256	val_256
+256	val_256
+258	val_258
 26	val_26
-230	val_230
-120	val_120
-404	val_404
-436	val_436
-156	val_156
-468	val_468
-308	val_308
-196	val_196
-288	val_288
-98	val_98
+26	val_26
+260	val_260
+262	val_262
+266	val_266
+272	val_272
+272	val_272
+274	val_274
+278	val_278
+278	val_278
+28	val_28
+280	val_280
+280	val_280
 282	val_282
-318	val_318
-318	val_318
-470	val_470
-316	val_316
-0	val_0
-490	val_490
-364	val_364
-118	val_118
-134	val_134
 282	val_282
-138	val_138
-238	val_238
-118	val_118
-72	val_72
-90	val_90
-10	val_10
+284	val_284
+286	val_286
+288	val_288
+288	val_288
+292	val_292
+296	val_296
+298	val_298
+298	val_298
+298	val_298
+30	val_30
+302	val_302
 306	val_306
-224	val_224
-242	val_242
-392	val_392
-272	val_272
-242	val_242
-452	val_452
-226	val_226
-402	val_402
-396	val_396
-58	val_58
+308	val_308
+310	val_310
+316	val_316
+316	val_316
+316	val_316
+318	val_318
+318	val_318
+318	val_318
+322	val_322
+322	val_322
+332	val_332
 336	val_336
-168	val_168
+338	val_338
 34	val_34
-472	val_472
-322	val_322
-498	val_498
-160	val_160
-42	val_42
-430	val_430
-458	val_458
-78	val_78
-76	val_76
-492	val_492
-218	val_218
-228	val_228
-138	val_138
-30	val_30
-64	val_64
-468	val_468
-76	val_76
-74	val_74
 342	val_342
-230	val_230
-368	val_368
-296	val_296
-216	val_216
+342	val_342
 344	val_344
-274	val_274
-116	val_116
-256	val_256
-70	val_70
-480	val_480
-288	val_288
-244	val_244
-438	val_438
-128	val_128
-432	val_432
-202	val_202
-316	val_316
-280	val_280
-2	val_2
-80	val_80
-44	val_44
-104	val_104
-466	val_466
+344	val_344
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+348	val_348
+356	val_356
+360	val_360
+362	val_362
+364	val_364
 366	val_366
+368	val_368
+374	val_374
+378	val_378
+382	val_382
+382	val_382
+384	val_384
+384	val_384
+384	val_384
+386	val_386
+392	val_392
+394	val_394
+396	val_396
+396	val_396
+396	val_396
+4	val_4
+400	val_400
+402	val_402
+404	val_404
+404	val_404
 406	val_406
-190	val_190
 406	val_406
-114	val_114
-258	val_258
-90	val_90
-262	val_262
-348	val_348
+406	val_406
+406	val_406
+414	val_414
+414	val_414
+418	val_418
+42	val_42
+42	val_42
 424	val_424
-12	val_12
-396	val_396
-164	val_164
-454	val_454
-478	val_478
-298	val_298
-164	val_164
 424	val_424
-382	val_382
-70	val_70
-480	val_480
-24	val_24
-104	val_104
-70	val_70
+430	val_430
+430	val_430
+430	val_430
+432	val_432
+436	val_436
 438	val_438
-414	val_414
-200	val_200
-360	val_360
-248	val_248
+438	val_438
+438	val_438
+44	val_44
 444	val_444
-120	val_120
-230	val_230
-478	val_478
-178	val_178
-468	val_468
-310	val_310
+446	val_446
+448	val_448
+452	val_452
+454	val_454
+454	val_454
+454	val_454
+458	val_458
+458	val_458
 460	val_460
-480	val_480
-136	val_136
-172	val_172
-214	val_214
 462	val_462
-406	val_406
-454	val_454
-384	val_384
-256	val_256
-26	val_26
-134	val_134
-384	val_384
-18	val_18
 462	val_462
+466	val_466
+466	val_466
+466	val_466
+468	val_468
+468	val_468
+468	val_468
+468	val_468
+470	val_470
+472	val_472
+478	val_478
+478	val_478
+480	val_480
+480	val_480
+480	val_480
+482	val_482
+484	val_484
+490	val_490
 492	val_492
-100	val_100
-298	val_298
+492	val_492
+494	val_494
+496	val_496
 498	val_498
-146	val_146
-458	val_458
-362	val_362
-186	val_186
-348	val_348
-18	val_18
-344	val_344
+498	val_498
+498	val_498
+54	val_54
+58	val_58
+58	val_58
+64	val_64
+66	val_66
+70	val_70
+70	val_70
+70	val_70
+72	val_72
+72	val_72
+74	val_74
+76	val_76
+76	val_76
+78	val_78
+8	val_8
+80	val_80
+82	val_82
 84	val_84
-28	val_28
-448	val_448
-152	val_152
-348	val_348
-194	val_194
-414	val_414
-222	val_222
-126	val_126
+84	val_84
+86	val_86
 90	val_90
-400	val_400
-200	val_200
+90	val_90
+90	val_90
+92	val_92
+96	val_96
+98	val_98
+98	val_98
 PREHOOK: query: SELECT * FROM odd
 PREHOOK: type: QUERY
 PREHOOK: Input: default@odd
@@ -1208,258 +1212,258 @@ POSTHOOK: query: SELECT * FROM odd
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@odd
 #### A masked pattern was here ####
-311	val_311
-27	val_27
-165	val_165
-409	val_409
-255	val_255
-265	val_265
-193	val_193
-401	val_401
-273	val_273
-369	val_369
-213	val_213
-429	val_429
-469	val_469
+103	val_103
+103	val_103
+105	val_105
+11	val_11
+111	val_111
+113	val_113
+113	val_113
+119	val_119
+119	val_119
+119	val_119
+125	val_125
+125	val_125
+129	val_129
+129	val_129
+131	val_131
+133	val_133
+137	val_137
+137	val_137
+143	val_143
 145	val_145
-495	val_495
-37	val_37
-327	val_327
-281	val_281
-277	val_277
-209	val_209
+149	val_149
+149	val_149
+15	val_15
 15	val_15
-403	val_403
-417	val_417
-219	val_219
-287	val_287
 153	val_153
-193	val_193
-459	val_459
-237	val_237
-413	val_413
-207	val_207
-199	val_199
-399	val_399
-247	val_247
-417	val_417
-489	val_489
-377	val_377
-397	val_397
-309	val_309
-365	val_365
-439	val_439
-367	val_367
-325	val_325
-167	val_167
-195	val_195
-475	val_475
-17	val_17
-113	val_113
 155	val_155
-203	val_203
-339	val_339
-455	val_455
-311	val_311
-57	val_57
-205	val_205
-149	val_149
-345	val_345
-129	val_129
-489	val_489
 157	val_157
-221	val_221
-111	val_111
-47	val_47
-35	val_35
-427	val_427
-277	val_277
-399	val_399
-169	val_169
-125	val_125
-437	val_437
-469	val_469
-187	val_187
-459	val_459
-51	val_51
-103	val_103
-239	val_239
-213	val_213
-289	val_289
-221	val_221
-65	val_65
-311	val_311
-275	val_275
-137	val_137
-241	val_241
-83	val_83
-333	val_333
-181	val_181
-67	val_67
-489	val_489
-353	val_353
-373	val_373
-217	val_217
-411	val_411
-463	val_463
-431	val_431
-179	val_179
-129	val_129
-119	val_119
-197	val_197
-393	val_393
-199	val_199
-191	val_191
+163	val_163
 165	val_165
-327	val_327
-205	val_205
-131	val_131
-51	val_51
-43	val_43
-469	val_469
-95	val_95
-481	val_481
-457	val_457
-197	val_197
-187	val_187
-409	val_409
-137	val_137
-369	val_369
+165	val_165
+167	val_167
+167	val_167
+167	val_167
 169	val_169
-413	val_413
-85	val_85
-77	val_77
-87	val_87
+169	val_169
+169	val_169
+169	val_169
+17	val_17
+175	val_175
+175	val_175
+177	val_177
 179	val_179
-395	val_395
-419	val_419
-15	val_15
-307	val_307
+179	val_179
+181	val_181
+183	val_183
+187	val_187
+187	val_187
+187	val_187
+189	val_189
 19	val_19
-435	val_435
-277	val_277
-273	val_273
-309	val_309
-389	val_389
-327	val_327
-369	val_369
-331	val_331
-401	val_401
-177	val_177
-5	val_5
-497	val_497
-317	val_317
-395	val_395
-35	val_35
-95	val_95
-11	val_11
-229	val_229
-233	val_233
-143	val_143
-195	val_195
-321	val_321
-119	val_119
-489	val_489
-41	val_41
-223	val_223
-149	val_149
-449	val_449
-453	val_453
+191	val_191
+191	val_191
+193	val_193
+193	val_193
+193	val_193
+195	val_195
+195	val_195
+197	val_197
+197	val_197
+199	val_199
+199	val_199
+199	val_199
+201	val_201
+203	val_203
+203	val_203
+205	val_205
+205	val_205
+207	val_207
+207	val_207
 209	val_209
-69	val_69
-33	val_33
-103	val_103
-113	val_113
-367	val_367
-167	val_167
+209	val_209
+213	val_213
+213	val_213
+217	val_217
+217	val_217
 219	val_219
-239	val_239
-485	val_485
+219	val_219
+221	val_221
+221	val_221
+223	val_223
 223	val_223
-263	val_263
-487	val_487
-401	val_401
-191	val_191
-5	val_5
-467	val_467
 229	val_229
-469	val_469
-463	val_463
-35	val_35
-283	val_283
-331	val_331
+229	val_229
+233	val_233
+233	val_233
 235	val_235
-193	val_193
-321	val_321
-335	val_335
-175	val_175
-403	val_403
-483	val_483
-53	val_53
-105	val_105
+237	val_237
+237	val_237
+239	val_239
+239	val_239
+241	val_241
+247	val_247
+249	val_249
+255	val_255
+255	val_255
 257	val_257
-409	val_409
-401	val_401
-203	val_203
-201	val_201
-217	val_217
-431	val_431
-125	val_125
-431	val_431
-187	val_187
-5	val_5
-397	val_397
+263	val_263
+265	val_265
+265	val_265
+27	val_27
+273	val_273
+273	val_273
+273	val_273
+275	val_275
+277	val_277
+277	val_277
+277	val_277
+277	val_277
+281	val_281
+281	val_281
+283	val_283
+285	val_285
+287	val_287
+289	val_289
 291	val_291
-351	val_351
-255	val_255
-163	val_163
-119	val_119
-491	val_491
-237	val_237
-439	val_439
-479	val_479
 305	val_305
-417	val_417
-199	val_199
-429	val_429
-169	val_169
-443	val_443
+307	val_307
+307	val_307
+309	val_309
+309	val_309
+311	val_311
+311	val_311
+311	val_311
+315	val_315
+317	val_317
+317	val_317
+321	val_321
+321	val_321
 323	val_323
 325	val_325
-277	val_277
-317	val_317
+325	val_325
+327	val_327
+327	val_327
+327	val_327
+33	val_33
+331	val_331
+331	val_331
 333	val_333
-493	val_493
-207	val_207
-249	val_249
-265	val_265
-83	val_83
+333	val_333
+335	val_335
+339	val_339
+341	val_341
+345	val_345
+35	val_35
+35	val_35
+35	val_35
+351	val_351
 353	val_353
-233	val_233
-133	val_133
-175	val_175
-189	val_189
+353	val_353
+365	val_365
+367	val_367
+367	val_367
+369	val_369
+369	val_369
+369	val_369
+37	val_37
+37	val_37
+373	val_373
 375	val_375
+377	val_377
+379	val_379
+389	val_389
+393	val_393
+395	val_395
+395	val_395
+397	val_397
+397	val_397
+399	val_399
+399	val_399
 401	val_401
-421	val_421
+401	val_401
+401	val_401
+401	val_401
+401	val_401
+403	val_403
+403	val_403
+403	val_403
 407	val_407
+409	val_409
+409	val_409
+409	val_409
+41	val_41
+411	val_411
+413	val_413
+413	val_413
+417	val_417
+417	val_417
+417	val_417
+419	val_419
+421	val_421
+427	val_427
+429	val_429
+429	val_429
+43	val_43
+431	val_431
+431	val_431
+431	val_431
+435	val_435
+437	val_437
+439	val_439
+439	val_439
+443	val_443
+449	val_449
+453	val_453
+455	val_455
+457	val_457
+459	val_459
+459	val_459
+463	val_463
+463	val_463
+467	val_467
+469	val_469
+469	val_469
+469	val_469
+469	val_469
+469	val_469
+47	val_47
+475	val_475
+477	val_477
+479	val_479
+481	val_481
+483	val_483
+485	val_485
+487	val_487
+489	val_489
+489	val_489
+489	val_489
+489	val_489
+491	val_491
+493	val_493
+495	val_495
+497	val_497
+5	val_5
+5	val_5
+5	val_5
+51	val_51
+51	val_51
+53	val_53
+57	val_57
+65	val_65
 67	val_67
-379	val_379
+67	val_67
+69	val_69
+77	val_77
+83	val_83
+83	val_83
+85	val_85
+87	val_87
 9	val_9
-341	val_341
-285	val_285
-167	val_167
-273	val_273
-183	val_183
-281	val_281
+95	val_95
+95	val_95
 97	val_97
-469	val_469
-315	val_315
-37	val_37
-307	val_307
-477	val_477
-169	val_169
-403	val_403
 97	val_97
 PREHOOK: query: -- create empty table
 CREATE TABLE empty STORED AS orc AS SELECT * FROM tmp_src_part WHERE d = -1000
diff --git a/ql/src/test/results/clientpositive/tez/tez_join_hash.q.out b/ql/src/test/results/clientpositive/tez/tez_join_hash.q.out
index e782c73013..59c8df4a04 100644
--- a/ql/src/test/results/clientpositive/tez/tez_join_hash.q.out
+++ b/ql/src/test/results/clientpositive/tez/tez_join_hash.q.out
@@ -1,8 +1,12 @@
-PREHOOK: query: create table orc_src (key string, value string) STORED AS ORC
+PREHOOK: query: -- SORT_QUERY_RESULTS
+
+create table orc_src (key string, value string) STORED AS ORC
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@orc_src
-POSTHOOK: query: create table orc_src (key string, value string) STORED AS ORC
+POSTHOOK: query: -- SORT_QUERY_RESULTS
+
+create table orc_src (key string, value string) STORED AS ORC
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@orc_src
@@ -327,72 +331,143 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
 #### A masked pattern was here ####
 0	468
 10	20
+100	144
 103	144
+104	144
 105	20
+11	20
+111	20
+113	144
+114	20
 116	20
+118	144
+119	468
+12	144
 120	144
 125	144
+126	20
+128	468
 129	144
 131	20
+133	20
 134	144
 136	20
+137	144
+138	1088
 143	20
 145	20
+146	144
 149	144
+15	144
 150	20
+152	144
+153	20
 155	20
+156	20
 157	20
 158	20
 160	20
+162	20
 163	20
 164	144
+165	144
 166	20
+167	468
+168	20
+169	1088
 17	20
 170	20
 172	144
+174	144
+175	144
+176	144
+177	20
+178	20
+179	144
+18	144
 180	20
+181	20
 183	20
+186	20
+187	468
 189	20
 19	20
 190	20
 191	144
+192	20
 193	468
+194	20
 195	144
 196	20
+197	144
+199	468
+2	20
 20	20
+200	144
+201	20
+202	20
+203	144
 205	144
 207	144
+208	468
 209	144
 213	144
+214	20
 216	144
 217	144
+218	20
+219	144
+221	144
+222	20
 223	144
 224	144
+226	20
 228	20
 229	144
+230	2100
 233	144
 235	20
+237	144
 238	144
 239	144
 24	144
 241	20
+242	144
 244	20
 247	20
 248	20
+249	20
+252	20
 255	144
+256	144
+257	20
 258	20
 26	144
 260	20
+262	20
 263	20
 265	144
 266	20
+27	20
 272	144
 273	468
 274	20
+275	20
+277	1088
+278	144
 28	20
+280	144
 281	144
+282	144
+283	20
+284	20
+285	20
 286	20
+287	20
+288	144
+289	20
 291	20
+292	20
 296	20
 298	468
 30	20
@@ -402,28 +477,46 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
 307	144
 308	20
 309	144
+310	20
+311	468
 315	20
 316	468
 317	144
 318	468
 321	144
+322	144
+323	20
 325	144
+327	468
 33	20
 331	144
 332	20
+333	144
 335	20
+336	20
+338	20
 339	20
+34	20
+341	20
 342	144
+344	144
 345	20
+348	2100
+35	468
+351	20
 353	144
 356	20
 360	20
+362	20
+364	20
+365	20
 366	20
 367	144
 368	20
 369	468
 37	144
 373	20
+374	20
 375	20
 377	20
 378	20
@@ -432,40 +525,81 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
 384	468
 386	20
 389	20
+392	20
+393	20
 394	20
 395	144
 396	468
+397	144
 399	144
+4	20
 400	20
 401	2100
 402	20
+403	468
+404	144
 406	1088
 407	20
+409	468
 41	20
+411	20
 413	144
 414	144
+417	468
+418	20
+419	20
 42	144
+421	20
+424	144
+427	20
+429	144
+43	20
 430	468
 431	468
+432	20
+435	20
 436	20
+437	20
+438	468
+439	144
 44	20
+443	20
+444	20
 446	20
 448	20
 449	20
 452	20
+453	20
+454	468
+455	20
+457	20
+458	144
 459	144
+460	20
 462	144
+463	144
 466	468
 467	20
 468	1088
+469	2100
 47	20
+470	20
 472	20
+475	20
+477	20
+478	144
+479	20
 480	468
+481	20
 482	20
+483	20
 484	20
 485	20
 487	20
+489	1088
 490	20
+491	20
+492	144
 493	20
 494	20
 495	20
@@ -474,164 +608,34 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
 498	468
 5	468
 51	144
+53	20
 54	20
 57	20
 58	144
+64	20
 65	20
 66	20
+67	144
 69	20
 70	468
+72	144
 74	20
+76	144
 77	20
 78	20
 8	20
 80	20
+82	20
+83	144
 84	144
 85	20
+86	20
 87	20
 9	20
+90	468
 92	20
 95	144
 96	20
-100	144
-104	144
-11	20
-111	20
-113	144
-114	20
-118	144
-119	468
-12	144
-126	20
-128	468
-133	20
-137	144
-138	1088
-146	144
-15	144
-152	144
-153	20
-156	20
-162	20
-165	144
-167	468
-168	20
-169	1088
-174	144
-175	144
-176	144
-177	20
-178	20
-179	144
-18	144
-181	20
-186	20
-187	468
-192	20
-194	20
-197	144
-199	468
-2	20
-200	144
-201	20
-202	20
-203	144
-208	468
-214	20
-218	20
-219	144
-221	144
-222	20
-226	20
-230	2100
-237	144
-242	144
-249	20
-252	20
-256	144
-257	20
-262	20
-27	20
-275	20
-277	1088
-278	144
-280	144
-282	144
-283	20
-284	20
-285	20
-287	20
-288	144
-289	20
-292	20
-310	20
-311	468
-322	144
-323	20
-327	468
-333	144
-336	20
-338	20
-34	20
-341	20
-344	144
-348	2100
-35	468
-351	20
-362	20
-364	20
-365	20
-374	20
-392	20
-393	20
-397	144
-4	20
-403	468
-404	144
-409	468
-411	20
-417	468
-418	20
-419	20
-421	20
-424	144
-427	20
-429	144
-43	20
-432	20
-435	20
-437	20
-438	468
-439	144
-443	20
-444	20
-453	20
-454	468
-455	20
-457	20
-458	144
-460	20
-463	144
-469	2100
-470	20
-475	20
-477	20
-478	144
-479	20
-481	20
-483	20
-489	1088
-491	20
-492	144
-53	20
-64	20
-67	144
-72	144
-76	144
-82	20
-83	144
-86	20
-90	468
 97	144
 98	144
 PREHOOK: query: select key, count(*) from (select x.key as key, y.value as value from
diff --git a/ql/src/test/results/clientpositive/tez/tez_joins_explain.q.out b/ql/src/test/results/clientpositive/tez/tez_joins_explain.q.out
index 668f75b41a..31f7275365 100644
--- a/ql/src/test/results/clientpositive/tez/tez_joins_explain.q.out
+++ b/ql/src/test/results/clientpositive/tez/tez_joins_explain.q.out
@@ -1,10 +1,8 @@
 PREHOOK: query: -- SORT_QUERY_RESULTS
-
 explain
 select * from (select b.key, b.value from src1 a left outer join src b on (a.key = b.key) order by b.key) x right outer join src c on (x.value = c.value) order by x.key
 PREHOOK: type: QUERY
 POSTHOOK: query: -- SORT_QUERY_RESULTS
-
 explain
 select * from (select b.key, b.value from src1 a left outer join src b on (a.key = b.key) order by b.key) x right outer join src c on (x.value = c.value) order by x.key
 POSTHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/tez/tez_multi_union.q.out b/ql/src/test/results/clientpositive/tez/tez_multi_union.q.out
index a649431196..fbc1c2f484 100644
--- a/ql/src/test/results/clientpositive/tez/tez_multi_union.q.out
+++ b/ql/src/test/results/clientpositive/tez/tez_multi_union.q.out
@@ -1,4 +1,5 @@
-PREHOOK: query: select key from
+PREHOOK: query: -- SORT_QUERY_RESULTS
+select key from
 (
 select key from src
 union all
@@ -9,7 +10,8 @@ select key from src
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
 #### A masked pattern was here ####
-POSTHOOK: query: select key from
+POSTHOOK: query: -- SORT_QUERY_RESULTS
+select key from
 (
 select key from src
 union all
@@ -21,811 +23,811 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 #### A masked pattern was here ####
 0
+0
+0
+0
+10
 10
 100
+100
+100
+103
+103
 103
 104
+104
+104
 105
+105
+11
 11
 111
+111
+113
 113
+113
+114
 114
 116
+116
+118
 118
+118
+119
 119
+119
+119
+12
+12
 12
 120
+120
+120
+125
+125
 125
 126
+126
+128
+128
+128
 128
 129
+129
+129
 131
+131
+133
 133
 134
+134
+134
 136
+136
+137
 137
+137
+138
+138
+138
 138
+138
+143
 143
 145
+145
+146
 146
+146
+149
 149
+149
+15
 15
+15
+150
 150
 152
+152
+152
 153
+153
+155
 155
 156
+156
+157
 157
 158
+158
+160
 160
 162
+162
+163
 163
 164
+164
+164
+165
+165
 165
 166
+166
+167
+167
+167
 167
 168
+168
+169
+169
+169
 169
+169
+17
 17
 170
+170
+172
 172
+172
+174
 174
+174
+175
 175
+175
+176
 176
+176
+177
 177
 178
+178
+179
 179
+179
+18
 18
+18
+180
 180
 181
+181
+183
 183
 186
+186
+187
+187
+187
 187
 189
+189
+19
 19
 190
+190
+191
 191
+191
+192
 192
 193
+193
+193
+193
+194
 194
 195
+195
+195
 196
+196
+197
 197
+197
+199
+199
+199
 199
 2
+2
+20
 20
 200
+200
+200
 201
+201
+202
 202
 203
+203
+203
+205
+205
 205
 207
+207
+207
+208
+208
 208
+208
+209
 209
+209
+213
 213
+213
+214
 214
 216
+216
+216
+217
+217
 217
 218
+218
+219
 219
+219
+221
 221
+221
+222
 222
 223
+223
+223
+224
+224
 224
 226
+226
+228
 228
 229
+229
+229
+230
+230
+230
+230
 230
+230
+233
 233
+233
+235
 235
 237
+237
+237
+238
+238
 238
 239
+239
+239
+24
+24
 24
 241
+241
+242
 242
+242
+244
 244
 247
+247
+248
 248
 249
+249
+252
 252
 255
+255
+255
+256
+256
 256
 257
+257
+258
 258
 26
+26
+26
 260
+260
+262
 262
 263
+263
+265
 265
+265
+266
 266
 27
+27
+272
 272
+272
+273
+273
+273
 273
 274
+274
+275
 275
 277
+277
+277
+277
+277
+278
+278
 278
 28
+28
+280
 280
+280
+281
 281
+281
+282
 282
+282
+283
 283
 284
+284
+285
 285
 286
+286
+287
 287
 288
+288
+288
 289
+289
+291
 291
 292
+292
+296
 296
 298
+298
+298
+298
+30
 30
 302
+302
+305
 305
 306
+306
+307
 307
+307
+308
 308
 309
+309
+309
 310
+310
+311
+311
+311
 311
 315
+315
+316
 316
+316
+316
+317
+317
 317
 318
+318
+318
+318
+321
 321
+321
+322
 322
+322
+323
 323
 325
+325
+325
+327
+327
 327
+327
+33
 33
 331
+331
+331
 332
+332
+333
 333
+333
+335
 335
 336
+336
+338
 338
 339
+339
+34
 34
 341
+341
+342
 342
+342
+344
 344
+344
+345
 345
 348
+348
+348
+348
+348
+348
+35
+35
+35
 35
 351
+351
+353
 353
+353
+356
 356
 360
+360
+362
 362
 364
+364
+365
 365
 366
+366
+367
 367
+367
+368
 368
 369
+369
+369
+369
+37
 37
+37
+373
 373
 374
+374
+375
 375
 377
+377
+378
 378
 379
+379
+382
 382
+382
+384
+384
+384
 384
 386
+386
+389
 389
 392
+392
+393
 393
 394
+394
+395
 395
+395
+396
+396
+396
 396
 397
+397
+397
+399
+399
 399
 4
+4
+400
 400
 401
+401
+401
+401
+401
+401
+402
 402
 403
+403
+403
+403
+404
 404
+404
+406
+406
+406
 406
+406
+407
 407
 409
+409
+409
+409
+41
 41
 411
+411
+413
 413
+413
+414
 414
+414
+417
+417
+417
 417
 418
+418
+419
 419
 42
+42
+42
 421
+421
+424
 424
+424
+427
 427
 429
+429
+429
 43
+43
+430
+430
+430
 430
 431
+431
+431
+431
+432
 432
 435
+435
+436
 436
 437
+437
+438
 438
+438
+438
+439
+439
 439
 44
+44
+443
 443
 444
+444
+446
 446
 448
+448
+449
 449
 452
+452
+453
 453
 454
+454
+454
+454
+455
 455
 457
+457
+458
 458
+458
+459
 459
+459
+460
 460
 462
+462
+462
 463
+463
+463
+466
+466
 466
+466
+467
 467
 468
+468
+468
+468
+468
+469
+469
 469
+469
+469
+469
+47
 47
 470
+470
+472
 472
 475
+475
+477
 477
 478
+478
+478
 479
+479
+480
+480
+480
 480
 481
+481
+482
 482
 483
+483
+484
 484
 485
+485
+487
 487
 489
+489
+489
+489
+489
 490
+490
+491
 491
 492
+492
+492
 493
+493
+494
 494
 495
+495
+496
 496
 497
+497
+498
+498
+498
 498
 5
+5
+5
+5
+51
 51
+51
+53
 53
 54
+54
+57
 57
 58
+58
+58
 64
+64
+65
 65
 66
+66
+67
 67
+67
+69
 69
 70
+70
+70
+70
+72
 72
+72
+74
 74
 76
+76
+76
 77
+77
+78
 78
 8
+8
+80
 80
 82
+82
+83
 83
+83
+84
 84
+84
+85
 85
 86
+86
+87
 87
 9
+9
+90
+90
+90
 90
 92
+92
+95
 95
+95
+96
 96
 97
+97
+97
 98
-238
-86
-311
-27
-165
-409
-255
-278
 98
-484
-265
-193
-401
-150
-273
-224
-369
-66
-128
-213
-146
-406
-429
-374
-152
-469
-145
-495
-37
-327
-281
-277
-209
-15
-82
-403
-166
-417
-430
-252
-292
-219
-287
-153
-193
-338
-446
-459
-394
-237
-482
-174
-413
-494
-207
-199
-466
-208
-174
-399
-396
-247
-417
-489
-162
-377
-397
-309
-365
-266
-439
-342
-367
-325
-167
-195
-475
-17
-113
-155
-203
-339
-0
-455
-128
-311
-316
-57
-302
-205
-149
-438
-345
-129
-170
-20
-489
-157
-378
-221
-92
-111
-47
-72
-4
-280
-35
-427
-277
-208
-356
-399
-169
-382
-498
-125
-386
-437
-469
-192
-286
-187
-176
-54
-459
-51
-138
-103
-239
-213
-216
-430
-278
-176
-289
-221
-65
-318
-332
-311
-275
-137
-241
-83
-333
-180
-284
-12
-230
-181
-67
-260
-404
-384
-489
-353
-373
-272
-138
-217
-84
-348
-466
-58
-8
-411
-230
-208
-348
-24
-463
-431
-179
-172
-42
-129
-158
-119
-496
-0
-322
-197
-468
-393
-454
-100
-298
-199
-191
-418
-96
-26
-165
-327
-230
-205
-120
-131
-51
-404
-43
-436
-156
-469
-468
-308
-95
-196
-288
-481
-457
 98
-282
-197
-187
-318
-318
-409
-470
-137
-369
-316
-169
-413
-85
-77
-0
-490
-87
-364
-179
-118
-134
-395
-282
-138
-238
-419
-15
-118
-72
-90
-307
-19
-435
-10
-277
-273
-306
-224
-309
-389
-327
-242
-369
-392
-272
-331
-401
-242
-452
-177
-226
-5
-497
-402
-396
-317
-395
-58
-35
-336
-95
-11
-168
-34
-229
-233
-143
-472
-322
-498
-160
-195
-42
-321
-430
-119
-489
-458
-78
-76
-41
-223
-492
-149
-449
-218
-228
-138
-453
-30
-209
-64
-468
-76
-74
-342
-69
-230
-33
-368
-103
-296
-113
-216
-367
-344
-167
-274
-219
-239
-485
-116
-223
-256
-263
-70
-487
-480
-401
-288
-191
-5
-244
-438
-128
-467
-432
-202
-316
-229
-469
-463
-280
-2
-35
-283
-331
-235
-80
-44
-193
-321
-335
-104
-466
-366
-175
-403
-483
-53
-105
-257
-406
-409
-190
-406
-401
-114
-258
-90
-203
-262
-348
-424
-12
-396
-201
-217
-164
-431
-454
-478
-298
-125
-431
-164
-424
-187
-382
-5
-70
-397
-480
-291
-24
-351
-255
-104
-70
-163
-438
-119
-414
-200
-491
-237
-439
-360
-248
-479
-305
-417
-199
-444
-120
-429
-169
-443
-323
-325
-277
-230
-478
-178
-468
-310
-317
-333
-493
-460
-207
-249
-265
-480
-83
-136
-353
-172
-214
-462
-233
-406
-133
-175
-189
-454
-375
-401
-421
-407
-384
-256
-26
-134
-67
-384
-379
-18
-462
-492
-100
-298
-9
-341
-498
-146
-458
-362
-186
-285
-348
-167
-18
-273
-183
-281
-344
-97
-469
-315
-84
-28
-37
-448
-152
-348
-307
-194
-414
-477
-222
-126
-90
-169
-403
-400
-200
-97
diff --git a/ql/src/test/results/clientpositive/tez/tez_schema_evolution.q.out b/ql/src/test/results/clientpositive/tez/tez_schema_evolution.q.out
index 6316268b03..548035d4d2 100644
--- a/ql/src/test/results/clientpositive/tez/tez_schema_evolution.q.out
+++ b/ql/src/test/results/clientpositive/tez/tez_schema_evolution.q.out
@@ -1,16 +1,20 @@
-PREHOOK: query: create table test (key int, value string) partitioned by (p int) stored as textfile
+PREHOOK: query: -- SORT_QUERY_RESULTS
+
+create table test (key int, value string) partitioned by (p int) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@test
-POSTHOOK: query: create table test (key int, value string) partitioned by (p int) stored as textfile
+POSTHOOK: query: -- SORT_QUERY_RESULTS
+
+create table test (key int, value string) partitioned by (p int) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@test
-PREHOOK: query: insert into table test partition (p=1) select * from src limit 10
+PREHOOK: query: insert into table test partition (p=1) select * from src order by key limit 10
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
 PREHOOK: Output: default@test@p=1
-POSTHOOK: query: insert into table test partition (p=1) select * from src limit 10
+POSTHOOK: query: insert into table test partition (p=1) select * from src order by key limit 10
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 POSTHOOK: Output: default@test@p=1
@@ -24,11 +28,11 @@ POSTHOOK: query: alter table test set fileformat orc
 POSTHOOK: type: ALTERTABLE_FILEFORMAT
 POSTHOOK: Input: default@test
 POSTHOOK: Output: default@test
-PREHOOK: query: insert into table test partition (p=2) select * from src limit 10
+PREHOOK: query: insert into table test partition (p=2) select * from src order by key limit 10
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
 PREHOOK: Output: default@test@p=2
-POSTHOOK: query: insert into table test partition (p=2) select * from src limit 10
+POSTHOOK: query: insert into table test partition (p=2) select * from src order by key limit 10
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 POSTHOOK: Output: default@test@p=2
@@ -48,75 +52,63 @@ p                   	int
 # col_name            	data_type           	comment             
 	 	 
 p                   	int                 	                    
-PREHOOK: query: select * from test where p=1 and key > 0
+PREHOOK: query: select * from test where p=1 and key > 0 order by key
 PREHOOK: type: QUERY
 PREHOOK: Input: default@test
 PREHOOK: Input: default@test@p=1
 #### A masked pattern was here ####
-POSTHOOK: query: select * from test where p=1 and key > 0
+POSTHOOK: query: select * from test where p=1 and key > 0 order by key
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@test
 POSTHOOK: Input: default@test@p=1
 #### A masked pattern was here ####
-484	val_484	1
-98	val_98	1
-278	val_278	1
-255	val_255	1
-409	val_409	1
-165	val_165	1
-27	val_27	1
-311	val_311	1
-86	val_86	1
-238	val_238	1
-PREHOOK: query: select * from test where p=2 and key > 0
+10	val_10	1
+100	val_100	1
+100	val_100	1
+103	val_103	1
+103	val_103	1
+104	val_104	1
+104	val_104	1
+PREHOOK: query: select * from test where p=2 and key > 0 order by key
 PREHOOK: type: QUERY
 PREHOOK: Input: default@test
 PREHOOK: Input: default@test@p=2
 #### A masked pattern was here ####
-POSTHOOK: query: select * from test where p=2 and key > 0
+POSTHOOK: query: select * from test where p=2 and key > 0 order by key
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@test
 POSTHOOK: Input: default@test@p=2
 #### A masked pattern was here ####
-484	val_484	2
-98	val_98	2
-278	val_278	2
-255	val_255	2
-409	val_409	2
-165	val_165	2
-27	val_27	2
-311	val_311	2
-86	val_86	2
-238	val_238	2
-PREHOOK: query: select * from test where key > 0
+10	val_10	2
+100	val_100	2
+100	val_100	2
+103	val_103	2
+103	val_103	2
+104	val_104	2
+104	val_104	2
+PREHOOK: query: select * from test where key > 0 order by key
 PREHOOK: type: QUERY
 PREHOOK: Input: default@test
 PREHOOK: Input: default@test@p=1
 PREHOOK: Input: default@test@p=2
 #### A masked pattern was here ####
-POSTHOOK: query: select * from test where key > 0
+POSTHOOK: query: select * from test where key > 0 order by key
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@test
 POSTHOOK: Input: default@test@p=1
 POSTHOOK: Input: default@test@p=2
 #### A masked pattern was here ####
-484	val_484	1
-98	val_98	1
-278	val_278	1
-255	val_255	1
-409	val_409	1
-165	val_165	1
-27	val_27	1
-311	val_311	1
-86	val_86	1
-238	val_238	1
-484	val_484	2
-98	val_98	2
-278	val_278	2
-255	val_255	2
-409	val_409	2
-165	val_165	2
-27	val_27	2
-311	val_311	2
-86	val_86	2
-238	val_238	2
+10	val_10	1
+10	val_10	2
+100	val_100	1
+100	val_100	1
+100	val_100	2
+100	val_100	2
+103	val_103	1
+103	val_103	1
+103	val_103	2
+103	val_103	2
+104	val_104	1
+104	val_104	1
+104	val_104	2
+104	val_104	2
diff --git a/ql/src/test/results/clientpositive/tez/update_all_partitioned.q.out b/ql/src/test/results/clientpositive/tez/update_all_partitioned.q.out
index 286e2ed527..4ee1e2e4cf 100644
--- a/ql/src/test/results/clientpositive/tez/update_all_partitioned.q.out
+++ b/ql/src/test/results/clientpositive/tez/update_all_partitioned.q.out
@@ -6,21 +6,21 @@ POSTHOOK: query: create table acid_uap(a int, b varchar(128)) partitioned by (ds
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@acid_uap
-PREHOOK: query: insert into table acid_uap partition (ds='today') select cint, cast(cstring1 as varchar(128)) from alltypesorc where cint is not null and cint < 0 order by cint limit 10
+PREHOOK: query: insert into table acid_uap partition (ds='today') select cint, cast(cstring1 as varchar(128)) as cs from alltypesorc where cint is not null and cint < 0 order by cint, cs limit 10
 PREHOOK: type: QUERY
 PREHOOK: Input: default@alltypesorc
 PREHOOK: Output: default@acid_uap@ds=today
-POSTHOOK: query: insert into table acid_uap partition (ds='today') select cint, cast(cstring1 as varchar(128)) from alltypesorc where cint is not null and cint < 0 order by cint limit 10
+POSTHOOK: query: insert into table acid_uap partition (ds='today') select cint, cast(cstring1 as varchar(128)) as cs from alltypesorc where cint is not null and cint < 0 order by cint, cs limit 10
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc
 POSTHOOK: Output: default@acid_uap@ds=today
 POSTHOOK: Lineage: acid_uap PARTITION(ds=today).a SIMPLE [(alltypesorc)alltypesorc.FieldSchema(name:cint, type:int, comment:null), ]
 POSTHOOK: Lineage: acid_uap PARTITION(ds=today).b EXPRESSION [(alltypesorc)alltypesorc.FieldSchema(name:cstring1, type:string, comment:null), ]
-PREHOOK: query: insert into table acid_uap partition (ds='tomorrow') select cint, cast(cstring1 as varchar(128)) from alltypesorc where cint is not null and cint > 10 order by cint limit 10
+PREHOOK: query: insert into table acid_uap partition (ds='tomorrow') select cint, cast(cstring1 as varchar(128)) as cs from alltypesorc where cint is not null and cint > 10 order by cint, cs limit 10
 PREHOOK: type: QUERY
 PREHOOK: Input: default@alltypesorc
 PREHOOK: Output: default@acid_uap@ds=tomorrow
-POSTHOOK: query: insert into table acid_uap partition (ds='tomorrow') select cint, cast(cstring1 as varchar(128)) from alltypesorc where cint is not null and cint > 10 order by cint limit 10
+POSTHOOK: query: insert into table acid_uap partition (ds='tomorrow') select cint, cast(cstring1 as varchar(128)) as cs from alltypesorc where cint is not null and cint > 10 order by cint, cs limit 10
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc
 POSTHOOK: Output: default@acid_uap@ds=tomorrow
@@ -53,11 +53,11 @@ POSTHOOK: Input: default@acid_uap@ds=tomorrow
 762	BLoMwUJ51ns6pd	tomorrow
 762	a10E76jX35YwquKCTA	tomorrow
 762	q5y2Vy1	tomorrow
+6981	NULL	tomorrow
 6981	1FNNhmiFLGw425NA13g	tomorrow
+6981	4KhrrQ0nJ7bMNTvhSCA	tomorrow
 6981	K630vaVf	tomorrow
-6981	YdG61y00526u5	tomorrow
-6981	a3EhVU6Wuy7ycJ7wY7h2gv	tomorrow
-6981	o4lvY20511w0EOX3P3I82p63	tomorrow
+6981	Y5x3JuI3M8jngv5N	tomorrow
 PREHOOK: query: update acid_uap set b = 'fred'
 PREHOOK: type: QUERY
 PREHOOK: Input: default@acid_uap
diff --git a/ql/src/test/results/clientpositive/tez/update_where_partitioned.q.out b/ql/src/test/results/clientpositive/tez/update_where_partitioned.q.out
index fef0dc08f0..1834e837c1 100644
--- a/ql/src/test/results/clientpositive/tez/update_where_partitioned.q.out
+++ b/ql/src/test/results/clientpositive/tez/update_where_partitioned.q.out
@@ -6,21 +6,21 @@ POSTHOOK: query: create table acid_uwp(a int, b varchar(128)) partitioned by (ds
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@acid_uwp
-PREHOOK: query: insert into table acid_uwp partition (ds='today') select cint, cast(cstring1 as varchar(128)) from alltypesorc where cint is not null and cint < 0 order by cint limit 10
+PREHOOK: query: insert into table acid_uwp partition (ds='today') select cint, cast(cstring1 as varchar(128)) as cs from alltypesorc where cint is not null and cint < 0 order by cint, cs limit 10
 PREHOOK: type: QUERY
 PREHOOK: Input: default@alltypesorc
 PREHOOK: Output: default@acid_uwp@ds=today
-POSTHOOK: query: insert into table acid_uwp partition (ds='today') select cint, cast(cstring1 as varchar(128)) from alltypesorc where cint is not null and cint < 0 order by cint limit 10
+POSTHOOK: query: insert into table acid_uwp partition (ds='today') select cint, cast(cstring1 as varchar(128)) as cs from alltypesorc where cint is not null and cint < 0 order by cint, cs limit 10
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc
 POSTHOOK: Output: default@acid_uwp@ds=today
 POSTHOOK: Lineage: acid_uwp PARTITION(ds=today).a SIMPLE [(alltypesorc)alltypesorc.FieldSchema(name:cint, type:int, comment:null), ]
 POSTHOOK: Lineage: acid_uwp PARTITION(ds=today).b EXPRESSION [(alltypesorc)alltypesorc.FieldSchema(name:cstring1, type:string, comment:null), ]
-PREHOOK: query: insert into table acid_uwp partition (ds='tomorrow') select cint, cast(cstring1 as varchar(128)) from alltypesorc where cint is not null and cint > 100 order by cint limit 10
+PREHOOK: query: insert into table acid_uwp partition (ds='tomorrow') select cint, cast(cstring1 as varchar(128)) as cs from alltypesorc where cint is not null and cint > 100 order by cint, cs limit 10
 PREHOOK: type: QUERY
 PREHOOK: Input: default@alltypesorc
 PREHOOK: Output: default@acid_uwp@ds=tomorrow
-POSTHOOK: query: insert into table acid_uwp partition (ds='tomorrow') select cint, cast(cstring1 as varchar(128)) from alltypesorc where cint is not null and cint > 100 order by cint limit 10
+POSTHOOK: query: insert into table acid_uwp partition (ds='tomorrow') select cint, cast(cstring1 as varchar(128)) as cs from alltypesorc where cint is not null and cint > 100 order by cint, cs limit 10
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc
 POSTHOOK: Output: default@acid_uwp@ds=tomorrow
@@ -53,11 +53,11 @@ POSTHOOK: Input: default@acid_uwp@ds=tomorrow
 762	BLoMwUJ51ns6pd	tomorrow
 762	a10E76jX35YwquKCTA	tomorrow
 762	q5y2Vy1	tomorrow
+6981	NULL	tomorrow
 6981	1FNNhmiFLGw425NA13g	tomorrow
+6981	4KhrrQ0nJ7bMNTvhSCA	tomorrow
 6981	K630vaVf	tomorrow
-6981	YdG61y00526u5	tomorrow
-6981	a3EhVU6Wuy7ycJ7wY7h2gv	tomorrow
-6981	o4lvY20511w0EOX3P3I82p63	tomorrow
+6981	Y5x3JuI3M8jngv5N	tomorrow
 PREHOOK: query: update acid_uwp set b = 'fred' where b = 'k17Am8uPHWk02cEf1jet'
 PREHOOK: type: QUERY
 PREHOOK: Input: default@acid_uwp
@@ -99,8 +99,8 @@ POSTHOOK: Input: default@acid_uwp@ds=tomorrow
 762	BLoMwUJ51ns6pd	tomorrow
 762	a10E76jX35YwquKCTA	tomorrow
 762	q5y2Vy1	tomorrow
+6981	NULL	tomorrow
 6981	1FNNhmiFLGw425NA13g	tomorrow
+6981	4KhrrQ0nJ7bMNTvhSCA	tomorrow
 6981	K630vaVf	tomorrow
-6981	YdG61y00526u5	tomorrow
-6981	a3EhVU6Wuy7ycJ7wY7h2gv	tomorrow
-6981	o4lvY20511w0EOX3P3I82p63	tomorrow
+6981	Y5x3JuI3M8jngv5N	tomorrow
diff --git a/ql/src/test/results/clientpositive/tez/vector_data_types.q.out b/ql/src/test/results/clientpositive/tez/vector_data_types.q.out
index eca2cbc554..972404b7f2 100644
--- a/ql/src/test/results/clientpositive/tez/vector_data_types.q.out
+++ b/ql/src/test/results/clientpositive/tez/vector_data_types.q.out
@@ -97,9 +97,9 @@ POSTHOOK: Lineage: over1korc.s SIMPLE [(over1k)over1k.FieldSchema(name:s, type:s
 POSTHOOK: Lineage: over1korc.si SIMPLE [(over1k)over1k.FieldSchema(name:si, type:smallint, comment:null), ]
 POSTHOOK: Lineage: over1korc.t SIMPLE [(over1k)over1k.FieldSchema(name:t, type:tinyint, comment:null), ]
 POSTHOOK: Lineage: over1korc.ts SIMPLE [(over1k)over1k.FieldSchema(name:ts, type:timestamp, comment:null), ]
-PREHOOK: query: EXPLAIN SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY i LIMIT 20
+PREHOOK: query: EXPLAIN SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY t, si, i LIMIT 20
 PREHOOK: type: QUERY
-POSTHOOK: query: EXPLAIN SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY i LIMIT 20
+POSTHOOK: query: EXPLAIN SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY t, si, i LIMIT 20
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
@@ -122,14 +122,14 @@ STAGE PLANS:
                     outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
                     Statistics: Num rows: 1049 Data size: 311170 Basic stats: COMPLETE Column stats: NONE
                     Reduce Output Operator
-                      key expressions: _col2 (type: int)
-                      sort order: +
+                      key expressions: _col0 (type: tinyint), _col1 (type: smallint), _col2 (type: int)
+                      sort order: +++
                       Statistics: Num rows: 1049 Data size: 311170 Basic stats: COMPLETE Column stats: NONE
-                      value expressions: _col0 (type: tinyint), _col1 (type: smallint), _col3 (type: bigint), _col4 (type: float), _col5 (type: double), _col6 (type: boolean), _col7 (type: string), _col8 (type: timestamp), _col9 (type: decimal(4,2)), _col10 (type: binary)
+                      value expressions: _col3 (type: bigint), _col4 (type: float), _col5 (type: double), _col6 (type: boolean), _col7 (type: string), _col8 (type: timestamp), _col9 (type: decimal(4,2)), _col10 (type: binary)
         Reducer 2 
             Reduce Operator Tree:
               Select Operator
-                expressions: VALUE._col0 (type: tinyint), VALUE._col1 (type: smallint), KEY.reducesinkkey0 (type: int), VALUE._col2 (type: bigint), VALUE._col3 (type: float), VALUE._col4 (type: double), VALUE._col5 (type: boolean), VALUE._col6 (type: string), VALUE._col7 (type: timestamp), VALUE._col8 (type: decimal(4,2)), VALUE._col9 (type: binary)
+                expressions: KEY.reducesinkkey0 (type: tinyint), KEY.reducesinkkey1 (type: smallint), KEY.reducesinkkey2 (type: int), VALUE._col0 (type: bigint), VALUE._col1 (type: float), VALUE._col2 (type: double), VALUE._col3 (type: boolean), VALUE._col4 (type: string), VALUE._col5 (type: timestamp), VALUE._col6 (type: decimal(4,2)), VALUE._col7 (type: binary)
                 outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
                 Statistics: Num rows: 1049 Data size: 311170 Basic stats: COMPLETE Column stats: NONE
                 Limit
@@ -149,48 +149,48 @@ STAGE PLANS:
       Processor Tree:
         ListSink
 
-PREHOOK: query: SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY i LIMIT 20
+PREHOOK: query: SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY t, si, i LIMIT 20
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over1korc
 #### A masked pattern was here ####
-POSTHOOK: query: SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY i LIMIT 20
+POSTHOOK: query: SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY t, si, i LIMIT 20
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1korc
 #### A masked pattern was here ####
-108	301	65536	4294967357	90.05	17.59	true	ethan johnson	2013-03-01 09:11:58.703271	75.7	undecided
-118	497	65536	4294967381	50.32	12.72	false	david nixon	2013-03-01 09:11:58.703285	83.48	values clariffication
-18	280	65536	4294967320	32.92	45.94	false	holly white	2013-03-01 09:11:58.703086	58.86	topology
-69	489	65536	4294967404	33.52	17.99	false	oscar ichabod	2013-03-01 09:11:58.703247	32.68	topology
-27	405	65536	4294967508	82.24	29.41	true	oscar ovid	2013-03-01 09:11:58.703166	16.85	biology
-42	495	65536	4294967431	43.57	46.81	false	tom johnson	2013-03-01 09:11:58.703245	62.25	american history
+NULL	374	65560	4294967516	65.43	22.48	true	oscar quirinius	2013-03-01 09:11:58.703316	16.86	mathematics
 NULL	409	65536	4294967490	46.97	25.92	false	fred miller	2013-03-01 09:11:58.703116	33.45	history
-59	431	65537	4294967326	11.34	2.9	true	oscar robinson	2013-03-01 09:11:58.703161	81.04	zync studies
-63	458	65537	4294967463	21.94	49.71	true	fred van buren	2013-03-01 09:11:58.703278	99.34	wind surfing
-121	355	65537	4294967437	85.9	10.99	true	calvin brown	2013-03-01 09:11:58.703254	4.49	yard duty
-72	267	65537	4294967460	55.2	42.89	false	oscar carson	2013-03-01 09:11:58.703153	51.91	topology
-22	264	65537	4294967419	8.07	10.71	false	david xylophone	2013-03-01 09:11:58.703136	11.87	undecided
-101	283	65538	4294967527	84.03	27.29	true	yuri brown	2013-03-01 09:11:58.703306	44.24	biology
-109	376	65538	4294967453	59.61	35.62	true	priscilla xylophone	2013-03-01 09:11:58.703286	9.53	study skills
-83	353	65538	4294967339	0.08	23.91	true	holly thompson	2013-03-01 09:11:58.703157	30.27	quiet hour
-29	331	65539	4294967420	73.18	28.96	true	ethan brown	2013-03-01 09:11:58.703094	58.85	zync studies
-70	430	65539	4294967534	18.89	43.84	true	tom carson	2013-03-01 09:11:58.703182	21.93	joggying
-120	331	65539	4294967324	88.02	40.94	true	holly nixon	2013-03-01 09:11:58.703262	96.64	yard duty
-71	298	65540	4294967510	91.63	9.6	false	gabriella zipper	2013-03-01 09:11:58.70314	68.14	geology
-114	385	65541	4294967458	73.48	34.97	true	oscar quirinius	2013-03-01 09:11:58.703143	72.33	xylophone band
+NULL	473	65720	4294967324	80.74	40.6	false	holly falkner	2013-03-01 09:11:58.703111	18.8	mathematics
+-3	275	65622	4294967302	71.78	8.49	false	wendy robinson	2013-03-01 09:11:58.703294	95.39	undecided
+-3	344	65733	4294967363	0.56	11.96	true	rachel thompson	2013-03-01 09:11:58.703276	88.46	wind surfing
+-3	376	65548	4294967431	96.78	43.23	false	fred ellison	2013-03-01 09:11:58.703233	75.39	education
+-3	438	65618	4294967398	62.39	4.62	false	victor xylophone	2013-03-01 09:11:58.703135	88.38	values clariffication
+-3	458	65696	4294967418	45.24	8.49	false	irene ellison	2013-03-01 09:11:58.703092	54.02	american history
+-3	467	65575	4294967437	81.64	23.53	true	tom hernandez	2013-03-01 09:11:58.703188	32.85	study skills
+-2	261	65603	4294967332	39.18	28.98	false	fred polk	2013-03-01 09:11:58.70331	69.26	opthamology
+-2	269	65681	4294967544	99.24	28.19	false	rachel falkner	2013-03-01 09:11:58.703089	41.57	quiet hour
+-2	288	65658	4294967383	53.78	19.92	false	holly nixon	2013-03-01 09:11:58.703224	42.93	industrial engineering
+-2	304	65629	4294967386	84.38	33.49	false	zach garcia	2013-03-01 09:11:58.703264	56.99	chemistry
+-2	340	65627	4294967533	76.52	21.91	true	quinn laertes	2013-03-01 09:11:58.703178	93.29	xylophone band
+-2	427	65666	4294967465	19.69	33.24	true	bob xylophone	2013-03-01 09:11:58.703219	32.73	joggying
+-2	429	65664	4294967441	45.19	40.43	false	wendy king	2013-03-01 09:11:58.703265	11.46	industrial engineering
+-2	461	65648	4294967425	58.52	24.85	false	rachel thompson	2013-03-01 09:11:58.703318	85.62	zync studies
+-1	268	65778	4294967418	56.33	44.73	true	calvin falkner	2013-03-01 09:11:58.70322	7.37	history
+-1	281	65643	4294967323	15.1	45.0	false	irene nixon	2013-03-01 09:11:58.703223	80.96	undecided
+-1	300	65663	4294967343	71.26	34.62	true	calvin ovid	2013-03-01 09:11:58.703262	78.56	study skills
 PREHOOK: query: SELECT SUM(HASH(*))
-FROM (SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY i) as q
+FROM (SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY t, si, i) as q
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over1korc
 #### A masked pattern was here ####
 POSTHOOK: query: SELECT SUM(HASH(*))
-FROM (SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY i) as q
+FROM (SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY t, si, i) as q
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1korc
 #### A masked pattern was here ####
 -17045922556
-PREHOOK: query: EXPLAIN select t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY i LIMIT 20
+PREHOOK: query: EXPLAIN select t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY t, si, i LIMIT 20
 PREHOOK: type: QUERY
-POSTHOOK: query: EXPLAIN select t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY i LIMIT 20
+POSTHOOK: query: EXPLAIN select t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY t, si, i LIMIT 20
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
@@ -213,15 +213,15 @@ STAGE PLANS:
                     outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
                     Statistics: Num rows: 1049 Data size: 311170 Basic stats: COMPLETE Column stats: NONE
                     Reduce Output Operator
-                      key expressions: _col2 (type: int)
-                      sort order: +
+                      key expressions: _col0 (type: tinyint), _col1 (type: smallint), _col2 (type: int)
+                      sort order: +++
                       Statistics: Num rows: 1049 Data size: 311170 Basic stats: COMPLETE Column stats: NONE
-                      value expressions: _col0 (type: tinyint), _col1 (type: smallint), _col3 (type: bigint), _col4 (type: float), _col5 (type: double), _col6 (type: boolean), _col7 (type: string), _col8 (type: timestamp), _col9 (type: decimal(4,2)), _col10 (type: binary)
+                      value expressions: _col3 (type: bigint), _col4 (type: float), _col5 (type: double), _col6 (type: boolean), _col7 (type: string), _col8 (type: timestamp), _col9 (type: decimal(4,2)), _col10 (type: binary)
             Execution mode: vectorized
         Reducer 2 
             Reduce Operator Tree:
               Select Operator
-                expressions: VALUE._col0 (type: tinyint), VALUE._col1 (type: smallint), KEY.reducesinkkey0 (type: int), VALUE._col2 (type: bigint), VALUE._col3 (type: float), VALUE._col4 (type: double), VALUE._col5 (type: boolean), VALUE._col6 (type: string), VALUE._col7 (type: timestamp), VALUE._col8 (type: decimal(4,2)), VALUE._col9 (type: binary)
+                expressions: KEY.reducesinkkey0 (type: tinyint), KEY.reducesinkkey1 (type: smallint), KEY.reducesinkkey2 (type: int), VALUE._col0 (type: bigint), VALUE._col1 (type: float), VALUE._col2 (type: double), VALUE._col3 (type: boolean), VALUE._col4 (type: string), VALUE._col5 (type: timestamp), VALUE._col6 (type: decimal(4,2)), VALUE._col7 (type: binary)
                 outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
                 Statistics: Num rows: 1049 Data size: 311170 Basic stats: COMPLETE Column stats: NONE
                 Limit
@@ -242,41 +242,41 @@ STAGE PLANS:
       Processor Tree:
         ListSink
 
-PREHOOK: query: SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY i LIMIT 20
+PREHOOK: query: SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY t, si, i LIMIT 20
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over1korc
 #### A masked pattern was here ####
-POSTHOOK: query: SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY i LIMIT 20
+POSTHOOK: query: SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY t, si, i LIMIT 20
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1korc
 #### A masked pattern was here ####
-108	301	65536	4294967357	90.05	17.59	true	ethan johnson	2013-03-01 09:11:58.703271	75.7	undecided
-118	497	65536	4294967381	50.32	12.72	false	david nixon	2013-03-01 09:11:58.703285	83.48	values clariffication
-18	280	65536	4294967320	32.92	45.94	false	holly white	2013-03-01 09:11:58.703086	58.86	topology
-69	489	65536	4294967404	33.52	17.99	false	oscar ichabod	2013-03-01 09:11:58.703247	32.68	topology
-27	405	65536	4294967508	82.24	29.41	true	oscar ovid	2013-03-01 09:11:58.703166	16.85	biology
-42	495	65536	4294967431	43.57	46.81	false	tom johnson	2013-03-01 09:11:58.703245	62.25	american history
+NULL	374	65560	4294967516	65.43	22.48	true	oscar quirinius	2013-03-01 09:11:58.703316	16.86	mathematics
 NULL	409	65536	4294967490	46.97	25.92	false	fred miller	2013-03-01 09:11:58.703116	33.45	history
-59	431	65537	4294967326	11.34	2.9	true	oscar robinson	2013-03-01 09:11:58.703161	81.04	zync studies
-63	458	65537	4294967463	21.94	49.71	true	fred van buren	2013-03-01 09:11:58.703278	99.34	wind surfing
-121	355	65537	4294967437	85.9	10.99	true	calvin brown	2013-03-01 09:11:58.703254	4.49	yard duty
-72	267	65537	4294967460	55.2	42.89	false	oscar carson	2013-03-01 09:11:58.703153	51.91	topology
-22	264	65537	4294967419	8.07	10.71	false	david xylophone	2013-03-01 09:11:58.703136	11.87	undecided
-101	283	65538	4294967527	84.03	27.29	true	yuri brown	2013-03-01 09:11:58.703306	44.24	biology
-109	376	65538	4294967453	59.61	35.62	true	priscilla xylophone	2013-03-01 09:11:58.703286	9.53	study skills
-83	353	65538	4294967339	0.08	23.91	true	holly thompson	2013-03-01 09:11:58.703157	30.27	quiet hour
-29	331	65539	4294967420	73.18	28.96	true	ethan brown	2013-03-01 09:11:58.703094	58.85	zync studies
-70	430	65539	4294967534	18.89	43.84	true	tom carson	2013-03-01 09:11:58.703182	21.93	joggying
-120	331	65539	4294967324	88.02	40.94	true	holly nixon	2013-03-01 09:11:58.703262	96.64	yard duty
-71	298	65540	4294967510	91.63	9.6	false	gabriella zipper	2013-03-01 09:11:58.70314	68.14	geology
-114	385	65541	4294967458	73.48	34.97	true	oscar quirinius	2013-03-01 09:11:58.703143	72.33	xylophone band
+NULL	473	65720	4294967324	80.74	40.6	false	holly falkner	2013-03-01 09:11:58.703111	18.8	mathematics
+-3	275	65622	4294967302	71.78	8.49	false	wendy robinson	2013-03-01 09:11:58.703294	95.39	undecided
+-3	344	65733	4294967363	0.56	11.96	true	rachel thompson	2013-03-01 09:11:58.703276	88.46	wind surfing
+-3	376	65548	4294967431	96.78	43.23	false	fred ellison	2013-03-01 09:11:58.703233	75.39	education
+-3	438	65618	4294967398	62.39	4.62	false	victor xylophone	2013-03-01 09:11:58.703135	88.38	values clariffication
+-3	458	65696	4294967418	45.24	8.49	false	irene ellison	2013-03-01 09:11:58.703092	54.02	american history
+-3	467	65575	4294967437	81.64	23.53	true	tom hernandez	2013-03-01 09:11:58.703188	32.85	study skills
+-2	261	65603	4294967332	39.18	28.98	false	fred polk	2013-03-01 09:11:58.70331	69.26	opthamology
+-2	269	65681	4294967544	99.24	28.19	false	rachel falkner	2013-03-01 09:11:58.703089	41.57	quiet hour
+-2	288	65658	4294967383	53.78	19.92	false	holly nixon	2013-03-01 09:11:58.703224	42.93	industrial engineering
+-2	304	65629	4294967386	84.38	33.49	false	zach garcia	2013-03-01 09:11:58.703264	56.99	chemistry
+-2	340	65627	4294967533	76.52	21.91	true	quinn laertes	2013-03-01 09:11:58.703178	93.29	xylophone band
+-2	427	65666	4294967465	19.69	33.24	true	bob xylophone	2013-03-01 09:11:58.703219	32.73	joggying
+-2	429	65664	4294967441	45.19	40.43	false	wendy king	2013-03-01 09:11:58.703265	11.46	industrial engineering
+-2	461	65648	4294967425	58.52	24.85	false	rachel thompson	2013-03-01 09:11:58.703318	85.62	zync studies
+-1	268	65778	4294967418	56.33	44.73	true	calvin falkner	2013-03-01 09:11:58.70322	7.37	history
+-1	281	65643	4294967323	15.1	45.0	false	irene nixon	2013-03-01 09:11:58.703223	80.96	undecided
+-1	300	65663	4294967343	71.26	34.62	true	calvin ovid	2013-03-01 09:11:58.703262	78.56	study skills
 PREHOOK: query: SELECT SUM(HASH(*))
-FROM (SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY i) as q
+FROM (SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY t, si, i) as q
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over1korc
 #### A masked pattern was here ####
 POSTHOOK: query: SELECT SUM(HASH(*))
-FROM (SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY i) as q
+FROM (SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY t, si, i) as q
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1korc
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/tez/vector_null_projection.q.out b/ql/src/test/results/clientpositive/tez/vector_null_projection.q.out
index 6af333d71c..88587e947d 100644
--- a/ql/src/test/results/clientpositive/tez/vector_null_projection.q.out
+++ b/ql/src/test/results/clientpositive/tez/vector_null_projection.q.out
@@ -1,8 +1,12 @@
-PREHOOK: query: create table a(s string) stored as orc
+PREHOOK: query: -- SORT_QUERY_RESULTS
+
+create table a(s string) stored as orc
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@a
-POSTHOOK: query: create table a(s string) stored as orc
+POSTHOOK: query: -- SORT_QUERY_RESULTS
+
+create table a(s string) stored as orc
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@a
diff --git a/ql/src/test/results/clientpositive/tez/vector_outer_join1.q.out b/ql/src/test/results/clientpositive/tez/vector_outer_join1.q.out
index 4955f49f06..a2f4458d01 100644
--- a/ql/src/test/results/clientpositive/tez/vector_outer_join1.q.out
+++ b/ql/src/test/results/clientpositive/tez/vector_outer_join1.q.out
@@ -1,39 +1,39 @@
-PREHOOK: query: create table small_alltypesorc1a as select * from alltypesorc where cint is not null and ctinyint is not null limit 5
+PREHOOK: query: create table small_alltypesorc1a as select * from alltypesorc where cint is not null and ctinyint is not null order by cint, ctinyint limit 5
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@alltypesorc
 PREHOOK: Output: database:default
 PREHOOK: Output: default@small_alltypesorc1a
-POSTHOOK: query: create table small_alltypesorc1a as select * from alltypesorc where cint is not null and ctinyint is not null limit 5
+POSTHOOK: query: create table small_alltypesorc1a as select * from alltypesorc where cint is not null and ctinyint is not null order by cint, ctinyint limit 5
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@alltypesorc
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@small_alltypesorc1a
-PREHOOK: query: create table small_alltypesorc2a as select * from alltypesorc where cint is null and ctinyint is not null limit 5
+PREHOOK: query: create table small_alltypesorc2a as select * from alltypesorc where cint is null and ctinyint is not null order by cint, ctinyint limit 5
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@alltypesorc
 PREHOOK: Output: database:default
 PREHOOK: Output: default@small_alltypesorc2a
-POSTHOOK: query: create table small_alltypesorc2a as select * from alltypesorc where cint is null and ctinyint is not null limit 5
+POSTHOOK: query: create table small_alltypesorc2a as select * from alltypesorc where cint is null and ctinyint is not null order by cint, ctinyint limit 5
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@alltypesorc
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@small_alltypesorc2a
-PREHOOK: query: create table small_alltypesorc3a as select * from alltypesorc where cint is not null and ctinyint is null limit 5
+PREHOOK: query: create table small_alltypesorc3a as select * from alltypesorc where cint is not null and ctinyint is null order by cint, ctinyint limit 5
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@alltypesorc
 PREHOOK: Output: database:default
 PREHOOK: Output: default@small_alltypesorc3a
-POSTHOOK: query: create table small_alltypesorc3a as select * from alltypesorc where cint is not null and ctinyint is null limit 5
+POSTHOOK: query: create table small_alltypesorc3a as select * from alltypesorc where cint is not null and ctinyint is null order by cint, ctinyint limit 5
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@alltypesorc
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@small_alltypesorc3a
-PREHOOK: query: create table small_alltypesorc4a as select * from alltypesorc where cint is null and ctinyint is null limit 5
+PREHOOK: query: create table small_alltypesorc4a as select * from alltypesorc where cint is null and ctinyint is null order by cint, ctinyint limit 5
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@alltypesorc
 PREHOOK: Output: database:default
 PREHOOK: Output: default@small_alltypesorc4a
-POSTHOOK: query: create table small_alltypesorc4a as select * from alltypesorc where cint is null and ctinyint is null limit 5
+POSTHOOK: query: create table small_alltypesorc4a as select * from alltypesorc where cint is null and ctinyint is null order by cint, ctinyint limit 5
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@alltypesorc
 POSTHOOK: Output: database:default
@@ -111,11 +111,11 @@ STAGE PLANS:
             Map Operator Tree:
                 TableScan
                   alias: c
-                  Statistics: Num rows: 11 Data size: 3667 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 13 Data size: 4183 Basic stats: COMPLETE Column stats: NONE
                   Select Operator
                     expressions: ctinyint (type: tinyint), csmallint (type: smallint), cint (type: int), cbigint (type: bigint), cfloat (type: float), cdouble (type: double), cstring1 (type: string), cstring2 (type: string), ctimestamp1 (type: timestamp), ctimestamp2 (type: timestamp), cboolean1 (type: boolean), cboolean2 (type: boolean)
                     outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11
-                    Statistics: Num rows: 11 Data size: 3667 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 13 Data size: 4183 Basic stats: COMPLETE Column stats: NONE
                     Map Join Operator
                       condition map:
                            Left Outer Join0 to 1
@@ -125,11 +125,11 @@ STAGE PLANS:
                       outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21, _col22, _col23
                       input vertices:
                         1 Map 2
-                      Statistics: Num rows: 12 Data size: 4033 Basic stats: COMPLETE Column stats: NONE
+                      Statistics: Num rows: 14 Data size: 4601 Basic stats: COMPLETE Column stats: NONE
                       HybridGraceHashJoin: true
                       File Output Operator
                         compressed: false
-                        Statistics: Num rows: 12 Data size: 4033 Basic stats: COMPLETE Column stats: NONE
+                        Statistics: Num rows: 14 Data size: 4601 Basic stats: COMPLETE Column stats: NONE
                         table:
                             input format: org.apache.hadoop.mapred.TextInputFormat
                             output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -139,16 +139,16 @@ STAGE PLANS:
             Map Operator Tree:
                 TableScan
                   alias: c
-                  Statistics: Num rows: 11 Data size: 3667 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 13 Data size: 4183 Basic stats: COMPLETE Column stats: NONE
                   Select Operator
                     expressions: ctinyint (type: tinyint), csmallint (type: smallint), cint (type: int), cbigint (type: bigint), cfloat (type: float), cdouble (type: double), cstring1 (type: string), cstring2 (type: string), ctimestamp1 (type: timestamp), ctimestamp2 (type: timestamp), cboolean1 (type: boolean), cboolean2 (type: boolean)
                     outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11
-                    Statistics: Num rows: 11 Data size: 3667 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 13 Data size: 4183 Basic stats: COMPLETE Column stats: NONE
                     Reduce Output Operator
                       key expressions: _col2 (type: int)
                       sort order: +
                       Map-reduce partition columns: _col2 (type: int)
-                      Statistics: Num rows: 11 Data size: 3667 Basic stats: COMPLETE Column stats: NONE
+                      Statistics: Num rows: 13 Data size: 4183 Basic stats: COMPLETE Column stats: NONE
                       value expressions: _col0 (type: tinyint), _col1 (type: smallint), _col3 (type: bigint), _col4 (type: float), _col5 (type: double), _col6 (type: string), _col7 (type: string), _col8 (type: timestamp), _col9 (type: timestamp), _col10 (type: boolean), _col11 (type: boolean)
             Execution mode: vectorized
 
@@ -176,111 +176,21 @@ left outer join small_alltypesorc_a cd
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@small_alltypesorc_a
 #### A masked pattern was here ####
--21	-200	NULL	NULL	-21.0	-200.0	NULL	NULL	1969-12-31 16:00:09.052	1969-12-31 15:59:55.451	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
--28	-15813	528534767	NULL	-28.0	-15813.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:55.787	1969-12-31 16:00:01.546	true	NULL	-28	-15813	528534767	NULL	-28.0	-15813.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:55.787	1969-12-31 16:00:01.546	true	NULL
--28	-15813	528534767	NULL	-28.0	-15813.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:55.787	1969-12-31 16:00:01.546	true	NULL	-34	15007	528534767	NULL	-34.0	15007.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:50.434	1969-12-31 16:00:13.352	true	NULL
--28	-15813	528534767	NULL	-28.0	-15813.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:55.787	1969-12-31 16:00:01.546	true	NULL	-50	-13326	528534767	NULL	-50.0	-13326.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:46.674	1969-12-31 16:00:08.875	true	NULL
--28	-15813	528534767	NULL	-28.0	-15813.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:55.787	1969-12-31 16:00:01.546	true	NULL	29	7021	528534767	NULL	29.0	7021.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 16:00:15.007	1969-12-31 16:00:15.148	true	NULL
--28	-15813	528534767	NULL	-28.0	-15813.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:55.787	1969-12-31 16:00:01.546	true	NULL	31	-9566	528534767	NULL	31.0	-9566.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:44.187	1969-12-31 16:00:06.961	true	NULL
--28	-15813	528534767	NULL	-28.0	-15813.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:55.787	1969-12-31 16:00:01.546	true	NULL	NULL	-11534	528534767	NULL	NULL	-11534.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 15:59:55.407	true	NULL
--28	-15813	528534767	NULL	-28.0	-15813.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:55.787	1969-12-31 16:00:01.546	true	NULL	NULL	-3012	528534767	NULL	NULL	-3012.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:03.756	true	NULL
--28	-15813	528534767	NULL	-28.0	-15813.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:55.787	1969-12-31 16:00:01.546	true	NULL	NULL	-4016	528534767	NULL	NULL	-4016.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:07.209	true	NULL
--28	-15813	528534767	NULL	-28.0	-15813.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:55.787	1969-12-31 16:00:01.546	true	NULL	NULL	-4213	528534767	NULL	NULL	-4213.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.589	true	NULL
--28	-15813	528534767	NULL	-28.0	-15813.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:55.787	1969-12-31 16:00:01.546	true	NULL	NULL	-6147	528534767	NULL	NULL	-6147.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.839	true	NULL
--34	15007	528534767	NULL	-34.0	15007.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:50.434	1969-12-31 16:00:13.352	true	NULL	-28	-15813	528534767	NULL	-28.0	-15813.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:55.787	1969-12-31 16:00:01.546	true	NULL
--34	15007	528534767	NULL	-34.0	15007.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:50.434	1969-12-31 16:00:13.352	true	NULL	-34	15007	528534767	NULL	-34.0	15007.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:50.434	1969-12-31 16:00:13.352	true	NULL
--34	15007	528534767	NULL	-34.0	15007.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:50.434	1969-12-31 16:00:13.352	true	NULL	-50	-13326	528534767	NULL	-50.0	-13326.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:46.674	1969-12-31 16:00:08.875	true	NULL
--34	15007	528534767	NULL	-34.0	15007.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:50.434	1969-12-31 16:00:13.352	true	NULL	29	7021	528534767	NULL	29.0	7021.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 16:00:15.007	1969-12-31 16:00:15.148	true	NULL
--34	15007	528534767	NULL	-34.0	15007.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:50.434	1969-12-31 16:00:13.352	true	NULL	31	-9566	528534767	NULL	31.0	-9566.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:44.187	1969-12-31 16:00:06.961	true	NULL
--34	15007	528534767	NULL	-34.0	15007.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:50.434	1969-12-31 16:00:13.352	true	NULL	NULL	-11534	528534767	NULL	NULL	-11534.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 15:59:55.407	true	NULL
--34	15007	528534767	NULL	-34.0	15007.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:50.434	1969-12-31 16:00:13.352	true	NULL	NULL	-3012	528534767	NULL	NULL	-3012.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:03.756	true	NULL
--34	15007	528534767	NULL	-34.0	15007.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:50.434	1969-12-31 16:00:13.352	true	NULL	NULL	-4016	528534767	NULL	NULL	-4016.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:07.209	true	NULL
--34	15007	528534767	NULL	-34.0	15007.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:50.434	1969-12-31 16:00:13.352	true	NULL	NULL	-4213	528534767	NULL	NULL	-4213.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.589	true	NULL
--34	15007	528534767	NULL	-34.0	15007.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:50.434	1969-12-31 16:00:13.352	true	NULL	NULL	-6147	528534767	NULL	NULL	-6147.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.839	true	NULL
--50	-13326	528534767	NULL	-50.0	-13326.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:46.674	1969-12-31 16:00:08.875	true	NULL	-28	-15813	528534767	NULL	-28.0	-15813.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:55.787	1969-12-31 16:00:01.546	true	NULL
--50	-13326	528534767	NULL	-50.0	-13326.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:46.674	1969-12-31 16:00:08.875	true	NULL	-34	15007	528534767	NULL	-34.0	15007.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:50.434	1969-12-31 16:00:13.352	true	NULL
--50	-13326	528534767	NULL	-50.0	-13326.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:46.674	1969-12-31 16:00:08.875	true	NULL	-50	-13326	528534767	NULL	-50.0	-13326.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:46.674	1969-12-31 16:00:08.875	true	NULL
--50	-13326	528534767	NULL	-50.0	-13326.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:46.674	1969-12-31 16:00:08.875	true	NULL	29	7021	528534767	NULL	29.0	7021.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 16:00:15.007	1969-12-31 16:00:15.148	true	NULL
--50	-13326	528534767	NULL	-50.0	-13326.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:46.674	1969-12-31 16:00:08.875	true	NULL	31	-9566	528534767	NULL	31.0	-9566.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:44.187	1969-12-31 16:00:06.961	true	NULL
--50	-13326	528534767	NULL	-50.0	-13326.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:46.674	1969-12-31 16:00:08.875	true	NULL	NULL	-11534	528534767	NULL	NULL	-11534.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 15:59:55.407	true	NULL
--50	-13326	528534767	NULL	-50.0	-13326.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:46.674	1969-12-31 16:00:08.875	true	NULL	NULL	-3012	528534767	NULL	NULL	-3012.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:03.756	true	NULL
--50	-13326	528534767	NULL	-50.0	-13326.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:46.674	1969-12-31 16:00:08.875	true	NULL	NULL	-4016	528534767	NULL	NULL	-4016.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:07.209	true	NULL
--50	-13326	528534767	NULL	-50.0	-13326.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:46.674	1969-12-31 16:00:08.875	true	NULL	NULL	-4213	528534767	NULL	NULL	-4213.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.589	true	NULL
--50	-13326	528534767	NULL	-50.0	-13326.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:46.674	1969-12-31 16:00:08.875	true	NULL	NULL	-6147	528534767	NULL	NULL	-6147.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.839	true	NULL
-29	7021	528534767	NULL	29.0	7021.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 16:00:15.007	1969-12-31 16:00:15.148	true	NULL	-28	-15813	528534767	NULL	-28.0	-15813.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:55.787	1969-12-31 16:00:01.546	true	NULL
-29	7021	528534767	NULL	29.0	7021.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 16:00:15.007	1969-12-31 16:00:15.148	true	NULL	-34	15007	528534767	NULL	-34.0	15007.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:50.434	1969-12-31 16:00:13.352	true	NULL
-29	7021	528534767	NULL	29.0	7021.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 16:00:15.007	1969-12-31 16:00:15.148	true	NULL	-50	-13326	528534767	NULL	-50.0	-13326.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:46.674	1969-12-31 16:00:08.875	true	NULL
-29	7021	528534767	NULL	29.0	7021.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 16:00:15.007	1969-12-31 16:00:15.148	true	NULL	29	7021	528534767	NULL	29.0	7021.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 16:00:15.007	1969-12-31 16:00:15.148	true	NULL
-29	7021	528534767	NULL	29.0	7021.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 16:00:15.007	1969-12-31 16:00:15.148	true	NULL	31	-9566	528534767	NULL	31.0	-9566.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:44.187	1969-12-31 16:00:06.961	true	NULL
-29	7021	528534767	NULL	29.0	7021.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 16:00:15.007	1969-12-31 16:00:15.148	true	NULL	NULL	-11534	528534767	NULL	NULL	-11534.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 15:59:55.407	true	NULL
-29	7021	528534767	NULL	29.0	7021.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 16:00:15.007	1969-12-31 16:00:15.148	true	NULL	NULL	-3012	528534767	NULL	NULL	-3012.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:03.756	true	NULL
-29	7021	528534767	NULL	29.0	7021.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 16:00:15.007	1969-12-31 16:00:15.148	true	NULL	NULL	-4016	528534767	NULL	NULL	-4016.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:07.209	true	NULL
-29	7021	528534767	NULL	29.0	7021.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 16:00:15.007	1969-12-31 16:00:15.148	true	NULL	NULL	-4213	528534767	NULL	NULL	-4213.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.589	true	NULL
-29	7021	528534767	NULL	29.0	7021.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 16:00:15.007	1969-12-31 16:00:15.148	true	NULL	NULL	-6147	528534767	NULL	NULL	-6147.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.839	true	NULL
-3	-200	NULL	-1438142492	3.0	-200.0	NULL	T8Uakh8tudd1XRG5yKW8Y42H	1969-12-31 16:00:07.648	1969-12-31 15:59:55.451	NULL	true	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
-31	-200	NULL	-245476731	31.0	-200.0	NULL	3E3BxP	1969-12-31 15:59:54.739	1969-12-31 15:59:55.451	NULL	true	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
-31	-9566	528534767	NULL	31.0	-9566.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:44.187	1969-12-31 16:00:06.961	true	NULL	-28	-15813	528534767	NULL	-28.0	-15813.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:55.787	1969-12-31 16:00:01.546	true	NULL
-31	-9566	528534767	NULL	31.0	-9566.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:44.187	1969-12-31 16:00:06.961	true	NULL	-34	15007	528534767	NULL	-34.0	15007.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:50.434	1969-12-31 16:00:13.352	true	NULL
-31	-9566	528534767	NULL	31.0	-9566.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:44.187	1969-12-31 16:00:06.961	true	NULL	-50	-13326	528534767	NULL	-50.0	-13326.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:46.674	1969-12-31 16:00:08.875	true	NULL
-31	-9566	528534767	NULL	31.0	-9566.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:44.187	1969-12-31 16:00:06.961	true	NULL	29	7021	528534767	NULL	29.0	7021.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 16:00:15.007	1969-12-31 16:00:15.148	true	NULL
-31	-9566	528534767	NULL	31.0	-9566.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:44.187	1969-12-31 16:00:06.961	true	NULL	31	-9566	528534767	NULL	31.0	-9566.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:44.187	1969-12-31 16:00:06.961	true	NULL
-31	-9566	528534767	NULL	31.0	-9566.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:44.187	1969-12-31 16:00:06.961	true	NULL	NULL	-11534	528534767	NULL	NULL	-11534.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 15:59:55.407	true	NULL
-31	-9566	528534767	NULL	31.0	-9566.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:44.187	1969-12-31 16:00:06.961	true	NULL	NULL	-3012	528534767	NULL	NULL	-3012.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:03.756	true	NULL
-31	-9566	528534767	NULL	31.0	-9566.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:44.187	1969-12-31 16:00:06.961	true	NULL	NULL	-4016	528534767	NULL	NULL	-4016.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:07.209	true	NULL
-31	-9566	528534767	NULL	31.0	-9566.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:44.187	1969-12-31 16:00:06.961	true	NULL	NULL	-4213	528534767	NULL	NULL	-4213.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.589	true	NULL
-31	-9566	528534767	NULL	31.0	-9566.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:44.187	1969-12-31 16:00:06.961	true	NULL	NULL	-6147	528534767	NULL	NULL	-6147.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.839	true	NULL
-38	-200	NULL	-1090414113	38.0	-200.0	NULL	5oQ43l	1969-12-31 16:00:05.478	1969-12-31 15:59:55.451	NULL	false	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
-38	-200	NULL	1576772382	38.0	-200.0	NULL	X3Ufbt46AUIfHe	1969-12-31 15:59:49.567	1969-12-31 15:59:55.451	NULL	true	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
-NULL	-11534	528534767	NULL	NULL	-11534.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 15:59:55.407	true	NULL	-28	-15813	528534767	NULL	-28.0	-15813.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:55.787	1969-12-31 16:00:01.546	true	NULL
-NULL	-11534	528534767	NULL	NULL	-11534.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 15:59:55.407	true	NULL	-34	15007	528534767	NULL	-34.0	15007.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:50.434	1969-12-31 16:00:13.352	true	NULL
-NULL	-11534	528534767	NULL	NULL	-11534.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 15:59:55.407	true	NULL	-50	-13326	528534767	NULL	-50.0	-13326.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:46.674	1969-12-31 16:00:08.875	true	NULL
-NULL	-11534	528534767	NULL	NULL	-11534.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 15:59:55.407	true	NULL	29	7021	528534767	NULL	29.0	7021.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 16:00:15.007	1969-12-31 16:00:15.148	true	NULL
-NULL	-11534	528534767	NULL	NULL	-11534.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 15:59:55.407	true	NULL	31	-9566	528534767	NULL	31.0	-9566.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:44.187	1969-12-31 16:00:06.961	true	NULL
-NULL	-11534	528534767	NULL	NULL	-11534.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 15:59:55.407	true	NULL	NULL	-11534	528534767	NULL	NULL	-11534.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 15:59:55.407	true	NULL
-NULL	-11534	528534767	NULL	NULL	-11534.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 15:59:55.407	true	NULL	NULL	-3012	528534767	NULL	NULL	-3012.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:03.756	true	NULL
-NULL	-11534	528534767	NULL	NULL	-11534.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 15:59:55.407	true	NULL	NULL	-4016	528534767	NULL	NULL	-4016.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:07.209	true	NULL
-NULL	-11534	528534767	NULL	NULL	-11534.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 15:59:55.407	true	NULL	NULL	-4213	528534767	NULL	NULL	-4213.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.589	true	NULL
-NULL	-11534	528534767	NULL	NULL	-11534.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 15:59:55.407	true	NULL	NULL	-6147	528534767	NULL	NULL	-6147.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.839	true	NULL
-NULL	-3012	528534767	NULL	NULL	-3012.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:03.756	true	NULL	-28	-15813	528534767	NULL	-28.0	-15813.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:55.787	1969-12-31 16:00:01.546	true	NULL
-NULL	-3012	528534767	NULL	NULL	-3012.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:03.756	true	NULL	-34	15007	528534767	NULL	-34.0	15007.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:50.434	1969-12-31 16:00:13.352	true	NULL
-NULL	-3012	528534767	NULL	NULL	-3012.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:03.756	true	NULL	-50	-13326	528534767	NULL	-50.0	-13326.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:46.674	1969-12-31 16:00:08.875	true	NULL
-NULL	-3012	528534767	NULL	NULL	-3012.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:03.756	true	NULL	29	7021	528534767	NULL	29.0	7021.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 16:00:15.007	1969-12-31 16:00:15.148	true	NULL
-NULL	-3012	528534767	NULL	NULL	-3012.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:03.756	true	NULL	31	-9566	528534767	NULL	31.0	-9566.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:44.187	1969-12-31 16:00:06.961	true	NULL
-NULL	-3012	528534767	NULL	NULL	-3012.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:03.756	true	NULL	NULL	-11534	528534767	NULL	NULL	-11534.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 15:59:55.407	true	NULL
-NULL	-3012	528534767	NULL	NULL	-3012.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:03.756	true	NULL	NULL	-3012	528534767	NULL	NULL	-3012.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:03.756	true	NULL
-NULL	-3012	528534767	NULL	NULL	-3012.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:03.756	true	NULL	NULL	-4016	528534767	NULL	NULL	-4016.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:07.209	true	NULL
-NULL	-3012	528534767	NULL	NULL	-3012.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:03.756	true	NULL	NULL	-4213	528534767	NULL	NULL	-4213.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.589	true	NULL
-NULL	-3012	528534767	NULL	NULL	-3012.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:03.756	true	NULL	NULL	-6147	528534767	NULL	NULL	-6147.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.839	true	NULL
-NULL	-4016	528534767	NULL	NULL	-4016.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:07.209	true	NULL	-28	-15813	528534767	NULL	-28.0	-15813.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:55.787	1969-12-31 16:00:01.546	true	NULL
-NULL	-4016	528534767	NULL	NULL	-4016.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:07.209	true	NULL	-34	15007	528534767	NULL	-34.0	15007.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:50.434	1969-12-31 16:00:13.352	true	NULL
-NULL	-4016	528534767	NULL	NULL	-4016.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:07.209	true	NULL	-50	-13326	528534767	NULL	-50.0	-13326.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:46.674	1969-12-31 16:00:08.875	true	NULL
-NULL	-4016	528534767	NULL	NULL	-4016.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:07.209	true	NULL	29	7021	528534767	NULL	29.0	7021.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 16:00:15.007	1969-12-31 16:00:15.148	true	NULL
-NULL	-4016	528534767	NULL	NULL	-4016.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:07.209	true	NULL	31	-9566	528534767	NULL	31.0	-9566.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:44.187	1969-12-31 16:00:06.961	true	NULL
-NULL	-4016	528534767	NULL	NULL	-4016.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:07.209	true	NULL	NULL	-11534	528534767	NULL	NULL	-11534.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 15:59:55.407	true	NULL
-NULL	-4016	528534767	NULL	NULL	-4016.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:07.209	true	NULL	NULL	-3012	528534767	NULL	NULL	-3012.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:03.756	true	NULL
-NULL	-4016	528534767	NULL	NULL	-4016.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:07.209	true	NULL	NULL	-4016	528534767	NULL	NULL	-4016.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:07.209	true	NULL
-NULL	-4016	528534767	NULL	NULL	-4016.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:07.209	true	NULL	NULL	-4213	528534767	NULL	NULL	-4213.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.589	true	NULL
-NULL	-4016	528534767	NULL	NULL	-4016.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:07.209	true	NULL	NULL	-6147	528534767	NULL	NULL	-6147.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.839	true	NULL
-NULL	-4213	528534767	NULL	NULL	-4213.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.589	true	NULL	-28	-15813	528534767	NULL	-28.0	-15813.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:55.787	1969-12-31 16:00:01.546	true	NULL
-NULL	-4213	528534767	NULL	NULL	-4213.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.589	true	NULL	-34	15007	528534767	NULL	-34.0	15007.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:50.434	1969-12-31 16:00:13.352	true	NULL
-NULL	-4213	528534767	NULL	NULL	-4213.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.589	true	NULL	-50	-13326	528534767	NULL	-50.0	-13326.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:46.674	1969-12-31 16:00:08.875	true	NULL
-NULL	-4213	528534767	NULL	NULL	-4213.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.589	true	NULL	29	7021	528534767	NULL	29.0	7021.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 16:00:15.007	1969-12-31 16:00:15.148	true	NULL
-NULL	-4213	528534767	NULL	NULL	-4213.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.589	true	NULL	31	-9566	528534767	NULL	31.0	-9566.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:44.187	1969-12-31 16:00:06.961	true	NULL
-NULL	-4213	528534767	NULL	NULL	-4213.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.589	true	NULL	NULL	-11534	528534767	NULL	NULL	-11534.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 15:59:55.407	true	NULL
-NULL	-4213	528534767	NULL	NULL	-4213.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.589	true	NULL	NULL	-3012	528534767	NULL	NULL	-3012.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:03.756	true	NULL
-NULL	-4213	528534767	NULL	NULL	-4213.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.589	true	NULL	NULL	-4016	528534767	NULL	NULL	-4016.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:07.209	true	NULL
-NULL	-4213	528534767	NULL	NULL	-4213.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.589	true	NULL	NULL	-4213	528534767	NULL	NULL	-4213.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.589	true	NULL
-NULL	-4213	528534767	NULL	NULL	-4213.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.589	true	NULL	NULL	-6147	528534767	NULL	NULL	-6147.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.839	true	NULL
-NULL	-6147	528534767	NULL	NULL	-6147.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.839	true	NULL	-28	-15813	528534767	NULL	-28.0	-15813.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:55.787	1969-12-31 16:00:01.546	true	NULL
-NULL	-6147	528534767	NULL	NULL	-6147.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.839	true	NULL	-34	15007	528534767	NULL	-34.0	15007.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:50.434	1969-12-31 16:00:13.352	true	NULL
-NULL	-6147	528534767	NULL	NULL	-6147.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.839	true	NULL	-50	-13326	528534767	NULL	-50.0	-13326.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:46.674	1969-12-31 16:00:08.875	true	NULL
-NULL	-6147	528534767	NULL	NULL	-6147.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.839	true	NULL	29	7021	528534767	NULL	29.0	7021.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 16:00:15.007	1969-12-31 16:00:15.148	true	NULL
-NULL	-6147	528534767	NULL	NULL	-6147.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.839	true	NULL	31	-9566	528534767	NULL	31.0	-9566.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:44.187	1969-12-31 16:00:06.961	true	NULL
-NULL	-6147	528534767	NULL	NULL	-6147.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.839	true	NULL	NULL	-11534	528534767	NULL	NULL	-11534.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 15:59:55.407	true	NULL
-NULL	-6147	528534767	NULL	NULL	-6147.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.839	true	NULL	NULL	-3012	528534767	NULL	NULL	-3012.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:03.756	true	NULL
-NULL	-6147	528534767	NULL	NULL	-6147.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.839	true	NULL	NULL	-4016	528534767	NULL	NULL	-4016.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:07.209	true	NULL
-NULL	-6147	528534767	NULL	NULL	-6147.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.839	true	NULL	NULL	-4213	528534767	NULL	NULL	-4213.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.589	true	NULL
-NULL	-6147	528534767	NULL	NULL	-6147.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.839	true	NULL	NULL	-6147	528534767	NULL	NULL	-6147.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.839	true	NULL
+-51	NULL	-1071480828	-1401575336	-51.0	NULL	aw724t8c5558x2xneC624	4uE7l74tESBiKfu7c8wM7GA	1969-12-31 16:00:08.451	NULL	true	true	-51	NULL	-1071480828	-1401575336	-51.0	NULL	aw724t8c5558x2xneC624	4uE7l74tESBiKfu7c8wM7GA	1969-12-31 16:00:08.451	NULL	true	true
+-64	-7196	NULL	-527203677	-64.0	-7196.0	NULL	JBE4H5RoK412Cs260I72	1969-12-31 15:59:50.184	1969-12-31 15:59:58.174	NULL	true	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+-64	-7196	NULL	406535485	-64.0	-7196.0	NULL	E011i	1969-12-31 15:59:56.048	1969-12-31 15:59:58.174	NULL	false	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+-64	-7196	NULL	658026952	-64.0	-7196.0	NULL	4tAur	1969-12-31 15:59:53.866	1969-12-31 15:59:58.174	NULL	true	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+-64	15601	NULL	1421812187	-64.0	15601.0	NULL	12AEw	1969-12-31 16:00:05.997	1969-12-31 15:59:58.456	NULL	true	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+-64	15601	NULL	1960950366	-64.0	15601.0	NULL	c0ODOF64	1969-12-31 16:00:13.274	1969-12-31 15:59:58.456	NULL	true	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+11	NULL	-1069736047	-453772520	11.0	NULL	k17Am8uPHWk02cEf1jet	qrXLLNX1	1969-12-31 16:00:02.351	NULL	true	true	11	NULL	-1069736047	-453772520	11.0	NULL	k17Am8uPHWk02cEf1jet	qrXLLNX1	1969-12-31 16:00:02.351	NULL	true	true
+11	NULL	-1072910839	2048385991	11.0	NULL	0iqrc5	KbaDXiN85adbHRx58v	1969-12-31 16:00:02.351	NULL	false	false	11	NULL	-1072910839	2048385991	11.0	NULL	0iqrc5	KbaDXiN85adbHRx58v	1969-12-31 16:00:02.351	NULL	false	false
+11	NULL	-1073279343	-1595604468	11.0	NULL	oj1YrV5Wa	P76636jJ6qM17d7DIy	1969-12-31 16:00:02.351	NULL	true	true	11	NULL	-1073279343	-1595604468	11.0	NULL	oj1YrV5Wa	P76636jJ6qM17d7DIy	1969-12-31 16:00:02.351	NULL	true	true
+8	NULL	-1071363017	1349676361	8.0	NULL	Anj0oF	IwE1G7Qb0B1NEfV030g	1969-12-31 16:00:15.892	NULL	true	true	8	NULL	-1071363017	1349676361	8.0	NULL	Anj0oF	IwE1G7Qb0B1NEfV030g	1969-12-31 16:00:15.892	NULL	true	true
+NULL	-5470	-1072076362	1864027286	NULL	-5470.0	2uLyD28144vklju213J1mr	4KWs6gw7lv2WYd66P	NULL	1969-12-31 16:00:01.836	true	true	NULL	-5470	-1072076362	1864027286	NULL	-5470.0	2uLyD28144vklju213J1mr	4KWs6gw7lv2WYd66P	NULL	1969-12-31 16:00:01.836	true	true
+NULL	-7382	-1073051226	-1887561756	NULL	-7382.0	A34p7oRr2WvUJNf	4hA4KQj2vD3fI6gX82220d	NULL	1969-12-31 16:00:10.331	false	false	NULL	-7382	-1073051226	-1887561756	NULL	-7382.0	A34p7oRr2WvUJNf	4hA4KQj2vD3fI6gX82220d	NULL	1969-12-31 16:00:10.331	false	false
+NULL	-741	-1070883071	-1645852809	NULL	-741.0	0ruyd6Y50JpdGRf6HqD	xH7445Rals48VOulSyR5F	NULL	1969-12-31 15:59:51.293	false	false	NULL	-741	-1070883071	-1645852809	NULL	-741.0	0ruyd6Y50JpdGRf6HqD	xH7445Rals48VOulSyR5F	NULL	1969-12-31 15:59:51.293	false	false
+NULL	-947	-1070551679	1864027286	NULL	-947.0	iUR3Q	4KWs6gw7lv2WYd66P	NULL	1969-12-31 16:00:08.058	false	true	NULL	-947	-1070551679	1864027286	NULL	-947.0	iUR3Q	4KWs6gw7lv2WYd66P	NULL	1969-12-31 16:00:08.058	false	true
+NULL	8373	-1072081801	1864027286	NULL	8373.0	dPkN74F7	4KWs6gw7lv2WYd66P	NULL	1969-12-31 15:59:56.465	true	true	NULL	8373	-1072081801	1864027286	NULL	8373.0	dPkN74F7	4KWs6gw7lv2WYd66P	NULL	1969-12-31 15:59:56.465	true	true
 PREHOOK: query: explain
 select c.ctinyint 
 from small_alltypesorc_a c
@@ -308,11 +218,11 @@ STAGE PLANS:
             Map Operator Tree:
                 TableScan
                   alias: c
-                  Statistics: Num rows: 916 Data size: 3667 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 1045 Data size: 4183 Basic stats: COMPLETE Column stats: NONE
                   Select Operator
                     expressions: ctinyint (type: tinyint)
                     outputColumnNames: _col0
-                    Statistics: Num rows: 916 Data size: 3667 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 1045 Data size: 4183 Basic stats: COMPLETE Column stats: NONE
                     Map Join Operator
                       condition map:
                            Left Outer Join0 to 1
@@ -322,11 +232,11 @@ STAGE PLANS:
                       outputColumnNames: _col0
                       input vertices:
                         1 Map 2
-                      Statistics: Num rows: 1007 Data size: 4033 Basic stats: COMPLETE Column stats: NONE
+                      Statistics: Num rows: 1149 Data size: 4601 Basic stats: COMPLETE Column stats: NONE
                       HybridGraceHashJoin: true
                       File Output Operator
                         compressed: false
-                        Statistics: Num rows: 1007 Data size: 4033 Basic stats: COMPLETE Column stats: NONE
+                        Statistics: Num rows: 1149 Data size: 4601 Basic stats: COMPLETE Column stats: NONE
                         table:
                             input format: org.apache.hadoop.mapred.TextInputFormat
                             output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -336,16 +246,16 @@ STAGE PLANS:
             Map Operator Tree:
                 TableScan
                   alias: c
-                  Statistics: Num rows: 916 Data size: 3667 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 1045 Data size: 4183 Basic stats: COMPLETE Column stats: NONE
                   Select Operator
                     expressions: ctinyint (type: tinyint)
                     outputColumnNames: _col0
-                    Statistics: Num rows: 916 Data size: 3667 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 1045 Data size: 4183 Basic stats: COMPLETE Column stats: NONE
                     Reduce Output Operator
                       key expressions: _col0 (type: tinyint)
                       sort order: +
                       Map-reduce partition columns: _col0 (type: tinyint)
-                      Statistics: Num rows: 916 Data size: 3667 Basic stats: COMPLETE Column stats: NONE
+                      Statistics: Num rows: 1045 Data size: 4183 Basic stats: COMPLETE Column stats: NONE
             Execution mode: vectorized
 
   Stage: Stage-0
@@ -372,20 +282,42 @@ left outer join small_alltypesorc_a hd
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@small_alltypesorc_a
 #### A masked pattern was here ####
--21
--28
--34
--50
-29
-3
-31
-31
-31
-31
-38
-38
-38
-38
+-51
+-64
+-64
+-64
+-64
+-64
+-64
+-64
+-64
+-64
+-64
+-64
+-64
+-64
+-64
+-64
+-64
+-64
+-64
+-64
+-64
+-64
+-64
+-64
+-64
+-64
+11
+11
+11
+11
+11
+11
+11
+11
+11
+8
 NULL
 NULL
 NULL
@@ -425,11 +357,11 @@ STAGE PLANS:
             Map Operator Tree:
                 TableScan
                   alias: c
-                  Statistics: Num rows: 458 Data size: 3667 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 522 Data size: 4183 Basic stats: COMPLETE Column stats: NONE
                   Select Operator
                     expressions: ctinyint (type: tinyint), cint (type: int)
                     outputColumnNames: _col0, _col1
-                    Statistics: Num rows: 458 Data size: 3667 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 522 Data size: 4183 Basic stats: COMPLETE Column stats: NONE
                     Map Join Operator
                       condition map:
                            Left Outer Join0 to 1
@@ -439,7 +371,7 @@ STAGE PLANS:
                       outputColumnNames: _col0
                       input vertices:
                         1 Map 3
-                      Statistics: Num rows: 1007 Data size: 4033 Basic stats: COMPLETE Column stats: NONE
+                      Statistics: Num rows: 1149 Data size: 4601 Basic stats: COMPLETE Column stats: NONE
                       HybridGraceHashJoin: true
                       Map Join Operator
                         condition map:
@@ -450,7 +382,7 @@ STAGE PLANS:
                         outputColumnNames: _col0
                         input vertices:
                           1 Map 4
-                        Statistics: Num rows: 1107 Data size: 4436 Basic stats: COMPLETE Column stats: NONE
+                        Statistics: Num rows: 1263 Data size: 5061 Basic stats: COMPLETE Column stats: NONE
                         HybridGraceHashJoin: true
                         Group By Operator
                           aggregations: count(), sum(_col0)
@@ -466,31 +398,31 @@ STAGE PLANS:
             Map Operator Tree:
                 TableScan
                   alias: c
-                  Statistics: Num rows: 916 Data size: 3667 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 1045 Data size: 4183 Basic stats: COMPLETE Column stats: NONE
                   Select Operator
                     expressions: cint (type: int)
                     outputColumnNames: _col0
-                    Statistics: Num rows: 916 Data size: 3667 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 1045 Data size: 4183 Basic stats: COMPLETE Column stats: NONE
                     Reduce Output Operator
                       key expressions: _col0 (type: int)
                       sort order: +
                       Map-reduce partition columns: _col0 (type: int)
-                      Statistics: Num rows: 916 Data size: 3667 Basic stats: COMPLETE Column stats: NONE
+                      Statistics: Num rows: 1045 Data size: 4183 Basic stats: COMPLETE Column stats: NONE
             Execution mode: vectorized
         Map 4 
             Map Operator Tree:
                 TableScan
                   alias: c
-                  Statistics: Num rows: 916 Data size: 3667 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 1045 Data size: 4183 Basic stats: COMPLETE Column stats: NONE
                   Select Operator
                     expressions: ctinyint (type: tinyint)
                     outputColumnNames: _col0
-                    Statistics: Num rows: 916 Data size: 3667 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 1045 Data size: 4183 Basic stats: COMPLETE Column stats: NONE
                     Reduce Output Operator
                       key expressions: _col0 (type: tinyint)
                       sort order: +
                       Map-reduce partition columns: _col0 (type: tinyint)
-                      Statistics: Num rows: 916 Data size: 3667 Basic stats: COMPLETE Column stats: NONE
+                      Statistics: Num rows: 1045 Data size: 4183 Basic stats: COMPLETE Column stats: NONE
             Execution mode: vectorized
         Reducer 2 
             Reduce Operator Tree:
@@ -538,4 +470,4 @@ left outer join small_alltypesorc_a hd
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@small_alltypesorc_a
 #### A masked pattern was here ####
-118	-14
+41	-1544
diff --git a/ql/src/test/results/clientpositive/tez/vector_outer_join2.q.out b/ql/src/test/results/clientpositive/tez/vector_outer_join2.q.out
index 94b3999511..8c8f54e21f 100644
--- a/ql/src/test/results/clientpositive/tez/vector_outer_join2.q.out
+++ b/ql/src/test/results/clientpositive/tez/vector_outer_join2.q.out
@@ -1,39 +1,39 @@
-PREHOOK: query: create table small_alltypesorc1a as select * from alltypesorc where cint is not null and ctinyint is not null limit 5
+PREHOOK: query: create table small_alltypesorc1a as select * from alltypesorc where cint is not null and ctinyint is not null order by cint, ctinyint limit 5
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@alltypesorc
 PREHOOK: Output: database:default
 PREHOOK: Output: default@small_alltypesorc1a
-POSTHOOK: query: create table small_alltypesorc1a as select * from alltypesorc where cint is not null and ctinyint is not null limit 5
+POSTHOOK: query: create table small_alltypesorc1a as select * from alltypesorc where cint is not null and ctinyint is not null order by cint, ctinyint limit 5
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@alltypesorc
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@small_alltypesorc1a
-PREHOOK: query: create table small_alltypesorc2a as select * from alltypesorc where cint is null and ctinyint is not null limit 5
+PREHOOK: query: create table small_alltypesorc2a as select * from alltypesorc where cint is null and ctinyint is not null order by cint, ctinyint limit 5
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@alltypesorc
 PREHOOK: Output: database:default
 PREHOOK: Output: default@small_alltypesorc2a
-POSTHOOK: query: create table small_alltypesorc2a as select * from alltypesorc where cint is null and ctinyint is not null limit 5
+POSTHOOK: query: create table small_alltypesorc2a as select * from alltypesorc where cint is null and ctinyint is not null order by cint, ctinyint limit 5
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@alltypesorc
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@small_alltypesorc2a
-PREHOOK: query: create table small_alltypesorc3a as select * from alltypesorc where cint is not null and ctinyint is null limit 5
+PREHOOK: query: create table small_alltypesorc3a as select * from alltypesorc where cint is not null and ctinyint is null order by cint, ctinyint limit 5
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@alltypesorc
 PREHOOK: Output: database:default
 PREHOOK: Output: default@small_alltypesorc3a
-POSTHOOK: query: create table small_alltypesorc3a as select * from alltypesorc where cint is not null and ctinyint is null limit 5
+POSTHOOK: query: create table small_alltypesorc3a as select * from alltypesorc where cint is not null and ctinyint is null order by cint, ctinyint limit 5
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@alltypesorc
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@small_alltypesorc3a
-PREHOOK: query: create table small_alltypesorc4a as select * from alltypesorc where cint is null and ctinyint is null limit 5
+PREHOOK: query: create table small_alltypesorc4a as select * from alltypesorc where cint is null and ctinyint is null order by cint, ctinyint limit 5
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@alltypesorc
 PREHOOK: Output: database:default
 PREHOOK: Output: default@small_alltypesorc4a
-POSTHOOK: query: create table small_alltypesorc4a as select * from alltypesorc where cint is null and ctinyint is null limit 5
+POSTHOOK: query: create table small_alltypesorc4a as select * from alltypesorc where cint is null and ctinyint is null order by cint, ctinyint limit 5
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@alltypesorc
 POSTHOOK: Output: database:default
@@ -118,11 +118,11 @@ STAGE PLANS:
             Map Operator Tree:
                 TableScan
                   alias: c
-                  Statistics: Num rows: 305 Data size: 3667 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 348 Data size: 4183 Basic stats: COMPLETE Column stats: NONE
                   Select Operator
                     expressions: cint (type: int), cbigint (type: bigint)
                     outputColumnNames: _col0, _col1
-                    Statistics: Num rows: 305 Data size: 3667 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 348 Data size: 4183 Basic stats: COMPLETE Column stats: NONE
                     Map Join Operator
                       condition map:
                            Left Outer Join0 to 1
@@ -132,7 +132,7 @@ STAGE PLANS:
                       outputColumnNames: _col1
                       input vertices:
                         1 Map 3
-                      Statistics: Num rows: 1007 Data size: 4033 Basic stats: COMPLETE Column stats: NONE
+                      Statistics: Num rows: 1149 Data size: 4601 Basic stats: COMPLETE Column stats: NONE
                       HybridGraceHashJoin: true
                       Map Join Operator
                         condition map:
@@ -143,12 +143,12 @@ STAGE PLANS:
                         outputColumnNames: _col1
                         input vertices:
                           1 Map 4
-                        Statistics: Num rows: 1107 Data size: 4436 Basic stats: COMPLETE Column stats: NONE
+                        Statistics: Num rows: 1263 Data size: 5061 Basic stats: COMPLETE Column stats: NONE
                         HybridGraceHashJoin: true
                         Select Operator
                           expressions: _col1 (type: bigint)
                           outputColumnNames: _col0
-                          Statistics: Num rows: 1107 Data size: 4436 Basic stats: COMPLETE Column stats: NONE
+                          Statistics: Num rows: 1263 Data size: 5061 Basic stats: COMPLETE Column stats: NONE
                           Group By Operator
                             aggregations: count(), sum(_col0)
                             mode: hash
@@ -163,31 +163,31 @@ STAGE PLANS:
             Map Operator Tree:
                 TableScan
                   alias: c
-                  Statistics: Num rows: 916 Data size: 3667 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 1045 Data size: 4183 Basic stats: COMPLETE Column stats: NONE
                   Select Operator
                     expressions: cint (type: int)
                     outputColumnNames: _col0
-                    Statistics: Num rows: 916 Data size: 3667 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 1045 Data size: 4183 Basic stats: COMPLETE Column stats: NONE
                     Reduce Output Operator
                       key expressions: _col0 (type: int)
                       sort order: +
                       Map-reduce partition columns: _col0 (type: int)
-                      Statistics: Num rows: 916 Data size: 3667 Basic stats: COMPLETE Column stats: NONE
+                      Statistics: Num rows: 1045 Data size: 4183 Basic stats: COMPLETE Column stats: NONE
             Execution mode: vectorized
         Map 4 
             Map Operator Tree:
                 TableScan
                   alias: c
-                  Statistics: Num rows: 458 Data size: 3667 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 522 Data size: 4183 Basic stats: COMPLETE Column stats: NONE
                   Select Operator
                     expressions: cbigint (type: bigint)
                     outputColumnNames: _col0
-                    Statistics: Num rows: 458 Data size: 3667 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 522 Data size: 4183 Basic stats: COMPLETE Column stats: NONE
                     Reduce Output Operator
                       key expressions: _col0 (type: bigint)
                       sort order: +
                       Map-reduce partition columns: _col0 (type: bigint)
-                      Statistics: Num rows: 458 Data size: 3667 Basic stats: COMPLETE Column stats: NONE
+                      Statistics: Num rows: 522 Data size: 4183 Basic stats: COMPLETE Column stats: NONE
             Execution mode: vectorized
         Reducer 2 
             Reduce Operator Tree:
@@ -235,4 +235,4 @@ left outer join small_alltypesorc_a hd
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@small_alltypesorc_a
 #### A masked pattern was here ####
-105	-1197260954
+21	17110062350
diff --git a/ql/src/test/results/clientpositive/tez/vector_outer_join3.q.out b/ql/src/test/results/clientpositive/tez/vector_outer_join3.q.out
index a7c93fa321..fa47a03b59 100644
--- a/ql/src/test/results/clientpositive/tez/vector_outer_join3.q.out
+++ b/ql/src/test/results/clientpositive/tez/vector_outer_join3.q.out
@@ -1,39 +1,39 @@
-PREHOOK: query: create table small_alltypesorc1a as select * from alltypesorc where cint is not null and ctinyint is not null limit 5
+PREHOOK: query: create table small_alltypesorc1a as select * from alltypesorc where cint is not null and ctinyint is not null order by cint, ctinyint limit 5
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@alltypesorc
 PREHOOK: Output: database:default
 PREHOOK: Output: default@small_alltypesorc1a
-POSTHOOK: query: create table small_alltypesorc1a as select * from alltypesorc where cint is not null and ctinyint is not null limit 5
+POSTHOOK: query: create table small_alltypesorc1a as select * from alltypesorc where cint is not null and ctinyint is not null order by cint, ctinyint limit 5
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@alltypesorc
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@small_alltypesorc1a
-PREHOOK: query: create table small_alltypesorc2a as select * from alltypesorc where cint is null and ctinyint is not null limit 5
+PREHOOK: query: create table small_alltypesorc2a as select * from alltypesorc where cint is null and ctinyint is not null order by cint, ctinyint limit 5
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@alltypesorc
 PREHOOK: Output: database:default
 PREHOOK: Output: default@small_alltypesorc2a
-POSTHOOK: query: create table small_alltypesorc2a as select * from alltypesorc where cint is null and ctinyint is not null limit 5
+POSTHOOK: query: create table small_alltypesorc2a as select * from alltypesorc where cint is null and ctinyint is not null order by cint, ctinyint limit 5
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@alltypesorc
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@small_alltypesorc2a
-PREHOOK: query: create table small_alltypesorc3a as select * from alltypesorc where cint is not null and ctinyint is null limit 5
+PREHOOK: query: create table small_alltypesorc3a as select * from alltypesorc where cint is not null and ctinyint is null order by cint, ctinyint limit 5
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@alltypesorc
 PREHOOK: Output: database:default
 PREHOOK: Output: default@small_alltypesorc3a
-POSTHOOK: query: create table small_alltypesorc3a as select * from alltypesorc where cint is not null and ctinyint is null limit 5
+POSTHOOK: query: create table small_alltypesorc3a as select * from alltypesorc where cint is not null and ctinyint is null order by cint, ctinyint limit 5
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@alltypesorc
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@small_alltypesorc3a
-PREHOOK: query: create table small_alltypesorc4a as select * from alltypesorc where cint is null and ctinyint is null limit 5
+PREHOOK: query: create table small_alltypesorc4a as select * from alltypesorc where cint is null and ctinyint is null order by cint, ctinyint limit 5
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@alltypesorc
 PREHOOK: Output: database:default
 PREHOOK: Output: default@small_alltypesorc4a
-POSTHOOK: query: create table small_alltypesorc4a as select * from alltypesorc where cint is null and ctinyint is null limit 5
+POSTHOOK: query: create table small_alltypesorc4a as select * from alltypesorc where cint is null and ctinyint is null order by cint, ctinyint limit 5
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@alltypesorc
 POSTHOOK: Output: database:default
@@ -118,11 +118,11 @@ STAGE PLANS:
             Map Operator Tree:
                 TableScan
                   alias: c
-                  Statistics: Num rows: 35 Data size: 3667 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 40 Data size: 4183 Basic stats: COMPLETE Column stats: NONE
                   Select Operator
                     expressions: cint (type: int), cstring1 (type: string)
                     outputColumnNames: _col0, _col1
-                    Statistics: Num rows: 35 Data size: 3667 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 40 Data size: 4183 Basic stats: COMPLETE Column stats: NONE
                     Map Join Operator
                       condition map:
                            Left Outer Join0 to 1
@@ -132,7 +132,7 @@ STAGE PLANS:
                       outputColumnNames: _col1
                       input vertices:
                         1 Map 3
-                      Statistics: Num rows: 1007 Data size: 4033 Basic stats: COMPLETE Column stats: NONE
+                      Statistics: Num rows: 1149 Data size: 4601 Basic stats: COMPLETE Column stats: NONE
                       HybridGraceHashJoin: true
                       Map Join Operator
                         condition map:
@@ -142,7 +142,7 @@ STAGE PLANS:
                           1 _col0 (type: string)
                         input vertices:
                           1 Map 4
-                        Statistics: Num rows: 1107 Data size: 4436 Basic stats: COMPLETE Column stats: NONE
+                        Statistics: Num rows: 1263 Data size: 5061 Basic stats: COMPLETE Column stats: NONE
                         HybridGraceHashJoin: true
                         Group By Operator
                           aggregations: count()
@@ -158,31 +158,31 @@ STAGE PLANS:
             Map Operator Tree:
                 TableScan
                   alias: c
-                  Statistics: Num rows: 916 Data size: 3667 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 1045 Data size: 4183 Basic stats: COMPLETE Column stats: NONE
                   Select Operator
                     expressions: cint (type: int)
                     outputColumnNames: _col0
-                    Statistics: Num rows: 916 Data size: 3667 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 1045 Data size: 4183 Basic stats: COMPLETE Column stats: NONE
                     Reduce Output Operator
                       key expressions: _col0 (type: int)
                       sort order: +
                       Map-reduce partition columns: _col0 (type: int)
-                      Statistics: Num rows: 916 Data size: 3667 Basic stats: COMPLETE Column stats: NONE
+                      Statistics: Num rows: 1045 Data size: 4183 Basic stats: COMPLETE Column stats: NONE
             Execution mode: vectorized
         Map 4 
             Map Operator Tree:
                 TableScan
                   alias: c
-                  Statistics: Num rows: 36 Data size: 3667 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 41 Data size: 4183 Basic stats: COMPLETE Column stats: NONE
                   Select Operator
                     expressions: cstring1 (type: string)
                     outputColumnNames: _col0
-                    Statistics: Num rows: 36 Data size: 3667 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 41 Data size: 4183 Basic stats: COMPLETE Column stats: NONE
                     Reduce Output Operator
                       key expressions: _col0 (type: string)
                       sort order: +
                       Map-reduce partition columns: _col0 (type: string)
-                      Statistics: Num rows: 36 Data size: 3667 Basic stats: COMPLETE Column stats: NONE
+                      Statistics: Num rows: 41 Data size: 4183 Basic stats: COMPLETE Column stats: NONE
             Execution mode: vectorized
         Reducer 2 
             Reduce Operator Tree:
@@ -230,7 +230,7 @@ left outer join small_alltypesorc_a hd
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@small_alltypesorc_a
 #### A masked pattern was here ####
-1005
+15
 PREHOOK: query: explain
 select count(*) from (select c.cstring1 
 from small_alltypesorc_a c
@@ -265,11 +265,11 @@ STAGE PLANS:
             Map Operator Tree:
                 TableScan
                   alias: c
-                  Statistics: Num rows: 18 Data size: 3667 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 20 Data size: 4183 Basic stats: COMPLETE Column stats: NONE
                   Select Operator
                     expressions: cstring1 (type: string), cstring2 (type: string)
                     outputColumnNames: _col0, _col1
-                    Statistics: Num rows: 18 Data size: 3667 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 20 Data size: 4183 Basic stats: COMPLETE Column stats: NONE
                     Map Join Operator
                       condition map:
                            Left Outer Join0 to 1
@@ -279,7 +279,7 @@ STAGE PLANS:
                       outputColumnNames: _col0
                       input vertices:
                         1 Map 3
-                      Statistics: Num rows: 39 Data size: 4033 Basic stats: COMPLETE Column stats: NONE
+                      Statistics: Num rows: 45 Data size: 4601 Basic stats: COMPLETE Column stats: NONE
                       HybridGraceHashJoin: true
                       Map Join Operator
                         condition map:
@@ -289,7 +289,7 @@ STAGE PLANS:
                           1 _col0 (type: string)
                         input vertices:
                           1 Map 4
-                        Statistics: Num rows: 42 Data size: 4436 Basic stats: COMPLETE Column stats: NONE
+                        Statistics: Num rows: 49 Data size: 5061 Basic stats: COMPLETE Column stats: NONE
                         HybridGraceHashJoin: true
                         Group By Operator
                           aggregations: count()
@@ -305,31 +305,31 @@ STAGE PLANS:
             Map Operator Tree:
                 TableScan
                   alias: c
-                  Statistics: Num rows: 36 Data size: 3667 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 41 Data size: 4183 Basic stats: COMPLETE Column stats: NONE
                   Select Operator
                     expressions: cstring2 (type: string)
                     outputColumnNames: _col0
-                    Statistics: Num rows: 36 Data size: 3667 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 41 Data size: 4183 Basic stats: COMPLETE Column stats: NONE
                     Reduce Output Operator
                       key expressions: _col0 (type: string)
                       sort order: +
                       Map-reduce partition columns: _col0 (type: string)
-                      Statistics: Num rows: 36 Data size: 3667 Basic stats: COMPLETE Column stats: NONE
+                      Statistics: Num rows: 41 Data size: 4183 Basic stats: COMPLETE Column stats: NONE
             Execution mode: vectorized
         Map 4 
             Map Operator Tree:
                 TableScan
                   alias: c
-                  Statistics: Num rows: 36 Data size: 3667 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 41 Data size: 4183 Basic stats: COMPLETE Column stats: NONE
                   Select Operator
                     expressions: cstring1 (type: string)
                     outputColumnNames: _col0
-                    Statistics: Num rows: 36 Data size: 3667 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 41 Data size: 4183 Basic stats: COMPLETE Column stats: NONE
                     Reduce Output Operator
                       key expressions: _col0 (type: string)
                       sort order: +
                       Map-reduce partition columns: _col0 (type: string)
-                      Statistics: Num rows: 36 Data size: 3667 Basic stats: COMPLETE Column stats: NONE
+                      Statistics: Num rows: 41 Data size: 4183 Basic stats: COMPLETE Column stats: NONE
             Execution mode: vectorized
         Reducer 2 
             Reduce Operator Tree:
@@ -377,7 +377,7 @@ left outer join small_alltypesorc_a hd
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@small_alltypesorc_a
 #### A masked pattern was here ####
-105
+21
 PREHOOK: query: explain
 select count(*) from (select c.cstring1 
 from small_alltypesorc_a c
@@ -412,11 +412,11 @@ STAGE PLANS:
             Map Operator Tree:
                 TableScan
                   alias: c
-                  Statistics: Num rows: 17 Data size: 3667 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 19 Data size: 4183 Basic stats: COMPLETE Column stats: NONE
                   Select Operator
                     expressions: cint (type: int), cbigint (type: bigint), cstring1 (type: string), cstring2 (type: string)
                     outputColumnNames: _col0, _col1, _col2, _col3
-                    Statistics: Num rows: 17 Data size: 3667 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 19 Data size: 4183 Basic stats: COMPLETE Column stats: NONE
                     Map Join Operator
                       condition map:
                            Left Outer Join0 to 1
@@ -426,7 +426,7 @@ STAGE PLANS:
                       outputColumnNames: _col0, _col2
                       input vertices:
                         1 Map 3
-                      Statistics: Num rows: 36 Data size: 4033 Basic stats: COMPLETE Column stats: NONE
+                      Statistics: Num rows: 41 Data size: 4601 Basic stats: COMPLETE Column stats: NONE
                       HybridGraceHashJoin: true
                       Map Join Operator
                         condition map:
@@ -436,7 +436,7 @@ STAGE PLANS:
                           1 _col1 (type: string), _col0 (type: int)
                         input vertices:
                           1 Map 4
-                        Statistics: Num rows: 39 Data size: 4436 Basic stats: COMPLETE Column stats: NONE
+                        Statistics: Num rows: 45 Data size: 5061 Basic stats: COMPLETE Column stats: NONE
                         HybridGraceHashJoin: true
                         Group By Operator
                           aggregations: count()
@@ -452,31 +452,31 @@ STAGE PLANS:
             Map Operator Tree:
                 TableScan
                   alias: c
-                  Statistics: Num rows: 33 Data size: 3667 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 38 Data size: 4183 Basic stats: COMPLETE Column stats: NONE
                   Select Operator
                     expressions: cbigint (type: bigint), cstring2 (type: string)
                     outputColumnNames: _col0, _col1
-                    Statistics: Num rows: 33 Data size: 3667 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 38 Data size: 4183 Basic stats: COMPLETE Column stats: NONE
                     Reduce Output Operator
                       key expressions: _col1 (type: string), _col0 (type: bigint)
                       sort order: ++
                       Map-reduce partition columns: _col1 (type: string), _col0 (type: bigint)
-                      Statistics: Num rows: 33 Data size: 3667 Basic stats: COMPLETE Column stats: NONE
+                      Statistics: Num rows: 38 Data size: 4183 Basic stats: COMPLETE Column stats: NONE
             Execution mode: vectorized
         Map 4 
             Map Operator Tree:
                 TableScan
                   alias: c
-                  Statistics: Num rows: 35 Data size: 3667 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 40 Data size: 4183 Basic stats: COMPLETE Column stats: NONE
                   Select Operator
                     expressions: cint (type: int), cstring1 (type: string)
                     outputColumnNames: _col0, _col1
-                    Statistics: Num rows: 35 Data size: 3667 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 40 Data size: 4183 Basic stats: COMPLETE Column stats: NONE
                     Reduce Output Operator
                       key expressions: _col1 (type: string), _col0 (type: int)
                       sort order: ++
                       Map-reduce partition columns: _col1 (type: string), _col0 (type: int)
-                      Statistics: Num rows: 35 Data size: 3667 Basic stats: COMPLETE Column stats: NONE
+                      Statistics: Num rows: 40 Data size: 4183 Basic stats: COMPLETE Column stats: NONE
             Execution mode: vectorized
         Reducer 2 
             Reduce Operator Tree:
@@ -524,4 +524,4 @@ left outer join small_alltypesorc_a hd
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@small_alltypesorc_a
 #### A masked pattern was here ####
-105
+21
diff --git a/ql/src/test/results/clientpositive/tez/vectorization_part_project.q.out b/ql/src/test/results/clientpositive/tez/vectorization_part_project.q.out
index 40c4522fe6..a5eabf8e9d 100644
--- a/ql/src/test/results/clientpositive/tez/vectorization_part_project.q.out
+++ b/ql/src/test/results/clientpositive/tez/vectorization_part_project.q.out
@@ -6,11 +6,11 @@ POSTHOOK: query: CREATE TABLE alltypesorc_part(ctinyint tinyint, csmallint small
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@alltypesorc_part
-PREHOOK: query: insert overwrite table alltypesorc_part partition (ds='2011') select * from alltypesorc limit 100
+PREHOOK: query: insert overwrite table alltypesorc_part partition (ds='2011') select * from alltypesorc order by ctinyint, cint, cbigint limit 100
 PREHOOK: type: QUERY
 PREHOOK: Input: default@alltypesorc
 PREHOOK: Output: default@alltypesorc_part@ds=2011
-POSTHOOK: query: insert overwrite table alltypesorc_part partition (ds='2011') select * from alltypesorc limit 100
+POSTHOOK: query: insert overwrite table alltypesorc_part partition (ds='2011') select * from alltypesorc order by ctinyint, cint, cbigint limit 100
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc
 POSTHOOK: Output: default@alltypesorc_part@ds=2011
@@ -26,11 +26,11 @@ POSTHOOK: Lineage: alltypesorc_part PARTITION(ds=2011).cstring2 SIMPLE [(alltype
 POSTHOOK: Lineage: alltypesorc_part PARTITION(ds=2011).ctimestamp1 SIMPLE [(alltypesorc)alltypesorc.FieldSchema(name:ctimestamp1, type:timestamp, comment:null), ]
 POSTHOOK: Lineage: alltypesorc_part PARTITION(ds=2011).ctimestamp2 SIMPLE [(alltypesorc)alltypesorc.FieldSchema(name:ctimestamp2, type:timestamp, comment:null), ]
 POSTHOOK: Lineage: alltypesorc_part PARTITION(ds=2011).ctinyint SIMPLE [(alltypesorc)alltypesorc.FieldSchema(name:ctinyint, type:tinyint, comment:null), ]
-PREHOOK: query: insert overwrite table alltypesorc_part partition (ds='2012') select * from alltypesorc limit 100
+PREHOOK: query: insert overwrite table alltypesorc_part partition (ds='2012') select * from alltypesorc order by ctinyint, cint, cbigint limit 100
 PREHOOK: type: QUERY
 PREHOOK: Input: default@alltypesorc
 PREHOOK: Output: default@alltypesorc_part@ds=2012
-POSTHOOK: query: insert overwrite table alltypesorc_part partition (ds='2012') select * from alltypesorc limit 100
+POSTHOOK: query: insert overwrite table alltypesorc_part partition (ds='2012') select * from alltypesorc order by ctinyint, cint, cbigint limit 100
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc
 POSTHOOK: Output: default@alltypesorc_part@ds=2012
@@ -65,28 +65,28 @@ STAGE PLANS:
             Map Operator Tree:
                 TableScan
                   alias: alltypesorc_part
-                  Statistics: Num rows: 200 Data size: 41576 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 200 Data size: 54496 Basic stats: COMPLETE Column stats: NONE
                   Select Operator
                     expressions: (cdouble + 2.0) (type: double)
                     outputColumnNames: _col0
-                    Statistics: Num rows: 200 Data size: 41576 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 200 Data size: 54496 Basic stats: COMPLETE Column stats: NONE
                     Reduce Output Operator
                       key expressions: _col0 (type: double)
                       sort order: +
-                      Statistics: Num rows: 200 Data size: 41576 Basic stats: COMPLETE Column stats: NONE
+                      Statistics: Num rows: 200 Data size: 54496 Basic stats: COMPLETE Column stats: NONE
             Execution mode: vectorized
         Reducer 2 
             Reduce Operator Tree:
               Select Operator
                 expressions: KEY.reducesinkkey0 (type: double)
                 outputColumnNames: _col0
-                Statistics: Num rows: 200 Data size: 41576 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 200 Data size: 54496 Basic stats: COMPLETE Column stats: NONE
                 Limit
                   Number of rows: 10
-                  Statistics: Num rows: 10 Data size: 2070 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 10 Data size: 2720 Basic stats: COMPLETE Column stats: NONE
                   File Output Operator
                     compressed: false
-                    Statistics: Num rows: 10 Data size: 2070 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 10 Data size: 2720 Basic stats: COMPLETE Column stats: NONE
                     table:
                         input format: org.apache.hadoop.mapred.TextInputFormat
                         output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -111,13 +111,13 @@ POSTHOOK: Input: default@alltypesorc_part
 POSTHOOK: Input: default@alltypesorc_part@ds=2011
 POSTHOOK: Input: default@alltypesorc_part@ds=2012
 #### A masked pattern was here ####
--15910.0
--15910.0
--15811.0
--15811.0
--15788.0
--15788.0
--15547.0
--15547.0
--15429.0
--15429.0
+NULL
+NULL
+-15863.0
+-15863.0
+-14988.0
+-14988.0
+-14646.0
+-14646.0
+-14236.0
+-14236.0
diff --git a/ql/src/test/results/clientpositive/tez/vectorized_distinct_gby.q.out b/ql/src/test/results/clientpositive/tez/vectorized_distinct_gby.q.out
index cf95c8a9d8..932b175d08 100644
--- a/ql/src/test/results/clientpositive/tez/vectorized_distinct_gby.q.out
+++ b/ql/src/test/results/clientpositive/tez/vectorized_distinct_gby.q.out
@@ -6,11 +6,11 @@ POSTHOOK: query: create table dtest(a int, b int) clustered by (a) sorted by (a)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@dtest
-PREHOOK: query: insert into table dtest select c,b from (select array(300,300,300,300,300) as a, 1 as b from src limit 1) y lateral view  explode(a) t1 as c
+PREHOOK: query: insert into table dtest select c,b from (select array(300,300,300,300,300) as a, 1 as b from src order by a limit 1) y lateral view  explode(a) t1 as c
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
 PREHOOK: Output: default@dtest
-POSTHOOK: query: insert into table dtest select c,b from (select array(300,300,300,300,300) as a, 1 as b from src limit 1) y lateral view  explode(a) t1 as c
+POSTHOOK: query: insert into table dtest select c,b from (select array(300,300,300,300,300) as a, 1 as b from src order by a limit 1) y lateral view  explode(a) t1 as c
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 POSTHOOK: Output: default@dtest
diff --git a/ql/src/test/results/clientpositive/tez/vectorized_mapjoin.q.out b/ql/src/test/results/clientpositive/tez/vectorized_mapjoin.q.out
index edc33af97a..44309087f2 100644
--- a/ql/src/test/results/clientpositive/tez/vectorized_mapjoin.q.out
+++ b/ql/src/test/results/clientpositive/tez/vectorized_mapjoin.q.out
@@ -1,8 +1,12 @@
-PREHOOK: query: EXPLAIN SELECT COUNT(t1.cint), MAX(t2.cint), MIN(t1.cint), AVG(t1.cint+t2.cint)
+PREHOOK: query: -- SORT_QUERY_RESULTS
+
+EXPLAIN SELECT COUNT(t1.cint), MAX(t2.cint), MIN(t1.cint), AVG(t1.cint+t2.cint)
   FROM alltypesorc t1
   JOIN alltypesorc t2 ON t1.cint = t2.cint
 PREHOOK: type: QUERY
-POSTHOOK: query: EXPLAIN SELECT COUNT(t1.cint), MAX(t2.cint), MIN(t1.cint), AVG(t1.cint+t2.cint)
+POSTHOOK: query: -- SORT_QUERY_RESULTS
+
+EXPLAIN SELECT COUNT(t1.cint), MAX(t2.cint), MIN(t1.cint), AVG(t1.cint+t2.cint)
   FROM alltypesorc t1
   JOIN alltypesorc t2 ON t1.cint = t2.cint
 POSTHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/tez/vectorized_nested_mapjoin.q.out b/ql/src/test/results/clientpositive/tez/vectorized_nested_mapjoin.q.out
index c49192bb06..01a36e54c8 100644
--- a/ql/src/test/results/clientpositive/tez/vectorized_nested_mapjoin.q.out
+++ b/ql/src/test/results/clientpositive/tez/vectorized_nested_mapjoin.q.out
@@ -1,6 +1,10 @@
-PREHOOK: query: explain select sum(t1.td) from (select  v1.csmallint as tsi, v1.cdouble as td from alltypesorc v1, alltypesorc v2 where v1.ctinyint=v2.ctinyint) t1 join alltypesorc v3 on t1.tsi=v3.csmallint
+PREHOOK: query: -- SORT_QUERY_RESULTS
+
+explain select sum(t1.td) from (select  v1.csmallint as tsi, v1.cdouble as td from alltypesorc v1, alltypesorc v2 where v1.ctinyint=v2.ctinyint) t1 join alltypesorc v3 on t1.tsi=v3.csmallint
 PREHOOK: type: QUERY
-POSTHOOK: query: explain select sum(t1.td) from (select  v1.csmallint as tsi, v1.cdouble as td from alltypesorc v1, alltypesorc v2 where v1.ctinyint=v2.ctinyint) t1 join alltypesorc v3 on t1.tsi=v3.csmallint
+POSTHOOK: query: -- SORT_QUERY_RESULTS
+
+explain select sum(t1.td) from (select  v1.csmallint as tsi, v1.cdouble as td from alltypesorc v1, alltypesorc v2 where v1.ctinyint=v2.ctinyint) t1 join alltypesorc v3 on t1.tsi=v3.csmallint
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
diff --git a/ql/src/test/results/clientpositive/tez/vectorized_rcfile_columnar.q.out b/ql/src/test/results/clientpositive/tez/vectorized_rcfile_columnar.q.out
index ee8959be94..c35173edde 100644
--- a/ql/src/test/results/clientpositive/tez/vectorized_rcfile_columnar.q.out
+++ b/ql/src/test/results/clientpositive/tez/vectorized_rcfile_columnar.q.out
@@ -23,12 +23,12 @@ POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@columnTable
 PREHOOK: query: FROM src
-INSERT OVERWRITE TABLE columnTable SELECT src.key, src.value LIMIT 10
+INSERT OVERWRITE TABLE columnTable SELECT src.key, src.value ORDER BY src.key, src.value LIMIT 10
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
 PREHOOK: Output: default@columntable
 POSTHOOK: query: FROM src
-INSERT OVERWRITE TABLE columnTable SELECT src.key, src.value LIMIT 10
+INSERT OVERWRITE TABLE columnTable SELECT src.key, src.value ORDER BY src.key, src.value LIMIT 10
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 POSTHOOK: Output: default@columntable
@@ -50,13 +50,13 @@ POSTHOOK: query: SELECT key, value FROM columnTable ORDER BY key
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@columntable
 #### A masked pattern was here ####
-165	val_165
-238	val_238
-255	val_255
-27	val_27
-278	val_278
-311	val_311
-409	val_409
-484	val_484
-86	val_86
-98	val_98
+0	val_0
+0	val_0
+0	val_0
+10	val_10
+100	val_100
+100	val_100
+103	val_103
+103	val_103
+104	val_104
+104	val_104
diff --git a/ql/src/test/results/clientpositive/tez/vectorized_shufflejoin.q.out b/ql/src/test/results/clientpositive/tez/vectorized_shufflejoin.q.out
index 408d46e169..1fe15fe690 100644
--- a/ql/src/test/results/clientpositive/tez/vectorized_shufflejoin.q.out
+++ b/ql/src/test/results/clientpositive/tez/vectorized_shufflejoin.q.out
@@ -1,10 +1,14 @@
-PREHOOK: query: EXPLAIN SELECT COUNT(t1.cint), MAX(t2.cint), MIN(t1.cint), AVG(t1.cint+t2.cint)
+PREHOOK: query: -- SORT_QUERY_RESULTS
+
+EXPLAIN SELECT COUNT(t1.cint) AS CNT, MAX(t2.cint) , MIN(t1.cint), AVG(t1.cint+t2.cint)
   FROM alltypesorc t1
-  JOIN alltypesorc t2 ON t1.cint = t2.cint
+  JOIN alltypesorc t2 ON t1.cint = t2.cint order by CNT
 PREHOOK: type: QUERY
-POSTHOOK: query: EXPLAIN SELECT COUNT(t1.cint), MAX(t2.cint), MIN(t1.cint), AVG(t1.cint+t2.cint)
+POSTHOOK: query: -- SORT_QUERY_RESULTS
+
+EXPLAIN SELECT COUNT(t1.cint) AS CNT, MAX(t2.cint) , MIN(t1.cint), AVG(t1.cint+t2.cint)
   FROM alltypesorc t1
-  JOIN alltypesorc t2 ON t1.cint = t2.cint
+  JOIN alltypesorc t2 ON t1.cint = t2.cint order by CNT
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
@@ -14,8 +18,9 @@ STAGE PLANS:
   Stage: Stage-1
     Tez
       Edges:
-        Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 4 (SIMPLE_EDGE)
+        Reducer 2 <- Map 1 (SIMPLE_EDGE), Map 5 (SIMPLE_EDGE)
         Reducer 3 <- Reducer 2 (SIMPLE_EDGE)
+        Reducer 4 <- Reducer 3 (SIMPLE_EDGE)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -36,7 +41,7 @@ STAGE PLANS:
                         Map-reduce partition columns: _col0 (type: int)
                         Statistics: Num rows: 6144 Data size: 1320982 Basic stats: COMPLETE Column stats: NONE
             Execution mode: vectorized
-        Map 4 
+        Map 5 
             Map Operator Tree:
                 TableScan
                   alias: t1
@@ -84,6 +89,17 @@ STAGE PLANS:
                 mode: mergepartial
                 outputColumnNames: _col0, _col1, _col2, _col3
                 Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: NONE
+                Reduce Output Operator
+                  key expressions: _col0 (type: bigint)
+                  sort order: +
+                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: NONE
+                  value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: double)
+        Reducer 4 
+            Reduce Operator Tree:
+              Select Operator
+                expressions: KEY.reducesinkkey0 (type: bigint), VALUE._col0 (type: int), VALUE._col1 (type: int), VALUE._col2 (type: double)
+                outputColumnNames: _col0, _col1, _col2, _col3
+                Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: NONE
                 File Output Operator
                   compressed: false
                   Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: NONE
@@ -91,6 +107,7 @@ STAGE PLANS:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+            Execution mode: vectorized
 
   Stage: Stage-0
     Fetch Operator
@@ -98,15 +115,15 @@ STAGE PLANS:
       Processor Tree:
         ListSink
 
-PREHOOK: query: SELECT COUNT(t1.cint), MAX(t2.cint), MIN(t1.cint), AVG(t1.cint+t2.cint)
+PREHOOK: query: SELECT COUNT(t1.cint), MAX(t2.cint) AS CNT, MIN(t1.cint), AVG(t1.cint+t2.cint)
   FROM alltypesorc t1
-  JOIN alltypesorc t2 ON t1.cint = t2.cint
+  JOIN alltypesorc t2 ON t1.cint = t2.cint order by CNT
 PREHOOK: type: QUERY
 PREHOOK: Input: default@alltypesorc
 #### A masked pattern was here ####
-POSTHOOK: query: SELECT COUNT(t1.cint), MAX(t2.cint), MIN(t1.cint), AVG(t1.cint+t2.cint)
+POSTHOOK: query: SELECT COUNT(t1.cint), MAX(t2.cint) AS CNT, MIN(t1.cint), AVG(t1.cint+t2.cint)
   FROM alltypesorc t1
-  JOIN alltypesorc t2 ON t1.cint = t2.cint
+  JOIN alltypesorc t2 ON t1.cint = t2.cint order by CNT
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/tez/vectorized_timestamp_funcs.q.out b/ql/src/test/results/clientpositive/tez/vectorized_timestamp_funcs.q.out
index 76e6686f8f..b285a4fa19 100644
--- a/ql/src/test/results/clientpositive/tez/vectorized_timestamp_funcs.q.out
+++ b/ql/src/test/results/clientpositive/tez/vectorized_timestamp_funcs.q.out
@@ -18,18 +18,20 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@alltypesorc_string
 PREHOOK: query: INSERT OVERWRITE TABLE alltypesorc_string
 SELECT
-  to_utc_timestamp(ctimestamp1, 'America/Los_Angeles'),
-  CAST(to_utc_timestamp(ctimestamp1, 'America/Los_Angeles') AS STRING)
+  to_utc_timestamp(ctimestamp1, 'America/Los_Angeles') AS toutc,
+  CAST(to_utc_timestamp(ctimestamp1, 'America/Los_Angeles') AS STRING) as cst
 FROM alltypesorc
+ORDER BY toutc, cst
 LIMIT 40
 PREHOOK: type: QUERY
 PREHOOK: Input: default@alltypesorc
 PREHOOK: Output: default@alltypesorc_string
 POSTHOOK: query: INSERT OVERWRITE TABLE alltypesorc_string
 SELECT
-  to_utc_timestamp(ctimestamp1, 'America/Los_Angeles'),
-  CAST(to_utc_timestamp(ctimestamp1, 'America/Los_Angeles') AS STRING)
+  to_utc_timestamp(ctimestamp1, 'America/Los_Angeles') AS toutc,
+  CAST(to_utc_timestamp(ctimestamp1, 'America/Los_Angeles') AS STRING) as cst
 FROM alltypesorc
+ORDER BY toutc, cst
 LIMIT 40
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc
@@ -112,15 +114,15 @@ STAGE PLANS:
             Map Operator Tree:
                 TableScan
                   alias: alltypesorc_string
-                  Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
                   Select Operator
                     expressions: to_unix_timestamp(ctimestamp1) (type: bigint), year(ctimestamp1) (type: int), month(ctimestamp1) (type: int), day(ctimestamp1) (type: int), dayofmonth(ctimestamp1) (type: int), weekofyear(ctimestamp1) (type: int), hour(ctimestamp1) (type: int), minute(ctimestamp1) (type: int), second(ctimestamp1) (type: int)
                     outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
-                    Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
                     Reduce Output Operator
                       key expressions: _col0 (type: bigint)
                       sort order: +
-                      Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+                      Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
                       value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: int), _col6 (type: int), _col7 (type: int), _col8 (type: int)
             Execution mode: vectorized
         Reducer 2 
@@ -128,10 +130,10 @@ STAGE PLANS:
               Select Operator
                 expressions: KEY.reducesinkkey0 (type: bigint), VALUE._col0 (type: int), VALUE._col1 (type: int), VALUE._col2 (type: int), VALUE._col3 (type: int), VALUE._col4 (type: int), VALUE._col5 (type: int), VALUE._col6 (type: int), VALUE._col7 (type: int)
                 outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
-                Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
                 File Output Operator
                   compressed: false
-                  Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
                   table:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -175,45 +177,45 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc_string
 #### A masked pattern was here ####
 NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
-28784	1969	12	31	31	1	23	59	44
-28784	1969	12	31	31	1	23	59	44
-28784	1969	12	31	31	1	23	59	44
-28784	1969	12	31	31	1	23	59	44
-28785	1969	12	31	31	1	23	59	45
-28786	1969	12	31	31	1	23	59	46
-28787	1969	12	31	31	1	23	59	47
-28788	1969	12	31	31	1	23	59	48
-28789	1969	12	31	31	1	23	59	49
-28789	1969	12	31	31	1	23	59	49
-28790	1969	12	31	31	1	23	59	50
-28792	1969	12	31	31	1	23	59	52
-28792	1969	12	31	31	1	23	59	52
-28792	1969	12	31	31	1	23	59	52
-28792	1969	12	31	31	1	23	59	52
-28795	1969	12	31	31	1	23	59	55
-28795	1969	12	31	31	1	23	59	55
-28795	1969	12	31	31	1	23	59	55
-28798	1969	12	31	31	1	23	59	58
-28798	1969	12	31	31	1	23	59	58
-28800	1970	1	1	1	1	0	0	0
-28800	1970	1	1	1	1	0	0	0
-28802	1970	1	1	1	1	0	0	2
-28803	1970	1	1	1	1	0	0	3
-28804	1970	1	1	1	1	0	0	4
-28804	1970	1	1	1	1	0	0	4
-28805	1970	1	1	1	1	0	0	5
-28805	1970	1	1	1	1	0	0	5
-28806	1970	1	1	1	1	0	0	6
-28807	1970	1	1	1	1	0	0	7
-28807	1970	1	1	1	1	0	0	7
-28807	1970	1	1	1	1	0	0	7
-28808	1970	1	1	1	1	0	0	8
-28808	1970	1	1	1	1	0	0	8
-28809	1970	1	1	1	1	0	0	9
-28811	1970	1	1	1	1	0	0	11
-28813	1970	1	1	1	1	0	0	13
-28814	1970	1	1	1	1	0	0	14
-28815	1970	1	1	1	1	0	0	15
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
 PREHOOK: query: EXPLAIN SELECT
   to_unix_timestamp(stimestamp1) AS c1,
   year(stimestamp1),
@@ -255,15 +257,15 @@ STAGE PLANS:
             Map Operator Tree:
                 TableScan
                   alias: alltypesorc_string
-                  Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
                   Select Operator
                     expressions: to_unix_timestamp(stimestamp1) (type: bigint), year(stimestamp1) (type: int), month(stimestamp1) (type: int), day(stimestamp1) (type: int), dayofmonth(stimestamp1) (type: int), weekofyear(stimestamp1) (type: int), hour(stimestamp1) (type: int), minute(stimestamp1) (type: int), second(stimestamp1) (type: int)
                     outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
-                    Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
                     Reduce Output Operator
                       key expressions: _col0 (type: bigint)
                       sort order: +
-                      Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+                      Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
                       value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: int), _col6 (type: int), _col7 (type: int), _col8 (type: int)
             Execution mode: vectorized
         Reducer 2 
@@ -271,10 +273,10 @@ STAGE PLANS:
               Select Operator
                 expressions: KEY.reducesinkkey0 (type: bigint), VALUE._col0 (type: int), VALUE._col1 (type: int), VALUE._col2 (type: int), VALUE._col3 (type: int), VALUE._col4 (type: int), VALUE._col5 (type: int), VALUE._col6 (type: int), VALUE._col7 (type: int)
                 outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
-                Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
                 File Output Operator
                   compressed: false
-                  Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
                   table:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -318,45 +320,45 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc_string
 #### A masked pattern was here ####
 NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
-28784	1969	12	31	31	1	23	59	44
-28784	1969	12	31	31	1	23	59	44
-28784	1969	12	31	31	1	23	59	44
-28784	1969	12	31	31	1	23	59	44
-28785	1969	12	31	31	1	23	59	45
-28786	1969	12	31	31	1	23	59	46
-28787	1969	12	31	31	1	23	59	47
-28788	1969	12	31	31	1	23	59	48
-28789	1969	12	31	31	1	23	59	49
-28789	1969	12	31	31	1	23	59	49
-28790	1969	12	31	31	1	23	59	50
-28792	1969	12	31	31	1	23	59	52
-28792	1969	12	31	31	1	23	59	52
-28792	1969	12	31	31	1	23	59	52
-28792	1969	12	31	31	1	23	59	52
-28795	1969	12	31	31	1	23	59	55
-28795	1969	12	31	31	1	23	59	55
-28795	1969	12	31	31	1	23	59	55
-28798	1969	12	31	31	1	23	59	58
-28798	1969	12	31	31	1	23	59	58
-28800	1970	1	1	1	1	0	0	0
-28800	1970	1	1	1	1	0	0	0
-28802	1970	1	1	1	1	0	0	2
-28803	1970	1	1	1	1	0	0	3
-28804	1970	1	1	1	1	0	0	4
-28804	1970	1	1	1	1	0	0	4
-28805	1970	1	1	1	1	0	0	5
-28805	1970	1	1	1	1	0	0	5
-28806	1970	1	1	1	1	0	0	6
-28807	1970	1	1	1	1	0	0	7
-28807	1970	1	1	1	1	0	0	7
-28807	1970	1	1	1	1	0	0	7
-28808	1970	1	1	1	1	0	0	8
-28808	1970	1	1	1	1	0	0	8
-28809	1970	1	1	1	1	0	0	9
-28811	1970	1	1	1	1	0	0	11
-28813	1970	1	1	1	1	0	0	13
-28814	1970	1	1	1	1	0	0	14
-28815	1970	1	1	1	1	0	0	15
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
 PREHOOK: query: EXPLAIN SELECT
   to_unix_timestamp(ctimestamp1) = to_unix_timestamp(stimestamp1) AS c1,
   year(ctimestamp1) = year(stimestamp1),
@@ -398,15 +400,15 @@ STAGE PLANS:
             Map Operator Tree:
                 TableScan
                   alias: alltypesorc_string
-                  Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
                   Select Operator
                     expressions: (to_unix_timestamp(ctimestamp1) = to_unix_timestamp(stimestamp1)) (type: boolean), (year(ctimestamp1) = year(stimestamp1)) (type: boolean), (month(ctimestamp1) = month(stimestamp1)) (type: boolean), (day(ctimestamp1) = day(stimestamp1)) (type: boolean), (dayofmonth(ctimestamp1) = dayofmonth(stimestamp1)) (type: boolean), (weekofyear(ctimestamp1) = weekofyear(stimestamp1)) (type: boolean), (hour(ctimestamp1) = hour(stimestamp1)) (type: boolean), (minute(ctimestamp1) = minute(stimestamp1)) (type: boolean), (second(ctimestamp1) = second(stimestamp1)) (type: boolean)
                     outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
-                    Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
                     Reduce Output Operator
                       key expressions: _col0 (type: boolean)
                       sort order: +
-                      Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+                      Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
                       value expressions: _col1 (type: boolean), _col2 (type: boolean), _col3 (type: boolean), _col4 (type: boolean), _col5 (type: boolean), _col6 (type: boolean), _col7 (type: boolean), _col8 (type: boolean)
             Execution mode: vectorized
         Reducer 2 
@@ -414,10 +416,10 @@ STAGE PLANS:
               Select Operator
                 expressions: KEY.reducesinkkey0 (type: boolean), VALUE._col0 (type: boolean), VALUE._col1 (type: boolean), VALUE._col2 (type: boolean), VALUE._col3 (type: boolean), VALUE._col4 (type: boolean), VALUE._col5 (type: boolean), VALUE._col6 (type: boolean), VALUE._col7 (type: boolean)
                 outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
-                Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
                 File Output Operator
                   compressed: false
-                  Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
                   table:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -463,45 +465,45 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc_string
 #### A masked pattern was here ####
 NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
 PREHOOK: query: -- Wrong format. Should all be NULL.
 EXPLAIN SELECT
   to_unix_timestamp(stimestamp1) AS c1,
@@ -639,11 +641,11 @@ STAGE PLANS:
             Map Operator Tree:
                 TableScan
                   alias: alltypesorc_string
-                  Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
                   Select Operator
                     expressions: ctimestamp1 (type: timestamp)
                     outputColumnNames: _col0
-                    Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
                     Group By Operator
                       aggregations: min(_col0), max(_col0), count(_col0), count()
                       mode: hash
@@ -694,7 +696,7 @@ FROM alltypesorc_string
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc_string
 #### A masked pattern was here ####
-1969-12-31 23:59:44.088	1970-01-01 00:00:15.007	39	40
+NULL	NULL	0	40
 PREHOOK: query: -- SUM of timestamps are not vectorized reduce-side because they produce a double instead of a long (HIVE-8211)...
 EXPLAIN SELECT
   round(sum(ctimestamp1), 3)
@@ -720,11 +722,11 @@ STAGE PLANS:
             Map Operator Tree:
                 TableScan
                   alias: alltypesorc_string
-                  Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
                   Select Operator
                     expressions: ctimestamp1 (type: timestamp)
                     outputColumnNames: _col0
-                    Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
                     Group By Operator
                       aggregations: sum(_col0)
                       mode: hash
@@ -772,7 +774,7 @@ FROM alltypesorc_string
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc_string
 #### A masked pattern was here ####
-1123143.857
+NULL
 PREHOOK: query: EXPLAIN SELECT
   round(avg(ctimestamp1), 0),
   variance(ctimestamp1) between 8.97077295279421E19 and 8.97077295279422E19,
@@ -810,11 +812,11 @@ STAGE PLANS:
             Map Operator Tree:
                 TableScan
                   alias: alltypesorc_string
-                  Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
                   Select Operator
                     expressions: ctimestamp1 (type: timestamp)
                     outputColumnNames: _col0
-                    Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
                     Group By Operator
                       aggregations: avg(_col0), variance(_col0), var_pop(_col0), var_samp(_col0), std(_col0), stddev(_col0), stddev_pop(_col0), stddev_samp(_col0)
                       mode: hash
@@ -876,4 +878,4 @@ FROM alltypesorc_string
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc_string
 #### A masked pattern was here ####
-2.8798560435897E13	true	true	true	9.471416447815E9	9.471416447815E9	9.471416447815E9	9.595231068211E9
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
diff --git a/ql/src/test/results/clientpositive/update_all_partitioned.q.out b/ql/src/test/results/clientpositive/update_all_partitioned.q.out
index 286e2ed527..4ee1e2e4cf 100644
--- a/ql/src/test/results/clientpositive/update_all_partitioned.q.out
+++ b/ql/src/test/results/clientpositive/update_all_partitioned.q.out
@@ -6,21 +6,21 @@ POSTHOOK: query: create table acid_uap(a int, b varchar(128)) partitioned by (ds
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@acid_uap
-PREHOOK: query: insert into table acid_uap partition (ds='today') select cint, cast(cstring1 as varchar(128)) from alltypesorc where cint is not null and cint < 0 order by cint limit 10
+PREHOOK: query: insert into table acid_uap partition (ds='today') select cint, cast(cstring1 as varchar(128)) as cs from alltypesorc where cint is not null and cint < 0 order by cint, cs limit 10
 PREHOOK: type: QUERY
 PREHOOK: Input: default@alltypesorc
 PREHOOK: Output: default@acid_uap@ds=today
-POSTHOOK: query: insert into table acid_uap partition (ds='today') select cint, cast(cstring1 as varchar(128)) from alltypesorc where cint is not null and cint < 0 order by cint limit 10
+POSTHOOK: query: insert into table acid_uap partition (ds='today') select cint, cast(cstring1 as varchar(128)) as cs from alltypesorc where cint is not null and cint < 0 order by cint, cs limit 10
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc
 POSTHOOK: Output: default@acid_uap@ds=today
 POSTHOOK: Lineage: acid_uap PARTITION(ds=today).a SIMPLE [(alltypesorc)alltypesorc.FieldSchema(name:cint, type:int, comment:null), ]
 POSTHOOK: Lineage: acid_uap PARTITION(ds=today).b EXPRESSION [(alltypesorc)alltypesorc.FieldSchema(name:cstring1, type:string, comment:null), ]
-PREHOOK: query: insert into table acid_uap partition (ds='tomorrow') select cint, cast(cstring1 as varchar(128)) from alltypesorc where cint is not null and cint > 10 order by cint limit 10
+PREHOOK: query: insert into table acid_uap partition (ds='tomorrow') select cint, cast(cstring1 as varchar(128)) as cs from alltypesorc where cint is not null and cint > 10 order by cint, cs limit 10
 PREHOOK: type: QUERY
 PREHOOK: Input: default@alltypesorc
 PREHOOK: Output: default@acid_uap@ds=tomorrow
-POSTHOOK: query: insert into table acid_uap partition (ds='tomorrow') select cint, cast(cstring1 as varchar(128)) from alltypesorc where cint is not null and cint > 10 order by cint limit 10
+POSTHOOK: query: insert into table acid_uap partition (ds='tomorrow') select cint, cast(cstring1 as varchar(128)) as cs from alltypesorc where cint is not null and cint > 10 order by cint, cs limit 10
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc
 POSTHOOK: Output: default@acid_uap@ds=tomorrow
@@ -53,11 +53,11 @@ POSTHOOK: Input: default@acid_uap@ds=tomorrow
 762	BLoMwUJ51ns6pd	tomorrow
 762	a10E76jX35YwquKCTA	tomorrow
 762	q5y2Vy1	tomorrow
+6981	NULL	tomorrow
 6981	1FNNhmiFLGw425NA13g	tomorrow
+6981	4KhrrQ0nJ7bMNTvhSCA	tomorrow
 6981	K630vaVf	tomorrow
-6981	YdG61y00526u5	tomorrow
-6981	a3EhVU6Wuy7ycJ7wY7h2gv	tomorrow
-6981	o4lvY20511w0EOX3P3I82p63	tomorrow
+6981	Y5x3JuI3M8jngv5N	tomorrow
 PREHOOK: query: update acid_uap set b = 'fred'
 PREHOOK: type: QUERY
 PREHOOK: Input: default@acid_uap
diff --git a/ql/src/test/results/clientpositive/update_where_partitioned.q.out b/ql/src/test/results/clientpositive/update_where_partitioned.q.out
index fef0dc08f0..1834e837c1 100644
--- a/ql/src/test/results/clientpositive/update_where_partitioned.q.out
+++ b/ql/src/test/results/clientpositive/update_where_partitioned.q.out
@@ -6,21 +6,21 @@ POSTHOOK: query: create table acid_uwp(a int, b varchar(128)) partitioned by (ds
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@acid_uwp
-PREHOOK: query: insert into table acid_uwp partition (ds='today') select cint, cast(cstring1 as varchar(128)) from alltypesorc where cint is not null and cint < 0 order by cint limit 10
+PREHOOK: query: insert into table acid_uwp partition (ds='today') select cint, cast(cstring1 as varchar(128)) as cs from alltypesorc where cint is not null and cint < 0 order by cint, cs limit 10
 PREHOOK: type: QUERY
 PREHOOK: Input: default@alltypesorc
 PREHOOK: Output: default@acid_uwp@ds=today
-POSTHOOK: query: insert into table acid_uwp partition (ds='today') select cint, cast(cstring1 as varchar(128)) from alltypesorc where cint is not null and cint < 0 order by cint limit 10
+POSTHOOK: query: insert into table acid_uwp partition (ds='today') select cint, cast(cstring1 as varchar(128)) as cs from alltypesorc where cint is not null and cint < 0 order by cint, cs limit 10
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc
 POSTHOOK: Output: default@acid_uwp@ds=today
 POSTHOOK: Lineage: acid_uwp PARTITION(ds=today).a SIMPLE [(alltypesorc)alltypesorc.FieldSchema(name:cint, type:int, comment:null), ]
 POSTHOOK: Lineage: acid_uwp PARTITION(ds=today).b EXPRESSION [(alltypesorc)alltypesorc.FieldSchema(name:cstring1, type:string, comment:null), ]
-PREHOOK: query: insert into table acid_uwp partition (ds='tomorrow') select cint, cast(cstring1 as varchar(128)) from alltypesorc where cint is not null and cint > 100 order by cint limit 10
+PREHOOK: query: insert into table acid_uwp partition (ds='tomorrow') select cint, cast(cstring1 as varchar(128)) as cs from alltypesorc where cint is not null and cint > 100 order by cint, cs limit 10
 PREHOOK: type: QUERY
 PREHOOK: Input: default@alltypesorc
 PREHOOK: Output: default@acid_uwp@ds=tomorrow
-POSTHOOK: query: insert into table acid_uwp partition (ds='tomorrow') select cint, cast(cstring1 as varchar(128)) from alltypesorc where cint is not null and cint > 100 order by cint limit 10
+POSTHOOK: query: insert into table acid_uwp partition (ds='tomorrow') select cint, cast(cstring1 as varchar(128)) as cs from alltypesorc where cint is not null and cint > 100 order by cint, cs limit 10
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc
 POSTHOOK: Output: default@acid_uwp@ds=tomorrow
@@ -53,11 +53,11 @@ POSTHOOK: Input: default@acid_uwp@ds=tomorrow
 762	BLoMwUJ51ns6pd	tomorrow
 762	a10E76jX35YwquKCTA	tomorrow
 762	q5y2Vy1	tomorrow
+6981	NULL	tomorrow
 6981	1FNNhmiFLGw425NA13g	tomorrow
+6981	4KhrrQ0nJ7bMNTvhSCA	tomorrow
 6981	K630vaVf	tomorrow
-6981	YdG61y00526u5	tomorrow
-6981	a3EhVU6Wuy7ycJ7wY7h2gv	tomorrow
-6981	o4lvY20511w0EOX3P3I82p63	tomorrow
+6981	Y5x3JuI3M8jngv5N	tomorrow
 PREHOOK: query: update acid_uwp set b = 'fred' where b = 'k17Am8uPHWk02cEf1jet'
 PREHOOK: type: QUERY
 PREHOOK: Input: default@acid_uwp
@@ -99,8 +99,8 @@ POSTHOOK: Input: default@acid_uwp@ds=tomorrow
 762	BLoMwUJ51ns6pd	tomorrow
 762	a10E76jX35YwquKCTA	tomorrow
 762	q5y2Vy1	tomorrow
+6981	NULL	tomorrow
 6981	1FNNhmiFLGw425NA13g	tomorrow
+6981	4KhrrQ0nJ7bMNTvhSCA	tomorrow
 6981	K630vaVf	tomorrow
-6981	YdG61y00526u5	tomorrow
-6981	a3EhVU6Wuy7ycJ7wY7h2gv	tomorrow
-6981	o4lvY20511w0EOX3P3I82p63	tomorrow
+6981	Y5x3JuI3M8jngv5N	tomorrow
diff --git a/ql/src/test/results/clientpositive/vector_data_types.q.out b/ql/src/test/results/clientpositive/vector_data_types.q.out
index 65aa5e9b3c..3ed833bb10 100644
--- a/ql/src/test/results/clientpositive/vector_data_types.q.out
+++ b/ql/src/test/results/clientpositive/vector_data_types.q.out
@@ -97,9 +97,9 @@ POSTHOOK: Lineage: over1korc.s SIMPLE [(over1k)over1k.FieldSchema(name:s, type:s
 POSTHOOK: Lineage: over1korc.si SIMPLE [(over1k)over1k.FieldSchema(name:si, type:smallint, comment:null), ]
 POSTHOOK: Lineage: over1korc.t SIMPLE [(over1k)over1k.FieldSchema(name:t, type:tinyint, comment:null), ]
 POSTHOOK: Lineage: over1korc.ts SIMPLE [(over1k)over1k.FieldSchema(name:ts, type:timestamp, comment:null), ]
-PREHOOK: query: EXPLAIN SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY i LIMIT 20
+PREHOOK: query: EXPLAIN SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY t, si, i LIMIT 20
 PREHOOK: type: QUERY
-POSTHOOK: query: EXPLAIN SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY i LIMIT 20
+POSTHOOK: query: EXPLAIN SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY t, si, i LIMIT 20
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
@@ -117,13 +117,13 @@ STAGE PLANS:
               outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
               Statistics: Num rows: 1049 Data size: 311170 Basic stats: COMPLETE Column stats: NONE
               Reduce Output Operator
-                key expressions: _col2 (type: int)
-                sort order: +
+                key expressions: _col0 (type: tinyint), _col1 (type: smallint), _col2 (type: int)
+                sort order: +++
                 Statistics: Num rows: 1049 Data size: 311170 Basic stats: COMPLETE Column stats: NONE
-                value expressions: _col0 (type: tinyint), _col1 (type: smallint), _col3 (type: bigint), _col4 (type: float), _col5 (type: double), _col6 (type: boolean), _col7 (type: string), _col8 (type: timestamp), _col9 (type: decimal(4,2)), _col10 (type: binary)
+                value expressions: _col3 (type: bigint), _col4 (type: float), _col5 (type: double), _col6 (type: boolean), _col7 (type: string), _col8 (type: timestamp), _col9 (type: decimal(4,2)), _col10 (type: binary)
       Reduce Operator Tree:
         Select Operator
-          expressions: VALUE._col0 (type: tinyint), VALUE._col1 (type: smallint), KEY.reducesinkkey0 (type: int), VALUE._col2 (type: bigint), VALUE._col3 (type: float), VALUE._col4 (type: double), VALUE._col5 (type: boolean), VALUE._col6 (type: string), VALUE._col7 (type: timestamp), VALUE._col8 (type: decimal(4,2)), VALUE._col9 (type: binary)
+          expressions: KEY.reducesinkkey0 (type: tinyint), KEY.reducesinkkey1 (type: smallint), KEY.reducesinkkey2 (type: int), VALUE._col0 (type: bigint), VALUE._col1 (type: float), VALUE._col2 (type: double), VALUE._col3 (type: boolean), VALUE._col4 (type: string), VALUE._col5 (type: timestamp), VALUE._col6 (type: decimal(4,2)), VALUE._col7 (type: binary)
           outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
           Statistics: Num rows: 1049 Data size: 311170 Basic stats: COMPLETE Column stats: NONE
           Limit
@@ -143,48 +143,48 @@ STAGE PLANS:
       Processor Tree:
         ListSink
 
-PREHOOK: query: SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY i LIMIT 20
+PREHOOK: query: SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY t, si, i LIMIT 20
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over1korc
 #### A masked pattern was here ####
-POSTHOOK: query: SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY i LIMIT 20
+POSTHOOK: query: SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY t, si, i LIMIT 20
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1korc
 #### A masked pattern was here ####
-108	301	65536	4294967357	90.05	17.59	true	ethan johnson	2013-03-01 09:11:58.703271	75.7	undecided
-118	497	65536	4294967381	50.32	12.72	false	david nixon	2013-03-01 09:11:58.703285	83.48	values clariffication
-18	280	65536	4294967320	32.92	45.94	false	holly white	2013-03-01 09:11:58.703086	58.86	topology
-69	489	65536	4294967404	33.52	17.99	false	oscar ichabod	2013-03-01 09:11:58.703247	32.68	topology
-27	405	65536	4294967508	82.24	29.41	true	oscar ovid	2013-03-01 09:11:58.703166	16.85	biology
-42	495	65536	4294967431	43.57	46.81	false	tom johnson	2013-03-01 09:11:58.703245	62.25	american history
+NULL	374	65560	4294967516	65.43	22.48	true	oscar quirinius	2013-03-01 09:11:58.703316	16.86	mathematics
 NULL	409	65536	4294967490	46.97	25.92	false	fred miller	2013-03-01 09:11:58.703116	33.45	history
-59	431	65537	4294967326	11.34	2.9	true	oscar robinson	2013-03-01 09:11:58.703161	81.04	zync studies
-63	458	65537	4294967463	21.94	49.71	true	fred van buren	2013-03-01 09:11:58.703278	99.34	wind surfing
-121	355	65537	4294967437	85.9	10.99	true	calvin brown	2013-03-01 09:11:58.703254	4.49	yard duty
-72	267	65537	4294967460	55.2	42.89	false	oscar carson	2013-03-01 09:11:58.703153	51.91	topology
-22	264	65537	4294967419	8.07	10.71	false	david xylophone	2013-03-01 09:11:58.703136	11.87	undecided
-101	283	65538	4294967527	84.03	27.29	true	yuri brown	2013-03-01 09:11:58.703306	44.24	biology
-109	376	65538	4294967453	59.61	35.62	true	priscilla xylophone	2013-03-01 09:11:58.703286	9.53	study skills
-83	353	65538	4294967339	0.08	23.91	true	holly thompson	2013-03-01 09:11:58.703157	30.27	quiet hour
-29	331	65539	4294967420	73.18	28.96	true	ethan brown	2013-03-01 09:11:58.703094	58.85	zync studies
-70	430	65539	4294967534	18.89	43.84	true	tom carson	2013-03-01 09:11:58.703182	21.93	joggying
-120	331	65539	4294967324	88.02	40.94	true	holly nixon	2013-03-01 09:11:58.703262	96.64	yard duty
-71	298	65540	4294967510	91.63	9.6	false	gabriella zipper	2013-03-01 09:11:58.70314	68.14	geology
-114	385	65541	4294967458	73.48	34.97	true	oscar quirinius	2013-03-01 09:11:58.703143	72.33	xylophone band
+NULL	473	65720	4294967324	80.74	40.6	false	holly falkner	2013-03-01 09:11:58.703111	18.8	mathematics
+-3	275	65622	4294967302	71.78	8.49	false	wendy robinson	2013-03-01 09:11:58.703294	95.39	undecided
+-3	344	65733	4294967363	0.56	11.96	true	rachel thompson	2013-03-01 09:11:58.703276	88.46	wind surfing
+-3	376	65548	4294967431	96.78	43.23	false	fred ellison	2013-03-01 09:11:58.703233	75.39	education
+-3	438	65618	4294967398	62.39	4.62	false	victor xylophone	2013-03-01 09:11:58.703135	88.38	values clariffication
+-3	458	65696	4294967418	45.24	8.49	false	irene ellison	2013-03-01 09:11:58.703092	54.02	american history
+-3	467	65575	4294967437	81.64	23.53	true	tom hernandez	2013-03-01 09:11:58.703188	32.85	study skills
+-2	261	65603	4294967332	39.18	28.98	false	fred polk	2013-03-01 09:11:58.70331	69.26	opthamology
+-2	269	65681	4294967544	99.24	28.19	false	rachel falkner	2013-03-01 09:11:58.703089	41.57	quiet hour
+-2	288	65658	4294967383	53.78	19.92	false	holly nixon	2013-03-01 09:11:58.703224	42.93	industrial engineering
+-2	304	65629	4294967386	84.38	33.49	false	zach garcia	2013-03-01 09:11:58.703264	56.99	chemistry
+-2	340	65627	4294967533	76.52	21.91	true	quinn laertes	2013-03-01 09:11:58.703178	93.29	xylophone band
+-2	427	65666	4294967465	19.69	33.24	true	bob xylophone	2013-03-01 09:11:58.703219	32.73	joggying
+-2	429	65664	4294967441	45.19	40.43	false	wendy king	2013-03-01 09:11:58.703265	11.46	industrial engineering
+-2	461	65648	4294967425	58.52	24.85	false	rachel thompson	2013-03-01 09:11:58.703318	85.62	zync studies
+-1	268	65778	4294967418	56.33	44.73	true	calvin falkner	2013-03-01 09:11:58.70322	7.37	history
+-1	281	65643	4294967323	15.1	45.0	false	irene nixon	2013-03-01 09:11:58.703223	80.96	undecided
+-1	300	65663	4294967343	71.26	34.62	true	calvin ovid	2013-03-01 09:11:58.703262	78.56	study skills
 PREHOOK: query: SELECT SUM(HASH(*))
-FROM (SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY i) as q
+FROM (SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY t, si, i) as q
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over1korc
 #### A masked pattern was here ####
 POSTHOOK: query: SELECT SUM(HASH(*))
-FROM (SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY i) as q
+FROM (SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY t, si, i) as q
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1korc
 #### A masked pattern was here ####
 -17045922556
-PREHOOK: query: EXPLAIN select t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY i LIMIT 20
+PREHOOK: query: EXPLAIN select t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY t, si, i LIMIT 20
 PREHOOK: type: QUERY
-POSTHOOK: query: EXPLAIN select t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY i LIMIT 20
+POSTHOOK: query: EXPLAIN select t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY t, si, i LIMIT 20
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
@@ -202,14 +202,14 @@ STAGE PLANS:
               outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
               Statistics: Num rows: 1049 Data size: 311170 Basic stats: COMPLETE Column stats: NONE
               Reduce Output Operator
-                key expressions: _col2 (type: int)
-                sort order: +
+                key expressions: _col0 (type: tinyint), _col1 (type: smallint), _col2 (type: int)
+                sort order: +++
                 Statistics: Num rows: 1049 Data size: 311170 Basic stats: COMPLETE Column stats: NONE
-                value expressions: _col0 (type: tinyint), _col1 (type: smallint), _col3 (type: bigint), _col4 (type: float), _col5 (type: double), _col6 (type: boolean), _col7 (type: string), _col8 (type: timestamp), _col9 (type: decimal(4,2)), _col10 (type: binary)
+                value expressions: _col3 (type: bigint), _col4 (type: float), _col5 (type: double), _col6 (type: boolean), _col7 (type: string), _col8 (type: timestamp), _col9 (type: decimal(4,2)), _col10 (type: binary)
       Execution mode: vectorized
       Reduce Operator Tree:
         Select Operator
-          expressions: VALUE._col0 (type: tinyint), VALUE._col1 (type: smallint), KEY.reducesinkkey0 (type: int), VALUE._col2 (type: bigint), VALUE._col3 (type: float), VALUE._col4 (type: double), VALUE._col5 (type: boolean), VALUE._col6 (type: string), VALUE._col7 (type: timestamp), VALUE._col8 (type: decimal(4,2)), VALUE._col9 (type: binary)
+          expressions: KEY.reducesinkkey0 (type: tinyint), KEY.reducesinkkey1 (type: smallint), KEY.reducesinkkey2 (type: int), VALUE._col0 (type: bigint), VALUE._col1 (type: float), VALUE._col2 (type: double), VALUE._col3 (type: boolean), VALUE._col4 (type: string), VALUE._col5 (type: timestamp), VALUE._col6 (type: decimal(4,2)), VALUE._col7 (type: binary)
           outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
           Statistics: Num rows: 1049 Data size: 311170 Basic stats: COMPLETE Column stats: NONE
           Limit
@@ -229,41 +229,41 @@ STAGE PLANS:
       Processor Tree:
         ListSink
 
-PREHOOK: query: SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY i LIMIT 20
+PREHOOK: query: SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY t, si, i LIMIT 20
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over1korc
 #### A masked pattern was here ####
-POSTHOOK: query: SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY i LIMIT 20
+POSTHOOK: query: SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY t, si, i LIMIT 20
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1korc
 #### A masked pattern was here ####
-108	301	65536	4294967357	90.05	17.59	true	ethan johnson	2013-03-01 09:11:58.703271	75.7	undecided
-118	497	65536	4294967381	50.32	12.72	false	david nixon	2013-03-01 09:11:58.703285	83.48	values clariffication
-18	280	65536	4294967320	32.92	45.94	false	holly white	2013-03-01 09:11:58.703086	58.86	topology
-69	489	65536	4294967404	33.52	17.99	false	oscar ichabod	2013-03-01 09:11:58.703247	32.68	topology
-27	405	65536	4294967508	82.24	29.41	true	oscar ovid	2013-03-01 09:11:58.703166	16.85	biology
-42	495	65536	4294967431	43.57	46.81	false	tom johnson	2013-03-01 09:11:58.703245	62.25	american history
+NULL	374	65560	4294967516	65.43	22.48	true	oscar quirinius	2013-03-01 09:11:58.703316	16.86	mathematics
 NULL	409	65536	4294967490	46.97	25.92	false	fred miller	2013-03-01 09:11:58.703116	33.45	history
-59	431	65537	4294967326	11.34	2.9	true	oscar robinson	2013-03-01 09:11:58.703161	81.04	zync studies
-63	458	65537	4294967463	21.94	49.71	true	fred van buren	2013-03-01 09:11:58.703278	99.34	wind surfing
-121	355	65537	4294967437	85.9	10.99	true	calvin brown	2013-03-01 09:11:58.703254	4.49	yard duty
-72	267	65537	4294967460	55.2	42.89	false	oscar carson	2013-03-01 09:11:58.703153	51.91	topology
-22	264	65537	4294967419	8.07	10.71	false	david xylophone	2013-03-01 09:11:58.703136	11.87	undecided
-101	283	65538	4294967527	84.03	27.29	true	yuri brown	2013-03-01 09:11:58.703306	44.24	biology
-109	376	65538	4294967453	59.61	35.62	true	priscilla xylophone	2013-03-01 09:11:58.703286	9.53	study skills
-83	353	65538	4294967339	0.08	23.91	true	holly thompson	2013-03-01 09:11:58.703157	30.27	quiet hour
-29	331	65539	4294967420	73.18	28.96	true	ethan brown	2013-03-01 09:11:58.703094	58.85	zync studies
-70	430	65539	4294967534	18.89	43.84	true	tom carson	2013-03-01 09:11:58.703182	21.93	joggying
-120	331	65539	4294967324	88.02	40.94	true	holly nixon	2013-03-01 09:11:58.703262	96.64	yard duty
-71	298	65540	4294967510	91.63	9.6	false	gabriella zipper	2013-03-01 09:11:58.70314	68.14	geology
-114	385	65541	4294967458	73.48	34.97	true	oscar quirinius	2013-03-01 09:11:58.703143	72.33	xylophone band
+NULL	473	65720	4294967324	80.74	40.6	false	holly falkner	2013-03-01 09:11:58.703111	18.8	mathematics
+-3	275	65622	4294967302	71.78	8.49	false	wendy robinson	2013-03-01 09:11:58.703294	95.39	undecided
+-3	344	65733	4294967363	0.56	11.96	true	rachel thompson	2013-03-01 09:11:58.703276	88.46	wind surfing
+-3	376	65548	4294967431	96.78	43.23	false	fred ellison	2013-03-01 09:11:58.703233	75.39	education
+-3	438	65618	4294967398	62.39	4.62	false	victor xylophone	2013-03-01 09:11:58.703135	88.38	values clariffication
+-3	458	65696	4294967418	45.24	8.49	false	irene ellison	2013-03-01 09:11:58.703092	54.02	american history
+-3	467	65575	4294967437	81.64	23.53	true	tom hernandez	2013-03-01 09:11:58.703188	32.85	study skills
+-2	261	65603	4294967332	39.18	28.98	false	fred polk	2013-03-01 09:11:58.70331	69.26	opthamology
+-2	269	65681	4294967544	99.24	28.19	false	rachel falkner	2013-03-01 09:11:58.703089	41.57	quiet hour
+-2	288	65658	4294967383	53.78	19.92	false	holly nixon	2013-03-01 09:11:58.703224	42.93	industrial engineering
+-2	304	65629	4294967386	84.38	33.49	false	zach garcia	2013-03-01 09:11:58.703264	56.99	chemistry
+-2	340	65627	4294967533	76.52	21.91	true	quinn laertes	2013-03-01 09:11:58.703178	93.29	xylophone band
+-2	427	65666	4294967465	19.69	33.24	true	bob xylophone	2013-03-01 09:11:58.703219	32.73	joggying
+-2	429	65664	4294967441	45.19	40.43	false	wendy king	2013-03-01 09:11:58.703265	11.46	industrial engineering
+-2	461	65648	4294967425	58.52	24.85	false	rachel thompson	2013-03-01 09:11:58.703318	85.62	zync studies
+-1	268	65778	4294967418	56.33	44.73	true	calvin falkner	2013-03-01 09:11:58.70322	7.37	history
+-1	281	65643	4294967323	15.1	45.0	false	irene nixon	2013-03-01 09:11:58.703223	80.96	undecided
+-1	300	65663	4294967343	71.26	34.62	true	calvin ovid	2013-03-01 09:11:58.703262	78.56	study skills
 PREHOOK: query: SELECT SUM(HASH(*))
-FROM (SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY i) as q
+FROM (SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY t, si, i) as q
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over1korc
 #### A masked pattern was here ####
 POSTHOOK: query: SELECT SUM(HASH(*))
-FROM (SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY i) as q
+FROM (SELECT t, si, i, b, f, d, bo, s, ts, dec, bin FROM over1korc ORDER BY t, si, i) as q
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@over1korc
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/vector_null_projection.q.out b/ql/src/test/results/clientpositive/vector_null_projection.q.out
index 7c3136f4cf..c787fd4062 100644
--- a/ql/src/test/results/clientpositive/vector_null_projection.q.out
+++ b/ql/src/test/results/clientpositive/vector_null_projection.q.out
@@ -1,8 +1,12 @@
-PREHOOK: query: create table a(s string) stored as orc
+PREHOOK: query: -- SORT_QUERY_RESULTS
+
+create table a(s string) stored as orc
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@a
-POSTHOOK: query: create table a(s string) stored as orc
+POSTHOOK: query: -- SORT_QUERY_RESULTS
+
+create table a(s string) stored as orc
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@a
diff --git a/ql/src/test/results/clientpositive/vector_outer_join1.q.out b/ql/src/test/results/clientpositive/vector_outer_join1.q.out
index 53e37ce743..c7c89ba474 100644
--- a/ql/src/test/results/clientpositive/vector_outer_join1.q.out
+++ b/ql/src/test/results/clientpositive/vector_outer_join1.q.out
@@ -1,39 +1,39 @@
-PREHOOK: query: create table small_alltypesorc1a as select * from alltypesorc where cint is not null and ctinyint is not null limit 5
+PREHOOK: query: create table small_alltypesorc1a as select * from alltypesorc where cint is not null and ctinyint is not null order by cint, ctinyint limit 5
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@alltypesorc
 PREHOOK: Output: database:default
 PREHOOK: Output: default@small_alltypesorc1a
-POSTHOOK: query: create table small_alltypesorc1a as select * from alltypesorc where cint is not null and ctinyint is not null limit 5
+POSTHOOK: query: create table small_alltypesorc1a as select * from alltypesorc where cint is not null and ctinyint is not null order by cint, ctinyint limit 5
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@alltypesorc
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@small_alltypesorc1a
-PREHOOK: query: create table small_alltypesorc2a as select * from alltypesorc where cint is null and ctinyint is not null limit 5
+PREHOOK: query: create table small_alltypesorc2a as select * from alltypesorc where cint is null and ctinyint is not null order by cint, ctinyint limit 5
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@alltypesorc
 PREHOOK: Output: database:default
 PREHOOK: Output: default@small_alltypesorc2a
-POSTHOOK: query: create table small_alltypesorc2a as select * from alltypesorc where cint is null and ctinyint is not null limit 5
+POSTHOOK: query: create table small_alltypesorc2a as select * from alltypesorc where cint is null and ctinyint is not null order by cint, ctinyint limit 5
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@alltypesorc
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@small_alltypesorc2a
-PREHOOK: query: create table small_alltypesorc3a as select * from alltypesorc where cint is not null and ctinyint is null limit 5
+PREHOOK: query: create table small_alltypesorc3a as select * from alltypesorc where cint is not null and ctinyint is null order by cint, ctinyint limit 5
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@alltypesorc
 PREHOOK: Output: database:default
 PREHOOK: Output: default@small_alltypesorc3a
-POSTHOOK: query: create table small_alltypesorc3a as select * from alltypesorc where cint is not null and ctinyint is null limit 5
+POSTHOOK: query: create table small_alltypesorc3a as select * from alltypesorc where cint is not null and ctinyint is null order by cint, ctinyint limit 5
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@alltypesorc
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@small_alltypesorc3a
-PREHOOK: query: create table small_alltypesorc4a as select * from alltypesorc where cint is null and ctinyint is null limit 5
+PREHOOK: query: create table small_alltypesorc4a as select * from alltypesorc where cint is null and ctinyint is null order by cint, ctinyint limit 5
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@alltypesorc
 PREHOOK: Output: database:default
 PREHOOK: Output: default@small_alltypesorc4a
-POSTHOOK: query: create table small_alltypesorc4a as select * from alltypesorc where cint is null and ctinyint is null limit 5
+POSTHOOK: query: create table small_alltypesorc4a as select * from alltypesorc where cint is null and ctinyint is null order by cint, ctinyint limit 5
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@alltypesorc
 POSTHOOK: Output: database:default
@@ -112,11 +112,11 @@ STAGE PLANS:
         $hdt$_1:c 
           TableScan
             alias: c
-            Statistics: Num rows: 15 Data size: 2772 Basic stats: COMPLETE Column stats: NONE
+            Statistics: Num rows: 15 Data size: 3700 Basic stats: COMPLETE Column stats: NONE
             Select Operator
               expressions: ctinyint (type: tinyint), csmallint (type: smallint), cint (type: int), cbigint (type: bigint), cfloat (type: float), cdouble (type: double), cstring1 (type: string), cstring2 (type: string), ctimestamp1 (type: timestamp), ctimestamp2 (type: timestamp), cboolean1 (type: boolean), cboolean2 (type: boolean)
               outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11
-              Statistics: Num rows: 15 Data size: 2772 Basic stats: COMPLETE Column stats: NONE
+              Statistics: Num rows: 15 Data size: 3700 Basic stats: COMPLETE Column stats: NONE
               HashTable Sink Operator
                 keys:
                   0 _col2 (type: int)
@@ -127,11 +127,11 @@ STAGE PLANS:
       Map Operator Tree:
           TableScan
             alias: c
-            Statistics: Num rows: 15 Data size: 2772 Basic stats: COMPLETE Column stats: NONE
+            Statistics: Num rows: 15 Data size: 3700 Basic stats: COMPLETE Column stats: NONE
             Select Operator
               expressions: ctinyint (type: tinyint), csmallint (type: smallint), cint (type: int), cbigint (type: bigint), cfloat (type: float), cdouble (type: double), cstring1 (type: string), cstring2 (type: string), ctimestamp1 (type: timestamp), ctimestamp2 (type: timestamp), cboolean1 (type: boolean), cboolean2 (type: boolean)
               outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11
-              Statistics: Num rows: 15 Data size: 2772 Basic stats: COMPLETE Column stats: NONE
+              Statistics: Num rows: 15 Data size: 3700 Basic stats: COMPLETE Column stats: NONE
               Map Join Operator
                 condition map:
                      Left Outer Join0 to 1
@@ -139,10 +139,10 @@ STAGE PLANS:
                   0 _col2 (type: int)
                   1 _col2 (type: int)
                 outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21, _col22, _col23
-                Statistics: Num rows: 16 Data size: 3049 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 16 Data size: 4070 Basic stats: COMPLETE Column stats: NONE
                 File Output Operator
                   compressed: false
-                  Statistics: Num rows: 16 Data size: 3049 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 16 Data size: 4070 Basic stats: COMPLETE Column stats: NONE
                   table:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -175,111 +175,21 @@ left outer join small_alltypesorc_a cd
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@small_alltypesorc_a
 #### A masked pattern was here ####
--21	-200	NULL	NULL	-21.0	-200.0	NULL	NULL	1969-12-31 16:00:09.052	1969-12-31 15:59:55.451	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
--28	-15813	528534767	NULL	-28.0	-15813.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:55.787	1969-12-31 16:00:01.546	true	NULL	-28	-15813	528534767	NULL	-28.0	-15813.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:55.787	1969-12-31 16:00:01.546	true	NULL
--28	-15813	528534767	NULL	-28.0	-15813.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:55.787	1969-12-31 16:00:01.546	true	NULL	-34	15007	528534767	NULL	-34.0	15007.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:50.434	1969-12-31 16:00:13.352	true	NULL
--28	-15813	528534767	NULL	-28.0	-15813.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:55.787	1969-12-31 16:00:01.546	true	NULL	-50	-13326	528534767	NULL	-50.0	-13326.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:46.674	1969-12-31 16:00:08.875	true	NULL
--28	-15813	528534767	NULL	-28.0	-15813.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:55.787	1969-12-31 16:00:01.546	true	NULL	29	7021	528534767	NULL	29.0	7021.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 16:00:15.007	1969-12-31 16:00:15.148	true	NULL
--28	-15813	528534767	NULL	-28.0	-15813.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:55.787	1969-12-31 16:00:01.546	true	NULL	31	-9566	528534767	NULL	31.0	-9566.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:44.187	1969-12-31 16:00:06.961	true	NULL
--28	-15813	528534767	NULL	-28.0	-15813.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:55.787	1969-12-31 16:00:01.546	true	NULL	NULL	-11534	528534767	NULL	NULL	-11534.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 15:59:55.407	true	NULL
--28	-15813	528534767	NULL	-28.0	-15813.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:55.787	1969-12-31 16:00:01.546	true	NULL	NULL	-3012	528534767	NULL	NULL	-3012.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:03.756	true	NULL
--28	-15813	528534767	NULL	-28.0	-15813.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:55.787	1969-12-31 16:00:01.546	true	NULL	NULL	-4016	528534767	NULL	NULL	-4016.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:07.209	true	NULL
--28	-15813	528534767	NULL	-28.0	-15813.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:55.787	1969-12-31 16:00:01.546	true	NULL	NULL	-4213	528534767	NULL	NULL	-4213.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.589	true	NULL
--28	-15813	528534767	NULL	-28.0	-15813.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:55.787	1969-12-31 16:00:01.546	true	NULL	NULL	-6147	528534767	NULL	NULL	-6147.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.839	true	NULL
--34	15007	528534767	NULL	-34.0	15007.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:50.434	1969-12-31 16:00:13.352	true	NULL	-28	-15813	528534767	NULL	-28.0	-15813.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:55.787	1969-12-31 16:00:01.546	true	NULL
--34	15007	528534767	NULL	-34.0	15007.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:50.434	1969-12-31 16:00:13.352	true	NULL	-34	15007	528534767	NULL	-34.0	15007.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:50.434	1969-12-31 16:00:13.352	true	NULL
--34	15007	528534767	NULL	-34.0	15007.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:50.434	1969-12-31 16:00:13.352	true	NULL	-50	-13326	528534767	NULL	-50.0	-13326.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:46.674	1969-12-31 16:00:08.875	true	NULL
--34	15007	528534767	NULL	-34.0	15007.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:50.434	1969-12-31 16:00:13.352	true	NULL	29	7021	528534767	NULL	29.0	7021.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 16:00:15.007	1969-12-31 16:00:15.148	true	NULL
--34	15007	528534767	NULL	-34.0	15007.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:50.434	1969-12-31 16:00:13.352	true	NULL	31	-9566	528534767	NULL	31.0	-9566.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:44.187	1969-12-31 16:00:06.961	true	NULL
--34	15007	528534767	NULL	-34.0	15007.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:50.434	1969-12-31 16:00:13.352	true	NULL	NULL	-11534	528534767	NULL	NULL	-11534.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 15:59:55.407	true	NULL
--34	15007	528534767	NULL	-34.0	15007.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:50.434	1969-12-31 16:00:13.352	true	NULL	NULL	-3012	528534767	NULL	NULL	-3012.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:03.756	true	NULL
--34	15007	528534767	NULL	-34.0	15007.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:50.434	1969-12-31 16:00:13.352	true	NULL	NULL	-4016	528534767	NULL	NULL	-4016.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:07.209	true	NULL
--34	15007	528534767	NULL	-34.0	15007.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:50.434	1969-12-31 16:00:13.352	true	NULL	NULL	-4213	528534767	NULL	NULL	-4213.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.589	true	NULL
--34	15007	528534767	NULL	-34.0	15007.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:50.434	1969-12-31 16:00:13.352	true	NULL	NULL	-6147	528534767	NULL	NULL	-6147.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.839	true	NULL
--50	-13326	528534767	NULL	-50.0	-13326.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:46.674	1969-12-31 16:00:08.875	true	NULL	-28	-15813	528534767	NULL	-28.0	-15813.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:55.787	1969-12-31 16:00:01.546	true	NULL
--50	-13326	528534767	NULL	-50.0	-13326.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:46.674	1969-12-31 16:00:08.875	true	NULL	-34	15007	528534767	NULL	-34.0	15007.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:50.434	1969-12-31 16:00:13.352	true	NULL
--50	-13326	528534767	NULL	-50.0	-13326.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:46.674	1969-12-31 16:00:08.875	true	NULL	-50	-13326	528534767	NULL	-50.0	-13326.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:46.674	1969-12-31 16:00:08.875	true	NULL
--50	-13326	528534767	NULL	-50.0	-13326.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:46.674	1969-12-31 16:00:08.875	true	NULL	29	7021	528534767	NULL	29.0	7021.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 16:00:15.007	1969-12-31 16:00:15.148	true	NULL
--50	-13326	528534767	NULL	-50.0	-13326.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:46.674	1969-12-31 16:00:08.875	true	NULL	31	-9566	528534767	NULL	31.0	-9566.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:44.187	1969-12-31 16:00:06.961	true	NULL
--50	-13326	528534767	NULL	-50.0	-13326.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:46.674	1969-12-31 16:00:08.875	true	NULL	NULL	-11534	528534767	NULL	NULL	-11534.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 15:59:55.407	true	NULL
--50	-13326	528534767	NULL	-50.0	-13326.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:46.674	1969-12-31 16:00:08.875	true	NULL	NULL	-3012	528534767	NULL	NULL	-3012.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:03.756	true	NULL
--50	-13326	528534767	NULL	-50.0	-13326.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:46.674	1969-12-31 16:00:08.875	true	NULL	NULL	-4016	528534767	NULL	NULL	-4016.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:07.209	true	NULL
--50	-13326	528534767	NULL	-50.0	-13326.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:46.674	1969-12-31 16:00:08.875	true	NULL	NULL	-4213	528534767	NULL	NULL	-4213.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.589	true	NULL
--50	-13326	528534767	NULL	-50.0	-13326.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:46.674	1969-12-31 16:00:08.875	true	NULL	NULL	-6147	528534767	NULL	NULL	-6147.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.839	true	NULL
-29	7021	528534767	NULL	29.0	7021.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 16:00:15.007	1969-12-31 16:00:15.148	true	NULL	-28	-15813	528534767	NULL	-28.0	-15813.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:55.787	1969-12-31 16:00:01.546	true	NULL
-29	7021	528534767	NULL	29.0	7021.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 16:00:15.007	1969-12-31 16:00:15.148	true	NULL	-34	15007	528534767	NULL	-34.0	15007.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:50.434	1969-12-31 16:00:13.352	true	NULL
-29	7021	528534767	NULL	29.0	7021.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 16:00:15.007	1969-12-31 16:00:15.148	true	NULL	-50	-13326	528534767	NULL	-50.0	-13326.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:46.674	1969-12-31 16:00:08.875	true	NULL
-29	7021	528534767	NULL	29.0	7021.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 16:00:15.007	1969-12-31 16:00:15.148	true	NULL	29	7021	528534767	NULL	29.0	7021.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 16:00:15.007	1969-12-31 16:00:15.148	true	NULL
-29	7021	528534767	NULL	29.0	7021.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 16:00:15.007	1969-12-31 16:00:15.148	true	NULL	31	-9566	528534767	NULL	31.0	-9566.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:44.187	1969-12-31 16:00:06.961	true	NULL
-29	7021	528534767	NULL	29.0	7021.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 16:00:15.007	1969-12-31 16:00:15.148	true	NULL	NULL	-11534	528534767	NULL	NULL	-11534.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 15:59:55.407	true	NULL
-29	7021	528534767	NULL	29.0	7021.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 16:00:15.007	1969-12-31 16:00:15.148	true	NULL	NULL	-3012	528534767	NULL	NULL	-3012.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:03.756	true	NULL
-29	7021	528534767	NULL	29.0	7021.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 16:00:15.007	1969-12-31 16:00:15.148	true	NULL	NULL	-4016	528534767	NULL	NULL	-4016.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:07.209	true	NULL
-29	7021	528534767	NULL	29.0	7021.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 16:00:15.007	1969-12-31 16:00:15.148	true	NULL	NULL	-4213	528534767	NULL	NULL	-4213.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.589	true	NULL
-29	7021	528534767	NULL	29.0	7021.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 16:00:15.007	1969-12-31 16:00:15.148	true	NULL	NULL	-6147	528534767	NULL	NULL	-6147.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.839	true	NULL
-3	-200	NULL	-1438142492	3.0	-200.0	NULL	T8Uakh8tudd1XRG5yKW8Y42H	1969-12-31 16:00:07.648	1969-12-31 15:59:55.451	NULL	true	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
-31	-200	NULL	-245476731	31.0	-200.0	NULL	3E3BxP	1969-12-31 15:59:54.739	1969-12-31 15:59:55.451	NULL	true	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
-31	-9566	528534767	NULL	31.0	-9566.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:44.187	1969-12-31 16:00:06.961	true	NULL	-28	-15813	528534767	NULL	-28.0	-15813.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:55.787	1969-12-31 16:00:01.546	true	NULL
-31	-9566	528534767	NULL	31.0	-9566.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:44.187	1969-12-31 16:00:06.961	true	NULL	-34	15007	528534767	NULL	-34.0	15007.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:50.434	1969-12-31 16:00:13.352	true	NULL
-31	-9566	528534767	NULL	31.0	-9566.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:44.187	1969-12-31 16:00:06.961	true	NULL	-50	-13326	528534767	NULL	-50.0	-13326.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:46.674	1969-12-31 16:00:08.875	true	NULL
-31	-9566	528534767	NULL	31.0	-9566.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:44.187	1969-12-31 16:00:06.961	true	NULL	29	7021	528534767	NULL	29.0	7021.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 16:00:15.007	1969-12-31 16:00:15.148	true	NULL
-31	-9566	528534767	NULL	31.0	-9566.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:44.187	1969-12-31 16:00:06.961	true	NULL	31	-9566	528534767	NULL	31.0	-9566.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:44.187	1969-12-31 16:00:06.961	true	NULL
-31	-9566	528534767	NULL	31.0	-9566.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:44.187	1969-12-31 16:00:06.961	true	NULL	NULL	-11534	528534767	NULL	NULL	-11534.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 15:59:55.407	true	NULL
-31	-9566	528534767	NULL	31.0	-9566.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:44.187	1969-12-31 16:00:06.961	true	NULL	NULL	-3012	528534767	NULL	NULL	-3012.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:03.756	true	NULL
-31	-9566	528534767	NULL	31.0	-9566.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:44.187	1969-12-31 16:00:06.961	true	NULL	NULL	-4016	528534767	NULL	NULL	-4016.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:07.209	true	NULL
-31	-9566	528534767	NULL	31.0	-9566.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:44.187	1969-12-31 16:00:06.961	true	NULL	NULL	-4213	528534767	NULL	NULL	-4213.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.589	true	NULL
-31	-9566	528534767	NULL	31.0	-9566.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:44.187	1969-12-31 16:00:06.961	true	NULL	NULL	-6147	528534767	NULL	NULL	-6147.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.839	true	NULL
-38	-200	NULL	-1090414113	38.0	-200.0	NULL	5oQ43l	1969-12-31 16:00:05.478	1969-12-31 15:59:55.451	NULL	false	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
-38	-200	NULL	1576772382	38.0	-200.0	NULL	X3Ufbt46AUIfHe	1969-12-31 15:59:49.567	1969-12-31 15:59:55.451	NULL	true	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
-NULL	-11534	528534767	NULL	NULL	-11534.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 15:59:55.407	true	NULL	-28	-15813	528534767	NULL	-28.0	-15813.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:55.787	1969-12-31 16:00:01.546	true	NULL
-NULL	-11534	528534767	NULL	NULL	-11534.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 15:59:55.407	true	NULL	-34	15007	528534767	NULL	-34.0	15007.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:50.434	1969-12-31 16:00:13.352	true	NULL
-NULL	-11534	528534767	NULL	NULL	-11534.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 15:59:55.407	true	NULL	-50	-13326	528534767	NULL	-50.0	-13326.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:46.674	1969-12-31 16:00:08.875	true	NULL
-NULL	-11534	528534767	NULL	NULL	-11534.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 15:59:55.407	true	NULL	29	7021	528534767	NULL	29.0	7021.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 16:00:15.007	1969-12-31 16:00:15.148	true	NULL
-NULL	-11534	528534767	NULL	NULL	-11534.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 15:59:55.407	true	NULL	31	-9566	528534767	NULL	31.0	-9566.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:44.187	1969-12-31 16:00:06.961	true	NULL
-NULL	-11534	528534767	NULL	NULL	-11534.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 15:59:55.407	true	NULL	NULL	-11534	528534767	NULL	NULL	-11534.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 15:59:55.407	true	NULL
-NULL	-11534	528534767	NULL	NULL	-11534.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 15:59:55.407	true	NULL	NULL	-3012	528534767	NULL	NULL	-3012.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:03.756	true	NULL
-NULL	-11534	528534767	NULL	NULL	-11534.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 15:59:55.407	true	NULL	NULL	-4016	528534767	NULL	NULL	-4016.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:07.209	true	NULL
-NULL	-11534	528534767	NULL	NULL	-11534.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 15:59:55.407	true	NULL	NULL	-4213	528534767	NULL	NULL	-4213.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.589	true	NULL
-NULL	-11534	528534767	NULL	NULL	-11534.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 15:59:55.407	true	NULL	NULL	-6147	528534767	NULL	NULL	-6147.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.839	true	NULL
-NULL	-3012	528534767	NULL	NULL	-3012.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:03.756	true	NULL	-28	-15813	528534767	NULL	-28.0	-15813.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:55.787	1969-12-31 16:00:01.546	true	NULL
-NULL	-3012	528534767	NULL	NULL	-3012.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:03.756	true	NULL	-34	15007	528534767	NULL	-34.0	15007.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:50.434	1969-12-31 16:00:13.352	true	NULL
-NULL	-3012	528534767	NULL	NULL	-3012.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:03.756	true	NULL	-50	-13326	528534767	NULL	-50.0	-13326.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:46.674	1969-12-31 16:00:08.875	true	NULL
-NULL	-3012	528534767	NULL	NULL	-3012.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:03.756	true	NULL	29	7021	528534767	NULL	29.0	7021.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 16:00:15.007	1969-12-31 16:00:15.148	true	NULL
-NULL	-3012	528534767	NULL	NULL	-3012.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:03.756	true	NULL	31	-9566	528534767	NULL	31.0	-9566.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:44.187	1969-12-31 16:00:06.961	true	NULL
-NULL	-3012	528534767	NULL	NULL	-3012.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:03.756	true	NULL	NULL	-11534	528534767	NULL	NULL	-11534.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 15:59:55.407	true	NULL
-NULL	-3012	528534767	NULL	NULL	-3012.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:03.756	true	NULL	NULL	-3012	528534767	NULL	NULL	-3012.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:03.756	true	NULL
-NULL	-3012	528534767	NULL	NULL	-3012.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:03.756	true	NULL	NULL	-4016	528534767	NULL	NULL	-4016.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:07.209	true	NULL
-NULL	-3012	528534767	NULL	NULL	-3012.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:03.756	true	NULL	NULL	-4213	528534767	NULL	NULL	-4213.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.589	true	NULL
-NULL	-3012	528534767	NULL	NULL	-3012.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:03.756	true	NULL	NULL	-6147	528534767	NULL	NULL	-6147.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.839	true	NULL
-NULL	-4016	528534767	NULL	NULL	-4016.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:07.209	true	NULL	-28	-15813	528534767	NULL	-28.0	-15813.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:55.787	1969-12-31 16:00:01.546	true	NULL
-NULL	-4016	528534767	NULL	NULL	-4016.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:07.209	true	NULL	-34	15007	528534767	NULL	-34.0	15007.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:50.434	1969-12-31 16:00:13.352	true	NULL
-NULL	-4016	528534767	NULL	NULL	-4016.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:07.209	true	NULL	-50	-13326	528534767	NULL	-50.0	-13326.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:46.674	1969-12-31 16:00:08.875	true	NULL
-NULL	-4016	528534767	NULL	NULL	-4016.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:07.209	true	NULL	29	7021	528534767	NULL	29.0	7021.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 16:00:15.007	1969-12-31 16:00:15.148	true	NULL
-NULL	-4016	528534767	NULL	NULL	-4016.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:07.209	true	NULL	31	-9566	528534767	NULL	31.0	-9566.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:44.187	1969-12-31 16:00:06.961	true	NULL
-NULL	-4016	528534767	NULL	NULL	-4016.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:07.209	true	NULL	NULL	-11534	528534767	NULL	NULL	-11534.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 15:59:55.407	true	NULL
-NULL	-4016	528534767	NULL	NULL	-4016.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:07.209	true	NULL	NULL	-3012	528534767	NULL	NULL	-3012.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:03.756	true	NULL
-NULL	-4016	528534767	NULL	NULL	-4016.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:07.209	true	NULL	NULL	-4016	528534767	NULL	NULL	-4016.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:07.209	true	NULL
-NULL	-4016	528534767	NULL	NULL	-4016.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:07.209	true	NULL	NULL	-4213	528534767	NULL	NULL	-4213.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.589	true	NULL
-NULL	-4016	528534767	NULL	NULL	-4016.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:07.209	true	NULL	NULL	-6147	528534767	NULL	NULL	-6147.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.839	true	NULL
-NULL	-4213	528534767	NULL	NULL	-4213.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.589	true	NULL	-28	-15813	528534767	NULL	-28.0	-15813.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:55.787	1969-12-31 16:00:01.546	true	NULL
-NULL	-4213	528534767	NULL	NULL	-4213.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.589	true	NULL	-34	15007	528534767	NULL	-34.0	15007.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:50.434	1969-12-31 16:00:13.352	true	NULL
-NULL	-4213	528534767	NULL	NULL	-4213.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.589	true	NULL	-50	-13326	528534767	NULL	-50.0	-13326.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:46.674	1969-12-31 16:00:08.875	true	NULL
-NULL	-4213	528534767	NULL	NULL	-4213.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.589	true	NULL	29	7021	528534767	NULL	29.0	7021.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 16:00:15.007	1969-12-31 16:00:15.148	true	NULL
-NULL	-4213	528534767	NULL	NULL	-4213.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.589	true	NULL	31	-9566	528534767	NULL	31.0	-9566.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:44.187	1969-12-31 16:00:06.961	true	NULL
-NULL	-4213	528534767	NULL	NULL	-4213.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.589	true	NULL	NULL	-11534	528534767	NULL	NULL	-11534.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 15:59:55.407	true	NULL
-NULL	-4213	528534767	NULL	NULL	-4213.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.589	true	NULL	NULL	-3012	528534767	NULL	NULL	-3012.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:03.756	true	NULL
-NULL	-4213	528534767	NULL	NULL	-4213.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.589	true	NULL	NULL	-4016	528534767	NULL	NULL	-4016.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:07.209	true	NULL
-NULL	-4213	528534767	NULL	NULL	-4213.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.589	true	NULL	NULL	-4213	528534767	NULL	NULL	-4213.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.589	true	NULL
-NULL	-4213	528534767	NULL	NULL	-4213.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.589	true	NULL	NULL	-6147	528534767	NULL	NULL	-6147.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.839	true	NULL
-NULL	-6147	528534767	NULL	NULL	-6147.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.839	true	NULL	-28	-15813	528534767	NULL	-28.0	-15813.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:55.787	1969-12-31 16:00:01.546	true	NULL
-NULL	-6147	528534767	NULL	NULL	-6147.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.839	true	NULL	-34	15007	528534767	NULL	-34.0	15007.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:50.434	1969-12-31 16:00:13.352	true	NULL
-NULL	-6147	528534767	NULL	NULL	-6147.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.839	true	NULL	-50	-13326	528534767	NULL	-50.0	-13326.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:46.674	1969-12-31 16:00:08.875	true	NULL
-NULL	-6147	528534767	NULL	NULL	-6147.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.839	true	NULL	29	7021	528534767	NULL	29.0	7021.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 16:00:15.007	1969-12-31 16:00:15.148	true	NULL
-NULL	-6147	528534767	NULL	NULL	-6147.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.839	true	NULL	31	-9566	528534767	NULL	31.0	-9566.0	cvLH6Eat2yFsyy7p	NULL	1969-12-31 15:59:44.187	1969-12-31 16:00:06.961	true	NULL
-NULL	-6147	528534767	NULL	NULL	-6147.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.839	true	NULL	NULL	-11534	528534767	NULL	NULL	-11534.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 15:59:55.407	true	NULL
-NULL	-6147	528534767	NULL	NULL	-6147.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.839	true	NULL	NULL	-3012	528534767	NULL	NULL	-3012.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:03.756	true	NULL
-NULL	-6147	528534767	NULL	NULL	-6147.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.839	true	NULL	NULL	-4016	528534767	NULL	NULL	-4016.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:07.209	true	NULL
-NULL	-6147	528534767	NULL	NULL	-6147.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.839	true	NULL	NULL	-4213	528534767	NULL	NULL	-4213.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.589	true	NULL
-NULL	-6147	528534767	NULL	NULL	-6147.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.839	true	NULL	NULL	-6147	528534767	NULL	NULL	-6147.0	cvLH6Eat2yFsyy7p	NULL	NULL	1969-12-31 16:00:13.839	true	NULL
+-51	NULL	-1071480828	-1401575336	-51.0	NULL	aw724t8c5558x2xneC624	4uE7l74tESBiKfu7c8wM7GA	1969-12-31 16:00:08.451	NULL	true	true	-51	NULL	-1071480828	-1401575336	-51.0	NULL	aw724t8c5558x2xneC624	4uE7l74tESBiKfu7c8wM7GA	1969-12-31 16:00:08.451	NULL	true	true
+-64	-7196	NULL	-527203677	-64.0	-7196.0	NULL	JBE4H5RoK412Cs260I72	1969-12-31 15:59:50.184	1969-12-31 15:59:58.174	NULL	true	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+-64	-7196	NULL	406535485	-64.0	-7196.0	NULL	E011i	1969-12-31 15:59:56.048	1969-12-31 15:59:58.174	NULL	false	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+-64	-7196	NULL	658026952	-64.0	-7196.0	NULL	4tAur	1969-12-31 15:59:53.866	1969-12-31 15:59:58.174	NULL	true	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+-64	15601	NULL	1421812187	-64.0	15601.0	NULL	12AEw	1969-12-31 16:00:05.997	1969-12-31 15:59:58.456	NULL	true	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+-64	15601	NULL	1960950366	-64.0	15601.0	NULL	c0ODOF64	1969-12-31 16:00:13.274	1969-12-31 15:59:58.456	NULL	true	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+11	NULL	-1069736047	-453772520	11.0	NULL	k17Am8uPHWk02cEf1jet	qrXLLNX1	1969-12-31 16:00:02.351	NULL	true	true	11	NULL	-1069736047	-453772520	11.0	NULL	k17Am8uPHWk02cEf1jet	qrXLLNX1	1969-12-31 16:00:02.351	NULL	true	true
+11	NULL	-1072910839	2048385991	11.0	NULL	0iqrc5	KbaDXiN85adbHRx58v	1969-12-31 16:00:02.351	NULL	false	false	11	NULL	-1072910839	2048385991	11.0	NULL	0iqrc5	KbaDXiN85adbHRx58v	1969-12-31 16:00:02.351	NULL	false	false
+11	NULL	-1073279343	-1595604468	11.0	NULL	oj1YrV5Wa	P76636jJ6qM17d7DIy	1969-12-31 16:00:02.351	NULL	true	true	11	NULL	-1073279343	-1595604468	11.0	NULL	oj1YrV5Wa	P76636jJ6qM17d7DIy	1969-12-31 16:00:02.351	NULL	true	true
+8	NULL	-1071363017	1349676361	8.0	NULL	Anj0oF	IwE1G7Qb0B1NEfV030g	1969-12-31 16:00:15.892	NULL	true	true	8	NULL	-1071363017	1349676361	8.0	NULL	Anj0oF	IwE1G7Qb0B1NEfV030g	1969-12-31 16:00:15.892	NULL	true	true
+NULL	-5470	-1072076362	1864027286	NULL	-5470.0	2uLyD28144vklju213J1mr	4KWs6gw7lv2WYd66P	NULL	1969-12-31 16:00:01.836	true	true	NULL	-5470	-1072076362	1864027286	NULL	-5470.0	2uLyD28144vklju213J1mr	4KWs6gw7lv2WYd66P	NULL	1969-12-31 16:00:01.836	true	true
+NULL	-7382	-1073051226	-1887561756	NULL	-7382.0	A34p7oRr2WvUJNf	4hA4KQj2vD3fI6gX82220d	NULL	1969-12-31 16:00:10.331	false	false	NULL	-7382	-1073051226	-1887561756	NULL	-7382.0	A34p7oRr2WvUJNf	4hA4KQj2vD3fI6gX82220d	NULL	1969-12-31 16:00:10.331	false	false
+NULL	-741	-1070883071	-1645852809	NULL	-741.0	0ruyd6Y50JpdGRf6HqD	xH7445Rals48VOulSyR5F	NULL	1969-12-31 15:59:51.293	false	false	NULL	-741	-1070883071	-1645852809	NULL	-741.0	0ruyd6Y50JpdGRf6HqD	xH7445Rals48VOulSyR5F	NULL	1969-12-31 15:59:51.293	false	false
+NULL	-947	-1070551679	1864027286	NULL	-947.0	iUR3Q	4KWs6gw7lv2WYd66P	NULL	1969-12-31 16:00:08.058	false	true	NULL	-947	-1070551679	1864027286	NULL	-947.0	iUR3Q	4KWs6gw7lv2WYd66P	NULL	1969-12-31 16:00:08.058	false	true
+NULL	8373	-1072081801	1864027286	NULL	8373.0	dPkN74F7	4KWs6gw7lv2WYd66P	NULL	1969-12-31 15:59:56.465	true	true	NULL	8373	-1072081801	1864027286	NULL	8373.0	dPkN74F7	4KWs6gw7lv2WYd66P	NULL	1969-12-31 15:59:56.465	true	true
 PREHOOK: query: explain
 select c.ctinyint 
 from small_alltypesorc_a c
@@ -308,11 +218,11 @@ STAGE PLANS:
         $hdt$_1:c 
           TableScan
             alias: c
-            Statistics: Num rows: 15 Data size: 2772 Basic stats: COMPLETE Column stats: NONE
+            Statistics: Num rows: 15 Data size: 3700 Basic stats: COMPLETE Column stats: NONE
             Select Operator
               expressions: ctinyint (type: tinyint)
               outputColumnNames: _col0
-              Statistics: Num rows: 15 Data size: 2772 Basic stats: COMPLETE Column stats: NONE
+              Statistics: Num rows: 15 Data size: 3700 Basic stats: COMPLETE Column stats: NONE
               HashTable Sink Operator
                 keys:
                   0 _col0 (type: tinyint)
@@ -323,11 +233,11 @@ STAGE PLANS:
       Map Operator Tree:
           TableScan
             alias: c
-            Statistics: Num rows: 15 Data size: 2772 Basic stats: COMPLETE Column stats: NONE
+            Statistics: Num rows: 15 Data size: 3700 Basic stats: COMPLETE Column stats: NONE
             Select Operator
               expressions: ctinyint (type: tinyint)
               outputColumnNames: _col0
-              Statistics: Num rows: 15 Data size: 2772 Basic stats: COMPLETE Column stats: NONE
+              Statistics: Num rows: 15 Data size: 3700 Basic stats: COMPLETE Column stats: NONE
               Map Join Operator
                 condition map:
                      Left Outer Join0 to 1
@@ -335,10 +245,10 @@ STAGE PLANS:
                   0 _col0 (type: tinyint)
                   1 _col0 (type: tinyint)
                 outputColumnNames: _col0
-                Statistics: Num rows: 16 Data size: 3049 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 16 Data size: 4070 Basic stats: COMPLETE Column stats: NONE
                 File Output Operator
                   compressed: false
-                  Statistics: Num rows: 16 Data size: 3049 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 16 Data size: 4070 Basic stats: COMPLETE Column stats: NONE
                   table:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -371,20 +281,42 @@ left outer join small_alltypesorc_a hd
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@small_alltypesorc_a
 #### A masked pattern was here ####
--21
--28
--34
--50
-29
-3
-31
-31
-31
-31
-38
-38
-38
-38
+-51
+-64
+-64
+-64
+-64
+-64
+-64
+-64
+-64
+-64
+-64
+-64
+-64
+-64
+-64
+-64
+-64
+-64
+-64
+-64
+-64
+-64
+-64
+-64
+-64
+-64
+11
+11
+11
+11
+11
+11
+11
+11
+11
+8
 NULL
 NULL
 NULL
@@ -427,11 +359,11 @@ STAGE PLANS:
         $hdt$_0:$hdt$_1:c 
           TableScan
             alias: c
-            Statistics: Num rows: 15 Data size: 2772 Basic stats: COMPLETE Column stats: NONE
+            Statistics: Num rows: 15 Data size: 3700 Basic stats: COMPLETE Column stats: NONE
             Select Operator
               expressions: cint (type: int)
               outputColumnNames: _col0
-              Statistics: Num rows: 15 Data size: 2772 Basic stats: COMPLETE Column stats: NONE
+              Statistics: Num rows: 15 Data size: 3700 Basic stats: COMPLETE Column stats: NONE
               HashTable Sink Operator
                 keys:
                   0 _col1 (type: int)
@@ -439,11 +371,11 @@ STAGE PLANS:
         $hdt$_0:$hdt$_2:c 
           TableScan
             alias: c
-            Statistics: Num rows: 15 Data size: 2772 Basic stats: COMPLETE Column stats: NONE
+            Statistics: Num rows: 15 Data size: 3700 Basic stats: COMPLETE Column stats: NONE
             Select Operator
               expressions: ctinyint (type: tinyint)
               outputColumnNames: _col0
-              Statistics: Num rows: 15 Data size: 2772 Basic stats: COMPLETE Column stats: NONE
+              Statistics: Num rows: 15 Data size: 3700 Basic stats: COMPLETE Column stats: NONE
               HashTable Sink Operator
                 keys:
                   0 _col0 (type: tinyint)
@@ -454,11 +386,11 @@ STAGE PLANS:
       Map Operator Tree:
           TableScan
             alias: c
-            Statistics: Num rows: 15 Data size: 2772 Basic stats: COMPLETE Column stats: NONE
+            Statistics: Num rows: 15 Data size: 3700 Basic stats: COMPLETE Column stats: NONE
             Select Operator
               expressions: ctinyint (type: tinyint), cint (type: int)
               outputColumnNames: _col0, _col1
-              Statistics: Num rows: 15 Data size: 2772 Basic stats: COMPLETE Column stats: NONE
+              Statistics: Num rows: 15 Data size: 3700 Basic stats: COMPLETE Column stats: NONE
               Map Join Operator
                 condition map:
                      Left Outer Join0 to 1
@@ -466,7 +398,7 @@ STAGE PLANS:
                   0 _col1 (type: int)
                   1 _col0 (type: int)
                 outputColumnNames: _col0
-                Statistics: Num rows: 16 Data size: 3049 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 16 Data size: 4070 Basic stats: COMPLETE Column stats: NONE
                 Map Join Operator
                   condition map:
                        Left Outer Join0 to 1
@@ -474,7 +406,7 @@ STAGE PLANS:
                     0 _col0 (type: tinyint)
                     1 _col0 (type: tinyint)
                   outputColumnNames: _col0
-                  Statistics: Num rows: 17 Data size: 3353 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 17 Data size: 4477 Basic stats: COMPLETE Column stats: NONE
                   Group By Operator
                     aggregations: count(), sum(_col0)
                     mode: hash
@@ -531,4 +463,4 @@ left outer join small_alltypesorc_a hd
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@small_alltypesorc_a
 #### A masked pattern was here ####
-118	-14
+41	-1544
diff --git a/ql/src/test/results/clientpositive/vector_outer_join2.q.out b/ql/src/test/results/clientpositive/vector_outer_join2.q.out
index a7b14e11b6..ff2e52a675 100644
--- a/ql/src/test/results/clientpositive/vector_outer_join2.q.out
+++ b/ql/src/test/results/clientpositive/vector_outer_join2.q.out
@@ -1,39 +1,39 @@
-PREHOOK: query: create table small_alltypesorc1a as select * from alltypesorc where cint is not null and ctinyint is not null limit 5
+PREHOOK: query: create table small_alltypesorc1a as select * from alltypesorc where cint is not null and ctinyint is not null order by cint, ctinyint limit 5
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@alltypesorc
 PREHOOK: Output: database:default
 PREHOOK: Output: default@small_alltypesorc1a
-POSTHOOK: query: create table small_alltypesorc1a as select * from alltypesorc where cint is not null and ctinyint is not null limit 5
+POSTHOOK: query: create table small_alltypesorc1a as select * from alltypesorc where cint is not null and ctinyint is not null order by cint, ctinyint limit 5
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@alltypesorc
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@small_alltypesorc1a
-PREHOOK: query: create table small_alltypesorc2a as select * from alltypesorc where cint is null and ctinyint is not null limit 5
+PREHOOK: query: create table small_alltypesorc2a as select * from alltypesorc where cint is null and ctinyint is not null order by cint, ctinyint limit 5
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@alltypesorc
 PREHOOK: Output: database:default
 PREHOOK: Output: default@small_alltypesorc2a
-POSTHOOK: query: create table small_alltypesorc2a as select * from alltypesorc where cint is null and ctinyint is not null limit 5
+POSTHOOK: query: create table small_alltypesorc2a as select * from alltypesorc where cint is null and ctinyint is not null order by cint, ctinyint limit 5
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@alltypesorc
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@small_alltypesorc2a
-PREHOOK: query: create table small_alltypesorc3a as select * from alltypesorc where cint is not null and ctinyint is null limit 5
+PREHOOK: query: create table small_alltypesorc3a as select * from alltypesorc where cint is not null and ctinyint is null order by cint, ctinyint limit 5
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@alltypesorc
 PREHOOK: Output: database:default
 PREHOOK: Output: default@small_alltypesorc3a
-POSTHOOK: query: create table small_alltypesorc3a as select * from alltypesorc where cint is not null and ctinyint is null limit 5
+POSTHOOK: query: create table small_alltypesorc3a as select * from alltypesorc where cint is not null and ctinyint is null order by cint, ctinyint limit 5
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@alltypesorc
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@small_alltypesorc3a
-PREHOOK: query: create table small_alltypesorc4a as select * from alltypesorc where cint is null and ctinyint is null limit 5
+PREHOOK: query: create table small_alltypesorc4a as select * from alltypesorc where cint is null and ctinyint is null order by cint, ctinyint limit 5
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@alltypesorc
 PREHOOK: Output: database:default
 PREHOOK: Output: default@small_alltypesorc4a
-POSTHOOK: query: create table small_alltypesorc4a as select * from alltypesorc where cint is null and ctinyint is null limit 5
+POSTHOOK: query: create table small_alltypesorc4a as select * from alltypesorc where cint is null and ctinyint is null order by cint, ctinyint limit 5
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@alltypesorc
 POSTHOOK: Output: database:default
@@ -121,11 +121,11 @@ STAGE PLANS:
         $hdt$_0:$hdt$_1:c 
           TableScan
             alias: c
-            Statistics: Num rows: 15 Data size: 2772 Basic stats: COMPLETE Column stats: NONE
+            Statistics: Num rows: 15 Data size: 3700 Basic stats: COMPLETE Column stats: NONE
             Select Operator
               expressions: cint (type: int)
               outputColumnNames: _col0
-              Statistics: Num rows: 15 Data size: 2772 Basic stats: COMPLETE Column stats: NONE
+              Statistics: Num rows: 15 Data size: 3700 Basic stats: COMPLETE Column stats: NONE
               HashTable Sink Operator
                 keys:
                   0 _col0 (type: int)
@@ -133,11 +133,11 @@ STAGE PLANS:
         $hdt$_0:$hdt$_2:c 
           TableScan
             alias: c
-            Statistics: Num rows: 15 Data size: 2772 Basic stats: COMPLETE Column stats: NONE
+            Statistics: Num rows: 15 Data size: 3700 Basic stats: COMPLETE Column stats: NONE
             Select Operator
               expressions: cbigint (type: bigint)
               outputColumnNames: _col0
-              Statistics: Num rows: 15 Data size: 2772 Basic stats: COMPLETE Column stats: NONE
+              Statistics: Num rows: 15 Data size: 3700 Basic stats: COMPLETE Column stats: NONE
               HashTable Sink Operator
                 keys:
                   0 _col1 (type: bigint)
@@ -148,11 +148,11 @@ STAGE PLANS:
       Map Operator Tree:
           TableScan
             alias: c
-            Statistics: Num rows: 15 Data size: 2772 Basic stats: COMPLETE Column stats: NONE
+            Statistics: Num rows: 15 Data size: 3700 Basic stats: COMPLETE Column stats: NONE
             Select Operator
               expressions: cint (type: int), cbigint (type: bigint)
               outputColumnNames: _col0, _col1
-              Statistics: Num rows: 15 Data size: 2772 Basic stats: COMPLETE Column stats: NONE
+              Statistics: Num rows: 15 Data size: 3700 Basic stats: COMPLETE Column stats: NONE
               Map Join Operator
                 condition map:
                      Left Outer Join0 to 1
@@ -160,7 +160,7 @@ STAGE PLANS:
                   0 _col0 (type: int)
                   1 _col0 (type: int)
                 outputColumnNames: _col1
-                Statistics: Num rows: 16 Data size: 3049 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 16 Data size: 4070 Basic stats: COMPLETE Column stats: NONE
                 Map Join Operator
                   condition map:
                        Left Outer Join0 to 1
@@ -168,11 +168,11 @@ STAGE PLANS:
                     0 _col1 (type: bigint)
                     1 _col0 (type: bigint)
                   outputColumnNames: _col1
-                  Statistics: Num rows: 17 Data size: 3353 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 17 Data size: 4477 Basic stats: COMPLETE Column stats: NONE
                   Select Operator
                     expressions: _col1 (type: bigint)
                     outputColumnNames: _col0
-                    Statistics: Num rows: 17 Data size: 3353 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 17 Data size: 4477 Basic stats: COMPLETE Column stats: NONE
                     Group By Operator
                       aggregations: count(), sum(_col0)
                       mode: hash
@@ -229,4 +229,4 @@ left outer join small_alltypesorc_a hd
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@small_alltypesorc_a
 #### A masked pattern was here ####
-105	-1197260954
+21	17110062350
diff --git a/ql/src/test/results/clientpositive/vector_outer_join3.q.out b/ql/src/test/results/clientpositive/vector_outer_join3.q.out
index a8ee829351..901808cecb 100644
--- a/ql/src/test/results/clientpositive/vector_outer_join3.q.out
+++ b/ql/src/test/results/clientpositive/vector_outer_join3.q.out
@@ -1,39 +1,39 @@
-PREHOOK: query: create table small_alltypesorc1a as select * from alltypesorc where cint is not null and ctinyint is not null limit 5
+PREHOOK: query: create table small_alltypesorc1a as select * from alltypesorc where cint is not null and ctinyint is not null order by cint, ctinyint limit 5
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@alltypesorc
 PREHOOK: Output: database:default
 PREHOOK: Output: default@small_alltypesorc1a
-POSTHOOK: query: create table small_alltypesorc1a as select * from alltypesorc where cint is not null and ctinyint is not null limit 5
+POSTHOOK: query: create table small_alltypesorc1a as select * from alltypesorc where cint is not null and ctinyint is not null order by cint, ctinyint limit 5
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@alltypesorc
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@small_alltypesorc1a
-PREHOOK: query: create table small_alltypesorc2a as select * from alltypesorc where cint is null and ctinyint is not null limit 5
+PREHOOK: query: create table small_alltypesorc2a as select * from alltypesorc where cint is null and ctinyint is not null order by cint, ctinyint limit 5
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@alltypesorc
 PREHOOK: Output: database:default
 PREHOOK: Output: default@small_alltypesorc2a
-POSTHOOK: query: create table small_alltypesorc2a as select * from alltypesorc where cint is null and ctinyint is not null limit 5
+POSTHOOK: query: create table small_alltypesorc2a as select * from alltypesorc where cint is null and ctinyint is not null order by cint, ctinyint limit 5
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@alltypesorc
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@small_alltypesorc2a
-PREHOOK: query: create table small_alltypesorc3a as select * from alltypesorc where cint is not null and ctinyint is null limit 5
+PREHOOK: query: create table small_alltypesorc3a as select * from alltypesorc where cint is not null and ctinyint is null order by cint, ctinyint limit 5
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@alltypesorc
 PREHOOK: Output: database:default
 PREHOOK: Output: default@small_alltypesorc3a
-POSTHOOK: query: create table small_alltypesorc3a as select * from alltypesorc where cint is not null and ctinyint is null limit 5
+POSTHOOK: query: create table small_alltypesorc3a as select * from alltypesorc where cint is not null and ctinyint is null order by cint, ctinyint limit 5
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@alltypesorc
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@small_alltypesorc3a
-PREHOOK: query: create table small_alltypesorc4a as select * from alltypesorc where cint is null and ctinyint is null limit 5
+PREHOOK: query: create table small_alltypesorc4a as select * from alltypesorc where cint is null and ctinyint is null order by cint, ctinyint limit 5
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@alltypesorc
 PREHOOK: Output: database:default
 PREHOOK: Output: default@small_alltypesorc4a
-POSTHOOK: query: create table small_alltypesorc4a as select * from alltypesorc where cint is null and ctinyint is null limit 5
+POSTHOOK: query: create table small_alltypesorc4a as select * from alltypesorc where cint is null and ctinyint is null order by cint, ctinyint limit 5
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@alltypesorc
 POSTHOOK: Output: database:default
@@ -121,11 +121,11 @@ STAGE PLANS:
         $hdt$_0:$hdt$_1:c 
           TableScan
             alias: c
-            Statistics: Num rows: 15 Data size: 2772 Basic stats: COMPLETE Column stats: NONE
+            Statistics: Num rows: 15 Data size: 3700 Basic stats: COMPLETE Column stats: NONE
             Select Operator
               expressions: cint (type: int)
               outputColumnNames: _col0
-              Statistics: Num rows: 15 Data size: 2772 Basic stats: COMPLETE Column stats: NONE
+              Statistics: Num rows: 15 Data size: 3700 Basic stats: COMPLETE Column stats: NONE
               HashTable Sink Operator
                 keys:
                   0 _col0 (type: int)
@@ -133,11 +133,11 @@ STAGE PLANS:
         $hdt$_0:$hdt$_2:c 
           TableScan
             alias: c
-            Statistics: Num rows: 15 Data size: 2772 Basic stats: COMPLETE Column stats: NONE
+            Statistics: Num rows: 15 Data size: 3700 Basic stats: COMPLETE Column stats: NONE
             Select Operator
               expressions: cstring1 (type: string)
               outputColumnNames: _col0
-              Statistics: Num rows: 15 Data size: 2772 Basic stats: COMPLETE Column stats: NONE
+              Statistics: Num rows: 15 Data size: 3700 Basic stats: COMPLETE Column stats: NONE
               HashTable Sink Operator
                 keys:
                   0 _col1 (type: string)
@@ -148,11 +148,11 @@ STAGE PLANS:
       Map Operator Tree:
           TableScan
             alias: c
-            Statistics: Num rows: 15 Data size: 2772 Basic stats: COMPLETE Column stats: NONE
+            Statistics: Num rows: 15 Data size: 3700 Basic stats: COMPLETE Column stats: NONE
             Select Operator
               expressions: cint (type: int), cstring1 (type: string)
               outputColumnNames: _col0, _col1
-              Statistics: Num rows: 15 Data size: 2772 Basic stats: COMPLETE Column stats: NONE
+              Statistics: Num rows: 15 Data size: 3700 Basic stats: COMPLETE Column stats: NONE
               Map Join Operator
                 condition map:
                      Left Outer Join0 to 1
@@ -160,14 +160,14 @@ STAGE PLANS:
                   0 _col0 (type: int)
                   1 _col0 (type: int)
                 outputColumnNames: _col1
-                Statistics: Num rows: 16 Data size: 3049 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 16 Data size: 4070 Basic stats: COMPLETE Column stats: NONE
                 Map Join Operator
                   condition map:
                        Left Outer Join0 to 1
                   keys:
                     0 _col1 (type: string)
                     1 _col0 (type: string)
-                  Statistics: Num rows: 17 Data size: 3353 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 17 Data size: 4477 Basic stats: COMPLETE Column stats: NONE
                   Group By Operator
                     aggregations: count()
                     mode: hash
@@ -224,7 +224,7 @@ left outer join small_alltypesorc_a hd
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@small_alltypesorc_a
 #### A masked pattern was here ####
-1005
+15
 PREHOOK: query: explain
 select count(*) from (select c.cstring1 
 from small_alltypesorc_a c
@@ -262,11 +262,11 @@ STAGE PLANS:
         $hdt$_0:$hdt$_1:c 
           TableScan
             alias: c
-            Statistics: Num rows: 15 Data size: 2772 Basic stats: COMPLETE Column stats: NONE
+            Statistics: Num rows: 15 Data size: 3700 Basic stats: COMPLETE Column stats: NONE
             Select Operator
               expressions: cstring2 (type: string)
               outputColumnNames: _col0
-              Statistics: Num rows: 15 Data size: 2772 Basic stats: COMPLETE Column stats: NONE
+              Statistics: Num rows: 15 Data size: 3700 Basic stats: COMPLETE Column stats: NONE
               HashTable Sink Operator
                 keys:
                   0 _col1 (type: string)
@@ -274,11 +274,11 @@ STAGE PLANS:
         $hdt$_0:$hdt$_2:c 
           TableScan
             alias: c
-            Statistics: Num rows: 15 Data size: 2772 Basic stats: COMPLETE Column stats: NONE
+            Statistics: Num rows: 15 Data size: 3700 Basic stats: COMPLETE Column stats: NONE
             Select Operator
               expressions: cstring1 (type: string)
               outputColumnNames: _col0
-              Statistics: Num rows: 15 Data size: 2772 Basic stats: COMPLETE Column stats: NONE
+              Statistics: Num rows: 15 Data size: 3700 Basic stats: COMPLETE Column stats: NONE
               HashTable Sink Operator
                 keys:
                   0 _col0 (type: string)
@@ -289,11 +289,11 @@ STAGE PLANS:
       Map Operator Tree:
           TableScan
             alias: c
-            Statistics: Num rows: 15 Data size: 2772 Basic stats: COMPLETE Column stats: NONE
+            Statistics: Num rows: 15 Data size: 3700 Basic stats: COMPLETE Column stats: NONE
             Select Operator
               expressions: cstring1 (type: string), cstring2 (type: string)
               outputColumnNames: _col0, _col1
-              Statistics: Num rows: 15 Data size: 2772 Basic stats: COMPLETE Column stats: NONE
+              Statistics: Num rows: 15 Data size: 3700 Basic stats: COMPLETE Column stats: NONE
               Map Join Operator
                 condition map:
                      Left Outer Join0 to 1
@@ -301,14 +301,14 @@ STAGE PLANS:
                   0 _col1 (type: string)
                   1 _col0 (type: string)
                 outputColumnNames: _col0
-                Statistics: Num rows: 16 Data size: 3049 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 16 Data size: 4070 Basic stats: COMPLETE Column stats: NONE
                 Map Join Operator
                   condition map:
                        Left Outer Join0 to 1
                   keys:
                     0 _col0 (type: string)
                     1 _col0 (type: string)
-                  Statistics: Num rows: 17 Data size: 3353 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 17 Data size: 4477 Basic stats: COMPLETE Column stats: NONE
                   Group By Operator
                     aggregations: count()
                     mode: hash
@@ -365,7 +365,7 @@ left outer join small_alltypesorc_a hd
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@small_alltypesorc_a
 #### A masked pattern was here ####
-105
+21
 PREHOOK: query: explain
 select count(*) from (select c.cstring1 
 from small_alltypesorc_a c
@@ -403,11 +403,11 @@ STAGE PLANS:
         $hdt$_0:$hdt$_1:c 
           TableScan
             alias: c
-            Statistics: Num rows: 15 Data size: 2772 Basic stats: COMPLETE Column stats: NONE
+            Statistics: Num rows: 15 Data size: 3700 Basic stats: COMPLETE Column stats: NONE
             Select Operator
               expressions: cbigint (type: bigint), cstring2 (type: string)
               outputColumnNames: _col0, _col1
-              Statistics: Num rows: 15 Data size: 2772 Basic stats: COMPLETE Column stats: NONE
+              Statistics: Num rows: 15 Data size: 3700 Basic stats: COMPLETE Column stats: NONE
               HashTable Sink Operator
                 keys:
                   0 _col3 (type: string), _col1 (type: bigint)
@@ -415,11 +415,11 @@ STAGE PLANS:
         $hdt$_0:$hdt$_2:c 
           TableScan
             alias: c
-            Statistics: Num rows: 15 Data size: 2772 Basic stats: COMPLETE Column stats: NONE
+            Statistics: Num rows: 15 Data size: 3700 Basic stats: COMPLETE Column stats: NONE
             Select Operator
               expressions: cint (type: int), cstring1 (type: string)
               outputColumnNames: _col0, _col1
-              Statistics: Num rows: 15 Data size: 2772 Basic stats: COMPLETE Column stats: NONE
+              Statistics: Num rows: 15 Data size: 3700 Basic stats: COMPLETE Column stats: NONE
               HashTable Sink Operator
                 keys:
                   0 _col2 (type: string), _col0 (type: int)
@@ -430,11 +430,11 @@ STAGE PLANS:
       Map Operator Tree:
           TableScan
             alias: c
-            Statistics: Num rows: 15 Data size: 2772 Basic stats: COMPLETE Column stats: NONE
+            Statistics: Num rows: 15 Data size: 3700 Basic stats: COMPLETE Column stats: NONE
             Select Operator
               expressions: cint (type: int), cbigint (type: bigint), cstring1 (type: string), cstring2 (type: string)
               outputColumnNames: _col0, _col1, _col2, _col3
-              Statistics: Num rows: 15 Data size: 2772 Basic stats: COMPLETE Column stats: NONE
+              Statistics: Num rows: 15 Data size: 3700 Basic stats: COMPLETE Column stats: NONE
               Map Join Operator
                 condition map:
                      Left Outer Join0 to 1
@@ -442,14 +442,14 @@ STAGE PLANS:
                   0 _col3 (type: string), _col1 (type: bigint)
                   1 _col1 (type: string), _col0 (type: bigint)
                 outputColumnNames: _col0, _col2
-                Statistics: Num rows: 16 Data size: 3049 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 16 Data size: 4070 Basic stats: COMPLETE Column stats: NONE
                 Map Join Operator
                   condition map:
                        Left Outer Join0 to 1
                   keys:
                     0 _col2 (type: string), _col0 (type: int)
                     1 _col1 (type: string), _col0 (type: int)
-                  Statistics: Num rows: 17 Data size: 3353 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 17 Data size: 4477 Basic stats: COMPLETE Column stats: NONE
                   Group By Operator
                     aggregations: count()
                     mode: hash
@@ -506,4 +506,4 @@ left outer join small_alltypesorc_a hd
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@small_alltypesorc_a
 #### A masked pattern was here ####
-105
+21
diff --git a/ql/src/test/results/clientpositive/vectorization_part_project.q.out b/ql/src/test/results/clientpositive/vectorization_part_project.q.out
index 57012b2993..f98e79cec5 100644
--- a/ql/src/test/results/clientpositive/vectorization_part_project.q.out
+++ b/ql/src/test/results/clientpositive/vectorization_part_project.q.out
@@ -6,11 +6,11 @@ POSTHOOK: query: CREATE TABLE alltypesorc_part(ctinyint tinyint, csmallint small
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@alltypesorc_part
-PREHOOK: query: insert overwrite table alltypesorc_part partition (ds='2011') select * from alltypesorc limit 100
+PREHOOK: query: insert overwrite table alltypesorc_part partition (ds='2011') select * from alltypesorc order by ctinyint, cint, cbigint limit 100
 PREHOOK: type: QUERY
 PREHOOK: Input: default@alltypesorc
 PREHOOK: Output: default@alltypesorc_part@ds=2011
-POSTHOOK: query: insert overwrite table alltypesorc_part partition (ds='2011') select * from alltypesorc limit 100
+POSTHOOK: query: insert overwrite table alltypesorc_part partition (ds='2011') select * from alltypesorc order by ctinyint, cint, cbigint limit 100
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc
 POSTHOOK: Output: default@alltypesorc_part@ds=2011
@@ -26,11 +26,11 @@ POSTHOOK: Lineage: alltypesorc_part PARTITION(ds=2011).cstring2 SIMPLE [(alltype
 POSTHOOK: Lineage: alltypesorc_part PARTITION(ds=2011).ctimestamp1 SIMPLE [(alltypesorc)alltypesorc.FieldSchema(name:ctimestamp1, type:timestamp, comment:null), ]
 POSTHOOK: Lineage: alltypesorc_part PARTITION(ds=2011).ctimestamp2 SIMPLE [(alltypesorc)alltypesorc.FieldSchema(name:ctimestamp2, type:timestamp, comment:null), ]
 POSTHOOK: Lineage: alltypesorc_part PARTITION(ds=2011).ctinyint SIMPLE [(alltypesorc)alltypesorc.FieldSchema(name:ctinyint, type:tinyint, comment:null), ]
-PREHOOK: query: insert overwrite table alltypesorc_part partition (ds='2012') select * from alltypesorc limit 100
+PREHOOK: query: insert overwrite table alltypesorc_part partition (ds='2012') select * from alltypesorc order by ctinyint, cint, cbigint limit 100
 PREHOOK: type: QUERY
 PREHOOK: Input: default@alltypesorc
 PREHOOK: Output: default@alltypesorc_part@ds=2012
-POSTHOOK: query: insert overwrite table alltypesorc_part partition (ds='2012') select * from alltypesorc limit 100
+POSTHOOK: query: insert overwrite table alltypesorc_part partition (ds='2012') select * from alltypesorc order by ctinyint, cint, cbigint limit 100
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc
 POSTHOOK: Output: default@alltypesorc_part@ds=2012
@@ -60,27 +60,27 @@ STAGE PLANS:
       Map Operator Tree:
           TableScan
             alias: alltypesorc_part
-            Statistics: Num rows: 200 Data size: 41576 Basic stats: COMPLETE Column stats: NONE
+            Statistics: Num rows: 200 Data size: 54496 Basic stats: COMPLETE Column stats: NONE
             Select Operator
               expressions: (cdouble + 2.0) (type: double)
               outputColumnNames: _col0
-              Statistics: Num rows: 200 Data size: 41576 Basic stats: COMPLETE Column stats: NONE
+              Statistics: Num rows: 200 Data size: 54496 Basic stats: COMPLETE Column stats: NONE
               Reduce Output Operator
                 key expressions: _col0 (type: double)
                 sort order: +
-                Statistics: Num rows: 200 Data size: 41576 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 200 Data size: 54496 Basic stats: COMPLETE Column stats: NONE
       Execution mode: vectorized
       Reduce Operator Tree:
         Select Operator
           expressions: KEY.reducesinkkey0 (type: double)
           outputColumnNames: _col0
-          Statistics: Num rows: 200 Data size: 41576 Basic stats: COMPLETE Column stats: NONE
+          Statistics: Num rows: 200 Data size: 54496 Basic stats: COMPLETE Column stats: NONE
           Limit
             Number of rows: 10
-            Statistics: Num rows: 10 Data size: 2070 Basic stats: COMPLETE Column stats: NONE
+            Statistics: Num rows: 10 Data size: 2720 Basic stats: COMPLETE Column stats: NONE
             File Output Operator
               compressed: false
-              Statistics: Num rows: 10 Data size: 2070 Basic stats: COMPLETE Column stats: NONE
+              Statistics: Num rows: 10 Data size: 2720 Basic stats: COMPLETE Column stats: NONE
               table:
                   input format: org.apache.hadoop.mapred.TextInputFormat
                   output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -104,13 +104,13 @@ POSTHOOK: Input: default@alltypesorc_part
 POSTHOOK: Input: default@alltypesorc_part@ds=2011
 POSTHOOK: Input: default@alltypesorc_part@ds=2012
 #### A masked pattern was here ####
--15910.0
--15910.0
--15811.0
--15811.0
--15788.0
--15788.0
--15547.0
--15547.0
--15429.0
--15429.0
+NULL
+NULL
+-15863.0
+-15863.0
+-14988.0
+-14988.0
+-14646.0
+-14646.0
+-14236.0
+-14236.0
diff --git a/ql/src/test/results/clientpositive/vectorized_distinct_gby.q.out b/ql/src/test/results/clientpositive/vectorized_distinct_gby.q.out
index 1c684ceb3e..2e041a32c8 100644
--- a/ql/src/test/results/clientpositive/vectorized_distinct_gby.q.out
+++ b/ql/src/test/results/clientpositive/vectorized_distinct_gby.q.out
@@ -6,11 +6,11 @@ POSTHOOK: query: create table dtest(a int, b int) clustered by (a) sorted by (a)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@dtest
-PREHOOK: query: insert into table dtest select c,b from (select array(300,300,300,300,300) as a, 1 as b from src limit 1) y lateral view  explode(a) t1 as c
+PREHOOK: query: insert into table dtest select c,b from (select array(300,300,300,300,300) as a, 1 as b from src order by a limit 1) y lateral view  explode(a) t1 as c
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
 PREHOOK: Output: default@dtest
-POSTHOOK: query: insert into table dtest select c,b from (select array(300,300,300,300,300) as a, 1 as b from src limit 1) y lateral view  explode(a) t1 as c
+POSTHOOK: query: insert into table dtest select c,b from (select array(300,300,300,300,300) as a, 1 as b from src order by a limit 1) y lateral view  explode(a) t1 as c
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 POSTHOOK: Output: default@dtest
diff --git a/ql/src/test/results/clientpositive/vectorized_mapjoin.q.out b/ql/src/test/results/clientpositive/vectorized_mapjoin.q.out
index d042ae0f7c..f33ddcfb25 100644
--- a/ql/src/test/results/clientpositive/vectorized_mapjoin.q.out
+++ b/ql/src/test/results/clientpositive/vectorized_mapjoin.q.out
@@ -1,8 +1,12 @@
-PREHOOK: query: EXPLAIN SELECT COUNT(t1.cint), MAX(t2.cint), MIN(t1.cint), AVG(t1.cint+t2.cint)
+PREHOOK: query: -- SORT_QUERY_RESULTS
+
+EXPLAIN SELECT COUNT(t1.cint), MAX(t2.cint), MIN(t1.cint), AVG(t1.cint+t2.cint)
   FROM alltypesorc t1
   JOIN alltypesorc t2 ON t1.cint = t2.cint
 PREHOOK: type: QUERY
-POSTHOOK: query: EXPLAIN SELECT COUNT(t1.cint), MAX(t2.cint), MIN(t1.cint), AVG(t1.cint+t2.cint)
+POSTHOOK: query: -- SORT_QUERY_RESULTS
+
+EXPLAIN SELECT COUNT(t1.cint), MAX(t2.cint), MIN(t1.cint), AVG(t1.cint+t2.cint)
   FROM alltypesorc t1
   JOIN alltypesorc t2 ON t1.cint = t2.cint
 POSTHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/vectorized_nested_mapjoin.q.out b/ql/src/test/results/clientpositive/vectorized_nested_mapjoin.q.out
index c92dcf9370..82e90dab38 100644
--- a/ql/src/test/results/clientpositive/vectorized_nested_mapjoin.q.out
+++ b/ql/src/test/results/clientpositive/vectorized_nested_mapjoin.q.out
@@ -1,6 +1,10 @@
-PREHOOK: query: explain select sum(t1.td) from (select  v1.csmallint as tsi, v1.cdouble as td from alltypesorc v1, alltypesorc v2 where v1.ctinyint=v2.ctinyint) t1 join alltypesorc v3 on t1.tsi=v3.csmallint
+PREHOOK: query: -- SORT_QUERY_RESULTS
+
+explain select sum(t1.td) from (select  v1.csmallint as tsi, v1.cdouble as td from alltypesorc v1, alltypesorc v2 where v1.ctinyint=v2.ctinyint) t1 join alltypesorc v3 on t1.tsi=v3.csmallint
 PREHOOK: type: QUERY
-POSTHOOK: query: explain select sum(t1.td) from (select  v1.csmallint as tsi, v1.cdouble as td from alltypesorc v1, alltypesorc v2 where v1.ctinyint=v2.ctinyint) t1 join alltypesorc v3 on t1.tsi=v3.csmallint
+POSTHOOK: query: -- SORT_QUERY_RESULTS
+
+explain select sum(t1.td) from (select  v1.csmallint as tsi, v1.cdouble as td from alltypesorc v1, alltypesorc v2 where v1.ctinyint=v2.ctinyint) t1 join alltypesorc v3 on t1.tsi=v3.csmallint
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
   Stage-8 is a root stage
diff --git a/ql/src/test/results/clientpositive/vectorized_rcfile_columnar.q.out b/ql/src/test/results/clientpositive/vectorized_rcfile_columnar.q.out
index ee8959be94..c35173edde 100644
--- a/ql/src/test/results/clientpositive/vectorized_rcfile_columnar.q.out
+++ b/ql/src/test/results/clientpositive/vectorized_rcfile_columnar.q.out
@@ -23,12 +23,12 @@ POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@columnTable
 PREHOOK: query: FROM src
-INSERT OVERWRITE TABLE columnTable SELECT src.key, src.value LIMIT 10
+INSERT OVERWRITE TABLE columnTable SELECT src.key, src.value ORDER BY src.key, src.value LIMIT 10
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
 PREHOOK: Output: default@columntable
 POSTHOOK: query: FROM src
-INSERT OVERWRITE TABLE columnTable SELECT src.key, src.value LIMIT 10
+INSERT OVERWRITE TABLE columnTable SELECT src.key, src.value ORDER BY src.key, src.value LIMIT 10
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 POSTHOOK: Output: default@columntable
@@ -50,13 +50,13 @@ POSTHOOK: query: SELECT key, value FROM columnTable ORDER BY key
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@columntable
 #### A masked pattern was here ####
-165	val_165
-238	val_238
-255	val_255
-27	val_27
-278	val_278
-311	val_311
-409	val_409
-484	val_484
-86	val_86
-98	val_98
+0	val_0
+0	val_0
+0	val_0
+10	val_10
+100	val_100
+100	val_100
+103	val_103
+103	val_103
+104	val_104
+104	val_104
diff --git a/ql/src/test/results/clientpositive/vectorized_shufflejoin.q.out b/ql/src/test/results/clientpositive/vectorized_shufflejoin.q.out
index 959a76266e..f32cc38f30 100644
--- a/ql/src/test/results/clientpositive/vectorized_shufflejoin.q.out
+++ b/ql/src/test/results/clientpositive/vectorized_shufflejoin.q.out
@@ -1,15 +1,20 @@
-PREHOOK: query: EXPLAIN SELECT COUNT(t1.cint), MAX(t2.cint), MIN(t1.cint), AVG(t1.cint+t2.cint)
+PREHOOK: query: -- SORT_QUERY_RESULTS
+
+EXPLAIN SELECT COUNT(t1.cint) AS CNT, MAX(t2.cint) , MIN(t1.cint), AVG(t1.cint+t2.cint)
   FROM alltypesorc t1
-  JOIN alltypesorc t2 ON t1.cint = t2.cint
+  JOIN alltypesorc t2 ON t1.cint = t2.cint order by CNT
 PREHOOK: type: QUERY
-POSTHOOK: query: EXPLAIN SELECT COUNT(t1.cint), MAX(t2.cint), MIN(t1.cint), AVG(t1.cint+t2.cint)
+POSTHOOK: query: -- SORT_QUERY_RESULTS
+
+EXPLAIN SELECT COUNT(t1.cint) AS CNT, MAX(t2.cint) , MIN(t1.cint), AVG(t1.cint+t2.cint)
   FROM alltypesorc t1
-  JOIN alltypesorc t2 ON t1.cint = t2.cint
+  JOIN alltypesorc t2 ON t1.cint = t2.cint order by CNT
 POSTHOOK: type: QUERY
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
   Stage-2 depends on stages: Stage-1
-  Stage-0 depends on stages: Stage-2
+  Stage-3 depends on stages: Stage-2
+  Stage-0 depends on stages: Stage-3
 
 STAGE PLANS:
   Stage: Stage-1
@@ -84,6 +89,27 @@ STAGE PLANS:
           mode: mergepartial
           outputColumnNames: _col0, _col1, _col2, _col3
           Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: NONE
+          File Output Operator
+            compressed: false
+            table:
+                input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+                serde: org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe
+
+  Stage: Stage-3
+    Map Reduce
+      Map Operator Tree:
+          TableScan
+            Reduce Output Operator
+              key expressions: _col0 (type: bigint)
+              sort order: +
+              Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: NONE
+              value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: double)
+      Reduce Operator Tree:
+        Select Operator
+          expressions: KEY.reducesinkkey0 (type: bigint), VALUE._col0 (type: int), VALUE._col1 (type: int), VALUE._col2 (type: double)
+          outputColumnNames: _col0, _col1, _col2, _col3
+          Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: NONE
           File Output Operator
             compressed: false
             Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: NONE
@@ -98,15 +124,15 @@ STAGE PLANS:
       Processor Tree:
         ListSink
 
-PREHOOK: query: SELECT COUNT(t1.cint), MAX(t2.cint), MIN(t1.cint), AVG(t1.cint+t2.cint)
+PREHOOK: query: SELECT COUNT(t1.cint), MAX(t2.cint) AS CNT, MIN(t1.cint), AVG(t1.cint+t2.cint)
   FROM alltypesorc t1
-  JOIN alltypesorc t2 ON t1.cint = t2.cint
+  JOIN alltypesorc t2 ON t1.cint = t2.cint order by CNT
 PREHOOK: type: QUERY
 PREHOOK: Input: default@alltypesorc
 #### A masked pattern was here ####
-POSTHOOK: query: SELECT COUNT(t1.cint), MAX(t2.cint), MIN(t1.cint), AVG(t1.cint+t2.cint)
+POSTHOOK: query: SELECT COUNT(t1.cint), MAX(t2.cint) AS CNT, MIN(t1.cint), AVG(t1.cint+t2.cint)
   FROM alltypesorc t1
-  JOIN alltypesorc t2 ON t1.cint = t2.cint
+  JOIN alltypesorc t2 ON t1.cint = t2.cint order by CNT
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/vectorized_timestamp_funcs.q.out b/ql/src/test/results/clientpositive/vectorized_timestamp_funcs.q.out
index b3bb9083d0..f66903b159 100644
--- a/ql/src/test/results/clientpositive/vectorized_timestamp_funcs.q.out
+++ b/ql/src/test/results/clientpositive/vectorized_timestamp_funcs.q.out
@@ -18,18 +18,20 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@alltypesorc_string
 PREHOOK: query: INSERT OVERWRITE TABLE alltypesorc_string
 SELECT
-  to_utc_timestamp(ctimestamp1, 'America/Los_Angeles'),
-  CAST(to_utc_timestamp(ctimestamp1, 'America/Los_Angeles') AS STRING)
+  to_utc_timestamp(ctimestamp1, 'America/Los_Angeles') AS toutc,
+  CAST(to_utc_timestamp(ctimestamp1, 'America/Los_Angeles') AS STRING) as cst
 FROM alltypesorc
+ORDER BY toutc, cst
 LIMIT 40
 PREHOOK: type: QUERY
 PREHOOK: Input: default@alltypesorc
 PREHOOK: Output: default@alltypesorc_string
 POSTHOOK: query: INSERT OVERWRITE TABLE alltypesorc_string
 SELECT
-  to_utc_timestamp(ctimestamp1, 'America/Los_Angeles'),
-  CAST(to_utc_timestamp(ctimestamp1, 'America/Los_Angeles') AS STRING)
+  to_utc_timestamp(ctimestamp1, 'America/Los_Angeles') AS toutc,
+  CAST(to_utc_timestamp(ctimestamp1, 'America/Los_Angeles') AS STRING) as cst
 FROM alltypesorc
+ORDER BY toutc, cst
 LIMIT 40
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc
@@ -107,25 +109,25 @@ STAGE PLANS:
       Map Operator Tree:
           TableScan
             alias: alltypesorc_string
-            Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+            Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
             Select Operator
               expressions: to_unix_timestamp(ctimestamp1) (type: bigint), year(ctimestamp1) (type: int), month(ctimestamp1) (type: int), day(ctimestamp1) (type: int), dayofmonth(ctimestamp1) (type: int), weekofyear(ctimestamp1) (type: int), hour(ctimestamp1) (type: int), minute(ctimestamp1) (type: int), second(ctimestamp1) (type: int)
               outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
-              Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+              Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
               Reduce Output Operator
                 key expressions: _col0 (type: bigint)
                 sort order: +
-                Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
                 value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: int), _col6 (type: int), _col7 (type: int), _col8 (type: int)
       Execution mode: vectorized
       Reduce Operator Tree:
         Select Operator
           expressions: KEY.reducesinkkey0 (type: bigint), VALUE._col0 (type: int), VALUE._col1 (type: int), VALUE._col2 (type: int), VALUE._col3 (type: int), VALUE._col4 (type: int), VALUE._col5 (type: int), VALUE._col6 (type: int), VALUE._col7 (type: int)
           outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
-          Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+          Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
           File Output Operator
             compressed: false
-            Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+            Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -168,45 +170,45 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc_string
 #### A masked pattern was here ####
 NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
-28784	1969	12	31	31	1	23	59	44
-28784	1969	12	31	31	1	23	59	44
-28784	1969	12	31	31	1	23	59	44
-28784	1969	12	31	31	1	23	59	44
-28785	1969	12	31	31	1	23	59	45
-28786	1969	12	31	31	1	23	59	46
-28787	1969	12	31	31	1	23	59	47
-28788	1969	12	31	31	1	23	59	48
-28789	1969	12	31	31	1	23	59	49
-28789	1969	12	31	31	1	23	59	49
-28790	1969	12	31	31	1	23	59	50
-28792	1969	12	31	31	1	23	59	52
-28792	1969	12	31	31	1	23	59	52
-28792	1969	12	31	31	1	23	59	52
-28792	1969	12	31	31	1	23	59	52
-28795	1969	12	31	31	1	23	59	55
-28795	1969	12	31	31	1	23	59	55
-28795	1969	12	31	31	1	23	59	55
-28798	1969	12	31	31	1	23	59	58
-28798	1969	12	31	31	1	23	59	58
-28800	1970	1	1	1	1	0	0	0
-28800	1970	1	1	1	1	0	0	0
-28802	1970	1	1	1	1	0	0	2
-28803	1970	1	1	1	1	0	0	3
-28804	1970	1	1	1	1	0	0	4
-28804	1970	1	1	1	1	0	0	4
-28805	1970	1	1	1	1	0	0	5
-28805	1970	1	1	1	1	0	0	5
-28806	1970	1	1	1	1	0	0	6
-28807	1970	1	1	1	1	0	0	7
-28807	1970	1	1	1	1	0	0	7
-28807	1970	1	1	1	1	0	0	7
-28808	1970	1	1	1	1	0	0	8
-28808	1970	1	1	1	1	0	0	8
-28809	1970	1	1	1	1	0	0	9
-28811	1970	1	1	1	1	0	0	11
-28813	1970	1	1	1	1	0	0	13
-28814	1970	1	1	1	1	0	0	14
-28815	1970	1	1	1	1	0	0	15
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
 PREHOOK: query: EXPLAIN SELECT
   to_unix_timestamp(stimestamp1) AS c1,
   year(stimestamp1),
@@ -243,25 +245,25 @@ STAGE PLANS:
       Map Operator Tree:
           TableScan
             alias: alltypesorc_string
-            Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+            Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
             Select Operator
               expressions: to_unix_timestamp(stimestamp1) (type: bigint), year(stimestamp1) (type: int), month(stimestamp1) (type: int), day(stimestamp1) (type: int), dayofmonth(stimestamp1) (type: int), weekofyear(stimestamp1) (type: int), hour(stimestamp1) (type: int), minute(stimestamp1) (type: int), second(stimestamp1) (type: int)
               outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
-              Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+              Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
               Reduce Output Operator
                 key expressions: _col0 (type: bigint)
                 sort order: +
-                Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
                 value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: int), _col6 (type: int), _col7 (type: int), _col8 (type: int)
       Execution mode: vectorized
       Reduce Operator Tree:
         Select Operator
           expressions: KEY.reducesinkkey0 (type: bigint), VALUE._col0 (type: int), VALUE._col1 (type: int), VALUE._col2 (type: int), VALUE._col3 (type: int), VALUE._col4 (type: int), VALUE._col5 (type: int), VALUE._col6 (type: int), VALUE._col7 (type: int)
           outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
-          Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+          Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
           File Output Operator
             compressed: false
-            Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+            Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -304,45 +306,45 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc_string
 #### A masked pattern was here ####
 NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
-28784	1969	12	31	31	1	23	59	44
-28784	1969	12	31	31	1	23	59	44
-28784	1969	12	31	31	1	23	59	44
-28784	1969	12	31	31	1	23	59	44
-28785	1969	12	31	31	1	23	59	45
-28786	1969	12	31	31	1	23	59	46
-28787	1969	12	31	31	1	23	59	47
-28788	1969	12	31	31	1	23	59	48
-28789	1969	12	31	31	1	23	59	49
-28789	1969	12	31	31	1	23	59	49
-28790	1969	12	31	31	1	23	59	50
-28792	1969	12	31	31	1	23	59	52
-28792	1969	12	31	31	1	23	59	52
-28792	1969	12	31	31	1	23	59	52
-28792	1969	12	31	31	1	23	59	52
-28795	1969	12	31	31	1	23	59	55
-28795	1969	12	31	31	1	23	59	55
-28795	1969	12	31	31	1	23	59	55
-28798	1969	12	31	31	1	23	59	58
-28798	1969	12	31	31	1	23	59	58
-28800	1970	1	1	1	1	0	0	0
-28800	1970	1	1	1	1	0	0	0
-28802	1970	1	1	1	1	0	0	2
-28803	1970	1	1	1	1	0	0	3
-28804	1970	1	1	1	1	0	0	4
-28804	1970	1	1	1	1	0	0	4
-28805	1970	1	1	1	1	0	0	5
-28805	1970	1	1	1	1	0	0	5
-28806	1970	1	1	1	1	0	0	6
-28807	1970	1	1	1	1	0	0	7
-28807	1970	1	1	1	1	0	0	7
-28807	1970	1	1	1	1	0	0	7
-28808	1970	1	1	1	1	0	0	8
-28808	1970	1	1	1	1	0	0	8
-28809	1970	1	1	1	1	0	0	9
-28811	1970	1	1	1	1	0	0	11
-28813	1970	1	1	1	1	0	0	13
-28814	1970	1	1	1	1	0	0	14
-28815	1970	1	1	1	1	0	0	15
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
 PREHOOK: query: EXPLAIN SELECT
   to_unix_timestamp(ctimestamp1) = to_unix_timestamp(stimestamp1) AS c1,
   year(ctimestamp1) = year(stimestamp1),
@@ -379,25 +381,25 @@ STAGE PLANS:
       Map Operator Tree:
           TableScan
             alias: alltypesorc_string
-            Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+            Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
             Select Operator
               expressions: (to_unix_timestamp(ctimestamp1) = to_unix_timestamp(stimestamp1)) (type: boolean), (year(ctimestamp1) = year(stimestamp1)) (type: boolean), (month(ctimestamp1) = month(stimestamp1)) (type: boolean), (day(ctimestamp1) = day(stimestamp1)) (type: boolean), (dayofmonth(ctimestamp1) = dayofmonth(stimestamp1)) (type: boolean), (weekofyear(ctimestamp1) = weekofyear(stimestamp1)) (type: boolean), (hour(ctimestamp1) = hour(stimestamp1)) (type: boolean), (minute(ctimestamp1) = minute(stimestamp1)) (type: boolean), (second(ctimestamp1) = second(stimestamp1)) (type: boolean)
               outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
-              Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+              Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
               Reduce Output Operator
                 key expressions: _col0 (type: boolean)
                 sort order: +
-                Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
                 value expressions: _col1 (type: boolean), _col2 (type: boolean), _col3 (type: boolean), _col4 (type: boolean), _col5 (type: boolean), _col6 (type: boolean), _col7 (type: boolean), _col8 (type: boolean)
       Execution mode: vectorized
       Reduce Operator Tree:
         Select Operator
           expressions: KEY.reducesinkkey0 (type: boolean), VALUE._col0 (type: boolean), VALUE._col1 (type: boolean), VALUE._col2 (type: boolean), VALUE._col3 (type: boolean), VALUE._col4 (type: boolean), VALUE._col5 (type: boolean), VALUE._col6 (type: boolean), VALUE._col7 (type: boolean)
           outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
-          Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+          Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
           File Output Operator
             compressed: false
-            Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+            Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -442,45 +444,45 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc_string
 #### A masked pattern was here ####
 NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
-true	true	true	true	true	true	true	true	true
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
 PREHOOK: query: -- Wrong format. Should all be NULL.
 EXPLAIN SELECT
   to_unix_timestamp(stimestamp1) AS c1,
@@ -606,11 +608,11 @@ STAGE PLANS:
       Map Operator Tree:
           TableScan
             alias: alltypesorc_string
-            Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+            Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
             Select Operator
               expressions: ctimestamp1 (type: timestamp)
               outputColumnNames: _col0
-              Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+              Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
               Group By Operator
                 aggregations: min(_col0), max(_col0), count(_col0), count()
                 mode: hash
@@ -659,7 +661,7 @@ FROM alltypesorc_string
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc_string
 #### A masked pattern was here ####
-1969-12-31 23:59:44.088	1970-01-01 00:00:15.007	39	40
+NULL	NULL	0	40
 PREHOOK: query: -- SUM of timestamps are not vectorized reduce-side because they produce a double instead of a long (HIVE-8211)...
 EXPLAIN SELECT
   round(sum(ctimestamp1), 3)
@@ -680,11 +682,11 @@ STAGE PLANS:
       Map Operator Tree:
           TableScan
             alias: alltypesorc_string
-            Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+            Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
             Select Operator
               expressions: ctimestamp1 (type: timestamp)
               outputColumnNames: _col0
-              Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+              Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
               Group By Operator
                 aggregations: sum(_col0)
                 mode: hash
@@ -730,7 +732,7 @@ FROM alltypesorc_string
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc_string
 #### A masked pattern was here ####
-1123143.857
+NULL
 PREHOOK: query: EXPLAIN SELECT
   round(avg(ctimestamp1), 0),
   variance(ctimestamp1) between 8.97077295279421E19 and 8.97077295279422E19,
@@ -763,11 +765,11 @@ STAGE PLANS:
       Map Operator Tree:
           TableScan
             alias: alltypesorc_string
-            Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+            Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
             Select Operator
               expressions: ctimestamp1 (type: timestamp)
               outputColumnNames: _col0
-              Statistics: Num rows: 40 Data size: 5694 Basic stats: COMPLETE Column stats: NONE
+              Statistics: Num rows: 40 Data size: 84 Basic stats: COMPLETE Column stats: NONE
               Group By Operator
                 aggregations: avg(_col0), variance(_col0), var_pop(_col0), var_samp(_col0), std(_col0), stddev(_col0), stddev_pop(_col0), stddev_samp(_col0)
                 mode: hash
@@ -828,4 +830,4 @@ FROM alltypesorc_string
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@alltypesorc_string
 #### A masked pattern was here ####
-2.8798560435897E13	true	true	true	9.471416447815E9	9.471416447815E9	9.471416447815E9	9.595231068211E9
+NULL	NULL	NULL	NULL	NULL	NULL	NULL	NULL
