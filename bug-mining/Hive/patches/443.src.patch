diff --git a/CHANGES.txt b/CHANGES.txt
index aaba32d7a1..1865fb83ae 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -147,6 +147,9 @@ Trunk -  Unreleased
     HIVE-1543 Abort in ExecMapper when record reader's next gets a exception
     (Ning Zhang via namit)
 
+    HIVE-1547 Unarchiving operation throws NPE
+    (He Yongqiang via namit)
+
   TESTS
 
     HIVE-1464. improve  test query performance
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/DDLTask.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/DDLTask.java
index ef1da6bbba..56b1c60910 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/DDLTask.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/DDLTask.java
@@ -726,7 +726,7 @@ private int unarchive(Hive db, AlterTableSimpleDesc simpleDesc)
       // Verify that there are no files in the tmp dir, because if there are, it
       // would be copied to the partition
       FileStatus [] filesInTmpDir = fs.listStatus(tmpDir);
-      if (filesInTmpDir.length != 0) {
+      if (filesInTmpDir != null && filesInTmpDir.length != 0) {
         for (FileStatus file : filesInTmpDir) {
           console.printInfo(file.getPath().toString());
         }
@@ -1584,7 +1584,7 @@ private int alterTable(Hive db, AlterTableDesc alterTbl) throws HiveException {
     // alter the table
     Table tbl = db.getTable(MetaStoreUtils.DEFAULT_DATABASE_NAME, alterTbl
         .getOldName());
-    
+
     Partition part = null;
     if(alterTbl.getPartSpec() != null) {
       part = db.getPartition(tbl, alterTbl.getPartSpec(), false);
@@ -1777,7 +1777,7 @@ private int alterTable(Hive db, AlterTableDesc alterTbl) throws HiveException {
       if (part != null) {
         part.setProtectMode(mode);
       } else {
-        tbl.setProtectMode(mode);        
+        tbl.setProtectMode(mode);
       }
 
     } else if (alterTbl.getOp() == AlterTableDesc.AlterTableTypes.ADDCLUSTERSORTCOLUMN) {
@@ -1857,12 +1857,12 @@ private int alterTable(Hive db, AlterTableDesc alterTbl) throws HiveException {
       part.getParameters().put("last_modified_time", Long.toString(System
           .currentTimeMillis() / 1000));
     }
-    
+
     try {
       if (part == null) {
         db.alterTable(alterTbl.getOldName(), tbl);
       } else {
-        db.alterPartition(tbl.getTableName(), part);        
+        db.alterPartition(tbl.getTableName(), part);
       }
     } catch (InvalidOperationException e) {
       console.printError("Invalid alter operation: " + e.getMessage());
