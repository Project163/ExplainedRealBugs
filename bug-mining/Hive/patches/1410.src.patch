diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/tez/DagUtils.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/tez/DagUtils.java
index 6dc66ce964..501fb46063 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/tez/DagUtils.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/tez/DagUtils.java
@@ -28,6 +28,7 @@
 import javax.security.auth.login.LoginException;
 
 import org.apache.commons.lang.StringUtils;
+import org.apache.commons.io.FilenameUtils;
 import org.apache.hadoop.conf.Configuration;
 import org.apache.hadoop.fs.FileStatus;
 import org.apache.hadoop.fs.FileSystem;
@@ -200,11 +201,11 @@ private static Vertex createVertex(JobConf conf, MapWork mapWork, int seqNo,
       if (localWorkLr != null) {
         localResources.put(hashTableArchive.getName(), localWorkLr);
       }
-      localResources.put(appJarLr.getResource().getFile(), appJarLr);
+      localResources.put(getBaseName(appJarLr), appJarLr);
       for (LocalResource lr: additionalLr) {
-        localResources.put(lr.getResource().getFile(), lr);
+        localResources.put(getBaseName(lr), lr);
       }
-      localResources.put(planPath.getName(), planLr);
+      localResources.put(FilenameUtils.getName(planPath.getName()), planLr);
 
       MRHelpers.updateLocalResourcesForInputSplits(FileSystem.get(conf), inputSplitInfo,
           localResources);
@@ -269,11 +270,11 @@ private static Vertex createVertex(JobConf conf, ReduceWork reduceWork, int seqN
     reducer.setJavaOpts(MRHelpers.getReduceJavaOpts(conf));
 
     Map<String, LocalResource> localResources = new HashMap<String, LocalResource>();
-    localResources.put(appJarLr.getResource().getFile(), appJarLr);
+    localResources.put(getBaseName(appJarLr), appJarLr);
     for (LocalResource lr: additionalLr) {
-      localResources.put(lr.getResource().getFile(), lr);
+      localResources.put(getBaseName(lr), lr);
     }
-    localResources.put(planPath.getName(), planLr);
+    localResources.put(FilenameUtils.getName(planPath.getName()), planLr);
     reducer.setTaskLocalResources(localResources);
 
     return reducer;
@@ -393,7 +394,13 @@ private static String getExecJarPathLocal () throws URISyntaxException {
       // returns the location on disc of the jar of this class.
     return DagUtils.class.getProtectionDomain().getCodeSource().getLocation().toURI().toString();
   }
-
+  
+  /*
+   * Helper function to retrieve the basename of a local resource
+   */
+  public static String getBaseName(LocalResource lr) {
+    return FilenameUtils.getName(lr.getResource().getFile());
+  }
 
   /**
    * @param pathStr - the string from which we try to determine the resource base name
@@ -546,7 +553,6 @@ public static JobConf createConfiguration(HiveConf hiveConf) throws IOException
     hiveConf.setBoolean("mapred.mapper.new-api", false);
 
     JobConf conf = (JobConf) MRHelpers.getBaseMRConfiguration();
-    MRHelpers.doJobClientMagic(conf);
 
     for (Map.Entry<String, String> entry: hiveConf) {
       if (conf.get(entry.getKey()) == null) {
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/tez/TezTask.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/tez/TezTask.java
index c0dd791d94..1a36b4b08b 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/tez/TezTask.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/tez/TezTask.java
@@ -153,7 +153,7 @@ private DAGClient submit(JobConf conf, DAG dag, Path scratchDir, LocalResource a
 
     // setup local resources used by application master
     Map<String, LocalResource> amLrs = new HashMap<String, LocalResource>();
-    amLrs.put(appJarLr.getResource().getFile(), appJarLr);
+    amLrs.put(DagUtils.getBaseName(appJarLr), appJarLr);
 
     // ready to start execution on the cluster
     DAGClient dagClient = tezClient.submitDAGApplication(dag, scratchDir,
