diff --git a/CHANGES.txt b/CHANGES.txt
index 09c9fe05e1..a92be0b515 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -158,6 +158,8 @@ Trunk - Unreleased
     HIVE-504. Fix script operator with empty input file.
     (Raghu Murthy via zshao)
 
+    HIVE-507. Handle empty files properly. (Namit Jain via zshao)
+
 Release 0.3.1 - Unreleased
 
   INCOMPATIBLE CHANGES
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/ExecDriver.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/ExecDriver.java
index 8ba1d6e166..4b03680302 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/ExecDriver.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/ExecDriver.java
@@ -633,7 +633,7 @@ private void addInputPaths(JobConf job, mapredWork work, String hiveScratchDir)
       
       Class<? extends HiveOutputFormat> outFileFormat = (Class<? extends HiveOutputFormat>)Class.forName("org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat");
       
-      String newFile = "file:" + hiveScratchDir + File.separator + (++numEmptyPaths);
+      String newFile = hiveScratchDir + File.separator + (++numEmptyPaths);
       Path newPath = new Path(newFile);
       LOG.info("Changed input file to " + newPath.toString());
       
@@ -683,7 +683,7 @@ private void addInputPaths(JobConf job, mapredWork work, String hiveScratchDir)
       for (String emptyFile : emptyPaths) {
         Class<? extends HiveOutputFormat> outFileFormat = work.getPathToPartitionInfo().get(emptyFile).getTableDesc().getOutputFileFormatClass();
         
-        String newFile = "file:" + hiveScratchDir + File.separator + (++numEmptyPaths);
+        String newFile = hiveScratchDir + File.separator + (++numEmptyPaths);
         Path newPath = new Path(newFile);
         LOG.info("Changed input file to " + newPath.toString());
         
