diff --git a/llap-tez/src/java/org/apache/hadoop/hive/llap/tezplugins/LlapTaskCommunicator.java b/llap-tez/src/java/org/apache/hadoop/hive/llap/tezplugins/LlapTaskCommunicator.java
index 893b7d9b5a..3aae7a42fa 100644
--- a/llap-tez/src/java/org/apache/hadoop/hive/llap/tezplugins/LlapTaskCommunicator.java
+++ b/llap-tez/src/java/org/apache/hadoop/hive/llap/tezplugins/LlapTaskCommunicator.java
@@ -541,7 +541,7 @@ public void indicateError(Throwable t) {
   @Override
   public String getInProgressLogsUrl(TezTaskAttemptID attemptID, NodeId containerNodeId) {
     String url = "";
-    if (timelineServerUri != null) {
+    if (timelineServerUri != null && containerNodeId != null) {
       LlapNodeId llapNodeId = LlapNodeId.getInstance(containerNodeId.getHost(), containerNodeId.getPort());
       BiMap<ContainerId, TezTaskAttemptID> biMap = entityTracker.getContainerAttemptMapForNode(llapNodeId);
       ContainerId containerId = biMap.inverse().get(attemptID);
@@ -559,7 +559,7 @@ public String getInProgressLogsUrl(TezTaskAttemptID attemptID, NodeId containerN
   @Override
   public String getCompletedLogsUrl(TezTaskAttemptID attemptID, NodeId containerNodeId) {
     String url = "";
-    if (timelineServerUri != null) {
+    if (timelineServerUri != null && containerNodeId != null) {
       LlapNodeId llapNodeId = LlapNodeId.getInstance(containerNodeId.getHost(), containerNodeId.getPort());
       BiMap<ContainerId, TezTaskAttemptID> biMap = entityTracker.getContainerAttemptMapForNode(llapNodeId);
       ContainerId containerId = biMap.inverse().get(attemptID);
