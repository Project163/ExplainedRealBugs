diff --git a/itests/hive-unit/src/test/java/org/apache/hadoop/hive/ql/txn/compactor/CompactorOnTezTest.java b/itests/hive-unit/src/test/java/org/apache/hadoop/hive/ql/txn/compactor/CompactorOnTezTest.java
index 78174f345b..05d72ba40d 100644
--- a/itests/hive-unit/src/test/java/org/apache/hadoop/hive/ql/txn/compactor/CompactorOnTezTest.java
+++ b/itests/hive-unit/src/test/java/org/apache/hadoop/hive/ql/txn/compactor/CompactorOnTezTest.java
@@ -110,7 +110,12 @@ protected class TestDataProvider {
 
     void createFullAcidTable(String tblName, boolean isPartitioned, boolean isBucketed)
         throws Exception {
-      createTable(tblName, isPartitioned, isBucketed, false, "orc");
+      createFullAcidTable(null, tblName, isPartitioned, isBucketed);
+    }
+
+    void createFullAcidTable(String dbName, String tblName, boolean isPartitioned, boolean isBucketed)
+        throws Exception {
+      createTable(dbName, tblName, isPartitioned, isBucketed, false, "orc");
     }
 
     void createMmTable(String tblName, boolean isPartitioned, boolean isBucketed)
@@ -120,12 +125,19 @@ void createMmTable(String tblName, boolean isPartitioned, boolean isBucketed)
 
     void createMmTable(String tblName, boolean isPartitioned, boolean isBucketed, String fileFormat)
         throws Exception {
-      createTable(tblName, isPartitioned, isBucketed, true, fileFormat);
+      createMmTable(null, tblName, isPartitioned, isBucketed, fileFormat);
     }
 
-    private void createTable(String tblName, boolean isPartitioned, boolean isBucketed,
-        boolean insertOnly, String fileFormat) throws Exception {
+    void createMmTable(String dbName, String tblName, boolean isPartitioned, boolean isBucketed, String fileFormat)
+        throws Exception {
+      createTable(dbName, tblName, isPartitioned, isBucketed, true, fileFormat);
+    }
 
+    private void createTable(String dbName, String tblName, boolean isPartitioned, boolean isBucketed,
+        boolean insertOnly, String fileFormat) throws Exception {
+      if (dbName != null) {
+        tblName = dbName + "." + tblName;
+      }
       executeStatementOnDriver("drop table if exists " + tblName, driver);
       StringBuilder query = new StringBuilder();
       query.append("create table ").append(tblName).append(" (a string, b int)");
@@ -145,6 +157,11 @@ private void createTable(String tblName, boolean isPartitioned, boolean isBucket
       executeStatementOnDriver(query.toString(), driver);
     }
 
+    void createDb(String dbName) throws Exception {
+      executeStatementOnDriver("drop database if exists " + dbName + " cascade", driver);
+      executeStatementOnDriver("create database " + dbName, driver);
+    }
+
     /**
      * 5 txns.
      */
@@ -178,7 +195,17 @@ protected void insertMmTestDataPartitioned(String tblName) throws Exception {
     /**
      * 5 txns.
      */
-    protected void insertTestData(String tblName) throws Exception {
+    void insertTestData(String tblName) throws Exception {
+      insertTestData(null, tblName);
+    }
+
+    /**
+     * 5 txns.
+     */
+    void insertTestData(String dbName, String tblName) throws Exception {
+      if (dbName != null) {
+        tblName = dbName + "." + tblName;
+      }
       executeStatementOnDriver("insert into " + tblName + " values('1',2),('1',3),('1',4),('2',2),('2',3),('2',4)",
           driver);
       executeStatementOnDriver("insert into " + tblName + " values('3',2),('3',3),('3',4),('4',2),('4',3),('4',4)",
@@ -189,10 +216,20 @@ protected void insertTestData(String tblName) throws Exception {
       executeStatementOnDriver("delete from " + tblName + " where a = '1'", driver);
     }
 
+    /**
+     * 5 txns.
+     */
+    void insertMmTestData(String tblName) throws Exception {
+      insertMmTestData(null, tblName);
+    }
+
     /**
      * 3 txns.
      */
-    protected void insertMmTestData(String tblName) throws Exception {
+    void insertMmTestData(String dbName, String tblName) throws Exception {
+      if (dbName != null) {
+        tblName = dbName + "." + tblName;
+      }
       executeStatementOnDriver("insert into " + tblName + " values('1',2),('1',3),('1',4),('2',2),('2',3),('2',4)",
           driver);
       executeStatementOnDriver("insert into " + tblName + " values('3',2),('3',3),('3',4),('4',2),('4',3),('4',4)",
@@ -222,7 +259,14 @@ protected void insertMmTestData(String tblName, int iterations) throws Exception
       }
     }
 
-    protected List<String> getAllData(String tblName) throws Exception {
+    List<String> getAllData(String tblName) throws Exception {
+      return getAllData(null, tblName);
+    }
+
+    List<String> getAllData(String dbName, String tblName) throws Exception {
+      if (dbName != null) {
+        tblName = dbName + "." + tblName;
+      }
       List<String> result = executeStatementOnDriverAndReturnResults("select * from " + tblName, driver);
       Collections.sort(result);
       return result;
diff --git a/itests/hive-unit/src/test/java/org/apache/hadoop/hive/ql/txn/compactor/TestCrudCompactorOnTez.java b/itests/hive-unit/src/test/java/org/apache/hadoop/hive/ql/txn/compactor/TestCrudCompactorOnTez.java
index 9659a3f048..89920ccebf 100644
--- a/itests/hive-unit/src/test/java/org/apache/hadoop/hive/ql/txn/compactor/TestCrudCompactorOnTez.java
+++ b/itests/hive-unit/src/test/java/org/apache/hadoop/hive/ql/txn/compactor/TestCrudCompactorOnTez.java
@@ -27,12 +27,14 @@
 import org.apache.hadoop.fs.FileStatus;
 import org.apache.hadoop.fs.FileSystem;
 import org.apache.hadoop.fs.Path;
+import org.apache.hadoop.fs.PathFilter;
 import org.apache.hadoop.hive.common.ValidTxnList;
 import org.apache.hadoop.hive.common.ValidWriteIdList;
 import org.apache.hadoop.hive.conf.HiveConf;
 import org.apache.hadoop.hive.metastore.HiveMetaStoreClient;
 import org.apache.hadoop.hive.metastore.IMetaStoreClient;
 import org.apache.hadoop.hive.metastore.api.CompactionType;
+import org.apache.hadoop.hive.metastore.api.MetaException;
 import org.apache.hadoop.hive.metastore.api.Partition;
 import org.apache.hadoop.hive.metastore.api.ShowCompactRequest;
 import org.apache.hadoop.hive.metastore.api.ShowCompactResponseElement;
@@ -920,6 +922,64 @@ public void testCompactionWithSchemaEvolutionNoBucketsMultipleReducers() throws
     executeStatementOnDriver("drop table " + tblName, driver);
   }
 
+  @Test public void testMajorCompactionDb() throws Exception {
+    testCompactionDb(CompactionType.MAJOR, "base_0000005_v0000011");
+  }
+
+  @Test public void testMinorCompactionDb() throws Exception {
+    testCompactionDb(CompactionType.MINOR, "delta_0000001_0000005_v0000011");
+  }
+
+  /**
+   * Make sure db is specified in compaction queries.
+   */
+  private void testCompactionDb(CompactionType compactionType, String resultDirName)
+      throws Exception {
+    String dbName = "myDb";
+    String tableName = "testCompactionDb";
+    // Create test table
+    TestDataProvider dataProvider = new TestDataProvider();
+    dataProvider.createDb(dbName);
+    dataProvider.createFullAcidTable(dbName, tableName, false, false);
+    // Find the location of the table
+    IMetaStoreClient metaStoreClient = new HiveMetaStoreClient(conf);
+    Table table = metaStoreClient.getTable(dbName, tableName);
+    FileSystem fs = FileSystem.get(conf);
+    // Insert test data into test table
+    dataProvider.insertTestData(dbName, tableName);
+    // Get all data before compaction is run
+    List<String> expectedData = dataProvider.getAllData(dbName, tableName);
+    Collections.sort(expectedData);
+    // Run a compaction
+    CompactorTestUtil.runCompaction(conf, dbName, tableName, compactionType, true);
+    CompactorTestUtil.runCleaner(conf);
+    verifySuccessulTxn(1);
+    // Verify directories after compaction
+    PathFilter pathFilter = compactionType == CompactionType.MAJOR ? AcidUtils.baseFileFilter :
+        AcidUtils.deltaFileFilter;
+    Assert.assertEquals("Result directory does not match after " + compactionType.name()
+            + " compaction", Collections.singletonList(resultDirName),
+        CompactorTestUtil.getBaseOrDeltaNames(fs, pathFilter, table, null));
+    // Verify all contents
+    List<String> actualData = dataProvider.getAllData(dbName, tableName);
+    Assert.assertEquals(expectedData, actualData);
+  }
+
+  /**
+   * Verify that the expected number of transactions have run, and their state is "succeeded".
+   *
+   * @param expectedCompleteCompacts number of compactions already run
+   * @throws MetaException
+   */
+  private void verifySuccessulTxn(int expectedCompleteCompacts) throws MetaException {
+    List<ShowCompactResponseElement> compacts =
+        TxnUtils.getTxnStore(conf).showCompact(new ShowCompactRequest()).getCompacts();
+    Assert.assertEquals("Completed compaction queue must contain one element",
+        expectedCompleteCompacts, compacts.size());
+    compacts.forEach(
+        c -> Assert.assertEquals("Compaction state is not succeeded", "succeeded", c.getState()));
+  }
+
   /**
    * Tests whether hive.llap.io.etl.skip.format config is handled properly whenever QueryCompactor#runCompactionQueries
    * is invoked.
diff --git a/itests/hive-unit/src/test/java/org/apache/hadoop/hive/ql/txn/compactor/TestMmCompactorOnTez.java b/itests/hive-unit/src/test/java/org/apache/hadoop/hive/ql/txn/compactor/TestMmCompactorOnTez.java
index 43a216b0cf..2c717b73d2 100644
--- a/itests/hive-unit/src/test/java/org/apache/hadoop/hive/ql/txn/compactor/TestMmCompactorOnTez.java
+++ b/itests/hive-unit/src/test/java/org/apache/hadoop/hive/ql/txn/compactor/TestMmCompactorOnTez.java
@@ -21,6 +21,7 @@
 import org.apache.hadoop.fs.FileStatus;
 import org.apache.hadoop.fs.FileSystem;
 import org.apache.hadoop.fs.Path;
+import org.apache.hadoop.fs.PathFilter;
 import org.apache.hadoop.hive.conf.HiveConf;
 import org.apache.hadoop.hive.metastore.HiveMetaStoreClient;
 import org.apache.hadoop.hive.metastore.IMetaStoreClient;
@@ -527,6 +528,48 @@ private void testMmMinorCompactionPartitionedWithBuckets(String fileFormat) thro
     verifyAllContents(tableName, testDataProvider, expectedData);
   }
 
+  @Test public void testMmMajorCompactionDb() throws Exception {
+    testMmCompactionDb(CompactionType.MAJOR, "base_0000003_v0000009");
+  }
+
+  @Test public void testMmMinorCompactionDb() throws Exception {
+    testMmCompactionDb(CompactionType.MINOR, "delta_0000001_0000003_v0000009");
+  }
+
+  /**
+   * Make sure db is specified in compaction queries.
+   */
+  private void testMmCompactionDb(CompactionType compactionType, String resultDirName) throws Exception {
+    String dbName = "myDb";
+    String tableName = "testMmCompactionDb";
+    // Create test table
+    TestDataProvider dataProvider = new TestDataProvider();
+    dataProvider.createDb(dbName);
+    dataProvider.createMmTable(dbName, tableName, false, false, "orc");
+    // Find the location of the table
+    IMetaStoreClient metaStoreClient = new HiveMetaStoreClient(conf);
+    Table table = metaStoreClient.getTable(dbName, tableName);
+    FileSystem fs = FileSystem.get(conf);
+    // Insert test data into test table
+    dataProvider.insertMmTestData(dbName, tableName);
+    // Get all data before compaction is run
+    List<String> expectedData = dataProvider.getAllData(dbName, tableName);
+    Collections.sort(expectedData);
+    // Run a compaction
+    CompactorTestUtil.runCompaction(conf, dbName, tableName, compactionType, true);
+    CompactorTestUtil.runCleaner(conf);
+    verifySuccessulTxn(1);
+    // Verify directories after compaction
+    PathFilter pathFilter = compactionType == CompactionType.MAJOR ? AcidUtils.baseFileFilter :
+        AcidUtils.deltaFileFilter;
+    Assert.assertEquals("Result directories does not match after " + compactionType.name()
+            + " compaction", Collections.singletonList(resultDirName),
+        CompactorTestUtil.getBaseOrDeltaNames(fs, pathFilter, table, null));
+    List<String> actualData = dataProvider.getAllData(dbName, tableName);
+    Collections.sort(actualData);
+    Assert.assertEquals(expectedData, actualData);
+  }
+
   /**
    * Verify that the expected number of transactions have run, and their state is "succeeded".
    *
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/txn/compactor/CompactionQueryBuilder.java b/ql/src/java/org/apache/hadoop/hive/ql/txn/compactor/CompactionQueryBuilder.java
index 6b3a4db26e..193f8323e8 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/txn/compactor/CompactionQueryBuilder.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/txn/compactor/CompactionQueryBuilder.java
@@ -46,7 +46,6 @@
 import java.util.HashSet;
 import java.util.List;
 import java.util.Map;
-import java.util.Optional;
 import java.util.Set;
 import java.util.stream.Collectors;
 
@@ -68,7 +67,7 @@ class CompactionQueryBuilder {
   private ValidWriteIdList validWriteIdList; // for Alter/Insert in minor and CRUD
   private AcidUtils.Directory dir; // for Alter in minor
   private Partition sourcePartition; // for Insert in major and insert-only minor
-  private String fromTableName; // for Insert
+  private String sourceTabForInsert; // for Insert
 
   // settable booleans
   private boolean isPartitioned; // for Create
@@ -158,10 +157,10 @@ CompactionQueryBuilder setSourcePartition(Partition sourcePartition) {
    * Set table to select from.
    * Required for Insert operations.
    *
-   * @param fromTableName name of table to select from, not null
+   * @param sourceTabForInsert name of table to select from, not null
    */
-  CompactionQueryBuilder setFromTableName(String fromTableName) {
-    this.fromTableName = fromTableName;
+  CompactionQueryBuilder setSourceTabForInsert(String sourceTabForInsert) {
+    this.sourceTabForInsert = sourceTabForInsert;
     return this;
   }
 
@@ -247,8 +246,8 @@ String build() {
     case INSERT:
       query.append(" select ");
       buildSelectClauseForInsert(query);
-      query.append(" from ")
-          .append(fromTableName);
+      query.append(" from ");
+      getSourceForInsert(query);
       buildWhereClauseForInsert(query);
       break;
     case DROP:
@@ -326,6 +325,14 @@ private void buildSelectClauseForInsert(StringBuilder query) {
     }
   }
 
+  private void getSourceForInsert(StringBuilder query) {
+    if (sourceTabForInsert != null) {
+      query.append(sourceTabForInsert);
+    } else {
+      query.append(sourceTab.getDbName()).append(".").append(sourceTab.getTableName());
+    }
+  }
+
   private void buildWhereClauseForInsert(StringBuilder query) {
     if (major && sourcePartition != null && sourceTab != null) {
       List<String> vals = sourcePartition.getValues();
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/txn/compactor/MajorQueryCompactor.java b/ql/src/java/org/apache/hadoop/hive/ql/txn/compactor/MajorQueryCompactor.java
index f47c23a6de..c70d4f33a8 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/txn/compactor/MajorQueryCompactor.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/txn/compactor/MajorQueryCompactor.java
@@ -98,7 +98,6 @@ private List<String> getCompactionQueries(Table t, Partition p, String tmpName)
             CompactionQueryBuilder.CompactionType.MAJOR_CRUD,
             CompactionQueryBuilder.Operation.INSERT,
             tmpName)
-            .setFromTableName(t.getTableName())
             .setSourceTab(t)
             .setSourcePartition(p)
         .build());
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/txn/compactor/MinorQueryCompactor.java b/ql/src/java/org/apache/hadoop/hive/ql/txn/compactor/MinorQueryCompactor.java
index 1bf0beea40..4d0e5f703e 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/txn/compactor/MinorQueryCompactor.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/txn/compactor/MinorQueryCompactor.java
@@ -221,7 +221,7 @@ private String buildCompactionQuery(String sourceTableName, String resultTableNa
         CompactionQueryBuilder.CompactionType.MINOR_CRUD,
         CompactionQueryBuilder.Operation.INSERT,
         resultTableName)
-        .setFromTableName(sourceTableName)
+        .setSourceTabForInsert(sourceTableName)
         .setSourceTab(table)
         .setValidWriteIdList(validWriteIdList)
         .build();
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/txn/compactor/MmMajorQueryCompactor.java b/ql/src/java/org/apache/hadoop/hive/ql/txn/compactor/MmMajorQueryCompactor.java
index 114b6f7a74..724a4375b7 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/txn/compactor/MmMajorQueryCompactor.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/txn/compactor/MmMajorQueryCompactor.java
@@ -124,7 +124,6 @@ private List<String> getCompactionQueries(Table t, Partition p, String tmpName)
             CompactionQueryBuilder.Operation.INSERT,
             tmpName)
             .setSourceTab(t)
-            .setFromTableName(t.getTableName())
             .setSourcePartition(p)
             .build()
     );
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/txn/compactor/MmMinorQueryCompactor.java b/ql/src/java/org/apache/hadoop/hive/ql/txn/compactor/MmMinorQueryCompactor.java
index 383891bfad..1cd95f8015 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/txn/compactor/MmMinorQueryCompactor.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/txn/compactor/MmMinorQueryCompactor.java
@@ -182,7 +182,7 @@ private List<String> getCompactionQueries(String sourceTmpTableName, String resu
             CompactionQueryBuilder.CompactionType.MINOR_INSERT_ONLY,
             CompactionQueryBuilder.Operation.INSERT,
             resultTmpTableName)
-        .setFromTableName(sourceTmpTableName)
+        .setSourceTabForInsert(sourceTmpTableName)
         .setSourceTab(sourceTable)
         .build()
     );
