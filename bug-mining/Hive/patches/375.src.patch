diff --git a/CHANGES.txt b/CHANGES.txt
index c26e8eb323..5509c392f4 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -348,6 +348,9 @@ Trunk -  Unreleased
     HIVE-1280. Add option to CombineHiveInputFormat for non-splittable inputs.
     (Namit Jain via zshao)
 
+    HIVE-1011. GenericUDTFExplode() throws NPE when given nulls
+    (Paul Yang via namit)
+
 Release 0.5.0 -  Unreleased
 
   INCOMPATIBLE CHANGES
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDTFExplode.java b/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDTFExplode.java
index c6b4c456d4..d1e7def8de 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDTFExplode.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDTFExplode.java
@@ -62,12 +62,14 @@ public StructObjectInspector initialize(ObjectInspector[] args) throws UDFArgume
         fieldOIs);
   }
 
-  private Object[] forwardObj = new Object[1];
+  private final Object[] forwardObj = new Object[1];
 
   @Override
   public void process(Object[] o) throws HiveException {
-
     List<?> list = listOI.getList(o[0]);
+    if(list == null) {
+      return;
+    }
     for (Object r : list) {
       forwardObj[0] = r;
       forward(forwardObj);
diff --git a/ql/src/test/queries/clientpositive/explode_null.q b/ql/src/test/queries/clientpositive/explode_null.q
new file mode 100644
index 0000000000..c1f3045f39
--- /dev/null
+++ b/ql/src/test/queries/clientpositive/explode_null.q
@@ -0,0 +1,5 @@
+SELECT explode(col) AS myCol FROM 
+    (SELECT array(1,2,3) AS col FROM src LIMIT 1 
+     UNION ALL
+     SELECT IF(false, array(1,2,3), NULL) AS col FROM src LIMIT 1) a;
+     
\ No newline at end of file
diff --git a/ql/src/test/results/clientpositive/explode_null.q.out b/ql/src/test/results/clientpositive/explode_null.q.out
new file mode 100644
index 0000000000..f53b446507
--- /dev/null
+++ b/ql/src/test/results/clientpositive/explode_null.q.out
@@ -0,0 +1,17 @@
+PREHOOK: query: SELECT explode(col) AS myCol FROM 
+    (SELECT array(1,2,3) AS col FROM src LIMIT 1 
+     UNION ALL
+     SELECT IF(false, array(1,2,3), NULL) AS col FROM src LIMIT 1) a
+PREHOOK: type: QUERY
+PREHOOK: Input: default@src
+PREHOOK: Output: file:/data/users/pyang/task2/trunk/VENDOR.hive/trunk/build/ql/scratchdir/hive_2010-04-08_15-57-57_440_1997210643218047348/10000
+POSTHOOK: query: SELECT explode(col) AS myCol FROM 
+    (SELECT array(1,2,3) AS col FROM src LIMIT 1 
+     UNION ALL
+     SELECT IF(false, array(1,2,3), NULL) AS col FROM src LIMIT 1) a
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@src
+POSTHOOK: Output: file:/data/users/pyang/task2/trunk/VENDOR.hive/trunk/build/ql/scratchdir/hive_2010-04-08_15-57-57_440_1997210643218047348/10000
+1
+2
+3
