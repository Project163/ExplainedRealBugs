diff --git a/ql/src/test/org/apache/hadoop/hive/ql/io/orc/TestRecordReaderImpl.java b/ql/src/test/org/apache/hadoop/hive/ql/io/orc/TestRecordReaderImpl.java
index fe87794d6d..8731be07d1 100644
--- a/ql/src/test/org/apache/hadoop/hive/ql/io/orc/TestRecordReaderImpl.java
+++ b/ql/src/test/org/apache/hadoop/hive/ql/io/orc/TestRecordReaderImpl.java
@@ -1663,10 +1663,8 @@ public void testCloseWithException() throws Exception {
 
   private void closeMockedRecordReader(DataReader mockedDataReader) throws IOException {
     Configuration conf = new Configuration();
-    FileSystem fs = FileSystem.getLocal(conf).getRaw();
-    fs.delete(workDir, true);
-    fs.mkdirs(workDir);
     Path path = new Path(workDir, "empty.orc");
+    FileSystem.get(conf).delete(path, true);
     Writer writer = OrcFile.createWriter(path, OrcFile.writerOptions(conf)
         .setSchema(TypeDescription.createLong()));
     writer.close();
