diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/ExprNodeEvaluatorFactory.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/ExprNodeEvaluatorFactory.java
index b31d2ea3b6..a4916774af 100755
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/ExprNodeEvaluatorFactory.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/ExprNodeEvaluatorFactory.java
@@ -100,12 +100,14 @@ private static ExprNodeEvaluator iterate(ExprNodeEvaluator eval, EvaluatorContex
 
   private static class EvaluatorContext {
 
-    private final Map<String, ExprNodeEvaluator> cached = new HashMap<String, ExprNodeEvaluator>();
+    private final Map<ExprNodeDesc.ExprNodeDescEqualityWrapper, ExprNodeEvaluator> cached = 
+        new HashMap<ExprNodeDesc.ExprNodeDescEqualityWrapper, ExprNodeEvaluator>();
 
     private boolean hasReference;
 
     public ExprNodeEvaluator getEvaluated(ExprNodeEvaluator eval) {
-      String key = eval.getExpr().toString();
+      ExprNodeDesc.ExprNodeDescEqualityWrapper key = 
+          new ExprNodeDesc.ExprNodeDescEqualityWrapper(eval.expr); 
       ExprNodeEvaluator prev = cached.get(key);
       if (prev == null) {
         cached.put(key, eval);
diff --git a/ql/src/test/queries/clientpositive/expr_cached.q b/ql/src/test/queries/clientpositive/expr_cached.q
new file mode 100644
index 0000000000..8fc182c054
--- /dev/null
+++ b/ql/src/test/queries/clientpositive/expr_cached.q
@@ -0,0 +1,4 @@
+set hive.fetch.task.conversion=more;
+
+-- should return a value
+select * from src tablesample (1 rows) where length(key) <> reverse(key);
\ No newline at end of file
diff --git a/ql/src/test/results/clientpositive/expr_cached.q.out b/ql/src/test/results/clientpositive/expr_cached.q.out
new file mode 100644
index 0000000000..9f0b651a5d
--- /dev/null
+++ b/ql/src/test/results/clientpositive/expr_cached.q.out
@@ -0,0 +1,11 @@
+PREHOOK: query: -- should return a value
+select * from src tablesample (1 rows) where length(key) <> reverse(key)
+PREHOOK: type: QUERY
+PREHOOK: Input: default@src
+#### A masked pattern was here ####
+POSTHOOK: query: -- should return a value
+select * from src tablesample (1 rows) where length(key) <> reverse(key)
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@src
+#### A masked pattern was here ####
+238	val_238
