diff --git a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/calcite/rules/HiveRelFieldTrimmer.java b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/calcite/rules/HiveRelFieldTrimmer.java
index c242524884..7143af237f 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/calcite/rules/HiveRelFieldTrimmer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/calcite/rules/HiveRelFieldTrimmer.java
@@ -581,7 +581,7 @@ private Aggregate rewriteGBConstantKeys(Aggregate aggregate, ImmutableBitSet fie
       relBuilder.push(input);
       relBuilder.project(newProjects);
       Aggregate newAggregate = new HiveAggregate(aggregate.getCluster(), aggregate.getTraitSet(), relBuilder.build(),
-          aggregate.getGroupSet(), null, aggregate.getAggCallList());
+          aggregate.getGroupSet(), aggregate.getGroupSets(), aggregate.getAggCallList());
       return newAggregate;
     }
     return aggregate;
diff --git a/ql/src/test/queries/clientpositive/multi_count_distinct_null.q b/ql/src/test/queries/clientpositive/multi_count_distinct_null.q
index 3e16386409..be5d0ae4f0 100644
--- a/ql/src/test/queries/clientpositive/multi_count_distinct_null.q
+++ b/ql/src/test/queries/clientpositive/multi_count_distinct_null.q
@@ -3,9 +3,16 @@ set hive.mapred.mode=nonstrict;
 drop table employee;
 
 create table employee (department_id int, gender varchar(10), education_level int);
- 
+
+explain cbo
+select count(distinct 0), count(distinct null) from employee;
+
+select count(distinct 0), count(distinct null) from employee;
+
 insert into employee values (1, 'M', 1),(1, 'M', 1),(2, 'F', 1),(1, 'F', 3),(1, 'M', 2),(4, 'M', 1),(2, 'F', 1),(2, 'F', 3),(3, 'M', 2),(null, 'M', 1),(null, null, 1),(null, null, null);
 
+select count(distinct 0), count(distinct null) from employee;
+
 explain select count(distinct department_id), count(distinct gender), count(distinct education_level) from employee;
 
 select count(distinct gender), count(distinct department_id), count(distinct education_level) from employee;
diff --git a/ql/src/test/results/clientpositive/llap/multi_count_distinct_null.q.out b/ql/src/test/results/clientpositive/llap/multi_count_distinct_null.q.out
index 07758e5030..008f4c4ba3 100644
--- a/ql/src/test/results/clientpositive/llap/multi_count_distinct_null.q.out
+++ b/ql/src/test/results/clientpositive/llap/multi_count_distinct_null.q.out
@@ -10,6 +10,32 @@ POSTHOOK: query: create table employee (department_id int, gender varchar(10), e
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@employee
+PREHOOK: query: explain cbo
+select count(distinct 0), count(distinct null) from employee
+PREHOOK: type: QUERY
+PREHOOK: Input: default@employee
+PREHOOK: Output: hdfs://### HDFS PATH ###
+POSTHOOK: query: explain cbo
+select count(distinct 0), count(distinct null) from employee
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@employee
+POSTHOOK: Output: hdfs://### HDFS PATH ###
+CBO PLAN:
+HiveAggregate(group=[{}], agg#0=[count($0)], agg#1=[count($1)])
+  HiveProject($f0=[CASE(=($2, 1), 1, null:INTEGER)], $f1=[null:INTEGER])
+    HiveAggregate(group=[{0, 1}], groups=[[{0}, {1}]], GROUPING__ID=[GROUPING__ID()])
+      HiveProject($f0=[true], $f1=[true])
+        HiveTableScan(table=[[default, employee]], table:alias=[employee])
+
+PREHOOK: query: select count(distinct 0), count(distinct null) from employee
+PREHOOK: type: QUERY
+PREHOOK: Input: default@employee
+PREHOOK: Output: hdfs://### HDFS PATH ###
+POSTHOOK: query: select count(distinct 0), count(distinct null) from employee
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@employee
+POSTHOOK: Output: hdfs://### HDFS PATH ###
+0	0
 PREHOOK: query: insert into employee values (1, 'M', 1),(1, 'M', 1),(2, 'F', 1),(1, 'F', 3),(1, 'M', 2),(4, 'M', 1),(2, 'F', 1),(2, 'F', 3),(3, 'M', 2),(null, 'M', 1),(null, null, 1),(null, null, null)
 PREHOOK: type: QUERY
 PREHOOK: Input: _dummy_database@_dummy_table
@@ -21,6 +47,15 @@ POSTHOOK: Output: default@employee
 POSTHOOK: Lineage: employee.department_id SCRIPT []
 POSTHOOK: Lineage: employee.education_level SCRIPT []
 POSTHOOK: Lineage: employee.gender SCRIPT []
+PREHOOK: query: select count(distinct 0), count(distinct null) from employee
+PREHOOK: type: QUERY
+PREHOOK: Input: default@employee
+PREHOOK: Output: hdfs://### HDFS PATH ###
+POSTHOOK: query: select count(distinct 0), count(distinct null) from employee
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@employee
+POSTHOOK: Output: hdfs://### HDFS PATH ###
+1	0
 PREHOOK: query: explain select count(distinct department_id), count(distinct gender), count(distinct education_level) from employee
 PREHOOK: type: QUERY
 PREHOOK: Input: default@employee
