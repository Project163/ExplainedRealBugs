diff --git a/cli/src/java/org/apache/hadoop/hive/cli/CliDriver.java b/cli/src/java/org/apache/hadoop/hive/cli/CliDriver.java
index dd544f3b03..3357414513 100644
--- a/cli/src/java/org/apache/hadoop/hive/cli/CliDriver.java
+++ b/cli/src/java/org/apache/hadoop/hive/cli/CliDriver.java
@@ -148,6 +148,11 @@ public int processCmd(String cmd) {
         errPrinter.start();
 
         ret = executor.waitFor();
+
+        // wait for stream threads to finish
+        outPrinter.join();
+        errPrinter.join();
+
         if (ret != 0) {
           console.printError("Command failed with exit code = " + ret);
         }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/mr/MapRedTask.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/mr/MapRedTask.java
index 326654faca..2ce4dbd8a2 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/mr/MapRedTask.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/mr/MapRedTask.java
@@ -276,6 +276,10 @@ public int execute(DriverContext driverContext) {
 
       int exitVal = jobExecHelper.progressLocal(executor, getId());
 
+      // wait for stream threads to finish
+      outPrinter.join();
+      errPrinter.join();
+
       if (exitVal != 0) {
         LOG.error("Execution failed with exit status: " + exitVal);
         if (SessionState.get() != null) {
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/mr/MapredLocalTask.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/mr/MapredLocalTask.java
index 34b063d2c6..d2e122d80a 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/mr/MapredLocalTask.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/mr/MapredLocalTask.java
@@ -264,6 +264,10 @@ public int execute(DriverContext driverContext) {
 
       int exitVal = jobExecHelper.progressLocal(executor, getId());
 
+      // wait for stream threads to finish
+      outPrinter.join();
+      errPrinter.join();
+
       if (exitVal != 0) {
         LOG.error("Execution failed with exit status: " + exitVal);
         if (SessionState.get() != null) {
