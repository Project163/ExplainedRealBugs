diff --git a/streaming/src/java/org/apache/hive/streaming/TransactionBatch.java b/streaming/src/java/org/apache/hive/streaming/TransactionBatch.java
index 40239ab53e..9215e1b80c 100644
--- a/streaming/src/java/org/apache/hive/streaming/TransactionBatch.java
+++ b/streaming/src/java/org/apache/hive/streaming/TransactionBatch.java
@@ -114,8 +114,6 @@ public TransactionBatch(HiveStreamingConnection conn) throws StreamingException
       this.numTxns = conn.getTransactionBatchSize();
       this.tableId = conn.getTable().getTTable().getId();
 
-      setupHeartBeatThread();
-
       List<Long> txnIds = openTxnImpl(username, numTxns);
       txnToWriteIds = allocateWriteIdsImpl(txnIds);
       assert (txnToWriteIds.size() == numTxns);
@@ -132,6 +130,7 @@ public TransactionBatch(HiveStreamingConnection conn) throws StreamingException
           txnToWriteIds.get(numTxns - 1).getWriteId(), conn.getStatementId());
       this.minTxnId = new AtomicLong(txnIds.get(0));
       this.maxTxnId = txnIds.get(txnIds.size() - 1);
+      setupHeartBeatThread();
       success = true;
     } catch (TException e) {
       throw new StreamingException(conn.toString(), e);
