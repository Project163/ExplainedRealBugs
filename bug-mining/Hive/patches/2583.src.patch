diff --git a/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/FieldSchema.java b/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/FieldSchema.java
index a99381013d..c84fa29ef6 100644
--- a/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/FieldSchema.java
+++ b/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/FieldSchema.java
@@ -135,9 +135,9 @@ public FieldSchema(
     String comment)
   {
     this();
-    this.name = name;
-    this.type = type;
-    this.comment = comment;
+    this.name = org.apache.hive.common.util.HiveStringUtils.intern(name);
+    this.type = org.apache.hive.common.util.HiveStringUtils.intern(type);
+    this.comment = org.apache.hive.common.util.HiveStringUtils.intern(comment);
   }
 
   /**
@@ -145,13 +145,13 @@ public FieldSchema(
    */
   public FieldSchema(FieldSchema other) {
     if (other.isSetName()) {
-      this.name = other.name;
+      this.name = org.apache.hive.common.util.HiveStringUtils.intern(other.name);
     }
     if (other.isSetType()) {
-      this.type = other.type;
+      this.type = org.apache.hive.common.util.HiveStringUtils.intern(other.type);
     }
     if (other.isSetComment()) {
-      this.comment = other.comment;
+      this.comment = org.apache.hive.common.util.HiveStringUtils.intern(other.comment);
     }
   }
 
@@ -171,7 +171,7 @@ public String getName() {
   }
 
   public void setName(String name) {
-    this.name = name;
+    this.name = org.apache.hive.common.util.HiveStringUtils.intern(name);
   }
 
   public void unsetName() {
@@ -194,7 +194,7 @@ public String getType() {
   }
 
   public void setType(String type) {
-    this.type = type;
+    this.type = org.apache.hive.common.util.HiveStringUtils.intern(type);
   }
 
   public void unsetType() {
@@ -217,7 +217,7 @@ public String getComment() {
   }
 
   public void setComment(String comment) {
-    this.comment = comment;
+    this.comment = org.apache.hive.common.util.HiveStringUtils.intern(comment);
   }
 
   public void unsetComment() {
diff --git a/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/Partition.java b/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/Partition.java
index 312807ed4e..242d54d222 100644
--- a/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/Partition.java
+++ b/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/Partition.java
@@ -182,14 +182,14 @@ public Partition(
   {
     this();
     this.values = values;
-    this.dbName = dbName;
-    this.tableName = tableName;
+    this.dbName = org.apache.hive.common.util.HiveStringUtils.intern(dbName);
+    this.tableName = org.apache.hive.common.util.HiveStringUtils.intern(tableName);
     this.createTime = createTime;
     setCreateTimeIsSet(true);
     this.lastAccessTime = lastAccessTime;
     setLastAccessTimeIsSet(true);
     this.sd = sd;
-    this.parameters = parameters;
+    this.parameters = org.apache.hive.common.util.HiveStringUtils.intern(parameters);
   }
 
   /**
@@ -205,10 +205,10 @@ public Partition(Partition other) {
       this.values = __this__values;
     }
     if (other.isSetDbName()) {
-      this.dbName = other.dbName;
+      this.dbName = org.apache.hive.common.util.HiveStringUtils.intern(other.dbName);
     }
     if (other.isSetTableName()) {
-      this.tableName = other.tableName;
+      this.tableName = org.apache.hive.common.util.HiveStringUtils.intern(other.tableName);
     }
     this.createTime = other.createTime;
     this.lastAccessTime = other.lastAccessTime;
@@ -222,9 +222,9 @@ public Partition(Partition other) {
         String other_element_key = other_element.getKey();
         String other_element_value = other_element.getValue();
 
-        String __this__parameters_copy_key = other_element_key;
+        String __this__parameters_copy_key = org.apache.hive.common.util.HiveStringUtils.intern(other_element_key);
 
-        String __this__parameters_copy_value = other_element_value;
+        String __this__parameters_copy_value = org.apache.hive.common.util.HiveStringUtils.intern(other_element_value);
 
         __this__parameters.put(__this__parameters_copy_key, __this__parameters_copy_value);
       }
@@ -296,7 +296,7 @@ public String getDbName() {
   }
 
   public void setDbName(String dbName) {
-    this.dbName = dbName;
+    this.dbName = org.apache.hive.common.util.HiveStringUtils.intern(dbName);
   }
 
   public void unsetDbName() {
@@ -319,7 +319,7 @@ public String getTableName() {
   }
 
   public void setTableName(String tableName) {
-    this.tableName = tableName;
+    this.tableName = org.apache.hive.common.util.HiveStringUtils.intern(tableName);
   }
 
   public void unsetTableName() {
@@ -420,7 +420,7 @@ public Map<String,String> getParameters() {
   }
 
   public void setParameters(Map<String,String> parameters) {
-    this.parameters = parameters;
+    this.parameters = org.apache.hive.common.util.HiveStringUtils.intern(parameters);
   }
 
   public void unsetParameters() {
diff --git a/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/SerDeInfo.java b/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/SerDeInfo.java
index 24d65bb5d9..2466d8fba8 100644
--- a/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/SerDeInfo.java
+++ b/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/SerDeInfo.java
@@ -137,9 +137,9 @@ public SerDeInfo(
     Map<String,String> parameters)
   {
     this();
-    this.name = name;
-    this.serializationLib = serializationLib;
-    this.parameters = parameters;
+    this.name = org.apache.hive.common.util.HiveStringUtils.intern(name);
+    this.serializationLib = org.apache.hive.common.util.HiveStringUtils.intern(serializationLib);
+    this.parameters = org.apache.hive.common.util.HiveStringUtils.intern(parameters);
   }
 
   /**
@@ -147,10 +147,10 @@ public SerDeInfo(
    */
   public SerDeInfo(SerDeInfo other) {
     if (other.isSetName()) {
-      this.name = other.name;
+      this.name = org.apache.hive.common.util.HiveStringUtils.intern(other.name);
     }
     if (other.isSetSerializationLib()) {
-      this.serializationLib = other.serializationLib;
+      this.serializationLib = org.apache.hive.common.util.HiveStringUtils.intern(other.serializationLib);
     }
     if (other.isSetParameters()) {
       Map<String,String> __this__parameters = new HashMap<String,String>();
@@ -159,9 +159,9 @@ public SerDeInfo(SerDeInfo other) {
         String other_element_key = other_element.getKey();
         String other_element_value = other_element.getValue();
 
-        String __this__parameters_copy_key = other_element_key;
+        String __this__parameters_copy_key = org.apache.hive.common.util.HiveStringUtils.intern(other_element_key);
 
-        String __this__parameters_copy_value = other_element_value;
+        String __this__parameters_copy_value = org.apache.hive.common.util.HiveStringUtils.intern(other_element_value);
 
         __this__parameters.put(__this__parameters_copy_key, __this__parameters_copy_value);
       }
@@ -185,7 +185,7 @@ public String getName() {
   }
 
   public void setName(String name) {
-    this.name = name;
+    this.name = org.apache.hive.common.util.HiveStringUtils.intern(name);
   }
 
   public void unsetName() {
@@ -208,7 +208,7 @@ public String getSerializationLib() {
   }
 
   public void setSerializationLib(String serializationLib) {
-    this.serializationLib = serializationLib;
+    this.serializationLib = org.apache.hive.common.util.HiveStringUtils.intern(serializationLib);
   }
 
   public void unsetSerializationLib() {
@@ -242,7 +242,7 @@ public Map<String,String> getParameters() {
   }
 
   public void setParameters(Map<String,String> parameters) {
-    this.parameters = parameters;
+    this.parameters = org.apache.hive.common.util.HiveStringUtils.intern(parameters);
   }
 
   public void unsetParameters() {
diff --git a/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/StorageDescriptor.java b/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/StorageDescriptor.java
index d0b9843be8..b91cc1c28f 100644
--- a/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/StorageDescriptor.java
+++ b/metastore/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/StorageDescriptor.java
@@ -216,17 +216,17 @@ public StorageDescriptor(
   {
     this();
     this.cols = cols;
-    this.location = location;
-    this.inputFormat = inputFormat;
-    this.outputFormat = outputFormat;
+    this.location = org.apache.hive.common.util.HiveStringUtils.intern(location);
+    this.inputFormat = org.apache.hive.common.util.HiveStringUtils.intern(inputFormat);
+    this.outputFormat = org.apache.hive.common.util.HiveStringUtils.intern(outputFormat);
     this.compressed = compressed;
     setCompressedIsSet(true);
     this.numBuckets = numBuckets;
     setNumBucketsIsSet(true);
     this.serdeInfo = serdeInfo;
-    this.bucketCols = bucketCols;
+    this.bucketCols = org.apache.hive.common.util.HiveStringUtils.intern(bucketCols);
     this.sortCols = sortCols;
-    this.parameters = parameters;
+    this.parameters = org.apache.hive.common.util.HiveStringUtils.intern(parameters);
   }
 
   /**
@@ -242,13 +242,13 @@ public StorageDescriptor(StorageDescriptor other) {
       this.cols = __this__cols;
     }
     if (other.isSetLocation()) {
-      this.location = other.location;
+      this.location = org.apache.hive.common.util.HiveStringUtils.intern(other.location);
     }
     if (other.isSetInputFormat()) {
-      this.inputFormat = other.inputFormat;
+      this.inputFormat = org.apache.hive.common.util.HiveStringUtils.intern(other.inputFormat);
     }
     if (other.isSetOutputFormat()) {
-      this.outputFormat = other.outputFormat;
+      this.outputFormat = org.apache.hive.common.util.HiveStringUtils.intern(other.outputFormat);
     }
     this.compressed = other.compressed;
     this.numBuckets = other.numBuckets;
@@ -276,9 +276,9 @@ public StorageDescriptor(StorageDescriptor other) {
         String other_element_key = other_element.getKey();
         String other_element_value = other_element.getValue();
 
-        String __this__parameters_copy_key = other_element_key;
+        String __this__parameters_copy_key = org.apache.hive.common.util.HiveStringUtils.intern(other_element_key);
 
-        String __this__parameters_copy_value = other_element_value;
+        String __this__parameters_copy_value = org.apache.hive.common.util.HiveStringUtils.intern(other_element_value);
 
         __this__parameters.put(__this__parameters_copy_key, __this__parameters_copy_value);
       }
@@ -356,7 +356,7 @@ public String getLocation() {
   }
 
   public void setLocation(String location) {
-    this.location = location;
+    this.location = org.apache.hive.common.util.HiveStringUtils.intern(location);
   }
 
   public void unsetLocation() {
@@ -379,7 +379,7 @@ public String getInputFormat() {
   }
 
   public void setInputFormat(String inputFormat) {
-    this.inputFormat = inputFormat;
+    this.inputFormat = org.apache.hive.common.util.HiveStringUtils.intern(inputFormat);
   }
 
   public void unsetInputFormat() {
@@ -402,7 +402,7 @@ public String getOutputFormat() {
   }
 
   public void setOutputFormat(String outputFormat) {
-    this.outputFormat = outputFormat;
+    this.outputFormat = org.apache.hive.common.util.HiveStringUtils.intern(outputFormat);
   }
 
   public void unsetOutputFormat() {
@@ -507,7 +507,7 @@ public List<String> getBucketCols() {
   }
 
   public void setBucketCols(List<String> bucketCols) {
-    this.bucketCols = bucketCols;
+    this.bucketCols = org.apache.hive.common.util.HiveStringUtils.intern(bucketCols);
   }
 
   public void unsetBucketCols() {
@@ -579,7 +579,7 @@ public Map<String,String> getParameters() {
   }
 
   public void setParameters(Map<String,String> parameters) {
-    this.parameters = parameters;
+    this.parameters = org.apache.hive.common.util.HiveStringUtils.intern(parameters);
   }
 
   public void unsetParameters() {
diff --git a/ql/if/queryplan.thrift b/ql/if/queryplan.thrift
index 6026d94141..f2a405e369 100644
--- a/ql/if/queryplan.thrift
+++ b/ql/if/queryplan.thrift
@@ -57,6 +57,8 @@ enum OperatorType {
   MUX,
   DEMUX,
   EVENT,
+  ORCFILEMERGE,
+  RCFILEMERGE,
 }
 
 struct Operator {
diff --git a/ql/src/gen/thrift/gen-cpp/queryplan_types.cpp b/ql/src/gen/thrift/gen-cpp/queryplan_types.cpp
index b9e04e2a67..04a0d67365 100644
--- a/ql/src/gen/thrift/gen-cpp/queryplan_types.cpp
+++ b/ql/src/gen/thrift/gen-cpp/queryplan_types.cpp
@@ -52,7 +52,9 @@ int _kOperatorTypeValues[] = {
   OperatorType::PTF,
   OperatorType::MUX,
   OperatorType::DEMUX,
-  OperatorType::EVENT
+  OperatorType::EVENT,
+  OperatorType::ORCFILEMERGE,
+  OperatorType::RCFILEMERGE
 };
 const char* _kOperatorTypeNames[] = {
   "JOIN",
@@ -76,9 +78,11 @@ const char* _kOperatorTypeNames[] = {
   "PTF",
   "MUX",
   "DEMUX",
-  "EVENT"
+  "EVENT",
+  "ORCFILEMERGE",
+  "RCFILEMERGE"
 };
-const std::map<int, const char*> _OperatorType_VALUES_TO_NAMES(::apache::thrift::TEnumIterator(22, _kOperatorTypeValues, _kOperatorTypeNames), ::apache::thrift::TEnumIterator(-1, NULL, NULL));
+const std::map<int, const char*> _OperatorType_VALUES_TO_NAMES(::apache::thrift::TEnumIterator(24, _kOperatorTypeValues, _kOperatorTypeNames), ::apache::thrift::TEnumIterator(-1, NULL, NULL));
 
 int _kTaskTypeValues[] = {
   TaskType::MAP,
diff --git a/ql/src/gen/thrift/gen-cpp/queryplan_types.h b/ql/src/gen/thrift/gen-cpp/queryplan_types.h
index 30ef71135d..d7797c6639 100644
--- a/ql/src/gen/thrift/gen-cpp/queryplan_types.h
+++ b/ql/src/gen/thrift/gen-cpp/queryplan_types.h
@@ -57,7 +57,9 @@ struct OperatorType {
     PTF = 18,
     MUX = 19,
     DEMUX = 20,
-    EVENT = 21
+    EVENT = 21,
+    ORCFILEMERGE = 22,
+    RCFILEMERGE = 23
   };
 };
 
diff --git a/ql/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/ql/plan/api/OperatorType.java b/ql/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/ql/plan/api/OperatorType.java
index 4e735f7570..e5c4c44d48 100644
--- a/ql/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/ql/plan/api/OperatorType.java
+++ b/ql/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/ql/plan/api/OperatorType.java
@@ -7,6 +7,10 @@
 package org.apache.hadoop.hive.ql.plan.api;
 
 
+import java.util.Map;
+import java.util.HashMap;
+import org.apache.thrift.TEnum;
+
 public enum OperatorType implements org.apache.thrift.TEnum {
   JOIN(0),
   MAPJOIN(1),
diff --git a/ql/src/gen/thrift/gen-php/Types.php b/ql/src/gen/thrift/gen-php/Types.php
index 4ed7fcc24d..e6f87d3d94 100644
--- a/ql/src/gen/thrift/gen-php/Types.php
+++ b/ql/src/gen/thrift/gen-php/Types.php
@@ -57,6 +57,8 @@ final class OperatorType {
   const MUX = 19;
   const DEMUX = 20;
   const EVENT = 21;
+  const ORCFILEMERGE = 22;
+  const RCFILEMERGE = 23;
   static public $__names = array(
     0 => 'JOIN',
     1 => 'MAPJOIN',
@@ -80,6 +82,8 @@ final class OperatorType {
     19 => 'MUX',
     20 => 'DEMUX',
     21 => 'EVENT',
+    22 => 'ORCFILEMERGE',
+    23 => 'RCFILEMERGE',
   );
 }
 
diff --git a/ql/src/gen/thrift/gen-py/queryplan/ttypes.py b/ql/src/gen/thrift/gen-py/queryplan/ttypes.py
index 96777fa72f..2e26e5862f 100644
--- a/ql/src/gen/thrift/gen-py/queryplan/ttypes.py
+++ b/ql/src/gen/thrift/gen-py/queryplan/ttypes.py
@@ -67,6 +67,8 @@ class OperatorType:
   MUX = 19
   DEMUX = 20
   EVENT = 21
+  ORCFILEMERGE = 22
+  RCFILEMERGE = 23
 
   _VALUES_TO_NAMES = {
     0: "JOIN",
@@ -91,6 +93,8 @@ class OperatorType:
     19: "MUX",
     20: "DEMUX",
     21: "EVENT",
+    22: "ORCFILEMERGE",
+    23: "RCFILEMERGE",
   }
 
   _NAMES_TO_VALUES = {
@@ -116,6 +120,8 @@ class OperatorType:
     "MUX": 19,
     "DEMUX": 20,
     "EVENT": 21,
+    "ORCFILEMERGE": 22,
+    "RCFILEMERGE": 23,
   }
 
 class TaskType:
diff --git a/ql/src/gen/thrift/gen-rb/queryplan_types.rb b/ql/src/gen/thrift/gen-rb/queryplan_types.rb
index 449becf929..e5e98aead9 100644
--- a/ql/src/gen/thrift/gen-rb/queryplan_types.rb
+++ b/ql/src/gen/thrift/gen-rb/queryplan_types.rb
@@ -43,8 +43,10 @@ module OperatorType
   MUX = 19
   DEMUX = 20
   EVENT = 21
-  VALUE_MAP = {0 => "JOIN", 1 => "MAPJOIN", 2 => "EXTRACT", 3 => "FILTER", 4 => "FORWARD", 5 => "GROUPBY", 6 => "LIMIT", 7 => "SCRIPT", 8 => "SELECT", 9 => "TABLESCAN", 10 => "FILESINK", 11 => "REDUCESINK", 12 => "UNION", 13 => "UDTF", 14 => "LATERALVIEWJOIN", 15 => "LATERALVIEWFORWARD", 16 => "HASHTABLESINK", 17 => "HASHTABLEDUMMY", 18 => "PTF", 19 => "MUX", 20 => "DEMUX", 21 => "EVENT"}
-  VALID_VALUES = Set.new([JOIN, MAPJOIN, EXTRACT, FILTER, FORWARD, GROUPBY, LIMIT, SCRIPT, SELECT, TABLESCAN, FILESINK, REDUCESINK, UNION, UDTF, LATERALVIEWJOIN, LATERALVIEWFORWARD, HASHTABLESINK, HASHTABLEDUMMY, PTF, MUX, DEMUX, EVENT]).freeze
+  ORCFILEMERGE = 22
+  RCFILEMERGE = 23
+  VALUE_MAP = {0 => "JOIN", 1 => "MAPJOIN", 2 => "EXTRACT", 3 => "FILTER", 4 => "FORWARD", 5 => "GROUPBY", 6 => "LIMIT", 7 => "SCRIPT", 8 => "SELECT", 9 => "TABLESCAN", 10 => "FILESINK", 11 => "REDUCESINK", 12 => "UNION", 13 => "UDTF", 14 => "LATERALVIEWJOIN", 15 => "LATERALVIEWFORWARD", 16 => "HASHTABLESINK", 17 => "HASHTABLEDUMMY", 18 => "PTF", 19 => "MUX", 20 => "DEMUX", 21 => "EVENT", 22 => "ORCFILEMERGE", 23 => "RCFILEMERGE"}
+  VALID_VALUES = Set.new([JOIN, MAPJOIN, EXTRACT, FILTER, FORWARD, GROUPBY, LIMIT, SCRIPT, SELECT, TABLESCAN, FILESINK, REDUCESINK, UNION, UDTF, LATERALVIEWJOIN, LATERALVIEWFORWARD, HASHTABLESINK, HASHTABLEDUMMY, PTF, MUX, DEMUX, EVENT, ORCFILEMERGE, RCFILEMERGE]).freeze
 end
 
 module TaskType
diff --git a/serde/src/gen/thrift/gen-cpp/complex_types.cpp b/serde/src/gen/thrift/gen-cpp/complex_types.cpp
index f0ede2cbcb..411e1b0a1c 100644
--- a/serde/src/gen/thrift/gen-cpp/complex_types.cpp
+++ b/serde/src/gen/thrift/gen-cpp/complex_types.cpp
@@ -622,4 +622,100 @@ void swap(Complex &a, Complex &b) {
   swap(a.__isset, b.__isset);
 }
 
+const char* SetIntString::ascii_fingerprint = "842B41C940D05DFB16183142A90DFC54";
+const uint8_t SetIntString::binary_fingerprint[16] = {0x84,0x2B,0x41,0xC9,0x40,0xD0,0x5D,0xFB,0x16,0x18,0x31,0x42,0xA9,0x0D,0xFC,0x54};
+
+uint32_t SetIntString::read(::apache::thrift::protocol::TProtocol* iprot) {
+
+  uint32_t xfer = 0;
+  std::string fname;
+  ::apache::thrift::protocol::TType ftype;
+  int16_t fid;
+
+  xfer += iprot->readStructBegin(fname);
+
+  using ::apache::thrift::protocol::TProtocolException;
+
+
+  while (true)
+  {
+    xfer += iprot->readFieldBegin(fname, ftype, fid);
+    if (ftype == ::apache::thrift::protocol::T_STOP) {
+      break;
+    }
+    switch (fid)
+    {
+      case 1:
+        if (ftype == ::apache::thrift::protocol::T_SET) {
+          {
+            this->sIntString.clear();
+            uint32_t _size64;
+            ::apache::thrift::protocol::TType _etype67;
+            xfer += iprot->readSetBegin(_etype67, _size64);
+            uint32_t _i68;
+            for (_i68 = 0; _i68 < _size64; ++_i68)
+            {
+              IntString _elem69;
+              xfer += _elem69.read(iprot);
+              this->sIntString.insert(_elem69);
+            }
+            xfer += iprot->readSetEnd();
+          }
+          this->__isset.sIntString = true;
+        } else {
+          xfer += iprot->skip(ftype);
+        }
+        break;
+      case 2:
+        if (ftype == ::apache::thrift::protocol::T_STRING) {
+          xfer += iprot->readString(this->aString);
+          this->__isset.aString = true;
+        } else {
+          xfer += iprot->skip(ftype);
+        }
+        break;
+      default:
+        xfer += iprot->skip(ftype);
+        break;
+    }
+    xfer += iprot->readFieldEnd();
+  }
+
+  xfer += iprot->readStructEnd();
+
+  return xfer;
+}
+
+uint32_t SetIntString::write(::apache::thrift::protocol::TProtocol* oprot) const {
+  uint32_t xfer = 0;
+  xfer += oprot->writeStructBegin("SetIntString");
+
+  xfer += oprot->writeFieldBegin("sIntString", ::apache::thrift::protocol::T_SET, 1);
+  {
+    xfer += oprot->writeSetBegin(::apache::thrift::protocol::T_STRUCT, static_cast<uint32_t>(this->sIntString.size()));
+    std::set<IntString> ::const_iterator _iter70;
+    for (_iter70 = this->sIntString.begin(); _iter70 != this->sIntString.end(); ++_iter70)
+    {
+      xfer += (*_iter70).write(oprot);
+    }
+    xfer += oprot->writeSetEnd();
+  }
+  xfer += oprot->writeFieldEnd();
+
+  xfer += oprot->writeFieldBegin("aString", ::apache::thrift::protocol::T_STRING, 2);
+  xfer += oprot->writeString(this->aString);
+  xfer += oprot->writeFieldEnd();
+
+  xfer += oprot->writeFieldStop();
+  xfer += oprot->writeStructEnd();
+  return xfer;
+}
+
+void swap(SetIntString &a, SetIntString &b) {
+  using ::std::swap;
+  swap(a.sIntString, b.sIntString);
+  swap(a.aString, b.aString);
+  swap(a.__isset, b.__isset);
+}
+
 
diff --git a/serde/src/gen/thrift/gen-cpp/complex_types.h b/serde/src/gen/thrift/gen-cpp/complex_types.h
index de9f5f99f5..3f4c76033c 100644
--- a/serde/src/gen/thrift/gen-cpp/complex_types.h
+++ b/serde/src/gen/thrift/gen-cpp/complex_types.h
@@ -296,6 +296,57 @@ class Complex {
 
 void swap(Complex &a, Complex &b);
 
+typedef struct _SetIntString__isset {
+  _SetIntString__isset() : sIntString(false), aString(false) {}
+  bool sIntString;
+  bool aString;
+} _SetIntString__isset;
+
+class SetIntString {
+ public:
+
+  static const char* ascii_fingerprint; // = "842B41C940D05DFB16183142A90DFC54";
+  static const uint8_t binary_fingerprint[16]; // = {0x84,0x2B,0x41,0xC9,0x40,0xD0,0x5D,0xFB,0x16,0x18,0x31,0x42,0xA9,0x0D,0xFC,0x54};
+
+  SetIntString() : aString() {
+  }
+
+  virtual ~SetIntString() throw() {}
+
+  std::set<IntString>  sIntString;
+  std::string aString;
+
+  _SetIntString__isset __isset;
+
+  void __set_sIntString(const std::set<IntString> & val) {
+    sIntString = val;
+  }
+
+  void __set_aString(const std::string& val) {
+    aString = val;
+  }
+
+  bool operator == (const SetIntString & rhs) const
+  {
+    if (!(sIntString == rhs.sIntString))
+      return false;
+    if (!(aString == rhs.aString))
+      return false;
+    return true;
+  }
+  bool operator != (const SetIntString &rhs) const {
+    return !(*this == rhs);
+  }
+
+  bool operator < (const SetIntString & ) const;
+
+  uint32_t read(::apache::thrift::protocol::TProtocol* iprot);
+  uint32_t write(::apache::thrift::protocol::TProtocol* oprot) const;
+
+};
+
+void swap(SetIntString &a, SetIntString &b);
+
 
 
 #endif
diff --git a/serde/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/serde/serdeConstants.java b/serde/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/serde/serdeConstants.java
index 5e089aac36..8d3595bff0 100644
--- a/serde/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/serde/serdeConstants.java
+++ b/serde/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/serde/serdeConstants.java
@@ -37,8 +37,6 @@ public class serdeConstants {
 
   public static final String SERIALIZATION_CLASS = "serialization.class";
 
-  public static final String SERIALIZATION_TYPE = "serialization.type";
-
   public static final String SERIALIZATION_FORMAT = "serialization.format";
 
   public static final String SERIALIZATION_DDL = "serialization.ddl";
diff --git a/serde/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/serde2/thrift/test/Complex.java b/serde/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/serde2/thrift/test/Complex.java
index 41df559da1..07ea8b9dfb 100644
--- a/serde/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/serde2/thrift/test/Complex.java
+++ b/serde/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/serde2/thrift/test/Complex.java
@@ -1267,7 +1267,7 @@ public void read(org.apache.thrift.protocol.TProtocol iprot, Complex struct) thr
                 for (int _i28 = 0; _i28 < _map27.size; ++_i28)
                 {
                   String _key29; // required
-                  String _val30; // optional
+                  String _val30; // required
                   _key29 = iprot.readString();
                   _val30 = iprot.readString();
                   struct.mStringString.put(_key29, _val30);
@@ -1287,7 +1287,7 @@ public void read(org.apache.thrift.protocol.TProtocol iprot, Complex struct) thr
                 for (int _i32 = 0; _i32 < _map31.size; ++_i32)
                 {
                   String _key33; // required
-                  Map<String,Map<String,PropValueUnion>> _val34; // optional
+                  Map<String,Map<String,PropValueUnion>> _val34; // required
                   _key33 = iprot.readString();
                   {
                     org.apache.thrift.protocol.TMap _map35 = iprot.readMapBegin();
@@ -1295,7 +1295,7 @@ public void read(org.apache.thrift.protocol.TProtocol iprot, Complex struct) thr
                     for (int _i36 = 0; _i36 < _map35.size; ++_i36)
                     {
                       String _key37; // required
-                      Map<String,PropValueUnion> _val38; // optional
+                      Map<String,PropValueUnion> _val38; // required
                       _key37 = iprot.readString();
                       {
                         org.apache.thrift.protocol.TMap _map39 = iprot.readMapBegin();
@@ -1303,7 +1303,7 @@ public void read(org.apache.thrift.protocol.TProtocol iprot, Complex struct) thr
                         for (int _i40 = 0; _i40 < _map39.size; ++_i40)
                         {
                           String _key41; // required
-                          PropValueUnion _val42; // optional
+                          PropValueUnion _val42; // required
                           _key41 = iprot.readString();
                           _val42 = new PropValueUnion();
                           _val42.read(iprot);
@@ -1651,7 +1651,7 @@ public void read(org.apache.thrift.protocol.TProtocol prot, Complex struct) thro
           for (int _i67 = 0; _i67 < _map66.size; ++_i67)
           {
             String _key68; // required
-            String _val69; // optional
+            String _val69; // required
             _key68 = iprot.readString();
             _val69 = iprot.readString();
             struct.mStringString.put(_key68, _val69);
@@ -1666,7 +1666,7 @@ public void read(org.apache.thrift.protocol.TProtocol prot, Complex struct) thro
           for (int _i71 = 0; _i71 < _map70.size; ++_i71)
           {
             String _key72; // required
-            Map<String,Map<String,PropValueUnion>> _val73; // optional
+            Map<String,Map<String,PropValueUnion>> _val73; // required
             _key72 = iprot.readString();
             {
               org.apache.thrift.protocol.TMap _map74 = new org.apache.thrift.protocol.TMap(org.apache.thrift.protocol.TType.STRING, org.apache.thrift.protocol.TType.MAP, iprot.readI32());
@@ -1674,7 +1674,7 @@ public void read(org.apache.thrift.protocol.TProtocol prot, Complex struct) thro
               for (int _i75 = 0; _i75 < _map74.size; ++_i75)
               {
                 String _key76; // required
-                Map<String,PropValueUnion> _val77; // optional
+                Map<String,PropValueUnion> _val77; // required
                 _key76 = iprot.readString();
                 {
                   org.apache.thrift.protocol.TMap _map78 = new org.apache.thrift.protocol.TMap(org.apache.thrift.protocol.TType.STRING, org.apache.thrift.protocol.TType.STRUCT, iprot.readI32());
@@ -1682,7 +1682,7 @@ public void read(org.apache.thrift.protocol.TProtocol prot, Complex struct) thro
                   for (int _i79 = 0; _i79 < _map78.size; ++_i79)
                   {
                     String _key80; // required
-                    PropValueUnion _val81; // optional
+                    PropValueUnion _val81; // required
                     _key80 = iprot.readString();
                     _val81 = new PropValueUnion();
                     _val81.read(iprot);
diff --git a/serde/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/serde2/thrift/test/PropValueUnion.java b/serde/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/serde2/thrift/test/PropValueUnion.java
index 0a5757e5b5..aa56dc91e0 100644
--- a/serde/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/serde2/thrift/test/PropValueUnion.java
+++ b/serde/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/serde2/thrift/test/PropValueUnion.java
@@ -320,7 +320,7 @@ protected Object standardSchemeReadValue(org.apache.thrift.protocol.TProtocol ip
               for (int _i4 = 0; _i4 < _map3.size; ++_i4)
               {
                 String _key5; // required
-                String _val6; // optional
+                String _val6; // required
                 _key5 = iprot.readString();
                 _val6 = iprot.readString();
                 unionMStringString.put(_key5, _val6);
@@ -438,7 +438,7 @@ protected Object tupleSchemeReadValue(org.apache.thrift.protocol.TProtocol iprot
             for (int _i13 = 0; _i13 < _map12.size; ++_i13)
             {
               String _key14; // required
-              String _val15; // optional
+              String _val15; // required
               _key14 = iprot.readString();
               _val15 = iprot.readString();
               unionMStringString.put(_key14, _val15);
diff --git a/serde/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/serde2/thrift/test/SetIntString.java b/serde/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/serde2/thrift/test/SetIntString.java
index 9b00404c53..676f2b2542 100644
--- a/serde/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/serde2/thrift/test/SetIntString.java
+++ b/serde/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/serde2/thrift/test/SetIntString.java
@@ -6,6 +6,7 @@
  */
 package org.apache.hadoop.hive.serde2.thrift.test;
 
+import org.apache.commons.lang.builder.HashCodeBuilder;
 import org.apache.thrift.scheme.IScheme;
 import org.apache.thrift.scheme.SchemeFactory;
 import org.apache.thrift.scheme.StandardScheme;
@@ -42,8 +43,8 @@ public class SetIntString implements org.apache.thrift.TBase<SetIntString, SetIn
     schemes.put(TupleScheme.class, new SetIntStringTupleSchemeFactory());
   }
 
-  public Set<IntString> sIntString; // required
-  public String aString; // required
+  private Set<IntString> sIntString; // required
+  private String aString; // required
 
   /** The set of fields this struct contains, along with convenience methods for finding and manipulating them. */
   public enum _Fields implements org.apache.thrift.TFieldIdEnum {
@@ -176,9 +177,8 @@ public Set<IntString> getSIntString() {
     return this.sIntString;
   }
 
-  public SetIntString setSIntString(Set<IntString> sIntString) {
+  public void setSIntString(Set<IntString> sIntString) {
     this.sIntString = sIntString;
-    return this;
   }
 
   public void unsetSIntString() {
@@ -200,9 +200,8 @@ public String getAString() {
     return this.aString;
   }
 
-  public SetIntString setAString(String aString) {
+  public void setAString(String aString) {
     this.aString = aString;
-    return this;
   }
 
   public void unsetAString() {
@@ -304,7 +303,19 @@ public boolean equals(SetIntString that) {
 
   @Override
   public int hashCode() {
-    return 0;
+    HashCodeBuilder builder = new HashCodeBuilder();
+
+    boolean present_sIntString = true && (isSetSIntString());
+    builder.append(present_sIntString);
+    if (present_sIntString)
+      builder.append(sIntString);
+
+    boolean present_aString = true && (isSetAString());
+    builder.append(present_aString);
+    if (present_aString)
+      builder.append(aString);
+
+    return builder.toHashCode();
   }
 
   public int compareTo(SetIntString other) {
@@ -416,14 +427,14 @@ public void read(org.apache.thrift.protocol.TProtocol iprot, SetIntString struct
           case 1: // S_INT_STRING
             if (schemeField.type == org.apache.thrift.protocol.TType.SET) {
               {
-                org.apache.thrift.protocol.TSet _set34 = iprot.readSetBegin();
-                struct.sIntString = new HashSet<IntString>(2*_set34.size);
-                for (int _i35 = 0; _i35 < _set34.size; ++_i35)
+                org.apache.thrift.protocol.TSet _set82 = iprot.readSetBegin();
+                struct.sIntString = new HashSet<IntString>(2*_set82.size);
+                for (int _i83 = 0; _i83 < _set82.size; ++_i83)
                 {
-                  IntString _elem36; // required
-                  _elem36 = new IntString();
-                  _elem36.read(iprot);
-                  struct.sIntString.add(_elem36);
+                  IntString _elem84; // required
+                  _elem84 = new IntString();
+                  _elem84.read(iprot);
+                  struct.sIntString.add(_elem84);
                 }
                 iprot.readSetEnd();
               }
@@ -446,8 +457,6 @@ public void read(org.apache.thrift.protocol.TProtocol iprot, SetIntString struct
         iprot.readFieldEnd();
       }
       iprot.readStructEnd();
-
-      // check for required fields of primitive type, which can't be checked in the validate method
       struct.validate();
     }
 
@@ -459,9 +468,9 @@ public void write(org.apache.thrift.protocol.TProtocol oprot, SetIntString struc
         oprot.writeFieldBegin(S_INT_STRING_FIELD_DESC);
         {
           oprot.writeSetBegin(new org.apache.thrift.protocol.TSet(org.apache.thrift.protocol.TType.STRUCT, struct.sIntString.size()));
-          for (IntString _iter37 : struct.sIntString)
+          for (IntString _iter85 : struct.sIntString)
           {
-            _iter37.write(oprot);
+            _iter85.write(oprot);
           }
           oprot.writeSetEnd();
         }
@@ -500,9 +509,9 @@ public void write(org.apache.thrift.protocol.TProtocol prot, SetIntString struct
       if (struct.isSetSIntString()) {
         {
           oprot.writeI32(struct.sIntString.size());
-          for (IntString _iter38 : struct.sIntString)
+          for (IntString _iter86 : struct.sIntString)
           {
-            _iter38.write(oprot);
+            _iter86.write(oprot);
           }
         }
       }
@@ -517,14 +526,14 @@ public void read(org.apache.thrift.protocol.TProtocol prot, SetIntString struct)
       BitSet incoming = iprot.readBitSet(2);
       if (incoming.get(0)) {
         {
-          org.apache.thrift.protocol.TSet _set39 = new org.apache.thrift.protocol.TSet(org.apache.thrift.protocol.TType.STRUCT, iprot.readI32());
-          struct.sIntString = new HashSet<IntString>(2*_set39.size);
-          for (int _i40 = 0; _i40 < _set39.size; ++_i40)
+          org.apache.thrift.protocol.TSet _set87 = new org.apache.thrift.protocol.TSet(org.apache.thrift.protocol.TType.STRUCT, iprot.readI32());
+          struct.sIntString = new HashSet<IntString>(2*_set87.size);
+          for (int _i88 = 0; _i88 < _set87.size; ++_i88)
           {
-            IntString _elem41; // required
-            _elem41 = new IntString();
-            _elem41.read(iprot);
-            struct.sIntString.add(_elem41);
+            IntString _elem89; // required
+            _elem89 = new IntString();
+            _elem89.read(iprot);
+            struct.sIntString.add(_elem89);
           }
         }
         struct.setSIntStringIsSet(true);
diff --git a/serde/src/gen/thrift/gen-py/complex/ttypes.py b/serde/src/gen/thrift/gen-py/complex/ttypes.py
index 3bc7a6ffd0..c2748d0fd9 100644
--- a/serde/src/gen/thrift/gen-py/complex/ttypes.py
+++ b/serde/src/gen/thrift/gen-py/complex/ttypes.py
@@ -477,6 +477,87 @@ def validate(self):
     return
 
 
+  def __repr__(self):
+    L = ['%s=%r' % (key, value)
+      for key, value in self.__dict__.iteritems()]
+    return '%s(%s)' % (self.__class__.__name__, ', '.join(L))
+
+  def __eq__(self, other):
+    return isinstance(other, self.__class__) and self.__dict__ == other.__dict__
+
+  def __ne__(self, other):
+    return not (self == other)
+
+class SetIntString:
+  """
+  Attributes:
+   - sIntString
+   - aString
+  """
+
+  thrift_spec = (
+    None, # 0
+    (1, TType.SET, 'sIntString', (TType.STRUCT,(IntString, IntString.thrift_spec)), None, ), # 1
+    (2, TType.STRING, 'aString', None, None, ), # 2
+  )
+
+  def __init__(self, sIntString=None, aString=None,):
+    self.sIntString = sIntString
+    self.aString = aString
+
+  def read(self, iprot):
+    if iprot.__class__ == TBinaryProtocol.TBinaryProtocolAccelerated and isinstance(iprot.trans, TTransport.CReadableTransport) and self.thrift_spec is not None and fastbinary is not None:
+      fastbinary.decode_binary(self, iprot.trans, (self.__class__, self.thrift_spec))
+      return
+    iprot.readStructBegin()
+    while True:
+      (fname, ftype, fid) = iprot.readFieldBegin()
+      if ftype == TType.STOP:
+        break
+      if fid == 1:
+        if ftype == TType.SET:
+          self.sIntString = set()
+          (_etype76, _size73) = iprot.readSetBegin()
+          for _i77 in xrange(_size73):
+            _elem78 = IntString()
+            _elem78.read(iprot)
+            self.sIntString.add(_elem78)
+          iprot.readSetEnd()
+        else:
+          iprot.skip(ftype)
+      elif fid == 2:
+        if ftype == TType.STRING:
+          self.aString = iprot.readString();
+        else:
+          iprot.skip(ftype)
+      else:
+        iprot.skip(ftype)
+      iprot.readFieldEnd()
+    iprot.readStructEnd()
+
+  def write(self, oprot):
+    if oprot.__class__ == TBinaryProtocol.TBinaryProtocolAccelerated and self.thrift_spec is not None and fastbinary is not None:
+      oprot.trans.write(fastbinary.encode_binary(self, (self.__class__, self.thrift_spec)))
+      return
+    oprot.writeStructBegin('SetIntString')
+    if self.sIntString is not None:
+      oprot.writeFieldBegin('sIntString', TType.SET, 1)
+      oprot.writeSetBegin(TType.STRUCT, len(self.sIntString))
+      for iter79 in self.sIntString:
+        iter79.write(oprot)
+      oprot.writeSetEnd()
+      oprot.writeFieldEnd()
+    if self.aString is not None:
+      oprot.writeFieldBegin('aString', TType.STRING, 2)
+      oprot.writeString(self.aString)
+      oprot.writeFieldEnd()
+    oprot.writeFieldStop()
+    oprot.writeStructEnd()
+
+  def validate(self):
+    return
+
+
   def __repr__(self):
     L = ['%s=%r' % (key, value)
       for key, value in self.__dict__.iteritems()]
diff --git a/serde/src/gen/thrift/gen-rb/complex_types.rb b/serde/src/gen/thrift/gen-rb/complex_types.rb
index 2c91cbc5fa..ffbd4d7c3a 100644
--- a/serde/src/gen/thrift/gen-rb/complex_types.rb
+++ b/serde/src/gen/thrift/gen-rb/complex_types.rb
@@ -119,3 +119,21 @@ class Complex
   ::Thrift::Struct.generate_accessors self
 end
 
+class SetIntString
+  include ::Thrift::Struct, ::Thrift::Struct_Union
+  SINTSTRING = 1
+  ASTRING = 2
+
+  FIELDS = {
+    SINTSTRING => {:type => ::Thrift::Types::SET, :name => 'sIntString', :element => {:type => ::Thrift::Types::STRUCT, :class => ::IntString}},
+    ASTRING => {:type => ::Thrift::Types::STRING, :name => 'aString'}
+  }
+
+  def struct_fields; FIELDS; end
+
+  def validate
+  end
+
+  ::Thrift::Struct.generate_accessors self
+end
+
