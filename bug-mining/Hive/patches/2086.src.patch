diff --git a/contrib/src/test/results/clientpositive/fileformat_base64.q.out b/contrib/src/test/results/clientpositive/fileformat_base64.q.out
index 8fdea9ac6d..5222bcfd36 100644
--- a/contrib/src/test/results/clientpositive/fileformat_base64.q.out
+++ b/contrib/src/test/results/clientpositive/fileformat_base64.q.out
@@ -37,8 +37,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@base64_test
 PREHOOK: query: DESCRIBE EXTENDED base64_test
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@base64_test
 POSTHOOK: query: DESCRIBE EXTENDED base64_test
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@base64_test
 key                 	int                 	                    
 value               	string              	                    
 	 	 
diff --git a/contrib/src/test/results/clientpositive/serde_s3.q.out b/contrib/src/test/results/clientpositive/serde_s3.q.out
index b8b74f88e7..58e6337418 100644
--- a/contrib/src/test/results/clientpositive/serde_s3.q.out
+++ b/contrib/src/test/results/clientpositive/serde_s3.q.out
@@ -15,8 +15,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@s3log
 PREHOOK: query: DESCRIBE s3log
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@s3log
 POSTHOOK: query: DESCRIBE s3log
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@s3log
 #### A masked pattern was here ####
 bucketname          	string              	from deserializer   
 rdatetime           	string              	from deserializer   
diff --git a/hbase-handler/src/test/results/positive/external_table_ppd.q.out b/hbase-handler/src/test/results/positive/external_table_ppd.q.out
index 200fcf1021..f7c4a50734 100644
--- a/hbase-handler/src/test/results/positive/external_table_ppd.q.out
+++ b/hbase-handler/src/test/results/positive/external_table_ppd.q.out
@@ -33,8 +33,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@t_hbase
 PREHOOK: query: DESCRIBE FORMATTED t_hbase
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@t_hbase
 POSTHOOK: query: DESCRIBE FORMATTED t_hbase
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@t_hbase
 # col_name            	data_type           	comment             
 	 	 
 key                 	string              	from deserializer   
diff --git a/hbase-handler/src/test/results/positive/hbase_binary_storage_queries.q.out b/hbase-handler/src/test/results/positive/hbase_binary_storage_queries.q.out
index e42b52a7ab..b92db111d5 100644
--- a/hbase-handler/src/test/results/positive/hbase_binary_storage_queries.q.out
+++ b/hbase-handler/src/test/results/positive/hbase_binary_storage_queries.q.out
@@ -33,8 +33,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@t_hbase
 PREHOOK: query: DESCRIBE FORMATTED t_hbase
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@t_hbase
 POSTHOOK: query: DESCRIBE FORMATTED t_hbase
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@t_hbase
 # col_name            	data_type           	comment             
 	 	 
 key                 	string              	from deserializer   
@@ -206,8 +208,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@t_hbase_1
 PREHOOK: query: DESCRIBE FORMATTED t_hbase_1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@t_hbase_1
 POSTHOOK: query: DESCRIBE FORMATTED t_hbase_1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@t_hbase_1
 # col_name            	data_type           	comment             
 	 	 
 key                 	string              	from deserializer   
diff --git a/hbase-handler/src/test/results/positive/hbase_queries.q.out b/hbase-handler/src/test/results/positive/hbase_queries.q.out
index 77569b7b38..e59c44d8ff 100644
--- a/hbase-handler/src/test/results/positive/hbase_queries.q.out
+++ b/hbase-handler/src/test/results/positive/hbase_queries.q.out
@@ -17,8 +17,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@hbase_table_1
 PREHOOK: query: DESCRIBE EXTENDED hbase_table_1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@hbase_table_1
 POSTHOOK: query: DESCRIBE EXTENDED hbase_table_1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@hbase_table_1
 key                 	int                 	from deserializer   
 value               	string              	from deserializer   
 	 	 
diff --git a/hbase-handler/src/test/results/positive/hbase_stats.q.out b/hbase-handler/src/test/results/positive/hbase_stats.q.out
index 0136d7968e..f978944461 100644
--- a/hbase-handler/src/test/results/positive/hbase_stats.q.out
+++ b/hbase-handler/src/test/results/positive/hbase_stats.q.out
@@ -27,8 +27,10 @@ POSTHOOK: Lineage: stats_src.key SIMPLE [(src)src.FieldSchema(name:key, type:str
 POSTHOOK: Lineage: stats_src.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: desc formatted stats_src
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@stats_src
 POSTHOOK: query: desc formatted stats_src
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@stats_src
 POSTHOOK: Lineage: stats_src.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_src.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 # col_name            	data_type           	comment             
@@ -150,8 +152,10 @@ POSTHOOK: Lineage: stats_src.key SIMPLE [(src)src.FieldSchema(name:key, type:str
 POSTHOOK: Lineage: stats_src.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: desc formatted stats_part
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@stats_part
 POSTHOOK: query: desc formatted stats_part
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@stats_part
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=11).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=11).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=12).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -193,8 +197,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: desc formatted stats_part partition (ds='2010-04-08', hr = '11')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@stats_part
 POSTHOOK: query: desc formatted stats_part partition (ds='2010-04-08', hr = '11')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@stats_part
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=11).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=11).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=12).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -241,8 +247,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: desc formatted stats_part partition (ds='2010-04-08', hr = '12')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@stats_part
 POSTHOOK: query: desc formatted stats_part partition (ds='2010-04-08', hr = '12')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@stats_part
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=11).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=11).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=12).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -317,8 +325,10 @@ POSTHOOK: Lineage: stats_src.key SIMPLE [(src)src.FieldSchema(name:key, type:str
 POSTHOOK: Lineage: stats_src.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: desc formatted stats_part
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@stats_part
 POSTHOOK: query: desc formatted stats_part
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@stats_part
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=11).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=11).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=12).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/hbase-handler/src/test/results/positive/hbase_stats2.q.out b/hbase-handler/src/test/results/positive/hbase_stats2.q.out
index 0136d7968e..f978944461 100644
--- a/hbase-handler/src/test/results/positive/hbase_stats2.q.out
+++ b/hbase-handler/src/test/results/positive/hbase_stats2.q.out
@@ -27,8 +27,10 @@ POSTHOOK: Lineage: stats_src.key SIMPLE [(src)src.FieldSchema(name:key, type:str
 POSTHOOK: Lineage: stats_src.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: desc formatted stats_src
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@stats_src
 POSTHOOK: query: desc formatted stats_src
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@stats_src
 POSTHOOK: Lineage: stats_src.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_src.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 # col_name            	data_type           	comment             
@@ -150,8 +152,10 @@ POSTHOOK: Lineage: stats_src.key SIMPLE [(src)src.FieldSchema(name:key, type:str
 POSTHOOK: Lineage: stats_src.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: desc formatted stats_part
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@stats_part
 POSTHOOK: query: desc formatted stats_part
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@stats_part
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=11).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=11).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=12).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -193,8 +197,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: desc formatted stats_part partition (ds='2010-04-08', hr = '11')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@stats_part
 POSTHOOK: query: desc formatted stats_part partition (ds='2010-04-08', hr = '11')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@stats_part
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=11).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=11).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=12).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -241,8 +247,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: desc formatted stats_part partition (ds='2010-04-08', hr = '12')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@stats_part
 POSTHOOK: query: desc formatted stats_part partition (ds='2010-04-08', hr = '12')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@stats_part
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=11).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=11).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=12).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -317,8 +325,10 @@ POSTHOOK: Lineage: stats_src.key SIMPLE [(src)src.FieldSchema(name:key, type:str
 POSTHOOK: Lineage: stats_src.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: desc formatted stats_part
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@stats_part
 POSTHOOK: query: desc formatted stats_part
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@stats_part
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=11).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=11).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=12).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/hbase-handler/src/test/results/positive/hbase_stats3.q.out b/hbase-handler/src/test/results/positive/hbase_stats3.q.out
index 69f515f98a..633384785d 100644
--- a/hbase-handler/src/test/results/positive/hbase_stats3.q.out
+++ b/hbase-handler/src/test/results/positive/hbase_stats3.q.out
@@ -19,8 +19,10 @@ POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).key SIMPLE [(src)sr
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: desc formatted stats_part partition (ds='2010-04-08', hr = '13')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@stats_part
 POSTHOOK: query: desc formatted stats_part partition (ds='2010-04-08', hr = '13')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@stats_part
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 # col_name            	data_type           	comment             
@@ -75,8 +77,10 @@ POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).key SIMPLE [(src)sr
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: desc formatted stats_part partition (ds='2010-04-08', hr = '13')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@stats_part
 POSTHOOK: query: desc formatted stats_part partition (ds='2010-04-08', hr = '13')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@stats_part
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -135,8 +139,10 @@ POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).key SIMPLE [(src)sr
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: desc formatted stats_part partition (ds='2010-04-08', hr = '13')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@stats_part
 POSTHOOK: query: desc formatted stats_part partition (ds='2010-04-08', hr = '13')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@stats_part
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -203,8 +209,10 @@ POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).key SIMPLE [(src)sr
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: desc formatted stats_part partition (ds='2010-04-08', hr = '13')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@stats_part
 POSTHOOK: query: desc formatted stats_part partition (ds='2010-04-08', hr = '13')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@stats_part
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -271,8 +279,10 @@ POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).key SIMPLE [(src)sr
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: desc formatted stats_part partition (ds='2010-04-08', hr = '13')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@stats_part
 POSTHOOK: query: desc formatted stats_part partition (ds='2010-04-08', hr = '13')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@stats_part
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -343,8 +353,10 @@ POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).key SIMPLE [(src)sr
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: desc formatted stats_part partition (ds='2010-04-08', hr = '13')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@stats_part
 POSTHOOK: query: desc formatted stats_part partition (ds='2010-04-08', hr = '13')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@stats_part
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/hbase-handler/src/test/results/positive/hbase_stats_empty_partition.q.out b/hbase-handler/src/test/results/positive/hbase_stats_empty_partition.q.out
index 92eb35cf7a..e4ff708efa 100644
--- a/hbase-handler/src/test/results/positive/hbase_stats_empty_partition.q.out
+++ b/hbase-handler/src/test/results/positive/hbase_stats_empty_partition.q.out
@@ -23,8 +23,10 @@ POSTHOOK: Lineage: tmptable PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(n
 POSTHOOK: Lineage: tmptable PARTITION(part=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: describe formatted tmptable partition (part = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tmptable
 POSTHOOK: query: describe formatted tmptable partition (part = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tmptable
 POSTHOOK: Lineage: tmptable PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: tmptable PARTITION(part=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 # col_name            	data_type           	comment             
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/DDLSemanticAnalyzer.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/DDLSemanticAnalyzer.java
index a73a5e00a1..a40a88d5d9 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/DDLSemanticAnalyzer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/DDLSemanticAnalyzer.java
@@ -1974,6 +1974,8 @@ private void analyzeDescribeTable(ASTNode ast) throws SemanticException {
       descTblDesc.setExt(descOptions == HiveParser.KW_EXTENDED);
       descTblDesc.setPretty(descOptions == HiveParser.KW_PRETTY);
     }
+
+    inputs.add(new ReadEntity(getTable(tableName)));
     rootTasks.add(TaskFactory.get(new DDLWork(getInputs(), getOutputs(),
         descTblDesc), conf));
     setFetchTask(createFetchTask(DescTableDesc.getSchema()));
@@ -2039,6 +2041,7 @@ private void analyzeShowPartitions(ASTNode ast) throws SemanticException {
     validateTable(tableName, null);
 
     showPartsDesc = new ShowPartitionsDesc(tableName, ctx.getResFile(), partSpec);
+    inputs.add(new ReadEntity(getTable(tableName)));
     rootTasks.add(TaskFactory.get(new DDLWork(getInputs(), getOutputs(),
         showPartsDesc), conf));
     setFetchTask(createFetchTask(showPartsDesc.getSchema()));
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/security/authorization/plugin/sqlstd/Operation2Privilege.java b/ql/src/java/org/apache/hadoop/hive/ql/security/authorization/plugin/sqlstd/Operation2Privilege.java
index 2f25df61c9..b0a804ce55 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/security/authorization/plugin/sqlstd/Operation2Privilege.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/security/authorization/plugin/sqlstd/Operation2Privilege.java
@@ -81,6 +81,7 @@ private SQLPrivTypeGrant[] getOutputPrivs() {
 
     op2Priv.put(HiveOperationType.DROPTABLE, new InOutPrivs(OWNER_PRIV_AR, null));
     op2Priv.put(HiveOperationType.DESCTABLE, new InOutPrivs(SEL_NOGRANT_AR, null));
+    op2Priv.put(HiveOperationType.SHOWPARTITIONS, new InOutPrivs(SEL_NOGRANT_AR, null));
     op2Priv.put(HiveOperationType.DESCFUNCTION, new InOutPrivs(null, null));
 
     // meta store check command - require admin priv
@@ -168,7 +169,6 @@ private SQLPrivTypeGrant[] getOutputPrivs() {
 
     op2Priv.put(HiveOperationType.SHOWFUNCTIONS, new InOutPrivs(null, null));
     op2Priv.put(HiveOperationType.SHOWINDEXES, new InOutPrivs(null, null));
-    op2Priv.put(HiveOperationType.SHOWPARTITIONS, new InOutPrivs(null, null));
     op2Priv.put(HiveOperationType.SHOWLOCKS, new InOutPrivs(null, null));
     op2Priv.put(HiveOperationType.CREATEFUNCTION, new InOutPrivs(null, ADMIN_PRIV_AR));
     op2Priv.put(HiveOperationType.DROPFUNCTION, new InOutPrivs(null, ADMIN_PRIV_AR));
@@ -176,7 +176,6 @@ private SQLPrivTypeGrant[] getOutputPrivs() {
     op2Priv.put(HiveOperationType.DROPMACRO, new InOutPrivs(null, ADMIN_PRIV_AR));
     op2Priv.put(HiveOperationType.SHOW_COMPACTIONS, new InOutPrivs(null, null));
     op2Priv.put(HiveOperationType.SHOW_TRANSACTIONS, new InOutPrivs(null, null));
-    op2Priv.put(HiveOperationType.DROPFUNCTION, new InOutPrivs(null, null));
 
     op2Priv.put(HiveOperationType.LOCKTABLE, new InOutPrivs(null, null));
     op2Priv.put(HiveOperationType.UNLOCKTABLE, new InOutPrivs(null, null));
diff --git a/ql/src/test/queries/clientnegative/authorization_desc_table_nosel.q b/ql/src/test/queries/clientnegative/authorization_desc_table_nosel.q
new file mode 100644
index 0000000000..bb62a67425
--- /dev/null
+++ b/ql/src/test/queries/clientnegative/authorization_desc_table_nosel.q
@@ -0,0 +1,14 @@
+set hive.security.authorization.manager=org.apache.hadoop.hive.ql.security.authorization.plugin.sqlstd.SQLStdHiveAuthorizerFactory;
+set hive.security.authenticator.manager=org.apache.hadoop.hive.ql.security.SessionStateConfigUserAuthenticator;
+set hive.security.authorization.enabled=true;
+set user.name=user1;
+
+-- check if alter table fails as different user
+create table t1(i int);
+desc t1;
+
+grant all on table t1 to user user2;
+revoke select on table t1 from user user2;
+
+set user.name=user2;
+desc t1;
diff --git a/ql/src/test/queries/clientnegative/authorization_show_parts_nosel.q b/ql/src/test/queries/clientnegative/authorization_show_parts_nosel.q
new file mode 100644
index 0000000000..e2514cc3ff
--- /dev/null
+++ b/ql/src/test/queries/clientnegative/authorization_show_parts_nosel.q
@@ -0,0 +1,10 @@
+set hive.security.authorization.manager=org.apache.hadoop.hive.ql.security.authorization.plugin.sqlstd.SQLStdHiveAuthorizerFactory;
+set hive.security.authenticator.manager=org.apache.hadoop.hive.ql.security.SessionStateConfigUserAuthenticator;
+set hive.security.authorization.enabled=true;
+set user.name=user1;
+
+-- check if alter table fails as different user
+create table t_show_parts(i int) partitioned by (j string);
+
+set user.name=user2;
+show partitions t_show_parts;
diff --git a/ql/src/test/results/clientnegative/add_partition_with_whitelist.q.out b/ql/src/test/results/clientnegative/add_partition_with_whitelist.q.out
index 920be831e1..2971c41b33 100644
--- a/ql/src/test/results/clientnegative/add_partition_with_whitelist.q.out
+++ b/ql/src/test/results/clientnegative/add_partition_with_whitelist.q.out
@@ -11,8 +11,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@part_whitelist_test
 PREHOOK: query: SHOW PARTITIONS part_whitelist_test
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@part_whitelist_test
 POSTHOOK: query: SHOW PARTITIONS part_whitelist_test
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@part_whitelist_test
 PREHOOK: query: ALTER TABLE part_whitelist_test ADD PARTITION (ds='1,2,3,4')
 PREHOOK: type: ALTERTABLE_ADDPARTS
 PREHOOK: Output: default@part_whitelist_test
diff --git a/ql/src/test/results/clientnegative/addpart1.q.out b/ql/src/test/results/clientnegative/addpart1.q.out
index 25d61da0b8..95f00ef0de 100644
--- a/ql/src/test/results/clientnegative/addpart1.q.out
+++ b/ql/src/test/results/clientnegative/addpart1.q.out
@@ -14,8 +14,10 @@ POSTHOOK: Output: default@addpart1
 POSTHOOK: Output: default@addpart1@b=f/c=s
 PREHOOK: query: show partitions addpart1
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@addpart1
 POSTHOOK: query: show partitions addpart1
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@addpart1
 b=f/c=s
 PREHOOK: query: alter table addpart1 add partition (b='f', c='')
 PREHOOK: type: ALTERTABLE_ADDPARTS
diff --git a/ql/src/test/results/clientnegative/alter_partition_coltype_2columns.q.out b/ql/src/test/results/clientnegative/alter_partition_coltype_2columns.q.out
index 9c0f89753d..47a0cbbab8 100644
--- a/ql/src/test/results/clientnegative/alter_partition_coltype_2columns.q.out
+++ b/ql/src/test/results/clientnegative/alter_partition_coltype_2columns.q.out
@@ -21,8 +21,10 @@ POSTHOOK: Lineage: alter_coltype PARTITION(dt=100x,ts=6:30pm).key SIMPLE [(src1)
 POSTHOOK: Lineage: alter_coltype PARTITION(dt=100x,ts=6:30pm).value SIMPLE [(src1)src1.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: desc alter_coltype
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@alter_coltype
 POSTHOOK: query: desc alter_coltype
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@alter_coltype
 POSTHOOK: Lineage: alter_coltype PARTITION(dt=100x,ts=6:30pm).key SIMPLE [(src1)src1.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: alter_coltype PARTITION(dt=100x,ts=6:30pm).value SIMPLE [(src1)src1.FieldSchema(name:value, type:string, comment:default), ]
 key                 	string              	                    
diff --git a/ql/src/test/results/clientnegative/alter_partition_coltype_invalidcolname.q.out b/ql/src/test/results/clientnegative/alter_partition_coltype_invalidcolname.q.out
index 62798f0516..5578f1ad66 100644
--- a/ql/src/test/results/clientnegative/alter_partition_coltype_invalidcolname.q.out
+++ b/ql/src/test/results/clientnegative/alter_partition_coltype_invalidcolname.q.out
@@ -21,8 +21,10 @@ POSTHOOK: Lineage: alter_coltype PARTITION(dt=100x,ts=6:30pm).key SIMPLE [(src1)
 POSTHOOK: Lineage: alter_coltype PARTITION(dt=100x,ts=6:30pm).value SIMPLE [(src1)src1.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: desc alter_coltype
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@alter_coltype
 POSTHOOK: query: desc alter_coltype
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@alter_coltype
 POSTHOOK: Lineage: alter_coltype PARTITION(dt=100x,ts=6:30pm).key SIMPLE [(src1)src1.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: alter_coltype PARTITION(dt=100x,ts=6:30pm).value SIMPLE [(src1)src1.FieldSchema(name:value, type:string, comment:default), ]
 key                 	string              	                    
diff --git a/ql/src/test/results/clientnegative/alter_partition_coltype_invalidtype.q.out b/ql/src/test/results/clientnegative/alter_partition_coltype_invalidtype.q.out
index b27238f206..63533a5da4 100644
--- a/ql/src/test/results/clientnegative/alter_partition_coltype_invalidtype.q.out
+++ b/ql/src/test/results/clientnegative/alter_partition_coltype_invalidtype.q.out
@@ -21,8 +21,10 @@ POSTHOOK: Lineage: alter_coltype PARTITION(dt=100x,ts=6:30pm).key SIMPLE [(src1)
 POSTHOOK: Lineage: alter_coltype PARTITION(dt=100x,ts=6:30pm).value SIMPLE [(src1)src1.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: desc alter_coltype
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@alter_coltype
 POSTHOOK: query: desc alter_coltype
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@alter_coltype
 POSTHOOK: Lineage: alter_coltype PARTITION(dt=100x,ts=6:30pm).key SIMPLE [(src1)src1.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: alter_coltype PARTITION(dt=100x,ts=6:30pm).value SIMPLE [(src1)src1.FieldSchema(name:value, type:string, comment:default), ]
 key                 	string              	                    
diff --git a/ql/src/test/results/clientnegative/alter_partition_with_whitelist.q.out b/ql/src/test/results/clientnegative/alter_partition_with_whitelist.q.out
index 08b85b6968..abc2dd72dd 100644
--- a/ql/src/test/results/clientnegative/alter_partition_with_whitelist.q.out
+++ b/ql/src/test/results/clientnegative/alter_partition_with_whitelist.q.out
@@ -11,8 +11,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@part_whitelist_test
 PREHOOK: query: SHOW PARTITIONS part_whitelist_test
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@part_whitelist_test
 POSTHOOK: query: SHOW PARTITIONS part_whitelist_test
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@part_whitelist_test
 PREHOOK: query: ALTER TABLE part_whitelist_test ADD PARTITION (ds='1')
 PREHOOK: type: ALTERTABLE_ADDPARTS
 PREHOOK: Output: default@part_whitelist_test
diff --git a/ql/src/test/results/clientnegative/alter_view_as_select_with_partition.q.out b/ql/src/test/results/clientnegative/alter_view_as_select_with_partition.q.out
index 4038961bd0..051fc90fa6 100644
--- a/ql/src/test/results/clientnegative/alter_view_as_select_with_partition.q.out
+++ b/ql/src/test/results/clientnegative/alter_view_as_select_with_partition.q.out
@@ -29,8 +29,10 @@ POSTHOOK: Output: default@testviewpart@value=val_86
 POSTHOOK: Output: default@testviewpart@value=val_xyz
 PREHOOK: query: DESCRIBE FORMATTED testViewPart
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@testviewpart
 POSTHOOK: query: DESCRIBE FORMATTED testViewPart
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@testviewpart
 # col_name            	data_type           	comment             
 	 	 
 key                 	string              	                    
diff --git a/ql/src/test/results/clientnegative/authorization_desc_table_nosel.q.out b/ql/src/test/results/clientnegative/authorization_desc_table_nosel.q.out
new file mode 100644
index 0000000000..be56d343f4
--- /dev/null
+++ b/ql/src/test/results/clientnegative/authorization_desc_table_nosel.q.out
@@ -0,0 +1,29 @@
+PREHOOK: query: -- check if alter table fails as different user
+create table t1(i int)
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+POSTHOOK: query: -- check if alter table fails as different user
+create table t1(i int)
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@t1
+PREHOOK: query: desc t1
+PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@t1
+POSTHOOK: query: desc t1
+POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@t1
+i                   	int                 	                    
+PREHOOK: query: grant all on table t1 to user user2
+PREHOOK: type: GRANT_PRIVILEGE
+PREHOOK: Output: default@t1
+POSTHOOK: query: grant all on table t1 to user user2
+POSTHOOK: type: GRANT_PRIVILEGE
+POSTHOOK: Output: default@t1
+PREHOOK: query: revoke select on table t1 from user user2
+PREHOOK: type: REVOKE_PRIVILEGE
+PREHOOK: Output: default@t1
+POSTHOOK: query: revoke select on table t1 from user user2
+POSTHOOK: type: REVOKE_PRIVILEGE
+POSTHOOK: Output: default@t1
+FAILED: HiveAccessControlException Permission denied. Principal [name=user2, type=USER] does not have following privileges on Object [type=TABLE_OR_VIEW, name=default.t1] : [SELECT]
diff --git a/ql/src/test/results/clientnegative/authorization_show_parts_nosel.q.out b/ql/src/test/results/clientnegative/authorization_show_parts_nosel.q.out
new file mode 100644
index 0000000000..bd502d1524
--- /dev/null
+++ b/ql/src/test/results/clientnegative/authorization_show_parts_nosel.q.out
@@ -0,0 +1,10 @@
+PREHOOK: query: -- check if alter table fails as different user
+create table t_show_parts(i int) partitioned by (j string)
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+POSTHOOK: query: -- check if alter table fails as different user
+create table t_show_parts(i int) partitioned by (j string)
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@t_show_parts
+FAILED: HiveAccessControlException Permission denied. Principal [name=user2, type=USER] does not have following privileges on Object [type=TABLE_OR_VIEW, name=default.t_show_parts] : [SELECT]
diff --git a/ql/src/test/results/clientnegative/desc_failure2.q.out b/ql/src/test/results/clientnegative/desc_failure2.q.out
index 91d3d68712..7e55211002 100644
--- a/ql/src/test/results/clientnegative/desc_failure2.q.out
+++ b/ql/src/test/results/clientnegative/desc_failure2.q.out
@@ -1,7 +1,9 @@
 PREHOOK: query: DESC srcpart
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: DESC srcpart
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@srcpart
 key                 	string              	default             
 value               	string              	default             
 ds                  	string              	                    
diff --git a/ql/src/test/results/clientnegative/describe_xpath1.q.out b/ql/src/test/results/clientnegative/describe_xpath1.q.out
index 6a19140500..d81c96ebdd 100644
--- a/ql/src/test/results/clientnegative/describe_xpath1.q.out
+++ b/ql/src/test/results/clientnegative/describe_xpath1.q.out
@@ -1,3 +1,4 @@
 PREHOOK: query: describe src_thrift.$elem$
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@src_thrift
 FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask. cannot find field $elem$ from [private int org.apache.hadoop.hive.serde2.thrift.test.Complex.aint, private java.lang.String org.apache.hadoop.hive.serde2.thrift.test.Complex.aString, private java.util.List org.apache.hadoop.hive.serde2.thrift.test.Complex.lint, private java.util.List org.apache.hadoop.hive.serde2.thrift.test.Complex.lString, private java.util.List org.apache.hadoop.hive.serde2.thrift.test.Complex.lintString, private java.util.Map org.apache.hadoop.hive.serde2.thrift.test.Complex.mStringString]
diff --git a/ql/src/test/results/clientnegative/describe_xpath2.q.out b/ql/src/test/results/clientnegative/describe_xpath2.q.out
index 92d67b8912..2bd0f06131 100644
--- a/ql/src/test/results/clientnegative/describe_xpath2.q.out
+++ b/ql/src/test/results/clientnegative/describe_xpath2.q.out
@@ -1,3 +1,4 @@
 PREHOOK: query: describe src_thrift.$key$
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@src_thrift
 FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask. cannot find field $key$ from [private int org.apache.hadoop.hive.serde2.thrift.test.Complex.aint, private java.lang.String org.apache.hadoop.hive.serde2.thrift.test.Complex.aString, private java.util.List org.apache.hadoop.hive.serde2.thrift.test.Complex.lint, private java.util.List org.apache.hadoop.hive.serde2.thrift.test.Complex.lString, private java.util.List org.apache.hadoop.hive.serde2.thrift.test.Complex.lintString, private java.util.Map org.apache.hadoop.hive.serde2.thrift.test.Complex.mStringString]
diff --git a/ql/src/test/results/clientnegative/describe_xpath3.q.out b/ql/src/test/results/clientnegative/describe_xpath3.q.out
index 9612971752..fb8c799a2b 100644
--- a/ql/src/test/results/clientnegative/describe_xpath3.q.out
+++ b/ql/src/test/results/clientnegative/describe_xpath3.q.out
@@ -1,3 +1,4 @@
 PREHOOK: query: describe src_thrift.lint.abc
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@src_thrift
 FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask. Error in getting fields from serde.Unknown type for abc
diff --git a/ql/src/test/results/clientnegative/describe_xpath4.q.out b/ql/src/test/results/clientnegative/describe_xpath4.q.out
index 6650cb8e6a..664a4b7752 100644
--- a/ql/src/test/results/clientnegative/describe_xpath4.q.out
+++ b/ql/src/test/results/clientnegative/describe_xpath4.q.out
@@ -1,3 +1,4 @@
 PREHOOK: query: describe src_thrift.mStringString.abc
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@src_thrift
 FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask. Error in getting fields from serde.Unknown type for abc
diff --git a/ql/src/test/results/clientnegative/drop_partition_failure.q.out b/ql/src/test/results/clientnegative/drop_partition_failure.q.out
index b94c6c292c..cde0abb34c 100644
--- a/ql/src/test/results/clientnegative/drop_partition_failure.q.out
+++ b/ql/src/test/results/clientnegative/drop_partition_failure.q.out
@@ -28,8 +28,10 @@ POSTHOOK: Output: default@mp
 POSTHOOK: Output: default@mp@b=2/c=2
 PREHOOK: query: show partitions mp
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@mp
 POSTHOOK: query: show partitions mp
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@mp
 b=1/c=1
 b=1/c=2
 b=2/c=2
diff --git a/ql/src/test/results/clientnegative/drop_partition_filter_failure.q.out b/ql/src/test/results/clientnegative/drop_partition_filter_failure.q.out
index 0ab5e0200a..c4f533bfac 100644
--- a/ql/src/test/results/clientnegative/drop_partition_filter_failure.q.out
+++ b/ql/src/test/results/clientnegative/drop_partition_filter_failure.q.out
@@ -14,7 +14,9 @@ POSTHOOK: Output: default@ptestfilter1
 POSTHOOK: Output: default@ptestfilter1@c=US/d=1
 PREHOOK: query: show partitions ptestfilter1
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@ptestfilter1
 POSTHOOK: query: show partitions ptestfilter1
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@ptestfilter1
 c=US/d=1
 FAILED: SemanticException [Error 10006]: Partition not found ((c = 'US') and (d < '1'))
diff --git a/ql/src/test/results/clientnegative/exchange_partition_neg_incomplete_partition.q.out b/ql/src/test/results/clientnegative/exchange_partition_neg_incomplete_partition.q.out
index 37627cd965..716fb8ad82 100644
--- a/ql/src/test/results/clientnegative/exchange_partition_neg_incomplete_partition.q.out
+++ b/ql/src/test/results/clientnegative/exchange_partition_neg_incomplete_partition.q.out
@@ -14,12 +14,16 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@exchange_part_test2
 PREHOOK: query: SHOW PARTITIONS exchange_part_test1
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@exchange_part_test1
 POSTHOOK: query: SHOW PARTITIONS exchange_part_test1
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@exchange_part_test1
 PREHOOK: query: SHOW PARTITIONS exchange_part_test2
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@exchange_part_test2
 POSTHOOK: query: SHOW PARTITIONS exchange_part_test2
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@exchange_part_test2
 PREHOOK: query: ALTER TABLE exchange_part_test2 ADD PARTITION (ds='2013-04-05', hr='h1')
 PREHOOK: type: ALTERTABLE_ADDPARTS
 PREHOOK: Output: default@exchange_part_test2
@@ -36,12 +40,16 @@ POSTHOOK: Output: default@exchange_part_test2
 POSTHOOK: Output: default@exchange_part_test2@ds=2013-04-05/hr=h2
 PREHOOK: query: SHOW PARTITIONS exchange_part_test1
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@exchange_part_test1
 POSTHOOK: query: SHOW PARTITIONS exchange_part_test1
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@exchange_part_test1
 PREHOOK: query: SHOW PARTITIONS exchange_part_test2
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@exchange_part_test2
 POSTHOOK: query: SHOW PARTITIONS exchange_part_test2
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@exchange_part_test2
 ds=2013-04-05/hr=h1
 ds=2013-04-05/hr=h2
 FAILED: SemanticException [Error 10234]: Parition values specifed are not continuous. A subpartition value is specified without specififying the parent partition's value {hr=h1}
diff --git a/ql/src/test/results/clientnegative/exchange_partition_neg_partition_exists.q.out b/ql/src/test/results/clientnegative/exchange_partition_neg_partition_exists.q.out
index f11a457f39..dc105277ef 100644
--- a/ql/src/test/results/clientnegative/exchange_partition_neg_partition_exists.q.out
+++ b/ql/src/test/results/clientnegative/exchange_partition_neg_partition_exists.q.out
@@ -14,12 +14,16 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@exchange_part_test2
 PREHOOK: query: SHOW PARTITIONS exchange_part_test1
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@exchange_part_test1
 POSTHOOK: query: SHOW PARTITIONS exchange_part_test1
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@exchange_part_test1
 PREHOOK: query: SHOW PARTITIONS exchange_part_test2
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@exchange_part_test2
 POSTHOOK: query: SHOW PARTITIONS exchange_part_test2
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@exchange_part_test2
 PREHOOK: query: ALTER TABLE exchange_part_test1 ADD PARTITION (ds='2013-04-05')
 PREHOOK: type: ALTERTABLE_ADDPARTS
 PREHOOK: Output: default@exchange_part_test1
@@ -36,12 +40,16 @@ POSTHOOK: Output: default@exchange_part_test2
 POSTHOOK: Output: default@exchange_part_test2@ds=2013-04-05
 PREHOOK: query: SHOW PARTITIONS exchange_part_test1
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@exchange_part_test1
 POSTHOOK: query: SHOW PARTITIONS exchange_part_test1
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@exchange_part_test1
 ds=2013-04-05
 PREHOOK: query: SHOW PARTITIONS exchange_part_test2
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@exchange_part_test2
 POSTHOOK: query: SHOW PARTITIONS exchange_part_test2
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@exchange_part_test2
 ds=2013-04-05
 FAILED: SemanticException [Error 10118]: Partition already exists [exchange_part_test1(ds=2013-04-05)]
diff --git a/ql/src/test/results/clientnegative/exchange_partition_neg_partition_exists2.q.out b/ql/src/test/results/clientnegative/exchange_partition_neg_partition_exists2.q.out
index 2b1b43f898..219b71293c 100644
--- a/ql/src/test/results/clientnegative/exchange_partition_neg_partition_exists2.q.out
+++ b/ql/src/test/results/clientnegative/exchange_partition_neg_partition_exists2.q.out
@@ -14,12 +14,16 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@exchange_part_test2
 PREHOOK: query: SHOW PARTITIONS exchange_part_test1
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@exchange_part_test1
 POSTHOOK: query: SHOW PARTITIONS exchange_part_test1
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@exchange_part_test1
 PREHOOK: query: SHOW PARTITIONS exchange_part_test2
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@exchange_part_test2
 POSTHOOK: query: SHOW PARTITIONS exchange_part_test2
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@exchange_part_test2
 PREHOOK: query: ALTER TABLE exchange_part_test1 ADD PARTITION (ds='2013-04-05', hr='1')
 PREHOOK: type: ALTERTABLE_ADDPARTS
 PREHOOK: Output: default@exchange_part_test1
@@ -43,13 +47,17 @@ POSTHOOK: Output: default@exchange_part_test2
 POSTHOOK: Output: default@exchange_part_test2@ds=2013-04-05/hr=3
 PREHOOK: query: SHOW PARTITIONS exchange_part_test1
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@exchange_part_test1
 POSTHOOK: query: SHOW PARTITIONS exchange_part_test1
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@exchange_part_test1
 ds=2013-04-05/hr=1
 ds=2013-04-05/hr=2
 PREHOOK: query: SHOW PARTITIONS exchange_part_test2
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@exchange_part_test2
 POSTHOOK: query: SHOW PARTITIONS exchange_part_test2
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@exchange_part_test2
 ds=2013-04-05/hr=3
 FAILED: SemanticException [Error 10118]: Partition already exists [exchange_part_test1(ds=2013-04-05/hr=1), exchange_part_test1(ds=2013-04-05/hr=2)]
diff --git a/ql/src/test/results/clientnegative/exchange_partition_neg_partition_exists3.q.out b/ql/src/test/results/clientnegative/exchange_partition_neg_partition_exists3.q.out
index 3559ac7895..90a81e110a 100644
--- a/ql/src/test/results/clientnegative/exchange_partition_neg_partition_exists3.q.out
+++ b/ql/src/test/results/clientnegative/exchange_partition_neg_partition_exists3.q.out
@@ -14,12 +14,16 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@exchange_part_test2
 PREHOOK: query: SHOW PARTITIONS exchange_part_test1
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@exchange_part_test1
 POSTHOOK: query: SHOW PARTITIONS exchange_part_test1
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@exchange_part_test1
 PREHOOK: query: SHOW PARTITIONS exchange_part_test2
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@exchange_part_test2
 POSTHOOK: query: SHOW PARTITIONS exchange_part_test2
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@exchange_part_test2
 PREHOOK: query: ALTER TABLE exchange_part_test1 ADD PARTITION (ds='2013-04-05', hr='1')
 PREHOOK: type: ALTERTABLE_ADDPARTS
 PREHOOK: Output: default@exchange_part_test1
@@ -43,13 +47,17 @@ POSTHOOK: Output: default@exchange_part_test2
 POSTHOOK: Output: default@exchange_part_test2@ds=2013-04-05/hr=1
 PREHOOK: query: SHOW PARTITIONS exchange_part_test1
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@exchange_part_test1
 POSTHOOK: query: SHOW PARTITIONS exchange_part_test1
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@exchange_part_test1
 ds=2013-04-05/hr=1
 ds=2013-04-05/hr=2
 PREHOOK: query: SHOW PARTITIONS exchange_part_test2
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@exchange_part_test2
 POSTHOOK: query: SHOW PARTITIONS exchange_part_test2
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@exchange_part_test2
 ds=2013-04-05/hr=1
 FAILED: SemanticException [Error 10118]: Partition already exists [exchange_part_test1(ds=2013-04-05/hr=1), exchange_part_test1(ds=2013-04-05/hr=2)]
diff --git a/ql/src/test/results/clientnegative/exchange_partition_neg_partition_missing.q.out b/ql/src/test/results/clientnegative/exchange_partition_neg_partition_missing.q.out
index d296512e39..0e7f535279 100644
--- a/ql/src/test/results/clientnegative/exchange_partition_neg_partition_missing.q.out
+++ b/ql/src/test/results/clientnegative/exchange_partition_neg_partition_missing.q.out
@@ -14,6 +14,8 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@exchange_part_test2
 PREHOOK: query: SHOW PARTITIONS exchange_part_test1
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@exchange_part_test1
 POSTHOOK: query: SHOW PARTITIONS exchange_part_test1
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@exchange_part_test1
 FAILED: SemanticException [Error 10006]: Partition not found {ds=2013-04-05}
diff --git a/ql/src/test/results/clientnegative/exchange_partition_neg_table_missing2.q.out b/ql/src/test/results/clientnegative/exchange_partition_neg_table_missing2.q.out
index 504bec1c9f..64e731f7ff 100644
--- a/ql/src/test/results/clientnegative/exchange_partition_neg_table_missing2.q.out
+++ b/ql/src/test/results/clientnegative/exchange_partition_neg_table_missing2.q.out
@@ -7,8 +7,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@exchange_part_test1
 PREHOOK: query: SHOW PARTITIONS exchange_part_test1
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@exchange_part_test1
 POSTHOOK: query: SHOW PARTITIONS exchange_part_test1
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@exchange_part_test1
 PREHOOK: query: ALTER TABLE exchange_part_test1 ADD PARTITION (ds='2013-04-05')
 PREHOOK: type: ALTERTABLE_ADDPARTS
 PREHOOK: Output: default@exchange_part_test1
@@ -18,7 +20,9 @@ POSTHOOK: Output: default@exchange_part_test1
 POSTHOOK: Output: default@exchange_part_test1@ds=2013-04-05
 PREHOOK: query: SHOW PARTITIONS exchange_part_test1
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@exchange_part_test1
 POSTHOOK: query: SHOW PARTITIONS exchange_part_test1
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@exchange_part_test1
 ds=2013-04-05
 FAILED: SemanticException [Error 10001]: Table not found exchange_part_test2
diff --git a/ql/src/test/results/clientnegative/exchange_partition_neg_test.q.out b/ql/src/test/results/clientnegative/exchange_partition_neg_test.q.out
index 98e93144e4..7cdf556010 100644
--- a/ql/src/test/results/clientnegative/exchange_partition_neg_test.q.out
+++ b/ql/src/test/results/clientnegative/exchange_partition_neg_test.q.out
@@ -14,12 +14,16 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@exchange_part_test2
 PREHOOK: query: SHOW PARTITIONS exchange_part_test1
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@exchange_part_test1
 POSTHOOK: query: SHOW PARTITIONS exchange_part_test1
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@exchange_part_test1
 PREHOOK: query: SHOW PARTITIONS exchange_part_test2
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@exchange_part_test2
 POSTHOOK: query: SHOW PARTITIONS exchange_part_test2
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@exchange_part_test2
 PREHOOK: query: ALTER TABLE exchange_part_test1 ADD PARTITION (ds='2013-04-05')
 PREHOOK: type: ALTERTABLE_ADDPARTS
 PREHOOK: Output: default@exchange_part_test1
@@ -29,11 +33,15 @@ POSTHOOK: Output: default@exchange_part_test1
 POSTHOOK: Output: default@exchange_part_test1@ds=2013-04-05
 PREHOOK: query: SHOW PARTITIONS exchange_part_test1
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@exchange_part_test1
 POSTHOOK: query: SHOW PARTITIONS exchange_part_test1
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@exchange_part_test1
 ds=2013-04-05
 PREHOOK: query: SHOW PARTITIONS exchange_part_test2
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@exchange_part_test2
 POSTHOOK: query: SHOW PARTITIONS exchange_part_test2
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@exchange_part_test2
 FAILED: SemanticException [Error 10235]: Tables have incompatible schemas and their partitions  cannot be exchanged.
diff --git a/ql/src/test/results/clientnegative/protectmode_part_no_drop.q.out b/ql/src/test/results/clientnegative/protectmode_part_no_drop.q.out
index 909de03621..857dafdd2e 100644
--- a/ql/src/test/results/clientnegative/protectmode_part_no_drop.q.out
+++ b/ql/src/test/results/clientnegative/protectmode_part_no_drop.q.out
@@ -31,8 +31,10 @@ POSTHOOK: Input: default@tbl_protectmode_no_drop@p=p1
 POSTHOOK: Output: default@tbl_protectmode_no_drop@p=p1
 PREHOOK: query: desc extended tbl_protectmode_no_drop partition (p='p1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tbl_protectmode_no_drop
 POSTHOOK: query: desc extended tbl_protectmode_no_drop partition (p='p1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tbl_protectmode_no_drop
 c1                  	string              	                    
 c2                  	string              	                    
 p                   	string              	                    
diff --git a/ql/src/test/results/clientnegative/protectmode_tbl2.q.out b/ql/src/test/results/clientnegative/protectmode_tbl2.q.out
index b16b25d94f..7d600d2343 100644
--- a/ql/src/test/results/clientnegative/protectmode_tbl2.q.out
+++ b/ql/src/test/results/clientnegative/protectmode_tbl2.q.out
@@ -46,8 +46,10 @@ POSTHOOK: Input: default@tbl_protectmode2
 POSTHOOK: Output: default@tbl_protectmode2
 PREHOOK: query: desc extended tbl_protectmode2
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tbl_protectmode2
 POSTHOOK: query: desc extended tbl_protectmode2
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tbl_protectmode2
 col                 	string              	                    
 p                   	string              	                    
 	 	 
diff --git a/ql/src/test/results/clientnegative/protectmode_tbl3.q.out b/ql/src/test/results/clientnegative/protectmode_tbl3.q.out
index f738f5ce51..fd4ddcbe0b 100644
--- a/ql/src/test/results/clientnegative/protectmode_tbl3.q.out
+++ b/ql/src/test/results/clientnegative/protectmode_tbl3.q.out
@@ -31,8 +31,10 @@ POSTHOOK: Input: default@tbl_protectmode_4
 POSTHOOK: Output: default@tbl_protectmode_4
 PREHOOK: query: desc extended tbl_protectmode_4
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tbl_protectmode_4
 POSTHOOK: query: desc extended tbl_protectmode_4
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tbl_protectmode_4
 col                 	string              	                    
 	 	 
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientnegative/protectmode_tbl4.q.out b/ql/src/test/results/clientnegative/protectmode_tbl4.q.out
index 4d187ed4b3..2c4dc6c9ea 100644
--- a/ql/src/test/results/clientnegative/protectmode_tbl4.q.out
+++ b/ql/src/test/results/clientnegative/protectmode_tbl4.q.out
@@ -57,8 +57,10 @@ POSTHOOK: Input: default@tbl_protectmode_tbl4
 POSTHOOK: Output: default@tbl_protectmode_tbl4
 PREHOOK: query: desc extended tbl_protectmode_tbl4
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tbl_protectmode_tbl4
 POSTHOOK: query: desc extended tbl_protectmode_tbl4
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tbl_protectmode_tbl4
 col                 	string              	                    
 p                   	string              	                    
 	 	 
diff --git a/ql/src/test/results/clientnegative/protectmode_tbl5.q.out b/ql/src/test/results/clientnegative/protectmode_tbl5.q.out
index 56a274653d..bc5e9d37b3 100644
--- a/ql/src/test/results/clientnegative/protectmode_tbl5.q.out
+++ b/ql/src/test/results/clientnegative/protectmode_tbl5.q.out
@@ -57,8 +57,10 @@ POSTHOOK: Input: default@tbl_protectmode_tbl5
 POSTHOOK: Output: default@tbl_protectmode_tbl5
 PREHOOK: query: desc extended tbl_protectmode_tbl5
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tbl_protectmode_tbl5
 POSTHOOK: query: desc extended tbl_protectmode_tbl5
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tbl_protectmode_tbl5
 col                 	string              	                    
 p                   	string              	                    
 	 	 
diff --git a/ql/src/test/results/clientnegative/protectmode_tbl_no_drop.q.out b/ql/src/test/results/clientnegative/protectmode_tbl_no_drop.q.out
index 7ecae4c8b4..ac0d794891 100644
--- a/ql/src/test/results/clientnegative/protectmode_tbl_no_drop.q.out
+++ b/ql/src/test/results/clientnegative/protectmode_tbl_no_drop.q.out
@@ -31,8 +31,10 @@ POSTHOOK: Input: default@tbl_protectmode__no_drop
 POSTHOOK: Output: default@tbl_protectmode__no_drop
 PREHOOK: query: desc extended tbl_protectmode__no_drop
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tbl_protectmode__no_drop
 POSTHOOK: query: desc extended tbl_protectmode__no_drop
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tbl_protectmode__no_drop
 col                 	string              	                    
 	 	 
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientnegative/set_hiveconf_validation0.q.out b/ql/src/test/results/clientnegative/set_hiveconf_validation0.q.out
index fe21381a0a..d30969704c 100644
--- a/ql/src/test/results/clientnegative/set_hiveconf_validation0.q.out
+++ b/ql/src/test/results/clientnegative/set_hiveconf_validation0.q.out
@@ -1,9 +1,11 @@
 PREHOOK: query: -- should fail: hive.join.cache.size accepts int type
 desc src
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@src
 POSTHOOK: query: -- should fail: hive.join.cache.size accepts int type
 desc src
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@src
 key                 	string              	default             
 value               	string              	default             
 Query returned non-zero code: 1, cause: 'SET hive.join.cache.size=test' FAILED because hive.join.cache.size expects an INT value.
diff --git a/ql/src/test/results/clientnegative/set_hiveconf_validation1.q.out b/ql/src/test/results/clientnegative/set_hiveconf_validation1.q.out
index 0e978ea3ce..9f24b8e176 100644
--- a/ql/src/test/results/clientnegative/set_hiveconf_validation1.q.out
+++ b/ql/src/test/results/clientnegative/set_hiveconf_validation1.q.out
@@ -1,9 +1,11 @@
 PREHOOK: query: -- should fail: hive.map.aggr.hash.min.reduction accepts float type
 desc src
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@src
 POSTHOOK: query: -- should fail: hive.map.aggr.hash.min.reduction accepts float type
 desc src
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@src
 key                 	string              	default             
 value               	string              	default             
 Query returned non-zero code: 1, cause: 'SET hive.map.aggr.hash.min.reduction=false' FAILED because hive.map.aggr.hash.min.reduction expects an FLOAT value.
diff --git a/ql/src/test/results/clientnegative/set_hiveconf_validation2.q.out b/ql/src/test/results/clientnegative/set_hiveconf_validation2.q.out
index 50ec9f496a..33f936004d 100644
--- a/ql/src/test/results/clientnegative/set_hiveconf_validation2.q.out
+++ b/ql/src/test/results/clientnegative/set_hiveconf_validation2.q.out
@@ -1,9 +1,11 @@
 PREHOOK: query: -- should fail: hive.fetch.task.conversion accepts minimal or more
 desc src
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@src
 POSTHOOK: query: -- should fail: hive.fetch.task.conversion accepts minimal or more
 desc src
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@src
 key                 	string              	default             
 value               	string              	default             
 Query returned non-zero code: 1, cause: 'SET hive.fetch.task.conversion=true' FAILED in validation : Invalid value.. expects one of [minimal, more].
diff --git a/ql/src/test/results/clientnegative/stats_partialscan_autogether.q.out b/ql/src/test/results/clientnegative/stats_partialscan_autogether.q.out
index 171b3dd3c1..1586deaac3 100644
--- a/ql/src/test/results/clientnegative/stats_partialscan_autogether.q.out
+++ b/ql/src/test/results/clientnegative/stats_partialscan_autogether.q.out
@@ -44,8 +44,10 @@ POSTHOOK: Lineage: analyze_srcpart_partial_scan PARTITION(ds=2008-04-09,hr=12).k
 POSTHOOK: Lineage: analyze_srcpart_partial_scan PARTITION(ds=2008-04-09,hr=12).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: describe formatted analyze_srcpart_partial_scan PARTITION(ds='2008-04-08',hr=11)
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@analyze_srcpart_partial_scan
 POSTHOOK: query: describe formatted analyze_srcpart_partial_scan PARTITION(ds='2008-04-08',hr=11)
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@analyze_srcpart_partial_scan
 POSTHOOK: Lineage: analyze_srcpart_partial_scan PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart_partial_scan PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart_partial_scan PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/add_part_exist.q.out b/ql/src/test/results/clientpositive/add_part_exist.q.out
index 86f17fb8d3..730fcfaf9e 100644
--- a/ql/src/test/results/clientpositive/add_part_exist.q.out
+++ b/ql/src/test/results/clientpositive/add_part_exist.q.out
@@ -7,8 +7,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@add_part_test
 PREHOOK: query: SHOW PARTITIONS add_part_test
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@add_part_test
 POSTHOOK: query: SHOW PARTITIONS add_part_test
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@add_part_test
 PREHOOK: query: ALTER TABLE add_part_test ADD PARTITION (ds='2010-01-01')
 PREHOOK: type: ALTERTABLE_ADDPARTS
 PREHOOK: Output: default@add_part_test
@@ -18,8 +20,10 @@ POSTHOOK: Output: default@add_part_test
 POSTHOOK: Output: default@add_part_test@ds=2010-01-01
 PREHOOK: query: SHOW PARTITIONS add_part_test
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@add_part_test
 POSTHOOK: query: SHOW PARTITIONS add_part_test
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@add_part_test
 ds=2010-01-01
 PREHOOK: query: ALTER TABLE add_part_test ADD IF NOT EXISTS PARTITION (ds='2010-01-01')
 PREHOOK: type: ALTERTABLE_ADDPARTS
@@ -29,8 +33,10 @@ POSTHOOK: type: ALTERTABLE_ADDPARTS
 POSTHOOK: Output: default@add_part_test
 PREHOOK: query: SHOW PARTITIONS add_part_test
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@add_part_test
 POSTHOOK: query: SHOW PARTITIONS add_part_test
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@add_part_test
 ds=2010-01-01
 PREHOOK: query: ALTER TABLE add_part_test ADD IF NOT EXISTS PARTITION (ds='2010-01-02')
 PREHOOK: type: ALTERTABLE_ADDPARTS
@@ -41,8 +47,10 @@ POSTHOOK: Output: default@add_part_test
 POSTHOOK: Output: default@add_part_test@ds=2010-01-02
 PREHOOK: query: SHOW PARTITIONS add_part_test
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@add_part_test
 POSTHOOK: query: SHOW PARTITIONS add_part_test
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@add_part_test
 ds=2010-01-01
 ds=2010-01-02
 PREHOOK: query: ALTER TABLE add_part_test ADD IF NOT EXISTS PARTITION (ds='2010-01-01') PARTITION (ds='2010-01-02') PARTITION (ds='2010-01-03')
@@ -54,8 +62,10 @@ POSTHOOK: Output: default@add_part_test
 POSTHOOK: Output: default@add_part_test@ds=2010-01-03
 PREHOOK: query: SHOW PARTITIONS add_part_test
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@add_part_test
 POSTHOOK: query: SHOW PARTITIONS add_part_test
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@add_part_test
 ds=2010-01-01
 ds=2010-01-02
 ds=2010-01-03
@@ -103,8 +113,10 @@ POSTHOOK: Output: add_part_test_db@add_part_test
 POSTHOOK: Output: database:add_part_test_db
 PREHOOK: query: SHOW PARTITIONS add_part_test
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: add_part_test_db@add_part_test
 POSTHOOK: query: SHOW PARTITIONS add_part_test
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: add_part_test_db@add_part_test
 PREHOOK: query: ALTER TABLE add_part_test ADD PARTITION (ds='2010-01-01')
 PREHOOK: type: ALTERTABLE_ADDPARTS
 PREHOOK: Output: add_part_test_db@add_part_test
@@ -114,8 +126,10 @@ POSTHOOK: Output: add_part_test_db@add_part_test
 POSTHOOK: Output: add_part_test_db@add_part_test@ds=2010-01-01
 PREHOOK: query: SHOW PARTITIONS add_part_test
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: add_part_test_db@add_part_test
 POSTHOOK: query: SHOW PARTITIONS add_part_test
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: add_part_test_db@add_part_test
 ds=2010-01-01
 PREHOOK: query: ALTER TABLE add_part_test ADD IF NOT EXISTS PARTITION (ds='2010-01-01')
 PREHOOK: type: ALTERTABLE_ADDPARTS
@@ -125,8 +139,10 @@ POSTHOOK: type: ALTERTABLE_ADDPARTS
 POSTHOOK: Output: add_part_test_db@add_part_test
 PREHOOK: query: SHOW PARTITIONS add_part_test
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: add_part_test_db@add_part_test
 POSTHOOK: query: SHOW PARTITIONS add_part_test
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: add_part_test_db@add_part_test
 ds=2010-01-01
 PREHOOK: query: ALTER TABLE add_part_test ADD IF NOT EXISTS PARTITION (ds='2010-01-02')
 PREHOOK: type: ALTERTABLE_ADDPARTS
@@ -137,8 +153,10 @@ POSTHOOK: Output: add_part_test_db@add_part_test
 POSTHOOK: Output: add_part_test_db@add_part_test@ds=2010-01-02
 PREHOOK: query: SHOW PARTITIONS add_part_test
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: add_part_test_db@add_part_test
 POSTHOOK: query: SHOW PARTITIONS add_part_test
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: add_part_test_db@add_part_test
 ds=2010-01-01
 ds=2010-01-02
 PREHOOK: query: ALTER TABLE add_part_test ADD IF NOT EXISTS PARTITION (ds='2010-01-01') PARTITION (ds='2010-01-02') PARTITION (ds='2010-01-03')
@@ -150,8 +168,10 @@ POSTHOOK: Output: add_part_test_db@add_part_test
 POSTHOOK: Output: add_part_test_db@add_part_test@ds=2010-01-03
 PREHOOK: query: SHOW PARTITIONS add_part_test
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: add_part_test_db@add_part_test
 POSTHOOK: query: SHOW PARTITIONS add_part_test
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: add_part_test_db@add_part_test
 ds=2010-01-01
 ds=2010-01-02
 ds=2010-01-03
diff --git a/ql/src/test/results/clientpositive/add_partition_no_whitelist.q.out b/ql/src/test/results/clientpositive/add_partition_no_whitelist.q.out
index aaa83365bb..35188753a3 100644
--- a/ql/src/test/results/clientpositive/add_partition_no_whitelist.q.out
+++ b/ql/src/test/results/clientpositive/add_partition_no_whitelist.q.out
@@ -11,8 +11,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@part_nowhitelist_test
 PREHOOK: query: SHOW PARTITIONS part_nowhitelist_test
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@part_nowhitelist_test
 POSTHOOK: query: SHOW PARTITIONS part_nowhitelist_test
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@part_nowhitelist_test
 PREHOOK: query: ALTER TABLE part_nowhitelist_test ADD PARTITION (ds='1,2,3,4')
 PREHOOK: type: ALTERTABLE_ADDPARTS
 PREHOOK: Output: default@part_nowhitelist_test
diff --git a/ql/src/test/results/clientpositive/add_partition_with_whitelist.q.out b/ql/src/test/results/clientpositive/add_partition_with_whitelist.q.out
index 33085a5aa9..6fda5c9cc2 100644
--- a/ql/src/test/results/clientpositive/add_partition_with_whitelist.q.out
+++ b/ql/src/test/results/clientpositive/add_partition_with_whitelist.q.out
@@ -11,8 +11,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@part_whitelist_test
 PREHOOK: query: SHOW PARTITIONS part_whitelist_test
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@part_whitelist_test
 POSTHOOK: query: SHOW PARTITIONS part_whitelist_test
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@part_whitelist_test
 PREHOOK: query: ALTER TABLE part_whitelist_test ADD PARTITION (ds='Part')
 PREHOOK: type: ALTERTABLE_ADDPARTS
 PREHOOK: Output: default@part_whitelist_test
diff --git a/ql/src/test/results/clientpositive/alter1.q.out b/ql/src/test/results/clientpositive/alter1.q.out
index 474ebea6d3..94fa640067 100644
--- a/ql/src/test/results/clientpositive/alter1.q.out
+++ b/ql/src/test/results/clientpositive/alter1.q.out
@@ -7,8 +7,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@alter1
 PREHOOK: query: describe extended alter1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@alter1
 POSTHOOK: query: describe extended alter1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@alter1
 a                   	int                 	                    
 b                   	int                 	                    
 	 	 
@@ -23,8 +25,10 @@ POSTHOOK: Input: default@alter1
 POSTHOOK: Output: default@alter1
 PREHOOK: query: describe extended alter1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@alter1
 POSTHOOK: query: describe extended alter1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@alter1
 a                   	int                 	                    
 b                   	int                 	                    
 	 	 
@@ -39,8 +43,10 @@ POSTHOOK: Input: default@alter1
 POSTHOOK: Output: default@alter1
 PREHOOK: query: describe extended alter1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@alter1
 POSTHOOK: query: describe extended alter1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@alter1
 a                   	int                 	                    
 b                   	int                 	                    
 	 	 
@@ -55,8 +61,10 @@ POSTHOOK: Input: default@alter1
 POSTHOOK: Output: default@alter1
 PREHOOK: query: describe extended alter1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@alter1
 POSTHOOK: query: describe extended alter1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@alter1
 a                   	int                 	                    
 b                   	int                 	                    
 	 	 
@@ -71,8 +79,10 @@ POSTHOOK: Input: default@alter1
 POSTHOOK: Output: default@alter1
 PREHOOK: query: describe extended alter1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@alter1
 POSTHOOK: query: describe extended alter1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@alter1
 a                   	int                 	                    
 b                   	int                 	                    
 	 	 
@@ -87,8 +97,10 @@ POSTHOOK: Input: default@alter1
 POSTHOOK: Output: default@alter1
 PREHOOK: query: describe extended alter1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@alter1
 POSTHOOK: query: describe extended alter1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@alter1
 a                   	int                 	                    
 b                   	int                 	                    
 	 	 
@@ -103,8 +115,10 @@ POSTHOOK: Input: default@alter1
 POSTHOOK: Output: default@alter1
 PREHOOK: query: describe extended alter1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@alter1
 POSTHOOK: query: describe extended alter1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@alter1
 a                   	int                 	                    
 b                   	int                 	                    
 	 	 
@@ -119,8 +133,10 @@ POSTHOOK: Input: default@alter1
 POSTHOOK: Output: default@alter1
 PREHOOK: query: describe extended alter1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@alter1
 POSTHOOK: query: describe extended alter1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@alter1
 a                   	string              	                    
 b                   	string              	                    
 	 	 
@@ -135,8 +151,10 @@ POSTHOOK: Input: default@alter1
 POSTHOOK: Output: default@alter1
 PREHOOK: query: describe extended alter1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@alter1
 POSTHOOK: query: describe extended alter1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@alter1
 a                   	string              	                    
 b                   	string              	                    
 	 	 
@@ -151,8 +169,10 @@ POSTHOOK: Input: default@alter1
 POSTHOOK: Output: default@alter1
 PREHOOK: query: describe alter1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@alter1
 POSTHOOK: query: describe alter1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@alter1
 a                   	int                 	                    
 b                   	int                 	                    
 c                   	string              	                    
@@ -204,8 +224,10 @@ POSTHOOK: Output: alter1_db@alter1
 POSTHOOK: Output: database:alter1_db
 PREHOOK: query: DESCRIBE EXTENDED alter1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: alter1_db@alter1
 POSTHOOK: query: DESCRIBE EXTENDED alter1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: alter1_db@alter1
 a                   	int                 	                    
 b                   	int                 	                    
 	 	 
@@ -220,8 +242,10 @@ POSTHOOK: Input: alter1_db@alter1
 POSTHOOK: Output: alter1_db@alter1
 PREHOOK: query: DESCRIBE EXTENDED alter1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: alter1_db@alter1
 POSTHOOK: query: DESCRIBE EXTENDED alter1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: alter1_db@alter1
 a                   	int                 	                    
 b                   	int                 	                    
 	 	 
@@ -236,8 +260,10 @@ POSTHOOK: Input: alter1_db@alter1
 POSTHOOK: Output: alter1_db@alter1
 PREHOOK: query: DESCRIBE EXTENDED alter1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: alter1_db@alter1
 POSTHOOK: query: DESCRIBE EXTENDED alter1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: alter1_db@alter1
 a                   	int                 	                    
 b                   	int                 	                    
 	 	 
@@ -252,8 +278,10 @@ POSTHOOK: Input: alter1_db@alter1
 POSTHOOK: Output: alter1_db@alter1
 PREHOOK: query: DESCRIBE EXTENDED alter1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: alter1_db@alter1
 POSTHOOK: query: DESCRIBE EXTENDED alter1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: alter1_db@alter1
 a                   	int                 	                    
 b                   	int                 	                    
 	 	 
@@ -268,8 +296,10 @@ POSTHOOK: Input: alter1_db@alter1
 POSTHOOK: Output: alter1_db@alter1
 PREHOOK: query: DESCRIBE EXTENDED alter1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: alter1_db@alter1
 POSTHOOK: query: DESCRIBE EXTENDED alter1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: alter1_db@alter1
 a                   	int                 	                    
 b                   	int                 	                    
 	 	 
@@ -284,8 +314,10 @@ POSTHOOK: Input: alter1_db@alter1
 POSTHOOK: Output: alter1_db@alter1
 PREHOOK: query: DESCRIBE EXTENDED alter1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: alter1_db@alter1
 POSTHOOK: query: DESCRIBE EXTENDED alter1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: alter1_db@alter1
 a                   	int                 	                    
 b                   	int                 	                    
 	 	 
@@ -300,8 +332,10 @@ POSTHOOK: Input: alter1_db@alter1
 POSTHOOK: Output: alter1_db@alter1
 PREHOOK: query: DESCRIBE EXTENDED alter1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: alter1_db@alter1
 POSTHOOK: query: DESCRIBE EXTENDED alter1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: alter1_db@alter1
 a                   	int                 	                    
 b                   	int                 	                    
 	 	 
@@ -316,8 +350,10 @@ POSTHOOK: Input: alter1_db@alter1
 POSTHOOK: Output: alter1_db@alter1
 PREHOOK: query: DESCRIBE EXTENDED alter1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: alter1_db@alter1
 POSTHOOK: query: DESCRIBE EXTENDED alter1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: alter1_db@alter1
 a                   	string              	                    
 b                   	string              	                    
 	 	 
@@ -332,8 +368,10 @@ POSTHOOK: Input: alter1_db@alter1
 POSTHOOK: Output: alter1_db@alter1
 PREHOOK: query: DESCRIBE EXTENDED alter1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: alter1_db@alter1
 POSTHOOK: query: DESCRIBE EXTENDED alter1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: alter1_db@alter1
 a                   	string              	                    
 b                   	string              	                    
 	 	 
@@ -348,8 +386,10 @@ POSTHOOK: Input: alter1_db@alter1
 POSTHOOK: Output: alter1_db@alter1
 PREHOOK: query: DESCRIBE alter1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: alter1_db@alter1
 POSTHOOK: query: DESCRIBE alter1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: alter1_db@alter1
 a                   	int                 	                    
 b                   	int                 	                    
 c                   	string              	                    
diff --git a/ql/src/test/results/clientpositive/alter2.q.out b/ql/src/test/results/clientpositive/alter2.q.out
index f093fe49cb..eb3f981beb 100644
--- a/ql/src/test/results/clientpositive/alter2.q.out
+++ b/ql/src/test/results/clientpositive/alter2.q.out
@@ -7,8 +7,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@alter2
 PREHOOK: query: describe extended alter2
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@alter2
 POSTHOOK: query: describe extended alter2
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@alter2
 a                   	int                 	                    
 b                   	int                 	                    
 insertdate          	string              	                    
@@ -21,8 +23,10 @@ insertdate          	string
 #### A masked pattern was here ####
 PREHOOK: query: show partitions alter2
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@alter2
 POSTHOOK: query: show partitions alter2
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@alter2
 PREHOOK: query: alter table alter2 add partition (insertdate='2008-01-01') location '2008/01/01'
 PREHOOK: type: ALTERTABLE_ADDPARTS
 PREHOOK: Input: 2008/01/01
@@ -34,8 +38,10 @@ POSTHOOK: Output: default@alter2
 POSTHOOK: Output: default@alter2@insertdate=2008-01-01
 PREHOOK: query: describe extended alter2
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@alter2
 POSTHOOK: query: describe extended alter2
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@alter2
 a                   	int                 	                    
 b                   	int                 	                    
 insertdate          	string              	                    
@@ -48,8 +54,10 @@ insertdate          	string
 #### A masked pattern was here ####
 PREHOOK: query: show partitions alter2
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@alter2
 POSTHOOK: query: show partitions alter2
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@alter2
 insertdate=2008-01-01
 PREHOOK: query: alter table alter2 add partition (insertdate='2008-01-02') location '2008/01/02'
 PREHOOK: type: ALTERTABLE_ADDPARTS
@@ -62,8 +70,10 @@ POSTHOOK: Output: default@alter2
 POSTHOOK: Output: default@alter2@insertdate=2008-01-02
 PREHOOK: query: describe extended alter2
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@alter2
 POSTHOOK: query: describe extended alter2
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@alter2
 a                   	int                 	                    
 b                   	int                 	                    
 insertdate          	string              	                    
@@ -76,8 +86,10 @@ insertdate          	string
 #### A masked pattern was here ####
 PREHOOK: query: show partitions alter2
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@alter2
 POSTHOOK: query: show partitions alter2
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@alter2
 insertdate=2008-01-01
 insertdate=2008-01-02
 PREHOOK: query: drop table alter2
@@ -97,8 +109,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@alter2
 PREHOOK: query: describe extended alter2
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@alter2
 POSTHOOK: query: describe extended alter2
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@alter2
 a                   	int                 	                    
 b                   	int                 	                    
 insertdate          	string              	                    
@@ -111,8 +125,10 @@ insertdate          	string
 #### A masked pattern was here ####
 PREHOOK: query: show partitions alter2
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@alter2
 POSTHOOK: query: show partitions alter2
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@alter2
 PREHOOK: query: alter table alter2 add partition (insertdate='2008-01-01') location '2008/01/01'
 PREHOOK: type: ALTERTABLE_ADDPARTS
 PREHOOK: Input: 2008/01/01
@@ -124,8 +140,10 @@ POSTHOOK: Output: default@alter2
 POSTHOOK: Output: default@alter2@insertdate=2008-01-01
 PREHOOK: query: describe extended alter2
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@alter2
 POSTHOOK: query: describe extended alter2
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@alter2
 a                   	int                 	                    
 b                   	int                 	                    
 insertdate          	string              	                    
@@ -138,8 +156,10 @@ insertdate          	string
 #### A masked pattern was here ####
 PREHOOK: query: show partitions alter2
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@alter2
 POSTHOOK: query: show partitions alter2
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@alter2
 insertdate=2008-01-01
 PREHOOK: query: alter table alter2 add partition (insertdate='2008-01-02') location '2008/01/02'
 PREHOOK: type: ALTERTABLE_ADDPARTS
@@ -152,8 +172,10 @@ POSTHOOK: Output: default@alter2
 POSTHOOK: Output: default@alter2@insertdate=2008-01-02
 PREHOOK: query: describe extended alter2
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@alter2
 POSTHOOK: query: describe extended alter2
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@alter2
 a                   	int                 	                    
 b                   	int                 	                    
 insertdate          	string              	                    
@@ -166,8 +188,10 @@ insertdate          	string
 #### A masked pattern was here ####
 PREHOOK: query: show partitions alter2
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@alter2
 POSTHOOK: query: show partitions alter2
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@alter2
 insertdate=2008-01-01
 insertdate=2008-01-02
 PREHOOK: query: -- Cleanup
@@ -218,8 +242,10 @@ POSTHOOK: Output: alter2_db@alter2
 POSTHOOK: Output: database:alter2_db
 PREHOOK: query: DESCRIBE EXTENDED alter2
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: alter2_db@alter2
 POSTHOOK: query: DESCRIBE EXTENDED alter2
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: alter2_db@alter2
 a                   	int                 	                    
 b                   	int                 	                    
 insertdate          	string              	                    
@@ -232,8 +258,10 @@ insertdate          	string
 #### A masked pattern was here ####
 PREHOOK: query: SHOW PARTITIONS alter2
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: alter2_db@alter2
 POSTHOOK: query: SHOW PARTITIONS alter2
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: alter2_db@alter2
 #### A masked pattern was here ####
 PREHOOK: type: ALTERTABLE_ADDPARTS
 PREHOOK: Input: 2008/01/01
@@ -245,8 +273,10 @@ POSTHOOK: Output: alter2_db@alter2
 POSTHOOK: Output: alter2_db@alter2@insertdate=2008-01-01
 PREHOOK: query: DESCRIBE EXTENDED alter2
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: alter2_db@alter2
 POSTHOOK: query: DESCRIBE EXTENDED alter2
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: alter2_db@alter2
 a                   	int                 	                    
 b                   	int                 	                    
 insertdate          	string              	                    
@@ -259,8 +289,10 @@ insertdate          	string
 #### A masked pattern was here ####
 PREHOOK: query: SHOW PARTITIONS alter2
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: alter2_db@alter2
 POSTHOOK: query: SHOW PARTITIONS alter2
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: alter2_db@alter2
 insertdate=2008-01-01
 #### A masked pattern was here ####
 PREHOOK: type: ALTERTABLE_ADDPARTS
@@ -273,8 +305,10 @@ POSTHOOK: Output: alter2_db@alter2
 POSTHOOK: Output: alter2_db@alter2@insertdate=2008-01-02
 PREHOOK: query: DESCRIBE EXTENDED alter2
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: alter2_db@alter2
 POSTHOOK: query: DESCRIBE EXTENDED alter2
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: alter2_db@alter2
 a                   	int                 	                    
 b                   	int                 	                    
 insertdate          	string              	                    
@@ -287,8 +321,10 @@ insertdate          	string
 #### A masked pattern was here ####
 PREHOOK: query: SHOW PARTITIONS alter2
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: alter2_db@alter2
 POSTHOOK: query: SHOW PARTITIONS alter2
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: alter2_db@alter2
 insertdate=2008-01-01
 insertdate=2008-01-02
 PREHOOK: query: DROP TABLE alter2
@@ -308,8 +344,10 @@ POSTHOOK: Output: alter2_db@alter2
 POSTHOOK: Output: database:alter2_db
 PREHOOK: query: DESCRIBE EXTENDED alter2
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: alter2_db@alter2
 POSTHOOK: query: DESCRIBE EXTENDED alter2
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: alter2_db@alter2
 a                   	int                 	                    
 b                   	int                 	                    
 insertdate          	string              	                    
@@ -322,8 +360,10 @@ insertdate          	string
 #### A masked pattern was here ####
 PREHOOK: query: SHOW PARTITIONS alter2
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: alter2_db@alter2
 POSTHOOK: query: SHOW PARTITIONS alter2
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: alter2_db@alter2
 #### A masked pattern was here ####
 PREHOOK: type: ALTERTABLE_ADDPARTS
 PREHOOK: Input: 2008/01/01
@@ -335,8 +375,10 @@ POSTHOOK: Output: alter2_db@alter2
 POSTHOOK: Output: alter2_db@alter2@insertdate=2008-01-01
 PREHOOK: query: DESCRIBE EXTENDED alter2
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: alter2_db@alter2
 POSTHOOK: query: DESCRIBE EXTENDED alter2
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: alter2_db@alter2
 a                   	int                 	                    
 b                   	int                 	                    
 insertdate          	string              	                    
@@ -349,8 +391,10 @@ insertdate          	string
 #### A masked pattern was here ####
 PREHOOK: query: SHOW PARTITIONS alter2
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: alter2_db@alter2
 POSTHOOK: query: SHOW PARTITIONS alter2
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: alter2_db@alter2
 insertdate=2008-01-01
 #### A masked pattern was here ####
 PREHOOK: type: ALTERTABLE_ADDPARTS
@@ -363,8 +407,10 @@ POSTHOOK: Output: alter2_db@alter2
 POSTHOOK: Output: alter2_db@alter2@insertdate=2008-01-02
 PREHOOK: query: DESCRIBE EXTENDED alter2
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: alter2_db@alter2
 POSTHOOK: query: DESCRIBE EXTENDED alter2
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: alter2_db@alter2
 a                   	int                 	                    
 b                   	int                 	                    
 insertdate          	string              	                    
@@ -377,8 +423,10 @@ insertdate          	string
 #### A masked pattern was here ####
 PREHOOK: query: SHOW PARTITIONS alter2
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: alter2_db@alter2
 POSTHOOK: query: SHOW PARTITIONS alter2
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: alter2_db@alter2
 insertdate=2008-01-01
 insertdate=2008-01-02
 PREHOOK: query: DROP TABLE alter2
diff --git a/ql/src/test/results/clientpositive/alter3.q.out b/ql/src/test/results/clientpositive/alter3.q.out
index eb2dff9ed1..1646561f46 100644
--- a/ql/src/test/results/clientpositive/alter3.q.out
+++ b/ql/src/test/results/clientpositive/alter3.q.out
@@ -65,8 +65,10 @@ POSTHOOK: Output: default@alter3_renamed
 POSTHOOK: Lineage: alter3 PARTITION(pcol1=test_part:,pcol2=test_part:).col1 SIMPLE [(alter3_src)alter3_src.FieldSchema(name:col1, type:string, comment:null), ]
 PREHOOK: query: describe extended alter3_renamed
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@alter3_renamed
 POSTHOOK: query: describe extended alter3_renamed
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@alter3_renamed
 POSTHOOK: Lineage: alter3 PARTITION(pcol1=test_part:,pcol2=test_part:).col1 SIMPLE [(alter3_src)alter3_src.FieldSchema(name:col1, type:string, comment:null), ]
 col1                	string              	                    
 pcol1               	string              	                    
@@ -81,8 +83,10 @@ pcol2               	string
 #### A masked pattern was here ####
 PREHOOK: query: describe extended alter3_renamed partition (pCol1='test_part:', pcol2='test_part:')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@alter3_renamed
 POSTHOOK: query: describe extended alter3_renamed partition (pCol1='test_part:', pcol2='test_part:')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@alter3_renamed
 POSTHOOK: Lineage: alter3 PARTITION(pcol1=test_part:,pcol2=test_part:).col1 SIMPLE [(alter3_src)alter3_src.FieldSchema(name:col1, type:string, comment:null), ]
 col1                	string              	                    
 pcol1               	string              	                    
@@ -139,8 +143,10 @@ POSTHOOK: Lineage: alter3 PARTITION(pcol1=test_part:,pcol2=test_part:).col1 SIMP
 POSTHOOK: Lineage: alter3_like PARTITION(pcol1=test_part:,pcol2=test_part:).col1 SIMPLE [(alter3_src)alter3_src.FieldSchema(name:col1, type:string, comment:null), ]
 PREHOOK: query: describe extended alter3_like_renamed
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@alter3_like_renamed
 POSTHOOK: query: describe extended alter3_like_renamed
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@alter3_like_renamed
 POSTHOOK: Lineage: alter3 PARTITION(pcol1=test_part:,pcol2=test_part:).col1 SIMPLE [(alter3_src)alter3_src.FieldSchema(name:col1, type:string, comment:null), ]
 POSTHOOK: Lineage: alter3_like PARTITION(pcol1=test_part:,pcol2=test_part:).col1 SIMPLE [(alter3_src)alter3_src.FieldSchema(name:col1, type:string, comment:null), ]
 col1                	string              	                    
@@ -304,8 +310,10 @@ POSTHOOK: Lineage: alter3 PARTITION(pcol1=test_part:,pcol2=test_part:).col1 SIMP
 POSTHOOK: Lineage: alter3_like PARTITION(pcol1=test_part:,pcol2=test_part:).col1 SIMPLE [(alter3_src)alter3_src.FieldSchema(name:col1, type:string, comment:null), ]
 PREHOOK: query: DESCRIBE EXTENDED alter3_renamed
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: alter3_db@alter3_renamed
 POSTHOOK: query: DESCRIBE EXTENDED alter3_renamed
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: alter3_db@alter3_renamed
 POSTHOOK: Lineage: alter3 PARTITION(pcol1=test_part:,pcol2=test_part:).col1 SIMPLE [(alter3_src)alter3_src.FieldSchema(name:col1, type:string, comment:null), ]
 POSTHOOK: Lineage: alter3 PARTITION(pcol1=test_part:,pcol2=test_part:).col1 SIMPLE [(alter3_src)alter3_src.FieldSchema(name:col1, type:string, comment:null), ]
 POSTHOOK: Lineage: alter3_like PARTITION(pcol1=test_part:,pcol2=test_part:).col1 SIMPLE [(alter3_src)alter3_src.FieldSchema(name:col1, type:string, comment:null), ]
@@ -322,8 +330,10 @@ pcol2               	string
 #### A masked pattern was here ####
 PREHOOK: query: DESCRIBE EXTENDED alter3_renamed PARTITION (pCol1='test_part:', pcol2='test_part:')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: alter3_db@alter3_renamed
 POSTHOOK: query: DESCRIBE EXTENDED alter3_renamed PARTITION (pCol1='test_part:', pcol2='test_part:')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: alter3_db@alter3_renamed
 POSTHOOK: Lineage: alter3 PARTITION(pcol1=test_part:,pcol2=test_part:).col1 SIMPLE [(alter3_src)alter3_src.FieldSchema(name:col1, type:string, comment:null), ]
 POSTHOOK: Lineage: alter3 PARTITION(pcol1=test_part:,pcol2=test_part:).col1 SIMPLE [(alter3_src)alter3_src.FieldSchema(name:col1, type:string, comment:null), ]
 POSTHOOK: Lineage: alter3_like PARTITION(pcol1=test_part:,pcol2=test_part:).col1 SIMPLE [(alter3_src)alter3_src.FieldSchema(name:col1, type:string, comment:null), ]
@@ -388,8 +398,10 @@ POSTHOOK: Lineage: alter3_like PARTITION(pcol1=test_part:,pcol2=test_part:).col1
 POSTHOOK: Lineage: alter3_like PARTITION(pcol1=test_part:,pcol2=test_part:).col1 SIMPLE [(alter3_src)alter3_src.FieldSchema(name:col1, type:string, comment:null), ]
 PREHOOK: query: DESCRIBE EXTENDED alter3_like_renamed
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: alter3_db@alter3_like_renamed
 POSTHOOK: query: DESCRIBE EXTENDED alter3_like_renamed
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: alter3_db@alter3_like_renamed
 POSTHOOK: Lineage: alter3 PARTITION(pcol1=test_part:,pcol2=test_part:).col1 SIMPLE [(alter3_src)alter3_src.FieldSchema(name:col1, type:string, comment:null), ]
 POSTHOOK: Lineage: alter3 PARTITION(pcol1=test_part:,pcol2=test_part:).col1 SIMPLE [(alter3_src)alter3_src.FieldSchema(name:col1, type:string, comment:null), ]
 POSTHOOK: Lineage: alter3_like PARTITION(pcol1=test_part:,pcol2=test_part:).col1 SIMPLE [(alter3_src)alter3_src.FieldSchema(name:col1, type:string, comment:null), ]
diff --git a/ql/src/test/results/clientpositive/alter4.q.out b/ql/src/test/results/clientpositive/alter4.q.out
index a616929451..50f1a48035 100644
--- a/ql/src/test/results/clientpositive/alter4.q.out
+++ b/ql/src/test/results/clientpositive/alter4.q.out
@@ -7,8 +7,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@set_bucketing_test
 PREHOOK: query: DESCRIBE EXTENDED set_bucketing_test
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@set_bucketing_test
 POSTHOOK: query: DESCRIBE EXTENDED set_bucketing_test
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@set_bucketing_test
 key                 	int                 	                    
 value               	string              	                    
 	 	 
@@ -23,8 +25,10 @@ POSTHOOK: Input: default@set_bucketing_test
 POSTHOOK: Output: default@set_bucketing_test
 PREHOOK: query: DESCRIBE EXTENDED set_bucketing_test
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@set_bucketing_test
 POSTHOOK: query: DESCRIBE EXTENDED set_bucketing_test
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@set_bucketing_test
 key                 	int                 	                    
 value               	string              	                    
 	 	 
@@ -77,8 +81,10 @@ POSTHOOK: Output: alter4_db@set_bucketing_test
 POSTHOOK: Output: database:alter4_db
 PREHOOK: query: DESCRIBE EXTENDED set_bucketing_test
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: alter4_db@set_bucketing_test
 POSTHOOK: query: DESCRIBE EXTENDED set_bucketing_test
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: alter4_db@set_bucketing_test
 key                 	int                 	                    
 value               	string              	                    
 	 	 
@@ -93,8 +99,10 @@ POSTHOOK: Input: alter4_db@set_bucketing_test
 POSTHOOK: Output: alter4_db@set_bucketing_test
 PREHOOK: query: DESCRIBE EXTENDED set_bucketing_test
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: alter4_db@set_bucketing_test
 POSTHOOK: query: DESCRIBE EXTENDED set_bucketing_test
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: alter4_db@set_bucketing_test
 key                 	int                 	                    
 value               	string              	                    
 	 	 
diff --git a/ql/src/test/results/clientpositive/alter5.q.out b/ql/src/test/results/clientpositive/alter5.q.out
index da8e1887ab..fc461c5471 100644
--- a/ql/src/test/results/clientpositive/alter5.q.out
+++ b/ql/src/test/results/clientpositive/alter5.q.out
@@ -47,8 +47,10 @@ POSTHOOK: Output: default@alter5
 POSTHOOK: Output: default@alter5@dt=a
 PREHOOK: query: describe extended alter5 partition (dt='a')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@alter5
 POSTHOOK: query: describe extended alter5 partition (dt='a')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@alter5
 col1                	string              	                    
 dt                  	string              	                    
 	 	 
@@ -86,8 +88,10 @@ POSTHOOK: Lineage: alter5 PARTITION(dt=a).col1 SIMPLE [(alter5_src)alter5_src.Fi
 6	a
 PREHOOK: query: describe extended alter5 partition (dt='a')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@alter5
 POSTHOOK: query: describe extended alter5 partition (dt='a')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@alter5
 POSTHOOK: Lineage: alter5 PARTITION(dt=a).col1 SIMPLE [(alter5_src)alter5_src.FieldSchema(name:col1, type:string, comment:null), ]
 col1                	string              	                    
 dt                  	string              	                    
@@ -188,8 +192,10 @@ POSTHOOK: Output: alter5_db@alter5@dt=a
 POSTHOOK: Lineage: alter5 PARTITION(dt=a).col1 SIMPLE [(alter5_src)alter5_src.FieldSchema(name:col1, type:string, comment:null), ]
 PREHOOK: query: describe extended alter5 partition (dt='a')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: alter5_db@alter5
 POSTHOOK: query: describe extended alter5 partition (dt='a')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: alter5_db@alter5
 POSTHOOK: Lineage: alter5 PARTITION(dt=a).col1 SIMPLE [(alter5_src)alter5_src.FieldSchema(name:col1, type:string, comment:null), ]
 col1                	string              	                    
 dt                  	string              	                    
@@ -230,8 +236,10 @@ POSTHOOK: Lineage: alter5 PARTITION(dt=a).col1 SIMPLE [(alter5_src)alter5_src.Fi
 6	a
 PREHOOK: query: describe extended alter5 partition (dt='a')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: alter5_db@alter5
 POSTHOOK: query: describe extended alter5 partition (dt='a')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: alter5_db@alter5
 POSTHOOK: Lineage: alter5 PARTITION(dt=a).col1 SIMPLE [(alter5_src)alter5_src.FieldSchema(name:col1, type:string, comment:null), ]
 POSTHOOK: Lineage: alter5 PARTITION(dt=a).col1 SIMPLE [(alter5_src)alter5_src.FieldSchema(name:col1, type:string, comment:null), ]
 col1                	string              	                    
diff --git a/ql/src/test/results/clientpositive/alter_index.q.out b/ql/src/test/results/clientpositive/alter_index.q.out
index b7786cea00..7a8c7edee0 100644
--- a/ql/src/test/results/clientpositive/alter_index.q.out
+++ b/ql/src/test/results/clientpositive/alter_index.q.out
@@ -9,8 +9,10 @@ POSTHOOK: type: CREATEINDEX
 POSTHOOK: Output: default@default__src_src_index_8__
 PREHOOK: query: desc extended default__src_src_index_8__
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@default__src_src_index_8__
 POSTHOOK: query: desc extended default__src_src_index_8__
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@default__src_src_index_8__
 key                 	string              	default             
 _bucketname         	string              	                    
 _offsets            	array<bigint>       	                    
@@ -22,8 +24,10 @@ POSTHOOK: query: alter index src_index_8 on src set IDXPROPERTIES ("prop1"="val1
 POSTHOOK: type: ALTERINDEX_PROPS
 PREHOOK: query: desc extended default__src_src_index_8__
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@default__src_src_index_8__
 POSTHOOK: query: desc extended default__src_src_index_8__
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@default__src_src_index_8__
 key                 	string              	default             
 _bucketname         	string              	                    
 _offsets            	array<bigint>       	                    
diff --git a/ql/src/test/results/clientpositive/alter_merge_2.q.out b/ql/src/test/results/clientpositive/alter_merge_2.q.out
index e5244d8072..2b41a1760a 100644
--- a/ql/src/test/results/clientpositive/alter_merge_2.q.out
+++ b/ql/src/test/results/clientpositive/alter_merge_2.q.out
@@ -14,8 +14,10 @@ POSTHOOK: Output: default@src_rc_merge_test_part
 POSTHOOK: Output: default@src_rc_merge_test_part@ds=2012-01-03/ts=2012-01-03+14%3A46%3A31
 PREHOOK: query: desc extended src_rc_merge_test_part partition (ds='2012-01-03', ts='2012-01-03+14:46:31')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@src_rc_merge_test_part
 POSTHOOK: query: desc extended src_rc_merge_test_part partition (ds='2012-01-03', ts='2012-01-03+14:46:31')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@src_rc_merge_test_part
 key                 	int                 	                    
 value               	string              	                    
 ds                  	string              	                    
diff --git a/ql/src/test/results/clientpositive/alter_merge_stats.q.out b/ql/src/test/results/clientpositive/alter_merge_stats.q.out
index ec2299571d..49c5556629 100644
--- a/ql/src/test/results/clientpositive/alter_merge_stats.q.out
+++ b/ql/src/test/results/clientpositive/alter_merge_stats.q.out
@@ -48,8 +48,10 @@ minFileSize:206
 
 PREHOOK: query: desc extended src_rc_merge_test_stat
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@src_rc_merge_test_stat
 POSTHOOK: query: desc extended src_rc_merge_test_stat
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@src_rc_merge_test_stat
 key                 	int                 	                    
 value               	string              	                    
 	 	 
@@ -64,8 +66,10 @@ POSTHOOK: Input: default@src_rc_merge_test_stat
 POSTHOOK: Output: default@src_rc_merge_test_stat
 PREHOOK: query: desc extended src_rc_merge_test_stat
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@src_rc_merge_test_stat
 POSTHOOK: query: desc extended src_rc_merge_test_stat
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@src_rc_merge_test_stat
 key                 	int                 	                    
 value               	string              	                    
 	 	 
@@ -97,8 +101,10 @@ minFileSize:239
 
 PREHOOK: query: desc extended src_rc_merge_test_stat
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@src_rc_merge_test_stat
 POSTHOOK: query: desc extended src_rc_merge_test_stat
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@src_rc_merge_test_stat
 key                 	int                 	                    
 value               	string              	                    
 	 	 
@@ -160,8 +166,10 @@ minFileSize:206
 
 PREHOOK: query: desc extended src_rc_merge_test_part_stat
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@src_rc_merge_test_part_stat
 POSTHOOK: query: desc extended src_rc_merge_test_part_stat
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@src_rc_merge_test_part_stat
 key                 	int                 	                    
 value               	string              	                    
 ds                  	string              	                    
@@ -186,8 +194,10 @@ POSTHOOK: Output: default@src_rc_merge_test_part_stat
 POSTHOOK: Output: default@src_rc_merge_test_part_stat@ds=2011
 PREHOOK: query: desc extended src_rc_merge_test_part_stat
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@src_rc_merge_test_part_stat
 POSTHOOK: query: desc extended src_rc_merge_test_part_stat
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@src_rc_merge_test_part_stat
 key                 	int                 	                    
 value               	string              	                    
 ds                  	string              	                    
@@ -225,8 +235,10 @@ minFileSize:239
 
 PREHOOK: query: desc extended src_rc_merge_test_part_stat
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@src_rc_merge_test_part_stat
 POSTHOOK: query: desc extended src_rc_merge_test_part_stat
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@src_rc_merge_test_part_stat
 key                 	int                 	                    
 value               	string              	                    
 ds                  	string              	                    
diff --git a/ql/src/test/results/clientpositive/alter_numbuckets_partitioned_table.q.out b/ql/src/test/results/clientpositive/alter_numbuckets_partitioned_table.q.out
index d68534f24e..939130ea90 100644
--- a/ql/src/test/results/clientpositive/alter_numbuckets_partitioned_table.q.out
+++ b/ql/src/test/results/clientpositive/alter_numbuckets_partitioned_table.q.out
@@ -17,8 +17,10 @@ POSTHOOK: Input: default@tst1
 POSTHOOK: Output: default@tst1
 PREHOOK: query: describe formatted tst1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tst1
 POSTHOOK: query: describe formatted tst1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tst1
 # col_name            	data_type           	comment             
 	 	 
 key                 	string              	                    
@@ -61,8 +63,10 @@ POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:ke
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: describe formatted tst1 partition (ds = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tst1
 POSTHOOK: query: describe formatted tst1 partition (ds = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tst1
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 # col_name            	data_type           	comment             
@@ -128,8 +132,10 @@ POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:ke
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: describe formatted tst1 partition (ds = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tst1
 POSTHOOK: query: describe formatted tst1 partition (ds = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tst1
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -171,8 +177,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: describe formatted tst1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tst1
 POSTHOOK: query: describe formatted tst1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tst1
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -224,8 +232,10 @@ POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:ke
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: describe formatted tst1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tst1
 POSTHOOK: query: describe formatted tst1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tst1
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -262,8 +272,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: describe formatted tst1 partition (ds = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tst1
 POSTHOOK: query: describe formatted tst1 partition (ds = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tst1
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -317,8 +329,10 @@ POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:ke
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: describe formatted tst1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tst1
 POSTHOOK: query: describe formatted tst1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tst1
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -355,8 +369,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: describe formatted tst1 partition (ds = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tst1
 POSTHOOK: query: describe formatted tst1 partition (ds = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tst1
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -415,8 +431,10 @@ POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:ke
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: describe formatted tst1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tst1
 POSTHOOK: query: describe formatted tst1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tst1
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -469,8 +487,10 @@ POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:ke
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: describe formatted tst1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tst1
 POSTHOOK: query: describe formatted tst1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tst1
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -523,8 +543,10 @@ POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:ke
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: describe formatted tst1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tst1
 POSTHOOK: query: describe formatted tst1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tst1
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -577,8 +599,10 @@ POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:ke
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: describe formatted tst1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tst1
 POSTHOOK: query: describe formatted tst1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tst1
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/alter_numbuckets_partitioned_table2.q.out b/ql/src/test/results/clientpositive/alter_numbuckets_partitioned_table2.q.out
index 0c74e6fc60..89cda0bd44 100644
--- a/ql/src/test/results/clientpositive/alter_numbuckets_partitioned_table2.q.out
+++ b/ql/src/test/results/clientpositive/alter_numbuckets_partitioned_table2.q.out
@@ -15,8 +15,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@tst1
 PREHOOK: query: DESCRIBE FORMATTED tst1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tst1
 POSTHOOK: query: DESCRIBE FORMATTED tst1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tst1
 # col_name            	data_type           	comment             
 	 	 
 key                 	string              	                    
@@ -59,8 +61,10 @@ POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:ke
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED tst1 PARTITION (ds = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tst1
 POSTHOOK: query: DESCRIBE FORMATTED tst1 PARTITION (ds = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tst1
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 # col_name            	data_type           	comment             
@@ -112,8 +116,10 @@ POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:ke
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED tst1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tst1
 POSTHOOK: query: DESCRIBE FORMATTED tst1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tst1
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 # col_name            	data_type           	comment             
@@ -160,8 +166,10 @@ POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:ke
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED tst1 PARTITION (ds = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tst1
 POSTHOOK: query: DESCRIBE FORMATTED tst1 PARTITION (ds = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tst1
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -217,8 +225,10 @@ POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:ke
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED tst1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tst1
 POSTHOOK: query: DESCRIBE FORMATTED tst1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tst1
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -269,8 +279,10 @@ POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:ke
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED tst1 PARTITION (ds = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tst1
 POSTHOOK: query: DESCRIBE FORMATTED tst1 PARTITION (ds = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tst1
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -330,8 +342,10 @@ POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:ke
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED tst1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tst1
 POSTHOOK: query: DESCRIBE FORMATTED tst1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tst1
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -386,8 +400,10 @@ POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:ke
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED tst1 PARTITION (ds = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tst1
 POSTHOOK: query: DESCRIBE FORMATTED tst1 PARTITION (ds = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tst1
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -451,8 +467,10 @@ POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:ke
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED tst1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tst1
 POSTHOOK: query: DESCRIBE FORMATTED tst1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tst1
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -511,8 +529,10 @@ POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:ke
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED tst1 PARTITION (ds = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tst1
 POSTHOOK: query: DESCRIBE FORMATTED tst1 PARTITION (ds = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tst1
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -580,8 +600,10 @@ POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:ke
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED tst1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tst1
 POSTHOOK: query: DESCRIBE FORMATTED tst1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tst1
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -644,8 +666,10 @@ POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:ke
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED tst1 PARTITION (ds = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tst1
 POSTHOOK: query: DESCRIBE FORMATTED tst1 PARTITION (ds = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tst1
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -717,8 +741,10 @@ POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:ke
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED tst1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tst1
 POSTHOOK: query: DESCRIBE FORMATTED tst1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tst1
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -785,8 +811,10 @@ POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:ke
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED tst1 PARTITION (ds = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tst1
 POSTHOOK: query: DESCRIBE FORMATTED tst1 PARTITION (ds = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tst1
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -862,8 +890,10 @@ POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:ke
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED tst1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tst1
 POSTHOOK: query: DESCRIBE FORMATTED tst1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tst1
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -934,8 +964,10 @@ POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:ke
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED tst1 PARTITION (ds = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tst1
 POSTHOOK: query: DESCRIBE FORMATTED tst1 PARTITION (ds = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tst1
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -1015,8 +1047,10 @@ POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:ke
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED tst1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tst1
 POSTHOOK: query: DESCRIBE FORMATTED tst1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tst1
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -1091,8 +1125,10 @@ POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:ke
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED tst1 PARTITION (ds = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tst1
 POSTHOOK: query: DESCRIBE FORMATTED tst1 PARTITION (ds = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tst1
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/alter_partition_clusterby_sortby.q.out b/ql/src/test/results/clientpositive/alter_partition_clusterby_sortby.q.out
index 8121057b13..05e7d9f17b 100644
--- a/ql/src/test/results/clientpositive/alter_partition_clusterby_sortby.q.out
+++ b/ql/src/test/results/clientpositive/alter_partition_clusterby_sortby.q.out
@@ -27,8 +27,10 @@ POSTHOOK: Input: default@alter_table_partition_clusterby_sortby@c=abc
 POSTHOOK: Output: default@alter_table_partition_clusterby_sortby@c=abc
 PREHOOK: query: desc formatted alter_table_partition_clusterby_sortby partition(c='abc')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@alter_table_partition_clusterby_sortby
 POSTHOOK: query: desc formatted alter_table_partition_clusterby_sortby partition(c='abc')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@alter_table_partition_clusterby_sortby
 # col_name            	data_type           	comment             
 	 	 
 a                   	int                 	                    
@@ -80,8 +82,10 @@ POSTHOOK: Input: default@alter_table_partition_clusterby_sortby@c=abc
 POSTHOOK: Output: default@alter_table_partition_clusterby_sortby@c=abc
 PREHOOK: query: desc formatted alter_table_partition_clusterby_sortby partition(c='abc')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@alter_table_partition_clusterby_sortby
 POSTHOOK: query: desc formatted alter_table_partition_clusterby_sortby partition(c='abc')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@alter_table_partition_clusterby_sortby
 # col_name            	data_type           	comment             
 	 	 
 a                   	int                 	                    
@@ -133,8 +137,10 @@ POSTHOOK: Input: default@alter_table_partition_clusterby_sortby@c=abc
 POSTHOOK: Output: default@alter_table_partition_clusterby_sortby@c=abc
 PREHOOK: query: desc formatted alter_table_partition_clusterby_sortby partition(c='abc')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@alter_table_partition_clusterby_sortby
 POSTHOOK: query: desc formatted alter_table_partition_clusterby_sortby partition(c='abc')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@alter_table_partition_clusterby_sortby
 # col_name            	data_type           	comment             
 	 	 
 a                   	int                 	                    
@@ -175,10 +181,12 @@ PREHOOK: query: -- Table properties should be unchanged
 
 desc formatted alter_table_partition_clusterby_sortby
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@alter_table_partition_clusterby_sortby
 POSTHOOK: query: -- Table properties should be unchanged
 
 desc formatted alter_table_partition_clusterby_sortby
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@alter_table_partition_clusterby_sortby
 # col_name            	data_type           	comment             
 	 	 
 a                   	int                 	                    
diff --git a/ql/src/test/results/clientpositive/alter_partition_coltype.q.out b/ql/src/test/results/clientpositive/alter_partition_coltype.q.out
index 3c39211a1e..45d8b1451a 100644
--- a/ql/src/test/results/clientpositive/alter_partition_coltype.q.out
+++ b/ql/src/test/results/clientpositive/alter_partition_coltype.q.out
@@ -21,8 +21,10 @@ POSTHOOK: Lineage: alter_coltype PARTITION(dt=100x,ts=6:30pm).key SIMPLE [(src1)
 POSTHOOK: Lineage: alter_coltype PARTITION(dt=100x,ts=6:30pm).value SIMPLE [(src1)src1.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: desc alter_coltype
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@alter_coltype
 POSTHOOK: query: desc alter_coltype
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@alter_coltype
 POSTHOOK: Lineage: alter_coltype PARTITION(dt=100x,ts=6:30pm).key SIMPLE [(src1)src1.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: alter_coltype PARTITION(dt=100x,ts=6:30pm).value SIMPLE [(src1)src1.FieldSchema(name:value, type:string, comment:default), ]
 key                 	string              	                    
diff --git a/ql/src/test/results/clientpositive/alter_partition_format_loc.q.out b/ql/src/test/results/clientpositive/alter_partition_format_loc.q.out
index fd4ee99df6..37bda45651 100644
--- a/ql/src/test/results/clientpositive/alter_partition_format_loc.q.out
+++ b/ql/src/test/results/clientpositive/alter_partition_format_loc.q.out
@@ -7,8 +7,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@alter_partition_format_test
 PREHOOK: query: desc extended alter_partition_format_test
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@alter_partition_format_test
 POSTHOOK: query: desc extended alter_partition_format_test
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@alter_partition_format_test
 key                 	int                 	                    
 value               	string              	                    
 	 	 
@@ -23,8 +25,10 @@ POSTHOOK: Input: default@alter_partition_format_test
 POSTHOOK: Output: default@alter_partition_format_test
 PREHOOK: query: desc extended alter_partition_format_test
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@alter_partition_format_test
 POSTHOOK: query: desc extended alter_partition_format_test
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@alter_partition_format_test
 key                 	int                 	                    
 value               	string              	                    
 	 	 
@@ -39,8 +43,10 @@ POSTHOOK: Output: default@alter_partition_format_test
 #### A masked pattern was here ####
 PREHOOK: query: desc extended alter_partition_format_test
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@alter_partition_format_test
 POSTHOOK: query: desc extended alter_partition_format_test
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@alter_partition_format_test
 key                 	int                 	                    
 value               	string              	                    
 	 	 
@@ -71,8 +77,10 @@ POSTHOOK: Output: default@alter_partition_format_test
 POSTHOOK: Output: default@alter_partition_format_test@ds=2010
 PREHOOK: query: desc extended alter_partition_format_test partition(ds='2010')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@alter_partition_format_test
 POSTHOOK: query: desc extended alter_partition_format_test partition(ds='2010')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@alter_partition_format_test
 key                 	int                 	                    
 value               	string              	                    
 ds                  	string              	                    
@@ -94,8 +102,10 @@ POSTHOOK: Input: default@alter_partition_format_test@ds=2010
 POSTHOOK: Output: default@alter_partition_format_test@ds=2010
 PREHOOK: query: desc extended alter_partition_format_test partition(ds='2010')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@alter_partition_format_test
 POSTHOOK: query: desc extended alter_partition_format_test partition(ds='2010')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@alter_partition_format_test
 key                 	int                 	                    
 value               	string              	                    
 ds                  	string              	                    
@@ -117,8 +127,10 @@ POSTHOOK: Output: default@alter_partition_format_test@ds=2010
 #### A masked pattern was here ####
 PREHOOK: query: desc extended alter_partition_format_test partition(ds='2010')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@alter_partition_format_test
 POSTHOOK: query: desc extended alter_partition_format_test partition(ds='2010')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@alter_partition_format_test
 key                 	int                 	                    
 value               	string              	                    
 ds                  	string              	                    
@@ -131,8 +143,10 @@ ds                  	string
 #### A masked pattern was here ####
 PREHOOK: query: desc extended alter_partition_format_test
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@alter_partition_format_test
 POSTHOOK: query: desc extended alter_partition_format_test
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@alter_partition_format_test
 key                 	int                 	                    
 value               	string              	                    
 ds                  	string              	                    
@@ -153,8 +167,10 @@ POSTHOOK: Input: default@alter_partition_format_test
 POSTHOOK: Output: default@alter_partition_format_test
 PREHOOK: query: desc extended alter_partition_format_test
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@alter_partition_format_test
 POSTHOOK: query: desc extended alter_partition_format_test
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@alter_partition_format_test
 key                 	int                 	                    
 value               	string              	                    
 ds                  	string              	                    
@@ -175,8 +191,10 @@ POSTHOOK: Output: default@alter_partition_format_test
 #### A masked pattern was here ####
 PREHOOK: query: desc extended alter_partition_format_test
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@alter_partition_format_test
 POSTHOOK: query: desc extended alter_partition_format_test
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@alter_partition_format_test
 key                 	int                 	                    
 value               	string              	                    
 ds                  	string              	                    
diff --git a/ql/src/test/results/clientpositive/alter_partition_with_whitelist.q.out b/ql/src/test/results/clientpositive/alter_partition_with_whitelist.q.out
index e5b112d796..7224132a28 100644
--- a/ql/src/test/results/clientpositive/alter_partition_with_whitelist.q.out
+++ b/ql/src/test/results/clientpositive/alter_partition_with_whitelist.q.out
@@ -11,8 +11,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@part_whitelist_test
 PREHOOK: query: SHOW PARTITIONS part_whitelist_test
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@part_whitelist_test
 POSTHOOK: query: SHOW PARTITIONS part_whitelist_test
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@part_whitelist_test
 PREHOOK: query: ALTER TABLE part_whitelist_test ADD PARTITION (ds='Part')
 PREHOOK: type: ALTERTABLE_ADDPARTS
 PREHOOK: Output: default@part_whitelist_test
diff --git a/ql/src/test/results/clientpositive/alter_rename_partition.q.out b/ql/src/test/results/clientpositive/alter_rename_partition.q.out
index 239df5a4fa..ebd427311f 100644
--- a/ql/src/test/results/clientpositive/alter_rename_partition.q.out
+++ b/ql/src/test/results/clientpositive/alter_rename_partition.q.out
@@ -82,8 +82,10 @@ POSTHOOK: Output: default@alter_rename_partition@pcol1=old_part1%3A/pcol2=old_pa
 POSTHOOK: Lineage: alter_rename_partition PARTITION(pcol1=old_part1:,pcol2=old_part2:).col1 SIMPLE [(alter_rename_partition_src)alter_rename_partition_src.FieldSchema(name:col1, type:string, comment:null), ]
 PREHOOK: query: SHOW PARTITIONS alter_rename_partition
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@alter_rename_partition
 POSTHOOK: query: SHOW PARTITIONS alter_rename_partition
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@alter_rename_partition
 POSTHOOK: Lineage: alter_rename_partition PARTITION(pcol1=old_part1:,pcol2=old_part2:).col1 SIMPLE [(alter_rename_partition_src)alter_rename_partition_src.FieldSchema(name:col1, type:string, comment:null), ]
 pcol1=new_part1%3A/pcol2=new_part2%3A
 PREHOOK: query: select * from alter_rename_partition where pcol1='old_part1:' and pcol2='old_part2:'
@@ -232,8 +234,10 @@ POSTHOOK: Lineage: alter_rename_partition PARTITION(pcol1=old_part1:,pcol2=old_p
 POSTHOOK: Lineage: alter_rename_partition PARTITION(pcol1=old_part1:,pcol2=old_part2:).col1 SIMPLE [(alter_rename_partition_src)alter_rename_partition_src.FieldSchema(name:col1, type:string, comment:null), ]
 PREHOOK: query: SHOW PARTITIONS alter_rename_partition
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: alter_rename_partition_db@alter_rename_partition
 POSTHOOK: query: SHOW PARTITIONS alter_rename_partition
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: alter_rename_partition_db@alter_rename_partition
 POSTHOOK: Lineage: alter_rename_partition PARTITION(pcol1=old_part1:,pcol2=old_part2:).col1 SIMPLE [(alter_rename_partition_src)alter_rename_partition_src.FieldSchema(name:col1, type:string, comment:null), ]
 POSTHOOK: Lineage: alter_rename_partition PARTITION(pcol1=old_part1:,pcol2=old_part2:).col1 SIMPLE [(alter_rename_partition_src)alter_rename_partition_src.FieldSchema(name:col1, type:string, comment:null), ]
 pcol1=new_part1%3A/pcol2=new_part2%3A
diff --git a/ql/src/test/results/clientpositive/alter_skewed_table.q.out b/ql/src/test/results/clientpositive/alter_skewed_table.q.out
index f0af6ba9b5..5cf963e860 100644
--- a/ql/src/test/results/clientpositive/alter_skewed_table.q.out
+++ b/ql/src/test/results/clientpositive/alter_skewed_table.q.out
@@ -7,8 +7,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@original
 PREHOOK: query: describe formatted original
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@original
 POSTHOOK: query: describe formatted original
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@original
 # col_name            	data_type           	comment             
 	 	 
 key                 	string              	                    
@@ -44,8 +46,10 @@ POSTHOOK: Input: default@original
 POSTHOOK: Output: default@original
 PREHOOK: query: describe formatted original
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@original
 POSTHOOK: query: describe formatted original
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@original
 # col_name            	data_type           	comment             
 	 	 
 key                 	string              	                    
@@ -96,8 +100,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@original2
 PREHOOK: query: describe formatted original2
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@original2
 POSTHOOK: query: describe formatted original2
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@original2
 # col_name            	data_type           	comment             
 	 	 
 key                 	string              	                    
@@ -133,8 +139,10 @@ POSTHOOK: Input: default@original2
 POSTHOOK: Output: default@original2
 PREHOOK: query: describe formatted original2
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@original2
 POSTHOOK: query: describe formatted original2
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@original2
 # col_name            	data_type           	comment             
 	 	 
 key                 	string              	                    
@@ -185,8 +193,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@original3
 PREHOOK: query: describe formatted original3
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@original3
 POSTHOOK: query: describe formatted original3
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@original3
 # col_name            	data_type           	comment             
 	 	 
 key                 	string              	                    
@@ -224,8 +234,10 @@ POSTHOOK: Input: default@original3
 POSTHOOK: Output: default@original3
 PREHOOK: query: describe formatted original3
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@original3
 POSTHOOK: query: describe formatted original3
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@original3
 # col_name            	data_type           	comment             
 	 	 
 key                 	string              	                    
diff --git a/ql/src/test/results/clientpositive/alter_table_not_sorted.q.out b/ql/src/test/results/clientpositive/alter_table_not_sorted.q.out
index a9ba843cb0..0e496e3fe8 100644
--- a/ql/src/test/results/clientpositive/alter_table_not_sorted.q.out
+++ b/ql/src/test/results/clientpositive/alter_table_not_sorted.q.out
@@ -7,8 +7,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@alter_table_not_sorted
 PREHOOK: query: desc formatted alter_table_not_sorted
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@alter_table_not_sorted
 POSTHOOK: query: desc formatted alter_table_not_sorted
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@alter_table_not_sorted
 # col_name            	data_type           	comment             
 	 	 
 a                   	int                 	                    
@@ -45,8 +47,10 @@ POSTHOOK: Input: default@alter_table_not_sorted
 POSTHOOK: Output: default@alter_table_not_sorted
 PREHOOK: query: desc formatted alter_table_not_sorted
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@alter_table_not_sorted
 POSTHOOK: query: desc formatted alter_table_not_sorted
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@alter_table_not_sorted
 # col_name            	data_type           	comment             
 	 	 
 a                   	int                 	                    
diff --git a/ql/src/test/results/clientpositive/alter_table_serde.q.out b/ql/src/test/results/clientpositive/alter_table_serde.q.out
index 491826a279..655e084280 100644
--- a/ql/src/test/results/clientpositive/alter_table_serde.q.out
+++ b/ql/src/test/results/clientpositive/alter_table_serde.q.out
@@ -9,8 +9,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@test_table
 PREHOOK: query: describe extended test_table
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: describe extended test_table
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 id                  	int                 	                    
 query               	string              	                    
 name                	string              	                    
@@ -26,8 +28,10 @@ POSTHOOK: Input: default@test_table
 POSTHOOK: Output: default@test_table
 PREHOOK: query: describe extended test_table
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: describe extended test_table
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 id                  	int                 	                    
 query               	string              	                    
 name                	string              	                    
@@ -43,8 +47,10 @@ POSTHOOK: Input: default@test_table
 POSTHOOK: Output: default@test_table
 PREHOOK: query: describe extended test_table
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: describe extended test_table
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 id                  	int                 	                    
 query               	string              	                    
 name                	string              	                    
@@ -76,8 +82,10 @@ POSTHOOK: Output: default@test_table
 POSTHOOK: Output: default@test_table@dt=2011
 PREHOOK: query: describe extended test_table partition (dt='2011')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: describe extended test_table partition (dt='2011')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 id                  	int                 	                    
 query               	string              	                    
 name                	string              	                    
@@ -99,8 +107,10 @@ POSTHOOK: Input: default@test_table
 POSTHOOK: Output: default@test_table
 PREHOOK: query: describe extended test_table partition (dt='2011')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: describe extended test_table partition (dt='2011')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 id                  	int                 	                    
 query               	string              	                    
 name                	string              	                    
@@ -122,8 +132,10 @@ POSTHOOK: Input: default@test_table
 POSTHOOK: Output: default@test_table
 PREHOOK: query: describe extended test_table partition (dt='2011')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: describe extended test_table partition (dt='2011')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 id                  	int                 	                    
 query               	string              	                    
 name                	string              	                    
@@ -150,8 +162,10 @@ POSTHOOK: Input: default@test_table@dt=2011
 POSTHOOK: Output: default@test_table@dt=2011
 PREHOOK: query: describe extended test_table partition (dt='2011')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: describe extended test_table partition (dt='2011')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 id                  	int                 	                    
 query               	string              	                    
 name                	string              	                    
@@ -174,8 +188,10 @@ POSTHOOK: Input: default@test_table@dt=2011
 POSTHOOK: Output: default@test_table@dt=2011
 PREHOOK: query: describe extended test_table partition (dt='2011')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: describe extended test_table partition (dt='2011')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 id                  	int                 	                    
 query               	string              	                    
 name                	string              	                    
diff --git a/ql/src/test/results/clientpositive/alter_table_serde2.q.out b/ql/src/test/results/clientpositive/alter_table_serde2.q.out
index ec0e6472c8..bc1589b830 100644
--- a/ql/src/test/results/clientpositive/alter_table_serde2.q.out
+++ b/ql/src/test/results/clientpositive/alter_table_serde2.q.out
@@ -13,8 +13,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@tst1
 PREHOOK: query: DESCRIBE FORMATTED tst1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tst1
 POSTHOOK: query: DESCRIBE FORMATTED tst1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tst1
 # col_name            	data_type           	comment             
 	 	 
 key                 	string              	                    
@@ -57,8 +59,10 @@ POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:ke
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED tst1 PARTITION (ds = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tst1
 POSTHOOK: query: DESCRIBE FORMATTED tst1 PARTITION (ds = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tst1
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 # col_name            	data_type           	comment             
@@ -112,8 +116,10 @@ POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:ke
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED tst1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tst1
 POSTHOOK: query: DESCRIBE FORMATTED tst1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tst1
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 # col_name            	data_type           	comment             
@@ -161,8 +167,10 @@ POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:ke
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED tst1 PARTITION (ds = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tst1
 POSTHOOK: query: DESCRIBE FORMATTED tst1 PARTITION (ds = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tst1
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: tst1 PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/alter_view_as_select.q.out b/ql/src/test/results/clientpositive/alter_view_as_select.q.out
index 86d8f602e9..53a6b37364 100644
--- a/ql/src/test/results/clientpositive/alter_view_as_select.q.out
+++ b/ql/src/test/results/clientpositive/alter_view_as_select.q.out
@@ -11,8 +11,10 @@ POSTHOOK: Input: default@srcpart
 POSTHOOK: Output: default@testView
 PREHOOK: query: DESCRIBE FORMATTED testView
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@testview
 POSTHOOK: query: DESCRIBE FORMATTED testView
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@testview
 # col_name            	data_type           	comment             
 	 	 
 key                 	string              	                    
@@ -50,8 +52,10 @@ POSTHOOK: Input: default@src
 POSTHOOK: Output: default@testview
 PREHOOK: query: DESCRIBE FORMATTED testView
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@testview
 POSTHOOK: query: DESCRIBE FORMATTED testView
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@testview
 # col_name            	data_type           	comment             
 	 	 
 value               	string              	                    
@@ -94,8 +98,10 @@ POSTHOOK: Input: default@src
 POSTHOOK: Output: default@testview
 PREHOOK: query: DESCRIBE FORMATTED testView
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@testview
 POSTHOOK: query: DESCRIBE FORMATTED testView
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@testview
 # col_name            	data_type           	comment             
 	 	 
 key                 	string              	                    
diff --git a/ql/src/test/results/clientpositive/alter_view_rename.q.out b/ql/src/test/results/clientpositive/alter_view_rename.q.out
index 4854ff3d39..2e142a3d0e 100644
--- a/ql/src/test/results/clientpositive/alter_view_rename.q.out
+++ b/ql/src/test/results/clientpositive/alter_view_rename.q.out
@@ -14,8 +14,10 @@ POSTHOOK: Input: default@invites
 POSTHOOK: Output: default@view1
 PREHOOK: query: DESCRIBE EXTENDED view1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@view1
 POSTHOOK: query: DESCRIBE EXTENDED view1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@view1
 foo                 	int                 	                    
 bar                 	string              	                    
 ds                  	string              	                    
@@ -32,8 +34,10 @@ POSTHOOK: Output: default@view1
 POSTHOOK: Output: default@view2
 PREHOOK: query: DESCRIBE EXTENDED view2
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@view2
 POSTHOOK: query: DESCRIBE EXTENDED view2
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@view2
 foo                 	int                 	                    
 bar                 	string              	                    
 ds                  	string              	                    
diff --git a/ql/src/test/results/clientpositive/authorization_7.q.out b/ql/src/test/results/clientpositive/authorization_7.q.out
index 282ae43085..1931ec8e91 100644
--- a/ql/src/test/results/clientpositive/authorization_7.q.out
+++ b/ql/src/test/results/clientpositive/authorization_7.q.out
@@ -11,8 +11,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@src_authorization_7
 PREHOOK: query: DESCRIBE src_authorization_7
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@src_authorization_7
 POSTHOOK: query: DESCRIBE src_authorization_7
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@src_authorization_7
 key                 	int                 	                    
 value               	string              	                    
 PREHOOK: query: DROP TABLE  src_authorization_7
@@ -40,8 +42,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@src_authorization_7
 PREHOOK: query: DESCRIBE src_authorization_7
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@src_authorization_7
 POSTHOOK: query: DESCRIBE src_authorization_7
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@src_authorization_7
 key                 	int                 	                    
 value               	string              	                    
 PREHOOK: query: DROP TABLE  src_authorization_7
diff --git a/ql/src/test/results/clientpositive/authorization_8.q.out b/ql/src/test/results/clientpositive/authorization_8.q.out
index f1c8ae25e8..f97c38f434 100644
--- a/ql/src/test/results/clientpositive/authorization_8.q.out
+++ b/ql/src/test/results/clientpositive/authorization_8.q.out
@@ -18,8 +18,10 @@ POSTHOOK: Input: default@tbl_j5jbymsx8e
 POSTHOOK: Output: default@view_j5jbymsx8e_1
 PREHOOK: query: DESCRIBE view_j5jbymsx8e_1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@view_j5jbymsx8e_1
 POSTHOOK: query: DESCRIBE view_j5jbymsx8e_1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@view_j5jbymsx8e_1
 key                 	int                 	                    
 value               	string              	                    
 ds                  	string              	                    
diff --git a/ql/src/test/results/clientpositive/autogen_colalias.q.out b/ql/src/test/results/clientpositive/autogen_colalias.q.out
index 7de1b5ad9b..fa5a7b65db 100644
--- a/ql/src/test/results/clientpositive/autogen_colalias.q.out
+++ b/ql/src/test/results/clientpositive/autogen_colalias.q.out
@@ -19,8 +19,10 @@ POSTHOOK: Input: default@src
 POSTHOOK: Output: default@dest_grouped_old1
 PREHOOK: query: describe dest_grouped_old1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@dest_grouped_old1
 POSTHOOK: query: describe dest_grouped_old1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@dest_grouped_old1
 _c0                 	int                 	                    
 zz                  	int                 	                    
 key                 	string              	                    
@@ -40,8 +42,10 @@ POSTHOOK: Input: default@src
 POSTHOOK: Output: default@dest_grouped_old2
 PREHOOK: query: describe dest_grouped_old2
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@dest_grouped_old2
 POSTHOOK: query: describe dest_grouped_old2
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@dest_grouped_old2
 key                 	string              	                    
 PREHOOK: query: create table dest_grouped_new1 as select 1+1, 2+2 as zz, ((src.key % 2)+2)/2, test_max(length(src.value)), count(src.value), sin(count(src.value)), count(sin(src.value)), unix_timestamp(), CAST(SUM(IF(value > 10, value, 1)) AS INT), if(src.key > 10,
 	(src.key +5) % 2,
@@ -58,8 +62,10 @@ POSTHOOK: Input: default@src
 POSTHOOK: Output: default@dest_grouped_new1
 PREHOOK: query: describe dest_grouped_new1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@dest_grouped_new1
 POSTHOOK: query: describe dest_grouped_new1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@dest_grouped_new1
 column_0            	int                 	                    
 zz                  	int                 	                    
 column_2            	double              	                    
@@ -79,8 +85,10 @@ POSTHOOK: Input: default@src
 POSTHOOK: Output: default@dest_grouped_new2
 PREHOOK: query: describe dest_grouped_new2
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@dest_grouped_new2
 POSTHOOK: query: describe dest_grouped_new2
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@dest_grouped_new2
 key                 	string              	                    
 PREHOOK: query: -- Drop the temporary function at the end till HIVE-3160 gets fixed
 DROP TEMPORARY FUNCTION test_max
diff --git a/ql/src/test/results/clientpositive/avro_change_schema.q.out b/ql/src/test/results/clientpositive/avro_change_schema.q.out
index 2dd94c7138..4a9569da64 100644
--- a/ql/src/test/results/clientpositive/avro_change_schema.q.out
+++ b/ql/src/test/results/clientpositive/avro_change_schema.q.out
@@ -33,8 +33,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@avro2
 PREHOOK: query: DESCRIBE avro2
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@avro2
 POSTHOOK: query: DESCRIBE avro2
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@avro2
 string1             	string              	from deserializer   
 string2             	string              	from deserializer   
 PREHOOK: query: ALTER TABLE avro2 SET TBLPROPERTIES ('avro.schema.literal'='{ "namespace": "org.apache.hive",
@@ -61,8 +63,10 @@ POSTHOOK: Input: default@avro2
 POSTHOOK: Output: default@avro2
 PREHOOK: query: DESCRIBE avro2
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@avro2
 POSTHOOK: query: DESCRIBE avro2
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@avro2
 int1                	int                 	from deserializer   
 float1              	float               	from deserializer   
 double1             	double              	from deserializer   
diff --git a/ql/src/test/results/clientpositive/avro_evolved_schemas.q.out b/ql/src/test/results/clientpositive/avro_evolved_schemas.q.out
index c3a915ae7b..2f6261ea0f 100644
--- a/ql/src/test/results/clientpositive/avro_evolved_schemas.q.out
+++ b/ql/src/test/results/clientpositive/avro_evolved_schemas.q.out
@@ -75,8 +75,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@doctors_with_new_field
 PREHOOK: query: DESCRIBE doctors_with_new_field
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@doctors_with_new_field
 POSTHOOK: query: DESCRIBE doctors_with_new_field
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@doctors_with_new_field
 number              	int                 	from deserializer   
 first_name          	string              	from deserializer   
 last_name           	string              	from deserializer   
diff --git a/ql/src/test/results/clientpositive/avro_joins.q.out b/ql/src/test/results/clientpositive/avro_joins.q.out
index 5dfb97cbb3..3e37e78913 100644
--- a/ql/src/test/results/clientpositive/avro_joins.q.out
+++ b/ql/src/test/results/clientpositive/avro_joins.q.out
@@ -77,8 +77,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@doctors4
 PREHOOK: query: DESCRIBE doctors4
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@doctors4
 POSTHOOK: query: DESCRIBE doctors4
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@doctors4
 number              	int                 	from deserializer   
 first_name          	string              	from deserializer   
 last_name           	string              	from deserializer   
@@ -154,8 +156,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@episodes
 PREHOOK: query: DESCRIBE episodes
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@episodes
 POSTHOOK: query: DESCRIBE episodes
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@episodes
 title               	string              	from deserializer   
 air_date            	string              	from deserializer   
 doctor              	int                 	from deserializer   
diff --git a/ql/src/test/results/clientpositive/avro_sanity_test.q.out b/ql/src/test/results/clientpositive/avro_sanity_test.q.out
index 2add6e88a1..bfbd0c26fe 100644
--- a/ql/src/test/results/clientpositive/avro_sanity_test.q.out
+++ b/ql/src/test/results/clientpositive/avro_sanity_test.q.out
@@ -63,8 +63,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@doctors
 PREHOOK: query: DESCRIBE doctors
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@doctors
 POSTHOOK: query: DESCRIBE doctors
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@doctors
 number              	int                 	from deserializer   
 first_name          	string              	from deserializer   
 last_name           	string              	from deserializer   
diff --git a/ql/src/test/results/clientpositive/avro_schema_error_message.q.out b/ql/src/test/results/clientpositive/avro_schema_error_message.q.out
index 76bdc71a3f..1ead961108 100644
--- a/ql/src/test/results/clientpositive/avro_schema_error_message.q.out
+++ b/ql/src/test/results/clientpositive/avro_schema_error_message.q.out
@@ -21,8 +21,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@avro_with_no_schema
 PREHOOK: query: DESCRIBE avro_with_no_schema
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@avro_with_no_schema
 POSTHOOK: query: DESCRIBE avro_with_no_schema
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@avro_with_no_schema
 error_error_error_error_error_error_error	string              	from deserializer   
 cannot_determine_schema	string              	from deserializer   
 check               	string              	from deserializer   
diff --git a/ql/src/test/results/clientpositive/avro_schema_literal.q.out b/ql/src/test/results/clientpositive/avro_schema_literal.q.out
index fcf341066f..ca945d599c 100644
--- a/ql/src/test/results/clientpositive/avro_schema_literal.q.out
+++ b/ql/src/test/results/clientpositive/avro_schema_literal.q.out
@@ -63,8 +63,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@avro1
 PREHOOK: query: DESCRIBE avro1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@avro1
 POSTHOOK: query: DESCRIBE avro1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@avro1
 string1             	string              	from deserializer   
 int1                	int                 	from deserializer   
 tinyint1            	int                 	from deserializer   
diff --git a/ql/src/test/results/clientpositive/ba_table1.q.out b/ql/src/test/results/clientpositive/ba_table1.q.out
index 29d0b4380f..d148dc4c5b 100644
--- a/ql/src/test/results/clientpositive/ba_table1.q.out
+++ b/ql/src/test/results/clientpositive/ba_table1.q.out
@@ -15,8 +15,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@ba_test
 PREHOOK: query: describe extended ba_test
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@ba_test
 POSTHOOK: query: describe extended ba_test
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@ba_test
 ba_key              	binary              	                    
 ba_val              	binary              	                    
 	 	 
diff --git a/ql/src/test/results/clientpositive/ba_table2.q.out b/ql/src/test/results/clientpositive/ba_table2.q.out
index 10c21e3655..5d7ed8d46c 100644
--- a/ql/src/test/results/clientpositive/ba_table2.q.out
+++ b/ql/src/test/results/clientpositive/ba_table2.q.out
@@ -23,8 +23,10 @@ POSTHOOK: Input: default@ba_test
 POSTHOOK: Output: default@ba_test
 PREHOOK: query: describe extended ba_test
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@ba_test
 POSTHOOK: query: describe extended ba_test
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@ba_test
 ba_key              	binary              	                    
 ba_val              	binary              	                    
 	 	 
diff --git a/ql/src/test/results/clientpositive/ba_table_union.q.out b/ql/src/test/results/clientpositive/ba_table_union.q.out
index dc5d3533b3..14026806aa 100644
--- a/ql/src/test/results/clientpositive/ba_table_union.q.out
+++ b/ql/src/test/results/clientpositive/ba_table_union.q.out
@@ -13,8 +13,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@ba_test
 PREHOOK: query: describe extended ba_test
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@ba_test
 POSTHOOK: query: describe extended ba_test
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@ba_test
 ba_key              	binary              	                    
 ba_val              	binary              	                    
 	 	 
diff --git a/ql/src/test/results/clientpositive/binary_table_bincolserde.q.out b/ql/src/test/results/clientpositive/binary_table_bincolserde.q.out
index a95d64f632..2a8c0eab96 100644
--- a/ql/src/test/results/clientpositive/binary_table_bincolserde.q.out
+++ b/ql/src/test/results/clientpositive/binary_table_bincolserde.q.out
@@ -23,8 +23,10 @@ POSTHOOK: Input: default@ba_test
 POSTHOOK: Output: default@ba_test
 PREHOOK: query: describe extended ba_test
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@ba_test
 POSTHOOK: query: describe extended ba_test
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@ba_test
 ba_key              	binary              	                    
 ba_val              	binary              	                    
 	 	 
diff --git a/ql/src/test/results/clientpositive/binary_table_colserde.q.out b/ql/src/test/results/clientpositive/binary_table_colserde.q.out
index af70a9dac2..252e615767 100644
--- a/ql/src/test/results/clientpositive/binary_table_colserde.q.out
+++ b/ql/src/test/results/clientpositive/binary_table_colserde.q.out
@@ -23,8 +23,10 @@ POSTHOOK: Input: default@ba_test
 POSTHOOK: Output: default@ba_test
 PREHOOK: query: describe extended ba_test
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@ba_test
 POSTHOOK: query: describe extended ba_test
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@ba_test
 ba_key              	binary              	                    
 ba_val              	binary              	                    
 	 	 
diff --git a/ql/src/test/results/clientpositive/bucket5.q.out b/ql/src/test/results/clientpositive/bucket5.q.out
index 1db076f837..fb588b9111 100644
--- a/ql/src/test/results/clientpositive/bucket5.q.out
+++ b/ql/src/test/results/clientpositive/bucket5.q.out
@@ -502,8 +502,10 @@ POSTHOOK: Lineage: unbucketed_table.key EXPRESSION [(src)src.FieldSchema(name:ke
 POSTHOOK: Lineage: unbucketed_table.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESC FORMATTED bucketed_table
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@bucketed_table
 POSTHOOK: query: DESC FORMATTED bucketed_table
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@bucketed_table
 POSTHOOK: Lineage: bucketed_table.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: bucketed_table.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: unbucketed_table.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/bucket_groupby.q.out b/ql/src/test/results/clientpositive/bucket_groupby.q.out
index cd9a914e8a..6b60248124 100644
--- a/ql/src/test/results/clientpositive/bucket_groupby.q.out
+++ b/ql/src/test/results/clientpositive/bucket_groupby.q.out
@@ -7,8 +7,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@clustergroupby
 PREHOOK: query: describe extended clustergroupby
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@clustergroupby
 POSTHOOK: query: describe extended clustergroupby
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@clustergroupby
 key                 	string              	                    
 value               	string              	                    
 ds                  	string              	                    
@@ -122,8 +124,10 @@ POSTHOOK: Lineage: clustergroupby PARTITION(ds=100).value SIMPLE [(src)src.Field
 114	1
 PREHOOK: query: describe extended clustergroupby
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@clustergroupby
 POSTHOOK: query: describe extended clustergroupby
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@clustergroupby
 POSTHOOK: Lineage: clustergroupby PARTITION(ds=100).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: clustergroupby PARTITION(ds=100).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 key                 	string              	                    
@@ -1063,8 +1067,10 @@ POSTHOOK: Lineage: clustergroupby PARTITION(ds=101).key SIMPLE [(src)src.FieldSc
 POSTHOOK: Lineage: clustergroupby PARTITION(ds=101).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: describe extended clustergroupby
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@clustergroupby
 POSTHOOK: query: describe extended clustergroupby
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@clustergroupby
 POSTHOOK: Lineage: clustergroupby PARTITION(ds=100).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: clustergroupby PARTITION(ds=100).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: clustergroupby PARTITION(ds=101).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -1413,8 +1419,10 @@ POSTHOOK: Lineage: clustergroupby PARTITION(ds=102).key SIMPLE [(src)src.FieldSc
 POSTHOOK: Lineage: clustergroupby PARTITION(ds=102).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: describe extended clustergroupby
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@clustergroupby
 POSTHOOK: query: describe extended clustergroupby
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@clustergroupby
 POSTHOOK: Lineage: clustergroupby PARTITION(ds=100).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: clustergroupby PARTITION(ds=100).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: clustergroupby PARTITION(ds=101).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/char_nested_types.q.out b/ql/src/test/results/clientpositive/char_nested_types.q.out
index 875543344c..08215231f5 100644
--- a/ql/src/test/results/clientpositive/char_nested_types.q.out
+++ b/ql/src/test/results/clientpositive/char_nested_types.q.out
@@ -67,8 +67,10 @@ POSTHOOK: Lineage: char_nested_1.value EXPRESSION [(src)src.FieldSchema(name:val
 POSTHOOK: Lineage: char_nested_array.c1 EXPRESSION [(char_nested_1)char_nested_1.FieldSchema(name:value, type:char(20), comment:null), ]
 PREHOOK: query: describe char_nested_array
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@char_nested_array
 POSTHOOK: query: describe char_nested_array
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@char_nested_array
 POSTHOOK: Lineage: char_nested_1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: char_nested_1.value EXPRESSION [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: char_nested_array.c1 EXPRESSION [(char_nested_1)char_nested_1.FieldSchema(name:value, type:char(20), comment:null), ]
@@ -113,8 +115,10 @@ POSTHOOK: Lineage: char_nested_array.c1 EXPRESSION [(char_nested_1)char_nested_1
 POSTHOOK: Lineage: char_nested_map.c1 EXPRESSION [(char_nested_1)char_nested_1.FieldSchema(name:key, type:int, comment:null), (char_nested_1)char_nested_1.FieldSchema(name:value, type:char(20), comment:null), ]
 PREHOOK: query: describe char_nested_map
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@char_nested_map
 POSTHOOK: query: describe char_nested_map
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@char_nested_map
 POSTHOOK: Lineage: char_nested_1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: char_nested_1.value EXPRESSION [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: char_nested_array.c1 EXPRESSION [(char_nested_1)char_nested_1.FieldSchema(name:value, type:char(20), comment:null), ]
@@ -169,8 +173,10 @@ POSTHOOK: Lineage: char_nested_map.c1 EXPRESSION [(char_nested_1)char_nested_1.F
 POSTHOOK: Lineage: char_nested_struct.c1 EXPRESSION [(char_nested_1)char_nested_1.FieldSchema(name:key, type:int, comment:null), (char_nested_1)char_nested_1.FieldSchema(name:value, type:char(20), comment:null), ]
 PREHOOK: query: describe char_nested_struct
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@char_nested_struct
 POSTHOOK: query: describe char_nested_struct
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@char_nested_struct
 POSTHOOK: Lineage: char_nested_1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: char_nested_1.value EXPRESSION [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: char_nested_array.c1 EXPRESSION [(char_nested_1)char_nested_1.FieldSchema(name:value, type:char(20), comment:null), ]
@@ -209,8 +215,10 @@ POSTHOOK: Lineage: char_nested_map.c1 EXPRESSION [(char_nested_1)char_nested_1.F
 POSTHOOK: Lineage: char_nested_struct.c1 EXPRESSION [(char_nested_1)char_nested_1.FieldSchema(name:key, type:int, comment:null), (char_nested_1)char_nested_1.FieldSchema(name:value, type:char(20), comment:null), ]
 PREHOOK: query: describe char_nested_cta
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@char_nested_cta
 POSTHOOK: query: describe char_nested_cta
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@char_nested_cta
 POSTHOOK: Lineage: char_nested_1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: char_nested_1.value EXPRESSION [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: char_nested_array.c1 EXPRESSION [(char_nested_1)char_nested_1.FieldSchema(name:value, type:char(20), comment:null), ]
@@ -249,8 +257,10 @@ POSTHOOK: Lineage: char_nested_map.c1 EXPRESSION [(char_nested_1)char_nested_1.F
 POSTHOOK: Lineage: char_nested_struct.c1 EXPRESSION [(char_nested_1)char_nested_1.FieldSchema(name:key, type:int, comment:null), (char_nested_1)char_nested_1.FieldSchema(name:value, type:char(20), comment:null), ]
 PREHOOK: query: describe char_nested_view
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@char_nested_view
 POSTHOOK: query: describe char_nested_view
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@char_nested_view
 POSTHOOK: Lineage: char_nested_1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: char_nested_1.value EXPRESSION [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: char_nested_array.c1 EXPRESSION [(char_nested_1)char_nested_1.FieldSchema(name:value, type:char(20), comment:null), ]
diff --git a/ql/src/test/results/clientpositive/columnarserde_create_shortcut.q.out b/ql/src/test/results/clientpositive/columnarserde_create_shortcut.q.out
index 944b8c7e41..8532ecbcee 100644
--- a/ql/src/test/results/clientpositive/columnarserde_create_shortcut.q.out
+++ b/ql/src/test/results/clientpositive/columnarserde_create_shortcut.q.out
@@ -153,8 +153,10 @@ POSTHOOK: Lineage: columnshortcuttable.key SIMPLE [(src)src.FieldSchema(name:key
 POSTHOOK: Lineage: columnshortcuttable.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: describe columnShortcutTable
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@columnshortcuttable
 POSTHOOK: query: describe columnShortcutTable
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@columnshortcuttable
 POSTHOOK: Lineage: columnarserde_create_shortcut.a SIMPLE [(src_thrift)src_thrift.FieldSchema(name:lint, type:array<int>, comment:from deserializer), ]
 POSTHOOK: Lineage: columnarserde_create_shortcut.b SIMPLE [(src_thrift)src_thrift.FieldSchema(name:lstring, type:array<string>, comment:from deserializer), ]
 POSTHOOK: Lineage: columnarserde_create_shortcut.c SIMPLE [(src_thrift)src_thrift.FieldSchema(name:mstringstring, type:map<string,string>, comment:from deserializer), ]
diff --git a/ql/src/test/results/clientpositive/combine2_hadoop20.q.out b/ql/src/test/results/clientpositive/combine2_hadoop20.q.out
index a29ba8d685..8d7fd81ae8 100644
--- a/ql/src/test/results/clientpositive/combine2_hadoop20.q.out
+++ b/ql/src/test/results/clientpositive/combine2_hadoop20.q.out
@@ -70,8 +70,10 @@ POSTHOOK: Lineage: combine2 PARTITION(value=val_9).key EXPRESSION [(src)src.Fiel
 POSTHOOK: Lineage: combine2 PARTITION(value=|).key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), (src)src.FieldSchema(name:key, type:string, comment:default), (src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: show partitions combine2
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@combine2
 POSTHOOK: query: show partitions combine2
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@combine2
 POSTHOOK: Lineage: combine2 PARTITION(value=2010-04-21 09:45:00).key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), (src)src.FieldSchema(name:key, type:string, comment:default), (src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: combine2 PARTITION(value=val_0).key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), (src)src.FieldSchema(name:key, type:string, comment:default), (src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: combine2 PARTITION(value=val_2).key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), (src)src.FieldSchema(name:key, type:string, comment:default), (src)src.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/combine3.q.out b/ql/src/test/results/clientpositive/combine3.q.out
index b018a7232c..4908e173d7 100644
--- a/ql/src/test/results/clientpositive/combine3.q.out
+++ b/ql/src/test/results/clientpositive/combine3.q.out
@@ -43,8 +43,10 @@ POSTHOOK: Lineage: combine_3_srcpart_seq_rc PARTITION(ds=2010-08-03,hr=00).key E
 POSTHOOK: Lineage: combine_3_srcpart_seq_rc PARTITION(ds=2010-08-03,hr=00).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: desc extended combine_3_srcpart_seq_rc partition(ds="2010-08-03", hr="00")
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@combine_3_srcpart_seq_rc
 POSTHOOK: query: desc extended combine_3_srcpart_seq_rc partition(ds="2010-08-03", hr="00")
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@combine_3_srcpart_seq_rc
 POSTHOOK: Lineage: combine_3_srcpart_seq_rc PARTITION(ds=2010-08-03,hr=001).key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: combine_3_srcpart_seq_rc PARTITION(ds=2010-08-03,hr=001).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: combine_3_srcpart_seq_rc PARTITION(ds=2010-08-03,hr=00).key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -63,8 +65,10 @@ hr                  	string
 #### A masked pattern was here ####
 PREHOOK: query: desc extended combine_3_srcpart_seq_rc partition(ds="2010-08-03", hr="001")
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@combine_3_srcpart_seq_rc
 POSTHOOK: query: desc extended combine_3_srcpart_seq_rc partition(ds="2010-08-03", hr="001")
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@combine_3_srcpart_seq_rc
 POSTHOOK: Lineage: combine_3_srcpart_seq_rc PARTITION(ds=2010-08-03,hr=001).key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: combine_3_srcpart_seq_rc PARTITION(ds=2010-08-03,hr=001).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: combine_3_srcpart_seq_rc PARTITION(ds=2010-08-03,hr=00).key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/convert_enum_to_string.q.out b/ql/src/test/results/clientpositive/convert_enum_to_string.q.out
index 0868a72776..4c89b29a1e 100644
--- a/ql/src/test/results/clientpositive/convert_enum_to_string.q.out
+++ b/ql/src/test/results/clientpositive/convert_enum_to_string.q.out
@@ -21,8 +21,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@convert_enum_to_string
 PREHOOK: query: describe convert_enum_to_string
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@convert_enum_to_string
 POSTHOOK: query: describe convert_enum_to_string
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@convert_enum_to_string
 my_bool             	boolean             	from deserializer   
 my_byte             	tinyint             	from deserializer   
 my_16bit_int        	smallint            	from deserializer   
diff --git a/ql/src/test/results/clientpositive/create_1.q.out b/ql/src/test/results/clientpositive/create_1.q.out
index f6ab23fa15..e6d9e9e561 100644
--- a/ql/src/test/results/clientpositive/create_1.q.out
+++ b/ql/src/test/results/clientpositive/create_1.q.out
@@ -7,14 +7,18 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@table1
 PREHOOK: query: DESCRIBE table1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@table1
 POSTHOOK: query: DESCRIBE table1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@table1
 a                   	string              	                    
 b                   	string              	                    
 PREHOOK: query: DESCRIBE EXTENDED table1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@table1
 POSTHOOK: query: DESCRIBE EXTENDED table1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@table1
 a                   	string              	                    
 b                   	string              	                    
 	 	 
@@ -32,14 +36,18 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@table2
 PREHOOK: query: DESCRIBE table2
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@table2
 POSTHOOK: query: DESCRIBE table2
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@table2
 a                   	string              	                    
 b                   	int                 	                    
 PREHOOK: query: DESCRIBE EXTENDED table2
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@table2
 POSTHOOK: query: DESCRIBE EXTENDED table2
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@table2
 a                   	string              	                    
 b                   	int                 	                    
 	 	 
@@ -57,14 +65,18 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@table3
 PREHOOK: query: DESCRIBE table3
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@table3
 POSTHOOK: query: DESCRIBE table3
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@table3
 a                   	string              	                    
 b                   	string              	                    
 PREHOOK: query: DESCRIBE EXTENDED table3
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@table3
 POSTHOOK: query: DESCRIBE EXTENDED table3
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@table3
 a                   	string              	                    
 b                   	string              	                    
 	 	 
@@ -82,14 +94,18 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@table4
 PREHOOK: query: DESCRIBE table4
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@table4
 POSTHOOK: query: DESCRIBE table4
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@table4
 a                   	string              	                    
 b                   	string              	                    
 PREHOOK: query: DESCRIBE EXTENDED table4
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@table4
 POSTHOOK: query: DESCRIBE EXTENDED table4
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@table4
 a                   	string              	                    
 b                   	string              	                    
 	 	 
@@ -107,14 +123,18 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@table5
 PREHOOK: query: DESCRIBE table5
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@table5
 POSTHOOK: query: DESCRIBE table5
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@table5
 a                   	string              	                    
 b                   	string              	                    
 PREHOOK: query: DESCRIBE EXTENDED table5
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@table5
 POSTHOOK: query: DESCRIBE EXTENDED table5
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@table5
 a                   	string              	                    
 b                   	string              	                    
 	 	 
diff --git a/ql/src/test/results/clientpositive/create_alter_list_bucketing_table1.q.out b/ql/src/test/results/clientpositive/create_alter_list_bucketing_table1.q.out
index 54099500a3..c875dbbc75 100644
--- a/ql/src/test/results/clientpositive/create_alter_list_bucketing_table1.q.out
+++ b/ql/src/test/results/clientpositive/create_alter_list_bucketing_table1.q.out
@@ -17,8 +17,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@stored_as_dirs_multiple
 PREHOOK: query: describe formatted stored_as_dirs_multiple
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@stored_as_dirs_multiple
 POSTHOOK: query: describe formatted stored_as_dirs_multiple
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@stored_as_dirs_multiple
 # col_name            	data_type           	comment             
 	 	 
 col1                	string              	                    
@@ -60,8 +62,10 @@ POSTHOOK: Input: default@stored_as_dirs_multiple
 POSTHOOK: Output: default@stored_as_dirs_multiple
 PREHOOK: query: describe formatted stored_as_dirs_multiple
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@stored_as_dirs_multiple
 POSTHOOK: query: describe formatted stored_as_dirs_multiple
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@stored_as_dirs_multiple
 # col_name            	data_type           	comment             
 	 	 
 col1                	string              	                    
@@ -108,8 +112,10 @@ POSTHOOK: Input: default@stored_as_dirs_multiple
 POSTHOOK: Output: default@stored_as_dirs_multiple
 PREHOOK: query: describe formatted stored_as_dirs_multiple
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@stored_as_dirs_multiple
 POSTHOOK: query: describe formatted stored_as_dirs_multiple
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@stored_as_dirs_multiple
 # col_name            	data_type           	comment             
 	 	 
 col1                	string              	                    
@@ -163,8 +169,10 @@ POSTHOOK: Input: default@stored_as_dirs_single
 POSTHOOK: Output: default@stored_as_dirs_single
 PREHOOK: query: describe formatted stored_as_dirs_single
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@stored_as_dirs_single
 POSTHOOK: query: describe formatted stored_as_dirs_single
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@stored_as_dirs_single
 # col_name            	data_type           	comment             
 	 	 
 key                 	string              	                    
@@ -211,8 +219,10 @@ POSTHOOK: Input: default@stored_as_dirs_single
 POSTHOOK: Output: default@stored_as_dirs_single
 PREHOOK: query: describe formatted stored_as_dirs_single
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@stored_as_dirs_single
 POSTHOOK: query: describe formatted stored_as_dirs_single
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@stored_as_dirs_single
 # col_name            	data_type           	comment             
 	 	 
 key                 	string              	                    
@@ -258,8 +268,10 @@ POSTHOOK: Input: default@stored_as_dirs_single
 POSTHOOK: Output: default@stored_as_dirs_single
 PREHOOK: query: describe formatted stored_as_dirs_single
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@stored_as_dirs_single
 POSTHOOK: query: describe formatted stored_as_dirs_single
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@stored_as_dirs_single
 # col_name            	data_type           	comment             
 	 	 
 key                 	string              	                    
@@ -305,8 +317,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@stored_as_dirs_single_like
 PREHOOK: query: describe formatted stored_as_dirs_single_like
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@stored_as_dirs_single_like
 POSTHOOK: query: describe formatted stored_as_dirs_single_like
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@stored_as_dirs_single_like
 # col_name            	data_type           	comment             
 	 	 
 key                 	string              	                    
diff --git a/ql/src/test/results/clientpositive/create_default_prop.q.out b/ql/src/test/results/clientpositive/create_default_prop.q.out
index 2958cdded9..ca44bea112 100644
--- a/ql/src/test/results/clientpositive/create_default_prop.q.out
+++ b/ql/src/test/results/clientpositive/create_default_prop.q.out
@@ -7,8 +7,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@table_p1
 PREHOOK: query: DESC EXTENDED table_p1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@table_p1
 POSTHOOK: query: DESC EXTENDED table_p1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@table_p1
 a                   	string              	                    
 	 	 
 #### A masked pattern was here ####
@@ -21,8 +23,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@table_p2
 PREHOOK: query: DESC EXTENDED table_p2
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@table_p2
 POSTHOOK: query: DESC EXTENDED table_p2
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@table_p2
 a                   	string              	                    
 	 	 
 #### A masked pattern was here ####
@@ -35,8 +39,10 @@ POSTHOOK: Input: default@table_p1
 POSTHOOK: Output: default@table_p3
 PREHOOK: query: DESC EXTENDED table_p3
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@table_p3
 POSTHOOK: query: DESC EXTENDED table_p3
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@table_p3
 a                   	string              	                    
 	 	 
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/create_escape.q.out b/ql/src/test/results/clientpositive/create_escape.q.out
index 6bf9ccf4d7..db166e8636 100644
--- a/ql/src/test/results/clientpositive/create_escape.q.out
+++ b/ql/src/test/results/clientpositive/create_escape.q.out
@@ -11,14 +11,18 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@table1
 PREHOOK: query: DESCRIBE table1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@table1
 POSTHOOK: query: DESCRIBE table1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@table1
 a                   	string              	                    
 b                   	string              	                    
 PREHOOK: query: DESCRIBE EXTENDED table1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@table1
 POSTHOOK: query: DESCRIBE EXTENDED table1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@table1
 a                   	string              	                    
 b                   	string              	                    
 	 	 
diff --git a/ql/src/test/results/clientpositive/create_insert_outputformat.q.out b/ql/src/test/results/clientpositive/create_insert_outputformat.q.out
index 640764502f..758d893849 100644
--- a/ql/src/test/results/clientpositive/create_insert_outputformat.q.out
+++ b/ql/src/test/results/clientpositive/create_insert_outputformat.q.out
@@ -23,8 +23,10 @@ POSTHOOK: Lineage: table_test_output_format.key EXPRESSION [(src)src.FieldSchema
 POSTHOOK: Lineage: table_test_output_format.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: describe table_test_output_format
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@table_test_output_format
 POSTHOOK: query: describe table_test_output_format
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@table_test_output_format
 POSTHOOK: Lineage: table_test_output_format.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: table_test_output_format.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 key                 	int                 	                    
@@ -58,8 +60,10 @@ POSTHOOK: Lineage: table_test_output_format_sequencefile.key EXPRESSION [(src)sr
 POSTHOOK: Lineage: table_test_output_format_sequencefile.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: describe table_test_output_format_sequencefile
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@table_test_output_format_sequencefile
 POSTHOOK: query: describe table_test_output_format_sequencefile
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@table_test_output_format_sequencefile
 POSTHOOK: Lineage: table_test_output_format.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: table_test_output_format.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: table_test_output_format_sequencefile.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -99,8 +103,10 @@ POSTHOOK: Lineage: table_test_output_format_sequencefile.key EXPRESSION [(src)sr
 POSTHOOK: Lineage: table_test_output_format_sequencefile.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: describe table_test_output_format_hivesequencefile
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@table_test_output_format_hivesequencefile
 POSTHOOK: query: describe table_test_output_format_hivesequencefile
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@table_test_output_format_hivesequencefile
 POSTHOOK: Lineage: table_test_output_format.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: table_test_output_format.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: table_test_output_format_hivesequencefile.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/create_like.q.out b/ql/src/test/results/clientpositive/create_like.q.out
index fc9e7d8422..62254feaad 100644
--- a/ql/src/test/results/clientpositive/create_like.q.out
+++ b/ql/src/test/results/clientpositive/create_like.q.out
@@ -7,8 +7,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@table1
 PREHOOK: query: DESCRIBE FORMATTED table1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@table1
 POSTHOOK: query: DESCRIBE FORMATTED table1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@table1
 # col_name            	data_type           	comment             
 	 	 
 a                   	string              	                    
@@ -43,8 +45,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@table2
 PREHOOK: query: DESCRIBE FORMATTED table2
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@table2
 POSTHOOK: query: DESCRIBE FORMATTED table2
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@table2
 # col_name            	data_type           	comment             
 	 	 
 a                   	string              	                    
@@ -87,8 +91,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@table3
 PREHOOK: query: DESCRIBE FORMATTED table3
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@table3
 POSTHOOK: query: DESCRIBE FORMATTED table3
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@table3
 # col_name            	data_type           	comment             
 	 	 
 a                   	string              	                    
diff --git a/ql/src/test/results/clientpositive/create_like2.q.out b/ql/src/test/results/clientpositive/create_like2.q.out
index d624aaf167..d7f1dfd47b 100644
--- a/ql/src/test/results/clientpositive/create_like2.q.out
+++ b/ql/src/test/results/clientpositive/create_like2.q.out
@@ -28,8 +28,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@table2
 PREHOOK: query: DESC FORMATTED table2
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@table2
 POSTHOOK: query: DESC FORMATTED table2
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@table2
 # col_name            	data_type           	comment             
 	 	 
 a                   	int                 	                    
diff --git a/ql/src/test/results/clientpositive/create_like_tbl_props.q.out b/ql/src/test/results/clientpositive/create_like_tbl_props.q.out
index a0b3292294..7a8d387701 100644
--- a/ql/src/test/results/clientpositive/create_like_tbl_props.q.out
+++ b/ql/src/test/results/clientpositive/create_like_tbl_props.q.out
@@ -11,8 +11,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@test_table
 PREHOOK: query: DESC FORMATTED test_table
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESC FORMATTED test_table
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 # col_name            	data_type           	comment             
 	 	 
 key                 	string              	default             
@@ -52,8 +54,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@test_table1
 PREHOOK: query: DESC FORMATTED test_table1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table1
 POSTHOOK: query: DESC FORMATTED test_table1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table1
 # col_name            	data_type           	comment             
 	 	 
 key                 	string              	default             
@@ -93,8 +97,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@test_table2
 PREHOOK: query: DESC FORMATTED test_table2
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table2
 POSTHOOK: query: DESC FORMATTED test_table2
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table2
 # col_name            	data_type           	comment             
 	 	 
 key                 	string              	default             
@@ -135,8 +141,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@test_table3
 PREHOOK: query: DESC FORMATTED test_table3
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table3
 POSTHOOK: query: DESC FORMATTED test_table3
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table3
 # col_name            	data_type           	comment             
 	 	 
 key                 	string              	default             
@@ -184,8 +192,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@test_table4
 PREHOOK: query: DESC FORMATTED test_table4
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table4
 POSTHOOK: query: DESC FORMATTED test_table4
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table4
 # col_name            	data_type           	comment             
 	 	 
 key                 	string              	                    
diff --git a/ql/src/test/results/clientpositive/create_like_view.q.out b/ql/src/test/results/clientpositive/create_like_view.q.out
index 2481663ab2..876888d36f 100644
--- a/ql/src/test/results/clientpositive/create_like_view.q.out
+++ b/ql/src/test/results/clientpositive/create_like_view.q.out
@@ -23,14 +23,18 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@table1
 PREHOOK: query: DESCRIBE table1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@table1
 POSTHOOK: query: DESCRIBE table1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@table1
 a                   	string              	                    
 b                   	string              	                    
 PREHOOK: query: DESCRIBE FORMATTED table1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@table1
 POSTHOOK: query: DESCRIBE FORMATTED table1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@table1
 # col_name            	data_type           	comment             
 	 	 
 a                   	string              	                    
@@ -72,14 +76,18 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@table2
 PREHOOK: query: DESCRIBE table2
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@table2
 POSTHOOK: query: DESCRIBE table2
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@table2
 a                   	string              	                    
 b                   	string              	                    
 PREHOOK: query: DESCRIBE FORMATTED table2
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@table2
 POSTHOOK: query: DESCRIBE FORMATTED table2
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@table2
 # col_name            	data_type           	comment             
 	 	 
 a                   	string              	                    
@@ -122,14 +130,18 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@table3
 PREHOOK: query: DESCRIBE table3
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@table3
 POSTHOOK: query: DESCRIBE table3
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@table3
 a                   	string              	                    
 b                   	string              	                    
 PREHOOK: query: DESCRIBE FORMATTED table3
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@table3
 POSTHOOK: query: DESCRIBE FORMATTED table3
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@table3
 # col_name            	data_type           	comment             
 	 	 
 a                   	string              	                    
@@ -267,8 +279,10 @@ POSTHOOK: Lineage: table2.a SIMPLE [(src)src.FieldSchema(name:key, type:string,
 POSTHOOK: Lineage: table2.b SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: describe formatted table1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@table1
 POSTHOOK: query: describe formatted table1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@table1
 POSTHOOK: Lineage: table1.a SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: table1.b SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: table2.a SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/create_nested_type.q.out b/ql/src/test/results/clientpositive/create_nested_type.q.out
index 5783d1bd79..388266e4a1 100644
--- a/ql/src/test/results/clientpositive/create_nested_type.q.out
+++ b/ql/src/test/results/clientpositive/create_nested_type.q.out
@@ -17,16 +17,20 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@table1
 PREHOOK: query: DESCRIBE table1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@table1
 POSTHOOK: query: DESCRIBE table1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@table1
 a                   	string              	                    
 b                   	array<string>       	                    
 c                   	array<map<string,string>>	                    
 d                   	map<string,array<string>>	                    
 PREHOOK: query: DESCRIBE EXTENDED table1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@table1
 POSTHOOK: query: DESCRIBE EXTENDED table1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@table1
 a                   	string              	                    
 b                   	array<string>       	                    
 c                   	array<map<string,string>>	                    
diff --git a/ql/src/test/results/clientpositive/create_or_replace_view.q.out b/ql/src/test/results/clientpositive/create_or_replace_view.q.out
index 5cfb08ba5f..36dfe77087 100644
--- a/ql/src/test/results/clientpositive/create_or_replace_view.q.out
+++ b/ql/src/test/results/clientpositive/create_or_replace_view.q.out
@@ -11,8 +11,10 @@ POSTHOOK: Input: default@srcpart
 POSTHOOK: Output: default@v
 PREHOOK: query: describe formatted v
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@v
 POSTHOOK: query: describe formatted v
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@v
 # col_name            	data_type           	comment             
 	 	 
 key                 	string              	                    
@@ -93,8 +95,10 @@ POSTHOOK: Input: default@v
 409	val_409	2008-04-08	11
 PREHOOK: query: describe formatted v
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@v
 POSTHOOK: query: describe formatted v
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@v
 # col_name            	data_type           	comment             
 	 	 
 key                 	string              	                    
@@ -129,8 +133,10 @@ View Original Text: 	select * from srcpart
 View Expanded Text: 	select `srcpart`.`key`, `srcpart`.`value`, `srcpart`.`ds`, `srcpart`.`hr` from `default`.`srcpart`	 
 PREHOOK: query: show partitions v
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@v
 POSTHOOK: query: show partitions v
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@v
 ds=2008-04-08/hr=11
 ds=2008-04-08/hr=12
 PREHOOK: query: -- altering partitioned view 1
@@ -159,8 +165,10 @@ val_409	2008-04-08	11
 val_409	2008-04-08	11
 PREHOOK: query: describe formatted v
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@v
 POSTHOOK: query: describe formatted v
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@v
 # col_name            	data_type           	comment             
 	 	 
 value               	string              	                    
@@ -194,8 +202,10 @@ View Original Text: 	select value, ds, hr from srcpart
 View Expanded Text: 	select `srcpart`.`value`, `srcpart`.`ds`, `srcpart`.`hr` from `default`.`srcpart`	 
 PREHOOK: query: show partitions v
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@v
 POSTHOOK: query: show partitions v
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@v
 ds=2008-04-08/hr=11
 ds=2008-04-08/hr=12
 PREHOOK: query: -- altering partitioned view 2
@@ -224,8 +234,10 @@ POSTHOOK: Input: default@v
 409	val_409	2008-04-08	11
 PREHOOK: query: describe formatted v
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@v
 POSTHOOK: query: describe formatted v
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@v
 # col_name            	data_type           	comment             
 	 	 
 key                 	string              	                    
@@ -260,8 +272,10 @@ View Original Text: 	select key, value, ds, hr from srcpart
 View Expanded Text: 	select `srcpart`.`key`, `srcpart`.`value`, `srcpart`.`ds`, `srcpart`.`hr` from `default`.`srcpart`	 
 PREHOOK: query: show partitions v
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@v
 POSTHOOK: query: show partitions v
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@v
 ds=2008-04-08/hr=11
 ds=2008-04-08/hr=12
 PREHOOK: query: drop view v
@@ -307,8 +321,10 @@ POSTHOOK: Input: default@srcpart
 POSTHOOK: Output: default@v
 PREHOOK: query: describe formatted v
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@v
 POSTHOOK: query: describe formatted v
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@v
 # col_name            	data_type           	comment             
 	 	 
 key                 	string              	                    
diff --git a/ql/src/test/results/clientpositive/create_skewed_table1.q.out b/ql/src/test/results/clientpositive/create_skewed_table1.q.out
index e97b0690ff..b3f61edfc2 100644
--- a/ql/src/test/results/clientpositive/create_skewed_table1.q.out
+++ b/ql/src/test/results/clientpositive/create_skewed_table1.q.out
@@ -21,8 +21,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@list_bucket_multiple
 PREHOOK: query: describe formatted list_bucket_single_2
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@list_bucket_single_2
 POSTHOOK: query: describe formatted list_bucket_single_2
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@list_bucket_single_2
 # col_name            	data_type           	comment             
 	 	 
 key                 	string              	                    
@@ -52,8 +54,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: describe formatted list_bucket_single
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@list_bucket_single
 POSTHOOK: query: describe formatted list_bucket_single
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@list_bucket_single
 # col_name            	data_type           	comment             
 	 	 
 key                 	string              	                    
@@ -83,8 +87,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: describe formatted list_bucket_multiple
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@list_bucket_multiple
 POSTHOOK: query: describe formatted list_bucket_multiple
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@list_bucket_multiple
 # col_name            	data_type           	comment             
 	 	 
 col1                	string              	                    
diff --git a/ql/src/test/results/clientpositive/create_view.q.out b/ql/src/test/results/clientpositive/create_view.q.out
index 246a7e1696..449f5de02d 100644
--- a/ql/src/test/results/clientpositive/create_view.q.out
+++ b/ql/src/test/results/clientpositive/create_view.q.out
@@ -210,20 +210,26 @@ view2
 view3
 PREHOOK: query: DESCRIBE view1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@view1
 POSTHOOK: query: DESCRIBE view1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@view1
 value               	string              	                    
 PREHOOK: query: DESCRIBE EXTENDED view1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@view1
 POSTHOOK: query: DESCRIBE EXTENDED view1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@view1
 value               	string              	                    
 	 	 
 #### A masked pattern was here ####
 PREHOOK: query: DESCRIBE FORMATTED view1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@view1
 POSTHOOK: query: DESCRIBE FORMATTED view1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@view1
 # col_name            	data_type           	comment             
 	 	 
 value               	string              	                    
@@ -251,22 +257,28 @@ View Original Text: 	SELECT value FROM src WHERE key=86
 View Expanded Text: 	SELECT `src`.`value` FROM `default`.`src` WHERE `src`.`key`=86	 
 PREHOOK: query: DESCRIBE view2
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@view2
 POSTHOOK: query: DESCRIBE view2
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@view2
 key                 	string              	                    
 value               	string              	                    
 PREHOOK: query: DESCRIBE EXTENDED view2
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@view2
 POSTHOOK: query: DESCRIBE EXTENDED view2
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@view2
 key                 	string              	                    
 value               	string              	                    
 	 	 
 #### A masked pattern was here ####
 PREHOOK: query: DESCRIBE FORMATTED view2
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@view2
 POSTHOOK: query: DESCRIBE FORMATTED view2
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@view2
 # col_name            	data_type           	comment             
 	 	 
 key                 	string              	                    
@@ -295,20 +307,26 @@ View Original Text: 	SELECT * FROM src
 View Expanded Text: 	SELECT `src`.`key`, `src`.`value` FROM `default`.`src`	 
 PREHOOK: query: DESCRIBE view3
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@view3
 POSTHOOK: query: DESCRIBE view3
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@view3
 valoo               	string              	                    
 PREHOOK: query: DESCRIBE EXTENDED view3
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@view3
 POSTHOOK: query: DESCRIBE EXTENDED view3
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@view3
 valoo               	string              	                    
 	 	 
 #### A masked pattern was here ####
 PREHOOK: query: DESCRIBE FORMATTED view3
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@view3
 POSTHOOK: query: DESCRIBE FORMATTED view3
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@view3
 # col_name            	data_type           	comment             
 	 	 
 valoo               	string              	                    
@@ -345,15 +363,19 @@ POSTHOOK: Input: default@view3
 POSTHOOK: Output: default@view3
 PREHOOK: query: DESCRIBE EXTENDED view3
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@view3
 POSTHOOK: query: DESCRIBE EXTENDED view3
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@view3
 valoo               	string              	                    
 	 	 
 #### A masked pattern was here ####
 PREHOOK: query: DESCRIBE FORMATTED view3
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@view3
 POSTHOOK: query: DESCRIBE FORMATTED view3
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@view3
 # col_name            	data_type           	comment             
 	 	 
 valoo               	string              	                    
@@ -392,17 +414,21 @@ PREHOOK: query: -- use DESCRIBE EXTENDED on a base table and an external table a
 -- of comparison for view descriptions
 DESCRIBE EXTENDED table1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@table1
 POSTHOOK: query: -- use DESCRIBE EXTENDED on a base table and an external table as points
 -- of comparison for view descriptions
 DESCRIBE EXTENDED table1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@table1
 key                 	int                 	                    
 	 	 
 #### A masked pattern was here ####
 PREHOOK: query: DESCRIBE EXTENDED src1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@src1
 POSTHOOK: query: DESCRIBE EXTENDED src1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@src1
 key                 	string              	default             
 value               	string              	default             
 	 	 
@@ -411,10 +437,12 @@ PREHOOK: query: -- use DESCRIBE EXTENDED on a base table as a point of compariso
 -- view descriptions
 DESCRIBE EXTENDED table1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@table1
 POSTHOOK: query: -- use DESCRIBE EXTENDED on a base table as a point of comparison for
 -- view descriptions
 DESCRIBE EXTENDED table1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@table1
 key                 	int                 	                    
 	 	 
 #### A masked pattern was here ####
@@ -459,8 +487,10 @@ POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:st
 86
 PREHOOK: query: DESCRIBE view4
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@view4
 POSTHOOK: query: DESCRIBE view4
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@view4
 POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 key                 	int                 	                    
 PREHOOK: query: ALTER TABLE table1 ADD COLUMNS (value STRING)
@@ -496,15 +526,19 @@ POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:st
 86
 PREHOOK: query: DESCRIBE table1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@table1
 POSTHOOK: query: DESCRIBE table1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@table1
 POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 key                 	int                 	                    
 value               	string              	                    
 PREHOOK: query: DESCRIBE view4
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@view4
 POSTHOOK: query: DESCRIBE view4
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@view4
 POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 key                 	int                 	                    
 PREHOOK: query: CREATE VIEW view5 AS SELECT v1.key as key1, v2.key as key2
@@ -536,8 +570,10 @@ POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:st
 86	86
 PREHOOK: query: DESCRIBE view5
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@view5
 POSTHOOK: query: DESCRIBE view5
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@view5
 POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 key1                	int                 	                    
 key2                	int                 	                    
@@ -557,8 +593,10 @@ POSTHOOK: Output: default@view6
 POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE view6
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@view6
 POSTHOOK: query: DESCRIBE view6
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@view6
 POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 valoo               	string              	I cannot spell      
 PREHOOK: query: -- verify that ORDER BY and LIMIT are both supported in view def
@@ -693,8 +731,10 @@ POSTHOOK: Output: default@view8
 POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE EXTENDED view8
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@view8
 POSTHOOK: query: DESCRIBE EXTENDED view8
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@view8
 POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 c                   	string              	                    
 	 	 
@@ -703,8 +743,10 @@ FROM table1, viewExpandedText:SELECT `_c0` AS `c` FROM (SELECT `test_translate`(
 FROM `default`.`table1`) `view8`, tableType:VIRTUAL_VIEW)		 
 PREHOOK: query: DESCRIBE FORMATTED view8
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@view8
 POSTHOOK: query: DESCRIBE FORMATTED view8
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@view8
 POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 # col_name            	data_type           	comment             
 	 	 
@@ -772,8 +814,10 @@ POSTHOOK: Output: default@view9
 POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE EXTENDED view9
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@view9
 POSTHOOK: query: DESCRIBE EXTENDED view9
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@view9
 POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 m                   	int                 	                    
 	 	 
@@ -782,8 +826,10 @@ FROM src, viewExpandedText:SELECT `_c0` AS `m` FROM (SELECT `test_max`(length(`s
 FROM `default`.`src`) `view9`, tableType:VIRTUAL_VIEW)		 
 PREHOOK: query: DESCRIBE FORMATTED view9
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@view9
 POSTHOOK: query: DESCRIBE FORMATTED view9
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@view9
 POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 # col_name            	data_type           	comment             
 	 	 
@@ -849,8 +895,10 @@ POSTHOOK: Output: default@view9
 POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE EXTENDED view9
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@view9
 POSTHOOK: query: DESCRIBE EXTENDED view9
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@view9
 POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 m                   	int                 	                    
 	 	 
@@ -859,8 +907,10 @@ FROM src, viewExpandedText:SELECT `_c0` AS `m` FROM (SELECT `test_max`(length(`s
 FROM `default`.`src`) `view9`, tableType:VIRTUAL_VIEW)		 
 PREHOOK: query: DESCRIBE FORMATTED view9
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@view9
 POSTHOOK: query: DESCRIBE FORMATTED view9
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@view9
 POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 # col_name            	data_type           	comment             
 	 	 
@@ -915,8 +965,10 @@ POSTHOOK: Output: default@view10
 POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE EXTENDED view10
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@view10
 POSTHOOK: query: DESCRIBE EXTENDED view10
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@view10
 POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 key                 	string              	                    
 value               	string              	                    
@@ -924,8 +976,10 @@ value               	string
 #### A masked pattern was here ####
 PREHOOK: query: DESCRIBE FORMATTED view10
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@view10
 POSTHOOK: query: DESCRIBE FORMATTED view10
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@view10
 POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 # col_name            	data_type           	comment             
 	 	 
@@ -990,8 +1044,10 @@ POSTHOOK: Output: default@view11
 POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE EXTENDED view11
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@view11
 POSTHOOK: query: DESCRIBE EXTENDED view11
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@view11
 POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 boom                	int                 	                    
 	 	 
@@ -1000,8 +1056,10 @@ FROM table1, viewExpandedText:SELECT `test_explode`(array(1,2,3)) AS (`boom`)
 FROM `default`.`table1`, tableType:VIRTUAL_VIEW)		 
 PREHOOK: query: DESCRIBE FORMATTED view11
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@view11
 POSTHOOK: query: DESCRIBE FORMATTED view11
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@view11
 POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 # col_name            	data_type           	comment             
 	 	 
@@ -1058,8 +1116,10 @@ POSTHOOK: Output: default@view12
 POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE EXTENDED view12
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@view12
 POSTHOOK: query: DESCRIBE EXTENDED view12
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@view12
 POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 key                 	string              	                    
 value               	string              	                    
@@ -1068,8 +1128,10 @@ mycol               	int
 #### A masked pattern was here ####
 PREHOOK: query: DESCRIBE FORMATTED view12
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@view12
 POSTHOOK: query: DESCRIBE FORMATTED view12
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@view12
 POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 # col_name            	data_type           	comment             
 	 	 
@@ -1144,8 +1206,10 @@ POSTHOOK: Output: default@view13
 POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE EXTENDED view13
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@view13
 POSTHOOK: query: DESCRIBE EXTENDED view13
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@view13
 POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 key                 	int                 	                    
 	 	 
@@ -1154,8 +1218,10 @@ FROM srcbucket TABLESAMPLE (BUCKET 1 OUT OF 5 ON key) s, viewExpandedText:SELECT
 FROM `default`.`srcbucket` TABLESAMPLE (BUCKET 1 OUT OF 5 ON `key`) `s`, tableType:VIRTUAL_VIEW)		 
 PREHOOK: query: DESCRIBE FORMATTED view13
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@view13
 POSTHOOK: query: DESCRIBE FORMATTED view13
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@view13
 POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 # col_name            	data_type           	comment             
 	 	 
@@ -1241,8 +1307,10 @@ POSTHOOK: Output: default@view14
 POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE EXTENDED view14
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@view14
 POSTHOOK: query: DESCRIBE EXTENDED view14
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@view14
 POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 k1                  	string              	                    
 v1                  	string              	                    
@@ -1270,8 +1338,10 @@ JOIN
 ON (`unionsrc1`.`key` = `unionsrc2`.`key`), tableType:VIRTUAL_VIEW)		 
 PREHOOK: query: DESCRIBE FORMATTED view14
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@view14
 POSTHOOK: query: DESCRIBE FORMATTED view14
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@view14
 POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 # col_name            	data_type           	comment             
 	 	 
@@ -1373,8 +1443,10 @@ POSTHOOK: Output: default@view15
 POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE EXTENDED view15
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@view15
 POSTHOOK: query: DESCRIBE EXTENDED view15
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@view15
 POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 key                 	string              	                    
 value_count         	bigint              	                    
@@ -1386,8 +1458,10 @@ FROM `default`.`src`
 GROUP BY `src`.`key`, tableType:VIRTUAL_VIEW)		 
 PREHOOK: query: DESCRIBE FORMATTED view15
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@view15
 POSTHOOK: query: DESCRIBE FORMATTED view15
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@view15
 POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 # col_name            	data_type           	comment             
 	 	 
@@ -1460,8 +1534,10 @@ POSTHOOK: Output: default@view16
 POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE EXTENDED view16
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@view16
 POSTHOOK: query: DESCRIBE EXTENDED view16
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@view16
 POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 value               	string              	                    
 	 	 
@@ -1470,8 +1546,10 @@ FROM src, viewExpandedText:SELECT DISTINCT `src`.`value`
 FROM `default`.`src`, tableType:VIRTUAL_VIEW)		 
 PREHOOK: query: DESCRIBE FORMATTED view16
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@view16
 POSTHOOK: query: DESCRIBE FORMATTED view16
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@view16
 POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 # col_name            	data_type           	comment             
 	 	 
@@ -1538,8 +1616,10 @@ POSTHOOK: Output: default@view16
 POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE view16
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@view16
 POSTHOOK: query: DESCRIBE view16
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@view16
 POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 value               	string              	                    
 PREHOOK: query: -- Likewise, DROP VIEW IF EXISTS should ignore a matching table name
@@ -1555,8 +1635,10 @@ POSTHOOK: Output: default@table1
 POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE table1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@table1
 POSTHOOK: query: DESCRIBE table1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@table1
 POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 key                 	int                 	                    
 value               	string              	                    
diff --git a/ql/src/test/results/clientpositive/create_view_partitioned.q.out b/ql/src/test/results/clientpositive/create_view_partitioned.q.out
index 07fdba97e3..021639554d 100644
--- a/ql/src/test/results/clientpositive/create_view_partitioned.q.out
+++ b/ql/src/test/results/clientpositive/create_view_partitioned.q.out
@@ -33,8 +33,10 @@ POSTHOOK: Input: default@src
 POSTHOOK: Output: default@vp1
 PREHOOK: query: DESCRIBE EXTENDED vp1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@vp1
 POSTHOOK: query: DESCRIBE EXTENDED vp1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@vp1
 key                 	string              	                    
 value               	string              	                    
 	 	 
@@ -50,8 +52,10 @@ FROM `default`.`src`
 WHERE `src`.`key`=86, tableType:VIRTUAL_VIEW)		 
 PREHOOK: query: DESCRIBE FORMATTED vp1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@vp1
 POSTHOOK: query: DESCRIBE FORMATTED vp1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@vp1
 # col_name            	data_type           	comment             
 	 	 
 key                 	string              	                    
@@ -149,14 +153,18 @@ POSTHOOK: Input: default@vp1
 POSTHOOK: Output: default@vp1
 PREHOOK: query: SHOW PARTITIONS vp1
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@vp1
 POSTHOOK: query: SHOW PARTITIONS vp1
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@vp1
 value=val_86
 value=val_xyz
 PREHOOK: query: SHOW PARTITIONS vp1 PARTITION(value='val_86')
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@vp1
 POSTHOOK: query: SHOW PARTITIONS vp1 PARTITION(value='val_86')
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@vp1
 value=val_86
 PREHOOK: query: SHOW TABLE EXTENDED LIKE vp1
 PREHOOK: type: SHOW_TABLESTATUS
@@ -206,8 +214,10 @@ POSTHOOK: type: ALTERTABLE_DROPPARTS
 POSTHOOK: Input: default@vp1
 PREHOOK: query: SHOW PARTITIONS vp1
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@vp1
 POSTHOOK: query: SHOW PARTITIONS vp1
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@vp1
 value=val_86
 PREHOOK: query: -- Even though no partition predicate is specified in the next query,
 -- the WHERE clause inside of the view should satisfy strict mode.
@@ -245,8 +255,10 @@ POSTHOOK: Input: default@srcpart
 POSTHOOK: Output: default@vp2
 PREHOOK: query: DESCRIBE FORMATTED vp2
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@vp2
 POSTHOOK: query: DESCRIBE FORMATTED vp2
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@vp2
 # col_name            	data_type           	comment             
 	 	 
 key                 	string              	                    
@@ -356,8 +368,10 @@ POSTHOOK: Input: default@src
 POSTHOOK: Output: default@vp3
 PREHOOK: query: DESCRIBE FORMATTED vp3
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@vp3
 POSTHOOK: query: DESCRIBE FORMATTED vp3
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@vp3
 # col_name            	data_type           	comment             
 	 	 
 k                   	string              	                    
diff --git a/ql/src/test/results/clientpositive/create_view_translate.q.out b/ql/src/test/results/clientpositive/create_view_translate.q.out
index cffe2ea8fe..26dad2f25c 100644
--- a/ql/src/test/results/clientpositive/create_view_translate.q.out
+++ b/ql/src/test/results/clientpositive/create_view_translate.q.out
@@ -15,8 +15,10 @@ POSTHOOK: Input: default@src
 POSTHOOK: Output: default@v
 PREHOOK: query: describe formatted v
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@v
 POSTHOOK: query: describe formatted v
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@v
 # col_name            	data_type           	comment             
 	 	 
 key                 	string              	                    
@@ -55,8 +57,10 @@ POSTHOOK: Input: default@src
 POSTHOOK: Output: default@w
 PREHOOK: query: describe formatted w
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@w
 POSTHOOK: query: describe formatted w
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@w
 # col_name            	data_type           	comment             
 	 	 
 key                 	string              	                    
diff --git a/ql/src/test/results/clientpositive/ctas_colname.q.out b/ql/src/test/results/clientpositive/ctas_colname.q.out
index 12e2e02298..524ef404a1 100644
--- a/ql/src/test/results/clientpositive/ctas_colname.q.out
+++ b/ql/src/test/results/clientpositive/ctas_colname.q.out
@@ -83,8 +83,10 @@ POSTHOOK: Input: default@src
 POSTHOOK: Output: default@summary
 PREHOOK: query: describe formatted summary
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@summary
 POSTHOOK: query: describe formatted summary
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@summary
 # col_name            	data_type           	comment             
 	 	 
 _col0               	double              	                    
@@ -197,8 +199,10 @@ POSTHOOK: Input: default@src1
 POSTHOOK: Output: default@x4
 PREHOOK: query: describe formatted x4
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@x4
 POSTHOOK: query: describe formatted x4
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@x4
 # col_name            	data_type           	comment             
 	 	 
 key                 	string              	                    
@@ -357,8 +361,10 @@ POSTHOOK: Input: default@src
 POSTHOOK: Output: default@x5
 PREHOOK: query: describe formatted x5
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@x5
 POSTHOOK: query: describe formatted x5
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@x5
 # col_name            	data_type           	comment             
 	 	 
 key                 	string              	                    
@@ -497,8 +503,10 @@ POSTHOOK: Input: default@src1
 POSTHOOK: Output: default@x6
 PREHOOK: query: describe formatted x6
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@x6
 POSTHOOK: query: describe formatted x6
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@x6
 # col_name            	data_type           	comment             
 	 	 
 _col0               	string              	                    
@@ -616,8 +624,10 @@ POSTHOOK: Input: default@src
 POSTHOOK: Output: default@x7
 PREHOOK: query: describe formatted x7
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@x7
 POSTHOOK: query: describe formatted x7
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@x7
 # col_name            	data_type           	comment             
 	 	 
 _col0               	string              	                    
@@ -1045,8 +1055,10 @@ POSTHOOK: Input: default@src
 POSTHOOK: Output: default@x8
 PREHOOK: query: describe formatted x8
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@x8
 POSTHOOK: query: describe formatted x8
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@x8
 # col_name            	data_type           	comment             
 	 	 
 _col0               	string              	                    
@@ -1176,8 +1188,10 @@ POSTHOOK: Input: default@src
 POSTHOOK: Output: default@x9
 PREHOOK: query: describe formatted x9
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@x9
 POSTHOOK: query: describe formatted x9
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@x9
 # col_name            	data_type           	comment             
 	 	 
 _c0                 	string              	                    
diff --git a/ql/src/test/results/clientpositive/ctas_hadoop20.q.out b/ql/src/test/results/clientpositive/ctas_hadoop20.q.out
index fc79856025..1f25cacfd2 100644
--- a/ql/src/test/results/clientpositive/ctas_hadoop20.q.out
+++ b/ql/src/test/results/clientpositive/ctas_hadoop20.q.out
@@ -125,8 +125,10 @@ POSTHOOK: Input: default@nzhang_ctas1
 104	val_104
 PREHOOK: query: describe formatted nzhang_CTAS1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@nzhang_ctas1
 POSTHOOK: query: describe formatted nzhang_CTAS1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@nzhang_ctas1
 # col_name            	data_type           	comment             
 	 	 
 k                   	string              	                    
@@ -265,8 +267,10 @@ POSTHOOK: Input: default@nzhang_ctas2
 104	val_104
 PREHOOK: query: describe formatted nzhang_CTAS2
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@nzhang_ctas2
 POSTHOOK: query: describe formatted nzhang_CTAS2
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@nzhang_ctas2
 # col_name            	data_type           	comment             
 	 	 
 key                 	string              	                    
@@ -406,8 +410,10 @@ POSTHOOK: Input: default@nzhang_ctas3
 4.5	val_9_con
 PREHOOK: query: describe formatted nzhang_CTAS3
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@nzhang_ctas3
 POSTHOOK: query: describe formatted nzhang_CTAS3
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@nzhang_ctas3
 # col_name            	data_type           	comment             
 	 	 
 half_key            	double              	                    
@@ -469,8 +475,10 @@ POSTHOOK: Input: default@nzhang_ctas3
 4.5	val_9_con
 PREHOOK: query: describe formatted nzhang_CTAS3
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@nzhang_ctas3
 POSTHOOK: query: describe formatted nzhang_CTAS3
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@nzhang_ctas3
 # col_name            	data_type           	comment             
 	 	 
 half_key            	double              	                    
@@ -610,8 +618,10 @@ POSTHOOK: Input: default@nzhang_ctas4
 104	val_104
 PREHOOK: query: describe formatted nzhang_CTAS4
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@nzhang_ctas4
 POSTHOOK: query: describe formatted nzhang_CTAS4
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@nzhang_ctas4
 # col_name            	data_type           	comment             
 	 	 
 key                 	string              	                    
@@ -919,8 +929,10 @@ POSTHOOK: Lineage: nzhang_ctas6.key SIMPLE [(src)src.FieldSchema(name:key, type:
 POSTHOOK: Lineage: nzhang_ctas6.to SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: desc nzhang_ctas8
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@nzhang_ctas8
 POSTHOOK: query: desc nzhang_ctas8
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@nzhang_ctas8
 POSTHOOK: Lineage: nzhang_ctas6.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: nzhang_ctas6.to SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 _c0                 	decimal(3,2)        	                    
diff --git a/ql/src/test/results/clientpositive/ctas_uses_database_location.q.out b/ql/src/test/results/clientpositive/ctas_uses_database_location.q.out
index 8bcee93eb8..a2c8c4a874 100644
--- a/ql/src/test/results/clientpositive/ctas_uses_database_location.q.out
+++ b/ql/src/test/results/clientpositive/ctas_uses_database_location.q.out
@@ -118,8 +118,10 @@ POSTHOOK: Input: default@src
 POSTHOOK: Output: db1@table_db1
 PREHOOK: query: DESCRIBE FORMATTED table_db1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: db1@table_db1
 POSTHOOK: query: DESCRIBE FORMATTED table_db1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: db1@table_db1
 # col_name            	data_type           	comment             
 	 	 
 key                 	string              	                    
diff --git a/ql/src/test/results/clientpositive/custom_input_output_format.q.out b/ql/src/test/results/clientpositive/custom_input_output_format.q.out
index 03d3291519..c29bc4ff09 100644
--- a/ql/src/test/results/clientpositive/custom_input_output_format.q.out
+++ b/ql/src/test/results/clientpositive/custom_input_output_format.q.out
@@ -11,8 +11,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@src1_rot13_iof
 PREHOOK: query: DESCRIBE EXTENDED src1_rot13_iof
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@src1_rot13_iof
 POSTHOOK: query: DESCRIBE EXTENDED src1_rot13_iof
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@src1_rot13_iof
 key                 	string              	                    
 value               	string              	                    
 	 	 
diff --git a/ql/src/test/results/clientpositive/database.q.out b/ql/src/test/results/clientpositive/database.q.out
index d457946ba4..3c3c76cab8 100644
--- a/ql/src/test/results/clientpositive/database.q.out
+++ b/ql/src/test/results/clientpositive/database.q.out
@@ -136,16 +136,20 @@ test_table
 PREHOOK: query: -- DESCRIBE table in non-default DB
 DESCRIBE test_table
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: test_db@test_table
 POSTHOOK: query: -- DESCRIBE table in non-default DB
 DESCRIBE test_table
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: test_db@test_table
 col1                	string              	                    
 PREHOOK: query: -- DESCRIBE EXTENDED in non-default DB
 DESCRIBE EXTENDED test_table
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: test_db@test_table
 POSTHOOK: query: -- DESCRIBE EXTENDED in non-default DB
 DESCRIBE EXTENDED test_table
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: test_db@test_table
 col1                	string              	                    
 	 	 
 #### A masked pattern was here ####
@@ -166,8 +170,10 @@ test_table
 test_table_like
 PREHOOK: query: DESCRIBE EXTENDED test_table_like
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: test_db@test_table_like
 POSTHOOK: query: DESCRIBE EXTENDED test_table_like
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: test_db@test_table_like
 col1                	string              	                    
 	 	 
 #### A masked pattern was here ####
@@ -1395,8 +1401,10 @@ POSTHOOK: Lineage: bucketized_src.value SIMPLE [(src)src.FieldSchema(name:value,
 POSTHOOK: Lineage: temp_tbl2.c EXPRESSION [(temp_tbl)temp_tbl.null, ]
 PREHOOK: query: DESC EXTENDED src1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: db2@src1
 POSTHOOK: query: DESC EXTENDED src1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: db2@src1
 POSTHOOK: Lineage: bucketized_src.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: bucketized_src.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: temp_tbl2.c EXPRESSION [(temp_tbl)temp_tbl.null, ]
diff --git a/ql/src/test/results/clientpositive/database_location.q.out b/ql/src/test/results/clientpositive/database_location.q.out
index 658692746c..a11653e23a 100644
--- a/ql/src/test/results/clientpositive/database_location.q.out
+++ b/ql/src/test/results/clientpositive/database_location.q.out
@@ -20,8 +20,10 @@ POSTHOOK: Output: database:db1
 POSTHOOK: Output: db1@table_db1
 PREHOOK: query: DESCRIBE FORMATTED table_db1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: db1@table_db1
 POSTHOOK: query: DESCRIBE FORMATTED table_db1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: db1@table_db1
 # col_name            	data_type           	comment             
 	 	 
 name                	string              	                    
@@ -80,8 +82,10 @@ POSTHOOK: Output: database:db2
 POSTHOOK: Output: db2@table_db2
 PREHOOK: query: DESCRIBE FORMATTED table_db2
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: db2@table_db2
 POSTHOOK: query: DESCRIBE FORMATTED table_db2
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: db2@table_db2
 # col_name            	data_type           	comment             
 	 	 
 name                	string              	                    
diff --git a/ql/src/test/results/clientpositive/dbtxnmgr_query5.q.out b/ql/src/test/results/clientpositive/dbtxnmgr_query5.q.out
index 9ab665cad4..0244f45ce3 100644
--- a/ql/src/test/results/clientpositive/dbtxnmgr_query5.q.out
+++ b/ql/src/test/results/clientpositive/dbtxnmgr_query5.q.out
@@ -35,8 +35,10 @@ t1
 v1
 PREHOOK: query: describe T1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: foo@t1
 POSTHOOK: query: describe T1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: foo@t1
 key                 	string              	                    
 val                 	string              	                    
 ds                  	string              	                    
diff --git a/ql/src/test/results/clientpositive/ddltime.q.out b/ql/src/test/results/clientpositive/ddltime.q.out
index 7c5154d59f..34aa837b68 100644
--- a/ql/src/test/results/clientpositive/ddltime.q.out
+++ b/ql/src/test/results/clientpositive/ddltime.q.out
@@ -7,8 +7,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@T1
 PREHOOK: query: desc extended T1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@t1
 POSTHOOK: query: desc extended T1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@t1
 key                 	string              	default             
 value               	string              	default             
 	 	 
@@ -25,8 +27,10 @@ POSTHOOK: Lineage: t1.key SIMPLE [(src)src.FieldSchema(name:key, type:string, co
 POSTHOOK: Lineage: t1.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: desc extended T1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@t1
 POSTHOOK: query: desc extended T1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@t1
 POSTHOOK: Lineage: t1.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: t1.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 key                 	string              	default             
@@ -47,8 +51,10 @@ POSTHOOK: Lineage: t1.value SIMPLE [(src)src.FieldSchema(name:value, type:string
 POSTHOOK: Lineage: t1.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: desc extended T1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@t1
 POSTHOOK: query: desc extended T1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@t1
 POSTHOOK: Lineage: t1.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: t1.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: t1.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
@@ -73,8 +79,10 @@ POSTHOOK: Lineage: t1.value SIMPLE [(src)src.FieldSchema(name:value, type:string
 POSTHOOK: Lineage: t1.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: desc extended T1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@t1
 POSTHOOK: query: desc extended T1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@t1
 POSTHOOK: Lineage: t1.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: t1.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: t1.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -100,8 +108,10 @@ POSTHOOK: Lineage: t1.value SIMPLE [(src)src.FieldSchema(name:value, type:string
 POSTHOOK: Lineage: t1.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: desc extended T2
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@t2
 POSTHOOK: query: desc extended T2
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@t2
 POSTHOOK: Lineage: t1.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: t1.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: t1.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -138,8 +148,10 @@ POSTHOOK: Lineage: t2 PARTITION(ds=2010-06-21,hr=1).key SIMPLE [(src)src.FieldSc
 POSTHOOK: Lineage: t2 PARTITION(ds=2010-06-21,hr=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: desc extended T2 partition (ds = '2010-06-21', hr = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@t2
 POSTHOOK: query: desc extended T2 partition (ds = '2010-06-21', hr = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@t2
 POSTHOOK: Lineage: t1.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: t1.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: t1.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -180,8 +192,10 @@ POSTHOOK: Lineage: t2 PARTITION(ds=2010-06-21,hr=1).key SIMPLE [(src)src.FieldSc
 POSTHOOK: Lineage: t2 PARTITION(ds=2010-06-21,hr=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: desc extended T2 partition (ds = '2010-06-21', hr = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@t2
 POSTHOOK: query: desc extended T2 partition (ds = '2010-06-21', hr = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@t2
 POSTHOOK: Lineage: t1.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: t1.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: t1.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -226,8 +240,10 @@ POSTHOOK: Lineage: t2 PARTITION(ds=2010-06-21,hr=1).key SIMPLE [(src)src.FieldSc
 POSTHOOK: Lineage: t2 PARTITION(ds=2010-06-21,hr=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: desc extended T2 partition(ds='2010-06-01', hr='1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@t2
 POSTHOOK: query: desc extended T2 partition(ds='2010-06-01', hr='1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@t2
 POSTHOOK: Lineage: t1.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: t1.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: t1.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/decimal_1.q.out b/ql/src/test/results/clientpositive/decimal_1.q.out
index c227ef22a6..a814f6320a 100644
--- a/ql/src/test/results/clientpositive/decimal_1.q.out
+++ b/ql/src/test/results/clientpositive/decimal_1.q.out
@@ -19,8 +19,10 @@ POSTHOOK: Input: default@decimal_1
 POSTHOOK: Output: default@decimal_1
 PREHOOK: query: desc decimal_1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@decimal_1
 POSTHOOK: query: desc decimal_1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@decimal_1
 t                   	decimal(4,2)        	                    
 u                   	decimal(5,0)        	                    
 v                   	decimal(10,0)       	                    
diff --git a/ql/src/test/results/clientpositive/decimal_6.q.out b/ql/src/test/results/clientpositive/decimal_6.q.out
index 30934c2dea..4338b52981 100644
--- a/ql/src/test/results/clientpositive/decimal_6.q.out
+++ b/ql/src/test/results/clientpositive/decimal_6.q.out
@@ -133,7 +133,9 @@ POSTHOOK: Input: default@decimal_6_1
 POSTHOOK: Output: default@DECIMAL_6_3
 PREHOOK: query: desc DECIMAL_6_3
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@decimal_6_3
 POSTHOOK: query: desc DECIMAL_6_3
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@decimal_6_3
 k                   	double              	                    
 v                   	int                 	                    
diff --git a/ql/src/test/results/clientpositive/default_partition_name.q.out b/ql/src/test/results/clientpositive/default_partition_name.q.out
index 109edcff8d..c3690ba188 100644
--- a/ql/src/test/results/clientpositive/default_partition_name.q.out
+++ b/ql/src/test/results/clientpositive/default_partition_name.q.out
@@ -14,6 +14,8 @@ POSTHOOK: Output: default@default_partition_name
 POSTHOOK: Output: default@default_partition_name@ds=__HIVE_DEFAULT_PARTITION__
 PREHOOK: query: show partitions default_partition_name
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@default_partition_name
 POSTHOOK: query: show partitions default_partition_name
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@default_partition_name
 ds=__HIVE_DEFAULT_PARTITION__
diff --git a/ql/src/test/results/clientpositive/desc_tbl_part_cols.q.out b/ql/src/test/results/clientpositive/desc_tbl_part_cols.q.out
index 68a456b5a4..843626a112 100644
--- a/ql/src/test/results/clientpositive/desc_tbl_part_cols.q.out
+++ b/ql/src/test/results/clientpositive/desc_tbl_part_cols.q.out
@@ -7,8 +7,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@t1
 PREHOOK: query: describe t1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@t1
 POSTHOOK: query: describe t1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@t1
 a                   	int                 	                    
 b                   	string              	                    
 c                   	int                 	                    
@@ -21,8 +23,10 @@ c                   	int
 d                   	string              	                    
 PREHOOK: query: describe t1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@t1
 POSTHOOK: query: describe t1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@t1
 a                   	int                 	                    
 b                   	string              	                    
 c                   	int                 	                    
diff --git a/ql/src/test/results/clientpositive/describe_comment_indent.q.out b/ql/src/test/results/clientpositive/describe_comment_indent.q.out
index c402a59993..79826e8164 100644
--- a/ql/src/test/results/clientpositive/describe_comment_indent.q.out
+++ b/ql/src/test/results/clientpositive/describe_comment_indent.q.out
@@ -27,8 +27,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@test_table
 PREHOOK: query: DESCRIBE test_table
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE test_table
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 col1                	int                 	col1 one line comment
 col2                	string              	col2                
                     	                    	two lines comment
@@ -37,8 +39,10 @@ col3                	string              	col3
                     	                    	comment
 PREHOOK: query: DESCRIBE FORMATTED test_table
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE FORMATTED test_table
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 # col_name            	data_type           	comment             
 	 	 
 col1                	int                 	col1 one line comment
diff --git a/ql/src/test/results/clientpositive/describe_comment_nonascii.q.out b/ql/src/test/results/clientpositive/describe_comment_nonascii.q.out
index 12924a6e94..3600454461 100644
--- a/ql/src/test/results/clientpositive/describe_comment_nonascii.q.out
+++ b/ql/src/test/results/clientpositive/describe_comment_nonascii.q.out
@@ -35,8 +35,10 @@ POSTHOOK: Input: default@dummy
 POSTHOOK: Output: default@dummy
 PREHOOK: query: DESCRIBE FORMATTED dummy
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@dummy
 POSTHOOK: query: DESCRIBE FORMATTED dummy
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@dummy
 # col_name            	data_type           	comment             
 	 	 
 col1                	string              	_col1             
diff --git a/ql/src/test/results/clientpositive/describe_formatted_view_partitioned.q.out b/ql/src/test/results/clientpositive/describe_formatted_view_partitioned.q.out
index 529d4f26c3..73d4389204 100644
--- a/ql/src/test/results/clientpositive/describe_formatted_view_partitioned.q.out
+++ b/ql/src/test/results/clientpositive/describe_formatted_view_partitioned.q.out
@@ -34,8 +34,10 @@ POSTHOOK: Output: default@view_partitioned
 POSTHOOK: Output: default@view_partitioned@value=val_86
 PREHOOK: query: DESCRIBE FORMATTED view_partitioned PARTITION (value='val_86')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@view_partitioned
 POSTHOOK: query: DESCRIBE FORMATTED view_partitioned PARTITION (value='val_86')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@view_partitioned
 # col_name            	data_type           	comment             
 	 	 
 key                 	string              	                    
diff --git a/ql/src/test/results/clientpositive/describe_formatted_view_partitioned_json.q.out b/ql/src/test/results/clientpositive/describe_formatted_view_partitioned_json.q.out
index 7996c7d6ac..8435ebeb76 100644
--- a/ql/src/test/results/clientpositive/describe_formatted_view_partitioned_json.q.out
+++ b/ql/src/test/results/clientpositive/describe_formatted_view_partitioned_json.q.out
@@ -34,8 +34,10 @@ POSTHOOK: Output: default@view_partitioned
 POSTHOOK: Output: default@view_partitioned@value=val_86
 PREHOOK: query: DESCRIBE FORMATTED view_partitioned PARTITION (value='val_86')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@view_partitioned
 POSTHOOK: query: DESCRIBE FORMATTED view_partitioned PARTITION (value='val_86')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@view_partitioned
 {"columns":[{"name":"key","type":"string"}]}	 	 
 PREHOOK: query: DROP VIEW view_partitioned
 PREHOOK: type: DROPVIEW
diff --git a/ql/src/test/results/clientpositive/describe_pretty.q.out b/ql/src/test/results/clientpositive/describe_pretty.q.out
index 204433b2cf..527529b002 100644
--- a/ql/src/test/results/clientpositive/describe_pretty.q.out
+++ b/ql/src/test/results/clientpositive/describe_pretty.q.out
@@ -53,6 +53,7 @@ PREHOOK: query: -- There will be an extra tab at the end of each comment line in
 
 DESCRIBE PRETTY test_table
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: -- There will be an extra tab at the end of each comment line in the output.
 -- This is because DESCRIBE <table_name> command separates the column, type and
 -- comment field using a \t. DESCRIBE PRETTY <table_name> uses spaces instead 
@@ -69,6 +70,7 @@ POSTHOOK: query: -- There will be an extra tab at the end of each comment line i
 
 DESCRIBE PRETTY test_table
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 col_name           data_type     comment	 	 
 	 	 
 col1               int           col1 one line comment	 	 
@@ -94,8 +96,10 @@ col6               string        This comment has a very long single word ABCDEF
 col7_nocomment     string        	 	 
 PREHOOK: query: DESCRIBE PRETTY test_table
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE PRETTY test_table
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 col_name           data_type     comment	 	 
 	 	 
 col1               int           col1 one line comment	 	 
@@ -112,8 +116,10 @@ col6               string        This comment has a very long single word ABCDEF
 col7_nocomment     string        	 	 
 PREHOOK: query: DESCRIBE PRETTY test_table
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE PRETTY test_table
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 col_name           data_type     comment	 	 
 	 	 
 col1               int           col1 one line	 	 
@@ -160,8 +166,10 @@ col6               string        This comment has
 col7_nocomment     string        	 	 
 PREHOOK: query: DESCRIBE PRETTY test_table
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE PRETTY test_table
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 col_name           data_type     comment	 	 
 	 	 
 col1               int           col1 one line comment	 	 
@@ -216,8 +224,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@test_table_very_long_column_name
 PREHOOK: query: DESCRIBE PRETTY test_table_very_long_column_name
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table_very_long_column_name
 POSTHOOK: query: DESCRIBE PRETTY test_table_very_long_column_name
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table_very_long_column_name
 col_name                          data_type     comment	 	 
 	 	 
 col1                              int           col1 one line comment	 	 
@@ -232,8 +242,10 @@ col4                              string        col4 very long comment that is
                                                 lines	 	 
 PREHOOK: query: DESCRIBE PRETTY test_table_very_long_column_name
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table_very_long_column_name
 POSTHOOK: query: DESCRIBE PRETTY test_table_very_long_column_name
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table_very_long_column_name
 col_name                          data_type     comment	 	 
 	 	 
 col1                              int           col1 one	 	 
@@ -297,8 +309,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@test_table_partitioned
 PREHOOK: query: DESCRIBE PRETTY test_table_partitioned
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table_partitioned
 POSTHOOK: query: DESCRIBE PRETTY test_table_partitioned
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table_partitioned
 col_name           data_type     comment	 	 
 	 	 
 col1               int           col1 one line comment	 	 
diff --git a/ql/src/test/results/clientpositive/describe_syntax.q.out b/ql/src/test/results/clientpositive/describe_syntax.q.out
index 8c3d6e55ce..f322ed8c71 100644
--- a/ql/src/test/results/clientpositive/describe_syntax.q.out
+++ b/ql/src/test/results/clientpositive/describe_syntax.q.out
@@ -37,9 +37,11 @@ POSTHOOK: Output: db1@t1@ds=4/part=5
 PREHOOK: query: -- describe table
 DESCRIBE t1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: db1@t1
 POSTHOOK: query: -- describe table
 DESCRIBE t1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: db1@t1
 key1                	int                 	                    
 value1              	string              	                    
 ds                  	string              	                    
@@ -52,8 +54,10 @@ ds                  	string
 part                	string              	                    
 PREHOOK: query: DESCRIBE EXTENDED t1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: db1@t1
 POSTHOOK: query: DESCRIBE EXTENDED t1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: db1@t1
 key1                	int                 	                    
 value1              	string              	                    
 ds                  	string              	                    
@@ -68,8 +72,10 @@ part                	string
 #### A masked pattern was here ####
 PREHOOK: query: DESCRIBE FORMATTED t1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: db1@t1
 POSTHOOK: query: DESCRIBE FORMATTED t1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: db1@t1
 # col_name            	data_type           	comment             
 	 	 
 key1                	int                 	                    
@@ -104,9 +110,11 @@ Storage Desc Params:
 PREHOOK: query: -- describe database.table
 DESCRIBE db1.t1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: db1@t1
 POSTHOOK: query: -- describe database.table
 DESCRIBE db1.t1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: db1@t1
 key1                	int                 	                    
 value1              	string              	                    
 ds                  	string              	                    
@@ -119,8 +127,10 @@ ds                  	string
 part                	string              	                    
 PREHOOK: query: DESCRIBE EXTENDED db1.t1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: db1@t1
 POSTHOOK: query: DESCRIBE EXTENDED db1.t1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: db1@t1
 key1                	int                 	                    
 value1              	string              	                    
 ds                  	string              	                    
@@ -135,8 +145,10 @@ part                	string
 #### A masked pattern was here ####
 PREHOOK: query: DESCRIBE FORMATTED db1.t1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: db1@t1
 POSTHOOK: query: DESCRIBE FORMATTED db1.t1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: db1@t1
 # col_name            	data_type           	comment             
 	 	 
 key1                	int                 	                    
@@ -171,38 +183,50 @@ Storage Desc Params:
 PREHOOK: query: -- describe table column
 DESCRIBE t1 key1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: db1@t1
 POSTHOOK: query: -- describe table column
 DESCRIBE t1 key1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: db1@t1
 key1                	int                 	from deserializer   
 PREHOOK: query: DESCRIBE EXTENDED t1 key1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: db1@t1
 POSTHOOK: query: DESCRIBE EXTENDED t1 key1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: db1@t1
 key1                	int                 	from deserializer   
 PREHOOK: query: DESCRIBE FORMATTED t1 key1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: db1@t1
 POSTHOOK: query: DESCRIBE FORMATTED t1 key1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: db1@t1
 # col_name            	data_type           	comment             
 	 	 
 key1                	int                 	from deserializer   
 PREHOOK: query: -- describe database.tabe column
 DESCRIBE db1.t1 key1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: db1@t1
 POSTHOOK: query: -- describe database.tabe column
 DESCRIBE db1.t1 key1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: db1@t1
 key1                	int                 	from deserializer   
 PREHOOK: query: DESCRIBE EXTENDED db1.t1 key1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: db1@t1
 POSTHOOK: query: DESCRIBE EXTENDED db1.t1 key1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: db1@t1
 key1                	int                 	from deserializer   
 PREHOOK: query: DESCRIBE FORMATTED db1.t1 key1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: db1@t1
 POSTHOOK: query: DESCRIBE FORMATTED db1.t1 key1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: db1@t1
 # col_name            	data_type           	comment             
 	 	 
 key1                	int                 	from deserializer   
@@ -211,30 +235,38 @@ PREHOOK: query: -- describe table.column
 -- fall back to the old syntax table.column
 DESCRIBE t1.key1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: db1@t1
 POSTHOOK: query: -- describe table.column
 -- after first checking t1.key1 for database.table not valid
 -- fall back to the old syntax table.column
 DESCRIBE t1.key1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: db1@t1
 key1                	int                 	from deserializer   
 PREHOOK: query: DESCRIBE EXTENDED t1.key1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: db1@t1
 POSTHOOK: query: DESCRIBE EXTENDED t1.key1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: db1@t1
 key1                	int                 	from deserializer   
 PREHOOK: query: DESCRIBE FORMATTED t1.key1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: db1@t1
 POSTHOOK: query: DESCRIBE FORMATTED t1.key1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: db1@t1
 # col_name            	data_type           	comment             
 	 	 
 key1                	int                 	from deserializer   
 PREHOOK: query: -- describe table partition
 DESCRIBE t1 PARTITION(ds='4', part='5')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: db1@t1
 POSTHOOK: query: -- describe table partition
 DESCRIBE t1 PARTITION(ds='4', part='5')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: db1@t1
 key1                	int                 	                    
 value1              	string              	                    
 ds                  	string              	                    
@@ -247,8 +279,10 @@ ds                  	string
 part                	string              	                    
 PREHOOK: query: DESCRIBE EXTENDED t1 PARTITION(ds='4', part='5')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: db1@t1
 POSTHOOK: query: DESCRIBE EXTENDED t1 PARTITION(ds='4', part='5')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: db1@t1
 key1                	int                 	                    
 value1              	string              	                    
 ds                  	string              	                    
@@ -263,8 +297,10 @@ part                	string
 #### A masked pattern was here ####
 PREHOOK: query: DESCRIBE FORMATTED t1 PARTITION(ds='4', part='5')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: db1@t1
 POSTHOOK: query: DESCRIBE FORMATTED t1 PARTITION(ds='4', part='5')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: db1@t1
 # col_name            	data_type           	comment             
 	 	 
 key1                	int                 	                    
@@ -299,9 +335,11 @@ Storage Desc Params:
 PREHOOK: query: -- describe database.table partition
 DESCRIBE db1.t1 PARTITION(ds='4', part='5')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: db1@t1
 POSTHOOK: query: -- describe database.table partition
 DESCRIBE db1.t1 PARTITION(ds='4', part='5')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: db1@t1
 key1                	int                 	                    
 value1              	string              	                    
 ds                  	string              	                    
@@ -314,8 +352,10 @@ ds                  	string
 part                	string              	                    
 PREHOOK: query: DESCRIBE EXTENDED db1.t1 PARTITION(ds='4', part='5')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: db1@t1
 POSTHOOK: query: DESCRIBE EXTENDED db1.t1 PARTITION(ds='4', part='5')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: db1@t1
 key1                	int                 	                    
 value1              	string              	                    
 ds                  	string              	                    
@@ -330,8 +370,10 @@ part                	string
 #### A masked pattern was here ####
 PREHOOK: query: DESCRIBE FORMATTED db1.t1 PARTITION(ds='4', part='5')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: db1@t1
 POSTHOOK: query: DESCRIBE FORMATTED db1.t1 PARTITION(ds='4', part='5')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: db1@t1
 # col_name            	data_type           	comment             
 	 	 
 key1                	int                 	                    
diff --git a/ql/src/test/results/clientpositive/describe_table.q.out b/ql/src/test/results/clientpositive/describe_table.q.out
index 22c02de71e..a8b2beca37 100644
--- a/ql/src/test/results/clientpositive/describe_table.q.out
+++ b/ql/src/test/results/clientpositive/describe_table.q.out
@@ -1,7 +1,9 @@
 PREHOOK: query: describe srcpart
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: describe srcpart
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@srcpart
 key                 	string              	default             
 value               	string              	default             
 ds                  	string              	                    
@@ -14,13 +16,17 @@ ds                  	string
 hr                  	string              	                    
 PREHOOK: query: describe srcpart.key
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: describe srcpart.key
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@srcpart
 key                 	string              	from deserializer   
 PREHOOK: query: describe srcpart PARTITION(ds='2008-04-08', hr='12')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: describe srcpart PARTITION(ds='2008-04-08', hr='12')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@srcpart
 key                 	string              	default             
 value               	string              	default             
 ds                  	string              	                    
@@ -33,8 +39,10 @@ ds                  	string
 hr                  	string              	                    
 PREHOOK: query: describe extended srcpart
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: describe extended srcpart
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@srcpart
 key                 	string              	default             
 value               	string              	default             
 ds                  	string              	                    
@@ -49,13 +57,17 @@ hr                  	string
 #### A masked pattern was here ####
 PREHOOK: query: describe extended srcpart.key
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: describe extended srcpart.key
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@srcpart
 key                 	string              	from deserializer   
 PREHOOK: query: describe extended srcpart PARTITION(ds='2008-04-08', hr='12')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: describe extended srcpart PARTITION(ds='2008-04-08', hr='12')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@srcpart
 key                 	string              	default             
 value               	string              	default             
 ds                  	string              	                    
@@ -70,8 +82,10 @@ hr                  	string
 #### A masked pattern was here ####
 PREHOOK: query: describe formatted srcpart
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: describe formatted srcpart
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@srcpart
 # col_name            	data_type           	comment             
 	 	 
 key                 	string              	default             
@@ -105,15 +119,19 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: describe formatted srcpart.key
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: describe formatted srcpart.key
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@srcpart
 # col_name            	data_type           	comment             
 	 	 
 key                 	string              	from deserializer   
 PREHOOK: query: describe formatted srcpart PARTITION(ds='2008-04-08', hr='12')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: describe formatted srcpart PARTITION(ds='2008-04-08', hr='12')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@srcpart
 # col_name            	data_type           	comment             
 	 	 
 key                 	string              	default             
@@ -191,8 +209,10 @@ POSTHOOK: Input: default@srcpart_serdeprops
 POSTHOOK: Output: default@srcpart_serdeprops
 PREHOOK: query: describe formatted srcpart_serdeprops
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@srcpart_serdeprops
 POSTHOOK: query: describe formatted srcpart_serdeprops
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@srcpart_serdeprops
 # col_name            	data_type           	comment             
 	 	 
 key                 	string              	default             
diff --git a/ql/src/test/results/clientpositive/describe_table_json.q.out b/ql/src/test/results/clientpositive/describe_table_json.q.out
index 897f91bfe3..51a5e5c295 100644
--- a/ql/src/test/results/clientpositive/describe_table_json.q.out
+++ b/ql/src/test/results/clientpositive/describe_table_json.q.out
@@ -30,13 +30,17 @@ POSTHOOK: Input: default@jsontable
 POSTHOOK: Output: default@jsontable
 PREHOOK: query: DESCRIBE jsontable
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@jsontable
 POSTHOOK: query: DESCRIBE jsontable
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@jsontable
 {"columns":[{"name":"key","type":"int"},{"name":"value","type":"string"}]}	 	 
 PREHOOK: query: DESCRIBE extended jsontable
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@jsontable
 POSTHOOK: query: DESCRIBE extended jsontable
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@jsontable
 #### A masked pattern was here ####
 PREHOOK: query: DROP TABLE jsontable
 PREHOOK: type: DROPTABLE
diff --git a/ql/src/test/results/clientpositive/describe_xpath.q.out b/ql/src/test/results/clientpositive/describe_xpath.q.out
index da9f44f274..b3325e0177 100644
--- a/ql/src/test/results/clientpositive/describe_xpath.q.out
+++ b/ql/src/test/results/clientpositive/describe_xpath.q.out
@@ -1,44 +1,56 @@
 PREHOOK: query: -- Describe a list structure in a thrift table
 describe src_thrift.lint
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@src_thrift
 POSTHOOK: query: -- Describe a list structure in a thrift table
 describe src_thrift.lint
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@src_thrift
 lint                	array<int>          	from deserializer   
 PREHOOK: query: -- Describe the element of a list
 describe src_thrift.lint.$elem$
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@src_thrift
 POSTHOOK: query: -- Describe the element of a list
 describe src_thrift.lint.$elem$
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@src_thrift
 $elem$              	int                 	from deserializer   
 PREHOOK: query: -- Describe the key of a map
 describe src_thrift.mStringString.$key$
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@src_thrift
 POSTHOOK: query: -- Describe the key of a map
 describe src_thrift.mStringString.$key$
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@src_thrift
 $key$               	string              	from deserializer   
 PREHOOK: query: -- Describe the value of a map
 describe src_thrift.mStringString.$value$
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@src_thrift
 POSTHOOK: query: -- Describe the value of a map
 describe src_thrift.mStringString.$value$
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@src_thrift
 $value$             	string              	from deserializer   
 PREHOOK: query: -- Describe a complex element of a list
 describe src_thrift.lintString.$elem$
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@src_thrift
 POSTHOOK: query: -- Describe a complex element of a list
 describe src_thrift.lintString.$elem$
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@src_thrift
 myint               	int                 	from deserializer   
 mystring            	string              	from deserializer   
 underscore_int      	int                 	from deserializer   
 PREHOOK: query: -- Describe a member of an element of a list
 describe src_thrift.lintString.$elem$.myint
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@src_thrift
 POSTHOOK: query: -- Describe a member of an element of a list
 describe src_thrift.lintString.$elem$.myint
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@src_thrift
 myint               	int                 	from deserializer   
diff --git a/ql/src/test/results/clientpositive/drop_multi_partitions.q.out b/ql/src/test/results/clientpositive/drop_multi_partitions.q.out
index 735920b16a..eae57f37c5 100644
--- a/ql/src/test/results/clientpositive/drop_multi_partitions.q.out
+++ b/ql/src/test/results/clientpositive/drop_multi_partitions.q.out
@@ -28,8 +28,10 @@ POSTHOOK: Output: default@mp
 POSTHOOK: Output: default@mp@b=2/c=2
 PREHOOK: query: show partitions mp
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@mp
 POSTHOOK: query: show partitions mp
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@mp
 b=1/c=1
 b=1/c=2
 b=2/c=2
@@ -69,8 +71,10 @@ POSTHOOK: Output: default@mp@b=1/c=1
 POSTHOOK: Output: default@mp@b=1/c=2
 PREHOOK: query: show partitions mp
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@mp
 POSTHOOK: query: show partitions mp
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@mp
 b=2/c=2
 PREHOOK: query: alter table mp drop if exists partition (b='3')
 PREHOOK: type: ALTERTABLE_DROPPARTS
@@ -80,6 +84,8 @@ POSTHOOK: type: ALTERTABLE_DROPPARTS
 POSTHOOK: Input: default@mp
 PREHOOK: query: show partitions mp
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@mp
 POSTHOOK: query: show partitions mp
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@mp
 b=2/c=2
diff --git a/ql/src/test/results/clientpositive/drop_partitions_filter.q.out b/ql/src/test/results/clientpositive/drop_partitions_filter.q.out
index 8e55cbae8e..cf03fba274 100644
--- a/ql/src/test/results/clientpositive/drop_partitions_filter.q.out
+++ b/ql/src/test/results/clientpositive/drop_partitions_filter.q.out
@@ -7,8 +7,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@ptestfilter
 PREHOOK: query: describe ptestfilter
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@ptestfilter
 POSTHOOK: query: describe ptestfilter
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@ptestfilter
 a                   	string              	                    
 b                   	int                 	                    
 c                   	string              	                    
@@ -84,8 +86,10 @@ POSTHOOK: Output: default@ptestfilter
 POSTHOOK: Output: default@ptestfilter@c=France/d=4
 PREHOOK: query: show partitions ptestfilter
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@ptestfilter
 POSTHOOK: query: show partitions ptestfilter
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@ptestfilter
 c=Canada/d=3
 c=France/d=4
 c=Germany/d=2
@@ -105,8 +109,10 @@ POSTHOOK: Input: default@ptestfilter
 POSTHOOK: Output: default@ptestfilter@c=US/d=1
 PREHOOK: query: show partitions ptestfilter
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@ptestfilter
 POSTHOOK: query: show partitions ptestfilter
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@ptestfilter
 c=Canada/d=3
 c=France/d=4
 c=Germany/d=2
@@ -127,8 +133,10 @@ POSTHOOK: Output: default@ptestfilter@c=US/d=2
 POSTHOOK: Output: default@ptestfilter@c=Uganda/d=2
 PREHOOK: query: show partitions ptestfilter
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@ptestfilter
 POSTHOOK: query: show partitions ptestfilter
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@ptestfilter
 c=Canada/d=3
 c=France/d=4
 c=Germany/d=2
@@ -145,8 +153,10 @@ POSTHOOK: Input: default@ptestfilter
 POSTHOOK: Output: default@ptestfilter@c=Russia/d=3
 PREHOOK: query: show partitions ptestfilter
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@ptestfilter
 POSTHOOK: query: show partitions ptestfilter
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@ptestfilter
 c=Canada/d=3
 c=France/d=4
 c=Germany/d=2
@@ -166,8 +176,10 @@ POSTHOOK: Output: default@ptestfilter@c=Greece/d=2
 POSTHOOK: Output: default@ptestfilter@c=India/d=3
 PREHOOK: query: show partitions ptestfilter
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@ptestfilter
 POSTHOOK: query: show partitions ptestfilter
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@ptestfilter
 c=Canada/d=3
 c=France/d=4
 c=Germany/d=2
@@ -183,8 +195,10 @@ POSTHOOK: Output: default@ptestfilter@c=Canada/d=3
 POSTHOOK: Output: default@ptestfilter@c=Germany/d=2
 PREHOOK: query: show partitions ptestfilter
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@ptestfilter
 POSTHOOK: query: show partitions ptestfilter
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@ptestfilter
 c=France/d=4
 PREHOOK: query: alter table ptestfilter drop if exists partition (c='US')
 PREHOOK: type: ALTERTABLE_DROPPARTS
@@ -194,8 +208,10 @@ POSTHOOK: type: ALTERTABLE_DROPPARTS
 POSTHOOK: Input: default@ptestfilter
 PREHOOK: query: show partitions ptestfilter
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@ptestfilter
 POSTHOOK: query: show partitions ptestfilter
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@ptestfilter
 c=France/d=4
 PREHOOK: query: drop table ptestfilter
 PREHOOK: type: DROPTABLE
diff --git a/ql/src/test/results/clientpositive/drop_partitions_filter2.q.out b/ql/src/test/results/clientpositive/drop_partitions_filter2.q.out
index d9a6f8c5e8..bfc063dc0a 100644
--- a/ql/src/test/results/clientpositive/drop_partitions_filter2.q.out
+++ b/ql/src/test/results/clientpositive/drop_partitions_filter2.q.out
@@ -7,8 +7,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@ptestfilter
 PREHOOK: query: describe ptestfilter
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@ptestfilter
 POSTHOOK: query: describe ptestfilter
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@ptestfilter
 a                   	string              	                    
 b                   	int                 	                    
 c                   	int                 	                    
@@ -63,8 +65,10 @@ POSTHOOK: Output: default@ptestfilter
 POSTHOOK: Output: default@ptestfilter@c=3/d=2
 PREHOOK: query: show partitions ptestfilter
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@ptestfilter
 POSTHOOK: query: show partitions ptestfilter
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@ptestfilter
 c=1/d=1
 c=1/d=2
 c=2/d=1
@@ -81,8 +85,10 @@ POSTHOOK: Input: default@ptestfilter
 POSTHOOK: Output: default@ptestfilter@c=1/d=1
 PREHOOK: query: show partitions ptestfilter
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@ptestfilter
 POSTHOOK: query: show partitions ptestfilter
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@ptestfilter
 c=1/d=2
 c=2/d=1
 c=2/d=2
@@ -100,8 +106,10 @@ POSTHOOK: Output: default@ptestfilter@c=2/d=1
 POSTHOOK: Output: default@ptestfilter@c=2/d=2
 PREHOOK: query: show partitions ptestfilter
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@ptestfilter
 POSTHOOK: query: show partitions ptestfilter
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@ptestfilter
 c=1/d=2
 c=3/d=1
 c=3/d=2
diff --git a/ql/src/test/results/clientpositive/drop_partitions_filter3.q.out b/ql/src/test/results/clientpositive/drop_partitions_filter3.q.out
index 69b7d42141..cc68b1e42a 100644
--- a/ql/src/test/results/clientpositive/drop_partitions_filter3.q.out
+++ b/ql/src/test/results/clientpositive/drop_partitions_filter3.q.out
@@ -7,8 +7,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@ptestfilter
 PREHOOK: query: describe ptestfilter
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@ptestfilter
 POSTHOOK: query: describe ptestfilter
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@ptestfilter
 a                   	string              	                    
 b                   	int                 	                    
 c                   	string              	                    
@@ -63,8 +65,10 @@ POSTHOOK: Output: default@ptestfilter
 POSTHOOK: Output: default@ptestfilter@c=3/d=2
 PREHOOK: query: show partitions ptestfilter
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@ptestfilter
 POSTHOOK: query: show partitions ptestfilter
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@ptestfilter
 c=1/d=1
 c=1/d=2
 c=2/d=1
@@ -81,8 +85,10 @@ POSTHOOK: Input: default@ptestfilter
 POSTHOOK: Output: default@ptestfilter@c=1/d=1
 PREHOOK: query: show partitions ptestfilter
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@ptestfilter
 POSTHOOK: query: show partitions ptestfilter
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@ptestfilter
 c=1/d=2
 c=2/d=1
 c=2/d=2
@@ -100,8 +106,10 @@ POSTHOOK: Output: default@ptestfilter@c=2/d=1
 POSTHOOK: Output: default@ptestfilter@c=2/d=2
 PREHOOK: query: show partitions ptestfilter
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@ptestfilter
 POSTHOOK: query: show partitions ptestfilter
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@ptestfilter
 c=1/d=2
 c=3/d=1
 c=3/d=2
diff --git a/ql/src/test/results/clientpositive/drop_partitions_ignore_protection.q.out b/ql/src/test/results/clientpositive/drop_partitions_ignore_protection.q.out
index e38211a4cf..5188520dd5 100644
--- a/ql/src/test/results/clientpositive/drop_partitions_ignore_protection.q.out
+++ b/ql/src/test/results/clientpositive/drop_partitions_ignore_protection.q.out
@@ -23,8 +23,10 @@ POSTHOOK: Input: default@tbl_protectmode_no_drop@p=p1
 POSTHOOK: Output: default@tbl_protectmode_no_drop@p=p1
 PREHOOK: query: desc extended tbl_protectmode_no_drop partition (p='p1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tbl_protectmode_no_drop
 POSTHOOK: query: desc extended tbl_protectmode_no_drop partition (p='p1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tbl_protectmode_no_drop
 c1                  	string              	                    
 c2                  	string              	                    
 p                   	string              	                    
diff --git a/ql/src/test/results/clientpositive/drop_table2.q.out b/ql/src/test/results/clientpositive/drop_table2.q.out
index c37326a939..3624f48f35 100644
--- a/ql/src/test/results/clientpositive/drop_table2.q.out
+++ b/ql/src/test/results/clientpositive/drop_table2.q.out
@@ -28,8 +28,10 @@ POSTHOOK: Output: default@temp
 POSTHOOK: Output: default@temp@p=p3
 PREHOOK: query: show partitions temp
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@temp
 POSTHOOK: query: show partitions temp
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@temp
 p=p1
 p=p2
 p=p3
@@ -50,8 +52,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@temp
 PREHOOK: query: show partitions temp
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@temp
 POSTHOOK: query: show partitions temp
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@temp
 PREHOOK: query: drop table temp
 PREHOOK: type: DROPTABLE
 PREHOOK: Input: default@temp
diff --git a/ql/src/test/results/clientpositive/dynpart_sort_opt_vectorization.q.out b/ql/src/test/results/clientpositive/dynpart_sort_opt_vectorization.q.out
index 8777b0068e..031fc6aadb 100644
--- a/ql/src/test/results/clientpositive/dynpart_sort_opt_vectorization.q.out
+++ b/ql/src/test/results/clientpositive/dynpart_sort_opt_vectorization.q.out
@@ -1380,8 +1380,10 @@ POSTHOOK: Lineage: over1k_part_orc PARTITION(ds=foo,t=__HIVE_DEFAULT_PARTITION__
 POSTHOOK: Lineage: over1k_part_orc PARTITION(ds=foo,t=__HIVE_DEFAULT_PARTITION__).si SIMPLE [(over1k_orc)over1k_orc.FieldSchema(name:si, type:smallint, comment:null), ]
 PREHOOK: query: desc formatted over1k_part_orc partition(ds="foo",t=27)
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@over1k_part_orc
 POSTHOOK: query: desc formatted over1k_part_orc partition(ds="foo",t=27)
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@over1k_part_orc
 POSTHOOK: Lineage: over1k_orc.b SIMPLE [(over1k)over1k.FieldSchema(name:b, type:bigint, comment:null), ]
 POSTHOOK: Lineage: over1k_orc.bin SIMPLE [(over1k)over1k.FieldSchema(name:bin, type:binary, comment:null), ]
 POSTHOOK: Lineage: over1k_orc.bo SIMPLE [(over1k)over1k.FieldSchema(name:bo, type:boolean, comment:null), ]
@@ -1497,8 +1499,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: desc formatted over1k_part_orc partition(ds="foo",t="__HIVE_DEFAULT_PARTITION__")
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@over1k_part_orc
 POSTHOOK: query: desc formatted over1k_part_orc partition(ds="foo",t="__HIVE_DEFAULT_PARTITION__")
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@over1k_part_orc
 POSTHOOK: Lineage: over1k_orc.b SIMPLE [(over1k)over1k.FieldSchema(name:b, type:bigint, comment:null), ]
 POSTHOOK: Lineage: over1k_orc.bin SIMPLE [(over1k)over1k.FieldSchema(name:bin, type:binary, comment:null), ]
 POSTHOOK: Lineage: over1k_orc.bo SIMPLE [(over1k)over1k.FieldSchema(name:bo, type:boolean, comment:null), ]
@@ -1614,8 +1618,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: desc formatted over1k_part_limit_orc partition(ds="foo",t=27)
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@over1k_part_limit_orc
 POSTHOOK: query: desc formatted over1k_part_limit_orc partition(ds="foo",t=27)
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@over1k_part_limit_orc
 POSTHOOK: Lineage: over1k_orc.b SIMPLE [(over1k)over1k.FieldSchema(name:b, type:bigint, comment:null), ]
 POSTHOOK: Lineage: over1k_orc.bin SIMPLE [(over1k)over1k.FieldSchema(name:bin, type:binary, comment:null), ]
 POSTHOOK: Lineage: over1k_orc.bo SIMPLE [(over1k)over1k.FieldSchema(name:bo, type:boolean, comment:null), ]
@@ -1731,8 +1737,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: desc formatted over1k_part_limit_orc partition(ds="foo",t="__HIVE_DEFAULT_PARTITION__")
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@over1k_part_limit_orc
 POSTHOOK: query: desc formatted over1k_part_limit_orc partition(ds="foo",t="__HIVE_DEFAULT_PARTITION__")
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@over1k_part_limit_orc
 POSTHOOK: Lineage: over1k_orc.b SIMPLE [(over1k)over1k.FieldSchema(name:b, type:bigint, comment:null), ]
 POSTHOOK: Lineage: over1k_orc.bin SIMPLE [(over1k)over1k.FieldSchema(name:bin, type:binary, comment:null), ]
 POSTHOOK: Lineage: over1k_orc.bo SIMPLE [(over1k)over1k.FieldSchema(name:bo, type:boolean, comment:null), ]
@@ -1848,8 +1856,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: desc formatted over1k_part_buck_orc partition(t=27)
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@over1k_part_buck_orc
 POSTHOOK: query: desc formatted over1k_part_buck_orc partition(t=27)
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@over1k_part_buck_orc
 POSTHOOK: Lineage: over1k_orc.b SIMPLE [(over1k)over1k.FieldSchema(name:b, type:bigint, comment:null), ]
 POSTHOOK: Lineage: over1k_orc.bin SIMPLE [(over1k)over1k.FieldSchema(name:bin, type:binary, comment:null), ]
 POSTHOOK: Lineage: over1k_orc.bo SIMPLE [(over1k)over1k.FieldSchema(name:bo, type:boolean, comment:null), ]
@@ -1964,8 +1974,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: desc formatted over1k_part_buck_orc partition(t="__HIVE_DEFAULT_PARTITION__")
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@over1k_part_buck_orc
 POSTHOOK: query: desc formatted over1k_part_buck_orc partition(t="__HIVE_DEFAULT_PARTITION__")
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@over1k_part_buck_orc
 POSTHOOK: Lineage: over1k_orc.b SIMPLE [(over1k)over1k.FieldSchema(name:b, type:bigint, comment:null), ]
 POSTHOOK: Lineage: over1k_orc.bin SIMPLE [(over1k)over1k.FieldSchema(name:bin, type:binary, comment:null), ]
 POSTHOOK: Lineage: over1k_orc.bo SIMPLE [(over1k)over1k.FieldSchema(name:bo, type:boolean, comment:null), ]
@@ -2080,8 +2092,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: desc formatted over1k_part_buck_sort_orc partition(t=27)
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@over1k_part_buck_sort_orc
 POSTHOOK: query: desc formatted over1k_part_buck_sort_orc partition(t=27)
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@over1k_part_buck_sort_orc
 POSTHOOK: Lineage: over1k_orc.b SIMPLE [(over1k)over1k.FieldSchema(name:b, type:bigint, comment:null), ]
 POSTHOOK: Lineage: over1k_orc.bin SIMPLE [(over1k)over1k.FieldSchema(name:bin, type:binary, comment:null), ]
 POSTHOOK: Lineage: over1k_orc.bo SIMPLE [(over1k)over1k.FieldSchema(name:bo, type:boolean, comment:null), ]
@@ -2196,8 +2210,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: desc formatted over1k_part_buck_sort_orc partition(t="__HIVE_DEFAULT_PARTITION__")
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@over1k_part_buck_sort_orc
 POSTHOOK: query: desc formatted over1k_part_buck_sort_orc partition(t="__HIVE_DEFAULT_PARTITION__")
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@over1k_part_buck_sort_orc
 POSTHOOK: Lineage: over1k_orc.b SIMPLE [(over1k)over1k.FieldSchema(name:b, type:bigint, comment:null), ]
 POSTHOOK: Lineage: over1k_orc.bin SIMPLE [(over1k)over1k.FieldSchema(name:bin, type:binary, comment:null), ]
 POSTHOOK: Lineage: over1k_orc.bo SIMPLE [(over1k)over1k.FieldSchema(name:bo, type:boolean, comment:null), ]
diff --git a/ql/src/test/results/clientpositive/dynpart_sort_optimization.q.out b/ql/src/test/results/clientpositive/dynpart_sort_optimization.q.out
index f411aa4877..7711bd15f7 100644
--- a/ql/src/test/results/clientpositive/dynpart_sort_optimization.q.out
+++ b/ql/src/test/results/clientpositive/dynpart_sort_optimization.q.out
@@ -1099,8 +1099,10 @@ POSTHOOK: Lineage: over1k_part_limit PARTITION(ds=foo,t=__HIVE_DEFAULT_PARTITION
 POSTHOOK: Lineage: over1k_part_limit PARTITION(ds=foo,t=__HIVE_DEFAULT_PARTITION__).si SIMPLE [(over1k)over1k.FieldSchema(name:si, type:smallint, comment:null), ]
 PREHOOK: query: desc formatted over1k_part partition(ds="foo",t=27)
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@over1k_part
 POSTHOOK: query: desc formatted over1k_part partition(ds="foo",t=27)
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@over1k_part
 POSTHOOK: Lineage: over1k_part PARTITION(ds=foo,t=27).b SIMPLE [(over1k)over1k.FieldSchema(name:b, type:bigint, comment:null), ]
 POSTHOOK: Lineage: over1k_part PARTITION(ds=foo,t=27).f SIMPLE [(over1k)over1k.FieldSchema(name:f, type:float, comment:null), ]
 POSTHOOK: Lineage: over1k_part PARTITION(ds=foo,t=27).i SIMPLE [(over1k)over1k.FieldSchema(name:i, type:int, comment:null), ]
@@ -1205,8 +1207,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: desc formatted over1k_part partition(ds="foo",t="__HIVE_DEFAULT_PARTITION__")
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@over1k_part
 POSTHOOK: query: desc formatted over1k_part partition(ds="foo",t="__HIVE_DEFAULT_PARTITION__")
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@over1k_part
 POSTHOOK: Lineage: over1k_part PARTITION(ds=foo,t=27).b SIMPLE [(over1k)over1k.FieldSchema(name:b, type:bigint, comment:null), ]
 POSTHOOK: Lineage: over1k_part PARTITION(ds=foo,t=27).f SIMPLE [(over1k)over1k.FieldSchema(name:f, type:float, comment:null), ]
 POSTHOOK: Lineage: over1k_part PARTITION(ds=foo,t=27).i SIMPLE [(over1k)over1k.FieldSchema(name:i, type:int, comment:null), ]
@@ -1311,8 +1315,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: desc formatted over1k_part_limit partition(ds="foo",t=27)
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@over1k_part_limit
 POSTHOOK: query: desc formatted over1k_part_limit partition(ds="foo",t=27)
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@over1k_part_limit
 POSTHOOK: Lineage: over1k_part PARTITION(ds=foo,t=27).b SIMPLE [(over1k)over1k.FieldSchema(name:b, type:bigint, comment:null), ]
 POSTHOOK: Lineage: over1k_part PARTITION(ds=foo,t=27).f SIMPLE [(over1k)over1k.FieldSchema(name:f, type:float, comment:null), ]
 POSTHOOK: Lineage: over1k_part PARTITION(ds=foo,t=27).i SIMPLE [(over1k)over1k.FieldSchema(name:i, type:int, comment:null), ]
@@ -1417,8 +1423,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: desc formatted over1k_part_limit partition(ds="foo",t="__HIVE_DEFAULT_PARTITION__")
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@over1k_part_limit
 POSTHOOK: query: desc formatted over1k_part_limit partition(ds="foo",t="__HIVE_DEFAULT_PARTITION__")
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@over1k_part_limit
 POSTHOOK: Lineage: over1k_part PARTITION(ds=foo,t=27).b SIMPLE [(over1k)over1k.FieldSchema(name:b, type:bigint, comment:null), ]
 POSTHOOK: Lineage: over1k_part PARTITION(ds=foo,t=27).f SIMPLE [(over1k)over1k.FieldSchema(name:f, type:float, comment:null), ]
 POSTHOOK: Lineage: over1k_part PARTITION(ds=foo,t=27).i SIMPLE [(over1k)over1k.FieldSchema(name:i, type:int, comment:null), ]
@@ -1523,8 +1531,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: desc formatted over1k_part_buck partition(t=27)
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@over1k_part_buck
 POSTHOOK: query: desc formatted over1k_part_buck partition(t=27)
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@over1k_part_buck
 POSTHOOK: Lineage: over1k_part PARTITION(ds=foo,t=27).b SIMPLE [(over1k)over1k.FieldSchema(name:b, type:bigint, comment:null), ]
 POSTHOOK: Lineage: over1k_part PARTITION(ds=foo,t=27).f SIMPLE [(over1k)over1k.FieldSchema(name:f, type:float, comment:null), ]
 POSTHOOK: Lineage: over1k_part PARTITION(ds=foo,t=27).i SIMPLE [(over1k)over1k.FieldSchema(name:i, type:int, comment:null), ]
@@ -1628,8 +1638,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: desc formatted over1k_part_buck partition(t="__HIVE_DEFAULT_PARTITION__")
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@over1k_part_buck
 POSTHOOK: query: desc formatted over1k_part_buck partition(t="__HIVE_DEFAULT_PARTITION__")
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@over1k_part_buck
 POSTHOOK: Lineage: over1k_part PARTITION(ds=foo,t=27).b SIMPLE [(over1k)over1k.FieldSchema(name:b, type:bigint, comment:null), ]
 POSTHOOK: Lineage: over1k_part PARTITION(ds=foo,t=27).f SIMPLE [(over1k)over1k.FieldSchema(name:f, type:float, comment:null), ]
 POSTHOOK: Lineage: over1k_part PARTITION(ds=foo,t=27).i SIMPLE [(over1k)over1k.FieldSchema(name:i, type:int, comment:null), ]
@@ -1733,8 +1745,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: desc formatted over1k_part_buck_sort partition(t=27)
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@over1k_part_buck_sort
 POSTHOOK: query: desc formatted over1k_part_buck_sort partition(t=27)
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@over1k_part_buck_sort
 POSTHOOK: Lineage: over1k_part PARTITION(ds=foo,t=27).b SIMPLE [(over1k)over1k.FieldSchema(name:b, type:bigint, comment:null), ]
 POSTHOOK: Lineage: over1k_part PARTITION(ds=foo,t=27).f SIMPLE [(over1k)over1k.FieldSchema(name:f, type:float, comment:null), ]
 POSTHOOK: Lineage: over1k_part PARTITION(ds=foo,t=27).i SIMPLE [(over1k)over1k.FieldSchema(name:i, type:int, comment:null), ]
@@ -1838,8 +1852,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: desc formatted over1k_part_buck_sort partition(t="__HIVE_DEFAULT_PARTITION__")
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@over1k_part_buck_sort
 POSTHOOK: query: desc formatted over1k_part_buck_sort partition(t="__HIVE_DEFAULT_PARTITION__")
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@over1k_part_buck_sort
 POSTHOOK: Lineage: over1k_part PARTITION(ds=foo,t=27).b SIMPLE [(over1k)over1k.FieldSchema(name:b, type:bigint, comment:null), ]
 POSTHOOK: Lineage: over1k_part PARTITION(ds=foo,t=27).f SIMPLE [(over1k)over1k.FieldSchema(name:f, type:float, comment:null), ]
 POSTHOOK: Lineage: over1k_part PARTITION(ds=foo,t=27).i SIMPLE [(over1k)over1k.FieldSchema(name:i, type:int, comment:null), ]
diff --git a/ql/src/test/results/clientpositive/escape1.q.out b/ql/src/test/results/clientpositive/escape1.q.out
index 84446c47e7..934221343e 100644
--- a/ql/src/test/results/clientpositive/escape1.q.out
+++ b/ql/src/test/results/clientpositive/escape1.q.out
@@ -1335,8 +1335,10 @@ POSTHOOK: Lineage: escape1 PARTITION(ds=1,part=~).a SIMPLE []
 1	1	~
 PREHOOK: query: SHOW PARTITIONS escape1
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@escape1
 POSTHOOK: query: SHOW PARTITIONS escape1
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@escape1
 POSTHOOK: Lineage: escape1 PARTITION(ds=1,part= ).a SIMPLE []
 POSTHOOK: Lineage: escape1 PARTITION(ds=1,part=).a SIMPLE []
 POSTHOOK: Lineage: escape1 PARTITION(ds=1,part=).a SIMPLE []
@@ -1970,8 +1972,10 @@ POSTHOOK: Lineage: escape1 PARTITION(ds=1,part=}).a SIMPLE []
 POSTHOOK: Lineage: escape1 PARTITION(ds=1,part=~).a SIMPLE []
 PREHOOK: query: SHOW PARTITIONS escape1
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@escape1
 POSTHOOK: query: SHOW PARTITIONS escape1
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@escape1
 POSTHOOK: Lineage: escape1 PARTITION(ds=1,part= ).a SIMPLE []
 POSTHOOK: Lineage: escape1 PARTITION(ds=1,part=).a SIMPLE []
 POSTHOOK: Lineage: escape1 PARTITION(ds=1,part=).a SIMPLE []
diff --git a/ql/src/test/results/clientpositive/escape2.q.out b/ql/src/test/results/clientpositive/escape2.q.out
index aa9f6013c9..828053ec17 100644
--- a/ql/src/test/results/clientpositive/escape2.q.out
+++ b/ql/src/test/results/clientpositive/escape2.q.out
@@ -1335,8 +1335,10 @@ POSTHOOK: Lineage: escape2 PARTITION(ds=1,part=~).a SIMPLE []
 1	1	~
 PREHOOK: query: SHOW PARTITIONS escape2
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@escape2
 POSTHOOK: query: SHOW PARTITIONS escape2
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@escape2
 POSTHOOK: Lineage: escape2 PARTITION(ds=1,part= ).a SIMPLE []
 POSTHOOK: Lineage: escape2 PARTITION(ds=1,part=).a SIMPLE []
 POSTHOOK: Lineage: escape2 PARTITION(ds=1,part=).a SIMPLE []
diff --git a/ql/src/test/results/clientpositive/exchange_partition.q.out b/ql/src/test/results/clientpositive/exchange_partition.q.out
index 7e3d5df4e7..8be28aca87 100644
--- a/ql/src/test/results/clientpositive/exchange_partition.q.out
+++ b/ql/src/test/results/clientpositive/exchange_partition.q.out
@@ -14,12 +14,16 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@exchange_part_test2
 PREHOOK: query: SHOW PARTITIONS exchange_part_test1
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@exchange_part_test1
 POSTHOOK: query: SHOW PARTITIONS exchange_part_test1
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@exchange_part_test1
 PREHOOK: query: SHOW PARTITIONS exchange_part_test2
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@exchange_part_test2
 POSTHOOK: query: SHOW PARTITIONS exchange_part_test2
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@exchange_part_test2
 PREHOOK: query: ALTER TABLE exchange_part_test2 ADD PARTITION (ds='2013-04-05')
 PREHOOK: type: ALTERTABLE_ADDPARTS
 PREHOOK: Output: default@exchange_part_test2
@@ -29,12 +33,16 @@ POSTHOOK: Output: default@exchange_part_test2
 POSTHOOK: Output: default@exchange_part_test2@ds=2013-04-05
 PREHOOK: query: SHOW PARTITIONS exchange_part_test1
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@exchange_part_test1
 POSTHOOK: query: SHOW PARTITIONS exchange_part_test1
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@exchange_part_test1
 PREHOOK: query: SHOW PARTITIONS exchange_part_test2
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@exchange_part_test2
 POSTHOOK: query: SHOW PARTITIONS exchange_part_test2
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@exchange_part_test2
 ds=2013-04-05
 PREHOOK: query: ALTER TABLE exchange_part_test1 EXCHANGE PARTITION (ds='2013-04-05') WITH TABLE exchange_part_test2
 PREHOOK: type: null
@@ -42,10 +50,14 @@ POSTHOOK: query: ALTER TABLE exchange_part_test1 EXCHANGE PARTITION (ds='2013-04
 POSTHOOK: type: null
 PREHOOK: query: SHOW PARTITIONS exchange_part_test1
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@exchange_part_test1
 POSTHOOK: query: SHOW PARTITIONS exchange_part_test1
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@exchange_part_test1
 ds=2013-04-05
 PREHOOK: query: SHOW PARTITIONS exchange_part_test2
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@exchange_part_test2
 POSTHOOK: query: SHOW PARTITIONS exchange_part_test2
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@exchange_part_test2
diff --git a/ql/src/test/results/clientpositive/exchange_partition2.q.out b/ql/src/test/results/clientpositive/exchange_partition2.q.out
index 8c1bbe7622..db43dd0ebb 100644
--- a/ql/src/test/results/clientpositive/exchange_partition2.q.out
+++ b/ql/src/test/results/clientpositive/exchange_partition2.q.out
@@ -14,12 +14,16 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@exchange_part_test2
 PREHOOK: query: SHOW PARTITIONS exchange_part_test1
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@exchange_part_test1
 POSTHOOK: query: SHOW PARTITIONS exchange_part_test1
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@exchange_part_test1
 PREHOOK: query: SHOW PARTITIONS exchange_part_test2
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@exchange_part_test2
 POSTHOOK: query: SHOW PARTITIONS exchange_part_test2
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@exchange_part_test2
 PREHOOK: query: ALTER TABLE exchange_part_test2 ADD PARTITION (ds='2013-04-05', hr='1')
 PREHOOK: type: ALTERTABLE_ADDPARTS
 PREHOOK: Output: default@exchange_part_test2
@@ -29,12 +33,16 @@ POSTHOOK: Output: default@exchange_part_test2
 POSTHOOK: Output: default@exchange_part_test2@ds=2013-04-05/hr=1
 PREHOOK: query: SHOW PARTITIONS exchange_part_test1
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@exchange_part_test1
 POSTHOOK: query: SHOW PARTITIONS exchange_part_test1
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@exchange_part_test1
 PREHOOK: query: SHOW PARTITIONS exchange_part_test2
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@exchange_part_test2
 POSTHOOK: query: SHOW PARTITIONS exchange_part_test2
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@exchange_part_test2
 ds=2013-04-05/hr=1
 PREHOOK: query: ALTER TABLE exchange_part_test1 EXCHANGE PARTITION (ds='2013-04-05', hr='1') WITH TABLE exchange_part_test2
 PREHOOK: type: null
@@ -42,10 +50,14 @@ POSTHOOK: query: ALTER TABLE exchange_part_test1 EXCHANGE PARTITION (ds='2013-04
 POSTHOOK: type: null
 PREHOOK: query: SHOW PARTITIONS exchange_part_test1
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@exchange_part_test1
 POSTHOOK: query: SHOW PARTITIONS exchange_part_test1
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@exchange_part_test1
 ds=2013-04-05/hr=1
 PREHOOK: query: SHOW PARTITIONS exchange_part_test2
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@exchange_part_test2
 POSTHOOK: query: SHOW PARTITIONS exchange_part_test2
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@exchange_part_test2
diff --git a/ql/src/test/results/clientpositive/exchange_partition3.q.out b/ql/src/test/results/clientpositive/exchange_partition3.q.out
index 5f9ceed4a5..ffcd9dff95 100644
--- a/ql/src/test/results/clientpositive/exchange_partition3.q.out
+++ b/ql/src/test/results/clientpositive/exchange_partition3.q.out
@@ -14,12 +14,16 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@exchange_part_test2
 PREHOOK: query: SHOW PARTITIONS exchange_part_test1
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@exchange_part_test1
 POSTHOOK: query: SHOW PARTITIONS exchange_part_test1
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@exchange_part_test1
 PREHOOK: query: SHOW PARTITIONS exchange_part_test2
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@exchange_part_test2
 POSTHOOK: query: SHOW PARTITIONS exchange_part_test2
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@exchange_part_test2
 PREHOOK: query: ALTER TABLE exchange_part_test1 ADD PARTITION (ds='2014-01-03', hr='1')
 PREHOOK: type: ALTERTABLE_ADDPARTS
 PREHOOK: Output: default@exchange_part_test1
@@ -43,13 +47,17 @@ POSTHOOK: Output: default@exchange_part_test2
 POSTHOOK: Output: default@exchange_part_test2@ds=2013-04-05/hr=2
 PREHOOK: query: SHOW PARTITIONS exchange_part_test1
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@exchange_part_test1
 POSTHOOK: query: SHOW PARTITIONS exchange_part_test1
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@exchange_part_test1
 ds=2014-01-03/hr=1
 PREHOOK: query: SHOW PARTITIONS exchange_part_test2
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@exchange_part_test2
 POSTHOOK: query: SHOW PARTITIONS exchange_part_test2
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@exchange_part_test2
 ds=2013-04-05/hr=1
 ds=2013-04-05/hr=2
 PREHOOK: query: -- This will exchange both partitions hr=1 and hr=2
@@ -60,12 +68,16 @@ ALTER TABLE exchange_part_test1 EXCHANGE PARTITION (ds='2013-04-05') WITH TABLE
 POSTHOOK: type: null
 PREHOOK: query: SHOW PARTITIONS exchange_part_test1
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@exchange_part_test1
 POSTHOOK: query: SHOW PARTITIONS exchange_part_test1
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@exchange_part_test1
 ds=2013-04-05/hr=1
 ds=2013-04-05/hr=2
 ds=2014-01-03/hr=1
 PREHOOK: query: SHOW PARTITIONS exchange_part_test2
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@exchange_part_test2
 POSTHOOK: query: SHOW PARTITIONS exchange_part_test2
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@exchange_part_test2
diff --git a/ql/src/test/results/clientpositive/exim_00_nonpart_empty.q.out b/ql/src/test/results/clientpositive/exim_00_nonpart_empty.q.out
index 11e2380aea..d8081f6ea6 100644
--- a/ql/src/test/results/clientpositive/exim_00_nonpart_empty.q.out
+++ b/ql/src/test/results/clientpositive/exim_00_nonpart_empty.q.out
@@ -41,8 +41,10 @@ POSTHOOK: type: IMPORT
 POSTHOOK: Output: importer@exim_department
 PREHOOK: query: describe extended exim_department
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: importer@exim_department
 POSTHOOK: query: describe extended exim_department
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: importer@exim_department
 dep_id              	int                 	department id       
 	 	 
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/exim_01_nonpart.q.out b/ql/src/test/results/clientpositive/exim_01_nonpart.q.out
index 0abab9f9d5..59987923f3 100644
--- a/ql/src/test/results/clientpositive/exim_01_nonpart.q.out
+++ b/ql/src/test/results/clientpositive/exim_01_nonpart.q.out
@@ -49,8 +49,10 @@ POSTHOOK: type: IMPORT
 POSTHOOK: Output: importer@exim_department
 PREHOOK: query: describe extended exim_department
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: importer@exim_department
 POSTHOOK: query: describe extended exim_department
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: importer@exim_department
 dep_id              	int                 	department id       
 	 	 
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/exim_02_00_part_empty.q.out b/ql/src/test/results/clientpositive/exim_02_00_part_empty.q.out
index 8712de0283..3f45fecd5e 100644
--- a/ql/src/test/results/clientpositive/exim_02_00_part_empty.q.out
+++ b/ql/src/test/results/clientpositive/exim_02_00_part_empty.q.out
@@ -43,8 +43,10 @@ POSTHOOK: type: IMPORT
 POSTHOOK: Output: importer@exim_employee
 PREHOOK: query: describe extended exim_employee
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: importer@exim_employee
 POSTHOOK: query: describe extended exim_employee
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: importer@exim_employee
 emp_id              	int                 	employee id         
 emp_country         	string              	two char iso code   
 emp_state           	string              	free text           
diff --git a/ql/src/test/results/clientpositive/exim_02_part.q.out b/ql/src/test/results/clientpositive/exim_02_part.q.out
index c3684760d6..172d0da362 100644
--- a/ql/src/test/results/clientpositive/exim_02_part.q.out
+++ b/ql/src/test/results/clientpositive/exim_02_part.q.out
@@ -57,8 +57,10 @@ POSTHOOK: Output: importer@exim_employee
 POSTHOOK: Output: importer@exim_employee@emp_country=in/emp_state=tn
 PREHOOK: query: describe extended exim_employee
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: importer@exim_employee
 POSTHOOK: query: describe extended exim_employee
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: importer@exim_employee
 emp_id              	int                 	employee id         
 emp_country         	string              	two char iso code   
 emp_state           	string              	free text           
diff --git a/ql/src/test/results/clientpositive/exim_03_nonpart_over_compat.q.out b/ql/src/test/results/clientpositive/exim_03_nonpart_over_compat.q.out
index f1586ae372..98ac40ddbc 100644
--- a/ql/src/test/results/clientpositive/exim_03_nonpart_over_compat.q.out
+++ b/ql/src/test/results/clientpositive/exim_03_nonpart_over_compat.q.out
@@ -61,8 +61,10 @@ POSTHOOK: type: IMPORT
 POSTHOOK: Output: importer@exim_department
 PREHOOK: query: describe extended exim_department
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: importer@exim_department
 POSTHOOK: query: describe extended exim_department
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: importer@exim_department
 dep_id              	int                 	department identifier
 	 	 
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/exim_04_all_part.q.out b/ql/src/test/results/clientpositive/exim_04_all_part.q.out
index cae3d29378..3ef7b15746 100644
--- a/ql/src/test/results/clientpositive/exim_04_all_part.q.out
+++ b/ql/src/test/results/clientpositive/exim_04_all_part.q.out
@@ -99,8 +99,10 @@ POSTHOOK: Output: importer@exim_employee@emp_country=us/emp_state=ka
 POSTHOOK: Output: importer@exim_employee@emp_country=us/emp_state=tn
 PREHOOK: query: describe extended exim_employee
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: importer@exim_employee
 POSTHOOK: query: describe extended exim_employee
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: importer@exim_employee
 emp_id              	int                 	employee id         
 emp_country         	string              	two char iso code   
 emp_state           	string              	free text           
diff --git a/ql/src/test/results/clientpositive/exim_04_evolved_parts.q.out b/ql/src/test/results/clientpositive/exim_04_evolved_parts.q.out
index 344394d1a1..ea3fd91f3d 100644
--- a/ql/src/test/results/clientpositive/exim_04_evolved_parts.q.out
+++ b/ql/src/test/results/clientpositive/exim_04_evolved_parts.q.out
@@ -101,8 +101,10 @@ POSTHOOK: Output: importer@exim_employee@emp_country=in/emp_state=ka
 POSTHOOK: Output: importer@exim_employee@emp_country=in/emp_state=tn
 PREHOOK: query: describe extended exim_employee
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: importer@exim_employee
 POSTHOOK: query: describe extended exim_employee
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: importer@exim_employee
 emp_id              	int                 	employee id         
 emp_name            	string              	                    
 emp_dob             	string              	employee date of birth
@@ -120,8 +122,10 @@ emp_state           	string              	2-char code
 #### A masked pattern was here ####
 PREHOOK: query: describe extended exim_employee partition (emp_country='in', emp_state='tn')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: importer@exim_employee
 POSTHOOK: query: describe extended exim_employee partition (emp_country='in', emp_state='tn')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: importer@exim_employee
 emp_id              	int                 	employee id         
 emp_name            	string              	                    
 emp_dob             	string              	employee date of birth
@@ -139,8 +143,10 @@ emp_state           	string              	2-char code
 #### A masked pattern was here ####
 PREHOOK: query: describe extended exim_employee partition (emp_country='in', emp_state='ka')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: importer@exim_employee
 POSTHOOK: query: describe extended exim_employee partition (emp_country='in', emp_state='ka')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: importer@exim_employee
 emp_id              	int                 	employee id         
 emp_name            	string              	                    
 emp_dob             	string              	employee date of birth
diff --git a/ql/src/test/results/clientpositive/exim_05_some_part.q.out b/ql/src/test/results/clientpositive/exim_05_some_part.q.out
index d790d18ca8..5bc044fcd9 100644
--- a/ql/src/test/results/clientpositive/exim_05_some_part.q.out
+++ b/ql/src/test/results/clientpositive/exim_05_some_part.q.out
@@ -93,8 +93,10 @@ POSTHOOK: Output: importer@exim_employee@emp_country=in/emp_state=ka
 POSTHOOK: Output: importer@exim_employee@emp_country=us/emp_state=ka
 PREHOOK: query: describe extended exim_employee
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: importer@exim_employee
 POSTHOOK: query: describe extended exim_employee
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: importer@exim_employee
 emp_id              	int                 	employee id         
 emp_country         	string              	two char iso code   
 emp_state           	string              	free text           
diff --git a/ql/src/test/results/clientpositive/exim_06_one_part.q.out b/ql/src/test/results/clientpositive/exim_06_one_part.q.out
index 1d7b432279..d8d3c45b38 100644
--- a/ql/src/test/results/clientpositive/exim_06_one_part.q.out
+++ b/ql/src/test/results/clientpositive/exim_06_one_part.q.out
@@ -90,8 +90,10 @@ POSTHOOK: Output: importer@exim_employee
 POSTHOOK: Output: importer@exim_employee@emp_country=in/emp_state=ka
 PREHOOK: query: describe extended exim_employee
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: importer@exim_employee
 POSTHOOK: query: describe extended exim_employee
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: importer@exim_employee
 emp_id              	int                 	employee id         
 emp_country         	string              	two char iso code   
 emp_state           	string              	free text           
diff --git a/ql/src/test/results/clientpositive/exim_07_all_part_over_nonoverlap.q.out b/ql/src/test/results/clientpositive/exim_07_all_part_over_nonoverlap.q.out
index 60b1cd010c..25c4f31c36 100644
--- a/ql/src/test/results/clientpositive/exim_07_all_part_over_nonoverlap.q.out
+++ b/ql/src/test/results/clientpositive/exim_07_all_part_over_nonoverlap.q.out
@@ -126,8 +126,10 @@ POSTHOOK: Output: importer@exim_employee@emp_country=us/emp_state=ka
 POSTHOOK: Output: importer@exim_employee@emp_country=us/emp_state=tn
 PREHOOK: query: describe extended exim_employee
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: importer@exim_employee
 POSTHOOK: query: describe extended exim_employee
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: importer@exim_employee
 emp_id              	int                 	employee id         
 emp_country         	string              	iso code            
 emp_state           	string              	free-form text      
diff --git a/ql/src/test/results/clientpositive/exim_08_nonpart_rename.q.out b/ql/src/test/results/clientpositive/exim_08_nonpart_rename.q.out
index 90f8d8dfde..708d9021b3 100644
--- a/ql/src/test/results/clientpositive/exim_08_nonpart_rename.q.out
+++ b/ql/src/test/results/clientpositive/exim_08_nonpart_rename.q.out
@@ -71,8 +71,10 @@ POSTHOOK: type: IMPORT
 POSTHOOK: Output: importer@exim_imported_dept
 PREHOOK: query: describe extended exim_imported_dept
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: importer@exim_imported_dept
 POSTHOOK: query: describe extended exim_imported_dept
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: importer@exim_imported_dept
 dep_id              	int                 	department id       
 	 	 
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/exim_09_part_spec_nonoverlap.q.out b/ql/src/test/results/clientpositive/exim_09_part_spec_nonoverlap.q.out
index 6f9feb0a78..3d5956704b 100644
--- a/ql/src/test/results/clientpositive/exim_09_part_spec_nonoverlap.q.out
+++ b/ql/src/test/results/clientpositive/exim_09_part_spec_nonoverlap.q.out
@@ -134,8 +134,10 @@ POSTHOOK: Output: importer@exim_employee
 POSTHOOK: Output: importer@exim_employee@emp_country=us/emp_state=tn
 PREHOOK: query: describe extended exim_employee
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: importer@exim_employee
 POSTHOOK: query: describe extended exim_employee
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: importer@exim_employee
 emp_id              	int                 	employee id         
 emp_country         	string              	two char iso code   
 emp_state           	string              	free text           
diff --git a/ql/src/test/results/clientpositive/exim_10_external_managed.q.out b/ql/src/test/results/clientpositive/exim_10_external_managed.q.out
index e7fbd696c3..e2f11138d5 100644
--- a/ql/src/test/results/clientpositive/exim_10_external_managed.q.out
+++ b/ql/src/test/results/clientpositive/exim_10_external_managed.q.out
@@ -55,8 +55,10 @@ POSTHOOK: type: IMPORT
 POSTHOOK: Output: importer@exim_department
 PREHOOK: query: describe extended exim_department
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: importer@exim_department
 POSTHOOK: query: describe extended exim_department
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: importer@exim_department
 dep_id              	int                 	department id       
 	 	 
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/exim_11_managed_external.q.out b/ql/src/test/results/clientpositive/exim_11_managed_external.q.out
index 6e92058dcf..1aa9e1404d 100644
--- a/ql/src/test/results/clientpositive/exim_11_managed_external.q.out
+++ b/ql/src/test/results/clientpositive/exim_11_managed_external.q.out
@@ -49,8 +49,10 @@ POSTHOOK: type: IMPORT
 POSTHOOK: Output: importer@exim_department
 PREHOOK: query: describe extended exim_department
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: importer@exim_department
 POSTHOOK: query: describe extended exim_department
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: importer@exim_department
 dep_id              	int                 	department id       
 	 	 
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/exim_12_external_location.q.out b/ql/src/test/results/clientpositive/exim_12_external_location.q.out
index ec555b75d9..9960740d39 100644
--- a/ql/src/test/results/clientpositive/exim_12_external_location.q.out
+++ b/ql/src/test/results/clientpositive/exim_12_external_location.q.out
@@ -52,8 +52,10 @@ POSTHOOK: type: IMPORT
 POSTHOOK: Output: importer@exim_department
 PREHOOK: query: describe extended exim_department
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: importer@exim_department
 POSTHOOK: query: describe extended exim_department
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: importer@exim_department
 dep_id              	int                 	department id       
 	 	 
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/exim_13_managed_location.q.out b/ql/src/test/results/clientpositive/exim_13_managed_location.q.out
index 9097486e4b..afcfb37c87 100644
--- a/ql/src/test/results/clientpositive/exim_13_managed_location.q.out
+++ b/ql/src/test/results/clientpositive/exim_13_managed_location.q.out
@@ -52,8 +52,10 @@ POSTHOOK: type: IMPORT
 POSTHOOK: Output: importer@exim_department
 PREHOOK: query: describe extended exim_department
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: importer@exim_department
 POSTHOOK: query: describe extended exim_department
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: importer@exim_department
 dep_id              	int                 	department id       
 	 	 
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/exim_14_managed_location_over_existing.q.out b/ql/src/test/results/clientpositive/exim_14_managed_location_over_existing.q.out
index 16a5bf7aba..afe3523c32 100644
--- a/ql/src/test/results/clientpositive/exim_14_managed_location_over_existing.q.out
+++ b/ql/src/test/results/clientpositive/exim_14_managed_location_over_existing.q.out
@@ -68,8 +68,10 @@ POSTHOOK: type: IMPORT
 POSTHOOK: Output: importer@exim_department
 PREHOOK: query: describe extended exim_department
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: importer@exim_department
 POSTHOOK: query: describe extended exim_department
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: importer@exim_department
 dep_id              	int                 	department id       
 	 	 
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/exim_15_external_part.q.out b/ql/src/test/results/clientpositive/exim_15_external_part.q.out
index 9260591769..e60aeb906f 100644
--- a/ql/src/test/results/clientpositive/exim_15_external_part.q.out
+++ b/ql/src/test/results/clientpositive/exim_15_external_part.q.out
@@ -141,8 +141,10 @@ POSTHOOK: Output: importer@exim_employee
 POSTHOOK: Output: importer@exim_employee@emp_country=us/emp_state=tn
 PREHOOK: query: describe extended exim_employee
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: importer@exim_employee
 POSTHOOK: query: describe extended exim_employee
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: importer@exim_employee
 emp_id              	int                 	employee id         
 emp_country         	string              	two char iso code   
 emp_state           	string              	free text           
diff --git a/ql/src/test/results/clientpositive/exim_18_part_external.q.out b/ql/src/test/results/clientpositive/exim_18_part_external.q.out
index 98384374c3..13398ea574 100644
--- a/ql/src/test/results/clientpositive/exim_18_part_external.q.out
+++ b/ql/src/test/results/clientpositive/exim_18_part_external.q.out
@@ -98,8 +98,10 @@ POSTHOOK: Output: importer@exim_employee
 POSTHOOK: Output: importer@exim_employee@emp_country=us/emp_state=tn
 PREHOOK: query: describe extended exim_employee
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: importer@exim_employee
 POSTHOOK: query: describe extended exim_employee
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: importer@exim_employee
 emp_id              	int                 	employee id         
 emp_country         	string              	two char iso code   
 emp_state           	string              	free text           
diff --git a/ql/src/test/results/clientpositive/exim_19_00_part_external_location.q.out b/ql/src/test/results/clientpositive/exim_19_00_part_external_location.q.out
index 788c312cb7..c967d01bf8 100644
--- a/ql/src/test/results/clientpositive/exim_19_00_part_external_location.q.out
+++ b/ql/src/test/results/clientpositive/exim_19_00_part_external_location.q.out
@@ -76,8 +76,10 @@ POSTHOOK: Output: importer@exim_employee@emp_country=in/emp_state=ka
 POSTHOOK: Output: importer@exim_employee@emp_country=in/emp_state=tn
 PREHOOK: query: describe extended exim_employee
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: importer@exim_employee
 POSTHOOK: query: describe extended exim_employee
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: importer@exim_employee
 emp_id              	int                 	employee id         
 emp_country         	string              	two char iso code   
 emp_state           	string              	free text           
diff --git a/ql/src/test/results/clientpositive/exim_19_part_external_location.q.out b/ql/src/test/results/clientpositive/exim_19_part_external_location.q.out
index f0b93552fd..4702002b59 100644
--- a/ql/src/test/results/clientpositive/exim_19_part_external_location.q.out
+++ b/ql/src/test/results/clientpositive/exim_19_part_external_location.q.out
@@ -101,8 +101,10 @@ POSTHOOK: Output: importer@exim_employee
 POSTHOOK: Output: importer@exim_employee@emp_country=us/emp_state=tn
 PREHOOK: query: describe extended exim_employee
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: importer@exim_employee
 POSTHOOK: query: describe extended exim_employee
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: importer@exim_employee
 emp_id              	int                 	employee id         
 emp_country         	string              	two char iso code   
 emp_state           	string              	free text           
diff --git a/ql/src/test/results/clientpositive/exim_20_part_managed_location.q.out b/ql/src/test/results/clientpositive/exim_20_part_managed_location.q.out
index 07ebc75c4c..c4a121ba2e 100644
--- a/ql/src/test/results/clientpositive/exim_20_part_managed_location.q.out
+++ b/ql/src/test/results/clientpositive/exim_20_part_managed_location.q.out
@@ -101,8 +101,10 @@ POSTHOOK: Output: importer@exim_employee
 POSTHOOK: Output: importer@exim_employee@emp_country=us/emp_state=tn
 PREHOOK: query: describe extended exim_employee
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: importer@exim_employee
 POSTHOOK: query: describe extended exim_employee
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: importer@exim_employee
 emp_id              	int                 	employee id         
 emp_country         	string              	two char iso code   
 emp_state           	string              	free text           
diff --git a/ql/src/test/results/clientpositive/exim_hidden_files.q.out b/ql/src/test/results/clientpositive/exim_hidden_files.q.out
index b603dd4f11..451ad9aaeb 100644
--- a/ql/src/test/results/clientpositive/exim_hidden_files.q.out
+++ b/ql/src/test/results/clientpositive/exim_hidden_files.q.out
@@ -46,8 +46,10 @@ POSTHOOK: Output: importer@exim_employee
 POSTHOOK: Output: importer@exim_employee@emp_country=in
 PREHOOK: query: describe formatted exim_employee
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: importer@exim_employee
 POSTHOOK: query: describe formatted exim_employee
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: importer@exim_employee
 # col_name            	data_type           	comment             
 	 	 
 emp_id              	int                 	                    
diff --git a/ql/src/test/results/clientpositive/fileformat_sequencefile.q.out b/ql/src/test/results/clientpositive/fileformat_sequencefile.q.out
index b83450ef58..95ada156d5 100644
--- a/ql/src/test/results/clientpositive/fileformat_sequencefile.q.out
+++ b/ql/src/test/results/clientpositive/fileformat_sequencefile.q.out
@@ -33,8 +33,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@dest1
 PREHOOK: query: DESCRIBE EXTENDED dest1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@dest1
 POSTHOOK: query: DESCRIBE EXTENDED dest1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@dest1
 key                 	int                 	                    
 value               	string              	                    
 	 	 
diff --git a/ql/src/test/results/clientpositive/fileformat_text.q.out b/ql/src/test/results/clientpositive/fileformat_text.q.out
index 90213c1104..707f43554b 100644
--- a/ql/src/test/results/clientpositive/fileformat_text.q.out
+++ b/ql/src/test/results/clientpositive/fileformat_text.q.out
@@ -33,8 +33,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@dest1
 PREHOOK: query: DESCRIBE EXTENDED dest1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@dest1
 POSTHOOK: query: DESCRIBE EXTENDED dest1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@dest1
 key                 	int                 	                    
 value               	string              	                    
 	 	 
diff --git a/ql/src/test/results/clientpositive/import_exported_table.q.out b/ql/src/test/results/clientpositive/import_exported_table.q.out
index b305a2ef89..4645b3b833 100644
--- a/ql/src/test/results/clientpositive/import_exported_table.q.out
+++ b/ql/src/test/results/clientpositive/import_exported_table.q.out
@@ -5,8 +5,10 @@ POSTHOOK: type: IMPORT
 POSTHOOK: Output: default@j1_41
 PREHOOK: query: DESCRIBE j1_41
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@j1_41
 POSTHOOK: query: DESCRIBE j1_41
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@j1_41
 a                   	string              	                    
 b                   	int                 	                    
 PREHOOK: query: SELECT * from j1_41
diff --git a/ql/src/test/results/clientpositive/index_creation.q.out b/ql/src/test/results/clientpositive/index_creation.q.out
index cd8d11ef93..9a65d178c6 100644
--- a/ql/src/test/results/clientpositive/index_creation.q.out
+++ b/ql/src/test/results/clientpositive/index_creation.q.out
@@ -41,8 +41,10 @@ POSTHOOK: type: CREATEINDEX
 POSTHOOK: Output: default@default__src_src_index_2__
 PREHOOK: query: desc extended default__src_src_index_2__
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@default__src_src_index_2__
 POSTHOOK: query: desc extended default__src_src_index_2__
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@default__src_src_index_2__
 key                 	string              	default             
 _bucketname         	string              	                    
 _offsets            	array<bigint>       	                    
@@ -55,8 +57,10 @@ POSTHOOK: type: CREATEINDEX
 POSTHOOK: Output: default@src_idx_src_index_3
 PREHOOK: query: desc extended src_idx_src_index_3
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@src_idx_src_index_3
 POSTHOOK: query: desc extended src_idx_src_index_3
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@src_idx_src_index_3
 key                 	string              	default             
 _bucketname         	string              	                    
 _offsets            	array<bigint>       	                    
@@ -69,8 +73,10 @@ POSTHOOK: type: CREATEINDEX
 POSTHOOK: Output: default@default__src_src_index_4__
 PREHOOK: query: desc extended default__src_src_index_4__
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@default__src_src_index_4__
 POSTHOOK: query: desc extended default__src_src_index_4__
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@default__src_src_index_4__
 key                 	string              	default             
 _bucketname         	string              	                    
 _offsets            	array<bigint>       	                    
@@ -83,8 +89,10 @@ POSTHOOK: type: CREATEINDEX
 POSTHOOK: Output: default@default__src_src_index_5__
 PREHOOK: query: desc extended default__src_src_index_5__
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@default__src_src_index_5__
 POSTHOOK: query: desc extended default__src_src_index_5__
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@default__src_src_index_5__
 key                 	string              	default             
 _bucketname         	string              	                    
 _offsets            	array<bigint>       	                    
@@ -97,8 +105,10 @@ POSTHOOK: type: CREATEINDEX
 POSTHOOK: Output: default@default__src_src_index_6__
 PREHOOK: query: desc extended default__src_src_index_6__
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@default__src_src_index_6__
 POSTHOOK: query: desc extended default__src_src_index_6__
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@default__src_src_index_6__
 key                 	string              	default             
 _bucketname         	string              	                    
 _offsets            	array<bigint>       	                    
@@ -111,8 +121,10 @@ POSTHOOK: type: CREATEINDEX
 POSTHOOK: Output: default@src_idx_src_index_7
 PREHOOK: query: desc extended src_idx_src_index_7
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@src_idx_src_index_7
 POSTHOOK: query: desc extended src_idx_src_index_7
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@src_idx_src_index_7
 key                 	string              	default             
 _bucketname         	string              	                    
 _offsets            	array<bigint>       	                    
@@ -125,8 +137,10 @@ POSTHOOK: type: CREATEINDEX
 POSTHOOK: Output: default@default__src_src_index_8__
 PREHOOK: query: desc extended default__src_src_index_8__
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@default__src_src_index_8__
 POSTHOOK: query: desc extended default__src_src_index_8__
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@default__src_src_index_8__
 key                 	string              	default             
 _bucketname         	string              	                    
 _offsets            	array<bigint>       	                    
@@ -139,8 +153,10 @@ POSTHOOK: type: CREATEINDEX
 POSTHOOK: Output: default@default__src_src_index_9__
 PREHOOK: query: desc extended default__src_src_index_9__
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@default__src_src_index_9__
 POSTHOOK: query: desc extended default__src_src_index_9__
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@default__src_src_index_9__
 key                 	string              	default             
 _bucketname         	string              	                    
 _offsets            	array<bigint>       	                    
diff --git a/ql/src/test/results/clientpositive/index_serde.q.out b/ql/src/test/results/clientpositive/index_serde.q.out
index cf18225fdb..54aa0e1657 100644
--- a/ql/src/test/results/clientpositive/index_serde.q.out
+++ b/ql/src/test/results/clientpositive/index_serde.q.out
@@ -65,8 +65,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@doctors
 PREHOOK: query: DESCRIBE doctors
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@doctors
 POSTHOOK: query: DESCRIBE doctors
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@doctors
 number              	int                 	from deserializer   
 first_name          	string              	from deserializer   
 last_name           	string              	from deserializer   
@@ -87,8 +89,10 @@ POSTHOOK: type: CREATEINDEX
 POSTHOOK: Output: default@default__doctors_doctors_index__
 PREHOOK: query: DESCRIBE EXTENDED default__doctors_doctors_index__
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@default__doctors_doctors_index__
 POSTHOOK: query: DESCRIBE EXTENDED default__doctors_doctors_index__
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@default__doctors_doctors_index__
 number              	int                 	from deserializer   
 _bucketname         	string              	                    
 _offsets            	array<bigint>       	                    
diff --git a/ql/src/test/results/clientpositive/infer_bucket_sort.q.out b/ql/src/test/results/clientpositive/infer_bucket_sort.q.out
index 2797023c04..a7d18ba96a 100644
--- a/ql/src/test/results/clientpositive/infer_bucket_sort.q.out
+++ b/ql/src/test/results/clientpositive/infer_bucket_sort.q.out
@@ -27,8 +27,10 @@ POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema
 POSTHOOK: Lineage: test_table PARTITION(part=1).value EXPRESSION [(src)src.null, ]
 PREHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).value EXPRESSION [(src)src.null, ]
 # col_name            	data_type           	comment             
@@ -84,8 +86,10 @@ POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema
 POSTHOOK: Lineage: test_table PARTITION(part=1).value EXPRESSION [(src)src.null, ]
 PREHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).value EXPRESSION [(src)src.null, ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -145,8 +149,10 @@ POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)a.FieldSchema(n
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)a.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).value EXPRESSION [(src)src.null, ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -210,8 +216,10 @@ POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)a.FieldSchema(n
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)a.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).value EXPRESSION [(src)src.null, ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)a.FieldSchema(name:key, type:string, comment:default), ]
@@ -279,8 +287,10 @@ POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)a.FieldSchema(n
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)a.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).value EXPRESSION [(src)src.null, ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)a.FieldSchema(name:key, type:string, comment:default), ]
@@ -352,8 +362,10 @@ POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)a.FieldSchema(n
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)c.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).value EXPRESSION [(src)src.null, ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)a.FieldSchema(name:key, type:string, comment:default), ]
@@ -429,8 +441,10 @@ POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)a.FieldSchema(n
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)c.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).value EXPRESSION [(src)src.null, ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)a.FieldSchema(name:key, type:string, comment:default), ]
@@ -510,8 +524,10 @@ POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)a.FieldSchema(n
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)c.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).value EXPRESSION [(src)src.null, ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)a.FieldSchema(name:key, type:string, comment:default), ]
@@ -595,8 +611,10 @@ POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)a.FieldSchema(n
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)c.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -684,8 +702,10 @@ POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)a.FieldSchema(n
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)c.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -777,8 +797,10 @@ POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)a.FieldSchema(n
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)c.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -874,8 +896,10 @@ POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)a.FieldSchema(n
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)c.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -975,8 +999,10 @@ POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)a.FieldSchema(n
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)c.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -1080,8 +1106,10 @@ POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)a.FieldSchema(n
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)c.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -1189,8 +1217,10 @@ POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)a.FieldSchema(n
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)c.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -1302,8 +1332,10 @@ POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)a.FieldSchema(n
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)c.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -1419,8 +1451,10 @@ POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)a.FieldSchema(n
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)c.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -1540,8 +1574,10 @@ POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)a.FieldSchema(n
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)c.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -1665,8 +1701,10 @@ POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)a.FieldSchema(n
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)c.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -1796,8 +1834,10 @@ POSTHOOK: Lineage: test_table PARTITION(part=1).key EXPRESSION [(src)src.null, ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).value EXPRESSION [(src)src.null, ]
 PREHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -1931,8 +1971,10 @@ POSTHOOK: Lineage: test_table PARTITION(part=1).key EXPRESSION [(src)src.null, ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -2068,8 +2110,10 @@ POSTHOOK: Lineage: test_table PARTITION(part=1).key EXPRESSION [(src)src.null, ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -2209,8 +2253,10 @@ POSTHOOK: Lineage: test_table PARTITION(part=1).key EXPRESSION [(src)src.null, ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -2354,8 +2400,10 @@ POSTHOOK: Lineage: test_table PARTITION(part=1).key EXPRESSION [(src)src.null, ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -2503,8 +2551,10 @@ POSTHOOK: Lineage: test_table PARTITION(part=1).key EXPRESSION [(src)src.null, ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/infer_bucket_sort_bucketed_table.q.out b/ql/src/test/results/clientpositive/infer_bucket_sort_bucketed_table.q.out
index 690aeacefb..ed823f805b 100644
--- a/ql/src/test/results/clientpositive/infer_bucket_sort_bucketed_table.q.out
+++ b/ql/src/test/results/clientpositive/infer_bucket_sort_bucketed_table.q.out
@@ -29,8 +29,10 @@ POSTHOOK: Lineage: test_table_bucketed PARTITION(part=1).key SIMPLE [(src)src.Fi
 POSTHOOK: Lineage: test_table_bucketed PARTITION(part=1).value EXPRESSION [(src)src.null, ]
 PREHOOK: query: DESCRIBE FORMATTED test_table_bucketed PARTITION (part = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table_bucketed
 POSTHOOK: query: DESCRIBE FORMATTED test_table_bucketed PARTITION (part = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table_bucketed
 POSTHOOK: Lineage: test_table_bucketed PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table_bucketed PARTITION(part=1).value EXPRESSION [(src)src.null, ]
 # col_name            	data_type           	comment             
diff --git a/ql/src/test/results/clientpositive/infer_bucket_sort_convert_join.q.out b/ql/src/test/results/clientpositive/infer_bucket_sort_convert_join.q.out
index 45f2b5e2a8..3b149869d5 100644
--- a/ql/src/test/results/clientpositive/infer_bucket_sort_convert_join.q.out
+++ b/ql/src/test/results/clientpositive/infer_bucket_sort_convert_join.q.out
@@ -29,8 +29,10 @@ POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)a.FieldSchema(n
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)b.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)a.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)b.FieldSchema(name:value, type:string, comment:default), ]
 # col_name            	data_type           	comment             
@@ -102,8 +104,10 @@ POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)a.FieldSchema(n
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)b.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)a.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)b.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)a.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/infer_bucket_sort_dyn_part.q.out b/ql/src/test/results/clientpositive/infer_bucket_sort_dyn_part.q.out
index 81e4a893c8..8b0bf96d63 100644
--- a/ql/src/test/results/clientpositive/infer_bucket_sort_dyn_part.q.out
+++ b/ql/src/test/results/clientpositive/infer_bucket_sort_dyn_part.q.out
@@ -48,8 +48,10 @@ POSTHOOK: Lineage: test_table PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpar
 POSTHOOK: Lineage: test_table PARTITION(ds=2008-04-08,hr=12).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED test_table PARTITION (ds='2008-04-08', hr='11')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE FORMATTED test_table PARTITION (ds='2008-04-08', hr='11')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 POSTHOOK: Lineage: test_table PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -92,8 +94,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: DESCRIBE FORMATTED test_table PARTITION (ds='2008-04-08', hr='12')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE FORMATTED test_table PARTITION (ds='2008-04-08', hr='12')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 POSTHOOK: Lineage: test_table PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -169,8 +173,10 @@ POSTHOOK: Lineage: test_table PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpar
 POSTHOOK: Lineage: test_table PARTITION(ds=2008-04-08,hr=12).value EXPRESSION [(srcpart)srcpart.null, ]
 PREHOOK: query: DESCRIBE FORMATTED test_table PARTITION (ds='2008-04-08', hr='11')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE FORMATTED test_table PARTITION (ds='2008-04-08', hr='11')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 POSTHOOK: Lineage: test_table PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -217,8 +223,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: DESCRIBE FORMATTED test_table PARTITION (ds='2008-04-08', hr='12')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE FORMATTED test_table PARTITION (ds='2008-04-08', hr='12')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 POSTHOOK: Lineage: test_table PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -302,8 +310,10 @@ POSTHOOK: Lineage: test_table PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpar
 POSTHOOK: Lineage: test_table PARTITION(ds=2008-04-08,hr=12).value EXPRESSION [(srcpart)srcpart.null, ]
 PREHOOK: query: DESCRIBE FORMATTED test_table PARTITION (ds='2008-04-08', hr='11')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE FORMATTED test_table PARTITION (ds='2008-04-08', hr='11')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 POSTHOOK: Lineage: test_table PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -354,8 +364,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: DESCRIBE FORMATTED test_table PARTITION (ds='2008-04-08', hr='12')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE FORMATTED test_table PARTITION (ds='2008-04-08', hr='12')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 POSTHOOK: Lineage: test_table PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -789,8 +801,10 @@ POSTHOOK: Lineage: test_table PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpar
 POSTHOOK: Lineage: test_table PARTITION(ds=2008-04-08,hr=12).value EXPRESSION [(srcpart)srcpart.null, ]
 PREHOOK: query: DESCRIBE FORMATTED test_table PARTITION (ds='2008-04-08', hr='11')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE FORMATTED test_table PARTITION (ds='2008-04-08', hr='11')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 POSTHOOK: Lineage: srcpart_merge_dp_rc PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart_merge_dp)srcpart_merge_dp.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: srcpart_merge_dp_rc PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart_merge_dp)srcpart_merge_dp.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: srcpart_merge_dp_rc PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart_merge_dp)srcpart_merge_dp.FieldSchema(name:key, type:string, comment:default), ]
@@ -849,8 +863,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: DESCRIBE FORMATTED test_table PARTITION (ds='2008-04-08', hr='12')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE FORMATTED test_table PARTITION (ds='2008-04-08', hr='12')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 POSTHOOK: Lineage: srcpart_merge_dp_rc PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart_merge_dp)srcpart_merge_dp.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: srcpart_merge_dp_rc PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart_merge_dp)srcpart_merge_dp.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: srcpart_merge_dp_rc PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart_merge_dp)srcpart_merge_dp.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/infer_bucket_sort_grouping_operators.q.out b/ql/src/test/results/clientpositive/infer_bucket_sort_grouping_operators.q.out
index 536c94dc81..bb80552469 100644
--- a/ql/src/test/results/clientpositive/infer_bucket_sort_grouping_operators.q.out
+++ b/ql/src/test/results/clientpositive/infer_bucket_sort_grouping_operators.q.out
@@ -106,8 +106,10 @@ POSTHOOK: Lineage: test_table_out PARTITION(part=1).key SIMPLE [(src)src.FieldSc
 POSTHOOK: Lineage: test_table_out PARTITION(part=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED test_table_out PARTITION (part = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table_out
 POSTHOOK: query: DESCRIBE FORMATTED test_table_out PARTITION (part = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table_out
 POSTHOOK: Lineage: test_table_out PARTITION(part=1).agg EXPRESSION [(src)src.null, ]
 POSTHOOK: Lineage: test_table_out PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table_out PARTITION(part=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
@@ -170,8 +172,10 @@ POSTHOOK: Lineage: test_table_out_2 PARTITION(part=1).key SIMPLE [(src)src.Field
 POSTHOOK: Lineage: test_table_out_2 PARTITION(part=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED test_table_out_2 PARTITION (part = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table_out_2
 POSTHOOK: query: DESCRIBE FORMATTED test_table_out_2 PARTITION (part = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table_out_2
 POSTHOOK: Lineage: test_table_out PARTITION(part=1).agg EXPRESSION [(src)src.null, ]
 POSTHOOK: Lineage: test_table_out PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table_out PARTITION(part=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
@@ -316,8 +320,10 @@ POSTHOOK: Lineage: test_table_out_2 PARTITION(part=1).key SIMPLE [(src)src.Field
 POSTHOOK: Lineage: test_table_out_2 PARTITION(part=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED test_table_out PARTITION (part = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table_out
 POSTHOOK: query: DESCRIBE FORMATTED test_table_out PARTITION (part = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table_out
 POSTHOOK: Lineage: test_table_out PARTITION(part=1).agg EXPRESSION [(src)src.null, ]
 POSTHOOK: Lineage: test_table_out PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table_out PARTITION(part=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
@@ -394,8 +400,10 @@ POSTHOOK: Lineage: test_table_out_2 PARTITION(part=1).key SIMPLE [(src)src.Field
 POSTHOOK: Lineage: test_table_out_2 PARTITION(part=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED test_table_out_2 PARTITION (part = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table_out_2
 POSTHOOK: query: DESCRIBE FORMATTED test_table_out_2 PARTITION (part = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table_out_2
 POSTHOOK: Lineage: test_table_out PARTITION(part=1).agg EXPRESSION [(src)src.null, ]
 POSTHOOK: Lineage: test_table_out PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table_out PARTITION(part=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
@@ -561,8 +569,10 @@ POSTHOOK: Lineage: test_table_out_2 PARTITION(part=1).key SIMPLE [(src)src.Field
 POSTHOOK: Lineage: test_table_out_2 PARTITION(part=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED test_table_out PARTITION (part = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table_out
 POSTHOOK: query: DESCRIBE FORMATTED test_table_out PARTITION (part = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table_out
 POSTHOOK: Lineage: test_table_out PARTITION(part=1).agg EXPRESSION [(src)src.null, ]
 POSTHOOK: Lineage: test_table_out PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table_out PARTITION(part=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
@@ -653,8 +663,10 @@ POSTHOOK: Lineage: test_table_out_2 PARTITION(part=1).key SIMPLE [(src)src.Field
 POSTHOOK: Lineage: test_table_out_2 PARTITION(part=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED test_table_out_2 PARTITION (part = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table_out_2
 POSTHOOK: query: DESCRIBE FORMATTED test_table_out_2 PARTITION (part = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table_out_2
 POSTHOOK: Lineage: test_table_out PARTITION(part=1).agg EXPRESSION [(src)src.null, ]
 POSTHOOK: Lineage: test_table_out PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table_out PARTITION(part=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/infer_bucket_sort_map_operators.q.out b/ql/src/test/results/clientpositive/infer_bucket_sort_map_operators.q.out
index 881e0c0557..1c1471f7ca 100644
--- a/ql/src/test/results/clientpositive/infer_bucket_sort_map_operators.q.out
+++ b/ql/src/test/results/clientpositive/infer_bucket_sort_map_operators.q.out
@@ -181,8 +181,10 @@ POSTHOOK: Lineage: test_table_out PARTITION(part=1).key SIMPLE [(test_table1)tes
 POSTHOOK: Lineage: test_table_out PARTITION(part=1).value EXPRESSION [(test_table1)test_table1.null, ]
 PREHOOK: query: DESCRIBE FORMATTED test_table_out PARTITION (part = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table_out
 POSTHOOK: query: DESCRIBE FORMATTED test_table_out PARTITION (part = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table_out
 POSTHOOK: Lineage: test_table1.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table1.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table2.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -361,8 +363,10 @@ POSTHOOK: Lineage: test_table_out PARTITION(part=1).key SIMPLE [(test_table1)tes
 POSTHOOK: Lineage: test_table_out PARTITION(part=1).value EXPRESSION [(test_table1)test_table1.null, ]
 PREHOOK: query: DESCRIBE FORMATTED test_table_out PARTITION (part = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table_out
 POSTHOOK: query: DESCRIBE FORMATTED test_table_out PARTITION (part = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table_out
 POSTHOOK: Lineage: test_table1.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table1.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table2.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -538,8 +542,10 @@ POSTHOOK: Lineage: test_table_out PARTITION(part=1).key SIMPLE [(test_table1)tes
 POSTHOOK: Lineage: test_table_out PARTITION(part=1).value EXPRESSION [(test_table1)test_table1.null, ]
 PREHOOK: query: DESCRIBE FORMATTED test_table_out PARTITION (part = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table_out
 POSTHOOK: query: DESCRIBE FORMATTED test_table_out PARTITION (part = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table_out
 POSTHOOK: Lineage: test_table1.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table1.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table2.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -700,8 +706,10 @@ POSTHOOK: Lineage: test_table_out PARTITION(part=1).key SIMPLE [(test_table1)tes
 POSTHOOK: Lineage: test_table_out PARTITION(part=1).value EXPRESSION [(test_table1)test_table1.null, ]
 PREHOOK: query: DESCRIBE FORMATTED test_table_out PARTITION (part = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table_out
 POSTHOOK: query: DESCRIBE FORMATTED test_table_out PARTITION (part = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table_out
 POSTHOOK: Lineage: test_table1.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table1.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table2.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/infer_bucket_sort_merge.q.out b/ql/src/test/results/clientpositive/infer_bucket_sort_merge.q.out
index 9162b7fe0a..6a8e7cb660 100644
--- a/ql/src/test/results/clientpositive/infer_bucket_sort_merge.q.out
+++ b/ql/src/test/results/clientpositive/infer_bucket_sort_merge.q.out
@@ -29,8 +29,10 @@ POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)a.FieldSchema(n
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)b.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)a.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)b.FieldSchema(name:value, type:string, comment:default), ]
 # col_name            	data_type           	comment             
@@ -86,8 +88,10 @@ POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)a.FieldSchema(n
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)b.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)a.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)b.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)a.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/infer_bucket_sort_multi_insert.q.out b/ql/src/test/results/clientpositive/infer_bucket_sort_multi_insert.q.out
index 80ca41bc11..911a2488b6 100644
--- a/ql/src/test/results/clientpositive/infer_bucket_sort_multi_insert.q.out
+++ b/ql/src/test/results/clientpositive/infer_bucket_sort_multi_insert.q.out
@@ -37,8 +37,10 @@ POSTHOOK: Lineage: test_table PARTITION(part=2).key SIMPLE [(src)src.FieldSchema
 POSTHOOK: Lineage: test_table PARTITION(part=2).value SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=2).key SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
@@ -80,8 +82,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '2')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '2')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=2).key SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
@@ -149,8 +153,10 @@ POSTHOOK: Lineage: test_table PARTITION(part=2).key EXPRESSION [(src)src.null, ]
 POSTHOOK: Lineage: test_table PARTITION(part=2).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -196,8 +202,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '2')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '2')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -273,8 +281,10 @@ POSTHOOK: Lineage: test_table PARTITION(part=2).key EXPRESSION [(src)src.null, ]
 POSTHOOK: Lineage: test_table PARTITION(part=2).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -324,8 +334,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '2')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '2')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -409,8 +421,10 @@ POSTHOOK: Lineage: test_table PARTITION(part=2).key EXPRESSION [(src)src.null, ]
 POSTHOOK: Lineage: test_table PARTITION(part=2).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -464,8 +478,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '2')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '2')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/infer_bucket_sort_num_buckets.q.out b/ql/src/test/results/clientpositive/infer_bucket_sort_num_buckets.q.out
index 24ae0952ea..4bf1e5e48a 100644
--- a/ql/src/test/results/clientpositive/infer_bucket_sort_num_buckets.q.out
+++ b/ql/src/test/results/clientpositive/infer_bucket_sort_num_buckets.q.out
@@ -125,8 +125,10 @@ POSTHOOK: Lineage: test_table PARTITION(ds=2008-04-08,hr=1).key EXPRESSION [(src
 POSTHOOK: Lineage: test_table PARTITION(ds=2008-04-08,hr=1).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED test_table PARTITION (ds='2008-04-08', hr='0')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE FORMATTED test_table PARTITION (ds='2008-04-08', hr='0')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 POSTHOOK: Lineage: test_table PARTITION(ds=2008-04-08,hr=0).key EXPRESSION [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(ds=2008-04-08,hr=0).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(ds=2008-04-08,hr=1).key EXPRESSION [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -169,8 +171,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: DESCRIBE FORMATTED test_table PARTITION (ds='2008-04-08', hr='1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE FORMATTED test_table PARTITION (ds='2008-04-08', hr='1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 POSTHOOK: Lineage: test_table PARTITION(ds=2008-04-08,hr=0).key EXPRESSION [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(ds=2008-04-08,hr=0).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(ds=2008-04-08,hr=1).key EXPRESSION [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/infer_bucket_sort_reducers_power_two.q.out b/ql/src/test/results/clientpositive/infer_bucket_sort_reducers_power_two.q.out
index 441448957b..6831b35e37 100644
--- a/ql/src/test/results/clientpositive/infer_bucket_sort_reducers_power_two.q.out
+++ b/ql/src/test/results/clientpositive/infer_bucket_sort_reducers_power_two.q.out
@@ -29,8 +29,10 @@ POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema
 POSTHOOK: Lineage: test_table PARTITION(part=1).value EXPRESSION [(src)src.null, ]
 PREHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).value EXPRESSION [(src)src.null, ]
 # col_name            	data_type           	comment             
@@ -86,8 +88,10 @@ POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)a.FieldSchema(n
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)a.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).value EXPRESSION [(src)src.null, ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)a.FieldSchema(name:key, type:string, comment:default), ]
@@ -147,8 +151,10 @@ POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)a.FieldSchema(n
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)a.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)a.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)a.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -212,8 +218,10 @@ POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)a.FieldSchema(n
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)c.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)a.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)a.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -281,8 +289,10 @@ POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)a.FieldSchema(n
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)c.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)a.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)c.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)a.FieldSchema(name:key, type:string, comment:default), ]
@@ -356,8 +366,10 @@ POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)a.FieldSchema(n
 POSTHOOK: Lineage: test_table PARTITION(part=1).value SIMPLE [(src)c.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DESCRIBE FORMATTED test_table PARTITION (part = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_table
 POSTHOOK: Lineage: test_table PARTITION(part=1).key EXPRESSION [(src)src.null, ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).value EXPRESSION [(src)src.null, ]
 POSTHOOK: Lineage: test_table PARTITION(part=1).key SIMPLE [(src)a.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/inoutdriver.q.out b/ql/src/test/results/clientpositive/inoutdriver.q.out
index 94ab37618e..3fa8ffbead 100644
--- a/ql/src/test/results/clientpositive/inoutdriver.q.out
+++ b/ql/src/test/results/clientpositive/inoutdriver.q.out
@@ -7,8 +7,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@test
 PREHOOK: query: desc extended test
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test
 POSTHOOK: query: desc extended test
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test
 a                   	int                 	                    
 	 	 
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/input1.q.out b/ql/src/test/results/clientpositive/input1.q.out
index addda2cb31..2e6af4f8bd 100644
--- a/ql/src/test/results/clientpositive/input1.q.out
+++ b/ql/src/test/results/clientpositive/input1.q.out
@@ -27,7 +27,9 @@ STAGE PLANS:
 
 PREHOOK: query: DESCRIBE TEST1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test1
 POSTHOOK: query: DESCRIBE TEST1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test1
 a                   	int                 	                    
 b                   	double              	                    
diff --git a/ql/src/test/results/clientpositive/input10.q.out b/ql/src/test/results/clientpositive/input10.q.out
index 7a70bcab09..9b172daa34 100644
--- a/ql/src/test/results/clientpositive/input10.q.out
+++ b/ql/src/test/results/clientpositive/input10.q.out
@@ -27,8 +27,10 @@ STAGE PLANS:
 
 PREHOOK: query: DESCRIBE TEST10
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test10
 POSTHOOK: query: DESCRIBE TEST10
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test10
 key                 	int                 	                    
 value               	string              	                    
 ds                  	string              	                    
diff --git a/ql/src/test/results/clientpositive/input15.q.out b/ql/src/test/results/clientpositive/input15.q.out
index 7ee65c5fd6..a9575ddb67 100644
--- a/ql/src/test/results/clientpositive/input15.q.out
+++ b/ql/src/test/results/clientpositive/input15.q.out
@@ -26,7 +26,9 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@TEST15
 PREHOOK: query: DESCRIBE TEST15
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test15
 POSTHOOK: query: DESCRIBE TEST15
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test15
 key                 	int                 	                    
 value               	string              	                    
diff --git a/ql/src/test/results/clientpositive/input2.q.out b/ql/src/test/results/clientpositive/input2.q.out
index 33ca479de5..e36c17449b 100644
--- a/ql/src/test/results/clientpositive/input2.q.out
+++ b/ql/src/test/results/clientpositive/input2.q.out
@@ -7,14 +7,18 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@TEST2a
 PREHOOK: query: DESCRIBE TEST2a
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test2a
 POSTHOOK: query: DESCRIBE TEST2a
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test2a
 a                   	int                 	                    
 b                   	double              	                    
 PREHOOK: query: DESC TEST2a
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test2a
 POSTHOOK: query: DESC TEST2a
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test2a
 a                   	int                 	                    
 b                   	double              	                    
 PREHOOK: query: CREATE TABLE TEST2b(A ARRAY<INT>, B DOUBLE, C MAP<DOUBLE, INT>) STORED AS TEXTFILE
@@ -26,8 +30,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@TEST2b
 PREHOOK: query: DESCRIBE TEST2b
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test2b
 POSTHOOK: query: DESCRIBE TEST2b
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test2b
 a                   	array<int>          	                    
 b                   	double              	                    
 c                   	map<double,int>     	                    
diff --git a/ql/src/test/results/clientpositive/input3.q.out b/ql/src/test/results/clientpositive/input3.q.out
index 94706bc697..547449cfe8 100644
--- a/ql/src/test/results/clientpositive/input3.q.out
+++ b/ql/src/test/results/clientpositive/input3.q.out
@@ -7,8 +7,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@TEST3a
 PREHOOK: query: DESCRIBE TEST3a
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test3a
 POSTHOOK: query: DESCRIBE TEST3a
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test3a
 a                   	int                 	                    
 b                   	double              	                    
 PREHOOK: query: CREATE TABLE TEST3b(A ARRAY<INT>, B DOUBLE, C MAP<DOUBLE, INT>) STORED AS TEXTFILE
@@ -20,8 +22,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@TEST3b
 PREHOOK: query: DESCRIBE TEST3b
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test3b
 POSTHOOK: query: DESCRIBE TEST3b
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test3b
 a                   	array<int>          	                    
 b                   	double              	                    
 c                   	map<double,int>     	                    
@@ -67,8 +71,10 @@ POSTHOOK: Input: default@test3b
 POSTHOOK: Output: default@test3b
 PREHOOK: query: DESCRIBE TEST3b
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test3b
 POSTHOOK: query: DESCRIBE TEST3b
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test3b
 a                   	array<int>          	                    
 b                   	double              	                    
 c                   	map<double,int>     	                    
@@ -101,8 +107,10 @@ POSTHOOK: Output: default@TEST3c
 POSTHOOK: Output: default@test3b
 PREHOOK: query: DESCRIBE TEST3c
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test3c
 POSTHOOK: query: DESCRIBE TEST3c
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test3c
 a                   	array<int>          	                    
 b                   	double              	                    
 c                   	map<double,int>     	                    
@@ -149,8 +157,10 @@ POSTHOOK: Input: default@test3c
 POSTHOOK: Output: default@test3c
 PREHOOK: query: DESCRIBE EXTENDED TEST3c
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test3c
 POSTHOOK: query: DESCRIBE EXTENDED TEST3c
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test3c
 r1                  	int                 	                    
 r2                  	double              	                    
 	 	 
diff --git a/ql/src/test/results/clientpositive/input_part10.q.out b/ql/src/test/results/clientpositive/input_part10.q.out
index bdc3e63c66..8c6afeac2b 100644
--- a/ql/src/test/results/clientpositive/input_part10.q.out
+++ b/ql/src/test/results/clientpositive/input_part10.q.out
@@ -99,8 +99,10 @@ POSTHOOK: Lineage: part_special PARTITION(ds=2008 04 08,ts=10:11:12=455).a SIMPL
 POSTHOOK: Lineage: part_special PARTITION(ds=2008 04 08,ts=10:11:12=455).b SIMPLE []
 PREHOOK: query: DESCRIBE EXTENDED part_special PARTITION(ds='2008 04 08', ts = '10:11:12=455')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@part_special
 POSTHOOK: query: DESCRIBE EXTENDED part_special PARTITION(ds='2008 04 08', ts = '10:11:12=455')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@part_special
 POSTHOOK: Lineage: part_special PARTITION(ds=2008 04 08,ts=10:11:12=455).a SIMPLE []
 POSTHOOK: Lineage: part_special PARTITION(ds=2008 04 08,ts=10:11:12=455).b SIMPLE []
 a                   	string              	                    
diff --git a/ql/src/test/results/clientpositive/inputddl2.q.out b/ql/src/test/results/clientpositive/inputddl2.q.out
index 01fa403ac0..f53b0b7039 100644
--- a/ql/src/test/results/clientpositive/inputddl2.q.out
+++ b/ql/src/test/results/clientpositive/inputddl2.q.out
@@ -26,8 +26,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@INPUTDDL2
 PREHOOK: query: DESCRIBE INPUTDDL2
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@inputddl2
 POSTHOOK: query: DESCRIBE INPUTDDL2
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@inputddl2
 key                 	int                 	                    
 value               	string              	                    
 ds                  	string              	                    
diff --git a/ql/src/test/results/clientpositive/inputddl3.q.out b/ql/src/test/results/clientpositive/inputddl3.q.out
index 6be4312a8e..6682b09e33 100644
--- a/ql/src/test/results/clientpositive/inputddl3.q.out
+++ b/ql/src/test/results/clientpositive/inputddl3.q.out
@@ -26,7 +26,9 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@INPUTDDL3
 PREHOOK: query: DESCRIBE INPUTDDL3
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@inputddl3
 POSTHOOK: query: DESCRIBE INPUTDDL3
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@inputddl3
 key                 	int                 	                    
 value               	string              	                    
diff --git a/ql/src/test/results/clientpositive/inputddl4.q.out b/ql/src/test/results/clientpositive/inputddl4.q.out
index 459f9c74f5..ba9c3e40f4 100644
--- a/ql/src/test/results/clientpositive/inputddl4.q.out
+++ b/ql/src/test/results/clientpositive/inputddl4.q.out
@@ -23,8 +23,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@INPUTDDL4
 PREHOOK: query: DESCRIBE INPUTDDL4
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@inputddl4
 POSTHOOK: query: DESCRIBE INPUTDDL4
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@inputddl4
 viewtime            	string              	                    
 userid              	int                 	                    
 page_url            	string              	                    
@@ -42,8 +44,10 @@ ds                  	string
 country             	string              	                    
 PREHOOK: query: DESCRIBE EXTENDED INPUTDDL4
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@inputddl4
 POSTHOOK: query: DESCRIBE EXTENDED INPUTDDL4
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@inputddl4
 viewtime            	string              	                    
 userid              	int                 	                    
 page_url            	string              	                    
diff --git a/ql/src/test/results/clientpositive/inputddl5.q.out b/ql/src/test/results/clientpositive/inputddl5.q.out
index 8ef9253c32..54a3e7b384 100644
--- a/ql/src/test/results/clientpositive/inputddl5.q.out
+++ b/ql/src/test/results/clientpositive/inputddl5.q.out
@@ -19,8 +19,10 @@ POSTHOOK: type: LOAD
 POSTHOOK: Output: default@inputddl5
 PREHOOK: query: DESCRIBE INPUTDDL5
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@inputddl5
 POSTHOOK: query: DESCRIBE INPUTDDL5
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@inputddl5
 name                	string              	                    
 PREHOOK: query: SELECT INPUTDDL5.name from INPUTDDL5
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/inputddl6.q.out b/ql/src/test/results/clientpositive/inputddl6.q.out
index 9055fa3f06..407b64fa3a 100644
--- a/ql/src/test/results/clientpositive/inputddl6.q.out
+++ b/ql/src/test/results/clientpositive/inputddl6.q.out
@@ -31,8 +31,10 @@ POSTHOOK: Output: default@inputddl6
 POSTHOOK: Output: default@inputddl6@ds=2008-04-08
 PREHOOK: query: DESCRIBE EXTENDED INPUTDDL6
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@inputddl6
 POSTHOOK: query: DESCRIBE EXTENDED INPUTDDL6
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@inputddl6
 key                 	string              	                    
 value               	string              	                    
 ds                  	string              	                    
@@ -45,8 +47,10 @@ ds                  	string
 #### A masked pattern was here ####
 PREHOOK: query: DESCRIBE EXTENDED INPUTDDL6 PARTITION (ds='2008-04-08')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@inputddl6
 POSTHOOK: query: DESCRIBE EXTENDED INPUTDDL6 PARTITION (ds='2008-04-08')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@inputddl6
 key                 	string              	                    
 value               	string              	                    
 ds                  	string              	                    
@@ -59,8 +63,10 @@ ds                  	string
 #### A masked pattern was here ####
 PREHOOK: query: SHOW PARTITIONS INPUTDDL6
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@inputddl6
 POSTHOOK: query: SHOW PARTITIONS INPUTDDL6
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@inputddl6
 ds=2008-04-08
 ds=2008-04-09
 PREHOOK: query: ALTER TABLE INPUTDDL6 DROP PARTITION (ds='2008-04-08')
@@ -73,8 +79,10 @@ POSTHOOK: Input: default@inputddl6
 POSTHOOK: Output: default@inputddl6@ds=2008-04-08
 PREHOOK: query: SHOW PARTITIONS INPUTDDL6
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@inputddl6
 POSTHOOK: query: SHOW PARTITIONS INPUTDDL6
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@inputddl6
 ds=2008-04-09
 PREHOOK: query: EXPLAIN
 DESCRIBE EXTENDED INPUTDDL6 PARTITION (ds='2008-04-09')
diff --git a/ql/src/test/results/clientpositive/inputddl7.q.out b/ql/src/test/results/clientpositive/inputddl7.q.out
index d3db941689..3f2584d661 100644
--- a/ql/src/test/results/clientpositive/inputddl7.q.out
+++ b/ql/src/test/results/clientpositive/inputddl7.q.out
@@ -110,22 +110,28 @@ POSTHOOK: Input: default@t4@ds=2008-04-09
 500
 PREHOOK: query: DESCRIBE EXTENDED T1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@t1
 POSTHOOK: query: DESCRIBE EXTENDED T1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@t1
 name                	string              	                    
 	 	 
 #### A masked pattern was here ####
 PREHOOK: query: DESCRIBE EXTENDED T2
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@t2
 POSTHOOK: query: DESCRIBE EXTENDED T2
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@t2
 name                	string              	                    
 	 	 
 #### A masked pattern was here ####
 PREHOOK: query: DESCRIBE EXTENDED T3 PARTITION (ds='2008-04-09')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@t3
 POSTHOOK: query: DESCRIBE EXTENDED T3 PARTITION (ds='2008-04-09')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@t3
 name                	string              	                    
 ds                  	string              	                    
 	 	 
@@ -137,8 +143,10 @@ ds                  	string
 #### A masked pattern was here ####
 PREHOOK: query: DESCRIBE EXTENDED T4 PARTITION (ds='2008-04-09')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@t4
 POSTHOOK: query: DESCRIBE EXTENDED T4 PARTITION (ds='2008-04-09')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@t4
 name                	string              	                    
 ds                  	string              	                    
 	 	 
diff --git a/ql/src/test/results/clientpositive/inputddl8.q.out b/ql/src/test/results/clientpositive/inputddl8.q.out
index c3854e5c5f..39efb0c969 100644
--- a/ql/src/test/results/clientpositive/inputddl8.q.out
+++ b/ql/src/test/results/clientpositive/inputddl8.q.out
@@ -19,8 +19,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@INPUTDDL8
 PREHOOK: query: DESCRIBE EXTENDED INPUTDDL8
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@inputddl8
 POSTHOOK: query: DESCRIBE EXTENDED INPUTDDL8
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@inputddl8
 aint                	int                 	from deserializer   
 astring             	string              	from deserializer   
 lint                	array<int>          	from deserializer   
diff --git a/ql/src/test/results/clientpositive/insert_into6.q.out b/ql/src/test/results/clientpositive/insert_into6.q.out
index ec47791089..d566e78249 100644
--- a/ql/src/test/results/clientpositive/insert_into6.q.out
+++ b/ql/src/test/results/clientpositive/insert_into6.q.out
@@ -233,8 +233,10 @@ POSTHOOK: Lineage: insert_into6b PARTITION(ds=2).value SIMPLE [(insert_into6a)in
 -35226404960
 PREHOOK: query: SHOW PARTITIONS insert_into6b
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@insert_into6b
 POSTHOOK: query: SHOW PARTITIONS insert_into6b
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@insert_into6b
 POSTHOOK: Lineage: insert_into6a PARTITION(ds=1).key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: insert_into6a PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: insert_into6a PARTITION(ds=2).key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/join_thrift.q.out b/ql/src/test/results/clientpositive/join_thrift.q.out
index c10bf144d0..bb845c2e62 100644
--- a/ql/src/test/results/clientpositive/join_thrift.q.out
+++ b/ql/src/test/results/clientpositive/join_thrift.q.out
@@ -1,7 +1,9 @@
 PREHOOK: query: DESCRIBE src_thrift
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@src_thrift
 POSTHOOK: query: DESCRIBE src_thrift
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@src_thrift
 aint                	int                 	from deserializer   
 astring             	string              	from deserializer   
 lint                	array<int>          	from deserializer   
diff --git a/ql/src/test/results/clientpositive/list_bucket_dml_10.q.out b/ql/src/test/results/clientpositive/list_bucket_dml_10.q.out
index c1e313d169..b0593a46e6 100644
--- a/ql/src/test/results/clientpositive/list_bucket_dml_10.q.out
+++ b/ql/src/test/results/clientpositive/list_bucket_dml_10.q.out
@@ -325,16 +325,20 @@ POSTHOOK: Lineage: list_bucketing_static_part PARTITION(ds=2008-04-08,hr=11).val
 PREHOOK: query: -- check DML result
 show partitions list_bucketing_static_part
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@list_bucketing_static_part
 POSTHOOK: query: -- check DML result
 show partitions list_bucketing_static_part
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@list_bucketing_static_part
 POSTHOOK: Lineage: list_bucketing_static_part PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: list_bucketing_static_part PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 ds=2008-04-08/hr=11
 PREHOOK: query: desc formatted list_bucketing_static_part partition (ds='2008-04-08', hr='11')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@list_bucketing_static_part
 POSTHOOK: query: desc formatted list_bucketing_static_part partition (ds='2008-04-08', hr='11')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@list_bucketing_static_part
 POSTHOOK: Lineage: list_bucketing_static_part PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: list_bucketing_static_part PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 # col_name            	data_type           	comment             
diff --git a/ql/src/test/results/clientpositive/load_dyn_part1.q.out b/ql/src/test/results/clientpositive/load_dyn_part1.q.out
index 4e4ef53486..787ebb9ba9 100644
--- a/ql/src/test/results/clientpositive/load_dyn_part1.q.out
+++ b/ql/src/test/results/clientpositive/load_dyn_part1.q.out
@@ -1,7 +1,9 @@
 PREHOOK: query: show partitions srcpart
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: show partitions srcpart
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@srcpart
 ds=2008-04-08/hr=11
 ds=2008-04-08/hr=12
 ds=2008-04-09/hr=11
@@ -22,8 +24,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@nzhang_part2
 PREHOOK: query: describe extended nzhang_part1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@nzhang_part1
 POSTHOOK: query: describe extended nzhang_part1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@nzhang_part1
 key                 	string              	default             
 value               	string              	default             
 ds                  	string              	                    
@@ -187,8 +191,10 @@ POSTHOOK: Lineage: nzhang_part2 PARTITION(ds=2008-12-31,hr=12).key SIMPLE [(srcp
 POSTHOOK: Lineage: nzhang_part2 PARTITION(ds=2008-12-31,hr=12).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: show partitions nzhang_part1
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@nzhang_part1
 POSTHOOK: query: show partitions nzhang_part1
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@nzhang_part1
 POSTHOOK: Lineage: nzhang_part1 PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: nzhang_part1 PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: nzhang_part1 PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -201,8 +207,10 @@ ds=2008-04-08/hr=11
 ds=2008-04-08/hr=12
 PREHOOK: query: show partitions nzhang_part2
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@nzhang_part2
 POSTHOOK: query: show partitions nzhang_part2
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@nzhang_part2
 POSTHOOK: Lineage: nzhang_part1 PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: nzhang_part1 PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: nzhang_part1 PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/load_dyn_part10.q.out b/ql/src/test/results/clientpositive/load_dyn_part10.q.out
index 292f855b91..90dd5d2fce 100644
--- a/ql/src/test/results/clientpositive/load_dyn_part10.q.out
+++ b/ql/src/test/results/clientpositive/load_dyn_part10.q.out
@@ -1,7 +1,9 @@
 PREHOOK: query: show partitions srcpart
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: show partitions srcpart
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@srcpart
 ds=2008-04-08/hr=11
 ds=2008-04-08/hr=12
 ds=2008-04-09/hr=11
@@ -15,8 +17,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@nzhang_part10
 PREHOOK: query: describe extended nzhang_part10
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@nzhang_part10
 POSTHOOK: query: describe extended nzhang_part10
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@nzhang_part10
 key                 	string              	default             
 value               	string              	default             
 ds                  	string              	                    
@@ -108,8 +112,10 @@ POSTHOOK: Lineage: nzhang_part10 PARTITION(ds=2008-12-31,hr=12).key SIMPLE [(src
 POSTHOOK: Lineage: nzhang_part10 PARTITION(ds=2008-12-31,hr=12).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: show partitions nzhang_part10
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@nzhang_part10
 POSTHOOK: query: show partitions nzhang_part10
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@nzhang_part10
 POSTHOOK: Lineage: nzhang_part10 PARTITION(ds=2008-12-31,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: nzhang_part10 PARTITION(ds=2008-12-31,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: nzhang_part10 PARTITION(ds=2008-12-31,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/load_dyn_part11.q.out b/ql/src/test/results/clientpositive/load_dyn_part11.q.out
index 50701d05b9..19e5f89ecf 100644
--- a/ql/src/test/results/clientpositive/load_dyn_part11.q.out
+++ b/ql/src/test/results/clientpositive/load_dyn_part11.q.out
@@ -1,7 +1,9 @@
 PREHOOK: query: show partitions srcpart
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: show partitions srcpart
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@srcpart
 ds=2008-04-08/hr=11
 ds=2008-04-08/hr=12
 ds=2008-04-09/hr=11
@@ -15,8 +17,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@nzhang_part
 PREHOOK: query: describe extended nzhang_part
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@nzhang_part
 POSTHOOK: query: describe extended nzhang_part
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@nzhang_part
 key                 	string              	default             
 value               	string              	default             
 ds                  	string              	                    
diff --git a/ql/src/test/results/clientpositive/load_dyn_part12.q.out b/ql/src/test/results/clientpositive/load_dyn_part12.q.out
index bc8e7231af..79bbf3d21e 100644
--- a/ql/src/test/results/clientpositive/load_dyn_part12.q.out
+++ b/ql/src/test/results/clientpositive/load_dyn_part12.q.out
@@ -1,7 +1,9 @@
 PREHOOK: query: show partitions srcpart
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: show partitions srcpart
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@srcpart
 ds=2008-04-08/hr=11
 ds=2008-04-08/hr=12
 ds=2008-04-09/hr=11
@@ -15,8 +17,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@nzhang_part12
 PREHOOK: query: describe extended nzhang_part12
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@nzhang_part12
 POSTHOOK: query: describe extended nzhang_part12
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@nzhang_part12
 key                 	string              	default             
 value               	string              	default             
 ds                  	string              	                    
@@ -52,8 +56,10 @@ POSTHOOK: Lineage: nzhang_part12 PARTITION(ds=2010-03-03,hr=24).key SIMPLE [(src
 POSTHOOK: Lineage: nzhang_part12 PARTITION(ds=2010-03-03,hr=24).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: show partitions nzhang_part12
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@nzhang_part12
 POSTHOOK: query: show partitions nzhang_part12
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@nzhang_part12
 POSTHOOK: Lineage: nzhang_part12 PARTITION(ds=2010-03-03,hr=22).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: nzhang_part12 PARTITION(ds=2010-03-03,hr=22).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: nzhang_part12 PARTITION(ds=2010-03-03,hr=24).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/load_dyn_part13.q.out b/ql/src/test/results/clientpositive/load_dyn_part13.q.out
index 4e39250803..ed978f6274 100644
--- a/ql/src/test/results/clientpositive/load_dyn_part13.q.out
+++ b/ql/src/test/results/clientpositive/load_dyn_part13.q.out
@@ -1,7 +1,9 @@
 PREHOOK: query: show partitions srcpart
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: show partitions srcpart
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@srcpart
 ds=2008-04-08/hr=11
 ds=2008-04-08/hr=12
 ds=2008-04-09/hr=11
@@ -15,8 +17,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@nzhang_part13
 PREHOOK: query: describe extended nzhang_part13
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@nzhang_part13
 POSTHOOK: query: describe extended nzhang_part13
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@nzhang_part13
 key                 	string              	default             
 value               	string              	default             
 ds                  	string              	                    
@@ -156,8 +160,10 @@ POSTHOOK: Lineage: nzhang_part13 PARTITION(ds=2010-03-03,hr=33).key EXPRESSION [
 POSTHOOK: Lineage: nzhang_part13 PARTITION(ds=2010-03-03,hr=33).value EXPRESSION [(src)src.FieldSchema(name:value, type:string, comment:default), (src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: show partitions nzhang_part13
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@nzhang_part13
 POSTHOOK: query: show partitions nzhang_part13
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@nzhang_part13
 POSTHOOK: Lineage: nzhang_part13 PARTITION(ds=2010-03-03,hr=22).key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), (src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: nzhang_part13 PARTITION(ds=2010-03-03,hr=22).value EXPRESSION [(src)src.FieldSchema(name:value, type:string, comment:default), (src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: nzhang_part13 PARTITION(ds=2010-03-03,hr=33).key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), (src)src.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/load_dyn_part14.q.out b/ql/src/test/results/clientpositive/load_dyn_part14.q.out
index a5ba23c28f..603f2f84ab 100644
--- a/ql/src/test/results/clientpositive/load_dyn_part14.q.out
+++ b/ql/src/test/results/clientpositive/load_dyn_part14.q.out
@@ -15,8 +15,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@nzhang_part14
 PREHOOK: query: describe extended nzhang_part14
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@nzhang_part14
 POSTHOOK: query: describe extended nzhang_part14
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@nzhang_part14
 key                 	string              	                    
 value               	string              	                    
 	 	 
@@ -245,8 +247,10 @@ POSTHOOK: Lineage: nzhang_part14 PARTITION(value= ).key EXPRESSION []
 POSTHOOK: Lineage: nzhang_part14 PARTITION(value=__HIVE_DEFAULT_PARTITION__).key EXPRESSION []
 PREHOOK: query: show partitions nzhang_part14
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@nzhang_part14
 POSTHOOK: query: show partitions nzhang_part14
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@nzhang_part14
 POSTHOOK: Lineage: nzhang_part14 PARTITION(value= ).key EXPRESSION []
 POSTHOOK: Lineage: nzhang_part14 PARTITION(value=__HIVE_DEFAULT_PARTITION__).key EXPRESSION []
 value= 
diff --git a/ql/src/test/results/clientpositive/load_dyn_part15.q.out b/ql/src/test/results/clientpositive/load_dyn_part15.q.out
index edd861204b..ac9707c2a7 100644
--- a/ql/src/test/results/clientpositive/load_dyn_part15.q.out
+++ b/ql/src/test/results/clientpositive/load_dyn_part15.q.out
@@ -9,8 +9,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@load_dyn_part15_test
 PREHOOK: query: show partitions load_dyn_part15_test
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@load_dyn_part15_test
 POSTHOOK: query: show partitions load_dyn_part15_test
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@load_dyn_part15_test
 PREHOOK: query: INSERT OVERWRITE TABLE load_dyn_part15_test PARTITION(part_key)
 SELECT key, part_key FROM src LATERAL VIEW explode(array("1","{2","3]")) myTable AS part_key
 PREHOOK: type: QUERY
@@ -28,8 +30,10 @@ POSTHOOK: Lineage: load_dyn_part15_test PARTITION(part_key=3]).key SCRIPT []
 POSTHOOK: Lineage: load_dyn_part15_test PARTITION(part_key={2).key SCRIPT []
 PREHOOK: query: show partitions load_dyn_part15_test
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@load_dyn_part15_test
 POSTHOOK: query: show partitions load_dyn_part15_test
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@load_dyn_part15_test
 POSTHOOK: Lineage: load_dyn_part15_test PARTITION(part_key=1).key SCRIPT []
 POSTHOOK: Lineage: load_dyn_part15_test PARTITION(part_key=3]).key SCRIPT []
 POSTHOOK: Lineage: load_dyn_part15_test PARTITION(part_key={2).key SCRIPT []
diff --git a/ql/src/test/results/clientpositive/load_dyn_part2.q.out b/ql/src/test/results/clientpositive/load_dyn_part2.q.out
index 8a565f1c5b..b30dc59779 100644
--- a/ql/src/test/results/clientpositive/load_dyn_part2.q.out
+++ b/ql/src/test/results/clientpositive/load_dyn_part2.q.out
@@ -11,8 +11,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@nzhang_part_bucket
 PREHOOK: query: describe extended nzhang_part_bucket
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@nzhang_part_bucket
 POSTHOOK: query: describe extended nzhang_part_bucket
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@nzhang_part_bucket
 key                 	string              	                    
 value               	string              	                    
 ds                  	string              	                    
@@ -103,8 +105,10 @@ POSTHOOK: Lineage: nzhang_part_bucket PARTITION(ds=2010-03-23,hr=12).key SIMPLE
 POSTHOOK: Lineage: nzhang_part_bucket PARTITION(ds=2010-03-23,hr=12).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: show partitions nzhang_part_bucket
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@nzhang_part_bucket
 POSTHOOK: query: show partitions nzhang_part_bucket
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@nzhang_part_bucket
 POSTHOOK: Lineage: nzhang_part_bucket PARTITION(ds=2010-03-23,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: nzhang_part_bucket PARTITION(ds=2010-03-23,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: nzhang_part_bucket PARTITION(ds=2010-03-23,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/load_dyn_part3.q.out b/ql/src/test/results/clientpositive/load_dyn_part3.q.out
index a3ebdf11bb..06d31d99f2 100644
--- a/ql/src/test/results/clientpositive/load_dyn_part3.q.out
+++ b/ql/src/test/results/clientpositive/load_dyn_part3.q.out
@@ -1,7 +1,9 @@
 PREHOOK: query: show partitions srcpart
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: show partitions srcpart
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@srcpart
 ds=2008-04-08/hr=11
 ds=2008-04-08/hr=12
 ds=2008-04-09/hr=11
@@ -15,8 +17,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@nzhang_part3
 PREHOOK: query: describe extended nzhang_part3
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@nzhang_part3
 POSTHOOK: query: describe extended nzhang_part3
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@nzhang_part3
 key                 	string              	default             
 value               	string              	default             
 ds                  	string              	                    
diff --git a/ql/src/test/results/clientpositive/load_dyn_part4.q.out b/ql/src/test/results/clientpositive/load_dyn_part4.q.out
index 8bdefa8d31..4064125a92 100644
--- a/ql/src/test/results/clientpositive/load_dyn_part4.q.out
+++ b/ql/src/test/results/clientpositive/load_dyn_part4.q.out
@@ -1,7 +1,9 @@
 PREHOOK: query: show partitions srcpart
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: show partitions srcpart
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@srcpart
 ds=2008-04-08/hr=11
 ds=2008-04-08/hr=12
 ds=2008-04-09/hr=11
@@ -15,8 +17,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@nzhang_part4
 PREHOOK: query: describe extended nzhang_part4
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@nzhang_part4
 POSTHOOK: query: describe extended nzhang_part4
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@nzhang_part4
 key                 	string              	default             
 value               	string              	default             
 ds                  	string              	                    
@@ -128,8 +132,10 @@ POSTHOOK: Lineage: nzhang_part4 PARTITION(ds=2008-04-09,hr=12).key SIMPLE [(srcp
 POSTHOOK: Lineage: nzhang_part4 PARTITION(ds=2008-04-09,hr=12).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: show partitions nzhang_part4
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@nzhang_part4
 POSTHOOK: query: show partitions nzhang_part4
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@nzhang_part4
 POSTHOOK: Lineage: nzhang_part4 PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: nzhang_part4 PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: nzhang_part4 PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/load_dyn_part5.q.out b/ql/src/test/results/clientpositive/load_dyn_part5.q.out
index 2b3cc1d91f..b79d53e5e3 100644
--- a/ql/src/test/results/clientpositive/load_dyn_part5.q.out
+++ b/ql/src/test/results/clientpositive/load_dyn_part5.q.out
@@ -7,8 +7,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@nzhang_part5
 PREHOOK: query: describe extended nzhang_part5
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@nzhang_part5
 POSTHOOK: query: describe extended nzhang_part5
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@nzhang_part5
 key                 	string              	                    
 value               	string              	                    
 	 	 
@@ -700,8 +702,10 @@ POSTHOOK: Lineage: nzhang_part5 PARTITION(value=val_98).key SIMPLE [(src)src.Fie
 POSTHOOK: Lineage: nzhang_part5 PARTITION(value=val_9).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: show partitions nzhang_part5
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@nzhang_part5
 POSTHOOK: query: show partitions nzhang_part5
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@nzhang_part5
 POSTHOOK: Lineage: nzhang_part5 PARTITION(value=val_0).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: nzhang_part5 PARTITION(value=val_100).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: nzhang_part5 PARTITION(value=val_103).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/load_dyn_part6.q.out b/ql/src/test/results/clientpositive/load_dyn_part6.q.out
index 49f4169229..6cf6f73e41 100644
--- a/ql/src/test/results/clientpositive/load_dyn_part6.q.out
+++ b/ql/src/test/results/clientpositive/load_dyn_part6.q.out
@@ -1,7 +1,9 @@
 PREHOOK: query: show partitions srcpart
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: show partitions srcpart
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@srcpart
 ds=2008-04-08/hr=11
 ds=2008-04-08/hr=12
 ds=2008-04-09/hr=11
@@ -15,8 +17,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@nzhang_part6
 PREHOOK: query: describe extended nzhang_part6
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@nzhang_part6
 POSTHOOK: query: describe extended nzhang_part6
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@nzhang_part6
 key                 	string              	default             
 value               	string              	default             
 ds                  	string              	                    
diff --git a/ql/src/test/results/clientpositive/load_dyn_part7.q.out b/ql/src/test/results/clientpositive/load_dyn_part7.q.out
index ec087c28d8..30175fe0f0 100644
--- a/ql/src/test/results/clientpositive/load_dyn_part7.q.out
+++ b/ql/src/test/results/clientpositive/load_dyn_part7.q.out
@@ -1,7 +1,9 @@
 PREHOOK: query: show partitions srcpart
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: show partitions srcpart
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@srcpart
 ds=2008-04-08/hr=11
 ds=2008-04-08/hr=12
 ds=2008-04-09/hr=11
@@ -15,8 +17,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@nzhang_part7
 PREHOOK: query: describe extended nzhang_part7
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@nzhang_part7
 POSTHOOK: query: describe extended nzhang_part7
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@nzhang_part7
 key                 	string              	default             
 value               	string              	default             
 ds                  	string              	                    
@@ -43,8 +47,10 @@ POSTHOOK: Lineage: nzhang_part7 PARTITION(ds=2010-03-03,hr=12).key SIMPLE [(srcp
 POSTHOOK: Lineage: nzhang_part7 PARTITION(ds=2010-03-03,hr=12).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: show partitions nzhang_part7
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@nzhang_part7
 POSTHOOK: query: show partitions nzhang_part7
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@nzhang_part7
 POSTHOOK: Lineage: nzhang_part7 PARTITION(ds=2010-03-03,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: nzhang_part7 PARTITION(ds=2010-03-03,hr=12).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 ds=2010-03-03/hr=12
diff --git a/ql/src/test/results/clientpositive/load_dyn_part8.q.out b/ql/src/test/results/clientpositive/load_dyn_part8.q.out
index 7334078e77..5f9ed273cd 100644
--- a/ql/src/test/results/clientpositive/load_dyn_part8.q.out
+++ b/ql/src/test/results/clientpositive/load_dyn_part8.q.out
@@ -1,7 +1,9 @@
 PREHOOK: query: show partitions srcpart
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: show partitions srcpart
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@srcpart
 ds=2008-04-08/hr=11
 ds=2008-04-08/hr=12
 ds=2008-04-09/hr=11
@@ -15,8 +17,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@nzhang_part8
 PREHOOK: query: describe extended nzhang_part8
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@nzhang_part8
 POSTHOOK: query: describe extended nzhang_part8
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@nzhang_part8
 key                 	string              	default             
 value               	string              	default             
 ds                  	string              	                    
@@ -550,8 +554,10 @@ POSTHOOK: Lineage: nzhang_part8 PARTITION(ds=2008-12-31,hr=12).key SIMPLE [(srcp
 POSTHOOK: Lineage: nzhang_part8 PARTITION(ds=2008-12-31,hr=12).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: show partitions nzhang_part8
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@nzhang_part8
 POSTHOOK: query: show partitions nzhang_part8
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@nzhang_part8
 POSTHOOK: Lineage: nzhang_part8 PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: nzhang_part8 PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: nzhang_part8 PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/load_dyn_part9.q.out b/ql/src/test/results/clientpositive/load_dyn_part9.q.out
index f3f16c959a..eb4183d60c 100644
--- a/ql/src/test/results/clientpositive/load_dyn_part9.q.out
+++ b/ql/src/test/results/clientpositive/load_dyn_part9.q.out
@@ -1,7 +1,9 @@
 PREHOOK: query: show partitions srcpart
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: show partitions srcpart
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@srcpart
 ds=2008-04-08/hr=11
 ds=2008-04-08/hr=12
 ds=2008-04-09/hr=11
@@ -15,8 +17,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@nzhang_part9
 PREHOOK: query: describe extended nzhang_part9
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@nzhang_part9
 POSTHOOK: query: describe extended nzhang_part9
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@nzhang_part9
 key                 	string              	default             
 value               	string              	default             
 ds                  	string              	                    
@@ -108,8 +112,10 @@ POSTHOOK: Lineage: nzhang_part9 PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcp
 POSTHOOK: Lineage: nzhang_part9 PARTITION(ds=2008-04-08,hr=12).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: show partitions nzhang_part9
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@nzhang_part9
 POSTHOOK: query: show partitions nzhang_part9
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@nzhang_part9
 POSTHOOK: Lineage: nzhang_part9 PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: nzhang_part9 PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: nzhang_part9 PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/load_fs.q.out b/ql/src/test/results/clientpositive/load_fs.q.out
index 9fa9e0d5a4..5770a639f8 100644
--- a/ql/src/test/results/clientpositive/load_fs.q.out
+++ b/ql/src/test/results/clientpositive/load_fs.q.out
@@ -59,8 +59,10 @@ minFileSize:216
 
 PREHOOK: query: desc extended load_overwrite
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@load_overwrite
 POSTHOOK: query: desc extended load_overwrite
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@load_overwrite
 key                 	string              	                    
 value               	string              	                    
 	 	 
@@ -101,8 +103,10 @@ minFileSize:216
 
 PREHOOK: query: desc extended load_overwrite2
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@load_overwrite2
 POSTHOOK: query: desc extended load_overwrite2
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@load_overwrite2
 key                 	string              	                    
 value               	string              	                    
 	 	 
diff --git a/ql/src/test/results/clientpositive/merge3.q.out b/ql/src/test/results/clientpositive/merge3.q.out
index a6ffa42a61..839ba6681e 100644
--- a/ql/src/test/results/clientpositive/merge3.q.out
+++ b/ql/src/test/results/clientpositive/merge3.q.out
@@ -2341,8 +2341,10 @@ POSTHOOK: Lineage: merge_src_part PARTITION(ds=2008-04-09).value SIMPLE [(srcpar
 98	val_98
 PREHOOK: query: describe formatted merge_src2
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@merge_src2
 POSTHOOK: query: describe formatted merge_src2
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@merge_src2
 POSTHOOK: Lineage: merge_src_part PARTITION(ds=2008-04-08).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: merge_src_part PARTITION(ds=2008-04-08).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: merge_src_part PARTITION(ds=2008-04-09).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -2814,8 +2816,10 @@ POSTHOOK: Lineage: merge_src_part2 PARTITION(ds=2008-04-09).key SIMPLE [(merge_s
 POSTHOOK: Lineage: merge_src_part2 PARTITION(ds=2008-04-09).value SIMPLE [(merge_src_part)merge_src_part.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: show partitions merge_src_part2
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@merge_src_part2
 POSTHOOK: query: show partitions merge_src_part2
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@merge_src_part2
 POSTHOOK: Lineage: merge_src_part PARTITION(ds=2008-04-08).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: merge_src_part PARTITION(ds=2008-04-08).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: merge_src_part PARTITION(ds=2008-04-09).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -5329,8 +5333,10 @@ POSTHOOK: Lineage: merge_src_part2 PARTITION(ds=2008-04-09).key SIMPLE [(merge_s
 POSTHOOK: Lineage: merge_src_part2 PARTITION(ds=2008-04-09).value SIMPLE [(merge_src_part)merge_src_part.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: show partitions merge_src_part2
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@merge_src_part2
 POSTHOOK: query: show partitions merge_src_part2
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@merge_src_part2
 POSTHOOK: Lineage: merge_src_part PARTITION(ds=2008-04-08).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: merge_src_part PARTITION(ds=2008-04-08).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: merge_src_part PARTITION(ds=2008-04-09).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/merge4.q.out b/ql/src/test/results/clientpositive/merge4.q.out
index 72ba899bd7..dd53baa00c 100644
--- a/ql/src/test/results/clientpositive/merge4.q.out
+++ b/ql/src/test/results/clientpositive/merge4.q.out
@@ -2975,8 +2975,10 @@ POSTHOOK: Lineage: nzhang_part PARTITION(ds=2010-08-15,hr=file,).key EXPRESSION
 POSTHOOK: Lineage: nzhang_part PARTITION(ds=2010-08-15,hr=file,).value EXPRESSION [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: show partitions nzhang_part
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@nzhang_part
 POSTHOOK: query: show partitions nzhang_part
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@nzhang_part
 POSTHOOK: Lineage: nzhang_part PARTITION(ds=2010-08-15,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: nzhang_part PARTITION(ds=2010-08-15,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: nzhang_part PARTITION(ds=2010-08-15,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/merge_dynamic_partition3.q.out b/ql/src/test/results/clientpositive/merge_dynamic_partition3.q.out
index 33079dc0f2..0e50b22ec1 100644
--- a/ql/src/test/results/clientpositive/merge_dynamic_partition3.q.out
+++ b/ql/src/test/results/clientpositive/merge_dynamic_partition3.q.out
@@ -114,8 +114,10 @@ POSTHOOK: type: LOAD
 POSTHOOK: Output: default@srcpart_merge_dp@ds=2008-04-09/hr=12
 PREHOOK: query: show partitions srcpart_merge_dp
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@srcpart_merge_dp
 POSTHOOK: query: show partitions srcpart_merge_dp
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@srcpart_merge_dp
 ds=2008-04-08/hr=11
 ds=2008-04-08/hr=12
 ds=2008-04-09/hr=11
diff --git a/ql/src/test/results/clientpositive/merge_dynamic_partition4.q.out b/ql/src/test/results/clientpositive/merge_dynamic_partition4.q.out
index f4e6665886..6aaea44d6b 100644
--- a/ql/src/test/results/clientpositive/merge_dynamic_partition4.q.out
+++ b/ql/src/test/results/clientpositive/merge_dynamic_partition4.q.out
@@ -239,8 +239,10 @@ POSTHOOK: Lineage: srcpart_merge_dp_rc PARTITION(ds=2008-04-08,hr=12).key SIMPLE
 POSTHOOK: Lineage: srcpart_merge_dp_rc PARTITION(ds=2008-04-08,hr=12).value SIMPLE [(srcpart_merge_dp)srcpart_merge_dp.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: show partitions merge_dynamic_part
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@merge_dynamic_part
 POSTHOOK: query: show partitions merge_dynamic_part
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@merge_dynamic_part
 POSTHOOK: Lineage: merge_dynamic_part PARTITION(ds=2008-04-08,hr=a1).key SIMPLE [(srcpart_merge_dp_rc)srcpart_merge_dp_rc.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: merge_dynamic_part PARTITION(ds=2008-04-08,hr=a1).value SIMPLE [(srcpart_merge_dp_rc)srcpart_merge_dp_rc.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: merge_dynamic_part PARTITION(ds=2008-04-08,hr=b1).key SIMPLE [(srcpart_merge_dp_rc)srcpart_merge_dp_rc.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/merge_dynamic_partition5.q.out b/ql/src/test/results/clientpositive/merge_dynamic_partition5.q.out
index 62e338f6c3..c04d45f686 100644
--- a/ql/src/test/results/clientpositive/merge_dynamic_partition5.q.out
+++ b/ql/src/test/results/clientpositive/merge_dynamic_partition5.q.out
@@ -213,8 +213,10 @@ POSTHOOK: Lineage: srcpart_merge_dp_rc PARTITION(ds=2008-04-08,hr=12).key SIMPLE
 POSTHOOK: Lineage: srcpart_merge_dp_rc PARTITION(ds=2008-04-08,hr=12).value SIMPLE [(srcpart_merge_dp)srcpart_merge_dp.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: show partitions merge_dynamic_part
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@merge_dynamic_part
 POSTHOOK: query: show partitions merge_dynamic_part
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@merge_dynamic_part
 POSTHOOK: Lineage: merge_dynamic_part PARTITION(ds=2008-04-08,hr=a1).key SIMPLE [(srcpart_merge_dp_rc)srcpart_merge_dp_rc.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: merge_dynamic_part PARTITION(ds=2008-04-08,hr=a1).value SIMPLE [(srcpart_merge_dp_rc)srcpart_merge_dp_rc.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: merge_dynamic_part PARTITION(ds=2008-04-08,hr=b1).key SIMPLE [(srcpart_merge_dp_rc)srcpart_merge_dp_rc.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/mi.q.out b/ql/src/test/results/clientpositive/mi.q.out
index 142134564c..96410f790c 100644
--- a/ql/src/test/results/clientpositive/mi.q.out
+++ b/ql/src/test/results/clientpositive/mi.q.out
@@ -46,8 +46,10 @@ POSTHOOK: Lineage: nzhang_t2 PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart
 POSTHOOK: Lineage: nzhang_t2 PARTITION(ds=2008-04-08,hr=12).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: show partitions nzhang_t1
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@nzhang_t1
 POSTHOOK: query: show partitions nzhang_t1
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@nzhang_t1
 POSTHOOK: Lineage: nzhang_t1 PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: nzhang_t1 PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: nzhang_t2 PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -55,8 +57,10 @@ POSTHOOK: Lineage: nzhang_t2 PARTITION(ds=2008-04-08,hr=12).value SIMPLE [(srcpa
 ds=2008-04-08/hr=11
 PREHOOK: query: show partitions nzhang_t2
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@nzhang_t2
 POSTHOOK: query: show partitions nzhang_t2
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@nzhang_t2
 POSTHOOK: Lineage: nzhang_t1 PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: nzhang_t1 PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: nzhang_t2 PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/multi_sahooks.q.out b/ql/src/test/results/clientpositive/multi_sahooks.q.out
index 941925db4b..ebf6430de7 100644
--- a/ql/src/test/results/clientpositive/multi_sahooks.q.out
+++ b/ql/src/test/results/clientpositive/multi_sahooks.q.out
@@ -13,8 +13,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@tbl_sahook
 PREHOOK: query: desc extended tbl_sahook
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tbl_sahook
 POSTHOOK: query: desc extended tbl_sahook
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tbl_sahook
 c                   	string              	                    
 	 	 
 #### A masked pattern was here ####
@@ -41,8 +43,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@tbl_sahooks
 PREHOOK: query: desc extended tbl_sahooks
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tbl_sahooks
 POSTHOOK: query: desc extended tbl_sahooks
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tbl_sahooks
 c                   	string              	                    
 	 	 
 #### A masked pattern was here ####
@@ -69,8 +73,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@tbl_sahooks
 PREHOOK: query: desc extended tbl_sahooks
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tbl_sahooks
 POSTHOOK: query: desc extended tbl_sahooks
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tbl_sahooks
 c                   	string              	                    
 	 	 
 #### A masked pattern was here ####
@@ -99,8 +105,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@tbl_sahooks
 PREHOOK: query: desc extended tbl_sahooks
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tbl_sahooks
 POSTHOOK: query: desc extended tbl_sahooks
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tbl_sahooks
 c                   	string              	                    
 	 	 
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/nested_complex.q.out b/ql/src/test/results/clientpositive/nested_complex.q.out
index fdfc9df8c7..a841955fbe 100644
--- a/ql/src/test/results/clientpositive/nested_complex.q.out
+++ b/ql/src/test/results/clientpositive/nested_complex.q.out
@@ -29,8 +29,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@nestedcomplex
 PREHOOK: query: describe nestedcomplex
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@nestedcomplex
 POSTHOOK: query: describe nestedcomplex
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@nestedcomplex
 simple_int          	int                 	                    
 max_nested_array    	array<array<array<array<array<array<array<array<array<array<array<array<array<array<array<array<array<array<array<array<array<array<array<int>>>>>>>>>>>>>>>>>>>>>>>	                    
 max_nested_map      	array<array<array<array<array<array<array<array<array<array<array<array<array<array<array<array<array<array<array<array<array<map<string,string>>>>>>>>>>>>>>>>>>>>>>	                    
@@ -38,8 +40,10 @@ max_nested_struct   	array<array<array<array<array<array<array<array<array<array
 simple_string       	string              	                    
 PREHOOK: query: describe extended nestedcomplex
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@nestedcomplex
 POSTHOOK: query: describe extended nestedcomplex
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@nestedcomplex
 simple_int          	int                 	                    
 max_nested_array    	array<array<array<array<array<array<array<array<array<array<array<array<array<array<array<array<array<array<array<array<array<array<array<int>>>>>>>>>>>>>>>>>>>>>>>	                    
 max_nested_map      	array<array<array<array<array<array<array<array<array<array<array<array<array<array<array<array<array<array<array<array<array<map<string,string>>>>>>>>>>>>>>>>>>>>>>	                    
diff --git a/ql/src/test/results/clientpositive/nullformat.q.out b/ql/src/test/results/clientpositive/nullformat.q.out
index 38fdebe880..199db08a6a 100644
--- a/ql/src/test/results/clientpositive/nullformat.q.out
+++ b/ql/src/test/results/clientpositive/nullformat.q.out
@@ -21,8 +21,10 @@ POSTHOOK: type: LOAD
 POSTHOOK: Output: default@base_tab
 PREHOOK: query: DESCRIBE EXTENDED base_tab
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@base_tab
 POSTHOOK: query: DESCRIBE EXTENDED base_tab
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@base_tab
 a                   	string              	                    
 b                   	string              	                    
 c                   	string              	                    
@@ -60,8 +62,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@null_tab1
 PREHOOK: query: DESCRIBE EXTENDED null_tab1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@null_tab1
 POSTHOOK: query: DESCRIBE EXTENDED null_tab1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@null_tab1
 a                   	string              	                    
 b                   	string              	                    
 	 	 
diff --git a/ql/src/test/results/clientpositive/nullformatCTAS.q.out b/ql/src/test/results/clientpositive/nullformatCTAS.q.out
index 9d8695149b..a1c0c3dbbe 100644
--- a/ql/src/test/results/clientpositive/nullformatCTAS.q.out
+++ b/ql/src/test/results/clientpositive/nullformatCTAS.q.out
@@ -21,8 +21,10 @@ POSTHOOK: type: LOAD
 POSTHOOK: Output: default@base_tab
 PREHOOK: query: DESCRIBE EXTENDED base_tab
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@base_tab
 POSTHOOK: query: DESCRIBE EXTENDED base_tab
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@base_tab
 a                   	string              	                    
 b                   	string              	                    
 c                   	string              	                    
@@ -139,8 +141,10 @@ POSTHOOK: Input: default@base_tab
 POSTHOOK: Output: default@null_tab3
 PREHOOK: query: DESCRIBE EXTENDED null_tab3
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@null_tab3
 POSTHOOK: query: DESCRIBE EXTENDED null_tab3
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@null_tab3
 a                   	string              	                    
 b                   	string              	                    
 	 	 
diff --git a/ql/src/test/results/clientpositive/nullformatdir.q.out b/ql/src/test/results/clientpositive/nullformatdir.q.out
index 2c2a59ed92..69b63e0122 100644
--- a/ql/src/test/results/clientpositive/nullformatdir.q.out
+++ b/ql/src/test/results/clientpositive/nullformatdir.q.out
@@ -21,8 +21,10 @@ POSTHOOK: type: LOAD
 POSTHOOK: Output: default@base_tab
 PREHOOK: query: DESCRIBE EXTENDED base_tab
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@base_tab
 POSTHOOK: query: DESCRIBE EXTENDED base_tab
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@base_tab
 a                   	string              	                    
 b                   	string              	                    
 c                   	string              	                    
diff --git a/ql/src/test/results/clientpositive/orc_analyze.q.out b/ql/src/test/results/clientpositive/orc_analyze.q.out
index 5835645031..f23e1f3c8a 100644
--- a/ql/src/test/results/clientpositive/orc_analyze.q.out
+++ b/ql/src/test/results/clientpositive/orc_analyze.q.out
@@ -84,8 +84,10 @@ POSTHOOK: Lineage: orc_create_people.start_date SIMPLE [(orc_create_people_stagi
 POSTHOOK: Lineage: orc_create_people.state SIMPLE [(orc_create_people_staging)orc_create_people_staging.FieldSchema(name:state, type:string, comment:null), ]
 PREHOOK: query: desc formatted orc_create_people
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@orc_create_people
 POSTHOOK: query: desc formatted orc_create_people
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@orc_create_people
 POSTHOOK: Lineage: orc_create_people.address SIMPLE [(orc_create_people_staging)orc_create_people_staging.FieldSchema(name:address, type:string, comment:null), ]
 POSTHOOK: Lineage: orc_create_people.first_name SIMPLE [(orc_create_people_staging)orc_create_people_staging.FieldSchema(name:first_name, type:string, comment:null), ]
 POSTHOOK: Lineage: orc_create_people.id SIMPLE [(orc_create_people_staging)orc_create_people_staging.FieldSchema(name:id, type:int, comment:null), ]
@@ -199,8 +201,10 @@ POSTHOOK: Lineage: orc_create_people.state SIMPLE [(orc_create_people_staging)or
 POSTHOOK: Lineage: orc_create_people.state SIMPLE [(orc_create_people_staging)orc_create_people_staging.FieldSchema(name:state, type:string, comment:null), ]
 PREHOOK: query: desc formatted orc_create_people
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@orc_create_people
 POSTHOOK: query: desc formatted orc_create_people
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@orc_create_people
 POSTHOOK: Lineage: orc_create_people.address SIMPLE [(orc_create_people_staging)orc_create_people_staging.FieldSchema(name:address, type:string, comment:null), ]
 POSTHOOK: Lineage: orc_create_people.address SIMPLE [(orc_create_people_staging)orc_create_people_staging.FieldSchema(name:address, type:string, comment:null), ]
 POSTHOOK: Lineage: orc_create_people.first_name SIMPLE [(orc_create_people_staging)orc_create_people_staging.FieldSchema(name:first_name, type:string, comment:null), ]
@@ -388,8 +392,10 @@ POSTHOOK: Lineage: orc_create_people PARTITION(state=Or).salary SIMPLE [(orc_cre
 POSTHOOK: Lineage: orc_create_people PARTITION(state=Or).start_date SIMPLE [(orc_create_people_staging)orc_create_people_staging.FieldSchema(name:start_date, type:timestamp, comment:null), ]
 PREHOOK: query: desc formatted orc_create_people partition(state="Ca")
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@orc_create_people
 POSTHOOK: query: desc formatted orc_create_people partition(state="Ca")
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@orc_create_people
 POSTHOOK: Lineage: orc_create_people.address SIMPLE [(orc_create_people_staging)orc_create_people_staging.FieldSchema(name:address, type:string, comment:null), ]
 POSTHOOK: Lineage: orc_create_people.address SIMPLE [(orc_create_people_staging)orc_create_people_staging.FieldSchema(name:address, type:string, comment:null), ]
 POSTHOOK: Lineage: orc_create_people.first_name SIMPLE [(orc_create_people_staging)orc_create_people_staging.FieldSchema(name:first_name, type:string, comment:null), ]
@@ -457,8 +463,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: desc formatted orc_create_people partition(state="Or")
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@orc_create_people
 POSTHOOK: query: desc formatted orc_create_people partition(state="Or")
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@orc_create_people
 POSTHOOK: Lineage: orc_create_people.address SIMPLE [(orc_create_people_staging)orc_create_people_staging.FieldSchema(name:address, type:string, comment:null), ]
 POSTHOOK: Lineage: orc_create_people.address SIMPLE [(orc_create_people_staging)orc_create_people_staging.FieldSchema(name:address, type:string, comment:null), ]
 POSTHOOK: Lineage: orc_create_people.first_name SIMPLE [(orc_create_people_staging)orc_create_people_staging.FieldSchema(name:first_name, type:string, comment:null), ]
@@ -660,8 +668,10 @@ POSTHOOK: Lineage: orc_create_people PARTITION(state=Or).salary SIMPLE [(orc_cre
 POSTHOOK: Lineage: orc_create_people PARTITION(state=Or).start_date SIMPLE [(orc_create_people_staging)orc_create_people_staging.FieldSchema(name:start_date, type:timestamp, comment:null), ]
 PREHOOK: query: desc formatted orc_create_people partition(state="Ca")
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@orc_create_people
 POSTHOOK: query: desc formatted orc_create_people partition(state="Ca")
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@orc_create_people
 POSTHOOK: Lineage: orc_create_people.address SIMPLE [(orc_create_people_staging)orc_create_people_staging.FieldSchema(name:address, type:string, comment:null), ]
 POSTHOOK: Lineage: orc_create_people.address SIMPLE [(orc_create_people_staging)orc_create_people_staging.FieldSchema(name:address, type:string, comment:null), ]
 POSTHOOK: Lineage: orc_create_people.first_name SIMPLE [(orc_create_people_staging)orc_create_people_staging.FieldSchema(name:first_name, type:string, comment:null), ]
@@ -741,8 +751,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: desc formatted orc_create_people partition(state="Or")
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@orc_create_people
 POSTHOOK: query: desc formatted orc_create_people partition(state="Or")
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@orc_create_people
 POSTHOOK: Lineage: orc_create_people.address SIMPLE [(orc_create_people_staging)orc_create_people_staging.FieldSchema(name:address, type:string, comment:null), ]
 POSTHOOK: Lineage: orc_create_people.address SIMPLE [(orc_create_people_staging)orc_create_people_staging.FieldSchema(name:address, type:string, comment:null), ]
 POSTHOOK: Lineage: orc_create_people.first_name SIMPLE [(orc_create_people_staging)orc_create_people_staging.FieldSchema(name:first_name, type:string, comment:null), ]
@@ -1060,8 +1072,10 @@ POSTHOOK: Lineage: orc_create_people PARTITION(state=Or).salary SIMPLE [(orc_cre
 POSTHOOK: Lineage: orc_create_people PARTITION(state=Or).start_date SIMPLE [(orc_create_people_staging)orc_create_people_staging.FieldSchema(name:start_date, type:timestamp, comment:null), ]
 PREHOOK: query: desc formatted orc_create_people partition(state="Ca")
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@orc_create_people
 POSTHOOK: query: desc formatted orc_create_people partition(state="Ca")
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@orc_create_people
 POSTHOOK: Lineage: orc_create_people.address SIMPLE [(orc_create_people_staging)orc_create_people_staging.FieldSchema(name:address, type:string, comment:null), ]
 POSTHOOK: Lineage: orc_create_people.address SIMPLE [(orc_create_people_staging)orc_create_people_staging.FieldSchema(name:address, type:string, comment:null), ]
 POSTHOOK: Lineage: orc_create_people.first_name SIMPLE [(orc_create_people_staging)orc_create_people_staging.FieldSchema(name:first_name, type:string, comment:null), ]
@@ -1153,8 +1167,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: desc formatted orc_create_people partition(state="Or")
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@orc_create_people
 POSTHOOK: query: desc formatted orc_create_people partition(state="Or")
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@orc_create_people
 POSTHOOK: Lineage: orc_create_people.address SIMPLE [(orc_create_people_staging)orc_create_people_staging.FieldSchema(name:address, type:string, comment:null), ]
 POSTHOOK: Lineage: orc_create_people.address SIMPLE [(orc_create_people_staging)orc_create_people_staging.FieldSchema(name:address, type:string, comment:null), ]
 POSTHOOK: Lineage: orc_create_people.first_name SIMPLE [(orc_create_people_staging)orc_create_people_staging.FieldSchema(name:first_name, type:string, comment:null), ]
@@ -1458,8 +1474,10 @@ POSTHOOK: Lineage: orc_create_people PARTITION(state=Or).salary SIMPLE [(orc_cre
 POSTHOOK: Lineage: orc_create_people PARTITION(state=Or).start_date SIMPLE [(orc_create_people_staging)orc_create_people_staging.FieldSchema(name:start_date, type:timestamp, comment:null), ]
 PREHOOK: query: desc formatted orc_create_people partition(state="Ca")
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@orc_create_people
 POSTHOOK: query: desc formatted orc_create_people partition(state="Ca")
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@orc_create_people
 POSTHOOK: Lineage: orc_create_people.address SIMPLE [(orc_create_people_staging)orc_create_people_staging.FieldSchema(name:address, type:string, comment:null), ]
 POSTHOOK: Lineage: orc_create_people.address SIMPLE [(orc_create_people_staging)orc_create_people_staging.FieldSchema(name:address, type:string, comment:null), ]
 POSTHOOK: Lineage: orc_create_people.first_name SIMPLE [(orc_create_people_staging)orc_create_people_staging.FieldSchema(name:first_name, type:string, comment:null), ]
@@ -1563,8 +1581,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: desc formatted orc_create_people partition(state="Or")
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@orc_create_people
 POSTHOOK: query: desc formatted orc_create_people partition(state="Or")
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@orc_create_people
 POSTHOOK: Lineage: orc_create_people.address SIMPLE [(orc_create_people_staging)orc_create_people_staging.FieldSchema(name:address, type:string, comment:null), ]
 POSTHOOK: Lineage: orc_create_people.address SIMPLE [(orc_create_people_staging)orc_create_people_staging.FieldSchema(name:address, type:string, comment:null), ]
 POSTHOOK: Lineage: orc_create_people.first_name SIMPLE [(orc_create_people_staging)orc_create_people_staging.FieldSchema(name:first_name, type:string, comment:null), ]
@@ -2417,8 +2437,10 @@ POSTHOOK: Lineage: orc_create_people PARTITION(state=Or).salary SIMPLE [(orc_cre
 POSTHOOK: Lineage: orc_create_people PARTITION(state=Or).start_date SIMPLE [(orc_create_people_staging)orc_create_people_staging.FieldSchema(name:start_date, type:timestamp, comment:null), ]
 PREHOOK: query: desc formatted orc_create_people partition(state="Ca")
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@orc_create_people
 POSTHOOK: query: desc formatted orc_create_people partition(state="Ca")
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@orc_create_people
 POSTHOOK: Lineage: orc_create_people.address SIMPLE [(orc_create_people_staging)orc_create_people_staging.FieldSchema(name:address, type:string, comment:null), ]
 POSTHOOK: Lineage: orc_create_people.address SIMPLE [(orc_create_people_staging)orc_create_people_staging.FieldSchema(name:address, type:string, comment:null), ]
 POSTHOOK: Lineage: orc_create_people.first_name SIMPLE [(orc_create_people_staging)orc_create_people_staging.FieldSchema(name:first_name, type:string, comment:null), ]
@@ -2534,8 +2556,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: desc formatted orc_create_people partition(state="OH")
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@orc_create_people
 POSTHOOK: query: desc formatted orc_create_people partition(state="OH")
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@orc_create_people
 POSTHOOK: Lineage: orc_create_people.address SIMPLE [(orc_create_people_staging)orc_create_people_staging.FieldSchema(name:address, type:string, comment:null), ]
 POSTHOOK: Lineage: orc_create_people.address SIMPLE [(orc_create_people_staging)orc_create_people_staging.FieldSchema(name:address, type:string, comment:null), ]
 POSTHOOK: Lineage: orc_create_people.first_name SIMPLE [(orc_create_people_staging)orc_create_people_staging.FieldSchema(name:first_name, type:string, comment:null), ]
diff --git a/ql/src/test/results/clientpositive/orc_create.q.out b/ql/src/test/results/clientpositive/orc_create.q.out
index f54fea9f7c..d15cf59b59 100644
--- a/ql/src/test/results/clientpositive/orc_create.q.out
+++ b/ql/src/test/results/clientpositive/orc_create.q.out
@@ -43,8 +43,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@orc_create_staging
 PREHOOK: query: DESCRIBE FORMATTED orc_create_staging
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@orc_create_staging
 POSTHOOK: query: DESCRIBE FORMATTED orc_create_staging
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@orc_create_staging
 # col_name            	data_type           	comment             
 	 	 
 str                 	string              	                    
@@ -88,8 +90,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@orc_create
 PREHOOK: query: DESCRIBE FORMATTED orc_create
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@orc_create
 POSTHOOK: query: DESCRIBE FORMATTED orc_create
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@orc_create
 # col_name            	data_type           	comment             
 	 	 
 key                 	int                 	                    
@@ -139,8 +143,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@orc_create
 PREHOOK: query: DESCRIBE FORMATTED orc_create
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@orc_create
 POSTHOOK: query: DESCRIBE FORMATTED orc_create
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@orc_create
 # col_name            	data_type           	comment             
 	 	 
 key                 	int                 	                    
@@ -181,8 +187,10 @@ POSTHOOK: Input: default@orc_create
 POSTHOOK: Output: default@orc_create
 PREHOOK: query: DESCRIBE FORMATTED orc_create
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@orc_create
 POSTHOOK: query: DESCRIBE FORMATTED orc_create
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@orc_create
 # col_name            	data_type           	comment             
 	 	 
 key                 	int                 	                    
@@ -232,8 +240,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@orc_create
 PREHOOK: query: DESCRIBE FORMATTED orc_create
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@orc_create
 POSTHOOK: query: DESCRIBE FORMATTED orc_create
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@orc_create
 # col_name            	data_type           	comment             
 	 	 
 key                 	int                 	                    
@@ -283,8 +293,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@orc_create_complex
 PREHOOK: query: DESCRIBE FORMATTED orc_create_complex
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@orc_create_complex
 POSTHOOK: query: DESCRIBE FORMATTED orc_create_complex
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@orc_create_complex
 # col_name            	data_type           	comment             
 	 	 
 str                 	string              	                    
diff --git a/ql/src/test/results/clientpositive/parallel_orderby.q.out b/ql/src/test/results/clientpositive/parallel_orderby.q.out
index d38cceabf2..9a4899e759 100644
--- a/ql/src/test/results/clientpositive/parallel_orderby.q.out
+++ b/ql/src/test/results/clientpositive/parallel_orderby.q.out
@@ -87,8 +87,10 @@ POSTHOOK: Input: default@src5
 POSTHOOK: Output: default@total_ordered
 PREHOOK: query: desc formatted total_ordered
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@total_ordered
 POSTHOOK: query: desc formatted total_ordered
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@total_ordered
 # col_name            	data_type           	comment             
 	 	 
 key                 	string              	                    
@@ -196,8 +198,10 @@ POSTHOOK: Input: default@src5
 POSTHOOK: Output: default@total_ordered
 PREHOOK: query: desc formatted total_ordered
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@total_ordered
 POSTHOOK: query: desc formatted total_ordered
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@total_ordered
 # col_name            	data_type           	comment             
 	 	 
 key                 	string              	                    
diff --git a/ql/src/test/results/clientpositive/parquet_create.q.out b/ql/src/test/results/clientpositive/parquet_create.q.out
index 7e28a8707a..3220be533d 100644
--- a/ql/src/test/results/clientpositive/parquet_create.q.out
+++ b/ql/src/test/results/clientpositive/parquet_create.q.out
@@ -52,8 +52,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@parquet_create
 PREHOOK: query: DESCRIBE FORMATTED parquet_create
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@parquet_create
 POSTHOOK: query: DESCRIBE FORMATTED parquet_create
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@parquet_create
 # col_name            	data_type           	comment             
 	 	 
 id                  	int                 	                    
diff --git a/ql/src/test/results/clientpositive/parquet_ctas.q.out b/ql/src/test/results/clientpositive/parquet_ctas.q.out
index 6acb4c1de8..094b427285 100644
--- a/ql/src/test/results/clientpositive/parquet_ctas.q.out
+++ b/ql/src/test/results/clientpositive/parquet_ctas.q.out
@@ -46,8 +46,10 @@ POSTHOOK: Lineage: staging.key EXPRESSION [(src)src.FieldSchema(name:key, type:s
 POSTHOOK: Lineage: staging.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: describe parquet_ctas
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@parquet_ctas
 POSTHOOK: query: describe parquet_ctas
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@parquet_ctas
 POSTHOOK: Lineage: staging.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: staging.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 key                 	int                 	                    
@@ -83,8 +85,10 @@ POSTHOOK: Lineage: staging.key EXPRESSION [(src)src.FieldSchema(name:key, type:s
 POSTHOOK: Lineage: staging.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: describe parquet_ctas_advanced
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@parquet_ctas_advanced
 POSTHOOK: query: describe parquet_ctas_advanced
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@parquet_ctas_advanced
 POSTHOOK: Lineage: staging.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: staging.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 _c0                 	int                 	                    
@@ -120,8 +124,10 @@ POSTHOOK: Lineage: staging.key EXPRESSION [(src)src.FieldSchema(name:key, type:s
 POSTHOOK: Lineage: staging.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: describe parquet_ctas_alias
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@parquet_ctas_alias
 POSTHOOK: query: describe parquet_ctas_alias
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@parquet_ctas_alias
 POSTHOOK: Lineage: staging.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: staging.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 mykey               	int                 	                    
@@ -157,8 +163,10 @@ POSTHOOK: Lineage: staging.key EXPRESSION [(src)src.FieldSchema(name:key, type:s
 POSTHOOK: Lineage: staging.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: describe parquet_ctas_mixed
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@parquet_ctas_mixed
 POSTHOOK: query: describe parquet_ctas_mixed
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@parquet_ctas_mixed
 POSTHOOK: Lineage: staging.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: staging.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 key                 	int                 	                    
diff --git a/ql/src/test/results/clientpositive/parquet_partitioned.q.out b/ql/src/test/results/clientpositive/parquet_partitioned.q.out
index 81e498f8b3..107702df43 100644
--- a/ql/src/test/results/clientpositive/parquet_partitioned.q.out
+++ b/ql/src/test/results/clientpositive/parquet_partitioned.q.out
@@ -40,8 +40,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@parquet_partitioned
 PREHOOK: query: DESCRIBE FORMATTED parquet_partitioned
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@parquet_partitioned
 POSTHOOK: query: DESCRIBE FORMATTED parquet_partitioned
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@parquet_partitioned
 # col_name            	data_type           	comment             
 	 	 
 id                  	int                 	                    
diff --git a/ql/src/test/results/clientpositive/part_inherit_tbl_props.q.out b/ql/src/test/results/clientpositive/part_inherit_tbl_props.q.out
index eaad9e48a8..15e8d75bd7 100644
--- a/ql/src/test/results/clientpositive/part_inherit_tbl_props.q.out
+++ b/ql/src/test/results/clientpositive/part_inherit_tbl_props.q.out
@@ -18,8 +18,10 @@ POSTHOOK: Output: default@mytbl
 POSTHOOK: Output: default@mytbl@c2=v1
 PREHOOK: query: describe formatted mytbl partition (c2='v1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@mytbl
 POSTHOOK: query: describe formatted mytbl partition (c2='v1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@mytbl
 # col_name            	data_type           	comment             
 	 	 
 c1                  	tinyint             	                    
diff --git a/ql/src/test/results/clientpositive/part_inherit_tbl_props_empty.q.out b/ql/src/test/results/clientpositive/part_inherit_tbl_props_empty.q.out
index 3ceb9d8928..6e11ac4baf 100644
--- a/ql/src/test/results/clientpositive/part_inherit_tbl_props_empty.q.out
+++ b/ql/src/test/results/clientpositive/part_inherit_tbl_props_empty.q.out
@@ -14,8 +14,10 @@ POSTHOOK: Output: default@mytbl
 POSTHOOK: Output: default@mytbl@c2=v1
 PREHOOK: query: describe formatted mytbl partition (c2='v1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@mytbl
 POSTHOOK: query: describe formatted mytbl partition (c2='v1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@mytbl
 # col_name            	data_type           	comment             
 	 	 
 c1                  	tinyint             	                    
diff --git a/ql/src/test/results/clientpositive/part_inherit_tbl_props_with_star.q.out b/ql/src/test/results/clientpositive/part_inherit_tbl_props_with_star.q.out
index 5c5a977830..88fe5b599e 100644
--- a/ql/src/test/results/clientpositive/part_inherit_tbl_props_with_star.q.out
+++ b/ql/src/test/results/clientpositive/part_inherit_tbl_props_with_star.q.out
@@ -18,8 +18,10 @@ POSTHOOK: Output: default@mytbl
 POSTHOOK: Output: default@mytbl@c2=v1
 PREHOOK: query: describe formatted mytbl partition (c2='v1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@mytbl
 POSTHOOK: query: describe formatted mytbl partition (c2='v1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@mytbl
 # col_name            	data_type           	comment             
 	 	 
 c1                  	tinyint             	                    
diff --git a/ql/src/test/results/clientpositive/partition_date2.q.out b/ql/src/test/results/clientpositive/partition_date2.q.out
index d0af967a4a..c70b3d6c3a 100644
--- a/ql/src/test/results/clientpositive/partition_date2.q.out
+++ b/ql/src/test/results/clientpositive/partition_date2.q.out
@@ -369,8 +369,10 @@ POSTHOOK: Lineage: partition_date2_1 PARTITION(dt=2000-01-01,region=2).key SIMPL
 POSTHOOK: Lineage: partition_date2_1 PARTITION(dt=2000-01-01,region=2).value SIMPLE []
 PREHOOK: query: describe extended partition_date2_1  partition(dt=date '1980-01-02', region=3)
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@partition_date2_1
 POSTHOOK: query: describe extended partition_date2_1  partition(dt=date '1980-01-02', region=3)
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@partition_date2_1
 POSTHOOK: Lineage: partition_date2_1 PARTITION(dt=1999-01-01,region=2).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: partition_date2_1 PARTITION(dt=1999-01-01,region=2).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: partition_date2_1 PARTITION(dt=2000-01-01,region=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -465,8 +467,10 @@ POSTHOOK: Lineage: partition_date2_1 PARTITION(dt=2000-01-01,region=2).key SIMPL
 POSTHOOK: Lineage: partition_date2_1 PARTITION(dt=2000-01-01,region=2).value SIMPLE []
 PREHOOK: query: describe extended partition_date2_1 partition(dt=date '1980-01-02', region=3)
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@partition_date2_1
 POSTHOOK: query: describe extended partition_date2_1 partition(dt=date '1980-01-02', region=3)
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@partition_date2_1
 POSTHOOK: Lineage: partition_date2_1 PARTITION(dt=1980-01-02,region=3).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: partition_date2_1 PARTITION(dt=1980-01-02,region=3).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: partition_date2_1 PARTITION(dt=1999-01-01,region=2).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/partition_decode_name.q.out b/ql/src/test/results/clientpositive/partition_decode_name.q.out
index 9231bcb47b..dbded3983e 100644
--- a/ql/src/test/results/clientpositive/partition_decode_name.q.out
+++ b/ql/src/test/results/clientpositive/partition_decode_name.q.out
@@ -37,8 +37,10 @@ POSTHOOK: Lineage: sc_part PARTITION(ts=2011-01-11+15:18:26).key SIMPLE [(sc)sc.
 POSTHOOK: Lineage: sc_part PARTITION(ts=2011-01-11+16:18:26).key SIMPLE [(sc)sc.FieldSchema(name:_c0, type:string, comment:null), ]
 PREHOOK: query: show partitions sc_part
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@sc_part
 POSTHOOK: query: show partitions sc_part
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@sc_part
 POSTHOOK: Lineage: sc_part PARTITION(ts=2011-01-11+14:18:26).key SIMPLE [(sc)sc.FieldSchema(name:_c0, type:string, comment:null), ]
 POSTHOOK: Lineage: sc_part PARTITION(ts=2011-01-11+15:18:26).key SIMPLE [(sc)sc.FieldSchema(name:_c0, type:string, comment:null), ]
 POSTHOOK: Lineage: sc_part PARTITION(ts=2011-01-11+16:18:26).key SIMPLE [(sc)sc.FieldSchema(name:_c0, type:string, comment:null), ]
@@ -81,8 +83,10 @@ POSTHOOK: Lineage: sc_part PARTITION(ts=2011-01-11+16:18:26).key SIMPLE [(sc)sc.
 POSTHOOK: Lineage: sc_part PARTITION(ts=2011-01-11+16:18:26).key SIMPLE [(sc)sc.FieldSchema(name:_c0, type:string, comment:null), ]
 PREHOOK: query: show partitions sc_part
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@sc_part
 POSTHOOK: query: show partitions sc_part
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@sc_part
 POSTHOOK: Lineage: sc_part PARTITION(ts=2011-01-11+14:18:26).key SIMPLE [(sc)sc.FieldSchema(name:_c0, type:string, comment:null), ]
 POSTHOOK: Lineage: sc_part PARTITION(ts=2011-01-11+14:18:26).key SIMPLE [(sc)sc.FieldSchema(name:_c0, type:string, comment:null), ]
 POSTHOOK: Lineage: sc_part PARTITION(ts=2011-01-11+15:18:26).key SIMPLE [(sc)sc.FieldSchema(name:_c0, type:string, comment:null), ]
diff --git a/ql/src/test/results/clientpositive/partition_schema1.q.out b/ql/src/test/results/clientpositive/partition_schema1.q.out
index 03fad52974..dd370f89a5 100644
--- a/ql/src/test/results/clientpositive/partition_schema1.q.out
+++ b/ql/src/test/results/clientpositive/partition_schema1.q.out
@@ -17,8 +17,10 @@ POSTHOOK: Lineage: partition_schema1 PARTITION(dt=100).key SIMPLE [(src1)src1.Fi
 POSTHOOK: Lineage: partition_schema1 PARTITION(dt=100).value SIMPLE [(src1)src1.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: desc partition_schema1 partition(dt='100')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@partition_schema1
 POSTHOOK: query: desc partition_schema1 partition(dt='100')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@partition_schema1
 POSTHOOK: Lineage: partition_schema1 PARTITION(dt=100).key SIMPLE [(src1)src1.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: partition_schema1 PARTITION(dt=100).value SIMPLE [(src1)src1.FieldSchema(name:value, type:string, comment:default), ]
 key                 	string              	                    
@@ -41,8 +43,10 @@ POSTHOOK: Lineage: partition_schema1 PARTITION(dt=100).key SIMPLE [(src1)src1.Fi
 POSTHOOK: Lineage: partition_schema1 PARTITION(dt=100).value SIMPLE [(src1)src1.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: desc partition_schema1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@partition_schema1
 POSTHOOK: query: desc partition_schema1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@partition_schema1
 POSTHOOK: Lineage: partition_schema1 PARTITION(dt=100).key SIMPLE [(src1)src1.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: partition_schema1 PARTITION(dt=100).value SIMPLE [(src1)src1.FieldSchema(name:value, type:string, comment:default), ]
 key                 	string              	                    
@@ -56,8 +60,10 @@ dt                  	string
 dt                  	string              	                    
 PREHOOK: query: desc partition_schema1 partition (dt='100')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@partition_schema1
 POSTHOOK: query: desc partition_schema1 partition (dt='100')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@partition_schema1
 POSTHOOK: Lineage: partition_schema1 PARTITION(dt=100).key SIMPLE [(src1)src1.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: partition_schema1 PARTITION(dt=100).value SIMPLE [(src1)src1.FieldSchema(name:value, type:string, comment:default), ]
 key                 	string              	                    
diff --git a/ql/src/test/results/clientpositive/partition_special_char.q.out b/ql/src/test/results/clientpositive/partition_special_char.q.out
index e3c3cc4c38..c06281805b 100644
--- a/ql/src/test/results/clientpositive/partition_special_char.q.out
+++ b/ql/src/test/results/clientpositive/partition_special_char.q.out
@@ -37,8 +37,10 @@ POSTHOOK: Lineage: sc_part PARTITION(ts=2011-01-11+15:18:26).key SIMPLE [(sc)sc.
 POSTHOOK: Lineage: sc_part PARTITION(ts=2011-01-11+16:18:26).key SIMPLE [(sc)sc.FieldSchema(name:_c0, type:string, comment:null), ]
 PREHOOK: query: show partitions sc_part
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@sc_part
 POSTHOOK: query: show partitions sc_part
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@sc_part
 POSTHOOK: Lineage: sc_part PARTITION(ts=2011-01-11+14:18:26).key SIMPLE [(sc)sc.FieldSchema(name:_c0, type:string, comment:null), ]
 POSTHOOK: Lineage: sc_part PARTITION(ts=2011-01-11+15:18:26).key SIMPLE [(sc)sc.FieldSchema(name:_c0, type:string, comment:null), ]
 POSTHOOK: Lineage: sc_part PARTITION(ts=2011-01-11+16:18:26).key SIMPLE [(sc)sc.FieldSchema(name:_c0, type:string, comment:null), ]
@@ -81,8 +83,10 @@ POSTHOOK: Lineage: sc_part PARTITION(ts=2011-01-11+16:18:26).key SIMPLE [(sc)sc.
 POSTHOOK: Lineage: sc_part PARTITION(ts=2011-01-11+16:18:26).key SIMPLE [(sc)sc.FieldSchema(name:_c0, type:string, comment:null), ]
 PREHOOK: query: show partitions sc_part
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@sc_part
 POSTHOOK: query: show partitions sc_part
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@sc_part
 POSTHOOK: Lineage: sc_part PARTITION(ts=2011-01-11+14:18:26).key SIMPLE [(sc)sc.FieldSchema(name:_c0, type:string, comment:null), ]
 POSTHOOK: Lineage: sc_part PARTITION(ts=2011-01-11+14:18:26).key SIMPLE [(sc)sc.FieldSchema(name:_c0, type:string, comment:null), ]
 POSTHOOK: Lineage: sc_part PARTITION(ts=2011-01-11+15:18:26).key SIMPLE [(sc)sc.FieldSchema(name:_c0, type:string, comment:null), ]
diff --git a/ql/src/test/results/clientpositive/partitions_json.q.out b/ql/src/test/results/clientpositive/partitions_json.q.out
index 944db9423a..da6bdd2f14 100644
--- a/ql/src/test/results/clientpositive/partitions_json.q.out
+++ b/ql/src/test/results/clientpositive/partitions_json.q.out
@@ -7,8 +7,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@add_part_test
 PREHOOK: query: SHOW PARTITIONS add_part_test
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@add_part_test
 POSTHOOK: query: SHOW PARTITIONS add_part_test
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@add_part_test
 {"partitions":[]}
 PREHOOK: query: ALTER TABLE add_part_test ADD PARTITION (ds='2010-01-01')
 PREHOOK: type: ALTERTABLE_ADDPARTS
@@ -19,8 +21,10 @@ POSTHOOK: Output: default@add_part_test
 POSTHOOK: Output: default@add_part_test@ds=2010-01-01
 PREHOOK: query: SHOW PARTITIONS add_part_test
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@add_part_test
 POSTHOOK: query: SHOW PARTITIONS add_part_test
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@add_part_test
 {"partitions":[{"values":[{"columnName":"ds","columnValue":"2010-01-01"}],"name":"ds='2010-01-01'"}]}
 PREHOOK: query: ALTER TABLE add_part_test ADD IF NOT EXISTS PARTITION (ds='2010-01-01')
 PREHOOK: type: ALTERTABLE_ADDPARTS
@@ -30,8 +34,10 @@ POSTHOOK: type: ALTERTABLE_ADDPARTS
 POSTHOOK: Output: default@add_part_test
 PREHOOK: query: SHOW PARTITIONS add_part_test
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@add_part_test
 POSTHOOK: query: SHOW PARTITIONS add_part_test
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@add_part_test
 {"partitions":[{"values":[{"columnName":"ds","columnValue":"2010-01-01"}],"name":"ds='2010-01-01'"}]}
 PREHOOK: query: ALTER TABLE add_part_test ADD IF NOT EXISTS PARTITION (ds='2010-01-02')
 PREHOOK: type: ALTERTABLE_ADDPARTS
@@ -42,8 +48,10 @@ POSTHOOK: Output: default@add_part_test
 POSTHOOK: Output: default@add_part_test@ds=2010-01-02
 PREHOOK: query: SHOW PARTITIONS add_part_test
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@add_part_test
 POSTHOOK: query: SHOW PARTITIONS add_part_test
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@add_part_test
 {"partitions":[{"values":[{"columnName":"ds","columnValue":"2010-01-01"}],"name":"ds='2010-01-01'"},{"values":[{"columnName":"ds","columnValue":"2010-01-02"}],"name":"ds='2010-01-02'"}]}
 PREHOOK: query: SHOW TABLE EXTENDED LIKE add_part_test PARTITION (ds='2010-01-02')
 PREHOOK: type: SHOW_TABLESTATUS
diff --git a/ql/src/test/results/clientpositive/protectmode.q.out b/ql/src/test/results/clientpositive/protectmode.q.out
index c7c97edb35..88ab821518 100644
--- a/ql/src/test/results/clientpositive/protectmode.q.out
+++ b/ql/src/test/results/clientpositive/protectmode.q.out
@@ -43,8 +43,10 @@ POSTHOOK: Input: default@tbl1
 POSTHOOK: Output: default@tbl1
 PREHOOK: query: desc extended tbl1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tbl1
 POSTHOOK: query: desc extended tbl1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tbl1
 col                 	string              	                    
 	 	 
 #### A masked pattern was here ####
@@ -58,8 +60,10 @@ POSTHOOK: Input: default@tbl1
 POSTHOOK: Output: default@tbl1
 PREHOOK: query: desc extended tbl1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tbl1
 POSTHOOK: query: desc extended tbl1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tbl1
 col                 	string              	                    
 	 	 
 #### A masked pattern was here ####
@@ -144,8 +148,10 @@ POSTHOOK: Input: default@tbl2@p=p1
 POSTHOOK: Output: default@tbl2@p=p1
 PREHOOK: query: desc extended tbl2 partition (p='p1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tbl2
 POSTHOOK: query: desc extended tbl2 partition (p='p1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tbl2
 col                 	string              	                    
 p                   	string              	                    
 	 	 
@@ -165,8 +171,10 @@ POSTHOOK: Input: default@tbl2
 POSTHOOK: Output: default@tbl2
 PREHOOK: query: desc extended tbl2
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tbl2
 POSTHOOK: query: desc extended tbl2
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tbl2
 col                 	string              	                    
 p                   	string              	                    
 	 	 
@@ -186,8 +194,10 @@ POSTHOOK: Input: default@tbl2
 POSTHOOK: Output: default@tbl2
 PREHOOK: query: desc extended tbl2
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tbl2
 POSTHOOK: query: desc extended tbl2
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tbl2
 col                 	string              	                    
 p                   	string              	                    
 	 	 
@@ -215,8 +225,10 @@ POSTHOOK: Input: default@tbl2
 POSTHOOK: Output: default@tbl2
 PREHOOK: query: desc extended tbl2
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tbl2
 POSTHOOK: query: desc extended tbl2
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tbl2
 col                 	string              	                    
 p                   	string              	                    
 	 	 
@@ -236,8 +248,10 @@ POSTHOOK: Input: default@tbl2
 POSTHOOK: Output: default@tbl2
 PREHOOK: query: desc extended tbl2
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tbl2
 POSTHOOK: query: desc extended tbl2
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tbl2
 col                 	string              	                    
 p                   	string              	                    
 	 	 
@@ -278,8 +292,10 @@ POSTHOOK: Input: default@tbl2@p=p1
 POSTHOOK: Output: default@tbl2@p=p1
 PREHOOK: query: desc extended tbl2 partition (p='p1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tbl2
 POSTHOOK: query: desc extended tbl2 partition (p='p1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tbl2
 col                 	string              	                    
 p                   	string              	                    
 	 	 
diff --git a/ql/src/test/results/clientpositive/protectmode2.q.out b/ql/src/test/results/clientpositive/protectmode2.q.out
index 7ad6d0b9be..6e4c55c4da 100644
--- a/ql/src/test/results/clientpositive/protectmode2.q.out
+++ b/ql/src/test/results/clientpositive/protectmode2.q.out
@@ -19,8 +19,10 @@ POSTHOOK: Input: default@tbl1
 POSTHOOK: Output: default@tbl1
 PREHOOK: query: desc extended tbl1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tbl1
 POSTHOOK: query: desc extended tbl1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tbl1
 col                 	string              	                    
 	 	 
 #### A masked pattern was here ####
@@ -34,8 +36,10 @@ POSTHOOK: Input: default@tbl1
 POSTHOOK: Output: default@tbl1
 PREHOOK: query: desc extended tbl1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tbl1
 POSTHOOK: query: desc extended tbl1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tbl1
 col                 	string              	                    
 	 	 
 #### A masked pattern was here ####
@@ -49,8 +53,10 @@ POSTHOOK: Input: default@tbl1
 POSTHOOK: Output: default@tbl1
 PREHOOK: query: desc extended tbl1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tbl1
 POSTHOOK: query: desc extended tbl1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tbl1
 col                 	string              	                    
 	 	 
 #### A masked pattern was here ####
@@ -112,8 +118,10 @@ POSTHOOK: Input: default@tbl2
 POSTHOOK: Output: default@tbl2
 PREHOOK: query: desc formatted tbl2
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tbl2
 POSTHOOK: query: desc formatted tbl2
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tbl2
 # col_name            	data_type           	comment             
 	 	 
 col                 	string              	                    
@@ -154,8 +162,10 @@ POSTHOOK: Input: default@tbl2
 POSTHOOK: Output: default@tbl2
 PREHOOK: query: desc formatted tbl2
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tbl2
 POSTHOOK: query: desc formatted tbl2
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tbl2
 # col_name            	data_type           	comment             
 	 	 
 col                 	string              	                    
diff --git a/ql/src/test/results/clientpositive/quotedid_alter.q.out b/ql/src/test/results/clientpositive/quotedid_alter.q.out
index 7348e49db6..786da6fc87 100644
--- a/ql/src/test/results/clientpositive/quotedid_alter.q.out
+++ b/ql/src/test/results/clientpositive/quotedid_alter.q.out
@@ -36,8 +36,10 @@ POSTHOOK: Lineage: src_p3 PARTITION(!@#$%^&*()_q=a).x+1 SIMPLE [(src)src.FieldSc
 POSTHOOK: Lineage: src_p3 PARTITION(!@#$%^&*()_q=a).y&y SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: show partitions src_p3
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@src_p3
 POSTHOOK: query: show partitions src_p3
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@src_p3
 POSTHOOK: Lineage: src_p3 PARTITION(!@#$%^&*()_q=a).x+1 SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: src_p3 PARTITION(!@#$%^&*()_q=a).y&y SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 !@%23$%25%5E&%2A()_q=a
@@ -52,8 +54,10 @@ POSTHOOK: Lineage: src_p3 PARTITION(!@#$%^&*()_q=a).x+1 SIMPLE [(src)src.FieldSc
 POSTHOOK: Lineage: src_p3 PARTITION(!@#$%^&*()_q=a).y&y SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: show partitions src_p3
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@src_p3
 POSTHOOK: query: show partitions src_p3
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@src_p3
 POSTHOOK: Lineage: src_p3 PARTITION(!@#$%^&*()_q=a).x+1 SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: src_p3 PARTITION(!@#$%^&*()_q=a).y&y SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 !@%23$%25%5E&%2A()_q=a
@@ -72,8 +76,10 @@ POSTHOOK: Lineage: src_p3 PARTITION(!@#$%^&*()_q=a).x+1 SIMPLE [(src)src.FieldSc
 POSTHOOK: Lineage: src_p3 PARTITION(!@#$%^&*()_q=a).y&y SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: show partitions src_p3
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@src_p3
 POSTHOOK: query: show partitions src_p3
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@src_p3
 POSTHOOK: Lineage: src_p3 PARTITION(!@#$%^&*()_q=a).x+1 SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: src_p3 PARTITION(!@#$%^&*()_q=a).y&y SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 !@%23$%25%5E&%2A()_q=a
diff --git a/ql/src/test/results/clientpositive/quotedid_basic.q.out b/ql/src/test/results/clientpositive/quotedid_basic.q.out
index 7d0e628b76..38d03fa354 100644
--- a/ql/src/test/results/clientpositive/quotedid_basic.q.out
+++ b/ql/src/test/results/clientpositive/quotedid_basic.q.out
@@ -9,8 +9,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@t1
 PREHOOK: query: describe t1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@t1
 POSTHOOK: query: describe t1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@t1
 x+1                 	string              	                    
 y&y                 	string              	                    
 !@#$%^&*()_q        	string              	                    
@@ -312,8 +314,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@t4
 PREHOOK: query: describe t4
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@t4
 POSTHOOK: query: describe t4
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@t4
 x+1`                	string              	                    
 y&y                 	string              	                    
 PREHOOK: query: insert into table t4 select * from src
diff --git a/ql/src/test/results/clientpositive/quotedid_partition.q.out b/ql/src/test/results/clientpositive/quotedid_partition.q.out
index f946c9354e..21c77d4f07 100644
--- a/ql/src/test/results/clientpositive/quotedid_partition.q.out
+++ b/ql/src/test/results/clientpositive/quotedid_partition.q.out
@@ -17,8 +17,10 @@ POSTHOOK: Lineage: src_p PARTITION(!@#$%^&*()_q=a).x+1 SIMPLE [(src)src.FieldSch
 POSTHOOK: Lineage: src_p PARTITION(!@#$%^&*()_q=a).y&y SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: show partitions src_p
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@src_p
 POSTHOOK: query: show partitions src_p
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@src_p
 POSTHOOK: Lineage: src_p PARTITION(!@#$%^&*()_q=a).x+1 SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: src_p PARTITION(!@#$%^&*()_q=a).y&y SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 !@%23$%25%5E&%2A()_q=a
@@ -252,8 +254,10 @@ POSTHOOK: Lineage: src_p2 PARTITION(!@#$%^&*()_q=val_20).x+1 SIMPLE [(src)src.Fi
 POSTHOOK: Lineage: src_p2 PARTITION(!@#$%^&*()_q=val_2).x+1 SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: show partitions src_p2
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@src_p2
 POSTHOOK: query: show partitions src_p2
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@src_p2
 POSTHOOK: Lineage: src_p PARTITION(!@#$%^&*()_q=a).x+1 SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: src_p PARTITION(!@#$%^&*()_q=a).y&y SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: src_p2 PARTITION(!@#$%^&*()_q=val_0).x+1 SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/quotedid_tblproperty.q.out b/ql/src/test/results/clientpositive/quotedid_tblproperty.q.out
index 2e5abe8216..fb24da8d7d 100644
--- a/ql/src/test/results/clientpositive/quotedid_tblproperty.q.out
+++ b/ql/src/test/results/clientpositive/quotedid_tblproperty.q.out
@@ -11,7 +11,9 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@xyz
 PREHOOK: query: describe xyz
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@xyz
 POSTHOOK: query: describe xyz
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@xyz
 valid_colname       	string              	                    
 invalid.colname     	string              	                    
diff --git a/ql/src/test/results/clientpositive/rcfile_bigdata.q.out b/ql/src/test/results/clientpositive/rcfile_bigdata.q.out
index b573a8c38e..bfee72081c 100644
--- a/ql/src/test/results/clientpositive/rcfile_bigdata.q.out
+++ b/ql/src/test/results/clientpositive/rcfile_bigdata.q.out
@@ -29,8 +29,10 @@ POSTHOOK: Lineage: columntable_bigdata.key SCRIPT [(src)src.FieldSchema(name:key
 POSTHOOK: Lineage: columntable_bigdata.value SCRIPT [(src)src.FieldSchema(name:key, type:string, comment:default), (src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: describe columnTable_Bigdata
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@columntable_bigdata
 POSTHOOK: query: describe columnTable_Bigdata
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@columntable_bigdata
 POSTHOOK: Lineage: columntable_bigdata.key SCRIPT [(src)src.FieldSchema(name:key, type:string, comment:default), (src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: columntable_bigdata.value SCRIPT [(src)src.FieldSchema(name:key, type:string, comment:default), (src)src.FieldSchema(name:value, type:string, comment:default), ]
 key                 	string              	                    
diff --git a/ql/src/test/results/clientpositive/rcfile_columnar.q.out b/ql/src/test/results/clientpositive/rcfile_columnar.q.out
index 6c52bb06b5..c0e417eac1 100644
--- a/ql/src/test/results/clientpositive/rcfile_columnar.q.out
+++ b/ql/src/test/results/clientpositive/rcfile_columnar.q.out
@@ -29,8 +29,10 @@ POSTHOOK: Lineage: columntable.key SIMPLE [(src)src.FieldSchema(name:key, type:s
 POSTHOOK: Lineage: columntable.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: describe columnTable
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@columntable
 POSTHOOK: query: describe columnTable
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@columntable
 POSTHOOK: Lineage: columntable.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: columntable.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 key                 	string              	                    
diff --git a/ql/src/test/results/clientpositive/rcfile_default_format.q.out b/ql/src/test/results/clientpositive/rcfile_default_format.q.out
index 3f6b6a3298..418504f06e 100644
--- a/ql/src/test/results/clientpositive/rcfile_default_format.q.out
+++ b/ql/src/test/results/clientpositive/rcfile_default_format.q.out
@@ -7,8 +7,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@rcfile_default_format
 PREHOOK: query: DESCRIBE FORMATTED rcfile_default_format
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@rcfile_default_format
 POSTHOOK: query: DESCRIBE FORMATTED rcfile_default_format
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@rcfile_default_format
 # col_name            	data_type           	comment             
 	 	 
 key                 	string              	                    
@@ -42,8 +44,10 @@ POSTHOOK: Input: default@src
 POSTHOOK: Output: default@rcfile_default_format_ctas
 PREHOOK: query: DESCRIBE FORMATTED rcfile_default_format_ctas
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@rcfile_default_format_ctas
 POSTHOOK: query: DESCRIBE FORMATTED rcfile_default_format_ctas
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@rcfile_default_format_ctas
 # col_name            	data_type           	comment             
 	 	 
 key                 	string              	                    
@@ -92,8 +96,10 @@ POSTHOOK: Output: default@rcfile_default_format_txtfile
 POSTHOOK: Lineage: rcfile_default_format_txtfile.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED rcfile_default_format_txtfile
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@rcfile_default_format_txtfile
 POSTHOOK: query: DESCRIBE FORMATTED rcfile_default_format_txtfile
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@rcfile_default_format_txtfile
 POSTHOOK: Lineage: rcfile_default_format_txtfile.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 # col_name            	data_type           	comment             
 	 	 
@@ -134,8 +140,10 @@ POSTHOOK: Output: default@textfile_default_format_ctas
 POSTHOOK: Lineage: rcfile_default_format_txtfile.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED textfile_default_format_ctas
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@textfile_default_format_ctas
 POSTHOOK: query: DESCRIBE FORMATTED textfile_default_format_ctas
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@textfile_default_format_ctas
 POSTHOOK: Lineage: rcfile_default_format_txtfile.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 # col_name            	data_type           	comment             
 	 	 
@@ -177,8 +185,10 @@ POSTHOOK: Output: default@rcfile_default_format_ctas_default_serde
 POSTHOOK: Lineage: rcfile_default_format_txtfile.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED rcfile_default_format_ctas_default_serde
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@rcfile_default_format_ctas_default_serde
 POSTHOOK: query: DESCRIBE FORMATTED rcfile_default_format_ctas_default_serde
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@rcfile_default_format_ctas_default_serde
 POSTHOOK: Lineage: rcfile_default_format_txtfile.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 # col_name            	data_type           	comment             
 	 	 
@@ -220,8 +230,10 @@ POSTHOOK: Output: default@rcfile_default_format_default_serde
 POSTHOOK: Lineage: rcfile_default_format_txtfile.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED rcfile_default_format_default_serde
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@rcfile_default_format_default_serde
 POSTHOOK: query: DESCRIBE FORMATTED rcfile_default_format_default_serde
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@rcfile_default_format_default_serde
 POSTHOOK: Lineage: rcfile_default_format_txtfile.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 # col_name            	data_type           	comment             
 	 	 
@@ -257,8 +269,10 @@ POSTHOOK: Output: default@rcfile_ctas_default_serde
 POSTHOOK: Lineage: rcfile_default_format_txtfile.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED rcfile_ctas_default_serde
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@rcfile_ctas_default_serde
 POSTHOOK: query: DESCRIBE FORMATTED rcfile_ctas_default_serde
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@rcfile_ctas_default_serde
 POSTHOOK: Lineage: rcfile_default_format_txtfile.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 # col_name            	data_type           	comment             
 	 	 
@@ -300,8 +314,10 @@ POSTHOOK: Output: default@rcfile_default_serde
 POSTHOOK: Lineage: rcfile_default_format_txtfile.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED rcfile_default_serde
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@rcfile_default_serde
 POSTHOOK: query: DESCRIBE FORMATTED rcfile_default_serde
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@rcfile_default_serde
 POSTHOOK: Lineage: rcfile_default_format_txtfile.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 # col_name            	data_type           	comment             
 	 	 
diff --git a/ql/src/test/results/clientpositive/rename_column.q.out b/ql/src/test/results/clientpositive/rename_column.q.out
index 1f00db8997..c2c2e3ee62 100644
--- a/ql/src/test/results/clientpositive/rename_column.q.out
+++ b/ql/src/test/results/clientpositive/rename_column.q.out
@@ -7,8 +7,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@kv_rename_test
 PREHOOK: query: DESCRIBE kv_rename_test
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@kv_rename_test
 POSTHOOK: query: DESCRIBE kv_rename_test
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@kv_rename_test
 a                   	int                 	                    
 b                   	int                 	                    
 c                   	int                 	                    
@@ -22,8 +24,10 @@ POSTHOOK: Input: default@kv_rename_test
 POSTHOOK: Output: default@kv_rename_test
 PREHOOK: query: DESCRIBE kv_rename_test
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@kv_rename_test
 POSTHOOK: query: DESCRIBE kv_rename_test
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@kv_rename_test
 a                   	string              	                    
 b                   	int                 	                    
 c                   	int                 	                    
@@ -37,8 +41,10 @@ POSTHOOK: Input: default@kv_rename_test
 POSTHOOK: Output: default@kv_rename_test
 PREHOOK: query: DESCRIBE kv_rename_test
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@kv_rename_test
 POSTHOOK: query: DESCRIBE kv_rename_test
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@kv_rename_test
 a1                  	int                 	                    
 b                   	int                 	                    
 c                   	int                 	                    
@@ -52,8 +58,10 @@ POSTHOOK: Input: default@kv_rename_test
 POSTHOOK: Output: default@kv_rename_test
 PREHOOK: query: DESCRIBE kv_rename_test
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@kv_rename_test
 POSTHOOK: query: DESCRIBE kv_rename_test
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@kv_rename_test
 a2                  	int                 	                    
 b                   	int                 	                    
 c                   	int                 	                    
@@ -67,8 +75,10 @@ POSTHOOK: Input: default@kv_rename_test
 POSTHOOK: Output: default@kv_rename_test
 PREHOOK: query: DESCRIBE kv_rename_test
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@kv_rename_test
 POSTHOOK: query: DESCRIBE kv_rename_test
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@kv_rename_test
 b                   	int                 	                    
 a                   	int                 	                    
 c                   	int                 	                    
@@ -82,8 +92,10 @@ POSTHOOK: Input: default@kv_rename_test
 POSTHOOK: Output: default@kv_rename_test
 PREHOOK: query: DESCRIBE kv_rename_test
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@kv_rename_test
 POSTHOOK: query: DESCRIBE kv_rename_test
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@kv_rename_test
 b                   	int                 	                    
 a1                  	int                 	test comment1       
 c                   	int                 	                    
@@ -97,8 +109,10 @@ POSTHOOK: Input: default@kv_rename_test
 POSTHOOK: Output: default@kv_rename_test
 PREHOOK: query: DESCRIBE kv_rename_test
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@kv_rename_test
 POSTHOOK: query: DESCRIBE kv_rename_test
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@kv_rename_test
 a2                  	int                 	test comment2       
 b                   	int                 	                    
 c                   	int                 	                    
@@ -112,8 +126,10 @@ POSTHOOK: Input: default@kv_rename_test
 POSTHOOK: Output: default@kv_rename_test
 PREHOOK: query: DESCRIBE kv_rename_test
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@kv_rename_test
 POSTHOOK: query: DESCRIBE kv_rename_test
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@kv_rename_test
 b                   	int                 	                    
 a                   	int                 	test comment2       
 c                   	int                 	                    
@@ -157,8 +173,10 @@ POSTHOOK: Output: database:kv_rename_test_db
 POSTHOOK: Output: kv_rename_test_db@kv_rename_test
 PREHOOK: query: DESCRIBE kv_rename_test
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: kv_rename_test_db@kv_rename_test
 POSTHOOK: query: DESCRIBE kv_rename_test
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: kv_rename_test_db@kv_rename_test
 a                   	int                 	                    
 b                   	int                 	                    
 c                   	int                 	                    
@@ -172,8 +190,10 @@ POSTHOOK: Input: kv_rename_test_db@kv_rename_test
 POSTHOOK: Output: kv_rename_test_db@kv_rename_test
 PREHOOK: query: DESCRIBE kv_rename_test
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: kv_rename_test_db@kv_rename_test
 POSTHOOK: query: DESCRIBE kv_rename_test
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: kv_rename_test_db@kv_rename_test
 a                   	string              	                    
 b                   	int                 	                    
 c                   	int                 	                    
@@ -187,8 +207,10 @@ POSTHOOK: Input: kv_rename_test_db@kv_rename_test
 POSTHOOK: Output: kv_rename_test_db@kv_rename_test
 PREHOOK: query: DESCRIBE kv_rename_test
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: kv_rename_test_db@kv_rename_test
 POSTHOOK: query: DESCRIBE kv_rename_test
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: kv_rename_test_db@kv_rename_test
 a1                  	int                 	                    
 b                   	int                 	                    
 c                   	int                 	                    
@@ -202,8 +224,10 @@ POSTHOOK: Input: kv_rename_test_db@kv_rename_test
 POSTHOOK: Output: kv_rename_test_db@kv_rename_test
 PREHOOK: query: DESCRIBE kv_rename_test
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: kv_rename_test_db@kv_rename_test
 POSTHOOK: query: DESCRIBE kv_rename_test
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: kv_rename_test_db@kv_rename_test
 a2                  	int                 	                    
 b                   	int                 	                    
 c                   	int                 	                    
@@ -217,8 +241,10 @@ POSTHOOK: Input: kv_rename_test_db@kv_rename_test
 POSTHOOK: Output: kv_rename_test_db@kv_rename_test
 PREHOOK: query: DESCRIBE kv_rename_test
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: kv_rename_test_db@kv_rename_test
 POSTHOOK: query: DESCRIBE kv_rename_test
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: kv_rename_test_db@kv_rename_test
 b                   	int                 	                    
 a                   	int                 	                    
 c                   	int                 	                    
@@ -232,8 +258,10 @@ POSTHOOK: Input: kv_rename_test_db@kv_rename_test
 POSTHOOK: Output: kv_rename_test_db@kv_rename_test
 PREHOOK: query: DESCRIBE kv_rename_test
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: kv_rename_test_db@kv_rename_test
 POSTHOOK: query: DESCRIBE kv_rename_test
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: kv_rename_test_db@kv_rename_test
 b                   	int                 	                    
 a1                  	int                 	test comment1       
 c                   	int                 	                    
@@ -247,8 +275,10 @@ POSTHOOK: Input: kv_rename_test_db@kv_rename_test
 POSTHOOK: Output: kv_rename_test_db@kv_rename_test
 PREHOOK: query: DESCRIBE kv_rename_test
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: kv_rename_test_db@kv_rename_test
 POSTHOOK: query: DESCRIBE kv_rename_test
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: kv_rename_test_db@kv_rename_test
 a2                  	int                 	test comment2       
 b                   	int                 	                    
 c                   	int                 	                    
@@ -262,8 +292,10 @@ POSTHOOK: Input: kv_rename_test_db@kv_rename_test
 POSTHOOK: Output: kv_rename_test_db@kv_rename_test
 PREHOOK: query: DESCRIBE kv_rename_test
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: kv_rename_test_db@kv_rename_test
 POSTHOOK: query: DESCRIBE kv_rename_test
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: kv_rename_test_db@kv_rename_test
 b                   	int                 	                    
 a                   	int                 	test comment2       
 c                   	int                 	                    
diff --git a/ql/src/test/results/clientpositive/rename_external_partition_location.q.out b/ql/src/test/results/clientpositive/rename_external_partition_location.q.out
index 840f4c8fba..8517f3f313 100644
--- a/ql/src/test/results/clientpositive/rename_external_partition_location.q.out
+++ b/ql/src/test/results/clientpositive/rename_external_partition_location.q.out
@@ -27,8 +27,10 @@ POSTHOOK: Lineage: ex_table PARTITION(part=part1).key EXPRESSION [(src)src.Field
 POSTHOOK: Lineage: ex_table PARTITION(part=part1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: SHOW PARTITIONS ex_table
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@ex_table
 POSTHOOK: query: SHOW PARTITIONS ex_table
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@ex_table
 POSTHOOK: Lineage: ex_table PARTITION(part=part1).key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: ex_table PARTITION(part=part1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 part=part1
@@ -80,8 +82,10 @@ POSTHOOK: Lineage: ex_table PARTITION(part=part1).key EXPRESSION [(src)src.Field
 POSTHOOK: Lineage: ex_table PARTITION(part=part1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: SHOW PARTITIONS ex_table
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@ex_table
 POSTHOOK: query: SHOW PARTITIONS ex_table
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@ex_table
 POSTHOOK: Lineage: ex_table PARTITION(part=part1).key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: ex_table PARTITION(part=part1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 part=part2
diff --git a/ql/src/test/results/clientpositive/sample8.q.out b/ql/src/test/results/clientpositive/sample8.q.out
index a5e8060a66..894522805e 100644
--- a/ql/src/test/results/clientpositive/sample8.q.out
+++ b/ql/src/test/results/clientpositive/sample8.q.out
@@ -161,7 +161,7 @@ STAGE PLANS:
               ds 2008-04-08
               hr 11
             properties:
-              COLUMN_STATS_ACCURATE true
+              COLUMN_STATS_ACCURATE false
               bucket_count -1
               columns key,value
               columns.comments default default
@@ -169,10 +169,10 @@ STAGE PLANS:
 #### A masked pattern was here ####
               name default.srcpart
               numFiles 1
-              numRows 0
+              numRows -1
               partition_columns ds/hr
               partition_columns.types string:string
-              rawDataSize 0
+              rawDataSize -1
               serialization.ddl struct srcpart { string key, string value}
               serialization.format 1
               serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -207,7 +207,7 @@ STAGE PLANS:
               ds 2008-04-08
               hr 12
             properties:
-              COLUMN_STATS_ACCURATE true
+              COLUMN_STATS_ACCURATE false
               bucket_count -1
               columns key,value
               columns.comments default default
@@ -215,10 +215,10 @@ STAGE PLANS:
 #### A masked pattern was here ####
               name default.srcpart
               numFiles 1
-              numRows 0
+              numRows -1
               partition_columns ds/hr
               partition_columns.types string:string
-              rawDataSize 0
+              rawDataSize -1
               serialization.ddl struct srcpart { string key, string value}
               serialization.format 1
               serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -253,7 +253,7 @@ STAGE PLANS:
               ds 2008-04-09
               hr 11
             properties:
-              COLUMN_STATS_ACCURATE true
+              COLUMN_STATS_ACCURATE false
               bucket_count -1
               columns key,value
               columns.comments default default
@@ -261,10 +261,10 @@ STAGE PLANS:
 #### A masked pattern was here ####
               name default.srcpart
               numFiles 1
-              numRows 0
+              numRows -1
               partition_columns ds/hr
               partition_columns.types string:string
-              rawDataSize 0
+              rawDataSize -1
               serialization.ddl struct srcpart { string key, string value}
               serialization.format 1
               serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -299,7 +299,7 @@ STAGE PLANS:
               ds 2008-04-09
               hr 12
             properties:
-              COLUMN_STATS_ACCURATE true
+              COLUMN_STATS_ACCURATE false
               bucket_count -1
               columns key,value
               columns.comments default default
@@ -307,10 +307,10 @@ STAGE PLANS:
 #### A masked pattern was here ####
               name default.srcpart
               numFiles 1
-              numRows 0
+              numRows -1
               partition_columns ds/hr
               partition_columns.types string:string
-              rawDataSize 0
+              rawDataSize -1
               serialization.ddl struct srcpart { string key, string value}
               serialization.format 1
               serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/serde_reported_schema.q.out b/ql/src/test/results/clientpositive/serde_reported_schema.q.out
index db5ce6aba1..a7b2438499 100644
--- a/ql/src/test/results/clientpositive/serde_reported_schema.q.out
+++ b/ql/src/test/results/clientpositive/serde_reported_schema.q.out
@@ -17,8 +17,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@int_string
 PREHOOK: query: describe extended int_string
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@int_string
 POSTHOOK: query: describe extended int_string
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@int_string
 myint               	int                 	from deserializer   
 mystring            	string              	from deserializer   
 underscore_int      	int                 	from deserializer   
@@ -39,8 +41,10 @@ POSTHOOK: Output: default@int_string
 POSTHOOK: Output: default@int_string@b=part1
 PREHOOK: query: describe extended int_string partition (b='part1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@int_string
 POSTHOOK: query: describe extended int_string partition (b='part1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@int_string
 myint               	int                 	from deserializer   
 mystring            	string              	from deserializer   
 underscore_int      	int                 	from deserializer   
diff --git a/ql/src/test/results/clientpositive/show_partitions.q.out b/ql/src/test/results/clientpositive/show_partitions.q.out
index 5190c53d3b..06f1c0d0b3 100644
--- a/ql/src/test/results/clientpositive/show_partitions.q.out
+++ b/ql/src/test/results/clientpositive/show_partitions.q.out
@@ -1,33 +1,43 @@
 PREHOOK: query: SHOW PARTITIONS srcpart
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: SHOW PARTITIONS srcpart
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@srcpart
 ds=2008-04-08/hr=11
 ds=2008-04-08/hr=12
 ds=2008-04-09/hr=11
 ds=2008-04-09/hr=12
 PREHOOK: query: SHOW PARTITIONS default.srcpart
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: SHOW PARTITIONS default.srcpart
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@srcpart
 ds=2008-04-08/hr=11
 ds=2008-04-08/hr=12
 ds=2008-04-09/hr=11
 ds=2008-04-09/hr=12
 PREHOOK: query: SHOW PARTITIONS srcpart PARTITION(hr='11')
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: SHOW PARTITIONS srcpart PARTITION(hr='11')
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@srcpart
 ds=2008-04-08/hr=11
 ds=2008-04-09/hr=11
 PREHOOK: query: SHOW PARTITIONS srcpart PARTITION(ds='2008-04-08')
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: SHOW PARTITIONS srcpart PARTITION(ds='2008-04-08')
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@srcpart
 ds=2008-04-08/hr=11
 ds=2008-04-08/hr=12
 PREHOOK: query: SHOW PARTITIONS srcpart PARTITION(ds='2008-04-08', hr='12')
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: SHOW PARTITIONS srcpart PARTITION(ds='2008-04-08', hr='12')
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@srcpart
 ds=2008-04-08/hr=12
diff --git a/ql/src/test/results/clientpositive/showparts.q.out b/ql/src/test/results/clientpositive/showparts.q.out
index 9f40fc08f5..7968946b09 100644
--- a/ql/src/test/results/clientpositive/showparts.q.out
+++ b/ql/src/test/results/clientpositive/showparts.q.out
@@ -20,8 +20,10 @@ STAGE PLANS:
 
 PREHOOK: query: SHOW PARTITIONS srcpart
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: SHOW PARTITIONS srcpart
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@srcpart
 ds=2008-04-08/hr=11
 ds=2008-04-08/hr=12
 ds=2008-04-09/hr=11
diff --git a/ql/src/test/results/clientpositive/stats0.q.out b/ql/src/test/results/clientpositive/stats0.q.out
index f4aaf980b9..a1d1e3cbcd 100644
--- a/ql/src/test/results/clientpositive/stats0.q.out
+++ b/ql/src/test/results/clientpositive/stats0.q.out
@@ -163,8 +163,10 @@ POSTHOOK: Lineage: stats_non_partitioned.key SIMPLE [(src)src.FieldSchema(name:k
 POSTHOOK: Lineage: stats_non_partitioned.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: desc extended stats_non_partitioned
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@stats_non_partitioned
 POSTHOOK: query: desc extended stats_non_partitioned
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@stats_non_partitioned
 POSTHOOK: Lineage: stats_non_partitioned.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_non_partitioned.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 key                 	string              	                    
@@ -756,8 +758,10 @@ POSTHOOK: Lineage: stats_partitioned PARTITION(ds=1).key SIMPLE [(src)src.FieldS
 POSTHOOK: Lineage: stats_partitioned PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: show partitions stats_partitioned
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@stats_partitioned
 POSTHOOK: query: show partitions stats_partitioned
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@stats_partitioned
 POSTHOOK: Lineage: stats_non_partitioned.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_non_partitioned.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_partitioned PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -1279,8 +1283,10 @@ POSTHOOK: Lineage: stats_partitioned PARTITION(ds=1).value SIMPLE [(src)src.Fiel
 97	val_97	1
 PREHOOK: query: describe extended stats_partitioned partition (ds='1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@stats_partitioned
 POSTHOOK: query: describe extended stats_partitioned partition (ds='1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@stats_partitioned
 POSTHOOK: Lineage: stats_non_partitioned.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_non_partitioned.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_partitioned PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -1297,8 +1303,10 @@ ds                  	string
 #### A masked pattern was here ####
 PREHOOK: query: describe extended stats_partitioned
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@stats_partitioned
 POSTHOOK: query: describe extended stats_partitioned
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@stats_partitioned
 POSTHOOK: Lineage: stats_non_partitioned.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_non_partitioned.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_partitioned PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -1672,8 +1680,10 @@ POSTHOOK: Lineage: stats_partitioned PARTITION(ds=1).key SIMPLE [(src)src.FieldS
 POSTHOOK: Lineage: stats_partitioned PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: desc extended stats_non_partitioned
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@stats_non_partitioned
 POSTHOOK: query: desc extended stats_non_partitioned
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@stats_non_partitioned
 POSTHOOK: Lineage: stats_non_partitioned.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_non_partitioned.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_non_partitioned.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
@@ -2329,8 +2339,10 @@ POSTHOOK: Lineage: stats_partitioned PARTITION(ds=1).key SIMPLE [(src)src.FieldS
 POSTHOOK: Lineage: stats_partitioned PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: show partitions stats_partitioned
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@stats_partitioned
 POSTHOOK: query: show partitions stats_partitioned
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@stats_partitioned
 POSTHOOK: Lineage: stats_non_partitioned.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_non_partitioned.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_non_partitioned.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
@@ -2860,8 +2872,10 @@ POSTHOOK: Lineage: stats_partitioned PARTITION(ds=1).value SIMPLE [(src)src.Fiel
 97	val_97	1
 PREHOOK: query: describe extended stats_partitioned partition (ds='1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@stats_partitioned
 POSTHOOK: query: describe extended stats_partitioned partition (ds='1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@stats_partitioned
 POSTHOOK: Lineage: stats_non_partitioned.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_non_partitioned.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_non_partitioned.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
@@ -2882,8 +2896,10 @@ ds                  	string
 #### A masked pattern was here ####
 PREHOOK: query: describe extended stats_partitioned
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@stats_partitioned
 POSTHOOK: query: describe extended stats_partitioned
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@stats_partitioned
 POSTHOOK: Lineage: stats_non_partitioned.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_non_partitioned.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_non_partitioned.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/stats1.q.out b/ql/src/test/results/clientpositive/stats1.q.out
index 90c5ad1b95..0b2022de6b 100644
--- a/ql/src/test/results/clientpositive/stats1.q.out
+++ b/ql/src/test/results/clientpositive/stats1.q.out
@@ -171,8 +171,10 @@ POSTHOOK: Lineage: tmptable.value EXPRESSION [(src)s1.null, (src1)s2.FieldSchema
 tst1	500
 PREHOOK: query: DESCRIBE FORMATTED tmptable
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tmptable
 POSTHOOK: query: DESCRIBE FORMATTED tmptable
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tmptable
 POSTHOOK: Lineage: tmptable.key EXPRESSION [(src1)s2.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: tmptable.value EXPRESSION [(src)s1.null, (src1)s2.FieldSchema(name:value, type:string, comment:default), ]
 # col_name            	data_type           	comment             
@@ -223,8 +225,10 @@ POSTHOOK: Lineage: tmptable.key EXPRESSION [(src1)s2.FieldSchema(name:key, type:
 POSTHOOK: Lineage: tmptable.value EXPRESSION [(src)s1.null, (src1)s2.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE FORMATTED tmptable
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tmptable
 POSTHOOK: query: DESCRIBE FORMATTED tmptable
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tmptable
 POSTHOOK: Lineage: tmptable.key EXPRESSION [(src1)s2.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: tmptable.value EXPRESSION [(src)s1.null, (src1)s2.FieldSchema(name:value, type:string, comment:default), ]
 # col_name            	data_type           	comment             
diff --git a/ql/src/test/results/clientpositive/stats10.q.out b/ql/src/test/results/clientpositive/stats10.q.out
index dda7a3f7ff..5e2be8a471 100644
--- a/ql/src/test/results/clientpositive/stats10.q.out
+++ b/ql/src/test/results/clientpositive/stats10.q.out
@@ -419,8 +419,10 @@ POSTHOOK: Lineage: bucket3_1 PARTITION(ds=2).key EXPRESSION [(src)src.FieldSchem
 POSTHOOK: Lineage: bucket3_1 PARTITION(ds=2).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: describe formatted bucket3_1 partition (ds='1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@bucket3_1
 POSTHOOK: query: describe formatted bucket3_1 partition (ds='1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@bucket3_1
 POSTHOOK: Lineage: bucket3_1 PARTITION(ds=1).key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: bucket3_1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: bucket3_1 PARTITION(ds=1).key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -464,8 +466,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: describe formatted bucket3_1 partition (ds='2')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@bucket3_1
 POSTHOOK: query: describe formatted bucket3_1 partition (ds='2')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@bucket3_1
 POSTHOOK: Lineage: bucket3_1 PARTITION(ds=1).key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: bucket3_1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: bucket3_1 PARTITION(ds=1).key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -509,8 +513,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: describe formatted bucket3_1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@bucket3_1
 POSTHOOK: query: describe formatted bucket3_1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@bucket3_1
 POSTHOOK: Lineage: bucket3_1 PARTITION(ds=1).key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: bucket3_1 PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: bucket3_1 PARTITION(ds=1).key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/stats11.q.out b/ql/src/test/results/clientpositive/stats11.q.out
index 3244007c2a..1bef162f8b 100644
--- a/ql/src/test/results/clientpositive/stats11.q.out
+++ b/ql/src/test/results/clientpositive/stats11.q.out
@@ -65,8 +65,10 @@ POSTHOOK: Output: default@srcbucket_mapjoin_part
 POSTHOOK: Output: default@srcbucket_mapjoin_part@ds=2008-04-08
 PREHOOK: query: desc formatted srcbucket_mapjoin_part partition(ds='2008-04-08')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@srcbucket_mapjoin_part
 POSTHOOK: query: desc formatted srcbucket_mapjoin_part partition(ds='2008-04-08')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@srcbucket_mapjoin_part
 # col_name            	data_type           	comment             
 	 	 
 key                 	int                 	                    
@@ -112,8 +114,10 @@ POSTHOOK: type: LOAD
 POSTHOOK: Output: default@srcbucket_mapjoin_part@ds=2008-04-08
 PREHOOK: query: desc formatted srcbucket_mapjoin_part partition(ds='2008-04-08')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@srcbucket_mapjoin_part
 POSTHOOK: query: desc formatted srcbucket_mapjoin_part partition(ds='2008-04-08')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@srcbucket_mapjoin_part
 # col_name            	data_type           	comment             
 	 	 
 key                 	int                 	                    
@@ -159,8 +163,10 @@ POSTHOOK: type: LOAD
 POSTHOOK: Output: default@srcbucket_mapjoin_part@ds=2008-04-08
 PREHOOK: query: desc formatted srcbucket_mapjoin_part partition(ds='2008-04-08')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@srcbucket_mapjoin_part
 POSTHOOK: query: desc formatted srcbucket_mapjoin_part partition(ds='2008-04-08')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@srcbucket_mapjoin_part
 # col_name            	data_type           	comment             
 	 	 
 key                 	int                 	                    
@@ -206,8 +212,10 @@ POSTHOOK: type: LOAD
 POSTHOOK: Output: default@srcbucket_mapjoin_part@ds=2008-04-08
 PREHOOK: query: desc formatted srcbucket_mapjoin_part partition(ds='2008-04-08')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@srcbucket_mapjoin_part
 POSTHOOK: query: desc formatted srcbucket_mapjoin_part partition(ds='2008-04-08')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@srcbucket_mapjoin_part
 # col_name            	data_type           	comment             
 	 	 
 key                 	int                 	                    
diff --git a/ql/src/test/results/clientpositive/stats12.q.out b/ql/src/test/results/clientpositive/stats12.q.out
index 77edec620a..c7a85c5004 100644
--- a/ql/src/test/results/clientpositive/stats12.q.out
+++ b/ql/src/test/results/clientpositive/stats12.q.out
@@ -202,8 +202,10 @@ POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-09,hr=12).key SIMPLE [(s
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-09,hr=12).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: desc formatted analyze_srcpart
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@analyze_srcpart
 POSTHOOK: query: desc formatted analyze_srcpart
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@analyze_srcpart
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -245,8 +247,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: desc formatted analyze_srcpart partition (ds='2008-04-08', hr=11)
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@analyze_srcpart
 POSTHOOK: query: desc formatted analyze_srcpart partition (ds='2008-04-08', hr=11)
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@analyze_srcpart
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -293,8 +297,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: desc formatted analyze_srcpart partition (ds='2008-04-08', hr=12)
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@analyze_srcpart
 POSTHOOK: query: desc formatted analyze_srcpart partition (ds='2008-04-08', hr=12)
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@analyze_srcpart
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -341,8 +347,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: desc formatted analyze_srcpart partition (ds='2008-04-09', hr=11)
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@analyze_srcpart
 POSTHOOK: query: desc formatted analyze_srcpart partition (ds='2008-04-09', hr=11)
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@analyze_srcpart
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -389,8 +397,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: desc formatted analyze_srcpart partition (ds='2008-04-09', hr=12)
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@analyze_srcpart
 POSTHOOK: query: desc formatted analyze_srcpart partition (ds='2008-04-09', hr=12)
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@analyze_srcpart
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/stats13.q.out b/ql/src/test/results/clientpositive/stats13.q.out
index caf45397d6..4a8a299ef8 100644
--- a/ql/src/test/results/clientpositive/stats13.q.out
+++ b/ql/src/test/results/clientpositive/stats13.q.out
@@ -152,8 +152,10 @@ POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-09,hr=12).key SIMPLE [(s
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-09,hr=12).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: desc formatted analyze_srcpart
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@analyze_srcpart
 POSTHOOK: query: desc formatted analyze_srcpart
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@analyze_srcpart
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -195,8 +197,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: desc formatted analyze_srcpart partition (ds='2008-04-08', hr=11)
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@analyze_srcpart
 POSTHOOK: query: desc formatted analyze_srcpart partition (ds='2008-04-08', hr=11)
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@analyze_srcpart
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -243,8 +247,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: desc formatted analyze_srcpart partition (ds='2008-04-08', hr=12)
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@analyze_srcpart
 POSTHOOK: query: desc formatted analyze_srcpart partition (ds='2008-04-08', hr=12)
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@analyze_srcpart
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -291,8 +297,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: desc formatted analyze_srcpart partition (ds='2008-04-09', hr=11)
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@analyze_srcpart
 POSTHOOK: query: desc formatted analyze_srcpart partition (ds='2008-04-09', hr=11)
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@analyze_srcpart
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -339,8 +347,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: desc formatted analyze_srcpart partition (ds='2008-04-09', hr=12)
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@analyze_srcpart
 POSTHOOK: query: desc formatted analyze_srcpart partition (ds='2008-04-09', hr=12)
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@analyze_srcpart
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -402,8 +412,10 @@ POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-09,hr=12).key SIMPLE [(s
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-09,hr=12).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: desc formatted analyze_srcpart2
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@analyze_srcpart2
 POSTHOOK: query: desc formatted analyze_srcpart2
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@analyze_srcpart2
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/stats14.q.out b/ql/src/test/results/clientpositive/stats14.q.out
index 0136d7968e..f978944461 100644
--- a/ql/src/test/results/clientpositive/stats14.q.out
+++ b/ql/src/test/results/clientpositive/stats14.q.out
@@ -27,8 +27,10 @@ POSTHOOK: Lineage: stats_src.key SIMPLE [(src)src.FieldSchema(name:key, type:str
 POSTHOOK: Lineage: stats_src.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: desc formatted stats_src
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@stats_src
 POSTHOOK: query: desc formatted stats_src
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@stats_src
 POSTHOOK: Lineage: stats_src.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_src.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 # col_name            	data_type           	comment             
@@ -150,8 +152,10 @@ POSTHOOK: Lineage: stats_src.key SIMPLE [(src)src.FieldSchema(name:key, type:str
 POSTHOOK: Lineage: stats_src.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: desc formatted stats_part
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@stats_part
 POSTHOOK: query: desc formatted stats_part
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@stats_part
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=11).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=11).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=12).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -193,8 +197,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: desc formatted stats_part partition (ds='2010-04-08', hr = '11')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@stats_part
 POSTHOOK: query: desc formatted stats_part partition (ds='2010-04-08', hr = '11')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@stats_part
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=11).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=11).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=12).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -241,8 +247,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: desc formatted stats_part partition (ds='2010-04-08', hr = '12')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@stats_part
 POSTHOOK: query: desc formatted stats_part partition (ds='2010-04-08', hr = '12')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@stats_part
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=11).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=11).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=12).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -317,8 +325,10 @@ POSTHOOK: Lineage: stats_src.key SIMPLE [(src)src.FieldSchema(name:key, type:str
 POSTHOOK: Lineage: stats_src.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: desc formatted stats_part
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@stats_part
 POSTHOOK: query: desc formatted stats_part
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@stats_part
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=11).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=11).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=12).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/stats15.q.out b/ql/src/test/results/clientpositive/stats15.q.out
index 0136d7968e..f978944461 100644
--- a/ql/src/test/results/clientpositive/stats15.q.out
+++ b/ql/src/test/results/clientpositive/stats15.q.out
@@ -27,8 +27,10 @@ POSTHOOK: Lineage: stats_src.key SIMPLE [(src)src.FieldSchema(name:key, type:str
 POSTHOOK: Lineage: stats_src.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: desc formatted stats_src
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@stats_src
 POSTHOOK: query: desc formatted stats_src
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@stats_src
 POSTHOOK: Lineage: stats_src.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_src.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 # col_name            	data_type           	comment             
@@ -150,8 +152,10 @@ POSTHOOK: Lineage: stats_src.key SIMPLE [(src)src.FieldSchema(name:key, type:str
 POSTHOOK: Lineage: stats_src.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: desc formatted stats_part
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@stats_part
 POSTHOOK: query: desc formatted stats_part
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@stats_part
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=11).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=11).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=12).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -193,8 +197,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: desc formatted stats_part partition (ds='2010-04-08', hr = '11')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@stats_part
 POSTHOOK: query: desc formatted stats_part partition (ds='2010-04-08', hr = '11')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@stats_part
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=11).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=11).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=12).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -241,8 +247,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: desc formatted stats_part partition (ds='2010-04-08', hr = '12')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@stats_part
 POSTHOOK: query: desc formatted stats_part partition (ds='2010-04-08', hr = '12')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@stats_part
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=11).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=11).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=12).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -317,8 +325,10 @@ POSTHOOK: Lineage: stats_src.key SIMPLE [(src)src.FieldSchema(name:key, type:str
 POSTHOOK: Lineage: stats_src.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: desc formatted stats_part
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@stats_part
 POSTHOOK: query: desc formatted stats_part
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@stats_part
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=11).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=11).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=12).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/stats16.q.out b/ql/src/test/results/clientpositive/stats16.q.out
index 41ecb4fceb..6031171d70 100644
--- a/ql/src/test/results/clientpositive/stats16.q.out
+++ b/ql/src/test/results/clientpositive/stats16.q.out
@@ -11,8 +11,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@stats16
 PREHOOK: query: desc formatted stats16
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@stats16
 POSTHOOK: query: desc formatted stats16
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@stats16
 # col_name            	data_type           	comment             
 	 	 
 key                 	int                 	                    
@@ -60,8 +62,10 @@ POSTHOOK: Lineage: stats16.key EXPRESSION [(src)src.FieldSchema(name:key, type:s
 POSTHOOK: Lineage: stats16.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: desc formatted stats16
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@stats16
 POSTHOOK: query: desc formatted stats16
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@stats16
 POSTHOOK: Lineage: stats16.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: stats16.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 # col_name            	data_type           	comment             
diff --git a/ql/src/test/results/clientpositive/stats18.q.out b/ql/src/test/results/clientpositive/stats18.q.out
index 55c366f4c2..eb0d493a55 100644
--- a/ql/src/test/results/clientpositive/stats18.q.out
+++ b/ql/src/test/results/clientpositive/stats18.q.out
@@ -20,11 +20,13 @@ PREHOOK: query: -- Load a file into a existing partition
 -- Some other stats (numRows, rawDataSize) should be cleared
 desc formatted stats_part partition (ds='2010-04-08', hr='13')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@stats_part
 POSTHOOK: query: -- Load a file into a existing partition
 -- Some stats (numFiles, totalSize) should be updated correctly
 -- Some other stats (numRows, rawDataSize) should be cleared
 desc formatted stats_part partition (ds='2010-04-08', hr='13')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@stats_part
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 # col_name            	data_type           	comment             
@@ -75,8 +77,10 @@ POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).key SIMPLE [(src)sr
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: desc formatted stats_part partition (ds='2010-04-08', hr='13')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@stats_part
 POSTHOOK: query: desc formatted stats_part partition (ds='2010-04-08', hr='13')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@stats_part
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 # col_name            	data_type           	comment             
diff --git a/ql/src/test/results/clientpositive/stats19.q.out b/ql/src/test/results/clientpositive/stats19.q.out
index d60718384a..413ca69348 100644
--- a/ql/src/test/results/clientpositive/stats19.q.out
+++ b/ql/src/test/results/clientpositive/stats19.q.out
@@ -89,8 +89,10 @@ POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).key SIMPLE [(src)sr
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: desc formatted stats_part partition (ds='2010-04-08', hr = '13')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@stats_part
 POSTHOOK: query: desc formatted stats_part partition (ds='2010-04-08', hr = '13')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@stats_part
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -157,8 +159,10 @@ POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).key SIMPLE [(src)sr
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: desc formatted stats_part partition (ds='2010-04-08', hr = '13')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@stats_part
 POSTHOOK: query: desc formatted stats_part partition (ds='2010-04-08', hr = '13')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@stats_part
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -229,8 +233,10 @@ POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).key SIMPLE [(src)sr
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: desc formatted stats_part partition (ds='2010-04-08', hr = '13')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@stats_part
 POSTHOOK: query: desc formatted stats_part partition (ds='2010-04-08', hr = '13')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@stats_part
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -405,8 +411,10 @@ POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).key SIMPLE [(src)sr
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: desc formatted stats_part partition (ds='2010-04-08', hr = '13')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@stats_part
 POSTHOOK: query: desc formatted stats_part partition (ds='2010-04-08', hr = '13')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@stats_part
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -497,8 +505,10 @@ POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).key SIMPLE [(src)sr
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: desc formatted stats_part partition (ds='2010-04-08', hr = '13')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@stats_part
 POSTHOOK: query: desc formatted stats_part partition (ds='2010-04-08', hr = '13')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@stats_part
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -593,8 +603,10 @@ POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).key SIMPLE [(src)sr
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: desc formatted stats_part partition (ds='2010-04-08', hr = '13')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@stats_part
 POSTHOOK: query: desc formatted stats_part partition (ds='2010-04-08', hr = '13')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@stats_part
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_part PARTITION(ds=2010-04-08,hr=13).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/stats2.q.out b/ql/src/test/results/clientpositive/stats2.q.out
index fb97e114e1..65e4020f6d 100644
--- a/ql/src/test/results/clientpositive/stats2.q.out
+++ b/ql/src/test/results/clientpositive/stats2.q.out
@@ -86,8 +86,10 @@ POSTHOOK: Lineage: analyze_t1 PARTITION(ds=2008-04-09,hr=12).key SIMPLE [(srcpar
 POSTHOOK: Lineage: analyze_t1 PARTITION(ds=2008-04-09,hr=12).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: desc formatted analyze_t1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@analyze_t1
 POSTHOOK: query: desc formatted analyze_t1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@analyze_t1
 POSTHOOK: Lineage: analyze_t1 PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_t1 PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_t1 PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -188,8 +190,10 @@ POSTHOOK: Lineage: analyze_t1 PARTITION(ds=2008-04-09,hr=12).key SIMPLE [(srcpar
 POSTHOOK: Lineage: analyze_t1 PARTITION(ds=2008-04-09,hr=12).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: describe formatted analyze_t1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@analyze_t1
 POSTHOOK: query: describe formatted analyze_t1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@analyze_t1
 POSTHOOK: Lineage: analyze_t1 PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_t1 PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_t1 PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/stats20.q.out b/ql/src/test/results/clientpositive/stats20.q.out
index 407a8ab3cb..cd663669cb 100644
--- a/ql/src/test/results/clientpositive/stats20.q.out
+++ b/ql/src/test/results/clientpositive/stats20.q.out
@@ -20,9 +20,11 @@ POSTHOOK: Lineage: stats_partitioned PARTITION(ds=1).value SIMPLE [(src)src.Fiel
 PREHOOK: query: -- rawDataSize is 5312 after config is turned on
 describe formatted stats_partitioned
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@stats_partitioned
 POSTHOOK: query: -- rawDataSize is 5312 after config is turned on
 describe formatted stats_partitioned
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@stats_partitioned
 POSTHOOK: Lineage: stats_partitioned PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_partitioned PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 # col_name            	data_type           	comment             
@@ -72,9 +74,11 @@ POSTHOOK: Lineage: stats_partitioned PARTITION(ds=1).value SIMPLE [(src)src.Fiel
 PREHOOK: query: -- rawDataSize is 0 after config is turned off
 describe formatted stats_partitioned
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@stats_partitioned
 POSTHOOK: query: -- rawDataSize is 0 after config is turned off
 describe formatted stats_partitioned
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@stats_partitioned
 POSTHOOK: Lineage: stats_partitioned PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_partitioned PARTITION(ds=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_partitioned PARTITION(ds=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/stats3.q.out b/ql/src/test/results/clientpositive/stats3.q.out
index 26eb08c06c..c9cc6fbd51 100644
--- a/ql/src/test/results/clientpositive/stats3.q.out
+++ b/ql/src/test/results/clientpositive/stats3.q.out
@@ -70,8 +70,10 @@ POSTHOOK: type: LOAD
 POSTHOOK: Output: default@hive_test_src
 PREHOOK: query: desc formatted hive_test_src
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@hive_test_src
 POSTHOOK: query: desc formatted hive_test_src
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@hive_test_src
 # col_name            	data_type           	comment             
 	 	 
 col1                	string              	                    
@@ -219,8 +221,10 @@ POSTHOOK: Lineage: hive_test_dst PARTITION(pcol1=test_part,pcol2=test_Part).col1
 POSTHOOK: Lineage: hive_test_dst PARTITION(pcol1=test_part,pcol2=test_Part).col1 SIMPLE [(hive_test_src)hive_test_src.FieldSchema(name:col1, type:string, comment:null), ]
 PREHOOK: query: describe formatted hive_test_dst
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@hive_test_dst
 POSTHOOK: query: describe formatted hive_test_dst
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@hive_test_dst
 POSTHOOK: Lineage: hive_test_dst PARTITION(pcol1=test_part,pcol2=test_Part).col1 SIMPLE [(hive_test_src)hive_test_src.FieldSchema(name:col1, type:string, comment:null), ]
 POSTHOOK: Lineage: hive_test_dst PARTITION(pcol1=test_part,pcol2=test_Part).col1 SIMPLE [(hive_test_src)hive_test_src.FieldSchema(name:col1, type:string, comment:null), ]
 # col_name            	data_type           	comment             
diff --git a/ql/src/test/results/clientpositive/stats4.q.out b/ql/src/test/results/clientpositive/stats4.q.out
index a706cc4fbf..7662e16cec 100644
--- a/ql/src/test/results/clientpositive/stats4.q.out
+++ b/ql/src/test/results/clientpositive/stats4.q.out
@@ -1,7 +1,9 @@
 PREHOOK: query: show partitions srcpart
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: show partitions srcpart
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@srcpart
 ds=2008-04-08/hr=11
 ds=2008-04-08/hr=12
 ds=2008-04-09/hr=11
@@ -179,8 +181,10 @@ POSTHOOK: Lineage: nzhang_part2 PARTITION(ds=2008-12-31,hr=12).key SIMPLE [(srcp
 POSTHOOK: Lineage: nzhang_part2 PARTITION(ds=2008-12-31,hr=12).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: show partitions nzhang_part1
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@nzhang_part1
 POSTHOOK: query: show partitions nzhang_part1
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@nzhang_part1
 POSTHOOK: Lineage: nzhang_part1 PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: nzhang_part1 PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: nzhang_part1 PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -193,8 +197,10 @@ ds=2008-04-08/hr=11
 ds=2008-04-08/hr=12
 PREHOOK: query: show partitions nzhang_part2
 PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@nzhang_part2
 POSTHOOK: query: show partitions nzhang_part2
 POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@nzhang_part2
 POSTHOOK: Lineage: nzhang_part1 PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: nzhang_part1 PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: nzhang_part1 PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -2247,8 +2253,10 @@ POSTHOOK: Lineage: nzhang_part2 PARTITION(ds=2008-12-31,hr=12).value SIMPLE [(sr
 97	val_97	2008-12-31	12
 PREHOOK: query: describe formatted nzhang_part1 partition(ds='2008-04-08',hr=11)
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@nzhang_part1
 POSTHOOK: query: describe formatted nzhang_part1 partition(ds='2008-04-08',hr=11)
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@nzhang_part1
 POSTHOOK: Lineage: nzhang_part1 PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: nzhang_part1 PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: nzhang_part1 PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -2295,8 +2303,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: describe formatted nzhang_part1 partition(ds='2008-04-08',hr=12)
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@nzhang_part1
 POSTHOOK: query: describe formatted nzhang_part1 partition(ds='2008-04-08',hr=12)
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@nzhang_part1
 POSTHOOK: Lineage: nzhang_part1 PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: nzhang_part1 PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: nzhang_part1 PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -2343,8 +2353,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: describe formatted nzhang_part2 partition(ds='2008-12-31',hr=11)
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@nzhang_part2
 POSTHOOK: query: describe formatted nzhang_part2 partition(ds='2008-12-31',hr=11)
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@nzhang_part2
 POSTHOOK: Lineage: nzhang_part1 PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: nzhang_part1 PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: nzhang_part1 PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -2391,8 +2403,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: describe formatted nzhang_part2 partition(ds='2008-12-31',hr=12)
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@nzhang_part2
 POSTHOOK: query: describe formatted nzhang_part2 partition(ds='2008-12-31',hr=12)
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@nzhang_part2
 POSTHOOK: Lineage: nzhang_part1 PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: nzhang_part1 PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: nzhang_part1 PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -2439,8 +2453,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: describe formatted nzhang_part1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@nzhang_part1
 POSTHOOK: query: describe formatted nzhang_part1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@nzhang_part1
 POSTHOOK: Lineage: nzhang_part1 PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: nzhang_part1 PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: nzhang_part1 PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -2482,8 +2498,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: describe formatted nzhang_part2
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@nzhang_part2
 POSTHOOK: query: describe formatted nzhang_part2
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@nzhang_part2
 POSTHOOK: Lineage: nzhang_part1 PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: nzhang_part1 PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: nzhang_part1 PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/stats5.q.out b/ql/src/test/results/clientpositive/stats5.q.out
index ae754bdd5f..6e4820dc4a 100644
--- a/ql/src/test/results/clientpositive/stats5.q.out
+++ b/ql/src/test/results/clientpositive/stats5.q.out
@@ -34,8 +34,10 @@ POSTHOOK: Input: default@analyze_src
 POSTHOOK: Output: default@analyze_src
 PREHOOK: query: describe formatted analyze_src
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@analyze_src
 POSTHOOK: query: describe formatted analyze_src
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@analyze_src
 # col_name            	data_type           	comment             
 	 	 
 key                 	string              	                    
diff --git a/ql/src/test/results/clientpositive/stats6.q.out b/ql/src/test/results/clientpositive/stats6.q.out
index 70f016f027..466f5efc49 100644
--- a/ql/src/test/results/clientpositive/stats6.q.out
+++ b/ql/src/test/results/clientpositive/stats6.q.out
@@ -74,8 +74,10 @@ POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-09,hr=12).key SIMPLE [(s
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-09,hr=12).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: describe formatted analyze_srcpart PARTITION(ds='2008-04-08',hr=11)
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@analyze_srcpart
 POSTHOOK: query: describe formatted analyze_srcpart PARTITION(ds='2008-04-08',hr=11)
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@analyze_srcpart
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -122,8 +124,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: describe formatted analyze_srcpart PARTITION(ds='2008-04-08',hr=12)
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@analyze_srcpart
 POSTHOOK: query: describe formatted analyze_srcpart PARTITION(ds='2008-04-08',hr=12)
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@analyze_srcpart
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -170,8 +174,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: describe formatted analyze_srcpart PARTITION(ds='2008-04-09',hr=11)
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@analyze_srcpart
 POSTHOOK: query: describe formatted analyze_srcpart PARTITION(ds='2008-04-09',hr=11)
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@analyze_srcpart
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -218,8 +224,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: describe formatted analyze_srcpart PARTITION(ds='2008-04-09',hr=12)
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@analyze_srcpart
 POSTHOOK: query: describe formatted analyze_srcpart PARTITION(ds='2008-04-09',hr=12)
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@analyze_srcpart
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -266,8 +274,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: describe formatted analyze_srcpart
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@analyze_srcpart
 POSTHOOK: query: describe formatted analyze_srcpart
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@analyze_srcpart
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/stats7.q.out b/ql/src/test/results/clientpositive/stats7.q.out
index b0f4a62a02..a7f8829f93 100644
--- a/ql/src/test/results/clientpositive/stats7.q.out
+++ b/ql/src/test/results/clientpositive/stats7.q.out
@@ -85,8 +85,10 @@ POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-09,hr=12).key SIMPLE [(s
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-09,hr=12).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: describe formatted analyze_srcpart PARTITION(ds='2008-04-08',hr=11)
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@analyze_srcpart
 POSTHOOK: query: describe formatted analyze_srcpart PARTITION(ds='2008-04-08',hr=11)
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@analyze_srcpart
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -133,8 +135,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: describe formatted analyze_srcpart PARTITION(ds='2008-04-08',hr=12)
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@analyze_srcpart
 POSTHOOK: query: describe formatted analyze_srcpart PARTITION(ds='2008-04-08',hr=12)
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@analyze_srcpart
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -181,8 +185,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: describe formatted analyze_srcpart
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@analyze_srcpart
 POSTHOOK: query: describe formatted analyze_srcpart
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@analyze_srcpart
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/stats8.q.out b/ql/src/test/results/clientpositive/stats8.q.out
index 392f654db3..674f3bfa0e 100644
--- a/ql/src/test/results/clientpositive/stats8.q.out
+++ b/ql/src/test/results/clientpositive/stats8.q.out
@@ -81,8 +81,10 @@ POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-09,hr=12).key SIMPLE [(s
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-09,hr=12).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: describe formatted analyze_srcpart PARTITION(ds='2008-04-08',hr=11)
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@analyze_srcpart
 POSTHOOK: query: describe formatted analyze_srcpart PARTITION(ds='2008-04-08',hr=11)
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@analyze_srcpart
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -129,8 +131,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: describe formatted analyze_srcpart
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@analyze_srcpart
 POSTHOOK: query: describe formatted analyze_srcpart
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@analyze_srcpart
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -219,8 +223,10 @@ POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-09,hr=12).key SIMPLE [(s
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-09,hr=12).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: describe formatted analyze_srcpart PARTITION(ds='2008-04-08',hr=12)
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@analyze_srcpart
 POSTHOOK: query: describe formatted analyze_srcpart PARTITION(ds='2008-04-08',hr=12)
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@analyze_srcpart
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -314,8 +320,10 @@ POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-09,hr=12).key SIMPLE [(s
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-09,hr=12).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: describe formatted analyze_srcpart PARTITION(ds='2008-04-09',hr=11)
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@analyze_srcpart
 POSTHOOK: query: describe formatted analyze_srcpart PARTITION(ds='2008-04-09',hr=11)
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@analyze_srcpart
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -409,8 +417,10 @@ POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-09,hr=12).key SIMPLE [(s
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-09,hr=12).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: describe formatted analyze_srcpart PARTITION(ds='2008-04-09',hr=12)
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@analyze_srcpart
 POSTHOOK: query: describe formatted analyze_srcpart PARTITION(ds='2008-04-09',hr=12)
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@analyze_srcpart
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -516,8 +526,10 @@ POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-09,hr=12).key SIMPLE [(s
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-09,hr=12).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: describe formatted analyze_srcpart PARTITION(ds='2008-04-08',hr=11)
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@analyze_srcpart
 POSTHOOK: query: describe formatted analyze_srcpart PARTITION(ds='2008-04-08',hr=11)
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@analyze_srcpart
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -564,8 +576,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: describe formatted analyze_srcpart PARTITION(ds='2008-04-08',hr=12)
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@analyze_srcpart
 POSTHOOK: query: describe formatted analyze_srcpart PARTITION(ds='2008-04-08',hr=12)
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@analyze_srcpart
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -612,8 +626,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: describe formatted analyze_srcpart PARTITION(ds='2008-04-09',hr=11)
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@analyze_srcpart
 POSTHOOK: query: describe formatted analyze_srcpart PARTITION(ds='2008-04-09',hr=11)
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@analyze_srcpart
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -660,8 +676,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: describe formatted analyze_srcpart PARTITION(ds='2008-04-09',hr=12)
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@analyze_srcpart
 POSTHOOK: query: describe formatted analyze_srcpart PARTITION(ds='2008-04-09',hr=12)
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@analyze_srcpart
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -708,8 +726,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: describe formatted analyze_srcpart
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@analyze_srcpart
 POSTHOOK: query: describe formatted analyze_srcpart
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@analyze_srcpart
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/stats9.q.out b/ql/src/test/results/clientpositive/stats9.q.out
index 17411b17a0..7aebb7ceeb 100644
--- a/ql/src/test/results/clientpositive/stats9.q.out
+++ b/ql/src/test/results/clientpositive/stats9.q.out
@@ -48,8 +48,10 @@ POSTHOOK: Lineage: analyze_srcbucket.key SIMPLE [(srcbucket)srcbucket.FieldSchem
 POSTHOOK: Lineage: analyze_srcbucket.value SIMPLE [(srcbucket)srcbucket.FieldSchema(name:value, type:string, comment:null), ]
 PREHOOK: query: describe formatted analyze_srcbucket
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@analyze_srcbucket
 POSTHOOK: query: describe formatted analyze_srcbucket
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@analyze_srcbucket
 POSTHOOK: Lineage: analyze_srcbucket.key SIMPLE [(srcbucket)srcbucket.FieldSchema(name:key, type:int, comment:null), ]
 POSTHOOK: Lineage: analyze_srcbucket.value SIMPLE [(srcbucket)srcbucket.FieldSchema(name:value, type:string, comment:null), ]
 # col_name            	data_type           	comment             
diff --git a/ql/src/test/results/clientpositive/stats_counter.q.out b/ql/src/test/results/clientpositive/stats_counter.q.out
index 1fc8ecb02f..b1d5b8f0a4 100644
--- a/ql/src/test/results/clientpositive/stats_counter.q.out
+++ b/ql/src/test/results/clientpositive/stats_counter.q.out
@@ -17,8 +17,10 @@ POSTHOOK: Input: default@dummy1
 POSTHOOK: Output: default@dummy1
 PREHOOK: query: desc formatted dummy1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@dummy1
 POSTHOOK: query: desc formatted dummy1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@dummy1
 # col_name            	data_type           	comment             
 	 	 
 key                 	string              	                    
@@ -60,8 +62,10 @@ POSTHOOK: Input: default@src
 POSTHOOK: Output: default@dummy2
 PREHOOK: query: desc formatted dummy2
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@dummy2
 POSTHOOK: query: desc formatted dummy2
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@dummy2
 # col_name            	data_type           	comment             
 	 	 
 key                 	string              	                    
diff --git a/ql/src/test/results/clientpositive/stats_counter_partitioned.q.out b/ql/src/test/results/clientpositive/stats_counter_partitioned.q.out
index fb91636e15..29678522cb 100644
--- a/ql/src/test/results/clientpositive/stats_counter_partitioned.q.out
+++ b/ql/src/test/results/clientpositive/stats_counter_partitioned.q.out
@@ -45,8 +45,10 @@ POSTHOOK: Output: default@dummy@ds=2008/hr=11
 POSTHOOK: Output: default@dummy@ds=2008/hr=12
 PREHOOK: query: describe formatted dummy partition (ds='2008', hr='11')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@dummy
 POSTHOOK: query: describe formatted dummy partition (ds='2008', hr='11')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@dummy
 # col_name            	data_type           	comment             
 	 	 
 key                 	string              	                    
@@ -85,8 +87,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: describe formatted dummy partition (ds='2008', hr='12')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@dummy
 POSTHOOK: query: describe formatted dummy partition (ds='2008', hr='12')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@dummy
 # col_name            	data_type           	comment             
 	 	 
 key                 	string              	                    
@@ -166,8 +170,10 @@ POSTHOOK: Lineage: dummy PARTITION(ds=10,hr=12).key SIMPLE [(src)src.FieldSchema
 POSTHOOK: Lineage: dummy PARTITION(ds=10,hr=12).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: describe formatted dummy partition (ds='10', hr='11')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@dummy
 POSTHOOK: query: describe formatted dummy partition (ds='10', hr='11')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@dummy
 POSTHOOK: Lineage: dummy PARTITION(ds=10,hr=11).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: dummy PARTITION(ds=10,hr=11).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: dummy PARTITION(ds=10,hr=12).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -210,8 +216,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: describe formatted dummy partition (ds='10', hr='12')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@dummy
 POSTHOOK: query: describe formatted dummy partition (ds='10', hr='12')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@dummy
 POSTHOOK: Lineage: dummy PARTITION(ds=10,hr=11).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: dummy PARTITION(ds=10,hr=11).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: dummy PARTITION(ds=10,hr=12).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -323,8 +331,10 @@ POSTHOOK: Lineage: dummy PARTITION(hr=1997).key SIMPLE [(tbl)tbl.FieldSchema(nam
 POSTHOOK: Lineage: dummy PARTITION(hr=1998).key SIMPLE [(tbl)tbl.FieldSchema(name:key, type:int, comment:null), ]
 PREHOOK: query: describe formatted dummy partition (hr=1997)
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@dummy
 POSTHOOK: query: describe formatted dummy partition (hr=1997)
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@dummy
 POSTHOOK: Lineage: dummy PARTITION(ds=10,hr=11).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: dummy PARTITION(ds=10,hr=11).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: dummy PARTITION(ds=10,hr=12).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -369,8 +379,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: describe formatted dummy partition (hr=1994)
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@dummy
 POSTHOOK: query: describe formatted dummy partition (hr=1994)
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@dummy
 POSTHOOK: Lineage: dummy PARTITION(ds=10,hr=11).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: dummy PARTITION(ds=10,hr=11).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: dummy PARTITION(ds=10,hr=12).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -415,8 +427,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: describe formatted dummy partition (hr=1998)
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@dummy
 POSTHOOK: query: describe formatted dummy partition (hr=1998)
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@dummy
 POSTHOOK: Lineage: dummy PARTITION(ds=10,hr=11).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: dummy PARTITION(ds=10,hr=11).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: dummy PARTITION(ds=10,hr=12).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -461,8 +475,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: describe formatted dummy partition (hr=1996)
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@dummy
 POSTHOOK: query: describe formatted dummy partition (hr=1996)
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@dummy
 POSTHOOK: Lineage: dummy PARTITION(ds=10,hr=11).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: dummy PARTITION(ds=10,hr=11).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: dummy PARTITION(ds=10,hr=12).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/stats_empty_partition.q.out b/ql/src/test/results/clientpositive/stats_empty_partition.q.out
index 92eb35cf7a..e4ff708efa 100644
--- a/ql/src/test/results/clientpositive/stats_empty_partition.q.out
+++ b/ql/src/test/results/clientpositive/stats_empty_partition.q.out
@@ -23,8 +23,10 @@ POSTHOOK: Lineage: tmptable PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(n
 POSTHOOK: Lineage: tmptable PARTITION(part=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: describe formatted tmptable partition (part = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tmptable
 POSTHOOK: query: describe formatted tmptable partition (part = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tmptable
 POSTHOOK: Lineage: tmptable PARTITION(part=1).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: tmptable PARTITION(part=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 # col_name            	data_type           	comment             
diff --git a/ql/src/test/results/clientpositive/stats_invalidation.q.out b/ql/src/test/results/clientpositive/stats_invalidation.q.out
index 57545182b0..e4ce586927 100644
--- a/ql/src/test/results/clientpositive/stats_invalidation.q.out
+++ b/ql/src/test/results/clientpositive/stats_invalidation.q.out
@@ -29,8 +29,10 @@ POSTHOOK: Lineage: stats_invalid.key SIMPLE [(src)src.FieldSchema(name:key, type
 POSTHOOK: Lineage: stats_invalid.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: desc formatted stats_invalid
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@stats_invalid
 POSTHOOK: query: desc formatted stats_invalid
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@stats_invalid
 POSTHOOK: Lineage: stats_invalid.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_invalid.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 # col_name            	data_type           	comment             
@@ -75,8 +77,10 @@ POSTHOOK: Lineage: stats_invalid.key SIMPLE [(src)src.FieldSchema(name:key, type
 POSTHOOK: Lineage: stats_invalid.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: desc formatted stats_invalid
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@stats_invalid
 POSTHOOK: query: desc formatted stats_invalid
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@stats_invalid
 POSTHOOK: Lineage: stats_invalid.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: stats_invalid.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 # col_name            	data_type           	comment             
diff --git a/ql/src/test/results/clientpositive/stats_noscan_1.q.out b/ql/src/test/results/clientpositive/stats_noscan_1.q.out
index 5178993789..5304a7d993 100644
--- a/ql/src/test/results/clientpositive/stats_noscan_1.q.out
+++ b/ql/src/test/results/clientpositive/stats_noscan_1.q.out
@@ -102,9 +102,11 @@ POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-09,hr=12).value SIMPLE [
 PREHOOK: query: -- confirm result
 describe formatted analyze_srcpart PARTITION(ds='2008-04-08',hr=11)
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@analyze_srcpart
 POSTHOOK: query: -- confirm result
 describe formatted analyze_srcpart PARTITION(ds='2008-04-08',hr=11)
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@analyze_srcpart
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -151,8 +153,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: describe formatted analyze_srcpart PARTITION(ds='2008-04-08',hr=12)
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@analyze_srcpart
 POSTHOOK: query: describe formatted analyze_srcpart PARTITION(ds='2008-04-08',hr=12)
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@analyze_srcpart
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -199,8 +203,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: describe formatted analyze_srcpart PARTITION(ds='2008-04-09',hr=11)
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@analyze_srcpart
 POSTHOOK: query: describe formatted analyze_srcpart PARTITION(ds='2008-04-09',hr=11)
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@analyze_srcpart
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -247,8 +253,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: describe formatted analyze_srcpart PARTITION(ds='2008-04-09',hr=12)
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@analyze_srcpart
 POSTHOOK: query: describe formatted analyze_srcpart PARTITION(ds='2008-04-09',hr=12)
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@analyze_srcpart
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -295,8 +303,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: describe formatted analyze_srcpart
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@analyze_srcpart
 POSTHOOK: query: describe formatted analyze_srcpart
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@analyze_srcpart
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -468,9 +478,11 @@ POSTHOOK: Lineage: analyze_srcpart_partial PARTITION(ds=2008-04-09,hr=12).value
 PREHOOK: query: -- confirm result
 describe formatted analyze_srcpart_partial PARTITION(ds='2008-04-08',hr=11)
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@analyze_srcpart_partial
 POSTHOOK: query: -- confirm result
 describe formatted analyze_srcpart_partial PARTITION(ds='2008-04-08',hr=11)
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@analyze_srcpart_partial
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -525,8 +537,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: describe formatted analyze_srcpart_partial PARTITION(ds='2008-04-08',hr=12)
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@analyze_srcpart_partial
 POSTHOOK: query: describe formatted analyze_srcpart_partial PARTITION(ds='2008-04-08',hr=12)
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@analyze_srcpart_partial
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -581,8 +595,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: describe formatted analyze_srcpart_partial PARTITION(ds='2008-04-09',hr=11)
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@analyze_srcpart_partial
 POSTHOOK: query: describe formatted analyze_srcpart_partial PARTITION(ds='2008-04-09',hr=11)
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@analyze_srcpart_partial
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -637,8 +653,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: describe formatted analyze_srcpart_partial PARTITION(ds='2008-04-09',hr=12)
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@analyze_srcpart_partial
 POSTHOOK: query: describe formatted analyze_srcpart_partial PARTITION(ds='2008-04-09',hr=12)
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@analyze_srcpart_partial
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/stats_noscan_2.q.out b/ql/src/test/results/clientpositive/stats_noscan_2.q.out
index 2a8de2d2db..7b8821b360 100644
--- a/ql/src/test/results/clientpositive/stats_noscan_2.q.out
+++ b/ql/src/test/results/clientpositive/stats_noscan_2.q.out
@@ -35,8 +35,10 @@ POSTHOOK: Input: default@anaylyze_external
 POSTHOOK: Output: default@anaylyze_external
 PREHOOK: query: describe formatted anaylyze_external
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@anaylyze_external
 POSTHOOK: query: describe formatted anaylyze_external
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@anaylyze_external
 # col_name            	data_type           	comment             
 	 	 
 a                   	int                 	                    
@@ -77,8 +79,10 @@ POSTHOOK: Input: default@anaylyze_external
 POSTHOOK: Output: default@anaylyze_external
 PREHOOK: query: describe formatted anaylyze_external
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@anaylyze_external
 POSTHOOK: query: describe formatted anaylyze_external
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@anaylyze_external
 # col_name            	data_type           	comment             
 	 	 
 a                   	int                 	                    
@@ -215,8 +219,10 @@ POSTHOOK: Lineage: texternal PARTITION(insertdate=2008-01-01).key SIMPLE [(src)s
 POSTHOOK: Lineage: texternal PARTITION(insertdate=2008-01-01).val SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: describe formatted anaylyze_external PARTITION (insertdate='2008-01-01')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@anaylyze_external
 POSTHOOK: query: describe formatted anaylyze_external PARTITION (insertdate='2008-01-01')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@anaylyze_external
 POSTHOOK: Lineage: texternal PARTITION(insertdate=2008-01-01).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: texternal PARTITION(insertdate=2008-01-01).val SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 # col_name            	data_type           	comment             
@@ -270,8 +276,10 @@ POSTHOOK: Lineage: texternal PARTITION(insertdate=2008-01-01).key SIMPLE [(src)s
 POSTHOOK: Lineage: texternal PARTITION(insertdate=2008-01-01).val SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: describe formatted anaylyze_external PARTITION (insertdate='2008-01-01')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@anaylyze_external
 POSTHOOK: query: describe formatted anaylyze_external PARTITION (insertdate='2008-01-01')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@anaylyze_external
 POSTHOOK: Lineage: texternal PARTITION(insertdate=2008-01-01).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: texternal PARTITION(insertdate=2008-01-01).val SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 # col_name            	data_type           	comment             
diff --git a/ql/src/test/results/clientpositive/stats_only_null.q.out b/ql/src/test/results/clientpositive/stats_only_null.q.out
index 2413058b69..c9e6f3b122 100644
--- a/ql/src/test/results/clientpositive/stats_only_null.q.out
+++ b/ql/src/test/results/clientpositive/stats_only_null.q.out
@@ -269,8 +269,10 @@ POSTHOOK: Lineage: stats_null_part PARTITION(dt=2011).c SIMPLE [(temps_null)temp
 POSTHOOK: Lineage: stats_null_part PARTITION(dt=2011).d SIMPLE [(temps_null)temps_null.FieldSchema(name:d, type:smallint, comment:null), ]
 PREHOOK: query: describe formatted stats_null_part partition (dt='2010')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@stats_null_part
 POSTHOOK: query: describe formatted stats_null_part partition (dt='2010')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@stats_null_part
 POSTHOOK: Lineage: stats_null.a SIMPLE [(temps_null)temps_null.FieldSchema(name:a, type:double, comment:null), ]
 POSTHOOK: Lineage: stats_null.b SIMPLE [(temps_null)temps_null.FieldSchema(name:b, type:int, comment:null), ]
 POSTHOOK: Lineage: stats_null.c SIMPLE [(temps_null)temps_null.FieldSchema(name:c, type:string, comment:null), ]
@@ -322,8 +324,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: describe formatted stats_null_part partition (dt='2011')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@stats_null_part
 POSTHOOK: query: describe formatted stats_null_part partition (dt='2011')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@stats_null_part
 POSTHOOK: Lineage: stats_null.a SIMPLE [(temps_null)temps_null.FieldSchema(name:a, type:double, comment:null), ]
 POSTHOOK: Lineage: stats_null.b SIMPLE [(temps_null)temps_null.FieldSchema(name:b, type:int, comment:null), ]
 POSTHOOK: Lineage: stats_null.c SIMPLE [(temps_null)temps_null.FieldSchema(name:c, type:string, comment:null), ]
diff --git a/ql/src/test/results/clientpositive/stats_partscan_1.q.out b/ql/src/test/results/clientpositive/stats_partscan_1.q.out
index 03cc6f6b00..23064692dc 100644
--- a/ql/src/test/results/clientpositive/stats_partscan_1.q.out
+++ b/ql/src/test/results/clientpositive/stats_partscan_1.q.out
@@ -54,8 +54,10 @@ POSTHOOK: Lineage: analyze_srcpart_partial_scan PARTITION(ds=2008-04-09,hr=12).k
 POSTHOOK: Lineage: analyze_srcpart_partial_scan PARTITION(ds=2008-04-09,hr=12).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: describe formatted analyze_srcpart_partial_scan PARTITION(ds='2008-04-08',hr=11)
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@analyze_srcpart_partial_scan
 POSTHOOK: query: describe formatted analyze_srcpart_partial_scan PARTITION(ds='2008-04-08',hr=11)
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@analyze_srcpart_partial_scan
 POSTHOOK: Lineage: analyze_srcpart_partial_scan PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart_partial_scan PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart_partial_scan PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -150,9 +152,11 @@ POSTHOOK: Lineage: analyze_srcpart_partial_scan PARTITION(ds=2008-04-09,hr=12).v
 PREHOOK: query: -- 3. confirm result
 describe formatted analyze_srcpart_partial_scan PARTITION(ds='2008-04-08',hr=11)
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@analyze_srcpart_partial_scan
 POSTHOOK: query: -- 3. confirm result
 describe formatted analyze_srcpart_partial_scan PARTITION(ds='2008-04-08',hr=11)
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@analyze_srcpart_partial_scan
 POSTHOOK: Lineage: analyze_srcpart_partial_scan PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart_partial_scan PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart_partial_scan PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -199,8 +203,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: describe formatted analyze_srcpart_partial_scan PARTITION(ds='2008-04-09',hr=11)
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@analyze_srcpart_partial_scan
 POSTHOOK: query: describe formatted analyze_srcpart_partial_scan PARTITION(ds='2008-04-09',hr=11)
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@analyze_srcpart_partial_scan
 POSTHOOK: Lineage: analyze_srcpart_partial_scan PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart_partial_scan PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: analyze_srcpart_partial_scan PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/statsfs.q.out b/ql/src/test/results/clientpositive/statsfs.q.out
index 08a853ed5b..cb08ff03c8 100644
--- a/ql/src/test/results/clientpositive/statsfs.q.out
+++ b/ql/src/test/results/clientpositive/statsfs.q.out
@@ -45,8 +45,10 @@ POSTHOOK: Output: default@t1@ds=2010
 POSTHOOK: Output: default@t1@ds=2011
 PREHOOK: query: describe formatted t1 partition (ds='2010')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@t1
 POSTHOOK: query: describe formatted t1 partition (ds='2010')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@t1
 # col_name            	data_type           	comment             
 	 	 
 key                 	string              	                    
@@ -84,8 +86,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: describe formatted t1 partition (ds='2011')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@t1
 POSTHOOK: query: describe formatted t1 partition (ds='2011')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@t1
 # col_name            	data_type           	comment             
 	 	 
 key                 	string              	                    
@@ -164,8 +168,10 @@ POSTHOOK: Lineage: t1 PARTITION(ds=2011).key SIMPLE [(src)src.FieldSchema(name:k
 POSTHOOK: Lineage: t1 PARTITION(ds=2011).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: describe formatted t1 partition (ds='2010')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@t1
 POSTHOOK: query: describe formatted t1 partition (ds='2010')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@t1
 POSTHOOK: Lineage: t1 PARTITION(ds=2010).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: t1 PARTITION(ds=2010).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: t1 PARTITION(ds=2011).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -207,8 +213,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: describe formatted t1 partition (ds='2011')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@t1
 POSTHOOK: query: describe formatted t1 partition (ds='2011')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@t1
 POSTHOOK: Lineage: t1 PARTITION(ds=2010).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: t1 PARTITION(ds=2010).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: t1 PARTITION(ds=2011).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -301,8 +309,10 @@ POSTHOOK: Lineage: t1 PARTITION(ds=2011).key SIMPLE [(src)src.FieldSchema(name:k
 POSTHOOK: Lineage: t1 PARTITION(ds=2011).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: describe formatted t1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@t1
 POSTHOOK: query: describe formatted t1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@t1
 POSTHOOK: Lineage: t1 PARTITION(ds=2010).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: t1 PARTITION(ds=2010).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: t1 PARTITION(ds=2011).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -380,8 +390,10 @@ POSTHOOK: Lineage: t1 PARTITION(ds=2011).key SIMPLE [(src)src.FieldSchema(name:k
 POSTHOOK: Lineage: t1 PARTITION(ds=2011).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: describe formatted t1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@t1
 POSTHOOK: query: describe formatted t1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@t1
 POSTHOOK: Lineage: t1.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: t1.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: t1 PARTITION(ds=2010).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -486,8 +498,10 @@ POSTHOOK: Lineage: t1 PARTITION(ds=2011).key SIMPLE [(src)src.FieldSchema(name:k
 POSTHOOK: Lineage: t1 PARTITION(ds=2011).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: describe formatted t1 partition (ds='2008-04-08',hr='11')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@t1
 POSTHOOK: query: describe formatted t1 partition (ds='2008-04-08',hr='11')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@t1
 POSTHOOK: Lineage: t1.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: t1.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: t1 PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -540,8 +554,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: describe formatted t1 partition (ds='2008-04-09',hr='12')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@t1
 POSTHOOK: query: describe formatted t1 partition (ds='2008-04-09',hr='12')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@t1
 POSTHOOK: Lineage: t1.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: t1.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: t1 PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/tablename_with_select.q.out b/ql/src/test/results/clientpositive/tablename_with_select.q.out
index b5ff0b48e7..8409a48fcc 100644
--- a/ql/src/test/results/clientpositive/tablename_with_select.q.out
+++ b/ql/src/test/results/clientpositive/tablename_with_select.q.out
@@ -7,8 +7,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@tmp_select
 PREHOOK: query: DESCRIBE tmp_select
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tmp_select
 POSTHOOK: query: DESCRIBE tmp_select
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tmp_select
 a                   	int                 	                    
 b                   	string              	                    
 PREHOOK: query: INSERT OVERWRITE TABLE tmp_select SELECT key, value FROM src
diff --git a/ql/src/test/results/clientpositive/transform_ppr1.q.out b/ql/src/test/results/clientpositive/transform_ppr1.q.out
index cff9829e12..fb113565e5 100644
--- a/ql/src/test/results/clientpositive/transform_ppr1.q.out
+++ b/ql/src/test/results/clientpositive/transform_ppr1.q.out
@@ -143,7 +143,7 @@ STAGE PLANS:
               ds 2008-04-08
               hr 11
             properties:
-              COLUMN_STATS_ACCURATE true
+              COLUMN_STATS_ACCURATE false
               bucket_count -1
               columns key,value
               columns.comments default default
@@ -151,10 +151,10 @@ STAGE PLANS:
 #### A masked pattern was here ####
               name default.srcpart
               numFiles 1
-              numRows 0
+              numRows -1
               partition_columns ds/hr
               partition_columns.types string:string
-              rawDataSize 0
+              rawDataSize -1
               serialization.ddl struct srcpart { string key, string value}
               serialization.format 1
               serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -189,7 +189,7 @@ STAGE PLANS:
               ds 2008-04-08
               hr 12
             properties:
-              COLUMN_STATS_ACCURATE true
+              COLUMN_STATS_ACCURATE false
               bucket_count -1
               columns key,value
               columns.comments default default
@@ -197,10 +197,10 @@ STAGE PLANS:
 #### A masked pattern was here ####
               name default.srcpart
               numFiles 1
-              numRows 0
+              numRows -1
               partition_columns ds/hr
               partition_columns.types string:string
-              rawDataSize 0
+              rawDataSize -1
               serialization.ddl struct srcpart { string key, string value}
               serialization.format 1
               serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -235,7 +235,7 @@ STAGE PLANS:
               ds 2008-04-09
               hr 11
             properties:
-              COLUMN_STATS_ACCURATE true
+              COLUMN_STATS_ACCURATE false
               bucket_count -1
               columns key,value
               columns.comments default default
@@ -243,10 +243,10 @@ STAGE PLANS:
 #### A masked pattern was here ####
               name default.srcpart
               numFiles 1
-              numRows 0
+              numRows -1
               partition_columns ds/hr
               partition_columns.types string:string
-              rawDataSize 0
+              rawDataSize -1
               serialization.ddl struct srcpart { string key, string value}
               serialization.format 1
               serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -281,7 +281,7 @@ STAGE PLANS:
               ds 2008-04-09
               hr 12
             properties:
-              COLUMN_STATS_ACCURATE true
+              COLUMN_STATS_ACCURATE false
               bucket_count -1
               columns key,value
               columns.comments default default
@@ -289,10 +289,10 @@ STAGE PLANS:
 #### A masked pattern was here ####
               name default.srcpart
               numFiles 1
-              numRows 0
+              numRows -1
               partition_columns ds/hr
               partition_columns.types string:string
-              rawDataSize 0
+              rawDataSize -1
               serialization.ddl struct srcpart { string key, string value}
               serialization.format 1
               serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/transform_ppr2.q.out b/ql/src/test/results/clientpositive/transform_ppr2.q.out
index 065ca2ec9e..54948b6576 100644
--- a/ql/src/test/results/clientpositive/transform_ppr2.q.out
+++ b/ql/src/test/results/clientpositive/transform_ppr2.q.out
@@ -145,7 +145,7 @@ STAGE PLANS:
               ds 2008-04-08
               hr 11
             properties:
-              COLUMN_STATS_ACCURATE true
+              COLUMN_STATS_ACCURATE false
               bucket_count -1
               columns key,value
               columns.comments default default
@@ -153,10 +153,10 @@ STAGE PLANS:
 #### A masked pattern was here ####
               name default.srcpart
               numFiles 1
-              numRows 0
+              numRows -1
               partition_columns ds/hr
               partition_columns.types string:string
-              rawDataSize 0
+              rawDataSize -1
               serialization.ddl struct srcpart { string key, string value}
               serialization.format 1
               serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -191,7 +191,7 @@ STAGE PLANS:
               ds 2008-04-08
               hr 12
             properties:
-              COLUMN_STATS_ACCURATE true
+              COLUMN_STATS_ACCURATE false
               bucket_count -1
               columns key,value
               columns.comments default default
@@ -199,10 +199,10 @@ STAGE PLANS:
 #### A masked pattern was here ####
               name default.srcpart
               numFiles 1
-              numRows 0
+              numRows -1
               partition_columns ds/hr
               partition_columns.types string:string
-              rawDataSize 0
+              rawDataSize -1
               serialization.ddl struct srcpart { string key, string value}
               serialization.format 1
               serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/truncate_column.q.out b/ql/src/test/results/clientpositive/truncate_column.q.out
index 88b2b49b93..53672b38e9 100644
--- a/ql/src/test/results/clientpositive/truncate_column.q.out
+++ b/ql/src/test/results/clientpositive/truncate_column.q.out
@@ -23,8 +23,10 @@ POSTHOOK: Lineage: test_tab.key SIMPLE [(src)src.FieldSchema(name:key, type:stri
 POSTHOOK: Lineage: test_tab.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESC FORMATTED test_tab
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_tab
 POSTHOOK: query: DESC FORMATTED test_tab
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_tab
 POSTHOOK: Lineage: test_tab.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_tab.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 # col_name            	data_type           	comment             
@@ -91,8 +93,10 @@ POSTHOOK: Lineage: test_tab.key SIMPLE [(src)src.FieldSchema(name:key, type:stri
 POSTHOOK: Lineage: test_tab.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESC FORMATTED test_tab
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_tab
 POSTHOOK: query: DESC FORMATTED test_tab
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_tab
 POSTHOOK: Lineage: test_tab.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_tab.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 # col_name            	data_type           	comment             
@@ -175,8 +179,10 @@ POSTHOOK: Lineage: test_tab.value SIMPLE [(src)src.FieldSchema(name:value, type:
 POSTHOOK: Lineage: test_tab.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESC FORMATTED test_tab
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_tab
 POSTHOOK: query: DESC FORMATTED test_tab
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_tab
 POSTHOOK: Lineage: test_tab.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_tab.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_tab.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
@@ -251,8 +257,10 @@ POSTHOOK: Lineage: test_tab.value SIMPLE [(src)src.FieldSchema(name:value, type:
 POSTHOOK: Lineage: test_tab.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESC FORMATTED test_tab
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_tab
 POSTHOOK: query: DESC FORMATTED test_tab
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_tab
 POSTHOOK: Lineage: test_tab.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_tab.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_tab.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
@@ -341,8 +349,10 @@ POSTHOOK: Lineage: test_tab.value SIMPLE [(src)src.FieldSchema(name:value, type:
 POSTHOOK: Lineage: test_tab.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESC FORMATTED test_tab
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_tab
 POSTHOOK: query: DESC FORMATTED test_tab
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_tab
 POSTHOOK: Lineage: test_tab.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_tab.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_tab.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -422,8 +432,10 @@ POSTHOOK: Lineage: test_tab.value SIMPLE [(src)src.FieldSchema(name:value, type:
 POSTHOOK: Lineage: test_tab.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESC FORMATTED test_tab
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_tab
 POSTHOOK: query: DESC FORMATTED test_tab
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_tab
 POSTHOOK: Lineage: test_tab.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_tab.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_tab.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -505,8 +517,10 @@ POSTHOOK: Lineage: test_tab.value SIMPLE [(src)src.FieldSchema(name:value, type:
 POSTHOOK: Lineage: test_tab.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESC FORMATTED test_tab
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_tab
 POSTHOOK: query: DESC FORMATTED test_tab
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_tab
 POSTHOOK: Lineage: test_tab.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_tab.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_tab.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -603,8 +617,10 @@ POSTHOOK: Lineage: test_tab_part PARTITION(part=1).key SIMPLE [(src)src.FieldSch
 POSTHOOK: Lineage: test_tab_part PARTITION(part=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESC FORMATTED test_tab_part PARTITION (part = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_tab_part
 POSTHOOK: query: DESC FORMATTED test_tab_part PARTITION (part = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_tab_part
 POSTHOOK: Lineage: test_tab.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_tab.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_tab.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -694,8 +710,10 @@ POSTHOOK: Lineage: test_tab_part PARTITION(part=1).key SIMPLE [(src)src.FieldSch
 POSTHOOK: Lineage: test_tab_part PARTITION(part=1).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: DESC FORMATTED test_tab_part PARTITION (part = '1')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@test_tab_part
 POSTHOOK: query: DESC FORMATTED test_tab_part PARTITION (part = '1')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@test_tab_part
 POSTHOOK: Lineage: test_tab.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_tab.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: test_tab.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/unicode_notation.q.out b/ql/src/test/results/clientpositive/unicode_notation.q.out
index 221e2559ed..ba167414fa 100644
--- a/ql/src/test/results/clientpositive/unicode_notation.q.out
+++ b/ql/src/test/results/clientpositive/unicode_notation.q.out
@@ -11,8 +11,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@k1
 PREHOOK: query: desc formatted k1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@k1
 POSTHOOK: query: desc formatted k1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@k1
 # col_name            	data_type           	comment             
 	 	 
 a                   	string              	                    
@@ -55,8 +57,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@k1
 PREHOOK: query: desc formatted k1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@k1
 POSTHOOK: query: desc formatted k1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@k1
 # col_name            	data_type           	comment             
 	 	 
 a                   	string              	                    
@@ -99,8 +103,10 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@k1
 PREHOOK: query: desc formatted k1
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@k1
 POSTHOOK: query: desc formatted k1
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@k1
 # col_name            	data_type           	comment             
 	 	 
 a                   	string              	                    
diff --git a/ql/src/test/results/clientpositive/union_ppr.q.out b/ql/src/test/results/clientpositive/union_ppr.q.out
index 71df8bfa70..63e37fd71c 100644
--- a/ql/src/test/results/clientpositive/union_ppr.q.out
+++ b/ql/src/test/results/clientpositive/union_ppr.q.out
@@ -172,7 +172,7 @@ STAGE PLANS:
               ds 2008-04-08
               hr 11
             properties:
-              COLUMN_STATS_ACCURATE true
+              COLUMN_STATS_ACCURATE false
               bucket_count -1
               columns key,value
               columns.comments default default
@@ -180,10 +180,10 @@ STAGE PLANS:
 #### A masked pattern was here ####
               name default.srcpart
               numFiles 1
-              numRows 0
+              numRows -1
               partition_columns ds/hr
               partition_columns.types string:string
-              rawDataSize 0
+              rawDataSize -1
               serialization.ddl struct srcpart { string key, string value}
               serialization.format 1
               serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
@@ -218,7 +218,7 @@ STAGE PLANS:
               ds 2008-04-08
               hr 12
             properties:
-              COLUMN_STATS_ACCURATE true
+              COLUMN_STATS_ACCURATE false
               bucket_count -1
               columns key,value
               columns.comments default default
@@ -226,10 +226,10 @@ STAGE PLANS:
 #### A masked pattern was here ####
               name default.srcpart
               numFiles 1
-              numRows 0
+              numRows -1
               partition_columns ds/hr
               partition_columns.types string:string
-              rawDataSize 0
+              rawDataSize -1
               serialization.ddl struct srcpart { string key, string value}
               serialization.format 1
               serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
diff --git a/ql/src/test/results/clientpositive/updateAccessTime.q.out b/ql/src/test/results/clientpositive/updateAccessTime.q.out
index 72a9f251b8..836ab1760f 100644
--- a/ql/src/test/results/clientpositive/updateAccessTime.q.out
+++ b/ql/src/test/results/clientpositive/updateAccessTime.q.out
@@ -11,8 +11,10 @@ POSTHOOK: Input: default@src
 POSTHOOK: Output: default@tstsrc
 PREHOOK: query: desc extended tstsrc
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tstsrc
 POSTHOOK: query: desc extended tstsrc
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tstsrc
 key                 	string              	                    
 value               	string              	                    
 	 	 
@@ -28,8 +30,10 @@ POSTHOOK: Input: default@tstsrc
 500
 PREHOOK: query: desc extended tstsrc
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tstsrc
 POSTHOOK: query: desc extended tstsrc
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tstsrc
 key                 	string              	                    
 value               	string              	                    
 	 	 
@@ -82,8 +86,10 @@ POSTHOOK: Lineage: tstsrcpart PARTITION(ds=2008-04-09,hr=12).key SIMPLE [(srcpar
 POSTHOOK: Lineage: tstsrcpart PARTITION(ds=2008-04-09,hr=12).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: desc extended tstsrcpart
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tstsrcpart
 POSTHOOK: query: desc extended tstsrcpart
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tstsrcpart
 POSTHOOK: Lineage: tstsrcpart PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: tstsrcpart PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: tstsrcpart PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -106,8 +112,10 @@ hr                  	string
 #### A masked pattern was here ####
 PREHOOK: query: desc extended tstsrcpart partition (ds='2008-04-08', hr='11')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tstsrcpart
 POSTHOOK: query: desc extended tstsrcpart partition (ds='2008-04-08', hr='11')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tstsrcpart
 POSTHOOK: Lineage: tstsrcpart PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: tstsrcpart PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: tstsrcpart PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -130,8 +138,10 @@ hr                  	string
 #### A masked pattern was here ####
 PREHOOK: query: desc extended tstsrcpart partition (ds='2008-04-08', hr='12')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tstsrcpart
 POSTHOOK: query: desc extended tstsrcpart partition (ds='2008-04-08', hr='12')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tstsrcpart
 POSTHOOK: Lineage: tstsrcpart PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: tstsrcpart PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: tstsrcpart PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -173,8 +183,10 @@ POSTHOOK: Lineage: tstsrcpart PARTITION(ds=2008-04-09,hr=12).value SIMPLE [(srcp
 500
 PREHOOK: query: desc extended tstsrcpart
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tstsrcpart
 POSTHOOK: query: desc extended tstsrcpart
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tstsrcpart
 POSTHOOK: Lineage: tstsrcpart PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: tstsrcpart PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: tstsrcpart PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -197,8 +209,10 @@ hr                  	string
 #### A masked pattern was here ####
 PREHOOK: query: desc extended tstsrcpart partition (ds='2008-04-08', hr='11')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tstsrcpart
 POSTHOOK: query: desc extended tstsrcpart partition (ds='2008-04-08', hr='11')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tstsrcpart
 POSTHOOK: Lineage: tstsrcpart PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: tstsrcpart PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: tstsrcpart PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
@@ -221,8 +235,10 @@ hr                  	string
 #### A masked pattern was here ####
 PREHOOK: query: desc extended tstsrcpart partition (ds='2008-04-08', hr='12')
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@tstsrcpart
 POSTHOOK: query: desc extended tstsrcpart partition (ds='2008-04-08', hr='12')
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@tstsrcpart
 POSTHOOK: Lineage: tstsrcpart PARTITION(ds=2008-04-08,hr=11).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: tstsrcpart PARTITION(ds=2008-04-08,hr=11).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: tstsrcpart PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(srcpart)srcpart.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/varchar_nested_types.q.out b/ql/src/test/results/clientpositive/varchar_nested_types.q.out
index f74f32d82a..7bc5a7fe5f 100644
--- a/ql/src/test/results/clientpositive/varchar_nested_types.q.out
+++ b/ql/src/test/results/clientpositive/varchar_nested_types.q.out
@@ -67,8 +67,10 @@ POSTHOOK: Lineage: varchar_nested_1.value EXPRESSION [(src)src.FieldSchema(name:
 POSTHOOK: Lineage: varchar_nested_array.c1 EXPRESSION [(varchar_nested_1)varchar_nested_1.FieldSchema(name:value, type:varchar(20), comment:null), ]
 PREHOOK: query: describe varchar_nested_array
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@varchar_nested_array
 POSTHOOK: query: describe varchar_nested_array
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@varchar_nested_array
 POSTHOOK: Lineage: varchar_nested_1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: varchar_nested_1.value EXPRESSION [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: varchar_nested_array.c1 EXPRESSION [(varchar_nested_1)varchar_nested_1.FieldSchema(name:value, type:varchar(20), comment:null), ]
@@ -113,8 +115,10 @@ POSTHOOK: Lineage: varchar_nested_array.c1 EXPRESSION [(varchar_nested_1)varchar
 POSTHOOK: Lineage: varchar_nested_map.c1 EXPRESSION [(varchar_nested_1)varchar_nested_1.FieldSchema(name:key, type:int, comment:null), (varchar_nested_1)varchar_nested_1.FieldSchema(name:value, type:varchar(20), comment:null), ]
 PREHOOK: query: describe varchar_nested_map
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@varchar_nested_map
 POSTHOOK: query: describe varchar_nested_map
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@varchar_nested_map
 POSTHOOK: Lineage: varchar_nested_1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: varchar_nested_1.value EXPRESSION [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: varchar_nested_array.c1 EXPRESSION [(varchar_nested_1)varchar_nested_1.FieldSchema(name:value, type:varchar(20), comment:null), ]
@@ -169,8 +173,10 @@ POSTHOOK: Lineage: varchar_nested_map.c1 EXPRESSION [(varchar_nested_1)varchar_n
 POSTHOOK: Lineage: varchar_nested_struct.c1 EXPRESSION [(varchar_nested_1)varchar_nested_1.FieldSchema(name:key, type:int, comment:null), (varchar_nested_1)varchar_nested_1.FieldSchema(name:value, type:varchar(20), comment:null), ]
 PREHOOK: query: describe varchar_nested_struct
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@varchar_nested_struct
 POSTHOOK: query: describe varchar_nested_struct
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@varchar_nested_struct
 POSTHOOK: Lineage: varchar_nested_1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: varchar_nested_1.value EXPRESSION [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: varchar_nested_array.c1 EXPRESSION [(varchar_nested_1)varchar_nested_1.FieldSchema(name:value, type:varchar(20), comment:null), ]
@@ -209,8 +215,10 @@ POSTHOOK: Lineage: varchar_nested_map.c1 EXPRESSION [(varchar_nested_1)varchar_n
 POSTHOOK: Lineage: varchar_nested_struct.c1 EXPRESSION [(varchar_nested_1)varchar_nested_1.FieldSchema(name:key, type:int, comment:null), (varchar_nested_1)varchar_nested_1.FieldSchema(name:value, type:varchar(20), comment:null), ]
 PREHOOK: query: describe varchar_nested_cta
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@varchar_nested_cta
 POSTHOOK: query: describe varchar_nested_cta
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@varchar_nested_cta
 POSTHOOK: Lineage: varchar_nested_1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: varchar_nested_1.value EXPRESSION [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: varchar_nested_array.c1 EXPRESSION [(varchar_nested_1)varchar_nested_1.FieldSchema(name:value, type:varchar(20), comment:null), ]
@@ -249,8 +257,10 @@ POSTHOOK: Lineage: varchar_nested_map.c1 EXPRESSION [(varchar_nested_1)varchar_n
 POSTHOOK: Lineage: varchar_nested_struct.c1 EXPRESSION [(varchar_nested_1)varchar_nested_1.FieldSchema(name:key, type:int, comment:null), (varchar_nested_1)varchar_nested_1.FieldSchema(name:value, type:varchar(20), comment:null), ]
 PREHOOK: query: describe varchar_nested_view
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@varchar_nested_view
 POSTHOOK: query: describe varchar_nested_view
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@varchar_nested_view
 POSTHOOK: Lineage: varchar_nested_1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: varchar_nested_1.value EXPRESSION [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: varchar_nested_array.c1 EXPRESSION [(varchar_nested_1)varchar_nested_1.FieldSchema(name:value, type:varchar(20), comment:null), ]
diff --git a/ql/src/test/results/clientpositive/vectorized_rcfile_columnar.q.out b/ql/src/test/results/clientpositive/vectorized_rcfile_columnar.q.out
index f432af0a6c..b44c296ec2 100644
--- a/ql/src/test/results/clientpositive/vectorized_rcfile_columnar.q.out
+++ b/ql/src/test/results/clientpositive/vectorized_rcfile_columnar.q.out
@@ -35,8 +35,10 @@ POSTHOOK: Lineage: columntable.key SIMPLE [(src)src.FieldSchema(name:key, type:s
 POSTHOOK: Lineage: columntable.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: describe columnTable
 PREHOOK: type: DESCTABLE
+PREHOOK: Input: default@columntable
 POSTHOOK: query: describe columnTable
 POSTHOOK: type: DESCTABLE
+POSTHOOK: Input: default@columntable
 POSTHOOK: Lineage: columntable.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: columntable.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 key                 	string              	                    
