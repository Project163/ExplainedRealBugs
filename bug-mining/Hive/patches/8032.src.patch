diff --git a/ql/src/java/org/apache/hadoop/hive/ql/QueryState.java b/ql/src/java/org/apache/hadoop/hive/ql/QueryState.java
index b2da5fba24..5edebcafe3 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/QueryState.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/QueryState.java
@@ -20,6 +20,8 @@
 
 import java.util.HashMap;
 import java.util.Map;
+import java.util.concurrent.locks.ReentrantLock;
+
 import org.apache.hadoop.hive.conf.HiveConf;
 import org.apache.hadoop.hive.ql.lockmgr.HiveTxnManager;
 import org.apache.hadoop.hive.ql.plan.HiveOperation;
@@ -65,6 +67,11 @@ public class QueryState {
    */
   private final Map<String, Object> resourceMap = new HashMap<>();
 
+  /**
+   * query level lock for ConditionalTask#resolveTask.
+   */
+  private final ReentrantLock resolveConditionalTaskLock = new ReentrantLock(true);
+
   /**
    * Private constructor, use QueryState.Builder instead.
    * @param conf The query specific configuration object
@@ -155,6 +162,10 @@ public Object getResource(String resourceIdentifier) {
     return resourceMap.get(resourceIdentifier);
   }
 
+  public ReentrantLock getResolveConditionalTaskLock() {
+    return resolveConditionalTaskLock;
+  }
+
   /**
    * Generating the new QueryState object. Making sure, that the new queryId is generated.
    * @param conf The HiveConf which should be used
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/ConditionalTask.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/ConditionalTask.java
index 90e552f3fe..eb40d76732 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/ConditionalTask.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/ConditionalTask.java
@@ -20,11 +20,13 @@
 
 import java.io.Serializable;
 import java.util.List;
+import java.util.concurrent.locks.ReentrantLock;
 
 import org.apache.hadoop.hive.ql.metadata.HiveException;
 import org.apache.hadoop.hive.ql.plan.ConditionalResolver;
 import org.apache.hadoop.hive.ql.plan.ConditionalWork;
 import org.apache.hadoop.hive.ql.plan.api.StageType;
+import org.apache.hadoop.hive.ql.session.SessionState;
 
 /**
  * Conditional Task implementation.
@@ -78,11 +80,15 @@ public int execute() {
     resTasks = resolver.getTasks(conf, resolverCtx);
     resolved = true;
 
+    ReentrantLock resolveTaskLock = queryState.getResolveConditionalTaskLock();
     try {
+      resolveTaskLock.lock();
       resolveTask();
     } catch (Exception e) {
       setException(e);
       return 1;
+    } finally {
+      resolveTaskLock.unlock();
     }
     return 0;
   }
