diff --git a/ql/src/java/org/apache/hadoop/hive/ql/Driver.java b/ql/src/java/org/apache/hadoop/hive/ql/Driver.java
index c4517fa15e..e5c48fdc95 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/Driver.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/Driver.java
@@ -497,38 +497,44 @@ private void runInternal(String command, boolean alreadyCompiled) throws Command
         HiveConf.ConfVars.HIVE_TXN_MAX_RETRYSNAPSHOT_COUNT);
 
       try {
-        while (!driverTxnHandler.isValidTxnListState() && ++retryShapshotCnt <= maxRetrySnapshotCnt) {
-          LOG.info("Re-compiling after acquiring locks, attempt #" + retryShapshotCnt);
-          // Snapshot was outdated when locks were acquired, hence regenerate context, txn list and retry.
-          // TODO: Lock acquisition should be moved before analyze, this is a bit hackish.
-          // Currently, we acquire a snapshot, compile the query with that snapshot, and then - acquire locks.
-          // If snapshot is still valid, we continue as usual.
-          // But if snapshot is not valid, we recompile the query.
-          if (driverContext.isOutdatedTxn()) {
-            LOG.info("Snapshot is outdated, re-initiating transaction ...");
-            driverContext.getTxnManager().rollbackTxn();
-
-            String userFromUGI = DriverUtils.getUserFromUGI(driverContext);
-            driverContext.getTxnManager().openTxn(context, userFromUGI, driverContext.getTxnType());
-            lockAndRespond();
+        do {
+          driverContext.setOutdatedTxn(false);
+          // Inserts will not invalidate the snapshot, that could cause duplicates.
+          if (!driverTxnHandler.isValidTxnListState()) {
+            LOG.info("Re-compiling after acquiring locks, attempt #" + retryShapshotCnt);
+            // Snapshot was outdated when locks were acquired, hence regenerate context, txn list and retry.
+            // TODO: Lock acquisition should be moved before analyze, this is a bit hackish.
+            // Currently, we acquire a snapshot, compile the query with that snapshot, and then - acquire locks.
+            // If snapshot is still valid, we continue as usual.
+            // But if snapshot is not valid, we recompile the query.
+            if (driverContext.isOutdatedTxn()) {
+              // Later transaction invalidated the snapshot, a new transaction is required
+              LOG.info("Snapshot is outdated, re-initiating transaction ...");
+              driverContext.getTxnManager().rollbackTxn();
+
+              String userFromUGI = DriverUtils.getUserFromUGI(driverContext);
+              driverContext.getTxnManager().openTxn(context, userFromUGI, driverContext.getTxnType());
+              lockAndRespond();
+            }
+            driverContext.setRetrial(true);
+            driverContext.getBackupContext().addSubContext(context);
+            driverContext.getBackupContext().setHiveLocks(context.getHiveLocks());
+            context = driverContext.getBackupContext();
+
+            driverContext.getConf().set(ValidTxnList.VALID_TXNS_KEY,
+              driverContext.getTxnManager().getValidTxns().toString());
+
+            if (driverContext.getPlan().hasAcidResourcesInQuery()) {
+              compileInternal(context.getCmd(), true);
+              driverTxnHandler.recordValidWriteIds();
+              driverTxnHandler.setWriteIdForAcidFileSinks();
+            }
+            // Since we're reusing the compiled plan, we need to update its start time for current run
+            driverContext.getPlan().setQueryStartTime(driverContext.getQueryDisplay().getQueryStartTime());
           }
-
-          driverContext.setRetrial(true);
-          driverContext.getBackupContext().addSubContext(context);
-          driverContext.getBackupContext().setHiveLocks(context.getHiveLocks());
-          context = driverContext.getBackupContext();
-
-          driverContext.getConf().set(ValidTxnList.VALID_TXNS_KEY,
-            driverContext.getTxnManager().getValidTxns().toString());
-
-          if (driverContext.getPlan().hasAcidResourcesInQuery()) {
-            compileInternal(context.getCmd(), true);
-            driverTxnHandler.recordValidWriteIds();
-            driverTxnHandler.setWriteIdForAcidFileSinks();
-          }
-          // Since we're reusing the compiled plan, we need to update its start time for current run
-          driverContext.getPlan().setQueryStartTime(driverContext.getQueryDisplay().getQueryStartTime());
-        }
+          // Re-check snapshot only in case we had to release locks and open a new transaction,
+          // otherwise exclusive locks should protect output tables/partitions in snapshot from concurrent writes.
+        } while (driverContext.isOutdatedTxn() && ++retryShapshotCnt <= maxRetrySnapshotCnt);
 
         if (retryShapshotCnt > maxRetrySnapshotCnt) {
           // Throw exception
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/DriverTxnHandler.java b/ql/src/java/org/apache/hadoop/hive/ql/DriverTxnHandler.java
index a5e13c1202..b14d824b4a 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/DriverTxnHandler.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/DriverTxnHandler.java
@@ -39,12 +39,9 @@
 import org.apache.hadoop.hive.conf.Constants;
 import org.apache.hadoop.hive.conf.HiveConf;
 import org.apache.hadoop.hive.conf.HiveConf.ConfVars;
-import org.apache.hadoop.hive.metastore.api.GetOpenTxnsResponse;
 import org.apache.hadoop.hive.metastore.api.LockComponent;
 import org.apache.hadoop.hive.metastore.api.LockType;
 import org.apache.hadoop.hive.metastore.api.TxnType;
-import org.apache.hadoop.hive.metastore.txn.TxnCommonUtils;
-import org.apache.hadoop.hive.metastore.utils.MetaStoreUtils;
 import org.apache.hadoop.hive.ql.ddl.DDLDesc.DDLDescWithWriteId;
 import org.apache.hadoop.hive.ql.exec.AbstractFileMergeOperator;
 import org.apache.hadoop.hive.ql.exec.ConditionalTask;
@@ -59,7 +56,6 @@
 import org.apache.hadoop.hive.ql.lockmgr.HiveTxnManager;
 import org.apache.hadoop.hive.ql.lockmgr.LockException;
 import org.apache.hadoop.hive.ql.log.PerfLogger;
-import org.apache.hadoop.hive.ql.metadata.HiveException;
 import org.apache.hadoop.hive.ql.metadata.Table;
 import org.apache.hadoop.hive.ql.parse.HiveTableName;
 import org.apache.hadoop.hive.ql.parse.SemanticException;
@@ -406,23 +402,15 @@ boolean isValidTxnListState() throws LockException {
       return true; // Nothing to check
     }
 
-    GetOpenTxnsResponse openTxns = driverContext.getTxnManager().getOpenTxns();
-    ValidTxnList validTxnList = TxnCommonUtils.createValidReadTxnList(openTxns, 0);
-    long txnId = driverContext.getTxnManager().getCurrentTxnId();
-
-    String currentTxnString;
-    if (validTxnList.isTxnRangeValid(txnId + 1, openTxns.getTxn_high_water_mark()) != ValidTxnList.RangeResponse.NONE) {
-      // If here, there was another txn opened & committed between current SNAPSHOT generation and locking.
-      validTxnList.removeException(txnId);
-      currentTxnString = validTxnList.toString();
-    } else {
-      currentTxnString = TxnCommonUtils.createValidReadTxnList(openTxns, txnId).toString();
+    // 4) Check if there is conflict
+    long txnId = driverContext.getTxnManager().getLatestTxnInConflict();
+    if (txnId <= 0) {
+      return true;
     }
-
-    if (currentTxnString.equals(txnString)) {
-      return true; // Still valid, nothing more to do
+    if (txnId > driverContext.getTxnManager().getCurrentTxnId()) {
+      driverContext.setOutdatedTxn(true);
     }
-    return checkWriteIds(currentTxnString, nonSharedLockedTables, txnWriteIdListString);
+    return false;
   }
 
   private Set<String> getNonSharedLockedTables() {
@@ -454,48 +442,6 @@ private Set<String> getNonSharedLockedTables() {
     return nonSharedLockedTables;
   }
 
-  private boolean checkWriteIds(String currentTxnString, Set<String> nonSharedLockedTables, String txnWriteIdListString)
-      throws LockException {
-    ValidTxnWriteIdList txnWriteIdList = new ValidTxnWriteIdList(txnWriteIdListString);
-    Map<String, Table> writtenTables = getTables(false, true);
-
-    ValidTxnWriteIdList currentTxnWriteIds = driverContext.getTxnManager().getValidWriteIds(
-        getTransactionalTables(writtenTables), currentTxnString);
-
-    for (Map.Entry<String, Table> tableInfo : writtenTables.entrySet()) {
-      String fullQNameForLock = TableName.getDbTable(tableInfo.getValue().getDbName(),
-          MetaStoreUtils.encodeTableName(tableInfo.getValue().getTableName()));
-      if (nonSharedLockedTables.contains(fullQNameForLock)) {
-        // Check if table is transactional
-        if (AcidUtils.isTransactionalTable(tableInfo.getValue())) {
-          ValidWriteIdList writeIdList = txnWriteIdList.getTableValidWriteIdList(tableInfo.getKey());
-          ValidWriteIdList currentWriteIdList = currentTxnWriteIds.getTableValidWriteIdList(tableInfo.getKey());
-          // Check if there was a conflicting write between current SNAPSHOT generation and locking.
-          if (currentWriteIdList.isWriteIdRangeValid(writeIdList.getHighWatermark() + 1,
-              currentWriteIdList.getHighWatermark()) != ValidWriteIdList.RangeResponse.NONE) {
-            driverContext.setOutdatedTxn(true);
-            return false;
-          }
-          // Check that write id is still valid
-          if (!TxnIdUtils.checkEquivalentWriteIds(writeIdList, currentWriteIdList)) {
-            // Write id has changed, it is not valid anymore, we need to recompile
-            return false;
-          }
-        }
-        nonSharedLockedTables.remove(fullQNameForLock);
-      }
-    }
-
-    if (!nonSharedLockedTables.isEmpty()) {
-      throw new LockException("Wrong state: non-shared locks contain information for tables that have not" +
-          " been visited when trying to validate the locks from query tables.\n" +
-          "Tables: " + writtenTables.keySet() + "\n" +
-          "Remaining locks after check: " + nonSharedLockedTables);
-    }
-
-    return true; // It passes the test, it is valid
-  }
-
   private Map<String, Table> getTables(boolean inputNeeded, boolean outputNeeded) {
     Map<String, Table> tables = new HashMap<>();
     if (inputNeeded) {
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/io/AcidUtils.java b/ql/src/java/org/apache/hadoop/hive/ql/io/AcidUtils.java
index 69ef8c7f3c..c6ddf8b124 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/io/AcidUtils.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/io/AcidUtils.java
@@ -3001,19 +3001,21 @@ Seems much cleaner if each stmt is identified as a particular HiveOperation (whi
       case INSERT:
         assert t != null;
         if (AcidUtils.isTransactionalTable(t)) {
+          boolean isExclMergeInsert = conf.getBoolVar(ConfVars.TXN_MERGE_INSERT_X_LOCK) && isMerge;
+
           if (sharedWrite) {
-            if (conf.getBoolVar(ConfVars.TXN_MERGE_INSERT_X_LOCK) && isMerge) {
-              compBuilder.setExclWrite();
-            } else {
-              compBuilder.setSharedWrite();
-            }
+            compBuilder.setSharedWrite();
           } else {
-            if (conf.getBoolVar(ConfVars.TXN_MERGE_INSERT_X_LOCK) && isMerge) {
-              compBuilder.setExclusive();
+            if (isExclMergeInsert) {
+              compBuilder.setExclWrite();
             } else {
               compBuilder.setSharedRead();
             }
           }
+          if (isExclMergeInsert) {
+            compBuilder.setOperationType(DataOperationType.UPDATE);
+            break;
+          }
         } else if (MetaStoreUtils.isNonNativeTable(t.getTTable())) {
           final HiveStorageHandler storageHandler = Preconditions.checkNotNull(t.getStorageHandler(),
               "Thought all the non native tables have an instance of storage handler");
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/lockmgr/DbTxnManager.java b/ql/src/java/org/apache/hadoop/hive/ql/lockmgr/DbTxnManager.java
index abadb43016..49293db9a2 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/lockmgr/DbTxnManager.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/lockmgr/DbTxnManager.java
@@ -1005,6 +1005,15 @@ public LockResponse acquireMaterializationRebuildLock(String dbName, String tabl
     return lockResponse;
   }
 
+  @Override
+  public long getLatestTxnInConflict() throws LockException {
+    try {
+      return getMS().getLatestTxnInConflict(txnId);
+    } catch (TException e) {
+      throw new LockException(e);
+    }
+  }
+
   private boolean heartbeatMaterializationRebuildLock(String dbName, String tableName, long txnId) throws LockException {
     try {
       return getMS().heartbeatLockMaterializationRebuild(dbName, tableName, txnId);
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/lockmgr/DummyTxnManager.java b/ql/src/java/org/apache/hadoop/hive/ql/lockmgr/DummyTxnManager.java
index 977d8efe52..2d1c14ef07 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/lockmgr/DummyTxnManager.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/lockmgr/DummyTxnManager.java
@@ -87,6 +87,12 @@ public int getStmtIdAndIncrement() {
   public int getCurrentStmtId() {
     return  0;
   }
+
+  @Override
+  public long getLatestTxnInConflict() throws LockException {
+    return 0;
+  }
+
   @Override
   public long getTableWriteId(String dbName, String tableName) throws LockException {
     return 0L;
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/lockmgr/HiveTxnManager.java b/ql/src/java/org/apache/hadoop/hive/ql/lockmgr/HiveTxnManager.java
index a2effe1bd4..5e1544a922 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/lockmgr/HiveTxnManager.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/lockmgr/HiveTxnManager.java
@@ -345,4 +345,6 @@ void replAllocateTableWriteIdsBatch(String dbName, String tableName, String repl
    */
   LockResponse acquireMaterializationRebuildLock(String dbName, String tableName, long txnId)
       throws LockException;
+
+ long getLatestTxnInConflict() throws LockException;
 }
diff --git a/ql/src/test/org/apache/hadoop/hive/ql/lockmgr/TestDbTxnManager2.java b/ql/src/test/org/apache/hadoop/hive/ql/lockmgr/TestDbTxnManager2.java
index 00c3f5051a..339aa12f11 100644
--- a/ql/src/test/org/apache/hadoop/hive/ql/lockmgr/TestDbTxnManager2.java
+++ b/ql/src/test/org/apache/hadoop/hive/ql/lockmgr/TestDbTxnManager2.java
@@ -1887,7 +1887,7 @@ private void testMerge3Way(boolean causeConflict, boolean sharedWrite) throws Ex
     Assert.assertEquals(
         "TXN_COMPONENTS mismatch(" + JavaUtils.txnIdToString(txnId1) + "): " +
         TxnDbUtil.queryToString(conf, "select * from \"TXN_COMPONENTS\""),
-        0,
+        1,
         TxnDbUtil.countQueryAgent(conf, "select count(*) from \"TXN_COMPONENTS\" where \"TC_TXNID\"=" + txnId1));
 
     //complete 1st txn
@@ -1960,7 +1960,7 @@ private void testMerge3Way(boolean causeConflict, boolean sharedWrite) throws Ex
     Assert.assertEquals(
         "TXN_COMPONENTS mismatch(" + JavaUtils.txnIdToString(txnId2) + "): " +
         TxnDbUtil.queryToString(conf, "select * from \"TXN_COMPONENTS\""),
-        0,
+        1,
         TxnDbUtil.countQueryAgent(conf, "select count(*) from \"TXN_COMPONENTS\" where \"TC_TXNID\"=" + txnId2));
 
     //complete 2nd txn
@@ -2213,68 +2213,96 @@ private void testMergeInsertLocking(boolean sharedWrite) throws Exception {
     Assert.assertEquals("Unexpected lock count", 3, locks.size());
     checkLock((sharedWrite ? LockType.SHARED_WRITE : LockType.SHARED_READ),
         LockState.ACQUIRED, "default", "target", null, locks);
-    checkLock(LockType.SHARED_READ, LockState.WAITING, "default", "source", null, locks);
-    checkLock((sharedWrite ? LockType.EXCL_WRITE : LockType.EXCLUSIVE),
-        LockState.WAITING, "default", "target", null, locks);
+    checkLock(LockType.SHARED_READ, LockState.ACQUIRED, "default", "source", null, locks);
+    checkLock((sharedWrite ? LockType.SHARED_WRITE : LockType.EXCL_WRITE),
+        LockState.ACQUIRED, "default", "target", null, locks);
   }
 
   @Test
-  public void testInsertMergeInsertConcurrentSnapshotInvalidateNoDuplicates() throws Exception {
-    testConcurrentMergeInsertSnapshotInvalidate("insert into target values (5, 6)", false);
+  public void testConcurrentInsertMergeInsertGenerateDuplicates() throws Exception {
+    testConcurrentMergeInsert("insert into target values (5, 6)", false, false, true);
+  }
+  @Test
+  public void testConcurrentInsertMergeInsertSharedWriteGenerateDuplicates() throws Exception {
+    testConcurrentMergeInsert("insert into target values (5, 6)", true,false, true);
   }
   @Test
-  public void testInsertMergeInsertConcurrentSharedWriteSnapshotInvalidateNoDuplicates() throws Exception {
-    testConcurrentMergeInsertSnapshotInvalidate("insert into target values (5, 6)", true);
+  public void testConcurrent2MergeInsertsNoDuplicates() throws Exception {
+    testConcurrentMergeInsert("merge into target t using source s on t.a = s.a " +
+        "when not matched then insert values (s.a, s.b)", false, false,false);
   }
   @Test
-  public void test2MergeInsertsConcurrentSnapshotInvalidateNoDuplicates() throws Exception {
-    testConcurrentMergeInsertSnapshotInvalidate("merge into target t using source s on t.a = s.a " +
-      "when not matched then insert values (s.a, s.b)", false);
+  public void testConcurrent2MergeInsertsSharedWriteNoDuplicates() throws Exception {
+    testConcurrentMergeInsert("merge into target t using source s on t.a = s.a " +
+        "when not matched then insert values (s.a, s.b)", true, false,false);
   }
   @Test
-  public void test2MergeInsertsConcurrentSharedWriteSnapshotInvalidateNoDuplicates() throws Exception {
-    testConcurrentMergeInsertSnapshotInvalidate("merge into target t using source s on t.a = s.a " +
-      "when not matched then insert values (s.a, s.b)", true);
+  public void testConcurrent2MergeInsertsNoDuplicatesSlowCompile() throws Exception {
+    testConcurrentMergeInsert("merge into target t using source s on t.a = s.a " +
+        "when not matched then insert values (s.a, s.b)", false, true,false);
   }
   @Test
-  public void testMergeInsertNoSnapshotInvalidateNoDuplicates() throws Exception {
-    testConcurrentMergeInsertSnapshotInvalidate("insert into source values (3, 4)", false);
+  public void testConcurrent2MergeInsertsSharedWriteNoDuplicatesSlowCompile() throws Exception {
+    testConcurrentMergeInsert("merge into target t using source s on t.a = s.a " +
+        "when not matched then insert values (s.a, s.b)", true, true,false);
+  }
+  @Test
+  public void testConcurrentInsertMergeInsertNoDuplicates() throws Exception {
+    testConcurrentMergeInsert("insert into source values (3, 4)", false, false,false);
   }
 
-  private void testConcurrentMergeInsertSnapshotInvalidate(String query, boolean sharedWrite) throws Exception {
+  private void testConcurrentMergeInsert(String query, boolean sharedWrite, boolean slowCompile, boolean extectedDuplicates) throws Exception {
     dropTable(new String[]{"target", "source"});
     conf.setBoolVar(HiveConf.ConfVars.TXN_WRITE_X_LOCK, !sharedWrite);
+    driver2.getConf().setBoolVar(HiveConf.ConfVars.TXN_WRITE_X_LOCK, !sharedWrite);
 
     driver.run("create table target (a int, b int) stored as orc TBLPROPERTIES ('transactional'='true')");
     driver.run("insert into target values (1,2), (3,4)");
     driver.run("create table source (a int, b int)");
     driver.run("insert into source values (5,6), (7,8)");
 
+    if (!slowCompile) {
+      driver.compileAndRespond(query);
+    }
+
     DbTxnManager txnMgr2 = (DbTxnManager) TxnManagerFactory.getTxnManagerFactory().getTxnManager(conf);
     swapTxnManager(txnMgr2);
     driver2.compileAndRespond("merge into target t using source s on t.a = s.a " +
       "when not matched then insert values (s.a, s.b)");
 
     swapTxnManager(txnMgr);
-    driver.run(query);
+    if (!slowCompile) {
+      driver.run();
+    } else {
+      driver.run(query);
+    }
 
     swapTxnManager(txnMgr2);
     try {
       driver2.run();
-    } catch (Exception ex ){
-      Assert.assertTrue(ex.getCause().getMessage().contains("due to a write conflict"));
+    } catch (CommandProcessorException ex ){
+      Assert.assertTrue(ex.getMessage().contains("write conflict on default/target"));
     }
 
     swapTxnManager(txnMgr);
     driver.run("select * from target");
     List res = new ArrayList();
     driver.getFetchTask().fetch(res);
-    Assert.assertEquals("Duplicate records found", 4, res.size());
+    Assert.assertEquals("Duplicate records " + (extectedDuplicates ? "" : "not") + "found",
+      extectedDuplicates ? 5 : 4, res.size());
     dropTable(new String[]{"target", "source"});
   }
 
   @Test
-  public void testUpdateMergeUpdateConcurrentSnapshotInvalidate() throws Exception {
+  public void testConcurrentUpdateMergeUpdateConflict() throws Exception {
+    testConcurrentUpdateMergeUpdateConflict(false);
+  }
+  @Test
+  public void testConcurrentUpdateMergeUpdateConflictSlowCompile() throws Exception {
+    testConcurrentUpdateMergeUpdateConflict(true);
+  }
+
+  private void testConcurrentUpdateMergeUpdateConflict(boolean slowCompile) throws Exception {
     dropTable(new String[]{"target", "source"});
     driver2.getConf().setBoolVar(HiveConf.ConfVars.TXN_WRITE_X_LOCK, true);
 
@@ -2283,7 +2311,9 @@ public void testUpdateMergeUpdateConcurrentSnapshotInvalidate() throws Exception
     driver.run("create table source (a int, b int)");
     driver.run("insert into source values (5,6), (7,8)");
 
-    driver.compileAndRespond("update target set a=5 where a=1");
+    if (!slowCompile) {
+      driver.compileAndRespond("update target set a=5 where a=1");
+    }
 
     DbTxnManager txnMgr2 = (DbTxnManager) TxnManagerFactory.getTxnManagerFactory().getTxnManager(conf);
     swapTxnManager(txnMgr2);
@@ -2291,7 +2321,11 @@ public void testUpdateMergeUpdateConcurrentSnapshotInvalidate() throws Exception
       "when matched then update set b=8");
 
     swapTxnManager(txnMgr);
-    driver.run();
+    if (!slowCompile) {
+      driver.run();
+    } else {
+      driver.run("update target set a=5 where a=1");
+    }
 
     swapTxnManager(txnMgr2);
     driver2.run();
@@ -2302,80 +2336,82 @@ public void testUpdateMergeUpdateConcurrentSnapshotInvalidate() throws Exception
     driver.getFetchTask().fetch(res);
     Assert.assertEquals(2, res.size());
     Assert.assertEquals("Lost Update", "5\t8", res.get(1));
-    dropTable(new String[]{"target", "source"});
   }
 
   @Test
-  public void testUpdateMergeUpdateConcurrentSnapshotInvalidateNewTxn() throws Exception {
+  public void testConcurrent2MergeUpdatesConflict() throws Exception {
+    testConcurrent2MergeUpdatesConflict(false);
+  }
+  @Test
+  public void testConcurrent2MergeUpdatesConflictSlowCompile() throws Exception {
+    testConcurrent2MergeUpdatesConflict(true);
+  }
+
+  private void testConcurrent2MergeUpdatesConflict(boolean slowCompile) throws Exception {
     dropTable(new String[]{"target", "source"});
     driver2.getConf().setBoolVar(HiveConf.ConfVars.TXN_WRITE_X_LOCK, true);
 
-    driver.run("create table target (a int, b int) stored as orc TBLPROPERTIES ('transactional'='true')");
-    driver.run("insert into target values (1,2), (3,4)");
-    driver.run("create table source (a int, b int)");
-    driver.run("insert into source values (5,6), (7,8)");
+    driver.run("create table target (name string, age int) stored as orc TBLPROPERTIES('transactional'='true')");
+    driver.run("insert into target values ('amy', 88), ('drake', 44), ('earl', 21)");
+    driver.run("create table source (name string, age int) stored as orc TBLPROPERTIES('transactional'='true')");
+    driver.run("insert into source values ('amy', 35), ('bob', 66), ('cal', 21)");
+
+    if (!slowCompile) {
+      driver.compileAndRespond("merge into target t using source s on t.name = s.name " +
+        "when matched then update set age=10");
+    }
 
     DbTxnManager txnMgr2 = (DbTxnManager) TxnManagerFactory.getTxnManagerFactory().getTxnManager(conf);
     swapTxnManager(txnMgr2);
-    driver2.compileAndRespond("merge into target t using source s on t.a = s.a " +
-      "when matched then update set b=8");
+    driver2.compileAndRespond("merge into target t using source s on t.age = s.age " +
+      "when matched then update set age=10");
 
     swapTxnManager(txnMgr);
-    driver.run("update target set a=5 where a=1");
+    if (!slowCompile) {
+      driver.run();
+    } else {
+      driver.run("merge into target t using source s on t.name = s.name " +
+        "when matched then update set age=10");
+    }
 
     swapTxnManager(txnMgr2);
     driver2.run();
 
     swapTxnManager(txnMgr);
-    driver.run("select * from target");
+    driver.run("select * from target where age=10");
     List res = new ArrayList();
     driver.getFetchTask().fetch(res);
     Assert.assertEquals(2, res.size());
-    Assert.assertEquals("Lost Update", "5\t8", res.get(1));
-    dropTable(new String[]{"target", "source"});
+    Assert.assertEquals("Lost Update", "[earl\t10, amy\t10]", res.toString());
   }
 
   @Test
-  public void test2MergeInsertsConcurrentNoDuplicates() throws Exception {
-    testConcurrentMergeInsertNoDuplicates("merge into target t using source s on t.a = s.a " +
-        "when not matched then insert values (s.a, s.b)", false);
-  }
-  @Test
-  public void test2MergeInsertsConcurrentSharedWriteNoDuplicates() throws Exception {
-    testConcurrentMergeInsertNoDuplicates("merge into target t using source s on t.a = s.a " +
-        "when not matched then insert values (s.a, s.b)", true);
+  public void testConcurrent2InsertOverwritesDiffPartitions() throws Exception {
+    testConcurrent2InsertOverwrites(false);
   }
   @Test
-  public void testtInsertMergeInsertConcurrentNoDuplicates() throws Exception {
-    testConcurrentMergeInsertNoDuplicates("insert into target values (5, 6)", false);
-  }
-  @Test
-  public void testtInsertMergeInsertConcurrentSharedWriteNoDuplicates() throws Exception {
-    testConcurrentMergeInsertNoDuplicates("insert into target values (5, 6)", true);
+  public void testConcurrent2InsertOverwritesSamePartition() throws Exception {
+    testConcurrent2InsertOverwrites(true);
   }
 
-  private void testConcurrentMergeInsertNoDuplicates(String query, boolean sharedWrite) throws Exception {
+  private void testConcurrent2InsertOverwrites(boolean conflict) throws Exception {
     dropTable(new String[]{"target", "source"});
-    conf.setBoolVar(HiveConf.ConfVars.TXN_WRITE_X_LOCK, !sharedWrite);
-    driver2.getConf().setBoolVar(HiveConf.ConfVars.TXN_WRITE_X_LOCK, !sharedWrite);
+    driver2.getConf().setBoolVar(HiveConf.ConfVars.TXN_WRITE_X_LOCK, true);
 
-    driver.run("create table target (a int, b int) stored as orc TBLPROPERTIES ('transactional'='true')");
+    driver.run("create table target (a int) partitioned by (b int) stored as orc TBLPROPERTIES ('transactional'='true')");
     driver.run("insert into target values (1,2), (3,4)");
-    driver.run("create table source (a int, b int)");
-    driver.run("insert into source values (5,6), (7,8)");
-
-    driver.compileAndRespond(query);
+    driver.run("create table source (a int)");
+    driver.run("insert into source values (5), (7)");
 
+    driver.compileAndRespond("insert overwrite table target partition (b='2') select * from source");
     DbTxnManager txnMgr2 = (DbTxnManager) TxnManagerFactory.getTxnManagerFactory().getTxnManager(conf);
     swapTxnManager(txnMgr2);
-
-    driver2.compileAndRespond("merge into target t using source s on t.a = s.a " +
-        "when not matched then insert values (s.a, s.b)");
+    driver2.compileAndRespond("insert overwrite table target partition (b='" +
+      (conflict ? 2 : 4) + "') select * from source");
 
     swapTxnManager(txnMgr);
     driver.run();
 
-    //merge should notice snapshot changes and re-create it
     swapTxnManager(txnMgr2);
     driver2.run();
 
@@ -2383,8 +2419,7 @@ private void testConcurrentMergeInsertNoDuplicates(String query, boolean sharedW
     driver.run("select * from target");
     List res = new ArrayList();
     driver.getFetchTask().fetch(res);
-    Assert.assertEquals("Duplicate records found", 4, res.size());
-    dropTable(new String[]{"target", "source"});
+    Assert.assertEquals(conflict ? 3 : 4, res.size());
   }
 
   /**
@@ -2394,7 +2429,7 @@ private void testConcurrentMergeInsertNoDuplicates(String query, boolean sharedW
    * @throws Exception ex
    */
   @Test
-  public void testMergeInsertDynamicPartitioningSequential() throws Exception {
+  public void testInsertOverwriteMergeInsertDynamicPartitioningSequential() throws Exception {
     dropTable(new String[]{"target", "source"});
     conf.setBoolVar(HiveConf.ConfVars.TXN_WRITE_X_LOCK, false);
 
@@ -2409,7 +2444,7 @@ public void testMergeInsertDynamicPartitioningSequential() throws Exception {
     driver.run("insert into source values (5,5,2), (6,6,3)");
 
     // txn 2 inserts into the target table into a new partition ( and a duplicate considering the source table)
-    driver.run("insert into target values (3, 3, 2)");
+    driver.run("insert overwrite table target partition (c=2) select 3, 3");
 
     // txn3 merge
     driver.run("merge into target t using source s on t.a = s.a " +
@@ -2424,11 +2459,20 @@ public void testMergeInsertDynamicPartitioningSequential() throws Exception {
   }
 
   @Test
-  public void testMergeInsertDynamicPartitioningSnapshotInvalidatedWithOldCommit() throws Exception {
-    Driver driver3 = new Driver(new QueryState.Builder().withHiveConf(conf).build());
+  public void testInsertOverwriteMergeInsertDynamicPartitioningConflict() throws Exception {
+    testInsertOverwriteMergeInsertDynamicPartitioningConflict(false);
+  }
+  @Test
+  public void testInsertOverwriteMergeInsertDynamicPartitioningConflictSlowCompile() throws Exception {
+    testInsertOverwriteMergeInsertDynamicPartitioningConflict(true);
+  }
 
+  private void testInsertOverwriteMergeInsertDynamicPartitioningConflict(boolean slowCompile) throws Exception {
+    conf.setBoolVar(HiveConf.ConfVars.TXN_WRITE_X_LOCK, true);
+    conf.setBoolVar(HiveConf.ConfVars.TXN_MERGE_INSERT_X_LOCK, true);
+
+    Driver driver3 = new Driver(new QueryState.Builder().withHiveConf(conf).build(), null);
     dropTable(new String[]{"target", "source"});
-    conf.setBoolVar(HiveConf.ConfVars.TXN_WRITE_X_LOCK, false);
 
     // Create partition c=1
     driver.run("create table target (a int, b int) partitioned by (c int) stored as orc TBLPROPERTIES ('transactional'='true')");
@@ -2437,14 +2481,15 @@ public void testMergeInsertDynamicPartitioningSnapshotInvalidatedWithOldCommit()
     driver.run("create table source (a int, b int) partitioned by (c int) stored as orc TBLPROPERTIES ('transactional'='true')");
     driver.run("insert into source values (3,3,2), (4,4,2)");
 
-    // txn 1 insert data to an old and a new partition
-    driver.compileAndRespond("insert into source values (5,5,2), (6,6,3)");
-
     DbTxnManager txnMgr2 = (DbTxnManager) TxnManagerFactory.getTxnManagerFactory().getTxnManager(new HiveConf(conf));
-    swapTxnManager(txnMgr2);
 
-    // txn 2 insert into the target table into a new partition ( and a duplicate considering the source table)
-    driver2.compileAndRespond("insert into target values (3, 3, 2)");
+    if (!slowCompile) {
+      // txn 1 insert data to an old and a new partition
+      driver.compileAndRespond("insert into source values (5,5,2), (6,6,3)");
+      swapTxnManager(txnMgr2);
+      // txn 2 insert into the target table into a new partition ( and a duplicate considering the source table)
+      driver2.compileAndRespond("insert overwrite table target partition (c=2) select 3, 3");
+    }
 
     DbTxnManager txnMgr3 = (DbTxnManager) TxnManagerFactory.getTxnManagerFactory().getTxnManager(new HiveConf(conf));
     swapTxnManager(txnMgr3);
@@ -2454,54 +2499,23 @@ public void testMergeInsertDynamicPartitioningSnapshotInvalidatedWithOldCommit()
       "when not matched then insert values (s.a, s.b, s.c)");
 
     swapTxnManager(txnMgr);
-    driver.run();
+    if (!slowCompile) {
+      driver.run();
+    } else {
+      // txn 2 insert data to an old and a new partition
+      driver.run("insert into source values (5,5,2), (6,6,3)");
+    }
 
     swapTxnManager(txnMgr2);
-    driver2.run();
-    // Since txn2 was committed and it is part of txn3 snapshot, the snapshot should be invalidated
-    // txn3 should be rolled back and the query reexecuted
-    swapTxnManager(txnMgr3);
-    driver3.run();
-
-    swapTxnManager(txnMgr);
-    driver.run("select * from target");
-    List res = new ArrayList();
-    driver.getFetchTask().fetch(res);
-    // The merge should see all three partition and not create duplicates
-    Assert.assertEquals("Duplicate records found", 6, res.size());
-    Assert.assertTrue("Partition 3 was skipped", res.contains("6\t6\t3"));
-    driver3.close();
-    dropTable(new String[]{"target", "source"});
-  }
-
-  @Test
-  public void testMergeInsertDynamicPartitioningSnapshotInvalidatedWithNewCommit() throws Exception {
-    Driver driver3 = new Driver(new QueryState.Builder().withHiveConf(conf).build());
-
-    dropTable(new String[]{"target", "source"});
-    conf.setBoolVar(HiveConf.ConfVars.TXN_WRITE_X_LOCK, false);
-
-    // Create partition c=1
-    driver.run("create table target (a int, b int) partitioned by (c int) stored as orc TBLPROPERTIES ('transactional'='true')");
-    driver.run("insert into target values (1,1,1), (2,2,1)");
-    //Create partition c=2
-    driver.run("create table source (a int, b int) partitioned by (c int) stored as orc TBLPROPERTIES ('transactional'='true')");
-    driver.run("insert into source values (3,3,2), (4,4,2)");
-
-    DbTxnManager txnMgr3 = (DbTxnManager) TxnManagerFactory.getTxnManagerFactory().getTxnManager(new HiveConf(conf));
-    swapTxnManager(txnMgr3);
-    // Compile txn 1 merge with only 1 known partition
-    driver3.compileAndRespond("merge into target t using source s on t.a = s.a " +
-      "when not matched then insert values (s.a, s.b, s.c)");
-
-    swapTxnManager(txnMgr);
-    // txn 2 insert data to an old and a new partition
-    driver.run("insert into source values (5,5,2), (6,6,3)");
-
-    // txn 3 insert into the target table into a new partition ( and a duplicate considering the source table)
-    driver.run("insert into target values (3, 3, 2)");
+    if (!slowCompile) {
+      driver2.run();
+      // Since txn2 was committed and it is part of txn3 snapshot, snapshot should be invalidated and query re-compiled
+    } else {
+      // txn 3 insert into the target table into a new partition ( and a duplicate considering the source table)
+      driver2.run("insert overwrite table target partition (c=2) select 3, 3");
+      // Since we were writing in the target table, txn 3 should break txn 1 snapshot regardless that it was opened later
+    }
 
-    // Since we were writing in the target table, txn 3 should break txn 1 snapshot regardless that it was opened later
     swapTxnManager(txnMgr3);
     driver3.run();
 
@@ -2668,7 +2682,7 @@ private void testMergePartitioned(boolean causeConflict, boolean sharedWrite) th
     Assert.assertEquals(
         "TXN_COMPONENTS mismatch(" + JavaUtils.txnIdToString(txnId1) + "): " +
         TxnDbUtil.queryToString(conf, "select * from \"TXN_COMPONENTS\""),
-        0, //because it's using a DP write
+        1, //because it's using a DP write
         TxnDbUtil.countQueryAgent(conf, "select count(*) from \"TXN_COMPONENTS\" where \"TC_TXNID\"=" + txnId1));
 
     //complete T1 transaction (simulate writing to 2 partitions)
@@ -2709,7 +2723,7 @@ private void testMergePartitioned(boolean causeConflict, boolean sharedWrite) th
     Assert.assertEquals(
         "TXN_COMPONENTS mismatch(" + JavaUtils.txnIdToString(txnid2) + "): " +
         TxnDbUtil.queryToString(conf, "select * from \"TXN_COMPONENTS\""),
-        0, //because it's using a DP write
+        1, //because it's using a DP write
         TxnDbUtil.countQueryAgent(conf, "select count(*) from \"TXN_COMPONENTS\" where \"TC_TXNID\"=" + txnid2));
 
     //complete T2 txn
diff --git a/standalone-metastore/metastore-common/src/gen/thrift/gen-cpp/ThriftHiveMetastore.cpp b/standalone-metastore/metastore-common/src/gen/thrift/gen-cpp/ThriftHiveMetastore.cpp
index caa9c571e1..453d5fd7f3 100644
--- a/standalone-metastore/metastore-common/src/gen/thrift/gen-cpp/ThriftHiveMetastore.cpp
+++ b/standalone-metastore/metastore-common/src/gen/thrift/gen-cpp/ThriftHiveMetastore.cpp
@@ -41941,6 +41941,213 @@ uint32_t ThriftHiveMetastore_commit_txn_presult::read(::apache::thrift::protocol
 }
 
 
+ThriftHiveMetastore_get_latest_txn_in_conflict_args::~ThriftHiveMetastore_get_latest_txn_in_conflict_args() noexcept {
+}
+
+
+uint32_t ThriftHiveMetastore_get_latest_txn_in_conflict_args::read(::apache::thrift::protocol::TProtocol* iprot) {
+
+  ::apache::thrift::protocol::TInputRecursionTracker tracker(*iprot);
+  uint32_t xfer = 0;
+  std::string fname;
+  ::apache::thrift::protocol::TType ftype;
+  int16_t fid;
+
+  xfer += iprot->readStructBegin(fname);
+
+  using ::apache::thrift::protocol::TProtocolException;
+
+
+  while (true)
+  {
+    xfer += iprot->readFieldBegin(fname, ftype, fid);
+    if (ftype == ::apache::thrift::protocol::T_STOP) {
+      break;
+    }
+    switch (fid)
+    {
+      case 1:
+        if (ftype == ::apache::thrift::protocol::T_I64) {
+          xfer += iprot->readI64(this->txnId);
+          this->__isset.txnId = true;
+        } else {
+          xfer += iprot->skip(ftype);
+        }
+        break;
+      default:
+        xfer += iprot->skip(ftype);
+        break;
+    }
+    xfer += iprot->readFieldEnd();
+  }
+
+  xfer += iprot->readStructEnd();
+
+  return xfer;
+}
+
+uint32_t ThriftHiveMetastore_get_latest_txn_in_conflict_args::write(::apache::thrift::protocol::TProtocol* oprot) const {
+  uint32_t xfer = 0;
+  ::apache::thrift::protocol::TOutputRecursionTracker tracker(*oprot);
+  xfer += oprot->writeStructBegin("ThriftHiveMetastore_get_latest_txn_in_conflict_args");
+
+  xfer += oprot->writeFieldBegin("txnId", ::apache::thrift::protocol::T_I64, 1);
+  xfer += oprot->writeI64(this->txnId);
+  xfer += oprot->writeFieldEnd();
+
+  xfer += oprot->writeFieldStop();
+  xfer += oprot->writeStructEnd();
+  return xfer;
+}
+
+
+ThriftHiveMetastore_get_latest_txn_in_conflict_pargs::~ThriftHiveMetastore_get_latest_txn_in_conflict_pargs() noexcept {
+}
+
+
+uint32_t ThriftHiveMetastore_get_latest_txn_in_conflict_pargs::write(::apache::thrift::protocol::TProtocol* oprot) const {
+  uint32_t xfer = 0;
+  ::apache::thrift::protocol::TOutputRecursionTracker tracker(*oprot);
+  xfer += oprot->writeStructBegin("ThriftHiveMetastore_get_latest_txn_in_conflict_pargs");
+
+  xfer += oprot->writeFieldBegin("txnId", ::apache::thrift::protocol::T_I64, 1);
+  xfer += oprot->writeI64((*(this->txnId)));
+  xfer += oprot->writeFieldEnd();
+
+  xfer += oprot->writeFieldStop();
+  xfer += oprot->writeStructEnd();
+  return xfer;
+}
+
+
+ThriftHiveMetastore_get_latest_txn_in_conflict_result::~ThriftHiveMetastore_get_latest_txn_in_conflict_result() noexcept {
+}
+
+
+uint32_t ThriftHiveMetastore_get_latest_txn_in_conflict_result::read(::apache::thrift::protocol::TProtocol* iprot) {
+
+  ::apache::thrift::protocol::TInputRecursionTracker tracker(*iprot);
+  uint32_t xfer = 0;
+  std::string fname;
+  ::apache::thrift::protocol::TType ftype;
+  int16_t fid;
+
+  xfer += iprot->readStructBegin(fname);
+
+  using ::apache::thrift::protocol::TProtocolException;
+
+
+  while (true)
+  {
+    xfer += iprot->readFieldBegin(fname, ftype, fid);
+    if (ftype == ::apache::thrift::protocol::T_STOP) {
+      break;
+    }
+    switch (fid)
+    {
+      case 0:
+        if (ftype == ::apache::thrift::protocol::T_I64) {
+          xfer += iprot->readI64(this->success);
+          this->__isset.success = true;
+        } else {
+          xfer += iprot->skip(ftype);
+        }
+        break;
+      case 1:
+        if (ftype == ::apache::thrift::protocol::T_STRUCT) {
+          xfer += this->o1.read(iprot);
+          this->__isset.o1 = true;
+        } else {
+          xfer += iprot->skip(ftype);
+        }
+        break;
+      default:
+        xfer += iprot->skip(ftype);
+        break;
+    }
+    xfer += iprot->readFieldEnd();
+  }
+
+  xfer += iprot->readStructEnd();
+
+  return xfer;
+}
+
+uint32_t ThriftHiveMetastore_get_latest_txn_in_conflict_result::write(::apache::thrift::protocol::TProtocol* oprot) const {
+
+  uint32_t xfer = 0;
+
+  xfer += oprot->writeStructBegin("ThriftHiveMetastore_get_latest_txn_in_conflict_result");
+
+  if (this->__isset.success) {
+    xfer += oprot->writeFieldBegin("success", ::apache::thrift::protocol::T_I64, 0);
+    xfer += oprot->writeI64(this->success);
+    xfer += oprot->writeFieldEnd();
+  } else if (this->__isset.o1) {
+    xfer += oprot->writeFieldBegin("o1", ::apache::thrift::protocol::T_STRUCT, 1);
+    xfer += this->o1.write(oprot);
+    xfer += oprot->writeFieldEnd();
+  }
+  xfer += oprot->writeFieldStop();
+  xfer += oprot->writeStructEnd();
+  return xfer;
+}
+
+
+ThriftHiveMetastore_get_latest_txn_in_conflict_presult::~ThriftHiveMetastore_get_latest_txn_in_conflict_presult() noexcept {
+}
+
+
+uint32_t ThriftHiveMetastore_get_latest_txn_in_conflict_presult::read(::apache::thrift::protocol::TProtocol* iprot) {
+
+  ::apache::thrift::protocol::TInputRecursionTracker tracker(*iprot);
+  uint32_t xfer = 0;
+  std::string fname;
+  ::apache::thrift::protocol::TType ftype;
+  int16_t fid;
+
+  xfer += iprot->readStructBegin(fname);
+
+  using ::apache::thrift::protocol::TProtocolException;
+
+
+  while (true)
+  {
+    xfer += iprot->readFieldBegin(fname, ftype, fid);
+    if (ftype == ::apache::thrift::protocol::T_STOP) {
+      break;
+    }
+    switch (fid)
+    {
+      case 0:
+        if (ftype == ::apache::thrift::protocol::T_I64) {
+          xfer += iprot->readI64((*(this->success)));
+          this->__isset.success = true;
+        } else {
+          xfer += iprot->skip(ftype);
+        }
+        break;
+      case 1:
+        if (ftype == ::apache::thrift::protocol::T_STRUCT) {
+          xfer += this->o1.read(iprot);
+          this->__isset.o1 = true;
+        } else {
+          xfer += iprot->skip(ftype);
+        }
+        break;
+      default:
+        xfer += iprot->skip(ftype);
+        break;
+    }
+    xfer += iprot->readFieldEnd();
+  }
+
+  xfer += iprot->readStructEnd();
+
+  return xfer;
+}
+
+
 ThriftHiveMetastore_repl_tbl_writeid_state_args::~ThriftHiveMetastore_repl_tbl_writeid_state_args() noexcept {
 }
 
@@ -69350,6 +69557,67 @@ void ThriftHiveMetastoreClient::recv_commit_txn()
   return;
 }
 
+int64_t ThriftHiveMetastoreClient::get_latest_txn_in_conflict(const int64_t txnId)
+{
+  send_get_latest_txn_in_conflict(txnId);
+  return recv_get_latest_txn_in_conflict();
+}
+
+void ThriftHiveMetastoreClient::send_get_latest_txn_in_conflict(const int64_t txnId)
+{
+  int32_t cseqid = 0;
+  oprot_->writeMessageBegin("get_latest_txn_in_conflict", ::apache::thrift::protocol::T_CALL, cseqid);
+
+  ThriftHiveMetastore_get_latest_txn_in_conflict_pargs args;
+  args.txnId = &txnId;
+  args.write(oprot_);
+
+  oprot_->writeMessageEnd();
+  oprot_->getTransport()->writeEnd();
+  oprot_->getTransport()->flush();
+}
+
+int64_t ThriftHiveMetastoreClient::recv_get_latest_txn_in_conflict()
+{
+
+  int32_t rseqid = 0;
+  std::string fname;
+  ::apache::thrift::protocol::TMessageType mtype;
+
+  iprot_->readMessageBegin(fname, mtype, rseqid);
+  if (mtype == ::apache::thrift::protocol::T_EXCEPTION) {
+    ::apache::thrift::TApplicationException x;
+    x.read(iprot_);
+    iprot_->readMessageEnd();
+    iprot_->getTransport()->readEnd();
+    throw x;
+  }
+  if (mtype != ::apache::thrift::protocol::T_REPLY) {
+    iprot_->skip(::apache::thrift::protocol::T_STRUCT);
+    iprot_->readMessageEnd();
+    iprot_->getTransport()->readEnd();
+  }
+  if (fname.compare("get_latest_txn_in_conflict") != 0) {
+    iprot_->skip(::apache::thrift::protocol::T_STRUCT);
+    iprot_->readMessageEnd();
+    iprot_->getTransport()->readEnd();
+  }
+  int64_t _return;
+  ThriftHiveMetastore_get_latest_txn_in_conflict_presult result;
+  result.success = &_return;
+  result.read(iprot_);
+  iprot_->readMessageEnd();
+  iprot_->getTransport()->readEnd();
+
+  if (result.__isset.success) {
+    return _return;
+  }
+  if (result.__isset.o1) {
+    throw result.o1;
+  }
+  throw ::apache::thrift::TApplicationException(::apache::thrift::TApplicationException::MISSING_RESULT, "get_latest_txn_in_conflict failed: unknown result");
+}
+
 void ThriftHiveMetastoreClient::repl_tbl_writeid_state(const ReplTblWriteIdStateRequest& rqst)
 {
   send_repl_tbl_writeid_state(rqst);
@@ -84167,6 +84435,63 @@ void ThriftHiveMetastoreProcessor::process_commit_txn(int32_t seqid, ::apache::t
   }
 }
 
+void ThriftHiveMetastoreProcessor::process_get_latest_txn_in_conflict(int32_t seqid, ::apache::thrift::protocol::TProtocol* iprot, ::apache::thrift::protocol::TProtocol* oprot, void* callContext)
+{
+  void* ctx = NULL;
+  if (this->eventHandler_.get() != NULL) {
+    ctx = this->eventHandler_->getContext("ThriftHiveMetastore.get_latest_txn_in_conflict", callContext);
+  }
+  ::apache::thrift::TProcessorContextFreer freer(this->eventHandler_.get(), ctx, "ThriftHiveMetastore.get_latest_txn_in_conflict");
+
+  if (this->eventHandler_.get() != NULL) {
+    this->eventHandler_->preRead(ctx, "ThriftHiveMetastore.get_latest_txn_in_conflict");
+  }
+
+  ThriftHiveMetastore_get_latest_txn_in_conflict_args args;
+  args.read(iprot);
+  iprot->readMessageEnd();
+  uint32_t bytes = iprot->getTransport()->readEnd();
+
+  if (this->eventHandler_.get() != NULL) {
+    this->eventHandler_->postRead(ctx, "ThriftHiveMetastore.get_latest_txn_in_conflict", bytes);
+  }
+
+  ThriftHiveMetastore_get_latest_txn_in_conflict_result result;
+  try {
+    result.success = iface_->get_latest_txn_in_conflict(args.txnId);
+    result.__isset.success = true;
+  } catch (MetaException &o1) {
+    result.o1 = o1;
+    result.__isset.o1 = true;
+  } catch (const std::exception& e) {
+    if (this->eventHandler_.get() != NULL) {
+      this->eventHandler_->handlerError(ctx, "ThriftHiveMetastore.get_latest_txn_in_conflict");
+    }
+
+    ::apache::thrift::TApplicationException x(e.what());
+    oprot->writeMessageBegin("get_latest_txn_in_conflict", ::apache::thrift::protocol::T_EXCEPTION, seqid);
+    x.write(oprot);
+    oprot->writeMessageEnd();
+    oprot->getTransport()->writeEnd();
+    oprot->getTransport()->flush();
+    return;
+  }
+
+  if (this->eventHandler_.get() != NULL) {
+    this->eventHandler_->preWrite(ctx, "ThriftHiveMetastore.get_latest_txn_in_conflict");
+  }
+
+  oprot->writeMessageBegin("get_latest_txn_in_conflict", ::apache::thrift::protocol::T_REPLY, seqid);
+  result.write(oprot);
+  oprot->writeMessageEnd();
+  bytes = oprot->getTransport()->writeEnd();
+  oprot->getTransport()->flush();
+
+  if (this->eventHandler_.get() != NULL) {
+    this->eventHandler_->postWrite(ctx, "ThriftHiveMetastore.get_latest_txn_in_conflict", bytes);
+  }
+}
+
 void ThriftHiveMetastoreProcessor::process_repl_tbl_writeid_state(int32_t seqid, ::apache::thrift::protocol::TProtocol* iprot, ::apache::thrift::protocol::TProtocol* oprot, void* callContext)
 {
   void* ctx = NULL;
@@ -104077,6 +104402,94 @@ void ThriftHiveMetastoreConcurrentClient::recv_commit_txn(const int32_t seqid)
   } // end while(true)
 }
 
+int64_t ThriftHiveMetastoreConcurrentClient::get_latest_txn_in_conflict(const int64_t txnId)
+{
+  int32_t seqid = send_get_latest_txn_in_conflict(txnId);
+  return recv_get_latest_txn_in_conflict(seqid);
+}
+
+int32_t ThriftHiveMetastoreConcurrentClient::send_get_latest_txn_in_conflict(const int64_t txnId)
+{
+  int32_t cseqid = this->sync_->generateSeqId();
+  ::apache::thrift::async::TConcurrentSendSentry sentry(this->sync_.get());
+  oprot_->writeMessageBegin("get_latest_txn_in_conflict", ::apache::thrift::protocol::T_CALL, cseqid);
+
+  ThriftHiveMetastore_get_latest_txn_in_conflict_pargs args;
+  args.txnId = &txnId;
+  args.write(oprot_);
+
+  oprot_->writeMessageEnd();
+  oprot_->getTransport()->writeEnd();
+  oprot_->getTransport()->flush();
+
+  sentry.commit();
+  return cseqid;
+}
+
+int64_t ThriftHiveMetastoreConcurrentClient::recv_get_latest_txn_in_conflict(const int32_t seqid)
+{
+
+  int32_t rseqid = 0;
+  std::string fname;
+  ::apache::thrift::protocol::TMessageType mtype;
+
+  // the read mutex gets dropped and reacquired as part of waitForWork()
+  // The destructor of this sentry wakes up other clients
+  ::apache::thrift::async::TConcurrentRecvSentry sentry(this->sync_.get(), seqid);
+
+  while(true) {
+    if(!this->sync_->getPending(fname, mtype, rseqid)) {
+      iprot_->readMessageBegin(fname, mtype, rseqid);
+    }
+    if(seqid == rseqid) {
+      if (mtype == ::apache::thrift::protocol::T_EXCEPTION) {
+        ::apache::thrift::TApplicationException x;
+        x.read(iprot_);
+        iprot_->readMessageEnd();
+        iprot_->getTransport()->readEnd();
+        sentry.commit();
+        throw x;
+      }
+      if (mtype != ::apache::thrift::protocol::T_REPLY) {
+        iprot_->skip(::apache::thrift::protocol::T_STRUCT);
+        iprot_->readMessageEnd();
+        iprot_->getTransport()->readEnd();
+      }
+      if (fname.compare("get_latest_txn_in_conflict") != 0) {
+        iprot_->skip(::apache::thrift::protocol::T_STRUCT);
+        iprot_->readMessageEnd();
+        iprot_->getTransport()->readEnd();
+
+        // in a bad state, don't commit
+        using ::apache::thrift::protocol::TProtocolException;
+        throw TProtocolException(TProtocolException::INVALID_DATA);
+      }
+      int64_t _return;
+      ThriftHiveMetastore_get_latest_txn_in_conflict_presult result;
+      result.success = &_return;
+      result.read(iprot_);
+      iprot_->readMessageEnd();
+      iprot_->getTransport()->readEnd();
+
+      if (result.__isset.success) {
+        sentry.commit();
+        return _return;
+      }
+      if (result.__isset.o1) {
+        sentry.commit();
+        throw result.o1;
+      }
+      // in a bad state, don't commit
+      throw ::apache::thrift::TApplicationException(::apache::thrift::TApplicationException::MISSING_RESULT, "get_latest_txn_in_conflict failed: unknown result");
+    }
+    // seqid != rseqid
+    this->sync_->updatePending(fname, mtype, rseqid);
+
+    // this will temporarily unlock the readMutex, and let other clients get work done
+    this->sync_->waitForWork(seqid);
+  } // end while(true)
+}
+
 void ThriftHiveMetastoreConcurrentClient::repl_tbl_writeid_state(const ReplTblWriteIdStateRequest& rqst)
 {
   int32_t seqid = send_repl_tbl_writeid_state(rqst);
diff --git a/standalone-metastore/metastore-common/src/gen/thrift/gen-cpp/ThriftHiveMetastore.h b/standalone-metastore/metastore-common/src/gen/thrift/gen-cpp/ThriftHiveMetastore.h
index 1abf4a7e02..690c1f9585 100644
--- a/standalone-metastore/metastore-common/src/gen/thrift/gen-cpp/ThriftHiveMetastore.h
+++ b/standalone-metastore/metastore-common/src/gen/thrift/gen-cpp/ThriftHiveMetastore.h
@@ -190,6 +190,7 @@ class ThriftHiveMetastoreIf : virtual public  ::facebook::fb303::FacebookService
   virtual void abort_txn(const AbortTxnRequest& rqst) = 0;
   virtual void abort_txns(const AbortTxnsRequest& rqst) = 0;
   virtual void commit_txn(const CommitTxnRequest& rqst) = 0;
+  virtual int64_t get_latest_txn_in_conflict(const int64_t txnId) = 0;
   virtual void repl_tbl_writeid_state(const ReplTblWriteIdStateRequest& rqst) = 0;
   virtual void get_valid_write_ids(GetValidWriteIdsResponse& _return, const GetValidWriteIdsRequest& rqst) = 0;
   virtual void allocate_table_write_ids(AllocateTableWriteIdsResponse& _return, const AllocateTableWriteIdsRequest& rqst) = 0;
@@ -826,6 +827,10 @@ class ThriftHiveMetastoreNull : virtual public ThriftHiveMetastoreIf , virtual p
   void commit_txn(const CommitTxnRequest& /* rqst */) {
     return;
   }
+  int64_t get_latest_txn_in_conflict(const int64_t /* txnId */) {
+    int64_t _return = 0;
+    return _return;
+  }
   void repl_tbl_writeid_state(const ReplTblWriteIdStateRequest& /* rqst */) {
     return;
   }
@@ -21913,6 +21918,118 @@ class ThriftHiveMetastore_commit_txn_presult {
 
 };
 
+typedef struct _ThriftHiveMetastore_get_latest_txn_in_conflict_args__isset {
+  _ThriftHiveMetastore_get_latest_txn_in_conflict_args__isset() : txnId(false) {}
+  bool txnId :1;
+} _ThriftHiveMetastore_get_latest_txn_in_conflict_args__isset;
+
+class ThriftHiveMetastore_get_latest_txn_in_conflict_args {
+ public:
+
+  ThriftHiveMetastore_get_latest_txn_in_conflict_args(const ThriftHiveMetastore_get_latest_txn_in_conflict_args&);
+  ThriftHiveMetastore_get_latest_txn_in_conflict_args& operator=(const ThriftHiveMetastore_get_latest_txn_in_conflict_args&);
+  ThriftHiveMetastore_get_latest_txn_in_conflict_args() : txnId(0) {
+  }
+
+  virtual ~ThriftHiveMetastore_get_latest_txn_in_conflict_args() noexcept;
+  int64_t txnId;
+
+  _ThriftHiveMetastore_get_latest_txn_in_conflict_args__isset __isset;
+
+  void __set_txnId(const int64_t val);
+
+  bool operator == (const ThriftHiveMetastore_get_latest_txn_in_conflict_args & rhs) const
+  {
+    if (!(txnId == rhs.txnId))
+      return false;
+    return true;
+  }
+  bool operator != (const ThriftHiveMetastore_get_latest_txn_in_conflict_args &rhs) const {
+    return !(*this == rhs);
+  }
+
+  bool operator < (const ThriftHiveMetastore_get_latest_txn_in_conflict_args & ) const;
+
+  uint32_t read(::apache::thrift::protocol::TProtocol* iprot);
+  uint32_t write(::apache::thrift::protocol::TProtocol* oprot) const;
+
+};
+
+
+class ThriftHiveMetastore_get_latest_txn_in_conflict_pargs {
+ public:
+
+
+  virtual ~ThriftHiveMetastore_get_latest_txn_in_conflict_pargs() noexcept;
+  const int64_t* txnId;
+
+  uint32_t write(::apache::thrift::protocol::TProtocol* oprot) const;
+
+};
+
+typedef struct _ThriftHiveMetastore_get_latest_txn_in_conflict_result__isset {
+  _ThriftHiveMetastore_get_latest_txn_in_conflict_result__isset() : success(false), o1(false) {}
+  bool success :1;
+  bool o1 :1;
+} _ThriftHiveMetastore_get_latest_txn_in_conflict_result__isset;
+
+class ThriftHiveMetastore_get_latest_txn_in_conflict_result {
+ public:
+
+  ThriftHiveMetastore_get_latest_txn_in_conflict_result(const ThriftHiveMetastore_get_latest_txn_in_conflict_result&);
+  ThriftHiveMetastore_get_latest_txn_in_conflict_result& operator=(const ThriftHiveMetastore_get_latest_txn_in_conflict_result&);
+  ThriftHiveMetastore_get_latest_txn_in_conflict_result() : success(0) {
+  }
+
+  virtual ~ThriftHiveMetastore_get_latest_txn_in_conflict_result() noexcept;
+  int64_t success;
+  MetaException o1;
+
+  _ThriftHiveMetastore_get_latest_txn_in_conflict_result__isset __isset;
+
+  void __set_success(const int64_t val);
+
+  void __set_o1(const MetaException& val);
+
+  bool operator == (const ThriftHiveMetastore_get_latest_txn_in_conflict_result & rhs) const
+  {
+    if (!(success == rhs.success))
+      return false;
+    if (!(o1 == rhs.o1))
+      return false;
+    return true;
+  }
+  bool operator != (const ThriftHiveMetastore_get_latest_txn_in_conflict_result &rhs) const {
+    return !(*this == rhs);
+  }
+
+  bool operator < (const ThriftHiveMetastore_get_latest_txn_in_conflict_result & ) const;
+
+  uint32_t read(::apache::thrift::protocol::TProtocol* iprot);
+  uint32_t write(::apache::thrift::protocol::TProtocol* oprot) const;
+
+};
+
+typedef struct _ThriftHiveMetastore_get_latest_txn_in_conflict_presult__isset {
+  _ThriftHiveMetastore_get_latest_txn_in_conflict_presult__isset() : success(false), o1(false) {}
+  bool success :1;
+  bool o1 :1;
+} _ThriftHiveMetastore_get_latest_txn_in_conflict_presult__isset;
+
+class ThriftHiveMetastore_get_latest_txn_in_conflict_presult {
+ public:
+
+
+  virtual ~ThriftHiveMetastore_get_latest_txn_in_conflict_presult() noexcept;
+  int64_t* success;
+  MetaException o1;
+
+  _ThriftHiveMetastore_get_latest_txn_in_conflict_presult__isset __isset;
+
+  uint32_t read(::apache::thrift::protocol::TProtocol* iprot);
+
+};
+
 typedef struct _ThriftHiveMetastore_repl_tbl_writeid_state_args__isset {
   _ThriftHiveMetastore_repl_tbl_writeid_state_args__isset() : rqst(false) {}
   bool rqst :1;
@@ -31357,6 +31474,9 @@ class ThriftHiveMetastoreClient : virtual public ThriftHiveMetastoreIf, public
   void commit_txn(const CommitTxnRequest& rqst);
   void send_commit_txn(const CommitTxnRequest& rqst);
   void recv_commit_txn();
+  int64_t get_latest_txn_in_conflict(const int64_t txnId);
+  void send_get_latest_txn_in_conflict(const int64_t txnId);
+  int64_t recv_get_latest_txn_in_conflict();
   void repl_tbl_writeid_state(const ReplTblWriteIdStateRequest& rqst);
   void send_repl_tbl_writeid_state(const ReplTblWriteIdStateRequest& rqst);
   void recv_repl_tbl_writeid_state();
@@ -31771,6 +31891,7 @@ class ThriftHiveMetastoreProcessor : public  ::facebook::fb303::FacebookServiceP
   void process_abort_txn(int32_t seqid, ::apache::thrift::protocol::TProtocol* iprot, ::apache::thrift::protocol::TProtocol* oprot, void* callContext);
   void process_abort_txns(int32_t seqid, ::apache::thrift::protocol::TProtocol* iprot, ::apache::thrift::protocol::TProtocol* oprot, void* callContext);
   void process_commit_txn(int32_t seqid, ::apache::thrift::protocol::TProtocol* iprot, ::apache::thrift::protocol::TProtocol* oprot, void* callContext);
+  void process_get_latest_txn_in_conflict(int32_t seqid, ::apache::thrift::protocol::TProtocol* iprot, ::apache::thrift::protocol::TProtocol* oprot, void* callContext);
   void process_repl_tbl_writeid_state(int32_t seqid, ::apache::thrift::protocol::TProtocol* iprot, ::apache::thrift::protocol::TProtocol* oprot, void* callContext);
   void process_get_valid_write_ids(int32_t seqid, ::apache::thrift::protocol::TProtocol* iprot, ::apache::thrift::protocol::TProtocol* oprot, void* callContext);
   void process_allocate_table_write_ids(int32_t seqid, ::apache::thrift::protocol::TProtocol* iprot, ::apache::thrift::protocol::TProtocol* oprot, void* callContext);
@@ -32021,6 +32142,7 @@ class ThriftHiveMetastoreProcessor : public  ::facebook::fb303::FacebookServiceP
     processMap_["abort_txn"] = &ThriftHiveMetastoreProcessor::process_abort_txn;
     processMap_["abort_txns"] = &ThriftHiveMetastoreProcessor::process_abort_txns;
     processMap_["commit_txn"] = &ThriftHiveMetastoreProcessor::process_commit_txn;
+    processMap_["get_latest_txn_in_conflict"] = &ThriftHiveMetastoreProcessor::process_get_latest_txn_in_conflict;
     processMap_["repl_tbl_writeid_state"] = &ThriftHiveMetastoreProcessor::process_repl_tbl_writeid_state;
     processMap_["get_valid_write_ids"] = &ThriftHiveMetastoreProcessor::process_get_valid_write_ids;
     processMap_["allocate_table_write_ids"] = &ThriftHiveMetastoreProcessor::process_allocate_table_write_ids;
@@ -33737,6 +33859,15 @@ class ThriftHiveMetastoreMultiface : virtual public ThriftHiveMetastoreIf, publi
     ifaces_[i]->commit_txn(rqst);
   }
 
+  int64_t get_latest_txn_in_conflict(const int64_t txnId) {
+    size_t sz = ifaces_.size();
+    size_t i = 0;
+    for (; i < (sz - 1); ++i) {
+      ifaces_[i]->get_latest_txn_in_conflict(txnId);
+    }
+    return ifaces_[i]->get_latest_txn_in_conflict(txnId);
+  }
+
   void repl_tbl_writeid_state(const ReplTblWriteIdStateRequest& rqst) {
     size_t sz = ifaces_.size();
     size_t i = 0;
@@ -35018,6 +35149,9 @@ class ThriftHiveMetastoreConcurrentClient : virtual public ThriftHiveMetastoreIf
   void commit_txn(const CommitTxnRequest& rqst);
   int32_t send_commit_txn(const CommitTxnRequest& rqst);
   void recv_commit_txn(const int32_t seqid);
+  int64_t get_latest_txn_in_conflict(const int64_t txnId);
+  int32_t send_get_latest_txn_in_conflict(const int64_t txnId);
+  int64_t recv_get_latest_txn_in_conflict(const int32_t seqid);
   void repl_tbl_writeid_state(const ReplTblWriteIdStateRequest& rqst);
   int32_t send_repl_tbl_writeid_state(const ReplTblWriteIdStateRequest& rqst);
   void recv_repl_tbl_writeid_state(const int32_t seqid);
diff --git a/standalone-metastore/metastore-common/src/gen/thrift/gen-cpp/ThriftHiveMetastore_server.skeleton.cpp b/standalone-metastore/metastore-common/src/gen/thrift/gen-cpp/ThriftHiveMetastore_server.skeleton.cpp
index 7371e557b0..ebadac7bb2 100644
--- a/standalone-metastore/metastore-common/src/gen/thrift/gen-cpp/ThriftHiveMetastore_server.skeleton.cpp
+++ b/standalone-metastore/metastore-common/src/gen/thrift/gen-cpp/ThriftHiveMetastore_server.skeleton.cpp
@@ -855,6 +855,11 @@ class ThriftHiveMetastoreHandler : virtual public ThriftHiveMetastoreIf {
     printf("commit_txn\n");
   }
 
+  int64_t get_latest_txn_in_conflict(const int64_t txnId) {
+    // Your implementation goes here
+    printf("get_latest_txn_in_conflict\n");
+  }
+
   void repl_tbl_writeid_state(const ReplTblWriteIdStateRequest& rqst) {
     // Your implementation goes here
     printf("repl_tbl_writeid_state\n");
diff --git a/standalone-metastore/metastore-common/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/ThriftHiveMetastore.java b/standalone-metastore/metastore-common/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/ThriftHiveMetastore.java
index 8aaaf2aa02..e762ab95f1 100644
--- a/standalone-metastore/metastore-common/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/ThriftHiveMetastore.java
+++ b/standalone-metastore/metastore-common/src/gen/thrift/gen-javabean/org/apache/hadoop/hive/metastore/api/ThriftHiveMetastore.java
@@ -349,6 +349,8 @@
 
     public void commit_txn(CommitTxnRequest rqst) throws NoSuchTxnException, TxnAbortedException, org.apache.thrift.TException;
 
+    public long get_latest_txn_in_conflict(long txnId) throws MetaException, org.apache.thrift.TException;
+
     public void repl_tbl_writeid_state(ReplTblWriteIdStateRequest rqst) throws org.apache.thrift.TException;
 
     public GetValidWriteIdsResponse get_valid_write_ids(GetValidWriteIdsRequest rqst) throws NoSuchTxnException, MetaException, org.apache.thrift.TException;
@@ -845,6 +847,8 @@
 
     public void commit_txn(CommitTxnRequest rqst, org.apache.thrift.async.AsyncMethodCallback<Void> resultHandler) throws org.apache.thrift.TException;
 
+    public void get_latest_txn_in_conflict(long txnId, org.apache.thrift.async.AsyncMethodCallback<java.lang.Long> resultHandler) throws org.apache.thrift.TException;
+
     public void repl_tbl_writeid_state(ReplTblWriteIdStateRequest rqst, org.apache.thrift.async.AsyncMethodCallback<Void> resultHandler) throws org.apache.thrift.TException;
 
     public void get_valid_write_ids(GetValidWriteIdsRequest rqst, org.apache.thrift.async.AsyncMethodCallback<GetValidWriteIdsResponse> resultHandler) throws org.apache.thrift.TException;
@@ -5921,6 +5925,32 @@ public void recv_commit_txn() throws NoSuchTxnException, TxnAbortedException, or
       return;
     }
 
+    public long get_latest_txn_in_conflict(long txnId) throws MetaException, org.apache.thrift.TException
+    {
+      send_get_latest_txn_in_conflict(txnId);
+      return recv_get_latest_txn_in_conflict();
+    }
+
+    public void send_get_latest_txn_in_conflict(long txnId) throws org.apache.thrift.TException
+    {
+      get_latest_txn_in_conflict_args args = new get_latest_txn_in_conflict_args();
+      args.setTxnId(txnId);
+      sendBase("get_latest_txn_in_conflict", args);
+    }
+
+    public long recv_get_latest_txn_in_conflict() throws MetaException, org.apache.thrift.TException
+    {
+      get_latest_txn_in_conflict_result result = new get_latest_txn_in_conflict_result();
+      receiveBase(result, "get_latest_txn_in_conflict");
+      if (result.isSetSuccess()) {
+        return result.success;
+      }
+      if (result.o1 != null) {
+        throw result.o1;
+      }
+      throw new org.apache.thrift.TApplicationException(org.apache.thrift.TApplicationException.MISSING_RESULT, "get_latest_txn_in_conflict failed: unknown result");
+    }
+
     public void repl_tbl_writeid_state(ReplTblWriteIdStateRequest rqst) throws org.apache.thrift.TException
     {
       send_repl_tbl_writeid_state(rqst);
@@ -13880,6 +13910,38 @@ public Void getResult() throws NoSuchTxnException, TxnAbortedException, org.apac
       }
     }
 
+    public void get_latest_txn_in_conflict(long txnId, org.apache.thrift.async.AsyncMethodCallback<java.lang.Long> resultHandler) throws org.apache.thrift.TException {
+      checkReady();
+      get_latest_txn_in_conflict_call method_call = new get_latest_txn_in_conflict_call(txnId, resultHandler, this, ___protocolFactory, ___transport);
+      this.___currentMethod = method_call;
+      ___manager.call(method_call);
+    }
+
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_latest_txn_in_conflict_call extends org.apache.thrift.async.TAsyncMethodCall<java.lang.Long> {
+      private long txnId;
+      public get_latest_txn_in_conflict_call(long txnId, org.apache.thrift.async.AsyncMethodCallback<java.lang.Long> resultHandler, org.apache.thrift.async.TAsyncClient client, org.apache.thrift.protocol.TProtocolFactory protocolFactory, org.apache.thrift.transport.TNonblockingTransport transport) throws org.apache.thrift.TException {
+        super(client, protocolFactory, transport, resultHandler, false);
+        this.txnId = txnId;
+      }
+
+      public void write_args(org.apache.thrift.protocol.TProtocol prot) throws org.apache.thrift.TException {
+        prot.writeMessageBegin(new org.apache.thrift.protocol.TMessage("get_latest_txn_in_conflict", org.apache.thrift.protocol.TMessageType.CALL, 0));
+        get_latest_txn_in_conflict_args args = new get_latest_txn_in_conflict_args();
+        args.setTxnId(txnId);
+        args.write(prot);
+        prot.writeMessageEnd();
+      }
+
+      public java.lang.Long getResult() throws MetaException, org.apache.thrift.TException {
+        if (getState() != org.apache.thrift.async.TAsyncMethodCall.State.RESPONSE_READ) {
+          throw new java.lang.IllegalStateException("Method call not finished!");
+        }
+        org.apache.thrift.transport.TMemoryInputTransport memoryTransport = new org.apache.thrift.transport.TMemoryInputTransport(getFrameBuffer().array());
+        org.apache.thrift.protocol.TProtocol prot = client.getProtocolFactory().getProtocol(memoryTransport);
+        return (new Client(prot)).recv_get_latest_txn_in_conflict();
+      }
+    }
+
     public void repl_tbl_writeid_state(ReplTblWriteIdStateRequest rqst, org.apache.thrift.async.AsyncMethodCallback<Void> resultHandler) throws org.apache.thrift.TException {
       checkReady();
       repl_tbl_writeid_state_call method_call = new repl_tbl_writeid_state_call(rqst, resultHandler, this, ___protocolFactory, ___transport);
@@ -16597,6 +16659,7 @@ protected Processor(I iface, java.util.Map<java.lang.String, org.apache.thrift.P
       processMap.put("abort_txn", new abort_txn());
       processMap.put("abort_txns", new abort_txns());
       processMap.put("commit_txn", new commit_txn());
+      processMap.put("get_latest_txn_in_conflict", new get_latest_txn_in_conflict());
       processMap.put("repl_tbl_writeid_state", new repl_tbl_writeid_state());
       processMap.put("get_valid_write_ids", new get_valid_write_ids());
       processMap.put("allocate_table_write_ids", new allocate_table_write_ids());
@@ -21867,6 +21930,36 @@ public commit_txn_result getResult(I iface, commit_txn_args args) throws org.apa
       }
     }
 
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_latest_txn_in_conflict<I extends Iface> extends org.apache.thrift.ProcessFunction<I, get_latest_txn_in_conflict_args> {
+      public get_latest_txn_in_conflict() {
+        super("get_latest_txn_in_conflict");
+      }
+
+      public get_latest_txn_in_conflict_args getEmptyArgsInstance() {
+        return new get_latest_txn_in_conflict_args();
+      }
+
+      protected boolean isOneway() {
+        return false;
+      }
+
+      @Override
+      protected boolean rethrowUnhandledExceptions() {
+        return false;
+      }
+
+      public get_latest_txn_in_conflict_result getResult(I iface, get_latest_txn_in_conflict_args args) throws org.apache.thrift.TException {
+        get_latest_txn_in_conflict_result result = new get_latest_txn_in_conflict_result();
+        try {
+          result.success = iface.get_latest_txn_in_conflict(args.txnId);
+          result.setSuccessIsSet(true);
+        } catch (MetaException o1) {
+          result.o1 = o1;
+        }
+        return result;
+      }
+    }
+
     @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class repl_tbl_writeid_state<I extends Iface> extends org.apache.thrift.ProcessFunction<I, repl_tbl_writeid_state_args> {
       public repl_tbl_writeid_state() {
         super("repl_tbl_writeid_state");
@@ -24375,6 +24468,7 @@ protected AsyncProcessor(I iface, java.util.Map<java.lang.String,  org.apache.th
       processMap.put("abort_txn", new abort_txn());
       processMap.put("abort_txns", new abort_txns());
       processMap.put("commit_txn", new commit_txn());
+      processMap.put("get_latest_txn_in_conflict", new get_latest_txn_in_conflict());
       processMap.put("repl_tbl_writeid_state", new repl_tbl_writeid_state());
       processMap.put("get_valid_write_ids", new get_valid_write_ids());
       processMap.put("allocate_table_write_ids", new allocate_table_write_ids());
@@ -35976,81 +36070,22 @@ public void start(I iface, commit_txn_args args, org.apache.thrift.async.AsyncMe
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class repl_tbl_writeid_state<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, repl_tbl_writeid_state_args, Void> {
-      public repl_tbl_writeid_state() {
-        super("repl_tbl_writeid_state");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_latest_txn_in_conflict<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, get_latest_txn_in_conflict_args, java.lang.Long> {
+      public get_latest_txn_in_conflict() {
+        super("get_latest_txn_in_conflict");
       }
 
-      public repl_tbl_writeid_state_args getEmptyArgsInstance() {
-        return new repl_tbl_writeid_state_args();
+      public get_latest_txn_in_conflict_args getEmptyArgsInstance() {
+        return new get_latest_txn_in_conflict_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<Void> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
-        final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<Void>() { 
-          public void onComplete(Void o) {
-            repl_tbl_writeid_state_result result = new repl_tbl_writeid_state_result();
-            try {
-              fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
-            } catch (org.apache.thrift.transport.TTransportException e) {
-              _LOGGER.error("TTransportException writing to internal frame buffer", e);
-              fb.close();
-            } catch (java.lang.Exception e) {
-              _LOGGER.error("Exception writing to internal frame buffer", e);
-              onError(e);
-            }
-          }
-          public void onError(java.lang.Exception e) {
-            byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
-            org.apache.thrift.TSerializable msg;
-            repl_tbl_writeid_state_result result = new repl_tbl_writeid_state_result();
-            if (e instanceof org.apache.thrift.transport.TTransportException) {
-              _LOGGER.error("TTransportException inside handler", e);
-              fb.close();
-              return;
-            } else if (e instanceof org.apache.thrift.TApplicationException) {
-              _LOGGER.error("TApplicationException inside handler", e);
-              msgType = org.apache.thrift.protocol.TMessageType.EXCEPTION;
-              msg = (org.apache.thrift.TApplicationException)e;
-            } else {
-              _LOGGER.error("Exception inside handler", e);
-              msgType = org.apache.thrift.protocol.TMessageType.EXCEPTION;
-              msg = new org.apache.thrift.TApplicationException(org.apache.thrift.TApplicationException.INTERNAL_ERROR, e.getMessage());
-            }
-            try {
-              fcall.sendResponse(fb,msg,msgType,seqid);
-            } catch (java.lang.Exception ex) {
-              _LOGGER.error("Exception writing to internal frame buffer", ex);
-              fb.close();
-            }
-          }
-        };
-      }
-
-      protected boolean isOneway() {
-        return false;
-      }
-
-      public void start(I iface, repl_tbl_writeid_state_args args, org.apache.thrift.async.AsyncMethodCallback<Void> resultHandler) throws org.apache.thrift.TException {
-        iface.repl_tbl_writeid_state(args.rqst,resultHandler);
-      }
-    }
-
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_valid_write_ids<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, get_valid_write_ids_args, GetValidWriteIdsResponse> {
-      public get_valid_write_ids() {
-        super("get_valid_write_ids");
-      }
-
-      public get_valid_write_ids_args getEmptyArgsInstance() {
-        return new get_valid_write_ids_args();
-      }
-
-      public org.apache.thrift.async.AsyncMethodCallback<GetValidWriteIdsResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<java.lang.Long> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<GetValidWriteIdsResponse>() { 
-          public void onComplete(GetValidWriteIdsResponse o) {
-            get_valid_write_ids_result result = new get_valid_write_ids_result();
+        return new org.apache.thrift.async.AsyncMethodCallback<java.lang.Long>() { 
+          public void onComplete(java.lang.Long o) {
+            get_latest_txn_in_conflict_result result = new get_latest_txn_in_conflict_result();
             result.success = o;
+            result.setSuccessIsSet(true);
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
             } catch (org.apache.thrift.transport.TTransportException e) {
@@ -36064,15 +36099,11 @@ public void onComplete(GetValidWriteIdsResponse o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            get_valid_write_ids_result result = new get_valid_write_ids_result();
-            if (e instanceof NoSuchTxnException) {
-              result.o1 = (NoSuchTxnException) e;
+            get_latest_txn_in_conflict_result result = new get_latest_txn_in_conflict_result();
+            if (e instanceof MetaException) {
+              result.o1 = (MetaException) e;
               result.setO1IsSet(true);
               msg = result;
-            } else if (e instanceof MetaException) {
-              result.o2 = (MetaException) e;
-              result.setO2IsSet(true);
-              msg = result;
             } else if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
               fb.close();
@@ -36100,26 +36131,25 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, get_valid_write_ids_args args, org.apache.thrift.async.AsyncMethodCallback<GetValidWriteIdsResponse> resultHandler) throws org.apache.thrift.TException {
-        iface.get_valid_write_ids(args.rqst,resultHandler);
+      public void start(I iface, get_latest_txn_in_conflict_args args, org.apache.thrift.async.AsyncMethodCallback<java.lang.Long> resultHandler) throws org.apache.thrift.TException {
+        iface.get_latest_txn_in_conflict(args.txnId,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class allocate_table_write_ids<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, allocate_table_write_ids_args, AllocateTableWriteIdsResponse> {
-      public allocate_table_write_ids() {
-        super("allocate_table_write_ids");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class repl_tbl_writeid_state<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, repl_tbl_writeid_state_args, Void> {
+      public repl_tbl_writeid_state() {
+        super("repl_tbl_writeid_state");
       }
 
-      public allocate_table_write_ids_args getEmptyArgsInstance() {
-        return new allocate_table_write_ids_args();
+      public repl_tbl_writeid_state_args getEmptyArgsInstance() {
+        return new repl_tbl_writeid_state_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<AllocateTableWriteIdsResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<Void> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<AllocateTableWriteIdsResponse>() { 
-          public void onComplete(AllocateTableWriteIdsResponse o) {
-            allocate_table_write_ids_result result = new allocate_table_write_ids_result();
-            result.success = o;
+        return new org.apache.thrift.async.AsyncMethodCallback<Void>() { 
+          public void onComplete(Void o) {
+            repl_tbl_writeid_state_result result = new repl_tbl_writeid_state_result();
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
             } catch (org.apache.thrift.transport.TTransportException e) {
@@ -36133,20 +36163,8 @@ public void onComplete(AllocateTableWriteIdsResponse o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            allocate_table_write_ids_result result = new allocate_table_write_ids_result();
-            if (e instanceof NoSuchTxnException) {
-              result.o1 = (NoSuchTxnException) e;
-              result.setO1IsSet(true);
-              msg = result;
-            } else if (e instanceof TxnAbortedException) {
-              result.o2 = (TxnAbortedException) e;
-              result.setO2IsSet(true);
-              msg = result;
-            } else if (e instanceof MetaException) {
-              result.o3 = (MetaException) e;
-              result.setO3IsSet(true);
-              msg = result;
-            } else if (e instanceof org.apache.thrift.transport.TTransportException) {
+            repl_tbl_writeid_state_result result = new repl_tbl_writeid_state_result();
+            if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
               fb.close();
               return;
@@ -36173,25 +36191,25 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, allocate_table_write_ids_args args, org.apache.thrift.async.AsyncMethodCallback<AllocateTableWriteIdsResponse> resultHandler) throws org.apache.thrift.TException {
-        iface.allocate_table_write_ids(args.rqst,resultHandler);
+      public void start(I iface, repl_tbl_writeid_state_args args, org.apache.thrift.async.AsyncMethodCallback<Void> resultHandler) throws org.apache.thrift.TException {
+        iface.repl_tbl_writeid_state(args.rqst,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_max_allocated_table_write_id<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, get_max_allocated_table_write_id_args, MaxAllocatedTableWriteIdResponse> {
-      public get_max_allocated_table_write_id() {
-        super("get_max_allocated_table_write_id");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_valid_write_ids<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, get_valid_write_ids_args, GetValidWriteIdsResponse> {
+      public get_valid_write_ids() {
+        super("get_valid_write_ids");
       }
 
-      public get_max_allocated_table_write_id_args getEmptyArgsInstance() {
-        return new get_max_allocated_table_write_id_args();
+      public get_valid_write_ids_args getEmptyArgsInstance() {
+        return new get_valid_write_ids_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<MaxAllocatedTableWriteIdResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<GetValidWriteIdsResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<MaxAllocatedTableWriteIdResponse>() { 
-          public void onComplete(MaxAllocatedTableWriteIdResponse o) {
-            get_max_allocated_table_write_id_result result = new get_max_allocated_table_write_id_result();
+        return new org.apache.thrift.async.AsyncMethodCallback<GetValidWriteIdsResponse>() { 
+          public void onComplete(GetValidWriteIdsResponse o) {
+            get_valid_write_ids_result result = new get_valid_write_ids_result();
             result.success = o;
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
@@ -36206,74 +36224,14 @@ public void onComplete(MaxAllocatedTableWriteIdResponse o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            get_max_allocated_table_write_id_result result = new get_max_allocated_table_write_id_result();
-            if (e instanceof MetaException) {
-              result.o1 = (MetaException) e;
+            get_valid_write_ids_result result = new get_valid_write_ids_result();
+            if (e instanceof NoSuchTxnException) {
+              result.o1 = (NoSuchTxnException) e;
               result.setO1IsSet(true);
               msg = result;
-            } else if (e instanceof org.apache.thrift.transport.TTransportException) {
-              _LOGGER.error("TTransportException inside handler", e);
-              fb.close();
-              return;
-            } else if (e instanceof org.apache.thrift.TApplicationException) {
-              _LOGGER.error("TApplicationException inside handler", e);
-              msgType = org.apache.thrift.protocol.TMessageType.EXCEPTION;
-              msg = (org.apache.thrift.TApplicationException)e;
-            } else {
-              _LOGGER.error("Exception inside handler", e);
-              msgType = org.apache.thrift.protocol.TMessageType.EXCEPTION;
-              msg = new org.apache.thrift.TApplicationException(org.apache.thrift.TApplicationException.INTERNAL_ERROR, e.getMessage());
-            }
-            try {
-              fcall.sendResponse(fb,msg,msgType,seqid);
-            } catch (java.lang.Exception ex) {
-              _LOGGER.error("Exception writing to internal frame buffer", ex);
-              fb.close();
-            }
-          }
-        };
-      }
-
-      protected boolean isOneway() {
-        return false;
-      }
-
-      public void start(I iface, get_max_allocated_table_write_id_args args, org.apache.thrift.async.AsyncMethodCallback<MaxAllocatedTableWriteIdResponse> resultHandler) throws org.apache.thrift.TException {
-        iface.get_max_allocated_table_write_id(args.rqst,resultHandler);
-      }
-    }
-
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class seed_write_id<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, seed_write_id_args, Void> {
-      public seed_write_id() {
-        super("seed_write_id");
-      }
-
-      public seed_write_id_args getEmptyArgsInstance() {
-        return new seed_write_id_args();
-      }
-
-      public org.apache.thrift.async.AsyncMethodCallback<Void> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
-        final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<Void>() { 
-          public void onComplete(Void o) {
-            seed_write_id_result result = new seed_write_id_result();
-            try {
-              fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
-            } catch (org.apache.thrift.transport.TTransportException e) {
-              _LOGGER.error("TTransportException writing to internal frame buffer", e);
-              fb.close();
-            } catch (java.lang.Exception e) {
-              _LOGGER.error("Exception writing to internal frame buffer", e);
-              onError(e);
-            }
-          }
-          public void onError(java.lang.Exception e) {
-            byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
-            org.apache.thrift.TSerializable msg;
-            seed_write_id_result result = new seed_write_id_result();
-            if (e instanceof MetaException) {
-              result.o1 = (MetaException) e;
-              result.setO1IsSet(true);
+            } else if (e instanceof MetaException) {
+              result.o2 = (MetaException) e;
+              result.setO2IsSet(true);
               msg = result;
             } else if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
@@ -36302,25 +36260,26 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, seed_write_id_args args, org.apache.thrift.async.AsyncMethodCallback<Void> resultHandler) throws org.apache.thrift.TException {
-        iface.seed_write_id(args.rqst,resultHandler);
+      public void start(I iface, get_valid_write_ids_args args, org.apache.thrift.async.AsyncMethodCallback<GetValidWriteIdsResponse> resultHandler) throws org.apache.thrift.TException {
+        iface.get_valid_write_ids(args.rqst,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class seed_txn_id<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, seed_txn_id_args, Void> {
-      public seed_txn_id() {
-        super("seed_txn_id");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class allocate_table_write_ids<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, allocate_table_write_ids_args, AllocateTableWriteIdsResponse> {
+      public allocate_table_write_ids() {
+        super("allocate_table_write_ids");
       }
 
-      public seed_txn_id_args getEmptyArgsInstance() {
-        return new seed_txn_id_args();
+      public allocate_table_write_ids_args getEmptyArgsInstance() {
+        return new allocate_table_write_ids_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<Void> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<AllocateTableWriteIdsResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<Void>() { 
-          public void onComplete(Void o) {
-            seed_txn_id_result result = new seed_txn_id_result();
+        return new org.apache.thrift.async.AsyncMethodCallback<AllocateTableWriteIdsResponse>() { 
+          public void onComplete(AllocateTableWriteIdsResponse o) {
+            allocate_table_write_ids_result result = new allocate_table_write_ids_result();
+            result.success = o;
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
             } catch (org.apache.thrift.transport.TTransportException e) {
@@ -36334,11 +36293,19 @@ public void onComplete(Void o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            seed_txn_id_result result = new seed_txn_id_result();
-            if (e instanceof MetaException) {
-              result.o1 = (MetaException) e;
+            allocate_table_write_ids_result result = new allocate_table_write_ids_result();
+            if (e instanceof NoSuchTxnException) {
+              result.o1 = (NoSuchTxnException) e;
               result.setO1IsSet(true);
               msg = result;
+            } else if (e instanceof TxnAbortedException) {
+              result.o2 = (TxnAbortedException) e;
+              result.setO2IsSet(true);
+              msg = result;
+            } else if (e instanceof MetaException) {
+              result.o3 = (MetaException) e;
+              result.setO3IsSet(true);
+              msg = result;
             } else if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
               fb.close();
@@ -36366,25 +36333,25 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, seed_txn_id_args args, org.apache.thrift.async.AsyncMethodCallback<Void> resultHandler) throws org.apache.thrift.TException {
-        iface.seed_txn_id(args.rqst,resultHandler);
+      public void start(I iface, allocate_table_write_ids_args args, org.apache.thrift.async.AsyncMethodCallback<AllocateTableWriteIdsResponse> resultHandler) throws org.apache.thrift.TException {
+        iface.allocate_table_write_ids(args.rqst,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class lock<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, lock_args, LockResponse> {
-      public lock() {
-        super("lock");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_max_allocated_table_write_id<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, get_max_allocated_table_write_id_args, MaxAllocatedTableWriteIdResponse> {
+      public get_max_allocated_table_write_id() {
+        super("get_max_allocated_table_write_id");
       }
 
-      public lock_args getEmptyArgsInstance() {
-        return new lock_args();
+      public get_max_allocated_table_write_id_args getEmptyArgsInstance() {
+        return new get_max_allocated_table_write_id_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<LockResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<MaxAllocatedTableWriteIdResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<LockResponse>() { 
-          public void onComplete(LockResponse o) {
-            lock_result result = new lock_result();
+        return new org.apache.thrift.async.AsyncMethodCallback<MaxAllocatedTableWriteIdResponse>() { 
+          public void onComplete(MaxAllocatedTableWriteIdResponse o) {
+            get_max_allocated_table_write_id_result result = new get_max_allocated_table_write_id_result();
             result.success = o;
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
@@ -36399,15 +36366,11 @@ public void onComplete(LockResponse o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            lock_result result = new lock_result();
-            if (e instanceof NoSuchTxnException) {
-              result.o1 = (NoSuchTxnException) e;
+            get_max_allocated_table_write_id_result result = new get_max_allocated_table_write_id_result();
+            if (e instanceof MetaException) {
+              result.o1 = (MetaException) e;
               result.setO1IsSet(true);
               msg = result;
-            } else if (e instanceof TxnAbortedException) {
-              result.o2 = (TxnAbortedException) e;
-              result.setO2IsSet(true);
-              msg = result;
             } else if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
               fb.close();
@@ -36435,26 +36398,25 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, lock_args args, org.apache.thrift.async.AsyncMethodCallback<LockResponse> resultHandler) throws org.apache.thrift.TException {
-        iface.lock(args.rqst,resultHandler);
+      public void start(I iface, get_max_allocated_table_write_id_args args, org.apache.thrift.async.AsyncMethodCallback<MaxAllocatedTableWriteIdResponse> resultHandler) throws org.apache.thrift.TException {
+        iface.get_max_allocated_table_write_id(args.rqst,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class check_lock<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, check_lock_args, LockResponse> {
-      public check_lock() {
-        super("check_lock");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class seed_write_id<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, seed_write_id_args, Void> {
+      public seed_write_id() {
+        super("seed_write_id");
       }
 
-      public check_lock_args getEmptyArgsInstance() {
-        return new check_lock_args();
+      public seed_write_id_args getEmptyArgsInstance() {
+        return new seed_write_id_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<LockResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<Void> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<LockResponse>() { 
-          public void onComplete(LockResponse o) {
-            check_lock_result result = new check_lock_result();
-            result.success = o;
+        return new org.apache.thrift.async.AsyncMethodCallback<Void>() { 
+          public void onComplete(Void o) {
+            seed_write_id_result result = new seed_write_id_result();
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
             } catch (org.apache.thrift.transport.TTransportException e) {
@@ -36468,19 +36430,11 @@ public void onComplete(LockResponse o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            check_lock_result result = new check_lock_result();
-            if (e instanceof NoSuchTxnException) {
-              result.o1 = (NoSuchTxnException) e;
+            seed_write_id_result result = new seed_write_id_result();
+            if (e instanceof MetaException) {
+              result.o1 = (MetaException) e;
               result.setO1IsSet(true);
               msg = result;
-            } else if (e instanceof TxnAbortedException) {
-              result.o2 = (TxnAbortedException) e;
-              result.setO2IsSet(true);
-              msg = result;
-            } else if (e instanceof NoSuchLockException) {
-              result.o3 = (NoSuchLockException) e;
-              result.setO3IsSet(true);
-              msg = result;
             } else if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
               fb.close();
@@ -36508,25 +36462,25 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, check_lock_args args, org.apache.thrift.async.AsyncMethodCallback<LockResponse> resultHandler) throws org.apache.thrift.TException {
-        iface.check_lock(args.rqst,resultHandler);
+      public void start(I iface, seed_write_id_args args, org.apache.thrift.async.AsyncMethodCallback<Void> resultHandler) throws org.apache.thrift.TException {
+        iface.seed_write_id(args.rqst,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class unlock<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, unlock_args, Void> {
-      public unlock() {
-        super("unlock");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class seed_txn_id<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, seed_txn_id_args, Void> {
+      public seed_txn_id() {
+        super("seed_txn_id");
       }
 
-      public unlock_args getEmptyArgsInstance() {
-        return new unlock_args();
+      public seed_txn_id_args getEmptyArgsInstance() {
+        return new seed_txn_id_args();
       }
 
       public org.apache.thrift.async.AsyncMethodCallback<Void> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
         return new org.apache.thrift.async.AsyncMethodCallback<Void>() { 
           public void onComplete(Void o) {
-            unlock_result result = new unlock_result();
+            seed_txn_id_result result = new seed_txn_id_result();
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
             } catch (org.apache.thrift.transport.TTransportException e) {
@@ -36540,15 +36494,11 @@ public void onComplete(Void o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            unlock_result result = new unlock_result();
-            if (e instanceof NoSuchLockException) {
-              result.o1 = (NoSuchLockException) e;
+            seed_txn_id_result result = new seed_txn_id_result();
+            if (e instanceof MetaException) {
+              result.o1 = (MetaException) e;
               result.setO1IsSet(true);
               msg = result;
-            } else if (e instanceof TxnOpenException) {
-              result.o2 = (TxnOpenException) e;
-              result.setO2IsSet(true);
-              msg = result;
             } else if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
               fb.close();
@@ -36576,25 +36526,25 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, unlock_args args, org.apache.thrift.async.AsyncMethodCallback<Void> resultHandler) throws org.apache.thrift.TException {
-        iface.unlock(args.rqst,resultHandler);
+      public void start(I iface, seed_txn_id_args args, org.apache.thrift.async.AsyncMethodCallback<Void> resultHandler) throws org.apache.thrift.TException {
+        iface.seed_txn_id(args.rqst,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class show_locks<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, show_locks_args, ShowLocksResponse> {
-      public show_locks() {
-        super("show_locks");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class lock<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, lock_args, LockResponse> {
+      public lock() {
+        super("lock");
       }
 
-      public show_locks_args getEmptyArgsInstance() {
-        return new show_locks_args();
+      public lock_args getEmptyArgsInstance() {
+        return new lock_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<ShowLocksResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<LockResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<ShowLocksResponse>() { 
-          public void onComplete(ShowLocksResponse o) {
-            show_locks_result result = new show_locks_result();
+        return new org.apache.thrift.async.AsyncMethodCallback<LockResponse>() { 
+          public void onComplete(LockResponse o) {
+            lock_result result = new lock_result();
             result.success = o;
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
@@ -36609,8 +36559,16 @@ public void onComplete(ShowLocksResponse o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            show_locks_result result = new show_locks_result();
-            if (e instanceof org.apache.thrift.transport.TTransportException) {
+            lock_result result = new lock_result();
+            if (e instanceof NoSuchTxnException) {
+              result.o1 = (NoSuchTxnException) e;
+              result.setO1IsSet(true);
+              msg = result;
+            } else if (e instanceof TxnAbortedException) {
+              result.o2 = (TxnAbortedException) e;
+              result.setO2IsSet(true);
+              msg = result;
+            } else if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
               fb.close();
               return;
@@ -36637,25 +36595,26 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, show_locks_args args, org.apache.thrift.async.AsyncMethodCallback<ShowLocksResponse> resultHandler) throws org.apache.thrift.TException {
-        iface.show_locks(args.rqst,resultHandler);
+      public void start(I iface, lock_args args, org.apache.thrift.async.AsyncMethodCallback<LockResponse> resultHandler) throws org.apache.thrift.TException {
+        iface.lock(args.rqst,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class heartbeat<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, heartbeat_args, Void> {
-      public heartbeat() {
-        super("heartbeat");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class check_lock<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, check_lock_args, LockResponse> {
+      public check_lock() {
+        super("check_lock");
       }
 
-      public heartbeat_args getEmptyArgsInstance() {
-        return new heartbeat_args();
+      public check_lock_args getEmptyArgsInstance() {
+        return new check_lock_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<Void> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<LockResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<Void>() { 
-          public void onComplete(Void o) {
-            heartbeat_result result = new heartbeat_result();
+        return new org.apache.thrift.async.AsyncMethodCallback<LockResponse>() { 
+          public void onComplete(LockResponse o) {
+            check_lock_result result = new check_lock_result();
+            result.success = o;
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
             } catch (org.apache.thrift.transport.TTransportException e) {
@@ -36669,17 +36628,17 @@ public void onComplete(Void o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            heartbeat_result result = new heartbeat_result();
-            if (e instanceof NoSuchLockException) {
-              result.o1 = (NoSuchLockException) e;
+            check_lock_result result = new check_lock_result();
+            if (e instanceof NoSuchTxnException) {
+              result.o1 = (NoSuchTxnException) e;
               result.setO1IsSet(true);
               msg = result;
-            } else if (e instanceof NoSuchTxnException) {
-              result.o2 = (NoSuchTxnException) e;
+            } else if (e instanceof TxnAbortedException) {
+              result.o2 = (TxnAbortedException) e;
               result.setO2IsSet(true);
               msg = result;
-            } else if (e instanceof TxnAbortedException) {
-              result.o3 = (TxnAbortedException) e;
+            } else if (e instanceof NoSuchLockException) {
+              result.o3 = (NoSuchLockException) e;
               result.setO3IsSet(true);
               msg = result;
             } else if (e instanceof org.apache.thrift.transport.TTransportException) {
@@ -36709,26 +36668,25 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, heartbeat_args args, org.apache.thrift.async.AsyncMethodCallback<Void> resultHandler) throws org.apache.thrift.TException {
-        iface.heartbeat(args.ids,resultHandler);
+      public void start(I iface, check_lock_args args, org.apache.thrift.async.AsyncMethodCallback<LockResponse> resultHandler) throws org.apache.thrift.TException {
+        iface.check_lock(args.rqst,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class heartbeat_txn_range<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, heartbeat_txn_range_args, HeartbeatTxnRangeResponse> {
-      public heartbeat_txn_range() {
-        super("heartbeat_txn_range");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class unlock<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, unlock_args, Void> {
+      public unlock() {
+        super("unlock");
       }
 
-      public heartbeat_txn_range_args getEmptyArgsInstance() {
-        return new heartbeat_txn_range_args();
+      public unlock_args getEmptyArgsInstance() {
+        return new unlock_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<HeartbeatTxnRangeResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<Void> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<HeartbeatTxnRangeResponse>() { 
-          public void onComplete(HeartbeatTxnRangeResponse o) {
-            heartbeat_txn_range_result result = new heartbeat_txn_range_result();
-            result.success = o;
+        return new org.apache.thrift.async.AsyncMethodCallback<Void>() { 
+          public void onComplete(Void o) {
+            unlock_result result = new unlock_result();
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
             } catch (org.apache.thrift.transport.TTransportException e) {
@@ -36742,8 +36700,16 @@ public void onComplete(HeartbeatTxnRangeResponse o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            heartbeat_txn_range_result result = new heartbeat_txn_range_result();
-            if (e instanceof org.apache.thrift.transport.TTransportException) {
+            unlock_result result = new unlock_result();
+            if (e instanceof NoSuchLockException) {
+              result.o1 = (NoSuchLockException) e;
+              result.setO1IsSet(true);
+              msg = result;
+            } else if (e instanceof TxnOpenException) {
+              result.o2 = (TxnOpenException) e;
+              result.setO2IsSet(true);
+              msg = result;
+            } else if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
               fb.close();
               return;
@@ -36770,25 +36736,26 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, heartbeat_txn_range_args args, org.apache.thrift.async.AsyncMethodCallback<HeartbeatTxnRangeResponse> resultHandler) throws org.apache.thrift.TException {
-        iface.heartbeat_txn_range(args.txns,resultHandler);
+      public void start(I iface, unlock_args args, org.apache.thrift.async.AsyncMethodCallback<Void> resultHandler) throws org.apache.thrift.TException {
+        iface.unlock(args.rqst,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class compact<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, compact_args, Void> {
-      public compact() {
-        super("compact");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class show_locks<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, show_locks_args, ShowLocksResponse> {
+      public show_locks() {
+        super("show_locks");
       }
 
-      public compact_args getEmptyArgsInstance() {
-        return new compact_args();
+      public show_locks_args getEmptyArgsInstance() {
+        return new show_locks_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<Void> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<ShowLocksResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<Void>() { 
-          public void onComplete(Void o) {
-            compact_result result = new compact_result();
+        return new org.apache.thrift.async.AsyncMethodCallback<ShowLocksResponse>() { 
+          public void onComplete(ShowLocksResponse o) {
+            show_locks_result result = new show_locks_result();
+            result.success = o;
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
             } catch (org.apache.thrift.transport.TTransportException e) {
@@ -36802,7 +36769,7 @@ public void onComplete(Void o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            compact_result result = new compact_result();
+            show_locks_result result = new show_locks_result();
             if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
               fb.close();
@@ -36830,26 +36797,25 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, compact_args args, org.apache.thrift.async.AsyncMethodCallback<Void> resultHandler) throws org.apache.thrift.TException {
-        iface.compact(args.rqst,resultHandler);
+      public void start(I iface, show_locks_args args, org.apache.thrift.async.AsyncMethodCallback<ShowLocksResponse> resultHandler) throws org.apache.thrift.TException {
+        iface.show_locks(args.rqst,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class compact2<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, compact2_args, CompactionResponse> {
-      public compact2() {
-        super("compact2");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class heartbeat<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, heartbeat_args, Void> {
+      public heartbeat() {
+        super("heartbeat");
       }
 
-      public compact2_args getEmptyArgsInstance() {
-        return new compact2_args();
+      public heartbeat_args getEmptyArgsInstance() {
+        return new heartbeat_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<CompactionResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<Void> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<CompactionResponse>() { 
-          public void onComplete(CompactionResponse o) {
-            compact2_result result = new compact2_result();
-            result.success = o;
+        return new org.apache.thrift.async.AsyncMethodCallback<Void>() { 
+          public void onComplete(Void o) {
+            heartbeat_result result = new heartbeat_result();
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
             } catch (org.apache.thrift.transport.TTransportException e) {
@@ -36863,8 +36829,20 @@ public void onComplete(CompactionResponse o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            compact2_result result = new compact2_result();
-            if (e instanceof org.apache.thrift.transport.TTransportException) {
+            heartbeat_result result = new heartbeat_result();
+            if (e instanceof NoSuchLockException) {
+              result.o1 = (NoSuchLockException) e;
+              result.setO1IsSet(true);
+              msg = result;
+            } else if (e instanceof NoSuchTxnException) {
+              result.o2 = (NoSuchTxnException) e;
+              result.setO2IsSet(true);
+              msg = result;
+            } else if (e instanceof TxnAbortedException) {
+              result.o3 = (TxnAbortedException) e;
+              result.setO3IsSet(true);
+              msg = result;
+            } else if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
               fb.close();
               return;
@@ -36891,25 +36869,25 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, compact2_args args, org.apache.thrift.async.AsyncMethodCallback<CompactionResponse> resultHandler) throws org.apache.thrift.TException {
-        iface.compact2(args.rqst,resultHandler);
+      public void start(I iface, heartbeat_args args, org.apache.thrift.async.AsyncMethodCallback<Void> resultHandler) throws org.apache.thrift.TException {
+        iface.heartbeat(args.ids,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class show_compact<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, show_compact_args, ShowCompactResponse> {
-      public show_compact() {
-        super("show_compact");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class heartbeat_txn_range<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, heartbeat_txn_range_args, HeartbeatTxnRangeResponse> {
+      public heartbeat_txn_range() {
+        super("heartbeat_txn_range");
       }
 
-      public show_compact_args getEmptyArgsInstance() {
-        return new show_compact_args();
+      public heartbeat_txn_range_args getEmptyArgsInstance() {
+        return new heartbeat_txn_range_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<ShowCompactResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<HeartbeatTxnRangeResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<ShowCompactResponse>() { 
-          public void onComplete(ShowCompactResponse o) {
-            show_compact_result result = new show_compact_result();
+        return new org.apache.thrift.async.AsyncMethodCallback<HeartbeatTxnRangeResponse>() { 
+          public void onComplete(HeartbeatTxnRangeResponse o) {
+            heartbeat_txn_range_result result = new heartbeat_txn_range_result();
             result.success = o;
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
@@ -36924,7 +36902,7 @@ public void onComplete(ShowCompactResponse o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            show_compact_result result = new show_compact_result();
+            heartbeat_txn_range_result result = new heartbeat_txn_range_result();
             if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
               fb.close();
@@ -36952,25 +36930,25 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, show_compact_args args, org.apache.thrift.async.AsyncMethodCallback<ShowCompactResponse> resultHandler) throws org.apache.thrift.TException {
-        iface.show_compact(args.rqst,resultHandler);
+      public void start(I iface, heartbeat_txn_range_args args, org.apache.thrift.async.AsyncMethodCallback<HeartbeatTxnRangeResponse> resultHandler) throws org.apache.thrift.TException {
+        iface.heartbeat_txn_range(args.txns,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class add_dynamic_partitions<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, add_dynamic_partitions_args, Void> {
-      public add_dynamic_partitions() {
-        super("add_dynamic_partitions");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class compact<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, compact_args, Void> {
+      public compact() {
+        super("compact");
       }
 
-      public add_dynamic_partitions_args getEmptyArgsInstance() {
-        return new add_dynamic_partitions_args();
+      public compact_args getEmptyArgsInstance() {
+        return new compact_args();
       }
 
       public org.apache.thrift.async.AsyncMethodCallback<Void> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
         return new org.apache.thrift.async.AsyncMethodCallback<Void>() { 
           public void onComplete(Void o) {
-            add_dynamic_partitions_result result = new add_dynamic_partitions_result();
+            compact_result result = new compact_result();
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
             } catch (org.apache.thrift.transport.TTransportException e) {
@@ -36984,16 +36962,8 @@ public void onComplete(Void o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            add_dynamic_partitions_result result = new add_dynamic_partitions_result();
-            if (e instanceof NoSuchTxnException) {
-              result.o1 = (NoSuchTxnException) e;
-              result.setO1IsSet(true);
-              msg = result;
-            } else if (e instanceof TxnAbortedException) {
-              result.o2 = (TxnAbortedException) e;
-              result.setO2IsSet(true);
-              msg = result;
-            } else if (e instanceof org.apache.thrift.transport.TTransportException) {
+            compact_result result = new compact_result();
+            if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
               fb.close();
               return;
@@ -37020,25 +36990,25 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, add_dynamic_partitions_args args, org.apache.thrift.async.AsyncMethodCallback<Void> resultHandler) throws org.apache.thrift.TException {
-        iface.add_dynamic_partitions(args.rqst,resultHandler);
+      public void start(I iface, compact_args args, org.apache.thrift.async.AsyncMethodCallback<Void> resultHandler) throws org.apache.thrift.TException {
+        iface.compact(args.rqst,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class find_next_compact<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, find_next_compact_args, OptionalCompactionInfoStruct> {
-      public find_next_compact() {
-        super("find_next_compact");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class compact2<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, compact2_args, CompactionResponse> {
+      public compact2() {
+        super("compact2");
       }
 
-      public find_next_compact_args getEmptyArgsInstance() {
-        return new find_next_compact_args();
+      public compact2_args getEmptyArgsInstance() {
+        return new compact2_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<OptionalCompactionInfoStruct> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<CompactionResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<OptionalCompactionInfoStruct>() { 
-          public void onComplete(OptionalCompactionInfoStruct o) {
-            find_next_compact_result result = new find_next_compact_result();
+        return new org.apache.thrift.async.AsyncMethodCallback<CompactionResponse>() { 
+          public void onComplete(CompactionResponse o) {
+            compact2_result result = new compact2_result();
             result.success = o;
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
@@ -37053,12 +37023,8 @@ public void onComplete(OptionalCompactionInfoStruct o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            find_next_compact_result result = new find_next_compact_result();
-            if (e instanceof MetaException) {
-              result.o1 = (MetaException) e;
-              result.setO1IsSet(true);
-              msg = result;
-            } else if (e instanceof org.apache.thrift.transport.TTransportException) {
+            compact2_result result = new compact2_result();
+            if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
               fb.close();
               return;
@@ -37085,25 +37051,26 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, find_next_compact_args args, org.apache.thrift.async.AsyncMethodCallback<OptionalCompactionInfoStruct> resultHandler) throws org.apache.thrift.TException {
-        iface.find_next_compact(args.workerId,resultHandler);
+      public void start(I iface, compact2_args args, org.apache.thrift.async.AsyncMethodCallback<CompactionResponse> resultHandler) throws org.apache.thrift.TException {
+        iface.compact2(args.rqst,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class update_compactor_state<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, update_compactor_state_args, Void> {
-      public update_compactor_state() {
-        super("update_compactor_state");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class show_compact<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, show_compact_args, ShowCompactResponse> {
+      public show_compact() {
+        super("show_compact");
       }
 
-      public update_compactor_state_args getEmptyArgsInstance() {
-        return new update_compactor_state_args();
+      public show_compact_args getEmptyArgsInstance() {
+        return new show_compact_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<Void> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<ShowCompactResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<Void>() { 
-          public void onComplete(Void o) {
-            update_compactor_state_result result = new update_compactor_state_result();
+        return new org.apache.thrift.async.AsyncMethodCallback<ShowCompactResponse>() { 
+          public void onComplete(ShowCompactResponse o) {
+            show_compact_result result = new show_compact_result();
+            result.success = o;
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
             } catch (org.apache.thrift.transport.TTransportException e) {
@@ -37117,7 +37084,7 @@ public void onComplete(Void o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            update_compactor_state_result result = new update_compactor_state_result();
+            show_compact_result result = new show_compact_result();
             if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
               fb.close();
@@ -37145,26 +37112,25 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, update_compactor_state_args args, org.apache.thrift.async.AsyncMethodCallback<Void> resultHandler) throws org.apache.thrift.TException {
-        iface.update_compactor_state(args.cr, args.txn_id,resultHandler);
+      public void start(I iface, show_compact_args args, org.apache.thrift.async.AsyncMethodCallback<ShowCompactResponse> resultHandler) throws org.apache.thrift.TException {
+        iface.show_compact(args.rqst,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class find_columns_with_stats<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, find_columns_with_stats_args, java.util.List<java.lang.String>> {
-      public find_columns_with_stats() {
-        super("find_columns_with_stats");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class add_dynamic_partitions<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, add_dynamic_partitions_args, Void> {
+      public add_dynamic_partitions() {
+        super("add_dynamic_partitions");
       }
 
-      public find_columns_with_stats_args getEmptyArgsInstance() {
-        return new find_columns_with_stats_args();
+      public add_dynamic_partitions_args getEmptyArgsInstance() {
+        return new add_dynamic_partitions_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<java.util.List<java.lang.String>> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<Void> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<java.util.List<java.lang.String>>() { 
-          public void onComplete(java.util.List<java.lang.String> o) {
-            find_columns_with_stats_result result = new find_columns_with_stats_result();
-            result.success = o;
+        return new org.apache.thrift.async.AsyncMethodCallback<Void>() { 
+          public void onComplete(Void o) {
+            add_dynamic_partitions_result result = new add_dynamic_partitions_result();
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
             } catch (org.apache.thrift.transport.TTransportException e) {
@@ -37178,8 +37144,16 @@ public void onComplete(java.util.List<java.lang.String> o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            find_columns_with_stats_result result = new find_columns_with_stats_result();
-            if (e instanceof org.apache.thrift.transport.TTransportException) {
+            add_dynamic_partitions_result result = new add_dynamic_partitions_result();
+            if (e instanceof NoSuchTxnException) {
+              result.o1 = (NoSuchTxnException) e;
+              result.setO1IsSet(true);
+              msg = result;
+            } else if (e instanceof TxnAbortedException) {
+              result.o2 = (TxnAbortedException) e;
+              result.setO2IsSet(true);
+              msg = result;
+            } else if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
               fb.close();
               return;
@@ -37206,25 +37180,26 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, find_columns_with_stats_args args, org.apache.thrift.async.AsyncMethodCallback<java.util.List<java.lang.String>> resultHandler) throws org.apache.thrift.TException {
-        iface.find_columns_with_stats(args.cr,resultHandler);
+      public void start(I iface, add_dynamic_partitions_args args, org.apache.thrift.async.AsyncMethodCallback<Void> resultHandler) throws org.apache.thrift.TException {
+        iface.add_dynamic_partitions(args.rqst,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class mark_cleaned<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, mark_cleaned_args, Void> {
-      public mark_cleaned() {
-        super("mark_cleaned");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class find_next_compact<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, find_next_compact_args, OptionalCompactionInfoStruct> {
+      public find_next_compact() {
+        super("find_next_compact");
       }
 
-      public mark_cleaned_args getEmptyArgsInstance() {
-        return new mark_cleaned_args();
+      public find_next_compact_args getEmptyArgsInstance() {
+        return new find_next_compact_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<Void> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<OptionalCompactionInfoStruct> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<Void>() { 
-          public void onComplete(Void o) {
-            mark_cleaned_result result = new mark_cleaned_result();
+        return new org.apache.thrift.async.AsyncMethodCallback<OptionalCompactionInfoStruct>() { 
+          public void onComplete(OptionalCompactionInfoStruct o) {
+            find_next_compact_result result = new find_next_compact_result();
+            result.success = o;
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
             } catch (org.apache.thrift.transport.TTransportException e) {
@@ -37238,7 +37213,7 @@ public void onComplete(Void o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            mark_cleaned_result result = new mark_cleaned_result();
+            find_next_compact_result result = new find_next_compact_result();
             if (e instanceof MetaException) {
               result.o1 = (MetaException) e;
               result.setO1IsSet(true);
@@ -37270,25 +37245,25 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, mark_cleaned_args args, org.apache.thrift.async.AsyncMethodCallback<Void> resultHandler) throws org.apache.thrift.TException {
-        iface.mark_cleaned(args.cr,resultHandler);
+      public void start(I iface, find_next_compact_args args, org.apache.thrift.async.AsyncMethodCallback<OptionalCompactionInfoStruct> resultHandler) throws org.apache.thrift.TException {
+        iface.find_next_compact(args.workerId,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class mark_compacted<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, mark_compacted_args, Void> {
-      public mark_compacted() {
-        super("mark_compacted");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class update_compactor_state<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, update_compactor_state_args, Void> {
+      public update_compactor_state() {
+        super("update_compactor_state");
       }
 
-      public mark_compacted_args getEmptyArgsInstance() {
-        return new mark_compacted_args();
+      public update_compactor_state_args getEmptyArgsInstance() {
+        return new update_compactor_state_args();
       }
 
       public org.apache.thrift.async.AsyncMethodCallback<Void> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
         return new org.apache.thrift.async.AsyncMethodCallback<Void>() { 
           public void onComplete(Void o) {
-            mark_compacted_result result = new mark_compacted_result();
+            update_compactor_state_result result = new update_compactor_state_result();
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
             } catch (org.apache.thrift.transport.TTransportException e) {
@@ -37302,12 +37277,8 @@ public void onComplete(Void o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            mark_compacted_result result = new mark_compacted_result();
-            if (e instanceof MetaException) {
-              result.o1 = (MetaException) e;
-              result.setO1IsSet(true);
-              msg = result;
-            } else if (e instanceof org.apache.thrift.transport.TTransportException) {
+            update_compactor_state_result result = new update_compactor_state_result();
+            if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
               fb.close();
               return;
@@ -37334,25 +37305,26 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, mark_compacted_args args, org.apache.thrift.async.AsyncMethodCallback<Void> resultHandler) throws org.apache.thrift.TException {
-        iface.mark_compacted(args.cr,resultHandler);
+      public void start(I iface, update_compactor_state_args args, org.apache.thrift.async.AsyncMethodCallback<Void> resultHandler) throws org.apache.thrift.TException {
+        iface.update_compactor_state(args.cr, args.txn_id,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class mark_failed<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, mark_failed_args, Void> {
-      public mark_failed() {
-        super("mark_failed");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class find_columns_with_stats<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, find_columns_with_stats_args, java.util.List<java.lang.String>> {
+      public find_columns_with_stats() {
+        super("find_columns_with_stats");
       }
 
-      public mark_failed_args getEmptyArgsInstance() {
-        return new mark_failed_args();
+      public find_columns_with_stats_args getEmptyArgsInstance() {
+        return new find_columns_with_stats_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<Void> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<java.util.List<java.lang.String>> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<Void>() { 
-          public void onComplete(Void o) {
-            mark_failed_result result = new mark_failed_result();
+        return new org.apache.thrift.async.AsyncMethodCallback<java.util.List<java.lang.String>>() { 
+          public void onComplete(java.util.List<java.lang.String> o) {
+            find_columns_with_stats_result result = new find_columns_with_stats_result();
+            result.success = o;
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
             } catch (org.apache.thrift.transport.TTransportException e) {
@@ -37366,12 +37338,8 @@ public void onComplete(Void o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            mark_failed_result result = new mark_failed_result();
-            if (e instanceof MetaException) {
-              result.o1 = (MetaException) e;
-              result.setO1IsSet(true);
-              msg = result;
-            } else if (e instanceof org.apache.thrift.transport.TTransportException) {
+            find_columns_with_stats_result result = new find_columns_with_stats_result();
+            if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
               fb.close();
               return;
@@ -37398,25 +37366,25 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, mark_failed_args args, org.apache.thrift.async.AsyncMethodCallback<Void> resultHandler) throws org.apache.thrift.TException {
-        iface.mark_failed(args.cr,resultHandler);
+      public void start(I iface, find_columns_with_stats_args args, org.apache.thrift.async.AsyncMethodCallback<java.util.List<java.lang.String>> resultHandler) throws org.apache.thrift.TException {
+        iface.find_columns_with_stats(args.cr,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class set_hadoop_jobid<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, set_hadoop_jobid_args, Void> {
-      public set_hadoop_jobid() {
-        super("set_hadoop_jobid");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class mark_cleaned<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, mark_cleaned_args, Void> {
+      public mark_cleaned() {
+        super("mark_cleaned");
       }
 
-      public set_hadoop_jobid_args getEmptyArgsInstance() {
-        return new set_hadoop_jobid_args();
+      public mark_cleaned_args getEmptyArgsInstance() {
+        return new mark_cleaned_args();
       }
 
       public org.apache.thrift.async.AsyncMethodCallback<Void> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
         return new org.apache.thrift.async.AsyncMethodCallback<Void>() { 
           public void onComplete(Void o) {
-            set_hadoop_jobid_result result = new set_hadoop_jobid_result();
+            mark_cleaned_result result = new mark_cleaned_result();
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
             } catch (org.apache.thrift.transport.TTransportException e) {
@@ -37430,8 +37398,12 @@ public void onComplete(Void o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            set_hadoop_jobid_result result = new set_hadoop_jobid_result();
-            if (e instanceof org.apache.thrift.transport.TTransportException) {
+            mark_cleaned_result result = new mark_cleaned_result();
+            if (e instanceof MetaException) {
+              result.o1 = (MetaException) e;
+              result.setO1IsSet(true);
+              msg = result;
+            } else if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
               fb.close();
               return;
@@ -37458,26 +37430,25 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, set_hadoop_jobid_args args, org.apache.thrift.async.AsyncMethodCallback<Void> resultHandler) throws org.apache.thrift.TException {
-        iface.set_hadoop_jobid(args.jobId, args.cq_id,resultHandler);
+      public void start(I iface, mark_cleaned_args args, org.apache.thrift.async.AsyncMethodCallback<Void> resultHandler) throws org.apache.thrift.TException {
+        iface.mark_cleaned(args.cr,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_next_notification<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, get_next_notification_args, NotificationEventResponse> {
-      public get_next_notification() {
-        super("get_next_notification");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class mark_compacted<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, mark_compacted_args, Void> {
+      public mark_compacted() {
+        super("mark_compacted");
       }
 
-      public get_next_notification_args getEmptyArgsInstance() {
-        return new get_next_notification_args();
+      public mark_compacted_args getEmptyArgsInstance() {
+        return new mark_compacted_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<NotificationEventResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<Void> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<NotificationEventResponse>() { 
-          public void onComplete(NotificationEventResponse o) {
-            get_next_notification_result result = new get_next_notification_result();
-            result.success = o;
+        return new org.apache.thrift.async.AsyncMethodCallback<Void>() { 
+          public void onComplete(Void o) {
+            mark_compacted_result result = new mark_compacted_result();
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
             } catch (org.apache.thrift.transport.TTransportException e) {
@@ -37491,8 +37462,12 @@ public void onComplete(NotificationEventResponse o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            get_next_notification_result result = new get_next_notification_result();
-            if (e instanceof org.apache.thrift.transport.TTransportException) {
+            mark_compacted_result result = new mark_compacted_result();
+            if (e instanceof MetaException) {
+              result.o1 = (MetaException) e;
+              result.setO1IsSet(true);
+              msg = result;
+            } else if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
               fb.close();
               return;
@@ -37519,26 +37494,25 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, get_next_notification_args args, org.apache.thrift.async.AsyncMethodCallback<NotificationEventResponse> resultHandler) throws org.apache.thrift.TException {
-        iface.get_next_notification(args.rqst,resultHandler);
+      public void start(I iface, mark_compacted_args args, org.apache.thrift.async.AsyncMethodCallback<Void> resultHandler) throws org.apache.thrift.TException {
+        iface.mark_compacted(args.cr,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_current_notificationEventId<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, get_current_notificationEventId_args, CurrentNotificationEventId> {
-      public get_current_notificationEventId() {
-        super("get_current_notificationEventId");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class mark_failed<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, mark_failed_args, Void> {
+      public mark_failed() {
+        super("mark_failed");
       }
 
-      public get_current_notificationEventId_args getEmptyArgsInstance() {
-        return new get_current_notificationEventId_args();
+      public mark_failed_args getEmptyArgsInstance() {
+        return new mark_failed_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<CurrentNotificationEventId> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<Void> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<CurrentNotificationEventId>() { 
-          public void onComplete(CurrentNotificationEventId o) {
-            get_current_notificationEventId_result result = new get_current_notificationEventId_result();
-            result.success = o;
+        return new org.apache.thrift.async.AsyncMethodCallback<Void>() { 
+          public void onComplete(Void o) {
+            mark_failed_result result = new mark_failed_result();
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
             } catch (org.apache.thrift.transport.TTransportException e) {
@@ -37552,8 +37526,12 @@ public void onComplete(CurrentNotificationEventId o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            get_current_notificationEventId_result result = new get_current_notificationEventId_result();
-            if (e instanceof org.apache.thrift.transport.TTransportException) {
+            mark_failed_result result = new mark_failed_result();
+            if (e instanceof MetaException) {
+              result.o1 = (MetaException) e;
+              result.setO1IsSet(true);
+              msg = result;
+            } else if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
               fb.close();
               return;
@@ -37580,26 +37558,25 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, get_current_notificationEventId_args args, org.apache.thrift.async.AsyncMethodCallback<CurrentNotificationEventId> resultHandler) throws org.apache.thrift.TException {
-        iface.get_current_notificationEventId(resultHandler);
+      public void start(I iface, mark_failed_args args, org.apache.thrift.async.AsyncMethodCallback<Void> resultHandler) throws org.apache.thrift.TException {
+        iface.mark_failed(args.cr,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_notification_events_count<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, get_notification_events_count_args, NotificationEventsCountResponse> {
-      public get_notification_events_count() {
-        super("get_notification_events_count");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class set_hadoop_jobid<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, set_hadoop_jobid_args, Void> {
+      public set_hadoop_jobid() {
+        super("set_hadoop_jobid");
       }
 
-      public get_notification_events_count_args getEmptyArgsInstance() {
-        return new get_notification_events_count_args();
+      public set_hadoop_jobid_args getEmptyArgsInstance() {
+        return new set_hadoop_jobid_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<NotificationEventsCountResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<Void> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<NotificationEventsCountResponse>() { 
-          public void onComplete(NotificationEventsCountResponse o) {
-            get_notification_events_count_result result = new get_notification_events_count_result();
-            result.success = o;
+        return new org.apache.thrift.async.AsyncMethodCallback<Void>() { 
+          public void onComplete(Void o) {
+            set_hadoop_jobid_result result = new set_hadoop_jobid_result();
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
             } catch (org.apache.thrift.transport.TTransportException e) {
@@ -37613,7 +37590,7 @@ public void onComplete(NotificationEventsCountResponse o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            get_notification_events_count_result result = new get_notification_events_count_result();
+            set_hadoop_jobid_result result = new set_hadoop_jobid_result();
             if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
               fb.close();
@@ -37641,25 +37618,25 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, get_notification_events_count_args args, org.apache.thrift.async.AsyncMethodCallback<NotificationEventsCountResponse> resultHandler) throws org.apache.thrift.TException {
-        iface.get_notification_events_count(args.rqst,resultHandler);
+      public void start(I iface, set_hadoop_jobid_args args, org.apache.thrift.async.AsyncMethodCallback<Void> resultHandler) throws org.apache.thrift.TException {
+        iface.set_hadoop_jobid(args.jobId, args.cq_id,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class fire_listener_event<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, fire_listener_event_args, FireEventResponse> {
-      public fire_listener_event() {
-        super("fire_listener_event");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_next_notification<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, get_next_notification_args, NotificationEventResponse> {
+      public get_next_notification() {
+        super("get_next_notification");
       }
 
-      public fire_listener_event_args getEmptyArgsInstance() {
-        return new fire_listener_event_args();
+      public get_next_notification_args getEmptyArgsInstance() {
+        return new get_next_notification_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<FireEventResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<NotificationEventResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<FireEventResponse>() { 
-          public void onComplete(FireEventResponse o) {
-            fire_listener_event_result result = new fire_listener_event_result();
+        return new org.apache.thrift.async.AsyncMethodCallback<NotificationEventResponse>() { 
+          public void onComplete(NotificationEventResponse o) {
+            get_next_notification_result result = new get_next_notification_result();
             result.success = o;
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
@@ -37674,7 +37651,7 @@ public void onComplete(FireEventResponse o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            fire_listener_event_result result = new fire_listener_event_result();
+            get_next_notification_result result = new get_next_notification_result();
             if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
               fb.close();
@@ -37702,25 +37679,26 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, fire_listener_event_args args, org.apache.thrift.async.AsyncMethodCallback<FireEventResponse> resultHandler) throws org.apache.thrift.TException {
-        iface.fire_listener_event(args.rqst,resultHandler);
+      public void start(I iface, get_next_notification_args args, org.apache.thrift.async.AsyncMethodCallback<NotificationEventResponse> resultHandler) throws org.apache.thrift.TException {
+        iface.get_next_notification(args.rqst,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class flushCache<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, flushCache_args, Void> {
-      public flushCache() {
-        super("flushCache");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_current_notificationEventId<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, get_current_notificationEventId_args, CurrentNotificationEventId> {
+      public get_current_notificationEventId() {
+        super("get_current_notificationEventId");
       }
 
-      public flushCache_args getEmptyArgsInstance() {
-        return new flushCache_args();
+      public get_current_notificationEventId_args getEmptyArgsInstance() {
+        return new get_current_notificationEventId_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<Void> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<CurrentNotificationEventId> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<Void>() { 
-          public void onComplete(Void o) {
-            flushCache_result result = new flushCache_result();
+        return new org.apache.thrift.async.AsyncMethodCallback<CurrentNotificationEventId>() { 
+          public void onComplete(CurrentNotificationEventId o) {
+            get_current_notificationEventId_result result = new get_current_notificationEventId_result();
+            result.success = o;
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
             } catch (org.apache.thrift.transport.TTransportException e) {
@@ -37734,7 +37712,7 @@ public void onComplete(Void o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            flushCache_result result = new flushCache_result();
+            get_current_notificationEventId_result result = new get_current_notificationEventId_result();
             if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
               fb.close();
@@ -37762,25 +37740,25 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, flushCache_args args, org.apache.thrift.async.AsyncMethodCallback<Void> resultHandler) throws org.apache.thrift.TException {
-        iface.flushCache(resultHandler);
+      public void start(I iface, get_current_notificationEventId_args args, org.apache.thrift.async.AsyncMethodCallback<CurrentNotificationEventId> resultHandler) throws org.apache.thrift.TException {
+        iface.get_current_notificationEventId(resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class add_write_notification_log<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, add_write_notification_log_args, WriteNotificationLogResponse> {
-      public add_write_notification_log() {
-        super("add_write_notification_log");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_notification_events_count<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, get_notification_events_count_args, NotificationEventsCountResponse> {
+      public get_notification_events_count() {
+        super("get_notification_events_count");
       }
 
-      public add_write_notification_log_args getEmptyArgsInstance() {
-        return new add_write_notification_log_args();
+      public get_notification_events_count_args getEmptyArgsInstance() {
+        return new get_notification_events_count_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<WriteNotificationLogResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<NotificationEventsCountResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<WriteNotificationLogResponse>() { 
-          public void onComplete(WriteNotificationLogResponse o) {
-            add_write_notification_log_result result = new add_write_notification_log_result();
+        return new org.apache.thrift.async.AsyncMethodCallback<NotificationEventsCountResponse>() { 
+          public void onComplete(NotificationEventsCountResponse o) {
+            get_notification_events_count_result result = new get_notification_events_count_result();
             result.success = o;
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
@@ -37795,7 +37773,7 @@ public void onComplete(WriteNotificationLogResponse o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            add_write_notification_log_result result = new add_write_notification_log_result();
+            get_notification_events_count_result result = new get_notification_events_count_result();
             if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
               fb.close();
@@ -37823,25 +37801,25 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, add_write_notification_log_args args, org.apache.thrift.async.AsyncMethodCallback<WriteNotificationLogResponse> resultHandler) throws org.apache.thrift.TException {
-        iface.add_write_notification_log(args.rqst,resultHandler);
+      public void start(I iface, get_notification_events_count_args args, org.apache.thrift.async.AsyncMethodCallback<NotificationEventsCountResponse> resultHandler) throws org.apache.thrift.TException {
+        iface.get_notification_events_count(args.rqst,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class cm_recycle<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, cm_recycle_args, CmRecycleResponse> {
-      public cm_recycle() {
-        super("cm_recycle");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class fire_listener_event<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, fire_listener_event_args, FireEventResponse> {
+      public fire_listener_event() {
+        super("fire_listener_event");
       }
 
-      public cm_recycle_args getEmptyArgsInstance() {
-        return new cm_recycle_args();
+      public fire_listener_event_args getEmptyArgsInstance() {
+        return new fire_listener_event_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<CmRecycleResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<FireEventResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<CmRecycleResponse>() { 
-          public void onComplete(CmRecycleResponse o) {
-            cm_recycle_result result = new cm_recycle_result();
+        return new org.apache.thrift.async.AsyncMethodCallback<FireEventResponse>() { 
+          public void onComplete(FireEventResponse o) {
+            fire_listener_event_result result = new fire_listener_event_result();
             result.success = o;
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
@@ -37856,12 +37834,8 @@ public void onComplete(CmRecycleResponse o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            cm_recycle_result result = new cm_recycle_result();
-            if (e instanceof MetaException) {
-              result.o1 = (MetaException) e;
-              result.setO1IsSet(true);
-              msg = result;
-            } else if (e instanceof org.apache.thrift.transport.TTransportException) {
+            fire_listener_event_result result = new fire_listener_event_result();
+            if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
               fb.close();
               return;
@@ -37888,26 +37862,25 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, cm_recycle_args args, org.apache.thrift.async.AsyncMethodCallback<CmRecycleResponse> resultHandler) throws org.apache.thrift.TException {
-        iface.cm_recycle(args.request,resultHandler);
+      public void start(I iface, fire_listener_event_args args, org.apache.thrift.async.AsyncMethodCallback<FireEventResponse> resultHandler) throws org.apache.thrift.TException {
+        iface.fire_listener_event(args.rqst,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_file_metadata_by_expr<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, get_file_metadata_by_expr_args, GetFileMetadataByExprResult> {
-      public get_file_metadata_by_expr() {
-        super("get_file_metadata_by_expr");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class flushCache<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, flushCache_args, Void> {
+      public flushCache() {
+        super("flushCache");
       }
 
-      public get_file_metadata_by_expr_args getEmptyArgsInstance() {
-        return new get_file_metadata_by_expr_args();
+      public flushCache_args getEmptyArgsInstance() {
+        return new flushCache_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<GetFileMetadataByExprResult> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<Void> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<GetFileMetadataByExprResult>() { 
-          public void onComplete(GetFileMetadataByExprResult o) {
-            get_file_metadata_by_expr_result result = new get_file_metadata_by_expr_result();
-            result.success = o;
+        return new org.apache.thrift.async.AsyncMethodCallback<Void>() { 
+          public void onComplete(Void o) {
+            flushCache_result result = new flushCache_result();
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
             } catch (org.apache.thrift.transport.TTransportException e) {
@@ -37921,7 +37894,7 @@ public void onComplete(GetFileMetadataByExprResult o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            get_file_metadata_by_expr_result result = new get_file_metadata_by_expr_result();
+            flushCache_result result = new flushCache_result();
             if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
               fb.close();
@@ -37949,25 +37922,25 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, get_file_metadata_by_expr_args args, org.apache.thrift.async.AsyncMethodCallback<GetFileMetadataByExprResult> resultHandler) throws org.apache.thrift.TException {
-        iface.get_file_metadata_by_expr(args.req,resultHandler);
+      public void start(I iface, flushCache_args args, org.apache.thrift.async.AsyncMethodCallback<Void> resultHandler) throws org.apache.thrift.TException {
+        iface.flushCache(resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_file_metadata<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, get_file_metadata_args, GetFileMetadataResult> {
-      public get_file_metadata() {
-        super("get_file_metadata");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class add_write_notification_log<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, add_write_notification_log_args, WriteNotificationLogResponse> {
+      public add_write_notification_log() {
+        super("add_write_notification_log");
       }
 
-      public get_file_metadata_args getEmptyArgsInstance() {
-        return new get_file_metadata_args();
+      public add_write_notification_log_args getEmptyArgsInstance() {
+        return new add_write_notification_log_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<GetFileMetadataResult> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<WriteNotificationLogResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<GetFileMetadataResult>() { 
-          public void onComplete(GetFileMetadataResult o) {
-            get_file_metadata_result result = new get_file_metadata_result();
+        return new org.apache.thrift.async.AsyncMethodCallback<WriteNotificationLogResponse>() { 
+          public void onComplete(WriteNotificationLogResponse o) {
+            add_write_notification_log_result result = new add_write_notification_log_result();
             result.success = o;
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
@@ -37982,7 +37955,7 @@ public void onComplete(GetFileMetadataResult o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            get_file_metadata_result result = new get_file_metadata_result();
+            add_write_notification_log_result result = new add_write_notification_log_result();
             if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
               fb.close();
@@ -38010,25 +37983,25 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, get_file_metadata_args args, org.apache.thrift.async.AsyncMethodCallback<GetFileMetadataResult> resultHandler) throws org.apache.thrift.TException {
-        iface.get_file_metadata(args.req,resultHandler);
+      public void start(I iface, add_write_notification_log_args args, org.apache.thrift.async.AsyncMethodCallback<WriteNotificationLogResponse> resultHandler) throws org.apache.thrift.TException {
+        iface.add_write_notification_log(args.rqst,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class put_file_metadata<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, put_file_metadata_args, PutFileMetadataResult> {
-      public put_file_metadata() {
-        super("put_file_metadata");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class cm_recycle<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, cm_recycle_args, CmRecycleResponse> {
+      public cm_recycle() {
+        super("cm_recycle");
       }
 
-      public put_file_metadata_args getEmptyArgsInstance() {
-        return new put_file_metadata_args();
+      public cm_recycle_args getEmptyArgsInstance() {
+        return new cm_recycle_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<PutFileMetadataResult> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<CmRecycleResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<PutFileMetadataResult>() { 
-          public void onComplete(PutFileMetadataResult o) {
-            put_file_metadata_result result = new put_file_metadata_result();
+        return new org.apache.thrift.async.AsyncMethodCallback<CmRecycleResponse>() { 
+          public void onComplete(CmRecycleResponse o) {
+            cm_recycle_result result = new cm_recycle_result();
             result.success = o;
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
@@ -38043,8 +38016,12 @@ public void onComplete(PutFileMetadataResult o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            put_file_metadata_result result = new put_file_metadata_result();
-            if (e instanceof org.apache.thrift.transport.TTransportException) {
+            cm_recycle_result result = new cm_recycle_result();
+            if (e instanceof MetaException) {
+              result.o1 = (MetaException) e;
+              result.setO1IsSet(true);
+              msg = result;
+            } else if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
               fb.close();
               return;
@@ -38071,25 +38048,25 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, put_file_metadata_args args, org.apache.thrift.async.AsyncMethodCallback<PutFileMetadataResult> resultHandler) throws org.apache.thrift.TException {
-        iface.put_file_metadata(args.req,resultHandler);
+      public void start(I iface, cm_recycle_args args, org.apache.thrift.async.AsyncMethodCallback<CmRecycleResponse> resultHandler) throws org.apache.thrift.TException {
+        iface.cm_recycle(args.request,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class clear_file_metadata<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, clear_file_metadata_args, ClearFileMetadataResult> {
-      public clear_file_metadata() {
-        super("clear_file_metadata");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_file_metadata_by_expr<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, get_file_metadata_by_expr_args, GetFileMetadataByExprResult> {
+      public get_file_metadata_by_expr() {
+        super("get_file_metadata_by_expr");
       }
 
-      public clear_file_metadata_args getEmptyArgsInstance() {
-        return new clear_file_metadata_args();
+      public get_file_metadata_by_expr_args getEmptyArgsInstance() {
+        return new get_file_metadata_by_expr_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<ClearFileMetadataResult> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<GetFileMetadataByExprResult> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<ClearFileMetadataResult>() { 
-          public void onComplete(ClearFileMetadataResult o) {
-            clear_file_metadata_result result = new clear_file_metadata_result();
+        return new org.apache.thrift.async.AsyncMethodCallback<GetFileMetadataByExprResult>() { 
+          public void onComplete(GetFileMetadataByExprResult o) {
+            get_file_metadata_by_expr_result result = new get_file_metadata_by_expr_result();
             result.success = o;
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
@@ -38104,7 +38081,7 @@ public void onComplete(ClearFileMetadataResult o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            clear_file_metadata_result result = new clear_file_metadata_result();
+            get_file_metadata_by_expr_result result = new get_file_metadata_by_expr_result();
             if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
               fb.close();
@@ -38132,25 +38109,25 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, clear_file_metadata_args args, org.apache.thrift.async.AsyncMethodCallback<ClearFileMetadataResult> resultHandler) throws org.apache.thrift.TException {
-        iface.clear_file_metadata(args.req,resultHandler);
+      public void start(I iface, get_file_metadata_by_expr_args args, org.apache.thrift.async.AsyncMethodCallback<GetFileMetadataByExprResult> resultHandler) throws org.apache.thrift.TException {
+        iface.get_file_metadata_by_expr(args.req,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class cache_file_metadata<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, cache_file_metadata_args, CacheFileMetadataResult> {
-      public cache_file_metadata() {
-        super("cache_file_metadata");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_file_metadata<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, get_file_metadata_args, GetFileMetadataResult> {
+      public get_file_metadata() {
+        super("get_file_metadata");
       }
 
-      public cache_file_metadata_args getEmptyArgsInstance() {
-        return new cache_file_metadata_args();
+      public get_file_metadata_args getEmptyArgsInstance() {
+        return new get_file_metadata_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<CacheFileMetadataResult> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<GetFileMetadataResult> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<CacheFileMetadataResult>() { 
-          public void onComplete(CacheFileMetadataResult o) {
-            cache_file_metadata_result result = new cache_file_metadata_result();
+        return new org.apache.thrift.async.AsyncMethodCallback<GetFileMetadataResult>() { 
+          public void onComplete(GetFileMetadataResult o) {
+            get_file_metadata_result result = new get_file_metadata_result();
             result.success = o;
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
@@ -38165,7 +38142,7 @@ public void onComplete(CacheFileMetadataResult o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            cache_file_metadata_result result = new cache_file_metadata_result();
+            get_file_metadata_result result = new get_file_metadata_result();
             if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
               fb.close();
@@ -38193,25 +38170,25 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, cache_file_metadata_args args, org.apache.thrift.async.AsyncMethodCallback<CacheFileMetadataResult> resultHandler) throws org.apache.thrift.TException {
-        iface.cache_file_metadata(args.req,resultHandler);
+      public void start(I iface, get_file_metadata_args args, org.apache.thrift.async.AsyncMethodCallback<GetFileMetadataResult> resultHandler) throws org.apache.thrift.TException {
+        iface.get_file_metadata(args.req,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_metastore_db_uuid<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, get_metastore_db_uuid_args, java.lang.String> {
-      public get_metastore_db_uuid() {
-        super("get_metastore_db_uuid");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class put_file_metadata<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, put_file_metadata_args, PutFileMetadataResult> {
+      public put_file_metadata() {
+        super("put_file_metadata");
       }
 
-      public get_metastore_db_uuid_args getEmptyArgsInstance() {
-        return new get_metastore_db_uuid_args();
+      public put_file_metadata_args getEmptyArgsInstance() {
+        return new put_file_metadata_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<java.lang.String> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<PutFileMetadataResult> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<java.lang.String>() { 
-          public void onComplete(java.lang.String o) {
-            get_metastore_db_uuid_result result = new get_metastore_db_uuid_result();
+        return new org.apache.thrift.async.AsyncMethodCallback<PutFileMetadataResult>() { 
+          public void onComplete(PutFileMetadataResult o) {
+            put_file_metadata_result result = new put_file_metadata_result();
             result.success = o;
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
@@ -38226,12 +38203,8 @@ public void onComplete(java.lang.String o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            get_metastore_db_uuid_result result = new get_metastore_db_uuid_result();
-            if (e instanceof MetaException) {
-              result.o1 = (MetaException) e;
-              result.setO1IsSet(true);
-              msg = result;
-            } else if (e instanceof org.apache.thrift.transport.TTransportException) {
+            put_file_metadata_result result = new put_file_metadata_result();
+            if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
               fb.close();
               return;
@@ -38258,25 +38231,25 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, get_metastore_db_uuid_args args, org.apache.thrift.async.AsyncMethodCallback<java.lang.String> resultHandler) throws org.apache.thrift.TException {
-        iface.get_metastore_db_uuid(resultHandler);
+      public void start(I iface, put_file_metadata_args args, org.apache.thrift.async.AsyncMethodCallback<PutFileMetadataResult> resultHandler) throws org.apache.thrift.TException {
+        iface.put_file_metadata(args.req,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class create_resource_plan<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, create_resource_plan_args, WMCreateResourcePlanResponse> {
-      public create_resource_plan() {
-        super("create_resource_plan");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class clear_file_metadata<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, clear_file_metadata_args, ClearFileMetadataResult> {
+      public clear_file_metadata() {
+        super("clear_file_metadata");
       }
 
-      public create_resource_plan_args getEmptyArgsInstance() {
-        return new create_resource_plan_args();
+      public clear_file_metadata_args getEmptyArgsInstance() {
+        return new clear_file_metadata_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<WMCreateResourcePlanResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<ClearFileMetadataResult> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<WMCreateResourcePlanResponse>() { 
-          public void onComplete(WMCreateResourcePlanResponse o) {
-            create_resource_plan_result result = new create_resource_plan_result();
+        return new org.apache.thrift.async.AsyncMethodCallback<ClearFileMetadataResult>() { 
+          public void onComplete(ClearFileMetadataResult o) {
+            clear_file_metadata_result result = new clear_file_metadata_result();
             result.success = o;
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
@@ -38291,20 +38264,8 @@ public void onComplete(WMCreateResourcePlanResponse o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            create_resource_plan_result result = new create_resource_plan_result();
-            if (e instanceof AlreadyExistsException) {
-              result.o1 = (AlreadyExistsException) e;
-              result.setO1IsSet(true);
-              msg = result;
-            } else if (e instanceof InvalidObjectException) {
-              result.o2 = (InvalidObjectException) e;
-              result.setO2IsSet(true);
-              msg = result;
-            } else if (e instanceof MetaException) {
-              result.o3 = (MetaException) e;
-              result.setO3IsSet(true);
-              msg = result;
-            } else if (e instanceof org.apache.thrift.transport.TTransportException) {
+            clear_file_metadata_result result = new clear_file_metadata_result();
+            if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
               fb.close();
               return;
@@ -38331,25 +38292,25 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, create_resource_plan_args args, org.apache.thrift.async.AsyncMethodCallback<WMCreateResourcePlanResponse> resultHandler) throws org.apache.thrift.TException {
-        iface.create_resource_plan(args.request,resultHandler);
+      public void start(I iface, clear_file_metadata_args args, org.apache.thrift.async.AsyncMethodCallback<ClearFileMetadataResult> resultHandler) throws org.apache.thrift.TException {
+        iface.clear_file_metadata(args.req,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_resource_plan<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, get_resource_plan_args, WMGetResourcePlanResponse> {
-      public get_resource_plan() {
-        super("get_resource_plan");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class cache_file_metadata<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, cache_file_metadata_args, CacheFileMetadataResult> {
+      public cache_file_metadata() {
+        super("cache_file_metadata");
       }
 
-      public get_resource_plan_args getEmptyArgsInstance() {
-        return new get_resource_plan_args();
+      public cache_file_metadata_args getEmptyArgsInstance() {
+        return new cache_file_metadata_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<WMGetResourcePlanResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<CacheFileMetadataResult> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<WMGetResourcePlanResponse>() { 
-          public void onComplete(WMGetResourcePlanResponse o) {
-            get_resource_plan_result result = new get_resource_plan_result();
+        return new org.apache.thrift.async.AsyncMethodCallback<CacheFileMetadataResult>() { 
+          public void onComplete(CacheFileMetadataResult o) {
+            cache_file_metadata_result result = new cache_file_metadata_result();
             result.success = o;
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
@@ -38364,16 +38325,8 @@ public void onComplete(WMGetResourcePlanResponse o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            get_resource_plan_result result = new get_resource_plan_result();
-            if (e instanceof NoSuchObjectException) {
-              result.o1 = (NoSuchObjectException) e;
-              result.setO1IsSet(true);
-              msg = result;
-            } else if (e instanceof MetaException) {
-              result.o2 = (MetaException) e;
-              result.setO2IsSet(true);
-              msg = result;
-            } else if (e instanceof org.apache.thrift.transport.TTransportException) {
+            cache_file_metadata_result result = new cache_file_metadata_result();
+            if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
               fb.close();
               return;
@@ -38400,25 +38353,25 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, get_resource_plan_args args, org.apache.thrift.async.AsyncMethodCallback<WMGetResourcePlanResponse> resultHandler) throws org.apache.thrift.TException {
-        iface.get_resource_plan(args.request,resultHandler);
+      public void start(I iface, cache_file_metadata_args args, org.apache.thrift.async.AsyncMethodCallback<CacheFileMetadataResult> resultHandler) throws org.apache.thrift.TException {
+        iface.cache_file_metadata(args.req,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_active_resource_plan<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, get_active_resource_plan_args, WMGetActiveResourcePlanResponse> {
-      public get_active_resource_plan() {
-        super("get_active_resource_plan");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_metastore_db_uuid<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, get_metastore_db_uuid_args, java.lang.String> {
+      public get_metastore_db_uuid() {
+        super("get_metastore_db_uuid");
       }
 
-      public get_active_resource_plan_args getEmptyArgsInstance() {
-        return new get_active_resource_plan_args();
+      public get_metastore_db_uuid_args getEmptyArgsInstance() {
+        return new get_metastore_db_uuid_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<WMGetActiveResourcePlanResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<java.lang.String> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<WMGetActiveResourcePlanResponse>() { 
-          public void onComplete(WMGetActiveResourcePlanResponse o) {
-            get_active_resource_plan_result result = new get_active_resource_plan_result();
+        return new org.apache.thrift.async.AsyncMethodCallback<java.lang.String>() { 
+          public void onComplete(java.lang.String o) {
+            get_metastore_db_uuid_result result = new get_metastore_db_uuid_result();
             result.success = o;
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
@@ -38433,10 +38386,10 @@ public void onComplete(WMGetActiveResourcePlanResponse o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            get_active_resource_plan_result result = new get_active_resource_plan_result();
+            get_metastore_db_uuid_result result = new get_metastore_db_uuid_result();
             if (e instanceof MetaException) {
-              result.o2 = (MetaException) e;
-              result.setO2IsSet(true);
+              result.o1 = (MetaException) e;
+              result.setO1IsSet(true);
               msg = result;
             } else if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
@@ -38465,25 +38418,25 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, get_active_resource_plan_args args, org.apache.thrift.async.AsyncMethodCallback<WMGetActiveResourcePlanResponse> resultHandler) throws org.apache.thrift.TException {
-        iface.get_active_resource_plan(args.request,resultHandler);
+      public void start(I iface, get_metastore_db_uuid_args args, org.apache.thrift.async.AsyncMethodCallback<java.lang.String> resultHandler) throws org.apache.thrift.TException {
+        iface.get_metastore_db_uuid(resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_all_resource_plans<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, get_all_resource_plans_args, WMGetAllResourcePlanResponse> {
-      public get_all_resource_plans() {
-        super("get_all_resource_plans");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class create_resource_plan<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, create_resource_plan_args, WMCreateResourcePlanResponse> {
+      public create_resource_plan() {
+        super("create_resource_plan");
       }
 
-      public get_all_resource_plans_args getEmptyArgsInstance() {
-        return new get_all_resource_plans_args();
+      public create_resource_plan_args getEmptyArgsInstance() {
+        return new create_resource_plan_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<WMGetAllResourcePlanResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<WMCreateResourcePlanResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<WMGetAllResourcePlanResponse>() { 
-          public void onComplete(WMGetAllResourcePlanResponse o) {
-            get_all_resource_plans_result result = new get_all_resource_plans_result();
+        return new org.apache.thrift.async.AsyncMethodCallback<WMCreateResourcePlanResponse>() { 
+          public void onComplete(WMCreateResourcePlanResponse o) {
+            create_resource_plan_result result = new create_resource_plan_result();
             result.success = o;
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
@@ -38498,11 +38451,19 @@ public void onComplete(WMGetAllResourcePlanResponse o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            get_all_resource_plans_result result = new get_all_resource_plans_result();
-            if (e instanceof MetaException) {
-              result.o1 = (MetaException) e;
+            create_resource_plan_result result = new create_resource_plan_result();
+            if (e instanceof AlreadyExistsException) {
+              result.o1 = (AlreadyExistsException) e;
               result.setO1IsSet(true);
               msg = result;
+            } else if (e instanceof InvalidObjectException) {
+              result.o2 = (InvalidObjectException) e;
+              result.setO2IsSet(true);
+              msg = result;
+            } else if (e instanceof MetaException) {
+              result.o3 = (MetaException) e;
+              result.setO3IsSet(true);
+              msg = result;
             } else if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
               fb.close();
@@ -38530,25 +38491,25 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, get_all_resource_plans_args args, org.apache.thrift.async.AsyncMethodCallback<WMGetAllResourcePlanResponse> resultHandler) throws org.apache.thrift.TException {
-        iface.get_all_resource_plans(args.request,resultHandler);
+      public void start(I iface, create_resource_plan_args args, org.apache.thrift.async.AsyncMethodCallback<WMCreateResourcePlanResponse> resultHandler) throws org.apache.thrift.TException {
+        iface.create_resource_plan(args.request,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class alter_resource_plan<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, alter_resource_plan_args, WMAlterResourcePlanResponse> {
-      public alter_resource_plan() {
-        super("alter_resource_plan");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_resource_plan<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, get_resource_plan_args, WMGetResourcePlanResponse> {
+      public get_resource_plan() {
+        super("get_resource_plan");
       }
 
-      public alter_resource_plan_args getEmptyArgsInstance() {
-        return new alter_resource_plan_args();
+      public get_resource_plan_args getEmptyArgsInstance() {
+        return new get_resource_plan_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<WMAlterResourcePlanResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<WMGetResourcePlanResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<WMAlterResourcePlanResponse>() { 
-          public void onComplete(WMAlterResourcePlanResponse o) {
-            alter_resource_plan_result result = new alter_resource_plan_result();
+        return new org.apache.thrift.async.AsyncMethodCallback<WMGetResourcePlanResponse>() { 
+          public void onComplete(WMGetResourcePlanResponse o) {
+            get_resource_plan_result result = new get_resource_plan_result();
             result.success = o;
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
@@ -38563,18 +38524,14 @@ public void onComplete(WMAlterResourcePlanResponse o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            alter_resource_plan_result result = new alter_resource_plan_result();
+            get_resource_plan_result result = new get_resource_plan_result();
             if (e instanceof NoSuchObjectException) {
               result.o1 = (NoSuchObjectException) e;
               result.setO1IsSet(true);
               msg = result;
-            } else if (e instanceof InvalidOperationException) {
-              result.o2 = (InvalidOperationException) e;
-              result.setO2IsSet(true);
-              msg = result;
             } else if (e instanceof MetaException) {
-              result.o3 = (MetaException) e;
-              result.setO3IsSet(true);
+              result.o2 = (MetaException) e;
+              result.setO2IsSet(true);
               msg = result;
             } else if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
@@ -38603,25 +38560,25 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, alter_resource_plan_args args, org.apache.thrift.async.AsyncMethodCallback<WMAlterResourcePlanResponse> resultHandler) throws org.apache.thrift.TException {
-        iface.alter_resource_plan(args.request,resultHandler);
+      public void start(I iface, get_resource_plan_args args, org.apache.thrift.async.AsyncMethodCallback<WMGetResourcePlanResponse> resultHandler) throws org.apache.thrift.TException {
+        iface.get_resource_plan(args.request,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class validate_resource_plan<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, validate_resource_plan_args, WMValidateResourcePlanResponse> {
-      public validate_resource_plan() {
-        super("validate_resource_plan");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_active_resource_plan<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, get_active_resource_plan_args, WMGetActiveResourcePlanResponse> {
+      public get_active_resource_plan() {
+        super("get_active_resource_plan");
       }
 
-      public validate_resource_plan_args getEmptyArgsInstance() {
-        return new validate_resource_plan_args();
+      public get_active_resource_plan_args getEmptyArgsInstance() {
+        return new get_active_resource_plan_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<WMValidateResourcePlanResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<WMGetActiveResourcePlanResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<WMValidateResourcePlanResponse>() { 
-          public void onComplete(WMValidateResourcePlanResponse o) {
-            validate_resource_plan_result result = new validate_resource_plan_result();
+        return new org.apache.thrift.async.AsyncMethodCallback<WMGetActiveResourcePlanResponse>() { 
+          public void onComplete(WMGetActiveResourcePlanResponse o) {
+            get_active_resource_plan_result result = new get_active_resource_plan_result();
             result.success = o;
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
@@ -38636,12 +38593,8 @@ public void onComplete(WMValidateResourcePlanResponse o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            validate_resource_plan_result result = new validate_resource_plan_result();
-            if (e instanceof NoSuchObjectException) {
-              result.o1 = (NoSuchObjectException) e;
-              result.setO1IsSet(true);
-              msg = result;
-            } else if (e instanceof MetaException) {
+            get_active_resource_plan_result result = new get_active_resource_plan_result();
+            if (e instanceof MetaException) {
               result.o2 = (MetaException) e;
               result.setO2IsSet(true);
               msg = result;
@@ -38672,25 +38625,25 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, validate_resource_plan_args args, org.apache.thrift.async.AsyncMethodCallback<WMValidateResourcePlanResponse> resultHandler) throws org.apache.thrift.TException {
-        iface.validate_resource_plan(args.request,resultHandler);
+      public void start(I iface, get_active_resource_plan_args args, org.apache.thrift.async.AsyncMethodCallback<WMGetActiveResourcePlanResponse> resultHandler) throws org.apache.thrift.TException {
+        iface.get_active_resource_plan(args.request,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class drop_resource_plan<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, drop_resource_plan_args, WMDropResourcePlanResponse> {
-      public drop_resource_plan() {
-        super("drop_resource_plan");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_all_resource_plans<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, get_all_resource_plans_args, WMGetAllResourcePlanResponse> {
+      public get_all_resource_plans() {
+        super("get_all_resource_plans");
       }
 
-      public drop_resource_plan_args getEmptyArgsInstance() {
-        return new drop_resource_plan_args();
+      public get_all_resource_plans_args getEmptyArgsInstance() {
+        return new get_all_resource_plans_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<WMDropResourcePlanResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<WMGetAllResourcePlanResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<WMDropResourcePlanResponse>() { 
-          public void onComplete(WMDropResourcePlanResponse o) {
-            drop_resource_plan_result result = new drop_resource_plan_result();
+        return new org.apache.thrift.async.AsyncMethodCallback<WMGetAllResourcePlanResponse>() { 
+          public void onComplete(WMGetAllResourcePlanResponse o) {
+            get_all_resource_plans_result result = new get_all_resource_plans_result();
             result.success = o;
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
@@ -38705,19 +38658,11 @@ public void onComplete(WMDropResourcePlanResponse o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            drop_resource_plan_result result = new drop_resource_plan_result();
-            if (e instanceof NoSuchObjectException) {
-              result.o1 = (NoSuchObjectException) e;
+            get_all_resource_plans_result result = new get_all_resource_plans_result();
+            if (e instanceof MetaException) {
+              result.o1 = (MetaException) e;
               result.setO1IsSet(true);
               msg = result;
-            } else if (e instanceof InvalidOperationException) {
-              result.o2 = (InvalidOperationException) e;
-              result.setO2IsSet(true);
-              msg = result;
-            } else if (e instanceof MetaException) {
-              result.o3 = (MetaException) e;
-              result.setO3IsSet(true);
-              msg = result;
             } else if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
               fb.close();
@@ -38745,25 +38690,25 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, drop_resource_plan_args args, org.apache.thrift.async.AsyncMethodCallback<WMDropResourcePlanResponse> resultHandler) throws org.apache.thrift.TException {
-        iface.drop_resource_plan(args.request,resultHandler);
+      public void start(I iface, get_all_resource_plans_args args, org.apache.thrift.async.AsyncMethodCallback<WMGetAllResourcePlanResponse> resultHandler) throws org.apache.thrift.TException {
+        iface.get_all_resource_plans(args.request,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class create_wm_trigger<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, create_wm_trigger_args, WMCreateTriggerResponse> {
-      public create_wm_trigger() {
-        super("create_wm_trigger");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class alter_resource_plan<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, alter_resource_plan_args, WMAlterResourcePlanResponse> {
+      public alter_resource_plan() {
+        super("alter_resource_plan");
       }
 
-      public create_wm_trigger_args getEmptyArgsInstance() {
-        return new create_wm_trigger_args();
+      public alter_resource_plan_args getEmptyArgsInstance() {
+        return new alter_resource_plan_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<WMCreateTriggerResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<WMAlterResourcePlanResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<WMCreateTriggerResponse>() { 
-          public void onComplete(WMCreateTriggerResponse o) {
-            create_wm_trigger_result result = new create_wm_trigger_result();
+        return new org.apache.thrift.async.AsyncMethodCallback<WMAlterResourcePlanResponse>() { 
+          public void onComplete(WMAlterResourcePlanResponse o) {
+            alter_resource_plan_result result = new alter_resource_plan_result();
             result.success = o;
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
@@ -38778,22 +38723,18 @@ public void onComplete(WMCreateTriggerResponse o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            create_wm_trigger_result result = new create_wm_trigger_result();
-            if (e instanceof AlreadyExistsException) {
-              result.o1 = (AlreadyExistsException) e;
+            alter_resource_plan_result result = new alter_resource_plan_result();
+            if (e instanceof NoSuchObjectException) {
+              result.o1 = (NoSuchObjectException) e;
               result.setO1IsSet(true);
               msg = result;
-            } else if (e instanceof NoSuchObjectException) {
-              result.o2 = (NoSuchObjectException) e;
+            } else if (e instanceof InvalidOperationException) {
+              result.o2 = (InvalidOperationException) e;
               result.setO2IsSet(true);
               msg = result;
-            } else if (e instanceof InvalidObjectException) {
-              result.o3 = (InvalidObjectException) e;
-              result.setO3IsSet(true);
-              msg = result;
             } else if (e instanceof MetaException) {
-              result.o4 = (MetaException) e;
-              result.setO4IsSet(true);
+              result.o3 = (MetaException) e;
+              result.setO3IsSet(true);
               msg = result;
             } else if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
@@ -38822,25 +38763,25 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, create_wm_trigger_args args, org.apache.thrift.async.AsyncMethodCallback<WMCreateTriggerResponse> resultHandler) throws org.apache.thrift.TException {
-        iface.create_wm_trigger(args.request,resultHandler);
+      public void start(I iface, alter_resource_plan_args args, org.apache.thrift.async.AsyncMethodCallback<WMAlterResourcePlanResponse> resultHandler) throws org.apache.thrift.TException {
+        iface.alter_resource_plan(args.request,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class alter_wm_trigger<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, alter_wm_trigger_args, WMAlterTriggerResponse> {
-      public alter_wm_trigger() {
-        super("alter_wm_trigger");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class validate_resource_plan<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, validate_resource_plan_args, WMValidateResourcePlanResponse> {
+      public validate_resource_plan() {
+        super("validate_resource_plan");
       }
 
-      public alter_wm_trigger_args getEmptyArgsInstance() {
-        return new alter_wm_trigger_args();
+      public validate_resource_plan_args getEmptyArgsInstance() {
+        return new validate_resource_plan_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<WMAlterTriggerResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<WMValidateResourcePlanResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<WMAlterTriggerResponse>() { 
-          public void onComplete(WMAlterTriggerResponse o) {
-            alter_wm_trigger_result result = new alter_wm_trigger_result();
+        return new org.apache.thrift.async.AsyncMethodCallback<WMValidateResourcePlanResponse>() { 
+          public void onComplete(WMValidateResourcePlanResponse o) {
+            validate_resource_plan_result result = new validate_resource_plan_result();
             result.success = o;
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
@@ -38855,18 +38796,14 @@ public void onComplete(WMAlterTriggerResponse o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            alter_wm_trigger_result result = new alter_wm_trigger_result();
+            validate_resource_plan_result result = new validate_resource_plan_result();
             if (e instanceof NoSuchObjectException) {
               result.o1 = (NoSuchObjectException) e;
               result.setO1IsSet(true);
               msg = result;
-            } else if (e instanceof InvalidObjectException) {
-              result.o2 = (InvalidObjectException) e;
-              result.setO2IsSet(true);
-              msg = result;
             } else if (e instanceof MetaException) {
-              result.o3 = (MetaException) e;
-              result.setO3IsSet(true);
+              result.o2 = (MetaException) e;
+              result.setO2IsSet(true);
               msg = result;
             } else if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
@@ -38895,25 +38832,25 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, alter_wm_trigger_args args, org.apache.thrift.async.AsyncMethodCallback<WMAlterTriggerResponse> resultHandler) throws org.apache.thrift.TException {
-        iface.alter_wm_trigger(args.request,resultHandler);
+      public void start(I iface, validate_resource_plan_args args, org.apache.thrift.async.AsyncMethodCallback<WMValidateResourcePlanResponse> resultHandler) throws org.apache.thrift.TException {
+        iface.validate_resource_plan(args.request,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class drop_wm_trigger<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, drop_wm_trigger_args, WMDropTriggerResponse> {
-      public drop_wm_trigger() {
-        super("drop_wm_trigger");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class drop_resource_plan<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, drop_resource_plan_args, WMDropResourcePlanResponse> {
+      public drop_resource_plan() {
+        super("drop_resource_plan");
       }
 
-      public drop_wm_trigger_args getEmptyArgsInstance() {
-        return new drop_wm_trigger_args();
+      public drop_resource_plan_args getEmptyArgsInstance() {
+        return new drop_resource_plan_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<WMDropTriggerResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<WMDropResourcePlanResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<WMDropTriggerResponse>() { 
-          public void onComplete(WMDropTriggerResponse o) {
-            drop_wm_trigger_result result = new drop_wm_trigger_result();
+        return new org.apache.thrift.async.AsyncMethodCallback<WMDropResourcePlanResponse>() { 
+          public void onComplete(WMDropResourcePlanResponse o) {
+            drop_resource_plan_result result = new drop_resource_plan_result();
             result.success = o;
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
@@ -38928,7 +38865,7 @@ public void onComplete(WMDropTriggerResponse o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            drop_wm_trigger_result result = new drop_wm_trigger_result();
+            drop_resource_plan_result result = new drop_resource_plan_result();
             if (e instanceof NoSuchObjectException) {
               result.o1 = (NoSuchObjectException) e;
               result.setO1IsSet(true);
@@ -38968,25 +38905,25 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, drop_wm_trigger_args args, org.apache.thrift.async.AsyncMethodCallback<WMDropTriggerResponse> resultHandler) throws org.apache.thrift.TException {
-        iface.drop_wm_trigger(args.request,resultHandler);
+      public void start(I iface, drop_resource_plan_args args, org.apache.thrift.async.AsyncMethodCallback<WMDropResourcePlanResponse> resultHandler) throws org.apache.thrift.TException {
+        iface.drop_resource_plan(args.request,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_triggers_for_resourceplan<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, get_triggers_for_resourceplan_args, WMGetTriggersForResourePlanResponse> {
-      public get_triggers_for_resourceplan() {
-        super("get_triggers_for_resourceplan");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class create_wm_trigger<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, create_wm_trigger_args, WMCreateTriggerResponse> {
+      public create_wm_trigger() {
+        super("create_wm_trigger");
       }
 
-      public get_triggers_for_resourceplan_args getEmptyArgsInstance() {
-        return new get_triggers_for_resourceplan_args();
+      public create_wm_trigger_args getEmptyArgsInstance() {
+        return new create_wm_trigger_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<WMGetTriggersForResourePlanResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<WMCreateTriggerResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<WMGetTriggersForResourePlanResponse>() { 
-          public void onComplete(WMGetTriggersForResourePlanResponse o) {
-            get_triggers_for_resourceplan_result result = new get_triggers_for_resourceplan_result();
+        return new org.apache.thrift.async.AsyncMethodCallback<WMCreateTriggerResponse>() { 
+          public void onComplete(WMCreateTriggerResponse o) {
+            create_wm_trigger_result result = new create_wm_trigger_result();
             result.success = o;
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
@@ -39001,15 +38938,23 @@ public void onComplete(WMGetTriggersForResourePlanResponse o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            get_triggers_for_resourceplan_result result = new get_triggers_for_resourceplan_result();
-            if (e instanceof NoSuchObjectException) {
-              result.o1 = (NoSuchObjectException) e;
+            create_wm_trigger_result result = new create_wm_trigger_result();
+            if (e instanceof AlreadyExistsException) {
+              result.o1 = (AlreadyExistsException) e;
               result.setO1IsSet(true);
               msg = result;
-            } else if (e instanceof MetaException) {
-              result.o2 = (MetaException) e;
+            } else if (e instanceof NoSuchObjectException) {
+              result.o2 = (NoSuchObjectException) e;
               result.setO2IsSet(true);
               msg = result;
+            } else if (e instanceof InvalidObjectException) {
+              result.o3 = (InvalidObjectException) e;
+              result.setO3IsSet(true);
+              msg = result;
+            } else if (e instanceof MetaException) {
+              result.o4 = (MetaException) e;
+              result.setO4IsSet(true);
+              msg = result;
             } else if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
               fb.close();
@@ -39037,25 +38982,25 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, get_triggers_for_resourceplan_args args, org.apache.thrift.async.AsyncMethodCallback<WMGetTriggersForResourePlanResponse> resultHandler) throws org.apache.thrift.TException {
-        iface.get_triggers_for_resourceplan(args.request,resultHandler);
+      public void start(I iface, create_wm_trigger_args args, org.apache.thrift.async.AsyncMethodCallback<WMCreateTriggerResponse> resultHandler) throws org.apache.thrift.TException {
+        iface.create_wm_trigger(args.request,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class create_wm_pool<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, create_wm_pool_args, WMCreatePoolResponse> {
-      public create_wm_pool() {
-        super("create_wm_pool");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class alter_wm_trigger<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, alter_wm_trigger_args, WMAlterTriggerResponse> {
+      public alter_wm_trigger() {
+        super("alter_wm_trigger");
       }
 
-      public create_wm_pool_args getEmptyArgsInstance() {
-        return new create_wm_pool_args();
+      public alter_wm_trigger_args getEmptyArgsInstance() {
+        return new alter_wm_trigger_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<WMCreatePoolResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<WMAlterTriggerResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<WMCreatePoolResponse>() { 
-          public void onComplete(WMCreatePoolResponse o) {
-            create_wm_pool_result result = new create_wm_pool_result();
+        return new org.apache.thrift.async.AsyncMethodCallback<WMAlterTriggerResponse>() { 
+          public void onComplete(WMAlterTriggerResponse o) {
+            alter_wm_trigger_result result = new alter_wm_trigger_result();
             result.success = o;
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
@@ -39070,22 +39015,18 @@ public void onComplete(WMCreatePoolResponse o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            create_wm_pool_result result = new create_wm_pool_result();
-            if (e instanceof AlreadyExistsException) {
-              result.o1 = (AlreadyExistsException) e;
+            alter_wm_trigger_result result = new alter_wm_trigger_result();
+            if (e instanceof NoSuchObjectException) {
+              result.o1 = (NoSuchObjectException) e;
               result.setO1IsSet(true);
               msg = result;
-            } else if (e instanceof NoSuchObjectException) {
-              result.o2 = (NoSuchObjectException) e;
-              result.setO2IsSet(true);
-              msg = result;
             } else if (e instanceof InvalidObjectException) {
-              result.o3 = (InvalidObjectException) e;
-              result.setO3IsSet(true);
+              result.o2 = (InvalidObjectException) e;
+              result.setO2IsSet(true);
               msg = result;
             } else if (e instanceof MetaException) {
-              result.o4 = (MetaException) e;
-              result.setO4IsSet(true);
+              result.o3 = (MetaException) e;
+              result.setO3IsSet(true);
               msg = result;
             } else if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
@@ -39114,25 +39055,25 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, create_wm_pool_args args, org.apache.thrift.async.AsyncMethodCallback<WMCreatePoolResponse> resultHandler) throws org.apache.thrift.TException {
-        iface.create_wm_pool(args.request,resultHandler);
+      public void start(I iface, alter_wm_trigger_args args, org.apache.thrift.async.AsyncMethodCallback<WMAlterTriggerResponse> resultHandler) throws org.apache.thrift.TException {
+        iface.alter_wm_trigger(args.request,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class alter_wm_pool<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, alter_wm_pool_args, WMAlterPoolResponse> {
-      public alter_wm_pool() {
-        super("alter_wm_pool");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class drop_wm_trigger<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, drop_wm_trigger_args, WMDropTriggerResponse> {
+      public drop_wm_trigger() {
+        super("drop_wm_trigger");
       }
 
-      public alter_wm_pool_args getEmptyArgsInstance() {
-        return new alter_wm_pool_args();
+      public drop_wm_trigger_args getEmptyArgsInstance() {
+        return new drop_wm_trigger_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<WMAlterPoolResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<WMDropTriggerResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<WMAlterPoolResponse>() { 
-          public void onComplete(WMAlterPoolResponse o) {
-            alter_wm_pool_result result = new alter_wm_pool_result();
+        return new org.apache.thrift.async.AsyncMethodCallback<WMDropTriggerResponse>() { 
+          public void onComplete(WMDropTriggerResponse o) {
+            drop_wm_trigger_result result = new drop_wm_trigger_result();
             result.success = o;
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
@@ -39147,22 +39088,18 @@ public void onComplete(WMAlterPoolResponse o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            alter_wm_pool_result result = new alter_wm_pool_result();
-            if (e instanceof AlreadyExistsException) {
-              result.o1 = (AlreadyExistsException) e;
+            drop_wm_trigger_result result = new drop_wm_trigger_result();
+            if (e instanceof NoSuchObjectException) {
+              result.o1 = (NoSuchObjectException) e;
               result.setO1IsSet(true);
               msg = result;
-            } else if (e instanceof NoSuchObjectException) {
-              result.o2 = (NoSuchObjectException) e;
+            } else if (e instanceof InvalidOperationException) {
+              result.o2 = (InvalidOperationException) e;
               result.setO2IsSet(true);
               msg = result;
-            } else if (e instanceof InvalidObjectException) {
-              result.o3 = (InvalidObjectException) e;
-              result.setO3IsSet(true);
-              msg = result;
             } else if (e instanceof MetaException) {
-              result.o4 = (MetaException) e;
-              result.setO4IsSet(true);
+              result.o3 = (MetaException) e;
+              result.setO3IsSet(true);
               msg = result;
             } else if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
@@ -39191,25 +39128,25 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, alter_wm_pool_args args, org.apache.thrift.async.AsyncMethodCallback<WMAlterPoolResponse> resultHandler) throws org.apache.thrift.TException {
-        iface.alter_wm_pool(args.request,resultHandler);
+      public void start(I iface, drop_wm_trigger_args args, org.apache.thrift.async.AsyncMethodCallback<WMDropTriggerResponse> resultHandler) throws org.apache.thrift.TException {
+        iface.drop_wm_trigger(args.request,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class drop_wm_pool<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, drop_wm_pool_args, WMDropPoolResponse> {
-      public drop_wm_pool() {
-        super("drop_wm_pool");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_triggers_for_resourceplan<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, get_triggers_for_resourceplan_args, WMGetTriggersForResourePlanResponse> {
+      public get_triggers_for_resourceplan() {
+        super("get_triggers_for_resourceplan");
       }
 
-      public drop_wm_pool_args getEmptyArgsInstance() {
-        return new drop_wm_pool_args();
+      public get_triggers_for_resourceplan_args getEmptyArgsInstance() {
+        return new get_triggers_for_resourceplan_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<WMDropPoolResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<WMGetTriggersForResourePlanResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<WMDropPoolResponse>() { 
-          public void onComplete(WMDropPoolResponse o) {
-            drop_wm_pool_result result = new drop_wm_pool_result();
+        return new org.apache.thrift.async.AsyncMethodCallback<WMGetTriggersForResourePlanResponse>() { 
+          public void onComplete(WMGetTriggersForResourePlanResponse o) {
+            get_triggers_for_resourceplan_result result = new get_triggers_for_resourceplan_result();
             result.success = o;
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
@@ -39224,18 +39161,14 @@ public void onComplete(WMDropPoolResponse o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            drop_wm_pool_result result = new drop_wm_pool_result();
+            get_triggers_for_resourceplan_result result = new get_triggers_for_resourceplan_result();
             if (e instanceof NoSuchObjectException) {
               result.o1 = (NoSuchObjectException) e;
               result.setO1IsSet(true);
               msg = result;
-            } else if (e instanceof InvalidOperationException) {
-              result.o2 = (InvalidOperationException) e;
-              result.setO2IsSet(true);
-              msg = result;
             } else if (e instanceof MetaException) {
-              result.o3 = (MetaException) e;
-              result.setO3IsSet(true);
+              result.o2 = (MetaException) e;
+              result.setO2IsSet(true);
               msg = result;
             } else if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
@@ -39264,25 +39197,25 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, drop_wm_pool_args args, org.apache.thrift.async.AsyncMethodCallback<WMDropPoolResponse> resultHandler) throws org.apache.thrift.TException {
-        iface.drop_wm_pool(args.request,resultHandler);
+      public void start(I iface, get_triggers_for_resourceplan_args args, org.apache.thrift.async.AsyncMethodCallback<WMGetTriggersForResourePlanResponse> resultHandler) throws org.apache.thrift.TException {
+        iface.get_triggers_for_resourceplan(args.request,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class create_or_update_wm_mapping<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, create_or_update_wm_mapping_args, WMCreateOrUpdateMappingResponse> {
-      public create_or_update_wm_mapping() {
-        super("create_or_update_wm_mapping");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class create_wm_pool<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, create_wm_pool_args, WMCreatePoolResponse> {
+      public create_wm_pool() {
+        super("create_wm_pool");
       }
 
-      public create_or_update_wm_mapping_args getEmptyArgsInstance() {
-        return new create_or_update_wm_mapping_args();
+      public create_wm_pool_args getEmptyArgsInstance() {
+        return new create_wm_pool_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<WMCreateOrUpdateMappingResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<WMCreatePoolResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<WMCreateOrUpdateMappingResponse>() { 
-          public void onComplete(WMCreateOrUpdateMappingResponse o) {
-            create_or_update_wm_mapping_result result = new create_or_update_wm_mapping_result();
+        return new org.apache.thrift.async.AsyncMethodCallback<WMCreatePoolResponse>() { 
+          public void onComplete(WMCreatePoolResponse o) {
+            create_wm_pool_result result = new create_wm_pool_result();
             result.success = o;
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
@@ -39297,7 +39230,7 @@ public void onComplete(WMCreateOrUpdateMappingResponse o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            create_or_update_wm_mapping_result result = new create_or_update_wm_mapping_result();
+            create_wm_pool_result result = new create_wm_pool_result();
             if (e instanceof AlreadyExistsException) {
               result.o1 = (AlreadyExistsException) e;
               result.setO1IsSet(true);
@@ -39341,25 +39274,25 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, create_or_update_wm_mapping_args args, org.apache.thrift.async.AsyncMethodCallback<WMCreateOrUpdateMappingResponse> resultHandler) throws org.apache.thrift.TException {
-        iface.create_or_update_wm_mapping(args.request,resultHandler);
+      public void start(I iface, create_wm_pool_args args, org.apache.thrift.async.AsyncMethodCallback<WMCreatePoolResponse> resultHandler) throws org.apache.thrift.TException {
+        iface.create_wm_pool(args.request,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class drop_wm_mapping<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, drop_wm_mapping_args, WMDropMappingResponse> {
-      public drop_wm_mapping() {
-        super("drop_wm_mapping");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class alter_wm_pool<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, alter_wm_pool_args, WMAlterPoolResponse> {
+      public alter_wm_pool() {
+        super("alter_wm_pool");
       }
 
-      public drop_wm_mapping_args getEmptyArgsInstance() {
-        return new drop_wm_mapping_args();
+      public alter_wm_pool_args getEmptyArgsInstance() {
+        return new alter_wm_pool_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<WMDropMappingResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<WMAlterPoolResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<WMDropMappingResponse>() { 
-          public void onComplete(WMDropMappingResponse o) {
-            drop_wm_mapping_result result = new drop_wm_mapping_result();
+        return new org.apache.thrift.async.AsyncMethodCallback<WMAlterPoolResponse>() { 
+          public void onComplete(WMAlterPoolResponse o) {
+            alter_wm_pool_result result = new alter_wm_pool_result();
             result.success = o;
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
@@ -39374,19 +39307,23 @@ public void onComplete(WMDropMappingResponse o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            drop_wm_mapping_result result = new drop_wm_mapping_result();
-            if (e instanceof NoSuchObjectException) {
-              result.o1 = (NoSuchObjectException) e;
+            alter_wm_pool_result result = new alter_wm_pool_result();
+            if (e instanceof AlreadyExistsException) {
+              result.o1 = (AlreadyExistsException) e;
               result.setO1IsSet(true);
               msg = result;
-            } else if (e instanceof InvalidOperationException) {
-              result.o2 = (InvalidOperationException) e;
+            } else if (e instanceof NoSuchObjectException) {
+              result.o2 = (NoSuchObjectException) e;
               result.setO2IsSet(true);
               msg = result;
-            } else if (e instanceof MetaException) {
-              result.o3 = (MetaException) e;
+            } else if (e instanceof InvalidObjectException) {
+              result.o3 = (InvalidObjectException) e;
               result.setO3IsSet(true);
               msg = result;
+            } else if (e instanceof MetaException) {
+              result.o4 = (MetaException) e;
+              result.setO4IsSet(true);
+              msg = result;
             } else if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
               fb.close();
@@ -39414,25 +39351,25 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, drop_wm_mapping_args args, org.apache.thrift.async.AsyncMethodCallback<WMDropMappingResponse> resultHandler) throws org.apache.thrift.TException {
-        iface.drop_wm_mapping(args.request,resultHandler);
+      public void start(I iface, alter_wm_pool_args args, org.apache.thrift.async.AsyncMethodCallback<WMAlterPoolResponse> resultHandler) throws org.apache.thrift.TException {
+        iface.alter_wm_pool(args.request,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class create_or_drop_wm_trigger_to_pool_mapping<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, create_or_drop_wm_trigger_to_pool_mapping_args, WMCreateOrDropTriggerToPoolMappingResponse> {
-      public create_or_drop_wm_trigger_to_pool_mapping() {
-        super("create_or_drop_wm_trigger_to_pool_mapping");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class drop_wm_pool<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, drop_wm_pool_args, WMDropPoolResponse> {
+      public drop_wm_pool() {
+        super("drop_wm_pool");
       }
 
-      public create_or_drop_wm_trigger_to_pool_mapping_args getEmptyArgsInstance() {
-        return new create_or_drop_wm_trigger_to_pool_mapping_args();
+      public drop_wm_pool_args getEmptyArgsInstance() {
+        return new drop_wm_pool_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<WMCreateOrDropTriggerToPoolMappingResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<WMDropPoolResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<WMCreateOrDropTriggerToPoolMappingResponse>() { 
-          public void onComplete(WMCreateOrDropTriggerToPoolMappingResponse o) {
-            create_or_drop_wm_trigger_to_pool_mapping_result result = new create_or_drop_wm_trigger_to_pool_mapping_result();
+        return new org.apache.thrift.async.AsyncMethodCallback<WMDropPoolResponse>() { 
+          public void onComplete(WMDropPoolResponse o) {
+            drop_wm_pool_result result = new drop_wm_pool_result();
             result.success = o;
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
@@ -39447,22 +39384,18 @@ public void onComplete(WMCreateOrDropTriggerToPoolMappingResponse o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            create_or_drop_wm_trigger_to_pool_mapping_result result = new create_or_drop_wm_trigger_to_pool_mapping_result();
-            if (e instanceof AlreadyExistsException) {
-              result.o1 = (AlreadyExistsException) e;
+            drop_wm_pool_result result = new drop_wm_pool_result();
+            if (e instanceof NoSuchObjectException) {
+              result.o1 = (NoSuchObjectException) e;
               result.setO1IsSet(true);
               msg = result;
-            } else if (e instanceof NoSuchObjectException) {
-              result.o2 = (NoSuchObjectException) e;
+            } else if (e instanceof InvalidOperationException) {
+              result.o2 = (InvalidOperationException) e;
               result.setO2IsSet(true);
               msg = result;
-            } else if (e instanceof InvalidObjectException) {
-              result.o3 = (InvalidObjectException) e;
-              result.setO3IsSet(true);
-              msg = result;
             } else if (e instanceof MetaException) {
-              result.o4 = (MetaException) e;
-              result.setO4IsSet(true);
+              result.o3 = (MetaException) e;
+              result.setO3IsSet(true);
               msg = result;
             } else if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
@@ -39491,25 +39424,26 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, create_or_drop_wm_trigger_to_pool_mapping_args args, org.apache.thrift.async.AsyncMethodCallback<WMCreateOrDropTriggerToPoolMappingResponse> resultHandler) throws org.apache.thrift.TException {
-        iface.create_or_drop_wm_trigger_to_pool_mapping(args.request,resultHandler);
+      public void start(I iface, drop_wm_pool_args args, org.apache.thrift.async.AsyncMethodCallback<WMDropPoolResponse> resultHandler) throws org.apache.thrift.TException {
+        iface.drop_wm_pool(args.request,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class create_ischema<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, create_ischema_args, Void> {
-      public create_ischema() {
-        super("create_ischema");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class create_or_update_wm_mapping<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, create_or_update_wm_mapping_args, WMCreateOrUpdateMappingResponse> {
+      public create_or_update_wm_mapping() {
+        super("create_or_update_wm_mapping");
       }
 
-      public create_ischema_args getEmptyArgsInstance() {
-        return new create_ischema_args();
+      public create_or_update_wm_mapping_args getEmptyArgsInstance() {
+        return new create_or_update_wm_mapping_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<Void> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<WMCreateOrUpdateMappingResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<Void>() { 
-          public void onComplete(Void o) {
-            create_ischema_result result = new create_ischema_result();
+        return new org.apache.thrift.async.AsyncMethodCallback<WMCreateOrUpdateMappingResponse>() { 
+          public void onComplete(WMCreateOrUpdateMappingResponse o) {
+            create_or_update_wm_mapping_result result = new create_or_update_wm_mapping_result();
+            result.success = o;
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
             } catch (org.apache.thrift.transport.TTransportException e) {
@@ -39523,7 +39457,7 @@ public void onComplete(Void o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            create_ischema_result result = new create_ischema_result();
+            create_or_update_wm_mapping_result result = new create_or_update_wm_mapping_result();
             if (e instanceof AlreadyExistsException) {
               result.o1 = (AlreadyExistsException) e;
               result.setO1IsSet(true);
@@ -39532,10 +39466,14 @@ public void onError(java.lang.Exception e) {
               result.o2 = (NoSuchObjectException) e;
               result.setO2IsSet(true);
               msg = result;
-            } else if (e instanceof MetaException) {
-              result.o3 = (MetaException) e;
+            } else if (e instanceof InvalidObjectException) {
+              result.o3 = (InvalidObjectException) e;
               result.setO3IsSet(true);
               msg = result;
+            } else if (e instanceof MetaException) {
+              result.o4 = (MetaException) e;
+              result.setO4IsSet(true);
+              msg = result;
             } else if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
               fb.close();
@@ -39563,25 +39501,26 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, create_ischema_args args, org.apache.thrift.async.AsyncMethodCallback<Void> resultHandler) throws org.apache.thrift.TException {
-        iface.create_ischema(args.schema,resultHandler);
+      public void start(I iface, create_or_update_wm_mapping_args args, org.apache.thrift.async.AsyncMethodCallback<WMCreateOrUpdateMappingResponse> resultHandler) throws org.apache.thrift.TException {
+        iface.create_or_update_wm_mapping(args.request,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class alter_ischema<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, alter_ischema_args, Void> {
-      public alter_ischema() {
-        super("alter_ischema");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class drop_wm_mapping<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, drop_wm_mapping_args, WMDropMappingResponse> {
+      public drop_wm_mapping() {
+        super("drop_wm_mapping");
       }
 
-      public alter_ischema_args getEmptyArgsInstance() {
-        return new alter_ischema_args();
+      public drop_wm_mapping_args getEmptyArgsInstance() {
+        return new drop_wm_mapping_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<Void> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<WMDropMappingResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<Void>() { 
-          public void onComplete(Void o) {
-            alter_ischema_result result = new alter_ischema_result();
+        return new org.apache.thrift.async.AsyncMethodCallback<WMDropMappingResponse>() { 
+          public void onComplete(WMDropMappingResponse o) {
+            drop_wm_mapping_result result = new drop_wm_mapping_result();
+            result.success = o;
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
             } catch (org.apache.thrift.transport.TTransportException e) {
@@ -39595,15 +39534,19 @@ public void onComplete(Void o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            alter_ischema_result result = new alter_ischema_result();
+            drop_wm_mapping_result result = new drop_wm_mapping_result();
             if (e instanceof NoSuchObjectException) {
               result.o1 = (NoSuchObjectException) e;
               result.setO1IsSet(true);
               msg = result;
-            } else if (e instanceof MetaException) {
-              result.o2 = (MetaException) e;
+            } else if (e instanceof InvalidOperationException) {
+              result.o2 = (InvalidOperationException) e;
               result.setO2IsSet(true);
               msg = result;
+            } else if (e instanceof MetaException) {
+              result.o3 = (MetaException) e;
+              result.setO3IsSet(true);
+              msg = result;
             } else if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
               fb.close();
@@ -39631,25 +39574,25 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, alter_ischema_args args, org.apache.thrift.async.AsyncMethodCallback<Void> resultHandler) throws org.apache.thrift.TException {
-        iface.alter_ischema(args.rqst,resultHandler);
+      public void start(I iface, drop_wm_mapping_args args, org.apache.thrift.async.AsyncMethodCallback<WMDropMappingResponse> resultHandler) throws org.apache.thrift.TException {
+        iface.drop_wm_mapping(args.request,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_ischema<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, get_ischema_args, ISchema> {
-      public get_ischema() {
-        super("get_ischema");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class create_or_drop_wm_trigger_to_pool_mapping<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, create_or_drop_wm_trigger_to_pool_mapping_args, WMCreateOrDropTriggerToPoolMappingResponse> {
+      public create_or_drop_wm_trigger_to_pool_mapping() {
+        super("create_or_drop_wm_trigger_to_pool_mapping");
       }
 
-      public get_ischema_args getEmptyArgsInstance() {
-        return new get_ischema_args();
+      public create_or_drop_wm_trigger_to_pool_mapping_args getEmptyArgsInstance() {
+        return new create_or_drop_wm_trigger_to_pool_mapping_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<ISchema> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<WMCreateOrDropTriggerToPoolMappingResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<ISchema>() { 
-          public void onComplete(ISchema o) {
-            get_ischema_result result = new get_ischema_result();
+        return new org.apache.thrift.async.AsyncMethodCallback<WMCreateOrDropTriggerToPoolMappingResponse>() { 
+          public void onComplete(WMCreateOrDropTriggerToPoolMappingResponse o) {
+            create_or_drop_wm_trigger_to_pool_mapping_result result = new create_or_drop_wm_trigger_to_pool_mapping_result();
             result.success = o;
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
@@ -39664,15 +39607,23 @@ public void onComplete(ISchema o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            get_ischema_result result = new get_ischema_result();
-            if (e instanceof NoSuchObjectException) {
-              result.o1 = (NoSuchObjectException) e;
+            create_or_drop_wm_trigger_to_pool_mapping_result result = new create_or_drop_wm_trigger_to_pool_mapping_result();
+            if (e instanceof AlreadyExistsException) {
+              result.o1 = (AlreadyExistsException) e;
               result.setO1IsSet(true);
               msg = result;
-            } else if (e instanceof MetaException) {
-              result.o2 = (MetaException) e;
+            } else if (e instanceof NoSuchObjectException) {
+              result.o2 = (NoSuchObjectException) e;
               result.setO2IsSet(true);
               msg = result;
+            } else if (e instanceof InvalidObjectException) {
+              result.o3 = (InvalidObjectException) e;
+              result.setO3IsSet(true);
+              msg = result;
+            } else if (e instanceof MetaException) {
+              result.o4 = (MetaException) e;
+              result.setO4IsSet(true);
+              msg = result;
             } else if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
               fb.close();
@@ -39700,25 +39651,25 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, get_ischema_args args, org.apache.thrift.async.AsyncMethodCallback<ISchema> resultHandler) throws org.apache.thrift.TException {
-        iface.get_ischema(args.name,resultHandler);
+      public void start(I iface, create_or_drop_wm_trigger_to_pool_mapping_args args, org.apache.thrift.async.AsyncMethodCallback<WMCreateOrDropTriggerToPoolMappingResponse> resultHandler) throws org.apache.thrift.TException {
+        iface.create_or_drop_wm_trigger_to_pool_mapping(args.request,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class drop_ischema<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, drop_ischema_args, Void> {
-      public drop_ischema() {
-        super("drop_ischema");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class create_ischema<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, create_ischema_args, Void> {
+      public create_ischema() {
+        super("create_ischema");
       }
 
-      public drop_ischema_args getEmptyArgsInstance() {
-        return new drop_ischema_args();
+      public create_ischema_args getEmptyArgsInstance() {
+        return new create_ischema_args();
       }
 
       public org.apache.thrift.async.AsyncMethodCallback<Void> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
         return new org.apache.thrift.async.AsyncMethodCallback<Void>() { 
           public void onComplete(Void o) {
-            drop_ischema_result result = new drop_ischema_result();
+            create_ischema_result result = new create_ischema_result();
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
             } catch (org.apache.thrift.transport.TTransportException e) {
@@ -39732,13 +39683,13 @@ public void onComplete(Void o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            drop_ischema_result result = new drop_ischema_result();
-            if (e instanceof NoSuchObjectException) {
-              result.o1 = (NoSuchObjectException) e;
+            create_ischema_result result = new create_ischema_result();
+            if (e instanceof AlreadyExistsException) {
+              result.o1 = (AlreadyExistsException) e;
               result.setO1IsSet(true);
               msg = result;
-            } else if (e instanceof InvalidOperationException) {
-              result.o2 = (InvalidOperationException) e;
+            } else if (e instanceof NoSuchObjectException) {
+              result.o2 = (NoSuchObjectException) e;
               result.setO2IsSet(true);
               msg = result;
             } else if (e instanceof MetaException) {
@@ -39772,25 +39723,25 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, drop_ischema_args args, org.apache.thrift.async.AsyncMethodCallback<Void> resultHandler) throws org.apache.thrift.TException {
-        iface.drop_ischema(args.name,resultHandler);
+      public void start(I iface, create_ischema_args args, org.apache.thrift.async.AsyncMethodCallback<Void> resultHandler) throws org.apache.thrift.TException {
+        iface.create_ischema(args.schema,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class add_schema_version<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, add_schema_version_args, Void> {
-      public add_schema_version() {
-        super("add_schema_version");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class alter_ischema<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, alter_ischema_args, Void> {
+      public alter_ischema() {
+        super("alter_ischema");
       }
 
-      public add_schema_version_args getEmptyArgsInstance() {
-        return new add_schema_version_args();
+      public alter_ischema_args getEmptyArgsInstance() {
+        return new alter_ischema_args();
       }
 
       public org.apache.thrift.async.AsyncMethodCallback<Void> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
         return new org.apache.thrift.async.AsyncMethodCallback<Void>() { 
           public void onComplete(Void o) {
-            add_schema_version_result result = new add_schema_version_result();
+            alter_ischema_result result = new alter_ischema_result();
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
             } catch (org.apache.thrift.transport.TTransportException e) {
@@ -39804,18 +39755,14 @@ public void onComplete(Void o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            add_schema_version_result result = new add_schema_version_result();
-            if (e instanceof AlreadyExistsException) {
-              result.o1 = (AlreadyExistsException) e;
+            alter_ischema_result result = new alter_ischema_result();
+            if (e instanceof NoSuchObjectException) {
+              result.o1 = (NoSuchObjectException) e;
               result.setO1IsSet(true);
               msg = result;
-            } else if (e instanceof NoSuchObjectException) {
-              result.o2 = (NoSuchObjectException) e;
-              result.setO2IsSet(true);
-              msg = result;
             } else if (e instanceof MetaException) {
-              result.o3 = (MetaException) e;
-              result.setO3IsSet(true);
+              result.o2 = (MetaException) e;
+              result.setO2IsSet(true);
               msg = result;
             } else if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
@@ -39844,25 +39791,25 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, add_schema_version_args args, org.apache.thrift.async.AsyncMethodCallback<Void> resultHandler) throws org.apache.thrift.TException {
-        iface.add_schema_version(args.schemaVersion,resultHandler);
+      public void start(I iface, alter_ischema_args args, org.apache.thrift.async.AsyncMethodCallback<Void> resultHandler) throws org.apache.thrift.TException {
+        iface.alter_ischema(args.rqst,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_schema_version<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, get_schema_version_args, SchemaVersion> {
-      public get_schema_version() {
-        super("get_schema_version");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_ischema<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, get_ischema_args, ISchema> {
+      public get_ischema() {
+        super("get_ischema");
       }
 
-      public get_schema_version_args getEmptyArgsInstance() {
-        return new get_schema_version_args();
+      public get_ischema_args getEmptyArgsInstance() {
+        return new get_ischema_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<SchemaVersion> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<ISchema> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<SchemaVersion>() { 
-          public void onComplete(SchemaVersion o) {
-            get_schema_version_result result = new get_schema_version_result();
+        return new org.apache.thrift.async.AsyncMethodCallback<ISchema>() { 
+          public void onComplete(ISchema o) {
+            get_ischema_result result = new get_ischema_result();
             result.success = o;
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
@@ -39877,7 +39824,7 @@ public void onComplete(SchemaVersion o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            get_schema_version_result result = new get_schema_version_result();
+            get_ischema_result result = new get_ischema_result();
             if (e instanceof NoSuchObjectException) {
               result.o1 = (NoSuchObjectException) e;
               result.setO1IsSet(true);
@@ -39913,26 +39860,25 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, get_schema_version_args args, org.apache.thrift.async.AsyncMethodCallback<SchemaVersion> resultHandler) throws org.apache.thrift.TException {
-        iface.get_schema_version(args.schemaVersion,resultHandler);
+      public void start(I iface, get_ischema_args args, org.apache.thrift.async.AsyncMethodCallback<ISchema> resultHandler) throws org.apache.thrift.TException {
+        iface.get_ischema(args.name,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_schema_latest_version<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, get_schema_latest_version_args, SchemaVersion> {
-      public get_schema_latest_version() {
-        super("get_schema_latest_version");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class drop_ischema<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, drop_ischema_args, Void> {
+      public drop_ischema() {
+        super("drop_ischema");
       }
 
-      public get_schema_latest_version_args getEmptyArgsInstance() {
-        return new get_schema_latest_version_args();
+      public drop_ischema_args getEmptyArgsInstance() {
+        return new drop_ischema_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<SchemaVersion> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<Void> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<SchemaVersion>() { 
-          public void onComplete(SchemaVersion o) {
-            get_schema_latest_version_result result = new get_schema_latest_version_result();
-            result.success = o;
+        return new org.apache.thrift.async.AsyncMethodCallback<Void>() { 
+          public void onComplete(Void o) {
+            drop_ischema_result result = new drop_ischema_result();
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
             } catch (org.apache.thrift.transport.TTransportException e) {
@@ -39946,15 +39892,19 @@ public void onComplete(SchemaVersion o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            get_schema_latest_version_result result = new get_schema_latest_version_result();
+            drop_ischema_result result = new drop_ischema_result();
             if (e instanceof NoSuchObjectException) {
               result.o1 = (NoSuchObjectException) e;
               result.setO1IsSet(true);
               msg = result;
-            } else if (e instanceof MetaException) {
-              result.o2 = (MetaException) e;
+            } else if (e instanceof InvalidOperationException) {
+              result.o2 = (InvalidOperationException) e;
               result.setO2IsSet(true);
               msg = result;
+            } else if (e instanceof MetaException) {
+              result.o3 = (MetaException) e;
+              result.setO3IsSet(true);
+              msg = result;
             } else if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
               fb.close();
@@ -39982,26 +39932,25 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, get_schema_latest_version_args args, org.apache.thrift.async.AsyncMethodCallback<SchemaVersion> resultHandler) throws org.apache.thrift.TException {
-        iface.get_schema_latest_version(args.schemaName,resultHandler);
+      public void start(I iface, drop_ischema_args args, org.apache.thrift.async.AsyncMethodCallback<Void> resultHandler) throws org.apache.thrift.TException {
+        iface.drop_ischema(args.name,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_schema_all_versions<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, get_schema_all_versions_args, java.util.List<SchemaVersion>> {
-      public get_schema_all_versions() {
-        super("get_schema_all_versions");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class add_schema_version<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, add_schema_version_args, Void> {
+      public add_schema_version() {
+        super("add_schema_version");
       }
 
-      public get_schema_all_versions_args getEmptyArgsInstance() {
-        return new get_schema_all_versions_args();
+      public add_schema_version_args getEmptyArgsInstance() {
+        return new add_schema_version_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<java.util.List<SchemaVersion>> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<Void> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<java.util.List<SchemaVersion>>() { 
-          public void onComplete(java.util.List<SchemaVersion> o) {
-            get_schema_all_versions_result result = new get_schema_all_versions_result();
-            result.success = o;
+        return new org.apache.thrift.async.AsyncMethodCallback<Void>() { 
+          public void onComplete(Void o) {
+            add_schema_version_result result = new add_schema_version_result();
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
             } catch (org.apache.thrift.transport.TTransportException e) {
@@ -40015,15 +39964,19 @@ public void onComplete(java.util.List<SchemaVersion> o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            get_schema_all_versions_result result = new get_schema_all_versions_result();
-            if (e instanceof NoSuchObjectException) {
-              result.o1 = (NoSuchObjectException) e;
+            add_schema_version_result result = new add_schema_version_result();
+            if (e instanceof AlreadyExistsException) {
+              result.o1 = (AlreadyExistsException) e;
               result.setO1IsSet(true);
               msg = result;
-            } else if (e instanceof MetaException) {
-              result.o2 = (MetaException) e;
+            } else if (e instanceof NoSuchObjectException) {
+              result.o2 = (NoSuchObjectException) e;
               result.setO2IsSet(true);
               msg = result;
+            } else if (e instanceof MetaException) {
+              result.o3 = (MetaException) e;
+              result.setO3IsSet(true);
+              msg = result;
             } else if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
               fb.close();
@@ -40051,25 +40004,26 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, get_schema_all_versions_args args, org.apache.thrift.async.AsyncMethodCallback<java.util.List<SchemaVersion>> resultHandler) throws org.apache.thrift.TException {
-        iface.get_schema_all_versions(args.schemaName,resultHandler);
+      public void start(I iface, add_schema_version_args args, org.apache.thrift.async.AsyncMethodCallback<Void> resultHandler) throws org.apache.thrift.TException {
+        iface.add_schema_version(args.schemaVersion,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class drop_schema_version<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, drop_schema_version_args, Void> {
-      public drop_schema_version() {
-        super("drop_schema_version");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_schema_version<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, get_schema_version_args, SchemaVersion> {
+      public get_schema_version() {
+        super("get_schema_version");
       }
 
-      public drop_schema_version_args getEmptyArgsInstance() {
-        return new drop_schema_version_args();
+      public get_schema_version_args getEmptyArgsInstance() {
+        return new get_schema_version_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<Void> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<SchemaVersion> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<Void>() { 
-          public void onComplete(Void o) {
-            drop_schema_version_result result = new drop_schema_version_result();
+        return new org.apache.thrift.async.AsyncMethodCallback<SchemaVersion>() { 
+          public void onComplete(SchemaVersion o) {
+            get_schema_version_result result = new get_schema_version_result();
+            result.success = o;
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
             } catch (org.apache.thrift.transport.TTransportException e) {
@@ -40083,7 +40037,7 @@ public void onComplete(Void o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            drop_schema_version_result result = new drop_schema_version_result();
+            get_schema_version_result result = new get_schema_version_result();
             if (e instanceof NoSuchObjectException) {
               result.o1 = (NoSuchObjectException) e;
               result.setO1IsSet(true);
@@ -40119,25 +40073,25 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, drop_schema_version_args args, org.apache.thrift.async.AsyncMethodCallback<Void> resultHandler) throws org.apache.thrift.TException {
-        iface.drop_schema_version(args.schemaVersion,resultHandler);
+      public void start(I iface, get_schema_version_args args, org.apache.thrift.async.AsyncMethodCallback<SchemaVersion> resultHandler) throws org.apache.thrift.TException {
+        iface.get_schema_version(args.schemaVersion,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_schemas_by_cols<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, get_schemas_by_cols_args, FindSchemasByColsResp> {
-      public get_schemas_by_cols() {
-        super("get_schemas_by_cols");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_schema_latest_version<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, get_schema_latest_version_args, SchemaVersion> {
+      public get_schema_latest_version() {
+        super("get_schema_latest_version");
       }
 
-      public get_schemas_by_cols_args getEmptyArgsInstance() {
-        return new get_schemas_by_cols_args();
+      public get_schema_latest_version_args getEmptyArgsInstance() {
+        return new get_schema_latest_version_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<FindSchemasByColsResp> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<SchemaVersion> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<FindSchemasByColsResp>() { 
-          public void onComplete(FindSchemasByColsResp o) {
-            get_schemas_by_cols_result result = new get_schemas_by_cols_result();
+        return new org.apache.thrift.async.AsyncMethodCallback<SchemaVersion>() { 
+          public void onComplete(SchemaVersion o) {
+            get_schema_latest_version_result result = new get_schema_latest_version_result();
             result.success = o;
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
@@ -40152,11 +40106,15 @@ public void onComplete(FindSchemasByColsResp o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            get_schemas_by_cols_result result = new get_schemas_by_cols_result();
-            if (e instanceof MetaException) {
-              result.o1 = (MetaException) e;
+            get_schema_latest_version_result result = new get_schema_latest_version_result();
+            if (e instanceof NoSuchObjectException) {
+              result.o1 = (NoSuchObjectException) e;
               result.setO1IsSet(true);
               msg = result;
+            } else if (e instanceof MetaException) {
+              result.o2 = (MetaException) e;
+              result.setO2IsSet(true);
+              msg = result;
             } else if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
               fb.close();
@@ -40184,25 +40142,26 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, get_schemas_by_cols_args args, org.apache.thrift.async.AsyncMethodCallback<FindSchemasByColsResp> resultHandler) throws org.apache.thrift.TException {
-        iface.get_schemas_by_cols(args.rqst,resultHandler);
+      public void start(I iface, get_schema_latest_version_args args, org.apache.thrift.async.AsyncMethodCallback<SchemaVersion> resultHandler) throws org.apache.thrift.TException {
+        iface.get_schema_latest_version(args.schemaName,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class map_schema_version_to_serde<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, map_schema_version_to_serde_args, Void> {
-      public map_schema_version_to_serde() {
-        super("map_schema_version_to_serde");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_schema_all_versions<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, get_schema_all_versions_args, java.util.List<SchemaVersion>> {
+      public get_schema_all_versions() {
+        super("get_schema_all_versions");
       }
 
-      public map_schema_version_to_serde_args getEmptyArgsInstance() {
-        return new map_schema_version_to_serde_args();
+      public get_schema_all_versions_args getEmptyArgsInstance() {
+        return new get_schema_all_versions_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<Void> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<java.util.List<SchemaVersion>> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<Void>() { 
-          public void onComplete(Void o) {
-            map_schema_version_to_serde_result result = new map_schema_version_to_serde_result();
+        return new org.apache.thrift.async.AsyncMethodCallback<java.util.List<SchemaVersion>>() { 
+          public void onComplete(java.util.List<SchemaVersion> o) {
+            get_schema_all_versions_result result = new get_schema_all_versions_result();
+            result.success = o;
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
             } catch (org.apache.thrift.transport.TTransportException e) {
@@ -40216,7 +40175,7 @@ public void onComplete(Void o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            map_schema_version_to_serde_result result = new map_schema_version_to_serde_result();
+            get_schema_all_versions_result result = new get_schema_all_versions_result();
             if (e instanceof NoSuchObjectException) {
               result.o1 = (NoSuchObjectException) e;
               result.setO1IsSet(true);
@@ -40252,25 +40211,25 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, map_schema_version_to_serde_args args, org.apache.thrift.async.AsyncMethodCallback<Void> resultHandler) throws org.apache.thrift.TException {
-        iface.map_schema_version_to_serde(args.rqst,resultHandler);
+      public void start(I iface, get_schema_all_versions_args args, org.apache.thrift.async.AsyncMethodCallback<java.util.List<SchemaVersion>> resultHandler) throws org.apache.thrift.TException {
+        iface.get_schema_all_versions(args.schemaName,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class set_schema_version_state<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, set_schema_version_state_args, Void> {
-      public set_schema_version_state() {
-        super("set_schema_version_state");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class drop_schema_version<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, drop_schema_version_args, Void> {
+      public drop_schema_version() {
+        super("drop_schema_version");
       }
 
-      public set_schema_version_state_args getEmptyArgsInstance() {
-        return new set_schema_version_state_args();
+      public drop_schema_version_args getEmptyArgsInstance() {
+        return new drop_schema_version_args();
       }
 
       public org.apache.thrift.async.AsyncMethodCallback<Void> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
         return new org.apache.thrift.async.AsyncMethodCallback<Void>() { 
           public void onComplete(Void o) {
-            set_schema_version_state_result result = new set_schema_version_state_result();
+            drop_schema_version_result result = new drop_schema_version_result();
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
             } catch (org.apache.thrift.transport.TTransportException e) {
@@ -40284,18 +40243,14 @@ public void onComplete(Void o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            set_schema_version_state_result result = new set_schema_version_state_result();
+            drop_schema_version_result result = new drop_schema_version_result();
             if (e instanceof NoSuchObjectException) {
               result.o1 = (NoSuchObjectException) e;
               result.setO1IsSet(true);
               msg = result;
-            } else if (e instanceof InvalidOperationException) {
-              result.o2 = (InvalidOperationException) e;
-              result.setO2IsSet(true);
-              msg = result;
             } else if (e instanceof MetaException) {
-              result.o3 = (MetaException) e;
-              result.setO3IsSet(true);
+              result.o2 = (MetaException) e;
+              result.setO2IsSet(true);
               msg = result;
             } else if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
@@ -40324,25 +40279,26 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, set_schema_version_state_args args, org.apache.thrift.async.AsyncMethodCallback<Void> resultHandler) throws org.apache.thrift.TException {
-        iface.set_schema_version_state(args.rqst,resultHandler);
+      public void start(I iface, drop_schema_version_args args, org.apache.thrift.async.AsyncMethodCallback<Void> resultHandler) throws org.apache.thrift.TException {
+        iface.drop_schema_version(args.schemaVersion,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class add_serde<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, add_serde_args, Void> {
-      public add_serde() {
-        super("add_serde");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_schemas_by_cols<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, get_schemas_by_cols_args, FindSchemasByColsResp> {
+      public get_schemas_by_cols() {
+        super("get_schemas_by_cols");
       }
 
-      public add_serde_args getEmptyArgsInstance() {
-        return new add_serde_args();
+      public get_schemas_by_cols_args getEmptyArgsInstance() {
+        return new get_schemas_by_cols_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<Void> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<FindSchemasByColsResp> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<Void>() { 
-          public void onComplete(Void o) {
-            add_serde_result result = new add_serde_result();
+        return new org.apache.thrift.async.AsyncMethodCallback<FindSchemasByColsResp>() { 
+          public void onComplete(FindSchemasByColsResp o) {
+            get_schemas_by_cols_result result = new get_schemas_by_cols_result();
+            result.success = o;
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
             } catch (org.apache.thrift.transport.TTransportException e) {
@@ -40356,15 +40312,11 @@ public void onComplete(Void o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            add_serde_result result = new add_serde_result();
-            if (e instanceof AlreadyExistsException) {
-              result.o1 = (AlreadyExistsException) e;
+            get_schemas_by_cols_result result = new get_schemas_by_cols_result();
+            if (e instanceof MetaException) {
+              result.o1 = (MetaException) e;
               result.setO1IsSet(true);
               msg = result;
-            } else if (e instanceof MetaException) {
-              result.o2 = (MetaException) e;
-              result.setO2IsSet(true);
-              msg = result;
             } else if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
               fb.close();
@@ -40392,26 +40344,25 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, add_serde_args args, org.apache.thrift.async.AsyncMethodCallback<Void> resultHandler) throws org.apache.thrift.TException {
-        iface.add_serde(args.serde,resultHandler);
+      public void start(I iface, get_schemas_by_cols_args args, org.apache.thrift.async.AsyncMethodCallback<FindSchemasByColsResp> resultHandler) throws org.apache.thrift.TException {
+        iface.get_schemas_by_cols(args.rqst,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_serde<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, get_serde_args, SerDeInfo> {
-      public get_serde() {
-        super("get_serde");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class map_schema_version_to_serde<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, map_schema_version_to_serde_args, Void> {
+      public map_schema_version_to_serde() {
+        super("map_schema_version_to_serde");
       }
 
-      public get_serde_args getEmptyArgsInstance() {
-        return new get_serde_args();
+      public map_schema_version_to_serde_args getEmptyArgsInstance() {
+        return new map_schema_version_to_serde_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<SerDeInfo> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<Void> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<SerDeInfo>() { 
-          public void onComplete(SerDeInfo o) {
-            get_serde_result result = new get_serde_result();
-            result.success = o;
+        return new org.apache.thrift.async.AsyncMethodCallback<Void>() { 
+          public void onComplete(Void o) {
+            map_schema_version_to_serde_result result = new map_schema_version_to_serde_result();
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
             } catch (org.apache.thrift.transport.TTransportException e) {
@@ -40425,7 +40376,7 @@ public void onComplete(SerDeInfo o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            get_serde_result result = new get_serde_result();
+            map_schema_version_to_serde_result result = new map_schema_version_to_serde_result();
             if (e instanceof NoSuchObjectException) {
               result.o1 = (NoSuchObjectException) e;
               result.setO1IsSet(true);
@@ -40461,26 +40412,25 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, get_serde_args args, org.apache.thrift.async.AsyncMethodCallback<SerDeInfo> resultHandler) throws org.apache.thrift.TException {
-        iface.get_serde(args.rqst,resultHandler);
+      public void start(I iface, map_schema_version_to_serde_args args, org.apache.thrift.async.AsyncMethodCallback<Void> resultHandler) throws org.apache.thrift.TException {
+        iface.map_schema_version_to_serde(args.rqst,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_lock_materialization_rebuild<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, get_lock_materialization_rebuild_args, LockResponse> {
-      public get_lock_materialization_rebuild() {
-        super("get_lock_materialization_rebuild");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class set_schema_version_state<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, set_schema_version_state_args, Void> {
+      public set_schema_version_state() {
+        super("set_schema_version_state");
       }
 
-      public get_lock_materialization_rebuild_args getEmptyArgsInstance() {
-        return new get_lock_materialization_rebuild_args();
+      public set_schema_version_state_args getEmptyArgsInstance() {
+        return new set_schema_version_state_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<LockResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<Void> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<LockResponse>() { 
-          public void onComplete(LockResponse o) {
-            get_lock_materialization_rebuild_result result = new get_lock_materialization_rebuild_result();
-            result.success = o;
+        return new org.apache.thrift.async.AsyncMethodCallback<Void>() { 
+          public void onComplete(Void o) {
+            set_schema_version_state_result result = new set_schema_version_state_result();
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
             } catch (org.apache.thrift.transport.TTransportException e) {
@@ -40494,8 +40444,20 @@ public void onComplete(LockResponse o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            get_lock_materialization_rebuild_result result = new get_lock_materialization_rebuild_result();
-            if (e instanceof org.apache.thrift.transport.TTransportException) {
+            set_schema_version_state_result result = new set_schema_version_state_result();
+            if (e instanceof NoSuchObjectException) {
+              result.o1 = (NoSuchObjectException) e;
+              result.setO1IsSet(true);
+              msg = result;
+            } else if (e instanceof InvalidOperationException) {
+              result.o2 = (InvalidOperationException) e;
+              result.setO2IsSet(true);
+              msg = result;
+            } else if (e instanceof MetaException) {
+              result.o3 = (MetaException) e;
+              result.setO3IsSet(true);
+              msg = result;
+            } else if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
               fb.close();
               return;
@@ -40522,27 +40484,25 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, get_lock_materialization_rebuild_args args, org.apache.thrift.async.AsyncMethodCallback<LockResponse> resultHandler) throws org.apache.thrift.TException {
-        iface.get_lock_materialization_rebuild(args.dbName, args.tableName, args.txnId,resultHandler);
+      public void start(I iface, set_schema_version_state_args args, org.apache.thrift.async.AsyncMethodCallback<Void> resultHandler) throws org.apache.thrift.TException {
+        iface.set_schema_version_state(args.rqst,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class heartbeat_lock_materialization_rebuild<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, heartbeat_lock_materialization_rebuild_args, java.lang.Boolean> {
-      public heartbeat_lock_materialization_rebuild() {
-        super("heartbeat_lock_materialization_rebuild");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class add_serde<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, add_serde_args, Void> {
+      public add_serde() {
+        super("add_serde");
       }
 
-      public heartbeat_lock_materialization_rebuild_args getEmptyArgsInstance() {
-        return new heartbeat_lock_materialization_rebuild_args();
+      public add_serde_args getEmptyArgsInstance() {
+        return new add_serde_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<java.lang.Boolean> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<Void> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<java.lang.Boolean>() { 
-          public void onComplete(java.lang.Boolean o) {
-            heartbeat_lock_materialization_rebuild_result result = new heartbeat_lock_materialization_rebuild_result();
-            result.success = o;
-            result.setSuccessIsSet(true);
+        return new org.apache.thrift.async.AsyncMethodCallback<Void>() { 
+          public void onComplete(Void o) {
+            add_serde_result result = new add_serde_result();
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
             } catch (org.apache.thrift.transport.TTransportException e) {
@@ -40556,8 +40516,16 @@ public void onComplete(java.lang.Boolean o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            heartbeat_lock_materialization_rebuild_result result = new heartbeat_lock_materialization_rebuild_result();
-            if (e instanceof org.apache.thrift.transport.TTransportException) {
+            add_serde_result result = new add_serde_result();
+            if (e instanceof AlreadyExistsException) {
+              result.o1 = (AlreadyExistsException) e;
+              result.setO1IsSet(true);
+              msg = result;
+            } else if (e instanceof MetaException) {
+              result.o2 = (MetaException) e;
+              result.setO2IsSet(true);
+              msg = result;
+            } else if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
               fb.close();
               return;
@@ -40584,25 +40552,26 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, heartbeat_lock_materialization_rebuild_args args, org.apache.thrift.async.AsyncMethodCallback<java.lang.Boolean> resultHandler) throws org.apache.thrift.TException {
-        iface.heartbeat_lock_materialization_rebuild(args.dbName, args.tableName, args.txnId,resultHandler);
+      public void start(I iface, add_serde_args args, org.apache.thrift.async.AsyncMethodCallback<Void> resultHandler) throws org.apache.thrift.TException {
+        iface.add_serde(args.serde,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class add_runtime_stats<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, add_runtime_stats_args, Void> {
-      public add_runtime_stats() {
-        super("add_runtime_stats");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_serde<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, get_serde_args, SerDeInfo> {
+      public get_serde() {
+        super("get_serde");
       }
 
-      public add_runtime_stats_args getEmptyArgsInstance() {
-        return new add_runtime_stats_args();
+      public get_serde_args getEmptyArgsInstance() {
+        return new get_serde_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<Void> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<SerDeInfo> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<Void>() { 
-          public void onComplete(Void o) {
-            add_runtime_stats_result result = new add_runtime_stats_result();
+        return new org.apache.thrift.async.AsyncMethodCallback<SerDeInfo>() { 
+          public void onComplete(SerDeInfo o) {
+            get_serde_result result = new get_serde_result();
+            result.success = o;
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
             } catch (org.apache.thrift.transport.TTransportException e) {
@@ -40616,11 +40585,15 @@ public void onComplete(Void o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            add_runtime_stats_result result = new add_runtime_stats_result();
-            if (e instanceof MetaException) {
-              result.o1 = (MetaException) e;
+            get_serde_result result = new get_serde_result();
+            if (e instanceof NoSuchObjectException) {
+              result.o1 = (NoSuchObjectException) e;
               result.setO1IsSet(true);
               msg = result;
+            } else if (e instanceof MetaException) {
+              result.o2 = (MetaException) e;
+              result.setO2IsSet(true);
+              msg = result;
             } else if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
               fb.close();
@@ -40648,25 +40621,25 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, add_runtime_stats_args args, org.apache.thrift.async.AsyncMethodCallback<Void> resultHandler) throws org.apache.thrift.TException {
-        iface.add_runtime_stats(args.stat,resultHandler);
+      public void start(I iface, get_serde_args args, org.apache.thrift.async.AsyncMethodCallback<SerDeInfo> resultHandler) throws org.apache.thrift.TException {
+        iface.get_serde(args.rqst,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_runtime_stats<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, get_runtime_stats_args, java.util.List<RuntimeStat>> {
-      public get_runtime_stats() {
-        super("get_runtime_stats");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_lock_materialization_rebuild<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, get_lock_materialization_rebuild_args, LockResponse> {
+      public get_lock_materialization_rebuild() {
+        super("get_lock_materialization_rebuild");
       }
 
-      public get_runtime_stats_args getEmptyArgsInstance() {
-        return new get_runtime_stats_args();
+      public get_lock_materialization_rebuild_args getEmptyArgsInstance() {
+        return new get_lock_materialization_rebuild_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<java.util.List<RuntimeStat>> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<LockResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<java.util.List<RuntimeStat>>() { 
-          public void onComplete(java.util.List<RuntimeStat> o) {
-            get_runtime_stats_result result = new get_runtime_stats_result();
+        return new org.apache.thrift.async.AsyncMethodCallback<LockResponse>() { 
+          public void onComplete(LockResponse o) {
+            get_lock_materialization_rebuild_result result = new get_lock_materialization_rebuild_result();
             result.success = o;
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
@@ -40681,12 +40654,8 @@ public void onComplete(java.util.List<RuntimeStat> o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            get_runtime_stats_result result = new get_runtime_stats_result();
-            if (e instanceof MetaException) {
-              result.o1 = (MetaException) e;
-              result.setO1IsSet(true);
-              msg = result;
-            } else if (e instanceof org.apache.thrift.transport.TTransportException) {
+            get_lock_materialization_rebuild_result result = new get_lock_materialization_rebuild_result();
+            if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
               fb.close();
               return;
@@ -40713,26 +40682,27 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, get_runtime_stats_args args, org.apache.thrift.async.AsyncMethodCallback<java.util.List<RuntimeStat>> resultHandler) throws org.apache.thrift.TException {
-        iface.get_runtime_stats(args.rqst,resultHandler);
+      public void start(I iface, get_lock_materialization_rebuild_args args, org.apache.thrift.async.AsyncMethodCallback<LockResponse> resultHandler) throws org.apache.thrift.TException {
+        iface.get_lock_materialization_rebuild(args.dbName, args.tableName, args.txnId,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_partitions_with_specs<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, get_partitions_with_specs_args, GetPartitionsResponse> {
-      public get_partitions_with_specs() {
-        super("get_partitions_with_specs");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class heartbeat_lock_materialization_rebuild<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, heartbeat_lock_materialization_rebuild_args, java.lang.Boolean> {
+      public heartbeat_lock_materialization_rebuild() {
+        super("heartbeat_lock_materialization_rebuild");
       }
 
-      public get_partitions_with_specs_args getEmptyArgsInstance() {
-        return new get_partitions_with_specs_args();
+      public heartbeat_lock_materialization_rebuild_args getEmptyArgsInstance() {
+        return new heartbeat_lock_materialization_rebuild_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<GetPartitionsResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<java.lang.Boolean> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<GetPartitionsResponse>() { 
-          public void onComplete(GetPartitionsResponse o) {
-            get_partitions_with_specs_result result = new get_partitions_with_specs_result();
+        return new org.apache.thrift.async.AsyncMethodCallback<java.lang.Boolean>() { 
+          public void onComplete(java.lang.Boolean o) {
+            heartbeat_lock_materialization_rebuild_result result = new heartbeat_lock_materialization_rebuild_result();
             result.success = o;
+            result.setSuccessIsSet(true);
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
             } catch (org.apache.thrift.transport.TTransportException e) {
@@ -40746,12 +40716,8 @@ public void onComplete(GetPartitionsResponse o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            get_partitions_with_specs_result result = new get_partitions_with_specs_result();
-            if (e instanceof MetaException) {
-              result.o1 = (MetaException) e;
-              result.setO1IsSet(true);
-              msg = result;
-            } else if (e instanceof org.apache.thrift.transport.TTransportException) {
+            heartbeat_lock_materialization_rebuild_result result = new heartbeat_lock_materialization_rebuild_result();
+            if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
               fb.close();
               return;
@@ -40778,26 +40744,25 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, get_partitions_with_specs_args args, org.apache.thrift.async.AsyncMethodCallback<GetPartitionsResponse> resultHandler) throws org.apache.thrift.TException {
-        iface.get_partitions_with_specs(args.request,resultHandler);
+      public void start(I iface, heartbeat_lock_materialization_rebuild_args args, org.apache.thrift.async.AsyncMethodCallback<java.lang.Boolean> resultHandler) throws org.apache.thrift.TException {
+        iface.heartbeat_lock_materialization_rebuild(args.dbName, args.tableName, args.txnId,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class scheduled_query_poll<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, scheduled_query_poll_args, ScheduledQueryPollResponse> {
-      public scheduled_query_poll() {
-        super("scheduled_query_poll");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class add_runtime_stats<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, add_runtime_stats_args, Void> {
+      public add_runtime_stats() {
+        super("add_runtime_stats");
       }
 
-      public scheduled_query_poll_args getEmptyArgsInstance() {
-        return new scheduled_query_poll_args();
+      public add_runtime_stats_args getEmptyArgsInstance() {
+        return new add_runtime_stats_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<ScheduledQueryPollResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<Void> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<ScheduledQueryPollResponse>() { 
-          public void onComplete(ScheduledQueryPollResponse o) {
-            scheduled_query_poll_result result = new scheduled_query_poll_result();
-            result.success = o;
+        return new org.apache.thrift.async.AsyncMethodCallback<Void>() { 
+          public void onComplete(Void o) {
+            add_runtime_stats_result result = new add_runtime_stats_result();
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
             } catch (org.apache.thrift.transport.TTransportException e) {
@@ -40811,7 +40776,7 @@ public void onComplete(ScheduledQueryPollResponse o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            scheduled_query_poll_result result = new scheduled_query_poll_result();
+            add_runtime_stats_result result = new add_runtime_stats_result();
             if (e instanceof MetaException) {
               result.o1 = (MetaException) e;
               result.setO1IsSet(true);
@@ -40843,25 +40808,26 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, scheduled_query_poll_args args, org.apache.thrift.async.AsyncMethodCallback<ScheduledQueryPollResponse> resultHandler) throws org.apache.thrift.TException {
-        iface.scheduled_query_poll(args.request,resultHandler);
+      public void start(I iface, add_runtime_stats_args args, org.apache.thrift.async.AsyncMethodCallback<Void> resultHandler) throws org.apache.thrift.TException {
+        iface.add_runtime_stats(args.stat,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class scheduled_query_maintenance<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, scheduled_query_maintenance_args, Void> {
-      public scheduled_query_maintenance() {
-        super("scheduled_query_maintenance");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_runtime_stats<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, get_runtime_stats_args, java.util.List<RuntimeStat>> {
+      public get_runtime_stats() {
+        super("get_runtime_stats");
       }
 
-      public scheduled_query_maintenance_args getEmptyArgsInstance() {
-        return new scheduled_query_maintenance_args();
+      public get_runtime_stats_args getEmptyArgsInstance() {
+        return new get_runtime_stats_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<Void> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<java.util.List<RuntimeStat>> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<Void>() { 
-          public void onComplete(Void o) {
-            scheduled_query_maintenance_result result = new scheduled_query_maintenance_result();
+        return new org.apache.thrift.async.AsyncMethodCallback<java.util.List<RuntimeStat>>() { 
+          public void onComplete(java.util.List<RuntimeStat> o) {
+            get_runtime_stats_result result = new get_runtime_stats_result();
+            result.success = o;
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
             } catch (org.apache.thrift.transport.TTransportException e) {
@@ -40875,23 +40841,11 @@ public void onComplete(Void o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            scheduled_query_maintenance_result result = new scheduled_query_maintenance_result();
+            get_runtime_stats_result result = new get_runtime_stats_result();
             if (e instanceof MetaException) {
               result.o1 = (MetaException) e;
               result.setO1IsSet(true);
               msg = result;
-            } else if (e instanceof NoSuchObjectException) {
-              result.o2 = (NoSuchObjectException) e;
-              result.setO2IsSet(true);
-              msg = result;
-            } else if (e instanceof AlreadyExistsException) {
-              result.o3 = (AlreadyExistsException) e;
-              result.setO3IsSet(true);
-              msg = result;
-            } else if (e instanceof InvalidInputException) {
-              result.o4 = (InvalidInputException) e;
-              result.setO4IsSet(true);
-              msg = result;
             } else if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
               fb.close();
@@ -40919,25 +40873,26 @@ protected boolean isOneway() {
         return false;
       }
 
-      public void start(I iface, scheduled_query_maintenance_args args, org.apache.thrift.async.AsyncMethodCallback<Void> resultHandler) throws org.apache.thrift.TException {
-        iface.scheduled_query_maintenance(args.request,resultHandler);
+      public void start(I iface, get_runtime_stats_args args, org.apache.thrift.async.AsyncMethodCallback<java.util.List<RuntimeStat>> resultHandler) throws org.apache.thrift.TException {
+        iface.get_runtime_stats(args.rqst,resultHandler);
       }
     }
 
-    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class scheduled_query_progress<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, scheduled_query_progress_args, Void> {
-      public scheduled_query_progress() {
-        super("scheduled_query_progress");
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_partitions_with_specs<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, get_partitions_with_specs_args, GetPartitionsResponse> {
+      public get_partitions_with_specs() {
+        super("get_partitions_with_specs");
       }
 
-      public scheduled_query_progress_args getEmptyArgsInstance() {
-        return new scheduled_query_progress_args();
+      public get_partitions_with_specs_args getEmptyArgsInstance() {
+        return new get_partitions_with_specs_args();
       }
 
-      public org.apache.thrift.async.AsyncMethodCallback<Void> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+      public org.apache.thrift.async.AsyncMethodCallback<GetPartitionsResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
         final org.apache.thrift.AsyncProcessFunction fcall = this;
-        return new org.apache.thrift.async.AsyncMethodCallback<Void>() { 
-          public void onComplete(Void o) {
-            scheduled_query_progress_result result = new scheduled_query_progress_result();
+        return new org.apache.thrift.async.AsyncMethodCallback<GetPartitionsResponse>() { 
+          public void onComplete(GetPartitionsResponse o) {
+            get_partitions_with_specs_result result = new get_partitions_with_specs_result();
+            result.success = o;
             try {
               fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
             } catch (org.apache.thrift.transport.TTransportException e) {
@@ -40951,15 +40906,220 @@ public void onComplete(Void o) {
           public void onError(java.lang.Exception e) {
             byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
             org.apache.thrift.TSerializable msg;
-            scheduled_query_progress_result result = new scheduled_query_progress_result();
+            get_partitions_with_specs_result result = new get_partitions_with_specs_result();
             if (e instanceof MetaException) {
               result.o1 = (MetaException) e;
               result.setO1IsSet(true);
               msg = result;
-            } else if (e instanceof InvalidOperationException) {
-              result.o2 = (InvalidOperationException) e;
-              result.setO2IsSet(true);
-              msg = result;
+            } else if (e instanceof org.apache.thrift.transport.TTransportException) {
+              _LOGGER.error("TTransportException inside handler", e);
+              fb.close();
+              return;
+            } else if (e instanceof org.apache.thrift.TApplicationException) {
+              _LOGGER.error("TApplicationException inside handler", e);
+              msgType = org.apache.thrift.protocol.TMessageType.EXCEPTION;
+              msg = (org.apache.thrift.TApplicationException)e;
+            } else {
+              _LOGGER.error("Exception inside handler", e);
+              msgType = org.apache.thrift.protocol.TMessageType.EXCEPTION;
+              msg = new org.apache.thrift.TApplicationException(org.apache.thrift.TApplicationException.INTERNAL_ERROR, e.getMessage());
+            }
+            try {
+              fcall.sendResponse(fb,msg,msgType,seqid);
+            } catch (java.lang.Exception ex) {
+              _LOGGER.error("Exception writing to internal frame buffer", ex);
+              fb.close();
+            }
+          }
+        };
+      }
+
+      protected boolean isOneway() {
+        return false;
+      }
+
+      public void start(I iface, get_partitions_with_specs_args args, org.apache.thrift.async.AsyncMethodCallback<GetPartitionsResponse> resultHandler) throws org.apache.thrift.TException {
+        iface.get_partitions_with_specs(args.request,resultHandler);
+      }
+    }
+
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class scheduled_query_poll<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, scheduled_query_poll_args, ScheduledQueryPollResponse> {
+      public scheduled_query_poll() {
+        super("scheduled_query_poll");
+      }
+
+      public scheduled_query_poll_args getEmptyArgsInstance() {
+        return new scheduled_query_poll_args();
+      }
+
+      public org.apache.thrift.async.AsyncMethodCallback<ScheduledQueryPollResponse> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+        final org.apache.thrift.AsyncProcessFunction fcall = this;
+        return new org.apache.thrift.async.AsyncMethodCallback<ScheduledQueryPollResponse>() { 
+          public void onComplete(ScheduledQueryPollResponse o) {
+            scheduled_query_poll_result result = new scheduled_query_poll_result();
+            result.success = o;
+            try {
+              fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
+            } catch (org.apache.thrift.transport.TTransportException e) {
+              _LOGGER.error("TTransportException writing to internal frame buffer", e);
+              fb.close();
+            } catch (java.lang.Exception e) {
+              _LOGGER.error("Exception writing to internal frame buffer", e);
+              onError(e);
+            }
+          }
+          public void onError(java.lang.Exception e) {
+            byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
+            org.apache.thrift.TSerializable msg;
+            scheduled_query_poll_result result = new scheduled_query_poll_result();
+            if (e instanceof MetaException) {
+              result.o1 = (MetaException) e;
+              result.setO1IsSet(true);
+              msg = result;
+            } else if (e instanceof org.apache.thrift.transport.TTransportException) {
+              _LOGGER.error("TTransportException inside handler", e);
+              fb.close();
+              return;
+            } else if (e instanceof org.apache.thrift.TApplicationException) {
+              _LOGGER.error("TApplicationException inside handler", e);
+              msgType = org.apache.thrift.protocol.TMessageType.EXCEPTION;
+              msg = (org.apache.thrift.TApplicationException)e;
+            } else {
+              _LOGGER.error("Exception inside handler", e);
+              msgType = org.apache.thrift.protocol.TMessageType.EXCEPTION;
+              msg = new org.apache.thrift.TApplicationException(org.apache.thrift.TApplicationException.INTERNAL_ERROR, e.getMessage());
+            }
+            try {
+              fcall.sendResponse(fb,msg,msgType,seqid);
+            } catch (java.lang.Exception ex) {
+              _LOGGER.error("Exception writing to internal frame buffer", ex);
+              fb.close();
+            }
+          }
+        };
+      }
+
+      protected boolean isOneway() {
+        return false;
+      }
+
+      public void start(I iface, scheduled_query_poll_args args, org.apache.thrift.async.AsyncMethodCallback<ScheduledQueryPollResponse> resultHandler) throws org.apache.thrift.TException {
+        iface.scheduled_query_poll(args.request,resultHandler);
+      }
+    }
+
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class scheduled_query_maintenance<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, scheduled_query_maintenance_args, Void> {
+      public scheduled_query_maintenance() {
+        super("scheduled_query_maintenance");
+      }
+
+      public scheduled_query_maintenance_args getEmptyArgsInstance() {
+        return new scheduled_query_maintenance_args();
+      }
+
+      public org.apache.thrift.async.AsyncMethodCallback<Void> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+        final org.apache.thrift.AsyncProcessFunction fcall = this;
+        return new org.apache.thrift.async.AsyncMethodCallback<Void>() { 
+          public void onComplete(Void o) {
+            scheduled_query_maintenance_result result = new scheduled_query_maintenance_result();
+            try {
+              fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
+            } catch (org.apache.thrift.transport.TTransportException e) {
+              _LOGGER.error("TTransportException writing to internal frame buffer", e);
+              fb.close();
+            } catch (java.lang.Exception e) {
+              _LOGGER.error("Exception writing to internal frame buffer", e);
+              onError(e);
+            }
+          }
+          public void onError(java.lang.Exception e) {
+            byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
+            org.apache.thrift.TSerializable msg;
+            scheduled_query_maintenance_result result = new scheduled_query_maintenance_result();
+            if (e instanceof MetaException) {
+              result.o1 = (MetaException) e;
+              result.setO1IsSet(true);
+              msg = result;
+            } else if (e instanceof NoSuchObjectException) {
+              result.o2 = (NoSuchObjectException) e;
+              result.setO2IsSet(true);
+              msg = result;
+            } else if (e instanceof AlreadyExistsException) {
+              result.o3 = (AlreadyExistsException) e;
+              result.setO3IsSet(true);
+              msg = result;
+            } else if (e instanceof InvalidInputException) {
+              result.o4 = (InvalidInputException) e;
+              result.setO4IsSet(true);
+              msg = result;
+            } else if (e instanceof org.apache.thrift.transport.TTransportException) {
+              _LOGGER.error("TTransportException inside handler", e);
+              fb.close();
+              return;
+            } else if (e instanceof org.apache.thrift.TApplicationException) {
+              _LOGGER.error("TApplicationException inside handler", e);
+              msgType = org.apache.thrift.protocol.TMessageType.EXCEPTION;
+              msg = (org.apache.thrift.TApplicationException)e;
+            } else {
+              _LOGGER.error("Exception inside handler", e);
+              msgType = org.apache.thrift.protocol.TMessageType.EXCEPTION;
+              msg = new org.apache.thrift.TApplicationException(org.apache.thrift.TApplicationException.INTERNAL_ERROR, e.getMessage());
+            }
+            try {
+              fcall.sendResponse(fb,msg,msgType,seqid);
+            } catch (java.lang.Exception ex) {
+              _LOGGER.error("Exception writing to internal frame buffer", ex);
+              fb.close();
+            }
+          }
+        };
+      }
+
+      protected boolean isOneway() {
+        return false;
+      }
+
+      public void start(I iface, scheduled_query_maintenance_args args, org.apache.thrift.async.AsyncMethodCallback<Void> resultHandler) throws org.apache.thrift.TException {
+        iface.scheduled_query_maintenance(args.request,resultHandler);
+      }
+    }
+
+    @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class scheduled_query_progress<I extends AsyncIface> extends org.apache.thrift.AsyncProcessFunction<I, scheduled_query_progress_args, Void> {
+      public scheduled_query_progress() {
+        super("scheduled_query_progress");
+      }
+
+      public scheduled_query_progress_args getEmptyArgsInstance() {
+        return new scheduled_query_progress_args();
+      }
+
+      public org.apache.thrift.async.AsyncMethodCallback<Void> getResultHandler(final org.apache.thrift.server.AbstractNonblockingServer.AsyncFrameBuffer fb, final int seqid) {
+        final org.apache.thrift.AsyncProcessFunction fcall = this;
+        return new org.apache.thrift.async.AsyncMethodCallback<Void>() { 
+          public void onComplete(Void o) {
+            scheduled_query_progress_result result = new scheduled_query_progress_result();
+            try {
+              fcall.sendResponse(fb, result, org.apache.thrift.protocol.TMessageType.REPLY,seqid);
+            } catch (org.apache.thrift.transport.TTransportException e) {
+              _LOGGER.error("TTransportException writing to internal frame buffer", e);
+              fb.close();
+            } catch (java.lang.Exception e) {
+              _LOGGER.error("Exception writing to internal frame buffer", e);
+              onError(e);
+            }
+          }
+          public void onError(java.lang.Exception e) {
+            byte msgType = org.apache.thrift.protocol.TMessageType.REPLY;
+            org.apache.thrift.TSerializable msg;
+            scheduled_query_progress_result result = new scheduled_query_progress_result();
+            if (e instanceof MetaException) {
+              result.o1 = (MetaException) e;
+              result.setO1IsSet(true);
+              msg = result;
+            } else if (e instanceof InvalidOperationException) {
+              result.o2 = (InvalidOperationException) e;
+              result.setO2IsSet(true);
+              msg = result;
             } else if (e instanceof org.apache.thrift.transport.TTransportException) {
               _LOGGER.error("TTransportException inside handler", e);
               fb.close();
@@ -210154,89 +210314,754 @@ public java.lang.String getFieldName() {
         return _fieldName;
       }
     }
-
-    // isset id assignments
-    private static final int __KEY_SEQ_ISSET_ID = 0;
-    private byte __isset_bitfield = 0;
+
+    // isset id assignments
+    private static final int __KEY_SEQ_ISSET_ID = 0;
+    private byte __isset_bitfield = 0;
+    public static final java.util.Map<_Fields, org.apache.thrift.meta_data.FieldMetaData> metaDataMap;
+    static {
+      java.util.Map<_Fields, org.apache.thrift.meta_data.FieldMetaData> tmpMap = new java.util.EnumMap<_Fields, org.apache.thrift.meta_data.FieldMetaData>(_Fields.class);
+      tmpMap.put(_Fields.KEY_SEQ, new org.apache.thrift.meta_data.FieldMetaData("key_seq", org.apache.thrift.TFieldRequirementType.DEFAULT, 
+          new org.apache.thrift.meta_data.FieldValueMetaData(org.apache.thrift.protocol.TType.I32)));
+      metaDataMap = java.util.Collections.unmodifiableMap(tmpMap);
+      org.apache.thrift.meta_data.FieldMetaData.addStructMetaDataMap(remove_master_key_args.class, metaDataMap);
+    }
+
+    public remove_master_key_args() {
+    }
+
+    public remove_master_key_args(
+      int key_seq)
+    {
+      this();
+      this.key_seq = key_seq;
+      setKey_seqIsSet(true);
+    }
+
+    /**
+     * Performs a deep copy on <i>other</i>.
+     */
+    public remove_master_key_args(remove_master_key_args other) {
+      __isset_bitfield = other.__isset_bitfield;
+      this.key_seq = other.key_seq;
+    }
+
+    public remove_master_key_args deepCopy() {
+      return new remove_master_key_args(this);
+    }
+
+    @Override
+    public void clear() {
+      setKey_seqIsSet(false);
+      this.key_seq = 0;
+    }
+
+    public int getKey_seq() {
+      return this.key_seq;
+    }
+
+    public void setKey_seq(int key_seq) {
+      this.key_seq = key_seq;
+      setKey_seqIsSet(true);
+    }
+
+    public void unsetKey_seq() {
+      __isset_bitfield = org.apache.thrift.EncodingUtils.clearBit(__isset_bitfield, __KEY_SEQ_ISSET_ID);
+    }
+
+    /** Returns true if field key_seq is set (has been assigned a value) and false otherwise */
+    public boolean isSetKey_seq() {
+      return org.apache.thrift.EncodingUtils.testBit(__isset_bitfield, __KEY_SEQ_ISSET_ID);
+    }
+
+    public void setKey_seqIsSet(boolean value) {
+      __isset_bitfield = org.apache.thrift.EncodingUtils.setBit(__isset_bitfield, __KEY_SEQ_ISSET_ID, value);
+    }
+
+    public void setFieldValue(_Fields field, @org.apache.thrift.annotation.Nullable java.lang.Object value) {
+      switch (field) {
+      case KEY_SEQ:
+        if (value == null) {
+          unsetKey_seq();
+        } else {
+          setKey_seq((java.lang.Integer)value);
+        }
+        break;
+
+      }
+    }
+
+    @org.apache.thrift.annotation.Nullable
+    public java.lang.Object getFieldValue(_Fields field) {
+      switch (field) {
+      case KEY_SEQ:
+        return getKey_seq();
+
+      }
+      throw new java.lang.IllegalStateException();
+    }
+
+    /** Returns true if field corresponding to fieldID is set (has been assigned a value) and false otherwise */
+    public boolean isSet(_Fields field) {
+      if (field == null) {
+        throw new java.lang.IllegalArgumentException();
+      }
+
+      switch (field) {
+      case KEY_SEQ:
+        return isSetKey_seq();
+      }
+      throw new java.lang.IllegalStateException();
+    }
+
+    @Override
+    public boolean equals(java.lang.Object that) {
+      if (that == null)
+        return false;
+      if (that instanceof remove_master_key_args)
+        return this.equals((remove_master_key_args)that);
+      return false;
+    }
+
+    public boolean equals(remove_master_key_args that) {
+      if (that == null)
+        return false;
+      if (this == that)
+        return true;
+
+      boolean this_present_key_seq = true;
+      boolean that_present_key_seq = true;
+      if (this_present_key_seq || that_present_key_seq) {
+        if (!(this_present_key_seq && that_present_key_seq))
+          return false;
+        if (this.key_seq != that.key_seq)
+          return false;
+      }
+
+      return true;
+    }
+
+    @Override
+    public int hashCode() {
+      int hashCode = 1;
+
+      hashCode = hashCode * 8191 + key_seq;
+
+      return hashCode;
+    }
+
+    @Override
+    public int compareTo(remove_master_key_args other) {
+      if (!getClass().equals(other.getClass())) {
+        return getClass().getName().compareTo(other.getClass().getName());
+      }
+
+      int lastComparison = 0;
+
+      lastComparison = java.lang.Boolean.valueOf(isSetKey_seq()).compareTo(other.isSetKey_seq());
+      if (lastComparison != 0) {
+        return lastComparison;
+      }
+      if (isSetKey_seq()) {
+        lastComparison = org.apache.thrift.TBaseHelper.compareTo(this.key_seq, other.key_seq);
+        if (lastComparison != 0) {
+          return lastComparison;
+        }
+      }
+      return 0;
+    }
+
+    @org.apache.thrift.annotation.Nullable
+    public _Fields fieldForId(int fieldId) {
+      return _Fields.findByThriftId(fieldId);
+    }
+
+    public void read(org.apache.thrift.protocol.TProtocol iprot) throws org.apache.thrift.TException {
+      scheme(iprot).read(iprot, this);
+    }
+
+    public void write(org.apache.thrift.protocol.TProtocol oprot) throws org.apache.thrift.TException {
+      scheme(oprot).write(oprot, this);
+    }
+
+    @Override
+    public java.lang.String toString() {
+      java.lang.StringBuilder sb = new java.lang.StringBuilder("remove_master_key_args(");
+      boolean first = true;
+
+      sb.append("key_seq:");
+      sb.append(this.key_seq);
+      first = false;
+      sb.append(")");
+      return sb.toString();
+    }
+
+    public void validate() throws org.apache.thrift.TException {
+      // check for required fields
+      // check for sub-struct validity
+    }
+
+    private void writeObject(java.io.ObjectOutputStream out) throws java.io.IOException {
+      try {
+        write(new org.apache.thrift.protocol.TCompactProtocol(new org.apache.thrift.transport.TIOStreamTransport(out)));
+      } catch (org.apache.thrift.TException te) {
+        throw new java.io.IOException(te);
+      }
+    }
+
+    private void readObject(java.io.ObjectInputStream in) throws java.io.IOException, java.lang.ClassNotFoundException {
+      try {
+        // it doesn't seem like you should have to do this, but java serialization is wacky, and doesn't call the default constructor.
+        __isset_bitfield = 0;
+        read(new org.apache.thrift.protocol.TCompactProtocol(new org.apache.thrift.transport.TIOStreamTransport(in)));
+      } catch (org.apache.thrift.TException te) {
+        throw new java.io.IOException(te);
+      }
+    }
+
+    private static class remove_master_key_argsStandardSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
+      public remove_master_key_argsStandardScheme getScheme() {
+        return new remove_master_key_argsStandardScheme();
+      }
+    }
+
+    private static class remove_master_key_argsStandardScheme extends org.apache.thrift.scheme.StandardScheme<remove_master_key_args> {
+
+      public void read(org.apache.thrift.protocol.TProtocol iprot, remove_master_key_args struct) throws org.apache.thrift.TException {
+        org.apache.thrift.protocol.TField schemeField;
+        iprot.readStructBegin();
+        while (true)
+        {
+          schemeField = iprot.readFieldBegin();
+          if (schemeField.type == org.apache.thrift.protocol.TType.STOP) { 
+            break;
+          }
+          switch (schemeField.id) {
+            case 1: // KEY_SEQ
+              if (schemeField.type == org.apache.thrift.protocol.TType.I32) {
+                struct.key_seq = iprot.readI32();
+                struct.setKey_seqIsSet(true);
+              } else { 
+                org.apache.thrift.protocol.TProtocolUtil.skip(iprot, schemeField.type);
+              }
+              break;
+            default:
+              org.apache.thrift.protocol.TProtocolUtil.skip(iprot, schemeField.type);
+          }
+          iprot.readFieldEnd();
+        }
+        iprot.readStructEnd();
+        struct.validate();
+      }
+
+      public void write(org.apache.thrift.protocol.TProtocol oprot, remove_master_key_args struct) throws org.apache.thrift.TException {
+        struct.validate();
+
+        oprot.writeStructBegin(STRUCT_DESC);
+        oprot.writeFieldBegin(KEY_SEQ_FIELD_DESC);
+        oprot.writeI32(struct.key_seq);
+        oprot.writeFieldEnd();
+        oprot.writeFieldStop();
+        oprot.writeStructEnd();
+      }
+
+    }
+
+    private static class remove_master_key_argsTupleSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
+      public remove_master_key_argsTupleScheme getScheme() {
+        return new remove_master_key_argsTupleScheme();
+      }
+    }
+
+    private static class remove_master_key_argsTupleScheme extends org.apache.thrift.scheme.TupleScheme<remove_master_key_args> {
+
+      @Override
+      public void write(org.apache.thrift.protocol.TProtocol prot, remove_master_key_args struct) throws org.apache.thrift.TException {
+        org.apache.thrift.protocol.TTupleProtocol oprot = (org.apache.thrift.protocol.TTupleProtocol) prot;
+        java.util.BitSet optionals = new java.util.BitSet();
+        if (struct.isSetKey_seq()) {
+          optionals.set(0);
+        }
+        oprot.writeBitSet(optionals, 1);
+        if (struct.isSetKey_seq()) {
+          oprot.writeI32(struct.key_seq);
+        }
+      }
+
+      @Override
+      public void read(org.apache.thrift.protocol.TProtocol prot, remove_master_key_args struct) throws org.apache.thrift.TException {
+        org.apache.thrift.protocol.TTupleProtocol iprot = (org.apache.thrift.protocol.TTupleProtocol) prot;
+        java.util.BitSet incoming = iprot.readBitSet(1);
+        if (incoming.get(0)) {
+          struct.key_seq = iprot.readI32();
+          struct.setKey_seqIsSet(true);
+        }
+      }
+    }
+
+    private static <S extends org.apache.thrift.scheme.IScheme> S scheme(org.apache.thrift.protocol.TProtocol proto) {
+      return (org.apache.thrift.scheme.StandardScheme.class.equals(proto.getScheme()) ? STANDARD_SCHEME_FACTORY : TUPLE_SCHEME_FACTORY).getScheme();
+    }
+  }
+
+  @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class remove_master_key_result implements org.apache.thrift.TBase<remove_master_key_result, remove_master_key_result._Fields>, java.io.Serializable, Cloneable, Comparable<remove_master_key_result>   {
+    private static final org.apache.thrift.protocol.TStruct STRUCT_DESC = new org.apache.thrift.protocol.TStruct("remove_master_key_result");
+
+    private static final org.apache.thrift.protocol.TField SUCCESS_FIELD_DESC = new org.apache.thrift.protocol.TField("success", org.apache.thrift.protocol.TType.BOOL, (short)0);
+
+    private static final org.apache.thrift.scheme.SchemeFactory STANDARD_SCHEME_FACTORY = new remove_master_key_resultStandardSchemeFactory();
+    private static final org.apache.thrift.scheme.SchemeFactory TUPLE_SCHEME_FACTORY = new remove_master_key_resultTupleSchemeFactory();
+
+    private boolean success; // required
+
+    /** The set of fields this struct contains, along with convenience methods for finding and manipulating them. */
+    public enum _Fields implements org.apache.thrift.TFieldIdEnum {
+      SUCCESS((short)0, "success");
+
+      private static final java.util.Map<java.lang.String, _Fields> byName = new java.util.HashMap<java.lang.String, _Fields>();
+
+      static {
+        for (_Fields field : java.util.EnumSet.allOf(_Fields.class)) {
+          byName.put(field.getFieldName(), field);
+        }
+      }
+
+      /**
+       * Find the _Fields constant that matches fieldId, or null if its not found.
+       */
+      @org.apache.thrift.annotation.Nullable
+      public static _Fields findByThriftId(int fieldId) {
+        switch(fieldId) {
+          case 0: // SUCCESS
+            return SUCCESS;
+          default:
+            return null;
+        }
+      }
+
+      /**
+       * Find the _Fields constant that matches fieldId, throwing an exception
+       * if it is not found.
+       */
+      public static _Fields findByThriftIdOrThrow(int fieldId) {
+        _Fields fields = findByThriftId(fieldId);
+        if (fields == null) throw new java.lang.IllegalArgumentException("Field " + fieldId + " doesn't exist!");
+        return fields;
+      }
+
+      /**
+       * Find the _Fields constant that matches name, or null if its not found.
+       */
+      @org.apache.thrift.annotation.Nullable
+      public static _Fields findByName(java.lang.String name) {
+        return byName.get(name);
+      }
+
+      private final short _thriftId;
+      private final java.lang.String _fieldName;
+
+      _Fields(short thriftId, java.lang.String fieldName) {
+        _thriftId = thriftId;
+        _fieldName = fieldName;
+      }
+
+      public short getThriftFieldId() {
+        return _thriftId;
+      }
+
+      public java.lang.String getFieldName() {
+        return _fieldName;
+      }
+    }
+
+    // isset id assignments
+    private static final int __SUCCESS_ISSET_ID = 0;
+    private byte __isset_bitfield = 0;
+    public static final java.util.Map<_Fields, org.apache.thrift.meta_data.FieldMetaData> metaDataMap;
+    static {
+      java.util.Map<_Fields, org.apache.thrift.meta_data.FieldMetaData> tmpMap = new java.util.EnumMap<_Fields, org.apache.thrift.meta_data.FieldMetaData>(_Fields.class);
+      tmpMap.put(_Fields.SUCCESS, new org.apache.thrift.meta_data.FieldMetaData("success", org.apache.thrift.TFieldRequirementType.DEFAULT, 
+          new org.apache.thrift.meta_data.FieldValueMetaData(org.apache.thrift.protocol.TType.BOOL)));
+      metaDataMap = java.util.Collections.unmodifiableMap(tmpMap);
+      org.apache.thrift.meta_data.FieldMetaData.addStructMetaDataMap(remove_master_key_result.class, metaDataMap);
+    }
+
+    public remove_master_key_result() {
+    }
+
+    public remove_master_key_result(
+      boolean success)
+    {
+      this();
+      this.success = success;
+      setSuccessIsSet(true);
+    }
+
+    /**
+     * Performs a deep copy on <i>other</i>.
+     */
+    public remove_master_key_result(remove_master_key_result other) {
+      __isset_bitfield = other.__isset_bitfield;
+      this.success = other.success;
+    }
+
+    public remove_master_key_result deepCopy() {
+      return new remove_master_key_result(this);
+    }
+
+    @Override
+    public void clear() {
+      setSuccessIsSet(false);
+      this.success = false;
+    }
+
+    public boolean isSuccess() {
+      return this.success;
+    }
+
+    public void setSuccess(boolean success) {
+      this.success = success;
+      setSuccessIsSet(true);
+    }
+
+    public void unsetSuccess() {
+      __isset_bitfield = org.apache.thrift.EncodingUtils.clearBit(__isset_bitfield, __SUCCESS_ISSET_ID);
+    }
+
+    /** Returns true if field success is set (has been assigned a value) and false otherwise */
+    public boolean isSetSuccess() {
+      return org.apache.thrift.EncodingUtils.testBit(__isset_bitfield, __SUCCESS_ISSET_ID);
+    }
+
+    public void setSuccessIsSet(boolean value) {
+      __isset_bitfield = org.apache.thrift.EncodingUtils.setBit(__isset_bitfield, __SUCCESS_ISSET_ID, value);
+    }
+
+    public void setFieldValue(_Fields field, @org.apache.thrift.annotation.Nullable java.lang.Object value) {
+      switch (field) {
+      case SUCCESS:
+        if (value == null) {
+          unsetSuccess();
+        } else {
+          setSuccess((java.lang.Boolean)value);
+        }
+        break;
+
+      }
+    }
+
+    @org.apache.thrift.annotation.Nullable
+    public java.lang.Object getFieldValue(_Fields field) {
+      switch (field) {
+      case SUCCESS:
+        return isSuccess();
+
+      }
+      throw new java.lang.IllegalStateException();
+    }
+
+    /** Returns true if field corresponding to fieldID is set (has been assigned a value) and false otherwise */
+    public boolean isSet(_Fields field) {
+      if (field == null) {
+        throw new java.lang.IllegalArgumentException();
+      }
+
+      switch (field) {
+      case SUCCESS:
+        return isSetSuccess();
+      }
+      throw new java.lang.IllegalStateException();
+    }
+
+    @Override
+    public boolean equals(java.lang.Object that) {
+      if (that == null)
+        return false;
+      if (that instanceof remove_master_key_result)
+        return this.equals((remove_master_key_result)that);
+      return false;
+    }
+
+    public boolean equals(remove_master_key_result that) {
+      if (that == null)
+        return false;
+      if (this == that)
+        return true;
+
+      boolean this_present_success = true;
+      boolean that_present_success = true;
+      if (this_present_success || that_present_success) {
+        if (!(this_present_success && that_present_success))
+          return false;
+        if (this.success != that.success)
+          return false;
+      }
+
+      return true;
+    }
+
+    @Override
+    public int hashCode() {
+      int hashCode = 1;
+
+      hashCode = hashCode * 8191 + ((success) ? 131071 : 524287);
+
+      return hashCode;
+    }
+
+    @Override
+    public int compareTo(remove_master_key_result other) {
+      if (!getClass().equals(other.getClass())) {
+        return getClass().getName().compareTo(other.getClass().getName());
+      }
+
+      int lastComparison = 0;
+
+      lastComparison = java.lang.Boolean.valueOf(isSetSuccess()).compareTo(other.isSetSuccess());
+      if (lastComparison != 0) {
+        return lastComparison;
+      }
+      if (isSetSuccess()) {
+        lastComparison = org.apache.thrift.TBaseHelper.compareTo(this.success, other.success);
+        if (lastComparison != 0) {
+          return lastComparison;
+        }
+      }
+      return 0;
+    }
+
+    @org.apache.thrift.annotation.Nullable
+    public _Fields fieldForId(int fieldId) {
+      return _Fields.findByThriftId(fieldId);
+    }
+
+    public void read(org.apache.thrift.protocol.TProtocol iprot) throws org.apache.thrift.TException {
+      scheme(iprot).read(iprot, this);
+    }
+
+    public void write(org.apache.thrift.protocol.TProtocol oprot) throws org.apache.thrift.TException {
+      scheme(oprot).write(oprot, this);
+      }
+
+    @Override
+    public java.lang.String toString() {
+      java.lang.StringBuilder sb = new java.lang.StringBuilder("remove_master_key_result(");
+      boolean first = true;
+
+      sb.append("success:");
+      sb.append(this.success);
+      first = false;
+      sb.append(")");
+      return sb.toString();
+    }
+
+    public void validate() throws org.apache.thrift.TException {
+      // check for required fields
+      // check for sub-struct validity
+    }
+
+    private void writeObject(java.io.ObjectOutputStream out) throws java.io.IOException {
+      try {
+        write(new org.apache.thrift.protocol.TCompactProtocol(new org.apache.thrift.transport.TIOStreamTransport(out)));
+      } catch (org.apache.thrift.TException te) {
+        throw new java.io.IOException(te);
+      }
+    }
+
+    private void readObject(java.io.ObjectInputStream in) throws java.io.IOException, java.lang.ClassNotFoundException {
+      try {
+        // it doesn't seem like you should have to do this, but java serialization is wacky, and doesn't call the default constructor.
+        __isset_bitfield = 0;
+        read(new org.apache.thrift.protocol.TCompactProtocol(new org.apache.thrift.transport.TIOStreamTransport(in)));
+      } catch (org.apache.thrift.TException te) {
+        throw new java.io.IOException(te);
+      }
+    }
+
+    private static class remove_master_key_resultStandardSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
+      public remove_master_key_resultStandardScheme getScheme() {
+        return new remove_master_key_resultStandardScheme();
+      }
+    }
+
+    private static class remove_master_key_resultStandardScheme extends org.apache.thrift.scheme.StandardScheme<remove_master_key_result> {
+
+      public void read(org.apache.thrift.protocol.TProtocol iprot, remove_master_key_result struct) throws org.apache.thrift.TException {
+        org.apache.thrift.protocol.TField schemeField;
+        iprot.readStructBegin();
+        while (true)
+        {
+          schemeField = iprot.readFieldBegin();
+          if (schemeField.type == org.apache.thrift.protocol.TType.STOP) { 
+            break;
+          }
+          switch (schemeField.id) {
+            case 0: // SUCCESS
+              if (schemeField.type == org.apache.thrift.protocol.TType.BOOL) {
+                struct.success = iprot.readBool();
+                struct.setSuccessIsSet(true);
+              } else { 
+                org.apache.thrift.protocol.TProtocolUtil.skip(iprot, schemeField.type);
+              }
+              break;
+            default:
+              org.apache.thrift.protocol.TProtocolUtil.skip(iprot, schemeField.type);
+          }
+          iprot.readFieldEnd();
+        }
+        iprot.readStructEnd();
+        struct.validate();
+      }
+
+      public void write(org.apache.thrift.protocol.TProtocol oprot, remove_master_key_result struct) throws org.apache.thrift.TException {
+        struct.validate();
+
+        oprot.writeStructBegin(STRUCT_DESC);
+        if (struct.isSetSuccess()) {
+          oprot.writeFieldBegin(SUCCESS_FIELD_DESC);
+          oprot.writeBool(struct.success);
+          oprot.writeFieldEnd();
+        }
+        oprot.writeFieldStop();
+        oprot.writeStructEnd();
+      }
+
+    }
+
+    private static class remove_master_key_resultTupleSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
+      public remove_master_key_resultTupleScheme getScheme() {
+        return new remove_master_key_resultTupleScheme();
+      }
+    }
+
+    private static class remove_master_key_resultTupleScheme extends org.apache.thrift.scheme.TupleScheme<remove_master_key_result> {
+
+      @Override
+      public void write(org.apache.thrift.protocol.TProtocol prot, remove_master_key_result struct) throws org.apache.thrift.TException {
+        org.apache.thrift.protocol.TTupleProtocol oprot = (org.apache.thrift.protocol.TTupleProtocol) prot;
+        java.util.BitSet optionals = new java.util.BitSet();
+        if (struct.isSetSuccess()) {
+          optionals.set(0);
+        }
+        oprot.writeBitSet(optionals, 1);
+        if (struct.isSetSuccess()) {
+          oprot.writeBool(struct.success);
+        }
+      }
+
+      @Override
+      public void read(org.apache.thrift.protocol.TProtocol prot, remove_master_key_result struct) throws org.apache.thrift.TException {
+        org.apache.thrift.protocol.TTupleProtocol iprot = (org.apache.thrift.protocol.TTupleProtocol) prot;
+        java.util.BitSet incoming = iprot.readBitSet(1);
+        if (incoming.get(0)) {
+          struct.success = iprot.readBool();
+          struct.setSuccessIsSet(true);
+        }
+      }
+    }
+
+    private static <S extends org.apache.thrift.scheme.IScheme> S scheme(org.apache.thrift.protocol.TProtocol proto) {
+      return (org.apache.thrift.scheme.StandardScheme.class.equals(proto.getScheme()) ? STANDARD_SCHEME_FACTORY : TUPLE_SCHEME_FACTORY).getScheme();
+    }
+  }
+
+  @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_master_keys_args implements org.apache.thrift.TBase<get_master_keys_args, get_master_keys_args._Fields>, java.io.Serializable, Cloneable, Comparable<get_master_keys_args>   {
+    private static final org.apache.thrift.protocol.TStruct STRUCT_DESC = new org.apache.thrift.protocol.TStruct("get_master_keys_args");
+
+
+    private static final org.apache.thrift.scheme.SchemeFactory STANDARD_SCHEME_FACTORY = new get_master_keys_argsStandardSchemeFactory();
+    private static final org.apache.thrift.scheme.SchemeFactory TUPLE_SCHEME_FACTORY = new get_master_keys_argsTupleSchemeFactory();
+
+
+    /** The set of fields this struct contains, along with convenience methods for finding and manipulating them. */
+    public enum _Fields implements org.apache.thrift.TFieldIdEnum {
+;
+
+      private static final java.util.Map<java.lang.String, _Fields> byName = new java.util.HashMap<java.lang.String, _Fields>();
+
+      static {
+        for (_Fields field : java.util.EnumSet.allOf(_Fields.class)) {
+          byName.put(field.getFieldName(), field);
+        }
+      }
+
+      /**
+       * Find the _Fields constant that matches fieldId, or null if its not found.
+       */
+      @org.apache.thrift.annotation.Nullable
+      public static _Fields findByThriftId(int fieldId) {
+        switch(fieldId) {
+          default:
+            return null;
+        }
+      }
+
+      /**
+       * Find the _Fields constant that matches fieldId, throwing an exception
+       * if it is not found.
+       */
+      public static _Fields findByThriftIdOrThrow(int fieldId) {
+        _Fields fields = findByThriftId(fieldId);
+        if (fields == null) throw new java.lang.IllegalArgumentException("Field " + fieldId + " doesn't exist!");
+        return fields;
+      }
+
+      /**
+       * Find the _Fields constant that matches name, or null if its not found.
+       */
+      @org.apache.thrift.annotation.Nullable
+      public static _Fields findByName(java.lang.String name) {
+        return byName.get(name);
+      }
+
+      private final short _thriftId;
+      private final java.lang.String _fieldName;
+
+      _Fields(short thriftId, java.lang.String fieldName) {
+        _thriftId = thriftId;
+        _fieldName = fieldName;
+      }
+
+      public short getThriftFieldId() {
+        return _thriftId;
+      }
+
+      public java.lang.String getFieldName() {
+        return _fieldName;
+      }
+    }
     public static final java.util.Map<_Fields, org.apache.thrift.meta_data.FieldMetaData> metaDataMap;
     static {
       java.util.Map<_Fields, org.apache.thrift.meta_data.FieldMetaData> tmpMap = new java.util.EnumMap<_Fields, org.apache.thrift.meta_data.FieldMetaData>(_Fields.class);
-      tmpMap.put(_Fields.KEY_SEQ, new org.apache.thrift.meta_data.FieldMetaData("key_seq", org.apache.thrift.TFieldRequirementType.DEFAULT, 
-          new org.apache.thrift.meta_data.FieldValueMetaData(org.apache.thrift.protocol.TType.I32)));
       metaDataMap = java.util.Collections.unmodifiableMap(tmpMap);
-      org.apache.thrift.meta_data.FieldMetaData.addStructMetaDataMap(remove_master_key_args.class, metaDataMap);
-    }
-
-    public remove_master_key_args() {
+      org.apache.thrift.meta_data.FieldMetaData.addStructMetaDataMap(get_master_keys_args.class, metaDataMap);
     }
 
-    public remove_master_key_args(
-      int key_seq)
-    {
-      this();
-      this.key_seq = key_seq;
-      setKey_seqIsSet(true);
+    public get_master_keys_args() {
     }
 
     /**
      * Performs a deep copy on <i>other</i>.
      */
-    public remove_master_key_args(remove_master_key_args other) {
-      __isset_bitfield = other.__isset_bitfield;
-      this.key_seq = other.key_seq;
+    public get_master_keys_args(get_master_keys_args other) {
     }
 
-    public remove_master_key_args deepCopy() {
-      return new remove_master_key_args(this);
+    public get_master_keys_args deepCopy() {
+      return new get_master_keys_args(this);
     }
 
     @Override
     public void clear() {
-      setKey_seqIsSet(false);
-      this.key_seq = 0;
-    }
-
-    public int getKey_seq() {
-      return this.key_seq;
-    }
-
-    public void setKey_seq(int key_seq) {
-      this.key_seq = key_seq;
-      setKey_seqIsSet(true);
-    }
-
-    public void unsetKey_seq() {
-      __isset_bitfield = org.apache.thrift.EncodingUtils.clearBit(__isset_bitfield, __KEY_SEQ_ISSET_ID);
-    }
-
-    /** Returns true if field key_seq is set (has been assigned a value) and false otherwise */
-    public boolean isSetKey_seq() {
-      return org.apache.thrift.EncodingUtils.testBit(__isset_bitfield, __KEY_SEQ_ISSET_ID);
-    }
-
-    public void setKey_seqIsSet(boolean value) {
-      __isset_bitfield = org.apache.thrift.EncodingUtils.setBit(__isset_bitfield, __KEY_SEQ_ISSET_ID, value);
     }
 
     public void setFieldValue(_Fields field, @org.apache.thrift.annotation.Nullable java.lang.Object value) {
       switch (field) {
-      case KEY_SEQ:
-        if (value == null) {
-          unsetKey_seq();
-        } else {
-          setKey_seq((java.lang.Integer)value);
-        }
-        break;
-
       }
     }
 
     @org.apache.thrift.annotation.Nullable
     public java.lang.Object getFieldValue(_Fields field) {
       switch (field) {
-      case KEY_SEQ:
-        return getKey_seq();
-
       }
       throw new java.lang.IllegalStateException();
     }
@@ -210248,8 +211073,6 @@ public boolean isSet(_Fields field) {
       }
 
       switch (field) {
-      case KEY_SEQ:
-        return isSetKey_seq();
       }
       throw new java.lang.IllegalStateException();
     }
@@ -210258,26 +211081,17 @@ public boolean isSet(_Fields field) {
     public boolean equals(java.lang.Object that) {
       if (that == null)
         return false;
-      if (that instanceof remove_master_key_args)
-        return this.equals((remove_master_key_args)that);
+      if (that instanceof get_master_keys_args)
+        return this.equals((get_master_keys_args)that);
       return false;
     }
 
-    public boolean equals(remove_master_key_args that) {
+    public boolean equals(get_master_keys_args that) {
       if (that == null)
         return false;
       if (this == that)
         return true;
 
-      boolean this_present_key_seq = true;
-      boolean that_present_key_seq = true;
-      if (this_present_key_seq || that_present_key_seq) {
-        if (!(this_present_key_seq && that_present_key_seq))
-          return false;
-        if (this.key_seq != that.key_seq)
-          return false;
-      }
-
       return true;
     }
 
@@ -210285,29 +211099,17 @@ public boolean equals(remove_master_key_args that) {
     public int hashCode() {
       int hashCode = 1;
 
-      hashCode = hashCode * 8191 + key_seq;
-
       return hashCode;
     }
 
     @Override
-    public int compareTo(remove_master_key_args other) {
+    public int compareTo(get_master_keys_args other) {
       if (!getClass().equals(other.getClass())) {
         return getClass().getName().compareTo(other.getClass().getName());
       }
 
       int lastComparison = 0;
 
-      lastComparison = java.lang.Boolean.valueOf(isSetKey_seq()).compareTo(other.isSetKey_seq());
-      if (lastComparison != 0) {
-        return lastComparison;
-      }
-      if (isSetKey_seq()) {
-        lastComparison = org.apache.thrift.TBaseHelper.compareTo(this.key_seq, other.key_seq);
-        if (lastComparison != 0) {
-          return lastComparison;
-        }
-      }
       return 0;
     }
 
@@ -210326,12 +211128,9 @@ public void write(org.apache.thrift.protocol.TProtocol oprot) throws org.apache.
 
     @Override
     public java.lang.String toString() {
-      java.lang.StringBuilder sb = new java.lang.StringBuilder("remove_master_key_args(");
+      java.lang.StringBuilder sb = new java.lang.StringBuilder("get_master_keys_args(");
       boolean first = true;
 
-      sb.append("key_seq:");
-      sb.append(this.key_seq);
-      first = false;
       sb.append(")");
       return sb.toString();
     }
@@ -210351,23 +211150,21 @@ private void writeObject(java.io.ObjectOutputStream out) throws java.io.IOExcept
 
     private void readObject(java.io.ObjectInputStream in) throws java.io.IOException, java.lang.ClassNotFoundException {
       try {
-        // it doesn't seem like you should have to do this, but java serialization is wacky, and doesn't call the default constructor.
-        __isset_bitfield = 0;
         read(new org.apache.thrift.protocol.TCompactProtocol(new org.apache.thrift.transport.TIOStreamTransport(in)));
       } catch (org.apache.thrift.TException te) {
         throw new java.io.IOException(te);
       }
     }
 
-    private static class remove_master_key_argsStandardSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
-      public remove_master_key_argsStandardScheme getScheme() {
-        return new remove_master_key_argsStandardScheme();
+    private static class get_master_keys_argsStandardSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
+      public get_master_keys_argsStandardScheme getScheme() {
+        return new get_master_keys_argsStandardScheme();
       }
     }
 
-    private static class remove_master_key_argsStandardScheme extends org.apache.thrift.scheme.StandardScheme<remove_master_key_args> {
+    private static class get_master_keys_argsStandardScheme extends org.apache.thrift.scheme.StandardScheme<get_master_keys_args> {
 
-      public void read(org.apache.thrift.protocol.TProtocol iprot, remove_master_key_args struct) throws org.apache.thrift.TException {
+      public void read(org.apache.thrift.protocol.TProtocol iprot, get_master_keys_args struct) throws org.apache.thrift.TException {
         org.apache.thrift.protocol.TField schemeField;
         iprot.readStructBegin();
         while (true)
@@ -210377,14 +211174,6 @@ public void read(org.apache.thrift.protocol.TProtocol iprot, remove_master_key_a
             break;
           }
           switch (schemeField.id) {
-            case 1: // KEY_SEQ
-              if (schemeField.type == org.apache.thrift.protocol.TType.I32) {
-                struct.key_seq = iprot.readI32();
-                struct.setKey_seqIsSet(true);
-              } else { 
-                org.apache.thrift.protocol.TProtocolUtil.skip(iprot, schemeField.type);
-              }
-              break;
             default:
               org.apache.thrift.protocol.TProtocolUtil.skip(iprot, schemeField.type);
           }
@@ -210394,48 +211183,32 @@ public void read(org.apache.thrift.protocol.TProtocol iprot, remove_master_key_a
         struct.validate();
       }
 
-      public void write(org.apache.thrift.protocol.TProtocol oprot, remove_master_key_args struct) throws org.apache.thrift.TException {
+      public void write(org.apache.thrift.protocol.TProtocol oprot, get_master_keys_args struct) throws org.apache.thrift.TException {
         struct.validate();
 
         oprot.writeStructBegin(STRUCT_DESC);
-        oprot.writeFieldBegin(KEY_SEQ_FIELD_DESC);
-        oprot.writeI32(struct.key_seq);
-        oprot.writeFieldEnd();
         oprot.writeFieldStop();
         oprot.writeStructEnd();
       }
 
     }
 
-    private static class remove_master_key_argsTupleSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
-      public remove_master_key_argsTupleScheme getScheme() {
-        return new remove_master_key_argsTupleScheme();
+    private static class get_master_keys_argsTupleSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
+      public get_master_keys_argsTupleScheme getScheme() {
+        return new get_master_keys_argsTupleScheme();
       }
     }
 
-    private static class remove_master_key_argsTupleScheme extends org.apache.thrift.scheme.TupleScheme<remove_master_key_args> {
+    private static class get_master_keys_argsTupleScheme extends org.apache.thrift.scheme.TupleScheme<get_master_keys_args> {
 
       @Override
-      public void write(org.apache.thrift.protocol.TProtocol prot, remove_master_key_args struct) throws org.apache.thrift.TException {
+      public void write(org.apache.thrift.protocol.TProtocol prot, get_master_keys_args struct) throws org.apache.thrift.TException {
         org.apache.thrift.protocol.TTupleProtocol oprot = (org.apache.thrift.protocol.TTupleProtocol) prot;
-        java.util.BitSet optionals = new java.util.BitSet();
-        if (struct.isSetKey_seq()) {
-          optionals.set(0);
-        }
-        oprot.writeBitSet(optionals, 1);
-        if (struct.isSetKey_seq()) {
-          oprot.writeI32(struct.key_seq);
-        }
       }
 
       @Override
-      public void read(org.apache.thrift.protocol.TProtocol prot, remove_master_key_args struct) throws org.apache.thrift.TException {
+      public void read(org.apache.thrift.protocol.TProtocol prot, get_master_keys_args struct) throws org.apache.thrift.TException {
         org.apache.thrift.protocol.TTupleProtocol iprot = (org.apache.thrift.protocol.TTupleProtocol) prot;
-        java.util.BitSet incoming = iprot.readBitSet(1);
-        if (incoming.get(0)) {
-          struct.key_seq = iprot.readI32();
-          struct.setKey_seqIsSet(true);
-        }
       }
     }
 
@@ -210444,15 +211217,15 @@ private static <S extends org.apache.thrift.scheme.IScheme> S scheme(org.apache.
     }
   }
 
-  @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class remove_master_key_result implements org.apache.thrift.TBase<remove_master_key_result, remove_master_key_result._Fields>, java.io.Serializable, Cloneable, Comparable<remove_master_key_result>   {
-    private static final org.apache.thrift.protocol.TStruct STRUCT_DESC = new org.apache.thrift.protocol.TStruct("remove_master_key_result");
+  @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_master_keys_result implements org.apache.thrift.TBase<get_master_keys_result, get_master_keys_result._Fields>, java.io.Serializable, Cloneable, Comparable<get_master_keys_result>   {
+    private static final org.apache.thrift.protocol.TStruct STRUCT_DESC = new org.apache.thrift.protocol.TStruct("get_master_keys_result");
 
-    private static final org.apache.thrift.protocol.TField SUCCESS_FIELD_DESC = new org.apache.thrift.protocol.TField("success", org.apache.thrift.protocol.TType.BOOL, (short)0);
+    private static final org.apache.thrift.protocol.TField SUCCESS_FIELD_DESC = new org.apache.thrift.protocol.TField("success", org.apache.thrift.protocol.TType.LIST, (short)0);
 
-    private static final org.apache.thrift.scheme.SchemeFactory STANDARD_SCHEME_FACTORY = new remove_master_key_resultStandardSchemeFactory();
-    private static final org.apache.thrift.scheme.SchemeFactory TUPLE_SCHEME_FACTORY = new remove_master_key_resultTupleSchemeFactory();
+    private static final org.apache.thrift.scheme.SchemeFactory STANDARD_SCHEME_FACTORY = new get_master_keys_resultStandardSchemeFactory();
+    private static final org.apache.thrift.scheme.SchemeFactory TUPLE_SCHEME_FACTORY = new get_master_keys_resultTupleSchemeFactory();
 
-    private boolean success; // required
+    private @org.apache.thrift.annotation.Nullable java.util.List<java.lang.String> success; // required
 
     /** The set of fields this struct contains, along with convenience methods for finding and manipulating them. */
     public enum _Fields implements org.apache.thrift.TFieldIdEnum {
@@ -210515,66 +211288,83 @@ public java.lang.String getFieldName() {
     }
 
     // isset id assignments
-    private static final int __SUCCESS_ISSET_ID = 0;
-    private byte __isset_bitfield = 0;
     public static final java.util.Map<_Fields, org.apache.thrift.meta_data.FieldMetaData> metaDataMap;
     static {
       java.util.Map<_Fields, org.apache.thrift.meta_data.FieldMetaData> tmpMap = new java.util.EnumMap<_Fields, org.apache.thrift.meta_data.FieldMetaData>(_Fields.class);
       tmpMap.put(_Fields.SUCCESS, new org.apache.thrift.meta_data.FieldMetaData("success", org.apache.thrift.TFieldRequirementType.DEFAULT, 
-          new org.apache.thrift.meta_data.FieldValueMetaData(org.apache.thrift.protocol.TType.BOOL)));
+          new org.apache.thrift.meta_data.ListMetaData(org.apache.thrift.protocol.TType.LIST, 
+              new org.apache.thrift.meta_data.FieldValueMetaData(org.apache.thrift.protocol.TType.STRING))));
       metaDataMap = java.util.Collections.unmodifiableMap(tmpMap);
-      org.apache.thrift.meta_data.FieldMetaData.addStructMetaDataMap(remove_master_key_result.class, metaDataMap);
+      org.apache.thrift.meta_data.FieldMetaData.addStructMetaDataMap(get_master_keys_result.class, metaDataMap);
     }
 
-    public remove_master_key_result() {
+    public get_master_keys_result() {
     }
 
-    public remove_master_key_result(
-      boolean success)
+    public get_master_keys_result(
+      java.util.List<java.lang.String> success)
     {
       this();
       this.success = success;
-      setSuccessIsSet(true);
     }
 
     /**
      * Performs a deep copy on <i>other</i>.
      */
-    public remove_master_key_result(remove_master_key_result other) {
-      __isset_bitfield = other.__isset_bitfield;
-      this.success = other.success;
+    public get_master_keys_result(get_master_keys_result other) {
+      if (other.isSetSuccess()) {
+        java.util.List<java.lang.String> __this__success = new java.util.ArrayList<java.lang.String>(other.success);
+        this.success = __this__success;
+      }
     }
 
-    public remove_master_key_result deepCopy() {
-      return new remove_master_key_result(this);
+    public get_master_keys_result deepCopy() {
+      return new get_master_keys_result(this);
     }
 
     @Override
     public void clear() {
-      setSuccessIsSet(false);
-      this.success = false;
+      this.success = null;
     }
 
-    public boolean isSuccess() {
+    public int getSuccessSize() {
+      return (this.success == null) ? 0 : this.success.size();
+    }
+
+    @org.apache.thrift.annotation.Nullable
+    public java.util.Iterator<java.lang.String> getSuccessIterator() {
+      return (this.success == null) ? null : this.success.iterator();
+    }
+
+    public void addToSuccess(java.lang.String elem) {
+      if (this.success == null) {
+        this.success = new java.util.ArrayList<java.lang.String>();
+      }
+      this.success.add(elem);
+    }
+
+    @org.apache.thrift.annotation.Nullable
+    public java.util.List<java.lang.String> getSuccess() {
       return this.success;
     }
 
-    public void setSuccess(boolean success) {
+    public void setSuccess(@org.apache.thrift.annotation.Nullable java.util.List<java.lang.String> success) {
       this.success = success;
-      setSuccessIsSet(true);
     }
 
     public void unsetSuccess() {
-      __isset_bitfield = org.apache.thrift.EncodingUtils.clearBit(__isset_bitfield, __SUCCESS_ISSET_ID);
+      this.success = null;
     }
 
     /** Returns true if field success is set (has been assigned a value) and false otherwise */
     public boolean isSetSuccess() {
-      return org.apache.thrift.EncodingUtils.testBit(__isset_bitfield, __SUCCESS_ISSET_ID);
+      return this.success != null;
     }
 
     public void setSuccessIsSet(boolean value) {
-      __isset_bitfield = org.apache.thrift.EncodingUtils.setBit(__isset_bitfield, __SUCCESS_ISSET_ID, value);
+      if (!value) {
+        this.success = null;
+      }
     }
 
     public void setFieldValue(_Fields field, @org.apache.thrift.annotation.Nullable java.lang.Object value) {
@@ -210583,7 +211373,7 @@ public void setFieldValue(_Fields field, @org.apache.thrift.annotation.Nullable
         if (value == null) {
           unsetSuccess();
         } else {
-          setSuccess((java.lang.Boolean)value);
+          setSuccess((java.util.List<java.lang.String>)value);
         }
         break;
 
@@ -210594,7 +211384,7 @@ public void setFieldValue(_Fields field, @org.apache.thrift.annotation.Nullable
     public java.lang.Object getFieldValue(_Fields field) {
       switch (field) {
       case SUCCESS:
-        return isSuccess();
+        return getSuccess();
 
       }
       throw new java.lang.IllegalStateException();
@@ -210617,23 +211407,23 @@ public boolean isSet(_Fields field) {
     public boolean equals(java.lang.Object that) {
       if (that == null)
         return false;
-      if (that instanceof remove_master_key_result)
-        return this.equals((remove_master_key_result)that);
+      if (that instanceof get_master_keys_result)
+        return this.equals((get_master_keys_result)that);
       return false;
     }
 
-    public boolean equals(remove_master_key_result that) {
+    public boolean equals(get_master_keys_result that) {
       if (that == null)
         return false;
       if (this == that)
         return true;
 
-      boolean this_present_success = true;
-      boolean that_present_success = true;
+      boolean this_present_success = true && this.isSetSuccess();
+      boolean that_present_success = true && that.isSetSuccess();
       if (this_present_success || that_present_success) {
         if (!(this_present_success && that_present_success))
           return false;
-        if (this.success != that.success)
+        if (!this.success.equals(that.success))
           return false;
       }
 
@@ -210644,13 +211434,15 @@ public boolean equals(remove_master_key_result that) {
     public int hashCode() {
       int hashCode = 1;
 
-      hashCode = hashCode * 8191 + ((success) ? 131071 : 524287);
+      hashCode = hashCode * 8191 + ((isSetSuccess()) ? 131071 : 524287);
+      if (isSetSuccess())
+        hashCode = hashCode * 8191 + success.hashCode();
 
       return hashCode;
     }
 
     @Override
-    public int compareTo(remove_master_key_result other) {
+    public int compareTo(get_master_keys_result other) {
       if (!getClass().equals(other.getClass())) {
         return getClass().getName().compareTo(other.getClass().getName());
       }
@@ -210685,11 +211477,15 @@ public void write(org.apache.thrift.protocol.TProtocol oprot) throws org.apache.
 
     @Override
     public java.lang.String toString() {
-      java.lang.StringBuilder sb = new java.lang.StringBuilder("remove_master_key_result(");
+      java.lang.StringBuilder sb = new java.lang.StringBuilder("get_master_keys_result(");
       boolean first = true;
 
       sb.append("success:");
-      sb.append(this.success);
+      if (this.success == null) {
+        sb.append("null");
+      } else {
+        sb.append(this.success);
+      }
       first = false;
       sb.append(")");
       return sb.toString();
@@ -210710,23 +211506,21 @@ private void writeObject(java.io.ObjectOutputStream out) throws java.io.IOExcept
 
     private void readObject(java.io.ObjectInputStream in) throws java.io.IOException, java.lang.ClassNotFoundException {
       try {
-        // it doesn't seem like you should have to do this, but java serialization is wacky, and doesn't call the default constructor.
-        __isset_bitfield = 0;
         read(new org.apache.thrift.protocol.TCompactProtocol(new org.apache.thrift.transport.TIOStreamTransport(in)));
       } catch (org.apache.thrift.TException te) {
         throw new java.io.IOException(te);
       }
     }
 
-    private static class remove_master_key_resultStandardSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
-      public remove_master_key_resultStandardScheme getScheme() {
-        return new remove_master_key_resultStandardScheme();
+    private static class get_master_keys_resultStandardSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
+      public get_master_keys_resultStandardScheme getScheme() {
+        return new get_master_keys_resultStandardScheme();
       }
     }
 
-    private static class remove_master_key_resultStandardScheme extends org.apache.thrift.scheme.StandardScheme<remove_master_key_result> {
+    private static class get_master_keys_resultStandardScheme extends org.apache.thrift.scheme.StandardScheme<get_master_keys_result> {
 
-      public void read(org.apache.thrift.protocol.TProtocol iprot, remove_master_key_result struct) throws org.apache.thrift.TException {
+      public void read(org.apache.thrift.protocol.TProtocol iprot, get_master_keys_result struct) throws org.apache.thrift.TException {
         org.apache.thrift.protocol.TField schemeField;
         iprot.readStructBegin();
         while (true)
@@ -210737,8 +211531,18 @@ public void read(org.apache.thrift.protocol.TProtocol iprot, remove_master_key_r
           }
           switch (schemeField.id) {
             case 0: // SUCCESS
-              if (schemeField.type == org.apache.thrift.protocol.TType.BOOL) {
-                struct.success = iprot.readBool();
+              if (schemeField.type == org.apache.thrift.protocol.TType.LIST) {
+                {
+                  org.apache.thrift.protocol.TList _list1916 = iprot.readListBegin();
+                  struct.success = new java.util.ArrayList<java.lang.String>(_list1916.size);
+                  @org.apache.thrift.annotation.Nullable java.lang.String _elem1917;
+                  for (int _i1918 = 0; _i1918 < _list1916.size; ++_i1918)
+                  {
+                    _elem1917 = iprot.readString();
+                    struct.success.add(_elem1917);
+                  }
+                  iprot.readListEnd();
+                }
                 struct.setSuccessIsSet(true);
               } else { 
                 org.apache.thrift.protocol.TProtocolUtil.skip(iprot, schemeField.type);
@@ -210753,13 +211557,20 @@ public void read(org.apache.thrift.protocol.TProtocol iprot, remove_master_key_r
         struct.validate();
       }
 
-      public void write(org.apache.thrift.protocol.TProtocol oprot, remove_master_key_result struct) throws org.apache.thrift.TException {
+      public void write(org.apache.thrift.protocol.TProtocol oprot, get_master_keys_result struct) throws org.apache.thrift.TException {
         struct.validate();
 
         oprot.writeStructBegin(STRUCT_DESC);
-        if (struct.isSetSuccess()) {
+        if (struct.success != null) {
           oprot.writeFieldBegin(SUCCESS_FIELD_DESC);
-          oprot.writeBool(struct.success);
+          {
+            oprot.writeListBegin(new org.apache.thrift.protocol.TList(org.apache.thrift.protocol.TType.STRING, struct.success.size()));
+            for (java.lang.String _iter1919 : struct.success)
+            {
+              oprot.writeString(_iter1919);
+            }
+            oprot.writeListEnd();
+          }
           oprot.writeFieldEnd();
         }
         oprot.writeFieldStop();
@@ -210768,16 +211579,16 @@ public void write(org.apache.thrift.protocol.TProtocol oprot, remove_master_key_
 
     }
 
-    private static class remove_master_key_resultTupleSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
-      public remove_master_key_resultTupleScheme getScheme() {
-        return new remove_master_key_resultTupleScheme();
+    private static class get_master_keys_resultTupleSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
+      public get_master_keys_resultTupleScheme getScheme() {
+        return new get_master_keys_resultTupleScheme();
       }
     }
 
-    private static class remove_master_key_resultTupleScheme extends org.apache.thrift.scheme.TupleScheme<remove_master_key_result> {
+    private static class get_master_keys_resultTupleScheme extends org.apache.thrift.scheme.TupleScheme<get_master_keys_result> {
 
       @Override
-      public void write(org.apache.thrift.protocol.TProtocol prot, remove_master_key_result struct) throws org.apache.thrift.TException {
+      public void write(org.apache.thrift.protocol.TProtocol prot, get_master_keys_result struct) throws org.apache.thrift.TException {
         org.apache.thrift.protocol.TTupleProtocol oprot = (org.apache.thrift.protocol.TTupleProtocol) prot;
         java.util.BitSet optionals = new java.util.BitSet();
         if (struct.isSetSuccess()) {
@@ -210785,16 +211596,31 @@ public void write(org.apache.thrift.protocol.TProtocol prot, remove_master_key_r
         }
         oprot.writeBitSet(optionals, 1);
         if (struct.isSetSuccess()) {
-          oprot.writeBool(struct.success);
+          {
+            oprot.writeI32(struct.success.size());
+            for (java.lang.String _iter1920 : struct.success)
+            {
+              oprot.writeString(_iter1920);
+            }
+          }
         }
       }
 
       @Override
-      public void read(org.apache.thrift.protocol.TProtocol prot, remove_master_key_result struct) throws org.apache.thrift.TException {
+      public void read(org.apache.thrift.protocol.TProtocol prot, get_master_keys_result struct) throws org.apache.thrift.TException {
         org.apache.thrift.protocol.TTupleProtocol iprot = (org.apache.thrift.protocol.TTupleProtocol) prot;
         java.util.BitSet incoming = iprot.readBitSet(1);
         if (incoming.get(0)) {
-          struct.success = iprot.readBool();
+          {
+            org.apache.thrift.protocol.TList _list1921 = new org.apache.thrift.protocol.TList(org.apache.thrift.protocol.TType.STRING, iprot.readI32());
+            struct.success = new java.util.ArrayList<java.lang.String>(_list1921.size);
+            @org.apache.thrift.annotation.Nullable java.lang.String _elem1922;
+            for (int _i1923 = 0; _i1923 < _list1921.size; ++_i1923)
+            {
+              _elem1922 = iprot.readString();
+              struct.success.add(_elem1922);
+            }
+          }
           struct.setSuccessIsSet(true);
         }
       }
@@ -210805,12 +211631,12 @@ private static <S extends org.apache.thrift.scheme.IScheme> S scheme(org.apache.
     }
   }
 
-  @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_master_keys_args implements org.apache.thrift.TBase<get_master_keys_args, get_master_keys_args._Fields>, java.io.Serializable, Cloneable, Comparable<get_master_keys_args>   {
-    private static final org.apache.thrift.protocol.TStruct STRUCT_DESC = new org.apache.thrift.protocol.TStruct("get_master_keys_args");
+  @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_open_txns_args implements org.apache.thrift.TBase<get_open_txns_args, get_open_txns_args._Fields>, java.io.Serializable, Cloneable, Comparable<get_open_txns_args>   {
+    private static final org.apache.thrift.protocol.TStruct STRUCT_DESC = new org.apache.thrift.protocol.TStruct("get_open_txns_args");
 
 
-    private static final org.apache.thrift.scheme.SchemeFactory STANDARD_SCHEME_FACTORY = new get_master_keys_argsStandardSchemeFactory();
-    private static final org.apache.thrift.scheme.SchemeFactory TUPLE_SCHEME_FACTORY = new get_master_keys_argsTupleSchemeFactory();
+    private static final org.apache.thrift.scheme.SchemeFactory STANDARD_SCHEME_FACTORY = new get_open_txns_argsStandardSchemeFactory();
+    private static final org.apache.thrift.scheme.SchemeFactory TUPLE_SCHEME_FACTORY = new get_open_txns_argsTupleSchemeFactory();
 
 
     /** The set of fields this struct contains, along with convenience methods for finding and manipulating them. */
@@ -210874,20 +211700,20 @@ public java.lang.String getFieldName() {
     static {
       java.util.Map<_Fields, org.apache.thrift.meta_data.FieldMetaData> tmpMap = new java.util.EnumMap<_Fields, org.apache.thrift.meta_data.FieldMetaData>(_Fields.class);
       metaDataMap = java.util.Collections.unmodifiableMap(tmpMap);
-      org.apache.thrift.meta_data.FieldMetaData.addStructMetaDataMap(get_master_keys_args.class, metaDataMap);
+      org.apache.thrift.meta_data.FieldMetaData.addStructMetaDataMap(get_open_txns_args.class, metaDataMap);
     }
 
-    public get_master_keys_args() {
+    public get_open_txns_args() {
     }
 
     /**
      * Performs a deep copy on <i>other</i>.
      */
-    public get_master_keys_args(get_master_keys_args other) {
+    public get_open_txns_args(get_open_txns_args other) {
     }
 
-    public get_master_keys_args deepCopy() {
-      return new get_master_keys_args(this);
+    public get_open_txns_args deepCopy() {
+      return new get_open_txns_args(this);
     }
 
     @Override
@@ -210921,12 +211747,12 @@ public boolean isSet(_Fields field) {
     public boolean equals(java.lang.Object that) {
       if (that == null)
         return false;
-      if (that instanceof get_master_keys_args)
-        return this.equals((get_master_keys_args)that);
+      if (that instanceof get_open_txns_args)
+        return this.equals((get_open_txns_args)that);
       return false;
     }
 
-    public boolean equals(get_master_keys_args that) {
+    public boolean equals(get_open_txns_args that) {
       if (that == null)
         return false;
       if (this == that)
@@ -210943,7 +211769,7 @@ public int hashCode() {
     }
 
     @Override
-    public int compareTo(get_master_keys_args other) {
+    public int compareTo(get_open_txns_args other) {
       if (!getClass().equals(other.getClass())) {
         return getClass().getName().compareTo(other.getClass().getName());
       }
@@ -210968,7 +211794,7 @@ public void write(org.apache.thrift.protocol.TProtocol oprot) throws org.apache.
 
     @Override
     public java.lang.String toString() {
-      java.lang.StringBuilder sb = new java.lang.StringBuilder("get_master_keys_args(");
+      java.lang.StringBuilder sb = new java.lang.StringBuilder("get_open_txns_args(");
       boolean first = true;
 
       sb.append(")");
@@ -210996,15 +211822,15 @@ private void readObject(java.io.ObjectInputStream in) throws java.io.IOException
       }
     }
 
-    private static class get_master_keys_argsStandardSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
-      public get_master_keys_argsStandardScheme getScheme() {
-        return new get_master_keys_argsStandardScheme();
+    private static class get_open_txns_argsStandardSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
+      public get_open_txns_argsStandardScheme getScheme() {
+        return new get_open_txns_argsStandardScheme();
       }
     }
 
-    private static class get_master_keys_argsStandardScheme extends org.apache.thrift.scheme.StandardScheme<get_master_keys_args> {
+    private static class get_open_txns_argsStandardScheme extends org.apache.thrift.scheme.StandardScheme<get_open_txns_args> {
 
-      public void read(org.apache.thrift.protocol.TProtocol iprot, get_master_keys_args struct) throws org.apache.thrift.TException {
+      public void read(org.apache.thrift.protocol.TProtocol iprot, get_open_txns_args struct) throws org.apache.thrift.TException {
         org.apache.thrift.protocol.TField schemeField;
         iprot.readStructBegin();
         while (true)
@@ -211023,7 +211849,7 @@ public void read(org.apache.thrift.protocol.TProtocol iprot, get_master_keys_arg
         struct.validate();
       }
 
-      public void write(org.apache.thrift.protocol.TProtocol oprot, get_master_keys_args struct) throws org.apache.thrift.TException {
+      public void write(org.apache.thrift.protocol.TProtocol oprot, get_open_txns_args struct) throws org.apache.thrift.TException {
         struct.validate();
 
         oprot.writeStructBegin(STRUCT_DESC);
@@ -211033,21 +211859,21 @@ public void write(org.apache.thrift.protocol.TProtocol oprot, get_master_keys_ar
 
     }
 
-    private static class get_master_keys_argsTupleSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
-      public get_master_keys_argsTupleScheme getScheme() {
-        return new get_master_keys_argsTupleScheme();
+    private static class get_open_txns_argsTupleSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
+      public get_open_txns_argsTupleScheme getScheme() {
+        return new get_open_txns_argsTupleScheme();
       }
     }
 
-    private static class get_master_keys_argsTupleScheme extends org.apache.thrift.scheme.TupleScheme<get_master_keys_args> {
+    private static class get_open_txns_argsTupleScheme extends org.apache.thrift.scheme.TupleScheme<get_open_txns_args> {
 
       @Override
-      public void write(org.apache.thrift.protocol.TProtocol prot, get_master_keys_args struct) throws org.apache.thrift.TException {
+      public void write(org.apache.thrift.protocol.TProtocol prot, get_open_txns_args struct) throws org.apache.thrift.TException {
         org.apache.thrift.protocol.TTupleProtocol oprot = (org.apache.thrift.protocol.TTupleProtocol) prot;
       }
 
       @Override
-      public void read(org.apache.thrift.protocol.TProtocol prot, get_master_keys_args struct) throws org.apache.thrift.TException {
+      public void read(org.apache.thrift.protocol.TProtocol prot, get_open_txns_args struct) throws org.apache.thrift.TException {
         org.apache.thrift.protocol.TTupleProtocol iprot = (org.apache.thrift.protocol.TTupleProtocol) prot;
       }
     }
@@ -211057,15 +211883,15 @@ private static <S extends org.apache.thrift.scheme.IScheme> S scheme(org.apache.
     }
   }
 
-  @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_master_keys_result implements org.apache.thrift.TBase<get_master_keys_result, get_master_keys_result._Fields>, java.io.Serializable, Cloneable, Comparable<get_master_keys_result>   {
-    private static final org.apache.thrift.protocol.TStruct STRUCT_DESC = new org.apache.thrift.protocol.TStruct("get_master_keys_result");
+  @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_open_txns_result implements org.apache.thrift.TBase<get_open_txns_result, get_open_txns_result._Fields>, java.io.Serializable, Cloneable, Comparable<get_open_txns_result>   {
+    private static final org.apache.thrift.protocol.TStruct STRUCT_DESC = new org.apache.thrift.protocol.TStruct("get_open_txns_result");
 
-    private static final org.apache.thrift.protocol.TField SUCCESS_FIELD_DESC = new org.apache.thrift.protocol.TField("success", org.apache.thrift.protocol.TType.LIST, (short)0);
+    private static final org.apache.thrift.protocol.TField SUCCESS_FIELD_DESC = new org.apache.thrift.protocol.TField("success", org.apache.thrift.protocol.TType.STRUCT, (short)0);
 
-    private static final org.apache.thrift.scheme.SchemeFactory STANDARD_SCHEME_FACTORY = new get_master_keys_resultStandardSchemeFactory();
-    private static final org.apache.thrift.scheme.SchemeFactory TUPLE_SCHEME_FACTORY = new get_master_keys_resultTupleSchemeFactory();
+    private static final org.apache.thrift.scheme.SchemeFactory STANDARD_SCHEME_FACTORY = new get_open_txns_resultStandardSchemeFactory();
+    private static final org.apache.thrift.scheme.SchemeFactory TUPLE_SCHEME_FACTORY = new get_open_txns_resultTupleSchemeFactory();
 
-    private @org.apache.thrift.annotation.Nullable java.util.List<java.lang.String> success; // required
+    private @org.apache.thrift.annotation.Nullable GetOpenTxnsResponse success; // required
 
     /** The set of fields this struct contains, along with convenience methods for finding and manipulating them. */
     public enum _Fields implements org.apache.thrift.TFieldIdEnum {
@@ -211132,17 +211958,16 @@ public java.lang.String getFieldName() {
     static {
       java.util.Map<_Fields, org.apache.thrift.meta_data.FieldMetaData> tmpMap = new java.util.EnumMap<_Fields, org.apache.thrift.meta_data.FieldMetaData>(_Fields.class);
       tmpMap.put(_Fields.SUCCESS, new org.apache.thrift.meta_data.FieldMetaData("success", org.apache.thrift.TFieldRequirementType.DEFAULT, 
-          new org.apache.thrift.meta_data.ListMetaData(org.apache.thrift.protocol.TType.LIST, 
-              new org.apache.thrift.meta_data.FieldValueMetaData(org.apache.thrift.protocol.TType.STRING))));
+          new org.apache.thrift.meta_data.StructMetaData(org.apache.thrift.protocol.TType.STRUCT, GetOpenTxnsResponse.class)));
       metaDataMap = java.util.Collections.unmodifiableMap(tmpMap);
-      org.apache.thrift.meta_data.FieldMetaData.addStructMetaDataMap(get_master_keys_result.class, metaDataMap);
+      org.apache.thrift.meta_data.FieldMetaData.addStructMetaDataMap(get_open_txns_result.class, metaDataMap);
     }
 
-    public get_master_keys_result() {
+    public get_open_txns_result() {
     }
 
-    public get_master_keys_result(
-      java.util.List<java.lang.String> success)
+    public get_open_txns_result(
+      GetOpenTxnsResponse success)
     {
       this();
       this.success = success;
@@ -211151,15 +211976,14 @@ public get_master_keys_result(
     /**
      * Performs a deep copy on <i>other</i>.
      */
-    public get_master_keys_result(get_master_keys_result other) {
+    public get_open_txns_result(get_open_txns_result other) {
       if (other.isSetSuccess()) {
-        java.util.List<java.lang.String> __this__success = new java.util.ArrayList<java.lang.String>(other.success);
-        this.success = __this__success;
+        this.success = new GetOpenTxnsResponse(other.success);
       }
     }
 
-    public get_master_keys_result deepCopy() {
-      return new get_master_keys_result(this);
+    public get_open_txns_result deepCopy() {
+      return new get_open_txns_result(this);
     }
 
     @Override
@@ -211167,28 +211991,12 @@ public void clear() {
       this.success = null;
     }
 
-    public int getSuccessSize() {
-      return (this.success == null) ? 0 : this.success.size();
-    }
-
     @org.apache.thrift.annotation.Nullable
-    public java.util.Iterator<java.lang.String> getSuccessIterator() {
-      return (this.success == null) ? null : this.success.iterator();
-    }
-
-    public void addToSuccess(java.lang.String elem) {
-      if (this.success == null) {
-        this.success = new java.util.ArrayList<java.lang.String>();
-      }
-      this.success.add(elem);
-    }
-
-    @org.apache.thrift.annotation.Nullable
-    public java.util.List<java.lang.String> getSuccess() {
+    public GetOpenTxnsResponse getSuccess() {
       return this.success;
     }
 
-    public void setSuccess(@org.apache.thrift.annotation.Nullable java.util.List<java.lang.String> success) {
+    public void setSuccess(@org.apache.thrift.annotation.Nullable GetOpenTxnsResponse success) {
       this.success = success;
     }
 
@@ -211213,7 +212021,7 @@ public void setFieldValue(_Fields field, @org.apache.thrift.annotation.Nullable
         if (value == null) {
           unsetSuccess();
         } else {
-          setSuccess((java.util.List<java.lang.String>)value);
+          setSuccess((GetOpenTxnsResponse)value);
         }
         break;
 
@@ -211247,12 +212055,12 @@ public boolean isSet(_Fields field) {
     public boolean equals(java.lang.Object that) {
       if (that == null)
         return false;
-      if (that instanceof get_master_keys_result)
-        return this.equals((get_master_keys_result)that);
+      if (that instanceof get_open_txns_result)
+        return this.equals((get_open_txns_result)that);
       return false;
     }
 
-    public boolean equals(get_master_keys_result that) {
+    public boolean equals(get_open_txns_result that) {
       if (that == null)
         return false;
       if (this == that)
@@ -211282,7 +212090,7 @@ public int hashCode() {
     }
 
     @Override
-    public int compareTo(get_master_keys_result other) {
+    public int compareTo(get_open_txns_result other) {
       if (!getClass().equals(other.getClass())) {
         return getClass().getName().compareTo(other.getClass().getName());
       }
@@ -211317,7 +212125,7 @@ public void write(org.apache.thrift.protocol.TProtocol oprot) throws org.apache.
 
     @Override
     public java.lang.String toString() {
-      java.lang.StringBuilder sb = new java.lang.StringBuilder("get_master_keys_result(");
+      java.lang.StringBuilder sb = new java.lang.StringBuilder("get_open_txns_result(");
       boolean first = true;
 
       sb.append("success:");
@@ -211334,6 +212142,9 @@ public java.lang.String toString() {
     public void validate() throws org.apache.thrift.TException {
       // check for required fields
       // check for sub-struct validity
+      if (success != null) {
+        success.validate();
+      }
     }
 
     private void writeObject(java.io.ObjectOutputStream out) throws java.io.IOException {
@@ -211352,15 +212163,15 @@ private void readObject(java.io.ObjectInputStream in) throws java.io.IOException
       }
     }
 
-    private static class get_master_keys_resultStandardSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
-      public get_master_keys_resultStandardScheme getScheme() {
-        return new get_master_keys_resultStandardScheme();
+    private static class get_open_txns_resultStandardSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
+      public get_open_txns_resultStandardScheme getScheme() {
+        return new get_open_txns_resultStandardScheme();
       }
     }
 
-    private static class get_master_keys_resultStandardScheme extends org.apache.thrift.scheme.StandardScheme<get_master_keys_result> {
+    private static class get_open_txns_resultStandardScheme extends org.apache.thrift.scheme.StandardScheme<get_open_txns_result> {
 
-      public void read(org.apache.thrift.protocol.TProtocol iprot, get_master_keys_result struct) throws org.apache.thrift.TException {
+      public void read(org.apache.thrift.protocol.TProtocol iprot, get_open_txns_result struct) throws org.apache.thrift.TException {
         org.apache.thrift.protocol.TField schemeField;
         iprot.readStructBegin();
         while (true)
@@ -211371,18 +212182,9 @@ public void read(org.apache.thrift.protocol.TProtocol iprot, get_master_keys_res
           }
           switch (schemeField.id) {
             case 0: // SUCCESS
-              if (schemeField.type == org.apache.thrift.protocol.TType.LIST) {
-                {
-                  org.apache.thrift.protocol.TList _list1916 = iprot.readListBegin();
-                  struct.success = new java.util.ArrayList<java.lang.String>(_list1916.size);
-                  @org.apache.thrift.annotation.Nullable java.lang.String _elem1917;
-                  for (int _i1918 = 0; _i1918 < _list1916.size; ++_i1918)
-                  {
-                    _elem1917 = iprot.readString();
-                    struct.success.add(_elem1917);
-                  }
-                  iprot.readListEnd();
-                }
+              if (schemeField.type == org.apache.thrift.protocol.TType.STRUCT) {
+                struct.success = new GetOpenTxnsResponse();
+                struct.success.read(iprot);
                 struct.setSuccessIsSet(true);
               } else { 
                 org.apache.thrift.protocol.TProtocolUtil.skip(iprot, schemeField.type);
@@ -211397,20 +212199,13 @@ public void read(org.apache.thrift.protocol.TProtocol iprot, get_master_keys_res
         struct.validate();
       }
 
-      public void write(org.apache.thrift.protocol.TProtocol oprot, get_master_keys_result struct) throws org.apache.thrift.TException {
+      public void write(org.apache.thrift.protocol.TProtocol oprot, get_open_txns_result struct) throws org.apache.thrift.TException {
         struct.validate();
 
         oprot.writeStructBegin(STRUCT_DESC);
         if (struct.success != null) {
           oprot.writeFieldBegin(SUCCESS_FIELD_DESC);
-          {
-            oprot.writeListBegin(new org.apache.thrift.protocol.TList(org.apache.thrift.protocol.TType.STRING, struct.success.size()));
-            for (java.lang.String _iter1919 : struct.success)
-            {
-              oprot.writeString(_iter1919);
-            }
-            oprot.writeListEnd();
-          }
+          struct.success.write(oprot);
           oprot.writeFieldEnd();
         }
         oprot.writeFieldStop();
@@ -211419,16 +212214,16 @@ public void write(org.apache.thrift.protocol.TProtocol oprot, get_master_keys_re
 
     }
 
-    private static class get_master_keys_resultTupleSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
-      public get_master_keys_resultTupleScheme getScheme() {
-        return new get_master_keys_resultTupleScheme();
+    private static class get_open_txns_resultTupleSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
+      public get_open_txns_resultTupleScheme getScheme() {
+        return new get_open_txns_resultTupleScheme();
       }
     }
 
-    private static class get_master_keys_resultTupleScheme extends org.apache.thrift.scheme.TupleScheme<get_master_keys_result> {
+    private static class get_open_txns_resultTupleScheme extends org.apache.thrift.scheme.TupleScheme<get_open_txns_result> {
 
       @Override
-      public void write(org.apache.thrift.protocol.TProtocol prot, get_master_keys_result struct) throws org.apache.thrift.TException {
+      public void write(org.apache.thrift.protocol.TProtocol prot, get_open_txns_result struct) throws org.apache.thrift.TException {
         org.apache.thrift.protocol.TTupleProtocol oprot = (org.apache.thrift.protocol.TTupleProtocol) prot;
         java.util.BitSet optionals = new java.util.BitSet();
         if (struct.isSetSuccess()) {
@@ -211436,31 +212231,17 @@ public void write(org.apache.thrift.protocol.TProtocol prot, get_master_keys_res
         }
         oprot.writeBitSet(optionals, 1);
         if (struct.isSetSuccess()) {
-          {
-            oprot.writeI32(struct.success.size());
-            for (java.lang.String _iter1920 : struct.success)
-            {
-              oprot.writeString(_iter1920);
-            }
-          }
+          struct.success.write(oprot);
         }
       }
 
       @Override
-      public void read(org.apache.thrift.protocol.TProtocol prot, get_master_keys_result struct) throws org.apache.thrift.TException {
+      public void read(org.apache.thrift.protocol.TProtocol prot, get_open_txns_result struct) throws org.apache.thrift.TException {
         org.apache.thrift.protocol.TTupleProtocol iprot = (org.apache.thrift.protocol.TTupleProtocol) prot;
         java.util.BitSet incoming = iprot.readBitSet(1);
         if (incoming.get(0)) {
-          {
-            org.apache.thrift.protocol.TList _list1921 = new org.apache.thrift.protocol.TList(org.apache.thrift.protocol.TType.STRING, iprot.readI32());
-            struct.success = new java.util.ArrayList<java.lang.String>(_list1921.size);
-            @org.apache.thrift.annotation.Nullable java.lang.String _elem1922;
-            for (int _i1923 = 0; _i1923 < _list1921.size; ++_i1923)
-            {
-              _elem1922 = iprot.readString();
-              struct.success.add(_elem1922);
-            }
-          }
+          struct.success = new GetOpenTxnsResponse();
+          struct.success.read(iprot);
           struct.setSuccessIsSet(true);
         }
       }
@@ -211471,12 +212252,12 @@ private static <S extends org.apache.thrift.scheme.IScheme> S scheme(org.apache.
     }
   }
 
-  @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_open_txns_args implements org.apache.thrift.TBase<get_open_txns_args, get_open_txns_args._Fields>, java.io.Serializable, Cloneable, Comparable<get_open_txns_args>   {
-    private static final org.apache.thrift.protocol.TStruct STRUCT_DESC = new org.apache.thrift.protocol.TStruct("get_open_txns_args");
+  @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_open_txns_info_args implements org.apache.thrift.TBase<get_open_txns_info_args, get_open_txns_info_args._Fields>, java.io.Serializable, Cloneable, Comparable<get_open_txns_info_args>   {
+    private static final org.apache.thrift.protocol.TStruct STRUCT_DESC = new org.apache.thrift.protocol.TStruct("get_open_txns_info_args");
 
 
-    private static final org.apache.thrift.scheme.SchemeFactory STANDARD_SCHEME_FACTORY = new get_open_txns_argsStandardSchemeFactory();
-    private static final org.apache.thrift.scheme.SchemeFactory TUPLE_SCHEME_FACTORY = new get_open_txns_argsTupleSchemeFactory();
+    private static final org.apache.thrift.scheme.SchemeFactory STANDARD_SCHEME_FACTORY = new get_open_txns_info_argsStandardSchemeFactory();
+    private static final org.apache.thrift.scheme.SchemeFactory TUPLE_SCHEME_FACTORY = new get_open_txns_info_argsTupleSchemeFactory();
 
 
     /** The set of fields this struct contains, along with convenience methods for finding and manipulating them. */
@@ -211540,20 +212321,20 @@ public java.lang.String getFieldName() {
     static {
       java.util.Map<_Fields, org.apache.thrift.meta_data.FieldMetaData> tmpMap = new java.util.EnumMap<_Fields, org.apache.thrift.meta_data.FieldMetaData>(_Fields.class);
       metaDataMap = java.util.Collections.unmodifiableMap(tmpMap);
-      org.apache.thrift.meta_data.FieldMetaData.addStructMetaDataMap(get_open_txns_args.class, metaDataMap);
+      org.apache.thrift.meta_data.FieldMetaData.addStructMetaDataMap(get_open_txns_info_args.class, metaDataMap);
     }
 
-    public get_open_txns_args() {
+    public get_open_txns_info_args() {
     }
 
     /**
      * Performs a deep copy on <i>other</i>.
      */
-    public get_open_txns_args(get_open_txns_args other) {
+    public get_open_txns_info_args(get_open_txns_info_args other) {
     }
 
-    public get_open_txns_args deepCopy() {
-      return new get_open_txns_args(this);
+    public get_open_txns_info_args deepCopy() {
+      return new get_open_txns_info_args(this);
     }
 
     @Override
@@ -211587,12 +212368,12 @@ public boolean isSet(_Fields field) {
     public boolean equals(java.lang.Object that) {
       if (that == null)
         return false;
-      if (that instanceof get_open_txns_args)
-        return this.equals((get_open_txns_args)that);
+      if (that instanceof get_open_txns_info_args)
+        return this.equals((get_open_txns_info_args)that);
       return false;
     }
 
-    public boolean equals(get_open_txns_args that) {
+    public boolean equals(get_open_txns_info_args that) {
       if (that == null)
         return false;
       if (this == that)
@@ -211609,7 +212390,7 @@ public int hashCode() {
     }
 
     @Override
-    public int compareTo(get_open_txns_args other) {
+    public int compareTo(get_open_txns_info_args other) {
       if (!getClass().equals(other.getClass())) {
         return getClass().getName().compareTo(other.getClass().getName());
       }
@@ -211634,7 +212415,7 @@ public void write(org.apache.thrift.protocol.TProtocol oprot) throws org.apache.
 
     @Override
     public java.lang.String toString() {
-      java.lang.StringBuilder sb = new java.lang.StringBuilder("get_open_txns_args(");
+      java.lang.StringBuilder sb = new java.lang.StringBuilder("get_open_txns_info_args(");
       boolean first = true;
 
       sb.append(")");
@@ -211662,15 +212443,15 @@ private void readObject(java.io.ObjectInputStream in) throws java.io.IOException
       }
     }
 
-    private static class get_open_txns_argsStandardSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
-      public get_open_txns_argsStandardScheme getScheme() {
-        return new get_open_txns_argsStandardScheme();
+    private static class get_open_txns_info_argsStandardSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
+      public get_open_txns_info_argsStandardScheme getScheme() {
+        return new get_open_txns_info_argsStandardScheme();
       }
     }
 
-    private static class get_open_txns_argsStandardScheme extends org.apache.thrift.scheme.StandardScheme<get_open_txns_args> {
+    private static class get_open_txns_info_argsStandardScheme extends org.apache.thrift.scheme.StandardScheme<get_open_txns_info_args> {
 
-      public void read(org.apache.thrift.protocol.TProtocol iprot, get_open_txns_args struct) throws org.apache.thrift.TException {
+      public void read(org.apache.thrift.protocol.TProtocol iprot, get_open_txns_info_args struct) throws org.apache.thrift.TException {
         org.apache.thrift.protocol.TField schemeField;
         iprot.readStructBegin();
         while (true)
@@ -211689,7 +212470,7 @@ public void read(org.apache.thrift.protocol.TProtocol iprot, get_open_txns_args
         struct.validate();
       }
 
-      public void write(org.apache.thrift.protocol.TProtocol oprot, get_open_txns_args struct) throws org.apache.thrift.TException {
+      public void write(org.apache.thrift.protocol.TProtocol oprot, get_open_txns_info_args struct) throws org.apache.thrift.TException {
         struct.validate();
 
         oprot.writeStructBegin(STRUCT_DESC);
@@ -211699,21 +212480,21 @@ public void write(org.apache.thrift.protocol.TProtocol oprot, get_open_txns_args
 
     }
 
-    private static class get_open_txns_argsTupleSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
-      public get_open_txns_argsTupleScheme getScheme() {
-        return new get_open_txns_argsTupleScheme();
+    private static class get_open_txns_info_argsTupleSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
+      public get_open_txns_info_argsTupleScheme getScheme() {
+        return new get_open_txns_info_argsTupleScheme();
       }
     }
 
-    private static class get_open_txns_argsTupleScheme extends org.apache.thrift.scheme.TupleScheme<get_open_txns_args> {
+    private static class get_open_txns_info_argsTupleScheme extends org.apache.thrift.scheme.TupleScheme<get_open_txns_info_args> {
 
       @Override
-      public void write(org.apache.thrift.protocol.TProtocol prot, get_open_txns_args struct) throws org.apache.thrift.TException {
+      public void write(org.apache.thrift.protocol.TProtocol prot, get_open_txns_info_args struct) throws org.apache.thrift.TException {
         org.apache.thrift.protocol.TTupleProtocol oprot = (org.apache.thrift.protocol.TTupleProtocol) prot;
       }
 
       @Override
-      public void read(org.apache.thrift.protocol.TProtocol prot, get_open_txns_args struct) throws org.apache.thrift.TException {
+      public void read(org.apache.thrift.protocol.TProtocol prot, get_open_txns_info_args struct) throws org.apache.thrift.TException {
         org.apache.thrift.protocol.TTupleProtocol iprot = (org.apache.thrift.protocol.TTupleProtocol) prot;
       }
     }
@@ -211723,15 +212504,15 @@ private static <S extends org.apache.thrift.scheme.IScheme> S scheme(org.apache.
     }
   }
 
-  @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_open_txns_result implements org.apache.thrift.TBase<get_open_txns_result, get_open_txns_result._Fields>, java.io.Serializable, Cloneable, Comparable<get_open_txns_result>   {
-    private static final org.apache.thrift.protocol.TStruct STRUCT_DESC = new org.apache.thrift.protocol.TStruct("get_open_txns_result");
+  @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_open_txns_info_result implements org.apache.thrift.TBase<get_open_txns_info_result, get_open_txns_info_result._Fields>, java.io.Serializable, Cloneable, Comparable<get_open_txns_info_result>   {
+    private static final org.apache.thrift.protocol.TStruct STRUCT_DESC = new org.apache.thrift.protocol.TStruct("get_open_txns_info_result");
 
     private static final org.apache.thrift.protocol.TField SUCCESS_FIELD_DESC = new org.apache.thrift.protocol.TField("success", org.apache.thrift.protocol.TType.STRUCT, (short)0);
 
-    private static final org.apache.thrift.scheme.SchemeFactory STANDARD_SCHEME_FACTORY = new get_open_txns_resultStandardSchemeFactory();
-    private static final org.apache.thrift.scheme.SchemeFactory TUPLE_SCHEME_FACTORY = new get_open_txns_resultTupleSchemeFactory();
+    private static final org.apache.thrift.scheme.SchemeFactory STANDARD_SCHEME_FACTORY = new get_open_txns_info_resultStandardSchemeFactory();
+    private static final org.apache.thrift.scheme.SchemeFactory TUPLE_SCHEME_FACTORY = new get_open_txns_info_resultTupleSchemeFactory();
 
-    private @org.apache.thrift.annotation.Nullable GetOpenTxnsResponse success; // required
+    private @org.apache.thrift.annotation.Nullable GetOpenTxnsInfoResponse success; // required
 
     /** The set of fields this struct contains, along with convenience methods for finding and manipulating them. */
     public enum _Fields implements org.apache.thrift.TFieldIdEnum {
@@ -211798,16 +212579,16 @@ public java.lang.String getFieldName() {
     static {
       java.util.Map<_Fields, org.apache.thrift.meta_data.FieldMetaData> tmpMap = new java.util.EnumMap<_Fields, org.apache.thrift.meta_data.FieldMetaData>(_Fields.class);
       tmpMap.put(_Fields.SUCCESS, new org.apache.thrift.meta_data.FieldMetaData("success", org.apache.thrift.TFieldRequirementType.DEFAULT, 
-          new org.apache.thrift.meta_data.StructMetaData(org.apache.thrift.protocol.TType.STRUCT, GetOpenTxnsResponse.class)));
+          new org.apache.thrift.meta_data.StructMetaData(org.apache.thrift.protocol.TType.STRUCT, GetOpenTxnsInfoResponse.class)));
       metaDataMap = java.util.Collections.unmodifiableMap(tmpMap);
-      org.apache.thrift.meta_data.FieldMetaData.addStructMetaDataMap(get_open_txns_result.class, metaDataMap);
+      org.apache.thrift.meta_data.FieldMetaData.addStructMetaDataMap(get_open_txns_info_result.class, metaDataMap);
     }
 
-    public get_open_txns_result() {
+    public get_open_txns_info_result() {
     }
 
-    public get_open_txns_result(
-      GetOpenTxnsResponse success)
+    public get_open_txns_info_result(
+      GetOpenTxnsInfoResponse success)
     {
       this();
       this.success = success;
@@ -211816,14 +212597,14 @@ public get_open_txns_result(
     /**
      * Performs a deep copy on <i>other</i>.
      */
-    public get_open_txns_result(get_open_txns_result other) {
+    public get_open_txns_info_result(get_open_txns_info_result other) {
       if (other.isSetSuccess()) {
-        this.success = new GetOpenTxnsResponse(other.success);
+        this.success = new GetOpenTxnsInfoResponse(other.success);
       }
     }
 
-    public get_open_txns_result deepCopy() {
-      return new get_open_txns_result(this);
+    public get_open_txns_info_result deepCopy() {
+      return new get_open_txns_info_result(this);
     }
 
     @Override
@@ -211832,11 +212613,11 @@ public void clear() {
     }
 
     @org.apache.thrift.annotation.Nullable
-    public GetOpenTxnsResponse getSuccess() {
+    public GetOpenTxnsInfoResponse getSuccess() {
       return this.success;
     }
 
-    public void setSuccess(@org.apache.thrift.annotation.Nullable GetOpenTxnsResponse success) {
+    public void setSuccess(@org.apache.thrift.annotation.Nullable GetOpenTxnsInfoResponse success) {
       this.success = success;
     }
 
@@ -211861,7 +212642,7 @@ public void setFieldValue(_Fields field, @org.apache.thrift.annotation.Nullable
         if (value == null) {
           unsetSuccess();
         } else {
-          setSuccess((GetOpenTxnsResponse)value);
+          setSuccess((GetOpenTxnsInfoResponse)value);
         }
         break;
 
@@ -211895,12 +212676,12 @@ public boolean isSet(_Fields field) {
     public boolean equals(java.lang.Object that) {
       if (that == null)
         return false;
-      if (that instanceof get_open_txns_result)
-        return this.equals((get_open_txns_result)that);
+      if (that instanceof get_open_txns_info_result)
+        return this.equals((get_open_txns_info_result)that);
       return false;
     }
 
-    public boolean equals(get_open_txns_result that) {
+    public boolean equals(get_open_txns_info_result that) {
       if (that == null)
         return false;
       if (this == that)
@@ -211930,7 +212711,7 @@ public int hashCode() {
     }
 
     @Override
-    public int compareTo(get_open_txns_result other) {
+    public int compareTo(get_open_txns_info_result other) {
       if (!getClass().equals(other.getClass())) {
         return getClass().getName().compareTo(other.getClass().getName());
       }
@@ -211965,7 +212746,7 @@ public void write(org.apache.thrift.protocol.TProtocol oprot) throws org.apache.
 
     @Override
     public java.lang.String toString() {
-      java.lang.StringBuilder sb = new java.lang.StringBuilder("get_open_txns_result(");
+      java.lang.StringBuilder sb = new java.lang.StringBuilder("get_open_txns_info_result(");
       boolean first = true;
 
       sb.append("success:");
@@ -212003,15 +212784,15 @@ private void readObject(java.io.ObjectInputStream in) throws java.io.IOException
       }
     }
 
-    private static class get_open_txns_resultStandardSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
-      public get_open_txns_resultStandardScheme getScheme() {
-        return new get_open_txns_resultStandardScheme();
+    private static class get_open_txns_info_resultStandardSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
+      public get_open_txns_info_resultStandardScheme getScheme() {
+        return new get_open_txns_info_resultStandardScheme();
       }
     }
 
-    private static class get_open_txns_resultStandardScheme extends org.apache.thrift.scheme.StandardScheme<get_open_txns_result> {
+    private static class get_open_txns_info_resultStandardScheme extends org.apache.thrift.scheme.StandardScheme<get_open_txns_info_result> {
 
-      public void read(org.apache.thrift.protocol.TProtocol iprot, get_open_txns_result struct) throws org.apache.thrift.TException {
+      public void read(org.apache.thrift.protocol.TProtocol iprot, get_open_txns_info_result struct) throws org.apache.thrift.TException {
         org.apache.thrift.protocol.TField schemeField;
         iprot.readStructBegin();
         while (true)
@@ -212023,7 +212804,7 @@ public void read(org.apache.thrift.protocol.TProtocol iprot, get_open_txns_resul
           switch (schemeField.id) {
             case 0: // SUCCESS
               if (schemeField.type == org.apache.thrift.protocol.TType.STRUCT) {
-                struct.success = new GetOpenTxnsResponse();
+                struct.success = new GetOpenTxnsInfoResponse();
                 struct.success.read(iprot);
                 struct.setSuccessIsSet(true);
               } else { 
@@ -212039,7 +212820,7 @@ public void read(org.apache.thrift.protocol.TProtocol iprot, get_open_txns_resul
         struct.validate();
       }
 
-      public void write(org.apache.thrift.protocol.TProtocol oprot, get_open_txns_result struct) throws org.apache.thrift.TException {
+      public void write(org.apache.thrift.protocol.TProtocol oprot, get_open_txns_info_result struct) throws org.apache.thrift.TException {
         struct.validate();
 
         oprot.writeStructBegin(STRUCT_DESC);
@@ -212054,16 +212835,16 @@ public void write(org.apache.thrift.protocol.TProtocol oprot, get_open_txns_resu
 
     }
 
-    private static class get_open_txns_resultTupleSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
-      public get_open_txns_resultTupleScheme getScheme() {
-        return new get_open_txns_resultTupleScheme();
+    private static class get_open_txns_info_resultTupleSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
+      public get_open_txns_info_resultTupleScheme getScheme() {
+        return new get_open_txns_info_resultTupleScheme();
       }
     }
 
-    private static class get_open_txns_resultTupleScheme extends org.apache.thrift.scheme.TupleScheme<get_open_txns_result> {
+    private static class get_open_txns_info_resultTupleScheme extends org.apache.thrift.scheme.TupleScheme<get_open_txns_info_result> {
 
       @Override
-      public void write(org.apache.thrift.protocol.TProtocol prot, get_open_txns_result struct) throws org.apache.thrift.TException {
+      public void write(org.apache.thrift.protocol.TProtocol prot, get_open_txns_info_result struct) throws org.apache.thrift.TException {
         org.apache.thrift.protocol.TTupleProtocol oprot = (org.apache.thrift.protocol.TTupleProtocol) prot;
         java.util.BitSet optionals = new java.util.BitSet();
         if (struct.isSetSuccess()) {
@@ -212076,11 +212857,11 @@ public void write(org.apache.thrift.protocol.TProtocol prot, get_open_txns_resul
       }
 
       @Override
-      public void read(org.apache.thrift.protocol.TProtocol prot, get_open_txns_result struct) throws org.apache.thrift.TException {
+      public void read(org.apache.thrift.protocol.TProtocol prot, get_open_txns_info_result struct) throws org.apache.thrift.TException {
         org.apache.thrift.protocol.TTupleProtocol iprot = (org.apache.thrift.protocol.TTupleProtocol) prot;
         java.util.BitSet incoming = iprot.readBitSet(1);
         if (incoming.get(0)) {
-          struct.success = new GetOpenTxnsResponse();
+          struct.success = new GetOpenTxnsInfoResponse();
           struct.success.read(iprot);
           struct.setSuccessIsSet(true);
         }
@@ -212092,17 +212873,19 @@ private static <S extends org.apache.thrift.scheme.IScheme> S scheme(org.apache.
     }
   }
 
-  @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_open_txns_info_args implements org.apache.thrift.TBase<get_open_txns_info_args, get_open_txns_info_args._Fields>, java.io.Serializable, Cloneable, Comparable<get_open_txns_info_args>   {
-    private static final org.apache.thrift.protocol.TStruct STRUCT_DESC = new org.apache.thrift.protocol.TStruct("get_open_txns_info_args");
+  @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class open_txns_args implements org.apache.thrift.TBase<open_txns_args, open_txns_args._Fields>, java.io.Serializable, Cloneable, Comparable<open_txns_args>   {
+    private static final org.apache.thrift.protocol.TStruct STRUCT_DESC = new org.apache.thrift.protocol.TStruct("open_txns_args");
 
+    private static final org.apache.thrift.protocol.TField RQST_FIELD_DESC = new org.apache.thrift.protocol.TField("rqst", org.apache.thrift.protocol.TType.STRUCT, (short)1);
 
-    private static final org.apache.thrift.scheme.SchemeFactory STANDARD_SCHEME_FACTORY = new get_open_txns_info_argsStandardSchemeFactory();
-    private static final org.apache.thrift.scheme.SchemeFactory TUPLE_SCHEME_FACTORY = new get_open_txns_info_argsTupleSchemeFactory();
+    private static final org.apache.thrift.scheme.SchemeFactory STANDARD_SCHEME_FACTORY = new open_txns_argsStandardSchemeFactory();
+    private static final org.apache.thrift.scheme.SchemeFactory TUPLE_SCHEME_FACTORY = new open_txns_argsTupleSchemeFactory();
 
+    private @org.apache.thrift.annotation.Nullable OpenTxnRequest rqst; // required
 
     /** The set of fields this struct contains, along with convenience methods for finding and manipulating them. */
     public enum _Fields implements org.apache.thrift.TFieldIdEnum {
-;
+      RQST((short)1, "rqst");
 
       private static final java.util.Map<java.lang.String, _Fields> byName = new java.util.HashMap<java.lang.String, _Fields>();
 
@@ -212118,6 +212901,8 @@ public enum _Fields implements org.apache.thrift.TFieldIdEnum {
       @org.apache.thrift.annotation.Nullable
       public static _Fields findByThriftId(int fieldId) {
         switch(fieldId) {
+          case 1: // RQST
+            return RQST;
           default:
             return null;
         }
@@ -212157,38 +212942,88 @@ public java.lang.String getFieldName() {
         return _fieldName;
       }
     }
+
+    // isset id assignments
     public static final java.util.Map<_Fields, org.apache.thrift.meta_data.FieldMetaData> metaDataMap;
     static {
       java.util.Map<_Fields, org.apache.thrift.meta_data.FieldMetaData> tmpMap = new java.util.EnumMap<_Fields, org.apache.thrift.meta_data.FieldMetaData>(_Fields.class);
+      tmpMap.put(_Fields.RQST, new org.apache.thrift.meta_data.FieldMetaData("rqst", org.apache.thrift.TFieldRequirementType.DEFAULT, 
+          new org.apache.thrift.meta_data.StructMetaData(org.apache.thrift.protocol.TType.STRUCT, OpenTxnRequest.class)));
       metaDataMap = java.util.Collections.unmodifiableMap(tmpMap);
-      org.apache.thrift.meta_data.FieldMetaData.addStructMetaDataMap(get_open_txns_info_args.class, metaDataMap);
+      org.apache.thrift.meta_data.FieldMetaData.addStructMetaDataMap(open_txns_args.class, metaDataMap);
     }
 
-    public get_open_txns_info_args() {
+    public open_txns_args() {
+    }
+
+    public open_txns_args(
+      OpenTxnRequest rqst)
+    {
+      this();
+      this.rqst = rqst;
     }
 
     /**
      * Performs a deep copy on <i>other</i>.
      */
-    public get_open_txns_info_args(get_open_txns_info_args other) {
+    public open_txns_args(open_txns_args other) {
+      if (other.isSetRqst()) {
+        this.rqst = new OpenTxnRequest(other.rqst);
+      }
     }
 
-    public get_open_txns_info_args deepCopy() {
-      return new get_open_txns_info_args(this);
+    public open_txns_args deepCopy() {
+      return new open_txns_args(this);
     }
 
     @Override
     public void clear() {
+      this.rqst = null;
+    }
+
+    @org.apache.thrift.annotation.Nullable
+    public OpenTxnRequest getRqst() {
+      return this.rqst;
+    }
+
+    public void setRqst(@org.apache.thrift.annotation.Nullable OpenTxnRequest rqst) {
+      this.rqst = rqst;
+    }
+
+    public void unsetRqst() {
+      this.rqst = null;
+    }
+
+    /** Returns true if field rqst is set (has been assigned a value) and false otherwise */
+    public boolean isSetRqst() {
+      return this.rqst != null;
+    }
+
+    public void setRqstIsSet(boolean value) {
+      if (!value) {
+        this.rqst = null;
+      }
     }
 
     public void setFieldValue(_Fields field, @org.apache.thrift.annotation.Nullable java.lang.Object value) {
       switch (field) {
+      case RQST:
+        if (value == null) {
+          unsetRqst();
+        } else {
+          setRqst((OpenTxnRequest)value);
+        }
+        break;
+
       }
     }
 
     @org.apache.thrift.annotation.Nullable
     public java.lang.Object getFieldValue(_Fields field) {
       switch (field) {
+      case RQST:
+        return getRqst();
+
       }
       throw new java.lang.IllegalStateException();
     }
@@ -212200,6 +213035,8 @@ public boolean isSet(_Fields field) {
       }
 
       switch (field) {
+      case RQST:
+        return isSetRqst();
       }
       throw new java.lang.IllegalStateException();
     }
@@ -212208,17 +213045,26 @@ public boolean isSet(_Fields field) {
     public boolean equals(java.lang.Object that) {
       if (that == null)
         return false;
-      if (that instanceof get_open_txns_info_args)
-        return this.equals((get_open_txns_info_args)that);
+      if (that instanceof open_txns_args)
+        return this.equals((open_txns_args)that);
       return false;
     }
 
-    public boolean equals(get_open_txns_info_args that) {
+    public boolean equals(open_txns_args that) {
       if (that == null)
         return false;
       if (this == that)
         return true;
 
+      boolean this_present_rqst = true && this.isSetRqst();
+      boolean that_present_rqst = true && that.isSetRqst();
+      if (this_present_rqst || that_present_rqst) {
+        if (!(this_present_rqst && that_present_rqst))
+          return false;
+        if (!this.rqst.equals(that.rqst))
+          return false;
+      }
+
       return true;
     }
 
@@ -212226,17 +213072,31 @@ public boolean equals(get_open_txns_info_args that) {
     public int hashCode() {
       int hashCode = 1;
 
+      hashCode = hashCode * 8191 + ((isSetRqst()) ? 131071 : 524287);
+      if (isSetRqst())
+        hashCode = hashCode * 8191 + rqst.hashCode();
+
       return hashCode;
     }
 
     @Override
-    public int compareTo(get_open_txns_info_args other) {
+    public int compareTo(open_txns_args other) {
       if (!getClass().equals(other.getClass())) {
         return getClass().getName().compareTo(other.getClass().getName());
       }
 
       int lastComparison = 0;
 
+      lastComparison = java.lang.Boolean.valueOf(isSetRqst()).compareTo(other.isSetRqst());
+      if (lastComparison != 0) {
+        return lastComparison;
+      }
+      if (isSetRqst()) {
+        lastComparison = org.apache.thrift.TBaseHelper.compareTo(this.rqst, other.rqst);
+        if (lastComparison != 0) {
+          return lastComparison;
+        }
+      }
       return 0;
     }
 
@@ -212255,9 +213115,16 @@ public void write(org.apache.thrift.protocol.TProtocol oprot) throws org.apache.
 
     @Override
     public java.lang.String toString() {
-      java.lang.StringBuilder sb = new java.lang.StringBuilder("get_open_txns_info_args(");
+      java.lang.StringBuilder sb = new java.lang.StringBuilder("open_txns_args(");
       boolean first = true;
 
+      sb.append("rqst:");
+      if (this.rqst == null) {
+        sb.append("null");
+      } else {
+        sb.append(this.rqst);
+      }
+      first = false;
       sb.append(")");
       return sb.toString();
     }
@@ -212265,6 +213132,9 @@ public java.lang.String toString() {
     public void validate() throws org.apache.thrift.TException {
       // check for required fields
       // check for sub-struct validity
+      if (rqst != null) {
+        rqst.validate();
+      }
     }
 
     private void writeObject(java.io.ObjectOutputStream out) throws java.io.IOException {
@@ -212283,15 +213153,15 @@ private void readObject(java.io.ObjectInputStream in) throws java.io.IOException
       }
     }
 
-    private static class get_open_txns_info_argsStandardSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
-      public get_open_txns_info_argsStandardScheme getScheme() {
-        return new get_open_txns_info_argsStandardScheme();
+    private static class open_txns_argsStandardSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
+      public open_txns_argsStandardScheme getScheme() {
+        return new open_txns_argsStandardScheme();
       }
     }
 
-    private static class get_open_txns_info_argsStandardScheme extends org.apache.thrift.scheme.StandardScheme<get_open_txns_info_args> {
+    private static class open_txns_argsStandardScheme extends org.apache.thrift.scheme.StandardScheme<open_txns_args> {
 
-      public void read(org.apache.thrift.protocol.TProtocol iprot, get_open_txns_info_args struct) throws org.apache.thrift.TException {
+      public void read(org.apache.thrift.protocol.TProtocol iprot, open_txns_args struct) throws org.apache.thrift.TException {
         org.apache.thrift.protocol.TField schemeField;
         iprot.readStructBegin();
         while (true)
@@ -212301,6 +213171,15 @@ public void read(org.apache.thrift.protocol.TProtocol iprot, get_open_txns_info_
             break;
           }
           switch (schemeField.id) {
+            case 1: // RQST
+              if (schemeField.type == org.apache.thrift.protocol.TType.STRUCT) {
+                struct.rqst = new OpenTxnRequest();
+                struct.rqst.read(iprot);
+                struct.setRqstIsSet(true);
+              } else { 
+                org.apache.thrift.protocol.TProtocolUtil.skip(iprot, schemeField.type);
+              }
+              break;
             default:
               org.apache.thrift.protocol.TProtocolUtil.skip(iprot, schemeField.type);
           }
@@ -212310,32 +213189,51 @@ public void read(org.apache.thrift.protocol.TProtocol iprot, get_open_txns_info_
         struct.validate();
       }
 
-      public void write(org.apache.thrift.protocol.TProtocol oprot, get_open_txns_info_args struct) throws org.apache.thrift.TException {
+      public void write(org.apache.thrift.protocol.TProtocol oprot, open_txns_args struct) throws org.apache.thrift.TException {
         struct.validate();
 
         oprot.writeStructBegin(STRUCT_DESC);
+        if (struct.rqst != null) {
+          oprot.writeFieldBegin(RQST_FIELD_DESC);
+          struct.rqst.write(oprot);
+          oprot.writeFieldEnd();
+        }
         oprot.writeFieldStop();
         oprot.writeStructEnd();
       }
 
     }
 
-    private static class get_open_txns_info_argsTupleSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
-      public get_open_txns_info_argsTupleScheme getScheme() {
-        return new get_open_txns_info_argsTupleScheme();
+    private static class open_txns_argsTupleSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
+      public open_txns_argsTupleScheme getScheme() {
+        return new open_txns_argsTupleScheme();
       }
     }
 
-    private static class get_open_txns_info_argsTupleScheme extends org.apache.thrift.scheme.TupleScheme<get_open_txns_info_args> {
+    private static class open_txns_argsTupleScheme extends org.apache.thrift.scheme.TupleScheme<open_txns_args> {
 
       @Override
-      public void write(org.apache.thrift.protocol.TProtocol prot, get_open_txns_info_args struct) throws org.apache.thrift.TException {
+      public void write(org.apache.thrift.protocol.TProtocol prot, open_txns_args struct) throws org.apache.thrift.TException {
         org.apache.thrift.protocol.TTupleProtocol oprot = (org.apache.thrift.protocol.TTupleProtocol) prot;
+        java.util.BitSet optionals = new java.util.BitSet();
+        if (struct.isSetRqst()) {
+          optionals.set(0);
+        }
+        oprot.writeBitSet(optionals, 1);
+        if (struct.isSetRqst()) {
+          struct.rqst.write(oprot);
+        }
       }
 
       @Override
-      public void read(org.apache.thrift.protocol.TProtocol prot, get_open_txns_info_args struct) throws org.apache.thrift.TException {
+      public void read(org.apache.thrift.protocol.TProtocol prot, open_txns_args struct) throws org.apache.thrift.TException {
         org.apache.thrift.protocol.TTupleProtocol iprot = (org.apache.thrift.protocol.TTupleProtocol) prot;
+        java.util.BitSet incoming = iprot.readBitSet(1);
+        if (incoming.get(0)) {
+          struct.rqst = new OpenTxnRequest();
+          struct.rqst.read(iprot);
+          struct.setRqstIsSet(true);
+        }
       }
     }
 
@@ -212344,15 +213242,15 @@ private static <S extends org.apache.thrift.scheme.IScheme> S scheme(org.apache.
     }
   }
 
-  @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_open_txns_info_result implements org.apache.thrift.TBase<get_open_txns_info_result, get_open_txns_info_result._Fields>, java.io.Serializable, Cloneable, Comparable<get_open_txns_info_result>   {
-    private static final org.apache.thrift.protocol.TStruct STRUCT_DESC = new org.apache.thrift.protocol.TStruct("get_open_txns_info_result");
+  @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class open_txns_result implements org.apache.thrift.TBase<open_txns_result, open_txns_result._Fields>, java.io.Serializable, Cloneable, Comparable<open_txns_result>   {
+    private static final org.apache.thrift.protocol.TStruct STRUCT_DESC = new org.apache.thrift.protocol.TStruct("open_txns_result");
 
     private static final org.apache.thrift.protocol.TField SUCCESS_FIELD_DESC = new org.apache.thrift.protocol.TField("success", org.apache.thrift.protocol.TType.STRUCT, (short)0);
 
-    private static final org.apache.thrift.scheme.SchemeFactory STANDARD_SCHEME_FACTORY = new get_open_txns_info_resultStandardSchemeFactory();
-    private static final org.apache.thrift.scheme.SchemeFactory TUPLE_SCHEME_FACTORY = new get_open_txns_info_resultTupleSchemeFactory();
+    private static final org.apache.thrift.scheme.SchemeFactory STANDARD_SCHEME_FACTORY = new open_txns_resultStandardSchemeFactory();
+    private static final org.apache.thrift.scheme.SchemeFactory TUPLE_SCHEME_FACTORY = new open_txns_resultTupleSchemeFactory();
 
-    private @org.apache.thrift.annotation.Nullable GetOpenTxnsInfoResponse success; // required
+    private @org.apache.thrift.annotation.Nullable OpenTxnsResponse success; // required
 
     /** The set of fields this struct contains, along with convenience methods for finding and manipulating them. */
     public enum _Fields implements org.apache.thrift.TFieldIdEnum {
@@ -212419,16 +213317,16 @@ public java.lang.String getFieldName() {
     static {
       java.util.Map<_Fields, org.apache.thrift.meta_data.FieldMetaData> tmpMap = new java.util.EnumMap<_Fields, org.apache.thrift.meta_data.FieldMetaData>(_Fields.class);
       tmpMap.put(_Fields.SUCCESS, new org.apache.thrift.meta_data.FieldMetaData("success", org.apache.thrift.TFieldRequirementType.DEFAULT, 
-          new org.apache.thrift.meta_data.StructMetaData(org.apache.thrift.protocol.TType.STRUCT, GetOpenTxnsInfoResponse.class)));
+          new org.apache.thrift.meta_data.StructMetaData(org.apache.thrift.protocol.TType.STRUCT, OpenTxnsResponse.class)));
       metaDataMap = java.util.Collections.unmodifiableMap(tmpMap);
-      org.apache.thrift.meta_data.FieldMetaData.addStructMetaDataMap(get_open_txns_info_result.class, metaDataMap);
+      org.apache.thrift.meta_data.FieldMetaData.addStructMetaDataMap(open_txns_result.class, metaDataMap);
     }
 
-    public get_open_txns_info_result() {
+    public open_txns_result() {
     }
 
-    public get_open_txns_info_result(
-      GetOpenTxnsInfoResponse success)
+    public open_txns_result(
+      OpenTxnsResponse success)
     {
       this();
       this.success = success;
@@ -212437,14 +213335,14 @@ public get_open_txns_info_result(
     /**
      * Performs a deep copy on <i>other</i>.
      */
-    public get_open_txns_info_result(get_open_txns_info_result other) {
+    public open_txns_result(open_txns_result other) {
       if (other.isSetSuccess()) {
-        this.success = new GetOpenTxnsInfoResponse(other.success);
+        this.success = new OpenTxnsResponse(other.success);
       }
     }
 
-    public get_open_txns_info_result deepCopy() {
-      return new get_open_txns_info_result(this);
+    public open_txns_result deepCopy() {
+      return new open_txns_result(this);
     }
 
     @Override
@@ -212453,11 +213351,11 @@ public void clear() {
     }
 
     @org.apache.thrift.annotation.Nullable
-    public GetOpenTxnsInfoResponse getSuccess() {
+    public OpenTxnsResponse getSuccess() {
       return this.success;
     }
 
-    public void setSuccess(@org.apache.thrift.annotation.Nullable GetOpenTxnsInfoResponse success) {
+    public void setSuccess(@org.apache.thrift.annotation.Nullable OpenTxnsResponse success) {
       this.success = success;
     }
 
@@ -212482,7 +213380,7 @@ public void setFieldValue(_Fields field, @org.apache.thrift.annotation.Nullable
         if (value == null) {
           unsetSuccess();
         } else {
-          setSuccess((GetOpenTxnsInfoResponse)value);
+          setSuccess((OpenTxnsResponse)value);
         }
         break;
 
@@ -212516,12 +213414,12 @@ public boolean isSet(_Fields field) {
     public boolean equals(java.lang.Object that) {
       if (that == null)
         return false;
-      if (that instanceof get_open_txns_info_result)
-        return this.equals((get_open_txns_info_result)that);
+      if (that instanceof open_txns_result)
+        return this.equals((open_txns_result)that);
       return false;
     }
 
-    public boolean equals(get_open_txns_info_result that) {
+    public boolean equals(open_txns_result that) {
       if (that == null)
         return false;
       if (this == that)
@@ -212551,7 +213449,7 @@ public int hashCode() {
     }
 
     @Override
-    public int compareTo(get_open_txns_info_result other) {
+    public int compareTo(open_txns_result other) {
       if (!getClass().equals(other.getClass())) {
         return getClass().getName().compareTo(other.getClass().getName());
       }
@@ -212586,7 +213484,7 @@ public void write(org.apache.thrift.protocol.TProtocol oprot) throws org.apache.
 
     @Override
     public java.lang.String toString() {
-      java.lang.StringBuilder sb = new java.lang.StringBuilder("get_open_txns_info_result(");
+      java.lang.StringBuilder sb = new java.lang.StringBuilder("open_txns_result(");
       boolean first = true;
 
       sb.append("success:");
@@ -212624,15 +213522,15 @@ private void readObject(java.io.ObjectInputStream in) throws java.io.IOException
       }
     }
 
-    private static class get_open_txns_info_resultStandardSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
-      public get_open_txns_info_resultStandardScheme getScheme() {
-        return new get_open_txns_info_resultStandardScheme();
+    private static class open_txns_resultStandardSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
+      public open_txns_resultStandardScheme getScheme() {
+        return new open_txns_resultStandardScheme();
       }
     }
 
-    private static class get_open_txns_info_resultStandardScheme extends org.apache.thrift.scheme.StandardScheme<get_open_txns_info_result> {
+    private static class open_txns_resultStandardScheme extends org.apache.thrift.scheme.StandardScheme<open_txns_result> {
 
-      public void read(org.apache.thrift.protocol.TProtocol iprot, get_open_txns_info_result struct) throws org.apache.thrift.TException {
+      public void read(org.apache.thrift.protocol.TProtocol iprot, open_txns_result struct) throws org.apache.thrift.TException {
         org.apache.thrift.protocol.TField schemeField;
         iprot.readStructBegin();
         while (true)
@@ -212644,7 +213542,7 @@ public void read(org.apache.thrift.protocol.TProtocol iprot, get_open_txns_info_
           switch (schemeField.id) {
             case 0: // SUCCESS
               if (schemeField.type == org.apache.thrift.protocol.TType.STRUCT) {
-                struct.success = new GetOpenTxnsInfoResponse();
+                struct.success = new OpenTxnsResponse();
                 struct.success.read(iprot);
                 struct.setSuccessIsSet(true);
               } else { 
@@ -212660,7 +213558,7 @@ public void read(org.apache.thrift.protocol.TProtocol iprot, get_open_txns_info_
         struct.validate();
       }
 
-      public void write(org.apache.thrift.protocol.TProtocol oprot, get_open_txns_info_result struct) throws org.apache.thrift.TException {
+      public void write(org.apache.thrift.protocol.TProtocol oprot, open_txns_result struct) throws org.apache.thrift.TException {
         struct.validate();
 
         oprot.writeStructBegin(STRUCT_DESC);
@@ -212675,16 +213573,16 @@ public void write(org.apache.thrift.protocol.TProtocol oprot, get_open_txns_info
 
     }
 
-    private static class get_open_txns_info_resultTupleSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
-      public get_open_txns_info_resultTupleScheme getScheme() {
-        return new get_open_txns_info_resultTupleScheme();
+    private static class open_txns_resultTupleSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
+      public open_txns_resultTupleScheme getScheme() {
+        return new open_txns_resultTupleScheme();
       }
     }
 
-    private static class get_open_txns_info_resultTupleScheme extends org.apache.thrift.scheme.TupleScheme<get_open_txns_info_result> {
+    private static class open_txns_resultTupleScheme extends org.apache.thrift.scheme.TupleScheme<open_txns_result> {
 
       @Override
-      public void write(org.apache.thrift.protocol.TProtocol prot, get_open_txns_info_result struct) throws org.apache.thrift.TException {
+      public void write(org.apache.thrift.protocol.TProtocol prot, open_txns_result struct) throws org.apache.thrift.TException {
         org.apache.thrift.protocol.TTupleProtocol oprot = (org.apache.thrift.protocol.TTupleProtocol) prot;
         java.util.BitSet optionals = new java.util.BitSet();
         if (struct.isSetSuccess()) {
@@ -212697,11 +213595,11 @@ public void write(org.apache.thrift.protocol.TProtocol prot, get_open_txns_info_
       }
 
       @Override
-      public void read(org.apache.thrift.protocol.TProtocol prot, get_open_txns_info_result struct) throws org.apache.thrift.TException {
+      public void read(org.apache.thrift.protocol.TProtocol prot, open_txns_result struct) throws org.apache.thrift.TException {
         org.apache.thrift.protocol.TTupleProtocol iprot = (org.apache.thrift.protocol.TTupleProtocol) prot;
         java.util.BitSet incoming = iprot.readBitSet(1);
         if (incoming.get(0)) {
-          struct.success = new GetOpenTxnsInfoResponse();
+          struct.success = new OpenTxnsResponse();
           struct.success.read(iprot);
           struct.setSuccessIsSet(true);
         }
@@ -212713,15 +213611,15 @@ private static <S extends org.apache.thrift.scheme.IScheme> S scheme(org.apache.
     }
   }
 
-  @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class open_txns_args implements org.apache.thrift.TBase<open_txns_args, open_txns_args._Fields>, java.io.Serializable, Cloneable, Comparable<open_txns_args>   {
-    private static final org.apache.thrift.protocol.TStruct STRUCT_DESC = new org.apache.thrift.protocol.TStruct("open_txns_args");
+  @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class abort_txn_args implements org.apache.thrift.TBase<abort_txn_args, abort_txn_args._Fields>, java.io.Serializable, Cloneable, Comparable<abort_txn_args>   {
+    private static final org.apache.thrift.protocol.TStruct STRUCT_DESC = new org.apache.thrift.protocol.TStruct("abort_txn_args");
 
     private static final org.apache.thrift.protocol.TField RQST_FIELD_DESC = new org.apache.thrift.protocol.TField("rqst", org.apache.thrift.protocol.TType.STRUCT, (short)1);
 
-    private static final org.apache.thrift.scheme.SchemeFactory STANDARD_SCHEME_FACTORY = new open_txns_argsStandardSchemeFactory();
-    private static final org.apache.thrift.scheme.SchemeFactory TUPLE_SCHEME_FACTORY = new open_txns_argsTupleSchemeFactory();
+    private static final org.apache.thrift.scheme.SchemeFactory STANDARD_SCHEME_FACTORY = new abort_txn_argsStandardSchemeFactory();
+    private static final org.apache.thrift.scheme.SchemeFactory TUPLE_SCHEME_FACTORY = new abort_txn_argsTupleSchemeFactory();
 
-    private @org.apache.thrift.annotation.Nullable OpenTxnRequest rqst; // required
+    private @org.apache.thrift.annotation.Nullable AbortTxnRequest rqst; // required
 
     /** The set of fields this struct contains, along with convenience methods for finding and manipulating them. */
     public enum _Fields implements org.apache.thrift.TFieldIdEnum {
@@ -212788,16 +213686,16 @@ public java.lang.String getFieldName() {
     static {
       java.util.Map<_Fields, org.apache.thrift.meta_data.FieldMetaData> tmpMap = new java.util.EnumMap<_Fields, org.apache.thrift.meta_data.FieldMetaData>(_Fields.class);
       tmpMap.put(_Fields.RQST, new org.apache.thrift.meta_data.FieldMetaData("rqst", org.apache.thrift.TFieldRequirementType.DEFAULT, 
-          new org.apache.thrift.meta_data.StructMetaData(org.apache.thrift.protocol.TType.STRUCT, OpenTxnRequest.class)));
+          new org.apache.thrift.meta_data.StructMetaData(org.apache.thrift.protocol.TType.STRUCT, AbortTxnRequest.class)));
       metaDataMap = java.util.Collections.unmodifiableMap(tmpMap);
-      org.apache.thrift.meta_data.FieldMetaData.addStructMetaDataMap(open_txns_args.class, metaDataMap);
+      org.apache.thrift.meta_data.FieldMetaData.addStructMetaDataMap(abort_txn_args.class, metaDataMap);
     }
 
-    public open_txns_args() {
+    public abort_txn_args() {
     }
 
-    public open_txns_args(
-      OpenTxnRequest rqst)
+    public abort_txn_args(
+      AbortTxnRequest rqst)
     {
       this();
       this.rqst = rqst;
@@ -212806,14 +213704,14 @@ public open_txns_args(
     /**
      * Performs a deep copy on <i>other</i>.
      */
-    public open_txns_args(open_txns_args other) {
+    public abort_txn_args(abort_txn_args other) {
       if (other.isSetRqst()) {
-        this.rqst = new OpenTxnRequest(other.rqst);
+        this.rqst = new AbortTxnRequest(other.rqst);
       }
     }
 
-    public open_txns_args deepCopy() {
-      return new open_txns_args(this);
+    public abort_txn_args deepCopy() {
+      return new abort_txn_args(this);
     }
 
     @Override
@@ -212822,11 +213720,11 @@ public void clear() {
     }
 
     @org.apache.thrift.annotation.Nullable
-    public OpenTxnRequest getRqst() {
+    public AbortTxnRequest getRqst() {
       return this.rqst;
     }
 
-    public void setRqst(@org.apache.thrift.annotation.Nullable OpenTxnRequest rqst) {
+    public void setRqst(@org.apache.thrift.annotation.Nullable AbortTxnRequest rqst) {
       this.rqst = rqst;
     }
 
@@ -212851,7 +213749,7 @@ public void setFieldValue(_Fields field, @org.apache.thrift.annotation.Nullable
         if (value == null) {
           unsetRqst();
         } else {
-          setRqst((OpenTxnRequest)value);
+          setRqst((AbortTxnRequest)value);
         }
         break;
 
@@ -212885,12 +213783,12 @@ public boolean isSet(_Fields field) {
     public boolean equals(java.lang.Object that) {
       if (that == null)
         return false;
-      if (that instanceof open_txns_args)
-        return this.equals((open_txns_args)that);
+      if (that instanceof abort_txn_args)
+        return this.equals((abort_txn_args)that);
       return false;
     }
 
-    public boolean equals(open_txns_args that) {
+    public boolean equals(abort_txn_args that) {
       if (that == null)
         return false;
       if (this == that)
@@ -212920,7 +213818,7 @@ public int hashCode() {
     }
 
     @Override
-    public int compareTo(open_txns_args other) {
+    public int compareTo(abort_txn_args other) {
       if (!getClass().equals(other.getClass())) {
         return getClass().getName().compareTo(other.getClass().getName());
       }
@@ -212955,7 +213853,7 @@ public void write(org.apache.thrift.protocol.TProtocol oprot) throws org.apache.
 
     @Override
     public java.lang.String toString() {
-      java.lang.StringBuilder sb = new java.lang.StringBuilder("open_txns_args(");
+      java.lang.StringBuilder sb = new java.lang.StringBuilder("abort_txn_args(");
       boolean first = true;
 
       sb.append("rqst:");
@@ -212993,15 +213891,15 @@ private void readObject(java.io.ObjectInputStream in) throws java.io.IOException
       }
     }
 
-    private static class open_txns_argsStandardSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
-      public open_txns_argsStandardScheme getScheme() {
-        return new open_txns_argsStandardScheme();
+    private static class abort_txn_argsStandardSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
+      public abort_txn_argsStandardScheme getScheme() {
+        return new abort_txn_argsStandardScheme();
       }
     }
 
-    private static class open_txns_argsStandardScheme extends org.apache.thrift.scheme.StandardScheme<open_txns_args> {
+    private static class abort_txn_argsStandardScheme extends org.apache.thrift.scheme.StandardScheme<abort_txn_args> {
 
-      public void read(org.apache.thrift.protocol.TProtocol iprot, open_txns_args struct) throws org.apache.thrift.TException {
+      public void read(org.apache.thrift.protocol.TProtocol iprot, abort_txn_args struct) throws org.apache.thrift.TException {
         org.apache.thrift.protocol.TField schemeField;
         iprot.readStructBegin();
         while (true)
@@ -213013,7 +213911,7 @@ public void read(org.apache.thrift.protocol.TProtocol iprot, open_txns_args stru
           switch (schemeField.id) {
             case 1: // RQST
               if (schemeField.type == org.apache.thrift.protocol.TType.STRUCT) {
-                struct.rqst = new OpenTxnRequest();
+                struct.rqst = new AbortTxnRequest();
                 struct.rqst.read(iprot);
                 struct.setRqstIsSet(true);
               } else { 
@@ -213029,7 +213927,7 @@ public void read(org.apache.thrift.protocol.TProtocol iprot, open_txns_args stru
         struct.validate();
       }
 
-      public void write(org.apache.thrift.protocol.TProtocol oprot, open_txns_args struct) throws org.apache.thrift.TException {
+      public void write(org.apache.thrift.protocol.TProtocol oprot, abort_txn_args struct) throws org.apache.thrift.TException {
         struct.validate();
 
         oprot.writeStructBegin(STRUCT_DESC);
@@ -213044,16 +213942,16 @@ public void write(org.apache.thrift.protocol.TProtocol oprot, open_txns_args str
 
     }
 
-    private static class open_txns_argsTupleSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
-      public open_txns_argsTupleScheme getScheme() {
-        return new open_txns_argsTupleScheme();
+    private static class abort_txn_argsTupleSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
+      public abort_txn_argsTupleScheme getScheme() {
+        return new abort_txn_argsTupleScheme();
       }
     }
 
-    private static class open_txns_argsTupleScheme extends org.apache.thrift.scheme.TupleScheme<open_txns_args> {
+    private static class abort_txn_argsTupleScheme extends org.apache.thrift.scheme.TupleScheme<abort_txn_args> {
 
       @Override
-      public void write(org.apache.thrift.protocol.TProtocol prot, open_txns_args struct) throws org.apache.thrift.TException {
+      public void write(org.apache.thrift.protocol.TProtocol prot, abort_txn_args struct) throws org.apache.thrift.TException {
         org.apache.thrift.protocol.TTupleProtocol oprot = (org.apache.thrift.protocol.TTupleProtocol) prot;
         java.util.BitSet optionals = new java.util.BitSet();
         if (struct.isSetRqst()) {
@@ -213066,11 +213964,11 @@ public void write(org.apache.thrift.protocol.TProtocol prot, open_txns_args stru
       }
 
       @Override
-      public void read(org.apache.thrift.protocol.TProtocol prot, open_txns_args struct) throws org.apache.thrift.TException {
+      public void read(org.apache.thrift.protocol.TProtocol prot, abort_txn_args struct) throws org.apache.thrift.TException {
         org.apache.thrift.protocol.TTupleProtocol iprot = (org.apache.thrift.protocol.TTupleProtocol) prot;
         java.util.BitSet incoming = iprot.readBitSet(1);
         if (incoming.get(0)) {
-          struct.rqst = new OpenTxnRequest();
+          struct.rqst = new AbortTxnRequest();
           struct.rqst.read(iprot);
           struct.setRqstIsSet(true);
         }
@@ -213082,19 +213980,19 @@ private static <S extends org.apache.thrift.scheme.IScheme> S scheme(org.apache.
     }
   }
 
-  @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class open_txns_result implements org.apache.thrift.TBase<open_txns_result, open_txns_result._Fields>, java.io.Serializable, Cloneable, Comparable<open_txns_result>   {
-    private static final org.apache.thrift.protocol.TStruct STRUCT_DESC = new org.apache.thrift.protocol.TStruct("open_txns_result");
+  @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class abort_txn_result implements org.apache.thrift.TBase<abort_txn_result, abort_txn_result._Fields>, java.io.Serializable, Cloneable, Comparable<abort_txn_result>   {
+    private static final org.apache.thrift.protocol.TStruct STRUCT_DESC = new org.apache.thrift.protocol.TStruct("abort_txn_result");
 
-    private static final org.apache.thrift.protocol.TField SUCCESS_FIELD_DESC = new org.apache.thrift.protocol.TField("success", org.apache.thrift.protocol.TType.STRUCT, (short)0);
+    private static final org.apache.thrift.protocol.TField O1_FIELD_DESC = new org.apache.thrift.protocol.TField("o1", org.apache.thrift.protocol.TType.STRUCT, (short)1);
 
-    private static final org.apache.thrift.scheme.SchemeFactory STANDARD_SCHEME_FACTORY = new open_txns_resultStandardSchemeFactory();
-    private static final org.apache.thrift.scheme.SchemeFactory TUPLE_SCHEME_FACTORY = new open_txns_resultTupleSchemeFactory();
+    private static final org.apache.thrift.scheme.SchemeFactory STANDARD_SCHEME_FACTORY = new abort_txn_resultStandardSchemeFactory();
+    private static final org.apache.thrift.scheme.SchemeFactory TUPLE_SCHEME_FACTORY = new abort_txn_resultTupleSchemeFactory();
 
-    private @org.apache.thrift.annotation.Nullable OpenTxnsResponse success; // required
+    private @org.apache.thrift.annotation.Nullable NoSuchTxnException o1; // required
 
     /** The set of fields this struct contains, along with convenience methods for finding and manipulating them. */
     public enum _Fields implements org.apache.thrift.TFieldIdEnum {
-      SUCCESS((short)0, "success");
+      O1((short)1, "o1");
 
       private static final java.util.Map<java.lang.String, _Fields> byName = new java.util.HashMap<java.lang.String, _Fields>();
 
@@ -213110,8 +214008,8 @@ public enum _Fields implements org.apache.thrift.TFieldIdEnum {
       @org.apache.thrift.annotation.Nullable
       public static _Fields findByThriftId(int fieldId) {
         switch(fieldId) {
-          case 0: // SUCCESS
-            return SUCCESS;
+          case 1: // O1
+            return O1;
           default:
             return null;
         }
@@ -213156,71 +214054,71 @@ public java.lang.String getFieldName() {
     public static final java.util.Map<_Fields, org.apache.thrift.meta_data.FieldMetaData> metaDataMap;
     static {
       java.util.Map<_Fields, org.apache.thrift.meta_data.FieldMetaData> tmpMap = new java.util.EnumMap<_Fields, org.apache.thrift.meta_data.FieldMetaData>(_Fields.class);
-      tmpMap.put(_Fields.SUCCESS, new org.apache.thrift.meta_data.FieldMetaData("success", org.apache.thrift.TFieldRequirementType.DEFAULT, 
-          new org.apache.thrift.meta_data.StructMetaData(org.apache.thrift.protocol.TType.STRUCT, OpenTxnsResponse.class)));
+      tmpMap.put(_Fields.O1, new org.apache.thrift.meta_data.FieldMetaData("o1", org.apache.thrift.TFieldRequirementType.DEFAULT, 
+          new org.apache.thrift.meta_data.StructMetaData(org.apache.thrift.protocol.TType.STRUCT, NoSuchTxnException.class)));
       metaDataMap = java.util.Collections.unmodifiableMap(tmpMap);
-      org.apache.thrift.meta_data.FieldMetaData.addStructMetaDataMap(open_txns_result.class, metaDataMap);
+      org.apache.thrift.meta_data.FieldMetaData.addStructMetaDataMap(abort_txn_result.class, metaDataMap);
     }
 
-    public open_txns_result() {
+    public abort_txn_result() {
     }
 
-    public open_txns_result(
-      OpenTxnsResponse success)
+    public abort_txn_result(
+      NoSuchTxnException o1)
     {
       this();
-      this.success = success;
+      this.o1 = o1;
     }
 
     /**
      * Performs a deep copy on <i>other</i>.
      */
-    public open_txns_result(open_txns_result other) {
-      if (other.isSetSuccess()) {
-        this.success = new OpenTxnsResponse(other.success);
+    public abort_txn_result(abort_txn_result other) {
+      if (other.isSetO1()) {
+        this.o1 = new NoSuchTxnException(other.o1);
       }
     }
 
-    public open_txns_result deepCopy() {
-      return new open_txns_result(this);
+    public abort_txn_result deepCopy() {
+      return new abort_txn_result(this);
     }
 
     @Override
     public void clear() {
-      this.success = null;
+      this.o1 = null;
     }
 
     @org.apache.thrift.annotation.Nullable
-    public OpenTxnsResponse getSuccess() {
-      return this.success;
+    public NoSuchTxnException getO1() {
+      return this.o1;
     }
 
-    public void setSuccess(@org.apache.thrift.annotation.Nullable OpenTxnsResponse success) {
-      this.success = success;
+    public void setO1(@org.apache.thrift.annotation.Nullable NoSuchTxnException o1) {
+      this.o1 = o1;
     }
 
-    public void unsetSuccess() {
-      this.success = null;
+    public void unsetO1() {
+      this.o1 = null;
     }
 
-    /** Returns true if field success is set (has been assigned a value) and false otherwise */
-    public boolean isSetSuccess() {
-      return this.success != null;
+    /** Returns true if field o1 is set (has been assigned a value) and false otherwise */
+    public boolean isSetO1() {
+      return this.o1 != null;
     }
 
-    public void setSuccessIsSet(boolean value) {
+    public void setO1IsSet(boolean value) {
       if (!value) {
-        this.success = null;
+        this.o1 = null;
       }
     }
 
     public void setFieldValue(_Fields field, @org.apache.thrift.annotation.Nullable java.lang.Object value) {
       switch (field) {
-      case SUCCESS:
+      case O1:
         if (value == null) {
-          unsetSuccess();
+          unsetO1();
         } else {
-          setSuccess((OpenTxnsResponse)value);
+          setO1((NoSuchTxnException)value);
         }
         break;
 
@@ -213230,8 +214128,8 @@ public void setFieldValue(_Fields field, @org.apache.thrift.annotation.Nullable
     @org.apache.thrift.annotation.Nullable
     public java.lang.Object getFieldValue(_Fields field) {
       switch (field) {
-      case SUCCESS:
-        return getSuccess();
+      case O1:
+        return getO1();
 
       }
       throw new java.lang.IllegalStateException();
@@ -213244,8 +214142,8 @@ public boolean isSet(_Fields field) {
       }
 
       switch (field) {
-      case SUCCESS:
-        return isSetSuccess();
+      case O1:
+        return isSetO1();
       }
       throw new java.lang.IllegalStateException();
     }
@@ -213254,23 +214152,23 @@ public boolean isSet(_Fields field) {
     public boolean equals(java.lang.Object that) {
       if (that == null)
         return false;
-      if (that instanceof open_txns_result)
-        return this.equals((open_txns_result)that);
+      if (that instanceof abort_txn_result)
+        return this.equals((abort_txn_result)that);
       return false;
     }
 
-    public boolean equals(open_txns_result that) {
+    public boolean equals(abort_txn_result that) {
       if (that == null)
         return false;
       if (this == that)
         return true;
 
-      boolean this_present_success = true && this.isSetSuccess();
-      boolean that_present_success = true && that.isSetSuccess();
-      if (this_present_success || that_present_success) {
-        if (!(this_present_success && that_present_success))
+      boolean this_present_o1 = true && this.isSetO1();
+      boolean that_present_o1 = true && that.isSetO1();
+      if (this_present_o1 || that_present_o1) {
+        if (!(this_present_o1 && that_present_o1))
           return false;
-        if (!this.success.equals(that.success))
+        if (!this.o1.equals(that.o1))
           return false;
       }
 
@@ -213281,27 +214179,27 @@ public boolean equals(open_txns_result that) {
     public int hashCode() {
       int hashCode = 1;
 
-      hashCode = hashCode * 8191 + ((isSetSuccess()) ? 131071 : 524287);
-      if (isSetSuccess())
-        hashCode = hashCode * 8191 + success.hashCode();
+      hashCode = hashCode * 8191 + ((isSetO1()) ? 131071 : 524287);
+      if (isSetO1())
+        hashCode = hashCode * 8191 + o1.hashCode();
 
       return hashCode;
     }
 
     @Override
-    public int compareTo(open_txns_result other) {
+    public int compareTo(abort_txn_result other) {
       if (!getClass().equals(other.getClass())) {
         return getClass().getName().compareTo(other.getClass().getName());
       }
 
       int lastComparison = 0;
 
-      lastComparison = java.lang.Boolean.valueOf(isSetSuccess()).compareTo(other.isSetSuccess());
+      lastComparison = java.lang.Boolean.valueOf(isSetO1()).compareTo(other.isSetO1());
       if (lastComparison != 0) {
         return lastComparison;
       }
-      if (isSetSuccess()) {
-        lastComparison = org.apache.thrift.TBaseHelper.compareTo(this.success, other.success);
+      if (isSetO1()) {
+        lastComparison = org.apache.thrift.TBaseHelper.compareTo(this.o1, other.o1);
         if (lastComparison != 0) {
           return lastComparison;
         }
@@ -213324,14 +214222,14 @@ public void write(org.apache.thrift.protocol.TProtocol oprot) throws org.apache.
 
     @Override
     public java.lang.String toString() {
-      java.lang.StringBuilder sb = new java.lang.StringBuilder("open_txns_result(");
+      java.lang.StringBuilder sb = new java.lang.StringBuilder("abort_txn_result(");
       boolean first = true;
 
-      sb.append("success:");
-      if (this.success == null) {
+      sb.append("o1:");
+      if (this.o1 == null) {
         sb.append("null");
       } else {
-        sb.append(this.success);
+        sb.append(this.o1);
       }
       first = false;
       sb.append(")");
@@ -213341,9 +214239,6 @@ public java.lang.String toString() {
     public void validate() throws org.apache.thrift.TException {
       // check for required fields
       // check for sub-struct validity
-      if (success != null) {
-        success.validate();
-      }
     }
 
     private void writeObject(java.io.ObjectOutputStream out) throws java.io.IOException {
@@ -213362,15 +214257,15 @@ private void readObject(java.io.ObjectInputStream in) throws java.io.IOException
       }
     }
 
-    private static class open_txns_resultStandardSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
-      public open_txns_resultStandardScheme getScheme() {
-        return new open_txns_resultStandardScheme();
+    private static class abort_txn_resultStandardSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
+      public abort_txn_resultStandardScheme getScheme() {
+        return new abort_txn_resultStandardScheme();
       }
     }
 
-    private static class open_txns_resultStandardScheme extends org.apache.thrift.scheme.StandardScheme<open_txns_result> {
+    private static class abort_txn_resultStandardScheme extends org.apache.thrift.scheme.StandardScheme<abort_txn_result> {
 
-      public void read(org.apache.thrift.protocol.TProtocol iprot, open_txns_result struct) throws org.apache.thrift.TException {
+      public void read(org.apache.thrift.protocol.TProtocol iprot, abort_txn_result struct) throws org.apache.thrift.TException {
         org.apache.thrift.protocol.TField schemeField;
         iprot.readStructBegin();
         while (true)
@@ -213380,11 +214275,11 @@ public void read(org.apache.thrift.protocol.TProtocol iprot, open_txns_result st
             break;
           }
           switch (schemeField.id) {
-            case 0: // SUCCESS
+            case 1: // O1
               if (schemeField.type == org.apache.thrift.protocol.TType.STRUCT) {
-                struct.success = new OpenTxnsResponse();
-                struct.success.read(iprot);
-                struct.setSuccessIsSet(true);
+                struct.o1 = new NoSuchTxnException();
+                struct.o1.read(iprot);
+                struct.setO1IsSet(true);
               } else { 
                 org.apache.thrift.protocol.TProtocolUtil.skip(iprot, schemeField.type);
               }
@@ -213398,13 +214293,13 @@ public void read(org.apache.thrift.protocol.TProtocol iprot, open_txns_result st
         struct.validate();
       }
 
-      public void write(org.apache.thrift.protocol.TProtocol oprot, open_txns_result struct) throws org.apache.thrift.TException {
+      public void write(org.apache.thrift.protocol.TProtocol oprot, abort_txn_result struct) throws org.apache.thrift.TException {
         struct.validate();
 
         oprot.writeStructBegin(STRUCT_DESC);
-        if (struct.success != null) {
-          oprot.writeFieldBegin(SUCCESS_FIELD_DESC);
-          struct.success.write(oprot);
+        if (struct.o1 != null) {
+          oprot.writeFieldBegin(O1_FIELD_DESC);
+          struct.o1.write(oprot);
           oprot.writeFieldEnd();
         }
         oprot.writeFieldStop();
@@ -213413,35 +214308,35 @@ public void write(org.apache.thrift.protocol.TProtocol oprot, open_txns_result s
 
     }
 
-    private static class open_txns_resultTupleSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
-      public open_txns_resultTupleScheme getScheme() {
-        return new open_txns_resultTupleScheme();
+    private static class abort_txn_resultTupleSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
+      public abort_txn_resultTupleScheme getScheme() {
+        return new abort_txn_resultTupleScheme();
       }
     }
 
-    private static class open_txns_resultTupleScheme extends org.apache.thrift.scheme.TupleScheme<open_txns_result> {
+    private static class abort_txn_resultTupleScheme extends org.apache.thrift.scheme.TupleScheme<abort_txn_result> {
 
       @Override
-      public void write(org.apache.thrift.protocol.TProtocol prot, open_txns_result struct) throws org.apache.thrift.TException {
+      public void write(org.apache.thrift.protocol.TProtocol prot, abort_txn_result struct) throws org.apache.thrift.TException {
         org.apache.thrift.protocol.TTupleProtocol oprot = (org.apache.thrift.protocol.TTupleProtocol) prot;
         java.util.BitSet optionals = new java.util.BitSet();
-        if (struct.isSetSuccess()) {
+        if (struct.isSetO1()) {
           optionals.set(0);
         }
         oprot.writeBitSet(optionals, 1);
-        if (struct.isSetSuccess()) {
-          struct.success.write(oprot);
+        if (struct.isSetO1()) {
+          struct.o1.write(oprot);
         }
       }
 
       @Override
-      public void read(org.apache.thrift.protocol.TProtocol prot, open_txns_result struct) throws org.apache.thrift.TException {
+      public void read(org.apache.thrift.protocol.TProtocol prot, abort_txn_result struct) throws org.apache.thrift.TException {
         org.apache.thrift.protocol.TTupleProtocol iprot = (org.apache.thrift.protocol.TTupleProtocol) prot;
         java.util.BitSet incoming = iprot.readBitSet(1);
         if (incoming.get(0)) {
-          struct.success = new OpenTxnsResponse();
-          struct.success.read(iprot);
-          struct.setSuccessIsSet(true);
+          struct.o1 = new NoSuchTxnException();
+          struct.o1.read(iprot);
+          struct.setO1IsSet(true);
         }
       }
     }
@@ -213451,15 +214346,15 @@ private static <S extends org.apache.thrift.scheme.IScheme> S scheme(org.apache.
     }
   }
 
-  @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class abort_txn_args implements org.apache.thrift.TBase<abort_txn_args, abort_txn_args._Fields>, java.io.Serializable, Cloneable, Comparable<abort_txn_args>   {
-    private static final org.apache.thrift.protocol.TStruct STRUCT_DESC = new org.apache.thrift.protocol.TStruct("abort_txn_args");
+  @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class abort_txns_args implements org.apache.thrift.TBase<abort_txns_args, abort_txns_args._Fields>, java.io.Serializable, Cloneable, Comparable<abort_txns_args>   {
+    private static final org.apache.thrift.protocol.TStruct STRUCT_DESC = new org.apache.thrift.protocol.TStruct("abort_txns_args");
 
     private static final org.apache.thrift.protocol.TField RQST_FIELD_DESC = new org.apache.thrift.protocol.TField("rqst", org.apache.thrift.protocol.TType.STRUCT, (short)1);
 
-    private static final org.apache.thrift.scheme.SchemeFactory STANDARD_SCHEME_FACTORY = new abort_txn_argsStandardSchemeFactory();
-    private static final org.apache.thrift.scheme.SchemeFactory TUPLE_SCHEME_FACTORY = new abort_txn_argsTupleSchemeFactory();
+    private static final org.apache.thrift.scheme.SchemeFactory STANDARD_SCHEME_FACTORY = new abort_txns_argsStandardSchemeFactory();
+    private static final org.apache.thrift.scheme.SchemeFactory TUPLE_SCHEME_FACTORY = new abort_txns_argsTupleSchemeFactory();
 
-    private @org.apache.thrift.annotation.Nullable AbortTxnRequest rqst; // required
+    private @org.apache.thrift.annotation.Nullable AbortTxnsRequest rqst; // required
 
     /** The set of fields this struct contains, along with convenience methods for finding and manipulating them. */
     public enum _Fields implements org.apache.thrift.TFieldIdEnum {
@@ -213526,16 +214421,16 @@ public java.lang.String getFieldName() {
     static {
       java.util.Map<_Fields, org.apache.thrift.meta_data.FieldMetaData> tmpMap = new java.util.EnumMap<_Fields, org.apache.thrift.meta_data.FieldMetaData>(_Fields.class);
       tmpMap.put(_Fields.RQST, new org.apache.thrift.meta_data.FieldMetaData("rqst", org.apache.thrift.TFieldRequirementType.DEFAULT, 
-          new org.apache.thrift.meta_data.StructMetaData(org.apache.thrift.protocol.TType.STRUCT, AbortTxnRequest.class)));
+          new org.apache.thrift.meta_data.StructMetaData(org.apache.thrift.protocol.TType.STRUCT, AbortTxnsRequest.class)));
       metaDataMap = java.util.Collections.unmodifiableMap(tmpMap);
-      org.apache.thrift.meta_data.FieldMetaData.addStructMetaDataMap(abort_txn_args.class, metaDataMap);
+      org.apache.thrift.meta_data.FieldMetaData.addStructMetaDataMap(abort_txns_args.class, metaDataMap);
     }
 
-    public abort_txn_args() {
+    public abort_txns_args() {
     }
 
-    public abort_txn_args(
-      AbortTxnRequest rqst)
+    public abort_txns_args(
+      AbortTxnsRequest rqst)
     {
       this();
       this.rqst = rqst;
@@ -213544,14 +214439,14 @@ public abort_txn_args(
     /**
      * Performs a deep copy on <i>other</i>.
      */
-    public abort_txn_args(abort_txn_args other) {
+    public abort_txns_args(abort_txns_args other) {
       if (other.isSetRqst()) {
-        this.rqst = new AbortTxnRequest(other.rqst);
+        this.rqst = new AbortTxnsRequest(other.rqst);
       }
     }
 
-    public abort_txn_args deepCopy() {
-      return new abort_txn_args(this);
+    public abort_txns_args deepCopy() {
+      return new abort_txns_args(this);
     }
 
     @Override
@@ -213560,11 +214455,11 @@ public void clear() {
     }
 
     @org.apache.thrift.annotation.Nullable
-    public AbortTxnRequest getRqst() {
+    public AbortTxnsRequest getRqst() {
       return this.rqst;
     }
 
-    public void setRqst(@org.apache.thrift.annotation.Nullable AbortTxnRequest rqst) {
+    public void setRqst(@org.apache.thrift.annotation.Nullable AbortTxnsRequest rqst) {
       this.rqst = rqst;
     }
 
@@ -213589,7 +214484,7 @@ public void setFieldValue(_Fields field, @org.apache.thrift.annotation.Nullable
         if (value == null) {
           unsetRqst();
         } else {
-          setRqst((AbortTxnRequest)value);
+          setRqst((AbortTxnsRequest)value);
         }
         break;
 
@@ -213623,12 +214518,12 @@ public boolean isSet(_Fields field) {
     public boolean equals(java.lang.Object that) {
       if (that == null)
         return false;
-      if (that instanceof abort_txn_args)
-        return this.equals((abort_txn_args)that);
+      if (that instanceof abort_txns_args)
+        return this.equals((abort_txns_args)that);
       return false;
     }
 
-    public boolean equals(abort_txn_args that) {
+    public boolean equals(abort_txns_args that) {
       if (that == null)
         return false;
       if (this == that)
@@ -213658,7 +214553,7 @@ public int hashCode() {
     }
 
     @Override
-    public int compareTo(abort_txn_args other) {
+    public int compareTo(abort_txns_args other) {
       if (!getClass().equals(other.getClass())) {
         return getClass().getName().compareTo(other.getClass().getName());
       }
@@ -213693,7 +214588,7 @@ public void write(org.apache.thrift.protocol.TProtocol oprot) throws org.apache.
 
     @Override
     public java.lang.String toString() {
-      java.lang.StringBuilder sb = new java.lang.StringBuilder("abort_txn_args(");
+      java.lang.StringBuilder sb = new java.lang.StringBuilder("abort_txns_args(");
       boolean first = true;
 
       sb.append("rqst:");
@@ -213731,15 +214626,15 @@ private void readObject(java.io.ObjectInputStream in) throws java.io.IOException
       }
     }
 
-    private static class abort_txn_argsStandardSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
-      public abort_txn_argsStandardScheme getScheme() {
-        return new abort_txn_argsStandardScheme();
+    private static class abort_txns_argsStandardSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
+      public abort_txns_argsStandardScheme getScheme() {
+        return new abort_txns_argsStandardScheme();
       }
     }
 
-    private static class abort_txn_argsStandardScheme extends org.apache.thrift.scheme.StandardScheme<abort_txn_args> {
+    private static class abort_txns_argsStandardScheme extends org.apache.thrift.scheme.StandardScheme<abort_txns_args> {
 
-      public void read(org.apache.thrift.protocol.TProtocol iprot, abort_txn_args struct) throws org.apache.thrift.TException {
+      public void read(org.apache.thrift.protocol.TProtocol iprot, abort_txns_args struct) throws org.apache.thrift.TException {
         org.apache.thrift.protocol.TField schemeField;
         iprot.readStructBegin();
         while (true)
@@ -213751,7 +214646,7 @@ public void read(org.apache.thrift.protocol.TProtocol iprot, abort_txn_args stru
           switch (schemeField.id) {
             case 1: // RQST
               if (schemeField.type == org.apache.thrift.protocol.TType.STRUCT) {
-                struct.rqst = new AbortTxnRequest();
+                struct.rqst = new AbortTxnsRequest();
                 struct.rqst.read(iprot);
                 struct.setRqstIsSet(true);
               } else { 
@@ -213767,7 +214662,7 @@ public void read(org.apache.thrift.protocol.TProtocol iprot, abort_txn_args stru
         struct.validate();
       }
 
-      public void write(org.apache.thrift.protocol.TProtocol oprot, abort_txn_args struct) throws org.apache.thrift.TException {
+      public void write(org.apache.thrift.protocol.TProtocol oprot, abort_txns_args struct) throws org.apache.thrift.TException {
         struct.validate();
 
         oprot.writeStructBegin(STRUCT_DESC);
@@ -213782,16 +214677,16 @@ public void write(org.apache.thrift.protocol.TProtocol oprot, abort_txn_args str
 
     }
 
-    private static class abort_txn_argsTupleSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
-      public abort_txn_argsTupleScheme getScheme() {
-        return new abort_txn_argsTupleScheme();
+    private static class abort_txns_argsTupleSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
+      public abort_txns_argsTupleScheme getScheme() {
+        return new abort_txns_argsTupleScheme();
       }
     }
 
-    private static class abort_txn_argsTupleScheme extends org.apache.thrift.scheme.TupleScheme<abort_txn_args> {
+    private static class abort_txns_argsTupleScheme extends org.apache.thrift.scheme.TupleScheme<abort_txns_args> {
 
       @Override
-      public void write(org.apache.thrift.protocol.TProtocol prot, abort_txn_args struct) throws org.apache.thrift.TException {
+      public void write(org.apache.thrift.protocol.TProtocol prot, abort_txns_args struct) throws org.apache.thrift.TException {
         org.apache.thrift.protocol.TTupleProtocol oprot = (org.apache.thrift.protocol.TTupleProtocol) prot;
         java.util.BitSet optionals = new java.util.BitSet();
         if (struct.isSetRqst()) {
@@ -213804,11 +214699,11 @@ public void write(org.apache.thrift.protocol.TProtocol prot, abort_txn_args stru
       }
 
       @Override
-      public void read(org.apache.thrift.protocol.TProtocol prot, abort_txn_args struct) throws org.apache.thrift.TException {
+      public void read(org.apache.thrift.protocol.TProtocol prot, abort_txns_args struct) throws org.apache.thrift.TException {
         org.apache.thrift.protocol.TTupleProtocol iprot = (org.apache.thrift.protocol.TTupleProtocol) prot;
         java.util.BitSet incoming = iprot.readBitSet(1);
         if (incoming.get(0)) {
-          struct.rqst = new AbortTxnRequest();
+          struct.rqst = new AbortTxnsRequest();
           struct.rqst.read(iprot);
           struct.setRqstIsSet(true);
         }
@@ -213820,13 +214715,13 @@ private static <S extends org.apache.thrift.scheme.IScheme> S scheme(org.apache.
     }
   }
 
-  @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class abort_txn_result implements org.apache.thrift.TBase<abort_txn_result, abort_txn_result._Fields>, java.io.Serializable, Cloneable, Comparable<abort_txn_result>   {
-    private static final org.apache.thrift.protocol.TStruct STRUCT_DESC = new org.apache.thrift.protocol.TStruct("abort_txn_result");
+  @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class abort_txns_result implements org.apache.thrift.TBase<abort_txns_result, abort_txns_result._Fields>, java.io.Serializable, Cloneable, Comparable<abort_txns_result>   {
+    private static final org.apache.thrift.protocol.TStruct STRUCT_DESC = new org.apache.thrift.protocol.TStruct("abort_txns_result");
 
     private static final org.apache.thrift.protocol.TField O1_FIELD_DESC = new org.apache.thrift.protocol.TField("o1", org.apache.thrift.protocol.TType.STRUCT, (short)1);
 
-    private static final org.apache.thrift.scheme.SchemeFactory STANDARD_SCHEME_FACTORY = new abort_txn_resultStandardSchemeFactory();
-    private static final org.apache.thrift.scheme.SchemeFactory TUPLE_SCHEME_FACTORY = new abort_txn_resultTupleSchemeFactory();
+    private static final org.apache.thrift.scheme.SchemeFactory STANDARD_SCHEME_FACTORY = new abort_txns_resultStandardSchemeFactory();
+    private static final org.apache.thrift.scheme.SchemeFactory TUPLE_SCHEME_FACTORY = new abort_txns_resultTupleSchemeFactory();
 
     private @org.apache.thrift.annotation.Nullable NoSuchTxnException o1; // required
 
@@ -213897,13 +214792,13 @@ public java.lang.String getFieldName() {
       tmpMap.put(_Fields.O1, new org.apache.thrift.meta_data.FieldMetaData("o1", org.apache.thrift.TFieldRequirementType.DEFAULT, 
           new org.apache.thrift.meta_data.StructMetaData(org.apache.thrift.protocol.TType.STRUCT, NoSuchTxnException.class)));
       metaDataMap = java.util.Collections.unmodifiableMap(tmpMap);
-      org.apache.thrift.meta_data.FieldMetaData.addStructMetaDataMap(abort_txn_result.class, metaDataMap);
+      org.apache.thrift.meta_data.FieldMetaData.addStructMetaDataMap(abort_txns_result.class, metaDataMap);
     }
 
-    public abort_txn_result() {
+    public abort_txns_result() {
     }
 
-    public abort_txn_result(
+    public abort_txns_result(
       NoSuchTxnException o1)
     {
       this();
@@ -213913,14 +214808,14 @@ public abort_txn_result(
     /**
      * Performs a deep copy on <i>other</i>.
      */
-    public abort_txn_result(abort_txn_result other) {
+    public abort_txns_result(abort_txns_result other) {
       if (other.isSetO1()) {
         this.o1 = new NoSuchTxnException(other.o1);
       }
     }
 
-    public abort_txn_result deepCopy() {
-      return new abort_txn_result(this);
+    public abort_txns_result deepCopy() {
+      return new abort_txns_result(this);
     }
 
     @Override
@@ -213992,12 +214887,12 @@ public boolean isSet(_Fields field) {
     public boolean equals(java.lang.Object that) {
       if (that == null)
         return false;
-      if (that instanceof abort_txn_result)
-        return this.equals((abort_txn_result)that);
+      if (that instanceof abort_txns_result)
+        return this.equals((abort_txns_result)that);
       return false;
     }
 
-    public boolean equals(abort_txn_result that) {
+    public boolean equals(abort_txns_result that) {
       if (that == null)
         return false;
       if (this == that)
@@ -214027,7 +214922,7 @@ public int hashCode() {
     }
 
     @Override
-    public int compareTo(abort_txn_result other) {
+    public int compareTo(abort_txns_result other) {
       if (!getClass().equals(other.getClass())) {
         return getClass().getName().compareTo(other.getClass().getName());
       }
@@ -214062,7 +214957,7 @@ public void write(org.apache.thrift.protocol.TProtocol oprot) throws org.apache.
 
     @Override
     public java.lang.String toString() {
-      java.lang.StringBuilder sb = new java.lang.StringBuilder("abort_txn_result(");
+      java.lang.StringBuilder sb = new java.lang.StringBuilder("abort_txns_result(");
       boolean first = true;
 
       sb.append("o1:");
@@ -214097,15 +214992,15 @@ private void readObject(java.io.ObjectInputStream in) throws java.io.IOException
       }
     }
 
-    private static class abort_txn_resultStandardSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
-      public abort_txn_resultStandardScheme getScheme() {
-        return new abort_txn_resultStandardScheme();
+    private static class abort_txns_resultStandardSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
+      public abort_txns_resultStandardScheme getScheme() {
+        return new abort_txns_resultStandardScheme();
       }
     }
 
-    private static class abort_txn_resultStandardScheme extends org.apache.thrift.scheme.StandardScheme<abort_txn_result> {
+    private static class abort_txns_resultStandardScheme extends org.apache.thrift.scheme.StandardScheme<abort_txns_result> {
 
-      public void read(org.apache.thrift.protocol.TProtocol iprot, abort_txn_result struct) throws org.apache.thrift.TException {
+      public void read(org.apache.thrift.protocol.TProtocol iprot, abort_txns_result struct) throws org.apache.thrift.TException {
         org.apache.thrift.protocol.TField schemeField;
         iprot.readStructBegin();
         while (true)
@@ -214133,7 +215028,7 @@ public void read(org.apache.thrift.protocol.TProtocol iprot, abort_txn_result st
         struct.validate();
       }
 
-      public void write(org.apache.thrift.protocol.TProtocol oprot, abort_txn_result struct) throws org.apache.thrift.TException {
+      public void write(org.apache.thrift.protocol.TProtocol oprot, abort_txns_result struct) throws org.apache.thrift.TException {
         struct.validate();
 
         oprot.writeStructBegin(STRUCT_DESC);
@@ -214148,16 +215043,16 @@ public void write(org.apache.thrift.protocol.TProtocol oprot, abort_txn_result s
 
     }
 
-    private static class abort_txn_resultTupleSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
-      public abort_txn_resultTupleScheme getScheme() {
-        return new abort_txn_resultTupleScheme();
+    private static class abort_txns_resultTupleSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
+      public abort_txns_resultTupleScheme getScheme() {
+        return new abort_txns_resultTupleScheme();
       }
     }
 
-    private static class abort_txn_resultTupleScheme extends org.apache.thrift.scheme.TupleScheme<abort_txn_result> {
+    private static class abort_txns_resultTupleScheme extends org.apache.thrift.scheme.TupleScheme<abort_txns_result> {
 
       @Override
-      public void write(org.apache.thrift.protocol.TProtocol prot, abort_txn_result struct) throws org.apache.thrift.TException {
+      public void write(org.apache.thrift.protocol.TProtocol prot, abort_txns_result struct) throws org.apache.thrift.TException {
         org.apache.thrift.protocol.TTupleProtocol oprot = (org.apache.thrift.protocol.TTupleProtocol) prot;
         java.util.BitSet optionals = new java.util.BitSet();
         if (struct.isSetO1()) {
@@ -214170,7 +215065,7 @@ public void write(org.apache.thrift.protocol.TProtocol prot, abort_txn_result st
       }
 
       @Override
-      public void read(org.apache.thrift.protocol.TProtocol prot, abort_txn_result struct) throws org.apache.thrift.TException {
+      public void read(org.apache.thrift.protocol.TProtocol prot, abort_txns_result struct) throws org.apache.thrift.TException {
         org.apache.thrift.protocol.TTupleProtocol iprot = (org.apache.thrift.protocol.TTupleProtocol) prot;
         java.util.BitSet incoming = iprot.readBitSet(1);
         if (incoming.get(0)) {
@@ -214186,15 +215081,15 @@ private static <S extends org.apache.thrift.scheme.IScheme> S scheme(org.apache.
     }
   }
 
-  @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class abort_txns_args implements org.apache.thrift.TBase<abort_txns_args, abort_txns_args._Fields>, java.io.Serializable, Cloneable, Comparable<abort_txns_args>   {
-    private static final org.apache.thrift.protocol.TStruct STRUCT_DESC = new org.apache.thrift.protocol.TStruct("abort_txns_args");
+  @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class commit_txn_args implements org.apache.thrift.TBase<commit_txn_args, commit_txn_args._Fields>, java.io.Serializable, Cloneable, Comparable<commit_txn_args>   {
+    private static final org.apache.thrift.protocol.TStruct STRUCT_DESC = new org.apache.thrift.protocol.TStruct("commit_txn_args");
 
     private static final org.apache.thrift.protocol.TField RQST_FIELD_DESC = new org.apache.thrift.protocol.TField("rqst", org.apache.thrift.protocol.TType.STRUCT, (short)1);
 
-    private static final org.apache.thrift.scheme.SchemeFactory STANDARD_SCHEME_FACTORY = new abort_txns_argsStandardSchemeFactory();
-    private static final org.apache.thrift.scheme.SchemeFactory TUPLE_SCHEME_FACTORY = new abort_txns_argsTupleSchemeFactory();
+    private static final org.apache.thrift.scheme.SchemeFactory STANDARD_SCHEME_FACTORY = new commit_txn_argsStandardSchemeFactory();
+    private static final org.apache.thrift.scheme.SchemeFactory TUPLE_SCHEME_FACTORY = new commit_txn_argsTupleSchemeFactory();
 
-    private @org.apache.thrift.annotation.Nullable AbortTxnsRequest rqst; // required
+    private @org.apache.thrift.annotation.Nullable CommitTxnRequest rqst; // required
 
     /** The set of fields this struct contains, along with convenience methods for finding and manipulating them. */
     public enum _Fields implements org.apache.thrift.TFieldIdEnum {
@@ -214261,16 +215156,16 @@ public java.lang.String getFieldName() {
     static {
       java.util.Map<_Fields, org.apache.thrift.meta_data.FieldMetaData> tmpMap = new java.util.EnumMap<_Fields, org.apache.thrift.meta_data.FieldMetaData>(_Fields.class);
       tmpMap.put(_Fields.RQST, new org.apache.thrift.meta_data.FieldMetaData("rqst", org.apache.thrift.TFieldRequirementType.DEFAULT, 
-          new org.apache.thrift.meta_data.StructMetaData(org.apache.thrift.protocol.TType.STRUCT, AbortTxnsRequest.class)));
+          new org.apache.thrift.meta_data.StructMetaData(org.apache.thrift.protocol.TType.STRUCT, CommitTxnRequest.class)));
       metaDataMap = java.util.Collections.unmodifiableMap(tmpMap);
-      org.apache.thrift.meta_data.FieldMetaData.addStructMetaDataMap(abort_txns_args.class, metaDataMap);
+      org.apache.thrift.meta_data.FieldMetaData.addStructMetaDataMap(commit_txn_args.class, metaDataMap);
     }
 
-    public abort_txns_args() {
+    public commit_txn_args() {
     }
 
-    public abort_txns_args(
-      AbortTxnsRequest rqst)
+    public commit_txn_args(
+      CommitTxnRequest rqst)
     {
       this();
       this.rqst = rqst;
@@ -214279,14 +215174,14 @@ public abort_txns_args(
     /**
      * Performs a deep copy on <i>other</i>.
      */
-    public abort_txns_args(abort_txns_args other) {
+    public commit_txn_args(commit_txn_args other) {
       if (other.isSetRqst()) {
-        this.rqst = new AbortTxnsRequest(other.rqst);
+        this.rqst = new CommitTxnRequest(other.rqst);
       }
     }
 
-    public abort_txns_args deepCopy() {
-      return new abort_txns_args(this);
+    public commit_txn_args deepCopy() {
+      return new commit_txn_args(this);
     }
 
     @Override
@@ -214295,11 +215190,11 @@ public void clear() {
     }
 
     @org.apache.thrift.annotation.Nullable
-    public AbortTxnsRequest getRqst() {
+    public CommitTxnRequest getRqst() {
       return this.rqst;
     }
 
-    public void setRqst(@org.apache.thrift.annotation.Nullable AbortTxnsRequest rqst) {
+    public void setRqst(@org.apache.thrift.annotation.Nullable CommitTxnRequest rqst) {
       this.rqst = rqst;
     }
 
@@ -214324,7 +215219,7 @@ public void setFieldValue(_Fields field, @org.apache.thrift.annotation.Nullable
         if (value == null) {
           unsetRqst();
         } else {
-          setRqst((AbortTxnsRequest)value);
+          setRqst((CommitTxnRequest)value);
         }
         break;
 
@@ -214358,12 +215253,12 @@ public boolean isSet(_Fields field) {
     public boolean equals(java.lang.Object that) {
       if (that == null)
         return false;
-      if (that instanceof abort_txns_args)
-        return this.equals((abort_txns_args)that);
+      if (that instanceof commit_txn_args)
+        return this.equals((commit_txn_args)that);
       return false;
     }
 
-    public boolean equals(abort_txns_args that) {
+    public boolean equals(commit_txn_args that) {
       if (that == null)
         return false;
       if (this == that)
@@ -214393,7 +215288,7 @@ public int hashCode() {
     }
 
     @Override
-    public int compareTo(abort_txns_args other) {
+    public int compareTo(commit_txn_args other) {
       if (!getClass().equals(other.getClass())) {
         return getClass().getName().compareTo(other.getClass().getName());
       }
@@ -214428,7 +215323,7 @@ public void write(org.apache.thrift.protocol.TProtocol oprot) throws org.apache.
 
     @Override
     public java.lang.String toString() {
-      java.lang.StringBuilder sb = new java.lang.StringBuilder("abort_txns_args(");
+      java.lang.StringBuilder sb = new java.lang.StringBuilder("commit_txn_args(");
       boolean first = true;
 
       sb.append("rqst:");
@@ -214466,15 +215361,15 @@ private void readObject(java.io.ObjectInputStream in) throws java.io.IOException
       }
     }
 
-    private static class abort_txns_argsStandardSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
-      public abort_txns_argsStandardScheme getScheme() {
-        return new abort_txns_argsStandardScheme();
+    private static class commit_txn_argsStandardSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
+      public commit_txn_argsStandardScheme getScheme() {
+        return new commit_txn_argsStandardScheme();
       }
     }
 
-    private static class abort_txns_argsStandardScheme extends org.apache.thrift.scheme.StandardScheme<abort_txns_args> {
+    private static class commit_txn_argsStandardScheme extends org.apache.thrift.scheme.StandardScheme<commit_txn_args> {
 
-      public void read(org.apache.thrift.protocol.TProtocol iprot, abort_txns_args struct) throws org.apache.thrift.TException {
+      public void read(org.apache.thrift.protocol.TProtocol iprot, commit_txn_args struct) throws org.apache.thrift.TException {
         org.apache.thrift.protocol.TField schemeField;
         iprot.readStructBegin();
         while (true)
@@ -214486,7 +215381,7 @@ public void read(org.apache.thrift.protocol.TProtocol iprot, abort_txns_args str
           switch (schemeField.id) {
             case 1: // RQST
               if (schemeField.type == org.apache.thrift.protocol.TType.STRUCT) {
-                struct.rqst = new AbortTxnsRequest();
+                struct.rqst = new CommitTxnRequest();
                 struct.rqst.read(iprot);
                 struct.setRqstIsSet(true);
               } else { 
@@ -214502,7 +215397,7 @@ public void read(org.apache.thrift.protocol.TProtocol iprot, abort_txns_args str
         struct.validate();
       }
 
-      public void write(org.apache.thrift.protocol.TProtocol oprot, abort_txns_args struct) throws org.apache.thrift.TException {
+      public void write(org.apache.thrift.protocol.TProtocol oprot, commit_txn_args struct) throws org.apache.thrift.TException {
         struct.validate();
 
         oprot.writeStructBegin(STRUCT_DESC);
@@ -214517,16 +215412,16 @@ public void write(org.apache.thrift.protocol.TProtocol oprot, abort_txns_args st
 
     }
 
-    private static class abort_txns_argsTupleSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
-      public abort_txns_argsTupleScheme getScheme() {
-        return new abort_txns_argsTupleScheme();
+    private static class commit_txn_argsTupleSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
+      public commit_txn_argsTupleScheme getScheme() {
+        return new commit_txn_argsTupleScheme();
       }
     }
 
-    private static class abort_txns_argsTupleScheme extends org.apache.thrift.scheme.TupleScheme<abort_txns_args> {
+    private static class commit_txn_argsTupleScheme extends org.apache.thrift.scheme.TupleScheme<commit_txn_args> {
 
       @Override
-      public void write(org.apache.thrift.protocol.TProtocol prot, abort_txns_args struct) throws org.apache.thrift.TException {
+      public void write(org.apache.thrift.protocol.TProtocol prot, commit_txn_args struct) throws org.apache.thrift.TException {
         org.apache.thrift.protocol.TTupleProtocol oprot = (org.apache.thrift.protocol.TTupleProtocol) prot;
         java.util.BitSet optionals = new java.util.BitSet();
         if (struct.isSetRqst()) {
@@ -214539,11 +215434,11 @@ public void write(org.apache.thrift.protocol.TProtocol prot, abort_txns_args str
       }
 
       @Override
-      public void read(org.apache.thrift.protocol.TProtocol prot, abort_txns_args struct) throws org.apache.thrift.TException {
+      public void read(org.apache.thrift.protocol.TProtocol prot, commit_txn_args struct) throws org.apache.thrift.TException {
         org.apache.thrift.protocol.TTupleProtocol iprot = (org.apache.thrift.protocol.TTupleProtocol) prot;
         java.util.BitSet incoming = iprot.readBitSet(1);
         if (incoming.get(0)) {
-          struct.rqst = new AbortTxnsRequest();
+          struct.rqst = new CommitTxnRequest();
           struct.rqst.read(iprot);
           struct.setRqstIsSet(true);
         }
@@ -214555,19 +215450,22 @@ private static <S extends org.apache.thrift.scheme.IScheme> S scheme(org.apache.
     }
   }
 
-  @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class abort_txns_result implements org.apache.thrift.TBase<abort_txns_result, abort_txns_result._Fields>, java.io.Serializable, Cloneable, Comparable<abort_txns_result>   {
-    private static final org.apache.thrift.protocol.TStruct STRUCT_DESC = new org.apache.thrift.protocol.TStruct("abort_txns_result");
+  @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class commit_txn_result implements org.apache.thrift.TBase<commit_txn_result, commit_txn_result._Fields>, java.io.Serializable, Cloneable, Comparable<commit_txn_result>   {
+    private static final org.apache.thrift.protocol.TStruct STRUCT_DESC = new org.apache.thrift.protocol.TStruct("commit_txn_result");
 
     private static final org.apache.thrift.protocol.TField O1_FIELD_DESC = new org.apache.thrift.protocol.TField("o1", org.apache.thrift.protocol.TType.STRUCT, (short)1);
+    private static final org.apache.thrift.protocol.TField O2_FIELD_DESC = new org.apache.thrift.protocol.TField("o2", org.apache.thrift.protocol.TType.STRUCT, (short)2);
 
-    private static final org.apache.thrift.scheme.SchemeFactory STANDARD_SCHEME_FACTORY = new abort_txns_resultStandardSchemeFactory();
-    private static final org.apache.thrift.scheme.SchemeFactory TUPLE_SCHEME_FACTORY = new abort_txns_resultTupleSchemeFactory();
+    private static final org.apache.thrift.scheme.SchemeFactory STANDARD_SCHEME_FACTORY = new commit_txn_resultStandardSchemeFactory();
+    private static final org.apache.thrift.scheme.SchemeFactory TUPLE_SCHEME_FACTORY = new commit_txn_resultTupleSchemeFactory();
 
     private @org.apache.thrift.annotation.Nullable NoSuchTxnException o1; // required
+    private @org.apache.thrift.annotation.Nullable TxnAbortedException o2; // required
 
     /** The set of fields this struct contains, along with convenience methods for finding and manipulating them. */
     public enum _Fields implements org.apache.thrift.TFieldIdEnum {
-      O1((short)1, "o1");
+      O1((short)1, "o1"),
+      O2((short)2, "o2");
 
       private static final java.util.Map<java.lang.String, _Fields> byName = new java.util.HashMap<java.lang.String, _Fields>();
 
@@ -214585,6 +215483,8 @@ public static _Fields findByThriftId(int fieldId) {
         switch(fieldId) {
           case 1: // O1
             return O1;
+          case 2: // O2
+            return O2;
           default:
             return null;
         }
@@ -214631,36 +215531,44 @@ public java.lang.String getFieldName() {
       java.util.Map<_Fields, org.apache.thrift.meta_data.FieldMetaData> tmpMap = new java.util.EnumMap<_Fields, org.apache.thrift.meta_data.FieldMetaData>(_Fields.class);
       tmpMap.put(_Fields.O1, new org.apache.thrift.meta_data.FieldMetaData("o1", org.apache.thrift.TFieldRequirementType.DEFAULT, 
           new org.apache.thrift.meta_data.StructMetaData(org.apache.thrift.protocol.TType.STRUCT, NoSuchTxnException.class)));
+      tmpMap.put(_Fields.O2, new org.apache.thrift.meta_data.FieldMetaData("o2", org.apache.thrift.TFieldRequirementType.DEFAULT, 
+          new org.apache.thrift.meta_data.StructMetaData(org.apache.thrift.protocol.TType.STRUCT, TxnAbortedException.class)));
       metaDataMap = java.util.Collections.unmodifiableMap(tmpMap);
-      org.apache.thrift.meta_data.FieldMetaData.addStructMetaDataMap(abort_txns_result.class, metaDataMap);
+      org.apache.thrift.meta_data.FieldMetaData.addStructMetaDataMap(commit_txn_result.class, metaDataMap);
     }
 
-    public abort_txns_result() {
+    public commit_txn_result() {
     }
 
-    public abort_txns_result(
-      NoSuchTxnException o1)
+    public commit_txn_result(
+      NoSuchTxnException o1,
+      TxnAbortedException o2)
     {
       this();
       this.o1 = o1;
+      this.o2 = o2;
     }
 
     /**
      * Performs a deep copy on <i>other</i>.
      */
-    public abort_txns_result(abort_txns_result other) {
+    public commit_txn_result(commit_txn_result other) {
       if (other.isSetO1()) {
         this.o1 = new NoSuchTxnException(other.o1);
       }
+      if (other.isSetO2()) {
+        this.o2 = new TxnAbortedException(other.o2);
+      }
     }
 
-    public abort_txns_result deepCopy() {
-      return new abort_txns_result(this);
+    public commit_txn_result deepCopy() {
+      return new commit_txn_result(this);
     }
 
     @Override
     public void clear() {
       this.o1 = null;
+      this.o2 = null;
     }
 
     @org.apache.thrift.annotation.Nullable
@@ -214687,6 +215595,30 @@ public void setO1IsSet(boolean value) {
       }
     }
 
+    @org.apache.thrift.annotation.Nullable
+    public TxnAbortedException getO2() {
+      return this.o2;
+    }
+
+    public void setO2(@org.apache.thrift.annotation.Nullable TxnAbortedException o2) {
+      this.o2 = o2;
+    }
+
+    public void unsetO2() {
+      this.o2 = null;
+    }
+
+    /** Returns true if field o2 is set (has been assigned a value) and false otherwise */
+    public boolean isSetO2() {
+      return this.o2 != null;
+    }
+
+    public void setO2IsSet(boolean value) {
+      if (!value) {
+        this.o2 = null;
+      }
+    }
+
     public void setFieldValue(_Fields field, @org.apache.thrift.annotation.Nullable java.lang.Object value) {
       switch (field) {
       case O1:
@@ -214697,6 +215629,14 @@ public void setFieldValue(_Fields field, @org.apache.thrift.annotation.Nullable
         }
         break;
 
+      case O2:
+        if (value == null) {
+          unsetO2();
+        } else {
+          setO2((TxnAbortedException)value);
+        }
+        break;
+
       }
     }
 
@@ -214706,6 +215646,9 @@ public java.lang.Object getFieldValue(_Fields field) {
       case O1:
         return getO1();
 
+      case O2:
+        return getO2();
+
       }
       throw new java.lang.IllegalStateException();
     }
@@ -214719,6 +215662,8 @@ public boolean isSet(_Fields field) {
       switch (field) {
       case O1:
         return isSetO1();
+      case O2:
+        return isSetO2();
       }
       throw new java.lang.IllegalStateException();
     }
@@ -214727,12 +215672,12 @@ public boolean isSet(_Fields field) {
     public boolean equals(java.lang.Object that) {
       if (that == null)
         return false;
-      if (that instanceof abort_txns_result)
-        return this.equals((abort_txns_result)that);
+      if (that instanceof commit_txn_result)
+        return this.equals((commit_txn_result)that);
       return false;
     }
 
-    public boolean equals(abort_txns_result that) {
+    public boolean equals(commit_txn_result that) {
       if (that == null)
         return false;
       if (this == that)
@@ -214747,6 +215692,15 @@ public boolean equals(abort_txns_result that) {
           return false;
       }
 
+      boolean this_present_o2 = true && this.isSetO2();
+      boolean that_present_o2 = true && that.isSetO2();
+      if (this_present_o2 || that_present_o2) {
+        if (!(this_present_o2 && that_present_o2))
+          return false;
+        if (!this.o2.equals(that.o2))
+          return false;
+      }
+
       return true;
     }
 
@@ -214758,11 +215712,15 @@ public int hashCode() {
       if (isSetO1())
         hashCode = hashCode * 8191 + o1.hashCode();
 
+      hashCode = hashCode * 8191 + ((isSetO2()) ? 131071 : 524287);
+      if (isSetO2())
+        hashCode = hashCode * 8191 + o2.hashCode();
+
       return hashCode;
     }
 
     @Override
-    public int compareTo(abort_txns_result other) {
+    public int compareTo(commit_txn_result other) {
       if (!getClass().equals(other.getClass())) {
         return getClass().getName().compareTo(other.getClass().getName());
       }
@@ -214779,6 +215737,16 @@ public int compareTo(abort_txns_result other) {
           return lastComparison;
         }
       }
+      lastComparison = java.lang.Boolean.valueOf(isSetO2()).compareTo(other.isSetO2());
+      if (lastComparison != 0) {
+        return lastComparison;
+      }
+      if (isSetO2()) {
+        lastComparison = org.apache.thrift.TBaseHelper.compareTo(this.o2, other.o2);
+        if (lastComparison != 0) {
+          return lastComparison;
+        }
+      }
       return 0;
     }
 
@@ -214797,7 +215765,7 @@ public void write(org.apache.thrift.protocol.TProtocol oprot) throws org.apache.
 
     @Override
     public java.lang.String toString() {
-      java.lang.StringBuilder sb = new java.lang.StringBuilder("abort_txns_result(");
+      java.lang.StringBuilder sb = new java.lang.StringBuilder("commit_txn_result(");
       boolean first = true;
 
       sb.append("o1:");
@@ -214807,6 +215775,14 @@ public java.lang.String toString() {
         sb.append(this.o1);
       }
       first = false;
+      if (!first) sb.append(", ");
+      sb.append("o2:");
+      if (this.o2 == null) {
+        sb.append("null");
+      } else {
+        sb.append(this.o2);
+      }
+      first = false;
       sb.append(")");
       return sb.toString();
     }
@@ -214832,15 +215808,15 @@ private void readObject(java.io.ObjectInputStream in) throws java.io.IOException
       }
     }
 
-    private static class abort_txns_resultStandardSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
-      public abort_txns_resultStandardScheme getScheme() {
-        return new abort_txns_resultStandardScheme();
+    private static class commit_txn_resultStandardSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
+      public commit_txn_resultStandardScheme getScheme() {
+        return new commit_txn_resultStandardScheme();
       }
     }
 
-    private static class abort_txns_resultStandardScheme extends org.apache.thrift.scheme.StandardScheme<abort_txns_result> {
+    private static class commit_txn_resultStandardScheme extends org.apache.thrift.scheme.StandardScheme<commit_txn_result> {
 
-      public void read(org.apache.thrift.protocol.TProtocol iprot, abort_txns_result struct) throws org.apache.thrift.TException {
+      public void read(org.apache.thrift.protocol.TProtocol iprot, commit_txn_result struct) throws org.apache.thrift.TException {
         org.apache.thrift.protocol.TField schemeField;
         iprot.readStructBegin();
         while (true)
@@ -214859,6 +215835,15 @@ public void read(org.apache.thrift.protocol.TProtocol iprot, abort_txns_result s
                 org.apache.thrift.protocol.TProtocolUtil.skip(iprot, schemeField.type);
               }
               break;
+            case 2: // O2
+              if (schemeField.type == org.apache.thrift.protocol.TType.STRUCT) {
+                struct.o2 = new TxnAbortedException();
+                struct.o2.read(iprot);
+                struct.setO2IsSet(true);
+              } else { 
+                org.apache.thrift.protocol.TProtocolUtil.skip(iprot, schemeField.type);
+              }
+              break;
             default:
               org.apache.thrift.protocol.TProtocolUtil.skip(iprot, schemeField.type);
           }
@@ -214868,7 +215853,7 @@ public void read(org.apache.thrift.protocol.TProtocol iprot, abort_txns_result s
         struct.validate();
       }
 
-      public void write(org.apache.thrift.protocol.TProtocol oprot, abort_txns_result struct) throws org.apache.thrift.TException {
+      public void write(org.apache.thrift.protocol.TProtocol oprot, commit_txn_result struct) throws org.apache.thrift.TException {
         struct.validate();
 
         oprot.writeStructBegin(STRUCT_DESC);
@@ -214877,42 +215862,58 @@ public void write(org.apache.thrift.protocol.TProtocol oprot, abort_txns_result
           struct.o1.write(oprot);
           oprot.writeFieldEnd();
         }
+        if (struct.o2 != null) {
+          oprot.writeFieldBegin(O2_FIELD_DESC);
+          struct.o2.write(oprot);
+          oprot.writeFieldEnd();
+        }
         oprot.writeFieldStop();
         oprot.writeStructEnd();
       }
 
     }
 
-    private static class abort_txns_resultTupleSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
-      public abort_txns_resultTupleScheme getScheme() {
-        return new abort_txns_resultTupleScheme();
+    private static class commit_txn_resultTupleSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
+      public commit_txn_resultTupleScheme getScheme() {
+        return new commit_txn_resultTupleScheme();
       }
     }
 
-    private static class abort_txns_resultTupleScheme extends org.apache.thrift.scheme.TupleScheme<abort_txns_result> {
+    private static class commit_txn_resultTupleScheme extends org.apache.thrift.scheme.TupleScheme<commit_txn_result> {
 
       @Override
-      public void write(org.apache.thrift.protocol.TProtocol prot, abort_txns_result struct) throws org.apache.thrift.TException {
+      public void write(org.apache.thrift.protocol.TProtocol prot, commit_txn_result struct) throws org.apache.thrift.TException {
         org.apache.thrift.protocol.TTupleProtocol oprot = (org.apache.thrift.protocol.TTupleProtocol) prot;
         java.util.BitSet optionals = new java.util.BitSet();
         if (struct.isSetO1()) {
           optionals.set(0);
         }
-        oprot.writeBitSet(optionals, 1);
+        if (struct.isSetO2()) {
+          optionals.set(1);
+        }
+        oprot.writeBitSet(optionals, 2);
         if (struct.isSetO1()) {
           struct.o1.write(oprot);
         }
+        if (struct.isSetO2()) {
+          struct.o2.write(oprot);
+        }
       }
 
       @Override
-      public void read(org.apache.thrift.protocol.TProtocol prot, abort_txns_result struct) throws org.apache.thrift.TException {
+      public void read(org.apache.thrift.protocol.TProtocol prot, commit_txn_result struct) throws org.apache.thrift.TException {
         org.apache.thrift.protocol.TTupleProtocol iprot = (org.apache.thrift.protocol.TTupleProtocol) prot;
-        java.util.BitSet incoming = iprot.readBitSet(1);
+        java.util.BitSet incoming = iprot.readBitSet(2);
         if (incoming.get(0)) {
           struct.o1 = new NoSuchTxnException();
           struct.o1.read(iprot);
           struct.setO1IsSet(true);
         }
+        if (incoming.get(1)) {
+          struct.o2 = new TxnAbortedException();
+          struct.o2.read(iprot);
+          struct.setO2IsSet(true);
+        }
       }
     }
 
@@ -214921,19 +215922,19 @@ private static <S extends org.apache.thrift.scheme.IScheme> S scheme(org.apache.
     }
   }
 
-  @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class commit_txn_args implements org.apache.thrift.TBase<commit_txn_args, commit_txn_args._Fields>, java.io.Serializable, Cloneable, Comparable<commit_txn_args>   {
-    private static final org.apache.thrift.protocol.TStruct STRUCT_DESC = new org.apache.thrift.protocol.TStruct("commit_txn_args");
+  @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_latest_txn_in_conflict_args implements org.apache.thrift.TBase<get_latest_txn_in_conflict_args, get_latest_txn_in_conflict_args._Fields>, java.io.Serializable, Cloneable, Comparable<get_latest_txn_in_conflict_args>   {
+    private static final org.apache.thrift.protocol.TStruct STRUCT_DESC = new org.apache.thrift.protocol.TStruct("get_latest_txn_in_conflict_args");
 
-    private static final org.apache.thrift.protocol.TField RQST_FIELD_DESC = new org.apache.thrift.protocol.TField("rqst", org.apache.thrift.protocol.TType.STRUCT, (short)1);
+    private static final org.apache.thrift.protocol.TField TXN_ID_FIELD_DESC = new org.apache.thrift.protocol.TField("txnId", org.apache.thrift.protocol.TType.I64, (short)1);
 
-    private static final org.apache.thrift.scheme.SchemeFactory STANDARD_SCHEME_FACTORY = new commit_txn_argsStandardSchemeFactory();
-    private static final org.apache.thrift.scheme.SchemeFactory TUPLE_SCHEME_FACTORY = new commit_txn_argsTupleSchemeFactory();
+    private static final org.apache.thrift.scheme.SchemeFactory STANDARD_SCHEME_FACTORY = new get_latest_txn_in_conflict_argsStandardSchemeFactory();
+    private static final org.apache.thrift.scheme.SchemeFactory TUPLE_SCHEME_FACTORY = new get_latest_txn_in_conflict_argsTupleSchemeFactory();
 
-    private @org.apache.thrift.annotation.Nullable CommitTxnRequest rqst; // required
+    private long txnId; // required
 
     /** The set of fields this struct contains, along with convenience methods for finding and manipulating them. */
     public enum _Fields implements org.apache.thrift.TFieldIdEnum {
-      RQST((short)1, "rqst");
+      TXN_ID((short)1, "txnId");
 
       private static final java.util.Map<java.lang.String, _Fields> byName = new java.util.HashMap<java.lang.String, _Fields>();
 
@@ -214949,8 +215950,8 @@ public enum _Fields implements org.apache.thrift.TFieldIdEnum {
       @org.apache.thrift.annotation.Nullable
       public static _Fields findByThriftId(int fieldId) {
         switch(fieldId) {
-          case 1: // RQST
-            return RQST;
+          case 1: // TXN_ID
+            return TXN_ID;
           default:
             return null;
         }
@@ -214992,74 +215993,75 @@ public java.lang.String getFieldName() {
     }
 
     // isset id assignments
+    private static final int __TXNID_ISSET_ID = 0;
+    private byte __isset_bitfield = 0;
     public static final java.util.Map<_Fields, org.apache.thrift.meta_data.FieldMetaData> metaDataMap;
     static {
       java.util.Map<_Fields, org.apache.thrift.meta_data.FieldMetaData> tmpMap = new java.util.EnumMap<_Fields, org.apache.thrift.meta_data.FieldMetaData>(_Fields.class);
-      tmpMap.put(_Fields.RQST, new org.apache.thrift.meta_data.FieldMetaData("rqst", org.apache.thrift.TFieldRequirementType.DEFAULT, 
-          new org.apache.thrift.meta_data.StructMetaData(org.apache.thrift.protocol.TType.STRUCT, CommitTxnRequest.class)));
+      tmpMap.put(_Fields.TXN_ID, new org.apache.thrift.meta_data.FieldMetaData("txnId", org.apache.thrift.TFieldRequirementType.DEFAULT, 
+          new org.apache.thrift.meta_data.FieldValueMetaData(org.apache.thrift.protocol.TType.I64)));
       metaDataMap = java.util.Collections.unmodifiableMap(tmpMap);
-      org.apache.thrift.meta_data.FieldMetaData.addStructMetaDataMap(commit_txn_args.class, metaDataMap);
+      org.apache.thrift.meta_data.FieldMetaData.addStructMetaDataMap(get_latest_txn_in_conflict_args.class, metaDataMap);
     }
 
-    public commit_txn_args() {
+    public get_latest_txn_in_conflict_args() {
     }
 
-    public commit_txn_args(
-      CommitTxnRequest rqst)
+    public get_latest_txn_in_conflict_args(
+      long txnId)
     {
       this();
-      this.rqst = rqst;
+      this.txnId = txnId;
+      setTxnIdIsSet(true);
     }
 
     /**
      * Performs a deep copy on <i>other</i>.
      */
-    public commit_txn_args(commit_txn_args other) {
-      if (other.isSetRqst()) {
-        this.rqst = new CommitTxnRequest(other.rqst);
-      }
+    public get_latest_txn_in_conflict_args(get_latest_txn_in_conflict_args other) {
+      __isset_bitfield = other.__isset_bitfield;
+      this.txnId = other.txnId;
     }
 
-    public commit_txn_args deepCopy() {
-      return new commit_txn_args(this);
+    public get_latest_txn_in_conflict_args deepCopy() {
+      return new get_latest_txn_in_conflict_args(this);
     }
 
     @Override
     public void clear() {
-      this.rqst = null;
+      setTxnIdIsSet(false);
+      this.txnId = 0;
     }
 
-    @org.apache.thrift.annotation.Nullable
-    public CommitTxnRequest getRqst() {
-      return this.rqst;
+    public long getTxnId() {
+      return this.txnId;
     }
 
-    public void setRqst(@org.apache.thrift.annotation.Nullable CommitTxnRequest rqst) {
-      this.rqst = rqst;
+    public void setTxnId(long txnId) {
+      this.txnId = txnId;
+      setTxnIdIsSet(true);
     }
 
-    public void unsetRqst() {
-      this.rqst = null;
+    public void unsetTxnId() {
+      __isset_bitfield = org.apache.thrift.EncodingUtils.clearBit(__isset_bitfield, __TXNID_ISSET_ID);
     }
 
-    /** Returns true if field rqst is set (has been assigned a value) and false otherwise */
-    public boolean isSetRqst() {
-      return this.rqst != null;
+    /** Returns true if field txnId is set (has been assigned a value) and false otherwise */
+    public boolean isSetTxnId() {
+      return org.apache.thrift.EncodingUtils.testBit(__isset_bitfield, __TXNID_ISSET_ID);
     }
 
-    public void setRqstIsSet(boolean value) {
-      if (!value) {
-        this.rqst = null;
-      }
+    public void setTxnIdIsSet(boolean value) {
+      __isset_bitfield = org.apache.thrift.EncodingUtils.setBit(__isset_bitfield, __TXNID_ISSET_ID, value);
     }
 
     public void setFieldValue(_Fields field, @org.apache.thrift.annotation.Nullable java.lang.Object value) {
       switch (field) {
-      case RQST:
+      case TXN_ID:
         if (value == null) {
-          unsetRqst();
+          unsetTxnId();
         } else {
-          setRqst((CommitTxnRequest)value);
+          setTxnId((java.lang.Long)value);
         }
         break;
 
@@ -215069,8 +216071,8 @@ public void setFieldValue(_Fields field, @org.apache.thrift.annotation.Nullable
     @org.apache.thrift.annotation.Nullable
     public java.lang.Object getFieldValue(_Fields field) {
       switch (field) {
-      case RQST:
-        return getRqst();
+      case TXN_ID:
+        return getTxnId();
 
       }
       throw new java.lang.IllegalStateException();
@@ -215083,8 +216085,8 @@ public boolean isSet(_Fields field) {
       }
 
       switch (field) {
-      case RQST:
-        return isSetRqst();
+      case TXN_ID:
+        return isSetTxnId();
       }
       throw new java.lang.IllegalStateException();
     }
@@ -215093,23 +216095,23 @@ public boolean isSet(_Fields field) {
     public boolean equals(java.lang.Object that) {
       if (that == null)
         return false;
-      if (that instanceof commit_txn_args)
-        return this.equals((commit_txn_args)that);
+      if (that instanceof get_latest_txn_in_conflict_args)
+        return this.equals((get_latest_txn_in_conflict_args)that);
       return false;
     }
 
-    public boolean equals(commit_txn_args that) {
+    public boolean equals(get_latest_txn_in_conflict_args that) {
       if (that == null)
         return false;
       if (this == that)
         return true;
 
-      boolean this_present_rqst = true && this.isSetRqst();
-      boolean that_present_rqst = true && that.isSetRqst();
-      if (this_present_rqst || that_present_rqst) {
-        if (!(this_present_rqst && that_present_rqst))
+      boolean this_present_txnId = true;
+      boolean that_present_txnId = true;
+      if (this_present_txnId || that_present_txnId) {
+        if (!(this_present_txnId && that_present_txnId))
           return false;
-        if (!this.rqst.equals(that.rqst))
+        if (this.txnId != that.txnId)
           return false;
       }
 
@@ -215120,27 +216122,25 @@ public boolean equals(commit_txn_args that) {
     public int hashCode() {
       int hashCode = 1;
 
-      hashCode = hashCode * 8191 + ((isSetRqst()) ? 131071 : 524287);
-      if (isSetRqst())
-        hashCode = hashCode * 8191 + rqst.hashCode();
+      hashCode = hashCode * 8191 + org.apache.thrift.TBaseHelper.hashCode(txnId);
 
       return hashCode;
     }
 
     @Override
-    public int compareTo(commit_txn_args other) {
+    public int compareTo(get_latest_txn_in_conflict_args other) {
       if (!getClass().equals(other.getClass())) {
         return getClass().getName().compareTo(other.getClass().getName());
       }
 
       int lastComparison = 0;
 
-      lastComparison = java.lang.Boolean.valueOf(isSetRqst()).compareTo(other.isSetRqst());
+      lastComparison = java.lang.Boolean.valueOf(isSetTxnId()).compareTo(other.isSetTxnId());
       if (lastComparison != 0) {
         return lastComparison;
       }
-      if (isSetRqst()) {
-        lastComparison = org.apache.thrift.TBaseHelper.compareTo(this.rqst, other.rqst);
+      if (isSetTxnId()) {
+        lastComparison = org.apache.thrift.TBaseHelper.compareTo(this.txnId, other.txnId);
         if (lastComparison != 0) {
           return lastComparison;
         }
@@ -215163,15 +216163,11 @@ public void write(org.apache.thrift.protocol.TProtocol oprot) throws org.apache.
 
     @Override
     public java.lang.String toString() {
-      java.lang.StringBuilder sb = new java.lang.StringBuilder("commit_txn_args(");
+      java.lang.StringBuilder sb = new java.lang.StringBuilder("get_latest_txn_in_conflict_args(");
       boolean first = true;
 
-      sb.append("rqst:");
-      if (this.rqst == null) {
-        sb.append("null");
-      } else {
-        sb.append(this.rqst);
-      }
+      sb.append("txnId:");
+      sb.append(this.txnId);
       first = false;
       sb.append(")");
       return sb.toString();
@@ -215180,9 +216176,6 @@ public java.lang.String toString() {
     public void validate() throws org.apache.thrift.TException {
       // check for required fields
       // check for sub-struct validity
-      if (rqst != null) {
-        rqst.validate();
-      }
     }
 
     private void writeObject(java.io.ObjectOutputStream out) throws java.io.IOException {
@@ -215195,21 +216188,23 @@ private void writeObject(java.io.ObjectOutputStream out) throws java.io.IOExcept
 
     private void readObject(java.io.ObjectInputStream in) throws java.io.IOException, java.lang.ClassNotFoundException {
       try {
+        // it doesn't seem like you should have to do this, but java serialization is wacky, and doesn't call the default constructor.
+        __isset_bitfield = 0;
         read(new org.apache.thrift.protocol.TCompactProtocol(new org.apache.thrift.transport.TIOStreamTransport(in)));
       } catch (org.apache.thrift.TException te) {
         throw new java.io.IOException(te);
       }
     }
 
-    private static class commit_txn_argsStandardSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
-      public commit_txn_argsStandardScheme getScheme() {
-        return new commit_txn_argsStandardScheme();
+    private static class get_latest_txn_in_conflict_argsStandardSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
+      public get_latest_txn_in_conflict_argsStandardScheme getScheme() {
+        return new get_latest_txn_in_conflict_argsStandardScheme();
       }
     }
 
-    private static class commit_txn_argsStandardScheme extends org.apache.thrift.scheme.StandardScheme<commit_txn_args> {
+    private static class get_latest_txn_in_conflict_argsStandardScheme extends org.apache.thrift.scheme.StandardScheme<get_latest_txn_in_conflict_args> {
 
-      public void read(org.apache.thrift.protocol.TProtocol iprot, commit_txn_args struct) throws org.apache.thrift.TException {
+      public void read(org.apache.thrift.protocol.TProtocol iprot, get_latest_txn_in_conflict_args struct) throws org.apache.thrift.TException {
         org.apache.thrift.protocol.TField schemeField;
         iprot.readStructBegin();
         while (true)
@@ -215219,11 +216214,10 @@ public void read(org.apache.thrift.protocol.TProtocol iprot, commit_txn_args str
             break;
           }
           switch (schemeField.id) {
-            case 1: // RQST
-              if (schemeField.type == org.apache.thrift.protocol.TType.STRUCT) {
-                struct.rqst = new CommitTxnRequest();
-                struct.rqst.read(iprot);
-                struct.setRqstIsSet(true);
+            case 1: // TXN_ID
+              if (schemeField.type == org.apache.thrift.protocol.TType.I64) {
+                struct.txnId = iprot.readI64();
+                struct.setTxnIdIsSet(true);
               } else { 
                 org.apache.thrift.protocol.TProtocolUtil.skip(iprot, schemeField.type);
               }
@@ -215237,50 +216231,47 @@ public void read(org.apache.thrift.protocol.TProtocol iprot, commit_txn_args str
         struct.validate();
       }
 
-      public void write(org.apache.thrift.protocol.TProtocol oprot, commit_txn_args struct) throws org.apache.thrift.TException {
+      public void write(org.apache.thrift.protocol.TProtocol oprot, get_latest_txn_in_conflict_args struct) throws org.apache.thrift.TException {
         struct.validate();
 
         oprot.writeStructBegin(STRUCT_DESC);
-        if (struct.rqst != null) {
-          oprot.writeFieldBegin(RQST_FIELD_DESC);
-          struct.rqst.write(oprot);
-          oprot.writeFieldEnd();
-        }
+        oprot.writeFieldBegin(TXN_ID_FIELD_DESC);
+        oprot.writeI64(struct.txnId);
+        oprot.writeFieldEnd();
         oprot.writeFieldStop();
         oprot.writeStructEnd();
       }
 
     }
 
-    private static class commit_txn_argsTupleSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
-      public commit_txn_argsTupleScheme getScheme() {
-        return new commit_txn_argsTupleScheme();
+    private static class get_latest_txn_in_conflict_argsTupleSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
+      public get_latest_txn_in_conflict_argsTupleScheme getScheme() {
+        return new get_latest_txn_in_conflict_argsTupleScheme();
       }
     }
 
-    private static class commit_txn_argsTupleScheme extends org.apache.thrift.scheme.TupleScheme<commit_txn_args> {
+    private static class get_latest_txn_in_conflict_argsTupleScheme extends org.apache.thrift.scheme.TupleScheme<get_latest_txn_in_conflict_args> {
 
       @Override
-      public void write(org.apache.thrift.protocol.TProtocol prot, commit_txn_args struct) throws org.apache.thrift.TException {
+      public void write(org.apache.thrift.protocol.TProtocol prot, get_latest_txn_in_conflict_args struct) throws org.apache.thrift.TException {
         org.apache.thrift.protocol.TTupleProtocol oprot = (org.apache.thrift.protocol.TTupleProtocol) prot;
         java.util.BitSet optionals = new java.util.BitSet();
-        if (struct.isSetRqst()) {
+        if (struct.isSetTxnId()) {
           optionals.set(0);
         }
         oprot.writeBitSet(optionals, 1);
-        if (struct.isSetRqst()) {
-          struct.rqst.write(oprot);
+        if (struct.isSetTxnId()) {
+          oprot.writeI64(struct.txnId);
         }
       }
 
       @Override
-      public void read(org.apache.thrift.protocol.TProtocol prot, commit_txn_args struct) throws org.apache.thrift.TException {
+      public void read(org.apache.thrift.protocol.TProtocol prot, get_latest_txn_in_conflict_args struct) throws org.apache.thrift.TException {
         org.apache.thrift.protocol.TTupleProtocol iprot = (org.apache.thrift.protocol.TTupleProtocol) prot;
         java.util.BitSet incoming = iprot.readBitSet(1);
         if (incoming.get(0)) {
-          struct.rqst = new CommitTxnRequest();
-          struct.rqst.read(iprot);
-          struct.setRqstIsSet(true);
+          struct.txnId = iprot.readI64();
+          struct.setTxnIdIsSet(true);
         }
       }
     }
@@ -215290,22 +216281,22 @@ private static <S extends org.apache.thrift.scheme.IScheme> S scheme(org.apache.
     }
   }
 
-  @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class commit_txn_result implements org.apache.thrift.TBase<commit_txn_result, commit_txn_result._Fields>, java.io.Serializable, Cloneable, Comparable<commit_txn_result>   {
-    private static final org.apache.thrift.protocol.TStruct STRUCT_DESC = new org.apache.thrift.protocol.TStruct("commit_txn_result");
+  @org.apache.hadoop.classification.InterfaceAudience.Public @org.apache.hadoop.classification.InterfaceStability.Stable public static class get_latest_txn_in_conflict_result implements org.apache.thrift.TBase<get_latest_txn_in_conflict_result, get_latest_txn_in_conflict_result._Fields>, java.io.Serializable, Cloneable, Comparable<get_latest_txn_in_conflict_result>   {
+    private static final org.apache.thrift.protocol.TStruct STRUCT_DESC = new org.apache.thrift.protocol.TStruct("get_latest_txn_in_conflict_result");
 
+    private static final org.apache.thrift.protocol.TField SUCCESS_FIELD_DESC = new org.apache.thrift.protocol.TField("success", org.apache.thrift.protocol.TType.I64, (short)0);
     private static final org.apache.thrift.protocol.TField O1_FIELD_DESC = new org.apache.thrift.protocol.TField("o1", org.apache.thrift.protocol.TType.STRUCT, (short)1);
-    private static final org.apache.thrift.protocol.TField O2_FIELD_DESC = new org.apache.thrift.protocol.TField("o2", org.apache.thrift.protocol.TType.STRUCT, (short)2);
 
-    private static final org.apache.thrift.scheme.SchemeFactory STANDARD_SCHEME_FACTORY = new commit_txn_resultStandardSchemeFactory();
-    private static final org.apache.thrift.scheme.SchemeFactory TUPLE_SCHEME_FACTORY = new commit_txn_resultTupleSchemeFactory();
+    private static final org.apache.thrift.scheme.SchemeFactory STANDARD_SCHEME_FACTORY = new get_latest_txn_in_conflict_resultStandardSchemeFactory();
+    private static final org.apache.thrift.scheme.SchemeFactory TUPLE_SCHEME_FACTORY = new get_latest_txn_in_conflict_resultTupleSchemeFactory();
 
-    private @org.apache.thrift.annotation.Nullable NoSuchTxnException o1; // required
-    private @org.apache.thrift.annotation.Nullable TxnAbortedException o2; // required
+    private long success; // required
+    private @org.apache.thrift.annotation.Nullable MetaException o1; // required
 
     /** The set of fields this struct contains, along with convenience methods for finding and manipulating them. */
     public enum _Fields implements org.apache.thrift.TFieldIdEnum {
-      O1((short)1, "o1"),
-      O2((short)2, "o2");
+      SUCCESS((short)0, "success"),
+      O1((short)1, "o1");
 
       private static final java.util.Map<java.lang.String, _Fields> byName = new java.util.HashMap<java.lang.String, _Fields>();
 
@@ -215321,10 +216312,10 @@ public enum _Fields implements org.apache.thrift.TFieldIdEnum {
       @org.apache.thrift.annotation.Nullable
       public static _Fields findByThriftId(int fieldId) {
         switch(fieldId) {
+          case 0: // SUCCESS
+            return SUCCESS;
           case 1: // O1
             return O1;
-          case 2: // O2
-            return O2;
           default:
             return null;
         }
@@ -215366,114 +216357,115 @@ public java.lang.String getFieldName() {
     }
 
     // isset id assignments
+    private static final int __SUCCESS_ISSET_ID = 0;
+    private byte __isset_bitfield = 0;
     public static final java.util.Map<_Fields, org.apache.thrift.meta_data.FieldMetaData> metaDataMap;
     static {
       java.util.Map<_Fields, org.apache.thrift.meta_data.FieldMetaData> tmpMap = new java.util.EnumMap<_Fields, org.apache.thrift.meta_data.FieldMetaData>(_Fields.class);
+      tmpMap.put(_Fields.SUCCESS, new org.apache.thrift.meta_data.FieldMetaData("success", org.apache.thrift.TFieldRequirementType.DEFAULT, 
+          new org.apache.thrift.meta_data.FieldValueMetaData(org.apache.thrift.protocol.TType.I64)));
       tmpMap.put(_Fields.O1, new org.apache.thrift.meta_data.FieldMetaData("o1", org.apache.thrift.TFieldRequirementType.DEFAULT, 
-          new org.apache.thrift.meta_data.StructMetaData(org.apache.thrift.protocol.TType.STRUCT, NoSuchTxnException.class)));
-      tmpMap.put(_Fields.O2, new org.apache.thrift.meta_data.FieldMetaData("o2", org.apache.thrift.TFieldRequirementType.DEFAULT, 
-          new org.apache.thrift.meta_data.StructMetaData(org.apache.thrift.protocol.TType.STRUCT, TxnAbortedException.class)));
+          new org.apache.thrift.meta_data.StructMetaData(org.apache.thrift.protocol.TType.STRUCT, MetaException.class)));
       metaDataMap = java.util.Collections.unmodifiableMap(tmpMap);
-      org.apache.thrift.meta_data.FieldMetaData.addStructMetaDataMap(commit_txn_result.class, metaDataMap);
+      org.apache.thrift.meta_data.FieldMetaData.addStructMetaDataMap(get_latest_txn_in_conflict_result.class, metaDataMap);
     }
 
-    public commit_txn_result() {
+    public get_latest_txn_in_conflict_result() {
     }
 
-    public commit_txn_result(
-      NoSuchTxnException o1,
-      TxnAbortedException o2)
+    public get_latest_txn_in_conflict_result(
+      long success,
+      MetaException o1)
     {
       this();
+      this.success = success;
+      setSuccessIsSet(true);
       this.o1 = o1;
-      this.o2 = o2;
     }
 
     /**
      * Performs a deep copy on <i>other</i>.
      */
-    public commit_txn_result(commit_txn_result other) {
+    public get_latest_txn_in_conflict_result(get_latest_txn_in_conflict_result other) {
+      __isset_bitfield = other.__isset_bitfield;
+      this.success = other.success;
       if (other.isSetO1()) {
-        this.o1 = new NoSuchTxnException(other.o1);
-      }
-      if (other.isSetO2()) {
-        this.o2 = new TxnAbortedException(other.o2);
+        this.o1 = new MetaException(other.o1);
       }
     }
 
-    public commit_txn_result deepCopy() {
-      return new commit_txn_result(this);
+    public get_latest_txn_in_conflict_result deepCopy() {
+      return new get_latest_txn_in_conflict_result(this);
     }
 
     @Override
     public void clear() {
+      setSuccessIsSet(false);
+      this.success = 0;
       this.o1 = null;
-      this.o2 = null;
     }
 
-    @org.apache.thrift.annotation.Nullable
-    public NoSuchTxnException getO1() {
-      return this.o1;
+    public long getSuccess() {
+      return this.success;
     }
 
-    public void setO1(@org.apache.thrift.annotation.Nullable NoSuchTxnException o1) {
-      this.o1 = o1;
+    public void setSuccess(long success) {
+      this.success = success;
+      setSuccessIsSet(true);
     }
 
-    public void unsetO1() {
-      this.o1 = null;
+    public void unsetSuccess() {
+      __isset_bitfield = org.apache.thrift.EncodingUtils.clearBit(__isset_bitfield, __SUCCESS_ISSET_ID);
     }
 
-    /** Returns true if field o1 is set (has been assigned a value) and false otherwise */
-    public boolean isSetO1() {
-      return this.o1 != null;
+    /** Returns true if field success is set (has been assigned a value) and false otherwise */
+    public boolean isSetSuccess() {
+      return org.apache.thrift.EncodingUtils.testBit(__isset_bitfield, __SUCCESS_ISSET_ID);
     }
 
-    public void setO1IsSet(boolean value) {
-      if (!value) {
-        this.o1 = null;
-      }
+    public void setSuccessIsSet(boolean value) {
+      __isset_bitfield = org.apache.thrift.EncodingUtils.setBit(__isset_bitfield, __SUCCESS_ISSET_ID, value);
     }
 
     @org.apache.thrift.annotation.Nullable
-    public TxnAbortedException getO2() {
-      return this.o2;
+    public MetaException getO1() {
+      return this.o1;
     }
 
-    public void setO2(@org.apache.thrift.annotation.Nullable TxnAbortedException o2) {
-      this.o2 = o2;
+    public void setO1(@org.apache.thrift.annotation.Nullable MetaException o1) {
+      this.o1 = o1;
     }
 
-    public void unsetO2() {
-      this.o2 = null;
+    public void unsetO1() {
+      this.o1 = null;
     }
 
-    /** Returns true if field o2 is set (has been assigned a value) and false otherwise */
-    public boolean isSetO2() {
-      return this.o2 != null;
+    /** Returns true if field o1 is set (has been assigned a value) and false otherwise */
+    public boolean isSetO1() {
+      return this.o1 != null;
     }
 
-    public void setO2IsSet(boolean value) {
+    public void setO1IsSet(boolean value) {
       if (!value) {
-        this.o2 = null;
+        this.o1 = null;
       }
     }
 
     public void setFieldValue(_Fields field, @org.apache.thrift.annotation.Nullable java.lang.Object value) {
       switch (field) {
-      case O1:
+      case SUCCESS:
         if (value == null) {
-          unsetO1();
+          unsetSuccess();
         } else {
-          setO1((NoSuchTxnException)value);
+          setSuccess((java.lang.Long)value);
         }
         break;
 
-      case O2:
+      case O1:
         if (value == null) {
-          unsetO2();
+          unsetO1();
         } else {
-          setO2((TxnAbortedException)value);
+          setO1((MetaException)value);
         }
         break;
 
@@ -215483,12 +216475,12 @@ public void setFieldValue(_Fields field, @org.apache.thrift.annotation.Nullable
     @org.apache.thrift.annotation.Nullable
     public java.lang.Object getFieldValue(_Fields field) {
       switch (field) {
+      case SUCCESS:
+        return getSuccess();
+
       case O1:
         return getO1();
 
-      case O2:
-        return getO2();
-
       }
       throw new java.lang.IllegalStateException();
     }
@@ -215500,10 +216492,10 @@ public boolean isSet(_Fields field) {
       }
 
       switch (field) {
+      case SUCCESS:
+        return isSetSuccess();
       case O1:
         return isSetO1();
-      case O2:
-        return isSetO2();
       }
       throw new java.lang.IllegalStateException();
     }
@@ -215512,17 +216504,26 @@ public boolean isSet(_Fields field) {
     public boolean equals(java.lang.Object that) {
       if (that == null)
         return false;
-      if (that instanceof commit_txn_result)
-        return this.equals((commit_txn_result)that);
+      if (that instanceof get_latest_txn_in_conflict_result)
+        return this.equals((get_latest_txn_in_conflict_result)that);
       return false;
     }
 
-    public boolean equals(commit_txn_result that) {
+    public boolean equals(get_latest_txn_in_conflict_result that) {
       if (that == null)
         return false;
       if (this == that)
         return true;
 
+      boolean this_present_success = true;
+      boolean that_present_success = true;
+      if (this_present_success || that_present_success) {
+        if (!(this_present_success && that_present_success))
+          return false;
+        if (this.success != that.success)
+          return false;
+      }
+
       boolean this_present_o1 = true && this.isSetO1();
       boolean that_present_o1 = true && that.isSetO1();
       if (this_present_o1 || that_present_o1) {
@@ -215532,15 +216533,6 @@ public boolean equals(commit_txn_result that) {
           return false;
       }
 
-      boolean this_present_o2 = true && this.isSetO2();
-      boolean that_present_o2 = true && that.isSetO2();
-      if (this_present_o2 || that_present_o2) {
-        if (!(this_present_o2 && that_present_o2))
-          return false;
-        if (!this.o2.equals(that.o2))
-          return false;
-      }
-
       return true;
     }
 
@@ -215548,41 +216540,39 @@ public boolean equals(commit_txn_result that) {
     public int hashCode() {
       int hashCode = 1;
 
+      hashCode = hashCode * 8191 + org.apache.thrift.TBaseHelper.hashCode(success);
+
       hashCode = hashCode * 8191 + ((isSetO1()) ? 131071 : 524287);
       if (isSetO1())
         hashCode = hashCode * 8191 + o1.hashCode();
 
-      hashCode = hashCode * 8191 + ((isSetO2()) ? 131071 : 524287);
-      if (isSetO2())
-        hashCode = hashCode * 8191 + o2.hashCode();
-
       return hashCode;
     }
 
     @Override
-    public int compareTo(commit_txn_result other) {
+    public int compareTo(get_latest_txn_in_conflict_result other) {
       if (!getClass().equals(other.getClass())) {
         return getClass().getName().compareTo(other.getClass().getName());
       }
 
       int lastComparison = 0;
 
-      lastComparison = java.lang.Boolean.valueOf(isSetO1()).compareTo(other.isSetO1());
+      lastComparison = java.lang.Boolean.valueOf(isSetSuccess()).compareTo(other.isSetSuccess());
       if (lastComparison != 0) {
         return lastComparison;
       }
-      if (isSetO1()) {
-        lastComparison = org.apache.thrift.TBaseHelper.compareTo(this.o1, other.o1);
+      if (isSetSuccess()) {
+        lastComparison = org.apache.thrift.TBaseHelper.compareTo(this.success, other.success);
         if (lastComparison != 0) {
           return lastComparison;
         }
       }
-      lastComparison = java.lang.Boolean.valueOf(isSetO2()).compareTo(other.isSetO2());
+      lastComparison = java.lang.Boolean.valueOf(isSetO1()).compareTo(other.isSetO1());
       if (lastComparison != 0) {
         return lastComparison;
       }
-      if (isSetO2()) {
-        lastComparison = org.apache.thrift.TBaseHelper.compareTo(this.o2, other.o2);
+      if (isSetO1()) {
+        lastComparison = org.apache.thrift.TBaseHelper.compareTo(this.o1, other.o1);
         if (lastComparison != 0) {
           return lastComparison;
         }
@@ -215605,9 +216595,13 @@ public void write(org.apache.thrift.protocol.TProtocol oprot) throws org.apache.
 
     @Override
     public java.lang.String toString() {
-      java.lang.StringBuilder sb = new java.lang.StringBuilder("commit_txn_result(");
+      java.lang.StringBuilder sb = new java.lang.StringBuilder("get_latest_txn_in_conflict_result(");
       boolean first = true;
 
+      sb.append("success:");
+      sb.append(this.success);
+      first = false;
+      if (!first) sb.append(", ");
       sb.append("o1:");
       if (this.o1 == null) {
         sb.append("null");
@@ -215615,14 +216609,6 @@ public java.lang.String toString() {
         sb.append(this.o1);
       }
       first = false;
-      if (!first) sb.append(", ");
-      sb.append("o2:");
-      if (this.o2 == null) {
-        sb.append("null");
-      } else {
-        sb.append(this.o2);
-      }
-      first = false;
       sb.append(")");
       return sb.toString();
     }
@@ -215642,21 +216628,23 @@ private void writeObject(java.io.ObjectOutputStream out) throws java.io.IOExcept
 
     private void readObject(java.io.ObjectInputStream in) throws java.io.IOException, java.lang.ClassNotFoundException {
       try {
+        // it doesn't seem like you should have to do this, but java serialization is wacky, and doesn't call the default constructor.
+        __isset_bitfield = 0;
         read(new org.apache.thrift.protocol.TCompactProtocol(new org.apache.thrift.transport.TIOStreamTransport(in)));
       } catch (org.apache.thrift.TException te) {
         throw new java.io.IOException(te);
       }
     }
 
-    private static class commit_txn_resultStandardSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
-      public commit_txn_resultStandardScheme getScheme() {
-        return new commit_txn_resultStandardScheme();
+    private static class get_latest_txn_in_conflict_resultStandardSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
+      public get_latest_txn_in_conflict_resultStandardScheme getScheme() {
+        return new get_latest_txn_in_conflict_resultStandardScheme();
       }
     }
 
-    private static class commit_txn_resultStandardScheme extends org.apache.thrift.scheme.StandardScheme<commit_txn_result> {
+    private static class get_latest_txn_in_conflict_resultStandardScheme extends org.apache.thrift.scheme.StandardScheme<get_latest_txn_in_conflict_result> {
 
-      public void read(org.apache.thrift.protocol.TProtocol iprot, commit_txn_result struct) throws org.apache.thrift.TException {
+      public void read(org.apache.thrift.protocol.TProtocol iprot, get_latest_txn_in_conflict_result struct) throws org.apache.thrift.TException {
         org.apache.thrift.protocol.TField schemeField;
         iprot.readStructBegin();
         while (true)
@@ -215666,20 +216654,19 @@ public void read(org.apache.thrift.protocol.TProtocol iprot, commit_txn_result s
             break;
           }
           switch (schemeField.id) {
-            case 1: // O1
-              if (schemeField.type == org.apache.thrift.protocol.TType.STRUCT) {
-                struct.o1 = new NoSuchTxnException();
-                struct.o1.read(iprot);
-                struct.setO1IsSet(true);
+            case 0: // SUCCESS
+              if (schemeField.type == org.apache.thrift.protocol.TType.I64) {
+                struct.success = iprot.readI64();
+                struct.setSuccessIsSet(true);
               } else { 
                 org.apache.thrift.protocol.TProtocolUtil.skip(iprot, schemeField.type);
               }
               break;
-            case 2: // O2
+            case 1: // O1
               if (schemeField.type == org.apache.thrift.protocol.TType.STRUCT) {
-                struct.o2 = new TxnAbortedException();
-                struct.o2.read(iprot);
-                struct.setO2IsSet(true);
+                struct.o1 = new MetaException();
+                struct.o1.read(iprot);
+                struct.setO1IsSet(true);
               } else { 
                 org.apache.thrift.protocol.TProtocolUtil.skip(iprot, schemeField.type);
               }
@@ -215693,66 +216680,65 @@ public void read(org.apache.thrift.protocol.TProtocol iprot, commit_txn_result s
         struct.validate();
       }
 
-      public void write(org.apache.thrift.protocol.TProtocol oprot, commit_txn_result struct) throws org.apache.thrift.TException {
+      public void write(org.apache.thrift.protocol.TProtocol oprot, get_latest_txn_in_conflict_result struct) throws org.apache.thrift.TException {
         struct.validate();
 
         oprot.writeStructBegin(STRUCT_DESC);
+        if (struct.isSetSuccess()) {
+          oprot.writeFieldBegin(SUCCESS_FIELD_DESC);
+          oprot.writeI64(struct.success);
+          oprot.writeFieldEnd();
+        }
         if (struct.o1 != null) {
           oprot.writeFieldBegin(O1_FIELD_DESC);
           struct.o1.write(oprot);
           oprot.writeFieldEnd();
         }
-        if (struct.o2 != null) {
-          oprot.writeFieldBegin(O2_FIELD_DESC);
-          struct.o2.write(oprot);
-          oprot.writeFieldEnd();
-        }
         oprot.writeFieldStop();
         oprot.writeStructEnd();
       }
 
     }
 
-    private static class commit_txn_resultTupleSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
-      public commit_txn_resultTupleScheme getScheme() {
-        return new commit_txn_resultTupleScheme();
+    private static class get_latest_txn_in_conflict_resultTupleSchemeFactory implements org.apache.thrift.scheme.SchemeFactory {
+      public get_latest_txn_in_conflict_resultTupleScheme getScheme() {
+        return new get_latest_txn_in_conflict_resultTupleScheme();
       }
     }
 
-    private static class commit_txn_resultTupleScheme extends org.apache.thrift.scheme.TupleScheme<commit_txn_result> {
+    private static class get_latest_txn_in_conflict_resultTupleScheme extends org.apache.thrift.scheme.TupleScheme<get_latest_txn_in_conflict_result> {
 
       @Override
-      public void write(org.apache.thrift.protocol.TProtocol prot, commit_txn_result struct) throws org.apache.thrift.TException {
+      public void write(org.apache.thrift.protocol.TProtocol prot, get_latest_txn_in_conflict_result struct) throws org.apache.thrift.TException {
         org.apache.thrift.protocol.TTupleProtocol oprot = (org.apache.thrift.protocol.TTupleProtocol) prot;
         java.util.BitSet optionals = new java.util.BitSet();
-        if (struct.isSetO1()) {
+        if (struct.isSetSuccess()) {
           optionals.set(0);
         }
-        if (struct.isSetO2()) {
+        if (struct.isSetO1()) {
           optionals.set(1);
         }
         oprot.writeBitSet(optionals, 2);
+        if (struct.isSetSuccess()) {
+          oprot.writeI64(struct.success);
+        }
         if (struct.isSetO1()) {
           struct.o1.write(oprot);
         }
-        if (struct.isSetO2()) {
-          struct.o2.write(oprot);
-        }
       }
 
       @Override
-      public void read(org.apache.thrift.protocol.TProtocol prot, commit_txn_result struct) throws org.apache.thrift.TException {
+      public void read(org.apache.thrift.protocol.TProtocol prot, get_latest_txn_in_conflict_result struct) throws org.apache.thrift.TException {
         org.apache.thrift.protocol.TTupleProtocol iprot = (org.apache.thrift.protocol.TTupleProtocol) prot;
         java.util.BitSet incoming = iprot.readBitSet(2);
         if (incoming.get(0)) {
-          struct.o1 = new NoSuchTxnException();
-          struct.o1.read(iprot);
-          struct.setO1IsSet(true);
+          struct.success = iprot.readI64();
+          struct.setSuccessIsSet(true);
         }
         if (incoming.get(1)) {
-          struct.o2 = new TxnAbortedException();
-          struct.o2.read(iprot);
-          struct.setO2IsSet(true);
+          struct.o1 = new MetaException();
+          struct.o1.read(iprot);
+          struct.setO1IsSet(true);
         }
       }
     }
diff --git a/standalone-metastore/metastore-common/src/gen/thrift/gen-php/metastore/ThriftHiveMetastoreClient.php b/standalone-metastore/metastore-common/src/gen/thrift/gen-php/metastore/ThriftHiveMetastoreClient.php
index 6c5f70e934..08a2bc0c7b 100644
--- a/standalone-metastore/metastore-common/src/gen/thrift/gen-php/metastore/ThriftHiveMetastoreClient.php
+++ b/standalone-metastore/metastore-common/src/gen/thrift/gen-php/metastore/ThriftHiveMetastoreClient.php
@@ -10932,6 +10932,68 @@ class ThriftHiveMetastoreClient extends \FacebookServiceClient implements \metas
         return;
     }
 
+    public function get_latest_txn_in_conflict($txnId)
+    {
+        $this->send_get_latest_txn_in_conflict($txnId);
+        return $this->recv_get_latest_txn_in_conflict();
+    }
+
+    public function send_get_latest_txn_in_conflict($txnId)
+    {
+        $args = new \metastore\ThriftHiveMetastore_get_latest_txn_in_conflict_args();
+        $args->txnId = $txnId;
+        $bin_accel = ($this->output_ instanceof TBinaryProtocolAccelerated) && function_exists('thrift_protocol_write_binary');
+        if ($bin_accel) {
+            thrift_protocol_write_binary(
+                $this->output_,
+                'get_latest_txn_in_conflict',
+                TMessageType::CALL,
+                $args,
+                $this->seqid_,
+                $this->output_->isStrictWrite()
+            );
+        } else {
+            $this->output_->writeMessageBegin('get_latest_txn_in_conflict', TMessageType::CALL, $this->seqid_);
+            $args->write($this->output_);
+            $this->output_->writeMessageEnd();
+            $this->output_->getTransport()->flush();
+        }
+    }
+
+    public function recv_get_latest_txn_in_conflict()
+    {
+        $bin_accel = ($this->input_ instanceof TBinaryProtocolAccelerated) && function_exists('thrift_protocol_read_binary');
+        if ($bin_accel) {
+            $result = thrift_protocol_read_binary(
+                $this->input_,
+                '\metastore\ThriftHiveMetastore_get_latest_txn_in_conflict_result',
+                $this->input_->isStrictRead()
+            );
+        } else {
+            $rseqid = 0;
+            $fname = null;
+            $mtype = 0;
+
+            $this->input_->readMessageBegin($fname, $mtype, $rseqid);
+            if ($mtype == TMessageType::EXCEPTION) {
+                $x = new TApplicationException();
+                $x->read($this->input_);
+                $this->input_->readMessageEnd();
+                throw $x;
+            }
+            $result = new \metastore\ThriftHiveMetastore_get_latest_txn_in_conflict_result();
+            $result->read($this->input_);
+            $this->input_->readMessageEnd();
+        }
+        if ($result->success !== null) {
+            return $result->success;
+        }
+        if ($result->o1 !== null) {
+            throw $result->o1;
+        }
+        throw new \Exception("get_latest_txn_in_conflict failed: unknown result");
+    }
+
     public function repl_tbl_writeid_state(\metastore\ReplTblWriteIdStateRequest $rqst)
     {
         $this->send_repl_tbl_writeid_state($rqst);
diff --git a/standalone-metastore/metastore-common/src/gen/thrift/gen-php/metastore/ThriftHiveMetastoreIf.php b/standalone-metastore/metastore-common/src/gen/thrift/gen-php/metastore/ThriftHiveMetastoreIf.php
index 6a63112c77..ba54493859 100644
--- a/standalone-metastore/metastore-common/src/gen/thrift/gen-php/metastore/ThriftHiveMetastoreIf.php
+++ b/standalone-metastore/metastore-common/src/gen/thrift/gen-php/metastore/ThriftHiveMetastoreIf.php
@@ -1317,6 +1317,12 @@ interface ThriftHiveMetastoreIf extends \FacebookServiceIf
      * @throws \metastore\TxnAbortedException
      */
     public function commit_txn(\metastore\CommitTxnRequest $rqst);
+    /**
+     * @param int $txnId
+     * @return int
+     * @throws \metastore\MetaException
+     */
+    public function get_latest_txn_in_conflict($txnId);
     /**
      * @param \metastore\ReplTblWriteIdStateRequest $rqst
      */
diff --git a/standalone-metastore/metastore-common/src/gen/thrift/gen-php/metastore/ThriftHiveMetastore_get_latest_txn_in_conflict_args.php b/standalone-metastore/metastore-common/src/gen/thrift/gen-php/metastore/ThriftHiveMetastore_get_latest_txn_in_conflict_args.php
new file mode 100644
index 0000000000..e3fe2de796
--- /dev/null
+++ b/standalone-metastore/metastore-common/src/gen/thrift/gen-php/metastore/ThriftHiveMetastore_get_latest_txn_in_conflict_args.php
@@ -0,0 +1,94 @@
+<?php
+namespace metastore;
+
+/**
+ * Autogenerated by Thrift Compiler (0.13.0)
+ *
+ * DO NOT EDIT UNLESS YOU ARE SURE THAT YOU KNOW WHAT YOU ARE DOING
+ *  @generated
+ */
+use Thrift\Base\TBase;
+use Thrift\Type\TType;
+use Thrift\Type\TMessageType;
+use Thrift\Exception\TException;
+use Thrift\Exception\TProtocolException;
+use Thrift\Protocol\TProtocol;
+use Thrift\Protocol\TBinaryProtocolAccelerated;
+use Thrift\Exception\TApplicationException;
+
+class ThriftHiveMetastore_get_latest_txn_in_conflict_args
+{
+    static public $isValidate = false;
+
+    static public $_TSPEC = array(
+        1 => array(
+            'var' => 'txnId',
+            'isRequired' => false,
+            'type' => TType::I64,
+        ),
+    );
+
+    /**
+     * @var int
+     */
+    public $txnId = null;
+
+    public function __construct($vals = null)
+    {
+        if (is_array($vals)) {
+            if (isset($vals['txnId'])) {
+                $this->txnId = $vals['txnId'];
+            }
+        }
+    }
+
+    public function getName()
+    {
+        return 'ThriftHiveMetastore_get_latest_txn_in_conflict_args';
+    }
+
+
+    public function read($input)
+    {
+        $xfer = 0;
+        $fname = null;
+        $ftype = 0;
+        $fid = 0;
+        $xfer += $input->readStructBegin($fname);
+        while (true) {
+            $xfer += $input->readFieldBegin($fname, $ftype, $fid);
+            if ($ftype == TType::STOP) {
+                break;
+            }
+            switch ($fid) {
+                case 1:
+                    if ($ftype == TType::I64) {
+                        $xfer += $input->readI64($this->txnId);
+                    } else {
+                        $xfer += $input->skip($ftype);
+                    }
+                    break;
+                default:
+                    $xfer += $input->skip($ftype);
+                    break;
+            }
+            $xfer += $input->readFieldEnd();
+        }
+        $xfer += $input->readStructEnd();
+        return $xfer;
+    }
+
+    public function write($output)
+    {
+        $xfer = 0;
+        $xfer += $output->writeStructBegin('ThriftHiveMetastore_get_latest_txn_in_conflict_args');
+        if ($this->txnId !== null) {
+            $xfer += $output->writeFieldBegin('txnId', TType::I64, 1);
+            $xfer += $output->writeI64($this->txnId);
+            $xfer += $output->writeFieldEnd();
+        }
+        $xfer += $output->writeFieldStop();
+        $xfer += $output->writeStructEnd();
+        return $xfer;
+    }
+}
diff --git a/standalone-metastore/metastore-common/src/gen/thrift/gen-php/metastore/ThriftHiveMetastore_get_latest_txn_in_conflict_result.php b/standalone-metastore/metastore-common/src/gen/thrift/gen-php/metastore/ThriftHiveMetastore_get_latest_txn_in_conflict_result.php
new file mode 100644
index 0000000000..8c0b3cdbe8
--- /dev/null
+++ b/standalone-metastore/metastore-common/src/gen/thrift/gen-php/metastore/ThriftHiveMetastore_get_latest_txn_in_conflict_result.php
@@ -0,0 +1,120 @@
+<?php
+namespace metastore;
+
+/**
+ * Autogenerated by Thrift Compiler (0.13.0)
+ *
+ * DO NOT EDIT UNLESS YOU ARE SURE THAT YOU KNOW WHAT YOU ARE DOING
+ *  @generated
+ */
+use Thrift\Base\TBase;
+use Thrift\Type\TType;
+use Thrift\Type\TMessageType;
+use Thrift\Exception\TException;
+use Thrift\Exception\TProtocolException;
+use Thrift\Protocol\TProtocol;
+use Thrift\Protocol\TBinaryProtocolAccelerated;
+use Thrift\Exception\TApplicationException;
+
+class ThriftHiveMetastore_get_latest_txn_in_conflict_result
+{
+    static public $isValidate = false;
+
+    static public $_TSPEC = array(
+        0 => array(
+            'var' => 'success',
+            'isRequired' => false,
+            'type' => TType::I64,
+        ),
+        1 => array(
+            'var' => 'o1',
+            'isRequired' => false,
+            'type' => TType::STRUCT,
+            'class' => '\metastore\MetaException',
+        ),
+    );
+
+    /**
+     * @var int
+     */
+    public $success = null;
+    /**
+     * @var \metastore\MetaException
+     */
+    public $o1 = null;
+
+    public function __construct($vals = null)
+    {
+        if (is_array($vals)) {
+            if (isset($vals['success'])) {
+                $this->success = $vals['success'];
+            }
+            if (isset($vals['o1'])) {
+                $this->o1 = $vals['o1'];
+            }
+        }
+    }
+
+    public function getName()
+    {
+        return 'ThriftHiveMetastore_get_latest_txn_in_conflict_result';
+    }
+
+
+    public function read($input)
+    {
+        $xfer = 0;
+        $fname = null;
+        $ftype = 0;
+        $fid = 0;
+        $xfer += $input->readStructBegin($fname);
+        while (true) {
+            $xfer += $input->readFieldBegin($fname, $ftype, $fid);
+            if ($ftype == TType::STOP) {
+                break;
+            }
+            switch ($fid) {
+                case 0:
+                    if ($ftype == TType::I64) {
+                        $xfer += $input->readI64($this->success);
+                    } else {
+                        $xfer += $input->skip($ftype);
+                    }
+                    break;
+                case 1:
+                    if ($ftype == TType::STRUCT) {
+                        $this->o1 = new \metastore\MetaException();
+                        $xfer += $this->o1->read($input);
+                    } else {
+                        $xfer += $input->skip($ftype);
+                    }
+                    break;
+                default:
+                    $xfer += $input->skip($ftype);
+                    break;
+            }
+            $xfer += $input->readFieldEnd();
+        }
+        $xfer += $input->readStructEnd();
+        return $xfer;
+    }
+
+    public function write($output)
+    {
+        $xfer = 0;
+        $xfer += $output->writeStructBegin('ThriftHiveMetastore_get_latest_txn_in_conflict_result');
+        if ($this->success !== null) {
+            $xfer += $output->writeFieldBegin('success', TType::I64, 0);
+            $xfer += $output->writeI64($this->success);
+            $xfer += $output->writeFieldEnd();
+        }
+        if ($this->o1 !== null) {
+            $xfer += $output->writeFieldBegin('o1', TType::STRUCT, 1);
+            $xfer += $this->o1->write($output);
+            $xfer += $output->writeFieldEnd();
+        }
+        $xfer += $output->writeFieldStop();
+        $xfer += $output->writeStructEnd();
+        return $xfer;
+    }
+}
diff --git a/standalone-metastore/metastore-common/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore-remote b/standalone-metastore/metastore-common/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore-remote
index cfefce32b7..06b7533855 100755
--- a/standalone-metastore/metastore-common/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore-remote
+++ b/standalone-metastore/metastore-common/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore-remote
@@ -191,6 +191,7 @@ if len(sys.argv) <= 1 or sys.argv[1] == '--help':
     print('  void abort_txn(AbortTxnRequest rqst)')
     print('  void abort_txns(AbortTxnsRequest rqst)')
     print('  void commit_txn(CommitTxnRequest rqst)')
+    print('  i64 get_latest_txn_in_conflict(i64 txnId)')
     print('  void repl_tbl_writeid_state(ReplTblWriteIdStateRequest rqst)')
     print('  GetValidWriteIdsResponse get_valid_write_ids(GetValidWriteIdsRequest rqst)')
     print('  AllocateTableWriteIdsResponse allocate_table_write_ids(AllocateTableWriteIdsRequest rqst)')
@@ -1364,6 +1365,12 @@ elif cmd == 'commit_txn':
         sys.exit(1)
     pp.pprint(client.commit_txn(eval(args[0]),))
 
+elif cmd == 'get_latest_txn_in_conflict':
+    if len(args) != 1:
+        print('get_latest_txn_in_conflict requires 1 args')
+        sys.exit(1)
+    pp.pprint(client.get_latest_txn_in_conflict(eval(args[0]),))
+
 elif cmd == 'repl_tbl_writeid_state':
     if len(args) != 1:
         print('repl_tbl_writeid_state requires 1 args')
diff --git a/standalone-metastore/metastore-common/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore.py b/standalone-metastore/metastore-common/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore.py
index 9a549ece19..21687233de 100644
--- a/standalone-metastore/metastore-common/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore.py
+++ b/standalone-metastore/metastore-common/src/gen/thrift/gen-py/hive_metastore/ThriftHiveMetastore.py
@@ -1488,6 +1488,14 @@ def commit_txn(self, rqst):
         """
         pass
 
+    def get_latest_txn_in_conflict(self, txnId):
+        """
+        Parameters:
+         - txnId
+
+        """
+        pass
+
     def repl_tbl_writeid_state(self, rqst):
         """
         Parameters:
@@ -8350,6 +8358,40 @@ def recv_commit_txn(self):
             raise result.o2
         return
 
+    def get_latest_txn_in_conflict(self, txnId):
+        """
+        Parameters:
+         - txnId
+
+        """
+        self.send_get_latest_txn_in_conflict(txnId)
+        return self.recv_get_latest_txn_in_conflict()
+
+    def send_get_latest_txn_in_conflict(self, txnId):
+        self._oprot.writeMessageBegin('get_latest_txn_in_conflict', TMessageType.CALL, self._seqid)
+        args = get_latest_txn_in_conflict_args()
+        args.txnId = txnId
+        args.write(self._oprot)
+        self._oprot.writeMessageEnd()
+        self._oprot.trans.flush()
+
+    def recv_get_latest_txn_in_conflict(self):
+        iprot = self._iprot
+        (fname, mtype, rseqid) = iprot.readMessageBegin()
+        if mtype == TMessageType.EXCEPTION:
+            x = TApplicationException()
+            x.read(iprot)
+            iprot.readMessageEnd()
+            raise x
+        result = get_latest_txn_in_conflict_result()
+        result.read(iprot)
+        iprot.readMessageEnd()
+        if result.success is not None:
+            return result.success
+        if result.o1 is not None:
+            raise result.o1
+        raise TApplicationException(TApplicationException.MISSING_RESULT, "get_latest_txn_in_conflict failed: unknown result")
+
     def repl_tbl_writeid_state(self, rqst):
         """
         Parameters:
@@ -11233,6 +11275,7 @@ def __init__(self, handler):
         self._processMap["abort_txn"] = Processor.process_abort_txn
         self._processMap["abort_txns"] = Processor.process_abort_txns
         self._processMap["commit_txn"] = Processor.process_commit_txn
+        self._processMap["get_latest_txn_in_conflict"] = Processor.process_get_latest_txn_in_conflict
         self._processMap["repl_tbl_writeid_state"] = Processor.process_repl_tbl_writeid_state
         self._processMap["get_valid_write_ids"] = Processor.process_get_valid_write_ids
         self._processMap["allocate_table_write_ids"] = Processor.process_allocate_table_write_ids
@@ -16183,6 +16226,32 @@ def process_commit_txn(self, seqid, iprot, oprot):
         oprot.writeMessageEnd()
         oprot.trans.flush()
 
+    def process_get_latest_txn_in_conflict(self, seqid, iprot, oprot):
+        args = get_latest_txn_in_conflict_args()
+        args.read(iprot)
+        iprot.readMessageEnd()
+        result = get_latest_txn_in_conflict_result()
+        try:
+            result.success = self._handler.get_latest_txn_in_conflict(args.txnId)
+            msg_type = TMessageType.REPLY
+        except TTransport.TTransportException:
+            raise
+        except MetaException as o1:
+            msg_type = TMessageType.REPLY
+            result.o1 = o1
+        except TApplicationException as ex:
+            logging.exception('TApplication exception in handler')
+            msg_type = TMessageType.EXCEPTION
+            result = ex
+        except Exception:
+            logging.exception('Unexpected exception in handler')
+            msg_type = TMessageType.EXCEPTION
+            result = TApplicationException(TApplicationException.INTERNAL_ERROR, 'Internal error')
+        oprot.writeMessageBegin("get_latest_txn_in_conflict", msg_type, seqid)
+        result.write(oprot)
+        oprot.writeMessageEnd()
+        oprot.trans.flush()
+
     def process_repl_tbl_writeid_state(self, seqid, iprot, oprot):
         args = repl_tbl_writeid_state_args()
         args.read(iprot)
@@ -45511,6 +45580,142 @@ def __ne__(self, other):
 )
 
 
+class get_latest_txn_in_conflict_args(object):
+    """
+    Attributes:
+     - txnId
+
+    """
+
+
+    def __init__(self, txnId=None,):
+        self.txnId = txnId
+
+    def read(self, iprot):
+        if iprot._fast_decode is not None and isinstance(iprot.trans, TTransport.CReadableTransport) and self.thrift_spec is not None:
+            iprot._fast_decode(self, iprot, [self.__class__, self.thrift_spec])
+            return
+        iprot.readStructBegin()
+        while True:
+            (fname, ftype, fid) = iprot.readFieldBegin()
+            if ftype == TType.STOP:
+                break
+            if fid == 1:
+                if ftype == TType.I64:
+                    self.txnId = iprot.readI64()
+                else:
+                    iprot.skip(ftype)
+            else:
+                iprot.skip(ftype)
+            iprot.readFieldEnd()
+        iprot.readStructEnd()
+
+    def write(self, oprot):
+        if oprot._fast_encode is not None and self.thrift_spec is not None:
+            oprot.trans.write(oprot._fast_encode(self, [self.__class__, self.thrift_spec]))
+            return
+        oprot.writeStructBegin('get_latest_txn_in_conflict_args')
+        if self.txnId is not None:
+            oprot.writeFieldBegin('txnId', TType.I64, 1)
+            oprot.writeI64(self.txnId)
+            oprot.writeFieldEnd()
+        oprot.writeFieldStop()
+        oprot.writeStructEnd()
+
+    def validate(self):
+        return
+
+    def __repr__(self):
+        L = ['%s=%r' % (key, value)
+             for key, value in self.__dict__.items()]
+        return '%s(%s)' % (self.__class__.__name__, ', '.join(L))
+
+    def __eq__(self, other):
+        return isinstance(other, self.__class__) and self.__dict__ == other.__dict__
+
+    def __ne__(self, other):
+        return not (self == other)
+all_structs.append(get_latest_txn_in_conflict_args)
+get_latest_txn_in_conflict_args.thrift_spec = (
+    None,  # 0
+    (1, TType.I64, 'txnId', None, None, ),  # 1
+)
+
+
+class get_latest_txn_in_conflict_result(object):
+    """
+    Attributes:
+     - success
+     - o1
+
+    """
+
+
+    def __init__(self, success=None, o1=None,):
+        self.success = success
+        self.o1 = o1
+
+    def read(self, iprot):
+        if iprot._fast_decode is not None and isinstance(iprot.trans, TTransport.CReadableTransport) and self.thrift_spec is not None:
+            iprot._fast_decode(self, iprot, [self.__class__, self.thrift_spec])
+            return
+        iprot.readStructBegin()
+        while True:
+            (fname, ftype, fid) = iprot.readFieldBegin()
+            if ftype == TType.STOP:
+                break
+            if fid == 0:
+                if ftype == TType.I64:
+                    self.success = iprot.readI64()
+                else:
+                    iprot.skip(ftype)
+            elif fid == 1:
+                if ftype == TType.STRUCT:
+                    self.o1 = MetaException()
+                    self.o1.read(iprot)
+                else:
+                    iprot.skip(ftype)
+            else:
+                iprot.skip(ftype)
+            iprot.readFieldEnd()
+        iprot.readStructEnd()
+
+    def write(self, oprot):
+        if oprot._fast_encode is not None and self.thrift_spec is not None:
+            oprot.trans.write(oprot._fast_encode(self, [self.__class__, self.thrift_spec]))
+            return
+        oprot.writeStructBegin('get_latest_txn_in_conflict_result')
+        if self.success is not None:
+            oprot.writeFieldBegin('success', TType.I64, 0)
+            oprot.writeI64(self.success)
+            oprot.writeFieldEnd()
+        if self.o1 is not None:
+            oprot.writeFieldBegin('o1', TType.STRUCT, 1)
+            self.o1.write(oprot)
+            oprot.writeFieldEnd()
+        oprot.writeFieldStop()
+        oprot.writeStructEnd()
+
+    def validate(self):
+        return
+
+    def __repr__(self):
+        L = ['%s=%r' % (key, value)
+             for key, value in self.__dict__.items()]
+        return '%s(%s)' % (self.__class__.__name__, ', '.join(L))
+
+    def __eq__(self, other):
+        return isinstance(other, self.__class__) and self.__dict__ == other.__dict__
+
+    def __ne__(self, other):
+        return not (self == other)
+all_structs.append(get_latest_txn_in_conflict_result)
+get_latest_txn_in_conflict_result.thrift_spec = (
+    (0, TType.I64, 'success', None, None, ),  # 0
+    (1, TType.STRUCT, 'o1', [MetaException, None], None, ),  # 1
+)
+
+
 class repl_tbl_writeid_state_args(object):
     """
     Attributes:
diff --git a/standalone-metastore/metastore-common/src/gen/thrift/gen-rb/thrift_hive_metastore.rb b/standalone-metastore/metastore-common/src/gen/thrift/gen-rb/thrift_hive_metastore.rb
index 5ec5fab7c5..abcc25bb98 100644
--- a/standalone-metastore/metastore-common/src/gen/thrift/gen-rb/thrift_hive_metastore.rb
+++ b/standalone-metastore/metastore-common/src/gen/thrift/gen-rb/thrift_hive_metastore.rb
@@ -2814,6 +2814,22 @@ module ThriftHiveMetastore
       return
     end
 
+    def get_latest_txn_in_conflict(txnId)
+      send_get_latest_txn_in_conflict(txnId)
+      return recv_get_latest_txn_in_conflict()
+    end
+
+    def send_get_latest_txn_in_conflict(txnId)
+      send_message('get_latest_txn_in_conflict', Get_latest_txn_in_conflict_args, :txnId => txnId)
+    end
+
+    def recv_get_latest_txn_in_conflict()
+      result = receive_message(Get_latest_txn_in_conflict_result)
+      return result.success unless result.success.nil?
+      raise result.o1 unless result.o1.nil?
+      raise ::Thrift::ApplicationException.new(::Thrift::ApplicationException::MISSING_RESULT, 'get_latest_txn_in_conflict failed: unknown result')
+    end
+
     def repl_tbl_writeid_state(rqst)
       send_repl_tbl_writeid_state(rqst)
       recv_repl_tbl_writeid_state()
@@ -6254,6 +6270,17 @@ module ThriftHiveMetastore
       write_result(result, oprot, 'commit_txn', seqid)
     end
 
+    def process_get_latest_txn_in_conflict(seqid, iprot, oprot)
+      args = read_args(iprot, Get_latest_txn_in_conflict_args)
+      result = Get_latest_txn_in_conflict_result.new()
+      begin
+        result.success = @handler.get_latest_txn_in_conflict(args.txnId)
+      rescue ::MetaException => o1
+        result.o1 = o1
+      end
+      write_result(result, oprot, 'get_latest_txn_in_conflict', seqid)
+    end
+
     def process_repl_tbl_writeid_state(seqid, iprot, oprot)
       args = read_args(iprot, Repl_tbl_writeid_state_args)
       result = Repl_tbl_writeid_state_result.new()
@@ -13459,6 +13486,40 @@ module ThriftHiveMetastore
     ::Thrift::Struct.generate_accessors self
   end
 
+  class Get_latest_txn_in_conflict_args
+    include ::Thrift::Struct, ::Thrift::Struct_Union
+    TXNID = 1
+
+    FIELDS = {
+      TXNID => {:type => ::Thrift::Types::I64, :name => 'txnId'}
+    }
+
+    def struct_fields; FIELDS; end
+
+    def validate
+    end
+
+    ::Thrift::Struct.generate_accessors self
+  end
+
+  class Get_latest_txn_in_conflict_result
+    include ::Thrift::Struct, ::Thrift::Struct_Union
+    SUCCESS = 0
+    O1 = 1
+
+    FIELDS = {
+      SUCCESS => {:type => ::Thrift::Types::I64, :name => 'success'},
+      O1 => {:type => ::Thrift::Types::STRUCT, :name => 'o1', :class => ::MetaException}
+    }
+
+    def struct_fields; FIELDS; end
+
+    def validate
+    end
+
+    ::Thrift::Struct.generate_accessors self
+  end
+
   class Repl_tbl_writeid_state_args
     include ::Thrift::Struct, ::Thrift::Struct_Union
     RQST = 1
diff --git a/standalone-metastore/metastore-common/src/main/java/org/apache/hadoop/hive/metastore/HiveMetaStoreClient.java b/standalone-metastore/metastore-common/src/main/java/org/apache/hadoop/hive/metastore/HiveMetaStoreClient.java
index 0c62271786..dea55b3142 100644
--- a/standalone-metastore/metastore-common/src/main/java/org/apache/hadoop/hive/metastore/HiveMetaStoreClient.java
+++ b/standalone-metastore/metastore-common/src/main/java/org/apache/hadoop/hive/metastore/HiveMetaStoreClient.java
@@ -3865,6 +3865,11 @@ public void insertTable(Table table, boolean overwrite) throws MetaException {
     }
   }
 
+  @Override
+  public long getLatestTxnInConflict(long txnId) throws TException {
+    return client.get_latest_txn_in_conflict(txnId);
+  }
+
   @InterfaceAudience.LimitedPrivate({"HCatalog"})
   @Override
   public NotificationEventResponse getNextNotification(long lastEventId, int maxEvents,
diff --git a/standalone-metastore/metastore-common/src/main/java/org/apache/hadoop/hive/metastore/IMetaStoreClient.java b/standalone-metastore/metastore-common/src/main/java/org/apache/hadoop/hive/metastore/IMetaStoreClient.java
index 88916f4a1d..f0b831900b 100644
--- a/standalone-metastore/metastore-common/src/main/java/org/apache/hadoop/hive/metastore/IMetaStoreClient.java
+++ b/standalone-metastore/metastore-common/src/main/java/org/apache/hadoop/hive/metastore/IMetaStoreClient.java
@@ -3401,7 +3401,9 @@ void addDynamicPartitions(long txnId, long writeId, String dbName, String tableN
    */
   void insertTable(Table table, boolean overwrite) throws MetaException;
 
-    /**
+  long getLatestTxnInConflict(long txnId) throws TException;
+
+  /**
    * A filter provided by the client that determines if a given notification event should be
    * returned.
    */
diff --git a/standalone-metastore/metastore-common/src/main/thrift/hive_metastore.thrift b/standalone-metastore/metastore-common/src/main/thrift/hive_metastore.thrift
index 03bd45d7c8..cdd6e5ea78 100644
--- a/standalone-metastore/metastore-common/src/main/thrift/hive_metastore.thrift
+++ b/standalone-metastore/metastore-common/src/main/thrift/hive_metastore.thrift
@@ -2681,6 +2681,7 @@ PartitionsResponse get_partitions_req(1:PartitionsRequest req)
   void abort_txn(1:AbortTxnRequest rqst) throws (1:NoSuchTxnException o1)
   void abort_txns(1:AbortTxnsRequest rqst) throws (1:NoSuchTxnException o1)
   void commit_txn(1:CommitTxnRequest rqst) throws (1:NoSuchTxnException o1, 2:TxnAbortedException o2)
+  i64 get_latest_txn_in_conflict(1:i64 txnId) throws (1:MetaException o1)
   void repl_tbl_writeid_state(1: ReplTblWriteIdStateRequest rqst)
   GetValidWriteIdsResponse get_valid_write_ids(1:GetValidWriteIdsRequest rqst)
       throws (1:NoSuchTxnException o1, 2:MetaException o2)
diff --git a/standalone-metastore/metastore-server/src/main/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java b/standalone-metastore/metastore-server/src/main/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java
index ac8486f662..6a8178e58e 100644
--- a/standalone-metastore/metastore-server/src/main/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java
+++ b/standalone-metastore/metastore-server/src/main/java/org/apache/hadoop/hive/metastore/HiveMetaStore.java
@@ -8404,6 +8404,11 @@ public void abort_txns(AbortTxnsRequest rqst) throws TException {
       }
     }
 
+    @Override
+    public long get_latest_txn_in_conflict(long txnId) throws MetaException {
+      return getTxnHandler().getLatestTxnInConflict(txnId);
+    }
+
     @Override
     public void commit_txn(CommitTxnRequest rqst) throws TException {
       // in replication flow, the write notification log table will be updated here.
diff --git a/standalone-metastore/metastore-server/src/main/java/org/apache/hadoop/hive/metastore/txn/TxnHandler.java b/standalone-metastore/metastore-server/src/main/java/org/apache/hadoop/hive/metastore/txn/TxnHandler.java
index f3dc6be12a..896a55435a 100644
--- a/standalone-metastore/metastore-server/src/main/java/org/apache/hadoop/hive/metastore/txn/TxnHandler.java
+++ b/standalone-metastore/metastore-server/src/main/java/org/apache/hadoop/hive/metastore/txn/TxnHandler.java
@@ -253,6 +253,8 @@ abstract class TxnHandler implements TxnStore, TxnStore.MutexAPI {
   private static final String TXN_COMPONENTS_INSERT_QUERY = "INSERT INTO \"TXN_COMPONENTS\" (" +
           "\"TC_TXNID\", \"TC_DATABASE\", \"TC_TABLE\", \"TC_PARTITION\", \"TC_OPERATION_TYPE\", \"TC_WRITEID\")" +
           " VALUES (?, ?, ?, ?, ?, ?)";
+  private static final String TXN_COMPONENTS_DP_DELETE_QUERY = "DELETE FROM \"TXN_COMPONENTS\" " +
+      "WHERE \"TC_TXNID\" = ? AND \"TC_PARTITION\" IS NULL";
   private static final String INCREMENT_NEXT_LOCK_ID_QUERY = "UPDATE \"NEXT_LOCK_ID\" SET \"NL_NEXT\" = %s";
   private static final String UPDATE_HIVE_LOCKS_EXT_ID_QUERY = "UPDATE \"HIVE_LOCKS\" SET \"HL_LOCK_EXT_ID\" = %s WHERE \"HL_LOCK_EXT_ID\" = %s";
   private static final String SELECT_WRITE_ID_QUERY = "SELECT \"T2W_WRITEID\" FROM \"TXN_TO_WRITE_ID\" WHERE"
@@ -1408,6 +1410,51 @@ private boolean isUpdateOrDelete(Statement stmt, String conflictSQLSuffix) throw
     }
   }
 
+  /**
+   * Checks if there are transactions that are overlapping, i.e. conflicting with the current one.
+   * Valid only if the caller txn holds an exclusive lock that prevents other txns to make changes to the same tables/partitions.
+   * Only considers txn performing update/delete and intentionally ignores inserts.
+   * @param txnid
+   * @return max Id for the conflicting transaction, if any, otherwise -1
+   * @throws MetaException
+   */
+  public long getLatestTxnInConflict(long txnid) throws MetaException {
+    Connection dbConn = null;
+    Statement stmt = null;
+
+    try {
+      dbConn = getDbConn(Connection.TRANSACTION_READ_COMMITTED);
+      stmt = dbConn.createStatement();
+
+      String writeConflictQuery = "SELECT MAX(\"COMMITTED\".\"WS_TXNID\")" +
+        " FROM \"WRITE_SET\" \"COMMITTED\" " +
+        "   INNER JOIN (" +
+        "SELECT DISTINCT \"TC_DATABASE\", \"TC_TABLE\", \"TC_PARTITION\", \"TC_TXNID\" " +
+        " FROM \"TXN_COMPONENTS\"  " +
+        "   WHERE \"TC_TXNID\" = " + txnid +
+        "     AND \"TC_OPERATION_TYPE\" IN (" + OperationType.UPDATE + ", " + OperationType.DELETE + ")) \"CUR\" " +
+        "   ON \"COMMITTED\".\"WS_DATABASE\" = \"CUR\".\"TC_DATABASE\" " +
+        "     AND \"COMMITTED\".\"WS_TABLE\" = \"CUR\".\"TC_TABLE\" " +
+        //For partitioned table we always track writes at partition level (never at table)
+        //and for non partitioned - always at table level, thus the same table should never
+        //have entries with partition key and w/o
+        "     AND (\"COMMITTED\".\"WS_PARTITION\" = \"CUR\".\"TC_PARTITION\" OR " +
+        "       \"CUR\".\"TC_PARTITION\" IS NULL) " +
+        " WHERE \"CUR\".\"TC_TXNID\" <= \"COMMITTED\".\"WS_COMMIT_ID\""; //txns overlap
+
+      LOG.debug("Going to execute query: <" + writeConflictQuery + ">");
+      ResultSet rs = stmt.executeQuery(writeConflictQuery);
+      return rs.next() ? rs.getLong(1) : -1;
+
+    } catch (Exception e) {
+      throw new MetaException(StringUtils.stringifyException(e));
+
+    } finally {
+      closeStmt(stmt);
+      closeDbConn(dbConn);
+    }
+  }
+
   private ResultSet checkForWriteConflict(Statement stmt, long txnid) throws SQLException, MetaException {
     String writeConflictQuery = sqlGenerator.addLimitClause(1, "\"COMMITTED\".\"WS_TXNID\", \"COMMITTED\".\"WS_COMMIT_ID\", " +
             "\"COMMITTED\".\"WS_DATABASE\", \"COMMITTED\".\"WS_TABLE\", \"COMMITTED\".\"WS_PARTITION\", " +
@@ -2638,9 +2685,17 @@ private void insertTxnComponents(long txnid, LockRequest rqst, Connection dbConn
           if (!shouldUpdateTxnComponent(txnid, rqst, lc)) {
             continue;
           }
+
           String dbName = normalizeCase(lc.getDbname());
           String tblName = normalizeCase(lc.getTablename());
           String partName = normalizeCase(lc.getPartitionname());
+
+          if (lc.isSetIsDynamicPartitionWrite() && lc.isIsDynamicPartitionWrite()) {
+            partName = null;
+            if (writeIdCache.containsKey(Pair.of(dbName, tblName))) {
+              continue;
+            }
+          }
           Optional<Long> writeId = getWriteId(writeIdCache, dbName, tblName, txnid, dbConn);
 
           pstmt.setLong(1, txnid);
@@ -2707,20 +2762,15 @@ private boolean shouldUpdateTxnComponent(long txnid, LockRequest rqst, LockCompo
     else {
       switch (lc.getOperationType()) {
         case INSERT:
-        case UPDATE:
-        case DELETE:
-          if(!lc.isSetIsDynamicPartitionWrite()) {
-            //must be old client talking, i.e. we don't know if it's DP so be conservative
-            return true;
-          }
-          else {
             /**
              * we know this is part of DP operation and so we'll get
              * {@link #addDynamicPartitions(AddDynamicPartitions)} call with the list
-             * of partitions actually chaged.
+             * of partitions actually changed.
              */
-            return !lc.isIsDynamicPartitionWrite();
-          }
+            return !lc.isSetIsDynamicPartitionWrite() || !lc.isIsDynamicPartitionWrite();
+        case UPDATE:
+        case DELETE:
+            return true;
         case SELECT:
           return false;
         case NO_TXN:
@@ -3501,6 +3551,10 @@ public void addDynamicPartitions(AddDynamicPartitions rqst)
             pstmt.executeBatch();
           }
         }
+        try (PreparedStatement pstmt = dbConn.prepareStatement(TXN_COMPONENTS_DP_DELETE_QUERY)) {
+          pstmt.setLong(1, rqst.getTxnid());
+          pstmt.execute();
+        }
         LOG.debug("Going to commit");
         dbConn.commit();
       } catch (SQLException e) {
diff --git a/standalone-metastore/metastore-server/src/main/java/org/apache/hadoop/hive/metastore/txn/TxnStore.java b/standalone-metastore/metastore-server/src/main/java/org/apache/hadoop/hive/metastore/txn/TxnStore.java
index dfcb393985..4e300f3ca2 100644
--- a/standalone-metastore/metastore-server/src/main/java/org/apache/hadoop/hive/metastore/txn/TxnStore.java
+++ b/standalone-metastore/metastore-server/src/main/java/org/apache/hadoop/hive/metastore/txn/TxnStore.java
@@ -162,6 +162,8 @@ Materialization getMaterializationInvalidationInfo(
   long getTxnIdForWriteId(String dbName, String tblName, long writeId)
       throws MetaException;
 
+  long getLatestTxnInConflict(long txnid) throws MetaException;
+
   LockResponse lockMaterializationRebuild(String dbName, String tableName, long txnId)
       throws MetaException;
 
diff --git a/standalone-metastore/metastore-server/src/test/java/org/apache/hadoop/hive/metastore/HiveMetaStoreClientPreCatalog.java b/standalone-metastore/metastore-server/src/test/java/org/apache/hadoop/hive/metastore/HiveMetaStoreClientPreCatalog.java
index bdae77436e..f65ea81fed 100644
--- a/standalone-metastore/metastore-server/src/test/java/org/apache/hadoop/hive/metastore/HiveMetaStoreClientPreCatalog.java
+++ b/standalone-metastore/metastore-server/src/test/java/org/apache/hadoop/hive/metastore/HiveMetaStoreClientPreCatalog.java
@@ -2629,6 +2629,11 @@ public void insertTable(Table table, boolean overwrite) throws MetaException {
     }
   }
 
+  @Override
+  public long getLatestTxnInConflict(long txnId) throws MetaException {
+    return 0;
+  }
+
   @InterfaceAudience.LimitedPrivate({"HCatalog"})
   @Override
   public NotificationEventResponse getNextNotification(long lastEventId, int maxEvents,
