diff --git a/CHANGES.txt b/CHANGES.txt
index db9a7cd0ba..eafb779192 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -398,6 +398,8 @@ Trunk -  Unreleased
 
     HIVE-1028. Fix tinyint in TypedBytes. (Namit Jain via zshao)
 
+    HIVE-458. Better error messages for fs.default.name. (Paul Yang via zshao)
+
 Release 0.4.0 -  Unreleased
 
   INCOMPATIBLE CHANGES
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/Context.java b/ql/src/java/org/apache/hadoop/hive/ql/Context.java
index 1103b2abec..593b0fd0ec 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/Context.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/Context.java
@@ -180,6 +180,9 @@ private String getMRScratchDir() {
         makeMRScratchDir();
       } catch (IOException e) {
         throw new RuntimeException (e);
+      } catch (IllegalArgumentException e) {
+        throw new RuntimeException("Error while making MR scratch " + 
+            "directory - check filesystem config (" + e.getCause() + ")", e);
       }
     }
     return MRScratchDir.toString();
@@ -194,6 +197,9 @@ private String getLocalScratchDir() {
         makeLocalScratchDir();
       } catch (IOException e) {
         throw new RuntimeException(e);
+      } catch (IllegalArgumentException e) {
+        throw new RuntimeException("Error while making local scratch " + 
+            "directory - check filesystem config (" + e.getCause() + ")", e);
       }
     }
     return localScratchDir.toString();
diff --git a/ql/src/test/queries/clientnegative/fs_default_name1.q b/ql/src/test/queries/clientnegative/fs_default_name1.q
new file mode 100644
index 0000000000..f50369b138
--- /dev/null
+++ b/ql/src/test/queries/clientnegative/fs_default_name1.q
@@ -0,0 +1,2 @@
+set fs.default.name='http://www.example.com;
+show tables;
diff --git a/ql/src/test/queries/clientnegative/fs_default_name2.q b/ql/src/test/queries/clientnegative/fs_default_name2.q
new file mode 100644
index 0000000000..485c3db068
--- /dev/null
+++ b/ql/src/test/queries/clientnegative/fs_default_name2.q
@@ -0,0 +1,2 @@
+set fs.default.name='http://www.example.com;
+SELECT * FROM src;
diff --git a/ql/src/test/results/clientnegative/fs_default_name1.q.out b/ql/src/test/results/clientnegative/fs_default_name1.q.out
new file mode 100644
index 0000000000..bad0b5f46a
--- /dev/null
+++ b/ql/src/test/results/clientnegative/fs_default_name1.q.out
@@ -0,0 +1 @@
+FAILED: Unknown exception: Error while making local scratch directory - check filesystem config (java.net.URISyntaxException: Illegal character in scheme name at index 0: 'http://www.example.com)
diff --git a/ql/src/test/results/clientnegative/fs_default_name2.q.out b/ql/src/test/results/clientnegative/fs_default_name2.q.out
new file mode 100644
index 0000000000..41c6124030
--- /dev/null
+++ b/ql/src/test/results/clientnegative/fs_default_name2.q.out
@@ -0,0 +1 @@
+FAILED: Unknown exception: Error while making MR scratch directory - check filesystem config (java.net.URISyntaxException: Illegal character in scheme name at index 0: 'http://www.example.com)
