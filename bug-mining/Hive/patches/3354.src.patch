diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/SparkHashTableSinkOperator.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/SparkHashTableSinkOperator.java
index c3ba21a196..94144a2b39 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/SparkHashTableSinkOperator.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/SparkHashTableSinkOperator.java
@@ -143,7 +143,7 @@ protected void flushToFile(MapJoinPersistableTableContainer tableContainer,
       }
       // TODO find out numOfPartitions for the big table
       int numOfPartitions = replication;
-      replication = (short) Math.min(MIN_REPLICATION, numOfPartitions);
+      replication = (short) Math.max(MIN_REPLICATION, numOfPartitions);
     }
     htsOperator.console.printInfo(Utilities.now() + "\tDump the side-table for tag: " + tag
       + " with group count: " + tableContainer.size() + " into file: " + path);
