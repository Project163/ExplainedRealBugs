diff --git a/ql/src/java/org/apache/hadoop/hive/ql/history/HiveHistory.java b/ql/src/java/org/apache/hadoop/hive/ql/history/HiveHistory.java
index 6f00c99f12..a9dabe6b79 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/history/HiveHistory.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/history/HiveHistory.java
@@ -425,6 +425,7 @@ public void endQuery(String queryId) {
       return;
     }
     log(RecordTypes.QueryEnd, ji.hm);
+    queryInfoMap.remove(queryId);
   }
 
   /**
@@ -465,6 +466,7 @@ public void endTask(String queryId, Task<? extends Serializable> task) {
       return;
     }
     log(RecordTypes.TaskEnd, ti.hm);
+    taskInfoMap.remove(id);
   }
 
   /**
