diff --git a/CHANGES.txt b/CHANGES.txt
index 9405a6622e..57374e0c76 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -17,6 +17,8 @@ Trunk (unreleased changes)
 
   IMPROVEMENTS
 
+    HIVE-85. New compression options for Hive. (Joydeep Sarma through zshao)
+
     HIVE-69. genMapRedTasks uses tree walker. (Namit through zshao)
 
   OPTIMIZATIONS
diff --git a/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java b/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java
index 41364bbf68..b20c9e41a0 100644
--- a/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java
+++ b/common/src/java/org/apache/hadoop/hive/conf/HiveConf.java
@@ -48,6 +48,8 @@ public static enum ConfVars {
     SCRATCHDIR("hive.exec.scratchdir", "/tmp/"+System.getProperty("user.name")+"/hive"),
     SUBMITVIACHILD("hive.exec.submitviachild", "false"),
     SCRIPTERRORLIMIT("hive.exec.script.maxerrsize", 100000),
+    COMPRESSRESULT("hive.exec.compress.output", false),
+    COMPRESSINTERMEDIATE("hive.exec.compress.intermediate", false),
 
     // hadoop stuff
     HADOOPBIN("hadoop.bin.path", System.getenv("HADOOP_HOME") + "/bin/hadoop"),
@@ -94,12 +96,14 @@ public static enum ConfVars {
     public final String defaultVal;
     public final int defaultIntVal;
     public final Class valClass;
+    public final boolean defaultBoolVal;
 
     ConfVars(String varname, String defaultVal) {
       this.varname = varname;
       this.defaultVal = defaultVal;
       this.valClass = String.class;
       this.defaultIntVal = -1;
+      this.defaultBoolVal = false;
     }
 
     ConfVars(String varname, int defaultIntVal) {
@@ -107,6 +111,15 @@ public static enum ConfVars {
       this.defaultVal = null;
       this.defaultIntVal = defaultIntVal;
       this.valClass = Integer.class;
+      this.defaultBoolVal = false;
+    }
+
+    ConfVars(String varname, boolean defaultBoolVal) {
+      this.varname = varname;
+      this.defaultVal = null;
+      this.defaultIntVal = -1;
+      this.valClass = Boolean.class;
+      this.defaultBoolVal = defaultBoolVal;
     }
 
     public String toString() {
@@ -123,6 +136,15 @@ public int getIntVar(ConfVars var) {
     return getIntVar(this, var);
   }
 
+  public static boolean getBoolVar(Configuration conf, ConfVars var) {
+    assert(var.valClass == Boolean.class);
+    return conf.getBoolean(var.varname, var.defaultBoolVal);
+  }
+
+  public boolean getBoolVar(ConfVars var) {
+    return getBoolVar(this, var);
+  }
+
   public static String getVar(Configuration conf, ConfVars var) {
     assert(var.valClass == String.class);
     return conf.get(var.varname, var.defaultVal);
diff --git a/conf/hive-default.xml b/conf/hive-default.xml
index 5beb482439..d11212d5e0 100644
--- a/conf/hive-default.xml
+++ b/conf/hive-default.xml
@@ -103,4 +103,17 @@
   <description>Maximum number of bytes a script is allowed to emit to standard error (per map-reduce task). This prevents runaway scripts from filling logs partitions to capacity </description>
 </property>
 
+<property>
+  <name>hive.exec.compress.output</name>
+  <value>false</value>
+  <description> This controls whether the final outputs of a query (to a local/hdfs file or a hive table) is compressed. The compression codec and other options are determined from hadoop config variables mapred.output.compress* </description>
+</property>
+
+<property>
+  <name>hive.exec.compress.intermediate</name>
+  <value>false</value>
+  <description> This controls whether intermediate files produced by hive between multiple map-reduce jobs are compressed. The compression codec and other options are determined from hadoop config variables mapred.output.compress* </description>
+</property>
+
+
 </configuration>
diff --git a/data/files/lt100.txt.deflate b/data/files/lt100.txt.deflate
new file mode 100644
index 0000000000..7ad780adf9
--- /dev/null
+++ b/data/files/lt100.txt.deflate
@@ -0,0 +1,3 @@
+xMR;nDASZfDS=.!*~~+Dz.0f-!d\0+N(!]hÖ·Â™DËƒmlBÛ± 38 !`Hut
+Êœ:L×>`qMwtCSGk[E6:rQDxo4
!&g9J/BW?Î² 7KbqfHrstr^*53Ã¶^}6\k~@Y
+7Âª?EÕº}
?
\ No newline at end of file
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/ExplainTask.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/ExplainTask.java
index 919664f6c9..87955cb153 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/ExplainTask.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/ExplainTask.java
@@ -141,7 +141,8 @@ else if (o instanceof Serializable) {
   }
 
   private boolean isPrintable(Object val) {
-    if (val instanceof String ||
+    if (val instanceof Boolean ||
+        val instanceof String ||
         val instanceof Integer ||
         val instanceof Byte ||
         val instanceof Float ||
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/FileSinkOperator.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/FileSinkOperator.java
index 40a81ea2f1..54160fbcd6 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/FileSinkOperator.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/FileSinkOperator.java
@@ -94,14 +94,14 @@ public void initialize(Configuration hconf) throws HiveException {
       outPath = new Path(conf.getDirName(), "_tmp."+Utilities.getTaskId(hconf));
       OutputFormat<?, ?> outputFormat = conf.getTableInfo().getOutputFileFormatClass().newInstance();
       final Class<? extends Writable> outputClass = serializer.getSerializedClass();
-      boolean isCompressed = FileOutputFormat.getCompressOutput(jc);
+      boolean isCompressed = conf.getCompressed();
 
       // The reason to keep these instead of using OutputFormat.getRecordWriter() is that
       // getRecordWriter does not give us enough control over the file name that we create.
       if(outputFormat instanceof IgnoreKeyTextOutputFormat) {
-        if(isCompressed) {
-          finalPath = new Path(conf.getDirName(), Utilities.getTaskId(hconf) + ".gz");
-        }
+        finalPath = new Path(conf.getDirName(), Utilities.getTaskId(hconf) +
+                             Utilities.getFileExtension(jc, isCompressed));
+
         String rowSeparatorString = conf.getTableInfo().getProperties().getProperty(Constants.LINE_DELIM, "\n");
         int rowSeparator = 0;
         try {
@@ -110,7 +110,7 @@ public void initialize(Configuration hconf) throws HiveException {
           rowSeparator = rowSeparatorString.charAt(0); 
         }
         final int finalRowSeparator = rowSeparator;  
-        final OutputStream outStream = Utilities.createCompressedStream(jc, fs.create(outPath));
+        final OutputStream outStream = Utilities.createCompressedStream(jc, fs.create(outPath), isCompressed);
         outWriter = new RecordWriter () {
             public void write(Writable r) throws IOException {
               if (r instanceof Text) {
@@ -130,7 +130,8 @@ public void close(boolean abort) throws IOException {
           };
       } else if (outputFormat instanceof SequenceFileOutputFormat) {
         final SequenceFile.Writer outStream =
-            Utilities.createSequenceWriter(jc, fs, outPath, BytesWritable.class, outputClass);
+          Utilities.createSequenceWriter(jc, fs, outPath, BytesWritable.class, outputClass,
+                                         isCompressed);
         outWriter = new RecordWriter () {
             public void write(Writable r) throws IOException {
               outStream.append(commonKey, r);
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/Utilities.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/Utilities.java
index f1b4b2b97a..6d14a80a69 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/Utilities.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/Utilities.java
@@ -398,10 +398,34 @@ public static streamStatus readColumn(DataInput in, OutputStream out) throws IOE
     }
     // Unreachable
   }
-  
+
+  /**
+   * Convert an output stream to a compressed output stream based on codecs 
+   * and compression options specified in the Job Configuration.
+   * @param jc Job Configuration
+   * @param out Output Stream to be converted into compressed output stream
+   * @return compressed output stream
+   */
   public static OutputStream createCompressedStream(JobConf jc,
-                                                    OutputStream out) throws IOException {
+                                                    OutputStream out)
+    throws IOException {
     boolean isCompressed = FileOutputFormat.getCompressOutput(jc);
+    return createCompressedStream(jc, out, isCompressed);
+  }
+  
+  /**
+   * Convert an output stream to a compressed output stream based on codecs
+   * codecs in the Job Configuration. Caller specifies directly whether file is 
+   * compressed or not
+   * @param jc Job Configuration
+   * @param out Output Stream to be converted into compressed output stream
+   * @param isCompressed whether the output stream needs to be compressed or not
+   * @return compressed output stream
+   */
+  public static OutputStream createCompressedStream(JobConf jc,
+                                                    OutputStream out,
+                                                    boolean isCompressed)
+    throws IOException {
     if(isCompressed) {
       Class<? extends CompressionCodec> codecClass =
         FileOutputFormat.getOutputCompressorClass(jc, DefaultCodec.class);
@@ -413,14 +437,63 @@ public static OutputStream createCompressedStream(JobConf jc,
     }
   }
 
+  /**
+   * Based on compression option and configured output codec - get extension
+   * for output file. This is only required for text files - not sequencefiles
+   * @param jc Job Configuration
+   * @param isCompressed Whether the output file is compressed or not
+   * @return the required file extension (example: .gz)
+   */
+  public static String getFileExtension(JobConf jc, boolean isCompressed) {
+    if(!isCompressed) {
+      return "";
+    } else {
+      Class<? extends CompressionCodec> codecClass =
+        FileOutputFormat.getOutputCompressorClass(jc, DefaultCodec.class);
+      CompressionCodec codec = (CompressionCodec)
+        ReflectionUtils.newInstance(codecClass, jc);
+      return codec.getDefaultExtension();
+    }
+  }
+
+  /**
+   * Create a sequencefile output stream based on job configuration
+   * @param jc Job configuration
+   * @param fs File System to create file in
+   * @param file Path to be created
+   * @param keyClass Java Class for key
+   * @param valClass Java Class for value
+   * @return output stream over the created sequencefile
+   */
+  public static SequenceFile.Writer createSequenceWriter(JobConf jc, FileSystem fs,
+                                                         Path file, Class<?> keyClass,
+                                                         Class<?> valClass)
+    throws IOException {
+    boolean isCompressed = SequenceFileOutputFormat.getCompressOutput(jc);
+    return createSequenceWriter(jc, fs, file, keyClass, valClass, isCompressed);
+  }
+
+  /**
+   * Create a sequencefile output stream based on job configuration
+   * Uses user supplied compression flag (rather than obtaining it from the Job Configuration)
+   * @param jc Job configuration
+   * @param fs File System to create file in
+   * @param file Path to be created
+   * @param keyClass Java Class for key
+   * @param valClass Java Class for value
+   * @return output stream over the created sequencefile
+   */
   public static SequenceFile.Writer createSequenceWriter(JobConf jc, FileSystem fs,
                                                          Path file, Class<?> keyClass,
-                                                         Class<?> valClass) throws IOException {
+                                                         Class<?> valClass,
+                                                         boolean isCompressed)
+    throws IOException {
     CompressionCodec codec = null;
     CompressionType compressionType = CompressionType.NONE;
-    if (SequenceFileOutputFormat.getCompressOutput(jc)) {
+    Class codecClass = null;
+    if (isCompressed) {
       compressionType = SequenceFileOutputFormat.getOutputCompressionType(jc);
-      Class codecClass = SequenceFileOutputFormat.getOutputCompressorClass(jc, DefaultCodec.class);
+      codecClass = SequenceFileOutputFormat.getOutputCompressorClass(jc, DefaultCodec.class);
       codec = (CompressionCodec) 
         ReflectionUtils.newInstance(codecClass, jc);
     }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMapRedUtils.java b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMapRedUtils.java
index 2ac0a3666c..d6255f3450 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMapRedUtils.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMapRedUtils.java
@@ -50,7 +50,7 @@
 import org.apache.hadoop.hive.ql.exec.Utilities;
 import org.apache.hadoop.fs.Path;
 import org.apache.hadoop.hive.ql.optimizer.GenMRProcContext.GenMapRedCtx;
-
+import org.apache.hadoop.hive.conf.HiveConf;
 import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
 
@@ -172,8 +172,11 @@ public static void splitPlan(ReduceSinkOperator op, GenMRProcContext opProcCtx)
       PlanUtils.getBinaryTableDesc(PlanUtils.getFieldSchemasFromRowSchema(parent.getSchema(), "temporarycol")); 
     
     // Create a file sink operator for this file name
-    Operator<? extends Serializable> fs_op = 
-      putOpInsertMap(OperatorFactory.get(new fileSinkDesc(taskTmpDir, tt_desc),parent.getSchema()), null, parseCtx);
+    Operator<? extends Serializable> fs_op =
+      putOpInsertMap(OperatorFactory.get
+                     (new fileSinkDesc(taskTmpDir, tt_desc,
+                                       parseCtx.getConf().getBoolVar(HiveConf.ConfVars.COMPRESSINTERMEDIATE)),
+                      parent.getSchema()), null, parseCtx);
     
     // replace the reduce child with this operator
     List<Operator<? extends Serializable>> childOpList = parent.getChildOperators();
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
index b51043bf3a..dbddaaf957 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
@@ -1915,7 +1915,8 @@ private Operator genFileSinkPlan(String dest, QB qb,
 
     Operator output = putOpInsertMap(
       OperatorFactory.getAndMakeChild(
-        new fileSinkDesc(queryTmpdir, table_desc),
+        new fileSinkDesc(queryTmpdir, table_desc,
+                         conf.getBoolVar(HiveConf.ConfVars.COMPRESSRESULT)),
         new RowSchema(inputRR.getColumnInfos()), input), inputRR);
 
     LOG.debug("Created FileSink Plan for clause: " + dest + "dest_path: "
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/plan/fileSinkDesc.java b/ql/src/java/org/apache/hadoop/hive/ql/plan/fileSinkDesc.java
index 6e2d406339..bcc2582111 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/plan/fileSinkDesc.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/plan/fileSinkDesc.java
@@ -25,14 +25,17 @@ public class fileSinkDesc implements Serializable {
   private static final long serialVersionUID = 1L;
   private String dirName;
   private tableDesc tableInfo;
+  private boolean compressed;
 
   public fileSinkDesc() { }
   public fileSinkDesc(
     final String dirName,
-    final tableDesc tableInfo) {
+    final tableDesc tableInfo,
+    final boolean compressed) {
 
     this.dirName = dirName;
     this.tableInfo = tableInfo;
+    this.compressed = compressed;
   }
   
   @explain(displayName="directory", normalExplain=false)
@@ -51,4 +54,12 @@ public void setTableInfo(final tableDesc tableInfo) {
     this.tableInfo = tableInfo;
   }
 
+  @explain(displayName="compressed")
+  public boolean getCompressed() {
+    return compressed;
+  }
+
+  public void setCompressed(boolean compressed) {
+    this.compressed = compressed;
+  }
 }
diff --git a/ql/src/test/org/apache/hadoop/hive/ql/QTestUtil.java b/ql/src/test/org/apache/hadoop/hive/ql/QTestUtil.java
index 23f5dfa6cd..46293a4d7f 100644
--- a/ql/src/test/org/apache/hadoop/hive/ql/QTestUtil.java
+++ b/ql/src/test/org/apache/hadoop/hive/ql/QTestUtil.java
@@ -61,6 +61,7 @@
 
 import com.facebook.thrift.protocol.TBinaryProtocol;
 import org.apache.hadoop.hive.serde2.ThriftDeserializer;
+import java.nio.channels.FileChannel;
 
 import org.antlr.runtime.tree.*;
 
@@ -408,13 +409,9 @@ public int checkNegativeResults(String tname, Exception e) throws Exception {
     expf = new File(expf, qf.getName().concat(".out"));
     
     File outf = null;
-    if (!overWrite) {
-      outf = new File(logDir);
-      outf = new File(outf, qf.getName().concat(".out"));
-    }
-    else {
-      outf = expf;
-    }
+    outf = new File(logDir);
+    outf = new File(outf, qf.getName().concat(".out"));
+
     FileWriter outfd = new FileWriter(outf);
     if (e instanceof ParseException) {
       outfd.write("Parse Error: ");
@@ -441,6 +438,14 @@ else if (e instanceof SemanticException) {
     errPrinter.start();
     
     int exitVal = executor.waitFor();
+
+    if(exitVal != 0 && overWrite) {
+      System.out.println("Overwriting results");
+      cmdLine = "cp " + outf.getPath() + " " + expf.getPath();
+      executor = Runtime.getRuntime().exec(cmdLine);
+      exitVal = executor.waitFor();
+    }
+
     return exitVal;
   }
 
@@ -451,13 +456,9 @@ public int checkParseResults(String tname, CommonTree tree) throws Exception {
       File expf = new File(parseDir, tname.concat(".out"));
   
       File outf = null;
-      if (!overWrite) {
-        outf = new File(logDir);
-        outf = new File(outf, tname.concat(".out"));
-      }
-      else {
-        outf = expf;
-      }
+      outf = new File(logDir);
+      outf = new File(outf, tname.concat(".out"));
+
       FileWriter outfd = new FileWriter(outf);
       outfd.write(tree.toStringTree());
       outfd.close();
@@ -474,6 +475,14 @@ public int checkParseResults(String tname, CommonTree tree) throws Exception {
       errPrinter.start();
       
       int exitVal = executor.waitFor();
+
+      if(exitVal != 0 && overWrite) {
+        System.out.println("Overwriting results");
+        cmdLine = "cp " + outf.getPath() + " " + expf.getPath();
+        executor = Runtime.getRuntime().exec(cmdLine);
+        exitVal = executor.waitFor();
+      }
+
       return exitVal;
     }
     else {
@@ -488,13 +497,9 @@ public int checkPlan(String tname,  List<Task<? extends Serializable>> tasks) th
       File planFile = new File(planDir, tname.concat(".xml"));
   
       File outf = null;
-      if (!overWrite) {
-        outf = new File(logDir);
-        outf = new File(outf, tname.concat(".xml"));
-      }
-      else {
-        outf = planFile;
-      }
+      outf = new File(logDir);
+      outf = new File(outf, tname.concat(".xml"));
+
       FileOutputStream ofs = new FileOutputStream(outf);
       for(Task<? extends Serializable> plan: tasks) {
         Utilities.serializeTasks(plan, ofs);
@@ -522,6 +527,13 @@ public int checkPlan(String tname,  List<Task<? extends Serializable>> tasks) th
       errPrinter.start();
       
       int exitVal = executor.waitFor();
+      
+      if(exitVal != 0 && overWrite) {
+        System.out.println("Overwriting results");
+        String cmdLine = "cp " + outf.getPath() + " " + planFile.getPath();
+        executor = Runtime.getRuntime().exec(cmdLine);
+        exitVal = executor.waitFor();
+      }
 
       return exitVal;
     }
@@ -605,23 +617,14 @@ public int checkResults(String tname) throws Exception {
   public int checkCliDriverResults(String tname) throws Exception {
     String [] cmdArray;
 
-    if (!overWrite) {
-      cmdArray = new String[5];
-      cmdArray[0] = "diff";
-      cmdArray[1] = "-I";
-      cmdArray[2] = "\\(file:\\)\\|\\(tmp/hive-.*\\)";
-      cmdArray[3] = (new File(logDir, tname + ".out")).getPath();
-      cmdArray[4] = (new File(outDir, tname + ".out")).getPath();
-      System.out.println(cmdArray[0] + " " + cmdArray[1] + " " + cmdArray[2] + " " +
-                         cmdArray[3] + " " + cmdArray[4]);
-    }
-    else {
-      cmdArray = new String[3];
-      cmdArray[0] = "cp";
-      cmdArray[1] = (new File(logDir, tname + ".out")).getPath();
-      cmdArray[2] = (new File(outDir, tname + ".out")).getPath();
-      System.out.println(cmdArray[0] + " " + cmdArray[1] + " " + cmdArray[2]);
-    }
+    cmdArray = new String[5];
+    cmdArray[0] = "diff";
+    cmdArray[1] = "-I";
+    cmdArray[2] = "\\(file:\\)\\|\\(tmp/hive-.*\\)";
+    cmdArray[3] = (new File(logDir, tname + ".out")).getPath();
+    cmdArray[4] = (new File(outDir, tname + ".out")).getPath();
+    System.out.println(cmdArray[0] + " " + cmdArray[1] + " " + cmdArray[2] + " " +
+                       cmdArray[3] + " " + cmdArray[4]);
 
     Process executor = Runtime.getRuntime().exec(cmdArray);
 
@@ -633,6 +636,16 @@ public int checkCliDriverResults(String tname) throws Exception {
     
     int exitVal = executor.waitFor();
 
+    if(exitVal != 0 && overWrite) {
+      System.out.println("Overwriting results");
+      cmdArray = new String[3];
+      cmdArray[0] = "cp";
+      cmdArray[1] = (new File(logDir, tname + ".out")).getPath();
+      cmdArray[2] = (new File(outDir, tname + ".out")).getPath();
+      executor = Runtime.getRuntime().exec(cmdArray);
+      exitVal = executor.waitFor();
+    }
+
     return exitVal;
   }
 
diff --git a/ql/src/test/org/apache/hadoop/hive/ql/exec/TestExecDriver.java b/ql/src/test/org/apache/hadoop/hive/ql/exec/TestExecDriver.java
index f7912eaa2c..9333192097 100644
--- a/ql/src/test/org/apache/hadoop/hive/ql/exec/TestExecDriver.java
+++ b/ql/src/test/org/apache/hadoop/hive/ql/exec/TestExecDriver.java
@@ -165,7 +165,7 @@ private void populateMapPlan1(Table src) {
 
     Operator<fileSinkDesc> op2 = OperatorFactory.get(new fileSinkDesc
                                                      (tmpdir + "mapplan1.out",
-                                                     Utilities.defaultTd));
+                                                      Utilities.defaultTd, true));
     Operator<filterDesc> op1 =
       OperatorFactory.get(getTestFilterDesc("key"), op2);
 
@@ -179,7 +179,7 @@ private void populateMapPlan2(Table src) {
 
     Operator<fileSinkDesc> op3 = OperatorFactory.get(new fileSinkDesc
                                                      (tmpdir + "mapplan2.out",
-                                                     Utilities.defaultTd));
+                                                      Utilities.defaultTd, false));
 
     Operator<scriptDesc> op2 = OperatorFactory.get
       (new scriptDesc("/bin/cat",
@@ -212,7 +212,7 @@ private void populateMapRedPlan1(Table src) {
     // reduce side work
     Operator<fileSinkDesc> op3 = OperatorFactory.get(new fileSinkDesc
                                                      (tmpdir + "mapredplan1.out",
-                                                         Utilities.defaultTd));
+                                                      Utilities.defaultTd, false));
 
     Operator<extractDesc> op2 =  OperatorFactory.get
       (new extractDesc(new exprNodeColumnDesc(String.class, Utilities.ReduceField.VALUE.toString())), op3);
@@ -238,7 +238,7 @@ private void populateMapRedPlan2(Table src) {
     // reduce side work
     Operator<fileSinkDesc> op4 = OperatorFactory.get(new fileSinkDesc
                                                      (tmpdir + "mapredplan2.out",
-                                                         Utilities.defaultTd));
+                                                      Utilities.defaultTd, false));
 
     Operator<filterDesc> op3 =
       OperatorFactory.get(getTestFilterDesc("0"), op4);
@@ -281,7 +281,7 @@ private void populateMapRedPlan3(Table src, Table src2) {
     // reduce side work
     Operator<fileSinkDesc> op4 = OperatorFactory.get(new fileSinkDesc
                                                      (tmpdir + "mapredplan3.out",
-                                                         Utilities.defaultTd));
+                                                      Utilities.defaultTd, false));
 
     Operator<selectDesc> op5 =  OperatorFactory.get
       (new selectDesc
@@ -327,7 +327,7 @@ private void populateMapRedPlan4(Table src) {
     // reduce side work
     Operator<fileSinkDesc> op3 = OperatorFactory.get(new fileSinkDesc
                                                      (tmpdir + "mapredplan4.out",
-                                                         Utilities.defaultTd));
+                                                      Utilities.defaultTd, false));
 
     Operator<extractDesc> op2 =  OperatorFactory.get
       (new extractDesc(new exprNodeColumnDesc(String.class, Utilities.ReduceField.VALUE.toString())), op3);
@@ -359,7 +359,7 @@ private void populateMapRedPlan5(Table src) {
     // reduce side work
     Operator<fileSinkDesc> op3 = OperatorFactory.get(new fileSinkDesc
                                                      (tmpdir + "mapredplan5.out",
-                                                         Utilities.defaultTd));
+                                                      Utilities.defaultTd, false));
 
     Operator<extractDesc> op2 =  OperatorFactory.get
       (new extractDesc(new exprNodeColumnDesc(String.class, Utilities.ReduceField.VALUE.toString())), op3);
@@ -397,7 +397,7 @@ private void populateMapRedPlan6(Table src) {
     // reduce side work
     Operator<fileSinkDesc> op3 = OperatorFactory.get(new fileSinkDesc
                                                      (tmpdir + "mapredplan6.out",
-                                                     Utilities.defaultTd));
+                                                      Utilities.defaultTd, false));
 
     Operator<filterDesc> op2 =
       OperatorFactory.get(getTestFilterDesc("0"), op3);
@@ -447,7 +447,7 @@ public void testMapPlan1() throws Exception {
       populateMapPlan1(db.getTable("src"));
       File planFile = generatePlanFile();
       executePlan(planFile);
-      fileDiff("lt100.txt", "mapplan1.out");
+      fileDiff("lt100.txt.deflate", "mapplan1.out");
     } catch (Throwable e) {
       e.printStackTrace();
       fail("Got Throwable");
diff --git a/ql/src/test/org/apache/hadoop/hive/ql/exec/TestOperators.java b/ql/src/test/org/apache/hadoop/hive/ql/exec/TestOperators.java
index eec10033d5..70e6735d70 100644
--- a/ql/src/test/org/apache/hadoop/hive/ql/exec/TestOperators.java
+++ b/ql/src/test/org/apache/hadoop/hive/ql/exec/TestOperators.java
@@ -133,7 +133,7 @@ public void testFileSinkOperator() throws Throwable {
 
       // fileSinkOperator to dump the output of the select
       fileSinkDesc fsd = new fileSinkDesc ("file:///tmp" + File.separator + System.getProperty("user.name") + File.separator + "TestFileSinkOperator",
-                                           Utilities.defaultTd);
+                                           Utilities.defaultTd, false);
       Operator<fileSinkDesc> flop = OperatorFactory.get(fileSinkDesc.class);
       flop.setConf(fsd);
       ArrayList<Operator<? extends Serializable>> nextOp = new ArrayList<Operator<? extends Serializable>> ();
diff --git a/ql/src/test/queries/clientpositive/groupby7.q b/ql/src/test/queries/clientpositive/groupby7.q
index f1ce810fb5..cad4dbd79c 100644
--- a/ql/src/test/queries/clientpositive/groupby7.q
+++ b/ql/src/test/queries/clientpositive/groupby7.q
@@ -1,6 +1,9 @@
 CREATE TABLE DEST1(key INT, value STRING) STORED AS TEXTFILE;
 CREATE TABLE DEST2(key INT, value STRING) STORED AS TEXTFILE;
 
+SET hive.exec.compress.intermediate=true;
+SET hive.exec.compress.output=true; 
+
 FROM SRC
 INSERT OVERWRITE TABLE DEST1 SELECT SRC.key, sum(SUBSTR(SRC.value,4)) GROUP BY SRC.key
 INSERT OVERWRITE TABLE DEST2 SELECT SRC.key, sum(SUBSTR(SRC.value,4)) GROUP BY SRC.key;
diff --git a/ql/src/test/results/clientpositive/case_sensitivity.q.out b/ql/src/test/results/clientpositive/case_sensitivity.q.out
index be01bdc4dc..9a9966bfbe 100644
--- a/ql/src/test/results/clientpositive/case_sensitivity.q.out
+++ b/ql/src/test/results/clientpositive/case_sensitivity.q.out
@@ -27,6 +27,7 @@ STAGE PLANS:
                         expr: 1[0].MYSTRING
                         type: string
                   File Output Operator
+                    compressed: false
                     table:
                         input format: org.apache.hadoop.mapred.TextInputFormat
                         output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -36,7 +37,7 @@ STAGE PLANS:
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/cast1.q.out b/ql/src/test/results/clientpositive/cast1.q.out
index e9675bccc8..325c3b8d55 100644
--- a/ql/src/test/results/clientpositive/cast1.q.out
+++ b/ql/src/test/results/clientpositive/cast1.q.out
@@ -35,6 +35,7 @@ STAGE PLANS:
                         expr: UDFToInteger(true)
                         type: int
                   File Output Operator
+                    compressed: false
                     table:
                         input format: org.apache.hadoop.mapred.TextInputFormat
                         output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -44,7 +45,7 @@ STAGE PLANS:
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/groupby1.q.out b/ql/src/test/results/clientpositive/groupby1.q.out
index bce833a102..b65d13c313 100644
--- a/ql/src/test/results/clientpositive/groupby1.q.out
+++ b/ql/src/test/results/clientpositive/groupby1.q.out
@@ -32,6 +32,7 @@ STAGE PLANS:
                 type: string
           mode: partial1
           File Output Operator
+            compressed: false
             table:
                 input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                 output format: org.apache.hadoop.mapred.SequenceFileOutputFormat
@@ -40,7 +41,7 @@ STAGE PLANS:
   Stage: Stage-2
     Map Reduce
       Alias -> Map Operator Tree:
-        /tmp/hive-njain/7857726/161687564.10001 
+        /tmp/hive-jssarma/669676736/1737584634.10001 
           Reduce Output Operator
             key expressions:
                   expr: 0
@@ -68,6 +69,7 @@ STAGE PLANS:
                   expr: 1
                   type: double
             File Output Operator
+              compressed: false
               table:
                   input format: org.apache.hadoop.mapred.TextInputFormat
                   output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -77,7 +79,7 @@ STAGE PLANS:
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/groupby1_limit.q.out b/ql/src/test/results/clientpositive/groupby1_limit.q.out
index 8c007bdb1a..5be731fe98 100644
--- a/ql/src/test/results/clientpositive/groupby1_limit.q.out
+++ b/ql/src/test/results/clientpositive/groupby1_limit.q.out
@@ -33,6 +33,7 @@ STAGE PLANS:
                 type: string
           mode: partial1
           File Output Operator
+            compressed: false
             table:
                 input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                 output format: org.apache.hadoop.mapred.SequenceFileOutputFormat
@@ -41,7 +42,7 @@ STAGE PLANS:
   Stage: Stage-2
     Map Reduce
       Alias -> Map Operator Tree:
-        /tmp/hive-njain/324923626/1284785232.10001 
+        /tmp/hive-jssarma/786365372/1698354371.10001 
           Reduce Output Operator
             key expressions:
                   expr: 0
@@ -70,6 +71,7 @@ STAGE PLANS:
                   type: double
             Limit
               File Output Operator
+                compressed: false
                 table:
                     input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                     output format: org.apache.hadoop.mapred.SequenceFileOutputFormat
@@ -78,7 +80,7 @@ STAGE PLANS:
   Stage: Stage-3
     Map Reduce
       Alias -> Map Operator Tree:
-        /tmp/hive-njain/324923626/1284785232.10002 
+        /tmp/hive-jssarma/786365372/1698354371.10002 
           Reduce Output Operator
             sort order: 
             tag: -1
@@ -92,6 +94,7 @@ STAGE PLANS:
         Extract
           Limit
             File Output Operator
+              compressed: false
               table:
                   input format: org.apache.hadoop.mapred.TextInputFormat
                   output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -101,7 +104,7 @@ STAGE PLANS:
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/groupby1_map.q.out b/ql/src/test/results/clientpositive/groupby1_map.q.out
index 474665da75..5e89ef9306 100644
--- a/ql/src/test/results/clientpositive/groupby1_map.q.out
+++ b/ql/src/test/results/clientpositive/groupby1_map.q.out
@@ -39,6 +39,7 @@ STAGE PLANS:
                 type: string
           mode: partial2
           File Output Operator
+            compressed: false
             table:
                 input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                 output format: org.apache.hadoop.mapred.SequenceFileOutputFormat
@@ -47,7 +48,7 @@ STAGE PLANS:
   Stage: Stage-2
     Map Reduce
       Alias -> Map Operator Tree:
-        /tmp/hive-njain/871552050/153342031.10001 
+        /tmp/hive-jssarma/176699107/318789303.10001 
           Reduce Output Operator
             key expressions:
                   expr: 0
@@ -75,6 +76,7 @@ STAGE PLANS:
                   expr: 1
                   type: double
             File Output Operator
+              compressed: false
               table:
                   input format: org.apache.hadoop.mapred.TextInputFormat
                   output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -84,7 +86,7 @@ STAGE PLANS:
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/groupby2.q.out b/ql/src/test/results/clientpositive/groupby2.q.out
index 27292d97dc..8cc02690e1 100644
--- a/ql/src/test/results/clientpositive/groupby2.q.out
+++ b/ql/src/test/results/clientpositive/groupby2.q.out
@@ -34,6 +34,7 @@ STAGE PLANS:
                 type: string
           mode: partial1
           File Output Operator
+            compressed: false
             table:
                 input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                 output format: org.apache.hadoop.mapred.SequenceFileOutputFormat
@@ -42,7 +43,7 @@ STAGE PLANS:
   Stage: Stage-2
     Map Reduce
       Alias -> Map Operator Tree:
-        /tmp/hive-njain/5285021/59406042.10001 
+        /tmp/hive-jssarma/836051436/1775451122.10001 
           Reduce Output Operator
             key expressions:
                   expr: 0
@@ -75,6 +76,7 @@ STAGE PLANS:
                   expr: concat(0, UDFToString(2))
                   type: string
             File Output Operator
+              compressed: false
               table:
                   input format: org.apache.hadoop.mapred.TextInputFormat
                   output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -84,7 +86,7 @@ STAGE PLANS:
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/groupby2_limit.q.out b/ql/src/test/results/clientpositive/groupby2_limit.q.out
index 653bfbb767..dbef75923c 100644
--- a/ql/src/test/results/clientpositive/groupby2_limit.q.out
+++ b/ql/src/test/results/clientpositive/groupby2_limit.q.out
@@ -32,6 +32,7 @@ STAGE PLANS:
                 type: string
           mode: partial1
           File Output Operator
+            compressed: false
             table:
                 input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                 output format: org.apache.hadoop.mapred.SequenceFileOutputFormat
@@ -40,7 +41,7 @@ STAGE PLANS:
   Stage: Stage-2
     Map Reduce
       Alias -> Map Operator Tree:
-        /tmp/hive-njain/635379378/60676453.10002 
+        /tmp/hive-jssarma/426666771/995404034.10002 
           Reduce Output Operator
             key expressions:
                   expr: 0
@@ -69,6 +70,7 @@ STAGE PLANS:
                   type: double
             Limit
               File Output Operator
+                compressed: false
                 table:
                     input format: org.apache.hadoop.mapred.TextInputFormat
                     output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/groupby2_map.q.out b/ql/src/test/results/clientpositive/groupby2_map.q.out
index af8694159a..e3f8b9db1c 100644
--- a/ql/src/test/results/clientpositive/groupby2_map.q.out
+++ b/ql/src/test/results/clientpositive/groupby2_map.q.out
@@ -49,6 +49,7 @@ STAGE PLANS:
                 type: string
           mode: partial2
           File Output Operator
+            compressed: false
             table:
                 input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                 output format: org.apache.hadoop.mapred.SequenceFileOutputFormat
@@ -57,7 +58,7 @@ STAGE PLANS:
   Stage: Stage-2
     Map Reduce
       Alias -> Map Operator Tree:
-        /tmp/hive-njain/951471939/220829541.10001 
+        /tmp/hive-jssarma/729182472/421148418.10001 
           Reduce Output Operator
             key expressions:
                   expr: 0
@@ -90,6 +91,7 @@ STAGE PLANS:
                   expr: concat(0, UDFToString(2))
                   type: string
             File Output Operator
+              compressed: false
               table:
                   input format: org.apache.hadoop.mapred.TextInputFormat
                   output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -99,7 +101,7 @@ STAGE PLANS:
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/groupby3.q.out b/ql/src/test/results/clientpositive/groupby3.q.out
index 14d94d1cb0..fd74baf737 100644
--- a/ql/src/test/results/clientpositive/groupby3.q.out
+++ b/ql/src/test/results/clientpositive/groupby3.q.out
@@ -34,6 +34,7 @@ STAGE PLANS:
                 expr: max(UDFToDouble(KEY.0))
           mode: partial1
           File Output Operator
+            compressed: false
             table:
                 input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                 output format: org.apache.hadoop.mapred.SequenceFileOutputFormat
@@ -42,7 +43,7 @@ STAGE PLANS:
   Stage: Stage-2
     Map Reduce
       Alias -> Map Operator Tree:
-        /tmp/hive-njain/1428098224/715983841.10001 
+        /tmp/hive-jssarma/793012867/112314829.10001 
           Reduce Output Operator
             sort order: 
             tag: -1
@@ -79,6 +80,7 @@ STAGE PLANS:
                   expr: 3
                   type: double
             File Output Operator
+              compressed: false
               table:
                   input format: org.apache.hadoop.mapred.TextInputFormat
                   output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -88,7 +90,7 @@ STAGE PLANS:
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/groupby3_map.q.out b/ql/src/test/results/clientpositive/groupby3_map.q.out
index 2bbcd64556..623821c030 100644
--- a/ql/src/test/results/clientpositive/groupby3_map.q.out
+++ b/ql/src/test/results/clientpositive/groupby3_map.q.out
@@ -56,6 +56,7 @@ STAGE PLANS:
                 expr: max(VALUE.4)
           mode: partial2
           File Output Operator
+            compressed: false
             table:
                 input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                 output format: org.apache.hadoop.mapred.SequenceFileOutputFormat
@@ -64,7 +65,7 @@ STAGE PLANS:
   Stage: Stage-2
     Map Reduce
       Alias -> Map Operator Tree:
-        /tmp/hive-njain/82630066/2591068.10001 
+        /tmp/hive-jssarma/16311816/1248542091.10001 
           Reduce Output Operator
             sort order: 
             tag: -1
@@ -101,6 +102,7 @@ STAGE PLANS:
                   expr: 3
                   type: double
             File Output Operator
+              compressed: false
               table:
                   input format: org.apache.hadoop.mapred.TextInputFormat
                   output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -110,7 +112,7 @@ STAGE PLANS:
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/groupby4.q.out b/ql/src/test/results/clientpositive/groupby4.q.out
index 484154d8d1..4d9eb71c94 100644
--- a/ql/src/test/results/clientpositive/groupby4.q.out
+++ b/ql/src/test/results/clientpositive/groupby4.q.out
@@ -31,6 +31,7 @@ STAGE PLANS:
                 type: string
           mode: partial1
           File Output Operator
+            compressed: false
             table:
                 input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                 output format: org.apache.hadoop.mapred.SequenceFileOutputFormat
@@ -39,7 +40,7 @@ STAGE PLANS:
   Stage: Stage-2
     Map Reduce
       Alias -> Map Operator Tree:
-        /tmp/hive-njain/142162733/220682119.10001 
+        /tmp/hive-jssarma/1453689426/82458415.10001 
           Reduce Output Operator
             key expressions:
                   expr: 0
@@ -60,6 +61,7 @@ STAGE PLANS:
                   expr: 0
                   type: string
             File Output Operator
+              compressed: false
               table:
                   input format: org.apache.hadoop.mapred.TextInputFormat
                   output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -69,7 +71,7 @@ STAGE PLANS:
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/groupby4_map.q.out b/ql/src/test/results/clientpositive/groupby4_map.q.out
index 7927f4864a..32f6449614 100644
--- a/ql/src/test/results/clientpositive/groupby4_map.q.out
+++ b/ql/src/test/results/clientpositive/groupby4_map.q.out
@@ -34,6 +34,7 @@ STAGE PLANS:
                   expr: 0
                   type: bigint
             File Output Operator
+              compressed: false
               table:
                   input format: org.apache.hadoop.mapred.TextInputFormat
                   output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -43,7 +44,7 @@ STAGE PLANS:
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/groupby5.q.out b/ql/src/test/results/clientpositive/groupby5.q.out
index 6797ae972c..651769d439 100644
--- a/ql/src/test/results/clientpositive/groupby5.q.out
+++ b/ql/src/test/results/clientpositive/groupby5.q.out
@@ -32,6 +32,7 @@ STAGE PLANS:
                 type: string
           mode: partial1
           File Output Operator
+            compressed: false
             table:
                 input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                 output format: org.apache.hadoop.mapred.SequenceFileOutputFormat
@@ -40,7 +41,7 @@ STAGE PLANS:
   Stage: Stage-2
     Map Reduce
       Alias -> Map Operator Tree:
-        /tmp/hive-njain/450793281/288129670.10001 
+        /tmp/hive-jssarma/46132837/471661111.10001 
           Reduce Output Operator
             key expressions:
                   expr: 0
@@ -68,6 +69,7 @@ STAGE PLANS:
                   expr: 1
                   type: double
             File Output Operator
+              compressed: false
               table:
                   input format: org.apache.hadoop.mapred.TextInputFormat
                   output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -77,7 +79,7 @@ STAGE PLANS:
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/groupby5_map.q.out b/ql/src/test/results/clientpositive/groupby5_map.q.out
index ab486ccf0a..dd4f57a6d8 100644
--- a/ql/src/test/results/clientpositive/groupby5_map.q.out
+++ b/ql/src/test/results/clientpositive/groupby5_map.q.out
@@ -37,6 +37,7 @@ STAGE PLANS:
                   expr: 0
                   type: double
             File Output Operator
+              compressed: false
               table:
                   input format: org.apache.hadoop.mapred.TextInputFormat
                   output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -46,7 +47,7 @@ STAGE PLANS:
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/groupby6.q.out b/ql/src/test/results/clientpositive/groupby6.q.out
index df8f707b33..3f35e60a16 100644
--- a/ql/src/test/results/clientpositive/groupby6.q.out
+++ b/ql/src/test/results/clientpositive/groupby6.q.out
@@ -31,6 +31,7 @@ STAGE PLANS:
                 type: string
           mode: partial1
           File Output Operator
+            compressed: false
             table:
                 input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                 output format: org.apache.hadoop.mapred.SequenceFileOutputFormat
@@ -39,7 +40,7 @@ STAGE PLANS:
   Stage: Stage-2
     Map Reduce
       Alias -> Map Operator Tree:
-        /tmp/hive-njain/53979816/107916670.10001 
+        /tmp/hive-jssarma/486205309/55090089.10001 
           Reduce Output Operator
             key expressions:
                   expr: 0
@@ -60,6 +61,7 @@ STAGE PLANS:
                   expr: 0
                   type: string
             File Output Operator
+              compressed: false
               table:
                   input format: org.apache.hadoop.mapred.TextInputFormat
                   output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -69,7 +71,7 @@ STAGE PLANS:
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/input11.q.out b/ql/src/test/results/clientpositive/input11.q.out
index a9000c13dd..7c407f04c0 100644
--- a/ql/src/test/results/clientpositive/input11.q.out
+++ b/ql/src/test/results/clientpositive/input11.q.out
@@ -21,6 +21,7 @@ STAGE PLANS:
                       expr: value
                       type: string
                 File Output Operator
+                  compressed: false
                   table:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -30,7 +31,7 @@ STAGE PLANS:
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/input11_limit.q.out b/ql/src/test/results/clientpositive/input11_limit.q.out
index e5675558e9..f7a296fced 100644
--- a/ql/src/test/results/clientpositive/input11_limit.q.out
+++ b/ql/src/test/results/clientpositive/input11_limit.q.out
@@ -34,6 +34,7 @@ STAGE PLANS:
         Extract
           Limit
             File Output Operator
+              compressed: false
               table:
                   input format: org.apache.hadoop.mapred.TextInputFormat
                   output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -43,7 +44,7 @@ STAGE PLANS:
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/input12.q.out b/ql/src/test/results/clientpositive/input12.q.out
index bcfc79c33b..ba55b3c7ae 100644
--- a/ql/src/test/results/clientpositive/input12.q.out
+++ b/ql/src/test/results/clientpositive/input12.q.out
@@ -21,6 +21,7 @@ STAGE PLANS:
                       expr: value
                       type: string
                 File Output Operator
+                  compressed: false
                   table:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -37,6 +38,7 @@ STAGE PLANS:
                       expr: value
                       type: string
                 File Output Operator
+                  compressed: false
                   table:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -51,6 +53,7 @@ STAGE PLANS:
                       expr: key
                       type: string
                 File Output Operator
+                  compressed: false
                   table:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -60,13 +63,13 @@ STAGE PLANS:
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
                 serde: org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                 name: dest1
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -75,7 +78,7 @@ STAGE PLANS:
             partition:
               ds 2008-04-08
               hr 12
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/input13.q.out b/ql/src/test/results/clientpositive/input13.q.out
index cef83c29fd..6eaf2d865b 100644
--- a/ql/src/test/results/clientpositive/input13.q.out
+++ b/ql/src/test/results/clientpositive/input13.q.out
@@ -21,6 +21,7 @@ STAGE PLANS:
                       expr: value
                       type: string
                 File Output Operator
+                  compressed: false
                   table:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -37,6 +38,7 @@ STAGE PLANS:
                       expr: value
                       type: string
                 File Output Operator
+                  compressed: false
                   table:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -51,6 +53,7 @@ STAGE PLANS:
                       expr: key
                       type: string
                 File Output Operator
+                  compressed: false
                   table:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -65,6 +68,7 @@ STAGE PLANS:
                       expr: value
                       type: string
                 File Output Operator
+                  compressed: false
                   table:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -72,16 +76,16 @@ STAGE PLANS:
   Stage: Stage-0
     Move Operator
       files:
-            hdfs directory:
+            hdfs directory: true
             destination: ../build/ql/test/data/warehouse/dest4.out
       tables:
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
                 serde: org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                 name: dest1
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -90,7 +94,7 @@ STAGE PLANS:
             partition:
               ds 2008-04-08
               hr 12
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/input14.q.out b/ql/src/test/results/clientpositive/input14.q.out
index 540dcbd55d..eb1f4712ab 100644
--- a/ql/src/test/results/clientpositive/input14.q.out
+++ b/ql/src/test/results/clientpositive/input14.q.out
@@ -48,6 +48,7 @@ STAGE PLANS:
                     expr: 1
                     type: string
               File Output Operator
+                compressed: false
                 table:
                     input format: org.apache.hadoop.mapred.TextInputFormat
                     output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -57,7 +58,7 @@ STAGE PLANS:
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/input14_limit.q.out b/ql/src/test/results/clientpositive/input14_limit.q.out
index ee3e4165ca..0f3dad675a 100644
--- a/ql/src/test/results/clientpositive/input14_limit.q.out
+++ b/ql/src/test/results/clientpositive/input14_limit.q.out
@@ -40,6 +40,7 @@ STAGE PLANS:
         Extract
           Limit
             File Output Operator
+              compressed: false
               table:
                   input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                   output format: org.apache.hadoop.mapred.SequenceFileOutputFormat
@@ -48,7 +49,7 @@ STAGE PLANS:
   Stage: Stage-2
     Map Reduce
       Alias -> Map Operator Tree:
-        /tmp/hive-njain/458204227/247333025.10001 
+        /tmp/hive-jssarma/606891034/24901173.10001 
           Reduce Output Operator
             key expressions:
                   expr: 0
@@ -78,6 +79,7 @@ STAGE PLANS:
                       expr: 1
                       type: string
                 File Output Operator
+                  compressed: false
                   table:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -87,7 +89,7 @@ STAGE PLANS:
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/input15.q.out b/ql/src/test/results/clientpositive/input15.q.out
index ec17b9b27f..3fab5a570c 100644
--- a/ql/src/test/results/clientpositive/input15.q.out
+++ b/ql/src/test/results/clientpositive/input15.q.out
@@ -12,8 +12,8 @@ STAGE PLANS:
           field delimiter: 	
           # buckets: -1
           name: TEST15
-          isExternal:
-          isSequenceFile:
+          isExternal: false
+          isSequenceFile: false
 
 
 key	int
diff --git a/ql/src/test/results/clientpositive/input17.q.out b/ql/src/test/results/clientpositive/input17.q.out
index f3177f37f1..d6c5762800 100644
--- a/ql/src/test/results/clientpositive/input17.q.out
+++ b/ql/src/test/results/clientpositive/input17.q.out
@@ -52,6 +52,7 @@ STAGE PLANS:
                   expr: 1
                   type: string
             File Output Operator
+              compressed: false
               table:
                   input format: org.apache.hadoop.mapred.TextInputFormat
                   output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -61,7 +62,7 @@ STAGE PLANS:
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/input18.q.out b/ql/src/test/results/clientpositive/input18.q.out
index fb6415c06e..67043920d7 100644
--- a/ql/src/test/results/clientpositive/input18.q.out
+++ b/ql/src/test/results/clientpositive/input18.q.out
@@ -52,6 +52,7 @@ STAGE PLANS:
                     expr: regexp_replace(1, '	', '+')
                     type: string
               File Output Operator
+                compressed: false
                 table:
                     input format: org.apache.hadoop.mapred.TextInputFormat
                     output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -61,7 +62,7 @@ STAGE PLANS:
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/input1_limit.q.out b/ql/src/test/results/clientpositive/input1_limit.q.out
index ea3bdbe779..e5ec3b4bff 100644
--- a/ql/src/test/results/clientpositive/input1_limit.q.out
+++ b/ql/src/test/results/clientpositive/input1_limit.q.out
@@ -43,6 +43,7 @@ STAGE PLANS:
                       type: string
                 Limit
                   File Output Operator
+                    compressed: false
                     table:
                         input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                         output format: org.apache.hadoop.mapred.SequenceFileOutputFormat
@@ -52,6 +53,7 @@ STAGE PLANS:
         Extract
           Limit
             File Output Operator
+              compressed: false
               table:
                   input format: org.apache.hadoop.mapred.TextInputFormat
                   output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -61,13 +63,13 @@ STAGE PLANS:
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
                 serde: org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                 name: dest1
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -77,7 +79,7 @@ STAGE PLANS:
   Stage: Stage-2
     Map Reduce
       Alias -> Map Operator Tree:
-        /tmp/hive-njain/842103907/482854493.10002 
+        /tmp/hive-jssarma/891215760/586361272.10002 
           Reduce Output Operator
             sort order: 
             tag: -1
@@ -91,6 +93,7 @@ STAGE PLANS:
         Extract
           Limit
             File Output Operator
+              compressed: false
               table:
                   input format: org.apache.hadoop.mapred.TextInputFormat
                   output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/input20.q.out b/ql/src/test/results/clientpositive/input20.q.out
index 2b8848bcb2..fc4699006f 100644
--- a/ql/src/test/results/clientpositive/input20.q.out
+++ b/ql/src/test/results/clientpositive/input20.q.out
@@ -53,6 +53,7 @@ STAGE PLANS:
                   input format: org.apache.hadoop.mapred.TextInputFormat
                   output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
               File Output Operator
+                compressed: false
                 table:
                     input format: org.apache.hadoop.mapred.TextInputFormat
                     output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -62,7 +63,7 @@ STAGE PLANS:
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/input2_limit.q.out b/ql/src/test/results/clientpositive/input2_limit.q.out
index 3b37675019..194c761b86 100644
--- a/ql/src/test/results/clientpositive/input2_limit.q.out
+++ b/ql/src/test/results/clientpositive/input2_limit.q.out
@@ -22,6 +22,7 @@ STAGE PLANS:
                       type: string
                 Limit
                   File Output Operator
+                    compressed: false
                     table:
                         input format: org.apache.hadoop.mapred.TextInputFormat
                         output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/input3_limit.q.out b/ql/src/test/results/clientpositive/input3_limit.q.out
index 7a56db18bf..4eef49be59 100644
--- a/ql/src/test/results/clientpositive/input3_limit.q.out
+++ b/ql/src/test/results/clientpositive/input3_limit.q.out
@@ -30,6 +30,7 @@ STAGE PLANS:
         Extract
           Limit
             File Output Operator
+              compressed: false
               table:
                   input format: org.apache.hadoop.mapred.TextInputFormat
                   output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -39,7 +40,7 @@ STAGE PLANS:
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/input4.q.out b/ql/src/test/results/clientpositive/input4.q.out
index fb17d9bac0..d435b759e4 100644
--- a/ql/src/test/results/clientpositive/input4.q.out
+++ b/ql/src/test/results/clientpositive/input4.q.out
@@ -8,13 +8,13 @@ STAGE DEPENDENCIES:
 STAGE PLANS:
   Stage: Stage-0
     Copy
-      source: file:/home/njain/workspace/hadoop-0.17/src/contrib/hive/data/files/kv1.txt
-      destination: file:/tmp/hive-njain/-1533162426
+      source: file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/data/files/kv1.txt
+      destination: file:/tmp/hive-jssarma/412426324
 
   Stage: Stage-1
     Move Operator
       tables:
-            replace:
+            replace: false
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/input5.q.out b/ql/src/test/results/clientpositive/input5.q.out
index 4bc103f8ce..3ba463a9fa 100644
--- a/ql/src/test/results/clientpositive/input5.q.out
+++ b/ql/src/test/results/clientpositive/input5.q.out
@@ -50,6 +50,7 @@ STAGE PLANS:
                   expr: 1
                   type: string
             File Output Operator
+              compressed: false
               table:
                   input format: org.apache.hadoop.mapred.TextInputFormat
                   output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -59,7 +60,7 @@ STAGE PLANS:
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/input6.q.out b/ql/src/test/results/clientpositive/input6.q.out
index 341c2291ad..c4667bc8e7 100644
--- a/ql/src/test/results/clientpositive/input6.q.out
+++ b/ql/src/test/results/clientpositive/input6.q.out
@@ -21,6 +21,7 @@ STAGE PLANS:
                       expr: value
                       type: string
                 File Output Operator
+                  compressed: false
                   table:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -30,7 +31,7 @@ STAGE PLANS:
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/input7.q.out b/ql/src/test/results/clientpositive/input7.q.out
index 7f95bad139..e6809edaec 100644
--- a/ql/src/test/results/clientpositive/input7.q.out
+++ b/ql/src/test/results/clientpositive/input7.q.out
@@ -21,6 +21,7 @@ STAGE PLANS:
                       expr: 0
                       type: string
                 File Output Operator
+                  compressed: false
                   table:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -30,7 +31,7 @@ STAGE PLANS:
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/input8.q.out b/ql/src/test/results/clientpositive/input8.q.out
index aa08e1ede6..731e4ada17 100644
--- a/ql/src/test/results/clientpositive/input8.q.out
+++ b/ql/src/test/results/clientpositive/input8.q.out
@@ -23,6 +23,7 @@ STAGE PLANS:
                       expr: (null + null)
                       type: tinyint
                 File Output Operator
+                  compressed: false
                   table:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -32,7 +33,7 @@ STAGE PLANS:
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/input9.q.out b/ql/src/test/results/clientpositive/input9.q.out
index 3caf491784..cec340f498 100644
--- a/ql/src/test/results/clientpositive/input9.q.out
+++ b/ql/src/test/results/clientpositive/input9.q.out
@@ -25,6 +25,7 @@ STAGE PLANS:
                         expr: 0
                         type: string
                   File Output Operator
+                    compressed: false
                     table:
                         input format: org.apache.hadoop.mapred.TextInputFormat
                         output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -34,7 +35,7 @@ STAGE PLANS:
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/input_dynamicserde.q.out b/ql/src/test/results/clientpositive/input_dynamicserde.q.out
index 3f123fb077..98fc2cb7d4 100644
--- a/ql/src/test/results/clientpositive/input_dynamicserde.q.out
+++ b/ql/src/test/results/clientpositive/input_dynamicserde.q.out
@@ -35,6 +35,7 @@ STAGE PLANS:
                       expr: 4
                       type: string
                 File Output Operator
+                  compressed: false
                   table:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -44,7 +45,7 @@ STAGE PLANS:
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/input_part1.q.out b/ql/src/test/results/clientpositive/input_part1.q.out
index ea12b0cfe6..fdec91b650 100644
--- a/ql/src/test/results/clientpositive/input_part1.q.out
+++ b/ql/src/test/results/clientpositive/input_part1.q.out
@@ -25,7 +25,8 @@ STAGE PLANS:
                       expr: ds
                       type: string
                 File Output Operator
-                  directory: /tmp/hive-njain/482622140/1009180747.10000.insclause-0
+                  compressed: false
+                  directory: /tmp/hive-jssarma/547047746/265807002.10000.insclause-0
                   table:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -38,14 +39,14 @@ STAGE PLANS:
                         serialization.lib org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                         file.inputformat org.apache.hadoop.mapred.TextInputFormat
                         file.outputformat org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
-                        location file:/home/njain/workspace/hadoop-0.17/build/contrib/hive/ql/test/data/warehouse/dest1
+                        location file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/dest1
                       serde: org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                       name: dest1
-      Needs Tagging:
+      Needs Tagging: false
       Path -> Alias:
-        file:/home/njain/workspace/hadoop-0.17/build/contrib/hive/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12 
+        file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12 
       Path -> Partition:
-        file:/home/njain/workspace/hadoop-0.17/build/contrib/hive/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12 
+        file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12 
           Partition
             partition values:
               ds 2008-04-08
@@ -63,15 +64,15 @@ STAGE PLANS:
                 serialization.lib org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
-                location file:/home/njain/workspace/hadoop-0.17/build/contrib/hive/ql/test/data/warehouse/srcpart
+                location file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/srcpart
               serde: org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
               name: srcpart
 
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
-            source: /tmp/hive-njain/482622140/1009180747.10000.insclause-0
+            replace: true
+            source: /tmp/hive-jssarma/547047746/265807002.10000.insclause-0
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -84,7 +85,7 @@ STAGE PLANS:
                   serialization.lib org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                   file.inputformat org.apache.hadoop.mapred.TextInputFormat
                   file.outputformat org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
-                  location file:/home/njain/workspace/hadoop-0.17/build/contrib/hive/ql/test/data/warehouse/dest1
+                  location file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/dest1
                 serde: org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                 name: dest1
 
diff --git a/ql/src/test/results/clientpositive/input_part2.q.out b/ql/src/test/results/clientpositive/input_part2.q.out
index 406dcbff58..c442d276dd 100644
--- a/ql/src/test/results/clientpositive/input_part2.q.out
+++ b/ql/src/test/results/clientpositive/input_part2.q.out
@@ -25,7 +25,8 @@ STAGE PLANS:
                       expr: ds
                       type: string
                 File Output Operator
-                  directory: /tmp/hive-njain/238334885/114382058.10000.insclause-0
+                  compressed: false
+                  directory: /tmp/hive-jssarma/478508083/234898564.10000.insclause-0
                   table:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -38,7 +39,7 @@ STAGE PLANS:
                         serialization.lib org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                         file.inputformat org.apache.hadoop.mapred.TextInputFormat
                         file.outputformat org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
-                        location file:/home/njain/workspace/hadoop-0.17/build/contrib/hive/ql/test/data/warehouse/dest1
+                        location file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/dest1
                       serde: org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                       name: dest1
             Filter Operator
@@ -56,7 +57,8 @@ STAGE PLANS:
                       expr: ds
                       type: string
                 File Output Operator
-                  directory: /tmp/hive-njain/238334885/114382058.10001.insclause-1
+                  compressed: false
+                  directory: /tmp/hive-jssarma/478508083/234898564.10001.insclause-1
                   table:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -69,15 +71,15 @@ STAGE PLANS:
                         serialization.lib org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                         file.inputformat org.apache.hadoop.mapred.TextInputFormat
                         file.outputformat org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
-                        location file:/home/njain/workspace/hadoop-0.17/build/contrib/hive/ql/test/data/warehouse/dest2
+                        location file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/dest2
                       serde: org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                       name: dest2
-      Needs Tagging:
+      Needs Tagging: false
       Path -> Alias:
-        file:/home/njain/workspace/hadoop-0.17/build/contrib/hive/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12 
-        file:/home/njain/workspace/hadoop-0.17/build/contrib/hive/ql/test/data/warehouse/srcpart/ds=2008-04-09/hr=12 
+        file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12 
+        file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/srcpart/ds=2008-04-09/hr=12 
       Path -> Partition:
-        file:/home/njain/workspace/hadoop-0.17/build/contrib/hive/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12 
+        file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12 
           Partition
             partition values:
               ds 2008-04-08
@@ -95,10 +97,10 @@ STAGE PLANS:
                 serialization.lib org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
-                location file:/home/njain/workspace/hadoop-0.17/build/contrib/hive/ql/test/data/warehouse/srcpart
+                location file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/srcpart
               serde: org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
               name: srcpart
-        file:/home/njain/workspace/hadoop-0.17/build/contrib/hive/ql/test/data/warehouse/srcpart/ds=2008-04-09/hr=12 
+        file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/srcpart/ds=2008-04-09/hr=12 
           Partition
             partition values:
               ds 2008-04-09
@@ -116,15 +118,15 @@ STAGE PLANS:
                 serialization.lib org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
-                location file:/home/njain/workspace/hadoop-0.17/build/contrib/hive/ql/test/data/warehouse/srcpart
+                location file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/srcpart
               serde: org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
               name: srcpart
 
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
-            source: /tmp/hive-njain/238334885/114382058.10000.insclause-0
+            replace: true
+            source: /tmp/hive-jssarma/478508083/234898564.10000.insclause-0
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -137,11 +139,11 @@ STAGE PLANS:
                   serialization.lib org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                   file.inputformat org.apache.hadoop.mapred.TextInputFormat
                   file.outputformat org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
-                  location file:/home/njain/workspace/hadoop-0.17/build/contrib/hive/ql/test/data/warehouse/dest1
+                  location file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/dest1
                 serde: org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                 name: dest1
-            replace:
-            source: /tmp/hive-njain/238334885/114382058.10001.insclause-1
+            replace: true
+            source: /tmp/hive-jssarma/478508083/234898564.10001.insclause-1
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -154,7 +156,7 @@ STAGE PLANS:
                   serialization.lib org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                   file.inputformat org.apache.hadoop.mapred.TextInputFormat
                   file.outputformat org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
-                  location file:/home/njain/workspace/hadoop-0.17/build/contrib/hive/ql/test/data/warehouse/dest2
+                  location file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/dest2
                 serde: org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                 name: dest2
 
diff --git a/ql/src/test/results/clientpositive/input_part5.q.out b/ql/src/test/results/clientpositive/input_part5.q.out
index d44cd1adbd..e3b0ad3564 100644
--- a/ql/src/test/results/clientpositive/input_part5.q.out
+++ b/ql/src/test/results/clientpositive/input_part5.q.out
@@ -25,6 +25,7 @@ STAGE PLANS:
                       expr: hr
                       type: string
                 File Output Operator
+                  compressed: false
                   table:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/input_part6.q.out b/ql/src/test/results/clientpositive/input_part6.q.out
index 2a8383dafe..55f4000cfd 100644
--- a/ql/src/test/results/clientpositive/input_part6.q.out
+++ b/ql/src/test/results/clientpositive/input_part6.q.out
@@ -26,6 +26,7 @@ STAGE PLANS:
                       type: string
                 Limit
                   File Output Operator
+                    compressed: false
                     table:
                         input format: org.apache.hadoop.mapred.TextInputFormat
                         output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/input_testsequencefile.q.out b/ql/src/test/results/clientpositive/input_testsequencefile.q.out
index e717441470..dd33dcc841 100644
--- a/ql/src/test/results/clientpositive/input_testsequencefile.q.out
+++ b/ql/src/test/results/clientpositive/input_testsequencefile.q.out
@@ -17,6 +17,7 @@ STAGE PLANS:
                     expr: value
                     type: string
               File Output Operator
+                compressed: false
                 table:
                     input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                     output format: org.apache.hadoop.mapred.SequenceFileOutputFormat
@@ -26,7 +27,7 @@ STAGE PLANS:
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                 output format: org.apache.hadoop.mapred.SequenceFileOutputFormat
diff --git a/ql/src/test/results/clientpositive/input_testxpath.q.out b/ql/src/test/results/clientpositive/input_testxpath.q.out
index 84943d5836..def43e944e 100644
--- a/ql/src/test/results/clientpositive/input_testxpath.q.out
+++ b/ql/src/test/results/clientpositive/input_testxpath.q.out
@@ -27,6 +27,7 @@ STAGE PLANS:
                       expr: 2['key_2']
                       type: string
                 File Output Operator
+                  compressed: false
                   table:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -36,7 +37,7 @@ STAGE PLANS:
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/input_testxpath2.q.out b/ql/src/test/results/clientpositive/input_testxpath2.q.out
index fd8128c35e..bf1177ba8b 100644
--- a/ql/src/test/results/clientpositive/input_testxpath2.q.out
+++ b/ql/src/test/results/clientpositive/input_testxpath2.q.out
@@ -31,6 +31,7 @@ STAGE PLANS:
                         expr: size(2)
                         type: int
                   File Output Operator
+                    compressed: false
                     table:
                         input format: org.apache.hadoop.mapred.TextInputFormat
                         output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -40,7 +41,7 @@ STAGE PLANS:
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/input_testxpath3.q.out b/ql/src/test/results/clientpositive/input_testxpath3.q.out
index c0b1fd4740..2f03e6ef85 100644
--- a/ql/src/test/results/clientpositive/input_testxpath3.q.out
+++ b/ql/src/test/results/clientpositive/input_testxpath3.q.out
@@ -23,6 +23,7 @@ STAGE PLANS:
                       expr: 1.myint
                       type: array<int>
                 File Output Operator
+                  compressed: false
                   table:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/inputddl1.q.out b/ql/src/test/results/clientpositive/inputddl1.q.out
index 8c22257836..59839ac3e7 100644
--- a/ql/src/test/results/clientpositive/inputddl1.q.out
+++ b/ql/src/test/results/clientpositive/inputddl1.q.out
@@ -11,7 +11,7 @@ STAGE PLANS:
           columns: key int, value string
           # buckets: -1
           name: INPUTDDL1
-          isExternal:
-          isSequenceFile:
+          isExternal: false
+          isSequenceFile: false
 
 
diff --git a/ql/src/test/results/clientpositive/inputddl2.q.out b/ql/src/test/results/clientpositive/inputddl2.q.out
index 5cfc687c16..bec281fa89 100644
--- a/ql/src/test/results/clientpositive/inputddl2.q.out
+++ b/ql/src/test/results/clientpositive/inputddl2.q.out
@@ -12,8 +12,8 @@ STAGE PLANS:
           # buckets: -1
           partition columns: ds datetime, country string
           name: INPUTDDL2
-          isExternal:
-          isSequenceFile:
+          isExternal: false
+          isSequenceFile: false
 
 
 key	int
diff --git a/ql/src/test/results/clientpositive/inputddl3.q.out b/ql/src/test/results/clientpositive/inputddl3.q.out
index 87dc118b95..c562c3acea 100644
--- a/ql/src/test/results/clientpositive/inputddl3.q.out
+++ b/ql/src/test/results/clientpositive/inputddl3.q.out
@@ -12,8 +12,8 @@ STAGE PLANS:
           field delimiter: 	
           # buckets: -1
           name: INPUTDDL3
-          isExternal:
-          isSequenceFile:
+          isExternal: false
+          isSequenceFile: false
 
 
 key	int
diff --git a/ql/src/test/results/clientpositive/join1.q.out b/ql/src/test/results/clientpositive/join1.q.out
index 1a374501a5..2c161b599d 100644
--- a/ql/src/test/results/clientpositive/join1.q.out
+++ b/ql/src/test/results/clientpositive/join1.q.out
@@ -55,6 +55,7 @@ STAGE PLANS:
                   expr: 2
                   type: string
             File Output Operator
+              compressed: false
               table:
                   input format: org.apache.hadoop.mapred.TextInputFormat
                   output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -64,7 +65,7 @@ STAGE PLANS:
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/join10.q.out b/ql/src/test/results/clientpositive/join10.q.out
index 89475ea1ab..f5539535fd 100644
--- a/ql/src/test/results/clientpositive/join10.q.out
+++ b/ql/src/test/results/clientpositive/join10.q.out
@@ -65,6 +65,7 @@ STAGE PLANS:
                   expr: 2
                   type: string
             File Output Operator
+              compressed: false
               table:
                   input format: org.apache.hadoop.mapred.TextInputFormat
                   output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/join11.q.out b/ql/src/test/results/clientpositive/join11.q.out
index 6b0eaa180b..c573655ac3 100644
--- a/ql/src/test/results/clientpositive/join11.q.out
+++ b/ql/src/test/results/clientpositive/join11.q.out
@@ -69,6 +69,7 @@ STAGE PLANS:
                   expr: 3
                   type: string
             File Output Operator
+              compressed: false
               table:
                   input format: org.apache.hadoop.mapred.TextInputFormat
                   output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/join12.q.out b/ql/src/test/results/clientpositive/join12.q.out
index fdb9d20d58..d52c710f04 100644
--- a/ql/src/test/results/clientpositive/join12.q.out
+++ b/ql/src/test/results/clientpositive/join12.q.out
@@ -96,6 +96,7 @@ STAGE PLANS:
                   expr: 3
                   type: string
             File Output Operator
+              compressed: false
               table:
                   input format: org.apache.hadoop.mapred.TextInputFormat
                   output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/join13.q.out b/ql/src/test/results/clientpositive/join13.q.out
index c731415ebe..8dc24a6ba1 100644
--- a/ql/src/test/results/clientpositive/join13.q.out
+++ b/ql/src/test/results/clientpositive/join13.q.out
@@ -64,6 +64,7 @@ STAGE PLANS:
             0 {VALUE.0} {VALUE.1}
             1 {VALUE.0} {VALUE.1}
           File Output Operator
+            compressed: false
             table:
                 input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                 output format: org.apache.hadoop.mapred.SequenceFileOutputFormat
@@ -130,6 +131,7 @@ STAGE PLANS:
                   expr: 1
                   type: string
             File Output Operator
+              compressed: false
               table:
                   input format: org.apache.hadoop.mapred.TextInputFormat
                   output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/join14.q.out b/ql/src/test/results/clientpositive/join14.q.out
index e7389c359f..8c0e80e259 100644
--- a/ql/src/test/results/clientpositive/join14.q.out
+++ b/ql/src/test/results/clientpositive/join14.q.out
@@ -73,6 +73,7 @@ STAGE PLANS:
                   expr: 2
                   type: string
             File Output Operator
+              compressed: false
               table:
                   input format: org.apache.hadoop.mapred.TextInputFormat
                   output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -82,7 +83,7 @@ STAGE PLANS:
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/join15.q.out b/ql/src/test/results/clientpositive/join15.q.out
index bb9df32471..10532529d3 100644
--- a/ql/src/test/results/clientpositive/join15.q.out
+++ b/ql/src/test/results/clientpositive/join15.q.out
@@ -57,6 +57,7 @@ STAGE PLANS:
                   expr: 3
                   type: string
             File Output Operator
+              compressed: false
               table:
                   input format: org.apache.hadoop.mapred.TextInputFormat
                   output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/join16.q.out b/ql/src/test/results/clientpositive/join16.q.out
index 127fd24b4a..29ff0585cd 100644
--- a/ql/src/test/results/clientpositive/join16.q.out
+++ b/ql/src/test/results/clientpositive/join16.q.out
@@ -79,6 +79,7 @@ STAGE PLANS:
                     expr: 3
                     type: string
               File Output Operator
+                compressed: false
                 table:
                     input format: org.apache.hadoop.mapred.TextInputFormat
                     output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/join17.q.out b/ql/src/test/results/clientpositive/join17.q.out
index 422c21500d..f77e5369c9 100644
--- a/ql/src/test/results/clientpositive/join17.q.out
+++ b/ql/src/test/results/clientpositive/join17.q.out
@@ -39,11 +39,11 @@ STAGE PLANS:
                     type: string
                     expr: value
                     type: string
-      Needs Tagging:
+      Needs Tagging: true
       Path -> Alias:
-        file:/home/njain/workspace/hadoophive/trunk/build/ql/test/data/warehouse/src 
+        file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/src 
       Path -> Partition:
-        file:/home/njain/workspace/hadoophive/trunk/build/ql/test/data/warehouse/src 
+        file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/src 
           Partition
           
               input format: org.apache.hadoop.mapred.TextInputFormat
@@ -57,7 +57,7 @@ STAGE PLANS:
                 serialization.lib org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
-                location file:/home/njain/workspace/hadoophive/trunk/build/ql/test/data/warehouse/src
+                location file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/src
               serde: org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
               name: src
       Reduce Operator Tree:
@@ -78,7 +78,8 @@ STAGE PLANS:
                   expr: 3
                   type: string
             File Output Operator
-              directory: /tmp/hive-njain/562245695/1983405.10000.insclause-0
+              compressed: false
+              directory: /tmp/hive-jssarma/658145143/35270689.10000.insclause-0
               table:
                   input format: org.apache.hadoop.mapred.TextInputFormat
                   output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -91,15 +92,15 @@ STAGE PLANS:
                     serialization.lib org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                     file.inputformat org.apache.hadoop.mapred.TextInputFormat
                     file.outputformat org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
-                    location file:/home/njain/workspace/hadoophive/trunk/build/ql/test/data/warehouse/dest1
+                    location file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/dest1
                   serde: org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                   name: dest1
 
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
-            source: /tmp/hive-njain/562245695/1983405.10000.insclause-0
+            replace: true
+            source: /tmp/hive-jssarma/658145143/35270689.10000.insclause-0
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -112,7 +113,7 @@ STAGE PLANS:
                   serialization.lib org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                   file.inputformat org.apache.hadoop.mapred.TextInputFormat
                   file.outputformat org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
-                  location file:/home/njain/workspace/hadoophive/trunk/build/ql/test/data/warehouse/dest1
+                  location file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/dest1
                 serde: org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                 name: dest1
 
diff --git a/ql/src/test/results/clientpositive/join2.q.out b/ql/src/test/results/clientpositive/join2.q.out
index a637b5bd19..dd6939ce9a 100644
--- a/ql/src/test/results/clientpositive/join2.q.out
+++ b/ql/src/test/results/clientpositive/join2.q.out
@@ -52,6 +52,7 @@ STAGE PLANS:
             0 {VALUE.0}
             1 {VALUE.0}
           File Output Operator
+            compressed: false
             table:
                 input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                 output format: org.apache.hadoop.mapred.SequenceFileOutputFormat
@@ -104,6 +105,7 @@ STAGE PLANS:
                   expr: 3
                   type: string
             File Output Operator
+              compressed: false
               table:
                   input format: org.apache.hadoop.mapred.TextInputFormat
                   output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -113,7 +115,7 @@ STAGE PLANS:
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/join3.q.out b/ql/src/test/results/clientpositive/join3.q.out
index 019bdcce9b..e6fd91946d 100644
--- a/ql/src/test/results/clientpositive/join3.q.out
+++ b/ql/src/test/results/clientpositive/join3.q.out
@@ -74,6 +74,7 @@ STAGE PLANS:
                   expr: 3
                   type: string
             File Output Operator
+              compressed: false
               table:
                   input format: org.apache.hadoop.mapred.TextInputFormat
                   output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -83,7 +84,7 @@ STAGE PLANS:
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/join4.q.out b/ql/src/test/results/clientpositive/join4.q.out
index 856a1e034a..7515d40107 100644
--- a/ql/src/test/results/clientpositive/join4.q.out
+++ b/ql/src/test/results/clientpositive/join4.q.out
@@ -87,6 +87,7 @@ STAGE PLANS:
                     expr: 3
                     type: string
               File Output Operator
+                compressed: false
                 table:
                     input format: org.apache.hadoop.mapred.TextInputFormat
                     output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -96,7 +97,7 @@ STAGE PLANS:
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/join5.q.out b/ql/src/test/results/clientpositive/join5.q.out
index f09e1a3850..6ba3877626 100644
--- a/ql/src/test/results/clientpositive/join5.q.out
+++ b/ql/src/test/results/clientpositive/join5.q.out
@@ -87,6 +87,7 @@ STAGE PLANS:
                     expr: 3
                     type: string
               File Output Operator
+                compressed: false
                 table:
                     input format: org.apache.hadoop.mapred.TextInputFormat
                     output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -96,7 +97,7 @@ STAGE PLANS:
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/join6.q.out b/ql/src/test/results/clientpositive/join6.q.out
index af90f0be96..9d528da3ca 100644
--- a/ql/src/test/results/clientpositive/join6.q.out
+++ b/ql/src/test/results/clientpositive/join6.q.out
@@ -87,6 +87,7 @@ STAGE PLANS:
                     expr: 3
                     type: string
               File Output Operator
+                compressed: false
                 table:
                     input format: org.apache.hadoop.mapred.TextInputFormat
                     output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -96,7 +97,7 @@ STAGE PLANS:
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/join7.q.out b/ql/src/test/results/clientpositive/join7.q.out
index 06c2d1dc20..0b22e297d2 100644
--- a/ql/src/test/results/clientpositive/join7.q.out
+++ b/ql/src/test/results/clientpositive/join7.q.out
@@ -122,6 +122,7 @@ STAGE PLANS:
                     expr: 5
                     type: string
               File Output Operator
+                compressed: false
                 table:
                     input format: org.apache.hadoop.mapred.TextInputFormat
                     output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -131,7 +132,7 @@ STAGE PLANS:
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/join8.q.out b/ql/src/test/results/clientpositive/join8.q.out
index 0cdcde6718..bf6e2ccb51 100644
--- a/ql/src/test/results/clientpositive/join8.q.out
+++ b/ql/src/test/results/clientpositive/join8.q.out
@@ -91,6 +91,7 @@ STAGE PLANS:
                       expr: 3
                       type: string
                 File Output Operator
+                  compressed: false
                   table:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -100,7 +101,7 @@ STAGE PLANS:
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/join9.q.out b/ql/src/test/results/clientpositive/join9.q.out
index fa4caa96a1..4ab3eb6518 100644
--- a/ql/src/test/results/clientpositive/join9.q.out
+++ b/ql/src/test/results/clientpositive/join9.q.out
@@ -49,12 +49,12 @@ STAGE PLANS:
                       type: string
                       expr: 2
                       type: string
-      Needs Tagging:
+      Needs Tagging: true
       Path -> Alias:
-        file:/home/njain/workspace/hadoophive/trunk/build/ql/test/data/warehouse/src 
-        file:/home/njain/workspace/hadoophive/trunk/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12 
+        file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/src 
+        file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12 
       Path -> Partition:
-        file:/home/njain/workspace/hadoophive/trunk/build/ql/test/data/warehouse/src 
+        file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/src 
           Partition
           
               input format: org.apache.hadoop.mapred.TextInputFormat
@@ -68,10 +68,10 @@ STAGE PLANS:
                 serialization.lib org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
-                location file:/home/njain/workspace/hadoophive/trunk/build/ql/test/data/warehouse/src
+                location file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/src
               serde: org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
               name: src
-        file:/home/njain/workspace/hadoophive/trunk/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12 
+        file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12 
           Partition
             partition values:
               ds 2008-04-08
@@ -89,7 +89,7 @@ STAGE PLANS:
                 serialization.lib org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
-                location file:/home/njain/workspace/hadoophive/trunk/build/ql/test/data/warehouse/srcpart
+                location file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/srcpart
               serde: org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
               name: srcpart
       Reduce Operator Tree:
@@ -110,7 +110,8 @@ STAGE PLANS:
                     expr: 4
                     type: string
               File Output Operator
-                directory: /tmp/hive-njain/292054552.10000.insclause-0
+                compressed: false
+                directory: /tmp/hive-jssarma/851341425.10000.insclause-0
                 table:
                     input format: org.apache.hadoop.mapred.TextInputFormat
                     output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -123,15 +124,15 @@ STAGE PLANS:
                       serialization.lib org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                       file.inputformat org.apache.hadoop.mapred.TextInputFormat
                       file.outputformat org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
-                      location file:/home/njain/workspace/hadoophive/trunk/build/ql/test/data/warehouse/dest1
+                      location file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/dest1
                     serde: org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                     name: dest1
 
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
-            source: /tmp/hive-njain/292054552.10000.insclause-0
+            replace: true
+            source: /tmp/hive-jssarma/851341425.10000.insclause-0
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -144,7 +145,7 @@ STAGE PLANS:
                   serialization.lib org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                   file.inputformat org.apache.hadoop.mapred.TextInputFormat
                   file.outputformat org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
-                  location file:/home/njain/workspace/hadoophive/trunk/build/ql/test/data/warehouse/dest1
+                  location file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/dest1
                 serde: org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                 name: dest1
 
diff --git a/ql/src/test/results/clientpositive/mapreduce1.q.out b/ql/src/test/results/clientpositive/mapreduce1.q.out
index 7bd92e0005..ca3273f0ec 100644
--- a/ql/src/test/results/clientpositive/mapreduce1.q.out
+++ b/ql/src/test/results/clientpositive/mapreduce1.q.out
@@ -50,6 +50,7 @@ STAGE PLANS:
       Reduce Operator Tree:
         Extract
           File Output Operator
+            compressed: false
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -59,7 +60,7 @@ STAGE PLANS:
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/mapreduce2.q.out b/ql/src/test/results/clientpositive/mapreduce2.q.out
index 6263b1da66..4da24c73cf 100644
--- a/ql/src/test/results/clientpositive/mapreduce2.q.out
+++ b/ql/src/test/results/clientpositive/mapreduce2.q.out
@@ -45,6 +45,7 @@ STAGE PLANS:
       Reduce Operator Tree:
         Extract
           File Output Operator
+            compressed: false
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -54,7 +55,7 @@ STAGE PLANS:
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/mapreduce3.q.out b/ql/src/test/results/clientpositive/mapreduce3.q.out
index 01ab60d0b9..5da98e7525 100644
--- a/ql/src/test/results/clientpositive/mapreduce3.q.out
+++ b/ql/src/test/results/clientpositive/mapreduce3.q.out
@@ -45,6 +45,7 @@ STAGE PLANS:
       Reduce Operator Tree:
         Extract
           File Output Operator
+            compressed: false
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -54,7 +55,7 @@ STAGE PLANS:
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/mapreduce4.q.out b/ql/src/test/results/clientpositive/mapreduce4.q.out
index c15a333407..d773c0455a 100644
--- a/ql/src/test/results/clientpositive/mapreduce4.q.out
+++ b/ql/src/test/results/clientpositive/mapreduce4.q.out
@@ -50,6 +50,7 @@ STAGE PLANS:
       Reduce Operator Tree:
         Extract
           File Output Operator
+            compressed: false
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -59,7 +60,7 @@ STAGE PLANS:
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/mapreduce5.q.out b/ql/src/test/results/clientpositive/mapreduce5.q.out
index 10c3f2d95c..c1a867c28a 100644
--- a/ql/src/test/results/clientpositive/mapreduce5.q.out
+++ b/ql/src/test/results/clientpositive/mapreduce5.q.out
@@ -45,6 +45,7 @@ STAGE PLANS:
       Reduce Operator Tree:
         Extract
           File Output Operator
+            compressed: false
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -54,7 +55,7 @@ STAGE PLANS:
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/mapreduce6.q.out b/ql/src/test/results/clientpositive/mapreduce6.q.out
index 1ce78371f0..12859eef0a 100644
--- a/ql/src/test/results/clientpositive/mapreduce6.q.out
+++ b/ql/src/test/results/clientpositive/mapreduce6.q.out
@@ -45,6 +45,7 @@ STAGE PLANS:
       Reduce Operator Tree:
         Extract
           File Output Operator
+            compressed: false
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -54,7 +55,7 @@ STAGE PLANS:
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/noalias_subq1.q.out b/ql/src/test/results/clientpositive/noalias_subq1.q.out
index f1e2a2cea8..3069244c87 100644
--- a/ql/src/test/results/clientpositive/noalias_subq1.q.out
+++ b/ql/src/test/results/clientpositive/noalias_subq1.q.out
@@ -25,6 +25,7 @@ STAGE PLANS:
                         expr: 0
                         type: string
                   File Output Operator
+                    compressed: false
                     table:
                         input format: org.apache.hadoop.mapred.TextInputFormat
                         output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/notable_alias1.q.out b/ql/src/test/results/clientpositive/notable_alias1.q.out
index de5d2b6175..c3dde5e031 100644
--- a/ql/src/test/results/clientpositive/notable_alias1.q.out
+++ b/ql/src/test/results/clientpositive/notable_alias1.q.out
@@ -40,6 +40,7 @@ STAGE PLANS:
                 type: string
           mode: partial1
           File Output Operator
+            compressed: false
             table:
                 input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                 output format: org.apache.hadoop.mapred.SequenceFileOutputFormat
@@ -48,7 +49,7 @@ STAGE PLANS:
   Stage: Stage-2
     Map Reduce
       Alias -> Map Operator Tree:
-        /tmp/hive-njain/323467472/558965085.10001 
+        /tmp/hive-jssarma/238416396/213974514.10001 
           Reduce Output Operator
             key expressions:
                   expr: 0
@@ -78,6 +79,7 @@ STAGE PLANS:
                   expr: 1
                   type: bigint
             File Output Operator
+              compressed: false
               table:
                   input format: org.apache.hadoop.mapred.TextInputFormat
                   output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -87,7 +89,7 @@ STAGE PLANS:
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/notable_alias2.q.out b/ql/src/test/results/clientpositive/notable_alias2.q.out
index 87272761dd..7939c446ac 100644
--- a/ql/src/test/results/clientpositive/notable_alias2.q.out
+++ b/ql/src/test/results/clientpositive/notable_alias2.q.out
@@ -40,6 +40,7 @@ STAGE PLANS:
                 type: string
           mode: partial1
           File Output Operator
+            compressed: false
             table:
                 input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                 output format: org.apache.hadoop.mapred.SequenceFileOutputFormat
@@ -48,7 +49,7 @@ STAGE PLANS:
   Stage: Stage-2
     Map Reduce
       Alias -> Map Operator Tree:
-        /tmp/hive-njain/202657451/1070275771.10001 
+        /tmp/hive-jssarma/506681419/141455468.10001 
           Reduce Output Operator
             key expressions:
                   expr: 0
@@ -78,6 +79,7 @@ STAGE PLANS:
                   expr: 1
                   type: bigint
             File Output Operator
+              compressed: false
               table:
                   input format: org.apache.hadoop.mapred.TextInputFormat
                   output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -87,7 +89,7 @@ STAGE PLANS:
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/quote1.q.out b/ql/src/test/results/clientpositive/quote1.q.out
index 014d0db9e9..b4d488c763 100644
--- a/ql/src/test/results/clientpositive/quote1.q.out
+++ b/ql/src/test/results/clientpositive/quote1.q.out
@@ -21,6 +21,7 @@ STAGE PLANS:
                       expr: value
                       type: string
                 File Output Operator
+                  compressed: false
                   table:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -32,7 +33,7 @@ STAGE PLANS:
       tables:
             partition:
               table 2008-04-08
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -65,6 +66,7 @@ STAGE PLANS:
                       expr: table
                       type: string
                 File Output Operator
+                  compressed: false
                   table:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/sample1.q.out b/ql/src/test/results/clientpositive/sample1.q.out
index 827ca59f11..5b10342ffb 100644
--- a/ql/src/test/results/clientpositive/sample1.q.out
+++ b/ql/src/test/results/clientpositive/sample1.q.out
@@ -29,7 +29,8 @@ STAGE PLANS:
                         expr: hr
                         type: string
                   File Output Operator
-                    directory: /tmp/hive-njain/804625404/371878036.10000.insclause-0
+                    compressed: false
+                    directory: /tmp/hive-jssarma/37742099/114802476.10000.insclause-0
                     table:
                         input format: org.apache.hadoop.mapred.TextInputFormat
                         output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -42,14 +43,14 @@ STAGE PLANS:
                           serialization.lib org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                           file.inputformat org.apache.hadoop.mapred.TextInputFormat
                           file.outputformat org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
-                          location file:/home/njain/workspace/hadoop-0.17/build/contrib/hive/ql/test/data/warehouse/dest1
+                          location file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/dest1
                         serde: org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                         name: dest1
-      Needs Tagging:
+      Needs Tagging: false
       Path -> Alias:
-        file:/home/njain/workspace/hadoop-0.17/build/contrib/hive/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 
+        file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 
       Path -> Partition:
-        file:/home/njain/workspace/hadoop-0.17/build/contrib/hive/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 
+        file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 
           Partition
             partition values:
               ds 2008-04-08
@@ -67,15 +68,15 @@ STAGE PLANS:
                 serialization.lib org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
-                location file:/home/njain/workspace/hadoop-0.17/build/contrib/hive/ql/test/data/warehouse/srcpart
+                location file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/srcpart
               serde: org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
               name: srcpart
 
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
-            source: /tmp/hive-njain/804625404/371878036.10000.insclause-0
+            replace: true
+            source: /tmp/hive-jssarma/37742099/114802476.10000.insclause-0
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -88,7 +89,7 @@ STAGE PLANS:
                   serialization.lib org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                   file.inputformat org.apache.hadoop.mapred.TextInputFormat
                   file.outputformat org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
-                  location file:/home/njain/workspace/hadoop-0.17/build/contrib/hive/ql/test/data/warehouse/dest1
+                  location file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/dest1
                 serde: org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                 name: dest1
 
diff --git a/ql/src/test/results/clientpositive/sample2.q.out b/ql/src/test/results/clientpositive/sample2.q.out
index 4deae7ac65..d9ce0c10e6 100644
--- a/ql/src/test/results/clientpositive/sample2.q.out
+++ b/ql/src/test/results/clientpositive/sample2.q.out
@@ -17,7 +17,8 @@ STAGE PLANS:
                     expr: value
                     type: string
               File Output Operator
-                directory: /tmp/hive-njain/74225087/82847953.10000.insclause-0
+                compressed: false
+                directory: /tmp/hive-jssarma/515988900/822291761.10000.insclause-0
                 table:
                     input format: org.apache.hadoop.mapred.TextInputFormat
                     output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -30,14 +31,14 @@ STAGE PLANS:
                       serialization.lib org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                       file.inputformat org.apache.hadoop.mapred.TextInputFormat
                       file.outputformat org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
-                      location file:/home/njain/workspace/hadoop-0.17/build/contrib/hive/ql/test/data/warehouse/dest1
+                      location file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/dest1
                     serde: org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                     name: dest1
-      Needs Tagging:
+      Needs Tagging: false
       Path -> Alias:
-        file:/home/njain/workspace/hadoop-0.17/build/contrib/hive/ql/test/data/warehouse/srcbucket/kv1.txt 
+        file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/srcbucket/kv1.txt 
       Path -> Partition:
-        file:/home/njain/workspace/hadoop-0.17/build/contrib/hive/ql/test/data/warehouse/srcbucket/kv1.txt 
+        file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/srcbucket/kv1.txt 
           Partition
           
               input format: org.apache.hadoop.mapred.TextInputFormat
@@ -52,15 +53,15 @@ STAGE PLANS:
                 serialization.lib org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
-                location file:/home/njain/workspace/hadoop-0.17/build/contrib/hive/ql/test/data/warehouse/srcbucket
+                location file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/srcbucket
               serde: org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
               name: srcbucket
 
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
-            source: /tmp/hive-njain/74225087/82847953.10000.insclause-0
+            replace: true
+            source: /tmp/hive-jssarma/515988900/822291761.10000.insclause-0
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -73,7 +74,7 @@ STAGE PLANS:
                   serialization.lib org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                   file.inputformat org.apache.hadoop.mapred.TextInputFormat
                   file.outputformat org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
-                  location file:/home/njain/workspace/hadoop-0.17/build/contrib/hive/ql/test/data/warehouse/dest1
+                  location file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/dest1
                 serde: org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                 name: dest1
 
diff --git a/ql/src/test/results/clientpositive/sample3.q.out b/ql/src/test/results/clientpositive/sample3.q.out
index 5c2f51ae4a..2ccad5f834 100644
--- a/ql/src/test/results/clientpositive/sample3.q.out
+++ b/ql/src/test/results/clientpositive/sample3.q.out
@@ -23,6 +23,7 @@ STAGE PLANS:
                         expr: 0
                         type: string
                   File Output Operator
+                    compressed: false
                     table:
                         input format: org.apache.hadoop.mapred.TextInputFormat
                         output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/sample4.q.out b/ql/src/test/results/clientpositive/sample4.q.out
index 716fa1e057..c9ca2eb5ad 100644
--- a/ql/src/test/results/clientpositive/sample4.q.out
+++ b/ql/src/test/results/clientpositive/sample4.q.out
@@ -17,7 +17,8 @@ STAGE PLANS:
                     expr: value
                     type: string
               File Output Operator
-                directory: /tmp/hive-njain/402231827/160820937.10000.insclause-0
+                compressed: false
+                directory: /tmp/hive-jssarma/1539308576/222195283.10000.insclause-0
                 table:
                     input format: org.apache.hadoop.mapred.TextInputFormat
                     output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -30,14 +31,14 @@ STAGE PLANS:
                       serialization.lib org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                       file.inputformat org.apache.hadoop.mapred.TextInputFormat
                       file.outputformat org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
-                      location file:/home/njain/workspace/hadoop-0.17/build/contrib/hive/ql/test/data/warehouse/dest1
+                      location file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/dest1
                     serde: org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                     name: dest1
-      Needs Tagging:
+      Needs Tagging: false
       Path -> Alias:
-        file:/home/njain/workspace/hadoop-0.17/build/contrib/hive/ql/test/data/warehouse/srcbucket/kv1.txt 
+        file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/srcbucket/kv1.txt 
       Path -> Partition:
-        file:/home/njain/workspace/hadoop-0.17/build/contrib/hive/ql/test/data/warehouse/srcbucket/kv1.txt 
+        file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/srcbucket/kv1.txt 
           Partition
           
               input format: org.apache.hadoop.mapred.TextInputFormat
@@ -52,15 +53,15 @@ STAGE PLANS:
                 serialization.lib org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
-                location file:/home/njain/workspace/hadoop-0.17/build/contrib/hive/ql/test/data/warehouse/srcbucket
+                location file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/srcbucket
               serde: org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
               name: srcbucket
 
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
-            source: /tmp/hive-njain/402231827/160820937.10000.insclause-0
+            replace: true
+            source: /tmp/hive-jssarma/1539308576/222195283.10000.insclause-0
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -73,7 +74,7 @@ STAGE PLANS:
                   serialization.lib org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                   file.inputformat org.apache.hadoop.mapred.TextInputFormat
                   file.outputformat org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
-                  location file:/home/njain/workspace/hadoop-0.17/build/contrib/hive/ql/test/data/warehouse/dest1
+                  location file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/dest1
                 serde: org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                 name: dest1
 
diff --git a/ql/src/test/results/clientpositive/sample5.q.out b/ql/src/test/results/clientpositive/sample5.q.out
index 44bd0e9a89..adfeda5a5b 100644
--- a/ql/src/test/results/clientpositive/sample5.q.out
+++ b/ql/src/test/results/clientpositive/sample5.q.out
@@ -21,7 +21,8 @@ STAGE PLANS:
                       expr: value
                       type: string
                 File Output Operator
-                  directory: /tmp/hive-njain/126424010/37680496.10000.insclause-0
+                  compressed: false
+                  directory: /tmp/hive-jssarma/611887541/74229442.10000.insclause-0
                   table:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -34,14 +35,14 @@ STAGE PLANS:
                         serialization.lib org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                         file.inputformat org.apache.hadoop.mapred.TextInputFormat
                         file.outputformat org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
-                        location file:/home/njain/workspace/hadoop-0.17/build/contrib/hive/ql/test/data/warehouse/dest1
+                        location file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/dest1
                       serde: org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                       name: dest1
-      Needs Tagging:
+      Needs Tagging: false
       Path -> Alias:
-        file:/home/njain/workspace/hadoop-0.17/build/contrib/hive/ql/test/data/warehouse/srcbucket 
+        file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/srcbucket 
       Path -> Partition:
-        file:/home/njain/workspace/hadoop-0.17/build/contrib/hive/ql/test/data/warehouse/srcbucket 
+        file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/srcbucket 
           Partition
           
               input format: org.apache.hadoop.mapred.TextInputFormat
@@ -56,15 +57,15 @@ STAGE PLANS:
                 serialization.lib org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
-                location file:/home/njain/workspace/hadoop-0.17/build/contrib/hive/ql/test/data/warehouse/srcbucket
+                location file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/srcbucket
               serde: org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
               name: srcbucket
 
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
-            source: /tmp/hive-njain/126424010/37680496.10000.insclause-0
+            replace: true
+            source: /tmp/hive-jssarma/611887541/74229442.10000.insclause-0
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -77,7 +78,7 @@ STAGE PLANS:
                   serialization.lib org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                   file.inputformat org.apache.hadoop.mapred.TextInputFormat
                   file.outputformat org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
-                  location file:/home/njain/workspace/hadoop-0.17/build/contrib/hive/ql/test/data/warehouse/dest1
+                  location file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/dest1
                 serde: org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                 name: dest1
 
diff --git a/ql/src/test/results/clientpositive/sample6.q.out b/ql/src/test/results/clientpositive/sample6.q.out
index 600dc265ae..728061238b 100644
--- a/ql/src/test/results/clientpositive/sample6.q.out
+++ b/ql/src/test/results/clientpositive/sample6.q.out
@@ -21,7 +21,8 @@ STAGE PLANS:
                       expr: value
                       type: string
                 File Output Operator
-                  directory: /tmp/hive-njain/57994069/1680944185.10000.insclause-0
+                  compressed: false
+                  directory: /tmp/hive-jssarma/862051292/1235999863.10000.insclause-0
                   table:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -34,14 +35,14 @@ STAGE PLANS:
                         serialization.lib org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                         file.inputformat org.apache.hadoop.mapred.TextInputFormat
                         file.outputformat org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
-                        location file:/home/njain/workspace/hadoop-0.17/build/contrib/hive/ql/test/data/warehouse/dest1
+                        location file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/dest1
                       serde: org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                       name: dest1
-      Needs Tagging:
+      Needs Tagging: false
       Path -> Alias:
-        file:/home/njain/workspace/hadoop-0.17/build/contrib/hive/ql/test/data/warehouse/srcbucket/kv1.txt 
+        file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/srcbucket/kv1.txt 
       Path -> Partition:
-        file:/home/njain/workspace/hadoop-0.17/build/contrib/hive/ql/test/data/warehouse/srcbucket/kv1.txt 
+        file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/srcbucket/kv1.txt 
           Partition
           
               input format: org.apache.hadoop.mapred.TextInputFormat
@@ -56,15 +57,15 @@ STAGE PLANS:
                 serialization.lib org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
-                location file:/home/njain/workspace/hadoop-0.17/build/contrib/hive/ql/test/data/warehouse/srcbucket
+                location file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/srcbucket
               serde: org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
               name: srcbucket
 
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
-            source: /tmp/hive-njain/57994069/1680944185.10000.insclause-0
+            replace: true
+            source: /tmp/hive-jssarma/862051292/1235999863.10000.insclause-0
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -77,7 +78,7 @@ STAGE PLANS:
                   serialization.lib org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                   file.inputformat org.apache.hadoop.mapred.TextInputFormat
                   file.outputformat org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
-                  location file:/home/njain/workspace/hadoop-0.17/build/contrib/hive/ql/test/data/warehouse/dest1
+                  location file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/dest1
                 serde: org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                 name: dest1
 
diff --git a/ql/src/test/results/clientpositive/sample7.q.out b/ql/src/test/results/clientpositive/sample7.q.out
index 74800013b0..826ff0613c 100644
--- a/ql/src/test/results/clientpositive/sample7.q.out
+++ b/ql/src/test/results/clientpositive/sample7.q.out
@@ -25,7 +25,8 @@ STAGE PLANS:
                         expr: value
                         type: string
                   File Output Operator
-                    directory: /tmp/hive-njain/682589217/559576387.10000.insclause-0
+                    compressed: false
+                    directory: /tmp/hive-jssarma/429463772/457590891.10000.insclause-0
                     table:
                         input format: org.apache.hadoop.mapred.TextInputFormat
                         output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -38,14 +39,14 @@ STAGE PLANS:
                           serialization.lib org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                           file.inputformat org.apache.hadoop.mapred.TextInputFormat
                           file.outputformat org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
-                          location file:/home/njain/workspace/hadoop-0.17/build/contrib/hive/ql/test/data/warehouse/dest1
+                          location file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/dest1
                         serde: org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                         name: dest1
-      Needs Tagging:
+      Needs Tagging: false
       Path -> Alias:
-        file:/home/njain/workspace/hadoop-0.17/build/contrib/hive/ql/test/data/warehouse/srcbucket/kv1.txt 
+        file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/srcbucket/kv1.txt 
       Path -> Partition:
-        file:/home/njain/workspace/hadoop-0.17/build/contrib/hive/ql/test/data/warehouse/srcbucket/kv1.txt 
+        file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/srcbucket/kv1.txt 
           Partition
           
               input format: org.apache.hadoop.mapred.TextInputFormat
@@ -60,15 +61,15 @@ STAGE PLANS:
                 serialization.lib org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
-                location file:/home/njain/workspace/hadoop-0.17/build/contrib/hive/ql/test/data/warehouse/srcbucket
+                location file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/srcbucket
               serde: org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
               name: srcbucket
 
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
-            source: /tmp/hive-njain/682589217/559576387.10000.insclause-0
+            replace: true
+            source: /tmp/hive-jssarma/429463772/457590891.10000.insclause-0
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -81,7 +82,7 @@ STAGE PLANS:
                   serialization.lib org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                   file.inputformat org.apache.hadoop.mapred.TextInputFormat
                   file.outputformat org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
-                  location file:/home/njain/workspace/hadoop-0.17/build/contrib/hive/ql/test/data/warehouse/dest1
+                  location file:/mnt/vol/devrs004.snc1/jssarma/projects/hive-trunk-compress/build/ql/test/data/warehouse/dest1
                 serde: org.apache.hadoop.hive.serde2.MetadataTypedColumnsetSerDe
                 name: dest1
 
diff --git a/ql/src/test/results/clientpositive/subq.q.out b/ql/src/test/results/clientpositive/subq.q.out
index 9050c1be95..adeb0cf1f7 100644
--- a/ql/src/test/results/clientpositive/subq.q.out
+++ b/ql/src/test/results/clientpositive/subq.q.out
@@ -27,6 +27,7 @@ STAGE PLANS:
                         expr: 1
                         type: string
                   File Output Operator
+                    compressed: false
                     table:
                         input format: org.apache.hadoop.mapred.TextInputFormat
                         output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -34,7 +35,7 @@ STAGE PLANS:
   Stage: Stage-0
     Move Operator
       files:
-            hdfs directory:
+            hdfs directory: true
             destination: ../build/ql/test/data/warehouse/union.out
 
 
diff --git a/ql/src/test/results/clientpositive/subq2.q.out b/ql/src/test/results/clientpositive/subq2.q.out
index c0b8e44393..5d8e09aafa 100644
--- a/ql/src/test/results/clientpositive/subq2.q.out
+++ b/ql/src/test/results/clientpositive/subq2.q.out
@@ -36,6 +36,7 @@ STAGE PLANS:
                 type: string
           mode: partial1
           File Output Operator
+            compressed: false
             table:
                 input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                 output format: org.apache.hadoop.mapred.SequenceFileOutputFormat
@@ -44,7 +45,7 @@ STAGE PLANS:
   Stage: Stage-2
     Map Reduce
       Alias -> Map Operator Tree:
-        /tmp/hive-njain/611234651/29133673.10002 
+        /tmp/hive-jssarma/438302216/1483130688.10002 
           Reduce Output Operator
             key expressions:
                   expr: 0
@@ -82,6 +83,7 @@ STAGE PLANS:
                       expr: 1
                       type: bigint
                 File Output Operator
+                  compressed: false
                   table:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/udf1.q.out b/ql/src/test/results/clientpositive/udf1.q.out
index 6f8f71ec14..616d337d44 100644
--- a/ql/src/test/results/clientpositive/udf1.q.out
+++ b/ql/src/test/results/clientpositive/udf1.q.out
@@ -55,6 +55,7 @@ STAGE PLANS:
                         expr: regexp_replace('hadoop', '(.)[a-z]*', '$1ive')
                         type: string
                   File Output Operator
+                    compressed: false
                     table:
                         input format: org.apache.hadoop.mapred.TextInputFormat
                         output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -64,7 +65,7 @@ STAGE PLANS:
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/udf2.q.out b/ql/src/test/results/clientpositive/udf2.q.out
index 14a0adc5ca..ce5be6042e 100644
--- a/ql/src/test/results/clientpositive/udf2.q.out
+++ b/ql/src/test/results/clientpositive/udf2.q.out
@@ -27,6 +27,7 @@ STAGE PLANS:
                     expr: '|'
                     type: string
               File Output Operator
+                compressed: false
                 table:
                     input format: org.apache.hadoop.mapred.TextInputFormat
                     output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/udf3.q.out b/ql/src/test/results/clientpositive/udf3.q.out
index e2c861b798..2d28343380 100644
--- a/ql/src/test/results/clientpositive/udf3.q.out
+++ b/ql/src/test/results/clientpositive/udf3.q.out
@@ -31,6 +31,7 @@ STAGE PLANS:
                 expr: min(UDFToDouble(VALUE.0))
           mode: partial1
           File Output Operator
+            compressed: false
             table:
                 input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                 output format: org.apache.hadoop.mapred.SequenceFileOutputFormat
@@ -39,7 +40,7 @@ STAGE PLANS:
   Stage: Stage-2
     Map Reduce
       Alias -> Map Operator Tree:
-        /tmp/hive-njain/650928980/125435985.10001 
+        /tmp/hive-jssarma/1415018212/1021817615.10001 
           Reduce Output Operator
             sort order: 
             tag: -1
@@ -76,6 +77,7 @@ STAGE PLANS:
                   expr: 0
                   type: double
             File Output Operator
+              compressed: false
               table:
                   input format: org.apache.hadoop.mapred.TextInputFormat
                   output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -85,7 +87,7 @@ STAGE PLANS:
   Stage: Stage-0
     Move Operator
       tables:
-            replace:
+            replace: true
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/udf4.q.out b/ql/src/test/results/clientpositive/udf4.q.out
index 3eb982cda2..b39cec47a8 100644
--- a/ql/src/test/results/clientpositive/udf4.q.out
+++ b/ql/src/test/results/clientpositive/udf4.q.out
@@ -46,6 +46,7 @@ STAGE PLANS:
                       expr: ~ 1
                       type: int
                 File Output Operator
+                  compressed: false
                   table:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/udf5.q.out b/ql/src/test/results/clientpositive/udf5.q.out
index 8e8b8df419..68fc575832 100644
--- a/ql/src/test/results/clientpositive/udf5.q.out
+++ b/ql/src/test/results/clientpositive/udf5.q.out
@@ -30,6 +30,7 @@ STAGE PLANS:
                       expr: year('2008-11-01 15:32:20')
                       type: int
                 File Output Operator
+                  compressed: false
                   table:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/union.q.out b/ql/src/test/results/clientpositive/union.q.out
index ebd7fd53bb..d7317e45c8 100644
--- a/ql/src/test/results/clientpositive/union.q.out
+++ b/ql/src/test/results/clientpositive/union.q.out
@@ -27,6 +27,7 @@ STAGE PLANS:
                           expr: 1
                           type: string
                     File Output Operator
+                      compressed: false
                       table:
                           input format: org.apache.hadoop.mapred.TextInputFormat
                           output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -48,6 +49,7 @@ STAGE PLANS:
                           expr: 1
                           type: string
                     File Output Operator
+                      compressed: false
                       table:
                           input format: org.apache.hadoop.mapred.TextInputFormat
                           output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
@@ -55,7 +57,7 @@ STAGE PLANS:
   Stage: Stage-0
     Move Operator
       files:
-            hdfs directory:
+            hdfs directory: true
             destination: ../build/ql/test/data/warehouse/union.out
 
 
diff --git a/ql/src/test/results/clientpositive/union2.q.out b/ql/src/test/results/clientpositive/union2.q.out
index 52c942e1c3..d42c934abd 100644
--- a/ql/src/test/results/clientpositive/union2.q.out
+++ b/ql/src/test/results/clientpositive/union2.q.out
@@ -48,6 +48,7 @@ STAGE PLANS:
                 expr: count(VALUE.0)
           mode: partial1
           File Output Operator
+            compressed: false
             table:
                 input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                 output format: org.apache.hadoop.mapred.SequenceFileOutputFormat
@@ -56,7 +57,7 @@ STAGE PLANS:
   Stage: Stage-2
     Map Reduce
       Alias -> Map Operator Tree:
-        /tmp/hive-njain/351706607/217456705.10002 
+        /tmp/hive-jssarma/32027196/47394207.10002 
           Reduce Output Operator
             sort order: 
             tag: -1
@@ -73,6 +74,7 @@ STAGE PLANS:
                   expr: 0
                   type: bigint
             File Output Operator
+              compressed: false
               table:
                   input format: org.apache.hadoop.mapred.TextInputFormat
                   output format: org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat
