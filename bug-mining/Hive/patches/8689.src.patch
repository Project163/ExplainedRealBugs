diff --git a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/calcite/rules/HiveAggregateReduceFunctionsRule.java b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/calcite/rules/HiveAggregateReduceFunctionsRule.java
index 10bfe66200..61c54bff70 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/calcite/rules/HiveAggregateReduceFunctionsRule.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/calcite/rules/HiveAggregateReduceFunctionsRule.java
@@ -16,6 +16,7 @@
  */
 package org.apache.hadoop.hive.ql.optimizer.calcite.rules;
 
+import com.google.common.base.Preconditions;
 import com.google.common.collect.ImmutableList;
 import com.google.common.collect.Lists;
 import com.google.common.collect.Maps;
@@ -36,6 +37,7 @@
 import org.apache.calcite.sql.fun.SqlStdOperatorTable;
 import org.apache.calcite.sql.type.InferTypes;
 import org.apache.calcite.sql.type.ReturnTypes;
+import org.apache.calcite.sql.type.SqlTypeFamily;
 import org.apache.calcite.sql.type.SqlTypeName;
 import org.apache.calcite.sql.type.SqlTypeUtil;
 import org.apache.calcite.tools.RelBuilder;
@@ -110,6 +112,7 @@ public HiveAggregateReduceFunctionsRule() {
     return containsAvgStddevVarCall(oldAggRel.getAggCallList());
   }
 
+  @Override
   public void onMatch(RelOptRuleCall ruleCall) {
     Aggregate oldAggRel = (Aggregate) ruleCall.rels[0];
     reduceAggs(ruleCall, oldAggRel);
@@ -156,15 +159,14 @@ private void reduceAggs(
 
     List<AggregateCall> oldCalls = oldAggRel.getAggCallList();
     final int groupCount = oldAggRel.getGroupCount();
-    final int indicatorCount = oldAggRel.getIndicatorCount();
 
     final List<AggregateCall> newCalls = Lists.newArrayList();
     final Map<AggregateCall, RexNode> aggCallMapping = Maps.newHashMap();
 
     final List<RexNode> projList = Lists.newArrayList();
 
-    // pass through group key (+ indicators if present)
-    for (int i = 0; i < groupCount + indicatorCount; ++i) {
+    // pass through group key
+    for (int i = 0; i < groupCount; ++i) {
       projList.add(
           rexBuilder.makeInputRef(
               getFieldType(oldAggRel, i),
@@ -252,7 +254,6 @@ private RexNode reduceAgg(
               oldAggRel.getInput().getRowType(), oldCall.getArgList());
       return rexBuilder.addAggCall(oldCall,
           nGroups,
-          oldAggRel.indicator,
           newCalls,
           aggCallMapping,
           oldArgTypes);
@@ -273,8 +274,10 @@ private AggregateCall createAggregateCallWithBinding(
     return AggregateCall.create(aggFunction,
         oldCall.isDistinct(),
         oldCall.isApproximate(),
+        oldCall.ignoreNulls(),
         ImmutableIntList.of(argOrdinal),
         oldCall.filterArg,
+        oldCall.getCollation(),
         aggFunction.inferReturnType(binding),
         null);
   }
@@ -332,11 +335,13 @@ private RexNode reduceAvg(
     final int nGroups = oldAggRel.getGroupCount();
     final RexBuilder rexBuilder = oldAggRel.getCluster().getRexBuilder();
     final RelDataTypeFactory typeFactory = oldAggRel.getCluster().getTypeFactory();
-    final int iAvgInput = oldCall.getArgList().get(0);
-    final RelDataType avgInputType = typeFactory.createTypeWithNullability(
-        getFieldType(oldAggRel.getInput(), iAvgInput), true);
+
+    Preconditions.checkState(oldCall.getArgList().size() == 1);
+    // We compute SUM with either BIGINT, DOUBLE, or DECIMAL
+    final RexNode arg = getAvgInput(inputExprs.get(oldCall.getArgList().get(0)), rexBuilder, typeFactory);
+    final List<Integer> argIndices = Collections.singletonList(lookupOrAdd(inputExprs, arg));
     final RelDataType sumReturnType = getSumReturnType(
-        rexBuilder.getTypeFactory(), avgInputType);
+        rexBuilder.getTypeFactory(), arg.getType());
     final AggregateCall sumCall =
         AggregateCall.create(
             new HiveSqlSumAggFunction(
@@ -346,13 +351,14 @@ private RexNode reduceAvg(
                 oldCall.getAggregation().getOperandTypeChecker()), //SqlStdOperatorTable.SUM,
             oldCall.isDistinct(),
             oldCall.isApproximate(),
-            oldCall.getArgList(),
+            oldCall.ignoreNulls(),
+            argIndices,
             oldCall.filterArg,
-            oldAggRel.getGroupCount(),
-            oldAggRel.getInput(),
-            null,
+            oldCall.getCollation(),
+            sumReturnType,
             null);
-    RelDataType countRetType = typeFactory.createTypeWithNullability(
+    // The denominator of AVG is always BIGINT
+    final RelDataType countRetType = typeFactory.createTypeWithNullability(
         typeFactory.createSqlType(SqlTypeName.BIGINT), true);
     final AggregateCall countCall =
         AggregateCall.create(
@@ -363,10 +369,11 @@ private RexNode reduceAvg(
                 oldCall.getAggregation().getOperandTypeChecker()), //SqlStdOperatorTable.COUNT,
             oldCall.isDistinct(),
             oldCall.isApproximate(),
-            oldCall.getArgList(),
+            oldCall.ignoreNulls(),
+            // We need to use the cast argument here to apply the same null-check as SUM
+            argIndices,
             oldCall.filterArg,
-            oldAggRel.getGroupCount(),
-            oldAggRel.getInput(),
+            oldCall.getCollation(),
             countRetType,
             null);
 
@@ -375,17 +382,15 @@ private RexNode reduceAvg(
     RexNode numeratorRef =
         rexBuilder.addAggCall(sumCall,
             nGroups,
-            oldAggRel.indicator,
             newCalls,
             aggCallMapping,
-            ImmutableList.of(avgInputType));
+            ImmutableList.of(arg.getType()));
     final RexNode denominatorRef =
         rexBuilder.addAggCall(countCall,
             nGroups,
-            oldAggRel.indicator,
             newCalls,
             aggCallMapping,
-            ImmutableList.of(avgInputType));
+            ImmutableList.of(arg.getType()));
 
     if (numeratorRef.getType().getSqlTypeName() != SqlTypeName.DECIMAL) {
       // If type is not decimal, we enforce the same type as the avg to comply with
@@ -421,14 +426,11 @@ private RexNode reduceStddev(
     final RexBuilder rexBuilder = cluster.getRexBuilder();
     final RelDataTypeFactory typeFactory = cluster.getTypeFactory();
 
-    assert oldCall.getArgList().size() == 1 : oldCall.getArgList();
-    final int argOrdinal = oldCall.getArgList().get(0);
-    final RelDataType argOrdinalType = getFieldType(oldAggRel.getInput(), argOrdinal);
+    Preconditions.checkState(oldCall.getArgList().size() == 1);
     final RelDataType oldCallType =
         typeFactory.createTypeWithNullability(oldCall.getType(), true);
 
-    final RexNode argRef =
-        rexBuilder.ensureType(oldCallType, inputExprs.get(argOrdinal), false);
+    final RexNode argRef = rexBuilder.ensureType(oldCallType, inputExprs.get(oldCall.getArgList().get(0)), false);
     final int argRefOrdinal = lookupOrAdd(inputExprs, argRef);
     final RelDataType sumReturnType = getSumReturnType(
         rexBuilder.getTypeFactory(), argRef.getType());
@@ -451,7 +453,6 @@ private RexNode reduceStddev(
     final RexNode sumArgSquared =
         rexBuilder.addAggCall(sumArgSquaredAggCall,
             nGroups,
-            oldAggRel.indicator,
             newCalls,
             aggCallMapping,
             ImmutableList.of(sumArgSquaredAggCall.getType()));
@@ -461,21 +462,20 @@ private RexNode reduceStddev(
             new HiveSqlSumAggFunction(
                 oldCall.isDistinct(),
                 ReturnTypes.explicit(sumReturnType),
-                InferTypes.explicit(Collections.singletonList(argOrdinalType)),
+                InferTypes.explicit(Collections.singletonList(argRef.getType())),
                 oldCall.getAggregation().getOperandTypeChecker()), //SqlStdOperatorTable.SUM,
             oldCall.isDistinct(),
             oldCall.isApproximate(),
+            oldCall.ignoreNulls(),
             ImmutableIntList.of(argRefOrdinal),
             oldCall.filterArg,
-            oldAggRel.getGroupCount(),
-            oldAggRel.getInput(),
-            null,
+            oldCall.getCollation(),
+            sumReturnType,
             null);
 
     final RexNode sumArg =
         rexBuilder.addAggCall(sumArgAggCall,
             nGroups,
-            oldAggRel.indicator,
             newCalls,
             aggCallMapping,
             ImmutableList.of(sumArgAggCall.getType()));
@@ -484,7 +484,8 @@ private RexNode reduceStddev(
         rexBuilder.makeCall(
             SqlStdOperatorTable.MULTIPLY, sumArgCast, sumArgCast);
 
-    RelDataType countRetType = typeFactory.createTypeWithNullability(typeFactory.createSqlType(SqlTypeName.BIGINT), true);
+    // COUNT always retains the number of elements as BIGINT
+    final RelDataType countRetType = typeFactory.createTypeWithNullability(typeFactory.createSqlType(SqlTypeName.BIGINT), true);
     final AggregateCall countArgAggCall =
         AggregateCall.create(
             new HiveSqlCountAggFunction(
@@ -494,20 +495,20 @@ private RexNode reduceStddev(
                 oldCall.getAggregation().getOperandTypeChecker()), //SqlStdOperatorTable.COUNT,
             oldCall.isDistinct(),
             oldCall.isApproximate(),
-            oldCall.getArgList(),
+            oldCall.ignoreNulls(),
+            // We need to use the cast argument here to null-check it with the same logic as SUM
+            ImmutableIntList.of(argRefOrdinal),
             oldCall.filterArg,
-            oldAggRel.getGroupCount(),
-            oldAggRel.getInput(),
+            oldCall.getCollation(),
             countRetType,
             null);
 
     final RexNode countArg =
         rexBuilder.addAggCall(countArgAggCall,
             nGroups,
-            oldAggRel.indicator,
             newCalls,
             aggCallMapping,
-            ImmutableList.of(argOrdinalType));
+            ImmutableList.of(argRef.getType()));
 
     final RexNode avgSumSquaredArg =
         rexBuilder.makeCall(
@@ -524,8 +525,7 @@ private RexNode reduceStddev(
     } else {
       final RexLiteral one =
           rexBuilder.makeExactLiteral(BigDecimal.ONE);
-      final RexNode nul =
-          rexBuilder.makeCast(countArg.getType(), rexBuilder.constantNull());
+      final RexNode nul = rexBuilder.makeNullLiteral(countArg.getType());
       final RexNode countMinusOne =
           rexBuilder.makeCall(
               SqlStdOperatorTable.MINUS, countArg, one);
@@ -596,6 +596,23 @@ private RelDataType getFieldType(RelNode relNode, int i) {
     return inputField.getType();
   }
 
+  private RexNode getAvgInput(RexNode input, RexBuilder rexBuilder, RelDataTypeFactory typeFactory) {
+    if (input.getType().getSqlTypeName().getFamily() == SqlTypeFamily.CHARACTER) {
+      // GenericUDAFSum implicitly casts texts into DOUBLE. That conversion could generate NULL when the text is not a
+      // valid numeric expression.
+      // So, we have to explicitly cast those types here. Otherwise, The COUNT UDF can evaluate values with inconsistent
+      // semantics with SUM.
+      // For example, if a set of values are `"10"`, `"invalid"` and `"20"`, the average should be (10 + 20) / 2 = 15.
+      // Without excluding invalid numeric texts, the result becomes (10 + 20) / 3 = 10.
+      // Additionally, SUM and COUNT should refer to the same cast expression so that they can reuse the same column
+      // as their input. Otherwise, we may need double columns of `x` for SUM and `CAST(x AS DOUBLE)` for COUNT.
+      final RelDataType targetType = typeFactory.createSqlType(SqlTypeName.DOUBLE);
+      final RelDataType nullableTargetType = typeFactory.createTypeWithNullability(targetType, true);
+      return rexBuilder.makeCast(nullableTargetType, input);
+    }
+    return input;
+  }
+
   private RelDataType getSumReturnType(RelDataTypeFactory typeFactory,
       RelDataType inputType) {
     switch (inputType.getSqlTypeName()) {
@@ -612,7 +629,9 @@ private RelDataType getSumReturnType(RelDataTypeFactory typeFactory,
         return TypeConverter.convert(TypeInfoFactory.doubleTypeInfo, typeFactory);
       case DECIMAL:
         return typeFactory.getTypeSystem().deriveSumType(typeFactory, inputType);
+      default:
+        // Unsupported types will be validated when GenericUDAFSum is initialized. We keep the original expression here
+        return inputType;
     }
-    return null;
   }
 }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/calcite/translator/SqlFunctionConverter.java b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/calcite/translator/SqlFunctionConverter.java
index dcaf70e2a5..2ce99b06a9 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/calcite/translator/SqlFunctionConverter.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/calcite/translator/SqlFunctionConverter.java
@@ -44,12 +44,12 @@
 import org.apache.hadoop.hive.ql.exec.FunctionRegistry;
 import org.apache.hadoop.hive.ql.exec.UDFArgumentException;
 import org.apache.hadoop.hive.ql.optimizer.calcite.CalciteSemanticException;
-import org.apache.hadoop.hive.ql.optimizer.calcite.CalciteSemanticException.UnsupportedFeature;
 import org.apache.hadoop.hive.ql.optimizer.calcite.functions.CanAggregateDistinct;
 import org.apache.hadoop.hive.ql.optimizer.calcite.functions.HiveSqlAverageAggFunction;
 import org.apache.hadoop.hive.ql.optimizer.calcite.functions.HiveSqlCountAggFunction;
 import org.apache.hadoop.hive.ql.optimizer.calcite.functions.HiveSqlMinMaxAggFunction;
 import org.apache.hadoop.hive.ql.optimizer.calcite.functions.HiveSqlSumAggFunction;
+import org.apache.hadoop.hive.ql.optimizer.calcite.functions.HiveSqlSumEmptyIsZeroAggFunction;
 import org.apache.hadoop.hive.ql.optimizer.calcite.functions.HiveSqlVarianceAggFunction;
 import org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveBetween;
 import org.apache.hadoop.hive.ql.optimizer.calcite.reloperators.HiveConcat;
@@ -612,6 +612,13 @@ public static SqlAggFunction getCalciteAggFn(String hiveUdfName, boolean isDisti
             udfInfo.operandTypeInference,
             udfInfo.operandTypeChecker);
         break;
+      case "$sum0":
+        calciteAggFn = new HiveSqlSumEmptyIsZeroAggFunction(
+            isDistinct,
+            udfInfo.returnTypeInference,
+            udfInfo.operandTypeInference,
+            udfInfo.operandTypeChecker);
+        break;
       case "count":
         calciteAggFn = new HiveSqlCountAggFunction(
             isDistinct,
diff --git a/ql/src/test/queries/clientpositive/cbo_aggregate_reduce_functions_rule.q b/ql/src/test/queries/clientpositive/cbo_aggregate_reduce_functions_rule.q
new file mode 100644
index 0000000000..24e67c234d
--- /dev/null
+++ b/ql/src/test/queries/clientpositive/cbo_aggregate_reduce_functions_rule.q
@@ -0,0 +1,191 @@
+CREATE TABLE test (c_numeric STRING, c_non_numeric STRING, c_mix STRING);
+INSERT INTO test VALUES
+  ('1', 'val1', '1'),
+  ('3', 'val3', 'val3'),
+  ('101', 'val101', '101'),
+  ('-51', 'val-51', '-51'),
+  ('32', 'val32', 'val32'),
+  ('0', 'val0', '0'),
+  ('87', 'val87', '87'),
+  ('55', 'val55', '55');
+
+EXPLAIN CBO
+SELECT
+  ROUND(`$SUM0`(c_numeric), 3),
+  ROUND(`$SUM0`(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(`$SUM0`(c_non_numeric), 3),
+  ROUND(`$SUM0`(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(`$SUM0`(c_mix), 3),
+  ROUND(`$SUM0`(CAST(c_mix AS DOUBLE)), 3),
+
+  ROUND(AVG(c_numeric), 3),
+  ROUND(AVG(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(AVG(c_non_numeric), 3),
+  ROUND(AVG(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(AVG(c_mix), 3),
+  ROUND(AVG(CAST(c_mix AS DOUBLE)), 3),
+
+  ROUND(STDDEV_POP(c_numeric), 3),
+  ROUND(STDDEV_POP(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(STDDEV_POP(c_non_numeric), 3),
+  ROUND(STDDEV_POP(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(STDDEV_POP(c_mix), 3),
+  ROUND(STDDEV_POP(CAST(c_mix AS DOUBLE)), 3),
+
+  ROUND(STDDEV_SAMP(c_numeric), 3),
+  ROUND(STDDEV_SAMP(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(STDDEV_SAMP(c_non_numeric), 3),
+  ROUND(STDDEV_SAMP(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(STDDEV_SAMP(c_mix), 3),
+  ROUND(STDDEV_SAMP(CAST(c_mix AS DOUBLE)), 3),
+
+  ROUND(VAR_POP(c_numeric), 3),
+  ROUND(VAR_POP(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(VAR_POP(c_non_numeric), 3),
+  ROUND(VAR_POP(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(VAR_POP(c_mix), 3),
+  ROUND(VAR_POP(CAST(c_mix AS DOUBLE)), 3),
+
+  ROUND(VAR_SAMP(c_numeric), 3),
+  ROUND(VAR_SAMP(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(VAR_SAMP(c_non_numeric), 3),
+  ROUND(VAR_SAMP(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(VAR_SAMP(c_mix), 3),
+  ROUND(VAR_SAMP(CAST(c_mix AS DOUBLE)), 3),
+
+  -- SUM and COUNT are not converted but used in the transformations
+  ROUND(SUM(c_numeric), 3),
+  ROUND(SUM(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(SUM(c_non_numeric), 3),
+  ROUND(SUM(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(SUM(c_mix), 3),
+  ROUND(SUM(CAST(c_mix AS DOUBLE)), 3),
+
+  COUNT(c_numeric),
+  COUNT(CAST(c_numeric AS DOUBLE)),
+  COUNT(c_non_numeric),
+  COUNT(CAST(c_non_numeric AS DOUBLE)),
+  COUNT(c_mix),
+  COUNT(CAST(c_mix AS DOUBLE))
+FROM test;
+
+SELECT
+  ROUND(`$SUM0`(c_numeric), 3),
+  ROUND(`$SUM0`(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(`$SUM0`(c_non_numeric), 3),
+  ROUND(`$SUM0`(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(`$SUM0`(c_mix), 3),
+  ROUND(`$SUM0`(CAST(c_mix AS DOUBLE)), 3),
+
+  ROUND(AVG(c_numeric), 3),
+  ROUND(AVG(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(AVG(c_non_numeric), 3),
+  ROUND(AVG(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(AVG(c_mix), 3),
+  ROUND(AVG(CAST(c_mix AS DOUBLE)), 3),
+
+  ROUND(STDDEV_POP(c_numeric), 3),
+  ROUND(STDDEV_POP(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(STDDEV_POP(c_non_numeric), 3),
+  ROUND(STDDEV_POP(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(STDDEV_POP(c_mix), 3),
+  ROUND(STDDEV_POP(CAST(c_mix AS DOUBLE)), 3),
+
+  ROUND(STDDEV_SAMP(c_numeric), 3),
+  ROUND(STDDEV_SAMP(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(STDDEV_SAMP(c_non_numeric), 3),
+  ROUND(STDDEV_SAMP(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(STDDEV_SAMP(c_mix), 3),
+  ROUND(STDDEV_SAMP(CAST(c_mix AS DOUBLE)), 3),
+
+  ROUND(VAR_POP(c_numeric), 3),
+  ROUND(VAR_POP(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(VAR_POP(c_non_numeric), 3),
+  ROUND(VAR_POP(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(VAR_POP(c_mix), 3),
+  ROUND(VAR_POP(CAST(c_mix AS DOUBLE)), 3),
+
+  ROUND(VAR_SAMP(c_numeric), 3),
+  ROUND(VAR_SAMP(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(VAR_SAMP(c_non_numeric), 3),
+  ROUND(VAR_SAMP(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(VAR_SAMP(c_mix), 3),
+  ROUND(VAR_SAMP(CAST(c_mix AS DOUBLE)), 3),
+
+  -- SUM and COUNT are not converted but used in the transformations
+  ROUND(SUM(c_numeric), 3),
+  ROUND(SUM(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(SUM(c_non_numeric), 3),
+  ROUND(SUM(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(SUM(c_mix), 3),
+  ROUND(SUM(CAST(c_mix AS DOUBLE)), 3),
+
+  COUNT(c_numeric),
+  COUNT(CAST(c_numeric AS DOUBLE)),
+  COUNT(c_non_numeric),
+  COUNT(CAST(c_non_numeric AS DOUBLE)),
+  COUNT(c_mix),
+  COUNT(CAST(c_mix AS DOUBLE))
+FROM test;
+
+
+SET hive.cbo.enable=false;
+
+SELECT
+  ROUND(`$SUM0`(c_numeric), 3),
+  ROUND(`$SUM0`(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(`$SUM0`(c_non_numeric), 3),
+  ROUND(`$SUM0`(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(`$SUM0`(c_mix), 3),
+  ROUND(`$SUM0`(CAST(c_mix AS DOUBLE)), 3),
+
+  ROUND(AVG(c_numeric), 3),
+  ROUND(AVG(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(AVG(c_non_numeric), 3),
+  ROUND(AVG(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(AVG(c_mix), 3),
+  ROUND(AVG(CAST(c_mix AS DOUBLE)), 3),
+
+  ROUND(STDDEV_POP(c_numeric), 3),
+  ROUND(STDDEV_POP(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(STDDEV_POP(c_non_numeric), 3),
+  ROUND(STDDEV_POP(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(STDDEV_POP(c_mix), 3),
+  ROUND(STDDEV_POP(CAST(c_mix AS DOUBLE)), 3),
+
+  ROUND(STDDEV_SAMP(c_numeric), 3),
+  ROUND(STDDEV_SAMP(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(STDDEV_SAMP(c_non_numeric), 3),
+  ROUND(STDDEV_SAMP(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(STDDEV_SAMP(c_mix), 3),
+  ROUND(STDDEV_SAMP(CAST(c_mix AS DOUBLE)), 3),
+
+  ROUND(VAR_POP(c_numeric), 3),
+  ROUND(VAR_POP(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(VAR_POP(c_non_numeric), 3),
+  ROUND(VAR_POP(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(VAR_POP(c_mix), 3),
+  ROUND(VAR_POP(CAST(c_mix AS DOUBLE)), 3),
+
+  ROUND(VAR_SAMP(c_numeric), 3),
+  ROUND(VAR_SAMP(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(VAR_SAMP(c_non_numeric), 3),
+  ROUND(VAR_SAMP(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(VAR_SAMP(c_mix), 3),
+  ROUND(VAR_SAMP(CAST(c_mix AS DOUBLE)), 3),
+
+  -- SUM and COUNT are not converted but used in the transformations
+  ROUND(SUM(c_numeric), 3),
+  ROUND(SUM(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(SUM(c_non_numeric), 3),
+  ROUND(SUM(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(SUM(c_mix), 3),
+  ROUND(SUM(CAST(c_mix AS DOUBLE)), 3),
+
+  COUNT(c_numeric),
+  COUNT(CAST(c_numeric AS DOUBLE)),
+  COUNT(c_non_numeric),
+  COUNT(CAST(c_non_numeric AS DOUBLE)),
+  COUNT(c_mix),
+  COUNT(CAST(c_mix AS DOUBLE))
+FROM test;
diff --git a/ql/src/test/results/clientpositive/llap/cbo_aggregate_reduce_functions_rule.q.out b/ql/src/test/results/clientpositive/llap/cbo_aggregate_reduce_functions_rule.q.out
new file mode 100644
index 0000000000..20b62a7d6f
--- /dev/null
+++ b/ql/src/test/results/clientpositive/llap/cbo_aggregate_reduce_functions_rule.q.out
@@ -0,0 +1,411 @@
+PREHOOK: query: CREATE TABLE test (c_numeric STRING, c_non_numeric STRING, c_mix STRING)
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@test
+POSTHOOK: query: CREATE TABLE test (c_numeric STRING, c_non_numeric STRING, c_mix STRING)
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@test
+PREHOOK: query: INSERT INTO test VALUES
+  ('1', 'val1', '1'),
+  ('3', 'val3', 'val3'),
+  ('101', 'val101', '101'),
+  ('-51', 'val-51', '-51'),
+  ('32', 'val32', 'val32'),
+  ('0', 'val0', '0'),
+  ('87', 'val87', '87'),
+  ('55', 'val55', '55')
+PREHOOK: type: QUERY
+PREHOOK: Input: _dummy_database@_dummy_table
+PREHOOK: Output: default@test
+POSTHOOK: query: INSERT INTO test VALUES
+  ('1', 'val1', '1'),
+  ('3', 'val3', 'val3'),
+  ('101', 'val101', '101'),
+  ('-51', 'val-51', '-51'),
+  ('32', 'val32', 'val32'),
+  ('0', 'val0', '0'),
+  ('87', 'val87', '87'),
+  ('55', 'val55', '55')
+POSTHOOK: type: QUERY
+POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@test
+POSTHOOK: Lineage: test.c_mix SCRIPT []
+POSTHOOK: Lineage: test.c_non_numeric SCRIPT []
+POSTHOOK: Lineage: test.c_numeric SCRIPT []
+PREHOOK: query: EXPLAIN CBO
+SELECT
+  ROUND(`$SUM0`(c_numeric), 3),
+  ROUND(`$SUM0`(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(`$SUM0`(c_non_numeric), 3),
+  ROUND(`$SUM0`(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(`$SUM0`(c_mix), 3),
+  ROUND(`$SUM0`(CAST(c_mix AS DOUBLE)), 3),
+
+  ROUND(AVG(c_numeric), 3),
+  ROUND(AVG(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(AVG(c_non_numeric), 3),
+  ROUND(AVG(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(AVG(c_mix), 3),
+  ROUND(AVG(CAST(c_mix AS DOUBLE)), 3),
+
+  ROUND(STDDEV_POP(c_numeric), 3),
+  ROUND(STDDEV_POP(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(STDDEV_POP(c_non_numeric), 3),
+  ROUND(STDDEV_POP(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(STDDEV_POP(c_mix), 3),
+  ROUND(STDDEV_POP(CAST(c_mix AS DOUBLE)), 3),
+
+  ROUND(STDDEV_SAMP(c_numeric), 3),
+  ROUND(STDDEV_SAMP(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(STDDEV_SAMP(c_non_numeric), 3),
+  ROUND(STDDEV_SAMP(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(STDDEV_SAMP(c_mix), 3),
+  ROUND(STDDEV_SAMP(CAST(c_mix AS DOUBLE)), 3),
+
+  ROUND(VAR_POP(c_numeric), 3),
+  ROUND(VAR_POP(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(VAR_POP(c_non_numeric), 3),
+  ROUND(VAR_POP(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(VAR_POP(c_mix), 3),
+  ROUND(VAR_POP(CAST(c_mix AS DOUBLE)), 3),
+
+  ROUND(VAR_SAMP(c_numeric), 3),
+  ROUND(VAR_SAMP(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(VAR_SAMP(c_non_numeric), 3),
+  ROUND(VAR_SAMP(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(VAR_SAMP(c_mix), 3),
+  ROUND(VAR_SAMP(CAST(c_mix AS DOUBLE)), 3),
+
+  -- SUM and COUNT are not converted but used in the transformations
+  ROUND(SUM(c_numeric), 3),
+  ROUND(SUM(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(SUM(c_non_numeric), 3),
+  ROUND(SUM(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(SUM(c_mix), 3),
+  ROUND(SUM(CAST(c_mix AS DOUBLE)), 3),
+
+  COUNT(c_numeric),
+  COUNT(CAST(c_numeric AS DOUBLE)),
+  COUNT(c_non_numeric),
+  COUNT(CAST(c_non_numeric AS DOUBLE)),
+  COUNT(c_mix),
+  COUNT(CAST(c_mix AS DOUBLE))
+FROM test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@test
+#### A masked pattern was here ####
+POSTHOOK: query: EXPLAIN CBO
+SELECT
+  ROUND(`$SUM0`(c_numeric), 3),
+  ROUND(`$SUM0`(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(`$SUM0`(c_non_numeric), 3),
+  ROUND(`$SUM0`(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(`$SUM0`(c_mix), 3),
+  ROUND(`$SUM0`(CAST(c_mix AS DOUBLE)), 3),
+
+  ROUND(AVG(c_numeric), 3),
+  ROUND(AVG(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(AVG(c_non_numeric), 3),
+  ROUND(AVG(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(AVG(c_mix), 3),
+  ROUND(AVG(CAST(c_mix AS DOUBLE)), 3),
+
+  ROUND(STDDEV_POP(c_numeric), 3),
+  ROUND(STDDEV_POP(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(STDDEV_POP(c_non_numeric), 3),
+  ROUND(STDDEV_POP(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(STDDEV_POP(c_mix), 3),
+  ROUND(STDDEV_POP(CAST(c_mix AS DOUBLE)), 3),
+
+  ROUND(STDDEV_SAMP(c_numeric), 3),
+  ROUND(STDDEV_SAMP(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(STDDEV_SAMP(c_non_numeric), 3),
+  ROUND(STDDEV_SAMP(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(STDDEV_SAMP(c_mix), 3),
+  ROUND(STDDEV_SAMP(CAST(c_mix AS DOUBLE)), 3),
+
+  ROUND(VAR_POP(c_numeric), 3),
+  ROUND(VAR_POP(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(VAR_POP(c_non_numeric), 3),
+  ROUND(VAR_POP(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(VAR_POP(c_mix), 3),
+  ROUND(VAR_POP(CAST(c_mix AS DOUBLE)), 3),
+
+  ROUND(VAR_SAMP(c_numeric), 3),
+  ROUND(VAR_SAMP(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(VAR_SAMP(c_non_numeric), 3),
+  ROUND(VAR_SAMP(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(VAR_SAMP(c_mix), 3),
+  ROUND(VAR_SAMP(CAST(c_mix AS DOUBLE)), 3),
+
+  -- SUM and COUNT are not converted but used in the transformations
+  ROUND(SUM(c_numeric), 3),
+  ROUND(SUM(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(SUM(c_non_numeric), 3),
+  ROUND(SUM(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(SUM(c_mix), 3),
+  ROUND(SUM(CAST(c_mix AS DOUBLE)), 3),
+
+  COUNT(c_numeric),
+  COUNT(CAST(c_numeric AS DOUBLE)),
+  COUNT(c_non_numeric),
+  COUNT(CAST(c_non_numeric AS DOUBLE)),
+  COUNT(c_mix),
+  COUNT(CAST(c_mix AS DOUBLE))
+FROM test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@test
+#### A masked pattern was here ####
+CBO PLAN:
+HiveProject(_o__c0=[round(COALESCE($0, 0E0:DOUBLE), 3)], _o__c1=[round(COALESCE($1, 0E0:DOUBLE), 3)], _o__c2=[round(COALESCE($2, 0E0:DOUBLE), 3)], _o__c3=[round(COALESCE($3, 0E0:DOUBLE), 3)], _o__c4=[round(COALESCE($4, 0E0:DOUBLE), 3)], _o__c5=[round(COALESCE($5, 0E0:DOUBLE), 3)], _o__c6=[round(/($6, $7), 3)], _o__c7=[round(/($1, $8), 3)], _o__c8=[round(/($9, $10), 3)], _o__c9=[round(/($3, $11), 3)], _o__c10=[round(/($12, $13), 3)], _o__c11=[round(/($5, $14), 3)], _o__c12=[round(POWER(/(-($15, /(*($6, $6), $7)), $7), 0.5:DECIMAL(2, 1)), 3)], _o__c13=[round(POWER(/(-($16, /(*($1, $1), $8)), $8), 0.5:DECIMAL(2, 1)), 3)], _o__c14=[round(POWER(/(-($17, /(*($9, $9), $10)), $10), 0.5:DECIMAL(2, 1)), 3)], _o__c15=[round(POWER(/(-($18, /(*($3, $3), $11)), $11), 0.5:DECIMAL(2, 1)), 3)], _o__c16=[round(POWER(/(-($19, /(*($12, $12), $13)), $13), 0.5:DECIMAL(2, 1)), 3)], _o__c17=[round(POWER(/(-($20, /(*($5, $5), $14)), $14), 0.5:DECIMAL(2, 1)), 3)], _o__c18=[round(POWER(/(-($15, /(*($6, $6), $7)), CASE(=($7, 1), null:BIGINT, -($7, 1))), 0.5:DECIMAL(2, 1)), 3)], _o__c19=[round(POWER(/(-($16, /(*($1, $1), $8)), CASE(=($8, 1), null:BIGINT, -($8, 1))), 0.5:DECIMAL(2, 1)), 3)], _o__c20=[round(POWER(/(-($17, /(*($9, $9), $10)), CASE(=($10, 1), null:BIGINT, -($10, 1))), 0.5:DECIMAL(2, 1)), 3)], _o__c21=[round(POWER(/(-($18, /(*($3, $3), $11)), CASE(=($11, 1), null:BIGINT, -($11, 1))), 0.5:DECIMAL(2, 1)), 3)], _o__c22=[round(POWER(/(-($19, /(*($12, $12), $13)), CASE(=($13, 1), null:BIGINT, -($13, 1))), 0.5:DECIMAL(2, 1)), 3)], _o__c23=[round(POWER(/(-($20, /(*($5, $5), $14)), CASE(=($14, 1), null:BIGINT, -($14, 1))), 0.5:DECIMAL(2, 1)), 3)], _o__c24=[round(/(-($15, /(*($6, $6), $7)), $7), 3)], _o__c25=[round(/(-($16, /(*($1, $1), $8)), $8), 3)], _o__c26=[round(/(-($17, /(*($9, $9), $10)), $10), 3)], _o__c27=[round(/(-($18, /(*($3, $3), $11)), $11), 3)], _o__c28=[round(/(-($19, /(*($12, $12), $13)), $13), 3)], _o__c29=[round(/(-($20, /(*($5, $5), $14)), $14), 3)], _o__c30=[round(/(-($15, /(*($6, $6), $7)), CASE(=($7, 1), null:BIGINT, -($7, 1))), 3)], _o__c31=[round(/(-($16, /(*($1, $1), $8)), CASE(=($8, 1), null:BIGINT, -($8, 1))), 3)], _o__c32=[round(/(-($17, /(*($9, $9), $10)), CASE(=($10, 1), null:BIGINT, -($10, 1))), 3)], _o__c33=[round(/(-($18, /(*($3, $3), $11)), CASE(=($11, 1), null:BIGINT, -($11, 1))), 3)], _o__c34=[round(/(-($19, /(*($12, $12), $13)), CASE(=($13, 1), null:BIGINT, -($13, 1))), 3)], _o__c35=[round(/(-($20, /(*($5, $5), $14)), CASE(=($14, 1), null:BIGINT, -($14, 1))), 3)], _o__c36=[round($0, 3)], _o__c37=[round($1, 3)], _o__c38=[round($2, 3)], _o__c39=[round($3, 3)], _o__c40=[round($4, 3)], _o__c41=[round($5, 3)], _o__c42=[$21], _o__c43=[$8], _o__c44=[$22], _o__c45=[$11], _o__c46=[$23], _o__c47=[$14])
+  HiveAggregate(group=[{}], agg#0=[sum($0)], agg#1=[sum($1)], agg#2=[sum($2)], agg#3=[sum($3)], agg#4=[sum($4)], agg#5=[sum($5)], agg#6=[sum($6)], agg#7=[count($6)], agg#8=[count($1)], agg#9=[sum($7)], agg#10=[count($7)], agg#11=[count($3)], agg#12=[sum($8)], agg#13=[count($8)], agg#14=[count($5)], agg#15=[sum($9)], agg#16=[sum($10)], agg#17=[sum($11)], agg#18=[sum($12)], agg#19=[sum($13)], agg#20=[sum($14)], agg#21=[count($0)], agg#22=[count($2)], agg#23=[count($4)])
+    HiveProject($f0=[$0], $f1=[CAST($0):DOUBLE], $f2=[$1], $f3=[CAST($1):DOUBLE], $f4=[$2], $f5=[CAST($2):DOUBLE], $f00=[CAST($0):DOUBLE], $f20=[CAST($1):DOUBLE], $f40=[CAST($2):DOUBLE], $f9=[*(CAST($0):DOUBLE, CAST($0):DOUBLE)], $f10=[*(CAST($0):DOUBLE, CAST($0):DOUBLE)], $f11=[*(CAST($1):DOUBLE, CAST($1):DOUBLE)], $f12=[*(CAST($1):DOUBLE, CAST($1):DOUBLE)], $f13=[*(CAST($2):DOUBLE, CAST($2):DOUBLE)], $f14=[*(CAST($2):DOUBLE, CAST($2):DOUBLE)])
+      HiveTableScan(table=[[default, test]], table:alias=[test])
+
+PREHOOK: query: SELECT
+  ROUND(`$SUM0`(c_numeric), 3),
+  ROUND(`$SUM0`(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(`$SUM0`(c_non_numeric), 3),
+  ROUND(`$SUM0`(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(`$SUM0`(c_mix), 3),
+  ROUND(`$SUM0`(CAST(c_mix AS DOUBLE)), 3),
+
+  ROUND(AVG(c_numeric), 3),
+  ROUND(AVG(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(AVG(c_non_numeric), 3),
+  ROUND(AVG(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(AVG(c_mix), 3),
+  ROUND(AVG(CAST(c_mix AS DOUBLE)), 3),
+
+  ROUND(STDDEV_POP(c_numeric), 3),
+  ROUND(STDDEV_POP(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(STDDEV_POP(c_non_numeric), 3),
+  ROUND(STDDEV_POP(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(STDDEV_POP(c_mix), 3),
+  ROUND(STDDEV_POP(CAST(c_mix AS DOUBLE)), 3),
+
+  ROUND(STDDEV_SAMP(c_numeric), 3),
+  ROUND(STDDEV_SAMP(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(STDDEV_SAMP(c_non_numeric), 3),
+  ROUND(STDDEV_SAMP(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(STDDEV_SAMP(c_mix), 3),
+  ROUND(STDDEV_SAMP(CAST(c_mix AS DOUBLE)), 3),
+
+  ROUND(VAR_POP(c_numeric), 3),
+  ROUND(VAR_POP(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(VAR_POP(c_non_numeric), 3),
+  ROUND(VAR_POP(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(VAR_POP(c_mix), 3),
+  ROUND(VAR_POP(CAST(c_mix AS DOUBLE)), 3),
+
+  ROUND(VAR_SAMP(c_numeric), 3),
+  ROUND(VAR_SAMP(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(VAR_SAMP(c_non_numeric), 3),
+  ROUND(VAR_SAMP(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(VAR_SAMP(c_mix), 3),
+  ROUND(VAR_SAMP(CAST(c_mix AS DOUBLE)), 3),
+
+  -- SUM and COUNT are not converted but used in the transformations
+  ROUND(SUM(c_numeric), 3),
+  ROUND(SUM(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(SUM(c_non_numeric), 3),
+  ROUND(SUM(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(SUM(c_mix), 3),
+  ROUND(SUM(CAST(c_mix AS DOUBLE)), 3),
+
+  COUNT(c_numeric),
+  COUNT(CAST(c_numeric AS DOUBLE)),
+  COUNT(c_non_numeric),
+  COUNT(CAST(c_non_numeric AS DOUBLE)),
+  COUNT(c_mix),
+  COUNT(CAST(c_mix AS DOUBLE))
+FROM test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT
+  ROUND(`$SUM0`(c_numeric), 3),
+  ROUND(`$SUM0`(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(`$SUM0`(c_non_numeric), 3),
+  ROUND(`$SUM0`(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(`$SUM0`(c_mix), 3),
+  ROUND(`$SUM0`(CAST(c_mix AS DOUBLE)), 3),
+
+  ROUND(AVG(c_numeric), 3),
+  ROUND(AVG(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(AVG(c_non_numeric), 3),
+  ROUND(AVG(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(AVG(c_mix), 3),
+  ROUND(AVG(CAST(c_mix AS DOUBLE)), 3),
+
+  ROUND(STDDEV_POP(c_numeric), 3),
+  ROUND(STDDEV_POP(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(STDDEV_POP(c_non_numeric), 3),
+  ROUND(STDDEV_POP(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(STDDEV_POP(c_mix), 3),
+  ROUND(STDDEV_POP(CAST(c_mix AS DOUBLE)), 3),
+
+  ROUND(STDDEV_SAMP(c_numeric), 3),
+  ROUND(STDDEV_SAMP(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(STDDEV_SAMP(c_non_numeric), 3),
+  ROUND(STDDEV_SAMP(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(STDDEV_SAMP(c_mix), 3),
+  ROUND(STDDEV_SAMP(CAST(c_mix AS DOUBLE)), 3),
+
+  ROUND(VAR_POP(c_numeric), 3),
+  ROUND(VAR_POP(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(VAR_POP(c_non_numeric), 3),
+  ROUND(VAR_POP(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(VAR_POP(c_mix), 3),
+  ROUND(VAR_POP(CAST(c_mix AS DOUBLE)), 3),
+
+  ROUND(VAR_SAMP(c_numeric), 3),
+  ROUND(VAR_SAMP(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(VAR_SAMP(c_non_numeric), 3),
+  ROUND(VAR_SAMP(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(VAR_SAMP(c_mix), 3),
+  ROUND(VAR_SAMP(CAST(c_mix AS DOUBLE)), 3),
+
+  -- SUM and COUNT are not converted but used in the transformations
+  ROUND(SUM(c_numeric), 3),
+  ROUND(SUM(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(SUM(c_non_numeric), 3),
+  ROUND(SUM(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(SUM(c_mix), 3),
+  ROUND(SUM(CAST(c_mix AS DOUBLE)), 3),
+
+  COUNT(c_numeric),
+  COUNT(CAST(c_numeric AS DOUBLE)),
+  COUNT(c_non_numeric),
+  COUNT(CAST(c_non_numeric AS DOUBLE)),
+  COUNT(c_mix),
+  COUNT(CAST(c_mix AS DOUBLE))
+FROM test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@test
+#### A masked pattern was here ####
+228.0	228.0	0.0	0.0	193.0	193.0	28.5	28.5	NULL	NULL	32.167	32.167	47.344	47.344	NULL	NULL	53.524	53.524	50.613	50.613	NULL	NULL	58.632	58.632	2241.5	2241.5	NULL	NULL	2864.806	2864.806	2561.714	2561.714	NULL	NULL	3437.767	3437.767	228.0	228.0	0.0	NULL	193.0	193.0	8	8	8	0	8	6
+PREHOOK: query: SELECT
+  ROUND(`$SUM0`(c_numeric), 3),
+  ROUND(`$SUM0`(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(`$SUM0`(c_non_numeric), 3),
+  ROUND(`$SUM0`(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(`$SUM0`(c_mix), 3),
+  ROUND(`$SUM0`(CAST(c_mix AS DOUBLE)), 3),
+
+  ROUND(AVG(c_numeric), 3),
+  ROUND(AVG(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(AVG(c_non_numeric), 3),
+  ROUND(AVG(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(AVG(c_mix), 3),
+  ROUND(AVG(CAST(c_mix AS DOUBLE)), 3),
+
+  ROUND(STDDEV_POP(c_numeric), 3),
+  ROUND(STDDEV_POP(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(STDDEV_POP(c_non_numeric), 3),
+  ROUND(STDDEV_POP(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(STDDEV_POP(c_mix), 3),
+  ROUND(STDDEV_POP(CAST(c_mix AS DOUBLE)), 3),
+
+  ROUND(STDDEV_SAMP(c_numeric), 3),
+  ROUND(STDDEV_SAMP(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(STDDEV_SAMP(c_non_numeric), 3),
+  ROUND(STDDEV_SAMP(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(STDDEV_SAMP(c_mix), 3),
+  ROUND(STDDEV_SAMP(CAST(c_mix AS DOUBLE)), 3),
+
+  ROUND(VAR_POP(c_numeric), 3),
+  ROUND(VAR_POP(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(VAR_POP(c_non_numeric), 3),
+  ROUND(VAR_POP(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(VAR_POP(c_mix), 3),
+  ROUND(VAR_POP(CAST(c_mix AS DOUBLE)), 3),
+
+  ROUND(VAR_SAMP(c_numeric), 3),
+  ROUND(VAR_SAMP(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(VAR_SAMP(c_non_numeric), 3),
+  ROUND(VAR_SAMP(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(VAR_SAMP(c_mix), 3),
+  ROUND(VAR_SAMP(CAST(c_mix AS DOUBLE)), 3),
+
+  -- SUM and COUNT are not converted but used in the transformations
+  ROUND(SUM(c_numeric), 3),
+  ROUND(SUM(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(SUM(c_non_numeric), 3),
+  ROUND(SUM(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(SUM(c_mix), 3),
+  ROUND(SUM(CAST(c_mix AS DOUBLE)), 3),
+
+  COUNT(c_numeric),
+  COUNT(CAST(c_numeric AS DOUBLE)),
+  COUNT(c_non_numeric),
+  COUNT(CAST(c_non_numeric AS DOUBLE)),
+  COUNT(c_mix),
+  COUNT(CAST(c_mix AS DOUBLE))
+FROM test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@test
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT
+  ROUND(`$SUM0`(c_numeric), 3),
+  ROUND(`$SUM0`(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(`$SUM0`(c_non_numeric), 3),
+  ROUND(`$SUM0`(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(`$SUM0`(c_mix), 3),
+  ROUND(`$SUM0`(CAST(c_mix AS DOUBLE)), 3),
+
+  ROUND(AVG(c_numeric), 3),
+  ROUND(AVG(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(AVG(c_non_numeric), 3),
+  ROUND(AVG(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(AVG(c_mix), 3),
+  ROUND(AVG(CAST(c_mix AS DOUBLE)), 3),
+
+  ROUND(STDDEV_POP(c_numeric), 3),
+  ROUND(STDDEV_POP(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(STDDEV_POP(c_non_numeric), 3),
+  ROUND(STDDEV_POP(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(STDDEV_POP(c_mix), 3),
+  ROUND(STDDEV_POP(CAST(c_mix AS DOUBLE)), 3),
+
+  ROUND(STDDEV_SAMP(c_numeric), 3),
+  ROUND(STDDEV_SAMP(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(STDDEV_SAMP(c_non_numeric), 3),
+  ROUND(STDDEV_SAMP(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(STDDEV_SAMP(c_mix), 3),
+  ROUND(STDDEV_SAMP(CAST(c_mix AS DOUBLE)), 3),
+
+  ROUND(VAR_POP(c_numeric), 3),
+  ROUND(VAR_POP(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(VAR_POP(c_non_numeric), 3),
+  ROUND(VAR_POP(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(VAR_POP(c_mix), 3),
+  ROUND(VAR_POP(CAST(c_mix AS DOUBLE)), 3),
+
+  ROUND(VAR_SAMP(c_numeric), 3),
+  ROUND(VAR_SAMP(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(VAR_SAMP(c_non_numeric), 3),
+  ROUND(VAR_SAMP(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(VAR_SAMP(c_mix), 3),
+  ROUND(VAR_SAMP(CAST(c_mix AS DOUBLE)), 3),
+
+  -- SUM and COUNT are not converted but used in the transformations
+  ROUND(SUM(c_numeric), 3),
+  ROUND(SUM(CAST(c_numeric AS DOUBLE)), 3),
+  ROUND(SUM(c_non_numeric), 3),
+  ROUND(SUM(CAST(c_non_numeric AS DOUBLE)), 3),
+  ROUND(SUM(c_mix), 3),
+  ROUND(SUM(CAST(c_mix AS DOUBLE)), 3),
+
+  COUNT(c_numeric),
+  COUNT(CAST(c_numeric AS DOUBLE)),
+  COUNT(c_non_numeric),
+  COUNT(CAST(c_non_numeric AS DOUBLE)),
+  COUNT(c_mix),
+  COUNT(CAST(c_mix AS DOUBLE))
+FROM test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@test
+#### A masked pattern was here ####
+228.0	228.0	0.0	0.0	193.0	193.0	28.5	28.5	NULL	NULL	32.167	32.167	47.344	47.344	NULL	NULL	53.524	53.524	50.613	50.613	NULL	NULL	58.632	58.632	2241.5	2241.5	NULL	NULL	2864.806	2864.806	2561.714	2561.714	NULL	NULL	3437.767	3437.767	228.0	228.0	0.0	NULL	193.0	193.0	8	8	8	0	8	6
diff --git a/ql/src/test/results/clientpositive/llap/cbo_rp_groupby3_noskew_multi_distinct.q.out b/ql/src/test/results/clientpositive/llap/cbo_rp_groupby3_noskew_multi_distinct.q.out
index 91ba8aea70..9938490628 100644
--- a/ql/src/test/results/clientpositive/llap/cbo_rp_groupby3_noskew_multi_distinct.q.out
+++ b/ql/src/test/results/clientpositive/llap/cbo_rp_groupby3_noskew_multi_distinct.q.out
@@ -64,23 +64,23 @@ STAGE PLANS:
                     outputColumnNames: $f0, $f00, $f2
                     Statistics: Num rows: 500 Data size: 51000 Basic stats: COMPLETE Column stats: COMPLETE
                     Reduce Output Operator
-                      key expressions: $f0 (type: string)
-                      null sort order: z
-                      sort order: +
+                      key expressions: $f00 (type: double), $f0 (type: string)
+                      null sort order: zz
+                      sort order: ++
                       Statistics: Num rows: 500 Data size: 51000 Basic stats: COMPLETE Column stats: COMPLETE
-                      value expressions: $f2 (type: double), $f00 (type: double)
+                      value expressions: $f2 (type: double)
             Execution mode: vectorized, llap
             LLAP IO: all inputs
         Reducer 2 
             Execution mode: llap
             Reduce Operator Tree:
               Group By Operator
-                aggregations: sum(KEY._col0:0._col0), count(KEY._col0:0._col0), sum(DISTINCT KEY._col0:0._col0), count(DISTINCT KEY._col0:1._col0), max(KEY._col0:0._col0), min(KEY._col0:0._col0), sum(VALUE._col0), sum(VALUE._col1)
+                aggregations: sum(KEY._col0:2._col0), sum(KEY._col0:0._col0), count(KEY._col0:0._col0), sum(DISTINCT KEY._col0:0._col0), count(DISTINCT KEY._col0:1._col0), max(KEY._col0:2._col0), min(KEY._col0:2._col0), sum(VALUE._col0), sum(DISTINCT KEY._col0:2._col0), count(DISTINCT KEY._col0:3._col0)
                 mode: complete
-                outputColumnNames: $f0, $f1, $f2, $f3, $f4, $f5, $f6, $f7
-                Statistics: Num rows: 1 Data size: 416 Basic stats: COMPLETE Column stats: COMPLETE
+                outputColumnNames: $f0, $f1, $f2, $f3, $f4, $f5, $f6, $f7, $f8, $f9
+                Statistics: Num rows: 1 Data size: 432 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
-                  expressions: $f0 (type: double), ($f0 / $f1) (type: double), ($f2 / $f3) (type: double), UDFToDouble($f4) (type: double), UDFToDouble($f5) (type: double), power((($f6 - (($f7 * $f7) / $f1)) / $f1), 0.5) (type: double), power((($f6 - (($f7 * $f7) / $f1)) / CASE WHEN (($f1 = 1)) THEN (null) ELSE (($f1 - 1)) END), 0.5) (type: double), (($f6 - (($f7 * $f7) / $f1)) / $f1) (type: double), (($f6 - (($f7 * $f7) / $f1)) / CASE WHEN (($f1 = 1)) THEN (null) ELSE (($f1 - 1)) END) (type: double), $f2 (type: double), UDFToDouble($f3) (type: double)
+                  expressions: $f0 (type: double), ($f1 / $f2) (type: double), ($f3 / $f4) (type: double), UDFToDouble($f5) (type: double), UDFToDouble($f6) (type: double), power((($f7 - (($f1 * $f1) / $f2)) / $f2), 0.5) (type: double), power((($f7 - (($f1 * $f1) / $f2)) / CASE WHEN (($f2 = 1)) THEN (null) ELSE (($f2 - 1)) END), 0.5) (type: double), (($f7 - (($f1 * $f1) / $f2)) / $f2) (type: double), (($f7 - (($f1 * $f1) / $f2)) / CASE WHEN (($f2 = 1)) THEN (null) ELSE (($f2 - 1)) END) (type: double), $f8 (type: double), UDFToDouble($f9) (type: double)
                   outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
                   Statistics: Num rows: 1 Data size: 88 Basic stats: COMPLETE Column stats: COMPLETE
                   File Output Operator
@@ -165,13 +165,13 @@ INSERT OVERWRITE TABLE dest1_n123 SELECT
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 POSTHOOK: Output: default@dest1_n123
-POSTHOOK: Lineage: dest1_n123.c1 EXPRESSION [(src)src.FieldSchema(name:value, type:string, comment:default), ]
-POSTHOOK: Lineage: dest1_n123.c10 EXPRESSION [(src)src.FieldSchema(name:value, type:string, comment:default), ]
+POSTHOOK: Lineage: dest1_n123.c1 EXPRESSION [(src)src.null, ]
+POSTHOOK: Lineage: dest1_n123.c10 EXPRESSION [(src)src.null, ]
 POSTHOOK: Lineage: dest1_n123.c11 EXPRESSION [(src)src.null, ]
 POSTHOOK: Lineage: dest1_n123.c2 EXPRESSION [(src)src.FieldSchema(name:value, type:string, comment:default), ]
-POSTHOOK: Lineage: dest1_n123.c3 EXPRESSION [(src)src.FieldSchema(name:value, type:string, comment:default), (src)src.null, ]
-POSTHOOK: Lineage: dest1_n123.c4 EXPRESSION [(src)src.FieldSchema(name:value, type:string, comment:default), ]
-POSTHOOK: Lineage: dest1_n123.c5 EXPRESSION [(src)src.FieldSchema(name:value, type:string, comment:default), ]
+POSTHOOK: Lineage: dest1_n123.c3 EXPRESSION [(src)src.FieldSchema(name:value, type:string, comment:default), ]
+POSTHOOK: Lineage: dest1_n123.c4 EXPRESSION [(src)src.null, ]
+POSTHOOK: Lineage: dest1_n123.c5 EXPRESSION [(src)src.null, ]
 POSTHOOK: Lineage: dest1_n123.c6 EXPRESSION [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: dest1_n123.c7 EXPRESSION [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: dest1_n123.c8 EXPRESSION [(src)src.FieldSchema(name:value, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/llap/count_dist_rewrite.q.out b/ql/src/test/results/clientpositive/llap/count_dist_rewrite.q.out
index b2085b3a7a..dca7cd846a 100644
--- a/ql/src/test/results/clientpositive/llap/count_dist_rewrite.q.out
+++ b/ql/src/test/results/clientpositive/llap/count_dist_rewrite.q.out
@@ -311,12 +311,12 @@ STAGE PLANS:
                   alias: src
                   Statistics: Num rows: 500 Data size: 43500 Basic stats: COMPLETE Column stats: COMPLETE
                   Select Operator
-                    expressions: key (type: string)
-                    outputColumnNames: key
+                    expressions: key (type: string), UDFToDouble(key) (type: double)
+                    outputColumnNames: _col0, _col1
                     Statistics: Num rows: 500 Data size: 43500 Basic stats: COMPLETE Column stats: COMPLETE
                     Group By Operator
-                      aggregations: max(key), min(key), sum(key), count(key)
-                      keys: key (type: string)
+                      aggregations: max(_col0), min(_col0), sum(_col1), count(_col1)
+                      keys: _col0 (type: string)
                       minReductionHashAggr: 0.4
                       mode: hash
                       outputColumnNames: _col0, _col1, _col3, _col4, _col5
@@ -328,7 +328,7 @@ STAGE PLANS:
                         Map-reduce partition columns: _col0 (type: string)
                         Statistics: Num rows: 316 Data size: 148836 Basic stats: COMPLETE Column stats: COMPLETE
                         value expressions: _col1 (type: string), _col3 (type: string), _col4 (type: double), _col5 (type: bigint)
-            Execution mode: llap
+            Execution mode: vectorized, llap
             LLAP IO: all inputs
         Reducer 2 
             Execution mode: vectorized, llap
@@ -631,7 +631,7 @@ STAGE PLANS:
                     outputColumnNames: _col0, _col1, _col2
                     Statistics: Num rows: 500 Data size: 43500 Basic stats: COMPLETE Column stats: COMPLETE
                     Group By Operator
-                      aggregations: count(), sum(_col2), sum(_col1), count(_col0)
+                      aggregations: count(), sum(_col2), sum(_col1), count(_col1)
                       keys: _col0 (type: string)
                       minReductionHashAggr: 0.4
                       mode: hash
@@ -758,11 +758,11 @@ STAGE PLANS:
                     outputColumnNames: _col0, _col1, _col2
                     Statistics: Num rows: 500 Data size: 45500 Basic stats: COMPLETE Column stats: COMPLETE
                     Group By Operator
-                      aggregations: sum(_col0), count(_col0), max(_col0), min(_col0), sum(_col2), sum(_col1)
+                      aggregations: sum(_col0), sum(_col1), count(_col1), max(_col0), min(_col0), sum(_col2)
                       keys: _col0 (type: string)
                       minReductionHashAggr: 0.4
                       mode: hash
-                      outputColumnNames: _col0, _col1, _col2, _col4, _col5, _col6, _col7
+                      outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col6, _col7
                       Statistics: Num rows: 307 Data size: 149202 Basic stats: COMPLETE Column stats: COMPLETE
                       Reduce Output Operator
                         key expressions: _col0 (type: string)
@@ -770,20 +770,20 @@ STAGE PLANS:
                         sort order: +
                         Map-reduce partition columns: _col0 (type: string)
                         Statistics: Num rows: 307 Data size: 149202 Basic stats: COMPLETE Column stats: COMPLETE
-                        value expressions: _col1 (type: double), _col2 (type: bigint), _col4 (type: string), _col5 (type: string), _col6 (type: double), _col7 (type: double)
+                        value expressions: _col1 (type: double), _col2 (type: double), _col3 (type: bigint), _col5 (type: string), _col6 (type: string), _col7 (type: double)
             Execution mode: llap
             LLAP IO: all inputs
         Reducer 2 
             Execution mode: vectorized, llap
             Reduce Operator Tree:
               Group By Operator
-                aggregations: sum(VALUE._col0), count(VALUE._col1), max(VALUE._col2), min(VALUE._col3), sum(VALUE._col4), sum(VALUE._col5)
+                aggregations: sum(VALUE._col0), sum(VALUE._col1), count(VALUE._col2), max(VALUE._col3), min(VALUE._col4), sum(VALUE._col5)
                 keys: KEY._col0 (type: string)
                 mode: partial2
                 outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                 Statistics: Num rows: 307 Data size: 149202 Basic stats: COMPLETE Column stats: COMPLETE
                 Group By Operator
-                  aggregations: sum(_col1), count(_col2), count(_col0), max(_col3), min(_col4), sum(_col5), sum(_col6)
+                  aggregations: sum(_col1), sum(_col2), count(_col3), count(_col0), max(_col4), min(_col5), sum(_col6)
                   mode: partial2
                   outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                   Statistics: Num rows: 1 Data size: 408 Basic stats: COMPLETE Column stats: COMPLETE
@@ -791,17 +791,17 @@ STAGE PLANS:
                     null sort order: 
                     sort order: 
                     Statistics: Num rows: 1 Data size: 408 Basic stats: COMPLETE Column stats: COMPLETE
-                    value expressions: _col0 (type: double), _col1 (type: bigint), _col2 (type: bigint), _col3 (type: string), _col4 (type: string), _col5 (type: double), _col6 (type: double)
+                    value expressions: _col0 (type: double), _col1 (type: double), _col2 (type: bigint), _col3 (type: bigint), _col4 (type: string), _col5 (type: string), _col6 (type: double)
         Reducer 3 
             Execution mode: vectorized, llap
             Reduce Operator Tree:
               Group By Operator
-                aggregations: sum(VALUE._col0), count(VALUE._col1), count(VALUE._col2), max(VALUE._col3), min(VALUE._col4), sum(VALUE._col5), sum(VALUE._col6)
+                aggregations: sum(VALUE._col0), sum(VALUE._col1), count(VALUE._col2), count(VALUE._col3), max(VALUE._col4), min(VALUE._col5), sum(VALUE._col6)
                 mode: mergepartial
                 outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                 Statistics: Num rows: 1 Data size: 408 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
-                  expressions: _col0 (type: double), (_col0 / _col1) (type: double), _col2 (type: bigint), _col3 (type: string), _col4 (type: string), UDFToInteger(power(((_col5 - ((_col6 * _col6) / _col1)) / _col1), 0.5)) (type: int), UDFToInteger(power(((_col5 - ((_col6 * _col6) / _col1)) / if((_col1 = 1L), null, (_col1 - 1))), 0.5)) (type: int), UDFToInteger(((_col5 - ((_col6 * _col6) / _col1)) / _col1)) (type: int), UDFToInteger(((_col5 - ((_col6 * _col6) / _col1)) / if((_col1 = 1L), null, (_col1 - 1)))) (type: int)
+                  expressions: _col0 (type: double), (_col1 / _col2) (type: double), _col3 (type: bigint), _col4 (type: string), _col5 (type: string), UDFToInteger(power(((_col6 - ((_col1 * _col1) / _col2)) / _col2), 0.5)) (type: int), UDFToInteger(power(((_col6 - ((_col1 * _col1) / _col2)) / if((_col2 = 1L), null, (_col2 - 1))), 0.5)) (type: int), UDFToInteger(((_col6 - ((_col1 * _col1) / _col2)) / _col2)) (type: int), UDFToInteger(((_col6 - ((_col1 * _col1) / _col2)) / if((_col2 = 1L), null, (_col2 - 1)))) (type: int)
                   outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                   Statistics: Num rows: 1 Data size: 408 Basic stats: COMPLETE Column stats: COMPLETE
                   File Output Operator
@@ -871,12 +871,12 @@ STAGE PLANS:
                   alias: src
                   Statistics: Num rows: 500 Data size: 89000 Basic stats: COMPLETE Column stats: COMPLETE
                   Select Operator
-                    expressions: key (type: string), value (type: string)
-                    outputColumnNames: key, value
+                    expressions: value (type: string), key (type: string), UDFToDouble(key) (type: double)
+                    outputColumnNames: _col0, _col1, _col2
                     Statistics: Num rows: 500 Data size: 89000 Basic stats: COMPLETE Column stats: COMPLETE
                     Group By Operator
-                      aggregations: max(key), count(DISTINCT key), min(key), sum(key), count(key)
-                      keys: value (type: string), key (type: string)
+                      aggregations: max(_col1), count(DISTINCT _col1), min(_col1), sum(_col2), count(_col2)
+                      keys: _col0 (type: string), _col1 (type: string)
                       minReductionHashAggr: 0.4
                       mode: hash
                       outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
@@ -888,7 +888,7 @@ STAGE PLANS:
                         Map-reduce partition columns: _col0 (type: string)
                         Statistics: Num rows: 316 Data size: 180120 Basic stats: COMPLETE Column stats: COMPLETE
                         value expressions: _col2 (type: string), _col4 (type: string), _col5 (type: double), _col6 (type: bigint)
-            Execution mode: llap
+            Execution mode: vectorized, llap
             LLAP IO: all inputs
         Reducer 2 
             Execution mode: llap
diff --git a/ql/src/test/results/clientpositive/llap/decimal_udf.q.out b/ql/src/test/results/clientpositive/llap/decimal_udf.q.out
index b03095676a..1196ad621d 100644
--- a/ql/src/test/results/clientpositive/llap/decimal_udf.q.out
+++ b/ql/src/test/results/clientpositive/llap/decimal_udf.q.out
@@ -1921,11 +1921,11 @@ STAGE PLANS:
                   alias: decimal_udf
                   Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: NONE
                   Select Operator
-                    expressions: value (type: int), key (type: decimal(20,10)), UDFToDouble(key) (type: double), (UDFToDouble(key) * UDFToDouble(key)) (type: double)
-                    outputColumnNames: _col0, _col1, _col2, _col3
+                    expressions: value (type: int), UDFToDouble(key) (type: double), (UDFToDouble(key) * UDFToDouble(key)) (type: double)
+                    outputColumnNames: _col0, _col1, _col2
                     Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: NONE
                     Group By Operator
-                      aggregations: sum(_col3), sum(_col2), count(_col1)
+                      aggregations: sum(_col2), sum(_col1), count(_col1)
                       keys: _col0 (type: int)
                       minReductionHashAggr: 0.99
                       mode: hash
@@ -2018,11 +2018,11 @@ STAGE PLANS:
                   alias: decimal_udf
                   Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: NONE
                   Select Operator
-                    expressions: value (type: int), key (type: decimal(20,10)), UDFToDouble(key) (type: double), (UDFToDouble(key) * UDFToDouble(key)) (type: double)
-                    outputColumnNames: _col0, _col1, _col2, _col3
+                    expressions: value (type: int), UDFToDouble(key) (type: double), (UDFToDouble(key) * UDFToDouble(key)) (type: double)
+                    outputColumnNames: _col0, _col1, _col2
                     Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: NONE
                     Group By Operator
-                      aggregations: sum(_col3), sum(_col2), count(_col1)
+                      aggregations: sum(_col2), sum(_col1), count(_col1)
                       keys: _col0 (type: int)
                       minReductionHashAggr: 0.99
                       mode: hash
diff --git a/ql/src/test/results/clientpositive/llap/fetch_aggregation.q.out b/ql/src/test/results/clientpositive/llap/fetch_aggregation.q.out
index 65d6832396..29c8769f99 100644
--- a/ql/src/test/results/clientpositive/llap/fetch_aggregation.q.out
+++ b/ql/src/test/results/clientpositive/llap/fetch_aggregation.q.out
@@ -27,14 +27,14 @@ STAGE PLANS:
                     outputColumnNames: _col0, _col1, _col2
                     Statistics: Num rows: 500 Data size: 43500 Basic stats: COMPLETE Column stats: COMPLETE
                     Group By Operator
-                      aggregations: count(_col0), sum(_col0), min(_col0), max(_col0), sum(_col2), sum(_col1)
+                      aggregations: count(_col0), sum(_col0), sum(_col1), count(_col1), min(_col0), max(_col0), sum(_col2)
                       minReductionHashAggr: 0.99
                       mode: hash
-                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
-                      Statistics: Num rows: 1 Data size: 400 Basic stats: COMPLETE Column stats: COMPLETE
+                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
+                      Statistics: Num rows: 1 Data size: 408 Basic stats: COMPLETE Column stats: COMPLETE
                       File Output Operator
                         compressed: false
-                        Statistics: Num rows: 1 Data size: 400 Basic stats: COMPLETE Column stats: COMPLETE
+                        Statistics: Num rows: 1 Data size: 408 Basic stats: COMPLETE Column stats: COMPLETE
                         table:
                             input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                             output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
@@ -47,11 +47,11 @@ STAGE PLANS:
       limit: -1
       Processor Tree:
         Group By Operator
-          aggregations: count(_col0), sum(_col1), min(_col2), max(_col3), sum(_col4), sum(_col5)
+          aggregations: count(_col0), sum(_col1), sum(_col2), count(_col3), min(_col4), max(_col5), sum(_col6)
           mode: mergepartial
-          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
+          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
           Select Operator
-            expressions: _col0 (type: bigint), _col1 (type: double), (_col1 / _col0) (type: double), _col2 (type: string), _col3 (type: string), power(((_col4 - ((_col5 * _col5) / _col0)) / _col0), 0.5) (type: double), ((_col4 - ((_col5 * _col5) / _col0)) / _col0) (type: double)
+            expressions: _col0 (type: bigint), _col1 (type: double), (_col2 / _col3) (type: double), _col4 (type: string), _col5 (type: string), power(((_col6 - ((_col2 * _col2) / _col3)) / _col3), 0.5) (type: double), ((_col6 - ((_col2 * _col2) / _col3)) / _col3) (type: double)
             outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
             ListSink
 
diff --git a/ql/src/test/results/clientpositive/llap/groupby3_map.q.out b/ql/src/test/results/clientpositive/llap/groupby3_map.q.out
index 10636eee2e..c983729abd 100644
--- a/ql/src/test/results/clientpositive/llap/groupby3_map.q.out
+++ b/ql/src/test/results/clientpositive/llap/groupby3_map.q.out
@@ -60,30 +60,30 @@ STAGE PLANS:
                     outputColumnNames: _col0, _col1, _col2
                     Statistics: Num rows: 500 Data size: 45500 Basic stats: COMPLETE Column stats: COMPLETE
                     Group By Operator
-                      aggregations: sum(_col0), count(_col0), sum(DISTINCT _col0), count(DISTINCT _col0), max(_col0), min(_col0), sum(_col2), sum(_col1)
-                      keys: _col0 (type: string)
+                      aggregations: sum(_col0), sum(_col1), count(_col1), sum(DISTINCT _col1), count(DISTINCT _col1), max(_col0), min(_col0), sum(_col2)
+                      keys: _col1 (type: double)
                       minReductionHashAggr: 0.4
                       mode: hash
                       outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
-                      Statistics: Num rows: 307 Data size: 154114 Basic stats: COMPLETE Column stats: COMPLETE
+                      Statistics: Num rows: 307 Data size: 130168 Basic stats: COMPLETE Column stats: COMPLETE
                       Reduce Output Operator
-                        key expressions: _col0 (type: string)
+                        key expressions: _col0 (type: double)
                         null sort order: z
                         sort order: +
-                        Statistics: Num rows: 307 Data size: 154114 Basic stats: COMPLETE Column stats: COMPLETE
-                        value expressions: _col1 (type: double), _col2 (type: bigint), _col5 (type: string), _col6 (type: string), _col7 (type: double), _col8 (type: double)
+                        Statistics: Num rows: 307 Data size: 130168 Basic stats: COMPLETE Column stats: COMPLETE
+                        value expressions: _col1 (type: double), _col2 (type: double), _col3 (type: bigint), _col6 (type: string), _col7 (type: string), _col8 (type: double)
             Execution mode: llap
             LLAP IO: all inputs
         Reducer 2 
             Execution mode: llap
             Reduce Operator Tree:
               Group By Operator
-                aggregations: sum(VALUE._col0), count(VALUE._col1), sum(DISTINCT KEY._col0:0._col0), count(DISTINCT KEY._col0:1._col0), max(VALUE._col4), min(VALUE._col5), sum(VALUE._col6), sum(VALUE._col7)
+                aggregations: sum(VALUE._col0), sum(VALUE._col1), count(VALUE._col2), sum(DISTINCT KEY._col0:0._col0), count(DISTINCT KEY._col0:1._col0), max(VALUE._col5), min(VALUE._col6), sum(VALUE._col7)
                 mode: mergepartial
                 outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                 Statistics: Num rows: 1 Data size: 416 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
-                  expressions: _col0 (type: double), (_col0 / _col1) (type: double), (_col2 / _col3) (type: double), UDFToDouble(_col4) (type: double), UDFToDouble(_col5) (type: double), power(((_col6 - ((_col7 * _col7) / _col1)) / _col1), 0.5) (type: double), power(((_col6 - ((_col7 * _col7) / _col1)) / if((_col1 = 1L), null, (_col1 - 1))), 0.5) (type: double), ((_col6 - ((_col7 * _col7) / _col1)) / _col1) (type: double), ((_col6 - ((_col7 * _col7) / _col1)) / if((_col1 = 1L), null, (_col1 - 1))) (type: double)
+                  expressions: _col0 (type: double), (_col1 / _col2) (type: double), (_col3 / _col4) (type: double), UDFToDouble(_col5) (type: double), UDFToDouble(_col6) (type: double), power(((_col7 - ((_col1 * _col1) / _col2)) / _col2), 0.5) (type: double), power(((_col7 - ((_col1 * _col1) / _col2)) / if((_col2 = 1L), null, (_col2 - 1))), 0.5) (type: double), ((_col7 - ((_col1 * _col1) / _col2)) / _col2) (type: double), ((_col7 - ((_col1 * _col1) / _col2)) / if((_col2 = 1L), null, (_col2 - 1))) (type: double)
                   outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                   Statistics: Num rows: 1 Data size: 72 Basic stats: COMPLETE Column stats: COMPLETE
                   File Output Operator
diff --git a/ql/src/test/results/clientpositive/llap/groupby3_map_multi_distinct.q.out b/ql/src/test/results/clientpositive/llap/groupby3_map_multi_distinct.q.out
index 732df5e295..e84c42c819 100644
--- a/ql/src/test/results/clientpositive/llap/groupby3_map_multi_distinct.q.out
+++ b/ql/src/test/results/clientpositive/llap/groupby3_map_multi_distinct.q.out
@@ -64,30 +64,30 @@ STAGE PLANS:
                     outputColumnNames: _col0, _col1, _col2
                     Statistics: Num rows: 500 Data size: 45500 Basic stats: COMPLETE Column stats: COMPLETE
                     Group By Operator
-                      aggregations: sum(_col0), count(_col0), sum(DISTINCT _col0), count(DISTINCT _col0), max(_col0), min(_col0), sum(_col2), sum(_col1)
-                      keys: _col0 (type: string)
+                      aggregations: sum(_col0), sum(_col1), count(_col1), sum(DISTINCT _col1), count(DISTINCT _col1), max(_col0), min(_col0), sum(_col2), sum(DISTINCT _col0), count(DISTINCT _col0)
+                      keys: _col1 (type: double), _col0 (type: string)
                       minReductionHashAggr: 0.4
                       mode: hash
-                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
-                      Statistics: Num rows: 307 Data size: 154114 Basic stats: COMPLETE Column stats: COMPLETE
+                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11
+                      Statistics: Num rows: 500 Data size: 263000 Basic stats: COMPLETE Column stats: COMPLETE
                       Reduce Output Operator
-                        key expressions: _col0 (type: string)
-                        null sort order: z
-                        sort order: +
-                        Statistics: Num rows: 307 Data size: 154114 Basic stats: COMPLETE Column stats: COMPLETE
-                        value expressions: _col1 (type: double), _col2 (type: bigint), _col5 (type: string), _col6 (type: string), _col7 (type: double), _col8 (type: double)
+                        key expressions: _col0 (type: double), _col1 (type: string)
+                        null sort order: zz
+                        sort order: ++
+                        Statistics: Num rows: 500 Data size: 263000 Basic stats: COMPLETE Column stats: COMPLETE
+                        value expressions: _col2 (type: double), _col3 (type: double), _col4 (type: bigint), _col7 (type: string), _col8 (type: string), _col9 (type: double)
             Execution mode: llap
             LLAP IO: all inputs
         Reducer 2 
             Execution mode: llap
             Reduce Operator Tree:
               Group By Operator
-                aggregations: sum(VALUE._col0), count(VALUE._col1), sum(DISTINCT KEY._col0:0._col0), count(DISTINCT KEY._col0:1._col0), max(VALUE._col4), min(VALUE._col5), sum(VALUE._col6), sum(VALUE._col7)
+                aggregations: sum(VALUE._col0), sum(VALUE._col1), count(VALUE._col2), sum(DISTINCT KEY._col0:0._col0), count(DISTINCT KEY._col0:1._col0), max(VALUE._col5), min(VALUE._col6), sum(VALUE._col7), sum(DISTINCT KEY._col0:2._col0), count(DISTINCT KEY._col0:3._col0)
                 mode: mergepartial
-                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
-                Statistics: Num rows: 1 Data size: 416 Basic stats: COMPLETE Column stats: COMPLETE
+                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
+                Statistics: Num rows: 1 Data size: 432 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
-                  expressions: _col0 (type: double), (_col0 / _col1) (type: double), (_col2 / _col3) (type: double), UDFToDouble(_col4) (type: double), UDFToDouble(_col5) (type: double), power(((_col6 - ((_col7 * _col7) / _col1)) / _col1), 0.5) (type: double), power(((_col6 - ((_col7 * _col7) / _col1)) / if((_col1 = 1L), null, (_col1 - 1))), 0.5) (type: double), ((_col6 - ((_col7 * _col7) / _col1)) / _col1) (type: double), ((_col6 - ((_col7 * _col7) / _col1)) / if((_col1 = 1L), null, (_col1 - 1))) (type: double), _col2 (type: double), UDFToDouble(_col3) (type: double)
+                  expressions: _col0 (type: double), (_col1 / _col2) (type: double), (_col3 / _col4) (type: double), UDFToDouble(_col5) (type: double), UDFToDouble(_col6) (type: double), power(((_col7 - ((_col1 * _col1) / _col2)) / _col2), 0.5) (type: double), power(((_col7 - ((_col1 * _col1) / _col2)) / if((_col2 = 1L), null, (_col2 - 1))), 0.5) (type: double), ((_col7 - ((_col1 * _col1) / _col2)) / _col2) (type: double), ((_col7 - ((_col1 * _col1) / _col2)) / if((_col2 = 1L), null, (_col2 - 1))) (type: double), _col8 (type: double), UDFToDouble(_col9) (type: double)
                   outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
                   Statistics: Num rows: 1 Data size: 88 Basic stats: COMPLETE Column stats: COMPLETE
                   File Output Operator
diff --git a/ql/src/test/results/clientpositive/llap/groupby3_noskew.q.out b/ql/src/test/results/clientpositive/llap/groupby3_noskew.q.out
index facd48006d..0cf7808456 100644
--- a/ql/src/test/results/clientpositive/llap/groupby3_noskew.q.out
+++ b/ql/src/test/results/clientpositive/llap/groupby3_noskew.q.out
@@ -60,23 +60,23 @@ STAGE PLANS:
                     outputColumnNames: _col0, _col1, _col2
                     Statistics: Num rows: 500 Data size: 45500 Basic stats: COMPLETE Column stats: COMPLETE
                     Reduce Output Operator
-                      key expressions: _col0 (type: string)
+                      key expressions: _col1 (type: double)
                       null sort order: z
                       sort order: +
                       Statistics: Num rows: 500 Data size: 45500 Basic stats: COMPLETE Column stats: COMPLETE
-                      value expressions: _col2 (type: double), _col1 (type: double)
+                      value expressions: _col0 (type: string), _col2 (type: double)
             Execution mode: vectorized, llap
             LLAP IO: all inputs
         Reducer 2 
             Execution mode: llap
             Reduce Operator Tree:
               Group By Operator
-                aggregations: sum(KEY._col0:0._col0), count(KEY._col0:0._col0), sum(DISTINCT KEY._col0:0._col0), count(DISTINCT KEY._col0:1._col0), max(KEY._col0:0._col0), min(KEY._col0:0._col0), sum(VALUE._col0), sum(VALUE._col1)
+                aggregations: sum(VALUE._col0), sum(KEY._col0:0._col0), count(KEY._col0:0._col0), sum(DISTINCT KEY._col0:0._col0), count(DISTINCT KEY._col0:1._col0), max(VALUE._col0), min(VALUE._col0), sum(VALUE._col1)
                 mode: complete
                 outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                 Statistics: Num rows: 1 Data size: 416 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
-                  expressions: _col0 (type: double), (_col0 / _col1) (type: double), (_col2 / _col3) (type: double), UDFToDouble(_col4) (type: double), UDFToDouble(_col5) (type: double), power(((_col6 - ((_col7 * _col7) / _col1)) / _col1), 0.5) (type: double), power(((_col6 - ((_col7 * _col7) / _col1)) / if((_col1 = 1L), null, (_col1 - 1))), 0.5) (type: double), ((_col6 - ((_col7 * _col7) / _col1)) / _col1) (type: double), ((_col6 - ((_col7 * _col7) / _col1)) / if((_col1 = 1L), null, (_col1 - 1))) (type: double)
+                  expressions: _col0 (type: double), (_col1 / _col2) (type: double), (_col3 / _col4) (type: double), UDFToDouble(_col5) (type: double), UDFToDouble(_col6) (type: double), power(((_col7 - ((_col1 * _col1) / _col2)) / _col2), 0.5) (type: double), power(((_col7 - ((_col1 * _col1) / _col2)) / if((_col2 = 1L), null, (_col2 - 1))), 0.5) (type: double), ((_col7 - ((_col1 * _col1) / _col2)) / _col2) (type: double), ((_col7 - ((_col1 * _col1) / _col2)) / if((_col2 = 1L), null, (_col2 - 1))) (type: double)
                   outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                   Statistics: Num rows: 1 Data size: 72 Basic stats: COMPLETE Column stats: COMPLETE
                   File Output Operator
diff --git a/ql/src/test/results/clientpositive/llap/groupby3_noskew_multi_distinct.q.out b/ql/src/test/results/clientpositive/llap/groupby3_noskew_multi_distinct.q.out
index cc9adfd892..f1436d2594 100644
--- a/ql/src/test/results/clientpositive/llap/groupby3_noskew_multi_distinct.q.out
+++ b/ql/src/test/results/clientpositive/llap/groupby3_noskew_multi_distinct.q.out
@@ -64,23 +64,23 @@ STAGE PLANS:
                     outputColumnNames: _col0, _col1, _col2
                     Statistics: Num rows: 500 Data size: 45500 Basic stats: COMPLETE Column stats: COMPLETE
                     Reduce Output Operator
-                      key expressions: _col0 (type: string)
-                      null sort order: z
-                      sort order: +
+                      key expressions: _col1 (type: double), _col0 (type: string)
+                      null sort order: zz
+                      sort order: ++
                       Statistics: Num rows: 500 Data size: 45500 Basic stats: COMPLETE Column stats: COMPLETE
-                      value expressions: _col2 (type: double), _col1 (type: double)
+                      value expressions: _col2 (type: double)
             Execution mode: vectorized, llap
             LLAP IO: all inputs
         Reducer 2 
             Execution mode: llap
             Reduce Operator Tree:
               Group By Operator
-                aggregations: sum(KEY._col0:0._col0), count(KEY._col0:0._col0), sum(DISTINCT KEY._col0:0._col0), count(DISTINCT KEY._col0:1._col0), max(KEY._col0:0._col0), min(KEY._col0:0._col0), sum(VALUE._col0), sum(VALUE._col1)
+                aggregations: sum(KEY._col0:2._col0), sum(KEY._col0:0._col0), count(KEY._col0:0._col0), sum(DISTINCT KEY._col0:0._col0), count(DISTINCT KEY._col0:1._col0), max(KEY._col0:2._col0), min(KEY._col0:2._col0), sum(VALUE._col0), sum(DISTINCT KEY._col0:2._col0), count(DISTINCT KEY._col0:3._col0)
                 mode: complete
-                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
-                Statistics: Num rows: 1 Data size: 416 Basic stats: COMPLETE Column stats: COMPLETE
+                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
+                Statistics: Num rows: 1 Data size: 432 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
-                  expressions: _col0 (type: double), (_col0 / _col1) (type: double), (_col2 / _col3) (type: double), UDFToDouble(_col4) (type: double), UDFToDouble(_col5) (type: double), power(((_col6 - ((_col7 * _col7) / _col1)) / _col1), 0.5) (type: double), power(((_col6 - ((_col7 * _col7) / _col1)) / if((_col1 = 1L), null, (_col1 - 1))), 0.5) (type: double), ((_col6 - ((_col7 * _col7) / _col1)) / _col1) (type: double), ((_col6 - ((_col7 * _col7) / _col1)) / if((_col1 = 1L), null, (_col1 - 1))) (type: double), _col2 (type: double), UDFToDouble(_col3) (type: double)
+                  expressions: _col0 (type: double), (_col1 / _col2) (type: double), (_col3 / _col4) (type: double), UDFToDouble(_col5) (type: double), UDFToDouble(_col6) (type: double), power(((_col7 - ((_col1 * _col1) / _col2)) / _col2), 0.5) (type: double), power(((_col7 - ((_col1 * _col1) / _col2)) / if((_col2 = 1L), null, (_col2 - 1))), 0.5) (type: double), ((_col7 - ((_col1 * _col1) / _col2)) / _col2) (type: double), ((_col7 - ((_col1 * _col1) / _col2)) / if((_col2 = 1L), null, (_col2 - 1))) (type: double), _col8 (type: double), UDFToDouble(_col9) (type: double)
                   outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
                   Statistics: Num rows: 1 Data size: 88 Basic stats: COMPLETE Column stats: COMPLETE
                   File Output Operator
diff --git a/ql/src/test/results/clientpositive/llap/groupby_grouping_sets3.q.out b/ql/src/test/results/clientpositive/llap/groupby_grouping_sets3.q.out
index e20b023e71..a9fc48b0f0 100644
--- a/ql/src/test/results/clientpositive/llap/groupby_grouping_sets3.q.out
+++ b/ql/src/test/results/clientpositive/llap/groupby_grouping_sets3.q.out
@@ -51,12 +51,12 @@ STAGE PLANS:
                   alias: t1_n118
                   Statistics: Num rows: 1 Data size: 552 Basic stats: COMPLETE Column stats: NONE
                   Select Operator
-                    expressions: a (type: string), b (type: string), c (type: string)
-                    outputColumnNames: a, b, c
+                    expressions: a (type: string), b (type: string), UDFToDouble(c) (type: double)
+                    outputColumnNames: _col0, _col1, _col2
                     Statistics: Num rows: 1 Data size: 552 Basic stats: COMPLETE Column stats: NONE
                     Group By Operator
-                      aggregations: sum(c), count(c), count()
-                      keys: a (type: string), b (type: string), 0L (type: bigint)
+                      aggregations: sum(_col2), count(_col2), count()
+                      keys: _col0 (type: string), _col1 (type: string), 0L (type: bigint)
                       grouping sets: 0, 1, 2, 3
                       minReductionHashAggr: 0.99
                       mode: hash
@@ -128,12 +128,12 @@ STAGE PLANS:
                   alias: t1_n118
                   Statistics: Num rows: 1 Data size: 552 Basic stats: COMPLETE Column stats: NONE
                   Select Operator
-                    expressions: a (type: string), b (type: string), c (type: string)
-                    outputColumnNames: a, b, c
+                    expressions: a (type: string), b (type: string), UDFToDouble(c) (type: double)
+                    outputColumnNames: _col0, _col1, _col2
                     Statistics: Num rows: 1 Data size: 552 Basic stats: COMPLETE Column stats: NONE
                     Group By Operator
-                      aggregations: sum(c), count(c), count()
-                      keys: a (type: string), b (type: string), 0L (type: bigint)
+                      aggregations: sum(_col2), count(_col2), count()
+                      keys: _col0 (type: string), _col1 (type: string), 0L (type: bigint)
                       grouping sets: 0, 1, 2, 3
                       minReductionHashAggr: 0.99
                       mode: hash
@@ -231,12 +231,12 @@ STAGE PLANS:
                   alias: t1_n118
                   Statistics: Num rows: 1 Data size: 552 Basic stats: COMPLETE Column stats: NONE
                   Select Operator
-                    expressions: a (type: string), b (type: string), c (type: string)
-                    outputColumnNames: a, b, c
+                    expressions: a (type: string), b (type: string), UDFToDouble(c) (type: double)
+                    outputColumnNames: _col0, _col1, _col2
                     Statistics: Num rows: 1 Data size: 552 Basic stats: COMPLETE Column stats: NONE
                     Group By Operator
-                      aggregations: sum(c), count(c), count()
-                      keys: a (type: string), b (type: string)
+                      aggregations: sum(_col2), count(_col2), count()
+                      keys: _col0 (type: string), _col1 (type: string)
                       minReductionHashAggr: 0.99
                       mode: hash
                       outputColumnNames: _col0, _col1, _col2, _col3, _col4
diff --git a/ql/src/test/results/clientpositive/llap/parquet_vectorization_0.q.out b/ql/src/test/results/clientpositive/llap/parquet_vectorization_0.q.out
index 21f87f9e1a..974b0f0750 100644
--- a/ql/src/test/results/clientpositive/llap/parquet_vectorization_0.q.out
+++ b/ql/src/test/results/clientpositive/llap/parquet_vectorization_0.q.out
@@ -236,16 +236,16 @@ STAGE PLANS:
                     outputColumnNames: _col0, _col1, _col2
                     Statistics: Num rows: 12288 Data size: 36696 Basic stats: COMPLETE Column stats: COMPLETE
                     Group By Operator
-                      aggregations: sum(_col0), count(_col0), sum(_col2), sum(_col1)
+                      aggregations: sum(_col0), count(_col0), sum(_col2), sum(_col1), count(_col1)
                       minReductionHashAggr: 0.99
                       mode: hash
-                      outputColumnNames: _col0, _col1, _col2, _col3
-                      Statistics: Num rows: 1 Data size: 32 Basic stats: COMPLETE Column stats: COMPLETE
+                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
+                      Statistics: Num rows: 1 Data size: 40 Basic stats: COMPLETE Column stats: COMPLETE
                       Reduce Output Operator
                         null sort order: 
                         sort order: 
-                        Statistics: Num rows: 1 Data size: 32 Basic stats: COMPLETE Column stats: COMPLETE
-                        value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: double), _col3 (type: double)
+                        Statistics: Num rows: 1 Data size: 40 Basic stats: COMPLETE Column stats: COMPLETE
+                        value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: double), _col3 (type: double), _col4 (type: bigint)
             Execution mode: vectorized, llap
             LLAP IO: all inputs (cache only)
             Map Vectorization:
@@ -267,12 +267,12 @@ STAGE PLANS:
                 vectorized: true
             Reduce Operator Tree:
               Group By Operator
-                aggregations: sum(VALUE._col0), count(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3)
+                aggregations: sum(VALUE._col0), count(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3), count(VALUE._col4)
                 mode: mergepartial
-                outputColumnNames: _col0, _col1, _col2, _col3
-                Statistics: Num rows: 1 Data size: 32 Basic stats: COMPLETE Column stats: COMPLETE
+                outputColumnNames: _col0, _col1, _col2, _col3, _col4
+                Statistics: Num rows: 1 Data size: 40 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
-                  expressions: (UDFToDouble(_col0) / _col1) (type: double), ((_col2 - ((_col3 * _col3) / _col1)) / _col1) (type: double), ((_col2 - ((_col3 * _col3) / _col1)) / _col1) (type: double), ((_col2 - ((_col3 * _col3) / _col1)) / if((_col1 = 1L), null, (_col1 - 1))) (type: double), power(((_col2 - ((_col3 * _col3) / _col1)) / _col1), 0.5) (type: double), power(((_col2 - ((_col3 * _col3) / _col1)) / _col1), 0.5) (type: double), power(((_col2 - ((_col3 * _col3) / _col1)) / _col1), 0.5) (type: double), power(((_col2 - ((_col3 * _col3) / _col1)) / if((_col1 = 1L), null, (_col1 - 1))), 0.5) (type: double)
+                  expressions: (UDFToDouble(_col0) / _col1) (type: double), ((_col2 - ((_col3 * _col3) / _col4)) / _col4) (type: double), ((_col2 - ((_col3 * _col3) / _col4)) / _col4) (type: double), ((_col2 - ((_col3 * _col3) / _col4)) / if((_col4 = 1L), null, (_col4 - 1))) (type: double), power(((_col2 - ((_col3 * _col3) / _col4)) / _col4), 0.5) (type: double), power(((_col2 - ((_col3 * _col3) / _col4)) / _col4), 0.5) (type: double), power(((_col2 - ((_col3 * _col3) / _col4)) / _col4), 0.5) (type: double), power(((_col2 - ((_col3 * _col3) / _col4)) / if((_col4 = 1L), null, (_col4 - 1))), 0.5) (type: double)
                   outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                   Statistics: Num rows: 1 Data size: 64 Basic stats: COMPLETE Column stats: COMPLETE
                   File Output Operator
@@ -556,16 +556,16 @@ STAGE PLANS:
                     outputColumnNames: _col0, _col1, _col2
                     Statistics: Num rows: 12288 Data size: 73392 Basic stats: COMPLETE Column stats: COMPLETE
                     Group By Operator
-                      aggregations: sum(_col0), count(_col0), sum(_col2), sum(_col1)
+                      aggregations: sum(_col0), count(_col0), sum(_col2), sum(_col1), count(_col1)
                       minReductionHashAggr: 0.99
                       mode: hash
-                      outputColumnNames: _col0, _col1, _col2, _col3
-                      Statistics: Num rows: 1 Data size: 32 Basic stats: COMPLETE Column stats: COMPLETE
+                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
+                      Statistics: Num rows: 1 Data size: 40 Basic stats: COMPLETE Column stats: COMPLETE
                       Reduce Output Operator
                         null sort order: 
                         sort order: 
-                        Statistics: Num rows: 1 Data size: 32 Basic stats: COMPLETE Column stats: COMPLETE
-                        value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: double), _col3 (type: double)
+                        Statistics: Num rows: 1 Data size: 40 Basic stats: COMPLETE Column stats: COMPLETE
+                        value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: double), _col3 (type: double), _col4 (type: bigint)
             Execution mode: vectorized, llap
             LLAP IO: all inputs (cache only)
             Map Vectorization:
@@ -587,12 +587,12 @@ STAGE PLANS:
                 vectorized: true
             Reduce Operator Tree:
               Group By Operator
-                aggregations: sum(VALUE._col0), count(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3)
+                aggregations: sum(VALUE._col0), count(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3), count(VALUE._col4)
                 mode: mergepartial
-                outputColumnNames: _col0, _col1, _col2, _col3
-                Statistics: Num rows: 1 Data size: 32 Basic stats: COMPLETE Column stats: COMPLETE
+                outputColumnNames: _col0, _col1, _col2, _col3, _col4
+                Statistics: Num rows: 1 Data size: 40 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
-                  expressions: (UDFToDouble(_col0) / _col1) (type: double), ((_col2 - ((_col3 * _col3) / _col1)) / _col1) (type: double), ((_col2 - ((_col3 * _col3) / _col1)) / _col1) (type: double), ((_col2 - ((_col3 * _col3) / _col1)) / if((_col1 = 1L), null, (_col1 - 1))) (type: double), power(((_col2 - ((_col3 * _col3) / _col1)) / _col1), 0.5) (type: double), power(((_col2 - ((_col3 * _col3) / _col1)) / _col1), 0.5) (type: double), power(((_col2 - ((_col3 * _col3) / _col1)) / _col1), 0.5) (type: double), power(((_col2 - ((_col3 * _col3) / _col1)) / if((_col1 = 1L), null, (_col1 - 1))), 0.5) (type: double)
+                  expressions: (UDFToDouble(_col0) / _col1) (type: double), ((_col2 - ((_col3 * _col3) / _col4)) / _col4) (type: double), ((_col2 - ((_col3 * _col3) / _col4)) / _col4) (type: double), ((_col2 - ((_col3 * _col3) / _col4)) / if((_col4 = 1L), null, (_col4 - 1))) (type: double), power(((_col2 - ((_col3 * _col3) / _col4)) / _col4), 0.5) (type: double), power(((_col2 - ((_col3 * _col3) / _col4)) / _col4), 0.5) (type: double), power(((_col2 - ((_col3 * _col3) / _col4)) / _col4), 0.5) (type: double), power(((_col2 - ((_col3 * _col3) / _col4)) / if((_col4 = 1L), null, (_col4 - 1))), 0.5) (type: double)
                   outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                   Statistics: Num rows: 1 Data size: 64 Basic stats: COMPLETE Column stats: COMPLETE
                   File Output Operator
@@ -876,16 +876,16 @@ STAGE PLANS:
                     outputColumnNames: _col0, _col1, _col2
                     Statistics: Num rows: 12288 Data size: 36696 Basic stats: COMPLETE Column stats: COMPLETE
                     Group By Operator
-                      aggregations: sum(_col0), count(_col0), sum(_col2), sum(_col1)
+                      aggregations: sum(_col0), count(_col0), sum(_col2), sum(_col1), count(_col1)
                       minReductionHashAggr: 0.99
                       mode: hash
-                      outputColumnNames: _col0, _col1, _col2, _col3
-                      Statistics: Num rows: 1 Data size: 32 Basic stats: COMPLETE Column stats: COMPLETE
+                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
+                      Statistics: Num rows: 1 Data size: 40 Basic stats: COMPLETE Column stats: COMPLETE
                       Reduce Output Operator
                         null sort order: 
                         sort order: 
-                        Statistics: Num rows: 1 Data size: 32 Basic stats: COMPLETE Column stats: COMPLETE
-                        value expressions: _col0 (type: double), _col1 (type: bigint), _col2 (type: double), _col3 (type: double)
+                        Statistics: Num rows: 1 Data size: 40 Basic stats: COMPLETE Column stats: COMPLETE
+                        value expressions: _col0 (type: double), _col1 (type: bigint), _col2 (type: double), _col3 (type: double), _col4 (type: bigint)
             Execution mode: vectorized, llap
             LLAP IO: all inputs (cache only)
             Map Vectorization:
@@ -907,12 +907,12 @@ STAGE PLANS:
                 vectorized: true
             Reduce Operator Tree:
               Group By Operator
-                aggregations: sum(VALUE._col0), count(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3)
+                aggregations: sum(VALUE._col0), count(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3), count(VALUE._col4)
                 mode: mergepartial
-                outputColumnNames: _col0, _col1, _col2, _col3
-                Statistics: Num rows: 1 Data size: 32 Basic stats: COMPLETE Column stats: COMPLETE
+                outputColumnNames: _col0, _col1, _col2, _col3, _col4
+                Statistics: Num rows: 1 Data size: 40 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
-                  expressions: (_col0 / _col1) (type: double), ((_col2 - ((_col3 * _col3) / _col1)) / _col1) (type: double), ((_col2 - ((_col3 * _col3) / _col1)) / _col1) (type: double), ((_col2 - ((_col3 * _col3) / _col1)) / if((_col1 = 1L), null, (_col1 - 1))) (type: double), power(((_col2 - ((_col3 * _col3) / _col1)) / _col1), 0.5) (type: double), power(((_col2 - ((_col3 * _col3) / _col1)) / _col1), 0.5) (type: double), power(((_col2 - ((_col3 * _col3) / _col1)) / _col1), 0.5) (type: double), power(((_col2 - ((_col3 * _col3) / _col1)) / if((_col1 = 1L), null, (_col1 - 1))), 0.5) (type: double)
+                  expressions: (_col0 / _col1) (type: double), ((_col2 - ((_col3 * _col3) / _col4)) / _col4) (type: double), ((_col2 - ((_col3 * _col3) / _col4)) / _col4) (type: double), ((_col2 - ((_col3 * _col3) / _col4)) / if((_col4 = 1L), null, (_col4 - 1))) (type: double), power(((_col2 - ((_col3 * _col3) / _col4)) / _col4), 0.5) (type: double), power(((_col2 - ((_col3 * _col3) / _col4)) / _col4), 0.5) (type: double), power(((_col2 - ((_col3 * _col3) / _col4)) / _col4), 0.5) (type: double), power(((_col2 - ((_col3 * _col3) / _col4)) / if((_col4 = 1L), null, (_col4 - 1))), 0.5) (type: double)
                   outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                   Statistics: Num rows: 1 Data size: 64 Basic stats: COMPLETE Column stats: COMPLETE
                   File Output Operator
@@ -1058,18 +1058,18 @@ STAGE PLANS:
                           selectExpressions: CastLongToDouble(col 3:bigint) -> 16:double, DoubleColMultiplyDoubleColumn(col 17:double, col 18:double)(children: CastLongToDouble(col 3:bigint) -> 17:double, CastLongToDouble(col 3:bigint) -> 18:double) -> 19:double
                       Statistics: Num rows: 12288 Data size: 1210980 Basic stats: COMPLETE Column stats: COMPLETE
                       Group By Operator
-                        aggregations: sum(_col0), count(_col0), sum(_col4), sum(_col3), count(), sum(_col1), min(_col2)
+                        aggregations: sum(_col0), count(_col0), sum(_col4), sum(_col3), count(_col3), count(), sum(_col1), min(_col2)
                         Group By Vectorization:
-                            aggregators: VectorUDAFSumLong(col 3:bigint) -> bigint, VectorUDAFCount(col 3:bigint) -> bigint, VectorUDAFSumDouble(col 19:double) -> double, VectorUDAFSumDouble(col 16:double) -> double, VectorUDAFCountStar(*) -> bigint, VectorUDAFSumDouble(col 4:float) -> double, VectorUDAFMinLong(col 0:tinyint) -> tinyint
+                            aggregators: VectorUDAFSumLong(col 3:bigint) -> bigint, VectorUDAFCount(col 3:bigint) -> bigint, VectorUDAFSumDouble(col 19:double) -> double, VectorUDAFSumDouble(col 16:double) -> double, VectorUDAFCount(col 16:double) -> bigint, VectorUDAFCountStar(*) -> bigint, VectorUDAFSumDouble(col 4:float) -> double, VectorUDAFMinLong(col 0:tinyint) -> tinyint
                             className: VectorGroupByOperator
                             groupByMode: HASH
                             native: false
                             vectorProcessingMode: HASH
-                            projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6]
+                            projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6, 7]
                         minReductionHashAggr: 0.99
                         mode: hash
-                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
-                        Statistics: Num rows: 1 Data size: 52 Basic stats: COMPLETE Column stats: COMPLETE
+                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
+                        Statistics: Num rows: 1 Data size: 60 Basic stats: COMPLETE Column stats: COMPLETE
                         Reduce Output Operator
                           null sort order: 
                           sort order: 
@@ -1077,8 +1077,8 @@ STAGE PLANS:
                               className: VectorReduceSinkEmptyKeyOperator
                               native: true
                               nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
-                          Statistics: Num rows: 1 Data size: 52 Basic stats: COMPLETE Column stats: COMPLETE
-                          value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: double), _col3 (type: double), _col4 (type: bigint), _col5 (type: double), _col6 (type: tinyint)
+                          Statistics: Num rows: 1 Data size: 60 Basic stats: COMPLETE Column stats: COMPLETE
+                          value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: double), _col3 (type: double), _col4 (type: bigint), _col5 (type: bigint), _col6 (type: double), _col7 (type: tinyint)
             Execution mode: vectorized, llap
             LLAP IO: all inputs (cache only)
             Map Vectorization:
@@ -1100,25 +1100,25 @@ STAGE PLANS:
                 vectorized: true
             Reduce Operator Tree:
               Group By Operator
-                aggregations: sum(VALUE._col0), count(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3), count(VALUE._col4), sum(VALUE._col5), min(VALUE._col6)
+                aggregations: sum(VALUE._col0), count(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3), count(VALUE._col4), count(VALUE._col5), sum(VALUE._col6), min(VALUE._col7)
                 Group By Vectorization:
-                    aggregators: VectorUDAFSumLong(col 0:bigint) -> bigint, VectorUDAFCountMerge(col 1:bigint) -> bigint, VectorUDAFSumDouble(col 2:double) -> double, VectorUDAFSumDouble(col 3:double) -> double, VectorUDAFCountMerge(col 4:bigint) -> bigint, VectorUDAFSumDouble(col 5:double) -> double, VectorUDAFMinLong(col 6:tinyint) -> tinyint
+                    aggregators: VectorUDAFSumLong(col 0:bigint) -> bigint, VectorUDAFCountMerge(col 1:bigint) -> bigint, VectorUDAFSumDouble(col 2:double) -> double, VectorUDAFSumDouble(col 3:double) -> double, VectorUDAFCountMerge(col 4:bigint) -> bigint, VectorUDAFCountMerge(col 5:bigint) -> bigint, VectorUDAFSumDouble(col 6:double) -> double, VectorUDAFMinLong(col 7:tinyint) -> tinyint
                     className: VectorGroupByOperator
                     groupByMode: MERGEPARTIAL
                     native: false
                     vectorProcessingMode: GLOBAL
-                    projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6]
+                    projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6, 7]
                 mode: mergepartial
-                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
-                Statistics: Num rows: 1 Data size: 52 Basic stats: COMPLETE Column stats: COMPLETE
+                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
+                Statistics: Num rows: 1 Data size: 60 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
-                  expressions: (UDFToDouble(_col0) / _col1) (type: double), (- (UDFToDouble(_col0) / _col1)) (type: double), (-6432.0D + (UDFToDouble(_col0) / _col1)) (type: double), power(((_col2 - ((_col3 * _col3) / _col1)) / _col1), 0.5) (type: double), (- (-6432.0D + (UDFToDouble(_col0) / _col1))) (type: double), ((- (-6432.0D + (UDFToDouble(_col0) / _col1))) + (-6432.0D + (UDFToDouble(_col0) / _col1))) (type: double), ((_col2 - ((_col3 * _col3) / _col1)) / if((_col1 = 1L), null, (_col1 - 1))) (type: double), (- (-6432.0D + (UDFToDouble(_col0) / _col1))) (type: double), (-6432.0D + (- (-6432.0D + (UDFToDouble(_col0) / _col1)))) (type: double), (- (-6432.0D + (UDFToDouble(_col0) / _col1))) (type: double), ((- (-6432.0D + (UDFToDouble(_col0) / _col1))) / (- (-6432.0D + (UDFToDouble(_col0) / _col1)))) (type: double), _col4 (type: bigint), _col5 (type: double), (((_col2 - ((_col3 * _col3) / _col1)) / if((_col1 = 1L), null, (_col1 - 1))) % power(((_col2 - ((_col3 * _col3) / _col1)) / _col1), 0.5)) (type: double), (- ((_col2 - ((_col3 * _col3) / _col1)) / if((_col1 = 1L), null, (_col1 - 1)))) (type: double), ((- (-6432.0D + (UDFToDouble(_col0) / _col1))) * (- (UDFToDouble(_col0) / _col1))) (type: double), _col6 (type: tinyint), (- _col6) (type: tinyint)
+                  expressions: (UDFToDouble(_col0) / _col1) (type: double), (- (UDFToDouble(_col0) / _col1)) (type: double), (-6432.0D + (UDFToDouble(_col0) / _col1)) (type: double), power(((_col2 - ((_col3 * _col3) / _col4)) / _col4), 0.5) (type: double), (- (-6432.0D + (UDFToDouble(_col0) / _col1))) (type: double), ((- (-6432.0D + (UDFToDouble(_col0) / _col1))) + (-6432.0D + (UDFToDouble(_col0) / _col1))) (type: double), ((_col2 - ((_col3 * _col3) / _col4)) / if((_col4 = 1L), null, (_col4 - 1))) (type: double), (- (-6432.0D + (UDFToDouble(_col0) / _col1))) (type: double), (-6432.0D + (- (-6432.0D + (UDFToDouble(_col0) / _col1)))) (type: double), (- (-6432.0D + (UDFToDouble(_col0) / _col1))) (type: double), ((- (-6432.0D + (UDFToDouble(_col0) / _col1))) / (- (-6432.0D + (UDFToDouble(_col0) / _col1)))) (type: double), _col5 (type: bigint), _col6 (type: double), (((_col2 - ((_col3 * _col3) / _col4)) / if((_col4 = 1L), null, (_col4 - 1))) % power(((_col2 - ((_col3 * _col3) / _col4)) / _col4), 0.5)) (type: double), (- ((_col2 - ((_col3 * _col3) / _col4)) / if((_col4 = 1L), null, (_col4 - 1)))) (type: double), ((- (-6432.0D + (UDFToDouble(_col0) / _col1))) * (- (UDFToDouble(_col0) / _col1))) (type: double), _col7 (type: tinyint), (- _col7) (type: tinyint)
                   outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
                   Select Vectorization:
                       className: VectorSelectOperator
                       native: true
-                      projectedOutputColumnNums: [8, 11, 14, 19, 23, 31, 38, 42, 47, 51, 60, 4, 5, 73, 81, 89, 6, 90]
-                      selectExpressions: DoubleColDivideLongColumn(col 7:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 7:double) -> 8:double, DoubleColUnaryMinus(col 10:double)(children: DoubleColDivideLongColumn(col 9:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 9:double) -> 10:double) -> 11:double, DoubleScalarAddDoubleColumn(val -6432.0, col 13:double)(children: DoubleColDivideLongColumn(col 12:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 12:double) -> 13:double) -> 14:double, FuncPowerDoubleToDouble(col 18:double)(children: DoubleColDivideLongColumn(col 17:double, col 1:bigint)(children: DoubleColSubtractDoubleColumn(col 2:double, col 16:double)(children: DoubleColDivideLongColumn(col 15:double, col 1:bigint)(children: DoubleColMultiplyDoubleColumn(col 3:double, col 3:double) -> 15:double) -> 16:double) -> 17:double) -> 18:double) -> 19:double, DoubleColUnaryMinus(col 22:double)(children: DoubleScalarAddDoubleColumn(val -6432.0, col 21:double)(children: DoubleColDivideLongColumn(col 20:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 20:double) -> 21:double) -> 22:double) -> 23:double, DoubleColAddDoubleColumn(col 27:double, col 30:double)(children: DoubleColUnaryMinus(col 26:double)(children: DoubleScalarAddDoubleColumn(val -6432.0, col 25:double)(children: DoubleColDivideLongColumn(col 24:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 24:double) -> 25:double) -> 26:double) -> 27:double, DoubleScalarAddDoubleColumn(val -6432.0, col 29:double)(children: DoubleColDivideLongColumn(col 28:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 28:double) -> 29:double) -> 30:double) -> 31:double, DoubleColDivideLongColumn(col 34:double, col 37:bigint)(children: DoubleColSubtractDoubleColumn(col 2:double, col 33:double)(children: DoubleColDivideLongColumn(col 32:double, col 1:bigint)(children: DoubleColMultiplyDoubleColumn(col 3:double, col 3:double) -> 32:double) -> 33:double) -> 34:double, IfExprNullCondExpr(col 35:boolean, null, col 36:bigint)(children: LongColEqualLongScalar(col 1:bigint, val 1) -> 35:boolean, LongColSubtractLongScalar(col 1:bigint, val 1) -> 36:bigint) -> 37:bigint) -> 38:double, DoubleColUnaryMinus(col 41:double)(children: DoubleScalarAddDoubleColumn(val -6432.0, col 40:double)(children: DoubleColDivideLongColumn(col 39:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 39:double) -> 40:double) -> 41:double) -> 42:double, DoubleScalarAddDoubleColumn(val -6432.0, col 46:double)(children: DoubleColUnaryMinus(col 45:double)(children: DoubleScalarAddDoubleColumn(val -6432.0, col 44:double)(children: DoubleColDivideLongColumn(col 43:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 43:double) -> 44:double) -> 45:double) -> 46:double) -> 47:double, DoubleColUnaryMinus(col 50:double)(children: DoubleScalarAddDoubleColumn(val -6432.0, col 49:double)(children: DoubleColDivideLongColumn(col 48:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 48:double) -> 49:double) -> 50:double) -> 51:double, DoubleColDivideDoubleColumn(col 55:double, col 59:double)(children: DoubleColUnaryMinus(col 54:double)(children: DoubleScalarAddDoubleColumn(val -6432.0, col 53:double)(children: DoubleColDivideLongColumn(col 52:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 52:double) -> 53:double) -> 54:double) -> 55:double, DoubleColUnaryMinus(col 58:double)(children: DoubleScalarAddDoubleColumn(val -6432.0, col 57:double)(children: DoubleColDivideLongColumn(col 56:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 56:double) -> 57:double) -> 58:double) -> 59:double) -> 60:double, DoubleColModuloDoubleColumn(col 67:double, col 72:double)(children: DoubleColDivideLongColumn(col 63:double, col 66:bigint)(children: DoubleColSubtractDoubleColumn(col 2:double, col 62:double)(children: DoubleColDivideLongColumn(col 61:double, col 1:bigint)(children: DoubleColMultiplyDoubleColumn(col 3:double, col 3:double) -> 61:double) -> 62:double) -> 63:double, IfExprNullCondExpr(col 64:boolean, null, col 65:bigint)(children: LongColEqualLongScalar(col 1:bigint, val 1) -> 64:boolean, LongColSubtractLongScalar(col 1:bigint, val 1) -> 65:bigint) -> 66:bigint) -> 67:double, FuncPowerDoubleToDouble(col 71:double)(children: DoubleColDivideLongColumn(col 70:double, col 1:bigint)(children: DoubleColSubtractDoubleColumn(col 2:double, col 69:double)(children: DoubleColDivideLongColumn(col 68:double, col 1:bigint)(children: DoubleColMultiplyDoubleColumn(col 3:double, col 3:double) -> 68:double) -> 69:double) -> 70:double) -> 71:double) -> 72:double) -> 73:double, DoubleColUnaryMinus(col 80:double)(children: DoubleColDivideLongColumn(col 76:double, col 79:bigint)(children: DoubleColSubtractDoubleColumn(col 2:double, col 75:double)(children: DoubleColDivideLongColumn(col 74:double, col 1:bigint)(children: DoubleColMultiplyDoubleColumn(col 3:double, col 3:double) -> 74:double) -> 75:double) -> 76:double, IfExprNullCondExpr(col 77:boolean, null, col 78:bigint)(children: LongColEqualLongScalar(col 1:bigint, val 1) -> 77:boolean, LongColSubtractLongScalar(col 1:bigint, val 1) -> 78:bigint) -> 79:bigint) -> 80:double) -> 81:double, DoubleColMultiplyDoubleColumn(col 85:double, col 88:double)(children: DoubleColUnaryMinus(col 84:double)(children: DoubleScalarAddDoubleColumn(val -6432.0, col 83:double)(children: DoubleColDivideLongColumn(col 82:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 82:double) -> 83:double) -> 84:double) -> 85:double, DoubleColUnaryMinus(col 87:double)(children: DoubleColDivideLongColumn(col 86:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 86:double) -> 87:double) -> 88:double) -> 89:double, LongColUnaryMinus(col 6:tinyint) -> 90:tinyint
+                      projectedOutputColumnNums: [9, 12, 15, 20, 24, 32, 39, 43, 48, 52, 61, 5, 6, 74, 82, 90, 7, 91]
+                      selectExpressions: DoubleColDivideLongColumn(col 8:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 8:double) -> 9:double, DoubleColUnaryMinus(col 11:double)(children: DoubleColDivideLongColumn(col 10:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 10:double) -> 11:double) -> 12:double, DoubleScalarAddDoubleColumn(val -6432.0, col 14:double)(children: DoubleColDivideLongColumn(col 13:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 13:double) -> 14:double) -> 15:double, FuncPowerDoubleToDouble(col 19:double)(children: DoubleColDivideLongColumn(col 18:double, col 4:bigint)(children: DoubleColSubtractDoubleColumn(col 2:double, col 17:double)(children: DoubleColDivideLongColumn(col 16:double, col 4:bigint)(children: DoubleColMultiplyDoubleColumn(col 3:double, col 3:double) -> 16:double) -> 17:double) -> 18:double) -> 19:double) -> 20:double, DoubleColUnaryMinus(col 23:double)(children: DoubleScalarAddDoubleColumn(val -6432.0, col 22:double)(children: DoubleColDivideLongColumn(col 21:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 21:double) -> 22:double) -> 23:double) -> 24:double, DoubleColAddDoubleColumn(col 28:double, col 31:double)(children: DoubleColUnaryMinus(col 27:double)(children: DoubleScalarAddDoubleColumn(val -6432.0, col 26:double)(children: DoubleColDivideLongColumn(col 25:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 25:double) -> 26:double) -> 27:double) -> 28:double, DoubleScalarAddDoubleColumn(val -6432.0, col 30:double)(children: DoubleColDivideLongColumn(col 29:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 29:double) -> 30:double) -> 31:double) -> 32:double, DoubleColDivideLongColumn(col 35:double, col 38:bigint)(children: DoubleColSubtractDoubleColumn(col 2:double, col 34:double)(children: DoubleColDivideLongColumn(col 33:double, col 4:bigint)(children: DoubleColMultiplyDoubleColumn(col 3:double, col 3:double) -> 33:double) -> 34:double) -> 35:double, IfExprNullCondExpr(col 36:boolean, null, col 37:bigint)(children: LongColEqualLongScalar(col 4:bigint, val 1) -> 36:boolean, LongColSubtractLongScalar(col 4:bigint, val 1) -> 37:bigint) -> 38:bigint) -> 39:double, DoubleColUnaryMinus(col 42:double)(children: DoubleScalarAddDoubleColumn(val -6432.0, col 41:double)(children: DoubleColDivideLongColumn(col 40:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 40:double) -> 41:double) -> 42:double) -> 43:double, DoubleScalarAddDoubleColumn(val -6432.0, col 47:double)(children: DoubleColUnaryMinus(col 46:double)(children: DoubleScalarAddDoubleColumn(val -6432.0, col 45:double)(children: DoubleColDivideLongColumn(col 44:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 44:double) -> 45:double) -> 46:double) -> 47:double) -> 48:double, DoubleColUnaryMinus(col 51:double)(children: DoubleScalarAddDoubleColumn(val -6432.0, col 50:double)(children: DoubleColDivideLongColumn(col 49:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 49:double) -> 50:double) -> 51:double) -> 52:double, DoubleColDivideDoubleColumn(col 56:double, col 60:double)(children: DoubleColUnaryMinus(col 55:double)(children: DoubleScalarAddDoubleColumn(val -6432.0, col 54:double)(children: DoubleColDivideLongColumn(col 53:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 53:double) -> 54:double) -> 55:double) -> 56:double, DoubleColUnaryMinus(col 59:double)(children: DoubleScalarAddDoubleColumn(val -6432.0, col 58:double)(children: DoubleColDivideLongColumn(col 57:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 57:double) -> 58:double) -> 59:double) -> 60:double) -> 61:double, DoubleColModuloDoubleColumn(col 68:double, col 73:double)(children: DoubleColDivideLongColumn(col 64:double, col 67:bigint)(children: DoubleColSubtractDoubleColumn(col 2:double, col 63:double)(children: DoubleColDivideLongColumn(col 62:double, col 4:bigint)(children: DoubleColMultiplyDoubleColumn(col 3:double, col 3:double) -> 62:double) -> 63:double) -> 64:double, IfExprNullCondExpr(col 65:boolean, null, col 66:bigint)(children: LongColEqualLongScalar(col 4:bigint, val 1) -> 65:boolean, LongColSubtractLongScalar(col 4:bigint, val 1) -> 66:bigint) -> 67:bigint) -> 68:double, FuncPowerDoubleToDouble(col 72:double)(children: DoubleColDivideLongColumn(col 71:double, col 4:bigint)(children: DoubleColSubtractDoubleColumn(col 2:double, col 70:double)(children: DoubleColDivideLongColumn(col 69:double, col 4:bigint)(children: DoubleColMultiplyDoubleColumn(col 3:double, col 3:double) -> 69:double) -> 70:double) -> 71:double) -> 72:double) -> 73:double) -> 74:double, DoubleColUnaryMinus(col 81:double)(children: DoubleColDivideLongColumn(col 77:double, col 80:bigint)(children: DoubleColSubtractDoubleColumn(col 2:double, col 76:double)(children: DoubleColDivideLongColumn(col 75:double, col 4:bigint)(children: DoubleColMultiplyDoubleColumn(col 3:double, col 3:double) -> 75:double) -> 76:double) -> 77:double, IfExprNullCondExpr(col 78:boolean, null, col 79:bigint)(children: LongColEqualLongScalar(col 4:bigint, val 1) -> 78:boolean, LongColSubtractLongScalar(col 4:bigint, val 1) -> 79:bigint) -> 80:bigint) -> 81:double) -> 82:double, DoubleColMultiplyDoubleColumn(col 86:double, col 89:double)(children: DoubleColUnaryMinus(col 85:double)(children: DoubleScalarAddDoubleColumn(val -6432.0, col 84:double)(children: DoubleColDivideLongColumn(col 83:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 83:double) -> 84:double) -> 85:double) -> 86:double, DoubleColUnaryMinus(col 88:double)(children: DoubleColDivideLongColumn(col 87:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 87:double) -> 88:double) -> 89:double) -> 90:double, LongColUnaryMinus(col 7:tinyint) -> 91:tinyint
                   Statistics: Num rows: 1 Data size: 136 Basic stats: COMPLETE Column stats: COMPLETE
                   File Output Operator
                     compressed: false
diff --git a/ql/src/test/results/clientpositive/llap/parquet_vectorization_1.q.out b/ql/src/test/results/clientpositive/llap/parquet_vectorization_1.q.out
index eee59739be..954191c63f 100644
--- a/ql/src/test/results/clientpositive/llap/parquet_vectorization_1.q.out
+++ b/ql/src/test/results/clientpositive/llap/parquet_vectorization_1.q.out
@@ -85,9 +85,9 @@ STAGE PLANS:
                           selectExpressions: CastLongToDouble(col 0:tinyint) -> 15:double, DoubleColMultiplyDoubleColumn(col 16:double, col 17:double)(children: CastLongToDouble(col 0:tinyint) -> 16:double, CastLongToDouble(col 0:tinyint) -> 17:double) -> 18:double, DoubleColMultiplyDoubleColumn(col 5:double, col 5:double) -> 19:double
                       Statistics: Num rows: 12288 Data size: 330276 Basic stats: COMPLETE Column stats: COMPLETE
                       Group By Operator
-                        aggregations: sum(_col5), sum(_col4), count(_col0), sum(_col1), max(_col0), max(_col2), sum(_col6), sum(_col3), count(_col3), count(_col2)
+                        aggregations: sum(_col5), sum(_col4), count(_col4), sum(_col1), max(_col0), max(_col2), sum(_col6), sum(_col3), count(_col3), count(_col2)
                         Group By Vectorization:
-                            aggregators: VectorUDAFSumDouble(col 18:double) -> double, VectorUDAFSumDouble(col 15:double) -> double, VectorUDAFCount(col 0:tinyint) -> bigint, VectorUDAFSumDouble(col 4:float) -> double, VectorUDAFMaxLong(col 0:tinyint) -> tinyint, VectorUDAFMaxLong(col 2:int) -> int, VectorUDAFSumDouble(col 19:double) -> double, VectorUDAFSumDouble(col 5:double) -> double, VectorUDAFCount(col 5:double) -> bigint, VectorUDAFCount(col 2:int) -> bigint
+                            aggregators: VectorUDAFSumDouble(col 18:double) -> double, VectorUDAFSumDouble(col 15:double) -> double, VectorUDAFCount(col 15:double) -> bigint, VectorUDAFSumDouble(col 4:float) -> double, VectorUDAFMaxLong(col 0:tinyint) -> tinyint, VectorUDAFMaxLong(col 2:int) -> int, VectorUDAFSumDouble(col 19:double) -> double, VectorUDAFSumDouble(col 5:double) -> double, VectorUDAFCount(col 5:double) -> bigint, VectorUDAFCount(col 2:int) -> bigint
                             className: VectorGroupByOperator
                             groupByMode: HASH
                             native: false
diff --git a/ql/src/test/results/clientpositive/llap/parquet_vectorization_12.q.out b/ql/src/test/results/clientpositive/llap/parquet_vectorization_12.q.out
index eb0d32717f..92f329c3f8 100644
--- a/ql/src/test/results/clientpositive/llap/parquet_vectorization_12.q.out
+++ b/ql/src/test/results/clientpositive/llap/parquet_vectorization_12.q.out
@@ -108,20 +108,20 @@ STAGE PLANS:
                           selectExpressions: CastLongToDouble(col 3:bigint) -> 14:double, DoubleColMultiplyDoubleColumn(col 15:double, col 16:double)(children: CastLongToDouble(col 3:bigint) -> 15:double, CastLongToDouble(col 3:bigint) -> 16:double) -> 17:double, DoubleColMultiplyDoubleColumn(col 5:double, col 5:double) -> 18:double
                       Statistics: Num rows: 1903 Data size: 236052 Basic stats: COMPLETE Column stats: COMPLETE
                       Group By Operator
-                        aggregations: count(_col0), sum(_col5), sum(_col4), sum(_col3), count(_col3), sum(_col0), sum(_col6)
+                        aggregations: count(_col0), sum(_col5), sum(_col4), count(_col4), sum(_col3), count(_col3), sum(_col0), sum(_col6)
                         Group By Vectorization:
-                            aggregators: VectorUDAFCount(col 3:bigint) -> bigint, VectorUDAFSumDouble(col 17:double) -> double, VectorUDAFSumDouble(col 14:double) -> double, VectorUDAFSumDouble(col 5:double) -> double, VectorUDAFCount(col 5:double) -> bigint, VectorUDAFSumLong(col 3:bigint) -> bigint, VectorUDAFSumDouble(col 18:double) -> double
+                            aggregators: VectorUDAFCount(col 3:bigint) -> bigint, VectorUDAFSumDouble(col 17:double) -> double, VectorUDAFSumDouble(col 14:double) -> double, VectorUDAFCount(col 14:double) -> bigint, VectorUDAFSumDouble(col 5:double) -> double, VectorUDAFCount(col 5:double) -> bigint, VectorUDAFSumLong(col 3:bigint) -> bigint, VectorUDAFSumDouble(col 18:double) -> double
                             className: VectorGroupByOperator
                             groupByMode: HASH
                             keyExpressions: col 5:double, col 3:bigint, col 6:string, col 10:boolean
                             native: false
                             vectorProcessingMode: HASH
-                            projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6]
+                            projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6, 7]
                         keys: _col3 (type: double), _col0 (type: bigint), _col2 (type: string), _col1 (type: boolean)
                         minReductionHashAggr: 0.4
                         mode: hash
-                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
-                        Statistics: Num rows: 1903 Data size: 268676 Basic stats: COMPLETE Column stats: COMPLETE
+                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11
+                        Statistics: Num rows: 1903 Data size: 283900 Basic stats: COMPLETE Column stats: COMPLETE
                         Reduce Output Operator
                           key expressions: _col0 (type: double), _col1 (type: bigint), _col2 (type: string), _col3 (type: boolean)
                           null sort order: zzzz
@@ -131,8 +131,8 @@ STAGE PLANS:
                               className: VectorReduceSinkMultiKeyOperator
                               native: true
                               nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
-                          Statistics: Num rows: 1903 Data size: 268676 Basic stats: COMPLETE Column stats: COMPLETE
-                          value expressions: _col4 (type: bigint), _col5 (type: double), _col6 (type: double), _col7 (type: double), _col8 (type: bigint), _col9 (type: bigint), _col10 (type: double)
+                          Statistics: Num rows: 1903 Data size: 283900 Basic stats: COMPLETE Column stats: COMPLETE
+                          value expressions: _col4 (type: bigint), _col5 (type: double), _col6 (type: double), _col7 (type: bigint), _col8 (type: double), _col9 (type: bigint), _col10 (type: bigint), _col11 (type: double)
             Execution mode: vectorized, llap
             LLAP IO: all inputs (cache only)
             Map Vectorization:
@@ -154,27 +154,27 @@ STAGE PLANS:
                 vectorized: true
             Reduce Operator Tree:
               Group By Operator
-                aggregations: count(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3), count(VALUE._col4), sum(VALUE._col5), sum(VALUE._col6)
+                aggregations: count(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2), count(VALUE._col3), sum(VALUE._col4), count(VALUE._col5), sum(VALUE._col6), sum(VALUE._col7)
                 Group By Vectorization:
-                    aggregators: VectorUDAFCountMerge(col 4:bigint) -> bigint, VectorUDAFSumDouble(col 5:double) -> double, VectorUDAFSumDouble(col 6:double) -> double, VectorUDAFSumDouble(col 7:double) -> double, VectorUDAFCountMerge(col 8:bigint) -> bigint, VectorUDAFSumLong(col 9:bigint) -> bigint, VectorUDAFSumDouble(col 10:double) -> double
+                    aggregators: VectorUDAFCountMerge(col 4:bigint) -> bigint, VectorUDAFSumDouble(col 5:double) -> double, VectorUDAFSumDouble(col 6:double) -> double, VectorUDAFCountMerge(col 7:bigint) -> bigint, VectorUDAFSumDouble(col 8:double) -> double, VectorUDAFCountMerge(col 9:bigint) -> bigint, VectorUDAFSumLong(col 10:bigint) -> bigint, VectorUDAFSumDouble(col 11:double) -> double
                     className: VectorGroupByOperator
                     groupByMode: MERGEPARTIAL
                     keyExpressions: col 0:double, col 1:bigint, col 2:string, col 3:boolean
                     native: false
                     vectorProcessingMode: MERGE_PARTIAL
-                    projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6]
+                    projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6, 7]
                 keys: KEY._col0 (type: double), KEY._col1 (type: bigint), KEY._col2 (type: string), KEY._col3 (type: boolean)
                 mode: mergepartial
-                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
-                Statistics: Num rows: 1903 Data size: 268676 Basic stats: COMPLETE Column stats: COMPLETE
+                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11
+                Statistics: Num rows: 1903 Data size: 283900 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
-                  expressions: _col1 (type: bigint), _col3 (type: boolean), _col2 (type: string), _col0 (type: double), (-6432.0D * _col0) (type: double), (- _col1) (type: bigint), _col4 (type: bigint), (_col1 * _col4) (type: bigint), power(((_col5 - ((_col6 * _col6) / _col4)) / if((_col4 = 1L), null, (_col4 - 1))), 0.5) (type: double), ((-6432.0D * _col0) / -6432.0D) (type: double), (- ((-6432.0D * _col0) / -6432.0D)) (type: double), (_col7 / _col8) (type: double), (- (-6432.0D * _col0)) (type: double), (-5638.15 + CAST( _col1 AS decimal(19,0))) (type: decimal(22,2)), _col9 (type: bigint), ((_col7 / _col8) / (-6432.0D * _col0)) (type: double), (((-6432.0D * _col0) / -6432.0D) + (- (-6432.0D * _col0))) (type: double), power(((_col10 - ((_col7 * _col7) / _col8)) / _col8), 0.5) (type: double)
+                  expressions: _col1 (type: bigint), _col3 (type: boolean), _col2 (type: string), _col0 (type: double), (-6432.0D * _col0) (type: double), (- _col1) (type: bigint), _col4 (type: bigint), (_col1 * _col4) (type: bigint), power(((_col5 - ((_col6 * _col6) / _col7)) / if((_col7 = 1L), null, (_col7 - 1))), 0.5) (type: double), ((-6432.0D * _col0) / -6432.0D) (type: double), (- ((-6432.0D * _col0) / -6432.0D)) (type: double), (_col8 / _col9) (type: double), (- (-6432.0D * _col0)) (type: double), (-5638.15 + CAST( _col1 AS decimal(19,0))) (type: decimal(22,2)), _col10 (type: bigint), ((_col8 / _col9) / (-6432.0D * _col0)) (type: double), (((-6432.0D * _col0) / -6432.0D) + (- (-6432.0D * _col0))) (type: double), power(((_col11 - ((_col8 * _col8) / _col9)) / _col9), 0.5) (type: double)
                   outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col18, _col19
                   Select Vectorization:
                       className: VectorSelectOperator
                       native: true
-                      projectedOutputColumnNums: [1, 3, 2, 0, 11, 12, 4, 13, 21, 23, 26, 27, 29, 31, 9, 34, 39, 44]
-                      selectExpressions: DoubleScalarMultiplyDoubleColumn(val -6432.0, col 0:double) -> 11:double, LongColUnaryMinus(col 1:bigint) -> 12:bigint, LongColMultiplyLongColumn(col 1:bigint, col 4:bigint) -> 13:bigint, FuncPowerDoubleToDouble(col 20:double)(children: DoubleColDivideLongColumn(col 16:double, col 19:bigint)(children: DoubleColSubtractDoubleColumn(col 5:double, col 15:double)(children: DoubleColDivideLongColumn(col 14:double, col 4:bigint)(children: DoubleColMultiplyDoubleColumn(col 6:double, col 6:double) -> 14:double) -> 15:double) -> 16:double, IfExprNullCondExpr(col 17:boolean, null, col 18:bigint)(children: LongColEqualLongScalar(col 4:bigint, val 1) -> 17:boolean, LongColSubtractLongScalar(col 4:bigint, val 1) -> 18:bigint) -> 19:bigint) -> 20:double) -> 21:double, DoubleColDivideDoubleScalar(col 22:double, val -6432.0)(children: DoubleScalarMultiplyDoubleColumn(val -6432.0, col 0:double) -> 22:double) -> 23:double, DoubleColUnaryMinus(col 25:double)(children: DoubleColDivideDoubleScalar(col 24:double, val -6432.0)(children: DoubleScalarMultiplyDoubleColumn(val -6432.0, col 0:double) -> 24:double) -> 25:double) -> 26:double, DoubleColDivideLongColumn(col 7:double, col 8:bigint) -> 27:double, DoubleColUnaryMinus(col 28:double)(children: DoubleScalarMultiplyDoubleColumn(val -6432.0, col 0:double) -> 28:double) -> 29:double, DecimalScalarAddDecimalColumn(val -5638.15, col 30:decimal(19,0))(children: CastLongToDecimal(col 1:bigint) -> 30:decimal(19,0)) -> 31:decimal(22,2), DoubleColDivideDoubleColumn(col 32:double, col 33:double)(children: DoubleColDivideLongColumn(col 7:double, col 8:bigint) -> 32:double, DoubleScalarMultiplyDoubleColumn(val -6432.0, col 0:double) -> 33:double) -> 34:double, DoubleColAddDoubleColumn(col 36:double, col 38:double)(children: DoubleColDivideDoubleScalar(col 35:double, val -6432.0)(children: DoubleScalarMultiplyDoubleColumn(val -6432.0, col 0:double) -> 35:double) -> 36:double, DoubleColUnaryMinus(col 37:double)(children: DoubleScalarMultiplyDoubleColumn(val -6432.0, col 0:double) -> 37:double) -> 38:double) -> 39:double, FuncPowerDoubleToDouble(col 43:double)(children: DoubleColDivideLongColumn(col 42:double, col 8:bigint)(children: DoubleColSubtractDoubleColumn(col 10:double, col 41:double)(children: DoubleColDivideLongColumn(col 40:double, col 8:bigint)(children: DoubleColMultiplyDoubleColumn(col 7:double, col 7:double) -> 40:double) -> 41:double) -> 42:double) -> 43:double) -> 44:double
+                      projectedOutputColumnNums: [1, 3, 2, 0, 12, 13, 4, 14, 22, 24, 27, 28, 30, 32, 10, 35, 40, 45]
+                      selectExpressions: DoubleScalarMultiplyDoubleColumn(val -6432.0, col 0:double) -> 12:double, LongColUnaryMinus(col 1:bigint) -> 13:bigint, LongColMultiplyLongColumn(col 1:bigint, col 4:bigint) -> 14:bigint, FuncPowerDoubleToDouble(col 21:double)(children: DoubleColDivideLongColumn(col 17:double, col 20:bigint)(children: DoubleColSubtractDoubleColumn(col 5:double, col 16:double)(children: DoubleColDivideLongColumn(col 15:double, col 7:bigint)(children: DoubleColMultiplyDoubleColumn(col 6:double, col 6:double) -> 15:double) -> 16:double) -> 17:double, IfExprNullCondExpr(col 18:boolean, null, col 19:bigint)(children: LongColEqualLongScalar(col 7:bigint, val 1) -> 18:boolean, LongColSubtractLongScalar(col 7:bigint, val 1) -> 19:bigint) -> 20:bigint) -> 21:double) -> 22:double, DoubleColDivideDoubleScalar(col 23:double, val -6432.0)(children: DoubleScalarMultiplyDoubleColumn(val -6432.0, col 0:double) -> 23:double) -> 24:double, DoubleColUnaryMinus(col 26:double)(children: DoubleColDivideDoubleScalar(col 25:double, val -6432.0)(children: DoubleScalarMultiplyDoubleColumn(val -6432.0, col 0:double) -> 25:double) -> 26:double) -> 27:double, DoubleColDivideLongColumn(col 8:double, col 9:bigint) -> 28:double, DoubleColUnaryMinus(col 29:double)(children: DoubleScalarMultiplyDoubleColumn(val -6432.0, col 0:double) -> 29:double) -> 30:double, DecimalScalarAddDecimalColumn(val -5638.15, col 31:decimal(19,0))(children: CastLongToDecimal(col 1:bigint) -> 31:decimal(19,0)) -> 32:decimal(22,2), DoubleColDivideDoubleColumn(col 33:double, col 34:double)(children: DoubleColDivideLongColumn(col 8:double, col 9:bigint) -> 33:double, DoubleScalarMultiplyDoubleColumn(val -6432.0, col 0:double) -> 34:double) -> 35:double, DoubleColAddDoubleColumn(col 37:double, col 39:double)(children: DoubleColDivideDoubleScalar(col 36:double, val -6432.0)(children: DoubleScalarMultiplyDoubleColumn(val -6432.0, col 0:double) -> 36:double) -> 37:double, DoubleColUnaryMinus(col 38:double)(children: DoubleScalarMultiplyDoubleColumn(val -6432.0, col 0:double) -> 38:double) -> 39:double) -> 40:double, FuncPowerDoubleToDouble(col 44:double)(children: DoubleColDivideLongColumn(col 43:double, col 9:bigint)(children: DoubleColSubtractDoubleColumn(col 11:double, col 42:double)(children: DoubleColDivideLongColumn(col 41:double, col 9:bigint)(children: DoubleColMultiplyDoubleColumn(col 8:double, col 8:double) -> 41:double) -> 42:double) -> 43:double) -> 44:double) -> 45:double
                   Statistics: Num rows: 1903 Data size: 573156 Basic stats: COMPLETE Column stats: COMPLETE
                   Reduce Output Operator
                     key expressions: _col3 (type: double), _col0 (type: bigint), _col2 (type: string)
diff --git a/ql/src/test/results/clientpositive/llap/parquet_vectorization_13.q.out b/ql/src/test/results/clientpositive/llap/parquet_vectorization_13.q.out
index 28dc4f7ca5..7125704c33 100644
--- a/ql/src/test/results/clientpositive/llap/parquet_vectorization_13.q.out
+++ b/ql/src/test/results/clientpositive/llap/parquet_vectorization_13.q.out
@@ -120,9 +120,9 @@ STAGE PLANS:
                             selectExpressions: DoubleColMultiplyDoubleColumn(col 4:double, col 4:double)(children: col 4:float, col 4:float) -> 14:double, CastLongToDouble(col 0:tinyint) -> 15:double, DoubleColMultiplyDoubleColumn(col 17:double, col 18:double)(children: CastLongToDouble(col 0:tinyint) -> 17:double, CastLongToDouble(col 0:tinyint) -> 18:double) -> 19:double
                         Statistics: Num rows: 1386 Data size: 200984 Basic stats: COMPLETE Column stats: COMPLETE
                         Group By Operator
-                          aggregations: max(_col1), sum(_col3), sum(_col6), sum(_col5), count(_col3), sum(_col8), sum(_col7), count(_col1), max(_col3), min(_col1)
+                          aggregations: max(_col1), sum(_col3), sum(_col6), sum(_col5), count(_col5), sum(_col8), sum(_col7), count(_col7), max(_col3), min(_col1)
                           Group By Vectorization:
-                              aggregators: VectorUDAFMaxLong(col 0:tinyint) -> tinyint, VectorUDAFSumDouble(col 4:float) -> double, VectorUDAFSumDouble(col 14:double) -> double, VectorUDAFSumDouble(col 4:double) -> double, VectorUDAFCount(col 4:float) -> bigint, VectorUDAFSumDouble(col 19:double) -> double, VectorUDAFSumDouble(col 15:double) -> double, VectorUDAFCount(col 0:tinyint) -> bigint, VectorUDAFMaxDouble(col 4:float) -> float, VectorUDAFMinLong(col 0:tinyint) -> tinyint
+                              aggregators: VectorUDAFMaxLong(col 0:tinyint) -> tinyint, VectorUDAFSumDouble(col 4:float) -> double, VectorUDAFSumDouble(col 14:double) -> double, VectorUDAFSumDouble(col 4:double) -> double, VectorUDAFCount(col 4:double) -> bigint, VectorUDAFSumDouble(col 19:double) -> double, VectorUDAFSumDouble(col 15:double) -> double, VectorUDAFCount(col 15:double) -> bigint, VectorUDAFMaxDouble(col 4:float) -> float, VectorUDAFMinLong(col 0:tinyint) -> tinyint
                               className: VectorGroupByOperator
                               groupByMode: HASH
                               keyExpressions: col 10:boolean, col 0:tinyint, col 8:timestamp, col 4:float, col 6:string
@@ -477,9 +477,9 @@ STAGE PLANS:
                             selectExpressions: DoubleColMultiplyDoubleColumn(col 4:double, col 4:double)(children: col 4:float, col 4:float) -> 14:double, CastLongToDouble(col 0:tinyint) -> 15:double, DoubleColMultiplyDoubleColumn(col 17:double, col 18:double)(children: CastLongToDouble(col 0:tinyint) -> 17:double, CastLongToDouble(col 0:tinyint) -> 18:double) -> 19:double
                         Statistics: Num rows: 1386 Data size: 200984 Basic stats: COMPLETE Column stats: COMPLETE
                         Group By Operator
-                          aggregations: max(_col1), sum(_col3), sum(_col6), sum(_col5), count(_col3), sum(_col8), sum(_col7), count(_col1), max(_col3), min(_col1)
+                          aggregations: max(_col1), sum(_col3), sum(_col6), sum(_col5), count(_col5), sum(_col8), sum(_col7), count(_col7), max(_col3), min(_col1)
                           Group By Vectorization:
-                              aggregators: VectorUDAFMaxLong(col 0:tinyint) -> tinyint, VectorUDAFSumDouble(col 4:float) -> double, VectorUDAFSumDouble(col 14:double) -> double, VectorUDAFSumDouble(col 4:double) -> double, VectorUDAFCount(col 4:float) -> bigint, VectorUDAFSumDouble(col 19:double) -> double, VectorUDAFSumDouble(col 15:double) -> double, VectorUDAFCount(col 0:tinyint) -> bigint, VectorUDAFMaxDouble(col 4:float) -> float, VectorUDAFMinLong(col 0:tinyint) -> tinyint
+                              aggregators: VectorUDAFMaxLong(col 0:tinyint) -> tinyint, VectorUDAFSumDouble(col 4:float) -> double, VectorUDAFSumDouble(col 14:double) -> double, VectorUDAFSumDouble(col 4:double) -> double, VectorUDAFCount(col 4:double) -> bigint, VectorUDAFSumDouble(col 19:double) -> double, VectorUDAFSumDouble(col 15:double) -> double, VectorUDAFCount(col 15:double) -> bigint, VectorUDAFMaxDouble(col 4:float) -> float, VectorUDAFMinLong(col 0:tinyint) -> tinyint
                               className: VectorGroupByOperator
                               groupByMode: HASH
                               keyExpressions: col 10:boolean, col 0:tinyint, col 8:timestamp, col 4:float, col 6:string
diff --git a/ql/src/test/results/clientpositive/llap/parquet_vectorization_14.q.out b/ql/src/test/results/clientpositive/llap/parquet_vectorization_14.q.out
index 5d5c7a3ab4..b333d723d9 100644
--- a/ql/src/test/results/clientpositive/llap/parquet_vectorization_14.q.out
+++ b/ql/src/test/results/clientpositive/llap/parquet_vectorization_14.q.out
@@ -110,20 +110,20 @@ STAGE PLANS:
                           selectExpressions: DoubleColUnaryMinus(col 17:double)(children: DoubleScalarAddDoubleColumn(val -26.28, col 5:double) -> 17:double) -> 18:double, DoubleColMultiplyDoubleColumn(col 20:double, col 22:double)(children: DoubleColUnaryMinus(col 19:double)(children: DoubleScalarAddDoubleColumn(val -26.28, col 5:double) -> 19:double) -> 20:double, DoubleColUnaryMinus(col 21:double)(children: DoubleScalarAddDoubleColumn(val -26.28, col 5:double) -> 21:double) -> 22:double) -> 23:double, DoubleColMultiplyDoubleColumn(col 4:double, col 4:double)(children: col 4:float, col 4:float) -> 24:double
                       Statistics: Num rows: 758 Data size: 116802 Basic stats: COMPLETE Column stats: COMPLETE
                       Group By Operator
-                        aggregations: sum(_col6), sum(_col5), count(_col5), max(_col1), sum(_col8), sum(_col7), count(_col1)
+                        aggregations: sum(_col6), sum(_col5), count(_col5), max(_col1), sum(_col8), sum(_col7), count(_col7), count(_col1)
                         Group By Vectorization:
-                            aggregators: VectorUDAFSumDouble(col 23:double) -> double, VectorUDAFSumDouble(col 18:double) -> double, VectorUDAFCount(col 18:double) -> bigint, VectorUDAFMaxDouble(col 4:float) -> float, VectorUDAFSumDouble(col 24:double) -> double, VectorUDAFSumDouble(col 4:double) -> double, VectorUDAFCount(col 4:float) -> bigint
+                            aggregators: VectorUDAFSumDouble(col 23:double) -> double, VectorUDAFSumDouble(col 18:double) -> double, VectorUDAFCount(col 18:double) -> bigint, VectorUDAFMaxDouble(col 4:float) -> float, VectorUDAFSumDouble(col 24:double) -> double, VectorUDAFSumDouble(col 4:double) -> double, VectorUDAFCount(col 4:double) -> bigint, VectorUDAFCount(col 4:float) -> bigint
                             className: VectorGroupByOperator
                             groupByMode: HASH
                             keyExpressions: col 6:string, col 4:float, col 5:double, col 8:timestamp, col 10:boolean
                             native: false
                             vectorProcessingMode: HASH
-                            projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6]
+                            projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6, 7]
                         keys: _col2 (type: string), _col1 (type: float), _col4 (type: double), _col0 (type: timestamp), _col3 (type: boolean)
                         minReductionHashAggr: 0.4
                         mode: hash
-                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11
-                        Statistics: Num rows: 758 Data size: 124466 Basic stats: COMPLETE Column stats: COMPLETE
+                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12
+                        Statistics: Num rows: 758 Data size: 130530 Basic stats: COMPLETE Column stats: COMPLETE
                         Reduce Output Operator
                           key expressions: _col0 (type: string), _col1 (type: float), _col2 (type: double), _col3 (type: timestamp), _col4 (type: boolean)
                           null sort order: zzzzz
@@ -133,8 +133,8 @@ STAGE PLANS:
                               className: VectorReduceSinkMultiKeyOperator
                               native: true
                               nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
-                          Statistics: Num rows: 758 Data size: 124466 Basic stats: COMPLETE Column stats: COMPLETE
-                          value expressions: _col5 (type: double), _col6 (type: double), _col7 (type: bigint), _col8 (type: float), _col9 (type: double), _col10 (type: double), _col11 (type: bigint)
+                          Statistics: Num rows: 758 Data size: 130530 Basic stats: COMPLETE Column stats: COMPLETE
+                          value expressions: _col5 (type: double), _col6 (type: double), _col7 (type: bigint), _col8 (type: float), _col9 (type: double), _col10 (type: double), _col11 (type: bigint), _col12 (type: bigint)
             Execution mode: vectorized, llap
             LLAP IO: all inputs (cache only)
             Map Vectorization:
@@ -156,27 +156,27 @@ STAGE PLANS:
                 vectorized: true
             Reduce Operator Tree:
               Group By Operator
-                aggregations: sum(VALUE._col0), sum(VALUE._col1), count(VALUE._col2), max(VALUE._col3), sum(VALUE._col4), sum(VALUE._col5), count(VALUE._col6)
+                aggregations: sum(VALUE._col0), sum(VALUE._col1), count(VALUE._col2), max(VALUE._col3), sum(VALUE._col4), sum(VALUE._col5), count(VALUE._col6), count(VALUE._col7)
                 Group By Vectorization:
-                    aggregators: VectorUDAFSumDouble(col 5:double) -> double, VectorUDAFSumDouble(col 6:double) -> double, VectorUDAFCountMerge(col 7:bigint) -> bigint, VectorUDAFMaxDouble(col 8:float) -> float, VectorUDAFSumDouble(col 9:double) -> double, VectorUDAFSumDouble(col 10:double) -> double, VectorUDAFCountMerge(col 11:bigint) -> bigint
+                    aggregators: VectorUDAFSumDouble(col 5:double) -> double, VectorUDAFSumDouble(col 6:double) -> double, VectorUDAFCountMerge(col 7:bigint) -> bigint, VectorUDAFMaxDouble(col 8:float) -> float, VectorUDAFSumDouble(col 9:double) -> double, VectorUDAFSumDouble(col 10:double) -> double, VectorUDAFCountMerge(col 11:bigint) -> bigint, VectorUDAFCountMerge(col 12:bigint) -> bigint
                     className: VectorGroupByOperator
                     groupByMode: MERGEPARTIAL
                     keyExpressions: col 0:string, col 1:float, col 2:double, col 3:timestamp, col 4:boolean
                     native: false
                     vectorProcessingMode: MERGE_PARTIAL
-                    projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6]
+                    projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6, 7]
                 keys: KEY._col0 (type: string), KEY._col1 (type: float), KEY._col2 (type: double), KEY._col3 (type: timestamp), KEY._col4 (type: boolean)
                 mode: mergepartial
-                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11
-                Statistics: Num rows: 758 Data size: 124466 Basic stats: COMPLETE Column stats: COMPLETE
+                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12
+                Statistics: Num rows: 758 Data size: 130530 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
-                  expressions: _col3 (type: timestamp), _col1 (type: float), _col0 (type: string), _col4 (type: boolean), _col2 (type: double), (-26.28D + _col2) (type: double), (- (-26.28D + _col2)) (type: double), power(((_col5 - ((_col6 * _col6) / _col7)) / if((_col7 = 1L), null, (_col7 - 1))), 0.5) (type: double), (_col1 * -26.28) (type: float), _col8 (type: float), (- _col1) (type: float), (- _col8) (type: float), ((- (-26.28D + _col2)) / 10.175D) (type: double), power(((_col9 - ((_col10 * _col10) / _col11)) / _col11), 0.5) (type: double), _col11 (type: bigint), (- ((- (-26.28D + _col2)) / 10.175D)) (type: double), (-1.389D % power(((_col5 - ((_col6 * _col6) / _col7)) / if((_col7 = 1L), null, (_col7 - 1))), 0.5)) (type: double), (UDFToDouble(_col1) - _col2) (type: double), ((_col9 - ((_col10 * _col10) / _col11)) / _col11) (type: double), (((_col9 - ((_col10 * _col10) / _col11)) / _col11) % 10.175D) (type: double), ((_col9 - ((_col10 * _col10) / _col11)) / if((_col11 = 1L), null, (_col11 - 1))) (type: double), (- (UDFToDouble(_col1) - _col2)) (type: double)
+                  expressions: _col3 (type: timestamp), _col1 (type: float), _col0 (type: string), _col4 (type: boolean), _col2 (type: double), (-26.28D + _col2) (type: double), (- (-26.28D + _col2)) (type: double), power(((_col5 - ((_col6 * _col6) / _col7)) / if((_col7 = 1L), null, (_col7 - 1))), 0.5) (type: double), (_col1 * -26.28) (type: float), _col8 (type: float), (- _col1) (type: float), (- _col8) (type: float), ((- (-26.28D + _col2)) / 10.175D) (type: double), power(((_col9 - ((_col10 * _col10) / _col11)) / _col11), 0.5) (type: double), _col12 (type: bigint), (- ((- (-26.28D + _col2)) / 10.175D)) (type: double), (-1.389D % power(((_col5 - ((_col6 * _col6) / _col7)) / if((_col7 = 1L), null, (_col7 - 1))), 0.5)) (type: double), (UDFToDouble(_col1) - _col2) (type: double), ((_col9 - ((_col10 * _col10) / _col11)) / _col11) (type: double), (((_col9 - ((_col10 * _col10) / _col11)) / _col11) % 10.175D) (type: double), ((_col9 - ((_col10 * _col10) / _col11)) / if((_col11 = 1L), null, (_col11 - 1))) (type: double), (- (UDFToDouble(_col1) - _col2)) (type: double)
                   outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21
                   Select Vectorization:
                       className: VectorSelectOperator
                       native: true
-                      projectedOutputColumnNums: [3, 1, 0, 4, 2, 12, 14, 22, 23, 8, 24, 25, 28, 33, 11, 37, 46, 47, 51, 56, 63, 65]
-                      selectExpressions: DoubleScalarAddDoubleColumn(val -26.28, col 2:double) -> 12:double, DoubleColUnaryMinus(col 13:double)(children: DoubleScalarAddDoubleColumn(val -26.28, col 2:double) -> 13:double) -> 14:double, FuncPowerDoubleToDouble(col 21:double)(children: DoubleColDivideLongColumn(col 17:double, col 20:bigint)(children: DoubleColSubtractDoubleColumn(col 5:double, col 16:double)(children: DoubleColDivideLongColumn(col 15:double, col 7:bigint)(children: DoubleColMultiplyDoubleColumn(col 6:double, col 6:double) -> 15:double) -> 16:double) -> 17:double, IfExprNullCondExpr(col 18:boolean, null, col 19:bigint)(children: LongColEqualLongScalar(col 7:bigint, val 1) -> 18:boolean, LongColSubtractLongScalar(col 7:bigint, val 1) -> 19:bigint) -> 20:bigint) -> 21:double) -> 22:double, DoubleColMultiplyDoubleScalar(col 1:float, val -26.280000686645508) -> 23:float, DoubleColUnaryMinus(col 1:float) -> 24:float, DoubleColUnaryMinus(col 8:float) -> 25:float, DoubleColDivideDoubleScalar(col 27:double, val 10.175)(children: DoubleColUnaryMinus(col 26:double)(children: DoubleScalarAddDoubleColumn(val -26.28, col 2:double) -> 26:double) -> 27:double) -> 28:double, FuncPowerDoubleToDouble(col 32:double)(children: DoubleColDivideLongColumn(col 31:double, col 11:bigint)(children: DoubleColSubtractDoubleColumn(col 9:double, col 30:double)(children: DoubleColDivideLongColumn(col 29:double, col 11:bigint)(children: DoubleColMultiplyDoubleColumn(col 10:double, col 10:double) -> 29:double) -> 30:double) -> 31:double) -> 32:double) -> 33:double, DoubleColUnaryMinus(col 36:double)(children: DoubleColDivideDoubleScalar(col 35:double, val 10.175)(children: DoubleColUnaryMinus(col 34:double)(children: DoubleScalarAddDoubleColumn(val -26.28, col 2:double) -> 34:double) -> 35:double) -> 36:double) -> 37:double, DoubleScalarModuloDoubleColumn(val -1.389, col 45:double)(children: FuncPowerDoubleToDouble(col 44:double)(children: DoubleColDivideLongColumn(col 40:double, col 43:bigint)(children: DoubleColSubtractDoubleColumn(col 5:double, col 39:double)(children: DoubleColDivideLongColumn(col 38:double, col 7:bigint)(children: DoubleColMultiplyDoubleColumn(col 6:double, col 6:double) -> 38:double) -> 39:double) -> 40:double, IfExprNullCondExpr(col 41:boolean, null, col 42:bigint)(children: LongColEqualLongScalar(col 7:bigint, val 1) -> 41:boolean, LongColSubtractLongScalar(col 7:bigint, val 1) -> 42:bigint) -> 43:bigint) -> 44:double) -> 45:double) -> 46:double, DoubleColSubtractDoubleColumn(col 1:double, col 2:double)(children: col 1:float) -> 47:double, DoubleColDivideLongColumn(col 50:double, col 11:bigint)(children: DoubleColSubtractDoubleColumn(col 9:double, col 49:double)(children: DoubleColDivideLongColumn(col 48:double, col 11:bigint)(children: DoubleColMultiplyDoubleColumn(col 10:double, col 10:double) -> 48:double) -> 49:double) -> 50:double) -> 51:double, DoubleColModuloDoubleScalar(col 55:double, val 10.175)(children: DoubleColDivideLongColumn(col 54:double, col 11:bigint)(children: DoubleColSubtractDoubleColumn(col 9:double, col 53:double)(children: DoubleColDivideLongColumn(col 52:double, col 11:bigint)(children: DoubleColMultiplyDoubleColumn(col 10:double, col 10:double) -> 52:double) -> 53:double) -> 54:double) -> 55:double) -> 56:double, DoubleColDivideLongColumn(col 59:double, col 62:bigint)(children: DoubleColSubtractDoubleColumn(col 9:double, col 58:double)(children: DoubleColDivideLongColumn(col 57:double, col 11:bigint)(children: DoubleColMultiplyDoubleColumn(col 10:double, col 10:double) -> 57:double) -> 58:double) -> 59:double, IfExprNullCondExpr(col 60:boolean, null, col 61:bigint)(children: LongColEqualLongScalar(col 11:bigint, val 1) -> 60:boolean, LongColSubtractLongScalar(col 11:bigint, val 1) -> 61:bigint) -> 62:bigint) -> 63:double, DoubleColUnaryMinus(col 64:double)(children: DoubleColSubtractDoubleColumn(col 1:double, col 2:double)(children: col 1:float) -> 64:double) -> 65:double
+                      projectedOutputColumnNums: [3, 1, 0, 4, 2, 13, 15, 23, 24, 8, 25, 26, 29, 34, 12, 38, 47, 48, 52, 57, 64, 66]
+                      selectExpressions: DoubleScalarAddDoubleColumn(val -26.28, col 2:double) -> 13:double, DoubleColUnaryMinus(col 14:double)(children: DoubleScalarAddDoubleColumn(val -26.28, col 2:double) -> 14:double) -> 15:double, FuncPowerDoubleToDouble(col 22:double)(children: DoubleColDivideLongColumn(col 18:double, col 21:bigint)(children: DoubleColSubtractDoubleColumn(col 5:double, col 17:double)(children: DoubleColDivideLongColumn(col 16:double, col 7:bigint)(children: DoubleColMultiplyDoubleColumn(col 6:double, col 6:double) -> 16:double) -> 17:double) -> 18:double, IfExprNullCondExpr(col 19:boolean, null, col 20:bigint)(children: LongColEqualLongScalar(col 7:bigint, val 1) -> 19:boolean, LongColSubtractLongScalar(col 7:bigint, val 1) -> 20:bigint) -> 21:bigint) -> 22:double) -> 23:double, DoubleColMultiplyDoubleScalar(col 1:float, val -26.280000686645508) -> 24:float, DoubleColUnaryMinus(col 1:float) -> 25:float, DoubleColUnaryMinus(col 8:float) -> 26:float, DoubleColDivideDoubleScalar(col 28:double, val 10.175)(children: DoubleColUnaryMinus(col 27:double)(children: DoubleScalarAddDoubleColumn(val -26.28, col 2:double) -> 27:double) -> 28:double) -> 29:double, FuncPowerDoubleToDouble(col 33:double)(children: DoubleColDivideLongColumn(col 32:double, col 11:bigint)(children: DoubleColSubtractDoubleColumn(col 9:double, col 31:double)(children: DoubleColDivideLongColumn(col 30:double, col 11:bigint)(children: DoubleColMultiplyDoubleColumn(col 10:double, col 10:double) -> 30:double) -> 31:double) -> 32:double) -> 33:double) -> 34:double, DoubleColUnaryMinus(col 37:double)(children: DoubleColDivideDoubleScalar(col 36:double, val 10.175)(children: DoubleColUnaryMinus(col 35:double)(children: DoubleScalarAddDoubleColumn(val -26.28, col 2:double) -> 35:double) -> 36:double) -> 37:double) -> 38:double, DoubleScalarModuloDoubleColumn(val -1.389, col 46:double)(children: FuncPowerDoubleToDouble(col 45:double)(children: DoubleColDivideLongColumn(col 41:double, col 44:bigint)(children: DoubleColSubtractDoubleColumn(col 5:double, col 40:double)(children: DoubleColDivideLongColumn(col 39:double, col 7:bigint)(children: DoubleColMultiplyDoubleColumn(col 6:double, col 6:double) -> 39:double) -> 40:double) -> 41:double, IfExprNullCondExpr(col 42:boolean, null, col 43:bigint)(children: LongColEqualLongScalar(col 7:bigint, val 1) -> 42:boolean, LongColSubtractLongScalar(col 7:bigint, val 1) -> 43:bigint) -> 44:bigint) -> 45:double) -> 46:double) -> 47:double, DoubleColSubtractDoubleColumn(col 1:double, col 2:double)(children: col 1:float) -> 48:double, DoubleColDivideLongColumn(col 51:double, col 11:bigint)(children: DoubleColSubtractDoubleColumn(col 9:double, col 50:double)(children: DoubleColDivideLongColumn(col 49:double, col 11:bigint)(children: DoubleColMultiplyDoubleColumn(col 10:double, col 10:double) -> 49:double) -> 50:double) -> 51:double) -> 52:double, DoubleColModuloDoubleScalar(col 56:double, val 10.175)(children: DoubleColDivideLongColumn(col 55:double, col 11:bigint)(children: DoubleColSubtractDoubleColumn(col 9:double, col 54:double)(children: DoubleColDivideLongColumn(col 53:double, col 11:bigint)(children: DoubleColMultiplyDoubleColumn(col 10:double, col 10:double) -> 53:double) -> 54:double) -> 55:double) -> 56:double) -> 57:double, DoubleColDivideLongColumn(col 60:double, col 63:bigint)(children: DoubleColSubtractDoubleColumn(col 9:double, col 59:double)(children: DoubleColDivideLongColumn(col 58:double, col 11:bigint)(children: DoubleColMultiplyDoubleColumn(col 10:double, col 10:double) -> 58:double) -> 59:double) -> 60:double, IfExprNullCondExpr(col 61:boolean, null, col 62:bigint)(children: LongColEqualLongScalar(col 11:bigint, val 1) -> 61:boolean, LongColSubtractLongScalar(col 11:bigint, val 1) -> 62:bigint) -> 63:bigint) -> 64:double, DoubleColUnaryMinus(col 65:double)(children: DoubleColSubtractDoubleColumn(col 1:double, col 2:double)(children: col 1:float) -> 65:double) -> 66:double
                   Statistics: Num rows: 758 Data size: 176010 Basic stats: COMPLETE Column stats: COMPLETE
                   Reduce Output Operator
                     key expressions: _col2 (type: string), _col1 (type: float), _col4 (type: double), _col0 (type: timestamp)
diff --git a/ql/src/test/results/clientpositive/llap/parquet_vectorization_15.q.out b/ql/src/test/results/clientpositive/llap/parquet_vectorization_15.q.out
index ff948c36a9..b1ba8de95a 100644
--- a/ql/src/test/results/clientpositive/llap/parquet_vectorization_15.q.out
+++ b/ql/src/test/results/clientpositive/llap/parquet_vectorization_15.q.out
@@ -106,9 +106,9 @@ STAGE PLANS:
                           selectExpressions: DoubleColMultiplyDoubleColumn(col 4:double, col 4:double)(children: col 4:float, col 4:float) -> 14:double, CastLongToDouble(col 0:tinyint) -> 15:double, DoubleColMultiplyDoubleColumn(col 16:double, col 17:double)(children: CastLongToDouble(col 0:tinyint) -> 16:double, CastLongToDouble(col 0:tinyint) -> 17:double) -> 18:double, CastLongToDouble(col 2:int) -> 19:double, DoubleColMultiplyDoubleColumn(col 20:double, col 21:double)(children: CastLongToDouble(col 2:int) -> 20:double, CastLongToDouble(col 2:int) -> 21:double) -> 22:double
                       Statistics: Num rows: 12288 Data size: 2367002 Basic stats: COMPLETE Column stats: COMPLETE
                       Group By Operator
-                        aggregations: sum(_col8), sum(_col7), count(_col0), min(_col2), sum(_col10), sum(_col9), count(_col4), sum(_col12), sum(_col11), count(_col5)
+                        aggregations: sum(_col8), sum(_col7), count(_col7), min(_col2), sum(_col10), sum(_col9), count(_col9), sum(_col12), sum(_col11), count(_col11)
                         Group By Vectorization:
-                            aggregators: VectorUDAFSumDouble(col 14:double) -> double, VectorUDAFSumDouble(col 4:double) -> double, VectorUDAFCount(col 4:float) -> bigint, VectorUDAFMinDouble(col 5:double) -> double, VectorUDAFSumDouble(col 18:double) -> double, VectorUDAFSumDouble(col 15:double) -> double, VectorUDAFCount(col 0:tinyint) -> bigint, VectorUDAFSumDouble(col 22:double) -> double, VectorUDAFSumDouble(col 19:double) -> double, VectorUDAFCount(col 2:int) -> bigint
+                            aggregators: VectorUDAFSumDouble(col 14:double) -> double, VectorUDAFSumDouble(col 4:double) -> double, VectorUDAFCount(col 4:double) -> bigint, VectorUDAFMinDouble(col 5:double) -> double, VectorUDAFSumDouble(col 18:double) -> double, VectorUDAFSumDouble(col 15:double) -> double, VectorUDAFCount(col 15:double) -> bigint, VectorUDAFSumDouble(col 22:double) -> double, VectorUDAFSumDouble(col 19:double) -> double, VectorUDAFCount(col 19:double) -> bigint
                             className: VectorGroupByOperator
                             groupByMode: HASH
                             keyExpressions: col 4:float, col 10:boolean, col 5:double, col 6:string, col 0:tinyint, col 2:int, col 8:timestamp
diff --git a/ql/src/test/results/clientpositive/llap/parquet_vectorization_2.q.out b/ql/src/test/results/clientpositive/llap/parquet_vectorization_2.q.out
index 6cc34234da..a8eab6b22f 100644
--- a/ql/src/test/results/clientpositive/llap/parquet_vectorization_2.q.out
+++ b/ql/src/test/results/clientpositive/llap/parquet_vectorization_2.q.out
@@ -80,18 +80,18 @@ STAGE PLANS:
                     predicate: (((cdouble < UDFToDouble(ctinyint)) and ((UDFToDouble(ctimestamp2) <> -10669.0D) or (cint < 359))) or ((ctimestamp1 < ctimestamp2) and (cstring2 like 'b%') and (cfloat <= -5638.15))) (type: boolean)
                     Statistics: Num rows: 4096 Data size: 636272 Basic stats: COMPLETE Column stats: COMPLETE
                     Select Operator
-                      expressions: csmallint (type: smallint), cfloat (type: float), cbigint (type: bigint), ctinyint (type: tinyint), cdouble (type: double), UDFToDouble(cbigint) (type: double), (UDFToDouble(cbigint) * UDFToDouble(cbigint)) (type: double)
-                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
+                      expressions: csmallint (type: smallint), cfloat (type: float), ctinyint (type: tinyint), cdouble (type: double), UDFToDouble(cbigint) (type: double), (UDFToDouble(cbigint) * UDFToDouble(cbigint)) (type: double)
+                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                       Select Vectorization:
                           className: VectorSelectOperator
                           native: true
-                          projectedOutputColumnNums: [1, 4, 3, 0, 5, 16, 19]
+                          projectedOutputColumnNums: [1, 4, 0, 5, 16, 19]
                           selectExpressions: CastLongToDouble(col 3:bigint) -> 16:double, DoubleColMultiplyDoubleColumn(col 17:double, col 18:double)(children: CastLongToDouble(col 3:bigint) -> 17:double, CastLongToDouble(col 3:bigint) -> 18:double) -> 19:double
                       Statistics: Num rows: 4096 Data size: 636272 Basic stats: COMPLETE Column stats: COMPLETE
                       Group By Operator
-                        aggregations: sum(_col0), count(_col0), sum(_col1), sum(_col6), sum(_col5), count(_col2), count(), min(_col3), sum(_col4), count(_col4)
+                        aggregations: sum(_col0), count(_col0), sum(_col1), sum(_col5), sum(_col4), count(_col4), count(), min(_col2), sum(_col3), count(_col3)
                         Group By Vectorization:
-                            aggregators: VectorUDAFSumLong(col 1:smallint) -> bigint, VectorUDAFCount(col 1:smallint) -> bigint, VectorUDAFSumDouble(col 4:float) -> double, VectorUDAFSumDouble(col 19:double) -> double, VectorUDAFSumDouble(col 16:double) -> double, VectorUDAFCount(col 3:bigint) -> bigint, VectorUDAFCountStar(*) -> bigint, VectorUDAFMinLong(col 0:tinyint) -> tinyint, VectorUDAFSumDouble(col 5:double) -> double, VectorUDAFCount(col 5:double) -> bigint
+                            aggregators: VectorUDAFSumLong(col 1:smallint) -> bigint, VectorUDAFCount(col 1:smallint) -> bigint, VectorUDAFSumDouble(col 4:float) -> double, VectorUDAFSumDouble(col 19:double) -> double, VectorUDAFSumDouble(col 16:double) -> double, VectorUDAFCount(col 16:double) -> bigint, VectorUDAFCountStar(*) -> bigint, VectorUDAFMinLong(col 0:tinyint) -> tinyint, VectorUDAFSumDouble(col 5:double) -> double, VectorUDAFCount(col 5:double) -> bigint
                             className: VectorGroupByOperator
                             groupByMode: HASH
                             native: false
diff --git a/ql/src/test/results/clientpositive/llap/parquet_vectorization_3.q.out b/ql/src/test/results/clientpositive/llap/parquet_vectorization_3.q.out
index d929f370ab..d75a945ac0 100644
--- a/ql/src/test/results/clientpositive/llap/parquet_vectorization_3.q.out
+++ b/ql/src/test/results/clientpositive/llap/parquet_vectorization_3.q.out
@@ -85,27 +85,27 @@ STAGE PLANS:
                     predicate: (((UDFToFloat(cint) <= cfloat) and (CAST( cbigint AS decimal(22,3)) <> 79.553) and (UDFToDouble(ctimestamp2) = -29071.0D)) or ((UDFToDouble(cbigint) > cdouble) and (CAST( csmallint AS decimal(8,3)) >= 79.553) and (ctimestamp1 > ctimestamp2))) (type: boolean)
                     Statistics: Num rows: 2503 Data size: 209380 Basic stats: COMPLETE Column stats: COMPLETE
                     Select Operator
-                      expressions: csmallint (type: smallint), ctinyint (type: tinyint), cfloat (type: float), cint (type: int), UDFToDouble(csmallint) (type: double), (UDFToDouble(csmallint) * UDFToDouble(csmallint)) (type: double), UDFToDouble(ctinyint) (type: double), (UDFToDouble(ctinyint) * UDFToDouble(ctinyint)) (type: double), UDFToDouble(cfloat) (type: double), (UDFToDouble(cfloat) * UDFToDouble(cfloat)) (type: double), UDFToDouble(cint) (type: double), (UDFToDouble(cint) * UDFToDouble(cint)) (type: double)
-                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11
+                      expressions: cfloat (type: float), cint (type: int), UDFToDouble(csmallint) (type: double), (UDFToDouble(csmallint) * UDFToDouble(csmallint)) (type: double), UDFToDouble(ctinyint) (type: double), (UDFToDouble(ctinyint) * UDFToDouble(ctinyint)) (type: double), UDFToDouble(cfloat) (type: double), (UDFToDouble(cfloat) * UDFToDouble(cfloat)) (type: double), UDFToDouble(cint) (type: double), (UDFToDouble(cint) * UDFToDouble(cint)) (type: double)
+                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                       Select Vectorization:
                           className: VectorSelectOperator
                           native: true
-                          projectedOutputColumnNums: [1, 0, 4, 2, 19, 22, 23, 26, 4, 27, 28, 31]
+                          projectedOutputColumnNums: [4, 2, 19, 22, 23, 26, 4, 27, 28, 31]
                           selectExpressions: CastLongToDouble(col 1:smallint) -> 19:double, DoubleColMultiplyDoubleColumn(col 20:double, col 21:double)(children: CastLongToDouble(col 1:smallint) -> 20:double, CastLongToDouble(col 1:smallint) -> 21:double) -> 22:double, CastLongToDouble(col 0:tinyint) -> 23:double, DoubleColMultiplyDoubleColumn(col 24:double, col 25:double)(children: CastLongToDouble(col 0:tinyint) -> 24:double, CastLongToDouble(col 0:tinyint) -> 25:double) -> 26:double, DoubleColMultiplyDoubleColumn(col 4:double, col 4:double)(children: col 4:float, col 4:float) -> 27:double, CastLongToDouble(col 2:int) -> 28:double, DoubleColMultiplyDoubleColumn(col 29:double, col 30:double)(children: CastLongToDouble(col 2:int) -> 29:double, CastLongToDouble(col 2:int) -> 30:double) -> 31:double
                       Statistics: Num rows: 2503 Data size: 209380 Basic stats: COMPLETE Column stats: COMPLETE
                       Group By Operator
-                        aggregations: sum(_col5), sum(_col4), count(_col0), sum(_col7), sum(_col6), count(_col1), sum(_col9), sum(_col8), count(_col2), sum(_col2), sum(_col3), count(_col3), sum(_col11), sum(_col10)
+                        aggregations: sum(_col3), sum(_col2), count(_col2), sum(_col5), sum(_col4), count(_col4), sum(_col7), sum(_col6), count(_col6), sum(_col0), sum(_col1), count(_col1), sum(_col9), sum(_col8), count(_col8)
                         Group By Vectorization:
-                            aggregators: VectorUDAFSumDouble(col 22:double) -> double, VectorUDAFSumDouble(col 19:double) -> double, VectorUDAFCount(col 1:smallint) -> bigint, VectorUDAFSumDouble(col 26:double) -> double, VectorUDAFSumDouble(col 23:double) -> double, VectorUDAFCount(col 0:tinyint) -> bigint, VectorUDAFSumDouble(col 27:double) -> double, VectorUDAFSumDouble(col 4:double) -> double, VectorUDAFCount(col 4:float) -> bigint, VectorUDAFSumDouble(col 4:float) -> double, VectorUDAFSumLong(col 2:int) -> bigint, VectorUDAFCount(col 2:int) -> bigint, VectorUDAFSumDouble(col 31:double) -> double, VectorUDAFSumDouble(col 28:double) -> double
+                            aggregators: VectorUDAFSumDouble(col 22:double) -> double, VectorUDAFSumDouble(col 19:double) -> double, VectorUDAFCount(col 19:double) -> bigint, VectorUDAFSumDouble(col 26:double) -> double, VectorUDAFSumDouble(col 23:double) -> double, VectorUDAFCount(col 23:double) -> bigint, VectorUDAFSumDouble(col 27:double) -> double, VectorUDAFSumDouble(col 4:double) -> double, VectorUDAFCount(col 4:double) -> bigint, VectorUDAFSumDouble(col 4:float) -> double, VectorUDAFSumLong(col 2:int) -> bigint, VectorUDAFCount(col 2:int) -> bigint, VectorUDAFSumDouble(col 31:double) -> double, VectorUDAFSumDouble(col 28:double) -> double, VectorUDAFCount(col 28:double) -> bigint
                             className: VectorGroupByOperator
                             groupByMode: HASH
                             native: false
                             vectorProcessingMode: HASH
-                            projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
+                            projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
                         minReductionHashAggr: 0.99
                         mode: hash
-                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13
-                        Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
+                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14
+                        Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                         Reduce Output Operator
                           null sort order: 
                           sort order: 
@@ -113,8 +113,8 @@ STAGE PLANS:
                               className: VectorReduceSinkEmptyKeyOperator
                               native: true
                               nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
-                          Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
-                          value expressions: _col0 (type: double), _col1 (type: double), _col2 (type: bigint), _col3 (type: double), _col4 (type: double), _col5 (type: bigint), _col6 (type: double), _col7 (type: double), _col8 (type: bigint), _col9 (type: double), _col10 (type: bigint), _col11 (type: bigint), _col12 (type: double), _col13 (type: double)
+                          Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
+                          value expressions: _col0 (type: double), _col1 (type: double), _col2 (type: bigint), _col3 (type: double), _col4 (type: double), _col5 (type: bigint), _col6 (type: double), _col7 (type: double), _col8 (type: bigint), _col9 (type: double), _col10 (type: bigint), _col11 (type: bigint), _col12 (type: double), _col13 (type: double), _col14 (type: bigint)
             Execution mode: vectorized, llap
             LLAP IO: all inputs (cache only)
             Map Vectorization:
@@ -136,25 +136,25 @@ STAGE PLANS:
                 vectorized: true
             Reduce Operator Tree:
               Group By Operator
-                aggregations: sum(VALUE._col0), sum(VALUE._col1), count(VALUE._col2), sum(VALUE._col3), sum(VALUE._col4), count(VALUE._col5), sum(VALUE._col6), sum(VALUE._col7), count(VALUE._col8), sum(VALUE._col9), sum(VALUE._col10), count(VALUE._col11), sum(VALUE._col12), sum(VALUE._col13)
+                aggregations: sum(VALUE._col0), sum(VALUE._col1), count(VALUE._col2), sum(VALUE._col3), sum(VALUE._col4), count(VALUE._col5), sum(VALUE._col6), sum(VALUE._col7), count(VALUE._col8), sum(VALUE._col9), sum(VALUE._col10), count(VALUE._col11), sum(VALUE._col12), sum(VALUE._col13), count(VALUE._col14)
                 Group By Vectorization:
-                    aggregators: VectorUDAFSumDouble(col 0:double) -> double, VectorUDAFSumDouble(col 1:double) -> double, VectorUDAFCountMerge(col 2:bigint) -> bigint, VectorUDAFSumDouble(col 3:double) -> double, VectorUDAFSumDouble(col 4:double) -> double, VectorUDAFCountMerge(col 5:bigint) -> bigint, VectorUDAFSumDouble(col 6:double) -> double, VectorUDAFSumDouble(col 7:double) -> double, VectorUDAFCountMerge(col 8:bigint) -> bigint, VectorUDAFSumDouble(col 9:double) -> double, VectorUDAFSumLong(col 10:bigint) -> bigint, VectorUDAFCountMerge(col 11:bigint) -> bigint, VectorUDAFSumDouble(col 12:double) -> double, VectorUDAFSumDouble(col 13:double) -> double
+                    aggregators: VectorUDAFSumDouble(col 0:double) -> double, VectorUDAFSumDouble(col 1:double) -> double, VectorUDAFCountMerge(col 2:bigint) -> bigint, VectorUDAFSumDouble(col 3:double) -> double, VectorUDAFSumDouble(col 4:double) -> double, VectorUDAFCountMerge(col 5:bigint) -> bigint, VectorUDAFSumDouble(col 6:double) -> double, VectorUDAFSumDouble(col 7:double) -> double, VectorUDAFCountMerge(col 8:bigint) -> bigint, VectorUDAFSumDouble(col 9:double) -> double, VectorUDAFSumLong(col 10:bigint) -> bigint, VectorUDAFCountMerge(col 11:bigint) -> bigint, VectorUDAFSumDouble(col 12:double) -> double, VectorUDAFSumDouble(col 13:double) -> double, VectorUDAFCountMerge(col 14:bigint) -> bigint
                     className: VectorGroupByOperator
                     groupByMode: MERGEPARTIAL
                     native: false
                     vectorProcessingMode: GLOBAL
-                    projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
+                    projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
                 mode: mergepartial
-                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13
-                Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
+                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14
+                Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
-                  expressions: power(((_col0 - ((_col1 * _col1) / _col2)) / if((_col2 = 1L), null, (_col2 - 1))), 0.5) (type: double), power(((_col3 - ((_col4 * _col4) / _col5)) / _col5), 0.5) (type: double), power(((_col6 - ((_col7 * _col7) / _col8)) / if((_col8 = 1L), null, (_col8 - 1))), 0.5) (type: double), _col9 (type: double), (UDFToDouble(_col10) / _col11) (type: double), power(((_col12 - ((_col13 * _col13) / _col11)) / _col11), 0.5) (type: double)
+                  expressions: power(((_col0 - ((_col1 * _col1) / _col2)) / if((_col2 = 1L), null, (_col2 - 1))), 0.5) (type: double), power(((_col3 - ((_col4 * _col4) / _col5)) / _col5), 0.5) (type: double), power(((_col6 - ((_col7 * _col7) / _col8)) / if((_col8 = 1L), null, (_col8 - 1))), 0.5) (type: double), _col9 (type: double), (UDFToDouble(_col10) / _col11) (type: double), power(((_col12 - ((_col13 * _col13) / _col14)) / _col14), 0.5) (type: double)
                   outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                   Select Vectorization:
                       className: VectorSelectOperator
                       native: true
-                      projectedOutputColumnNums: [21, 26, 34, 9, 36, 41]
-                      selectExpressions: FuncPowerDoubleToDouble(col 20:double)(children: DoubleColDivideLongColumn(col 16:double, col 19:bigint)(children: DoubleColSubtractDoubleColumn(col 0:double, col 15:double)(children: DoubleColDivideLongColumn(col 14:double, col 2:bigint)(children: DoubleColMultiplyDoubleColumn(col 1:double, col 1:double) -> 14:double) -> 15:double) -> 16:double, IfExprNullCondExpr(col 17:boolean, null, col 18:bigint)(children: LongColEqualLongScalar(col 2:bigint, val 1) -> 17:boolean, LongColSubtractLongScalar(col 2:bigint, val 1) -> 18:bigint) -> 19:bigint) -> 20:double) -> 21:double, FuncPowerDoubleToDouble(col 25:double)(children: DoubleColDivideLongColumn(col 24:double, col 5:bigint)(children: DoubleColSubtractDoubleColumn(col 3:double, col 23:double)(children: DoubleColDivideLongColumn(col 22:double, col 5:bigint)(children: DoubleColMultiplyDoubleColumn(col 4:double, col 4:double) -> 22:double) -> 23:double) -> 24:double) -> 25:double) -> 26:double, FuncPowerDoubleToDouble(col 33:double)(children: DoubleColDivideLongColumn(col 29:double, col 32:bigint)(children: DoubleColSubtractDoubleColumn(col 6:double, col 28:double)(children: DoubleColDivideLongColumn(col 27:double, col 8:bigint)(children: DoubleColMultiplyDoubleColumn(col 7:double, col 7:double) -> 27:double) -> 28:double) -> 29:double, IfExprNullCondExpr(col 30:boolean, null, col 31:bigint)(children: LongColEqualLongScalar(col 8:bigint, val 1) -> 30:boolean, LongColSubtractLongScalar(col 8:bigint, val 1) -> 31:bigint) -> 32:bigint) -> 33:double) -> 34:double, DoubleColDivideLongColumn(col 35:double, col 11:bigint)(children: CastLongToDouble(col 10:bigint) -> 35:double) -> 36:double, FuncPowerDoubleToDouble(col 40:double)(children: DoubleColDivideLongColumn(col 39:double, col 11:bigint)(children: DoubleColSubtractDoubleColumn(col 12:double, col 38:double)(children: DoubleColDivideLongColumn(col 37:double, col 11:bigint)(children: DoubleColMultiplyDoubleColumn(col 13:double, col 13:double) -> 37:double) -> 38:double) -> 39:double) -> 40:double) -> 41:double
+                      projectedOutputColumnNums: [22, 27, 35, 9, 37, 42]
+                      selectExpressions: FuncPowerDoubleToDouble(col 21:double)(children: DoubleColDivideLongColumn(col 17:double, col 20:bigint)(children: DoubleColSubtractDoubleColumn(col 0:double, col 16:double)(children: DoubleColDivideLongColumn(col 15:double, col 2:bigint)(children: DoubleColMultiplyDoubleColumn(col 1:double, col 1:double) -> 15:double) -> 16:double) -> 17:double, IfExprNullCondExpr(col 18:boolean, null, col 19:bigint)(children: LongColEqualLongScalar(col 2:bigint, val 1) -> 18:boolean, LongColSubtractLongScalar(col 2:bigint, val 1) -> 19:bigint) -> 20:bigint) -> 21:double) -> 22:double, FuncPowerDoubleToDouble(col 26:double)(children: DoubleColDivideLongColumn(col 25:double, col 5:bigint)(children: DoubleColSubtractDoubleColumn(col 3:double, col 24:double)(children: DoubleColDivideLongColumn(col 23:double, col 5:bigint)(children: DoubleColMultiplyDoubleColumn(col 4:double, col 4:double) -> 23:double) -> 24:double) -> 25:double) -> 26:double) -> 27:double, FuncPowerDoubleToDouble(col 34:double)(children: DoubleColDivideLongColumn(col 30:double, col 33:bigint)(children: DoubleColSubtractDoubleColumn(col 6:double, col 29:double)(children: DoubleColDivideLongColumn(col 28:double, col 8:bigint)(children: DoubleColMultiplyDoubleColumn(col 7:double, col 7:double) -> 28:double) -> 29:double) -> 30:double, IfExprNullCondExpr(col 31:boolean, null, col 32:bigint)(children: LongColEqualLongScalar(col 8:bigint, val 1) -> 31:boolean, LongColSubtractLongScalar(col 8:bigint, val 1) -> 32:bigint) -> 33:bigint) -> 34:double) -> 35:double, DoubleColDivideLongColumn(col 36:double, col 11:bigint)(children: CastLongToDouble(col 10:bigint) -> 36:double) -> 37:double, FuncPowerDoubleToDouble(col 41:double)(children: DoubleColDivideLongColumn(col 40:double, col 14:bigint)(children: DoubleColSubtractDoubleColumn(col 12:double, col 39:double)(children: DoubleColDivideLongColumn(col 38:double, col 14:bigint)(children: DoubleColMultiplyDoubleColumn(col 13:double, col 13:double) -> 38:double) -> 39:double) -> 40:double) -> 41:double) -> 42:double
                   Statistics: Num rows: 1 Data size: 48 Basic stats: COMPLETE Column stats: COMPLETE
                   Select Operator
                     expressions: _col0 (type: double), (_col0 - 10.175D) (type: double), _col1 (type: double), (_col0 * (_col0 - 10.175D)) (type: double), (- _col1) (type: double), (_col0 % 79.553D) (type: double), (- (_col0 * (_col0 - 10.175D))) (type: double), _col2 (type: double), (- _col0) (type: double), _col3 (type: double), ((- (_col0 * (_col0 - 10.175D))) / (_col0 - 10.175D)) (type: double), (- (_col0 - 10.175D)) (type: double), _col4 (type: double), (-3728.0D - _col0) (type: double), _col5 (type: double), (_col4 / _col2) (type: double)
@@ -162,8 +162,8 @@ STAGE PLANS:
                     Select Vectorization:
                         className: VectorSelectOperator
                         native: true
-                        projectedOutputColumnNums: [21, 42, 26, 44, 45, 46, 49, 34, 50, 9, 55, 57, 36, 58, 41, 59]
-                        selectExpressions: DoubleColSubtractDoubleScalar(col 21:double, val 10.175) -> 42:double, DoubleColMultiplyDoubleColumn(col 21:double, col 43:double)(children: DoubleColSubtractDoubleScalar(col 21:double, val 10.175) -> 43:double) -> 44:double, DoubleColUnaryMinus(col 26:double) -> 45:double, DoubleColModuloDoubleScalar(col 21:double, val 79.553) -> 46:double, DoubleColUnaryMinus(col 48:double)(children: DoubleColMultiplyDoubleColumn(col 21:double, col 47:double)(children: DoubleColSubtractDoubleScalar(col 21:double, val 10.175) -> 47:double) -> 48:double) -> 49:double, DoubleColUnaryMinus(col 21:double) -> 50:double, DoubleColDivideDoubleColumn(col 53:double, col 54:double)(children: DoubleColUnaryMinus(col 52:double)(children: DoubleColMultiplyDoubleColumn(col 21:double, col 51:double)(children: DoubleColSubtractDoubleScalar(col 21:double, val 10.175) -> 51:double) -> 52:double) -> 53:double, DoubleColSubtractDoubleScalar(col 21:double, val 10.175) -> 54:double) -> 55:double, DoubleColUnaryMinus(col 56:double)(children: DoubleColSubtractDoubleScalar(col 21:double, val 10.175) -> 56:double) -> 57:double, DoubleScalarSubtractDoubleColumn(val -3728.0, col 21:double) -> 58:double, DoubleColDivideDoubleColumn(col 36:double, col 34:double) -> 59:double
+                        projectedOutputColumnNums: [22, 43, 27, 45, 46, 47, 50, 35, 51, 9, 56, 58, 37, 59, 42, 60]
+                        selectExpressions: DoubleColSubtractDoubleScalar(col 22:double, val 10.175) -> 43:double, DoubleColMultiplyDoubleColumn(col 22:double, col 44:double)(children: DoubleColSubtractDoubleScalar(col 22:double, val 10.175) -> 44:double) -> 45:double, DoubleColUnaryMinus(col 27:double) -> 46:double, DoubleColModuloDoubleScalar(col 22:double, val 79.553) -> 47:double, DoubleColUnaryMinus(col 49:double)(children: DoubleColMultiplyDoubleColumn(col 22:double, col 48:double)(children: DoubleColSubtractDoubleScalar(col 22:double, val 10.175) -> 48:double) -> 49:double) -> 50:double, DoubleColUnaryMinus(col 22:double) -> 51:double, DoubleColDivideDoubleColumn(col 54:double, col 55:double)(children: DoubleColUnaryMinus(col 53:double)(children: DoubleColMultiplyDoubleColumn(col 22:double, col 52:double)(children: DoubleColSubtractDoubleScalar(col 22:double, val 10.175) -> 52:double) -> 53:double) -> 54:double, DoubleColSubtractDoubleScalar(col 22:double, val 10.175) -> 55:double) -> 56:double, DoubleColUnaryMinus(col 57:double)(children: DoubleColSubtractDoubleScalar(col 22:double, val 10.175) -> 57:double) -> 58:double, DoubleScalarSubtractDoubleColumn(val -3728.0, col 22:double) -> 59:double, DoubleColDivideDoubleColumn(col 37:double, col 35:double) -> 60:double
                     Statistics: Num rows: 1 Data size: 128 Basic stats: COMPLETE Column stats: COMPLETE
                     File Output Operator
                       compressed: false
diff --git a/ql/src/test/results/clientpositive/llap/udaf_binarysetfunctions.q.out b/ql/src/test/results/clientpositive/llap/udaf_binarysetfunctions.q.out
index 49182860b2..4272510974 100644
--- a/ql/src/test/results/clientpositive/llap/udaf_binarysetfunctions.q.out
+++ b/ql/src/test/results/clientpositive/llap/udaf_binarysetfunctions.q.out
@@ -395,7 +395,7 @@ STAGE PLANS:
                     outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                     Statistics: Num rows: 29 Data size: 5044 Basic stats: COMPLETE Column stats: COMPLETE
                     Group By Operator
-                      aggregations: sum(_col4), sum(_col3), count(_col1), sum(_col6), sum(_col5), count(_col2), corr(_col2, _col1), covar_samp(_col2, _col1), covar_pop(_col2, _col1), regr_count(_col2, _col1), regr_slope(_col2, _col1), regr_intercept(_col2, _col1), regr_r2(_col2, _col1), regr_sxx(_col2, _col1), regr_syy(_col2, _col1), regr_sxy(_col2, _col1), regr_avgx(_col2, _col1), regr_avgy(_col2, _col1)
+                      aggregations: sum(_col4), sum(_col3), count(_col3), sum(_col6), sum(_col5), count(_col5), corr(_col2, _col1), covar_samp(_col2, _col1), covar_pop(_col2, _col1), regr_count(_col2, _col1), regr_slope(_col2, _col1), regr_intercept(_col2, _col1), regr_r2(_col2, _col1), regr_sxx(_col2, _col1), regr_syy(_col2, _col1), regr_sxy(_col2, _col1), regr_avgx(_col2, _col1), regr_avgy(_col2, _col1)
                       keys: _col0 (type: int)
                       minReductionHashAggr: 0.7586207
                       mode: hash
diff --git a/ql/src/test/results/clientpositive/llap/udaf_number_format.q.out b/ql/src/test/results/clientpositive/llap/udaf_number_format.q.out
index 6cd088c7be..94f4c3e879 100644
--- a/ql/src/test/results/clientpositive/llap/udaf_number_format.q.out
+++ b/ql/src/test/results/clientpositive/llap/udaf_number_format.q.out
@@ -36,7 +36,7 @@ STAGE PLANS:
                   Select Operator
                     Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: COMPLETE
                     Group By Operator
-                      aggregations: sum('a'), count(), sum(null), sum(null)
+                      aggregations: sum('a'), sum(null), count(null), sum(null)
                       minReductionHashAggr: 0.99
                       mode: hash
                       outputColumnNames: _col0, _col1, _col2, _col3
@@ -45,19 +45,19 @@ STAGE PLANS:
                         null sort order: 
                         sort order: 
                         Statistics: Num rows: 1 Data size: 32 Basic stats: COMPLETE Column stats: COMPLETE
-                        value expressions: _col0 (type: double), _col1 (type: bigint), _col2 (type: double), _col3 (type: double)
+                        value expressions: _col0 (type: double), _col1 (type: double), _col2 (type: bigint), _col3 (type: double)
             Execution mode: llap
             LLAP IO: all inputs
         Reducer 2 
             Execution mode: vectorized, llap
             Reduce Operator Tree:
               Group By Operator
-                aggregations: sum(VALUE._col0), count(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3)
+                aggregations: sum(VALUE._col0), sum(VALUE._col1), count(VALUE._col2), sum(VALUE._col3)
                 mode: mergepartial
                 outputColumnNames: _col0, _col1, _col2, _col3
                 Statistics: Num rows: 1 Data size: 32 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
-                  expressions: _col0 (type: double), (_col0 / _col1) (type: double), ((_col2 - ((_col3 * _col3) / _col1)) / _col1) (type: double), power(((_col2 - ((_col3 * _col3) / _col1)) / _col1), 0.5) (type: double)
+                  expressions: _col0 (type: double), (_col1 / _col2) (type: double), ((_col3 - ((_col1 * _col1) / _col2)) / _col2) (type: double), power(((_col3 - ((_col1 * _col1) / _col2)) / _col2), 0.5) (type: double)
                   outputColumnNames: _col0, _col1, _col2, _col3
                   Statistics: Num rows: 1 Data size: 32 Basic stats: COMPLETE Column stats: COMPLETE
                   File Output Operator
@@ -92,4 +92,4 @@ FROM src
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
 #### A masked pattern was here ####
-0.0	0.0	NULL	NULL
+0.0	NULL	NULL	NULL
diff --git a/ql/src/test/results/clientpositive/llap/udf8.q.out b/ql/src/test/results/clientpositive/llap/udf8.q.out
index 869862c6c1..ef65e7d27a 100644
--- a/ql/src/test/results/clientpositive/llap/udf8.q.out
+++ b/ql/src/test/results/clientpositive/llap/udf8.q.out
@@ -52,32 +52,32 @@ STAGE PLANS:
                   alias: dest1_n54
                   Statistics: Num rows: 1 Data size: 85 Basic stats: COMPLETE Column stats: COMPLETE
                   Select Operator
-                    expressions: c1 (type: string)
-                    outputColumnNames: c1
+                    expressions: c1 (type: string), UDFToDouble(c1) (type: double)
+                    outputColumnNames: _col0, _col1
                     Statistics: Num rows: 1 Data size: 85 Basic stats: COMPLETE Column stats: COMPLETE
                     Group By Operator
-                      aggregations: sum(c1), count(c1)
+                      aggregations: sum(_col1), count(_col1), sum(_col0), count(_col0)
                       minReductionHashAggr: 0.4
                       mode: hash
-                      outputColumnNames: _col0, _col1
-                      Statistics: Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: COMPLETE
+                      outputColumnNames: _col0, _col1, _col2, _col3
+                      Statistics: Num rows: 1 Data size: 32 Basic stats: COMPLETE Column stats: COMPLETE
                       Reduce Output Operator
                         null sort order: 
                         sort order: 
-                        Statistics: Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: COMPLETE
-                        value expressions: _col0 (type: double), _col1 (type: bigint)
+                        Statistics: Num rows: 1 Data size: 32 Basic stats: COMPLETE Column stats: COMPLETE
+                        value expressions: _col0 (type: double), _col1 (type: bigint), _col2 (type: double), _col3 (type: bigint)
             Execution mode: llap
             LLAP IO: all inputs
         Reducer 2 
             Execution mode: vectorized, llap
             Reduce Operator Tree:
               Group By Operator
-                aggregations: sum(VALUE._col0), count(VALUE._col1)
+                aggregations: sum(VALUE._col0), count(VALUE._col1), sum(VALUE._col2), count(VALUE._col3)
                 mode: mergepartial
-                outputColumnNames: _col0, _col1
-                Statistics: Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: COMPLETE
+                outputColumnNames: _col0, _col1, _col2, _col3
+                Statistics: Num rows: 1 Data size: 32 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
-                  expressions: (_col0 / _col1) (type: double), _col0 (type: double), _col1 (type: bigint)
+                  expressions: (_col0 / _col1) (type: double), _col2 (type: double), _col3 (type: bigint)
                   outputColumnNames: _col0, _col1, _col2
                   Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                   File Output Operator
diff --git a/ql/src/test/results/clientpositive/llap/vector_decimal_aggregate.q.out b/ql/src/test/results/clientpositive/llap/vector_decimal_aggregate.q.out
index 39133ac7b1..6705110e46 100644
--- a/ql/src/test/results/clientpositive/llap/vector_decimal_aggregate.q.out
+++ b/ql/src/test/results/clientpositive/llap/vector_decimal_aggregate.q.out
@@ -271,20 +271,20 @@ STAGE PLANS:
                         selectExpressions: CastDecimalToDouble(col 1:decimal(20,10)) -> 6:double, DoubleColMultiplyDoubleColumn(col 7:double, col 8:double)(children: CastDecimalToDouble(col 1:decimal(20,10)) -> 7:double, CastDecimalToDouble(col 1:decimal(20,10)) -> 8:double) -> 9:double, CastDecimalToDouble(col 2:decimal(23,14)) -> 10:double, DoubleColMultiplyDoubleColumn(col 11:double, col 12:double)(children: CastDecimalToDouble(col 2:decimal(23,14)) -> 11:double, CastDecimalToDouble(col 2:decimal(23,14)) -> 12:double) -> 13:double
                     Statistics: Num rows: 12289 Data size: 2091896 Basic stats: COMPLETE Column stats: COMPLETE
                     Group By Operator
-                      aggregations: count(_col1), max(_col1), min(_col1), sum(_col1), sum(_col4), sum(_col3), count(_col2), max(_col2), min(_col2), sum(_col2), sum(_col6), sum(_col5), count()
+                      aggregations: count(_col1), max(_col1), min(_col1), sum(_col1), sum(_col4), sum(_col3), count(_col3), count(_col2), max(_col2), min(_col2), sum(_col2), sum(_col6), sum(_col5), count(_col5), count()
                       Group By Vectorization:
-                          aggregators: VectorUDAFCount(col 1:decimal(20,10)) -> bigint, VectorUDAFMaxDecimal(col 1:decimal(20,10)) -> decimal(20,10), VectorUDAFMinDecimal(col 1:decimal(20,10)) -> decimal(20,10), VectorUDAFSumDecimal(col 1:decimal(20,10)) -> decimal(30,10), VectorUDAFSumDouble(col 9:double) -> double, VectorUDAFSumDouble(col 6:double) -> double, VectorUDAFCount(col 2:decimal(23,14)) -> bigint, VectorUDAFMaxDecimal(col 2:decimal(23,14)) -> decimal(23,14), VectorUDAFMinDecimal(col 2:decimal(23,14)) -> decimal(23,14), VectorUDAFSumDecimal(col 2:decimal(23,14)) -> decimal(33,14), VectorUDAFSumDouble(col 13:double) -> double, VectorUDAFSumDouble(col 10:double) -> double, VectorUDAFCountStar(*) -> bigint
+                          aggregators: VectorUDAFCount(col 1:decimal(20,10)) -> bigint, VectorUDAFMaxDecimal(col 1:decimal(20,10)) -> decimal(20,10), VectorUDAFMinDecimal(col 1:decimal(20,10)) -> decimal(20,10), VectorUDAFSumDecimal(col 1:decimal(20,10)) -> decimal(30,10), VectorUDAFSumDouble(col 9:double) -> double, VectorUDAFSumDouble(col 6:double) -> double, VectorUDAFCount(col 6:double) -> bigint, VectorUDAFCount(col 2:decimal(23,14)) -> bigint, VectorUDAFMaxDecimal(col 2:decimal(23,14)) -> decimal(23,14), VectorUDAFMinDecimal(col 2:decimal(23,14)) -> decimal(23,14), VectorUDAFSumDecimal(col 2:decimal(23,14)) -> decimal(33,14), VectorUDAFSumDouble(col 13:double) -> double, VectorUDAFSumDouble(col 10:double) -> double, VectorUDAFCount(col 10:double) -> bigint, VectorUDAFCountStar(*) -> bigint
                           className: VectorGroupByOperator
                           groupByMode: HASH
                           keyExpressions: col 3:int
                           native: false
                           vectorProcessingMode: HASH
-                          projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]
+                          projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
                       keys: _col0 (type: int)
                       minReductionHashAggr: 0.50321424
                       mode: hash
-                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13
-                      Statistics: Num rows: 6105 Data size: 4462672 Basic stats: COMPLETE Column stats: COMPLETE
+                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15
+                      Statistics: Num rows: 6105 Data size: 4560352 Basic stats: COMPLETE Column stats: COMPLETE
                       Reduce Output Operator
                         key expressions: _col0 (type: int)
                         null sort order: z
@@ -295,9 +295,9 @@ STAGE PLANS:
                             keyColumns: 0:int
                             native: true
                             nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
-                            valueColumns: 1:bigint, 2:decimal(20,10), 3:decimal(20,10), 4:decimal(30,10), 5:double, 6:double, 7:bigint, 8:decimal(23,14), 9:decimal(23,14), 10:decimal(33,14), 11:double, 12:double, 13:bigint
-                        Statistics: Num rows: 6105 Data size: 4462672 Basic stats: COMPLETE Column stats: COMPLETE
-                        value expressions: _col1 (type: bigint), _col2 (type: decimal(20,10)), _col3 (type: decimal(20,10)), _col4 (type: decimal(30,10)), _col5 (type: double), _col6 (type: double), _col7 (type: bigint), _col8 (type: decimal(23,14)), _col9 (type: decimal(23,14)), _col10 (type: decimal(33,14)), _col11 (type: double), _col12 (type: double), _col13 (type: bigint)
+                            valueColumns: 1:bigint, 2:decimal(20,10), 3:decimal(20,10), 4:decimal(30,10), 5:double, 6:double, 7:bigint, 8:bigint, 9:decimal(23,14), 10:decimal(23,14), 11:decimal(33,14), 12:double, 13:double, 14:bigint, 15:bigint
+                        Statistics: Num rows: 6105 Data size: 4560352 Basic stats: COMPLETE Column stats: COMPLETE
+                        value expressions: _col1 (type: bigint), _col2 (type: decimal(20,10)), _col3 (type: decimal(20,10)), _col4 (type: decimal(30,10)), _col5 (type: double), _col6 (type: double), _col7 (type: bigint), _col8 (type: bigint), _col9 (type: decimal(23,14)), _col10 (type: decimal(23,14)), _col11 (type: decimal(33,14)), _col12 (type: double), _col13 (type: double), _col14 (type: bigint), _col15 (type: bigint)
             Execution mode: vectorized, llap
             LLAP IO: all inputs
             Map Vectorization:
@@ -326,40 +326,40 @@ STAGE PLANS:
                 usesVectorUDFAdaptor: false
                 vectorized: true
                 rowBatchContext:
-                    dataColumnCount: 14
-                    dataColumns: KEY._col0:int, VALUE._col0:bigint, VALUE._col1:decimal(20,10), VALUE._col2:decimal(20,10), VALUE._col3:decimal(30,10), VALUE._col4:double, VALUE._col5:double, VALUE._col6:bigint, VALUE._col7:decimal(23,14), VALUE._col8:decimal(23,14), VALUE._col9:decimal(33,14), VALUE._col10:double, VALUE._col11:double, VALUE._col12:bigint
+                    dataColumnCount: 16
+                    dataColumns: KEY._col0:int, VALUE._col0:bigint, VALUE._col1:decimal(20,10), VALUE._col2:decimal(20,10), VALUE._col3:decimal(30,10), VALUE._col4:double, VALUE._col5:double, VALUE._col6:bigint, VALUE._col7:bigint, VALUE._col8:decimal(23,14), VALUE._col9:decimal(23,14), VALUE._col10:decimal(33,14), VALUE._col11:double, VALUE._col12:double, VALUE._col13:bigint, VALUE._col14:bigint
                     partitionColumnCount: 0
                     scratchColumnTypeNames: []
             Reduce Operator Tree:
               Group By Operator
-                aggregations: count(VALUE._col0), max(VALUE._col1), min(VALUE._col2), sum(VALUE._col3), sum(VALUE._col4), sum(VALUE._col5), count(VALUE._col6), max(VALUE._col7), min(VALUE._col8), sum(VALUE._col9), sum(VALUE._col10), sum(VALUE._col11), count(VALUE._col12)
+                aggregations: count(VALUE._col0), max(VALUE._col1), min(VALUE._col2), sum(VALUE._col3), sum(VALUE._col4), sum(VALUE._col5), count(VALUE._col6), count(VALUE._col7), max(VALUE._col8), min(VALUE._col9), sum(VALUE._col10), sum(VALUE._col11), sum(VALUE._col12), count(VALUE._col13), count(VALUE._col14)
                 Group By Vectorization:
-                    aggregators: VectorUDAFCountMerge(col 1:bigint) -> bigint, VectorUDAFMaxDecimal(col 2:decimal(20,10)) -> decimal(20,10), VectorUDAFMinDecimal(col 3:decimal(20,10)) -> decimal(20,10), VectorUDAFSumDecimal(col 4:decimal(30,10)) -> decimal(30,10), VectorUDAFSumDouble(col 5:double) -> double, VectorUDAFSumDouble(col 6:double) -> double, VectorUDAFCountMerge(col 7:bigint) -> bigint, VectorUDAFMaxDecimal(col 8:decimal(23,14)) -> decimal(23,14), VectorUDAFMinDecimal(col 9:decimal(23,14)) -> decimal(23,14), VectorUDAFSumDecimal(col 10:decimal(33,14)) -> decimal(33,14), VectorUDAFSumDouble(col 11:double) -> double, VectorUDAFSumDouble(col 12:double) -> double, VectorUDAFCountMerge(col 13:bigint) -> bigint
+                    aggregators: VectorUDAFCountMerge(col 1:bigint) -> bigint, VectorUDAFMaxDecimal(col 2:decimal(20,10)) -> decimal(20,10), VectorUDAFMinDecimal(col 3:decimal(20,10)) -> decimal(20,10), VectorUDAFSumDecimal(col 4:decimal(30,10)) -> decimal(30,10), VectorUDAFSumDouble(col 5:double) -> double, VectorUDAFSumDouble(col 6:double) -> double, VectorUDAFCountMerge(col 7:bigint) -> bigint, VectorUDAFCountMerge(col 8:bigint) -> bigint, VectorUDAFMaxDecimal(col 9:decimal(23,14)) -> decimal(23,14), VectorUDAFMinDecimal(col 10:decimal(23,14)) -> decimal(23,14), VectorUDAFSumDecimal(col 11:decimal(33,14)) -> decimal(33,14), VectorUDAFSumDouble(col 12:double) -> double, VectorUDAFSumDouble(col 13:double) -> double, VectorUDAFCountMerge(col 14:bigint) -> bigint, VectorUDAFCountMerge(col 15:bigint) -> bigint
                     className: VectorGroupByOperator
                     groupByMode: MERGEPARTIAL
                     keyExpressions: col 0:int
                     native: false
                     vectorProcessingMode: MERGE_PARTIAL
-                    projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]
+                    projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
                 keys: KEY._col0 (type: int)
                 mode: mergepartial
-                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13
-                Statistics: Num rows: 6105 Data size: 4462672 Basic stats: COMPLETE Column stats: COMPLETE
+                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15
+                Statistics: Num rows: 6105 Data size: 4560352 Basic stats: COMPLETE Column stats: COMPLETE
                 Filter Operator
                   Filter Vectorization:
                       className: VectorFilterOperator
                       native: true
-                      predicateExpression: FilterLongColGreaterLongScalar(col 13:bigint, val 1)
-                  predicate: (_col13 > 1L) (type: boolean)
-                  Statistics: Num rows: 2035 Data size: 1487560 Basic stats: COMPLETE Column stats: COMPLETE
+                      predicateExpression: FilterLongColGreaterLongScalar(col 15:bigint, val 1)
+                  predicate: (_col15 > 1L) (type: boolean)
+                  Statistics: Num rows: 2035 Data size: 1520120 Basic stats: COMPLETE Column stats: COMPLETE
                   Select Operator
-                    expressions: _col0 (type: int), _col1 (type: bigint), _col2 (type: decimal(20,10)), _col3 (type: decimal(20,10)), _col4 (type: decimal(30,10)), CAST( (_col4 / _col1) AS decimal(24,14)) (type: decimal(24,14)), power(((_col5 - ((_col6 * _col6) / _col1)) / _col1), 0.5) (type: double), power(((_col5 - ((_col6 * _col6) / _col1)) / if((_col1 = 1L), null, (_col1 - 1))), 0.5) (type: double), _col7 (type: bigint), _col8 (type: decimal(23,14)), _col9 (type: decimal(23,14)), _col10 (type: decimal(33,14)), CAST( (_col10 / _col7) AS decimal(27,18)) (type: decimal(27,18)), power(((_col11 - ((_col12 * _col12) / _col7)) / _col7), 0.5) (type: double), power(((_col11 - ((_col12 * _col12) / _col7)) / if((_col7 = 1L), null, (_col7 - 1))), 0.5) (type: double)
+                    expressions: _col0 (type: int), _col1 (type: bigint), _col2 (type: decimal(20,10)), _col3 (type: decimal(20,10)), _col4 (type: decimal(30,10)), CAST( (_col4 / _col1) AS decimal(24,14)) (type: decimal(24,14)), power(((_col5 - ((_col6 * _col6) / _col7)) / _col7), 0.5) (type: double), power(((_col5 - ((_col6 * _col6) / _col7)) / if((_col7 = 1L), null, (_col7 - 1))), 0.5) (type: double), _col8 (type: bigint), _col9 (type: decimal(23,14)), _col10 (type: decimal(23,14)), _col11 (type: decimal(33,14)), CAST( (_col11 / _col8) AS decimal(27,18)) (type: decimal(27,18)), power(((_col12 - ((_col13 * _col13) / _col14)) / _col14), 0.5) (type: double), power(((_col12 - ((_col13 * _col13) / _col14)) / if((_col14 = 1L), null, (_col14 - 1))), 0.5) (type: double)
                     outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14
                     Select Vectorization:
                         className: VectorSelectOperator
                         native: true
-                        projectedOutputColumnNums: [0, 1, 2, 3, 4, 16, 21, 29, 7, 8, 9, 10, 32, 37, 45]
-                        selectExpressions: CastDecimalToDecimal(col 15:decimal(38,18))(children: DecimalColDivideDecimalColumn(col 4:decimal(30,10), col 14:decimal(19,0))(children: CastLongToDecimal(col 1:bigint) -> 14:decimal(19,0)) -> 15:decimal(38,18)) -> 16:decimal(24,14), FuncPowerDoubleToDouble(col 20:double)(children: DoubleColDivideLongColumn(col 19:double, col 1:bigint)(children: DoubleColSubtractDoubleColumn(col 5:double, col 18:double)(children: DoubleColDivideLongColumn(col 17:double, col 1:bigint)(children: DoubleColMultiplyDoubleColumn(col 6:double, col 6:double) -> 17:double) -> 18:double) -> 19:double) -> 20:double) -> 21:double, FuncPowerDoubleToDouble(col 28:double)(children: DoubleColDivideLongColumn(col 24:double, col 27:bigint)(children: DoubleColSubtractDoubleColumn(col 5:double, col 23:double)(children: DoubleColDivideLongColumn(col 22:double, col 1:bigint)(children: DoubleColMultiplyDoubleColumn(col 6:double, col 6:double) -> 22:double) -> 23:double) -> 24:double, IfExprNullCondExpr(col 25:boolean, null, col 26:bigint)(children: LongColEqualLongScalar(col 1:bigint, val 1) -> 25:boolean, LongColSubtractLongScalar(col 1:bigint, val 1) -> 26:bigint) -> 27:bigint) -> 28:double) -> 29:double, CastDecimalToDecimal(col 31:decimal(38,19))(children: DecimalColDivideDecimalColumn(col 10:decimal(33,14), col 30:decimal(19,0))(children: CastLongToDecimal(col 7:bigint) -> 30:decimal(19,0)) -> 31:decimal(38,19)) -> 32:decimal(27,18), FuncPowerDoubleToDouble(col 36:double)(children: DoubleColDivideLongColumn(col 35:double, col 7:bigint)(children: DoubleColSubtractDoubleColumn(col 11:double, col 34:double)(children: DoubleColDivideLongColumn(col 33:double, col 7:bigint)(children: DoubleColMultiplyDoubleColumn(col 12:double, col 12:double) -> 33:double) -> 34:double) -> 35:double) -> 36:double) -> 37:double, FuncPowerDoubleToDouble(col 44:double)(children: DoubleColDivideLongColumn(col 40:double, col 43:bigint)(children: DoubleColSubtractDoubleColumn(col 11:double, col 39:double)(children: DoubleColDivideLongColumn(col 38:double, col 7:bigint)(children: DoubleColMultiplyDoubleColumn(col 12:double, col 12:double) -> 38:double) -> 39:double) -> 40:double, IfExprNullCondExpr(col 41:boolean, null, col 42:bigint)(children: LongColEqualLongScalar(col 7:bigint, val 1) -> 41:boolean, LongColSubtractLongScalar(col 7:bigint, val 1) -> 42:bigint) -> 43:bigint) -> 44:double) -> 45:double
+                        projectedOutputColumnNums: [0, 1, 2, 3, 4, 18, 23, 31, 8, 9, 10, 11, 34, 39, 47]
+                        selectExpressions: CastDecimalToDecimal(col 17:decimal(38,18))(children: DecimalColDivideDecimalColumn(col 4:decimal(30,10), col 16:decimal(19,0))(children: CastLongToDecimal(col 1:bigint) -> 16:decimal(19,0)) -> 17:decimal(38,18)) -> 18:decimal(24,14), FuncPowerDoubleToDouble(col 22:double)(children: DoubleColDivideLongColumn(col 21:double, col 7:bigint)(children: DoubleColSubtractDoubleColumn(col 5:double, col 20:double)(children: DoubleColDivideLongColumn(col 19:double, col 7:bigint)(children: DoubleColMultiplyDoubleColumn(col 6:double, col 6:double) -> 19:double) -> 20:double) -> 21:double) -> 22:double) -> 23:double, FuncPowerDoubleToDouble(col 30:double)(children: DoubleColDivideLongColumn(col 26:double, col 29:bigint)(children: DoubleColSubtractDoubleColumn(col 5:double, col 25:double)(children: DoubleColDivideLongColumn(col 24:double, col 7:bigint)(children: DoubleColMultiplyDoubleColumn(col 6:double, col 6:double) -> 24:double) -> 25:double) -> 26:double, IfExprNullCondExpr(col 27:boolean, null, col 28:bigint)(children: LongColEqualLongScalar(col 7:bigint, val 1) -> 27:boolean, LongColSubtractLongScalar(col 7:bigint, val 1) -> 28:bigint) -> 29:bigint) -> 30:double) -> 31:double, CastDecimalToDecimal(col 33:decimal(38,19))(children: DecimalColDivideDecimalColumn(col 11:decimal(33,14), col 32:decimal(19,0))(children: CastLongToDecimal(col 8:bigint) -> 32:decimal(19,0)) -> 33:decimal(38,19)) -> 34:decimal(27,18), FuncPowerDoubleToDouble(col 38:double)(children: DoubleColDivideLongColumn(col 37:double, col 14:bigint)(children: DoubleColSubtractDoubleColumn(col 12:double, col 36:double)(children: DoubleColDivideLongColumn(col 35:double, col 14:bigint)(children: DoubleColMultiplyDoubleColumn(col 13:double, col 13:double) -> 35:double) -> 36:double) -> 37:double) -> 38:double) -> 39:double, FuncPowerDoubleToDouble(col 46:double)(children: DoubleColDivideLongColumn(col 42:double, col 45:bigint)(children: DoubleColSubtractDoubleColumn(col 12:double, col 41:double)(children: DoubleColDivideLongColumn(col 40:double, col 14:bigint)(children: DoubleColMultiplyDoubleColumn(col 13:double, col 13:double) -> 40:double) -> 41:double) -> 42:double, IfExprNullCondExpr(col 43:boolean, null, col 44:bigint)(children: LongColEqualLongScalar(col 14:bigint, val 1) -> 43:boolean, LongColSubtractLongScalar(col 14:bigint, val 1) -> 44:bigint) -> 45:bigint) -> 46:double) -> 47:double
                     Statistics: Num rows: 2035 Data size: 1927120 Basic stats: COMPLETE Column stats: COMPLETE
                     File Output Operator
                       compressed: false
@@ -696,20 +696,20 @@ STAGE PLANS:
                         selectExpressions: CastDecimalToDouble(col 6:decimal(11,5))(children: ConvertDecimal64ToDecimal(col 1:decimal(11,5)/DECIMAL_64) -> 6:decimal(11,5)) -> 7:double, DoubleColMultiplyDoubleColumn(col 9:double, col 11:double)(children: CastDecimalToDouble(col 8:decimal(11,5))(children: ConvertDecimal64ToDecimal(col 1:decimal(11,5)/DECIMAL_64) -> 8:decimal(11,5)) -> 9:double, CastDecimalToDouble(col 10:decimal(11,5))(children: ConvertDecimal64ToDecimal(col 1:decimal(11,5)/DECIMAL_64) -> 10:decimal(11,5)) -> 11:double) -> 12:double, CastDecimalToDouble(col 13:decimal(16,0))(children: ConvertDecimal64ToDecimal(col 2:decimal(16,0)/DECIMAL_64) -> 13:decimal(16,0)) -> 14:double, DoubleColMultiplyDoubleColumn(col 16:double, col 18:double)(children: CastDecimalToDouble(col 15:decimal(16,0))(children: ConvertDecimal64ToDecimal(col 2:decimal(16,0)/DECIMAL_64) -> 15:decimal(16,0)) -> 16:double, CastDecimalToDouble(col 17:decimal(16,0))(children: ConvertDecimal64ToDecimal(col 2:decimal(16,0)/DECIMAL_64) -> 17:decimal(16,0)) -> 18:double) -> 19:double
                     Statistics: Num rows: 12289 Data size: 2091336 Basic stats: COMPLETE Column stats: COMPLETE
                     Group By Operator
-                      aggregations: count(_col1), max(_col1), min(_col1), sum(_col1), sum(_col4), sum(_col3), count(_col2), max(_col2), min(_col2), sum(_col2), sum(_col6), sum(_col5), count()
+                      aggregations: count(_col1), max(_col1), min(_col1), sum(_col1), sum(_col4), sum(_col3), count(_col3), count(_col2), max(_col2), min(_col2), sum(_col2), sum(_col6), sum(_col5), count(_col5), count()
                       Group By Vectorization:
-                          aggregators: VectorUDAFCount(col 1:decimal(11,5)/DECIMAL_64) -> bigint, VectorUDAFMaxDecimal64(col 1:decimal(11,5)/DECIMAL_64) -> decimal(11,5)/DECIMAL_64, VectorUDAFMinDecimal64(col 1:decimal(11,5)/DECIMAL_64) -> decimal(11,5)/DECIMAL_64, VectorUDAFSumDecimal64ToDecimal(col 1:decimal(11,5)/DECIMAL_64) -> decimal(21,5), VectorUDAFSumDouble(col 12:double) -> double, VectorUDAFSumDouble(col 7:double) -> double, VectorUDAFCount(col 2:decimal(16,0)/DECIMAL_64) -> bigint, VectorUDAFMaxDecimal64(col 2:decimal(16,0)/DECIMAL_64) -> decimal(16,0)/DECIMAL_64, VectorUDAFMinDecimal64(col 2:decimal(16,0)/DECIMAL_64) -> decimal(16,0)/DECIMAL_64, VectorUDAFSumDecimal64ToDecimal(col 2:decimal(16,0)/DECIMAL_64) -> decimal(26,0), VectorUDAFSumDouble(col 19:double) -> double, VectorUDAFSumDouble(col 14:double) -> double, VectorUDAFCountStar(*) -> bigint
+                          aggregators: VectorUDAFCount(col 1:decimal(11,5)/DECIMAL_64) -> bigint, VectorUDAFMaxDecimal64(col 1:decimal(11,5)/DECIMAL_64) -> decimal(11,5)/DECIMAL_64, VectorUDAFMinDecimal64(col 1:decimal(11,5)/DECIMAL_64) -> decimal(11,5)/DECIMAL_64, VectorUDAFSumDecimal64ToDecimal(col 1:decimal(11,5)/DECIMAL_64) -> decimal(21,5), VectorUDAFSumDouble(col 12:double) -> double, VectorUDAFSumDouble(col 7:double) -> double, VectorUDAFCount(col 7:double) -> bigint, VectorUDAFCount(col 2:decimal(16,0)/DECIMAL_64) -> bigint, VectorUDAFMaxDecimal64(col 2:decimal(16,0)/DECIMAL_64) -> decimal(16,0)/DECIMAL_64, VectorUDAFMinDecimal64(col 2:decimal(16,0)/DECIMAL_64) -> decimal(16,0)/DECIMAL_64, VectorUDAFSumDecimal64ToDecimal(col 2:decimal(16,0)/DECIMAL_64) -> decimal(26,0), VectorUDAFSumDouble(col 19:double) -> double, VectorUDAFSumDouble(col 14:double) -> double, VectorUDAFCount(col 14:double) -> bigint, VectorUDAFCountStar(*) -> bigint
                           className: VectorGroupByOperator
                           groupByMode: HASH
                           keyExpressions: col 3:int
                           native: false
                           vectorProcessingMode: HASH
-                          projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]
+                          projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
                       keys: _col0 (type: int)
                       minReductionHashAggr: 0.50321424
                       mode: hash
-                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13
-                      Statistics: Num rows: 6105 Data size: 4462672 Basic stats: COMPLETE Column stats: COMPLETE
+                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15
+                      Statistics: Num rows: 6105 Data size: 4560352 Basic stats: COMPLETE Column stats: COMPLETE
                       Reduce Output Operator
                         key expressions: _col0 (type: int)
                         null sort order: z
@@ -720,9 +720,9 @@ STAGE PLANS:
                             keyColumns: 0:int
                             native: true
                             nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
-                            valueColumns: 1:bigint, 2:decimal(11,5), 3:decimal(11,5), 4:decimal(21,5), 5:double, 6:double, 7:bigint, 8:decimal(16,0), 9:decimal(16,0), 10:decimal(26,0), 11:double, 12:double, 13:bigint
-                        Statistics: Num rows: 6105 Data size: 4462672 Basic stats: COMPLETE Column stats: COMPLETE
-                        value expressions: _col1 (type: bigint), _col2 (type: decimal(11,5)), _col3 (type: decimal(11,5)), _col4 (type: decimal(21,5)), _col5 (type: double), _col6 (type: double), _col7 (type: bigint), _col8 (type: decimal(16,0)), _col9 (type: decimal(16,0)), _col10 (type: decimal(26,0)), _col11 (type: double), _col12 (type: double), _col13 (type: bigint)
+                            valueColumns: 1:bigint, 2:decimal(11,5), 3:decimal(11,5), 4:decimal(21,5), 5:double, 6:double, 7:bigint, 8:bigint, 9:decimal(16,0), 10:decimal(16,0), 11:decimal(26,0), 12:double, 13:double, 14:bigint, 15:bigint
+                        Statistics: Num rows: 6105 Data size: 4560352 Basic stats: COMPLETE Column stats: COMPLETE
+                        value expressions: _col1 (type: bigint), _col2 (type: decimal(11,5)), _col3 (type: decimal(11,5)), _col4 (type: decimal(21,5)), _col5 (type: double), _col6 (type: double), _col7 (type: bigint), _col8 (type: bigint), _col9 (type: decimal(16,0)), _col10 (type: decimal(16,0)), _col11 (type: decimal(26,0)), _col12 (type: double), _col13 (type: double), _col14 (type: bigint), _col15 (type: bigint)
             Execution mode: vectorized, llap
             LLAP IO: all inputs
             Map Vectorization:
@@ -751,40 +751,40 @@ STAGE PLANS:
                 usesVectorUDFAdaptor: false
                 vectorized: true
                 rowBatchContext:
-                    dataColumnCount: 14
-                    dataColumns: KEY._col0:int, VALUE._col0:bigint, VALUE._col1:decimal(11,5)/DECIMAL_64, VALUE._col2:decimal(11,5)/DECIMAL_64, VALUE._col3:decimal(21,5), VALUE._col4:double, VALUE._col5:double, VALUE._col6:bigint, VALUE._col7:decimal(16,0)/DECIMAL_64, VALUE._col8:decimal(16,0)/DECIMAL_64, VALUE._col9:decimal(26,0), VALUE._col10:double, VALUE._col11:double, VALUE._col12:bigint
+                    dataColumnCount: 16
+                    dataColumns: KEY._col0:int, VALUE._col0:bigint, VALUE._col1:decimal(11,5)/DECIMAL_64, VALUE._col2:decimal(11,5)/DECIMAL_64, VALUE._col3:decimal(21,5), VALUE._col4:double, VALUE._col5:double, VALUE._col6:bigint, VALUE._col7:bigint, VALUE._col8:decimal(16,0)/DECIMAL_64, VALUE._col9:decimal(16,0)/DECIMAL_64, VALUE._col10:decimal(26,0), VALUE._col11:double, VALUE._col12:double, VALUE._col13:bigint, VALUE._col14:bigint
                     partitionColumnCount: 0
                     scratchColumnTypeNames: []
             Reduce Operator Tree:
               Group By Operator
-                aggregations: count(VALUE._col0), max(VALUE._col1), min(VALUE._col2), sum(VALUE._col3), sum(VALUE._col4), sum(VALUE._col5), count(VALUE._col6), max(VALUE._col7), min(VALUE._col8), sum(VALUE._col9), sum(VALUE._col10), sum(VALUE._col11), count(VALUE._col12)
+                aggregations: count(VALUE._col0), max(VALUE._col1), min(VALUE._col2), sum(VALUE._col3), sum(VALUE._col4), sum(VALUE._col5), count(VALUE._col6), count(VALUE._col7), max(VALUE._col8), min(VALUE._col9), sum(VALUE._col10), sum(VALUE._col11), sum(VALUE._col12), count(VALUE._col13), count(VALUE._col14)
                 Group By Vectorization:
-                    aggregators: VectorUDAFCountMerge(col 1:bigint) -> bigint, VectorUDAFMaxDecimal64(col 2:decimal(11,5)/DECIMAL_64) -> decimal(11,5)/DECIMAL_64, VectorUDAFMinDecimal64(col 3:decimal(11,5)/DECIMAL_64) -> decimal(11,5)/DECIMAL_64, VectorUDAFSumDecimal(col 4:decimal(21,5)) -> decimal(21,5), VectorUDAFSumDouble(col 5:double) -> double, VectorUDAFSumDouble(col 6:double) -> double, VectorUDAFCountMerge(col 7:bigint) -> bigint, VectorUDAFMaxDecimal64(col 8:decimal(16,0)/DECIMAL_64) -> decimal(16,0)/DECIMAL_64, VectorUDAFMinDecimal64(col 9:decimal(16,0)/DECIMAL_64) -> decimal(16,0)/DECIMAL_64, VectorUDAFSumDecimal(col 10:decimal(26,0)) -> decimal(26,0), VectorUDAFSumDouble(col 11:double) -> double, VectorUDAFSumDouble(col 12:double) -> double, VectorUDAFCountMerge(col 13:bigint) -> bigint
+                    aggregators: VectorUDAFCountMerge(col 1:bigint) -> bigint, VectorUDAFMaxDecimal64(col 2:decimal(11,5)/DECIMAL_64) -> decimal(11,5)/DECIMAL_64, VectorUDAFMinDecimal64(col 3:decimal(11,5)/DECIMAL_64) -> decimal(11,5)/DECIMAL_64, VectorUDAFSumDecimal(col 4:decimal(21,5)) -> decimal(21,5), VectorUDAFSumDouble(col 5:double) -> double, VectorUDAFSumDouble(col 6:double) -> double, VectorUDAFCountMerge(col 7:bigint) -> bigint, VectorUDAFCountMerge(col 8:bigint) -> bigint, VectorUDAFMaxDecimal64(col 9:decimal(16,0)/DECIMAL_64) -> decimal(16,0)/DECIMAL_64, VectorUDAFMinDecimal64(col 10:decimal(16,0)/DECIMAL_64) -> decimal(16,0)/DECIMAL_64, VectorUDAFSumDecimal(col 11:decimal(26,0)) -> decimal(26,0), VectorUDAFSumDouble(col 12:double) -> double, VectorUDAFSumDouble(col 13:double) -> double, VectorUDAFCountMerge(col 14:bigint) -> bigint, VectorUDAFCountMerge(col 15:bigint) -> bigint
                     className: VectorGroupByOperator
                     groupByMode: MERGEPARTIAL
                     keyExpressions: col 0:int
                     native: false
                     vectorProcessingMode: MERGE_PARTIAL
-                    projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]
+                    projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
                 keys: KEY._col0 (type: int)
                 mode: mergepartial
-                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13
-                Statistics: Num rows: 6105 Data size: 4462672 Basic stats: COMPLETE Column stats: COMPLETE
+                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15
+                Statistics: Num rows: 6105 Data size: 4560352 Basic stats: COMPLETE Column stats: COMPLETE
                 Filter Operator
                   Filter Vectorization:
                       className: VectorFilterOperator
                       native: true
-                      predicateExpression: FilterLongColGreaterLongScalar(col 13:bigint, val 1)
-                  predicate: (_col13 > 1L) (type: boolean)
-                  Statistics: Num rows: 2035 Data size: 1487560 Basic stats: COMPLETE Column stats: COMPLETE
+                      predicateExpression: FilterLongColGreaterLongScalar(col 15:bigint, val 1)
+                  predicate: (_col15 > 1L) (type: boolean)
+                  Statistics: Num rows: 2035 Data size: 1520120 Basic stats: COMPLETE Column stats: COMPLETE
                   Select Operator
-                    expressions: _col0 (type: int), _col1 (type: bigint), _col2 (type: decimal(11,5)), _col3 (type: decimal(11,5)), _col4 (type: decimal(21,5)), CAST( (_col4 / _col1) AS decimal(15,9)) (type: decimal(15,9)), power(((_col5 - ((_col6 * _col6) / _col1)) / _col1), 0.5) (type: double), power(((_col5 - ((_col6 * _col6) / _col1)) / if((_col1 = 1L), null, (_col1 - 1))), 0.5) (type: double), _col7 (type: bigint), _col8 (type: decimal(16,0)), _col9 (type: decimal(16,0)), _col10 (type: decimal(26,0)), CAST( (_col10 / _col7) AS decimal(20,4)) (type: decimal(20,4)), power(((_col11 - ((_col12 * _col12) / _col7)) / _col7), 0.5) (type: double), power(((_col11 - ((_col12 * _col12) / _col7)) / if((_col7 = 1L), null, (_col7 - 1))), 0.5) (type: double)
+                    expressions: _col0 (type: int), _col1 (type: bigint), _col2 (type: decimal(11,5)), _col3 (type: decimal(11,5)), _col4 (type: decimal(21,5)), CAST( (_col4 / _col1) AS decimal(15,9)) (type: decimal(15,9)), power(((_col5 - ((_col6 * _col6) / _col7)) / _col7), 0.5) (type: double), power(((_col5 - ((_col6 * _col6) / _col7)) / if((_col7 = 1L), null, (_col7 - 1))), 0.5) (type: double), _col8 (type: bigint), _col9 (type: decimal(16,0)), _col10 (type: decimal(16,0)), _col11 (type: decimal(26,0)), CAST( (_col11 / _col8) AS decimal(20,4)) (type: decimal(20,4)), power(((_col12 - ((_col13 * _col13) / _col14)) / _col14), 0.5) (type: double), power(((_col12 - ((_col13 * _col13) / _col14)) / if((_col14 = 1L), null, (_col14 - 1))), 0.5) (type: double)
                     outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14
                     Select Vectorization:
                         className: VectorSelectOperator
                         native: true
-                        projectedOutputColumnNums: [0, 1, 2, 3, 4, 16, 21, 29, 7, 8, 9, 10, 32, 37, 45]
-                        selectExpressions: CastDecimalToDecimal(col 15:decimal(38,22))(children: DecimalColDivideDecimalColumn(col 4:decimal(21,5), col 14:decimal(19,0))(children: CastLongToDecimal(col 1:bigint) -> 14:decimal(19,0)) -> 15:decimal(38,22)) -> 16:decimal(15,9), FuncPowerDoubleToDouble(col 20:double)(children: DoubleColDivideLongColumn(col 19:double, col 1:bigint)(children: DoubleColSubtractDoubleColumn(col 5:double, col 18:double)(children: DoubleColDivideLongColumn(col 17:double, col 1:bigint)(children: DoubleColMultiplyDoubleColumn(col 6:double, col 6:double) -> 17:double) -> 18:double) -> 19:double) -> 20:double) -> 21:double, FuncPowerDoubleToDouble(col 28:double)(children: DoubleColDivideLongColumn(col 24:double, col 27:bigint)(children: DoubleColSubtractDoubleColumn(col 5:double, col 23:double)(children: DoubleColDivideLongColumn(col 22:double, col 1:bigint)(children: DoubleColMultiplyDoubleColumn(col 6:double, col 6:double) -> 22:double) -> 23:double) -> 24:double, IfExprNullCondExpr(col 25:boolean, null, col 26:bigint)(children: LongColEqualLongScalar(col 1:bigint, val 1) -> 25:boolean, LongColSubtractLongScalar(col 1:bigint, val 1) -> 26:bigint) -> 27:bigint) -> 28:double) -> 29:double, CastDecimalToDecimal(col 31:decimal(38,12))(children: DecimalColDivideDecimalColumn(col 10:decimal(26,0), col 30:decimal(19,0))(children: CastLongToDecimal(col 7:bigint) -> 30:decimal(19,0)) -> 31:decimal(38,12)) -> 32:decimal(20,4), FuncPowerDoubleToDouble(col 36:double)(children: DoubleColDivideLongColumn(col 35:double, col 7:bigint)(children: DoubleColSubtractDoubleColumn(col 11:double, col 34:double)(children: DoubleColDivideLongColumn(col 33:double, col 7:bigint)(children: DoubleColMultiplyDoubleColumn(col 12:double, col 12:double) -> 33:double) -> 34:double) -> 35:double) -> 36:double) -> 37:double, FuncPowerDoubleToDouble(col 44:double)(children: DoubleColDivideLongColumn(col 40:double, col 43:bigint)(children: DoubleColSubtractDoubleColumn(col 11:double, col 39:double)(children: DoubleColDivideLongColumn(col 38:double, col 7:bigint)(children: DoubleColMultiplyDoubleColumn(col 12:double, col 12:double) -> 38:double) -> 39:double) -> 40:double, IfExprNullCondExpr(col 41:boolean, null, col 42:bigint)(children: LongColEqualLongScalar(col 7:bigint, val 1) -> 41:boolean, LongColSubtractLongScalar(col 7:bigint, val 1) -> 42:bigint) -> 43:bigint) -> 44:double) -> 45:double
+                        projectedOutputColumnNums: [0, 1, 2, 3, 4, 18, 23, 31, 8, 9, 10, 11, 34, 39, 47]
+                        selectExpressions: CastDecimalToDecimal(col 17:decimal(38,22))(children: DecimalColDivideDecimalColumn(col 4:decimal(21,5), col 16:decimal(19,0))(children: CastLongToDecimal(col 1:bigint) -> 16:decimal(19,0)) -> 17:decimal(38,22)) -> 18:decimal(15,9), FuncPowerDoubleToDouble(col 22:double)(children: DoubleColDivideLongColumn(col 21:double, col 7:bigint)(children: DoubleColSubtractDoubleColumn(col 5:double, col 20:double)(children: DoubleColDivideLongColumn(col 19:double, col 7:bigint)(children: DoubleColMultiplyDoubleColumn(col 6:double, col 6:double) -> 19:double) -> 20:double) -> 21:double) -> 22:double) -> 23:double, FuncPowerDoubleToDouble(col 30:double)(children: DoubleColDivideLongColumn(col 26:double, col 29:bigint)(children: DoubleColSubtractDoubleColumn(col 5:double, col 25:double)(children: DoubleColDivideLongColumn(col 24:double, col 7:bigint)(children: DoubleColMultiplyDoubleColumn(col 6:double, col 6:double) -> 24:double) -> 25:double) -> 26:double, IfExprNullCondExpr(col 27:boolean, null, col 28:bigint)(children: LongColEqualLongScalar(col 7:bigint, val 1) -> 27:boolean, LongColSubtractLongScalar(col 7:bigint, val 1) -> 28:bigint) -> 29:bigint) -> 30:double) -> 31:double, CastDecimalToDecimal(col 33:decimal(38,12))(children: DecimalColDivideDecimalColumn(col 11:decimal(26,0), col 32:decimal(19,0))(children: CastLongToDecimal(col 8:bigint) -> 32:decimal(19,0)) -> 33:decimal(38,12)) -> 34:decimal(20,4), FuncPowerDoubleToDouble(col 38:double)(children: DoubleColDivideLongColumn(col 37:double, col 14:bigint)(children: DoubleColSubtractDoubleColumn(col 12:double, col 36:double)(children: DoubleColDivideLongColumn(col 35:double, col 14:bigint)(children: DoubleColMultiplyDoubleColumn(col 13:double, col 13:double) -> 35:double) -> 36:double) -> 37:double) -> 38:double) -> 39:double, FuncPowerDoubleToDouble(col 46:double)(children: DoubleColDivideLongColumn(col 42:double, col 45:bigint)(children: DoubleColSubtractDoubleColumn(col 12:double, col 41:double)(children: DoubleColDivideLongColumn(col 40:double, col 14:bigint)(children: DoubleColMultiplyDoubleColumn(col 13:double, col 13:double) -> 40:double) -> 41:double) -> 42:double, IfExprNullCondExpr(col 43:boolean, null, col 44:bigint)(children: LongColEqualLongScalar(col 14:bigint, val 1) -> 43:boolean, LongColSubtractLongScalar(col 14:bigint, val 1) -> 44:bigint) -> 45:bigint) -> 46:double) -> 47:double
                     Statistics: Num rows: 2035 Data size: 1927120 Basic stats: COMPLETE Column stats: COMPLETE
                     File Output Operator
                       compressed: false
diff --git a/ql/src/test/results/clientpositive/llap/vector_decimal_udf.q.out b/ql/src/test/results/clientpositive/llap/vector_decimal_udf.q.out
index c890c36301..fcc5a1005c 100644
--- a/ql/src/test/results/clientpositive/llap/vector_decimal_udf.q.out
+++ b/ql/src/test/results/clientpositive/llap/vector_decimal_udf.q.out
@@ -3352,18 +3352,18 @@ STAGE PLANS:
                       native: true
                       vectorizationSchemaColumns: [0:key:decimal(20,10), 1:value:int, 2:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 3:ROW__IS__DELETED:boolean]
                   Select Operator
-                    expressions: value (type: int), key (type: decimal(20,10)), UDFToDouble(key) (type: double), (UDFToDouble(key) * UDFToDouble(key)) (type: double)
-                    outputColumnNames: _col0, _col1, _col2, _col3
+                    expressions: value (type: int), UDFToDouble(key) (type: double), (UDFToDouble(key) * UDFToDouble(key)) (type: double)
+                    outputColumnNames: _col0, _col1, _col2
                     Select Vectorization:
                         className: VectorSelectOperator
                         native: true
-                        projectedOutputColumnNums: [1, 0, 4, 7]
+                        projectedOutputColumnNums: [1, 4, 7]
                         selectExpressions: CastDecimalToDouble(col 0:decimal(20,10)) -> 4:double, DoubleColMultiplyDoubleColumn(col 5:double, col 6:double)(children: CastDecimalToDouble(col 0:decimal(20,10)) -> 5:double, CastDecimalToDouble(col 0:decimal(20,10)) -> 6:double) -> 7:double
                     Statistics: Num rows: 39 Data size: 4412 Basic stats: COMPLETE Column stats: COMPLETE
                     Group By Operator
-                      aggregations: sum(_col3), sum(_col2), count(_col1)
+                      aggregations: sum(_col2), sum(_col1), count(_col1)
                       Group By Vectorization:
-                          aggregators: VectorUDAFSumDouble(col 7:double) -> double, VectorUDAFSumDouble(col 4:double) -> double, VectorUDAFCount(col 0:decimal(20,10)) -> bigint
+                          aggregators: VectorUDAFSumDouble(col 7:double) -> double, VectorUDAFSumDouble(col 4:double) -> double, VectorUDAFCount(col 4:double) -> bigint
                           className: VectorGroupByOperator
                           groupByMode: HASH
                           keyExpressions: col 1:int
@@ -3522,18 +3522,18 @@ STAGE PLANS:
                       native: true
                       vectorizationSchemaColumns: [0:key:decimal(20,10), 1:value:int, 2:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 3:ROW__IS__DELETED:boolean]
                   Select Operator
-                    expressions: value (type: int), key (type: decimal(20,10)), UDFToDouble(key) (type: double), (UDFToDouble(key) * UDFToDouble(key)) (type: double)
-                    outputColumnNames: _col0, _col1, _col2, _col3
+                    expressions: value (type: int), UDFToDouble(key) (type: double), (UDFToDouble(key) * UDFToDouble(key)) (type: double)
+                    outputColumnNames: _col0, _col1, _col2
                     Select Vectorization:
                         className: VectorSelectOperator
                         native: true
-                        projectedOutputColumnNums: [1, 0, 4, 7]
+                        projectedOutputColumnNums: [1, 4, 7]
                         selectExpressions: CastDecimalToDouble(col 0:decimal(20,10)) -> 4:double, DoubleColMultiplyDoubleColumn(col 5:double, col 6:double)(children: CastDecimalToDouble(col 0:decimal(20,10)) -> 5:double, CastDecimalToDouble(col 0:decimal(20,10)) -> 6:double) -> 7:double
                     Statistics: Num rows: 39 Data size: 4412 Basic stats: COMPLETE Column stats: COMPLETE
                     Group By Operator
-                      aggregations: sum(_col3), sum(_col2), count(_col1)
+                      aggregations: sum(_col2), sum(_col1), count(_col1)
                       Group By Vectorization:
-                          aggregators: VectorUDAFSumDouble(col 7:double) -> double, VectorUDAFSumDouble(col 4:double) -> double, VectorUDAFCount(col 0:decimal(20,10)) -> bigint
+                          aggregators: VectorUDAFSumDouble(col 7:double) -> double, VectorUDAFSumDouble(col 4:double) -> double, VectorUDAFCount(col 4:double) -> bigint
                           className: VectorGroupByOperator
                           groupByMode: HASH
                           keyExpressions: col 1:int
@@ -7477,18 +7477,18 @@ STAGE PLANS:
                       native: true
                       vectorizationSchemaColumns: [0:key:decimal(15,3)/DECIMAL_64, 1:value:int, 2:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 3:ROW__IS__DELETED:boolean]
                   Select Operator
-                    expressions: value (type: int), key (type: decimal(15,3)), UDFToDouble(key) (type: double), (UDFToDouble(key) * UDFToDouble(key)) (type: double)
-                    outputColumnNames: _col0, _col1, _col2, _col3
+                    expressions: value (type: int), UDFToDouble(key) (type: double), (UDFToDouble(key) * UDFToDouble(key)) (type: double)
+                    outputColumnNames: _col0, _col1, _col2
                     Select Vectorization:
                         className: VectorSelectOperator
                         native: true
-                        projectedOutputColumnNums: [1, 0, 5, 10]
+                        projectedOutputColumnNums: [1, 5, 10]
                         selectExpressions: CastDecimalToDouble(col 4:decimal(15,3))(children: ConvertDecimal64ToDecimal(col 0:decimal(15,3)/DECIMAL_64) -> 4:decimal(15,3)) -> 5:double, DoubleColMultiplyDoubleColumn(col 7:double, col 9:double)(children: CastDecimalToDouble(col 6:decimal(15,3))(children: ConvertDecimal64ToDecimal(col 0:decimal(15,3)/DECIMAL_64) -> 6:decimal(15,3)) -> 7:double, CastDecimalToDouble(col 8:decimal(15,3))(children: ConvertDecimal64ToDecimal(col 0:decimal(15,3)/DECIMAL_64) -> 8:decimal(15,3)) -> 9:double) -> 10:double
                     Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: NONE
                     Group By Operator
-                      aggregations: sum(_col3), sum(_col2), count(_col1)
+                      aggregations: sum(_col2), sum(_col1), count(_col1)
                       Group By Vectorization:
-                          aggregators: VectorUDAFSumDouble(col 10:double) -> double, VectorUDAFSumDouble(col 5:double) -> double, VectorUDAFCount(col 0:decimal(15,3)/DECIMAL_64) -> bigint
+                          aggregators: VectorUDAFSumDouble(col 10:double) -> double, VectorUDAFSumDouble(col 5:double) -> double, VectorUDAFCount(col 5:double) -> bigint
                           className: VectorGroupByOperator
                           groupByMode: HASH
                           keyExpressions: col 1:int
@@ -7647,18 +7647,18 @@ STAGE PLANS:
                       native: true
                       vectorizationSchemaColumns: [0:key:decimal(15,3)/DECIMAL_64, 1:value:int, 2:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 3:ROW__IS__DELETED:boolean]
                   Select Operator
-                    expressions: value (type: int), key (type: decimal(15,3)), UDFToDouble(key) (type: double), (UDFToDouble(key) * UDFToDouble(key)) (type: double)
-                    outputColumnNames: _col0, _col1, _col2, _col3
+                    expressions: value (type: int), UDFToDouble(key) (type: double), (UDFToDouble(key) * UDFToDouble(key)) (type: double)
+                    outputColumnNames: _col0, _col1, _col2
                     Select Vectorization:
                         className: VectorSelectOperator
                         native: true
-                        projectedOutputColumnNums: [1, 0, 5, 10]
+                        projectedOutputColumnNums: [1, 5, 10]
                         selectExpressions: CastDecimalToDouble(col 4:decimal(15,3))(children: ConvertDecimal64ToDecimal(col 0:decimal(15,3)/DECIMAL_64) -> 4:decimal(15,3)) -> 5:double, DoubleColMultiplyDoubleColumn(col 7:double, col 9:double)(children: CastDecimalToDouble(col 6:decimal(15,3))(children: ConvertDecimal64ToDecimal(col 0:decimal(15,3)/DECIMAL_64) -> 6:decimal(15,3)) -> 7:double, CastDecimalToDouble(col 8:decimal(15,3))(children: ConvertDecimal64ToDecimal(col 0:decimal(15,3)/DECIMAL_64) -> 8:decimal(15,3)) -> 9:double) -> 10:double
                     Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: NONE
                     Group By Operator
-                      aggregations: sum(_col3), sum(_col2), count(_col1)
+                      aggregations: sum(_col2), sum(_col1), count(_col1)
                       Group By Vectorization:
-                          aggregators: VectorUDAFSumDouble(col 10:double) -> double, VectorUDAFSumDouble(col 5:double) -> double, VectorUDAFCount(col 0:decimal(15,3)/DECIMAL_64) -> bigint
+                          aggregators: VectorUDAFSumDouble(col 10:double) -> double, VectorUDAFSumDouble(col 5:double) -> double, VectorUDAFCount(col 5:double) -> bigint
                           className: VectorGroupByOperator
                           groupByMode: HASH
                           keyExpressions: col 1:int
diff --git a/ql/src/test/results/clientpositive/llap/vector_groupby_grouping_sets3.q.out b/ql/src/test/results/clientpositive/llap/vector_groupby_grouping_sets3.q.out
index a3b784e2fa..2d6b9fcc13 100644
--- a/ql/src/test/results/clientpositive/llap/vector_groupby_grouping_sets3.q.out
+++ b/ql/src/test/results/clientpositive/llap/vector_groupby_grouping_sets3.q.out
@@ -68,13 +68,29 @@ STAGE PLANS:
                 TableScan
                   alias: t1_n106
                   Statistics: Num rows: 12 Data size: 3060 Basic stats: COMPLETE Column stats: COMPLETE
+                  TableScan Vectorization:
+                      native: true
+                      vectorizationSchemaColumns: [0:a:string, 1:b:string, 2:c:string, 3:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 4:ROW__IS__DELETED:boolean]
                   Select Operator
-                    expressions: a (type: string), b (type: string), c (type: string)
-                    outputColumnNames: a, b, c
+                    expressions: a (type: string), b (type: string), UDFToDouble(c) (type: double)
+                    outputColumnNames: _col0, _col1, _col2
+                    Select Vectorization:
+                        className: VectorSelectOperator
+                        native: true
+                        projectedOutputColumnNums: [0, 1, 5]
+                        selectExpressions: CastStringToDouble(col 2:string) -> 5:double
                     Statistics: Num rows: 12 Data size: 3060 Basic stats: COMPLETE Column stats: COMPLETE
                     Group By Operator
-                      aggregations: sum(c), count(c), count()
-                      keys: a (type: string), b (type: string), 0L (type: bigint)
+                      aggregations: sum(_col2), count(_col2), count()
+                      Group By Vectorization:
+                          aggregators: VectorUDAFSumDouble(col 5:double) -> double, VectorUDAFCount(col 5:double) -> bigint, VectorUDAFCountStar(*) -> bigint
+                          className: VectorGroupByOperator
+                          groupByMode: HASH
+                          keyExpressions: col 0:string, col 1:string, ConstantVectorExpression(val 0) -> 6:bigint
+                          native: false
+                          vectorProcessingMode: HASH
+                          projectedOutputColumnNums: [0, 1, 2]
+                      keys: _col0 (type: string), _col1 (type: string), 0L (type: bigint)
                       grouping sets: 0, 1, 2, 3
                       minReductionHashAggr: 0.4
                       mode: hash
@@ -85,16 +101,31 @@ STAGE PLANS:
                         null sort order: zzz
                         sort order: +++
                         Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: bigint)
+                        Reduce Sink Vectorization:
+                            className: VectorReduceSinkMultiKeyOperator
+                            keyColumns: 0:string, 1:string, 2:bigint
+                            native: true
+                            nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
+                            valueColumns: 3:double, 4:bigint, 5:bigint
                         Statistics: Num rows: 24 Data size: 4848 Basic stats: COMPLETE Column stats: COMPLETE
                         value expressions: _col3 (type: double), _col4 (type: bigint), _col5 (type: bigint)
-            Execution mode: llap
+            Execution mode: vectorized, llap
             LLAP IO: all inputs
             Map Vectorization:
                 enabled: true
                 enabledConditionsMet: hive.vectorized.use.vectorized.input.format IS true
+                inputFormatFeatureSupport: [DECIMAL_64]
+                featureSupportInUse: [DECIMAL_64]
                 inputFileFormats: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
-                notVectorizedReason: GROUPBY operator: Vector aggregation : "sum" for input type: "BYTES" and output type: "DOUBLE" and mode: PARTIAL1 not supported for evaluator GenericUDAFSumDouble
-                vectorized: false
+                allNative: false
+                usesVectorUDFAdaptor: false
+                vectorized: true
+                rowBatchContext:
+                    dataColumnCount: 3
+                    includeColumns: [0, 1, 2]
+                    dataColumns: a:string, b:string, c:string
+                    partitionColumnCount: 0
+                    scratchColumnTypeNames: [double, bigint]
         Reducer 2 
             Execution mode: vectorized, llap
             Reduce Vectorization:
@@ -184,13 +215,29 @@ STAGE PLANS:
                 TableScan
                   alias: t1_n106
                   Statistics: Num rows: 12 Data size: 3060 Basic stats: COMPLETE Column stats: COMPLETE
+                  TableScan Vectorization:
+                      native: true
+                      vectorizationSchemaColumns: [0:a:string, 1:b:string, 2:c:string, 3:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 4:ROW__IS__DELETED:boolean]
                   Select Operator
-                    expressions: a (type: string), b (type: string), c (type: string)
-                    outputColumnNames: a, b, c
+                    expressions: a (type: string), b (type: string), UDFToDouble(c) (type: double)
+                    outputColumnNames: _col0, _col1, _col2
+                    Select Vectorization:
+                        className: VectorSelectOperator
+                        native: true
+                        projectedOutputColumnNums: [0, 1, 5]
+                        selectExpressions: CastStringToDouble(col 2:string) -> 5:double
                     Statistics: Num rows: 12 Data size: 3060 Basic stats: COMPLETE Column stats: COMPLETE
                     Group By Operator
-                      aggregations: sum(c), count(c), count()
-                      keys: a (type: string), b (type: string), 0L (type: bigint)
+                      aggregations: sum(_col2), count(_col2), count()
+                      Group By Vectorization:
+                          aggregators: VectorUDAFSumDouble(col 5:double) -> double, VectorUDAFCount(col 5:double) -> bigint, VectorUDAFCountStar(*) -> bigint
+                          className: VectorGroupByOperator
+                          groupByMode: HASH
+                          keyExpressions: col 0:string, col 1:string, ConstantVectorExpression(val 0) -> 6:bigint
+                          native: false
+                          vectorProcessingMode: HASH
+                          projectedOutputColumnNums: [0, 1, 2]
+                      keys: _col0 (type: string), _col1 (type: string), 0L (type: bigint)
                       grouping sets: 0, 1, 2, 3
                       minReductionHashAggr: 0.4
                       mode: hash
@@ -201,16 +248,31 @@ STAGE PLANS:
                         null sort order: zzz
                         sort order: +++
                         Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: bigint)
+                        Reduce Sink Vectorization:
+                            className: VectorReduceSinkMultiKeyOperator
+                            keyColumns: 0:string, 1:string, 2:bigint
+                            native: true
+                            nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
+                            valueColumns: 3:double, 4:bigint, 5:bigint
                         Statistics: Num rows: 24 Data size: 4848 Basic stats: COMPLETE Column stats: COMPLETE
                         value expressions: _col3 (type: double), _col4 (type: bigint), _col5 (type: bigint)
-            Execution mode: llap
+            Execution mode: vectorized, llap
             LLAP IO: all inputs
             Map Vectorization:
                 enabled: true
                 enabledConditionsMet: hive.vectorized.use.vectorized.input.format IS true
+                inputFormatFeatureSupport: [DECIMAL_64]
+                featureSupportInUse: [DECIMAL_64]
                 inputFileFormats: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
-                notVectorizedReason: GROUPBY operator: Vector aggregation : "sum" for input type: "BYTES" and output type: "DOUBLE" and mode: PARTIAL1 not supported for evaluator GenericUDAFSumDouble
-                vectorized: false
+                allNative: false
+                usesVectorUDFAdaptor: false
+                vectorized: true
+                rowBatchContext:
+                    dataColumnCount: 3
+                    includeColumns: [0, 1, 2]
+                    dataColumns: a:string, b:string, c:string
+                    partitionColumnCount: 0
+                    scratchColumnTypeNames: [double, bigint]
         Reducer 2 
             Execution mode: vectorized, llap
             Reduce Vectorization:
@@ -326,13 +388,29 @@ STAGE PLANS:
                 TableScan
                   alias: t1_n106
                   Statistics: Num rows: 12 Data size: 3060 Basic stats: COMPLETE Column stats: COMPLETE
+                  TableScan Vectorization:
+                      native: true
+                      vectorizationSchemaColumns: [0:a:string, 1:b:string, 2:c:string, 3:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 4:ROW__IS__DELETED:boolean]
                   Select Operator
-                    expressions: a (type: string), b (type: string), c (type: string)
-                    outputColumnNames: a, b, c
+                    expressions: a (type: string), b (type: string), UDFToDouble(c) (type: double)
+                    outputColumnNames: _col0, _col1, _col2
+                    Select Vectorization:
+                        className: VectorSelectOperator
+                        native: true
+                        projectedOutputColumnNums: [0, 1, 5]
+                        selectExpressions: CastStringToDouble(col 2:string) -> 5:double
                     Statistics: Num rows: 12 Data size: 3060 Basic stats: COMPLETE Column stats: COMPLETE
                     Group By Operator
-                      aggregations: sum(c), count(c), count()
-                      keys: a (type: string), b (type: string)
+                      aggregations: sum(_col2), count(_col2), count()
+                      Group By Vectorization:
+                          aggregators: VectorUDAFSumDouble(col 5:double) -> double, VectorUDAFCount(col 5:double) -> bigint, VectorUDAFCountStar(*) -> bigint
+                          className: VectorGroupByOperator
+                          groupByMode: HASH
+                          keyExpressions: col 0:string, col 1:string
+                          native: false
+                          vectorProcessingMode: HASH
+                          projectedOutputColumnNums: [0, 1, 2]
+                      keys: _col0 (type: string), _col1 (type: string)
                       minReductionHashAggr: 0.4
                       mode: hash
                       outputColumnNames: _col0, _col1, _col2, _col3, _col4
@@ -342,16 +420,31 @@ STAGE PLANS:
                         null sort order: zz
                         sort order: ++
                         Map-reduce partition columns: _col0 (type: string), _col1 (type: string)
+                        Reduce Sink Vectorization:
+                            className: VectorReduceSinkMultiKeyOperator
+                            keyColumns: 0:string, 1:string
+                            native: true
+                            nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
+                            valueColumns: 2:double, 3:bigint, 4:bigint
                         Statistics: Num rows: 6 Data size: 1164 Basic stats: COMPLETE Column stats: COMPLETE
                         value expressions: _col2 (type: double), _col3 (type: bigint), _col4 (type: bigint)
-            Execution mode: llap
+            Execution mode: vectorized, llap
             LLAP IO: all inputs
             Map Vectorization:
                 enabled: true
                 enabledConditionsMet: hive.vectorized.use.vectorized.input.format IS true
+                inputFormatFeatureSupport: [DECIMAL_64]
+                featureSupportInUse: [DECIMAL_64]
                 inputFileFormats: org.apache.hadoop.hive.ql.io.orc.OrcInputFormat
-                notVectorizedReason: GROUPBY operator: Vector aggregation : "sum" for input type: "BYTES" and output type: "DOUBLE" and mode: PARTIAL1 not supported for evaluator GenericUDAFSumDouble
-                vectorized: false
+                allNative: false
+                usesVectorUDFAdaptor: false
+                vectorized: true
+                rowBatchContext:
+                    dataColumnCount: 3
+                    includeColumns: [0, 1, 2]
+                    dataColumns: a:string, b:string, c:string
+                    partitionColumnCount: 0
+                    scratchColumnTypeNames: [double]
         Reducer 2 
             Execution mode: vectorized, llap
             Reduce Vectorization:
diff --git a/ql/src/test/results/clientpositive/llap/vector_reuse_scratchcols.q.out b/ql/src/test/results/clientpositive/llap/vector_reuse_scratchcols.q.out
index 64291a9b0f..f48b6cf917 100644
--- a/ql/src/test/results/clientpositive/llap/vector_reuse_scratchcols.q.out
+++ b/ql/src/test/results/clientpositive/llap/vector_reuse_scratchcols.q.out
@@ -118,18 +118,18 @@ STAGE PLANS:
                           selectExpressions: CastLongToDouble(col 2:int) -> 19:double, DoubleColMultiplyDoubleColumn(col 20:double, col 21:double)(children: CastLongToDouble(col 2:int) -> 20:double, CastLongToDouble(col 2:int) -> 21:double) -> 22:double, CastLongToDouble(col 1:smallint) -> 23:double, DoubleColMultiplyDoubleColumn(col 24:double, col 25:double)(children: CastLongToDouble(col 1:smallint) -> 24:double, CastLongToDouble(col 1:smallint) -> 25:double) -> 26:double
                       Statistics: Num rows: 5465 Data size: 1101870 Basic stats: COMPLETE Column stats: COMPLETE
                       Group By Operator
-                        aggregations: sum(_col0), count(_col0), sum(_col1), sum(_col6), sum(_col5), sum(_col8), sum(_col7), count(_col2), sum(_col3), count(_col3), min(_col4)
+                        aggregations: sum(_col0), count(_col0), sum(_col1), sum(_col6), sum(_col5), count(_col5), sum(_col8), sum(_col7), count(_col7), sum(_col3), count(_col3), min(_col4), count(_col2)
                         Group By Vectorization:
-                            aggregators: VectorUDAFSumLong(col 2:int) -> bigint, VectorUDAFCount(col 2:int) -> bigint, VectorUDAFSumDouble(col 5:double) -> double, VectorUDAFSumDouble(col 22:double) -> double, VectorUDAFSumDouble(col 19:double) -> double, VectorUDAFSumDouble(col 26:double) -> double, VectorUDAFSumDouble(col 23:double) -> double, VectorUDAFCount(col 1:smallint) -> bigint, VectorUDAFSumDouble(col 4:float) -> double, VectorUDAFCount(col 4:float) -> bigint, VectorUDAFMinLong(col 0:tinyint) -> tinyint
+                            aggregators: VectorUDAFSumLong(col 2:int) -> bigint, VectorUDAFCount(col 2:int) -> bigint, VectorUDAFSumDouble(col 5:double) -> double, VectorUDAFSumDouble(col 22:double) -> double, VectorUDAFSumDouble(col 19:double) -> double, VectorUDAFCount(col 19:double) -> bigint, VectorUDAFSumDouble(col 26:double) -> double, VectorUDAFSumDouble(col 23:double) -> double, VectorUDAFCount(col 23:double) -> bigint, VectorUDAFSumDouble(col 4:float) -> double, VectorUDAFCount(col 4:float) -> bigint, VectorUDAFMinLong(col 0:tinyint) -> tinyint, VectorUDAFCount(col 1:smallint) -> bigint
                             className: VectorGroupByOperator
                             groupByMode: HASH
                             native: false
                             vectorProcessingMode: HASH
-                            projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
+                            projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]
                         minReductionHashAggr: 0.99
                         mode: hash
-                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
-                        Statistics: Num rows: 1 Data size: 84 Basic stats: COMPLETE Column stats: COMPLETE
+                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12
+                        Statistics: Num rows: 1 Data size: 100 Basic stats: COMPLETE Column stats: COMPLETE
                         Reduce Output Operator
                           null sort order: 
                           sort order: 
@@ -137,9 +137,9 @@ STAGE PLANS:
                               className: VectorReduceSinkEmptyKeyOperator
                               native: true
                               nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
-                              valueColumns: 0:bigint, 1:bigint, 2:double, 3:double, 4:double, 5:double, 6:double, 7:bigint, 8:double, 9:bigint, 10:tinyint
-                          Statistics: Num rows: 1 Data size: 84 Basic stats: COMPLETE Column stats: COMPLETE
-                          value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: double), _col3 (type: double), _col4 (type: double), _col5 (type: double), _col6 (type: double), _col7 (type: bigint), _col8 (type: double), _col9 (type: bigint), _col10 (type: tinyint)
+                              valueColumns: 0:bigint, 1:bigint, 2:double, 3:double, 4:double, 5:bigint, 6:double, 7:double, 8:bigint, 9:double, 10:bigint, 11:tinyint, 12:bigint
+                          Statistics: Num rows: 1 Data size: 100 Basic stats: COMPLETE Column stats: COMPLETE
+                          value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: double), _col3 (type: double), _col4 (type: double), _col5 (type: bigint), _col6 (type: double), _col7 (type: double), _col8 (type: bigint), _col9 (type: double), _col10 (type: bigint), _col11 (type: tinyint), _col12 (type: bigint)
             Execution mode: vectorized, llap
             LLAP IO: all inputs
             Map Vectorization:
@@ -168,31 +168,31 @@ STAGE PLANS:
                 usesVectorUDFAdaptor: false
                 vectorized: true
                 rowBatchContext:
-                    dataColumnCount: 11
-                    dataColumns: VALUE._col0:bigint, VALUE._col1:bigint, VALUE._col2:double, VALUE._col3:double, VALUE._col4:double, VALUE._col5:double, VALUE._col6:double, VALUE._col7:bigint, VALUE._col8:double, VALUE._col9:bigint, VALUE._col10:tinyint
+                    dataColumnCount: 13
+                    dataColumns: VALUE._col0:bigint, VALUE._col1:bigint, VALUE._col2:double, VALUE._col3:double, VALUE._col4:double, VALUE._col5:bigint, VALUE._col6:double, VALUE._col7:double, VALUE._col8:bigint, VALUE._col9:double, VALUE._col10:bigint, VALUE._col11:tinyint, VALUE._col12:bigint
                     partitionColumnCount: 0
                     scratchColumnTypeNames: []
             Reduce Operator Tree:
               Group By Operator
-                aggregations: sum(VALUE._col0), count(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3), sum(VALUE._col4), sum(VALUE._col5), sum(VALUE._col6), count(VALUE._col7), sum(VALUE._col8), count(VALUE._col9), min(VALUE._col10)
+                aggregations: sum(VALUE._col0), count(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3), sum(VALUE._col4), count(VALUE._col5), sum(VALUE._col6), sum(VALUE._col7), count(VALUE._col8), sum(VALUE._col9), count(VALUE._col10), min(VALUE._col11), count(VALUE._col12)
                 Group By Vectorization:
-                    aggregators: VectorUDAFSumLong(col 0:bigint) -> bigint, VectorUDAFCountMerge(col 1:bigint) -> bigint, VectorUDAFSumDouble(col 2:double) -> double, VectorUDAFSumDouble(col 3:double) -> double, VectorUDAFSumDouble(col 4:double) -> double, VectorUDAFSumDouble(col 5:double) -> double, VectorUDAFSumDouble(col 6:double) -> double, VectorUDAFCountMerge(col 7:bigint) -> bigint, VectorUDAFSumDouble(col 8:double) -> double, VectorUDAFCountMerge(col 9:bigint) -> bigint, VectorUDAFMinLong(col 10:tinyint) -> tinyint
+                    aggregators: VectorUDAFSumLong(col 0:bigint) -> bigint, VectorUDAFCountMerge(col 1:bigint) -> bigint, VectorUDAFSumDouble(col 2:double) -> double, VectorUDAFSumDouble(col 3:double) -> double, VectorUDAFSumDouble(col 4:double) -> double, VectorUDAFCountMerge(col 5:bigint) -> bigint, VectorUDAFSumDouble(col 6:double) -> double, VectorUDAFSumDouble(col 7:double) -> double, VectorUDAFCountMerge(col 8:bigint) -> bigint, VectorUDAFSumDouble(col 9:double) -> double, VectorUDAFCountMerge(col 10:bigint) -> bigint, VectorUDAFMinLong(col 11:tinyint) -> tinyint, VectorUDAFCountMerge(col 12:bigint) -> bigint
                     className: VectorGroupByOperator
                     groupByMode: MERGEPARTIAL
                     native: false
                     vectorProcessingMode: GLOBAL
-                    projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
+                    projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]
                 mode: mergepartial
-                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
-                Statistics: Num rows: 1 Data size: 84 Basic stats: COMPLETE Column stats: COMPLETE
+                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12
+                Statistics: Num rows: 1 Data size: 100 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
-                  expressions: (UDFToDouble(_col0) / _col1) (type: double), _col2 (type: double), power(((_col3 - ((_col4 * _col4) / _col1)) / _col1), 0.5) (type: double), power(((_col5 - ((_col6 * _col6) / _col7)) / if((_col7 = 1L), null, (_col7 - 1))), 0.5) (type: double), ((_col3 - ((_col4 * _col4) / _col1)) / if((_col1 = 1L), null, (_col1 - 1))) (type: double), (_col8 / _col9) (type: double), power(((_col3 - ((_col4 * _col4) / _col1)) / if((_col1 = 1L), null, (_col1 - 1))), 0.5) (type: double), _col10 (type: tinyint), _col7 (type: bigint)
+                  expressions: (UDFToDouble(_col0) / _col1) (type: double), _col2 (type: double), power(((_col3 - ((_col4 * _col4) / _col5)) / _col5), 0.5) (type: double), power(((_col6 - ((_col7 * _col7) / _col8)) / if((_col8 = 1L), null, (_col8 - 1))), 0.5) (type: double), ((_col3 - ((_col4 * _col4) / _col5)) / if((_col5 = 1L), null, (_col5 - 1))) (type: double), (_col9 / _col10) (type: double), power(((_col3 - ((_col4 * _col4) / _col5)) / if((_col5 = 1L), null, (_col5 - 1))), 0.5) (type: double), _col11 (type: tinyint), _col12 (type: bigint)
                   outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                   Select Vectorization:
                       className: VectorSelectOperator
                       native: true
-                      projectedOutputColumnNums: [12, 2, 17, 25, 32, 33, 41, 10, 7]
-                      selectExpressions: DoubleColDivideLongColumn(col 11:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 11:double) -> 12:double, FuncPowerDoubleToDouble(col 16:double)(children: DoubleColDivideLongColumn(col 15:double, col 1:bigint)(children: DoubleColSubtractDoubleColumn(col 3:double, col 14:double)(children: DoubleColDivideLongColumn(col 13:double, col 1:bigint)(children: DoubleColMultiplyDoubleColumn(col 4:double, col 4:double) -> 13:double) -> 14:double) -> 15:double) -> 16:double) -> 17:double, FuncPowerDoubleToDouble(col 24:double)(children: DoubleColDivideLongColumn(col 20:double, col 23:bigint)(children: DoubleColSubtractDoubleColumn(col 5:double, col 19:double)(children: DoubleColDivideLongColumn(col 18:double, col 7:bigint)(children: DoubleColMultiplyDoubleColumn(col 6:double, col 6:double) -> 18:double) -> 19:double) -> 20:double, IfExprNullCondExpr(col 21:boolean, null, col 22:bigint)(children: LongColEqualLongScalar(col 7:bigint, val 1) -> 21:boolean, LongColSubtractLongScalar(col 7:bigint, val 1) -> 22:bigint) -> 23:bigint) -> 24:double) -> 25:double, DoubleColDivideLongColumn(col 28:double, col 31:bigint)(children: DoubleColSubtractDoubleColumn(col 3:double, col 27:double)(children: DoubleColDivideLongColumn(col 26:double, col 1:bigint)(children: DoubleColMultiplyDoubleColumn(col 4:double, col 4:double) -> 26:double) -> 27:double) -> 28:double, IfExprNullCondExpr(col 29:boolean, null, col 30:bigint)(children: LongColEqualLongScalar(col 1:bigint, val 1) -> 29:boolean, LongColSubtractLongScalar(col 1:bigint, val 1) -> 30:bigint) -> 31:bigint) -> 32:double, DoubleColDivideLongColumn(col 8:double, col 9:bigint) -> 33:double, FuncPowerDoubleToDouble(col 40:double)(children: DoubleColDivideLongColumn(col 36:double, col 39:bigint)(children: DoubleColSubtractDoubleColumn(col 3:double, col 35:double)(children: DoubleColDivideLongColumn(col 34:double, col 1:bigint)(children: DoubleColMultiplyDoubleColumn(col 4:double, col 4:double) -> 34:double) -> 35:double) -> 36:double, IfExprNullCondExpr(col 37:boolean, null, col 38:bigint)(children: LongColEqualLongScalar(col 1:bigint, val 1) -> 37:boolean, LongColSubtractLongScalar(col 1:bigint, val 1) -> 38:bigint) -> 39:bigint) -> 40:double) -> 41:double
+                      projectedOutputColumnNums: [14, 2, 19, 27, 34, 35, 43, 11, 12]
+                      selectExpressions: DoubleColDivideLongColumn(col 13:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 13:double) -> 14:double, FuncPowerDoubleToDouble(col 18:double)(children: DoubleColDivideLongColumn(col 17:double, col 5:bigint)(children: DoubleColSubtractDoubleColumn(col 3:double, col 16:double)(children: DoubleColDivideLongColumn(col 15:double, col 5:bigint)(children: DoubleColMultiplyDoubleColumn(col 4:double, col 4:double) -> 15:double) -> 16:double) -> 17:double) -> 18:double) -> 19:double, FuncPowerDoubleToDouble(col 26:double)(children: DoubleColDivideLongColumn(col 22:double, col 25:bigint)(children: DoubleColSubtractDoubleColumn(col 6:double, col 21:double)(children: DoubleColDivideLongColumn(col 20:double, col 8:bigint)(children: DoubleColMultiplyDoubleColumn(col 7:double, col 7:double) -> 20:double) -> 21:double) -> 22:double, IfExprNullCondExpr(col 23:boolean, null, col 24:bigint)(children: LongColEqualLongScalar(col 8:bigint, val 1) -> 23:boolean, LongColSubtractLongScalar(col 8:bigint, val 1) -> 24:bigint) -> 25:bigint) -> 26:double) -> 27:double, DoubleColDivideLongColumn(col 30:double, col 33:bigint)(children: DoubleColSubtractDoubleColumn(col 3:double, col 29:double)(children: DoubleColDivideLongColumn(col 28:double, col 5:bigint)(children: DoubleColMultiplyDoubleColumn(col 4:double, col 4:double) -> 28:double) -> 29:double) -> 30:double, IfExprNullCondExpr(col 31:boolean, null, col 32:bigint)(children: LongColEqualLongScalar(col 5:bigint, val 1) -> 31:boolean, LongColSubtractLongScalar(col 5:bigint, val 1) -> 32:bigint) -> 33:bigint) -> 34:double, DoubleColDivideLongColumn(col 9:double, col 10:bigint) -> 35:double, FuncPowerDoubleToDouble(col 42:double)(children: DoubleColDivideLongColumn(col 38:double, col 41:bigint)(children: DoubleColSubtractDoubleColumn(col 3:double, col 37:double)(children: DoubleColDivideLongColumn(col 36:double, col 5:bigint)(children: DoubleColMultiplyDoubleColumn(col 4:double, col 4:double) -> 36:double) -> 37:double) -> 38:double, IfExprNullCondExpr(col 39:boolean, null, col 40:bigint)(children: LongColEqualLongScalar(col 5:bigint, val 1) -> 39:boolean, LongColSubtractLongScalar(col 5:bigint, val 1) -> 40:bigint) -> 41:bigint) -> 42:double) -> 43:double
                   Statistics: Num rows: 1 Data size: 68 Basic stats: COMPLETE Column stats: COMPLETE
                   Select Operator
                     expressions: _col0 (type: double), (_col0 + -3728.0D) (type: double), (- (_col0 + -3728.0D)) (type: double), (_col0 + -3728.0D) (type: double), ((_col0 + -3728.0D) * (_col0 + -3728.0D)) (type: double), _col1 (type: double), (- _col0) (type: double), _col2 (type: double), (((_col0 + -3728.0D) * (_col0 + -3728.0D)) * (_col0 + -3728.0D)) (type: double), _col3 (type: double), (- _col2) (type: double), (_col2 - (_col0 + -3728.0D)) (type: double), ((_col2 - (_col0 + -3728.0D)) * _col2) (type: double), _col4 (type: double), _col5 (type: double), (10.175D - _col4) (type: double), (- (10.175D - _col4)) (type: double), ((- _col2) / -563.0D) (type: double), _col6 (type: double), (- ((- _col2) / -563.0D)) (type: double), (_col0 / _col1) (type: double), _col7 (type: tinyint), _col8 (type: bigint), (UDFToDouble(_col7) / ((- _col2) / -563.0D)) (type: double), (- (_col0 / _col1)) (type: double)
@@ -200,8 +200,8 @@ STAGE PLANS:
                     Select Vectorization:
                         className: VectorSelectOperator
                         native: true
-                        projectedOutputColumnNums: [12, 42, 44, 45, 48, 2, 49, 17, 54, 25, 55, 57, 60, 32, 33, 61, 63, 65, 41, 68, 69, 10, 7, 73, 75]
-                        selectExpressions: DoubleColAddDoubleScalar(col 12:double, val -3728.0) -> 42:double, DoubleColUnaryMinus(col 43:double)(children: DoubleColAddDoubleScalar(col 12:double, val -3728.0) -> 43:double) -> 44:double, DoubleColAddDoubleScalar(col 12:double, val -3728.0) -> 45:double, DoubleColMultiplyDoubleColumn(col 46:double, col 47:double)(children: DoubleColAddDoubleScalar(col 12:double, val -3728.0) -> 46:double, DoubleColAddDoubleScalar(col 12:double, val -3728.0) -> 47:double) -> 48:double, DoubleColUnaryMinus(col 12:double) -> 49:double, DoubleColMultiplyDoubleColumn(col 52:double, col 53:double)(children: DoubleColMultiplyDoubleColumn(col 50:double, col 51:double)(children: DoubleColAddDoubleScalar(col 12:double, val -3728.0) -> 50:double, DoubleColAddDoubleScalar(col 12:double, val -3728.0) -> 51:double) -> 52:double, DoubleColAddDoubleScalar(col 12:double, val -3728.0) -> 53:double) -> 54:double, DoubleColUnaryMinus(col 17:double) -> 55:double, DoubleColSubtractDoubleColumn(col 17:double, col 56:double)(children: DoubleColAddDoubleScalar(col 12:double, val -3728.0) -> 56:double) -> 57:double, DoubleColMultiplyDoubleColumn(col 59:double, col 17:double)(children: DoubleColSubtractDoubleColumn(col 17:double, col 58:double)(children: DoubleColAddDoubleScalar(col 12:double, val -3728.0) -> 58:double) -> 59:double) -> 60:double, DoubleScalarSubtractDoubleColumn(val 10.175, col 32:double) -> 61:double, DoubleColUnaryMinus(col 62:double)(children: DoubleScalarSubtractDoubleColumn(val 10.175, col 32:double) -> 62:double) -> 63:double, DoubleColDivideDoubleScalar(col 64:double, val -563.0)(children: DoubleColUnaryMinus(col 17:double) -> 64:double) -> 65:double, DoubleColUnaryMinus(col 67:double)(children: DoubleColDivideDoubleScalar(col 66:double, val -563.0)(children: DoubleColUnaryMinus(col 17:double) -> 66:double) -> 67:double) -> 68:double, DoubleColDivideDoubleColumn(col 12:double, col 2:double) -> 69:double, DoubleColDivideDoubleColumn(col 70:double, col 72:double)(children: CastLongToDouble(col 10:tinyint) -> 70:double, DoubleColDivideDoubleScalar(col 71:double, val -563.0)(children: DoubleColUnaryMinus(col 17:double) -> 71:double) -> 72:double) -> 73:double, DoubleColUnaryMinus(col 74:double)(children: DoubleColDivideDoubleColumn(col 12:double, col 2:double) -> 74:double) -> 75:double
+                        projectedOutputColumnNums: [14, 44, 46, 47, 50, 2, 51, 19, 56, 27, 57, 59, 62, 34, 35, 63, 65, 67, 43, 70, 71, 11, 12, 75, 77]
+                        selectExpressions: DoubleColAddDoubleScalar(col 14:double, val -3728.0) -> 44:double, DoubleColUnaryMinus(col 45:double)(children: DoubleColAddDoubleScalar(col 14:double, val -3728.0) -> 45:double) -> 46:double, DoubleColAddDoubleScalar(col 14:double, val -3728.0) -> 47:double, DoubleColMultiplyDoubleColumn(col 48:double, col 49:double)(children: DoubleColAddDoubleScalar(col 14:double, val -3728.0) -> 48:double, DoubleColAddDoubleScalar(col 14:double, val -3728.0) -> 49:double) -> 50:double, DoubleColUnaryMinus(col 14:double) -> 51:double, DoubleColMultiplyDoubleColumn(col 54:double, col 55:double)(children: DoubleColMultiplyDoubleColumn(col 52:double, col 53:double)(children: DoubleColAddDoubleScalar(col 14:double, val -3728.0) -> 52:double, DoubleColAddDoubleScalar(col 14:double, val -3728.0) -> 53:double) -> 54:double, DoubleColAddDoubleScalar(col 14:double, val -3728.0) -> 55:double) -> 56:double, DoubleColUnaryMinus(col 19:double) -> 57:double, DoubleColSubtractDoubleColumn(col 19:double, col 58:double)(children: DoubleColAddDoubleScalar(col 14:double, val -3728.0) -> 58:double) -> 59:double, DoubleColMultiplyDoubleColumn(col 61:double, col 19:double)(children: DoubleColSubtractDoubleColumn(col 19:double, col 60:double)(children: DoubleColAddDoubleScalar(col 14:double, val -3728.0) -> 60:double) -> 61:double) -> 62:double, DoubleScalarSubtractDoubleColumn(val 10.175, col 34:double) -> 63:double, DoubleColUnaryMinus(col 64:double)(children: DoubleScalarSubtractDoubleColumn(val 10.175, col 34:double) -> 64:double) -> 65:double, DoubleColDivideDoubleScalar(col 66:double, val -563.0)(children: DoubleColUnaryMinus(col 19:double) -> 66:double) -> 67:double, DoubleColUnaryMinus(col 69:double)(children: DoubleColDivideDoubleScalar(col 68:double, val -563.0)(children: DoubleColUnaryMinus(col 19:double) -> 68:double) -> 69:double) -> 70:double, DoubleColDivideDoubleColumn(col 14:double, col 2:double) -> 71:double, DoubleColDivideDoubleColumn(col 72:double, col 74:double)(children: CastLongToDouble(col 11:tinyint) -> 72:double, DoubleColDivideDoubleScalar(col 73:double, val -563.0)(children: DoubleColUnaryMinus(col 19:double) -> 73:double) -> 74:double) -> 75:double, DoubleColUnaryMinus(col 76:double)(children: DoubleColDivideDoubleColumn(col 14:double, col 2:double) -> 76:double) -> 77:double
                     Statistics: Num rows: 1 Data size: 196 Basic stats: COMPLETE Column stats: COMPLETE
                     File Output Operator
                       compressed: false
@@ -340,18 +340,18 @@ STAGE PLANS:
                           selectExpressions: CastLongToDouble(col 2:int) -> 19:double, DoubleColMultiplyDoubleColumn(col 20:double, col 21:double)(children: CastLongToDouble(col 2:int) -> 20:double, CastLongToDouble(col 2:int) -> 21:double) -> 22:double, CastLongToDouble(col 1:smallint) -> 23:double, DoubleColMultiplyDoubleColumn(col 24:double, col 25:double)(children: CastLongToDouble(col 1:smallint) -> 24:double, CastLongToDouble(col 1:smallint) -> 25:double) -> 26:double
                       Statistics: Num rows: 5465 Data size: 1101870 Basic stats: COMPLETE Column stats: COMPLETE
                       Group By Operator
-                        aggregations: sum(_col0), count(_col0), sum(_col1), sum(_col6), sum(_col5), sum(_col8), sum(_col7), count(_col2), sum(_col3), count(_col3), min(_col4)
+                        aggregations: sum(_col0), count(_col0), sum(_col1), sum(_col6), sum(_col5), count(_col5), sum(_col8), sum(_col7), count(_col7), sum(_col3), count(_col3), min(_col4), count(_col2)
                         Group By Vectorization:
-                            aggregators: VectorUDAFSumLong(col 2:int) -> bigint, VectorUDAFCount(col 2:int) -> bigint, VectorUDAFSumDouble(col 5:double) -> double, VectorUDAFSumDouble(col 22:double) -> double, VectorUDAFSumDouble(col 19:double) -> double, VectorUDAFSumDouble(col 26:double) -> double, VectorUDAFSumDouble(col 23:double) -> double, VectorUDAFCount(col 1:smallint) -> bigint, VectorUDAFSumDouble(col 4:float) -> double, VectorUDAFCount(col 4:float) -> bigint, VectorUDAFMinLong(col 0:tinyint) -> tinyint
+                            aggregators: VectorUDAFSumLong(col 2:int) -> bigint, VectorUDAFCount(col 2:int) -> bigint, VectorUDAFSumDouble(col 5:double) -> double, VectorUDAFSumDouble(col 22:double) -> double, VectorUDAFSumDouble(col 19:double) -> double, VectorUDAFCount(col 19:double) -> bigint, VectorUDAFSumDouble(col 26:double) -> double, VectorUDAFSumDouble(col 23:double) -> double, VectorUDAFCount(col 23:double) -> bigint, VectorUDAFSumDouble(col 4:float) -> double, VectorUDAFCount(col 4:float) -> bigint, VectorUDAFMinLong(col 0:tinyint) -> tinyint, VectorUDAFCount(col 1:smallint) -> bigint
                             className: VectorGroupByOperator
                             groupByMode: HASH
                             native: false
                             vectorProcessingMode: HASH
-                            projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
+                            projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]
                         minReductionHashAggr: 0.99
                         mode: hash
-                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
-                        Statistics: Num rows: 1 Data size: 84 Basic stats: COMPLETE Column stats: COMPLETE
+                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12
+                        Statistics: Num rows: 1 Data size: 100 Basic stats: COMPLETE Column stats: COMPLETE
                         Reduce Output Operator
                           null sort order: 
                           sort order: 
@@ -359,9 +359,9 @@ STAGE PLANS:
                               className: VectorReduceSinkEmptyKeyOperator
                               native: true
                               nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
-                              valueColumns: 0:bigint, 1:bigint, 2:double, 3:double, 4:double, 5:double, 6:double, 7:bigint, 8:double, 9:bigint, 10:tinyint
-                          Statistics: Num rows: 1 Data size: 84 Basic stats: COMPLETE Column stats: COMPLETE
-                          value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: double), _col3 (type: double), _col4 (type: double), _col5 (type: double), _col6 (type: double), _col7 (type: bigint), _col8 (type: double), _col9 (type: bigint), _col10 (type: tinyint)
+                              valueColumns: 0:bigint, 1:bigint, 2:double, 3:double, 4:double, 5:bigint, 6:double, 7:double, 8:bigint, 9:double, 10:bigint, 11:tinyint, 12:bigint
+                          Statistics: Num rows: 1 Data size: 100 Basic stats: COMPLETE Column stats: COMPLETE
+                          value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: double), _col3 (type: double), _col4 (type: double), _col5 (type: bigint), _col6 (type: double), _col7 (type: double), _col8 (type: bigint), _col9 (type: double), _col10 (type: bigint), _col11 (type: tinyint), _col12 (type: bigint)
             Execution mode: vectorized, llap
             LLAP IO: all inputs
             Map Vectorization:
@@ -390,31 +390,31 @@ STAGE PLANS:
                 usesVectorUDFAdaptor: false
                 vectorized: true
                 rowBatchContext:
-                    dataColumnCount: 11
-                    dataColumns: VALUE._col0:bigint, VALUE._col1:bigint, VALUE._col2:double, VALUE._col3:double, VALUE._col4:double, VALUE._col5:double, VALUE._col6:double, VALUE._col7:bigint, VALUE._col8:double, VALUE._col9:bigint, VALUE._col10:tinyint
+                    dataColumnCount: 13
+                    dataColumns: VALUE._col0:bigint, VALUE._col1:bigint, VALUE._col2:double, VALUE._col3:double, VALUE._col4:double, VALUE._col5:bigint, VALUE._col6:double, VALUE._col7:double, VALUE._col8:bigint, VALUE._col9:double, VALUE._col10:bigint, VALUE._col11:tinyint, VALUE._col12:bigint
                     partitionColumnCount: 0
                     scratchColumnTypeNames: []
             Reduce Operator Tree:
               Group By Operator
-                aggregations: sum(VALUE._col0), count(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3), sum(VALUE._col4), sum(VALUE._col5), sum(VALUE._col6), count(VALUE._col7), sum(VALUE._col8), count(VALUE._col9), min(VALUE._col10)
+                aggregations: sum(VALUE._col0), count(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3), sum(VALUE._col4), count(VALUE._col5), sum(VALUE._col6), sum(VALUE._col7), count(VALUE._col8), sum(VALUE._col9), count(VALUE._col10), min(VALUE._col11), count(VALUE._col12)
                 Group By Vectorization:
-                    aggregators: VectorUDAFSumLong(col 0:bigint) -> bigint, VectorUDAFCountMerge(col 1:bigint) -> bigint, VectorUDAFSumDouble(col 2:double) -> double, VectorUDAFSumDouble(col 3:double) -> double, VectorUDAFSumDouble(col 4:double) -> double, VectorUDAFSumDouble(col 5:double) -> double, VectorUDAFSumDouble(col 6:double) -> double, VectorUDAFCountMerge(col 7:bigint) -> bigint, VectorUDAFSumDouble(col 8:double) -> double, VectorUDAFCountMerge(col 9:bigint) -> bigint, VectorUDAFMinLong(col 10:tinyint) -> tinyint
+                    aggregators: VectorUDAFSumLong(col 0:bigint) -> bigint, VectorUDAFCountMerge(col 1:bigint) -> bigint, VectorUDAFSumDouble(col 2:double) -> double, VectorUDAFSumDouble(col 3:double) -> double, VectorUDAFSumDouble(col 4:double) -> double, VectorUDAFCountMerge(col 5:bigint) -> bigint, VectorUDAFSumDouble(col 6:double) -> double, VectorUDAFSumDouble(col 7:double) -> double, VectorUDAFCountMerge(col 8:bigint) -> bigint, VectorUDAFSumDouble(col 9:double) -> double, VectorUDAFCountMerge(col 10:bigint) -> bigint, VectorUDAFMinLong(col 11:tinyint) -> tinyint, VectorUDAFCountMerge(col 12:bigint) -> bigint
                     className: VectorGroupByOperator
                     groupByMode: MERGEPARTIAL
                     native: false
                     vectorProcessingMode: GLOBAL
-                    projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
+                    projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]
                 mode: mergepartial
-                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
-                Statistics: Num rows: 1 Data size: 84 Basic stats: COMPLETE Column stats: COMPLETE
+                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12
+                Statistics: Num rows: 1 Data size: 100 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
-                  expressions: (UDFToDouble(_col0) / _col1) (type: double), _col2 (type: double), power(((_col3 - ((_col4 * _col4) / _col1)) / _col1), 0.5) (type: double), power(((_col5 - ((_col6 * _col6) / _col7)) / if((_col7 = 1L), null, (_col7 - 1))), 0.5) (type: double), ((_col3 - ((_col4 * _col4) / _col1)) / if((_col1 = 1L), null, (_col1 - 1))) (type: double), (_col8 / _col9) (type: double), power(((_col3 - ((_col4 * _col4) / _col1)) / if((_col1 = 1L), null, (_col1 - 1))), 0.5) (type: double), _col10 (type: tinyint), _col7 (type: bigint)
+                  expressions: (UDFToDouble(_col0) / _col1) (type: double), _col2 (type: double), power(((_col3 - ((_col4 * _col4) / _col5)) / _col5), 0.5) (type: double), power(((_col6 - ((_col7 * _col7) / _col8)) / if((_col8 = 1L), null, (_col8 - 1))), 0.5) (type: double), ((_col3 - ((_col4 * _col4) / _col5)) / if((_col5 = 1L), null, (_col5 - 1))) (type: double), (_col9 / _col10) (type: double), power(((_col3 - ((_col4 * _col4) / _col5)) / if((_col5 = 1L), null, (_col5 - 1))), 0.5) (type: double), _col11 (type: tinyint), _col12 (type: bigint)
                   outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                   Select Vectorization:
                       className: VectorSelectOperator
                       native: true
-                      projectedOutputColumnNums: [12, 2, 17, 25, 32, 33, 41, 10, 7]
-                      selectExpressions: DoubleColDivideLongColumn(col 11:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 11:double) -> 12:double, FuncPowerDoubleToDouble(col 16:double)(children: DoubleColDivideLongColumn(col 15:double, col 1:bigint)(children: DoubleColSubtractDoubleColumn(col 3:double, col 14:double)(children: DoubleColDivideLongColumn(col 13:double, col 1:bigint)(children: DoubleColMultiplyDoubleColumn(col 4:double, col 4:double) -> 13:double) -> 14:double) -> 15:double) -> 16:double) -> 17:double, FuncPowerDoubleToDouble(col 24:double)(children: DoubleColDivideLongColumn(col 20:double, col 23:bigint)(children: DoubleColSubtractDoubleColumn(col 5:double, col 19:double)(children: DoubleColDivideLongColumn(col 18:double, col 7:bigint)(children: DoubleColMultiplyDoubleColumn(col 6:double, col 6:double) -> 18:double) -> 19:double) -> 20:double, IfExprNullCondExpr(col 21:boolean, null, col 22:bigint)(children: LongColEqualLongScalar(col 7:bigint, val 1) -> 21:boolean, LongColSubtractLongScalar(col 7:bigint, val 1) -> 22:bigint) -> 23:bigint) -> 24:double) -> 25:double, DoubleColDivideLongColumn(col 28:double, col 31:bigint)(children: DoubleColSubtractDoubleColumn(col 3:double, col 27:double)(children: DoubleColDivideLongColumn(col 26:double, col 1:bigint)(children: DoubleColMultiplyDoubleColumn(col 4:double, col 4:double) -> 26:double) -> 27:double) -> 28:double, IfExprNullCondExpr(col 29:boolean, null, col 30:bigint)(children: LongColEqualLongScalar(col 1:bigint, val 1) -> 29:boolean, LongColSubtractLongScalar(col 1:bigint, val 1) -> 30:bigint) -> 31:bigint) -> 32:double, DoubleColDivideLongColumn(col 8:double, col 9:bigint) -> 33:double, FuncPowerDoubleToDouble(col 40:double)(children: DoubleColDivideLongColumn(col 36:double, col 39:bigint)(children: DoubleColSubtractDoubleColumn(col 3:double, col 35:double)(children: DoubleColDivideLongColumn(col 34:double, col 1:bigint)(children: DoubleColMultiplyDoubleColumn(col 4:double, col 4:double) -> 34:double) -> 35:double) -> 36:double, IfExprNullCondExpr(col 37:boolean, null, col 38:bigint)(children: LongColEqualLongScalar(col 1:bigint, val 1) -> 37:boolean, LongColSubtractLongScalar(col 1:bigint, val 1) -> 38:bigint) -> 39:bigint) -> 40:double) -> 41:double
+                      projectedOutputColumnNums: [14, 2, 19, 27, 34, 35, 43, 11, 12]
+                      selectExpressions: DoubleColDivideLongColumn(col 13:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 13:double) -> 14:double, FuncPowerDoubleToDouble(col 18:double)(children: DoubleColDivideLongColumn(col 17:double, col 5:bigint)(children: DoubleColSubtractDoubleColumn(col 3:double, col 16:double)(children: DoubleColDivideLongColumn(col 15:double, col 5:bigint)(children: DoubleColMultiplyDoubleColumn(col 4:double, col 4:double) -> 15:double) -> 16:double) -> 17:double) -> 18:double) -> 19:double, FuncPowerDoubleToDouble(col 26:double)(children: DoubleColDivideLongColumn(col 22:double, col 25:bigint)(children: DoubleColSubtractDoubleColumn(col 6:double, col 21:double)(children: DoubleColDivideLongColumn(col 20:double, col 8:bigint)(children: DoubleColMultiplyDoubleColumn(col 7:double, col 7:double) -> 20:double) -> 21:double) -> 22:double, IfExprNullCondExpr(col 23:boolean, null, col 24:bigint)(children: LongColEqualLongScalar(col 8:bigint, val 1) -> 23:boolean, LongColSubtractLongScalar(col 8:bigint, val 1) -> 24:bigint) -> 25:bigint) -> 26:double) -> 27:double, DoubleColDivideLongColumn(col 30:double, col 33:bigint)(children: DoubleColSubtractDoubleColumn(col 3:double, col 29:double)(children: DoubleColDivideLongColumn(col 28:double, col 5:bigint)(children: DoubleColMultiplyDoubleColumn(col 4:double, col 4:double) -> 28:double) -> 29:double) -> 30:double, IfExprNullCondExpr(col 31:boolean, null, col 32:bigint)(children: LongColEqualLongScalar(col 5:bigint, val 1) -> 31:boolean, LongColSubtractLongScalar(col 5:bigint, val 1) -> 32:bigint) -> 33:bigint) -> 34:double, DoubleColDivideLongColumn(col 9:double, col 10:bigint) -> 35:double, FuncPowerDoubleToDouble(col 42:double)(children: DoubleColDivideLongColumn(col 38:double, col 41:bigint)(children: DoubleColSubtractDoubleColumn(col 3:double, col 37:double)(children: DoubleColDivideLongColumn(col 36:double, col 5:bigint)(children: DoubleColMultiplyDoubleColumn(col 4:double, col 4:double) -> 36:double) -> 37:double) -> 38:double, IfExprNullCondExpr(col 39:boolean, null, col 40:bigint)(children: LongColEqualLongScalar(col 5:bigint, val 1) -> 39:boolean, LongColSubtractLongScalar(col 5:bigint, val 1) -> 40:bigint) -> 41:bigint) -> 42:double) -> 43:double
                   Statistics: Num rows: 1 Data size: 68 Basic stats: COMPLETE Column stats: COMPLETE
                   Select Operator
                     expressions: _col0 (type: double), (_col0 + -3728.0D) (type: double), (- (_col0 + -3728.0D)) (type: double), (_col0 + -3728.0D) (type: double), ((_col0 + -3728.0D) * (_col0 + -3728.0D)) (type: double), _col1 (type: double), (- _col0) (type: double), _col2 (type: double), (((_col0 + -3728.0D) * (_col0 + -3728.0D)) * (_col0 + -3728.0D)) (type: double), _col3 (type: double), (- _col2) (type: double), (_col2 - (_col0 + -3728.0D)) (type: double), ((_col2 - (_col0 + -3728.0D)) * _col2) (type: double), _col4 (type: double), _col5 (type: double), (10.175D - _col4) (type: double), (- (10.175D - _col4)) (type: double), ((- _col2) / -563.0D) (type: double), _col6 (type: double), (- ((- _col2) / -563.0D)) (type: double), (_col0 / _col1) (type: double), _col7 (type: tinyint), _col8 (type: bigint), (UDFToDouble(_col7) / ((- _col2) / -563.0D)) (type: double), (- (_col0 / _col1)) (type: double)
@@ -422,8 +422,8 @@ STAGE PLANS:
                     Select Vectorization:
                         className: VectorSelectOperator
                         native: true
-                        projectedOutputColumnNums: [12, 42, 44, 45, 48, 2, 49, 17, 54, 25, 55, 57, 60, 32, 33, 61, 63, 65, 41, 68, 69, 10, 7, 73, 75]
-                        selectExpressions: DoubleColAddDoubleScalar(col 12:double, val -3728.0) -> 42:double, DoubleColUnaryMinus(col 43:double)(children: DoubleColAddDoubleScalar(col 12:double, val -3728.0) -> 43:double) -> 44:double, DoubleColAddDoubleScalar(col 12:double, val -3728.0) -> 45:double, DoubleColMultiplyDoubleColumn(col 46:double, col 47:double)(children: DoubleColAddDoubleScalar(col 12:double, val -3728.0) -> 46:double, DoubleColAddDoubleScalar(col 12:double, val -3728.0) -> 47:double) -> 48:double, DoubleColUnaryMinus(col 12:double) -> 49:double, DoubleColMultiplyDoubleColumn(col 52:double, col 53:double)(children: DoubleColMultiplyDoubleColumn(col 50:double, col 51:double)(children: DoubleColAddDoubleScalar(col 12:double, val -3728.0) -> 50:double, DoubleColAddDoubleScalar(col 12:double, val -3728.0) -> 51:double) -> 52:double, DoubleColAddDoubleScalar(col 12:double, val -3728.0) -> 53:double) -> 54:double, DoubleColUnaryMinus(col 17:double) -> 55:double, DoubleColSubtractDoubleColumn(col 17:double, col 56:double)(children: DoubleColAddDoubleScalar(col 12:double, val -3728.0) -> 56:double) -> 57:double, DoubleColMultiplyDoubleColumn(col 59:double, col 17:double)(children: DoubleColSubtractDoubleColumn(col 17:double, col 58:double)(children: DoubleColAddDoubleScalar(col 12:double, val -3728.0) -> 58:double) -> 59:double) -> 60:double, DoubleScalarSubtractDoubleColumn(val 10.175, col 32:double) -> 61:double, DoubleColUnaryMinus(col 62:double)(children: DoubleScalarSubtractDoubleColumn(val 10.175, col 32:double) -> 62:double) -> 63:double, DoubleColDivideDoubleScalar(col 64:double, val -563.0)(children: DoubleColUnaryMinus(col 17:double) -> 64:double) -> 65:double, DoubleColUnaryMinus(col 67:double)(children: DoubleColDivideDoubleScalar(col 66:double, val -563.0)(children: DoubleColUnaryMinus(col 17:double) -> 66:double) -> 67:double) -> 68:double, DoubleColDivideDoubleColumn(col 12:double, col 2:double) -> 69:double, DoubleColDivideDoubleColumn(col 70:double, col 72:double)(children: CastLongToDouble(col 10:tinyint) -> 70:double, DoubleColDivideDoubleScalar(col 71:double, val -563.0)(children: DoubleColUnaryMinus(col 17:double) -> 71:double) -> 72:double) -> 73:double, DoubleColUnaryMinus(col 74:double)(children: DoubleColDivideDoubleColumn(col 12:double, col 2:double) -> 74:double) -> 75:double
+                        projectedOutputColumnNums: [14, 44, 46, 47, 50, 2, 51, 19, 56, 27, 57, 59, 62, 34, 35, 63, 65, 67, 43, 70, 71, 11, 12, 75, 77]
+                        selectExpressions: DoubleColAddDoubleScalar(col 14:double, val -3728.0) -> 44:double, DoubleColUnaryMinus(col 45:double)(children: DoubleColAddDoubleScalar(col 14:double, val -3728.0) -> 45:double) -> 46:double, DoubleColAddDoubleScalar(col 14:double, val -3728.0) -> 47:double, DoubleColMultiplyDoubleColumn(col 48:double, col 49:double)(children: DoubleColAddDoubleScalar(col 14:double, val -3728.0) -> 48:double, DoubleColAddDoubleScalar(col 14:double, val -3728.0) -> 49:double) -> 50:double, DoubleColUnaryMinus(col 14:double) -> 51:double, DoubleColMultiplyDoubleColumn(col 54:double, col 55:double)(children: DoubleColMultiplyDoubleColumn(col 52:double, col 53:double)(children: DoubleColAddDoubleScalar(col 14:double, val -3728.0) -> 52:double, DoubleColAddDoubleScalar(col 14:double, val -3728.0) -> 53:double) -> 54:double, DoubleColAddDoubleScalar(col 14:double, val -3728.0) -> 55:double) -> 56:double, DoubleColUnaryMinus(col 19:double) -> 57:double, DoubleColSubtractDoubleColumn(col 19:double, col 58:double)(children: DoubleColAddDoubleScalar(col 14:double, val -3728.0) -> 58:double) -> 59:double, DoubleColMultiplyDoubleColumn(col 61:double, col 19:double)(children: DoubleColSubtractDoubleColumn(col 19:double, col 60:double)(children: DoubleColAddDoubleScalar(col 14:double, val -3728.0) -> 60:double) -> 61:double) -> 62:double, DoubleScalarSubtractDoubleColumn(val 10.175, col 34:double) -> 63:double, DoubleColUnaryMinus(col 64:double)(children: DoubleScalarSubtractDoubleColumn(val 10.175, col 34:double) -> 64:double) -> 65:double, DoubleColDivideDoubleScalar(col 66:double, val -563.0)(children: DoubleColUnaryMinus(col 19:double) -> 66:double) -> 67:double, DoubleColUnaryMinus(col 69:double)(children: DoubleColDivideDoubleScalar(col 68:double, val -563.0)(children: DoubleColUnaryMinus(col 19:double) -> 68:double) -> 69:double) -> 70:double, DoubleColDivideDoubleColumn(col 14:double, col 2:double) -> 71:double, DoubleColDivideDoubleColumn(col 72:double, col 74:double)(children: CastLongToDouble(col 11:tinyint) -> 72:double, DoubleColDivideDoubleScalar(col 73:double, val -563.0)(children: DoubleColUnaryMinus(col 19:double) -> 73:double) -> 74:double) -> 75:double, DoubleColUnaryMinus(col 76:double)(children: DoubleColDivideDoubleColumn(col 14:double, col 2:double) -> 76:double) -> 77:double
                     Statistics: Num rows: 1 Data size: 196 Basic stats: COMPLETE Column stats: COMPLETE
                     File Output Operator
                       compressed: false
diff --git a/ql/src/test/results/clientpositive/llap/vectorization_0.q.out b/ql/src/test/results/clientpositive/llap/vectorization_0.q.out
index 862d2d127e..256d0e8bb9 100644
--- a/ql/src/test/results/clientpositive/llap/vectorization_0.q.out
+++ b/ql/src/test/results/clientpositive/llap/vectorization_0.q.out
@@ -251,16 +251,16 @@ STAGE PLANS:
                     outputColumnNames: _col0, _col1, _col2
                     Statistics: Num rows: 12288 Data size: 36696 Basic stats: COMPLETE Column stats: COMPLETE
                     Group By Operator
-                      aggregations: sum(_col0), count(_col0), sum(_col2), sum(_col1)
+                      aggregations: sum(_col0), count(_col0), sum(_col2), sum(_col1), count(_col1)
                       minReductionHashAggr: 0.99
                       mode: hash
-                      outputColumnNames: _col0, _col1, _col2, _col3
-                      Statistics: Num rows: 1 Data size: 32 Basic stats: COMPLETE Column stats: COMPLETE
+                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
+                      Statistics: Num rows: 1 Data size: 40 Basic stats: COMPLETE Column stats: COMPLETE
                       Reduce Output Operator
                         null sort order: 
                         sort order: 
-                        Statistics: Num rows: 1 Data size: 32 Basic stats: COMPLETE Column stats: COMPLETE
-                        value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: double), _col3 (type: double)
+                        Statistics: Num rows: 1 Data size: 40 Basic stats: COMPLETE Column stats: COMPLETE
+                        value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: double), _col3 (type: double), _col4 (type: bigint)
             Execution mode: vectorized, llap
             LLAP IO: all inputs
             Map Vectorization:
@@ -282,12 +282,12 @@ STAGE PLANS:
                 vectorized: true
             Reduce Operator Tree:
               Group By Operator
-                aggregations: sum(VALUE._col0), count(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3)
+                aggregations: sum(VALUE._col0), count(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3), count(VALUE._col4)
                 mode: mergepartial
-                outputColumnNames: _col0, _col1, _col2, _col3
-                Statistics: Num rows: 1 Data size: 32 Basic stats: COMPLETE Column stats: COMPLETE
+                outputColumnNames: _col0, _col1, _col2, _col3, _col4
+                Statistics: Num rows: 1 Data size: 40 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
-                  expressions: (UDFToDouble(_col0) / _col1) (type: double), ((_col2 - ((_col3 * _col3) / _col1)) / _col1) (type: double), ((_col2 - ((_col3 * _col3) / _col1)) / _col1) (type: double), ((_col2 - ((_col3 * _col3) / _col1)) / if((_col1 = 1L), null, (_col1 - 1))) (type: double), power(((_col2 - ((_col3 * _col3) / _col1)) / _col1), 0.5) (type: double), power(((_col2 - ((_col3 * _col3) / _col1)) / _col1), 0.5) (type: double), power(((_col2 - ((_col3 * _col3) / _col1)) / _col1), 0.5) (type: double), power(((_col2 - ((_col3 * _col3) / _col1)) / if((_col1 = 1L), null, (_col1 - 1))), 0.5) (type: double)
+                  expressions: (UDFToDouble(_col0) / _col1) (type: double), ((_col2 - ((_col3 * _col3) / _col4)) / _col4) (type: double), ((_col2 - ((_col3 * _col3) / _col4)) / _col4) (type: double), ((_col2 - ((_col3 * _col3) / _col4)) / if((_col4 = 1L), null, (_col4 - 1))) (type: double), power(((_col2 - ((_col3 * _col3) / _col4)) / _col4), 0.5) (type: double), power(((_col2 - ((_col3 * _col3) / _col4)) / _col4), 0.5) (type: double), power(((_col2 - ((_col3 * _col3) / _col4)) / _col4), 0.5) (type: double), power(((_col2 - ((_col3 * _col3) / _col4)) / if((_col4 = 1L), null, (_col4 - 1))), 0.5) (type: double)
                   outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                   Statistics: Num rows: 1 Data size: 64 Basic stats: COMPLETE Column stats: COMPLETE
                   File Output Operator
@@ -586,16 +586,16 @@ STAGE PLANS:
                     outputColumnNames: _col0, _col1, _col2
                     Statistics: Num rows: 12288 Data size: 73392 Basic stats: COMPLETE Column stats: COMPLETE
                     Group By Operator
-                      aggregations: sum(_col0), count(_col0), sum(_col2), sum(_col1)
+                      aggregations: sum(_col0), count(_col0), sum(_col2), sum(_col1), count(_col1)
                       minReductionHashAggr: 0.99
                       mode: hash
-                      outputColumnNames: _col0, _col1, _col2, _col3
-                      Statistics: Num rows: 1 Data size: 32 Basic stats: COMPLETE Column stats: COMPLETE
+                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
+                      Statistics: Num rows: 1 Data size: 40 Basic stats: COMPLETE Column stats: COMPLETE
                       Reduce Output Operator
                         null sort order: 
                         sort order: 
-                        Statistics: Num rows: 1 Data size: 32 Basic stats: COMPLETE Column stats: COMPLETE
-                        value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: double), _col3 (type: double)
+                        Statistics: Num rows: 1 Data size: 40 Basic stats: COMPLETE Column stats: COMPLETE
+                        value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: double), _col3 (type: double), _col4 (type: bigint)
             Execution mode: vectorized, llap
             LLAP IO: all inputs
             Map Vectorization:
@@ -617,12 +617,12 @@ STAGE PLANS:
                 vectorized: true
             Reduce Operator Tree:
               Group By Operator
-                aggregations: sum(VALUE._col0), count(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3)
+                aggregations: sum(VALUE._col0), count(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3), count(VALUE._col4)
                 mode: mergepartial
-                outputColumnNames: _col0, _col1, _col2, _col3
-                Statistics: Num rows: 1 Data size: 32 Basic stats: COMPLETE Column stats: COMPLETE
+                outputColumnNames: _col0, _col1, _col2, _col3, _col4
+                Statistics: Num rows: 1 Data size: 40 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
-                  expressions: (UDFToDouble(_col0) / _col1) (type: double), ((_col2 - ((_col3 * _col3) / _col1)) / _col1) (type: double), ((_col2 - ((_col3 * _col3) / _col1)) / _col1) (type: double), ((_col2 - ((_col3 * _col3) / _col1)) / if((_col1 = 1L), null, (_col1 - 1))) (type: double), power(((_col2 - ((_col3 * _col3) / _col1)) / _col1), 0.5) (type: double), power(((_col2 - ((_col3 * _col3) / _col1)) / _col1), 0.5) (type: double), power(((_col2 - ((_col3 * _col3) / _col1)) / _col1), 0.5) (type: double), power(((_col2 - ((_col3 * _col3) / _col1)) / if((_col1 = 1L), null, (_col1 - 1))), 0.5) (type: double)
+                  expressions: (UDFToDouble(_col0) / _col1) (type: double), ((_col2 - ((_col3 * _col3) / _col4)) / _col4) (type: double), ((_col2 - ((_col3 * _col3) / _col4)) / _col4) (type: double), ((_col2 - ((_col3 * _col3) / _col4)) / if((_col4 = 1L), null, (_col4 - 1))) (type: double), power(((_col2 - ((_col3 * _col3) / _col4)) / _col4), 0.5) (type: double), power(((_col2 - ((_col3 * _col3) / _col4)) / _col4), 0.5) (type: double), power(((_col2 - ((_col3 * _col3) / _col4)) / _col4), 0.5) (type: double), power(((_col2 - ((_col3 * _col3) / _col4)) / if((_col4 = 1L), null, (_col4 - 1))), 0.5) (type: double)
                   outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                   Statistics: Num rows: 1 Data size: 64 Basic stats: COMPLETE Column stats: COMPLETE
                   File Output Operator
@@ -921,16 +921,16 @@ STAGE PLANS:
                     outputColumnNames: _col0, _col1, _col2
                     Statistics: Num rows: 12288 Data size: 36696 Basic stats: COMPLETE Column stats: COMPLETE
                     Group By Operator
-                      aggregations: sum(_col0), count(_col0), sum(_col2), sum(_col1)
+                      aggregations: sum(_col0), count(_col0), sum(_col2), sum(_col1), count(_col1)
                       minReductionHashAggr: 0.99
                       mode: hash
-                      outputColumnNames: _col0, _col1, _col2, _col3
-                      Statistics: Num rows: 1 Data size: 32 Basic stats: COMPLETE Column stats: COMPLETE
+                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
+                      Statistics: Num rows: 1 Data size: 40 Basic stats: COMPLETE Column stats: COMPLETE
                       Reduce Output Operator
                         null sort order: 
                         sort order: 
-                        Statistics: Num rows: 1 Data size: 32 Basic stats: COMPLETE Column stats: COMPLETE
-                        value expressions: _col0 (type: double), _col1 (type: bigint), _col2 (type: double), _col3 (type: double)
+                        Statistics: Num rows: 1 Data size: 40 Basic stats: COMPLETE Column stats: COMPLETE
+                        value expressions: _col0 (type: double), _col1 (type: bigint), _col2 (type: double), _col3 (type: double), _col4 (type: bigint)
             Execution mode: vectorized, llap
             LLAP IO: all inputs
             Map Vectorization:
@@ -952,12 +952,12 @@ STAGE PLANS:
                 vectorized: true
             Reduce Operator Tree:
               Group By Operator
-                aggregations: sum(VALUE._col0), count(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3)
+                aggregations: sum(VALUE._col0), count(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3), count(VALUE._col4)
                 mode: mergepartial
-                outputColumnNames: _col0, _col1, _col2, _col3
-                Statistics: Num rows: 1 Data size: 32 Basic stats: COMPLETE Column stats: COMPLETE
+                outputColumnNames: _col0, _col1, _col2, _col3, _col4
+                Statistics: Num rows: 1 Data size: 40 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
-                  expressions: (_col0 / _col1) (type: double), ((_col2 - ((_col3 * _col3) / _col1)) / _col1) (type: double), ((_col2 - ((_col3 * _col3) / _col1)) / _col1) (type: double), ((_col2 - ((_col3 * _col3) / _col1)) / if((_col1 = 1L), null, (_col1 - 1))) (type: double), power(((_col2 - ((_col3 * _col3) / _col1)) / _col1), 0.5) (type: double), power(((_col2 - ((_col3 * _col3) / _col1)) / _col1), 0.5) (type: double), power(((_col2 - ((_col3 * _col3) / _col1)) / _col1), 0.5) (type: double), power(((_col2 - ((_col3 * _col3) / _col1)) / if((_col1 = 1L), null, (_col1 - 1))), 0.5) (type: double)
+                  expressions: (_col0 / _col1) (type: double), ((_col2 - ((_col3 * _col3) / _col4)) / _col4) (type: double), ((_col2 - ((_col3 * _col3) / _col4)) / _col4) (type: double), ((_col2 - ((_col3 * _col3) / _col4)) / if((_col4 = 1L), null, (_col4 - 1))) (type: double), power(((_col2 - ((_col3 * _col3) / _col4)) / _col4), 0.5) (type: double), power(((_col2 - ((_col3 * _col3) / _col4)) / _col4), 0.5) (type: double), power(((_col2 - ((_col3 * _col3) / _col4)) / _col4), 0.5) (type: double), power(((_col2 - ((_col3 * _col3) / _col4)) / if((_col4 = 1L), null, (_col4 - 1))), 0.5) (type: double)
                   outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                   Statistics: Num rows: 1 Data size: 64 Basic stats: COMPLETE Column stats: COMPLETE
                   File Output Operator
@@ -1104,18 +1104,18 @@ STAGE PLANS:
                           selectExpressions: CastLongToDouble(col 3:bigint) -> 16:double, DoubleColMultiplyDoubleColumn(col 17:double, col 18:double)(children: CastLongToDouble(col 3:bigint) -> 17:double, CastLongToDouble(col 3:bigint) -> 18:double) -> 19:double
                       Statistics: Num rows: 12288 Data size: 1210980 Basic stats: COMPLETE Column stats: COMPLETE
                       Group By Operator
-                        aggregations: sum(_col0), count(_col0), sum(_col4), sum(_col3), count(), sum(_col1), min(_col2)
+                        aggregations: sum(_col0), count(_col0), sum(_col4), sum(_col3), count(_col3), count(), sum(_col1), min(_col2)
                         Group By Vectorization:
-                            aggregators: VectorUDAFSumLong(col 3:bigint) -> bigint, VectorUDAFCount(col 3:bigint) -> bigint, VectorUDAFSumDouble(col 19:double) -> double, VectorUDAFSumDouble(col 16:double) -> double, VectorUDAFCountStar(*) -> bigint, VectorUDAFSumDouble(col 4:float) -> double, VectorUDAFMinLong(col 0:tinyint) -> tinyint
+                            aggregators: VectorUDAFSumLong(col 3:bigint) -> bigint, VectorUDAFCount(col 3:bigint) -> bigint, VectorUDAFSumDouble(col 19:double) -> double, VectorUDAFSumDouble(col 16:double) -> double, VectorUDAFCount(col 16:double) -> bigint, VectorUDAFCountStar(*) -> bigint, VectorUDAFSumDouble(col 4:float) -> double, VectorUDAFMinLong(col 0:tinyint) -> tinyint
                             className: VectorGroupByOperator
                             groupByMode: HASH
                             native: false
                             vectorProcessingMode: HASH
-                            projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6]
+                            projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6, 7]
                         minReductionHashAggr: 0.99
                         mode: hash
-                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
-                        Statistics: Num rows: 1 Data size: 52 Basic stats: COMPLETE Column stats: COMPLETE
+                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
+                        Statistics: Num rows: 1 Data size: 60 Basic stats: COMPLETE Column stats: COMPLETE
                         Reduce Output Operator
                           null sort order: 
                           sort order: 
@@ -1123,9 +1123,9 @@ STAGE PLANS:
                               className: VectorReduceSinkEmptyKeyOperator
                               native: true
                               nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
-                              valueColumns: 0:bigint, 1:bigint, 2:double, 3:double, 4:bigint, 5:double, 6:tinyint
-                          Statistics: Num rows: 1 Data size: 52 Basic stats: COMPLETE Column stats: COMPLETE
-                          value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: double), _col3 (type: double), _col4 (type: bigint), _col5 (type: double), _col6 (type: tinyint)
+                              valueColumns: 0:bigint, 1:bigint, 2:double, 3:double, 4:bigint, 5:bigint, 6:double, 7:tinyint
+                          Statistics: Num rows: 1 Data size: 60 Basic stats: COMPLETE Column stats: COMPLETE
+                          value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: double), _col3 (type: double), _col4 (type: bigint), _col5 (type: bigint), _col6 (type: double), _col7 (type: tinyint)
             Execution mode: vectorized, llap
             LLAP IO: all inputs
             Map Vectorization:
@@ -1154,31 +1154,31 @@ STAGE PLANS:
                 usesVectorUDFAdaptor: false
                 vectorized: true
                 rowBatchContext:
-                    dataColumnCount: 7
-                    dataColumns: VALUE._col0:bigint, VALUE._col1:bigint, VALUE._col2:double, VALUE._col3:double, VALUE._col4:bigint, VALUE._col5:double, VALUE._col6:tinyint
+                    dataColumnCount: 8
+                    dataColumns: VALUE._col0:bigint, VALUE._col1:bigint, VALUE._col2:double, VALUE._col3:double, VALUE._col4:bigint, VALUE._col5:bigint, VALUE._col6:double, VALUE._col7:tinyint
                     partitionColumnCount: 0
                     scratchColumnTypeNames: []
             Reduce Operator Tree:
               Group By Operator
-                aggregations: sum(VALUE._col0), count(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3), count(VALUE._col4), sum(VALUE._col5), min(VALUE._col6)
+                aggregations: sum(VALUE._col0), count(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3), count(VALUE._col4), count(VALUE._col5), sum(VALUE._col6), min(VALUE._col7)
                 Group By Vectorization:
-                    aggregators: VectorUDAFSumLong(col 0:bigint) -> bigint, VectorUDAFCountMerge(col 1:bigint) -> bigint, VectorUDAFSumDouble(col 2:double) -> double, VectorUDAFSumDouble(col 3:double) -> double, VectorUDAFCountMerge(col 4:bigint) -> bigint, VectorUDAFSumDouble(col 5:double) -> double, VectorUDAFMinLong(col 6:tinyint) -> tinyint
+                    aggregators: VectorUDAFSumLong(col 0:bigint) -> bigint, VectorUDAFCountMerge(col 1:bigint) -> bigint, VectorUDAFSumDouble(col 2:double) -> double, VectorUDAFSumDouble(col 3:double) -> double, VectorUDAFCountMerge(col 4:bigint) -> bigint, VectorUDAFCountMerge(col 5:bigint) -> bigint, VectorUDAFSumDouble(col 6:double) -> double, VectorUDAFMinLong(col 7:tinyint) -> tinyint
                     className: VectorGroupByOperator
                     groupByMode: MERGEPARTIAL
                     native: false
                     vectorProcessingMode: GLOBAL
-                    projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6]
+                    projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6, 7]
                 mode: mergepartial
-                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
-                Statistics: Num rows: 1 Data size: 52 Basic stats: COMPLETE Column stats: COMPLETE
+                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
+                Statistics: Num rows: 1 Data size: 60 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
-                  expressions: (UDFToDouble(_col0) / _col1) (type: double), (- (UDFToDouble(_col0) / _col1)) (type: double), (-6432.0D + (UDFToDouble(_col0) / _col1)) (type: double), power(((_col2 - ((_col3 * _col3) / _col1)) / _col1), 0.5) (type: double), (- (-6432.0D + (UDFToDouble(_col0) / _col1))) (type: double), ((- (-6432.0D + (UDFToDouble(_col0) / _col1))) + (-6432.0D + (UDFToDouble(_col0) / _col1))) (type: double), ((_col2 - ((_col3 * _col3) / _col1)) / if((_col1 = 1L), null, (_col1 - 1))) (type: double), (- (-6432.0D + (UDFToDouble(_col0) / _col1))) (type: double), (-6432.0D + (- (-6432.0D + (UDFToDouble(_col0) / _col1)))) (type: double), (- (-6432.0D + (UDFToDouble(_col0) / _col1))) (type: double), ((- (-6432.0D + (UDFToDouble(_col0) / _col1))) / (- (-6432.0D + (UDFToDouble(_col0) / _col1)))) (type: double), _col4 (type: bigint), _col5 (type: double), (((_col2 - ((_col3 * _col3) / _col1)) / if((_col1 = 1L), null, (_col1 - 1))) % power(((_col2 - ((_col3 * _col3) / _col1)) / _col1), 0.5)) (type: double), (- ((_col2 - ((_col3 * _col3) / _col1)) / if((_col1 = 1L), null, (_col1 - 1)))) (type: double), ((- (-6432.0D + (UDFToDouble(_col0) / _col1))) * (- (UDFToDouble(_col0) / _col1))) (type: double), _col6 (type: tinyint), (- _col6) (type: tinyint)
+                  expressions: (UDFToDouble(_col0) / _col1) (type: double), (- (UDFToDouble(_col0) / _col1)) (type: double), (-6432.0D + (UDFToDouble(_col0) / _col1)) (type: double), power(((_col2 - ((_col3 * _col3) / _col4)) / _col4), 0.5) (type: double), (- (-6432.0D + (UDFToDouble(_col0) / _col1))) (type: double), ((- (-6432.0D + (UDFToDouble(_col0) / _col1))) + (-6432.0D + (UDFToDouble(_col0) / _col1))) (type: double), ((_col2 - ((_col3 * _col3) / _col4)) / if((_col4 = 1L), null, (_col4 - 1))) (type: double), (- (-6432.0D + (UDFToDouble(_col0) / _col1))) (type: double), (-6432.0D + (- (-6432.0D + (UDFToDouble(_col0) / _col1)))) (type: double), (- (-6432.0D + (UDFToDouble(_col0) / _col1))) (type: double), ((- (-6432.0D + (UDFToDouble(_col0) / _col1))) / (- (-6432.0D + (UDFToDouble(_col0) / _col1)))) (type: double), _col5 (type: bigint), _col6 (type: double), (((_col2 - ((_col3 * _col3) / _col4)) / if((_col4 = 1L), null, (_col4 - 1))) % power(((_col2 - ((_col3 * _col3) / _col4)) / _col4), 0.5)) (type: double), (- ((_col2 - ((_col3 * _col3) / _col4)) / if((_col4 = 1L), null, (_col4 - 1)))) (type: double), ((- (-6432.0D + (UDFToDouble(_col0) / _col1))) * (- (UDFToDouble(_col0) / _col1))) (type: double), _col7 (type: tinyint), (- _col7) (type: tinyint)
                   outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
                   Select Vectorization:
                       className: VectorSelectOperator
                       native: true
-                      projectedOutputColumnNums: [8, 11, 14, 19, 23, 31, 38, 42, 47, 51, 60, 4, 5, 73, 81, 89, 6, 90]
-                      selectExpressions: DoubleColDivideLongColumn(col 7:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 7:double) -> 8:double, DoubleColUnaryMinus(col 10:double)(children: DoubleColDivideLongColumn(col 9:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 9:double) -> 10:double) -> 11:double, DoubleScalarAddDoubleColumn(val -6432.0, col 13:double)(children: DoubleColDivideLongColumn(col 12:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 12:double) -> 13:double) -> 14:double, FuncPowerDoubleToDouble(col 18:double)(children: DoubleColDivideLongColumn(col 17:double, col 1:bigint)(children: DoubleColSubtractDoubleColumn(col 2:double, col 16:double)(children: DoubleColDivideLongColumn(col 15:double, col 1:bigint)(children: DoubleColMultiplyDoubleColumn(col 3:double, col 3:double) -> 15:double) -> 16:double) -> 17:double) -> 18:double) -> 19:double, DoubleColUnaryMinus(col 22:double)(children: DoubleScalarAddDoubleColumn(val -6432.0, col 21:double)(children: DoubleColDivideLongColumn(col 20:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 20:double) -> 21:double) -> 22:double) -> 23:double, DoubleColAddDoubleColumn(col 27:double, col 30:double)(children: DoubleColUnaryMinus(col 26:double)(children: DoubleScalarAddDoubleColumn(val -6432.0, col 25:double)(children: DoubleColDivideLongColumn(col 24:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 24:double) -> 25:double) -> 26:double) -> 27:double, DoubleScalarAddDoubleColumn(val -6432.0, col 29:double)(children: DoubleColDivideLongColumn(col 28:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 28:double) -> 29:double) -> 30:double) -> 31:double, DoubleColDivideLongColumn(col 34:double, col 37:bigint)(children: DoubleColSubtractDoubleColumn(col 2:double, col 33:double)(children: DoubleColDivideLongColumn(col 32:double, col 1:bigint)(children: DoubleColMultiplyDoubleColumn(col 3:double, col 3:double) -> 32:double) -> 33:double) -> 34:double, IfExprNullCondExpr(col 35:boolean, null, col 36:bigint)(children: LongColEqualLongScalar(col 1:bigint, val 1) -> 35:boolean, LongColSubtractLongScalar(col 1:bigint, val 1) -> 36:bigint) -> 37:bigint) -> 38:double, DoubleColUnaryMinus(col 41:double)(children: DoubleScalarAddDoubleColumn(val -6432.0, col 40:double)(children: DoubleColDivideLongColumn(col 39:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 39:double) -> 40:double) -> 41:double) -> 42:double, DoubleScalarAddDoubleColumn(val -6432.0, col 46:double)(children: DoubleColUnaryMinus(col 45:double)(children: DoubleScalarAddDoubleColumn(val -6432.0, col 44:double)(children: DoubleColDivideLongColumn(col 43:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 43:double) -> 44:double) -> 45:double) -> 46:double) -> 47:double, DoubleColUnaryMinus(col 50:double)(children: DoubleScalarAddDoubleColumn(val -6432.0, col 49:double)(children: DoubleColDivideLongColumn(col 48:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 48:double) -> 49:double) -> 50:double) -> 51:double, DoubleColDivideDoubleColumn(col 55:double, col 59:double)(children: DoubleColUnaryMinus(col 54:double)(children: DoubleScalarAddDoubleColumn(val -6432.0, col 53:double)(children: DoubleColDivideLongColumn(col 52:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 52:double) -> 53:double) -> 54:double) -> 55:double, DoubleColUnaryMinus(col 58:double)(children: DoubleScalarAddDoubleColumn(val -6432.0, col 57:double)(children: DoubleColDivideLongColumn(col 56:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 56:double) -> 57:double) -> 58:double) -> 59:double) -> 60:double, DoubleColModuloDoubleColumn(col 67:double, col 72:double)(children: DoubleColDivideLongColumn(col 63:double, col 66:bigint)(children: DoubleColSubtractDoubleColumn(col 2:double, col 62:double)(children: DoubleColDivideLongColumn(col 61:double, col 1:bigint)(children: DoubleColMultiplyDoubleColumn(col 3:double, col 3:double) -> 61:double) -> 62:double) -> 63:double, IfExprNullCondExpr(col 64:boolean, null, col 65:bigint)(children: LongColEqualLongScalar(col 1:bigint, val 1) -> 64:boolean, LongColSubtractLongScalar(col 1:bigint, val 1) -> 65:bigint) -> 66:bigint) -> 67:double, FuncPowerDoubleToDouble(col 71:double)(children: DoubleColDivideLongColumn(col 70:double, col 1:bigint)(children: DoubleColSubtractDoubleColumn(col 2:double, col 69:double)(children: DoubleColDivideLongColumn(col 68:double, col 1:bigint)(children: DoubleColMultiplyDoubleColumn(col 3:double, col 3:double) -> 68:double) -> 69:double) -> 70:double) -> 71:double) -> 72:double) -> 73:double, DoubleColUnaryMinus(col 80:double)(children: DoubleColDivideLongColumn(col 76:double, col 79:bigint)(children: DoubleColSubtractDoubleColumn(col 2:double, col 75:double)(children: DoubleColDivideLongColumn(col 74:double, col 1:bigint)(children: DoubleColMultiplyDoubleColumn(col 3:double, col 3:double) -> 74:double) -> 75:double) -> 76:double, IfExprNullCondExpr(col 77:boolean, null, col 78:bigint)(children: LongColEqualLongScalar(col 1:bigint, val 1) -> 77:boolean, LongColSubtractLongScalar(col 1:bigint, val 1) -> 78:bigint) -> 79:bigint) -> 80:double) -> 81:double, DoubleColMultiplyDoubleColumn(col 85:double, col 88:double)(children: DoubleColUnaryMinus(col 84:double)(children: DoubleScalarAddDoubleColumn(val -6432.0, col 83:double)(children: DoubleColDivideLongColumn(col 82:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 82:double) -> 83:double) -> 84:double) -> 85:double, DoubleColUnaryMinus(col 87:double)(children: DoubleColDivideLongColumn(col 86:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 86:double) -> 87:double) -> 88:double) -> 89:double, LongColUnaryMinus(col 6:tinyint) -> 90:tinyint
+                      projectedOutputColumnNums: [9, 12, 15, 20, 24, 32, 39, 43, 48, 52, 61, 5, 6, 74, 82, 90, 7, 91]
+                      selectExpressions: DoubleColDivideLongColumn(col 8:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 8:double) -> 9:double, DoubleColUnaryMinus(col 11:double)(children: DoubleColDivideLongColumn(col 10:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 10:double) -> 11:double) -> 12:double, DoubleScalarAddDoubleColumn(val -6432.0, col 14:double)(children: DoubleColDivideLongColumn(col 13:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 13:double) -> 14:double) -> 15:double, FuncPowerDoubleToDouble(col 19:double)(children: DoubleColDivideLongColumn(col 18:double, col 4:bigint)(children: DoubleColSubtractDoubleColumn(col 2:double, col 17:double)(children: DoubleColDivideLongColumn(col 16:double, col 4:bigint)(children: DoubleColMultiplyDoubleColumn(col 3:double, col 3:double) -> 16:double) -> 17:double) -> 18:double) -> 19:double) -> 20:double, DoubleColUnaryMinus(col 23:double)(children: DoubleScalarAddDoubleColumn(val -6432.0, col 22:double)(children: DoubleColDivideLongColumn(col 21:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 21:double) -> 22:double) -> 23:double) -> 24:double, DoubleColAddDoubleColumn(col 28:double, col 31:double)(children: DoubleColUnaryMinus(col 27:double)(children: DoubleScalarAddDoubleColumn(val -6432.0, col 26:double)(children: DoubleColDivideLongColumn(col 25:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 25:double) -> 26:double) -> 27:double) -> 28:double, DoubleScalarAddDoubleColumn(val -6432.0, col 30:double)(children: DoubleColDivideLongColumn(col 29:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 29:double) -> 30:double) -> 31:double) -> 32:double, DoubleColDivideLongColumn(col 35:double, col 38:bigint)(children: DoubleColSubtractDoubleColumn(col 2:double, col 34:double)(children: DoubleColDivideLongColumn(col 33:double, col 4:bigint)(children: DoubleColMultiplyDoubleColumn(col 3:double, col 3:double) -> 33:double) -> 34:double) -> 35:double, IfExprNullCondExpr(col 36:boolean, null, col 37:bigint)(children: LongColEqualLongScalar(col 4:bigint, val 1) -> 36:boolean, LongColSubtractLongScalar(col 4:bigint, val 1) -> 37:bigint) -> 38:bigint) -> 39:double, DoubleColUnaryMinus(col 42:double)(children: DoubleScalarAddDoubleColumn(val -6432.0, col 41:double)(children: DoubleColDivideLongColumn(col 40:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 40:double) -> 41:double) -> 42:double) -> 43:double, DoubleScalarAddDoubleColumn(val -6432.0, col 47:double)(children: DoubleColUnaryMinus(col 46:double)(children: DoubleScalarAddDoubleColumn(val -6432.0, col 45:double)(children: DoubleColDivideLongColumn(col 44:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 44:double) -> 45:double) -> 46:double) -> 47:double) -> 48:double, DoubleColUnaryMinus(col 51:double)(children: DoubleScalarAddDoubleColumn(val -6432.0, col 50:double)(children: DoubleColDivideLongColumn(col 49:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 49:double) -> 50:double) -> 51:double) -> 52:double, DoubleColDivideDoubleColumn(col 56:double, col 60:double)(children: DoubleColUnaryMinus(col 55:double)(children: DoubleScalarAddDoubleColumn(val -6432.0, col 54:double)(children: DoubleColDivideLongColumn(col 53:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 53:double) -> 54:double) -> 55:double) -> 56:double, DoubleColUnaryMinus(col 59:double)(children: DoubleScalarAddDoubleColumn(val -6432.0, col 58:double)(children: DoubleColDivideLongColumn(col 57:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 57:double) -> 58:double) -> 59:double) -> 60:double) -> 61:double, DoubleColModuloDoubleColumn(col 68:double, col 73:double)(children: DoubleColDivideLongColumn(col 64:double, col 67:bigint)(children: DoubleColSubtractDoubleColumn(col 2:double, col 63:double)(children: DoubleColDivideLongColumn(col 62:double, col 4:bigint)(children: DoubleColMultiplyDoubleColumn(col 3:double, col 3:double) -> 62:double) -> 63:double) -> 64:double, IfExprNullCondExpr(col 65:boolean, null, col 66:bigint)(children: LongColEqualLongScalar(col 4:bigint, val 1) -> 65:boolean, LongColSubtractLongScalar(col 4:bigint, val 1) -> 66:bigint) -> 67:bigint) -> 68:double, FuncPowerDoubleToDouble(col 72:double)(children: DoubleColDivideLongColumn(col 71:double, col 4:bigint)(children: DoubleColSubtractDoubleColumn(col 2:double, col 70:double)(children: DoubleColDivideLongColumn(col 69:double, col 4:bigint)(children: DoubleColMultiplyDoubleColumn(col 3:double, col 3:double) -> 69:double) -> 70:double) -> 71:double) -> 72:double) -> 73:double) -> 74:double, DoubleColUnaryMinus(col 81:double)(children: DoubleColDivideLongColumn(col 77:double, col 80:bigint)(children: DoubleColSubtractDoubleColumn(col 2:double, col 76:double)(children: DoubleColDivideLongColumn(col 75:double, col 4:bigint)(children: DoubleColMultiplyDoubleColumn(col 3:double, col 3:double) -> 75:double) -> 76:double) -> 77:double, IfExprNullCondExpr(col 78:boolean, null, col 79:bigint)(children: LongColEqualLongScalar(col 4:bigint, val 1) -> 78:boolean, LongColSubtractLongScalar(col 4:bigint, val 1) -> 79:bigint) -> 80:bigint) -> 81:double) -> 82:double, DoubleColMultiplyDoubleColumn(col 86:double, col 89:double)(children: DoubleColUnaryMinus(col 85:double)(children: DoubleScalarAddDoubleColumn(val -6432.0, col 84:double)(children: DoubleColDivideLongColumn(col 83:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 83:double) -> 84:double) -> 85:double) -> 86:double, DoubleColUnaryMinus(col 88:double)(children: DoubleColDivideLongColumn(col 87:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 87:double) -> 88:double) -> 89:double) -> 90:double, LongColUnaryMinus(col 7:tinyint) -> 91:tinyint
                   Statistics: Num rows: 1 Data size: 136 Basic stats: COMPLETE Column stats: COMPLETE
                   File Output Operator
                     compressed: false
diff --git a/ql/src/test/results/clientpositive/llap/vectorization_1.q.out b/ql/src/test/results/clientpositive/llap/vectorization_1.q.out
index fb6a5972b8..f8eaa6c757 100644
--- a/ql/src/test/results/clientpositive/llap/vectorization_1.q.out
+++ b/ql/src/test/results/clientpositive/llap/vectorization_1.q.out
@@ -86,9 +86,9 @@ STAGE PLANS:
                           selectExpressions: CastLongToDouble(col 0:tinyint) -> 15:double, DoubleColMultiplyDoubleColumn(col 16:double, col 17:double)(children: CastLongToDouble(col 0:tinyint) -> 16:double, CastLongToDouble(col 0:tinyint) -> 17:double) -> 18:double, DoubleColMultiplyDoubleColumn(col 5:double, col 5:double) -> 19:double
                       Statistics: Num rows: 12288 Data size: 330276 Basic stats: COMPLETE Column stats: COMPLETE
                       Group By Operator
-                        aggregations: sum(_col5), sum(_col4), count(_col0), sum(_col1), max(_col0), max(_col2), sum(_col6), sum(_col3), count(_col3), count(_col2)
+                        aggregations: sum(_col5), sum(_col4), count(_col4), sum(_col1), max(_col0), max(_col2), sum(_col6), sum(_col3), count(_col3), count(_col2)
                         Group By Vectorization:
-                            aggregators: VectorUDAFSumDouble(col 18:double) -> double, VectorUDAFSumDouble(col 15:double) -> double, VectorUDAFCount(col 0:tinyint) -> bigint, VectorUDAFSumDouble(col 4:float) -> double, VectorUDAFMaxLong(col 0:tinyint) -> tinyint, VectorUDAFMaxLong(col 2:int) -> int, VectorUDAFSumDouble(col 19:double) -> double, VectorUDAFSumDouble(col 5:double) -> double, VectorUDAFCount(col 5:double) -> bigint, VectorUDAFCount(col 2:int) -> bigint
+                            aggregators: VectorUDAFSumDouble(col 18:double) -> double, VectorUDAFSumDouble(col 15:double) -> double, VectorUDAFCount(col 15:double) -> bigint, VectorUDAFSumDouble(col 4:float) -> double, VectorUDAFMaxLong(col 0:tinyint) -> tinyint, VectorUDAFMaxLong(col 2:int) -> int, VectorUDAFSumDouble(col 19:double) -> double, VectorUDAFSumDouble(col 5:double) -> double, VectorUDAFCount(col 5:double) -> bigint, VectorUDAFCount(col 2:int) -> bigint
                             className: VectorGroupByOperator
                             groupByMode: HASH
                             native: false
diff --git a/ql/src/test/results/clientpositive/llap/vectorization_12.q.out b/ql/src/test/results/clientpositive/llap/vectorization_12.q.out
index 2317d83cdf..dbae880e0d 100644
--- a/ql/src/test/results/clientpositive/llap/vectorization_12.q.out
+++ b/ql/src/test/results/clientpositive/llap/vectorization_12.q.out
@@ -109,20 +109,20 @@ STAGE PLANS:
                           selectExpressions: CastLongToDouble(col 3:bigint) -> 14:double, DoubleColMultiplyDoubleColumn(col 15:double, col 16:double)(children: CastLongToDouble(col 3:bigint) -> 15:double, CastLongToDouble(col 3:bigint) -> 16:double) -> 17:double, DoubleColMultiplyDoubleColumn(col 5:double, col 5:double) -> 18:double
                       Statistics: Num rows: 1903 Data size: 236052 Basic stats: COMPLETE Column stats: COMPLETE
                       Group By Operator
-                        aggregations: count(_col0), sum(_col5), sum(_col4), sum(_col3), count(_col3), sum(_col0), sum(_col6)
+                        aggregations: count(_col0), sum(_col5), sum(_col4), count(_col4), sum(_col3), count(_col3), sum(_col0), sum(_col6)
                         Group By Vectorization:
-                            aggregators: VectorUDAFCount(col 3:bigint) -> bigint, VectorUDAFSumDouble(col 17:double) -> double, VectorUDAFSumDouble(col 14:double) -> double, VectorUDAFSumDouble(col 5:double) -> double, VectorUDAFCount(col 5:double) -> bigint, VectorUDAFSumLong(col 3:bigint) -> bigint, VectorUDAFSumDouble(col 18:double) -> double
+                            aggregators: VectorUDAFCount(col 3:bigint) -> bigint, VectorUDAFSumDouble(col 17:double) -> double, VectorUDAFSumDouble(col 14:double) -> double, VectorUDAFCount(col 14:double) -> bigint, VectorUDAFSumDouble(col 5:double) -> double, VectorUDAFCount(col 5:double) -> bigint, VectorUDAFSumLong(col 3:bigint) -> bigint, VectorUDAFSumDouble(col 18:double) -> double
                             className: VectorGroupByOperator
                             groupByMode: HASH
                             keyExpressions: col 5:double, col 3:bigint, col 6:string, col 10:boolean
                             native: false
                             vectorProcessingMode: HASH
-                            projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6]
+                            projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6, 7]
                         keys: _col3 (type: double), _col0 (type: bigint), _col2 (type: string), _col1 (type: boolean)
                         minReductionHashAggr: 0.4
                         mode: hash
-                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
-                        Statistics: Num rows: 1903 Data size: 268676 Basic stats: COMPLETE Column stats: COMPLETE
+                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11
+                        Statistics: Num rows: 1903 Data size: 283900 Basic stats: COMPLETE Column stats: COMPLETE
                         Reduce Output Operator
                           key expressions: _col0 (type: double), _col1 (type: bigint), _col2 (type: string), _col3 (type: boolean)
                           null sort order: zzzz
@@ -133,9 +133,9 @@ STAGE PLANS:
                               keyColumns: 0:double, 1:bigint, 2:string, 3:boolean
                               native: true
                               nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
-                              valueColumns: 4:bigint, 5:double, 6:double, 7:double, 8:bigint, 9:bigint, 10:double
-                          Statistics: Num rows: 1903 Data size: 268676 Basic stats: COMPLETE Column stats: COMPLETE
-                          value expressions: _col4 (type: bigint), _col5 (type: double), _col6 (type: double), _col7 (type: double), _col8 (type: bigint), _col9 (type: bigint), _col10 (type: double)
+                              valueColumns: 4:bigint, 5:double, 6:double, 7:bigint, 8:double, 9:bigint, 10:bigint, 11:double
+                          Statistics: Num rows: 1903 Data size: 283900 Basic stats: COMPLETE Column stats: COMPLETE
+                          value expressions: _col4 (type: bigint), _col5 (type: double), _col6 (type: double), _col7 (type: bigint), _col8 (type: double), _col9 (type: bigint), _col10 (type: bigint), _col11 (type: double)
             Execution mode: vectorized, llap
             LLAP IO: all inputs
             Map Vectorization:
@@ -164,33 +164,33 @@ STAGE PLANS:
                 usesVectorUDFAdaptor: false
                 vectorized: true
                 rowBatchContext:
-                    dataColumnCount: 11
-                    dataColumns: KEY._col0:double, KEY._col1:bigint, KEY._col2:string, KEY._col3:boolean, VALUE._col0:bigint, VALUE._col1:double, VALUE._col2:double, VALUE._col3:double, VALUE._col4:bigint, VALUE._col5:bigint, VALUE._col6:double
+                    dataColumnCount: 12
+                    dataColumns: KEY._col0:double, KEY._col1:bigint, KEY._col2:string, KEY._col3:boolean, VALUE._col0:bigint, VALUE._col1:double, VALUE._col2:double, VALUE._col3:bigint, VALUE._col4:double, VALUE._col5:bigint, VALUE._col6:bigint, VALUE._col7:double
                     partitionColumnCount: 0
                     scratchColumnTypeNames: []
             Reduce Operator Tree:
               Group By Operator
-                aggregations: count(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3), count(VALUE._col4), sum(VALUE._col5), sum(VALUE._col6)
+                aggregations: count(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2), count(VALUE._col3), sum(VALUE._col4), count(VALUE._col5), sum(VALUE._col6), sum(VALUE._col7)
                 Group By Vectorization:
-                    aggregators: VectorUDAFCountMerge(col 4:bigint) -> bigint, VectorUDAFSumDouble(col 5:double) -> double, VectorUDAFSumDouble(col 6:double) -> double, VectorUDAFSumDouble(col 7:double) -> double, VectorUDAFCountMerge(col 8:bigint) -> bigint, VectorUDAFSumLong(col 9:bigint) -> bigint, VectorUDAFSumDouble(col 10:double) -> double
+                    aggregators: VectorUDAFCountMerge(col 4:bigint) -> bigint, VectorUDAFSumDouble(col 5:double) -> double, VectorUDAFSumDouble(col 6:double) -> double, VectorUDAFCountMerge(col 7:bigint) -> bigint, VectorUDAFSumDouble(col 8:double) -> double, VectorUDAFCountMerge(col 9:bigint) -> bigint, VectorUDAFSumLong(col 10:bigint) -> bigint, VectorUDAFSumDouble(col 11:double) -> double
                     className: VectorGroupByOperator
                     groupByMode: MERGEPARTIAL
                     keyExpressions: col 0:double, col 1:bigint, col 2:string, col 3:boolean
                     native: false
                     vectorProcessingMode: MERGE_PARTIAL
-                    projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6]
+                    projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6, 7]
                 keys: KEY._col0 (type: double), KEY._col1 (type: bigint), KEY._col2 (type: string), KEY._col3 (type: boolean)
                 mode: mergepartial
-                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
-                Statistics: Num rows: 1903 Data size: 268676 Basic stats: COMPLETE Column stats: COMPLETE
+                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11
+                Statistics: Num rows: 1903 Data size: 283900 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
-                  expressions: _col1 (type: bigint), _col3 (type: boolean), _col2 (type: string), _col0 (type: double), (-6432.0D * _col0) (type: double), (- _col1) (type: bigint), _col4 (type: bigint), (_col1 * _col4) (type: bigint), power(((_col5 - ((_col6 * _col6) / _col4)) / if((_col4 = 1L), null, (_col4 - 1))), 0.5) (type: double), ((-6432.0D * _col0) / -6432.0D) (type: double), (- ((-6432.0D * _col0) / -6432.0D)) (type: double), (_col7 / _col8) (type: double), (- (-6432.0D * _col0)) (type: double), (-5638.15 + CAST( _col1 AS decimal(19,0))) (type: decimal(22,2)), _col9 (type: bigint), ((_col7 / _col8) / (-6432.0D * _col0)) (type: double), (((-6432.0D * _col0) / -6432.0D) + (- (-6432.0D * _col0))) (type: double), power(((_col10 - ((_col7 * _col7) / _col8)) / _col8), 0.5) (type: double)
+                  expressions: _col1 (type: bigint), _col3 (type: boolean), _col2 (type: string), _col0 (type: double), (-6432.0D * _col0) (type: double), (- _col1) (type: bigint), _col4 (type: bigint), (_col1 * _col4) (type: bigint), power(((_col5 - ((_col6 * _col6) / _col7)) / if((_col7 = 1L), null, (_col7 - 1))), 0.5) (type: double), ((-6432.0D * _col0) / -6432.0D) (type: double), (- ((-6432.0D * _col0) / -6432.0D)) (type: double), (_col8 / _col9) (type: double), (- (-6432.0D * _col0)) (type: double), (-5638.15 + CAST( _col1 AS decimal(19,0))) (type: decimal(22,2)), _col10 (type: bigint), ((_col8 / _col9) / (-6432.0D * _col0)) (type: double), (((-6432.0D * _col0) / -6432.0D) + (- (-6432.0D * _col0))) (type: double), power(((_col11 - ((_col8 * _col8) / _col9)) / _col9), 0.5) (type: double)
                   outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col18, _col19
                   Select Vectorization:
                       className: VectorSelectOperator
                       native: true
-                      projectedOutputColumnNums: [1, 3, 2, 0, 11, 12, 4, 13, 21, 23, 26, 27, 29, 31, 9, 34, 39, 44]
-                      selectExpressions: DoubleScalarMultiplyDoubleColumn(val -6432.0, col 0:double) -> 11:double, LongColUnaryMinus(col 1:bigint) -> 12:bigint, LongColMultiplyLongColumn(col 1:bigint, col 4:bigint) -> 13:bigint, FuncPowerDoubleToDouble(col 20:double)(children: DoubleColDivideLongColumn(col 16:double, col 19:bigint)(children: DoubleColSubtractDoubleColumn(col 5:double, col 15:double)(children: DoubleColDivideLongColumn(col 14:double, col 4:bigint)(children: DoubleColMultiplyDoubleColumn(col 6:double, col 6:double) -> 14:double) -> 15:double) -> 16:double, IfExprNullCondExpr(col 17:boolean, null, col 18:bigint)(children: LongColEqualLongScalar(col 4:bigint, val 1) -> 17:boolean, LongColSubtractLongScalar(col 4:bigint, val 1) -> 18:bigint) -> 19:bigint) -> 20:double) -> 21:double, DoubleColDivideDoubleScalar(col 22:double, val -6432.0)(children: DoubleScalarMultiplyDoubleColumn(val -6432.0, col 0:double) -> 22:double) -> 23:double, DoubleColUnaryMinus(col 25:double)(children: DoubleColDivideDoubleScalar(col 24:double, val -6432.0)(children: DoubleScalarMultiplyDoubleColumn(val -6432.0, col 0:double) -> 24:double) -> 25:double) -> 26:double, DoubleColDivideLongColumn(col 7:double, col 8:bigint) -> 27:double, DoubleColUnaryMinus(col 28:double)(children: DoubleScalarMultiplyDoubleColumn(val -6432.0, col 0:double) -> 28:double) -> 29:double, DecimalScalarAddDecimalColumn(val -5638.15, col 30:decimal(19,0))(children: CastLongToDecimal(col 1:bigint) -> 30:decimal(19,0)) -> 31:decimal(22,2), DoubleColDivideDoubleColumn(col 32:double, col 33:double)(children: DoubleColDivideLongColumn(col 7:double, col 8:bigint) -> 32:double, DoubleScalarMultiplyDoubleColumn(val -6432.0, col 0:double) -> 33:double) -> 34:double, DoubleColAddDoubleColumn(col 36:double, col 38:double)(children: DoubleColDivideDoubleScalar(col 35:double, val -6432.0)(children: DoubleScalarMultiplyDoubleColumn(val -6432.0, col 0:double) -> 35:double) -> 36:double, DoubleColUnaryMinus(col 37:double)(children: DoubleScalarMultiplyDoubleColumn(val -6432.0, col 0:double) -> 37:double) -> 38:double) -> 39:double, FuncPowerDoubleToDouble(col 43:double)(children: DoubleColDivideLongColumn(col 42:double, col 8:bigint)(children: DoubleColSubtractDoubleColumn(col 10:double, col 41:double)(children: DoubleColDivideLongColumn(col 40:double, col 8:bigint)(children: DoubleColMultiplyDoubleColumn(col 7:double, col 7:double) -> 40:double) -> 41:double) -> 42:double) -> 43:double) -> 44:double
+                      projectedOutputColumnNums: [1, 3, 2, 0, 12, 13, 4, 14, 22, 24, 27, 28, 30, 32, 10, 35, 40, 45]
+                      selectExpressions: DoubleScalarMultiplyDoubleColumn(val -6432.0, col 0:double) -> 12:double, LongColUnaryMinus(col 1:bigint) -> 13:bigint, LongColMultiplyLongColumn(col 1:bigint, col 4:bigint) -> 14:bigint, FuncPowerDoubleToDouble(col 21:double)(children: DoubleColDivideLongColumn(col 17:double, col 20:bigint)(children: DoubleColSubtractDoubleColumn(col 5:double, col 16:double)(children: DoubleColDivideLongColumn(col 15:double, col 7:bigint)(children: DoubleColMultiplyDoubleColumn(col 6:double, col 6:double) -> 15:double) -> 16:double) -> 17:double, IfExprNullCondExpr(col 18:boolean, null, col 19:bigint)(children: LongColEqualLongScalar(col 7:bigint, val 1) -> 18:boolean, LongColSubtractLongScalar(col 7:bigint, val 1) -> 19:bigint) -> 20:bigint) -> 21:double) -> 22:double, DoubleColDivideDoubleScalar(col 23:double, val -6432.0)(children: DoubleScalarMultiplyDoubleColumn(val -6432.0, col 0:double) -> 23:double) -> 24:double, DoubleColUnaryMinus(col 26:double)(children: DoubleColDivideDoubleScalar(col 25:double, val -6432.0)(children: DoubleScalarMultiplyDoubleColumn(val -6432.0, col 0:double) -> 25:double) -> 26:double) -> 27:double, DoubleColDivideLongColumn(col 8:double, col 9:bigint) -> 28:double, DoubleColUnaryMinus(col 29:double)(children: DoubleScalarMultiplyDoubleColumn(val -6432.0, col 0:double) -> 29:double) -> 30:double, DecimalScalarAddDecimalColumn(val -5638.15, col 31:decimal(19,0))(children: CastLongToDecimal(col 1:bigint) -> 31:decimal(19,0)) -> 32:decimal(22,2), DoubleColDivideDoubleColumn(col 33:double, col 34:double)(children: DoubleColDivideLongColumn(col 8:double, col 9:bigint) -> 33:double, DoubleScalarMultiplyDoubleColumn(val -6432.0, col 0:double) -> 34:double) -> 35:double, DoubleColAddDoubleColumn(col 37:double, col 39:double)(children: DoubleColDivideDoubleScalar(col 36:double, val -6432.0)(children: DoubleScalarMultiplyDoubleColumn(val -6432.0, col 0:double) -> 36:double) -> 37:double, DoubleColUnaryMinus(col 38:double)(children: DoubleScalarMultiplyDoubleColumn(val -6432.0, col 0:double) -> 38:double) -> 39:double) -> 40:double, FuncPowerDoubleToDouble(col 44:double)(children: DoubleColDivideLongColumn(col 43:double, col 9:bigint)(children: DoubleColSubtractDoubleColumn(col 11:double, col 42:double)(children: DoubleColDivideLongColumn(col 41:double, col 9:bigint)(children: DoubleColMultiplyDoubleColumn(col 8:double, col 8:double) -> 41:double) -> 42:double) -> 43:double) -> 44:double) -> 45:double
                   Statistics: Num rows: 1903 Data size: 573156 Basic stats: COMPLETE Column stats: COMPLETE
                   Reduce Output Operator
                     key expressions: _col3 (type: double), _col0 (type: bigint), _col2 (type: string)
@@ -201,7 +201,7 @@ STAGE PLANS:
                         keyColumns: 0:double, 1:bigint, 2:string
                         native: true
                         nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
-                        valueColumns: 3:boolean, 11:double, 12:bigint, 4:bigint, 13:bigint, 21:double, 23:double, 26:double, 27:double, 29:double, 31:decimal(22,2), 9:bigint, 34:double, 39:double, 44:double
+                        valueColumns: 3:boolean, 12:double, 13:bigint, 4:bigint, 14:bigint, 22:double, 24:double, 27:double, 28:double, 30:double, 32:decimal(22,2), 10:bigint, 35:double, 40:double, 45:double
                     Statistics: Num rows: 1903 Data size: 573156 Basic stats: COMPLETE Column stats: COMPLETE
                     value expressions: _col1 (type: boolean), _col4 (type: double), _col5 (type: bigint), _col6 (type: bigint), _col7 (type: bigint), _col8 (type: double), _col9 (type: double), _col10 (type: double), _col11 (type: double), _col12 (type: double), _col13 (type: decimal(22,2)), _col14 (type: bigint), _col15 (type: double), _col18 (type: double), _col19 (type: double)
         Reducer 3 
diff --git a/ql/src/test/results/clientpositive/llap/vectorization_13.q.out b/ql/src/test/results/clientpositive/llap/vectorization_13.q.out
index b92b7de38d..d1911fdb7f 100644
--- a/ql/src/test/results/clientpositive/llap/vectorization_13.q.out
+++ b/ql/src/test/results/clientpositive/llap/vectorization_13.q.out
@@ -121,9 +121,9 @@ STAGE PLANS:
                             selectExpressions: DoubleColMultiplyDoubleColumn(col 4:double, col 4:double)(children: col 4:float, col 4:float) -> 14:double, CastLongToDouble(col 0:tinyint) -> 15:double, DoubleColMultiplyDoubleColumn(col 17:double, col 18:double)(children: CastLongToDouble(col 0:tinyint) -> 17:double, CastLongToDouble(col 0:tinyint) -> 18:double) -> 19:double
                         Statistics: Num rows: 1386 Data size: 200984 Basic stats: COMPLETE Column stats: COMPLETE
                         Group By Operator
-                          aggregations: max(_col1), sum(_col3), sum(_col6), sum(_col5), count(_col3), sum(_col8), sum(_col7), count(_col1), max(_col3), min(_col1)
+                          aggregations: max(_col1), sum(_col3), sum(_col6), sum(_col5), count(_col5), sum(_col8), sum(_col7), count(_col7), max(_col3), min(_col1)
                           Group By Vectorization:
-                              aggregators: VectorUDAFMaxLong(col 0:tinyint) -> tinyint, VectorUDAFSumDouble(col 4:float) -> double, VectorUDAFSumDouble(col 14:double) -> double, VectorUDAFSumDouble(col 4:double) -> double, VectorUDAFCount(col 4:float) -> bigint, VectorUDAFSumDouble(col 19:double) -> double, VectorUDAFSumDouble(col 15:double) -> double, VectorUDAFCount(col 0:tinyint) -> bigint, VectorUDAFMaxDouble(col 4:float) -> float, VectorUDAFMinLong(col 0:tinyint) -> tinyint
+                              aggregators: VectorUDAFMaxLong(col 0:tinyint) -> tinyint, VectorUDAFSumDouble(col 4:float) -> double, VectorUDAFSumDouble(col 14:double) -> double, VectorUDAFSumDouble(col 4:double) -> double, VectorUDAFCount(col 4:double) -> bigint, VectorUDAFSumDouble(col 19:double) -> double, VectorUDAFSumDouble(col 15:double) -> double, VectorUDAFCount(col 15:double) -> bigint, VectorUDAFMaxDouble(col 4:float) -> float, VectorUDAFMinLong(col 0:tinyint) -> tinyint
                               className: VectorGroupByOperator
                               groupByMode: HASH
                               keyExpressions: col 10:boolean, col 0:tinyint, col 8:timestamp, col 4:float, col 6:string
@@ -501,9 +501,9 @@ STAGE PLANS:
                             selectExpressions: DoubleColMultiplyDoubleColumn(col 4:double, col 4:double)(children: col 4:float, col 4:float) -> 14:double, CastLongToDouble(col 0:tinyint) -> 15:double, DoubleColMultiplyDoubleColumn(col 17:double, col 18:double)(children: CastLongToDouble(col 0:tinyint) -> 17:double, CastLongToDouble(col 0:tinyint) -> 18:double) -> 19:double
                         Statistics: Num rows: 1386 Data size: 200984 Basic stats: COMPLETE Column stats: COMPLETE
                         Group By Operator
-                          aggregations: max(_col1), sum(_col3), sum(_col6), sum(_col5), count(_col3), sum(_col8), sum(_col7), count(_col1), max(_col3), min(_col1)
+                          aggregations: max(_col1), sum(_col3), sum(_col6), sum(_col5), count(_col5), sum(_col8), sum(_col7), count(_col7), max(_col3), min(_col1)
                           Group By Vectorization:
-                              aggregators: VectorUDAFMaxLong(col 0:tinyint) -> tinyint, VectorUDAFSumDouble(col 4:float) -> double, VectorUDAFSumDouble(col 14:double) -> double, VectorUDAFSumDouble(col 4:double) -> double, VectorUDAFCount(col 4:float) -> bigint, VectorUDAFSumDouble(col 19:double) -> double, VectorUDAFSumDouble(col 15:double) -> double, VectorUDAFCount(col 0:tinyint) -> bigint, VectorUDAFMaxDouble(col 4:float) -> float, VectorUDAFMinLong(col 0:tinyint) -> tinyint
+                              aggregators: VectorUDAFMaxLong(col 0:tinyint) -> tinyint, VectorUDAFSumDouble(col 4:float) -> double, VectorUDAFSumDouble(col 14:double) -> double, VectorUDAFSumDouble(col 4:double) -> double, VectorUDAFCount(col 4:double) -> bigint, VectorUDAFSumDouble(col 19:double) -> double, VectorUDAFSumDouble(col 15:double) -> double, VectorUDAFCount(col 15:double) -> bigint, VectorUDAFMaxDouble(col 4:float) -> float, VectorUDAFMinLong(col 0:tinyint) -> tinyint
                               className: VectorGroupByOperator
                               groupByMode: HASH
                               keyExpressions: col 10:boolean, col 0:tinyint, col 8:timestamp, col 4:float, col 6:string
diff --git a/ql/src/test/results/clientpositive/llap/vectorization_14.q.out b/ql/src/test/results/clientpositive/llap/vectorization_14.q.out
index ae9db8a6d4..7038c3a78b 100644
--- a/ql/src/test/results/clientpositive/llap/vectorization_14.q.out
+++ b/ql/src/test/results/clientpositive/llap/vectorization_14.q.out
@@ -111,20 +111,20 @@ STAGE PLANS:
                           selectExpressions: DoubleColUnaryMinus(col 17:double)(children: DoubleScalarAddDoubleColumn(val -26.28, col 5:double) -> 17:double) -> 18:double, DoubleColMultiplyDoubleColumn(col 20:double, col 22:double)(children: DoubleColUnaryMinus(col 19:double)(children: DoubleScalarAddDoubleColumn(val -26.28, col 5:double) -> 19:double) -> 20:double, DoubleColUnaryMinus(col 21:double)(children: DoubleScalarAddDoubleColumn(val -26.28, col 5:double) -> 21:double) -> 22:double) -> 23:double, DoubleColMultiplyDoubleColumn(col 4:double, col 4:double)(children: col 4:float, col 4:float) -> 24:double
                       Statistics: Num rows: 758 Data size: 116802 Basic stats: COMPLETE Column stats: COMPLETE
                       Group By Operator
-                        aggregations: sum(_col6), sum(_col5), count(_col5), max(_col1), sum(_col8), sum(_col7), count(_col1)
+                        aggregations: sum(_col6), sum(_col5), count(_col5), max(_col1), sum(_col8), sum(_col7), count(_col7), count(_col1)
                         Group By Vectorization:
-                            aggregators: VectorUDAFSumDouble(col 23:double) -> double, VectorUDAFSumDouble(col 18:double) -> double, VectorUDAFCount(col 18:double) -> bigint, VectorUDAFMaxDouble(col 4:float) -> float, VectorUDAFSumDouble(col 24:double) -> double, VectorUDAFSumDouble(col 4:double) -> double, VectorUDAFCount(col 4:float) -> bigint
+                            aggregators: VectorUDAFSumDouble(col 23:double) -> double, VectorUDAFSumDouble(col 18:double) -> double, VectorUDAFCount(col 18:double) -> bigint, VectorUDAFMaxDouble(col 4:float) -> float, VectorUDAFSumDouble(col 24:double) -> double, VectorUDAFSumDouble(col 4:double) -> double, VectorUDAFCount(col 4:double) -> bigint, VectorUDAFCount(col 4:float) -> bigint
                             className: VectorGroupByOperator
                             groupByMode: HASH
                             keyExpressions: col 6:string, col 4:float, col 5:double, col 8:timestamp, col 10:boolean
                             native: false
                             vectorProcessingMode: HASH
-                            projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6]
+                            projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6, 7]
                         keys: _col2 (type: string), _col1 (type: float), _col4 (type: double), _col0 (type: timestamp), _col3 (type: boolean)
                         minReductionHashAggr: 0.4
                         mode: hash
-                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11
-                        Statistics: Num rows: 758 Data size: 124466 Basic stats: COMPLETE Column stats: COMPLETE
+                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12
+                        Statistics: Num rows: 758 Data size: 130530 Basic stats: COMPLETE Column stats: COMPLETE
                         Reduce Output Operator
                           key expressions: _col0 (type: string), _col1 (type: float), _col2 (type: double), _col3 (type: timestamp), _col4 (type: boolean)
                           null sort order: zzzzz
@@ -135,9 +135,9 @@ STAGE PLANS:
                               keyColumns: 0:string, 1:float, 2:double, 3:timestamp, 4:boolean
                               native: true
                               nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
-                              valueColumns: 5:double, 6:double, 7:bigint, 8:float, 9:double, 10:double, 11:bigint
-                          Statistics: Num rows: 758 Data size: 124466 Basic stats: COMPLETE Column stats: COMPLETE
-                          value expressions: _col5 (type: double), _col6 (type: double), _col7 (type: bigint), _col8 (type: float), _col9 (type: double), _col10 (type: double), _col11 (type: bigint)
+                              valueColumns: 5:double, 6:double, 7:bigint, 8:float, 9:double, 10:double, 11:bigint, 12:bigint
+                          Statistics: Num rows: 758 Data size: 130530 Basic stats: COMPLETE Column stats: COMPLETE
+                          value expressions: _col5 (type: double), _col6 (type: double), _col7 (type: bigint), _col8 (type: float), _col9 (type: double), _col10 (type: double), _col11 (type: bigint), _col12 (type: bigint)
             Execution mode: vectorized, llap
             LLAP IO: all inputs
             Map Vectorization:
@@ -166,33 +166,33 @@ STAGE PLANS:
                 usesVectorUDFAdaptor: false
                 vectorized: true
                 rowBatchContext:
-                    dataColumnCount: 12
-                    dataColumns: KEY._col0:string, KEY._col1:float, KEY._col2:double, KEY._col3:timestamp, KEY._col4:boolean, VALUE._col0:double, VALUE._col1:double, VALUE._col2:bigint, VALUE._col3:float, VALUE._col4:double, VALUE._col5:double, VALUE._col6:bigint
+                    dataColumnCount: 13
+                    dataColumns: KEY._col0:string, KEY._col1:float, KEY._col2:double, KEY._col3:timestamp, KEY._col4:boolean, VALUE._col0:double, VALUE._col1:double, VALUE._col2:bigint, VALUE._col3:float, VALUE._col4:double, VALUE._col5:double, VALUE._col6:bigint, VALUE._col7:bigint
                     partitionColumnCount: 0
                     scratchColumnTypeNames: []
             Reduce Operator Tree:
               Group By Operator
-                aggregations: sum(VALUE._col0), sum(VALUE._col1), count(VALUE._col2), max(VALUE._col3), sum(VALUE._col4), sum(VALUE._col5), count(VALUE._col6)
+                aggregations: sum(VALUE._col0), sum(VALUE._col1), count(VALUE._col2), max(VALUE._col3), sum(VALUE._col4), sum(VALUE._col5), count(VALUE._col6), count(VALUE._col7)
                 Group By Vectorization:
-                    aggregators: VectorUDAFSumDouble(col 5:double) -> double, VectorUDAFSumDouble(col 6:double) -> double, VectorUDAFCountMerge(col 7:bigint) -> bigint, VectorUDAFMaxDouble(col 8:float) -> float, VectorUDAFSumDouble(col 9:double) -> double, VectorUDAFSumDouble(col 10:double) -> double, VectorUDAFCountMerge(col 11:bigint) -> bigint
+                    aggregators: VectorUDAFSumDouble(col 5:double) -> double, VectorUDAFSumDouble(col 6:double) -> double, VectorUDAFCountMerge(col 7:bigint) -> bigint, VectorUDAFMaxDouble(col 8:float) -> float, VectorUDAFSumDouble(col 9:double) -> double, VectorUDAFSumDouble(col 10:double) -> double, VectorUDAFCountMerge(col 11:bigint) -> bigint, VectorUDAFCountMerge(col 12:bigint) -> bigint
                     className: VectorGroupByOperator
                     groupByMode: MERGEPARTIAL
                     keyExpressions: col 0:string, col 1:float, col 2:double, col 3:timestamp, col 4:boolean
                     native: false
                     vectorProcessingMode: MERGE_PARTIAL
-                    projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6]
+                    projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6, 7]
                 keys: KEY._col0 (type: string), KEY._col1 (type: float), KEY._col2 (type: double), KEY._col3 (type: timestamp), KEY._col4 (type: boolean)
                 mode: mergepartial
-                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11
-                Statistics: Num rows: 758 Data size: 124466 Basic stats: COMPLETE Column stats: COMPLETE
+                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12
+                Statistics: Num rows: 758 Data size: 130530 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
-                  expressions: _col3 (type: timestamp), _col1 (type: float), _col0 (type: string), _col4 (type: boolean), _col2 (type: double), (-26.28D + _col2) (type: double), (- (-26.28D + _col2)) (type: double), power(((_col5 - ((_col6 * _col6) / _col7)) / if((_col7 = 1L), null, (_col7 - 1))), 0.5) (type: double), (_col1 * -26.28) (type: float), _col8 (type: float), (- _col1) (type: float), (- _col8) (type: float), ((- (-26.28D + _col2)) / 10.175D) (type: double), power(((_col9 - ((_col10 * _col10) / _col11)) / _col11), 0.5) (type: double), _col11 (type: bigint), (- ((- (-26.28D + _col2)) / 10.175D)) (type: double), (-1.389D % power(((_col5 - ((_col6 * _col6) / _col7)) / if((_col7 = 1L), null, (_col7 - 1))), 0.5)) (type: double), (UDFToDouble(_col1) - _col2) (type: double), ((_col9 - ((_col10 * _col10) / _col11)) / _col11) (type: double), (((_col9 - ((_col10 * _col10) / _col11)) / _col11) % 10.175D) (type: double), ((_col9 - ((_col10 * _col10) / _col11)) / if((_col11 = 1L), null, (_col11 - 1))) (type: double), (- (UDFToDouble(_col1) - _col2)) (type: double)
+                  expressions: _col3 (type: timestamp), _col1 (type: float), _col0 (type: string), _col4 (type: boolean), _col2 (type: double), (-26.28D + _col2) (type: double), (- (-26.28D + _col2)) (type: double), power(((_col5 - ((_col6 * _col6) / _col7)) / if((_col7 = 1L), null, (_col7 - 1))), 0.5) (type: double), (_col1 * -26.28) (type: float), _col8 (type: float), (- _col1) (type: float), (- _col8) (type: float), ((- (-26.28D + _col2)) / 10.175D) (type: double), power(((_col9 - ((_col10 * _col10) / _col11)) / _col11), 0.5) (type: double), _col12 (type: bigint), (- ((- (-26.28D + _col2)) / 10.175D)) (type: double), (-1.389D % power(((_col5 - ((_col6 * _col6) / _col7)) / if((_col7 = 1L), null, (_col7 - 1))), 0.5)) (type: double), (UDFToDouble(_col1) - _col2) (type: double), ((_col9 - ((_col10 * _col10) / _col11)) / _col11) (type: double), (((_col9 - ((_col10 * _col10) / _col11)) / _col11) % 10.175D) (type: double), ((_col9 - ((_col10 * _col10) / _col11)) / if((_col11 = 1L), null, (_col11 - 1))) (type: double), (- (UDFToDouble(_col1) - _col2)) (type: double)
                   outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21
                   Select Vectorization:
                       className: VectorSelectOperator
                       native: true
-                      projectedOutputColumnNums: [3, 1, 0, 4, 2, 12, 14, 22, 23, 8, 24, 25, 28, 33, 11, 37, 46, 47, 51, 56, 63, 65]
-                      selectExpressions: DoubleScalarAddDoubleColumn(val -26.28, col 2:double) -> 12:double, DoubleColUnaryMinus(col 13:double)(children: DoubleScalarAddDoubleColumn(val -26.28, col 2:double) -> 13:double) -> 14:double, FuncPowerDoubleToDouble(col 21:double)(children: DoubleColDivideLongColumn(col 17:double, col 20:bigint)(children: DoubleColSubtractDoubleColumn(col 5:double, col 16:double)(children: DoubleColDivideLongColumn(col 15:double, col 7:bigint)(children: DoubleColMultiplyDoubleColumn(col 6:double, col 6:double) -> 15:double) -> 16:double) -> 17:double, IfExprNullCondExpr(col 18:boolean, null, col 19:bigint)(children: LongColEqualLongScalar(col 7:bigint, val 1) -> 18:boolean, LongColSubtractLongScalar(col 7:bigint, val 1) -> 19:bigint) -> 20:bigint) -> 21:double) -> 22:double, DoubleColMultiplyDoubleScalar(col 1:float, val -26.280000686645508) -> 23:float, DoubleColUnaryMinus(col 1:float) -> 24:float, DoubleColUnaryMinus(col 8:float) -> 25:float, DoubleColDivideDoubleScalar(col 27:double, val 10.175)(children: DoubleColUnaryMinus(col 26:double)(children: DoubleScalarAddDoubleColumn(val -26.28, col 2:double) -> 26:double) -> 27:double) -> 28:double, FuncPowerDoubleToDouble(col 32:double)(children: DoubleColDivideLongColumn(col 31:double, col 11:bigint)(children: DoubleColSubtractDoubleColumn(col 9:double, col 30:double)(children: DoubleColDivideLongColumn(col 29:double, col 11:bigint)(children: DoubleColMultiplyDoubleColumn(col 10:double, col 10:double) -> 29:double) -> 30:double) -> 31:double) -> 32:double) -> 33:double, DoubleColUnaryMinus(col 36:double)(children: DoubleColDivideDoubleScalar(col 35:double, val 10.175)(children: DoubleColUnaryMinus(col 34:double)(children: DoubleScalarAddDoubleColumn(val -26.28, col 2:double) -> 34:double) -> 35:double) -> 36:double) -> 37:double, DoubleScalarModuloDoubleColumn(val -1.389, col 45:double)(children: FuncPowerDoubleToDouble(col 44:double)(children: DoubleColDivideLongColumn(col 40:double, col 43:bigint)(children: DoubleColSubtractDoubleColumn(col 5:double, col 39:double)(children: DoubleColDivideLongColumn(col 38:double, col 7:bigint)(children: DoubleColMultiplyDoubleColumn(col 6:double, col 6:double) -> 38:double) -> 39:double) -> 40:double, IfExprNullCondExpr(col 41:boolean, null, col 42:bigint)(children: LongColEqualLongScalar(col 7:bigint, val 1) -> 41:boolean, LongColSubtractLongScalar(col 7:bigint, val 1) -> 42:bigint) -> 43:bigint) -> 44:double) -> 45:double) -> 46:double, DoubleColSubtractDoubleColumn(col 1:double, col 2:double)(children: col 1:float) -> 47:double, DoubleColDivideLongColumn(col 50:double, col 11:bigint)(children: DoubleColSubtractDoubleColumn(col 9:double, col 49:double)(children: DoubleColDivideLongColumn(col 48:double, col 11:bigint)(children: DoubleColMultiplyDoubleColumn(col 10:double, col 10:double) -> 48:double) -> 49:double) -> 50:double) -> 51:double, DoubleColModuloDoubleScalar(col 55:double, val 10.175)(children: DoubleColDivideLongColumn(col 54:double, col 11:bigint)(children: DoubleColSubtractDoubleColumn(col 9:double, col 53:double)(children: DoubleColDivideLongColumn(col 52:double, col 11:bigint)(children: DoubleColMultiplyDoubleColumn(col 10:double, col 10:double) -> 52:double) -> 53:double) -> 54:double) -> 55:double) -> 56:double, DoubleColDivideLongColumn(col 59:double, col 62:bigint)(children: DoubleColSubtractDoubleColumn(col 9:double, col 58:double)(children: DoubleColDivideLongColumn(col 57:double, col 11:bigint)(children: DoubleColMultiplyDoubleColumn(col 10:double, col 10:double) -> 57:double) -> 58:double) -> 59:double, IfExprNullCondExpr(col 60:boolean, null, col 61:bigint)(children: LongColEqualLongScalar(col 11:bigint, val 1) -> 60:boolean, LongColSubtractLongScalar(col 11:bigint, val 1) -> 61:bigint) -> 62:bigint) -> 63:double, DoubleColUnaryMinus(col 64:double)(children: DoubleColSubtractDoubleColumn(col 1:double, col 2:double)(children: col 1:float) -> 64:double) -> 65:double
+                      projectedOutputColumnNums: [3, 1, 0, 4, 2, 13, 15, 23, 24, 8, 25, 26, 29, 34, 12, 38, 47, 48, 52, 57, 64, 66]
+                      selectExpressions: DoubleScalarAddDoubleColumn(val -26.28, col 2:double) -> 13:double, DoubleColUnaryMinus(col 14:double)(children: DoubleScalarAddDoubleColumn(val -26.28, col 2:double) -> 14:double) -> 15:double, FuncPowerDoubleToDouble(col 22:double)(children: DoubleColDivideLongColumn(col 18:double, col 21:bigint)(children: DoubleColSubtractDoubleColumn(col 5:double, col 17:double)(children: DoubleColDivideLongColumn(col 16:double, col 7:bigint)(children: DoubleColMultiplyDoubleColumn(col 6:double, col 6:double) -> 16:double) -> 17:double) -> 18:double, IfExprNullCondExpr(col 19:boolean, null, col 20:bigint)(children: LongColEqualLongScalar(col 7:bigint, val 1) -> 19:boolean, LongColSubtractLongScalar(col 7:bigint, val 1) -> 20:bigint) -> 21:bigint) -> 22:double) -> 23:double, DoubleColMultiplyDoubleScalar(col 1:float, val -26.280000686645508) -> 24:float, DoubleColUnaryMinus(col 1:float) -> 25:float, DoubleColUnaryMinus(col 8:float) -> 26:float, DoubleColDivideDoubleScalar(col 28:double, val 10.175)(children: DoubleColUnaryMinus(col 27:double)(children: DoubleScalarAddDoubleColumn(val -26.28, col 2:double) -> 27:double) -> 28:double) -> 29:double, FuncPowerDoubleToDouble(col 33:double)(children: DoubleColDivideLongColumn(col 32:double, col 11:bigint)(children: DoubleColSubtractDoubleColumn(col 9:double, col 31:double)(children: DoubleColDivideLongColumn(col 30:double, col 11:bigint)(children: DoubleColMultiplyDoubleColumn(col 10:double, col 10:double) -> 30:double) -> 31:double) -> 32:double) -> 33:double) -> 34:double, DoubleColUnaryMinus(col 37:double)(children: DoubleColDivideDoubleScalar(col 36:double, val 10.175)(children: DoubleColUnaryMinus(col 35:double)(children: DoubleScalarAddDoubleColumn(val -26.28, col 2:double) -> 35:double) -> 36:double) -> 37:double) -> 38:double, DoubleScalarModuloDoubleColumn(val -1.389, col 46:double)(children: FuncPowerDoubleToDouble(col 45:double)(children: DoubleColDivideLongColumn(col 41:double, col 44:bigint)(children: DoubleColSubtractDoubleColumn(col 5:double, col 40:double)(children: DoubleColDivideLongColumn(col 39:double, col 7:bigint)(children: DoubleColMultiplyDoubleColumn(col 6:double, col 6:double) -> 39:double) -> 40:double) -> 41:double, IfExprNullCondExpr(col 42:boolean, null, col 43:bigint)(children: LongColEqualLongScalar(col 7:bigint, val 1) -> 42:boolean, LongColSubtractLongScalar(col 7:bigint, val 1) -> 43:bigint) -> 44:bigint) -> 45:double) -> 46:double) -> 47:double, DoubleColSubtractDoubleColumn(col 1:double, col 2:double)(children: col 1:float) -> 48:double, DoubleColDivideLongColumn(col 51:double, col 11:bigint)(children: DoubleColSubtractDoubleColumn(col 9:double, col 50:double)(children: DoubleColDivideLongColumn(col 49:double, col 11:bigint)(children: DoubleColMultiplyDoubleColumn(col 10:double, col 10:double) -> 49:double) -> 50:double) -> 51:double) -> 52:double, DoubleColModuloDoubleScalar(col 56:double, val 10.175)(children: DoubleColDivideLongColumn(col 55:double, col 11:bigint)(children: DoubleColSubtractDoubleColumn(col 9:double, col 54:double)(children: DoubleColDivideLongColumn(col 53:double, col 11:bigint)(children: DoubleColMultiplyDoubleColumn(col 10:double, col 10:double) -> 53:double) -> 54:double) -> 55:double) -> 56:double) -> 57:double, DoubleColDivideLongColumn(col 60:double, col 63:bigint)(children: DoubleColSubtractDoubleColumn(col 9:double, col 59:double)(children: DoubleColDivideLongColumn(col 58:double, col 11:bigint)(children: DoubleColMultiplyDoubleColumn(col 10:double, col 10:double) -> 58:double) -> 59:double) -> 60:double, IfExprNullCondExpr(col 61:boolean, null, col 62:bigint)(children: LongColEqualLongScalar(col 11:bigint, val 1) -> 61:boolean, LongColSubtractLongScalar(col 11:bigint, val 1) -> 62:bigint) -> 63:bigint) -> 64:double, DoubleColUnaryMinus(col 65:double)(children: DoubleColSubtractDoubleColumn(col 1:double, col 2:double)(children: col 1:float) -> 65:double) -> 66:double
                   Statistics: Num rows: 758 Data size: 176010 Basic stats: COMPLETE Column stats: COMPLETE
                   Reduce Output Operator
                     key expressions: _col2 (type: string), _col1 (type: float), _col4 (type: double), _col0 (type: timestamp)
@@ -203,7 +203,7 @@ STAGE PLANS:
                         keyColumns: 0:string, 1:float, 2:double, 3:timestamp
                         native: true
                         nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
-                        valueColumns: 4:boolean, 12:double, 14:double, 22:double, 23:float, 8:float, 24:float, 25:float, 28:double, 33:double, 11:bigint, 37:double, 46:double, 47:double, 51:double, 56:double, 63:double, 65:double
+                        valueColumns: 4:boolean, 13:double, 15:double, 23:double, 24:float, 8:float, 25:float, 26:float, 29:double, 34:double, 12:bigint, 38:double, 47:double, 48:double, 52:double, 57:double, 64:double, 66:double
                     Statistics: Num rows: 758 Data size: 176010 Basic stats: COMPLETE Column stats: COMPLETE
                     value expressions: _col3 (type: boolean), _col5 (type: double), _col6 (type: double), _col7 (type: double), _col8 (type: float), _col9 (type: float), _col10 (type: float), _col11 (type: float), _col12 (type: double), _col13 (type: double), _col14 (type: bigint), _col15 (type: double), _col16 (type: double), _col17 (type: double), _col18 (type: double), _col19 (type: double), _col20 (type: double), _col21 (type: double)
         Reducer 3 
diff --git a/ql/src/test/results/clientpositive/llap/vectorization_15.q.out b/ql/src/test/results/clientpositive/llap/vectorization_15.q.out
index 5deabb09f7..ea7a6d0abe 100644
--- a/ql/src/test/results/clientpositive/llap/vectorization_15.q.out
+++ b/ql/src/test/results/clientpositive/llap/vectorization_15.q.out
@@ -107,9 +107,9 @@ STAGE PLANS:
                           selectExpressions: DoubleColMultiplyDoubleColumn(col 4:double, col 4:double)(children: col 4:float, col 4:float) -> 14:double, CastLongToDouble(col 0:tinyint) -> 15:double, DoubleColMultiplyDoubleColumn(col 16:double, col 17:double)(children: CastLongToDouble(col 0:tinyint) -> 16:double, CastLongToDouble(col 0:tinyint) -> 17:double) -> 18:double, CastLongToDouble(col 2:int) -> 19:double, DoubleColMultiplyDoubleColumn(col 20:double, col 21:double)(children: CastLongToDouble(col 2:int) -> 20:double, CastLongToDouble(col 2:int) -> 21:double) -> 22:double
                       Statistics: Num rows: 12288 Data size: 2367002 Basic stats: COMPLETE Column stats: COMPLETE
                       Group By Operator
-                        aggregations: sum(_col8), sum(_col7), count(_col0), min(_col2), sum(_col10), sum(_col9), count(_col4), sum(_col12), sum(_col11), count(_col5)
+                        aggregations: sum(_col8), sum(_col7), count(_col7), min(_col2), sum(_col10), sum(_col9), count(_col9), sum(_col12), sum(_col11), count(_col11)
                         Group By Vectorization:
-                            aggregators: VectorUDAFSumDouble(col 14:double) -> double, VectorUDAFSumDouble(col 4:double) -> double, VectorUDAFCount(col 4:float) -> bigint, VectorUDAFMinDouble(col 5:double) -> double, VectorUDAFSumDouble(col 18:double) -> double, VectorUDAFSumDouble(col 15:double) -> double, VectorUDAFCount(col 0:tinyint) -> bigint, VectorUDAFSumDouble(col 22:double) -> double, VectorUDAFSumDouble(col 19:double) -> double, VectorUDAFCount(col 2:int) -> bigint
+                            aggregators: VectorUDAFSumDouble(col 14:double) -> double, VectorUDAFSumDouble(col 4:double) -> double, VectorUDAFCount(col 4:double) -> bigint, VectorUDAFMinDouble(col 5:double) -> double, VectorUDAFSumDouble(col 18:double) -> double, VectorUDAFSumDouble(col 15:double) -> double, VectorUDAFCount(col 15:double) -> bigint, VectorUDAFSumDouble(col 22:double) -> double, VectorUDAFSumDouble(col 19:double) -> double, VectorUDAFCount(col 19:double) -> bigint
                             className: VectorGroupByOperator
                             groupByMode: HASH
                             keyExpressions: col 4:float, col 10:boolean, col 5:double, col 6:string, col 0:tinyint, col 2:int, col 8:timestamp
diff --git a/ql/src/test/results/clientpositive/llap/vectorization_2.q.out b/ql/src/test/results/clientpositive/llap/vectorization_2.q.out
index 7f28bc1c1d..72e19e53b8 100644
--- a/ql/src/test/results/clientpositive/llap/vectorization_2.q.out
+++ b/ql/src/test/results/clientpositive/llap/vectorization_2.q.out
@@ -81,18 +81,18 @@ STAGE PLANS:
                     predicate: (((cdouble < UDFToDouble(ctinyint)) and ((UDFToDouble(ctimestamp2) <> -10669.0D) or (cint < 359))) or ((ctimestamp1 < ctimestamp2) and (cstring2 like 'b%') and (cfloat <= -5638.15))) (type: boolean)
                     Statistics: Num rows: 4096 Data size: 636272 Basic stats: COMPLETE Column stats: COMPLETE
                     Select Operator
-                      expressions: csmallint (type: smallint), cfloat (type: float), cbigint (type: bigint), ctinyint (type: tinyint), cdouble (type: double), UDFToDouble(cbigint) (type: double), (UDFToDouble(cbigint) * UDFToDouble(cbigint)) (type: double)
-                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
+                      expressions: csmallint (type: smallint), cfloat (type: float), ctinyint (type: tinyint), cdouble (type: double), UDFToDouble(cbigint) (type: double), (UDFToDouble(cbigint) * UDFToDouble(cbigint)) (type: double)
+                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                       Select Vectorization:
                           className: VectorSelectOperator
                           native: true
-                          projectedOutputColumnNums: [1, 4, 3, 0, 5, 16, 19]
+                          projectedOutputColumnNums: [1, 4, 0, 5, 16, 19]
                           selectExpressions: CastLongToDouble(col 3:bigint) -> 16:double, DoubleColMultiplyDoubleColumn(col 17:double, col 18:double)(children: CastLongToDouble(col 3:bigint) -> 17:double, CastLongToDouble(col 3:bigint) -> 18:double) -> 19:double
                       Statistics: Num rows: 4096 Data size: 636272 Basic stats: COMPLETE Column stats: COMPLETE
                       Group By Operator
-                        aggregations: sum(_col0), count(_col0), sum(_col1), sum(_col6), sum(_col5), count(_col2), count(), min(_col3), sum(_col4), count(_col4)
+                        aggregations: sum(_col0), count(_col0), sum(_col1), sum(_col5), sum(_col4), count(_col4), count(), min(_col2), sum(_col3), count(_col3)
                         Group By Vectorization:
-                            aggregators: VectorUDAFSumLong(col 1:smallint) -> bigint, VectorUDAFCount(col 1:smallint) -> bigint, VectorUDAFSumDouble(col 4:float) -> double, VectorUDAFSumDouble(col 19:double) -> double, VectorUDAFSumDouble(col 16:double) -> double, VectorUDAFCount(col 3:bigint) -> bigint, VectorUDAFCountStar(*) -> bigint, VectorUDAFMinLong(col 0:tinyint) -> tinyint, VectorUDAFSumDouble(col 5:double) -> double, VectorUDAFCount(col 5:double) -> bigint
+                            aggregators: VectorUDAFSumLong(col 1:smallint) -> bigint, VectorUDAFCount(col 1:smallint) -> bigint, VectorUDAFSumDouble(col 4:float) -> double, VectorUDAFSumDouble(col 19:double) -> double, VectorUDAFSumDouble(col 16:double) -> double, VectorUDAFCount(col 16:double) -> bigint, VectorUDAFCountStar(*) -> bigint, VectorUDAFMinLong(col 0:tinyint) -> tinyint, VectorUDAFSumDouble(col 5:double) -> double, VectorUDAFCount(col 5:double) -> bigint
                             className: VectorGroupByOperator
                             groupByMode: HASH
                             native: false
diff --git a/ql/src/test/results/clientpositive/llap/vectorization_3.q.out b/ql/src/test/results/clientpositive/llap/vectorization_3.q.out
index bfb74f1e7c..445a06ac0f 100644
--- a/ql/src/test/results/clientpositive/llap/vectorization_3.q.out
+++ b/ql/src/test/results/clientpositive/llap/vectorization_3.q.out
@@ -86,27 +86,27 @@ STAGE PLANS:
                     predicate: (((UDFToFloat(cint) <= cfloat) and (CAST( cbigint AS decimal(22,3)) <> 79.553) and (UDFToDouble(ctimestamp2) = -29071.0D)) or ((UDFToDouble(cbigint) > cdouble) and (CAST( csmallint AS decimal(8,3)) >= 79.553) and (ctimestamp1 > ctimestamp2))) (type: boolean)
                     Statistics: Num rows: 2503 Data size: 209380 Basic stats: COMPLETE Column stats: COMPLETE
                     Select Operator
-                      expressions: csmallint (type: smallint), ctinyint (type: tinyint), cfloat (type: float), cint (type: int), UDFToDouble(csmallint) (type: double), (UDFToDouble(csmallint) * UDFToDouble(csmallint)) (type: double), UDFToDouble(ctinyint) (type: double), (UDFToDouble(ctinyint) * UDFToDouble(ctinyint)) (type: double), UDFToDouble(cfloat) (type: double), (UDFToDouble(cfloat) * UDFToDouble(cfloat)) (type: double), UDFToDouble(cint) (type: double), (UDFToDouble(cint) * UDFToDouble(cint)) (type: double)
-                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11
+                      expressions: cfloat (type: float), cint (type: int), UDFToDouble(csmallint) (type: double), (UDFToDouble(csmallint) * UDFToDouble(csmallint)) (type: double), UDFToDouble(ctinyint) (type: double), (UDFToDouble(ctinyint) * UDFToDouble(ctinyint)) (type: double), UDFToDouble(cfloat) (type: double), (UDFToDouble(cfloat) * UDFToDouble(cfloat)) (type: double), UDFToDouble(cint) (type: double), (UDFToDouble(cint) * UDFToDouble(cint)) (type: double)
+                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                       Select Vectorization:
                           className: VectorSelectOperator
                           native: true
-                          projectedOutputColumnNums: [1, 0, 4, 2, 19, 22, 23, 26, 4, 27, 28, 31]
+                          projectedOutputColumnNums: [4, 2, 19, 22, 23, 26, 4, 27, 28, 31]
                           selectExpressions: CastLongToDouble(col 1:smallint) -> 19:double, DoubleColMultiplyDoubleColumn(col 20:double, col 21:double)(children: CastLongToDouble(col 1:smallint) -> 20:double, CastLongToDouble(col 1:smallint) -> 21:double) -> 22:double, CastLongToDouble(col 0:tinyint) -> 23:double, DoubleColMultiplyDoubleColumn(col 24:double, col 25:double)(children: CastLongToDouble(col 0:tinyint) -> 24:double, CastLongToDouble(col 0:tinyint) -> 25:double) -> 26:double, DoubleColMultiplyDoubleColumn(col 4:double, col 4:double)(children: col 4:float, col 4:float) -> 27:double, CastLongToDouble(col 2:int) -> 28:double, DoubleColMultiplyDoubleColumn(col 29:double, col 30:double)(children: CastLongToDouble(col 2:int) -> 29:double, CastLongToDouble(col 2:int) -> 30:double) -> 31:double
                       Statistics: Num rows: 2503 Data size: 209380 Basic stats: COMPLETE Column stats: COMPLETE
                       Group By Operator
-                        aggregations: sum(_col5), sum(_col4), count(_col0), sum(_col7), sum(_col6), count(_col1), sum(_col9), sum(_col8), count(_col2), sum(_col2), sum(_col3), count(_col3), sum(_col11), sum(_col10)
+                        aggregations: sum(_col3), sum(_col2), count(_col2), sum(_col5), sum(_col4), count(_col4), sum(_col7), sum(_col6), count(_col6), sum(_col0), sum(_col1), count(_col1), sum(_col9), sum(_col8), count(_col8)
                         Group By Vectorization:
-                            aggregators: VectorUDAFSumDouble(col 22:double) -> double, VectorUDAFSumDouble(col 19:double) -> double, VectorUDAFCount(col 1:smallint) -> bigint, VectorUDAFSumDouble(col 26:double) -> double, VectorUDAFSumDouble(col 23:double) -> double, VectorUDAFCount(col 0:tinyint) -> bigint, VectorUDAFSumDouble(col 27:double) -> double, VectorUDAFSumDouble(col 4:double) -> double, VectorUDAFCount(col 4:float) -> bigint, VectorUDAFSumDouble(col 4:float) -> double, VectorUDAFSumLong(col 2:int) -> bigint, VectorUDAFCount(col 2:int) -> bigint, VectorUDAFSumDouble(col 31:double) -> double, VectorUDAFSumDouble(col 28:double) -> double
+                            aggregators: VectorUDAFSumDouble(col 22:double) -> double, VectorUDAFSumDouble(col 19:double) -> double, VectorUDAFCount(col 19:double) -> bigint, VectorUDAFSumDouble(col 26:double) -> double, VectorUDAFSumDouble(col 23:double) -> double, VectorUDAFCount(col 23:double) -> bigint, VectorUDAFSumDouble(col 27:double) -> double, VectorUDAFSumDouble(col 4:double) -> double, VectorUDAFCount(col 4:double) -> bigint, VectorUDAFSumDouble(col 4:float) -> double, VectorUDAFSumLong(col 2:int) -> bigint, VectorUDAFCount(col 2:int) -> bigint, VectorUDAFSumDouble(col 31:double) -> double, VectorUDAFSumDouble(col 28:double) -> double, VectorUDAFCount(col 28:double) -> bigint
                             className: VectorGroupByOperator
                             groupByMode: HASH
                             native: false
                             vectorProcessingMode: HASH
-                            projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
+                            projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
                         minReductionHashAggr: 0.99
                         mode: hash
-                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13
-                        Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
+                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14
+                        Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                         Reduce Output Operator
                           null sort order: 
                           sort order: 
@@ -114,9 +114,9 @@ STAGE PLANS:
                               className: VectorReduceSinkEmptyKeyOperator
                               native: true
                               nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
-                              valueColumns: 0:double, 1:double, 2:bigint, 3:double, 4:double, 5:bigint, 6:double, 7:double, 8:bigint, 9:double, 10:bigint, 11:bigint, 12:double, 13:double
-                          Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
-                          value expressions: _col0 (type: double), _col1 (type: double), _col2 (type: bigint), _col3 (type: double), _col4 (type: double), _col5 (type: bigint), _col6 (type: double), _col7 (type: double), _col8 (type: bigint), _col9 (type: double), _col10 (type: bigint), _col11 (type: bigint), _col12 (type: double), _col13 (type: double)
+                              valueColumns: 0:double, 1:double, 2:bigint, 3:double, 4:double, 5:bigint, 6:double, 7:double, 8:bigint, 9:double, 10:bigint, 11:bigint, 12:double, 13:double, 14:bigint
+                          Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
+                          value expressions: _col0 (type: double), _col1 (type: double), _col2 (type: bigint), _col3 (type: double), _col4 (type: double), _col5 (type: bigint), _col6 (type: double), _col7 (type: double), _col8 (type: bigint), _col9 (type: double), _col10 (type: bigint), _col11 (type: bigint), _col12 (type: double), _col13 (type: double), _col14 (type: bigint)
             Execution mode: vectorized, llap
             LLAP IO: all inputs
             Map Vectorization:
@@ -145,31 +145,31 @@ STAGE PLANS:
                 usesVectorUDFAdaptor: false
                 vectorized: true
                 rowBatchContext:
-                    dataColumnCount: 14
-                    dataColumns: VALUE._col0:double, VALUE._col1:double, VALUE._col2:bigint, VALUE._col3:double, VALUE._col4:double, VALUE._col5:bigint, VALUE._col6:double, VALUE._col7:double, VALUE._col8:bigint, VALUE._col9:double, VALUE._col10:bigint, VALUE._col11:bigint, VALUE._col12:double, VALUE._col13:double
+                    dataColumnCount: 15
+                    dataColumns: VALUE._col0:double, VALUE._col1:double, VALUE._col2:bigint, VALUE._col3:double, VALUE._col4:double, VALUE._col5:bigint, VALUE._col6:double, VALUE._col7:double, VALUE._col8:bigint, VALUE._col9:double, VALUE._col10:bigint, VALUE._col11:bigint, VALUE._col12:double, VALUE._col13:double, VALUE._col14:bigint
                     partitionColumnCount: 0
                     scratchColumnTypeNames: []
             Reduce Operator Tree:
               Group By Operator
-                aggregations: sum(VALUE._col0), sum(VALUE._col1), count(VALUE._col2), sum(VALUE._col3), sum(VALUE._col4), count(VALUE._col5), sum(VALUE._col6), sum(VALUE._col7), count(VALUE._col8), sum(VALUE._col9), sum(VALUE._col10), count(VALUE._col11), sum(VALUE._col12), sum(VALUE._col13)
+                aggregations: sum(VALUE._col0), sum(VALUE._col1), count(VALUE._col2), sum(VALUE._col3), sum(VALUE._col4), count(VALUE._col5), sum(VALUE._col6), sum(VALUE._col7), count(VALUE._col8), sum(VALUE._col9), sum(VALUE._col10), count(VALUE._col11), sum(VALUE._col12), sum(VALUE._col13), count(VALUE._col14)
                 Group By Vectorization:
-                    aggregators: VectorUDAFSumDouble(col 0:double) -> double, VectorUDAFSumDouble(col 1:double) -> double, VectorUDAFCountMerge(col 2:bigint) -> bigint, VectorUDAFSumDouble(col 3:double) -> double, VectorUDAFSumDouble(col 4:double) -> double, VectorUDAFCountMerge(col 5:bigint) -> bigint, VectorUDAFSumDouble(col 6:double) -> double, VectorUDAFSumDouble(col 7:double) -> double, VectorUDAFCountMerge(col 8:bigint) -> bigint, VectorUDAFSumDouble(col 9:double) -> double, VectorUDAFSumLong(col 10:bigint) -> bigint, VectorUDAFCountMerge(col 11:bigint) -> bigint, VectorUDAFSumDouble(col 12:double) -> double, VectorUDAFSumDouble(col 13:double) -> double
+                    aggregators: VectorUDAFSumDouble(col 0:double) -> double, VectorUDAFSumDouble(col 1:double) -> double, VectorUDAFCountMerge(col 2:bigint) -> bigint, VectorUDAFSumDouble(col 3:double) -> double, VectorUDAFSumDouble(col 4:double) -> double, VectorUDAFCountMerge(col 5:bigint) -> bigint, VectorUDAFSumDouble(col 6:double) -> double, VectorUDAFSumDouble(col 7:double) -> double, VectorUDAFCountMerge(col 8:bigint) -> bigint, VectorUDAFSumDouble(col 9:double) -> double, VectorUDAFSumLong(col 10:bigint) -> bigint, VectorUDAFCountMerge(col 11:bigint) -> bigint, VectorUDAFSumDouble(col 12:double) -> double, VectorUDAFSumDouble(col 13:double) -> double, VectorUDAFCountMerge(col 14:bigint) -> bigint
                     className: VectorGroupByOperator
                     groupByMode: MERGEPARTIAL
                     native: false
                     vectorProcessingMode: GLOBAL
-                    projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13]
+                    projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14]
                 mode: mergepartial
-                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13
-                Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
+                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14
+                Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
-                  expressions: power(((_col0 - ((_col1 * _col1) / _col2)) / if((_col2 = 1L), null, (_col2 - 1))), 0.5) (type: double), power(((_col3 - ((_col4 * _col4) / _col5)) / _col5), 0.5) (type: double), power(((_col6 - ((_col7 * _col7) / _col8)) / if((_col8 = 1L), null, (_col8 - 1))), 0.5) (type: double), _col9 (type: double), (UDFToDouble(_col10) / _col11) (type: double), power(((_col12 - ((_col13 * _col13) / _col11)) / _col11), 0.5) (type: double)
+                  expressions: power(((_col0 - ((_col1 * _col1) / _col2)) / if((_col2 = 1L), null, (_col2 - 1))), 0.5) (type: double), power(((_col3 - ((_col4 * _col4) / _col5)) / _col5), 0.5) (type: double), power(((_col6 - ((_col7 * _col7) / _col8)) / if((_col8 = 1L), null, (_col8 - 1))), 0.5) (type: double), _col9 (type: double), (UDFToDouble(_col10) / _col11) (type: double), power(((_col12 - ((_col13 * _col13) / _col14)) / _col14), 0.5) (type: double)
                   outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                   Select Vectorization:
                       className: VectorSelectOperator
                       native: true
-                      projectedOutputColumnNums: [21, 26, 34, 9, 36, 41]
-                      selectExpressions: FuncPowerDoubleToDouble(col 20:double)(children: DoubleColDivideLongColumn(col 16:double, col 19:bigint)(children: DoubleColSubtractDoubleColumn(col 0:double, col 15:double)(children: DoubleColDivideLongColumn(col 14:double, col 2:bigint)(children: DoubleColMultiplyDoubleColumn(col 1:double, col 1:double) -> 14:double) -> 15:double) -> 16:double, IfExprNullCondExpr(col 17:boolean, null, col 18:bigint)(children: LongColEqualLongScalar(col 2:bigint, val 1) -> 17:boolean, LongColSubtractLongScalar(col 2:bigint, val 1) -> 18:bigint) -> 19:bigint) -> 20:double) -> 21:double, FuncPowerDoubleToDouble(col 25:double)(children: DoubleColDivideLongColumn(col 24:double, col 5:bigint)(children: DoubleColSubtractDoubleColumn(col 3:double, col 23:double)(children: DoubleColDivideLongColumn(col 22:double, col 5:bigint)(children: DoubleColMultiplyDoubleColumn(col 4:double, col 4:double) -> 22:double) -> 23:double) -> 24:double) -> 25:double) -> 26:double, FuncPowerDoubleToDouble(col 33:double)(children: DoubleColDivideLongColumn(col 29:double, col 32:bigint)(children: DoubleColSubtractDoubleColumn(col 6:double, col 28:double)(children: DoubleColDivideLongColumn(col 27:double, col 8:bigint)(children: DoubleColMultiplyDoubleColumn(col 7:double, col 7:double) -> 27:double) -> 28:double) -> 29:double, IfExprNullCondExpr(col 30:boolean, null, col 31:bigint)(children: LongColEqualLongScalar(col 8:bigint, val 1) -> 30:boolean, LongColSubtractLongScalar(col 8:bigint, val 1) -> 31:bigint) -> 32:bigint) -> 33:double) -> 34:double, DoubleColDivideLongColumn(col 35:double, col 11:bigint)(children: CastLongToDouble(col 10:bigint) -> 35:double) -> 36:double, FuncPowerDoubleToDouble(col 40:double)(children: DoubleColDivideLongColumn(col 39:double, col 11:bigint)(children: DoubleColSubtractDoubleColumn(col 12:double, col 38:double)(children: DoubleColDivideLongColumn(col 37:double, col 11:bigint)(children: DoubleColMultiplyDoubleColumn(col 13:double, col 13:double) -> 37:double) -> 38:double) -> 39:double) -> 40:double) -> 41:double
+                      projectedOutputColumnNums: [22, 27, 35, 9, 37, 42]
+                      selectExpressions: FuncPowerDoubleToDouble(col 21:double)(children: DoubleColDivideLongColumn(col 17:double, col 20:bigint)(children: DoubleColSubtractDoubleColumn(col 0:double, col 16:double)(children: DoubleColDivideLongColumn(col 15:double, col 2:bigint)(children: DoubleColMultiplyDoubleColumn(col 1:double, col 1:double) -> 15:double) -> 16:double) -> 17:double, IfExprNullCondExpr(col 18:boolean, null, col 19:bigint)(children: LongColEqualLongScalar(col 2:bigint, val 1) -> 18:boolean, LongColSubtractLongScalar(col 2:bigint, val 1) -> 19:bigint) -> 20:bigint) -> 21:double) -> 22:double, FuncPowerDoubleToDouble(col 26:double)(children: DoubleColDivideLongColumn(col 25:double, col 5:bigint)(children: DoubleColSubtractDoubleColumn(col 3:double, col 24:double)(children: DoubleColDivideLongColumn(col 23:double, col 5:bigint)(children: DoubleColMultiplyDoubleColumn(col 4:double, col 4:double) -> 23:double) -> 24:double) -> 25:double) -> 26:double) -> 27:double, FuncPowerDoubleToDouble(col 34:double)(children: DoubleColDivideLongColumn(col 30:double, col 33:bigint)(children: DoubleColSubtractDoubleColumn(col 6:double, col 29:double)(children: DoubleColDivideLongColumn(col 28:double, col 8:bigint)(children: DoubleColMultiplyDoubleColumn(col 7:double, col 7:double) -> 28:double) -> 29:double) -> 30:double, IfExprNullCondExpr(col 31:boolean, null, col 32:bigint)(children: LongColEqualLongScalar(col 8:bigint, val 1) -> 31:boolean, LongColSubtractLongScalar(col 8:bigint, val 1) -> 32:bigint) -> 33:bigint) -> 34:double) -> 35:double, DoubleColDivideLongColumn(col 36:double, col 11:bigint)(children: CastLongToDouble(col 10:bigint) -> 36:double) -> 37:double, FuncPowerDoubleToDouble(col 41:double)(children: DoubleColDivideLongColumn(col 40:double, col 14:bigint)(children: DoubleColSubtractDoubleColumn(col 12:double, col 39:double)(children: DoubleColDivideLongColumn(col 38:double, col 14:bigint)(children: DoubleColMultiplyDoubleColumn(col 13:double, col 13:double) -> 38:double) -> 39:double) -> 40:double) -> 41:double) -> 42:double
                   Statistics: Num rows: 1 Data size: 48 Basic stats: COMPLETE Column stats: COMPLETE
                   Select Operator
                     expressions: _col0 (type: double), (_col0 - 10.175D) (type: double), _col1 (type: double), (_col0 * (_col0 - 10.175D)) (type: double), (- _col1) (type: double), (_col0 % 79.553D) (type: double), (- (_col0 * (_col0 - 10.175D))) (type: double), _col2 (type: double), (- _col0) (type: double), _col3 (type: double), ((- (_col0 * (_col0 - 10.175D))) / (_col0 - 10.175D)) (type: double), (- (_col0 - 10.175D)) (type: double), _col4 (type: double), (-3728.0D - _col0) (type: double), _col5 (type: double), (_col4 / _col2) (type: double)
@@ -177,8 +177,8 @@ STAGE PLANS:
                     Select Vectorization:
                         className: VectorSelectOperator
                         native: true
-                        projectedOutputColumnNums: [21, 42, 26, 44, 45, 46, 49, 34, 50, 9, 55, 57, 36, 58, 41, 59]
-                        selectExpressions: DoubleColSubtractDoubleScalar(col 21:double, val 10.175) -> 42:double, DoubleColMultiplyDoubleColumn(col 21:double, col 43:double)(children: DoubleColSubtractDoubleScalar(col 21:double, val 10.175) -> 43:double) -> 44:double, DoubleColUnaryMinus(col 26:double) -> 45:double, DoubleColModuloDoubleScalar(col 21:double, val 79.553) -> 46:double, DoubleColUnaryMinus(col 48:double)(children: DoubleColMultiplyDoubleColumn(col 21:double, col 47:double)(children: DoubleColSubtractDoubleScalar(col 21:double, val 10.175) -> 47:double) -> 48:double) -> 49:double, DoubleColUnaryMinus(col 21:double) -> 50:double, DoubleColDivideDoubleColumn(col 53:double, col 54:double)(children: DoubleColUnaryMinus(col 52:double)(children: DoubleColMultiplyDoubleColumn(col 21:double, col 51:double)(children: DoubleColSubtractDoubleScalar(col 21:double, val 10.175) -> 51:double) -> 52:double) -> 53:double, DoubleColSubtractDoubleScalar(col 21:double, val 10.175) -> 54:double) -> 55:double, DoubleColUnaryMinus(col 56:double)(children: DoubleColSubtractDoubleScalar(col 21:double, val 10.175) -> 56:double) -> 57:double, DoubleScalarSubtractDoubleColumn(val -3728.0, col 21:double) -> 58:double, DoubleColDivideDoubleColumn(col 36:double, col 34:double) -> 59:double
+                        projectedOutputColumnNums: [22, 43, 27, 45, 46, 47, 50, 35, 51, 9, 56, 58, 37, 59, 42, 60]
+                        selectExpressions: DoubleColSubtractDoubleScalar(col 22:double, val 10.175) -> 43:double, DoubleColMultiplyDoubleColumn(col 22:double, col 44:double)(children: DoubleColSubtractDoubleScalar(col 22:double, val 10.175) -> 44:double) -> 45:double, DoubleColUnaryMinus(col 27:double) -> 46:double, DoubleColModuloDoubleScalar(col 22:double, val 79.553) -> 47:double, DoubleColUnaryMinus(col 49:double)(children: DoubleColMultiplyDoubleColumn(col 22:double, col 48:double)(children: DoubleColSubtractDoubleScalar(col 22:double, val 10.175) -> 48:double) -> 49:double) -> 50:double, DoubleColUnaryMinus(col 22:double) -> 51:double, DoubleColDivideDoubleColumn(col 54:double, col 55:double)(children: DoubleColUnaryMinus(col 53:double)(children: DoubleColMultiplyDoubleColumn(col 22:double, col 52:double)(children: DoubleColSubtractDoubleScalar(col 22:double, val 10.175) -> 52:double) -> 53:double) -> 54:double, DoubleColSubtractDoubleScalar(col 22:double, val 10.175) -> 55:double) -> 56:double, DoubleColUnaryMinus(col 57:double)(children: DoubleColSubtractDoubleScalar(col 22:double, val 10.175) -> 57:double) -> 58:double, DoubleScalarSubtractDoubleColumn(val -3728.0, col 22:double) -> 59:double, DoubleColDivideDoubleColumn(col 37:double, col 35:double) -> 60:double
                     Statistics: Num rows: 1 Data size: 128 Basic stats: COMPLETE Column stats: COMPLETE
                     File Output Operator
                       compressed: false
diff --git a/ql/src/test/results/clientpositive/llap/vectorization_short_regress.q.out b/ql/src/test/results/clientpositive/llap/vectorization_short_regress.q.out
index d1462a2a7a..8a1222c2dc 100644
--- a/ql/src/test/results/clientpositive/llap/vectorization_short_regress.q.out
+++ b/ql/src/test/results/clientpositive/llap/vectorization_short_regress.q.out
@@ -117,18 +117,18 @@ STAGE PLANS:
                           selectExpressions: CastLongToDouble(col 2:int) -> 19:double, DoubleColMultiplyDoubleColumn(col 20:double, col 21:double)(children: CastLongToDouble(col 2:int) -> 20:double, CastLongToDouble(col 2:int) -> 21:double) -> 22:double, CastLongToDouble(col 1:smallint) -> 23:double, DoubleColMultiplyDoubleColumn(col 24:double, col 25:double)(children: CastLongToDouble(col 1:smallint) -> 24:double, CastLongToDouble(col 1:smallint) -> 25:double) -> 26:double
                       Statistics: Num rows: 5465 Data size: 1101870 Basic stats: COMPLETE Column stats: COMPLETE
                       Group By Operator
-                        aggregations: sum(_col0), count(_col0), sum(_col1), sum(_col6), sum(_col5), sum(_col8), sum(_col7), count(_col2), sum(_col3), count(_col3), min(_col4)
+                        aggregations: sum(_col0), count(_col0), sum(_col1), sum(_col6), sum(_col5), count(_col5), sum(_col8), sum(_col7), count(_col7), sum(_col3), count(_col3), min(_col4), count(_col2)
                         Group By Vectorization:
-                            aggregators: VectorUDAFSumLong(col 2:int) -> bigint, VectorUDAFCount(col 2:int) -> bigint, VectorUDAFSumDouble(col 5:double) -> double, VectorUDAFSumDouble(col 22:double) -> double, VectorUDAFSumDouble(col 19:double) -> double, VectorUDAFSumDouble(col 26:double) -> double, VectorUDAFSumDouble(col 23:double) -> double, VectorUDAFCount(col 1:smallint) -> bigint, VectorUDAFSumDouble(col 4:float) -> double, VectorUDAFCount(col 4:float) -> bigint, VectorUDAFMinLong(col 0:tinyint) -> tinyint
+                            aggregators: VectorUDAFSumLong(col 2:int) -> bigint, VectorUDAFCount(col 2:int) -> bigint, VectorUDAFSumDouble(col 5:double) -> double, VectorUDAFSumDouble(col 22:double) -> double, VectorUDAFSumDouble(col 19:double) -> double, VectorUDAFCount(col 19:double) -> bigint, VectorUDAFSumDouble(col 26:double) -> double, VectorUDAFSumDouble(col 23:double) -> double, VectorUDAFCount(col 23:double) -> bigint, VectorUDAFSumDouble(col 4:float) -> double, VectorUDAFCount(col 4:float) -> bigint, VectorUDAFMinLong(col 0:tinyint) -> tinyint, VectorUDAFCount(col 1:smallint) -> bigint
                             className: VectorGroupByOperator
                             groupByMode: HASH
                             native: false
                             vectorProcessingMode: HASH
-                            projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
+                            projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]
                         minReductionHashAggr: 0.99
                         mode: hash
-                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
-                        Statistics: Num rows: 1 Data size: 84 Basic stats: COMPLETE Column stats: COMPLETE
+                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12
+                        Statistics: Num rows: 1 Data size: 100 Basic stats: COMPLETE Column stats: COMPLETE
                         Reduce Output Operator
                           null sort order: 
                           sort order: 
@@ -136,8 +136,8 @@ STAGE PLANS:
                               className: VectorReduceSinkEmptyKeyOperator
                               native: true
                               nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
-                          Statistics: Num rows: 1 Data size: 84 Basic stats: COMPLETE Column stats: COMPLETE
-                          value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: double), _col3 (type: double), _col4 (type: double), _col5 (type: double), _col6 (type: double), _col7 (type: bigint), _col8 (type: double), _col9 (type: bigint), _col10 (type: tinyint)
+                          Statistics: Num rows: 1 Data size: 100 Basic stats: COMPLETE Column stats: COMPLETE
+                          value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: double), _col3 (type: double), _col4 (type: double), _col5 (type: bigint), _col6 (type: double), _col7 (type: double), _col8 (type: bigint), _col9 (type: double), _col10 (type: bigint), _col11 (type: tinyint), _col12 (type: bigint)
             Execution mode: vectorized, llap
             LLAP IO: all inputs
             Map Vectorization:
@@ -159,25 +159,25 @@ STAGE PLANS:
                 vectorized: true
             Reduce Operator Tree:
               Group By Operator
-                aggregations: sum(VALUE._col0), count(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3), sum(VALUE._col4), sum(VALUE._col5), sum(VALUE._col6), count(VALUE._col7), sum(VALUE._col8), count(VALUE._col9), min(VALUE._col10)
+                aggregations: sum(VALUE._col0), count(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3), sum(VALUE._col4), count(VALUE._col5), sum(VALUE._col6), sum(VALUE._col7), count(VALUE._col8), sum(VALUE._col9), count(VALUE._col10), min(VALUE._col11), count(VALUE._col12)
                 Group By Vectorization:
-                    aggregators: VectorUDAFSumLong(col 0:bigint) -> bigint, VectorUDAFCountMerge(col 1:bigint) -> bigint, VectorUDAFSumDouble(col 2:double) -> double, VectorUDAFSumDouble(col 3:double) -> double, VectorUDAFSumDouble(col 4:double) -> double, VectorUDAFSumDouble(col 5:double) -> double, VectorUDAFSumDouble(col 6:double) -> double, VectorUDAFCountMerge(col 7:bigint) -> bigint, VectorUDAFSumDouble(col 8:double) -> double, VectorUDAFCountMerge(col 9:bigint) -> bigint, VectorUDAFMinLong(col 10:tinyint) -> tinyint
+                    aggregators: VectorUDAFSumLong(col 0:bigint) -> bigint, VectorUDAFCountMerge(col 1:bigint) -> bigint, VectorUDAFSumDouble(col 2:double) -> double, VectorUDAFSumDouble(col 3:double) -> double, VectorUDAFSumDouble(col 4:double) -> double, VectorUDAFCountMerge(col 5:bigint) -> bigint, VectorUDAFSumDouble(col 6:double) -> double, VectorUDAFSumDouble(col 7:double) -> double, VectorUDAFCountMerge(col 8:bigint) -> bigint, VectorUDAFSumDouble(col 9:double) -> double, VectorUDAFCountMerge(col 10:bigint) -> bigint, VectorUDAFMinLong(col 11:tinyint) -> tinyint, VectorUDAFCountMerge(col 12:bigint) -> bigint
                     className: VectorGroupByOperator
                     groupByMode: MERGEPARTIAL
                     native: false
                     vectorProcessingMode: GLOBAL
-                    projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
+                    projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]
                 mode: mergepartial
-                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
-                Statistics: Num rows: 1 Data size: 84 Basic stats: COMPLETE Column stats: COMPLETE
+                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12
+                Statistics: Num rows: 1 Data size: 100 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
-                  expressions: (UDFToDouble(_col0) / _col1) (type: double), _col2 (type: double), power(((_col3 - ((_col4 * _col4) / _col1)) / _col1), 0.5) (type: double), power(((_col5 - ((_col6 * _col6) / _col7)) / if((_col7 = 1L), null, (_col7 - 1))), 0.5) (type: double), ((_col3 - ((_col4 * _col4) / _col1)) / if((_col1 = 1L), null, (_col1 - 1))) (type: double), (_col8 / _col9) (type: double), power(((_col3 - ((_col4 * _col4) / _col1)) / if((_col1 = 1L), null, (_col1 - 1))), 0.5) (type: double), _col10 (type: tinyint), _col7 (type: bigint)
+                  expressions: (UDFToDouble(_col0) / _col1) (type: double), _col2 (type: double), power(((_col3 - ((_col4 * _col4) / _col5)) / _col5), 0.5) (type: double), power(((_col6 - ((_col7 * _col7) / _col8)) / if((_col8 = 1L), null, (_col8 - 1))), 0.5) (type: double), ((_col3 - ((_col4 * _col4) / _col5)) / if((_col5 = 1L), null, (_col5 - 1))) (type: double), (_col9 / _col10) (type: double), power(((_col3 - ((_col4 * _col4) / _col5)) / if((_col5 = 1L), null, (_col5 - 1))), 0.5) (type: double), _col11 (type: tinyint), _col12 (type: bigint)
                   outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                   Select Vectorization:
                       className: VectorSelectOperator
                       native: true
-                      projectedOutputColumnNums: [12, 2, 17, 25, 32, 33, 41, 10, 7]
-                      selectExpressions: DoubleColDivideLongColumn(col 11:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 11:double) -> 12:double, FuncPowerDoubleToDouble(col 16:double)(children: DoubleColDivideLongColumn(col 15:double, col 1:bigint)(children: DoubleColSubtractDoubleColumn(col 3:double, col 14:double)(children: DoubleColDivideLongColumn(col 13:double, col 1:bigint)(children: DoubleColMultiplyDoubleColumn(col 4:double, col 4:double) -> 13:double) -> 14:double) -> 15:double) -> 16:double) -> 17:double, FuncPowerDoubleToDouble(col 24:double)(children: DoubleColDivideLongColumn(col 20:double, col 23:bigint)(children: DoubleColSubtractDoubleColumn(col 5:double, col 19:double)(children: DoubleColDivideLongColumn(col 18:double, col 7:bigint)(children: DoubleColMultiplyDoubleColumn(col 6:double, col 6:double) -> 18:double) -> 19:double) -> 20:double, IfExprNullCondExpr(col 21:boolean, null, col 22:bigint)(children: LongColEqualLongScalar(col 7:bigint, val 1) -> 21:boolean, LongColSubtractLongScalar(col 7:bigint, val 1) -> 22:bigint) -> 23:bigint) -> 24:double) -> 25:double, DoubleColDivideLongColumn(col 28:double, col 31:bigint)(children: DoubleColSubtractDoubleColumn(col 3:double, col 27:double)(children: DoubleColDivideLongColumn(col 26:double, col 1:bigint)(children: DoubleColMultiplyDoubleColumn(col 4:double, col 4:double) -> 26:double) -> 27:double) -> 28:double, IfExprNullCondExpr(col 29:boolean, null, col 30:bigint)(children: LongColEqualLongScalar(col 1:bigint, val 1) -> 29:boolean, LongColSubtractLongScalar(col 1:bigint, val 1) -> 30:bigint) -> 31:bigint) -> 32:double, DoubleColDivideLongColumn(col 8:double, col 9:bigint) -> 33:double, FuncPowerDoubleToDouble(col 40:double)(children: DoubleColDivideLongColumn(col 36:double, col 39:bigint)(children: DoubleColSubtractDoubleColumn(col 3:double, col 35:double)(children: DoubleColDivideLongColumn(col 34:double, col 1:bigint)(children: DoubleColMultiplyDoubleColumn(col 4:double, col 4:double) -> 34:double) -> 35:double) -> 36:double, IfExprNullCondExpr(col 37:boolean, null, col 38:bigint)(children: LongColEqualLongScalar(col 1:bigint, val 1) -> 37:boolean, LongColSubtractLongScalar(col 1:bigint, val 1) -> 38:bigint) -> 39:bigint) -> 40:double) -> 41:double
+                      projectedOutputColumnNums: [14, 2, 19, 27, 34, 35, 43, 11, 12]
+                      selectExpressions: DoubleColDivideLongColumn(col 13:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 13:double) -> 14:double, FuncPowerDoubleToDouble(col 18:double)(children: DoubleColDivideLongColumn(col 17:double, col 5:bigint)(children: DoubleColSubtractDoubleColumn(col 3:double, col 16:double)(children: DoubleColDivideLongColumn(col 15:double, col 5:bigint)(children: DoubleColMultiplyDoubleColumn(col 4:double, col 4:double) -> 15:double) -> 16:double) -> 17:double) -> 18:double) -> 19:double, FuncPowerDoubleToDouble(col 26:double)(children: DoubleColDivideLongColumn(col 22:double, col 25:bigint)(children: DoubleColSubtractDoubleColumn(col 6:double, col 21:double)(children: DoubleColDivideLongColumn(col 20:double, col 8:bigint)(children: DoubleColMultiplyDoubleColumn(col 7:double, col 7:double) -> 20:double) -> 21:double) -> 22:double, IfExprNullCondExpr(col 23:boolean, null, col 24:bigint)(children: LongColEqualLongScalar(col 8:bigint, val 1) -> 23:boolean, LongColSubtractLongScalar(col 8:bigint, val 1) -> 24:bigint) -> 25:bigint) -> 26:double) -> 27:double, DoubleColDivideLongColumn(col 30:double, col 33:bigint)(children: DoubleColSubtractDoubleColumn(col 3:double, col 29:double)(children: DoubleColDivideLongColumn(col 28:double, col 5:bigint)(children: DoubleColMultiplyDoubleColumn(col 4:double, col 4:double) -> 28:double) -> 29:double) -> 30:double, IfExprNullCondExpr(col 31:boolean, null, col 32:bigint)(children: LongColEqualLongScalar(col 5:bigint, val 1) -> 31:boolean, LongColSubtractLongScalar(col 5:bigint, val 1) -> 32:bigint) -> 33:bigint) -> 34:double, DoubleColDivideLongColumn(col 9:double, col 10:bigint) -> 35:double, FuncPowerDoubleToDouble(col 42:double)(children: DoubleColDivideLongColumn(col 38:double, col 41:bigint)(children: DoubleColSubtractDoubleColumn(col 3:double, col 37:double)(children: DoubleColDivideLongColumn(col 36:double, col 5:bigint)(children: DoubleColMultiplyDoubleColumn(col 4:double, col 4:double) -> 36:double) -> 37:double) -> 38:double, IfExprNullCondExpr(col 39:boolean, null, col 40:bigint)(children: LongColEqualLongScalar(col 5:bigint, val 1) -> 39:boolean, LongColSubtractLongScalar(col 5:bigint, val 1) -> 40:bigint) -> 41:bigint) -> 42:double) -> 43:double
                   Statistics: Num rows: 1 Data size: 68 Basic stats: COMPLETE Column stats: COMPLETE
                   Select Operator
                     expressions: _col0 (type: double), (_col0 + -3728.0D) (type: double), (- (_col0 + -3728.0D)) (type: double), (_col0 + -3728.0D) (type: double), ((_col0 + -3728.0D) * (_col0 + -3728.0D)) (type: double), _col1 (type: double), (- _col0) (type: double), _col2 (type: double), (((_col0 + -3728.0D) * (_col0 + -3728.0D)) * (_col0 + -3728.0D)) (type: double), _col3 (type: double), (- _col2) (type: double), (_col2 - (_col0 + -3728.0D)) (type: double), ((_col2 - (_col0 + -3728.0D)) * _col2) (type: double), _col4 (type: double), _col5 (type: double), (10.175D - _col4) (type: double), (- (10.175D - _col4)) (type: double), ((- _col2) / -563.0D) (type: double), _col6 (type: double), (- ((- _col2) / -563.0D)) (type: double), (_col0 / _col1) (type: double), _col7 (type: tinyint), _col8 (type: bigint), (UDFToDouble(_col7) / ((- _col2) / -563.0D)) (type: double), (- (_col0 / _col1)) (type: double)
@@ -185,8 +185,8 @@ STAGE PLANS:
                     Select Vectorization:
                         className: VectorSelectOperator
                         native: true
-                        projectedOutputColumnNums: [12, 42, 44, 45, 48, 2, 49, 17, 54, 25, 55, 57, 60, 32, 33, 61, 63, 65, 41, 68, 69, 10, 7, 73, 75]
-                        selectExpressions: DoubleColAddDoubleScalar(col 12:double, val -3728.0) -> 42:double, DoubleColUnaryMinus(col 43:double)(children: DoubleColAddDoubleScalar(col 12:double, val -3728.0) -> 43:double) -> 44:double, DoubleColAddDoubleScalar(col 12:double, val -3728.0) -> 45:double, DoubleColMultiplyDoubleColumn(col 46:double, col 47:double)(children: DoubleColAddDoubleScalar(col 12:double, val -3728.0) -> 46:double, DoubleColAddDoubleScalar(col 12:double, val -3728.0) -> 47:double) -> 48:double, DoubleColUnaryMinus(col 12:double) -> 49:double, DoubleColMultiplyDoubleColumn(col 52:double, col 53:double)(children: DoubleColMultiplyDoubleColumn(col 50:double, col 51:double)(children: DoubleColAddDoubleScalar(col 12:double, val -3728.0) -> 50:double, DoubleColAddDoubleScalar(col 12:double, val -3728.0) -> 51:double) -> 52:double, DoubleColAddDoubleScalar(col 12:double, val -3728.0) -> 53:double) -> 54:double, DoubleColUnaryMinus(col 17:double) -> 55:double, DoubleColSubtractDoubleColumn(col 17:double, col 56:double)(children: DoubleColAddDoubleScalar(col 12:double, val -3728.0) -> 56:double) -> 57:double, DoubleColMultiplyDoubleColumn(col 59:double, col 17:double)(children: DoubleColSubtractDoubleColumn(col 17:double, col 58:double)(children: DoubleColAddDoubleScalar(col 12:double, val -3728.0) -> 58:double) -> 59:double) -> 60:double, DoubleScalarSubtractDoubleColumn(val 10.175, col 32:double) -> 61:double, DoubleColUnaryMinus(col 62:double)(children: DoubleScalarSubtractDoubleColumn(val 10.175, col 32:double) -> 62:double) -> 63:double, DoubleColDivideDoubleScalar(col 64:double, val -563.0)(children: DoubleColUnaryMinus(col 17:double) -> 64:double) -> 65:double, DoubleColUnaryMinus(col 67:double)(children: DoubleColDivideDoubleScalar(col 66:double, val -563.0)(children: DoubleColUnaryMinus(col 17:double) -> 66:double) -> 67:double) -> 68:double, DoubleColDivideDoubleColumn(col 12:double, col 2:double) -> 69:double, DoubleColDivideDoubleColumn(col 70:double, col 72:double)(children: CastLongToDouble(col 10:tinyint) -> 70:double, DoubleColDivideDoubleScalar(col 71:double, val -563.0)(children: DoubleColUnaryMinus(col 17:double) -> 71:double) -> 72:double) -> 73:double, DoubleColUnaryMinus(col 74:double)(children: DoubleColDivideDoubleColumn(col 12:double, col 2:double) -> 74:double) -> 75:double
+                        projectedOutputColumnNums: [14, 44, 46, 47, 50, 2, 51, 19, 56, 27, 57, 59, 62, 34, 35, 63, 65, 67, 43, 70, 71, 11, 12, 75, 77]
+                        selectExpressions: DoubleColAddDoubleScalar(col 14:double, val -3728.0) -> 44:double, DoubleColUnaryMinus(col 45:double)(children: DoubleColAddDoubleScalar(col 14:double, val -3728.0) -> 45:double) -> 46:double, DoubleColAddDoubleScalar(col 14:double, val -3728.0) -> 47:double, DoubleColMultiplyDoubleColumn(col 48:double, col 49:double)(children: DoubleColAddDoubleScalar(col 14:double, val -3728.0) -> 48:double, DoubleColAddDoubleScalar(col 14:double, val -3728.0) -> 49:double) -> 50:double, DoubleColUnaryMinus(col 14:double) -> 51:double, DoubleColMultiplyDoubleColumn(col 54:double, col 55:double)(children: DoubleColMultiplyDoubleColumn(col 52:double, col 53:double)(children: DoubleColAddDoubleScalar(col 14:double, val -3728.0) -> 52:double, DoubleColAddDoubleScalar(col 14:double, val -3728.0) -> 53:double) -> 54:double, DoubleColAddDoubleScalar(col 14:double, val -3728.0) -> 55:double) -> 56:double, DoubleColUnaryMinus(col 19:double) -> 57:double, DoubleColSubtractDoubleColumn(col 19:double, col 58:double)(children: DoubleColAddDoubleScalar(col 14:double, val -3728.0) -> 58:double) -> 59:double, DoubleColMultiplyDoubleColumn(col 61:double, col 19:double)(children: DoubleColSubtractDoubleColumn(col 19:double, col 60:double)(children: DoubleColAddDoubleScalar(col 14:double, val -3728.0) -> 60:double) -> 61:double) -> 62:double, DoubleScalarSubtractDoubleColumn(val 10.175, col 34:double) -> 63:double, DoubleColUnaryMinus(col 64:double)(children: DoubleScalarSubtractDoubleColumn(val 10.175, col 34:double) -> 64:double) -> 65:double, DoubleColDivideDoubleScalar(col 66:double, val -563.0)(children: DoubleColUnaryMinus(col 19:double) -> 66:double) -> 67:double, DoubleColUnaryMinus(col 69:double)(children: DoubleColDivideDoubleScalar(col 68:double, val -563.0)(children: DoubleColUnaryMinus(col 19:double) -> 68:double) -> 69:double) -> 70:double, DoubleColDivideDoubleColumn(col 14:double, col 2:double) -> 71:double, DoubleColDivideDoubleColumn(col 72:double, col 74:double)(children: CastLongToDouble(col 11:tinyint) -> 72:double, DoubleColDivideDoubleScalar(col 73:double, val -563.0)(children: DoubleColUnaryMinus(col 19:double) -> 73:double) -> 74:double) -> 75:double, DoubleColUnaryMinus(col 76:double)(children: DoubleColDivideDoubleColumn(col 14:double, col 2:double) -> 76:double) -> 77:double
                     Statistics: Num rows: 1 Data size: 196 Basic stats: COMPLETE Column stats: COMPLETE
                     File Output Operator
                       compressed: false
@@ -386,18 +386,18 @@ STAGE PLANS:
                     predicate: (((cdouble >= -26.28D) and (UDFToDouble(csmallint) > cdouble)) or ((cbigint <= 197L) and (UDFToLong(cint) < cbigint)) or ((cfloat > 79.553) and (cstring2 like '10%')) or ((UDFToFloat(ctinyint) > cfloat) and cstring1 regexp '.*ss.*')) (type: boolean)
                     Statistics: Num rows: 8186 Data size: 1356970 Basic stats: COMPLETE Column stats: COMPLETE
                     Select Operator
-                      expressions: cint (type: int), cbigint (type: bigint), csmallint (type: smallint), cdouble (type: double), ctinyint (type: tinyint), UDFToDouble(cbigint) (type: double), (UDFToDouble(cbigint) * UDFToDouble(cbigint)) (type: double), UDFToDouble(csmallint) (type: double), (UDFToDouble(csmallint) * UDFToDouble(csmallint)) (type: double), UDFToDouble(cint) (type: double), (UDFToDouble(cint) * UDFToDouble(cint)) (type: double)
-                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
+                      expressions: cint (type: int), cdouble (type: double), ctinyint (type: tinyint), UDFToDouble(cbigint) (type: double), (UDFToDouble(cbigint) * UDFToDouble(cbigint)) (type: double), UDFToDouble(csmallint) (type: double), (UDFToDouble(csmallint) * UDFToDouble(csmallint)) (type: double), UDFToDouble(cint) (type: double), (UDFToDouble(cint) * UDFToDouble(cint)) (type: double)
+                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                       Select Vectorization:
                           className: VectorSelectOperator
                           native: true
-                          projectedOutputColumnNums: [2, 3, 1, 5, 0, 16, 19, 20, 23, 24, 27]
+                          projectedOutputColumnNums: [2, 5, 0, 16, 19, 20, 23, 24, 27]
                           selectExpressions: CastLongToDouble(col 3:bigint) -> 16:double, DoubleColMultiplyDoubleColumn(col 17:double, col 18:double)(children: CastLongToDouble(col 3:bigint) -> 17:double, CastLongToDouble(col 3:bigint) -> 18:double) -> 19:double, CastLongToDouble(col 1:smallint) -> 20:double, DoubleColMultiplyDoubleColumn(col 21:double, col 22:double)(children: CastLongToDouble(col 1:smallint) -> 21:double, CastLongToDouble(col 1:smallint) -> 22:double) -> 23:double, CastLongToDouble(col 2:int) -> 24:double, DoubleColMultiplyDoubleColumn(col 25:double, col 26:double)(children: CastLongToDouble(col 2:int) -> 25:double, CastLongToDouble(col 2:int) -> 26:double) -> 27:double
                       Statistics: Num rows: 8186 Data size: 1356970 Basic stats: COMPLETE Column stats: COMPLETE
                       Group By Operator
-                        aggregations: max(_col0), sum(_col6), sum(_col5), count(_col1), sum(_col8), sum(_col7), count(_col2), max(_col3), sum(_col4), count(_col4), min(_col0), min(_col3), sum(_col10), sum(_col9), count(_col0)
+                        aggregations: max(_col0), sum(_col4), sum(_col3), count(_col3), sum(_col6), sum(_col5), count(_col5), max(_col1), sum(_col2), count(_col2), min(_col0), min(_col1), sum(_col8), sum(_col7), count(_col7)
                         Group By Vectorization:
-                            aggregators: VectorUDAFMaxLong(col 2:int) -> int, VectorUDAFSumDouble(col 19:double) -> double, VectorUDAFSumDouble(col 16:double) -> double, VectorUDAFCount(col 3:bigint) -> bigint, VectorUDAFSumDouble(col 23:double) -> double, VectorUDAFSumDouble(col 20:double) -> double, VectorUDAFCount(col 1:smallint) -> bigint, VectorUDAFMaxDouble(col 5:double) -> double, VectorUDAFSumLong(col 0:tinyint) -> bigint, VectorUDAFCount(col 0:tinyint) -> bigint, VectorUDAFMinLong(col 2:int) -> int, VectorUDAFMinDouble(col 5:double) -> double, VectorUDAFSumDouble(col 27:double) -> double, VectorUDAFSumDouble(col 24:double) -> double, VectorUDAFCount(col 2:int) -> bigint
+                            aggregators: VectorUDAFMaxLong(col 2:int) -> int, VectorUDAFSumDouble(col 19:double) -> double, VectorUDAFSumDouble(col 16:double) -> double, VectorUDAFCount(col 16:double) -> bigint, VectorUDAFSumDouble(col 23:double) -> double, VectorUDAFSumDouble(col 20:double) -> double, VectorUDAFCount(col 20:double) -> bigint, VectorUDAFMaxDouble(col 5:double) -> double, VectorUDAFSumLong(col 0:tinyint) -> bigint, VectorUDAFCount(col 0:tinyint) -> bigint, VectorUDAFMinLong(col 2:int) -> int, VectorUDAFMinDouble(col 5:double) -> double, VectorUDAFSumDouble(col 27:double) -> double, VectorUDAFSumDouble(col 24:double) -> double, VectorUDAFCount(col 24:double) -> bigint
                             className: VectorGroupByOperator
                             groupByMode: HASH
                             native: false
@@ -647,18 +647,18 @@ STAGE PLANS:
                     predicate: ((ctimestamp1 = ctimestamp2) or ((UDFToLong(csmallint) <= cbigint) and (cboolean2 = 1)) or ((cstring2 > 'a') and cboolean1 is not null and ctimestamp2 is not null) or (cfloat = 762.0) or (cstring1 = 'ss')) (type: boolean)
                     Statistics: Num rows: 10571 Data size: 2446670 Basic stats: COMPLETE Column stats: COMPLETE
                     Select Operator
-                      expressions: cbigint (type: bigint), ctinyint (type: tinyint), csmallint (type: smallint), cint (type: int), cdouble (type: double), UDFToDouble(cbigint) (type: double), (UDFToDouble(cbigint) * UDFToDouble(cbigint)) (type: double), UDFToDouble(csmallint) (type: double), (UDFToDouble(csmallint) * UDFToDouble(csmallint)) (type: double), (cdouble * cdouble) (type: double)
-                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
+                      expressions: ctinyint (type: tinyint), cint (type: int), cdouble (type: double), UDFToDouble(cbigint) (type: double), (UDFToDouble(cbigint) * UDFToDouble(cbigint)) (type: double), UDFToDouble(csmallint) (type: double), (UDFToDouble(csmallint) * UDFToDouble(csmallint)) (type: double), (cdouble * cdouble) (type: double)
+                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                       Select Vectorization:
                           className: VectorSelectOperator
                           native: true
-                          projectedOutputColumnNums: [3, 0, 1, 2, 5, 14, 17, 18, 21, 22]
+                          projectedOutputColumnNums: [0, 2, 5, 14, 17, 18, 21, 22]
                           selectExpressions: CastLongToDouble(col 3:bigint) -> 14:double, DoubleColMultiplyDoubleColumn(col 15:double, col 16:double)(children: CastLongToDouble(col 3:bigint) -> 15:double, CastLongToDouble(col 3:bigint) -> 16:double) -> 17:double, CastLongToDouble(col 1:smallint) -> 18:double, DoubleColMultiplyDoubleColumn(col 19:double, col 20:double)(children: CastLongToDouble(col 1:smallint) -> 19:double, CastLongToDouble(col 1:smallint) -> 20:double) -> 21:double, DoubleColMultiplyDoubleColumn(col 5:double, col 5:double) -> 22:double
                       Statistics: Num rows: 10571 Data size: 2446670 Basic stats: COMPLETE Column stats: COMPLETE
                       Group By Operator
-                        aggregations: sum(_col6), sum(_col5), count(_col0), count(), max(_col1), sum(_col8), sum(_col7), count(_col2), max(_col3), sum(_col9), sum(_col4), count(_col4), count(_col1), sum(_col1)
+                        aggregations: sum(_col4), sum(_col3), count(_col3), count(), max(_col0), sum(_col6), sum(_col5), count(_col5), max(_col1), sum(_col7), sum(_col2), count(_col2), count(_col0), sum(_col0)
                         Group By Vectorization:
-                            aggregators: VectorUDAFSumDouble(col 17:double) -> double, VectorUDAFSumDouble(col 14:double) -> double, VectorUDAFCount(col 3:bigint) -> bigint, VectorUDAFCountStar(*) -> bigint, VectorUDAFMaxLong(col 0:tinyint) -> tinyint, VectorUDAFSumDouble(col 21:double) -> double, VectorUDAFSumDouble(col 18:double) -> double, VectorUDAFCount(col 1:smallint) -> bigint, VectorUDAFMaxLong(col 2:int) -> int, VectorUDAFSumDouble(col 22:double) -> double, VectorUDAFSumDouble(col 5:double) -> double, VectorUDAFCount(col 5:double) -> bigint, VectorUDAFCount(col 0:tinyint) -> bigint, VectorUDAFSumLong(col 0:tinyint) -> bigint
+                            aggregators: VectorUDAFSumDouble(col 17:double) -> double, VectorUDAFSumDouble(col 14:double) -> double, VectorUDAFCount(col 14:double) -> bigint, VectorUDAFCountStar(*) -> bigint, VectorUDAFMaxLong(col 0:tinyint) -> tinyint, VectorUDAFSumDouble(col 21:double) -> double, VectorUDAFSumDouble(col 18:double) -> double, VectorUDAFCount(col 18:double) -> bigint, VectorUDAFMaxLong(col 2:int) -> int, VectorUDAFSumDouble(col 22:double) -> double, VectorUDAFSumDouble(col 5:double) -> double, VectorUDAFCount(col 5:double) -> bigint, VectorUDAFCount(col 0:tinyint) -> bigint, VectorUDAFSumLong(col 0:tinyint) -> bigint
                             className: VectorGroupByOperator
                             groupByMode: HASH
                             native: false
@@ -887,18 +887,18 @@ STAGE PLANS:
                     predicate: (((csmallint < UDFToShort(ctinyint)) and (UDFToDouble(ctimestamp1) >= 0.0D)) or (cfloat = 17.0) or ((ctimestamp2 <= ctimestamp1) and (UDFToDouble(cbigint) <> cdouble) and (cstring1 >= 'ss'))) (type: boolean)
                     Statistics: Num rows: 2824 Data size: 434454 Basic stats: COMPLETE Column stats: COMPLETE
                     Select Operator
-                      expressions: ctinyint (type: tinyint), cbigint (type: bigint), cint (type: int), cfloat (type: float), UDFToDouble(cint) (type: double), (UDFToDouble(cint) * UDFToDouble(cint)) (type: double), UDFToDouble(cbigint) (type: double), (UDFToDouble(cbigint) * UDFToDouble(cbigint)) (type: double)
-                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
+                      expressions: ctinyint (type: tinyint), cbigint (type: bigint), cfloat (type: float), UDFToDouble(cint) (type: double), (UDFToDouble(cint) * UDFToDouble(cint)) (type: double), UDFToDouble(cbigint) (type: double), (UDFToDouble(cbigint) * UDFToDouble(cbigint)) (type: double)
+                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                       Select Vectorization:
                           className: VectorSelectOperator
                           native: true
-                          projectedOutputColumnNums: [0, 3, 2, 4, 16, 19, 20, 23]
+                          projectedOutputColumnNums: [0, 3, 4, 16, 19, 20, 23]
                           selectExpressions: CastLongToDouble(col 2:int) -> 16:double, DoubleColMultiplyDoubleColumn(col 17:double, col 18:double)(children: CastLongToDouble(col 2:int) -> 17:double, CastLongToDouble(col 2:int) -> 18:double) -> 19:double, CastLongToDouble(col 3:bigint) -> 20:double, DoubleColMultiplyDoubleColumn(col 21:double, col 22:double)(children: CastLongToDouble(col 3:bigint) -> 21:double, CastLongToDouble(col 3:bigint) -> 22:double) -> 23:double
                       Statistics: Num rows: 2824 Data size: 434454 Basic stats: COMPLETE Column stats: COMPLETE
                       Group By Operator
-                        aggregations: sum(_col0), count(_col0), max(_col1), sum(_col5), sum(_col4), count(_col2), sum(_col7), sum(_col6), count(_col1), max(_col3)
+                        aggregations: sum(_col0), count(_col0), max(_col1), sum(_col4), sum(_col3), count(_col3), sum(_col6), sum(_col5), count(_col5), max(_col2)
                         Group By Vectorization:
-                            aggregators: VectorUDAFSumLong(col 0:tinyint) -> bigint, VectorUDAFCount(col 0:tinyint) -> bigint, VectorUDAFMaxLong(col 3:bigint) -> bigint, VectorUDAFSumDouble(col 19:double) -> double, VectorUDAFSumDouble(col 16:double) -> double, VectorUDAFCount(col 2:int) -> bigint, VectorUDAFSumDouble(col 23:double) -> double, VectorUDAFSumDouble(col 20:double) -> double, VectorUDAFCount(col 3:bigint) -> bigint, VectorUDAFMaxDouble(col 4:float) -> float
+                            aggregators: VectorUDAFSumLong(col 0:tinyint) -> bigint, VectorUDAFCount(col 0:tinyint) -> bigint, VectorUDAFMaxLong(col 3:bigint) -> bigint, VectorUDAFSumDouble(col 19:double) -> double, VectorUDAFSumDouble(col 16:double) -> double, VectorUDAFCount(col 16:double) -> bigint, VectorUDAFSumDouble(col 23:double) -> double, VectorUDAFSumDouble(col 20:double) -> double, VectorUDAFCount(col 20:double) -> bigint, VectorUDAFMaxDouble(col 4:float) -> float
                             className: VectorGroupByOperator
                             groupByMode: HASH
                             native: false
@@ -2298,18 +2298,18 @@ STAGE PLANS:
                           keyExpressions: col 1:smallint
                           native: true
                       Select Operator
-                        expressions: csmallint (type: smallint), cbigint (type: bigint), ctinyint (type: tinyint), UDFToDouble(csmallint) (type: double), (UDFToDouble(csmallint) * UDFToDouble(csmallint)) (type: double), UDFToDouble(ctinyint) (type: double), (UDFToDouble(ctinyint) * UDFToDouble(ctinyint)) (type: double)
-                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
+                        expressions: csmallint (type: smallint), cbigint (type: bigint), UDFToDouble(csmallint) (type: double), (UDFToDouble(csmallint) * UDFToDouble(csmallint)) (type: double), UDFToDouble(ctinyint) (type: double), (UDFToDouble(ctinyint) * UDFToDouble(ctinyint)) (type: double)
+                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                         Select Vectorization:
                             className: VectorSelectOperator
                             native: true
-                            projectedOutputColumnNums: [1, 3, 0, 14, 17, 18, 21]
+                            projectedOutputColumnNums: [1, 3, 14, 17, 18, 21]
                             selectExpressions: CastLongToDouble(col 1:smallint) -> 14:double, DoubleColMultiplyDoubleColumn(col 15:double, col 16:double)(children: CastLongToDouble(col 1:smallint) -> 15:double, CastLongToDouble(col 1:smallint) -> 16:double) -> 17:double, CastLongToDouble(col 0:tinyint) -> 18:double, DoubleColMultiplyDoubleColumn(col 19:double, col 20:double)(children: CastLongToDouble(col 0:tinyint) -> 19:double, CastLongToDouble(col 0:tinyint) -> 20:double) -> 21:double
                         Statistics: Num rows: 693 Data size: 14504 Basic stats: COMPLETE Column stats: COMPLETE
                         Group By Operator
-                          aggregations: sum(_col4), sum(_col3), count(_col0), sum(_col1), sum(_col6), sum(_col5), count(_col2), count()
+                          aggregations: sum(_col3), sum(_col2), count(_col2), sum(_col1), sum(_col5), sum(_col4), count(_col4), count()
                           Group By Vectorization:
-                              aggregators: VectorUDAFSumDouble(col 17:double) -> double, VectorUDAFSumDouble(col 14:double) -> double, VectorUDAFCount(col 1:smallint) -> bigint, VectorUDAFSumLong(col 3:bigint) -> bigint, VectorUDAFSumDouble(col 21:double) -> double, VectorUDAFSumDouble(col 18:double) -> double, VectorUDAFCount(col 0:tinyint) -> bigint, VectorUDAFCountStar(*) -> bigint
+                              aggregators: VectorUDAFSumDouble(col 17:double) -> double, VectorUDAFSumDouble(col 14:double) -> double, VectorUDAFCount(col 14:double) -> bigint, VectorUDAFSumLong(col 3:bigint) -> bigint, VectorUDAFSumDouble(col 21:double) -> double, VectorUDAFSumDouble(col 18:double) -> double, VectorUDAFCount(col 18:double) -> bigint, VectorUDAFCountStar(*) -> bigint
                               className: VectorGroupByOperator
                               groupByMode: HASH
                               keyExpressions: col 1:smallint
@@ -2930,20 +2930,20 @@ STAGE PLANS:
                           selectExpressions: CastLongToDouble(col 2:int) -> 20:double, DoubleColMultiplyDoubleColumn(col 21:double, col 22:double)(children: CastLongToDouble(col 2:int) -> 21:double, CastLongToDouble(col 2:int) -> 22:double) -> 23:double, CastLongToDouble(col 1:smallint) -> 24:double, DoubleColMultiplyDoubleColumn(col 25:double, col 26:double)(children: CastLongToDouble(col 1:smallint) -> 25:double, CastLongToDouble(col 1:smallint) -> 26:double) -> 27:double, DoubleColMultiplyDoubleColumn(col 4:double, col 4:double)(children: col 4:float, col 4:float) -> 28:double, CastLongToDouble(col 0:tinyint) -> 29:double, DoubleColMultiplyDoubleColumn(col 30:double, col 31:double)(children: CastLongToDouble(col 0:tinyint) -> 30:double, CastLongToDouble(col 0:tinyint) -> 31:double) -> 32:double
                       Statistics: Num rows: 12288 Data size: 2770698 Basic stats: COMPLETE Column stats: COMPLETE
                       Group By Operator
-                        aggregations: sum(_col8), sum(_col7), count(_col2), sum(_col3), count(_col3), count(), min(_col4), sum(_col10), sum(_col9), sum(_col12), sum(_col11), count(_col5), sum(_col2), sum(_col5), min(_col6), sum(_col14), sum(_col13), count(_col4)
+                        aggregations: sum(_col8), sum(_col7), count(_col7), sum(_col3), count(_col3), count(), min(_col4), sum(_col10), sum(_col9), count(_col9), sum(_col12), sum(_col11), count(_col11), sum(_col2), count(_col2), sum(_col5), count(_col5), min(_col6), sum(_col14), sum(_col13), count(_col13)
                         Group By Vectorization:
-                            aggregators: VectorUDAFSumDouble(col 23:double) -> double, VectorUDAFSumDouble(col 20:double) -> double, VectorUDAFCount(col 2:int) -> bigint, VectorUDAFSumLong(col 1:smallint) -> bigint, VectorUDAFCount(col 1:smallint) -> bigint, VectorUDAFCountStar(*) -> bigint, VectorUDAFMinLong(col 0:tinyint) -> tinyint, VectorUDAFSumDouble(col 27:double) -> double, VectorUDAFSumDouble(col 24:double) -> double, VectorUDAFSumDouble(col 28:double) -> double, VectorUDAFSumDouble(col 4:double) -> double, VectorUDAFCount(col 4:float) -> bigint, VectorUDAFSumLong(col 2:int) -> bigint, VectorUDAFSumDouble(col 4:float) -> double, VectorUDAFMinDouble(col 5:double) -> double, VectorUDAFSumDouble(col 32:double) -> double, VectorUDAFSumDouble(col 29:double) -> double, VectorUDAFCount(col 0:tinyint) -> bigint
+                            aggregators: VectorUDAFSumDouble(col 23:double) -> double, VectorUDAFSumDouble(col 20:double) -> double, VectorUDAFCount(col 20:double) -> bigint, VectorUDAFSumLong(col 1:smallint) -> bigint, VectorUDAFCount(col 1:smallint) -> bigint, VectorUDAFCountStar(*) -> bigint, VectorUDAFMinLong(col 0:tinyint) -> tinyint, VectorUDAFSumDouble(col 27:double) -> double, VectorUDAFSumDouble(col 24:double) -> double, VectorUDAFCount(col 24:double) -> bigint, VectorUDAFSumDouble(col 28:double) -> double, VectorUDAFSumDouble(col 4:double) -> double, VectorUDAFCount(col 4:double) -> bigint, VectorUDAFSumLong(col 2:int) -> bigint, VectorUDAFCount(col 2:int) -> bigint, VectorUDAFSumDouble(col 4:float) -> double, VectorUDAFCount(col 4:float) -> bigint, VectorUDAFMinDouble(col 5:double) -> double, VectorUDAFSumDouble(col 32:double) -> double, VectorUDAFSumDouble(col 29:double) -> double, VectorUDAFCount(col 29:double) -> bigint
                             className: VectorGroupByOperator
                             groupByMode: HASH
                             keyExpressions: col 8:timestamp, col 6:string
                             native: false
                             vectorProcessingMode: HASH
-                            projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17]
+                            projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
                         keys: _col0 (type: timestamp), _col1 (type: string)
                         minReductionHashAggr: 0.5133463
                         mode: hash
-                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19
-                        Statistics: Num rows: 5980 Data size: 1435604 Basic stats: COMPLETE Column stats: COMPLETE
+                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21, _col22
+                        Statistics: Num rows: 5980 Data size: 1579124 Basic stats: COMPLETE Column stats: COMPLETE
                         Reduce Output Operator
                           key expressions: _col0 (type: timestamp), _col1 (type: string)
                           null sort order: zz
@@ -2953,8 +2953,8 @@ STAGE PLANS:
                               className: VectorReduceSinkMultiKeyOperator
                               native: true
                               nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
-                          Statistics: Num rows: 5980 Data size: 1435604 Basic stats: COMPLETE Column stats: COMPLETE
-                          value expressions: _col2 (type: double), _col3 (type: double), _col4 (type: bigint), _col5 (type: bigint), _col6 (type: bigint), _col7 (type: bigint), _col8 (type: tinyint), _col9 (type: double), _col10 (type: double), _col11 (type: double), _col12 (type: double), _col13 (type: bigint), _col14 (type: bigint), _col15 (type: double), _col16 (type: double), _col17 (type: double), _col18 (type: double), _col19 (type: bigint)
+                          Statistics: Num rows: 5980 Data size: 1579124 Basic stats: COMPLETE Column stats: COMPLETE
+                          value expressions: _col2 (type: double), _col3 (type: double), _col4 (type: bigint), _col5 (type: bigint), _col6 (type: bigint), _col7 (type: bigint), _col8 (type: tinyint), _col9 (type: double), _col10 (type: double), _col11 (type: bigint), _col12 (type: double), _col13 (type: double), _col14 (type: bigint), _col15 (type: bigint), _col16 (type: bigint), _col17 (type: double), _col18 (type: bigint), _col19 (type: double), _col20 (type: double), _col21 (type: double), _col22 (type: bigint)
             Execution mode: vectorized, llap
             LLAP IO: all inputs
             Map Vectorization:
@@ -2976,27 +2976,27 @@ STAGE PLANS:
                 vectorized: true
             Reduce Operator Tree:
               Group By Operator
-                aggregations: sum(VALUE._col0), sum(VALUE._col1), count(VALUE._col2), sum(VALUE._col3), count(VALUE._col4), count(VALUE._col5), min(VALUE._col6), sum(VALUE._col7), sum(VALUE._col8), sum(VALUE._col9), sum(VALUE._col10), count(VALUE._col11), sum(VALUE._col12), sum(VALUE._col13), min(VALUE._col14), sum(VALUE._col15), sum(VALUE._col16), count(VALUE._col17)
+                aggregations: sum(VALUE._col0), sum(VALUE._col1), count(VALUE._col2), sum(VALUE._col3), count(VALUE._col4), count(VALUE._col5), min(VALUE._col6), sum(VALUE._col7), sum(VALUE._col8), count(VALUE._col9), sum(VALUE._col10), sum(VALUE._col11), count(VALUE._col12), sum(VALUE._col13), count(VALUE._col14), sum(VALUE._col15), count(VALUE._col16), min(VALUE._col17), sum(VALUE._col18), sum(VALUE._col19), count(VALUE._col20)
                 Group By Vectorization:
-                    aggregators: VectorUDAFSumDouble(col 2:double) -> double, VectorUDAFSumDouble(col 3:double) -> double, VectorUDAFCountMerge(col 4:bigint) -> bigint, VectorUDAFSumLong(col 5:bigint) -> bigint, VectorUDAFCountMerge(col 6:bigint) -> bigint, VectorUDAFCountMerge(col 7:bigint) -> bigint, VectorUDAFMinLong(col 8:tinyint) -> tinyint, VectorUDAFSumDouble(col 9:double) -> double, VectorUDAFSumDouble(col 10:double) -> double, VectorUDAFSumDouble(col 11:double) -> double, VectorUDAFSumDouble(col 12:double) -> double, VectorUDAFCountMerge(col 13:bigint) -> bigint, VectorUDAFSumLong(col 14:bigint) -> bigint, VectorUDAFSumDouble(col 15:double) -> double, VectorUDAFMinDouble(col 16:double) -> double, VectorUDAFSumDouble(col 17:double) -> double, VectorUDAFSumDouble(col 18:double) -> double, VectorUDAFCountMerge(col 19:bigint) -> bigint
+                    aggregators: VectorUDAFSumDouble(col 2:double) -> double, VectorUDAFSumDouble(col 3:double) -> double, VectorUDAFCountMerge(col 4:bigint) -> bigint, VectorUDAFSumLong(col 5:bigint) -> bigint, VectorUDAFCountMerge(col 6:bigint) -> bigint, VectorUDAFCountMerge(col 7:bigint) -> bigint, VectorUDAFMinLong(col 8:tinyint) -> tinyint, VectorUDAFSumDouble(col 9:double) -> double, VectorUDAFSumDouble(col 10:double) -> double, VectorUDAFCountMerge(col 11:bigint) -> bigint, VectorUDAFSumDouble(col 12:double) -> double, VectorUDAFSumDouble(col 13:double) -> double, VectorUDAFCountMerge(col 14:bigint) -> bigint, VectorUDAFSumLong(col 15:bigint) -> bigint, VectorUDAFCountMerge(col 16:bigint) -> bigint, VectorUDAFSumDouble(col 17:double) -> double, VectorUDAFCountMerge(col 18:bigint) -> bigint, VectorUDAFMinDouble(col 19:double) -> double, VectorUDAFSumDouble(col 20:double) -> double, VectorUDAFSumDouble(col 21:double) -> double, VectorUDAFCountMerge(col 22:bigint) -> bigint
                     className: VectorGroupByOperator
                     groupByMode: MERGEPARTIAL
                     keyExpressions: col 0:timestamp, col 1:string
                     native: false
                     vectorProcessingMode: MERGE_PARTIAL
-                    projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17]
+                    projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
                 keys: KEY._col0 (type: timestamp), KEY._col1 (type: string)
                 mode: mergepartial
-                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19
-                Statistics: Num rows: 5980 Data size: 1435604 Basic stats: COMPLETE Column stats: COMPLETE
+                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21, _col22
+                Statistics: Num rows: 5980 Data size: 1579124 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
-                  expressions: _col0 (type: timestamp), _col1 (type: string), power(((_col2 - ((_col3 * _col3) / _col4)) / _col4), 0.5) (type: double), (UDFToDouble(_col5) / _col6) (type: double), _col7 (type: bigint), _col8 (type: tinyint), ((_col9 - ((_col10 * _col10) / _col6)) / if((_col6 = 1L), null, (_col6 - 1))) (type: double), ((_col11 - ((_col12 * _col12) / _col13)) / _col13) (type: double), (UDFToDouble(_col14) / _col4) (type: double), ((_col11 - ((_col12 * _col12) / _col13)) / if((_col13 = 1L), null, (_col13 - 1))) (type: double), (_col15 / _col13) (type: double), _col16 (type: double), ((_col9 - ((_col10 * _col10) / _col6)) / _col6) (type: double), power(((_col17 - ((_col18 * _col18) / _col19)) / _col19), 0.5) (type: double), _col14 (type: bigint)
+                  expressions: _col0 (type: timestamp), _col1 (type: string), power(((_col2 - ((_col3 * _col3) / _col4)) / _col4), 0.5) (type: double), (UDFToDouble(_col5) / _col6) (type: double), _col7 (type: bigint), _col8 (type: tinyint), ((_col9 - ((_col10 * _col10) / _col11)) / if((_col11 = 1L), null, (_col11 - 1))) (type: double), ((_col12 - ((_col13 * _col13) / _col14)) / _col14) (type: double), (UDFToDouble(_col15) / _col16) (type: double), ((_col12 - ((_col13 * _col13) / _col14)) / if((_col14 = 1L), null, (_col14 - 1))) (type: double), (_col17 / _col18) (type: double), _col19 (type: double), ((_col9 - ((_col10 * _col10) / _col11)) / _col11) (type: double), power(((_col20 - ((_col21 * _col21) / _col22)) / _col22), 0.5) (type: double), _col15 (type: bigint)
                   outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14
                   Select Vectorization:
                       className: VectorSelectOperator
                       native: true
-                      projectedOutputColumnNums: [0, 1, 24, 26, 7, 8, 33, 37, 39, 46, 47, 16, 51, 56, 14]
-                      selectExpressions: FuncPowerDoubleToDouble(col 23:double)(children: DoubleColDivideLongColumn(col 22:double, col 4:bigint)(children: DoubleColSubtractDoubleColumn(col 2:double, col 21:double)(children: DoubleColDivideLongColumn(col 20:double, col 4:bigint)(children: DoubleColMultiplyDoubleColumn(col 3:double, col 3:double) -> 20:double) -> 21:double) -> 22:double) -> 23:double) -> 24:double, DoubleColDivideLongColumn(col 25:double, col 6:bigint)(children: CastLongToDouble(col 5:bigint) -> 25:double) -> 26:double, DoubleColDivideLongColumn(col 29:double, col 32:bigint)(children: DoubleColSubtractDoubleColumn(col 9:double, col 28:double)(children: DoubleColDivideLongColumn(col 27:double, col 6:bigint)(children: DoubleColMultiplyDoubleColumn(col 10:double, col 10:double) -> 27:double) -> 28:double) -> 29:double, IfExprNullCondExpr(col 30:boolean, null, col 31:bigint)(children: LongColEqualLongScalar(col 6:bigint, val 1) -> 30:boolean, LongColSubtractLongScalar(col 6:bigint, val 1) -> 31:bigint) -> 32:bigint) -> 33:double, DoubleColDivideLongColumn(col 36:double, col 13:bigint)(children: DoubleColSubtractDoubleColumn(col 11:double, col 35:double)(children: DoubleColDivideLongColumn(col 34:double, col 13:bigint)(children: DoubleColMultiplyDoubleColumn(col 12:double, col 12:double) -> 34:double) -> 35:double) -> 36:double) -> 37:double, DoubleColDivideLongColumn(col 38:double, col 4:bigint)(children: CastLongToDouble(col 14:bigint) -> 38:double) -> 39:double, DoubleColDivideLongColumn(col 42:double, col 45:bigint)(children: DoubleColSubtractDoubleColumn(col 11:double, col 41:double)(children: DoubleColDivideLongColumn(col 40:double, col 13:bigint)(children: DoubleColMultiplyDoubleColumn(col 12:double, col 12:double) -> 40:double) -> 41:double) -> 42:double, IfExprNullCondExpr(col 43:boolean, null, col 44:bigint)(children: LongColEqualLongScalar(col 13:bigint, val 1) -> 43:boolean, LongColSubtractLongScalar(col 13:bigint, val 1) -> 44:bigint) -> 45:bigint) -> 46:double, DoubleColDivideLongColumn(col 15:double, col 13:bigint) -> 47:double, DoubleColDivideLongColumn(col 50:double, col 6:bigint)(children: DoubleColSubtractDoubleColumn(col 9:double, col 49:double)(children: DoubleColDivideLongColumn(col 48:double, col 6:bigint)(children: DoubleColMultiplyDoubleColumn(col 10:double, col 10:double) -> 48:double) -> 49:double) -> 50:double) -> 51:double, FuncPowerDoubleToDouble(col 55:double)(children: DoubleColDivideLongColumn(col 54:double, col 19:bigint)(children: DoubleColSubtractDoubleColumn(col 17:double, col 53:double)(children: DoubleColDivideLongColumn(col 52:double, col 19:bigint)(children: DoubleColMultiplyDoubleColumn(col 18:double, col 18:double) -> 52:double) -> 53:double) -> 54:double) -> 55:double) -> 56:double
+                      projectedOutputColumnNums: [0, 1, 27, 29, 7, 8, 36, 40, 42, 49, 50, 19, 54, 59, 15]
+                      selectExpressions: FuncPowerDoubleToDouble(col 26:double)(children: DoubleColDivideLongColumn(col 25:double, col 4:bigint)(children: DoubleColSubtractDoubleColumn(col 2:double, col 24:double)(children: DoubleColDivideLongColumn(col 23:double, col 4:bigint)(children: DoubleColMultiplyDoubleColumn(col 3:double, col 3:double) -> 23:double) -> 24:double) -> 25:double) -> 26:double) -> 27:double, DoubleColDivideLongColumn(col 28:double, col 6:bigint)(children: CastLongToDouble(col 5:bigint) -> 28:double) -> 29:double, DoubleColDivideLongColumn(col 32:double, col 35:bigint)(children: DoubleColSubtractDoubleColumn(col 9:double, col 31:double)(children: DoubleColDivideLongColumn(col 30:double, col 11:bigint)(children: DoubleColMultiplyDoubleColumn(col 10:double, col 10:double) -> 30:double) -> 31:double) -> 32:double, IfExprNullCondExpr(col 33:boolean, null, col 34:bigint)(children: LongColEqualLongScalar(col 11:bigint, val 1) -> 33:boolean, LongColSubtractLongScalar(col 11:bigint, val 1) -> 34:bigint) -> 35:bigint) -> 36:double, DoubleColDivideLongColumn(col 39:double, col 14:bigint)(children: DoubleColSubtractDoubleColumn(col 12:double, col 38:double)(children: DoubleColDivideLongColumn(col 37:double, col 14:bigint)(children: DoubleColMultiplyDoubleColumn(col 13:double, col 13:double) -> 37:double) -> 38:double) -> 39:double) -> 40:double, DoubleColDivideLongColumn(col 41:double, col 16:bigint)(children: CastLongToDouble(col 15:bigint) -> 41:double) -> 42:double, DoubleColDivideLongColumn(col 45:double, col 48:bigint)(children: DoubleColSubtractDoubleColumn(col 12:double, col 44:double)(children: DoubleColDivideLongColumn(col 43:double, col 14:bigint)(children: DoubleColMultiplyDoubleColumn(col 13:double, col 13:double) -> 43:double) -> 44:double) -> 45:double, IfExprNullCondExpr(col 46:boolean, null, col 47:bigint)(children: LongColEqualLongScalar(col 14:bigint, val 1) -> 46:boolean, LongColSubtractLongScalar(col 14:bigint, val 1) -> 47:bigint) -> 48:bigint) -> 49:double, DoubleColDivideLongColumn(col 17:double, col 18:bigint) -> 50:double, DoubleColDivideLongColumn(col 53:double, col 11:bigint)(children: DoubleColSubtractDoubleColumn(col 9:double, col 52:double)(children: DoubleColDivideLongColumn(col 51:double, col 11:bigint)(children: DoubleColMultiplyDoubleColumn(col 10:double, col 10:double) -> 51:double) -> 52:double) -> 53:double) -> 54:double, FuncPowerDoubleToDouble(col 58:double)(children: DoubleColDivideLongColumn(col 57:double, col 22:bigint)(children: DoubleColSubtractDoubleColumn(col 20:double, col 56:double)(children: DoubleColDivideLongColumn(col 55:double, col 22:bigint)(children: DoubleColMultiplyDoubleColumn(col 21:double, col 21:double) -> 55:double) -> 56:double) -> 57:double) -> 58:double) -> 59:double
                   Statistics: Num rows: 5980 Data size: 1196404 Basic stats: COMPLETE Column stats: COMPLETE
                   Top N Key Operator
                     sort order: +++++++++++++++++++++++++++++++++++++++
@@ -3006,7 +3006,7 @@ STAGE PLANS:
                     top n: 50
                     Top N Key Vectorization:
                         className: VectorTopNKeyOperator
-                        keyExpressions: col 0:timestamp, col 1:string, col 24:double, DoubleColMultiplyDoubleScalar(col 24:double, val 10.175) -> 57:double, DoubleColUnaryMinus(col 24:double) -> 58:double, col 26:double, DoubleColUnaryMinus(col 24:double) -> 59:double, DoubleScalarSubtractDoubleColumn(val -26.28, col 24:double) -> 60:double, col 7:bigint, LongColUnaryMinus(col 7:bigint) -> 61:bigint, DoubleColMultiplyDoubleColumn(col 62:double, col 63:double)(children: DoubleScalarSubtractDoubleColumn(val -26.28, col 24:double) -> 62:double, DoubleColUnaryMinus(col 24:double) -> 63:double) -> 64:double, col 8:tinyint, DoubleColMultiplyDoubleColumn(col 67:double, col 69:double)(children: DoubleColMultiplyDoubleColumn(col 65:double, col 66:double)(children: DoubleScalarSubtractDoubleColumn(val -26.28, col 24:double) -> 65:double, DoubleColUnaryMinus(col 24:double) -> 66:double) -> 67:double, CastLongToDouble(col 68:bigint)(children: LongColUnaryMinus(col 7:bigint) -> 68:bigint) -> 69:double) -> 70:double, DoubleColUnaryMinus(col 71:double)(children: DoubleColMultiplyDoubleScalar(col 24:double, val 10.175) -> 71:double) -> 72:double, col 33:double, DoubleColAddDoubleColumn(col 33:double, col 78:double)(children: DoubleColMultiplyDoubleColumn(col 75:double, col 77:double)(children: DoubleColMultiplyDoubleColumn(col 73:double, col 74:double)(children: DoubleScalarSubtractDoubleColumn(val -26.28, col 24:double) -> 73:double, DoubleColUnaryMinus(col 24:double) -> 74:double) -> 75:double, CastLongToDouble(col 76:bigint)(children: LongColUnaryMinus(col 7:bigint) -> 76:bigint) -> 77:double) -> 78:double) -> 79:double, col 24:double, DoubleColDivideDoubleColumn(col 81:double, col 24:double)(children: CastLongToDouble(col 80:bigint)(children: LongColUnaryMinus(col 7:bigint) -> 80:bigint) -> 81:double) -> 82:double, col 37:double, DoubleScalarDivideDoubleColumn(val 10.175, col 26:double) -> 83:double, col 39:double, col 46:double, DoubleColSubtractDoubleColumn(col 90:double, col 96:double)(children: DoubleColAddDoubleColumn(col 33:double, col 89:double)(children: DoubleColMultiplyDoubleColumn(col 86:double, col 88:double)(children: DoubleColMultiplyDoubleColumn(col 84:double, col 85:double)(children: DoubleScalarSubtractDoubleColumn(val -26.28, col 24:double) -> 84:double, DoubleColUnaryMinus(col 24:double) -> 85:double) -> 86:double, CastLongToDouble(col 87:bigint)(children: LongColUnaryMinus(col 7:bigint) -> 87:bigint) -> 88:double) -> 89:double) -> 90:double, DoubleColMultiplyDoubleColumn(col 93:double, col 95:double)(children: DoubleColMultiplyDoubleColumn(col 91:double, col 92:double)(children: DoubleScalarSubtractDoubleColumn(val -26.28, col 24:double) -> 91:double, DoubleColUnaryMinus(col 24:double) -> 92:double) -> 93:double, CastLongToDouble(col 94:bigint)(children: LongColUnaryMinus(col 7:bigint) -> 94:bigint) -> 95:double) -> 96:double) -> 97:double, DoubleColMultiplyDoubleScalar(col 24:double, val 10.175) -> 98:double, col 47:double, DoubleColMultiplyDoubleScalar(col 112:double, val 10.175)(children: DoubleColSubtractDoubleColumn(col 105:double, col 111:double)(children: DoubleColAddDoubleColumn(col 33:double, col 104:double)(children: DoubleColMultiplyDoubleColumn(col 101:double, col 103:double)(children: DoubleColMultiplyDoubleColumn(col 99:double, col 100:double)(children: DoubleScalarSubtractDoubleColumn(val -26.28, col 24:double) -> 99:double, DoubleColUnaryMinus(col 24:double) -> 100:double) -> 101:double, CastLongToDouble(col 102:bigint)(children: LongColUnaryMinus(col 7:bigint) -> 102:bigint) -> 103:double) -> 104:double) -> 105:double, DoubleColMultiplyDoubleColumn(col 108:double, col 110:double)(children: DoubleColMultiplyDoubleColumn(col 106:double, col 107:double)(children: DoubleScalarSubtractDoubleColumn(val -26.28, col 24:double) -> 106:double, DoubleColUnaryMinus(col 24:double) -> 107:double) -> 108:double, CastLongToDouble(col 109:bigint)(children: LongColUnaryMinus(col 7:bigint) -> 109:bigint) -> 110:double) -> 111:double) -> 112:double) -> 113:double, DoubleScalarModuloDoubleColumn(val 10.175, col 114:double)(children: DoubleScalarDivideDoubleColumn(val 10.175, col 26:double) -> 114:double) -> 115:double, LongColUnaryMinus(col 8:tinyint) -> 116:tinyint, col 16:double, col 51:double, DoubleColUnaryMinus(col 119:double)(children: DoubleColMultiplyDoubleColumn(col 117:double, col 118:double)(children: DoubleScalarSubtractDoubleColumn(val -26.28, col 24:double) -> 117:double, DoubleColUnaryMinus(col 24:double) -> 118:double) -> 119:double) -> 120:double, DoubleColModuloDoubleColumn(col 121:double, col 47:double)(children: DoubleColUnaryMinus(col 24:double) -> 121:double) -> 122:double, DecimalScalarDivideDecimalColumn(val -26.28, col 124:decimal(3,0))(children: CastLongToDecimal(col 123:tinyint)(children: LongColUnaryMinus(col 8:tinyint) -> 123:tinyint) -> 124:decimal(3,0)) -> 125:decimal(8,6), col 56:double, col 14:bigint, DoubleColDivideDoubleColumn(col 132:double, col 37:double)(children: DoubleColAddDoubleColumn(col 33:double, col 131:double)(children: DoubleColMultiplyDoubleColumn(col 128:double, col 130:double)(children: DoubleColMultiplyDoubleColumn(col 126:double, col 127:double)(children: DoubleScalarSubtractDoubleColumn(val -26.28, col 24:double) -> 126:double, DoubleColUnaryMinus(col 24:double) -> 127:double) -> 128:double, CastLongToDouble(col 129:bigint)(children: LongColUnaryMinus(col 7:bigint) -> 129:bigint) -> 130:double) -> 131:double) -> 132:double) -> 133:double, col 7:bigint, col 7:bigint, DoubleColModuloDoubleScalar(col 140:double, val -26.28)(children: DoubleColAddDoubleColumn(col 33:double, col 139:double)(children: DoubleColMultiplyDoubleColumn(col 136:double, col 138:double)(children: DoubleColMultiplyDoubleColumn(col 134:double, col 135:double)(children: DoubleScalarSubtractDoubleColumn(val -26.28, col 24:double) -> 134:double, DoubleColUnaryMinus(col 24:double) -> 135:double) -> 136:double, CastLongToDouble(col 137:bigint)(children: LongColUnaryMinus(col 7:bigint) -> 137:bigint) -> 138:double) -> 139:double) -> 140:double) -> 141:double
+                        keyExpressions: col 0:timestamp, col 1:string, col 27:double, DoubleColMultiplyDoubleScalar(col 27:double, val 10.175) -> 60:double, DoubleColUnaryMinus(col 27:double) -> 61:double, col 29:double, DoubleColUnaryMinus(col 27:double) -> 62:double, DoubleScalarSubtractDoubleColumn(val -26.28, col 27:double) -> 63:double, col 7:bigint, LongColUnaryMinus(col 7:bigint) -> 64:bigint, DoubleColMultiplyDoubleColumn(col 65:double, col 66:double)(children: DoubleScalarSubtractDoubleColumn(val -26.28, col 27:double) -> 65:double, DoubleColUnaryMinus(col 27:double) -> 66:double) -> 67:double, col 8:tinyint, DoubleColMultiplyDoubleColumn(col 70:double, col 72:double)(children: DoubleColMultiplyDoubleColumn(col 68:double, col 69:double)(children: DoubleScalarSubtractDoubleColumn(val -26.28, col 27:double) -> 68:double, DoubleColUnaryMinus(col 27:double) -> 69:double) -> 70:double, CastLongToDouble(col 71:bigint)(children: LongColUnaryMinus(col 7:bigint) -> 71:bigint) -> 72:double) -> 73:double, DoubleColUnaryMinus(col 74:double)(children: DoubleColMultiplyDoubleScalar(col 27:double, val 10.175) -> 74:double) -> 75:double, col 36:double, DoubleColAddDoubleColumn(col 36:double, col 81:double)(children: DoubleColMultiplyDoubleColumn(col 78:double, col 80:double)(children: DoubleColMultiplyDoubleColumn(col 76:double, col 77:double)(children: DoubleScalarSubtractDoubleColumn(val -26.28, col 27:double) -> 76:double, DoubleColUnaryMinus(col 27:double) -> 77:double) -> 78:double, CastLongToDouble(col 79:bigint)(children: LongColUnaryMinus(col 7:bigint) -> 79:bigint) -> 80:double) -> 81:double) -> 82:double, col 27:double, DoubleColDivideDoubleColumn(col 84:double, col 27:double)(children: CastLongToDouble(col 83:bigint)(children: LongColUnaryMinus(col 7:bigint) -> 83:bigint) -> 84:double) -> 85:double, col 40:double, DoubleScalarDivideDoubleColumn(val 10.175, col 29:double) -> 86:double, col 42:double, col 49:double, DoubleColSubtractDoubleColumn(col 93:double, col 99:double)(children: DoubleColAddDoubleColumn(col 36:double, col 92:double)(children: DoubleColMultiplyDoubleColumn(col 89:double, col 91:double)(children: DoubleColMultiplyDoubleColumn(col 87:double, col 88:double)(children: DoubleScalarSubtractDoubleColumn(val -26.28, col 27:double) -> 87:double, DoubleColUnaryMinus(col 27:double) -> 88:double) -> 89:double, CastLongToDouble(col 90:bigint)(children: LongColUnaryMinus(col 7:bigint) -> 90:bigint) -> 91:double) -> 92:double) -> 93:double, DoubleColMultiplyDoubleColumn(col 96:double, col 98:double)(children: DoubleColMultiplyDoubleColumn(col 94:double, col 95:double)(children: DoubleScalarSubtractDoubleColumn(val -26.28, col 27:double) -> 94:double, DoubleColUnaryMinus(col 27:double) -> 95:double) -> 96:double, CastLongToDouble(col 97:bigint)(children: LongColUnaryMinus(col 7:bigint) -> 97:bigint) -> 98:double) -> 99:double) -> 100:double, DoubleColMultiplyDoubleScalar(col 27:double, val 10.175) -> 101:double, col 50:double, DoubleColMultiplyDoubleScalar(col 115:double, val 10.175)(children: DoubleColSubtractDoubleColumn(col 108:double, col 114:double)(children: DoubleColAddDoubleColumn(col 36:double, col 107:double)(children: DoubleColMultiplyDoubleColumn(col 104:double, col 106:double)(children: DoubleColMultiplyDoubleColumn(col 102:double, col 103:double)(children: DoubleScalarSubtractDoubleColumn(val -26.28, col 27:double) -> 102:double, DoubleColUnaryMinus(col 27:double) -> 103:double) -> 104:double, CastLongToDouble(col 105:bigint)(children: LongColUnaryMinus(col 7:bigint) -> 105:bigint) -> 106:double) -> 107:double) -> 108:double, DoubleColMultiplyDoubleColumn(col 111:double, col 113:double)(children: DoubleColMultiplyDoubleColumn(col 109:double, col 110:double)(children: DoubleScalarSubtractDoubleColumn(val -26.28, col 27:double) -> 109:double, DoubleColUnaryMinus(col 27:double) -> 110:double) -> 111:double, CastLongToDouble(col 112:bigint)(children: LongColUnaryMinus(col 7:bigint) -> 112:bigint) -> 113:double) -> 114:double) -> 115:double) -> 116:double, DoubleScalarModuloDoubleColumn(val 10.175, col 117:double)(children: DoubleScalarDivideDoubleColumn(val 10.175, col 29:double) -> 117:double) -> 118:double, LongColUnaryMinus(col 8:tinyint) -> 119:tinyint, col 19:double, col 54:double, DoubleColUnaryMinus(col 122:double)(children: DoubleColMultiplyDoubleColumn(col 120:double, col 121:double)(children: DoubleScalarSubtractDoubleColumn(val -26.28, col 27:double) -> 120:double, DoubleColUnaryMinus(col 27:double) -> 121:double) -> 122:double) -> 123:double, DoubleColModuloDoubleColumn(col 124:double, col 50:double)(children: DoubleColUnaryMinus(col 27:double) -> 124:double) -> 125:double, DecimalScalarDivideDecimalColumn(val -26.28, col 127:decimal(3,0))(children: CastLongToDecimal(col 126:tinyint)(children: LongColUnaryMinus(col 8:tinyint) -> 126:tinyint) -> 127:decimal(3,0)) -> 128:decimal(8,6), col 59:double, col 15:bigint, DoubleColDivideDoubleColumn(col 135:double, col 40:double)(children: DoubleColAddDoubleColumn(col 36:double, col 134:double)(children: DoubleColMultiplyDoubleColumn(col 131:double, col 133:double)(children: DoubleColMultiplyDoubleColumn(col 129:double, col 130:double)(children: DoubleScalarSubtractDoubleColumn(val -26.28, col 27:double) -> 129:double, DoubleColUnaryMinus(col 27:double) -> 130:double) -> 131:double, CastLongToDouble(col 132:bigint)(children: LongColUnaryMinus(col 7:bigint) -> 132:bigint) -> 133:double) -> 134:double) -> 135:double) -> 136:double, col 7:bigint, col 7:bigint, DoubleColModuloDoubleScalar(col 143:double, val -26.28)(children: DoubleColAddDoubleColumn(col 36:double, col 142:double)(children: DoubleColMultiplyDoubleColumn(col 139:double, col 141:double)(children: DoubleColMultiplyDoubleColumn(col 137:double, col 138:double)(children: DoubleScalarSubtractDoubleColumn(val -26.28, col 27:double) -> 137:double, DoubleColUnaryMinus(col 27:double) -> 138:double) -> 139:double, CastLongToDouble(col 140:bigint)(children: LongColUnaryMinus(col 7:bigint) -> 140:bigint) -> 141:double) -> 142:double) -> 143:double) -> 144:double
                         native: true
                     Select Operator
                       expressions: _col0 (type: timestamp), _col1 (type: string), _col2 (type: double), (_col2 * 10.175D) (type: double), (- _col2) (type: double), _col3 (type: double), (- _col2) (type: double), (-26.28D - _col2) (type: double), _col4 (type: bigint), (- _col4) (type: bigint), ((-26.28D - _col2) * (- _col2)) (type: double), _col5 (type: tinyint), (((-26.28D - _col2) * (- _col2)) * UDFToDouble((- _col4))) (type: double), (- (_col2 * 10.175D)) (type: double), _col6 (type: double), (_col6 + (((-26.28D - _col2) * (- _col2)) * UDFToDouble((- _col4)))) (type: double), _col2 (type: double), (UDFToDouble((- _col4)) / _col2) (type: double), _col7 (type: double), (10.175D / _col3) (type: double), _col8 (type: double), _col9 (type: double), ((_col6 + (((-26.28D - _col2) * (- _col2)) * UDFToDouble((- _col4)))) - (((-26.28D - _col2) * (- _col2)) * UDFToDouble((- _col4)))) (type: double), (_col2 * 10.175D) (type: double), _col10 (type: double), (((_col6 + (((-26.28D - _col2) * (- _col2)) * UDFToDouble((- _col4)))) - (((-26.28D - _col2) * (- _col2)) * UDFToDouble((- _col4)))) * 10.175D) (type: double), (10.175D % (10.175D / _col3)) (type: double), (- _col5) (type: tinyint), _col11 (type: double), _col12 (type: double), (- ((-26.28D - _col2) * (- _col2))) (type: double), ((- _col2) % _col10) (type: double), (-26.28 / CAST( (- _col5) AS decimal(3,0))) (type: decimal(8,6)), _col13 (type: double), _col14 (type: bigint), ((_col6 + (((-26.28D - _col2) * (- _col2)) * UDFToDouble((- _col4)))) / _col7) (type: double), _col4 (type: bigint), _col4 (type: bigint), ((_col6 + (((-26.28D - _col2) * (- _col2)) * UDFToDouble((- _col4)))) % -26.28D) (type: double)
@@ -3014,8 +3014,8 @@ STAGE PLANS:
                       Select Vectorization:
                           className: VectorSelectOperator
                           native: true
-                          projectedOutputColumnNums: [0, 1, 24, 20, 21, 26, 22, 23, 7, 32, 28, 8, 27, 29, 33, 25, 24, 35, 37, 34, 39, 46, 38, 36, 47, 40, 42, 45, 16, 51, 41, 49, 142, 56, 14, 50, 7, 7, 52]
-                          selectExpressions: DoubleColMultiplyDoubleScalar(col 24:double, val 10.175) -> 20:double, DoubleColUnaryMinus(col 24:double) -> 21:double, DoubleColUnaryMinus(col 24:double) -> 22:double, DoubleScalarSubtractDoubleColumn(val -26.28, col 24:double) -> 23:double, LongColUnaryMinus(col 7:bigint) -> 32:bigint, DoubleColMultiplyDoubleColumn(col 25:double, col 27:double)(children: DoubleScalarSubtractDoubleColumn(val -26.28, col 24:double) -> 25:double, DoubleColUnaryMinus(col 24:double) -> 27:double) -> 28:double, DoubleColMultiplyDoubleColumn(col 29:double, col 25:double)(children: DoubleColMultiplyDoubleColumn(col 25:double, col 27:double)(children: DoubleScalarSubtractDoubleColumn(val -26.28, col 24:double) -> 25:double, DoubleColUnaryMinus(col 24:double) -> 27:double) -> 29:double, CastLongToDouble(col 45:bigint)(children: LongColUnaryMinus(col 7:bigint) -> 45:bigint) -> 25:double) -> 27:double, DoubleColUnaryMinus(col 25:double)(children: DoubleColMultiplyDoubleScalar(col 24:double, val 10.175) -> 25:double) -> 29:double, DoubleColAddDoubleColumn(col 33:double, col 34:double)(children: DoubleColMultiplyDoubleColumn(col 35:double, col 25:double)(children: DoubleColMultiplyDoubleColumn(col 25:double, col 34:double)(children: DoubleScalarSubtractDoubleColumn(val -26.28, col 24:double) -> 25:double, DoubleColUnaryMinus(col 24:double) -> 34:double) -> 35:double, CastLongToDouble(col 45:bigint)(children: LongColUnaryMinus(col 7:bigint) -> 45:bigint) -> 25:double) -> 34:double) -> 25:double, DoubleColDivideDoubleColumn(col 34:double, col 24:double)(children: CastLongToDouble(col 45:bigint)(children: LongColUnaryMinus(col 7:bigint) -> 45:bigint) -> 34:double) -> 35:double, DoubleScalarDivideDoubleColumn(val 10.175, col 26:double) -> 34:double, DoubleColSubtractDoubleColumn(col 36:double, col 40:double)(children: DoubleColAddDoubleColumn(col 33:double, col 38:double)(children: DoubleColMultiplyDoubleColumn(col 40:double, col 36:double)(children: DoubleColMultiplyDoubleColumn(col 36:double, col 38:double)(children: DoubleScalarSubtractDoubleColumn(val -26.28, col 24:double) -> 36:double, DoubleColUnaryMinus(col 24:double) -> 38:double) -> 40:double, CastLongToDouble(col 45:bigint)(children: LongColUnaryMinus(col 7:bigint) -> 45:bigint) -> 36:double) -> 38:double) -> 36:double, DoubleColMultiplyDoubleColumn(col 41:double, col 38:double)(children: DoubleColMultiplyDoubleColumn(col 38:double, col 40:double)(children: DoubleScalarSubtractDoubleColumn(val -26.28, col 24:double) -> 38:double, DoubleColUnaryMinus(col 24:double) -> 40:double) -> 41:double, CastLongToDouble(col 45:bigint)(children: LongColUnaryMinus(col 7:bigint) -> 45:bigint) -> 38:double) -> 40:double) -> 38:double, DoubleColMultiplyDoubleScalar(col 24:double, val 10.175) -> 36:double, DoubleColMultiplyDoubleScalar(col 41:double, val 10.175)(children: DoubleColSubtractDoubleColumn(col 40:double, col 42:double)(children: DoubleColAddDoubleColumn(col 33:double, col 41:double)(children: DoubleColMultiplyDoubleColumn(col 42:double, col 40:double)(children: DoubleColMultiplyDoubleColumn(col 40:double, col 41:double)(children: DoubleScalarSubtractDoubleColumn(val -26.28, col 24:double) -> 40:double, DoubleColUnaryMinus(col 24:double) -> 41:double) -> 42:double, CastLongToDouble(col 45:bigint)(children: LongColUnaryMinus(col 7:bigint) -> 45:bigint) -> 40:double) -> 41:double) -> 40:double, DoubleColMultiplyDoubleColumn(col 48:double, col 41:double)(children: DoubleColMultiplyDoubleColumn(col 41:double, col 42:double)(children: DoubleScalarSubtractDoubleColumn(val -26.28, col 24:double) -> 41:double, DoubleColUnaryMinus(col 24:double) -> 42:double) -> 48:double, CastLongToDouble(col 45:bigint)(children: LongColUnaryMinus(col 7:bigint) -> 45:bigint) -> 41:double) -> 42:double) -> 41:double) -> 40:double, DoubleScalarModuloDoubleColumn(val 10.175, col 41:double)(children: DoubleScalarDivideDoubleColumn(val 10.175, col 26:double) -> 41:double) -> 42:double, LongColUnaryMinus(col 8:tinyint) -> 45:tinyint, DoubleColUnaryMinus(col 49:double)(children: DoubleColMultiplyDoubleColumn(col 41:double, col 48:double)(children: DoubleScalarSubtractDoubleColumn(val -26.28, col 24:double) -> 41:double, DoubleColUnaryMinus(col 24:double) -> 48:double) -> 49:double) -> 41:double, DoubleColModuloDoubleColumn(col 48:double, col 47:double)(children: DoubleColUnaryMinus(col 24:double) -> 48:double) -> 49:double, DecimalScalarDivideDecimalColumn(val -26.28, col 124:decimal(3,0))(children: CastLongToDecimal(col 68:tinyint)(children: LongColUnaryMinus(col 8:tinyint) -> 68:tinyint) -> 124:decimal(3,0)) -> 142:decimal(8,6), DoubleColDivideDoubleColumn(col 48:double, col 37:double)(children: DoubleColAddDoubleColumn(col 33:double, col 50:double)(children: DoubleColMultiplyDoubleColumn(col 52:double, col 48:double)(children: DoubleColMultiplyDoubleColumn(col 48:double, col 50:double)(children: DoubleScalarSubtractDoubleColumn(val -26.28, col 24:double) -> 48:double, DoubleColUnaryMinus(col 24:double) -> 50:double) -> 52:double, CastLongToDouble(col 68:bigint)(children: LongColUnaryMinus(col 7:bigint) -> 68:bigint) -> 48:double) -> 50:double) -> 48:double) -> 50:double, DoubleColModuloDoubleScalar(col 48:double, val -26.28)(children: DoubleColAddDoubleColumn(col 33:double, col 52:double)(children: DoubleColMultiplyDoubleColumn(col 53:double, col 48:double)(children: DoubleColMultiplyDoubleColumn(col 48:double, col 52:double)(children: DoubleScalarSubtractDoubleColumn(val -26.28, col 24:double) -> 48:double, DoubleColUnaryMinus(col 24:double) -> 52:double) -> 53:double, CastLongToDouble(col 68:bigint)(children: LongColUnaryMinus(col 7:bigint) -> 68:bigint) -> 48:double) -> 52:double) -> 48:double) -> 52:double
+                          projectedOutputColumnNums: [0, 1, 27, 23, 24, 29, 25, 26, 7, 35, 31, 8, 30, 32, 36, 28, 27, 38, 40, 37, 42, 49, 41, 39, 50, 43, 45, 48, 19, 54, 44, 52, 145, 59, 15, 53, 7, 7, 55]
+                          selectExpressions: DoubleColMultiplyDoubleScalar(col 27:double, val 10.175) -> 23:double, DoubleColUnaryMinus(col 27:double) -> 24:double, DoubleColUnaryMinus(col 27:double) -> 25:double, DoubleScalarSubtractDoubleColumn(val -26.28, col 27:double) -> 26:double, LongColUnaryMinus(col 7:bigint) -> 35:bigint, DoubleColMultiplyDoubleColumn(col 28:double, col 30:double)(children: DoubleScalarSubtractDoubleColumn(val -26.28, col 27:double) -> 28:double, DoubleColUnaryMinus(col 27:double) -> 30:double) -> 31:double, DoubleColMultiplyDoubleColumn(col 32:double, col 28:double)(children: DoubleColMultiplyDoubleColumn(col 28:double, col 30:double)(children: DoubleScalarSubtractDoubleColumn(val -26.28, col 27:double) -> 28:double, DoubleColUnaryMinus(col 27:double) -> 30:double) -> 32:double, CastLongToDouble(col 48:bigint)(children: LongColUnaryMinus(col 7:bigint) -> 48:bigint) -> 28:double) -> 30:double, DoubleColUnaryMinus(col 28:double)(children: DoubleColMultiplyDoubleScalar(col 27:double, val 10.175) -> 28:double) -> 32:double, DoubleColAddDoubleColumn(col 36:double, col 37:double)(children: DoubleColMultiplyDoubleColumn(col 38:double, col 28:double)(children: DoubleColMultiplyDoubleColumn(col 28:double, col 37:double)(children: DoubleScalarSubtractDoubleColumn(val -26.28, col 27:double) -> 28:double, DoubleColUnaryMinus(col 27:double) -> 37:double) -> 38:double, CastLongToDouble(col 48:bigint)(children: LongColUnaryMinus(col 7:bigint) -> 48:bigint) -> 28:double) -> 37:double) -> 28:double, DoubleColDivideDoubleColumn(col 37:double, col 27:double)(children: CastLongToDouble(col 48:bigint)(children: LongColUnaryMinus(col 7:bigint) -> 48:bigint) -> 37:double) -> 38:double, DoubleScalarDivideDoubleColumn(val 10.175, col 29:double) -> 37:double, DoubleColSubtractDoubleColumn(col 39:double, col 43:double)(children: DoubleColAddDoubleColumn(col 36:double, col 41:double)(children: DoubleColMultiplyDoubleColumn(col 43:double, col 39:double)(children: DoubleColMultiplyDoubleColumn(col 39:double, col 41:double)(children: DoubleScalarSubtractDoubleColumn(val -26.28, col 27:double) -> 39:double, DoubleColUnaryMinus(col 27:double) -> 41:double) -> 43:double, CastLongToDouble(col 48:bigint)(children: LongColUnaryMinus(col 7:bigint) -> 48:bigint) -> 39:double) -> 41:double) -> 39:double, DoubleColMultiplyDoubleColumn(col 44:double, col 41:double)(children: DoubleColMultiplyDoubleColumn(col 41:double, col 43:double)(children: DoubleScalarSubtractDoubleColumn(val -26.28, col 27:double) -> 41:double, DoubleColUnaryMinus(col 27:double) -> 43:double) -> 44:double, CastLongToDouble(col 48:bigint)(children: LongColUnaryMinus(col 7:bigint) -> 48:bigint) -> 41:double) -> 43:double) -> 41:double, DoubleColMultiplyDoubleScalar(col 27:double, val 10.175) -> 39:double, DoubleColMultiplyDoubleScalar(col 44:double, val 10.175)(children: DoubleColSubtractDoubleColumn(col 43:double, col 45:double)(children: DoubleColAddDoubleColumn(col 36:double, col 44:double)(children: DoubleColMultiplyDoubleColumn(col 45:double, col 43:double)(children: DoubleColMultiplyDoubleColumn(col 43:double, col 44:double)(children: DoubleScalarSubtractDoubleColumn(val -26.28, col 27:double) -> 43:double, DoubleColUnaryMinus(col 27:double) -> 44:double) -> 45:double, CastLongToDouble(col 48:bigint)(children: LongColUnaryMinus(col 7:bigint) -> 48:bigint) -> 43:double) -> 44:double) -> 43:double, DoubleColMultiplyDoubleColumn(col 51:double, col 44:double)(children: DoubleColMultiplyDoubleColumn(col 44:double, col 45:double)(children: DoubleScalarSubtractDoubleColumn(val -26.28, col 27:double) -> 44:double, DoubleColUnaryMinus(col 27:double) -> 45:double) -> 51:double, CastLongToDouble(col 48:bigint)(children: LongColUnaryMinus(col 7:bigint) -> 48:bigint) -> 44:double) -> 45:double) -> 44:double) -> 43:double, DoubleScalarModuloDoubleColumn(val 10.175, col 44:double)(children: DoubleScalarDivideDoubleColumn(val 10.175, col 29:double) -> 44:double) -> 45:double, LongColUnaryMinus(col 8:tinyint) -> 48:tinyint, DoubleColUnaryMinus(col 52:double)(children: DoubleColMultiplyDoubleColumn(col 44:double, col 51:double)(children: DoubleScalarSubtractDoubleColumn(val -26.28, col 27:double) -> 44:double, DoubleColUnaryMinus(col 27:double) -> 51:double) -> 52:double) -> 44:double, DoubleColModuloDoubleColumn(col 51:double, col 50:double)(children: DoubleColUnaryMinus(col 27:double) -> 51:double) -> 52:double, DecimalScalarDivideDecimalColumn(val -26.28, col 127:decimal(3,0))(children: CastLongToDecimal(col 71:tinyint)(children: LongColUnaryMinus(col 8:tinyint) -> 71:tinyint) -> 127:decimal(3,0)) -> 145:decimal(8,6), DoubleColDivideDoubleColumn(col 51:double, col 40:double)(children: DoubleColAddDoubleColumn(col 36:double, col 53:double)(children: DoubleColMultiplyDoubleColumn(col 55:double, col 51:double)(children: DoubleColMultiplyDoubleColumn(col 51:double, col 53:double)(children: DoubleScalarSubtractDoubleColumn(val -26.28, col 27:double) -> 51:double, DoubleColUnaryMinus(col 27:double) -> 53:double) -> 55:double, CastLongToDouble(col 71:bigint)(children: LongColUnaryMinus(col 7:bigint) -> 71:bigint) -> 51:double) -> 53:double) -> 51:double) -> 53:double, DoubleColModuloDoubleScalar(col 51:double, val -26.28)(children: DoubleColAddDoubleColumn(col 36:double, col 55:double)(children: DoubleColMultiplyDoubleColumn(col 56:double, col 51:double)(children: DoubleColMultiplyDoubleColumn(col 51:double, col 55:double)(children: DoubleScalarSubtractDoubleColumn(val -26.28, col 27:double) -> 51:double, DoubleColUnaryMinus(col 27:double) -> 55:double) -> 56:double, CastLongToDouble(col 71:bigint)(children: LongColUnaryMinus(col 7:bigint) -> 71:bigint) -> 51:double) -> 55:double) -> 51:double) -> 55:double
                       Statistics: Num rows: 5980 Data size: 2739514 Basic stats: COMPLETE Column stats: COMPLETE
                       Reduce Output Operator
                         key expressions: _col0 (type: timestamp), _col1 (type: string), _col2 (type: double), _col3 (type: double), _col4 (type: double), _col5 (type: double), _col6 (type: double), _col7 (type: double), _col8 (type: bigint), _col9 (type: bigint), _col10 (type: double), _col11 (type: tinyint), _col12 (type: double), _col13 (type: double), _col14 (type: double), _col15 (type: double), _col16 (type: double), _col17 (type: double), _col18 (type: double), _col19 (type: double), _col20 (type: double), _col21 (type: double), _col22 (type: double), _col23 (type: double), _col24 (type: double), _col25 (type: double), _col26 (type: double), _col27 (type: tinyint), _col28 (type: double), _col29 (type: double), _col30 (type: double), _col31 (type: double), _col32 (type: decimal(8,6)), _col33 (type: double), _col34 (type: bigint), _col35 (type: double), _col36 (type: bigint), _col37 (type: bigint), _col38 (type: double)
@@ -3349,29 +3349,29 @@ STAGE PLANS:
                     predicate: (cboolean1 is not null and (((cdouble < UDFToDouble(csmallint)) and (cboolean2 = cboolean1) and (CAST( cbigint AS decimal(22,3)) <= -863.257)) or ((cint >= -257) and (cboolean1 >= 1) and cstring1 is not null) or cstring2 regexp 'b' or ((csmallint >= UDFToShort(ctinyint)) and ctimestamp2 is null))) (type: boolean)
                     Statistics: Num rows: 7012 Data size: 1413600 Basic stats: COMPLETE Column stats: COMPLETE
                     Select Operator
-                      expressions: cboolean1 (type: boolean), cfloat (type: float), cbigint (type: bigint), cint (type: int), cdouble (type: double), ctinyint (type: tinyint), csmallint (type: smallint), UDFToDouble(cint) (type: double), (UDFToDouble(cint) * UDFToDouble(cint)) (type: double), UDFToDouble(cbigint) (type: double), (UDFToDouble(cbigint) * UDFToDouble(cbigint)) (type: double), UDFToDouble(ctinyint) (type: double), (UDFToDouble(ctinyint) * UDFToDouble(ctinyint)) (type: double), UDFToDouble(csmallint) (type: double), (UDFToDouble(csmallint) * UDFToDouble(csmallint)) (type: double)
-                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14
+                      expressions: cboolean1 (type: boolean), cfloat (type: float), cbigint (type: bigint), cint (type: int), cdouble (type: double), UDFToDouble(cint) (type: double), (UDFToDouble(cint) * UDFToDouble(cint)) (type: double), UDFToDouble(cbigint) (type: double), (UDFToDouble(cbigint) * UDFToDouble(cbigint)) (type: double), UDFToDouble(ctinyint) (type: double), (UDFToDouble(ctinyint) * UDFToDouble(ctinyint)) (type: double), UDFToDouble(csmallint) (type: double), (UDFToDouble(csmallint) * UDFToDouble(csmallint)) (type: double)
+                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12
                       Select Vectorization:
                           className: VectorSelectOperator
                           native: true
-                          projectedOutputColumnNums: [10, 4, 3, 2, 5, 0, 1, 16, 19, 20, 23, 24, 27, 28, 31]
+                          projectedOutputColumnNums: [10, 4, 3, 2, 5, 16, 19, 20, 23, 24, 27, 28, 31]
                           selectExpressions: CastLongToDouble(col 2:int) -> 16:double, DoubleColMultiplyDoubleColumn(col 17:double, col 18:double)(children: CastLongToDouble(col 2:int) -> 17:double, CastLongToDouble(col 2:int) -> 18:double) -> 19:double, CastLongToDouble(col 3:bigint) -> 20:double, DoubleColMultiplyDoubleColumn(col 21:double, col 22:double)(children: CastLongToDouble(col 3:bigint) -> 21:double, CastLongToDouble(col 3:bigint) -> 22:double) -> 23:double, CastLongToDouble(col 0:tinyint) -> 24:double, DoubleColMultiplyDoubleColumn(col 25:double, col 26:double)(children: CastLongToDouble(col 0:tinyint) -> 25:double, CastLongToDouble(col 0:tinyint) -> 26:double) -> 27:double, CastLongToDouble(col 1:smallint) -> 28:double, DoubleColMultiplyDoubleColumn(col 29:double, col 30:double)(children: CastLongToDouble(col 1:smallint) -> 29:double, CastLongToDouble(col 1:smallint) -> 30:double) -> 31:double
                       Statistics: Num rows: 7012 Data size: 1413600 Basic stats: COMPLETE Column stats: COMPLETE
                       Group By Operator
-                        aggregations: max(_col1), sum(_col2), sum(_col8), sum(_col7), count(_col3), sum(_col4), count(_col4), min(_col2), sum(_col10), sum(_col9), count(_col2), sum(_col3), sum(_col12), sum(_col11), count(_col5), sum(_col14), sum(_col13), count(_col6)
+                        aggregations: max(_col1), sum(_col2), sum(_col6), sum(_col5), count(_col5), sum(_col4), count(_col4), min(_col2), sum(_col8), sum(_col7), count(_col7), sum(_col3), sum(_col10), sum(_col9), count(_col9), sum(_col12), sum(_col11), count(_col11), count(_col3)
                         Group By Vectorization:
-                            aggregators: VectorUDAFMaxDouble(col 4:float) -> float, VectorUDAFSumLong(col 3:bigint) -> bigint, VectorUDAFSumDouble(col 19:double) -> double, VectorUDAFSumDouble(col 16:double) -> double, VectorUDAFCount(col 2:int) -> bigint, VectorUDAFSumDouble(col 5:double) -> double, VectorUDAFCount(col 5:double) -> bigint, VectorUDAFMinLong(col 3:bigint) -> bigint, VectorUDAFSumDouble(col 23:double) -> double, VectorUDAFSumDouble(col 20:double) -> double, VectorUDAFCount(col 3:bigint) -> bigint, VectorUDAFSumLong(col 2:int) -> bigint, VectorUDAFSumDouble(col 27:double) -> double, VectorUDAFSumDouble(col 24:double) -> double, VectorUDAFCount(col 0:tinyint) -> bigint, VectorUDAFSumDouble(col 31:double) -> double, VectorUDAFSumDouble(col 28:double) -> double, VectorUDAFCount(col 1:smallint) -> bigint
+                            aggregators: VectorUDAFMaxDouble(col 4:float) -> float, VectorUDAFSumLong(col 3:bigint) -> bigint, VectorUDAFSumDouble(col 19:double) -> double, VectorUDAFSumDouble(col 16:double) -> double, VectorUDAFCount(col 16:double) -> bigint, VectorUDAFSumDouble(col 5:double) -> double, VectorUDAFCount(col 5:double) -> bigint, VectorUDAFMinLong(col 3:bigint) -> bigint, VectorUDAFSumDouble(col 23:double) -> double, VectorUDAFSumDouble(col 20:double) -> double, VectorUDAFCount(col 20:double) -> bigint, VectorUDAFSumLong(col 2:int) -> bigint, VectorUDAFSumDouble(col 27:double) -> double, VectorUDAFSumDouble(col 24:double) -> double, VectorUDAFCount(col 24:double) -> bigint, VectorUDAFSumDouble(col 31:double) -> double, VectorUDAFSumDouble(col 28:double) -> double, VectorUDAFCount(col 28:double) -> bigint, VectorUDAFCount(col 2:int) -> bigint
                             className: VectorGroupByOperator
                             groupByMode: HASH
                             keyExpressions: col 10:boolean
                             native: false
                             vectorProcessingMode: HASH
-                            projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17]
+                            projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18]
                         keys: _col0 (type: boolean)
                         minReductionHashAggr: 0.99
                         mode: hash
-                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18
-                        Statistics: Num rows: 3 Data size: 432 Basic stats: COMPLETE Column stats: COMPLETE
+                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19
+                        Statistics: Num rows: 3 Data size: 456 Basic stats: COMPLETE Column stats: COMPLETE
                         Reduce Output Operator
                           key expressions: _col0 (type: boolean)
                           null sort order: z
@@ -3381,8 +3381,8 @@ STAGE PLANS:
                               className: VectorReduceSinkLongOperator
                               native: true
                               nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
-                          Statistics: Num rows: 3 Data size: 432 Basic stats: COMPLETE Column stats: COMPLETE
-                          value expressions: _col1 (type: float), _col2 (type: bigint), _col3 (type: double), _col4 (type: double), _col5 (type: bigint), _col6 (type: double), _col7 (type: bigint), _col8 (type: bigint), _col9 (type: double), _col10 (type: double), _col11 (type: bigint), _col12 (type: bigint), _col13 (type: double), _col14 (type: double), _col15 (type: bigint), _col16 (type: double), _col17 (type: double), _col18 (type: bigint)
+                          Statistics: Num rows: 3 Data size: 456 Basic stats: COMPLETE Column stats: COMPLETE
+                          value expressions: _col1 (type: float), _col2 (type: bigint), _col3 (type: double), _col4 (type: double), _col5 (type: bigint), _col6 (type: double), _col7 (type: bigint), _col8 (type: bigint), _col9 (type: double), _col10 (type: double), _col11 (type: bigint), _col12 (type: bigint), _col13 (type: double), _col14 (type: double), _col15 (type: bigint), _col16 (type: double), _col17 (type: double), _col18 (type: bigint), _col19 (type: bigint)
             Execution mode: vectorized, llap
             LLAP IO: all inputs
             Map Vectorization:
@@ -3404,27 +3404,27 @@ STAGE PLANS:
                 vectorized: true
             Reduce Operator Tree:
               Group By Operator
-                aggregations: max(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3), count(VALUE._col4), sum(VALUE._col5), count(VALUE._col6), min(VALUE._col7), sum(VALUE._col8), sum(VALUE._col9), count(VALUE._col10), sum(VALUE._col11), sum(VALUE._col12), sum(VALUE._col13), count(VALUE._col14), sum(VALUE._col15), sum(VALUE._col16), count(VALUE._col17)
+                aggregations: max(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3), count(VALUE._col4), sum(VALUE._col5), count(VALUE._col6), min(VALUE._col7), sum(VALUE._col8), sum(VALUE._col9), count(VALUE._col10), sum(VALUE._col11), sum(VALUE._col12), sum(VALUE._col13), count(VALUE._col14), sum(VALUE._col15), sum(VALUE._col16), count(VALUE._col17), count(VALUE._col18)
                 Group By Vectorization:
-                    aggregators: VectorUDAFMaxDouble(col 1:float) -> float, VectorUDAFSumLong(col 2:bigint) -> bigint, VectorUDAFSumDouble(col 3:double) -> double, VectorUDAFSumDouble(col 4:double) -> double, VectorUDAFCountMerge(col 5:bigint) -> bigint, VectorUDAFSumDouble(col 6:double) -> double, VectorUDAFCountMerge(col 7:bigint) -> bigint, VectorUDAFMinLong(col 8:bigint) -> bigint, VectorUDAFSumDouble(col 9:double) -> double, VectorUDAFSumDouble(col 10:double) -> double, VectorUDAFCountMerge(col 11:bigint) -> bigint, VectorUDAFSumLong(col 12:bigint) -> bigint, VectorUDAFSumDouble(col 13:double) -> double, VectorUDAFSumDouble(col 14:double) -> double, VectorUDAFCountMerge(col 15:bigint) -> bigint, VectorUDAFSumDouble(col 16:double) -> double, VectorUDAFSumDouble(col 17:double) -> double, VectorUDAFCountMerge(col 18:bigint) -> bigint
+                    aggregators: VectorUDAFMaxDouble(col 1:float) -> float, VectorUDAFSumLong(col 2:bigint) -> bigint, VectorUDAFSumDouble(col 3:double) -> double, VectorUDAFSumDouble(col 4:double) -> double, VectorUDAFCountMerge(col 5:bigint) -> bigint, VectorUDAFSumDouble(col 6:double) -> double, VectorUDAFCountMerge(col 7:bigint) -> bigint, VectorUDAFMinLong(col 8:bigint) -> bigint, VectorUDAFSumDouble(col 9:double) -> double, VectorUDAFSumDouble(col 10:double) -> double, VectorUDAFCountMerge(col 11:bigint) -> bigint, VectorUDAFSumLong(col 12:bigint) -> bigint, VectorUDAFSumDouble(col 13:double) -> double, VectorUDAFSumDouble(col 14:double) -> double, VectorUDAFCountMerge(col 15:bigint) -> bigint, VectorUDAFSumDouble(col 16:double) -> double, VectorUDAFSumDouble(col 17:double) -> double, VectorUDAFCountMerge(col 18:bigint) -> bigint, VectorUDAFCountMerge(col 19:bigint) -> bigint
                     className: VectorGroupByOperator
                     groupByMode: MERGEPARTIAL
                     keyExpressions: col 0:boolean
                     native: false
                     vectorProcessingMode: MERGE_PARTIAL
-                    projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17]
+                    projectedOutputColumnNums: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18]
                 keys: KEY._col0 (type: boolean)
                 mode: mergepartial
-                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18
-                Statistics: Num rows: 3 Data size: 432 Basic stats: COMPLETE Column stats: COMPLETE
+                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19
+                Statistics: Num rows: 3 Data size: 456 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
-                  expressions: _col0 (type: boolean), _col1 (type: float), (- _col1) (type: float), (-26.28D / UDFToDouble(_col1)) (type: double), _col2 (type: bigint), (CAST( _col2 AS decimal(19,0)) - 10.175) (type: decimal(23,3)), ((_col3 - ((_col4 * _col4) / _col5)) / if((_col5 = 1L), null, (_col5 - 1))) (type: double), (((_col3 - ((_col4 * _col4) / _col5)) / if((_col5 = 1L), null, (_col5 - 1))) % UDFToDouble(_col1)) (type: double), (10.175 + (- _col1)) (type: float), (_col6 / _col7) (type: double), (UDFToDouble((CAST( _col2 AS decimal(19,0)) - 10.175)) + ((_col3 - ((_col4 * _col4) / _col5)) / if((_col5 = 1L), null, (_col5 - 1)))) (type: double), _col8 (type: bigint), ((_col9 - ((_col10 * _col10) / _col11)) / _col11) (type: double), (- (10.175 + (- _col1))) (type: float), (79.553D / ((_col9 - ((_col10 * _col10) / _col11)) / _col11)) (type: double), (((_col3 - ((_col4 * _col4) / _col5)) / if((_col5 = 1L), null, (_col5 - 1))) % (79.553D / ((_col9 - ((_col10 * _col10) / _col11)) / _col11))) (type: double), _col12 (type: bigint), power(((_col13 - ((_col14 * _col14) / _col15)) / if((_col15 = 1L), null, (_col15 - 1))), 0.5) (type: double), (-1.389 * CAST( _col8 AS decimal(19,0))) (type: decimal(24,3)), (CAST( _col12 AS decimal(19,0)) - (-1.389 * CAST( _col8 AS decimal(19,0)))) (type: decimal(25,3)), power(((_col16 - ((_col17 * _col17) / _col18)) / _col18), 0.5) (type: double), (- (CAST( _col12 AS decimal(19,0)) - (-1.389 * CAST( _col8 AS decimal(19,0))))) (type: decimal(25,3)), (UDFToDouble(_col12) / _col5) (type: double), (- (UDFToDouble(_col12) / _col5)) (type: double), ((UDFToDouble(_col12) / _col5) * UDFToDouble(_col12)) (type: double)
+                  expressions: _col0 (type: boolean), _col1 (type: float), (- _col1) (type: float), (-26.28D / UDFToDouble(_col1)) (type: double), _col2 (type: bigint), (CAST( _col2 AS decimal(19,0)) - 10.175) (type: decimal(23,3)), ((_col3 - ((_col4 * _col4) / _col5)) / if((_col5 = 1L), null, (_col5 - 1))) (type: double), (((_col3 - ((_col4 * _col4) / _col5)) / if((_col5 = 1L), null, (_col5 - 1))) % UDFToDouble(_col1)) (type: double), (10.175 + (- _col1)) (type: float), (_col6 / _col7) (type: double), (UDFToDouble((CAST( _col2 AS decimal(19,0)) - 10.175)) + ((_col3 - ((_col4 * _col4) / _col5)) / if((_col5 = 1L), null, (_col5 - 1)))) (type: double), _col8 (type: bigint), ((_col9 - ((_col10 * _col10) / _col11)) / _col11) (type: double), (- (10.175 + (- _col1))) (type: float), (79.553D / ((_col9 - ((_col10 * _col10) / _col11)) / _col11)) (type: double), (((_col3 - ((_col4 * _col4) / _col5)) / if((_col5 = 1L), null, (_col5 - 1))) % (79.553D / ((_col9 - ((_col10 * _col10) / _col11)) / _col11))) (type: double), _col12 (type: bigint), power(((_col13 - ((_col14 * _col14) / _col15)) / if((_col15 = 1L), null, (_col15 - 1))), 0.5) (type: double), (-1.389 * CAST( _col8 AS decimal(19,0))) (type: decimal(24,3)), (CAST( _col12 AS decimal(19,0)) - (-1.389 * CAST( _col8 AS decimal(19,0)))) (type: decimal(25,3)), power(((_col16 - ((_col17 * _col17) / _col18)) / _col18), 0.5) (type: double), (- (CAST( _col12 AS decimal(19,0)) - (-1.389 * CAST( _col8 AS decimal(19,0))))) (type: decimal(25,3)), (UDFToDouble(_col12) / _col19) (type: double), (- (UDFToDouble(_col12) / _col19)) (type: double), ((UDFToDouble(_col12) / _col19) * UDFToDouble(_col12)) (type: double)
                   outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col17, _col18, _col19, _col20, _col21, _col22, _col23, _col24, _col25
                   Select Vectorization:
                       className: VectorSelectOperator
                       native: true
-                      projectedOutputColumnNums: [0, 1, 19, 20, 2, 22, 29, 37, 39, 40, 51, 8, 55, 58, 63, 76, 12, 84, 86, 90, 95, 100, 102, 105, 109]
-                      selectExpressions: DoubleColUnaryMinus(col 1:float) -> 19:float, DoubleScalarDivideDoubleColumn(val -26.28, col 1:double)(children: col 1:float) -> 20:double, DecimalColSubtractDecimalScalar(col 21:decimal(19,0), val 10.175)(children: CastLongToDecimal(col 2:bigint) -> 21:decimal(19,0)) -> 22:decimal(23,3), DoubleColDivideLongColumn(col 25:double, col 28:bigint)(children: DoubleColSubtractDoubleColumn(col 3:double, col 24:double)(children: DoubleColDivideLongColumn(col 23:double, col 5:bigint)(children: DoubleColMultiplyDoubleColumn(col 4:double, col 4:double) -> 23:double) -> 24:double) -> 25:double, IfExprNullCondExpr(col 26:boolean, null, col 27:bigint)(children: LongColEqualLongScalar(col 5:bigint, val 1) -> 26:boolean, LongColSubtractLongScalar(col 5:bigint, val 1) -> 27:bigint) -> 28:bigint) -> 29:double, DoubleColModuloDoubleColumn(col 36:double, col 1:double)(children: DoubleColDivideLongColumn(col 32:double, col 35:bigint)(children: DoubleColSubtractDoubleColumn(col 3:double, col 31:double)(children: DoubleColDivideLongColumn(col 30:double, col 5:bigint)(children: DoubleColMultiplyDoubleColumn(col 4:double, col 4:double) -> 30:double) -> 31:double) -> 32:double, IfExprNullCondExpr(col 33:boolean, null, col 34:bigint)(children: LongColEqualLongScalar(col 5:bigint, val 1) -> 33:boolean, LongColSubtractLongScalar(col 5:bigint, val 1) -> 34:bigint) -> 35:bigint) -> 36:double, col 1:float) -> 37:double, DoubleScalarAddDoubleColumn(val 10.175000190734863, col 38:float)(children: DoubleColUnaryMinus(col 1:float) -> 38:float) -> 39:float, DoubleColDivideLongColumn(col 6:double, col 7:bigint) -> 40:double, DoubleColAddDoubleColumn(col 43:double, col 50:double)(children: CastDecimalToDouble(col 42:decimal(23,3))(children: DecimalColSubtractDecimalScalar(col 41:decimal(19,0), val 10.175)(children: CastLongToDecimal(col 2:bigint) -> 41:decimal(19,0)) -> 42:decimal(23,3)) -> 43:double, DoubleColDivideLongColumn(col 46:double, col 49:bigint)(children: DoubleColSubtractDoubleColumn(col 3:double, col 45:double)(children: DoubleColDivideLongColumn(col 44:double, col 5:bigint)(children: DoubleColMultiplyDoubleColumn(col 4:double, col 4:double) -> 44:double) -> 45:double) -> 46:double, IfExprNullCondExpr(col 47:boolean, null, col 48:bigint)(children: LongColEqualLongScalar(col 5:bigint, val 1) -> 47:boolean, LongColSubtractLongScalar(col 5:bigint, val 1) -> 48:bigint) -> 49:bigint) -> 50:double) -> 51:double, DoubleColDivideLongColumn(col 54:double, col 11:bigint)(children: DoubleColSubtractDoubleColumn(col 9:double, col 53:double)(children: DoubleColDivideLongColumn(col 52:double, col 11:bigint)(children: DoubleColMultiplyDoubleColumn(col 10:double, col 10:double) -> 52:double) -> 53:double) -> 54:double) -> 55:double, DoubleColUnaryMinus(col 57:float)(children: DoubleScalarAddDoubleColumn(val 10.175000190734863, col 56:float)(children: DoubleColUnaryMinus(col 1:float) -> 56:float) -> 57:float) -> 58:float, DoubleScalarDivideDoubleColumn(val 79.553, col 62:double)(children: DoubleColDivideLongColumn(col 61:double, col 11:bigint)(children: DoubleColSubtractDoubleColumn(col 9:double, col 60:double)(children: DoubleColDivideLongColumn(col 59:double, col 11:bigint)(children: DoubleColMultiplyDoubleColumn(col 10:double, col 10:double) -> 59:double) -> 60:double) -> 61:double) -> 62:double) -> 63:double, DoubleColModuloDoubleColumn(col 70:double, col 75:double)(children: DoubleColDivideLongColumn(col 66:double, col 69:bigint)(children: DoubleColSubtractDoubleColumn(col 3:double, col 65:double)(children: DoubleColDivideLongColumn(col 64:double, col 5:bigint)(children: DoubleColMultiplyDoubleColumn(col 4:double, col 4:double) -> 64:double) -> 65:double) -> 66:double, IfExprNullCondExpr(col 67:boolean, null, col 68:bigint)(children: LongColEqualLongScalar(col 5:bigint, val 1) -> 67:boolean, LongColSubtractLongScalar(col 5:bigint, val 1) -> 68:bigint) -> 69:bigint) -> 70:double, DoubleScalarDivideDoubleColumn(val 79.553, col 74:double)(children: DoubleColDivideLongColumn(col 73:double, col 11:bigint)(children: DoubleColSubtractDoubleColumn(col 9:double, col 72:double)(children: DoubleColDivideLongColumn(col 71:double, col 11:bigint)(children: DoubleColMultiplyDoubleColumn(col 10:double, col 10:double) -> 71:double) -> 72:double) -> 73:double) -> 74:double) -> 75:double) -> 76:double, FuncPowerDoubleToDouble(col 83:double)(children: DoubleColDivideLongColumn(col 79:double, col 82:bigint)(children: DoubleColSubtractDoubleColumn(col 13:double, col 78:double)(children: DoubleColDivideLongColumn(col 77:double, col 15:bigint)(children: DoubleColMultiplyDoubleColumn(col 14:double, col 14:double) -> 77:double) -> 78:double) -> 79:double, IfExprNullCondExpr(col 80:boolean, null, col 81:bigint)(children: LongColEqualLongScalar(col 15:bigint, val 1) -> 80:boolean, LongColSubtractLongScalar(col 15:bigint, val 1) -> 81:bigint) -> 82:bigint) -> 83:double) -> 84:double, DecimalScalarMultiplyDecimalColumn(val -1.389, col 85:decimal(19,0))(children: CastLongToDecimal(col 8:bigint) -> 85:decimal(19,0)) -> 86:decimal(24,3), DecimalColSubtractDecimalColumn(col 87:decimal(19,0), col 89:decimal(24,3))(children: CastLongToDecimal(col 12:bigint) -> 87:decimal(19,0), DecimalScalarMultiplyDecimalColumn(val -1.389, col 88:decimal(19,0))(children: CastLongToDecimal(col 8:bigint) -> 88:decimal(19,0)) -> 89:decimal(24,3)) -> 90:decimal(25,3), FuncPowerDoubleToDouble(col 94:double)(children: DoubleColDivideLongColumn(col 93:double, col 18:bigint)(children: DoubleColSubtractDoubleColumn(col 16:double, col 92:double)(children: DoubleColDivideLongColumn(col 91:double, col 18:bigint)(children: DoubleColMultiplyDoubleColumn(col 17:double, col 17:double) -> 91:double) -> 92:double) -> 93:double) -> 94:double) -> 95:double, FuncNegateDecimalToDecimal(col 99:decimal(25,3))(children: DecimalColSubtractDecimalColumn(col 96:decimal(19,0), col 98:decimal(24,3))(children: CastLongToDecimal(col 12:bigint) -> 96:decimal(19,0), DecimalScalarMultiplyDecimalColumn(val -1.389, col 97:decimal(19,0))(children: CastLongToDecimal(col 8:bigint) -> 97:decimal(19,0)) -> 98:decimal(24,3)) -> 99:decimal(25,3)) -> 100:decimal(25,3), DoubleColDivideLongColumn(col 101:double, col 5:bigint)(children: CastLongToDouble(col 12:bigint) -> 101:double) -> 102:double, DoubleColUnaryMinus(col 104:double)(children: DoubleColDivideLongColumn(col 103:double, col 5:bigint)(children: CastLongToDouble(col 12:bigint) -> 103:double) -> 104:double) -> 105:double, DoubleColMultiplyDoubleColumn(col 107:double, col 108:double)(children: DoubleColDivideLongColumn(col 106:double, col 5:bigint)(children: CastLongToDouble(col 12:bigint) -> 106:double) -> 107:double, CastLongToDouble(col 12:bigint) -> 108:double) -> 109:double
+                      projectedOutputColumnNums: [0, 1, 20, 21, 2, 23, 30, 38, 40, 41, 52, 8, 56, 59, 64, 77, 12, 85, 87, 91, 96, 101, 103, 106, 110]
+                      selectExpressions: DoubleColUnaryMinus(col 1:float) -> 20:float, DoubleScalarDivideDoubleColumn(val -26.28, col 1:double)(children: col 1:float) -> 21:double, DecimalColSubtractDecimalScalar(col 22:decimal(19,0), val 10.175)(children: CastLongToDecimal(col 2:bigint) -> 22:decimal(19,0)) -> 23:decimal(23,3), DoubleColDivideLongColumn(col 26:double, col 29:bigint)(children: DoubleColSubtractDoubleColumn(col 3:double, col 25:double)(children: DoubleColDivideLongColumn(col 24:double, col 5:bigint)(children: DoubleColMultiplyDoubleColumn(col 4:double, col 4:double) -> 24:double) -> 25:double) -> 26:double, IfExprNullCondExpr(col 27:boolean, null, col 28:bigint)(children: LongColEqualLongScalar(col 5:bigint, val 1) -> 27:boolean, LongColSubtractLongScalar(col 5:bigint, val 1) -> 28:bigint) -> 29:bigint) -> 30:double, DoubleColModuloDoubleColumn(col 37:double, col 1:double)(children: DoubleColDivideLongColumn(col 33:double, col 36:bigint)(children: DoubleColSubtractDoubleColumn(col 3:double, col 32:double)(children: DoubleColDivideLongColumn(col 31:double, col 5:bigint)(children: DoubleColMultiplyDoubleColumn(col 4:double, col 4:double) -> 31:double) -> 32:double) -> 33:double, IfExprNullCondExpr(col 34:boolean, null, col 35:bigint)(children: LongColEqualLongScalar(col 5:bigint, val 1) -> 34:boolean, LongColSubtractLongScalar(col 5:bigint, val 1) -> 35:bigint) -> 36:bigint) -> 37:double, col 1:float) -> 38:double, DoubleScalarAddDoubleColumn(val 10.175000190734863, col 39:float)(children: DoubleColUnaryMinus(col 1:float) -> 39:float) -> 40:float, DoubleColDivideLongColumn(col 6:double, col 7:bigint) -> 41:double, DoubleColAddDoubleColumn(col 44:double, col 51:double)(children: CastDecimalToDouble(col 43:decimal(23,3))(children: DecimalColSubtractDecimalScalar(col 42:decimal(19,0), val 10.175)(children: CastLongToDecimal(col 2:bigint) -> 42:decimal(19,0)) -> 43:decimal(23,3)) -> 44:double, DoubleColDivideLongColumn(col 47:double, col 50:bigint)(children: DoubleColSubtractDoubleColumn(col 3:double, col 46:double)(children: DoubleColDivideLongColumn(col 45:double, col 5:bigint)(children: DoubleColMultiplyDoubleColumn(col 4:double, col 4:double) -> 45:double) -> 46:double) -> 47:double, IfExprNullCondExpr(col 48:boolean, null, col 49:bigint)(children: LongColEqualLongScalar(col 5:bigint, val 1) -> 48:boolean, LongColSubtractLongScalar(col 5:bigint, val 1) -> 49:bigint) -> 50:bigint) -> 51:double) -> 52:double, DoubleColDivideLongColumn(col 55:double, col 11:bigint)(children: DoubleColSubtractDoubleColumn(col 9:double, col 54:double)(children: DoubleColDivideLongColumn(col 53:double, col 11:bigint)(children: DoubleColMultiplyDoubleColumn(col 10:double, col 10:double) -> 53:double) -> 54:double) -> 55:double) -> 56:double, DoubleColUnaryMinus(col 58:float)(children: DoubleScalarAddDoubleColumn(val 10.175000190734863, col 57:float)(children: DoubleColUnaryMinus(col 1:float) -> 57:float) -> 58:float) -> 59:float, DoubleScalarDivideDoubleColumn(val 79.553, col 63:double)(children: DoubleColDivideLongColumn(col 62:double, col 11:bigint)(children: DoubleColSubtractDoubleColumn(col 9:double, col 61:double)(children: DoubleColDivideLongColumn(col 60:double, col 11:bigint)(children: DoubleColMultiplyDoubleColumn(col 10:double, col 10:double) -> 60:double) -> 61:double) -> 62:double) -> 63:double) -> 64:double, DoubleColModuloDoubleColumn(col 71:double, col 76:double)(children: DoubleColDivideLongColumn(col 67:double, col 70:bigint)(children: DoubleColSubtractDoubleColumn(col 3:double, col 66:double)(children: DoubleColDivideLongColumn(col 65:double, col 5:bigint)(children: DoubleColMultiplyDoubleColumn(col 4:double, col 4:double) -> 65:double) -> 66:double) -> 67:double, IfExprNullCondExpr(col 68:boolean, null, col 69:bigint)(children: LongColEqualLongScalar(col 5:bigint, val 1) -> 68:boolean, LongColSubtractLongScalar(col 5:bigint, val 1) -> 69:bigint) -> 70:bigint) -> 71:double, DoubleScalarDivideDoubleColumn(val 79.553, col 75:double)(children: DoubleColDivideLongColumn(col 74:double, col 11:bigint)(children: DoubleColSubtractDoubleColumn(col 9:double, col 73:double)(children: DoubleColDivideLongColumn(col 72:double, col 11:bigint)(children: DoubleColMultiplyDoubleColumn(col 10:double, col 10:double) -> 72:double) -> 73:double) -> 74:double) -> 75:double) -> 76:double) -> 77:double, FuncPowerDoubleToDouble(col 84:double)(children: DoubleColDivideLongColumn(col 80:double, col 83:bigint)(children: DoubleColSubtractDoubleColumn(col 13:double, col 79:double)(children: DoubleColDivideLongColumn(col 78:double, col 15:bigint)(children: DoubleColMultiplyDoubleColumn(col 14:double, col 14:double) -> 78:double) -> 79:double) -> 80:double, IfExprNullCondExpr(col 81:boolean, null, col 82:bigint)(children: LongColEqualLongScalar(col 15:bigint, val 1) -> 81:boolean, LongColSubtractLongScalar(col 15:bigint, val 1) -> 82:bigint) -> 83:bigint) -> 84:double) -> 85:double, DecimalScalarMultiplyDecimalColumn(val -1.389, col 86:decimal(19,0))(children: CastLongToDecimal(col 8:bigint) -> 86:decimal(19,0)) -> 87:decimal(24,3), DecimalColSubtractDecimalColumn(col 88:decimal(19,0), col 90:decimal(24,3))(children: CastLongToDecimal(col 12:bigint) -> 88:decimal(19,0), DecimalScalarMultiplyDecimalColumn(val -1.389, col 89:decimal(19,0))(children: CastLongToDecimal(col 8:bigint) -> 89:decimal(19,0)) -> 90:decimal(24,3)) -> 91:decimal(25,3), FuncPowerDoubleToDouble(col 95:double)(children: DoubleColDivideLongColumn(col 94:double, col 18:bigint)(children: DoubleColSubtractDoubleColumn(col 16:double, col 93:double)(children: DoubleColDivideLongColumn(col 92:double, col 18:bigint)(children: DoubleColMultiplyDoubleColumn(col 17:double, col 17:double) -> 92:double) -> 93:double) -> 94:double) -> 95:double) -> 96:double, FuncNegateDecimalToDecimal(col 100:decimal(25,3))(children: DecimalColSubtractDecimalColumn(col 97:decimal(19,0), col 99:decimal(24,3))(children: CastLongToDecimal(col 12:bigint) -> 97:decimal(19,0), DecimalScalarMultiplyDecimalColumn(val -1.389, col 98:decimal(19,0))(children: CastLongToDecimal(col 8:bigint) -> 98:decimal(19,0)) -> 99:decimal(24,3)) -> 100:decimal(25,3)) -> 101:decimal(25,3), DoubleColDivideLongColumn(col 102:double, col 19:bigint)(children: CastLongToDouble(col 12:bigint) -> 102:double) -> 103:double, DoubleColUnaryMinus(col 105:double)(children: DoubleColDivideLongColumn(col 104:double, col 19:bigint)(children: CastLongToDouble(col 12:bigint) -> 104:double) -> 105:double) -> 106:double, DoubleColMultiplyDoubleColumn(col 108:double, col 109:double)(children: DoubleColDivideLongColumn(col 107:double, col 19:bigint)(children: CastLongToDouble(col 12:bigint) -> 107:double) -> 108:double, CastLongToDouble(col 12:bigint) -> 109:double) -> 110:double
                   Statistics: Num rows: 3 Data size: 1788 Basic stats: COMPLETE Column stats: COMPLETE
                   Reduce Output Operator
                     key expressions: _col0 (type: boolean)
diff --git a/ql/src/test/results/clientpositive/llap/vectorized_distinct_gby.q.out b/ql/src/test/results/clientpositive/llap/vectorized_distinct_gby.q.out
index 8488a65b7e..e6d744731f 100644
--- a/ql/src/test/results/clientpositive/llap/vectorized_distinct_gby.q.out
+++ b/ql/src/test/results/clientpositive/llap/vectorized_distinct_gby.q.out
@@ -286,18 +286,18 @@ STAGE PLANS:
                       selectExpressions: CastLongToDouble(col 0:int) -> 1:double, DoubleColMultiplyDoubleColumn(col 2:double, col 3:double)(children: CastLongToDouble(col 0:int) -> 2:double, CastLongToDouble(col 0:int) -> 3:double) -> 4:double
                   Statistics: Num rows: 6105 Data size: 18232 Basic stats: COMPLETE Column stats: COMPLETE
                   Group By Operator
-                    aggregations: sum(_col0), count(_col0), sum(_col2), sum(_col1)
+                    aggregations: sum(_col0), count(_col0), sum(_col2), sum(_col1), count(_col1)
                     Group By Vectorization:
-                        aggregators: VectorUDAFSumLong(col 0:int) -> bigint, VectorUDAFCount(col 0:int) -> bigint, VectorUDAFSumDouble(col 4:double) -> double, VectorUDAFSumDouble(col 1:double) -> double
+                        aggregators: VectorUDAFSumLong(col 0:int) -> bigint, VectorUDAFCount(col 0:int) -> bigint, VectorUDAFSumDouble(col 4:double) -> double, VectorUDAFSumDouble(col 1:double) -> double, VectorUDAFCount(col 1:double) -> bigint
                         className: VectorGroupByOperator
                         groupByMode: HASH
                         native: false
                         vectorProcessingMode: HASH
-                        projectedOutputColumnNums: [0, 1, 2, 3]
+                        projectedOutputColumnNums: [0, 1, 2, 3, 4]
                     minReductionHashAggr: 0.99
                     mode: hash
-                    outputColumnNames: _col0, _col1, _col2, _col3
-                    Statistics: Num rows: 1 Data size: 32 Basic stats: COMPLETE Column stats: COMPLETE
+                    outputColumnNames: _col0, _col1, _col2, _col3, _col4
+                    Statistics: Num rows: 1 Data size: 40 Basic stats: COMPLETE Column stats: COMPLETE
                     Reduce Output Operator
                       null sort order: 
                       sort order: 
@@ -305,9 +305,9 @@ STAGE PLANS:
                           className: VectorReduceSinkEmptyKeyOperator
                           native: true
                           nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
-                          valueColumns: 0:bigint, 1:bigint, 2:double, 3:double
-                      Statistics: Num rows: 1 Data size: 32 Basic stats: COMPLETE Column stats: COMPLETE
-                      value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: double), _col3 (type: double)
+                          valueColumns: 0:bigint, 1:bigint, 2:double, 3:double, 4:bigint
+                      Statistics: Num rows: 1 Data size: 40 Basic stats: COMPLETE Column stats: COMPLETE
+                      value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: double), _col3 (type: double), _col4 (type: bigint)
         Reducer 3 
             Execution mode: vectorized, llap
             Reduce Vectorization:
@@ -319,31 +319,31 @@ STAGE PLANS:
                 usesVectorUDFAdaptor: false
                 vectorized: true
                 rowBatchContext:
-                    dataColumnCount: 4
-                    dataColumns: VALUE._col0:bigint, VALUE._col1:bigint, VALUE._col2:double, VALUE._col3:double
+                    dataColumnCount: 5
+                    dataColumns: VALUE._col0:bigint, VALUE._col1:bigint, VALUE._col2:double, VALUE._col3:double, VALUE._col4:bigint
                     partitionColumnCount: 0
                     scratchColumnTypeNames: []
             Reduce Operator Tree:
               Group By Operator
-                aggregations: sum(VALUE._col0), count(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3)
+                aggregations: sum(VALUE._col0), count(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3), count(VALUE._col4)
                 Group By Vectorization:
-                    aggregators: VectorUDAFSumLong(col 0:bigint) -> bigint, VectorUDAFCountMerge(col 1:bigint) -> bigint, VectorUDAFSumDouble(col 2:double) -> double, VectorUDAFSumDouble(col 3:double) -> double
+                    aggregators: VectorUDAFSumLong(col 0:bigint) -> bigint, VectorUDAFCountMerge(col 1:bigint) -> bigint, VectorUDAFSumDouble(col 2:double) -> double, VectorUDAFSumDouble(col 3:double) -> double, VectorUDAFCountMerge(col 4:bigint) -> bigint
                     className: VectorGroupByOperator
                     groupByMode: MERGEPARTIAL
                     native: false
                     vectorProcessingMode: GLOBAL
-                    projectedOutputColumnNums: [0, 1, 2, 3]
+                    projectedOutputColumnNums: [0, 1, 2, 3, 4]
                 mode: mergepartial
-                outputColumnNames: _col0, _col1, _col2, _col3
-                Statistics: Num rows: 1 Data size: 32 Basic stats: COMPLETE Column stats: COMPLETE
+                outputColumnNames: _col0, _col1, _col2, _col3, _col4
+                Statistics: Num rows: 1 Data size: 40 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
-                  expressions: _col0 (type: bigint), _col1 (type: bigint), (UDFToDouble(_col0) / _col1) (type: double), power(((_col2 - ((_col3 * _col3) / _col1)) / _col1), 0.5) (type: double)
+                  expressions: _col0 (type: bigint), _col1 (type: bigint), (UDFToDouble(_col0) / _col1) (type: double), power(((_col2 - ((_col3 * _col3) / _col4)) / _col4), 0.5) (type: double)
                   outputColumnNames: _col0, _col1, _col2, _col3
                   Select Vectorization:
                       className: VectorSelectOperator
                       native: true
-                      projectedOutputColumnNums: [0, 1, 5, 10]
-                      selectExpressions: DoubleColDivideLongColumn(col 4:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 4:double) -> 5:double, FuncPowerDoubleToDouble(col 9:double)(children: DoubleColDivideLongColumn(col 8:double, col 1:bigint)(children: DoubleColSubtractDoubleColumn(col 2:double, col 7:double)(children: DoubleColDivideLongColumn(col 6:double, col 1:bigint)(children: DoubleColMultiplyDoubleColumn(col 3:double, col 3:double) -> 6:double) -> 7:double) -> 8:double) -> 9:double) -> 10:double
+                      projectedOutputColumnNums: [0, 1, 6, 11]
+                      selectExpressions: DoubleColDivideLongColumn(col 5:double, col 1:bigint)(children: CastLongToDouble(col 0:bigint) -> 5:double) -> 6:double, FuncPowerDoubleToDouble(col 10:double)(children: DoubleColDivideLongColumn(col 9:double, col 4:bigint)(children: DoubleColSubtractDoubleColumn(col 2:double, col 8:double)(children: DoubleColDivideLongColumn(col 7:double, col 4:bigint)(children: DoubleColMultiplyDoubleColumn(col 3:double, col 3:double) -> 7:double) -> 8:double) -> 9:double) -> 10:double) -> 11:double
                   Statistics: Num rows: 1 Data size: 32 Basic stats: COMPLETE Column stats: COMPLETE
                   File Output Operator
                     compressed: false
diff --git a/ql/src/test/results/clientpositive/llap/vectorized_timestamp.q.out b/ql/src/test/results/clientpositive/llap/vectorized_timestamp.q.out
index 65f2621f65..3e1d638d59 100644
--- a/ql/src/test/results/clientpositive/llap/vectorized_timestamp.q.out
+++ b/ql/src/test/results/clientpositive/llap/vectorized_timestamp.q.out
@@ -522,18 +522,18 @@ STAGE PLANS:
                       native: true
                       vectorizationSchemaColumns: [0:ts:timestamp, 1:ROW__ID:struct<writeid:bigint,bucketid:int,rowid:bigint>, 2:ROW__IS__DELETED:boolean]
                   Select Operator
-                    expressions: ts (type: timestamp), UDFToDouble(ts) (type: double), (UDFToDouble(ts) * UDFToDouble(ts)) (type: double)
-                    outputColumnNames: _col0, _col1, _col2
+                    expressions: UDFToDouble(ts) (type: double), (UDFToDouble(ts) * UDFToDouble(ts)) (type: double)
+                    outputColumnNames: _col0, _col1
                     Select Vectorization:
                         className: VectorSelectOperator
                         native: true
-                        projectedOutputColumnNums: [0, 3, 6]
+                        projectedOutputColumnNums: [3, 6]
                         selectExpressions: CastTimestampToDouble(col 0:timestamp) -> 3:double, DoubleColMultiplyDoubleColumn(col 4:double, col 5:double)(children: CastTimestampToDouble(col 0:timestamp) -> 4:double, CastTimestampToDouble(col 0:timestamp) -> 5:double) -> 6:double
                     Statistics: Num rows: 2 Data size: 80 Basic stats: COMPLETE Column stats: COMPLETE
                     Group By Operator
-                      aggregations: sum(_col2), sum(_col1), count(_col0)
+                      aggregations: sum(_col1), sum(_col0), count(_col0)
                       Group By Vectorization:
-                          aggregators: VectorUDAFSumDouble(col 6:double) -> double, VectorUDAFSumDouble(col 3:double) -> double, VectorUDAFCount(col 0:timestamp) -> bigint
+                          aggregators: VectorUDAFSumDouble(col 6:double) -> double, VectorUDAFSumDouble(col 3:double) -> double, VectorUDAFCount(col 3:double) -> bigint
                           className: VectorGroupByOperator
                           groupByMode: HASH
                           native: false
diff --git a/ql/src/test/results/clientpositive/llap/vectorized_timestamp_funcs.q.out b/ql/src/test/results/clientpositive/llap/vectorized_timestamp_funcs.q.out
index 49bbe44731..ed69aa6e60 100644
--- a/ql/src/test/results/clientpositive/llap/vectorized_timestamp_funcs.q.out
+++ b/ql/src/test/results/clientpositive/llap/vectorized_timestamp_funcs.q.out
@@ -1310,18 +1310,18 @@ STAGE PLANS:
                         selectExpressions: CastTimestampToDouble(col 1:timestamp) -> 6:double, DoubleColMultiplyDoubleColumn(col 7:double, col 8:double)(children: CastTimestampToDouble(col 1:timestamp) -> 7:double, CastTimestampToDouble(col 1:timestamp) -> 8:double) -> 9:double
                     Statistics: Num rows: 52 Data size: 1960 Basic stats: COMPLETE Column stats: COMPLETE
                     Group By Operator
-                      aggregations: sum(_col0), count(_col0), sum(_col2), sum(_col1)
+                      aggregations: sum(_col0), count(_col0), sum(_col2), sum(_col1), count(_col1)
                       Group By Vectorization:
-                          aggregators: VectorUDAFSumTimestamp(col 1:timestamp) -> double, VectorUDAFCount(col 1:timestamp) -> bigint, VectorUDAFSumDouble(col 9:double) -> double, VectorUDAFSumDouble(col 6:double) -> double
+                          aggregators: VectorUDAFSumTimestamp(col 1:timestamp) -> double, VectorUDAFCount(col 1:timestamp) -> bigint, VectorUDAFSumDouble(col 9:double) -> double, VectorUDAFSumDouble(col 6:double) -> double, VectorUDAFCount(col 6:double) -> bigint
                           className: VectorGroupByOperator
                           groupByMode: HASH
                           native: false
                           vectorProcessingMode: HASH
-                          projectedOutputColumnNums: [0, 1, 2, 3]
+                          projectedOutputColumnNums: [0, 1, 2, 3, 4]
                       minReductionHashAggr: 0.9807692
                       mode: hash
-                      outputColumnNames: _col0, _col1, _col2, _col3
-                      Statistics: Num rows: 1 Data size: 32 Basic stats: COMPLETE Column stats: COMPLETE
+                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
+                      Statistics: Num rows: 1 Data size: 40 Basic stats: COMPLETE Column stats: COMPLETE
                       Reduce Output Operator
                         null sort order: 
                         sort order: 
@@ -1329,8 +1329,8 @@ STAGE PLANS:
                             className: VectorReduceSinkEmptyKeyOperator
                             native: true
                             nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
-                        Statistics: Num rows: 1 Data size: 32 Basic stats: COMPLETE Column stats: COMPLETE
-                        value expressions: _col0 (type: double), _col1 (type: bigint), _col2 (type: double), _col3 (type: double)
+                        Statistics: Num rows: 1 Data size: 40 Basic stats: COMPLETE Column stats: COMPLETE
+                        value expressions: _col0 (type: double), _col1 (type: bigint), _col2 (type: double), _col3 (type: double), _col4 (type: bigint)
             Execution mode: vectorized, llap
             LLAP IO: all inputs
             Map Vectorization:
@@ -1352,25 +1352,25 @@ STAGE PLANS:
                 vectorized: true
             Reduce Operator Tree:
               Group By Operator
-                aggregations: sum(VALUE._col0), count(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3)
+                aggregations: sum(VALUE._col0), count(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3), count(VALUE._col4)
                 Group By Vectorization:
-                    aggregators: VectorUDAFSumDouble(col 0:double) -> double, VectorUDAFCountMerge(col 1:bigint) -> bigint, VectorUDAFSumDouble(col 2:double) -> double, VectorUDAFSumDouble(col 3:double) -> double
+                    aggregators: VectorUDAFSumDouble(col 0:double) -> double, VectorUDAFCountMerge(col 1:bigint) -> bigint, VectorUDAFSumDouble(col 2:double) -> double, VectorUDAFSumDouble(col 3:double) -> double, VectorUDAFCountMerge(col 4:bigint) -> bigint
                     className: VectorGroupByOperator
                     groupByMode: MERGEPARTIAL
                     native: false
                     vectorProcessingMode: GLOBAL
-                    projectedOutputColumnNums: [0, 1, 2, 3]
+                    projectedOutputColumnNums: [0, 1, 2, 3, 4]
                 mode: mergepartial
-                outputColumnNames: _col0, _col1, _col2, _col3
-                Statistics: Num rows: 1 Data size: 32 Basic stats: COMPLETE Column stats: COMPLETE
+                outputColumnNames: _col0, _col1, _col2, _col3, _col4
+                Statistics: Num rows: 1 Data size: 40 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
-                  expressions: round((_col0 / _col1), 0) (type: double), ((_col2 - ((_col3 * _col3) / _col1)) / _col1) BETWEEN 8.97077295279421E19D AND 8.97077295279422E19D (type: boolean), ((_col2 - ((_col3 * _col3) / _col1)) / _col1) BETWEEN 8.97077295279421E19D AND 8.97077295279422E19D (type: boolean), ((_col2 - ((_col3 * _col3) / _col1)) / if((_col1 = 1L), null, (_col1 - 1))) BETWEEN 9.20684592523616E19D AND 9.20684592523617E19D (type: boolean), round(power(((_col2 - ((_col3 * _col3) / _col1)) / _col1), 0.5), 3) (type: double), round(power(((_col2 - ((_col3 * _col3) / _col1)) / _col1), 0.5), 3) (type: double), round(power(((_col2 - ((_col3 * _col3) / _col1)) / _col1), 0.5), 3) (type: double), round(power(((_col2 - ((_col3 * _col3) / _col1)) / if((_col1 = 1L), null, (_col1 - 1))), 0.5), 3) (type: double)
+                  expressions: round((_col0 / _col1), 0) (type: double), ((_col2 - ((_col3 * _col3) / _col4)) / _col4) BETWEEN 8.97077295279421E19D AND 8.97077295279422E19D (type: boolean), ((_col2 - ((_col3 * _col3) / _col4)) / _col4) BETWEEN 8.97077295279421E19D AND 8.97077295279422E19D (type: boolean), ((_col2 - ((_col3 * _col3) / _col4)) / if((_col4 = 1L), null, (_col4 - 1))) BETWEEN 9.20684592523616E19D AND 9.20684592523617E19D (type: boolean), round(power(((_col2 - ((_col3 * _col3) / _col4)) / _col4), 0.5), 3) (type: double), round(power(((_col2 - ((_col3 * _col3) / _col4)) / _col4), 0.5), 3) (type: double), round(power(((_col2 - ((_col3 * _col3) / _col4)) / _col4), 0.5), 3) (type: double), round(power(((_col2 - ((_col3 * _col3) / _col4)) / if((_col4 = 1L), null, (_col4 - 1))), 0.5), 3) (type: double)
                   outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                   Select Vectorization:
                       className: VectorSelectOperator
                       native: true
-                      projectedOutputColumnNums: [5, 10, 15, 23, 29, 35, 41, 50]
-                      selectExpressions: RoundWithNumDigitsDoubleToDouble(col 4, decimalPlaces 0)(children: DoubleColDivideLongColumn(col 0:double, col 1:bigint) -> 4:double) -> 5:double, DoubleColumnBetween(col 9:double, left 8.97077295279421E19, right 8.97077295279422E19)(children: DoubleColDivideLongColumn(col 8:double, col 1:bigint)(children: DoubleColSubtractDoubleColumn(col 2:double, col 7:double)(children: DoubleColDivideLongColumn(col 6:double, col 1:bigint)(children: DoubleColMultiplyDoubleColumn(col 3:double, col 3:double) -> 6:double) -> 7:double) -> 8:double) -> 9:double) -> 10:boolean, DoubleColumnBetween(col 14:double, left 8.97077295279421E19, right 8.97077295279422E19)(children: DoubleColDivideLongColumn(col 13:double, col 1:bigint)(children: DoubleColSubtractDoubleColumn(col 2:double, col 12:double)(children: DoubleColDivideLongColumn(col 11:double, col 1:bigint)(children: DoubleColMultiplyDoubleColumn(col 3:double, col 3:double) -> 11:double) -> 12:double) -> 13:double) -> 14:double) -> 15:boolean, DoubleColumnBetween(col 22:double, left 9.20684592523616E19, right 9.20684592523617E19)(children: DoubleColDivideLongColumn(col 18:double, col 21:bigint)(children: DoubleColSubtractDoubleColumn(col 2:double, col 17:double)(children: DoubleColDivideLongColumn(col 16:double, col 1:bigint)(children: DoubleColMultiplyDoubleColumn(col 3:double, col 3:double) -> 16:double) -> 17:double) -> 18:double, IfExprNullCondExpr(col 19:boolean, null, col 20:bigint)(children: LongColEqualLongScalar(col 1:bigint, val 1) -> 19:boolean, LongColSubtractLongScalar(col 1:bigint, val 1) -> 20:bigint) -> 21:bigint) -> 22:double) -> 23:boolean, RoundWithNumDigitsDoubleToDouble(col 28, decimalPlaces 3)(children: FuncPowerDoubleToDouble(col 27:double)(children: DoubleColDivideLongColumn(col 26:double, col 1:bigint)(children: DoubleColSubtractDoubleColumn(col 2:double, col 25:double)(children: DoubleColDivideLongColumn(col 24:double, col 1:bigint)(children: DoubleColMultiplyDoubleColumn(col 3:double, col 3:double) -> 24:double) -> 25:double) -> 26:double) -> 27:double) -> 28:double) -> 29:double, RoundWithNumDigitsDoubleToDouble(col 34, decimalPlaces 3)(children: FuncPowerDoubleToDouble(col 33:double)(children: DoubleColDivideLongColumn(col 32:double, col 1:bigint)(children: DoubleColSubtractDoubleColumn(col 2:double, col 31:double)(children: DoubleColDivideLongColumn(col 30:double, col 1:bigint)(children: DoubleColMultiplyDoubleColumn(col 3:double, col 3:double) -> 30:double) -> 31:double) -> 32:double) -> 33:double) -> 34:double) -> 35:double, RoundWithNumDigitsDoubleToDouble(col 40, decimalPlaces 3)(children: FuncPowerDoubleToDouble(col 39:double)(children: DoubleColDivideLongColumn(col 38:double, col 1:bigint)(children: DoubleColSubtractDoubleColumn(col 2:double, col 37:double)(children: DoubleColDivideLongColumn(col 36:double, col 1:bigint)(children: DoubleColMultiplyDoubleColumn(col 3:double, col 3:double) -> 36:double) -> 37:double) -> 38:double) -> 39:double) -> 40:double) -> 41:double, RoundWithNumDigitsDoubleToDouble(col 49, decimalPlaces 3)(children: FuncPowerDoubleToDouble(col 48:double)(children: DoubleColDivideLongColumn(col 44:double, col 47:bigint)(children: DoubleColSubtractDoubleColumn(col 2:double, col 43:double)(children: DoubleColDivideLongColumn(col 42:double, col 1:bigint)(children: DoubleColMultiplyDoubleColumn(col 3:double, col 3:double) -> 42:double) -> 43:double) -> 44:double, IfExprNullCondExpr(col 45:boolean, null, col 46:bigint)(children: LongColEqualLongScalar(col 1:bigint, val 1) -> 45:boolean, LongColSubtractLongScalar(col 1:bigint, val 1) -> 46:bigint) -> 47:bigint) -> 48:double) -> 49:double) -> 50:double
+                      projectedOutputColumnNums: [6, 11, 16, 24, 30, 36, 42, 51]
+                      selectExpressions: RoundWithNumDigitsDoubleToDouble(col 5, decimalPlaces 0)(children: DoubleColDivideLongColumn(col 0:double, col 1:bigint) -> 5:double) -> 6:double, DoubleColumnBetween(col 10:double, left 8.97077295279421E19, right 8.97077295279422E19)(children: DoubleColDivideLongColumn(col 9:double, col 4:bigint)(children: DoubleColSubtractDoubleColumn(col 2:double, col 8:double)(children: DoubleColDivideLongColumn(col 7:double, col 4:bigint)(children: DoubleColMultiplyDoubleColumn(col 3:double, col 3:double) -> 7:double) -> 8:double) -> 9:double) -> 10:double) -> 11:boolean, DoubleColumnBetween(col 15:double, left 8.97077295279421E19, right 8.97077295279422E19)(children: DoubleColDivideLongColumn(col 14:double, col 4:bigint)(children: DoubleColSubtractDoubleColumn(col 2:double, col 13:double)(children: DoubleColDivideLongColumn(col 12:double, col 4:bigint)(children: DoubleColMultiplyDoubleColumn(col 3:double, col 3:double) -> 12:double) -> 13:double) -> 14:double) -> 15:double) -> 16:boolean, DoubleColumnBetween(col 23:double, left 9.20684592523616E19, right 9.20684592523617E19)(children: DoubleColDivideLongColumn(col 19:double, col 22:bigint)(children: DoubleColSubtractDoubleColumn(col 2:double, col 18:double)(children: DoubleColDivideLongColumn(col 17:double, col 4:bigint)(children: DoubleColMultiplyDoubleColumn(col 3:double, col 3:double) -> 17:double) -> 18:double) -> 19:double, IfExprNullCondExpr(col 20:boolean, null, col 21:bigint)(children: LongColEqualLongScalar(col 4:bigint, val 1) -> 20:boolean, LongColSubtractLongScalar(col 4:bigint, val 1) -> 21:bigint) -> 22:bigint) -> 23:double) -> 24:boolean, RoundWithNumDigitsDoubleToDouble(col 29, decimalPlaces 3)(children: FuncPowerDoubleToDouble(col 28:double)(children: DoubleColDivideLongColumn(col 27:double, col 4:bigint)(children: DoubleColSubtractDoubleColumn(col 2:double, col 26:double)(children: DoubleColDivideLongColumn(col 25:double, col 4:bigint)(children: DoubleColMultiplyDoubleColumn(col 3:double, col 3:double) -> 25:double) -> 26:double) -> 27:double) -> 28:double) -> 29:double) -> 30:double, RoundWithNumDigitsDoubleToDouble(col 35, decimalPlaces 3)(children: FuncPowerDoubleToDouble(col 34:double)(children: DoubleColDivideLongColumn(col 33:double, col 4:bigint)(children: DoubleColSubtractDoubleColumn(col 2:double, col 32:double)(children: DoubleColDivideLongColumn(col 31:double, col 4:bigint)(children: DoubleColMultiplyDoubleColumn(col 3:double, col 3:double) -> 31:double) -> 32:double) -> 33:double) -> 34:double) -> 35:double) -> 36:double, RoundWithNumDigitsDoubleToDouble(col 41, decimalPlaces 3)(children: FuncPowerDoubleToDouble(col 40:double)(children: DoubleColDivideLongColumn(col 39:double, col 4:bigint)(children: DoubleColSubtractDoubleColumn(col 2:double, col 38:double)(children: DoubleColDivideLongColumn(col 37:double, col 4:bigint)(children: DoubleColMultiplyDoubleColumn(col 3:double, col 3:double) -> 37:double) -> 38:double) -> 39:double) -> 40:double) -> 41:double) -> 42:double, RoundWithNumDigitsDoubleToDouble(col 50, decimalPlaces 3)(children: FuncPowerDoubleToDouble(col 49:double)(children: DoubleColDivideLongColumn(col 45:double, col 48:bigint)(children: DoubleColSubtractDoubleColumn(col 2:double, col 44:double)(children: DoubleColDivideLongColumn(col 43:double, col 4:bigint)(children: DoubleColMultiplyDoubleColumn(col 3:double, col 3:double) -> 43:double) -> 44:double) -> 45:double, IfExprNullCondExpr(col 46:boolean, null, col 47:bigint)(children: LongColEqualLongScalar(col 4:bigint, val 1) -> 46:boolean, LongColSubtractLongScalar(col 4:bigint, val 1) -> 47:bigint) -> 48:bigint) -> 49:double) -> 50:double) -> 51:double
                   Statistics: Num rows: 1 Data size: 52 Basic stats: COMPLETE Column stats: COMPLETE
                   File Output Operator
                     compressed: false
diff --git a/ql/src/test/results/clientpositive/perf/tpcds30tb/tez/cbo_query17.q.out b/ql/src/test/results/clientpositive/perf/tpcds30tb/tez/cbo_query17.q.out
index ae0eee0364..cbdc327d99 100644
--- a/ql/src/test/results/clientpositive/perf/tpcds30tb/tez/cbo_query17.q.out
+++ b/ql/src/test/results/clientpositive/perf/tpcds30tb/tez/cbo_query17.q.out
@@ -1,7 +1,7 @@
 CBO PLAN:
 HiveSortLimit(sort0=[$0], sort1=[$1], sort2=[$2], dir0=[ASC], dir1=[ASC], dir2=[ASC], fetch=[100])
-  HiveProject(i_item_id=[$0], i_item_desc=[$1], s_state=[$2], store_sales_quantitycount=[$3], store_sales_quantityave=[/(CAST($4):DOUBLE, $3)], store_sales_quantitystdev=[POWER(/(-($5, /(*($6, $6), $3)), CASE(=($3, 1), null:BIGINT, -($3, 1))), 0.5:DECIMAL(2, 1))], store_sales_quantitycov=[/(POWER(/(-($5, /(*($6, $6), $3)), CASE(=($3, 1), null:BIGINT, -($3, 1))), 0.5:DECIMAL(2, 1)), /(CAST($4):DOUBLE, $3))], as_store_returns_quantitycount=[$7], as_store_returns_quantityave=[/(CAST($8):DOUBLE, $7)], as_store_returns_quantitystdev=[POWER(/(-($9, /(*($10, $10), $7)), CASE(=($7, 1), null:BIGINT, -($7, 1))), 0.5:DECIMAL(2, 1))], store_returns_quantitycov=[/(POWER(/(-($9, /(*($10, $10), $7)), CASE(=($7, 1), null:BIGINT, -($7, 1))), 0.5:DECIMAL(2, 1)), /(CAST($8):DOUBLE, $7))], catalog_sales_quantitycount=[$11], catalog_sales_quantityave=[/(CAST($12):DOUBLE, $11)], catalog_sales_quantitystdev=[/(POWER(/(-($13, /(*($14, $14), $11)), CASE(=($11, 1), null:BIGINT, -($11, 1))), 0.5:DECIMAL(2, 1)), /(CAST($12):DOUBLE, $11))], catalog_sales_quantitycov=[/(POWER(/(-($13, /(*($14, $14), $11)), CASE(=($11, 1), null:BIGINT, -($11, 1))), 0.5:DECIMAL(2, 1)), /(CAST($12):DOUBLE, $11))])
-    HiveAggregate(group=[{0, 1, 2}], agg#0=[count($3)], agg#1=[sum($3)], agg#2=[sum($7)], agg#3=[sum($6)], agg#4=[count($4)], agg#5=[sum($4)], agg#6=[sum($9)], agg#7=[sum($8)], agg#8=[count($5)], agg#9=[sum($5)], agg#10=[sum($11)], agg#11=[sum($10)])
+  HiveProject(i_item_id=[$0], i_item_desc=[$1], s_state=[$2], store_sales_quantitycount=[$3], store_sales_quantityave=[/(CAST($4):DOUBLE, $3)], store_sales_quantitystdev=[POWER(/(-($5, /(*($6, $6), $7)), CASE(=($7, 1), null:BIGINT, -($7, 1))), 0.5:DECIMAL(2, 1))], store_sales_quantitycov=[/(POWER(/(-($5, /(*($6, $6), $7)), CASE(=($7, 1), null:BIGINT, -($7, 1))), 0.5:DECIMAL(2, 1)), /(CAST($4):DOUBLE, $3))], as_store_returns_quantitycount=[$8], as_store_returns_quantityave=[/(CAST($9):DOUBLE, $8)], as_store_returns_quantitystdev=[POWER(/(-($10, /(*($11, $11), $12)), CASE(=($12, 1), null:BIGINT, -($12, 1))), 0.5:DECIMAL(2, 1))], store_returns_quantitycov=[/(POWER(/(-($10, /(*($11, $11), $12)), CASE(=($12, 1), null:BIGINT, -($12, 1))), 0.5:DECIMAL(2, 1)), /(CAST($9):DOUBLE, $8))], catalog_sales_quantitycount=[$13], catalog_sales_quantityave=[/(CAST($14):DOUBLE, $13)], catalog_sales_quantitystdev=[/(POWER(/(-($15, /(*($16, $16), $17)), CASE(=($17, 1), null:BIGINT, -($17, 1))), 0.5:DECIMAL(2, 1)), /(CAST($14):DOUBLE, $13))], catalog_sales_quantitycov=[/(POWER(/(-($15, /(*($16, $16), $17)), CASE(=($17, 1), null:BIGINT, -($17, 1))), 0.5:DECIMAL(2, 1)), /(CAST($14):DOUBLE, $13))])
+    HiveAggregate(group=[{0, 1, 2}], agg#0=[count($3)], agg#1=[sum($3)], agg#2=[sum($7)], agg#3=[sum($6)], agg#4=[count($6)], agg#5=[count($4)], agg#6=[sum($4)], agg#7=[sum($9)], agg#8=[sum($8)], agg#9=[count($8)], agg#10=[count($5)], agg#11=[sum($5)], agg#12=[sum($11)], agg#13=[sum($10)], agg#14=[count($10)])
       HiveProject($f0=[$21], $f1=[$22], $f2=[$19], $f3=[$9], $f4=[$15], $f5=[$2], $f30=[CAST($9):DOUBLE], $f7=[*(CAST($9):DOUBLE, CAST($9):DOUBLE)], $f40=[CAST($15):DOUBLE], $f9=[*(CAST($15):DOUBLE, CAST($15):DOUBLE)], $f50=[CAST($2):DOUBLE], $f11=[*(CAST($2):DOUBLE, CAST($2):DOUBLE)])
         HiveJoin(condition=[=($20, $5)], joinType=[inner], algorithm=[none], cost=[not available])
           HiveJoin(condition=[=($18, $7)], joinType=[inner], algorithm=[none], cost=[not available])
diff --git a/ql/src/test/results/clientpositive/perf/tpcds30tb/tez/cbo_query39.q.out b/ql/src/test/results/clientpositive/perf/tpcds30tb/tez/cbo_query39.q.out
index cd79fff158..1ef18c2019 100644
--- a/ql/src/test/results/clientpositive/perf/tpcds30tb/tez/cbo_query39.q.out
+++ b/ql/src/test/results/clientpositive/perf/tpcds30tb/tez/cbo_query39.q.out
@@ -3,9 +3,9 @@ HiveProject(w_warehouse_sk=[$0], i_item_sk=[$1], d_moy=[CAST(4):INTEGER], mean=[
   HiveSortLimit(sort0=[$0], sort1=[$1], sort2=[$2], sort3=[$3], sort4=[$6], sort5=[$7], dir0=[ASC], dir1=[ASC], dir2=[ASC], dir3=[ASC], dir4=[ASC], dir5=[ASC])
     HiveProject(w_warehouse_sk=[$0], i_item_sk=[$1], mean=[$6], cov=[$7], w_warehouse_sk0=[$0], i_item_sk0=[$1], mean0=[$2], cov0=[$3])
       HiveJoin(condition=[AND(=($5, $1), =($4, $0))], joinType=[inner], algorithm=[none], cost=[not available])
-        HiveProject(w_warehouse_sk=[$0], i_item_sk=[$1], mean=[/(CAST($5):DOUBLE, $4)], cov=[CASE(=(/(CAST($5):DOUBLE, $4), 0), null:DOUBLE, /(POWER(/(-($2, /(*($3, $3), $4)), CASE(=($4, 1), null:BIGINT, -($4, 1))), 0.5:DECIMAL(2, 1)), /(CAST($5):DOUBLE, $4)))])
-          HiveFilter(condition=[CASE(=(/(CAST($5):DOUBLE, $4), 0), false, >(/(POWER(/(-($2, /(*($3, $3), $4)), CASE(=($4, 1), null:BIGINT, -($4, 1))), 0.5:DECIMAL(2, 1)), /(CAST($5):DOUBLE, $4)), 1))])
-            HiveAggregate(group=[{1, 2}], agg#0=[sum($5)], agg#1=[sum($4)], agg#2=[count($3)], agg#3=[sum($3)])
+        HiveProject(w_warehouse_sk=[$0], i_item_sk=[$1], mean=[/(CAST($5):DOUBLE, $6)], cov=[CASE(=(/(CAST($5):DOUBLE, $6), 0), null:DOUBLE, /(POWER(/(-($2, /(*($3, $3), $4)), CASE(=($4, 1), null:BIGINT, -($4, 1))), 0.5:DECIMAL(2, 1)), /(CAST($5):DOUBLE, $6)))])
+          HiveFilter(condition=[CASE(=(/(CAST($5):DOUBLE, $6), 0), false, >(/(POWER(/(-($2, /(*($3, $3), $4)), CASE(=($4, 1), null:BIGINT, -($4, 1))), 0.5:DECIMAL(2, 1)), /(CAST($5):DOUBLE, $6)), 1))])
+            HiveAggregate(group=[{1, 2}], agg#0=[sum($5)], agg#1=[sum($4)], agg#2=[count($4)], agg#3=[sum($3)], agg#4=[count($3)])
               HiveProject($f0=[$6], $f1=[$5], $f2=[$3], $f4=[$2], $f40=[CAST($2):DOUBLE], $f6=[*(CAST($2):DOUBLE, CAST($2):DOUBLE)])
                 HiveJoin(condition=[=($1, $5)], joinType=[inner], algorithm=[none], cost=[not available])
                   HiveJoin(condition=[=($0, $4)], joinType=[inner], algorithm=[none], cost=[not available])
@@ -16,9 +16,9 @@ HiveProject(w_warehouse_sk=[$0], i_item_sk=[$1], d_moy=[CAST(4):INTEGER], mean=[
                         HiveTableScan(table=[[default, date_dim]], table:alias=[date_dim])
                   HiveProject(w_warehouse_sk=[$0], w_warehouse_name=[$2])
                     HiveTableScan(table=[[default, warehouse]], table:alias=[warehouse])
-        HiveProject(w_warehouse_sk=[$0], i_item_sk=[$1], mean=[/(CAST($5):DOUBLE, $4)], cov=[CASE(=(/(CAST($5):DOUBLE, $4), 0), null:DOUBLE, /(POWER(/(-($2, /(*($3, $3), $4)), CASE(=($4, 1), null:BIGINT, -($4, 1))), 0.5:DECIMAL(2, 1)), /(CAST($5):DOUBLE, $4)))])
-          HiveFilter(condition=[CASE(=(/(CAST($5):DOUBLE, $4), 0), false, >(/(POWER(/(-($2, /(*($3, $3), $4)), CASE(=($4, 1), null:BIGINT, -($4, 1))), 0.5:DECIMAL(2, 1)), /(CAST($5):DOUBLE, $4)), 1))])
-            HiveAggregate(group=[{1, 2}], agg#0=[sum($5)], agg#1=[sum($4)], agg#2=[count($3)], agg#3=[sum($3)])
+        HiveProject(w_warehouse_sk=[$0], i_item_sk=[$1], mean=[/(CAST($5):DOUBLE, $6)], cov=[CASE(=(/(CAST($5):DOUBLE, $6), 0), null:DOUBLE, /(POWER(/(-($2, /(*($3, $3), $4)), CASE(=($4, 1), null:BIGINT, -($4, 1))), 0.5:DECIMAL(2, 1)), /(CAST($5):DOUBLE, $6)))])
+          HiveFilter(condition=[CASE(=(/(CAST($5):DOUBLE, $6), 0), false, >(/(POWER(/(-($2, /(*($3, $3), $4)), CASE(=($4, 1), null:BIGINT, -($4, 1))), 0.5:DECIMAL(2, 1)), /(CAST($5):DOUBLE, $6)), 1))])
+            HiveAggregate(group=[{1, 2}], agg#0=[sum($5)], agg#1=[sum($4)], agg#2=[count($4)], agg#3=[sum($3)], agg#4=[count($3)])
               HiveProject($f0=[$6], $f1=[$5], $f2=[$3], $f4=[$2], $f40=[CAST($2):DOUBLE], $f6=[*(CAST($2):DOUBLE, CAST($2):DOUBLE)])
                 HiveJoin(condition=[=($1, $5)], joinType=[inner], algorithm=[none], cost=[not available])
                   HiveJoin(condition=[=($0, $4)], joinType=[inner], algorithm=[none], cost=[not available])
diff --git a/ql/src/test/results/clientpositive/perf/tpcds30tb/tez/query17.q.out b/ql/src/test/results/clientpositive/perf/tpcds30tb/tez/query17.q.out
index a2bc0a3c94..d37b1ee2e8 100644
--- a/ql/src/test/results/clientpositive/perf/tpcds30tb/tez/query17.q.out
+++ b/ql/src/test/results/clientpositive/perf/tpcds30tb/tez/query17.q.out
@@ -347,30 +347,30 @@ STAGE PLANS:
                         outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11
                         Statistics: Num rows: 3459560664786 Data size: 1321543728307672 Basic stats: COMPLETE Column stats: COMPLETE
                         Group By Operator
-                          aggregations: count(_col3), sum(_col3), sum(_col7), sum(_col6), count(_col4), sum(_col4), sum(_col9), sum(_col8), count(_col5), sum(_col5), sum(_col11), sum(_col10)
+                          aggregations: count(_col3), sum(_col3), sum(_col7), sum(_col6), count(_col6), count(_col4), sum(_col4), sum(_col9), sum(_col8), count(_col8), count(_col5), sum(_col5), sum(_col11), sum(_col10), count(_col10)
                           keys: _col0 (type: string), _col1 (type: varchar(200)), _col2 (type: char(2))
                           minReductionHashAggr: 0.99
                           mode: hash
-                          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14
-                          Statistics: Num rows: 3459560664786 Data size: 1612155269790276 Basic stats: COMPLETE Column stats: COMPLETE
+                          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
+                          Statistics: Num rows: 3459560664786 Data size: 1695184725745140 Basic stats: COMPLETE Column stats: COMPLETE
                           Reduce Output Operator
                             key expressions: _col0 (type: string), _col1 (type: varchar(200)), _col2 (type: char(2))
                             null sort order: zzz
                             sort order: +++
                             Map-reduce partition columns: _col0 (type: string), _col1 (type: varchar(200)), _col2 (type: char(2))
-                            Statistics: Num rows: 3459560664786 Data size: 1612155269790276 Basic stats: COMPLETE Column stats: COMPLETE
-                            value expressions: _col3 (type: bigint), _col4 (type: bigint), _col5 (type: double), _col6 (type: double), _col7 (type: bigint), _col8 (type: bigint), _col9 (type: double), _col10 (type: double), _col11 (type: bigint), _col12 (type: bigint), _col13 (type: double), _col14 (type: double)
+                            Statistics: Num rows: 3459560664786 Data size: 1695184725745140 Basic stats: COMPLETE Column stats: COMPLETE
+                            value expressions: _col3 (type: bigint), _col4 (type: bigint), _col5 (type: double), _col6 (type: double), _col7 (type: bigint), _col8 (type: bigint), _col9 (type: bigint), _col10 (type: double), _col11 (type: double), _col12 (type: bigint), _col13 (type: bigint), _col14 (type: bigint), _col15 (type: double), _col16 (type: double), _col17 (type: bigint)
         Reducer 6 
             Execution mode: vectorized, llap
             Reduce Operator Tree:
               Group By Operator
-                aggregations: count(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3), count(VALUE._col4), sum(VALUE._col5), sum(VALUE._col6), sum(VALUE._col7), count(VALUE._col8), sum(VALUE._col9), sum(VALUE._col10), sum(VALUE._col11)
+                aggregations: count(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3), count(VALUE._col4), count(VALUE._col5), sum(VALUE._col6), sum(VALUE._col7), sum(VALUE._col8), count(VALUE._col9), count(VALUE._col10), sum(VALUE._col11), sum(VALUE._col12), sum(VALUE._col13), count(VALUE._col14)
                 keys: KEY._col0 (type: string), KEY._col1 (type: varchar(200)), KEY._col2 (type: char(2))
                 mode: mergepartial
-                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14
-                Statistics: Num rows: 3459560664786 Data size: 1612155269790276 Basic stats: COMPLETE Column stats: COMPLETE
+                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
+                Statistics: Num rows: 3459560664786 Data size: 1695184725745140 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
-                  expressions: _col0 (type: string), _col1 (type: varchar(200)), _col2 (type: char(2)), _col3 (type: bigint), (UDFToDouble(_col4) / _col3) (type: double), power(((_col5 - ((_col6 * _col6) / _col3)) / if((_col3 = 1L), null, (_col3 - 1))), 0.5) (type: double), (power(((_col5 - ((_col6 * _col6) / _col3)) / if((_col3 = 1L), null, (_col3 - 1))), 0.5) / (UDFToDouble(_col4) / _col3)) (type: double), _col7 (type: bigint), (UDFToDouble(_col8) / _col7) (type: double), power(((_col9 - ((_col10 * _col10) / _col7)) / if((_col7 = 1L), null, (_col7 - 1))), 0.5) (type: double), (power(((_col9 - ((_col10 * _col10) / _col7)) / if((_col7 = 1L), null, (_col7 - 1))), 0.5) / (UDFToDouble(_col8) / _col7)) (type: double), _col11 (type: bigint), (UDFToDouble(_col12) / _col11) (type: double), (power(((_col13 - ((_col14 * _col14) / _col11)) / if((_col11 = 1L), null, (_col11 - 1))), 0.5) / (UDFToDouble(_col12) / _col11)) (type: double)
+                  expressions: _col0 (type: string), _col1 (type: varchar(200)), _col2 (type: char(2)), _col3 (type: bigint), (UDFToDouble(_col4) / _col3) (type: double), power(((_col5 - ((_col6 * _col6) / _col7)) / if((_col7 = 1L), null, (_col7 - 1))), 0.5) (type: double), (power(((_col5 - ((_col6 * _col6) / _col7)) / if((_col7 = 1L), null, (_col7 - 1))), 0.5) / (UDFToDouble(_col4) / _col3)) (type: double), _col8 (type: bigint), (UDFToDouble(_col9) / _col8) (type: double), power(((_col10 - ((_col11 * _col11) / _col12)) / if((_col12 = 1L), null, (_col12 - 1))), 0.5) (type: double), (power(((_col10 - ((_col11 * _col11) / _col12)) / if((_col12 = 1L), null, (_col12 - 1))), 0.5) / (UDFToDouble(_col9) / _col8)) (type: double), _col13 (type: bigint), (UDFToDouble(_col14) / _col13) (type: double), (power(((_col15 - ((_col16 * _col16) / _col17)) / if((_col17 = 1L), null, (_col17 - 1))), 0.5) / (UDFToDouble(_col14) / _col13)) (type: double)
                   outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13
                   Statistics: Num rows: 3459560664786 Data size: 1584478784471988 Basic stats: COMPLETE Column stats: COMPLETE
                   Reduce Output Operator
diff --git a/ql/src/test/results/clientpositive/perf/tpcds30tb/tez/query39.q.out b/ql/src/test/results/clientpositive/perf/tpcds30tb/tez/query39.q.out
index 6fb410963a..a9d9f3a313 100644
--- a/ql/src/test/results/clientpositive/perf/tpcds30tb/tez/query39.q.out
+++ b/ql/src/test/results/clientpositive/perf/tpcds30tb/tez/query39.q.out
@@ -65,19 +65,19 @@ STAGE PLANS:
                           outputColumnNames: _col1, _col2, _col3, _col4, _col5
                           Statistics: Num rows: 27726856 Data size: 443629700 Basic stats: COMPLETE Column stats: COMPLETE
                           Group By Operator
-                            aggregations: sum(_col3), count(_col3), sum(_col5), sum(_col4)
+                            aggregations: sum(_col3), count(_col3), sum(_col5), sum(_col4), count(_col4)
                             keys: _col1 (type: bigint), _col2 (type: bigint)
                             minReductionHashAggr: 0.99
                             mode: hash
-                            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
-                            Statistics: Num rows: 15836 Data size: 760128 Basic stats: COMPLETE Column stats: COMPLETE
+                            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
+                            Statistics: Num rows: 15836 Data size: 886816 Basic stats: COMPLETE Column stats: COMPLETE
                             Reduce Output Operator
                               key expressions: _col0 (type: bigint), _col1 (type: bigint)
                               null sort order: zz
                               sort order: ++
                               Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
-                              Statistics: Num rows: 15836 Data size: 760128 Basic stats: COMPLETE Column stats: COMPLETE
-                              value expressions: _col2 (type: bigint), _col3 (type: bigint), _col4 (type: double), _col5 (type: double)
+                              Statistics: Num rows: 15836 Data size: 886816 Basic stats: COMPLETE Column stats: COMPLETE
+                              value expressions: _col2 (type: bigint), _col3 (type: bigint), _col4 (type: double), _col5 (type: double), _col6 (type: bigint)
             Execution mode: vectorized, llap
             LLAP IO: may be used (ACID table)
         Map 5 
@@ -153,19 +153,19 @@ STAGE PLANS:
                             outputColumnNames: _col1, _col2, _col3, _col4, _col5
                             Statistics: Num rows: 27726856 Data size: 443629700 Basic stats: COMPLETE Column stats: COMPLETE
                             Group By Operator
-                              aggregations: sum(_col3), count(_col3), sum(_col5), sum(_col4)
+                              aggregations: sum(_col3), count(_col3), sum(_col5), sum(_col4), count(_col4)
                               keys: _col1 (type: bigint), _col2 (type: bigint)
                               minReductionHashAggr: 0.99
                               mode: hash
-                              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
-                              Statistics: Num rows: 15836 Data size: 760128 Basic stats: COMPLETE Column stats: COMPLETE
+                              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
+                              Statistics: Num rows: 15836 Data size: 886816 Basic stats: COMPLETE Column stats: COMPLETE
                               Reduce Output Operator
                                 key expressions: _col0 (type: bigint), _col1 (type: bigint)
                                 null sort order: zz
                                 sort order: ++
                                 Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
-                                Statistics: Num rows: 15836 Data size: 760128 Basic stats: COMPLETE Column stats: COMPLETE
-                                value expressions: _col2 (type: bigint), _col3 (type: bigint), _col4 (type: double), _col5 (type: double)
+                                Statistics: Num rows: 15836 Data size: 886816 Basic stats: COMPLETE Column stats: COMPLETE
+                                value expressions: _col2 (type: bigint), _col3 (type: bigint), _col4 (type: double), _col5 (type: double), _col6 (type: bigint)
             Execution mode: vectorized, llap
             LLAP IO: may be used (ACID table)
         Map 8 
@@ -208,16 +208,16 @@ STAGE PLANS:
             Execution mode: vectorized, llap
             Reduce Operator Tree:
               Group By Operator
-                aggregations: sum(VALUE._col0), count(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3)
+                aggregations: sum(VALUE._col0), count(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3), count(VALUE._col4)
                 keys: KEY._col0 (type: bigint), KEY._col1 (type: bigint)
                 mode: mergepartial
-                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
-                Statistics: Num rows: 7918 Data size: 380064 Basic stats: COMPLETE Column stats: COMPLETE
+                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
+                Statistics: Num rows: 7918 Data size: 443408 Basic stats: COMPLETE Column stats: COMPLETE
                 Filter Operator
-                  predicate: if(((UDFToDouble(_col2) / _col3) = 0.0D), false, ((power(((_col4 - ((_col5 * _col5) / _col3)) / if((_col3 = 1L), null, (_col3 - 1))), 0.5) / (UDFToDouble(_col2) / _col3)) > 1.0D)) (type: boolean)
-                  Statistics: Num rows: 3959 Data size: 190032 Basic stats: COMPLETE Column stats: COMPLETE
+                  predicate: if(((UDFToDouble(_col2) / _col3) = 0.0D), false, ((power(((_col4 - ((_col5 * _col5) / _col6)) / if((_col6 = 1L), null, (_col6 - 1))), 0.5) / (UDFToDouble(_col2) / _col3)) > 1.0D)) (type: boolean)
+                  Statistics: Num rows: 3959 Data size: 221704 Basic stats: COMPLETE Column stats: COMPLETE
                   Select Operator
-                    expressions: _col0 (type: bigint), _col1 (type: bigint), (UDFToDouble(_col2) / _col3) (type: double), if(((UDFToDouble(_col2) / _col3) = 0.0D), null, (power(((_col4 - ((_col5 * _col5) / _col3)) / if((_col3 = 1L), null, (_col3 - 1))), 0.5) / (UDFToDouble(_col2) / _col3))) (type: double)
+                    expressions: _col0 (type: bigint), _col1 (type: bigint), (UDFToDouble(_col2) / _col3) (type: double), if(((UDFToDouble(_col2) / _col3) = 0.0D), null, (power(((_col4 - ((_col5 * _col5) / _col6)) / if((_col6 = 1L), null, (_col6 - 1))), 0.5) / (UDFToDouble(_col2) / _col3))) (type: double)
                     outputColumnNames: _col0, _col1, _col2, _col3
                     Statistics: Num rows: 3959 Data size: 95024 Basic stats: COMPLETE Column stats: COMPLETE
                     Map Join Operator
@@ -257,16 +257,16 @@ STAGE PLANS:
             Execution mode: vectorized, llap
             Reduce Operator Tree:
               Group By Operator
-                aggregations: sum(VALUE._col0), count(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3)
+                aggregations: sum(VALUE._col0), count(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3), count(VALUE._col4)
                 keys: KEY._col0 (type: bigint), KEY._col1 (type: bigint)
                 mode: mergepartial
-                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
-                Statistics: Num rows: 7918 Data size: 380064 Basic stats: COMPLETE Column stats: COMPLETE
+                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
+                Statistics: Num rows: 7918 Data size: 443408 Basic stats: COMPLETE Column stats: COMPLETE
                 Filter Operator
-                  predicate: if(((UDFToDouble(_col2) / _col3) = 0.0D), false, ((power(((_col4 - ((_col5 * _col5) / _col3)) / if((_col3 = 1L), null, (_col3 - 1))), 0.5) / (UDFToDouble(_col2) / _col3)) > 1.0D)) (type: boolean)
-                  Statistics: Num rows: 3959 Data size: 190032 Basic stats: COMPLETE Column stats: COMPLETE
+                  predicate: if(((UDFToDouble(_col2) / _col3) = 0.0D), false, ((power(((_col4 - ((_col5 * _col5) / _col6)) / if((_col6 = 1L), null, (_col6 - 1))), 0.5) / (UDFToDouble(_col2) / _col3)) > 1.0D)) (type: boolean)
+                  Statistics: Num rows: 3959 Data size: 221704 Basic stats: COMPLETE Column stats: COMPLETE
                   Select Operator
-                    expressions: _col0 (type: bigint), _col1 (type: bigint), (UDFToDouble(_col2) / _col3) (type: double), if(((UDFToDouble(_col2) / _col3) = 0.0D), null, (power(((_col4 - ((_col5 * _col5) / _col3)) / if((_col3 = 1L), null, (_col3 - 1))), 0.5) / (UDFToDouble(_col2) / _col3))) (type: double)
+                    expressions: _col0 (type: bigint), _col1 (type: bigint), (UDFToDouble(_col2) / _col3) (type: double), if(((UDFToDouble(_col2) / _col3) = 0.0D), null, (power(((_col4 - ((_col5 * _col5) / _col6)) / if((_col6 = 1L), null, (_col6 - 1))), 0.5) / (UDFToDouble(_col2) / _col3))) (type: double)
                     outputColumnNames: _col0, _col1, _col2, _col3
                     Statistics: Num rows: 3959 Data size: 95024 Basic stats: COMPLETE Column stats: COMPLETE
                     Reduce Output Operator
