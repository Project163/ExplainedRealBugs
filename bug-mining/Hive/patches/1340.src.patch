diff --git a/RELEASE_NOTES.txt b/RELEASE_NOTES.txt
index 7b2ea85249..8151906d75 100644
--- a/RELEASE_NOTES.txt
+++ b/RELEASE_NOTES.txt
@@ -15,6 +15,7 @@ Release Notes - Hive - Version 0.11.0
     * [HIVE-4326] - Clean up remaining items in hive/hcatalog/historical/trunk
 
 ** Bug
+    * [HIVE-4820] - webhcat_config.sh should set default values for HIVE_HOME and HCAT_PREFIX that work with default build tree structure
     * [HIVE-2264] - Hive server is SHUTTING DOWN when invalid queries beeing executed.
     * [HIVE-2332] - If all of the parameters of distinct functions are exists in group by columns, query fails in runtime
     * [HIVE-2689] - ObjectInspectorConverters cannot convert Void types to Array/Map/Struct types.
diff --git a/hcatalog/bin/hcat b/hcatalog/bin/hcat
index 455f1082ca..f59a58a25f 100644
--- a/hcatalog/bin/hcat
+++ b/hcatalog/bin/hcat
@@ -34,8 +34,14 @@ done
 bin=`dirname "$this"`                                                            
 script=`basename "$this"`                                                        
 bin=`unset CDPATH; cd "$bin"; pwd`                                               
-this="$bin/$script"                                                              
+this="$bin/$script"
+#to preserve value of 'this' since any other file that defines 'this' and is sourced
+#here (e.g. hcat-config.sh) will overwrite it
+this_hcat=$this
 
+function echoerr() {
+    echo "${this_hcat}: $@" 1>&2
+}
 
 if [ -e "$bin/../libexec/hcat-config.sh" ]; then
   . "$bin"/../libexec/hcat-config.sh
@@ -60,7 +66,8 @@ done
 
 # check for hive in the path
 HIVE_IN_PATH=`which hive 2>/dev/null`
-if [ -f ${HIVE_IN_PATH} ]; then
+# looks like [ -f '' ] is true...
+if [ -n ${HIVE_IN_PATH} ]; then
   #dir of hive scrip
   HIVE_DIR=`dirname "$HIVE_IN_PATH"`
   #one level up for base dir
@@ -70,8 +77,14 @@ fi
 # HIVE_HOME env variable overrides hive in the path
 HIVE_HOME=${HIVE_HOME:-$HIVE_DIR}
 
+#if hive is not in path and not set by env, set it to default in build tree
+if [ -n ${HIVE_HOME} ]; then
+  HIVE_HOME="${bin}/../.."
+  echoerr "HIVE_HOME is not defined; assuming ${HIVE_HOME}";
+fi
+
 if [ "$HIVE_HOME" == "" ]; then
-  echo "Cannot find hive installation: \$HIVE_HOME must be set or hive must be in the path";
+  echo "${this_hcat}: Cannot find hive installation: \$HIVE_HOME must be set or hive must be in the path";
   exit 4;
 fi
 
@@ -87,13 +100,13 @@ fi
 
 HIVE_LIB_DIR=${HIVE_HOME}/lib
 if [ ! -d "$HIVE_LIB_DIR" ]; then
-  echo "Cannot find lib dir within HIVE_HOME : $HIVE_LIB_DIR";
+  echo "${this_hcat}: Cannot find lib dir within HIVE_HOME : $HIVE_LIB_DIR";
   exit 4;
 fi
 
 HIVE_CONF_DIR=${HIVE_CONF_DIR:-$HIVE_HOME/conf}
 if [ ! -d "$HIVE_CONF_DIR" ]; then
-  echo "Cannot find conf dir within HIVE_HOME : $HIVE_CONF_DIR";
+  echo "${this_hcat}: Cannot find conf dir within HIVE_HOME : $HIVE_CONF_DIR";
   exit 4;
 fi
 
diff --git a/hcatalog/build-support/ant/deploy.xml b/hcatalog/build-support/ant/deploy.xml
index b4b05d4045..5ede3d0c1d 100644
--- a/hcatalog/build-support/ant/deploy.xml
+++ b/hcatalog/build-support/ant/deploy.xml
@@ -69,7 +69,7 @@
       <_mvnpublish module="testutils" />
     </target>
 
-    <target name="mvn-init" unless="mvn-init.complete">
+    <target name="mvn-init" unless="mvn-init.complete" description="Get Maven Ant Tasts jar and deploy all Hive jars to local Maven repo">
         <echo message="${ant.project.name}"/>
         <get src="${mvnrepo}/org/apache/maven/maven-ant-tasks/${maven-ant-tasks.version}/maven-ant-tasks-${maven-ant-tasks.version}.jar"
              dest="${path.to.basedir}/build/maven-ant-tasks-${maven-ant-tasks.version}.jar"
diff --git a/hcatalog/build-support/ant/test.xml b/hcatalog/build-support/ant/test.xml
index 3489d12cce..c7edc9cd8c 100644
--- a/hcatalog/build-support/ant/test.xml
+++ b/hcatalog/build-support/ant/test.xml
@@ -47,6 +47,9 @@
         <sysproperty key="hive.metastore.warehouse.dir" value="${test.warehouse.dir}"/>
         <sysproperty key="java.security.krb5.realm" value=""/> <!-- HADOOP-7489 -->
         <sysproperty key="java.security.krb5.kdc" value=""/> <!-- HADOOP-7489 -->
+        <!--HCAT_PREFIX, HIVE_HOME are needed by WebHCat tests-->
+        <env key="HCAT_PREFIX" value="${env.HCAT_PREFIX}"/>
+        <env key="HIVE_HOME" value="${env.HIVE_HOME}"/>
         <classpath>
           <path refid="test.class.path"/>
           <pathelement location="${clover.jar}"/>
diff --git a/hcatalog/build.xml b/hcatalog/build.xml
index 516b462f86..a716385da3 100644
--- a/hcatalog/build.xml
+++ b/hcatalog/build.xml
@@ -28,6 +28,8 @@
     <property name="path.to.basedir" location="${basedir}"/>
     <property name="test.result.dir" location="${build.dir.hive}/hcatalog/test"
               description="location to place TEST-*.xml files so that hive's testreport includes them"/>
+    <property name="hive.dist.dir" location="${build.dir.hive}/dist"
+            description="where all hive build artifacts are placed to make binary tar ball"/>
     <loadproperties srcfile="${basedir}/build.properties"/>
 
     <!--
@@ -108,6 +110,8 @@
             </ant>
             <ant target="test" dir="webhcat/svr" inheritAll="false">
                 <property name="test.result.dir" location="${test.result.dir}"/>
+                <property name="env.HIVE_HOME" value="${hive.dist.dir}"/>
+                <property name="env.HCAT_PREFIX" value="${hive.dist.dir}/hcatalog"/>
             </ant>
             <ant target="test" dir="webhcat/java-client" inheritAll="false">
                 <property name="test.result.dir" location="${test.result.dir}"/>
diff --git a/hcatalog/webhcat/svr/src/main/bin/webhcat_config.sh b/hcatalog/webhcat/svr/src/main/bin/webhcat_config.sh
index aa0c0e26f7..5736fdd4a3 100644
--- a/hcatalog/webhcat/svr/src/main/bin/webhcat_config.sh
+++ b/hcatalog/webhcat/svr/src/main/bin/webhcat_config.sh
@@ -18,6 +18,12 @@
 # under the License.
 
 
+# Print an error message and exit
+function die() {
+        echo "${this}: $@" 1>&2
+        exit 1
+}
+
 #====================================
 #Default config param values
 #====================================
@@ -71,6 +77,23 @@ else
 fi
 WEBHCAT_CONF_DIR="${WEBHCAT_CONF_DIR:-$DEFAULT_CONF_DIR}"
 
+#set defaults for HCAT_PREFIX, HIVE_HOME, TEMPLETON_HOME that work for default directory structure
+DEFAULT_HCAT_PREFIX="${WEBHCAT_PREFIX}"
+export HCAT_PREFIX="${HCAT_PREFIX:-$DEFAULT_HCAT_PREFIX}"
+if [ ! -f ${HCAT_PREFIX}/bin/hcat ]; then
+    die "HCAT_PREFIX=${HCAT_PREFIX} is invalid";
+fi
+DEFAULT_HIVE_HOME="${WEBHCAT_PREFIX}/.."
+export HIVE_HOME="${HIVE_HOME:-$DEFAULT_HIVE_HOME}"
+if [ ! -f ${HIVE_HOME}/bin/hive ]; then
+    die "HIVE_HOME=${HIVE_HOME} is invalid";
+fi
+DEFAULT_TEMPLETON_HOME="${WEBHCAT_PREFIX}"
+export TEMPLETON_HOME="${TEMPLETON_HOME:-$DEFAULT_TEMPLETON_HOME}"
+if [ ! -d ${TEMPLETON_HOME}/share/webhcat ]; then
+    die "TEMPLETON_HOME=${TEMPLETON_HOME} is invalid";
+fi
+
 #users can add various env vars to webhcat-env.sh in the conf
 #rather than having to export them before running the command
 if [ -f "${WEBHCAT_CONF_DIR}/webhcat-env.sh" ]; then
@@ -89,6 +112,6 @@ elif [ -f ${WEBHCAT_PREFIX}/bin/hadoop ]; then
   HADOOP_PREFIX=$WEBHCAT_PREFIX
 #otherwise see if HADOOP_PREFIX is defined
 elif [ ! -f ${HADOOP_PREFIX}/bin/hadoop ]; then
-  echo "Hadoop not found."
+  echo "${this}: Hadoop not found."
   exit 1
 fi
diff --git a/hcatalog/webhcat/svr/src/test/java/org/apache/hcatalog/templeton/TestWebHCatE2e.java b/hcatalog/webhcat/svr/src/test/java/org/apache/hcatalog/templeton/TestWebHCatE2e.java
index 82c1ec03fe..0e3ead8f30 100644
--- a/hcatalog/webhcat/svr/src/test/java/org/apache/hcatalog/templeton/TestWebHCatE2e.java
+++ b/hcatalog/webhcat/svr/src/test/java/org/apache/hcatalog/templeton/TestWebHCatE2e.java
@@ -28,6 +28,7 @@
 import org.apache.commons.httpclient.methods.StringRequestEntity;
 import org.apache.hadoop.hive.ql.ErrorMsg;
 import org.junit.AfterClass;
+import org.junit.BeforeClass;
 import org.junit.Ignore;
 import org.junit.Test;
 import org.slf4j.Logger;
@@ -62,8 +63,7 @@ public class TestWebHCatE2e {
     private static final String ERROR_CODE = "errorCode";
     private static Main templetonServer;
     private static final String charSet = "UTF-8";
-    //  "not ready due to HIVE-4820"
-    //@BeforeClass
+    @BeforeClass
     public static void startHebHcatInMem() {
         templetonServer = new Main(new String[] {"-D" + AppConfig.UNIT_TEST_MODE + "=true"});
         LOG.info("Starting Main");
@@ -78,7 +78,6 @@ public static void stopWebHcatInMem() {
             LOG.info("Main stopped");
         }
     }
-    @Ignore("not ready due to HIVE-4820")
     @Test
     public void getStatus() throws IOException {
         LOG.debug("+getStatus()");
@@ -100,7 +99,6 @@ public void listDataBases() throws IOException {
      * Check that we return correct status code when the URL doesn't map to any method
      * in {@link Server}
      */
-    @Ignore("not ready due to HIVE-4820")
     @Test
     public void invalidPath() throws IOException {
         MethodCallRetVal p = doHttpCall(templetonBaseUrl + "/no_such_mapping/database", HTTP_METHOD_TYPE.GET);
