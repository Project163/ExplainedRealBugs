diff --git a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/calcite/rules/HiveAggregateReduceFunctionsRule.java b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/calcite/rules/HiveAggregateReduceFunctionsRule.java
index 61c54bff70..731b34340f 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/calcite/rules/HiveAggregateReduceFunctionsRule.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/calcite/rules/HiveAggregateReduceFunctionsRule.java
@@ -34,6 +34,7 @@
 import org.apache.calcite.rex.RexNode;
 import org.apache.calcite.sql.SqlAggFunction;
 import org.apache.calcite.sql.SqlKind;
+import org.apache.calcite.sql.fun.SqlLibraryOperators;
 import org.apache.calcite.sql.fun.SqlStdOperatorTable;
 import org.apache.calcite.sql.type.InferTypes;
 import org.apache.calcite.sql.type.ReturnTypes;
@@ -516,8 +517,20 @@ private RexNode reduceStddev(
 
     final RexNode diff =
         rexBuilder.makeCall(
-            SqlStdOperatorTable.MINUS,
-            sumArgSquared, avgSumSquaredArg);
+            SqlStdOperatorTable.MINUS, sumArgSquared, avgSumSquaredArg);
+
+    RelDataType oldArgType = SqlTypeUtil.projectTypes(
+        oldAggRel.getInput().getRowType(), oldCall.getArgList()).get(0);
+
+    final RexNode correctedDiff =
+        switch (oldArgType.getSqlTypeName()){
+          case DOUBLE, DECIMAL ->
+            rexBuilder.makeCall(
+                SqlLibraryOperators.GREATEST,
+                rexBuilder.makeExactLiteral(BigDecimal.ZERO),
+                diff);
+          default -> diff;
+        };
 
     final RexNode denominator;
     if (biased) {
@@ -540,7 +553,7 @@ private RexNode reduceStddev(
 
     final RexNode div =
         rexBuilder.makeCall(
-            SqlStdOperatorTable.DIVIDE, diff, denominator);
+            SqlStdOperatorTable.DIVIDE, correctedDiff, denominator);
 
     RexNode result = div;
     if (sqrt) {
diff --git a/ql/src/test/queries/clientpositive/stddev_variance_with_double_decimal_test.q b/ql/src/test/queries/clientpositive/stddev_variance_with_double_decimal_test.q
new file mode 100644
index 0000000000..fd90e7f944
--- /dev/null
+++ b/ql/src/test/queries/clientpositive/stddev_variance_with_double_decimal_test.q
@@ -0,0 +1,29 @@
+set metastore.direct.product.name=fs;
+set hive.stats.column.autogather=false;
+
+with tempDataset as (
+select 10 as account_id, cast(23.79 as double) interest_paid
+union all select 10, 23.79
+union all select 10, 23.79
+union all select 11, 64.34
+union all select 11, 64.34
+union all select 11, 64.34
+)
+select account_id, STDDEV(interest_paid) as sdev, variance(interest_paid) as vari from tempDataset group by account_id;
+
+create table cbo_test (key string, v1 double, v2 float, v3 decimal(30,2), v4 bigint);
+
+insert into cbo_test values
+  ("001400000000000000000006375905", 10230.72, 10230.72, 10230.69, 10230),
+  ("001400000000000000000006375905", 10230.72, 10230.72, 10230.69, 10230),
+  ("001400000000000000000006375905", 10230.72, 10230.72, 10230.69, 10230),
+  ("001400000000000000000006375905", 10230.72, 10230.72, 10230.69, 10230),
+  ("001400000000000000000006375905", 10230.72, 10230.72, 10230.69, 10230),
+  ("001400000000000000000006375905", 10230.72, 10230.72, 10230.69, 10230);
+
+explain select stddev(v1), stddev(v2), stddev(v3), stddev(v4) from cbo_test;
+select stddev(v1), stddev(v2), stddev(v3), stddev(v4) from cbo_test;
+
+set hive.cbo.enable=false;
+explain select stddev(v1), stddev(v2), stddev(v3), stddev(v4) from cbo_test;
+select stddev(v1), stddev(v2), stddev(v3), stddev(v4) from cbo_test;
diff --git a/ql/src/test/results/clientpositive/llap/cbo_aggregate_reduce_functions_rule.q.out b/ql/src/test/results/clientpositive/llap/cbo_aggregate_reduce_functions_rule.q.out
index 981aee931a..280652d242 100644
--- a/ql/src/test/results/clientpositive/llap/cbo_aggregate_reduce_functions_rule.q.out
+++ b/ql/src/test/results/clientpositive/llap/cbo_aggregate_reduce_functions_rule.q.out
@@ -158,7 +158,7 @@ POSTHOOK: type: QUERY
 POSTHOOK: Input: default@test
 #### A masked pattern was here ####
 CBO PLAN:
-HiveProject(_o__c0=[CAST(COALESCE($0, 0E0:DOUBLE)):DOUBLE], _o__c1=[CAST(COALESCE($1, 0E0:DOUBLE)):DOUBLE], _o__c2=[CAST(COALESCE($2, 0E0:DOUBLE)):DOUBLE], _o__c3=[CAST(COALESCE($3, 0E0:DOUBLE)):DOUBLE], _o__c4=[CAST(COALESCE($4, 0E0:DOUBLE)):DOUBLE], _o__c5=[CAST(COALESCE($5, 0E0:DOUBLE)):DOUBLE], _o__c6=[/($6, $7)], _o__c7=[/($1, $8)], _o__c8=[/($9, $10)], _o__c9=[/($3, $11)], _o__c10=[/($12, $13)], _o__c11=[/($5, $14)], _o__c12=[POWER(/(-($15, /(*($6, $6), $7)), $7), 0.5:DECIMAL(2, 1))], _o__c13=[POWER(/(-($16, /(*($1, $1), $8)), $8), 0.5:DECIMAL(2, 1))], _o__c14=[POWER(/(-($17, /(*($9, $9), $10)), $10), 0.5:DECIMAL(2, 1))], _o__c15=[POWER(/(-($18, /(*($3, $3), $11)), $11), 0.5:DECIMAL(2, 1))], _o__c16=[POWER(/(-($19, /(*($12, $12), $13)), $13), 0.5:DECIMAL(2, 1))], _o__c17=[POWER(/(-($20, /(*($5, $5), $14)), $14), 0.5:DECIMAL(2, 1))], _o__c18=[POWER(/(-($15, /(*($6, $6), $7)), CASE(=($7, 1), null:BIGINT, -($7, 1))), 0.5:DECIMAL(2, 1))], _o__c19=[POWER(/(-($16, /(*($1, $1), $8)), CASE(=($8, 1), null:BIGINT, -($8, 1))), 0.5:DECIMAL(2, 1))], _o__c20=[POWER(/(-($17, /(*($9, $9), $10)), CASE(=($10, 1), null:BIGINT, -($10, 1))), 0.5:DECIMAL(2, 1))], _o__c21=[POWER(/(-($18, /(*($3, $3), $11)), CASE(=($11, 1), null:BIGINT, -($11, 1))), 0.5:DECIMAL(2, 1))], _o__c22=[POWER(/(-($19, /(*($12, $12), $13)), CASE(=($13, 1), null:BIGINT, -($13, 1))), 0.5:DECIMAL(2, 1))], _o__c23=[POWER(/(-($20, /(*($5, $5), $14)), CASE(=($14, 1), null:BIGINT, -($14, 1))), 0.5:DECIMAL(2, 1))], _o__c24=[/(-($15, /(*($6, $6), $7)), $7)], _o__c25=[/(-($16, /(*($1, $1), $8)), $8)], _o__c26=[/(-($17, /(*($9, $9), $10)), $10)], _o__c27=[/(-($18, /(*($3, $3), $11)), $11)], _o__c28=[/(-($19, /(*($12, $12), $13)), $13)], _o__c29=[/(-($20, /(*($5, $5), $14)), $14)], _o__c30=[/(-($15, /(*($6, $6), $7)), CASE(=($7, 1), null:BIGINT, -($7, 1)))], _o__c31=[/(-($16, /(*($1, $1), $8)), CASE(=($8, 1), null:BIGINT, -($8, 1)))], _o__c32=[/(-($17, /(*($9, $9), $10)), CASE(=($10, 1), null:BIGINT, -($10, 1)))], _o__c33=[/(-($18, /(*($3, $3), $11)), CASE(=($11, 1), null:BIGINT, -($11, 1)))], _o__c34=[/(-($19, /(*($12, $12), $13)), CASE(=($13, 1), null:BIGINT, -($13, 1)))], _o__c35=[/(-($20, /(*($5, $5), $14)), CASE(=($14, 1), null:BIGINT, -($14, 1)))], _o__c36=[$0], _o__c37=[$1], _o__c38=[$2], _o__c39=[$3], _o__c40=[$4], _o__c41=[$5], _o__c42=[$21], _o__c43=[$8], _o__c44=[$22], _o__c45=[$11], _o__c46=[$23], _o__c47=[$14])
+HiveProject(_o__c0=[CAST(COALESCE($0, 0E0:DOUBLE)):DOUBLE], _o__c1=[CAST(COALESCE($1, 0E0:DOUBLE)):DOUBLE], _o__c2=[CAST(COALESCE($2, 0E0:DOUBLE)):DOUBLE], _o__c3=[CAST(COALESCE($3, 0E0:DOUBLE)):DOUBLE], _o__c4=[CAST(COALESCE($4, 0E0:DOUBLE)):DOUBLE], _o__c5=[CAST(COALESCE($5, 0E0:DOUBLE)):DOUBLE], _o__c6=[/($6, $7)], _o__c7=[/($1, $8)], _o__c8=[/($9, $10)], _o__c9=[/($3, $11)], _o__c10=[/($12, $13)], _o__c11=[/($5, $14)], _o__c12=[POWER(/(-($15, /(*($6, $6), $7)), $7), 0.5:DECIMAL(2, 1))], _o__c13=[POWER(/(GREATEST(0, -($16, /(*($1, $1), $8))), $8), 0.5:DECIMAL(2, 1))], _o__c14=[POWER(/(-($17, /(*($9, $9), $10)), $10), 0.5:DECIMAL(2, 1))], _o__c15=[POWER(/(GREATEST(0, -($18, /(*($3, $3), $11))), $11), 0.5:DECIMAL(2, 1))], _o__c16=[POWER(/(-($19, /(*($12, $12), $13)), $13), 0.5:DECIMAL(2, 1))], _o__c17=[POWER(/(GREATEST(0, -($20, /(*($5, $5), $14))), $14), 0.5:DECIMAL(2, 1))], _o__c18=[POWER(/(-($15, /(*($6, $6), $7)), CASE(=($7, 1), null:BIGINT, -($7, 1))), 0.5:DECIMAL(2, 1))], _o__c19=[POWER(/(GREATEST(0, -($16, /(*($1, $1), $8))), CASE(=($8, 1), null:BIGINT, -($8, 1))), 0.5:DECIMAL(2, 1))], _o__c20=[POWER(/(-($17, /(*($9, $9), $10)), CASE(=($10, 1), null:BIGINT, -($10, 1))), 0.5:DECIMAL(2, 1))], _o__c21=[POWER(/(GREATEST(0, -($18, /(*($3, $3), $11))), CASE(=($11, 1), null:BIGINT, -($11, 1))), 0.5:DECIMAL(2, 1))], _o__c22=[POWER(/(-($19, /(*($12, $12), $13)), CASE(=($13, 1), null:BIGINT, -($13, 1))), 0.5:DECIMAL(2, 1))], _o__c23=[POWER(/(GREATEST(0, -($20, /(*($5, $5), $14))), CASE(=($14, 1), null:BIGINT, -($14, 1))), 0.5:DECIMAL(2, 1))], _o__c24=[/(-($15, /(*($6, $6), $7)), $7)], _o__c25=[/(GREATEST(0, -($16, /(*($1, $1), $8))), $8)], _o__c26=[/(-($17, /(*($9, $9), $10)), $10)], _o__c27=[/(GREATEST(0, -($18, /(*($3, $3), $11))), $11)], _o__c28=[/(-($19, /(*($12, $12), $13)), $13)], _o__c29=[/(GREATEST(0, -($20, /(*($5, $5), $14))), $14)], _o__c30=[/(-($15, /(*($6, $6), $7)), CASE(=($7, 1), null:BIGINT, -($7, 1)))], _o__c31=[/(GREATEST(0, -($16, /(*($1, $1), $8))), CASE(=($8, 1), null:BIGINT, -($8, 1)))], _o__c32=[/(-($17, /(*($9, $9), $10)), CASE(=($10, 1), null:BIGINT, -($10, 1)))], _o__c33=[/(GREATEST(0, -($18, /(*($3, $3), $11))), CASE(=($11, 1), null:BIGINT, -($11, 1)))], _o__c34=[/(-($19, /(*($12, $12), $13)), CASE(=($13, 1), null:BIGINT, -($13, 1)))], _o__c35=[/(GREATEST(0, -($20, /(*($5, $5), $14))), CASE(=($14, 1), null:BIGINT, -($14, 1)))], _o__c36=[$0], _o__c37=[$1], _o__c38=[$2], _o__c39=[$3], _o__c40=[$4], _o__c41=[$5], _o__c42=[$21], _o__c43=[$8], _o__c44=[$22], _o__c45=[$11], _o__c46=[$23], _o__c47=[$14])
   HiveAggregate(group=[{}], agg#0=[sum($0)], agg#1=[sum($1)], agg#2=[sum($2)], agg#3=[sum($3)], agg#4=[sum($4)], agg#5=[sum($5)], agg#6=[sum($6)], agg#7=[count($6)], agg#8=[count($1)], agg#9=[sum($7)], agg#10=[count($7)], agg#11=[count($3)], agg#12=[sum($8)], agg#13=[count($8)], agg#14=[count($5)], agg#15=[sum($9)], agg#16=[sum($10)], agg#17=[sum($11)], agg#18=[sum($12)], agg#19=[sum($13)], agg#20=[sum($14)], agg#21=[count($0)], agg#22=[count($2)], agg#23=[count($4)])
     HiveProject($f0=[$0], $f1=[CAST($0):DOUBLE], $f2=[$1], $f3=[CAST($1):DOUBLE], $f4=[$2], $f5=[CAST($2):DOUBLE], $f00=[CAST($0):DOUBLE], $f20=[CAST($1):DOUBLE], $f40=[CAST($2):DOUBLE], $f9=[*(CAST($0):DOUBLE, CAST($0):DOUBLE)], $f10=[*(CAST($0):DOUBLE, CAST($0):DOUBLE)], $f11=[*(CAST($1):DOUBLE, CAST($1):DOUBLE)], $f12=[*(CAST($1):DOUBLE, CAST($1):DOUBLE)], $f13=[*(CAST($2):DOUBLE, CAST($2):DOUBLE)], $f14=[*(CAST($2):DOUBLE, CAST($2):DOUBLE)])
       HiveTableScan(table=[[default, test]], table:alias=[test])
diff --git a/ql/src/test/results/clientpositive/llap/decimal_udf.q.out b/ql/src/test/results/clientpositive/llap/decimal_udf.q.out
index 2410bfcba2..dc12dec7b2 100644
--- a/ql/src/test/results/clientpositive/llap/decimal_udf.q.out
+++ b/ql/src/test/results/clientpositive/llap/decimal_udf.q.out
@@ -1950,7 +1950,7 @@ STAGE PLANS:
                 outputColumnNames: _col0, _col1, _col2, _col3
                 Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: NONE
                 Select Operator
-                  expressions: _col0 (type: int), power(((_col1 - ((_col2 * _col2) / _col3)) / _col3), 0.5) (type: double), ((_col1 - ((_col2 * _col2) / _col3)) / _col3) (type: double)
+                  expressions: _col0 (type: int), power((greatest(0,(_col1 - ((_col2 * _col2) / _col3))) / _col3), 0.5) (type: double), (greatest(0,(_col1 - ((_col2 * _col2) / _col3))) / _col3) (type: double)
                   outputColumnNames: _col0, _col1, _col2
                   Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: NONE
                   File Output Operator
@@ -2047,7 +2047,7 @@ STAGE PLANS:
                 outputColumnNames: _col0, _col1, _col2, _col3
                 Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: NONE
                 Select Operator
-                  expressions: _col0 (type: int), power(((_col1 - ((_col2 * _col2) / _col3)) / if((_col3 = 1L), null, (_col3 - 1))), 0.5) (type: double), ((_col1 - ((_col2 * _col2) / _col3)) / if((_col3 = 1L), null, (_col3 - 1))) (type: double)
+                  expressions: _col0 (type: int), power((greatest(0,(_col1 - ((_col2 * _col2) / _col3))) / if((_col3 = 1L), null, (_col3 - 1))), 0.5) (type: double), (greatest(0,(_col1 - ((_col2 * _col2) / _col3))) / if((_col3 = 1L), null, (_col3 - 1))) (type: double)
                   outputColumnNames: _col0, _col1, _col2
                   Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: NONE
                   File Output Operator
diff --git a/ql/src/test/results/clientpositive/llap/parquet_types_non_dictionary_encoding_vectorization.q.out b/ql/src/test/results/clientpositive/llap/parquet_types_non_dictionary_encoding_vectorization.q.out
index a411ffde5f..1858408db2 100644
--- a/ql/src/test/results/clientpositive/llap/parquet_types_non_dictionary_encoding_vectorization.q.out
+++ b/ql/src/test/results/clientpositive/llap/parquet_types_non_dictionary_encoding_vectorization.q.out
@@ -508,7 +508,7 @@ STAGE PLANS:
                 outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                 Statistics: Num rows: 150 Data size: 29744 Basic stats: COMPLETE Column stats: NONE
                 Select Operator
-                  expressions: _col0 (type: tinyint), _col1 (type: int), _col2 (type: smallint), _col3 (type: bigint), round((_col4 / _col5), 5) (type: double), round(power(((_col6 - ((_col7 * _col7) / _col8)) / _col8), 0.5), 5) (type: double)
+                  expressions: _col0 (type: tinyint), _col1 (type: int), _col2 (type: smallint), _col3 (type: bigint), round((_col4 / _col5), 5) (type: double), round(power((greatest(0,(_col6 - ((_col7 * _col7) / _col8))) / _col8), 0.5), 5) (type: double)
                   outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                   Statistics: Num rows: 150 Data size: 29744 Basic stats: COMPLETE Column stats: NONE
                   Reduce Output Operator
diff --git a/ql/src/test/results/clientpositive/llap/parquet_types_vectorization.q.out b/ql/src/test/results/clientpositive/llap/parquet_types_vectorization.q.out
index 062a59a45a..2f60dd7695 100644
--- a/ql/src/test/results/clientpositive/llap/parquet_types_vectorization.q.out
+++ b/ql/src/test/results/clientpositive/llap/parquet_types_vectorization.q.out
@@ -228,7 +228,7 @@ STAGE PLANS:
                 outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                 Statistics: Num rows: 11 Data size: 2288 Basic stats: COMPLETE Column stats: NONE
                 Select Operator
-                  expressions: _col0 (type: tinyint), _col1 (type: int), _col2 (type: smallint), _col3 (type: bigint), round((_col4 / _col5), 5) (type: double), round(power(((_col6 - ((_col7 * _col7) / _col8)) / _col8), 0.5), 5) (type: double)
+                  expressions: _col0 (type: tinyint), _col1 (type: int), _col2 (type: smallint), _col3 (type: bigint), round((_col4 / _col5), 5) (type: double), round(power((greatest(0,(_col6 - ((_col7 * _col7) / _col8))) / _col8), 0.5), 5) (type: double)
                   outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                   Statistics: Num rows: 11 Data size: 2288 Basic stats: COMPLETE Column stats: NONE
                   Reduce Output Operator
diff --git a/ql/src/test/results/clientpositive/llap/parquet_vectorization_1.q.out b/ql/src/test/results/clientpositive/llap/parquet_vectorization_1.q.out
index 954191c63f..a00c56715b 100644
--- a/ql/src/test/results/clientpositive/llap/parquet_vectorization_1.q.out
+++ b/ql/src/test/results/clientpositive/llap/parquet_vectorization_1.q.out
@@ -123,7 +123,7 @@ STAGE PLANS:
                 enabled: true
                 enableConditionsMet: hive.vectorized.execution.reduce.enabled IS true, hive.execution.engine tez IN [tez] IS true
                 allNative: false
-                usesVectorUDFAdaptor: false
+                usesVectorUDFAdaptor: true
                 vectorized: true
             Reduce Operator Tree:
               Group By Operator
@@ -139,13 +139,13 @@ STAGE PLANS:
                 outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                 Statistics: Num rows: 1 Data size: 72 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
-                  expressions: ((_col0 - ((_col1 * _col1) / _col2)) / _col2) (type: double), (((_col0 - ((_col1 * _col1) / _col2)) / _col2) / -26.28D) (type: double), _col3 (type: double), (-1.389D + _col3) (type: double), (_col3 * (-1.389D + _col3)) (type: double), _col4 (type: tinyint), (- (_col3 * (-1.389D + _col3))) (type: double), _col5 (type: int), (CAST( _col5 AS decimal(10,0)) * 79.553) (type: decimal(16,3)), ((_col6 - ((_col7 * _col7) / _col8)) / if((_col8 = 1L), null, (_col8 - 1))) (type: double), (10.175D % (- (_col3 * (-1.389D + _col3)))) (type: double), _col9 (type: bigint), (-563 % _col5) (type: int)
+                  expressions: ((_col0 - ((_col1 * _col1) / _col2)) / _col2) (type: double), (((_col0 - ((_col1 * _col1) / _col2)) / _col2) / -26.28D) (type: double), _col3 (type: double), (-1.389D + _col3) (type: double), (_col3 * (-1.389D + _col3)) (type: double), _col4 (type: tinyint), (- (_col3 * (-1.389D + _col3))) (type: double), _col5 (type: int), (CAST( _col5 AS decimal(10,0)) * 79.553) (type: decimal(16,3)), (greatest(0,(_col6 - ((_col7 * _col7) / _col8))) / if((_col8 = 1L), null, (_col8 - 1))) (type: double), (10.175D % (- (_col3 * (-1.389D + _col3)))) (type: double), _col9 (type: bigint), (-563 % _col5) (type: int)
                   outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12
                   Select Vectorization:
                       className: VectorSelectOperator
                       native: true
-                      projectedOutputColumnNums: [13, 18, 3, 19, 21, 4, 24, 5, 27, 34, 38, 9, 39]
-                      selectExpressions: DoubleColDivideLongColumn(col 12:double, col 2:bigint)(children: DoubleColSubtractDoubleColumn(col 0:double, col 11:double)(children: DoubleColDivideLongColumn(col 10:double, col 2:bigint)(children: DoubleColMultiplyDoubleColumn(col 1:double, col 1:double) -> 10:double) -> 11:double) -> 12:double) -> 13:double, DoubleColDivideDoubleScalar(col 17:double, val -26.28)(children: DoubleColDivideLongColumn(col 16:double, col 2:bigint)(children: DoubleColSubtractDoubleColumn(col 0:double, col 15:double)(children: DoubleColDivideLongColumn(col 14:double, col 2:bigint)(children: DoubleColMultiplyDoubleColumn(col 1:double, col 1:double) -> 14:double) -> 15:double) -> 16:double) -> 17:double) -> 18:double, DoubleScalarAddDoubleColumn(val -1.389, col 3:double) -> 19:double, DoubleColMultiplyDoubleColumn(col 3:double, col 20:double)(children: DoubleScalarAddDoubleColumn(val -1.389, col 3:double) -> 20:double) -> 21:double, DoubleColUnaryMinus(col 23:double)(children: DoubleColMultiplyDoubleColumn(col 3:double, col 22:double)(children: DoubleScalarAddDoubleColumn(val -1.389, col 3:double) -> 22:double) -> 23:double) -> 24:double, DecimalColMultiplyDecimalScalar(col 26:decimal(10,0), val 79.553)(children: CastLongToDecimal(col 5:int) -> 26:decimal(10,0)) -> 27:decimal(16,3), DoubleColDivideLongColumn(col 30:double, col 33:bigint)(children: DoubleColSubtractDoubleColumn(col 6:double, col 29:double)(children: DoubleColDivideLongColumn(col 28:double, col 8:bigint)(children: DoubleColMultiplyDoubleColumn(col 7:double, col 7:double) -> 28:double) -> 29:double) -> 30:double, IfExprNullCondExpr(col 31:boolean, null, col 32:bigint)(children: LongColEqualLongScalar(col 8:bigint, val 1) -> 31:boolean, LongColSubtractLongScalar(col 8:bigint, val 1) -> 32:bigint) -> 33:bigint) -> 34:double, DoubleScalarModuloDoubleColumn(val 10.175, col 37:double)(children: DoubleColUnaryMinus(col 36:double)(children: DoubleColMultiplyDoubleColumn(col 3:double, col 35:double)(children: DoubleScalarAddDoubleColumn(val -1.389, col 3:double) -> 35:double) -> 36:double) -> 37:double) -> 38:double, LongScalarModuloLongColumn(val -563, col 5:int) -> 39:int
+                      projectedOutputColumnNums: [13, 18, 3, 19, 21, 4, 24, 5, 27, 35, 39, 9, 40]
+                      selectExpressions: DoubleColDivideLongColumn(col 12:double, col 2:bigint)(children: DoubleColSubtractDoubleColumn(col 0:double, col 11:double)(children: DoubleColDivideLongColumn(col 10:double, col 2:bigint)(children: DoubleColMultiplyDoubleColumn(col 1:double, col 1:double) -> 10:double) -> 11:double) -> 12:double) -> 13:double, DoubleColDivideDoubleScalar(col 17:double, val -26.28)(children: DoubleColDivideLongColumn(col 16:double, col 2:bigint)(children: DoubleColSubtractDoubleColumn(col 0:double, col 15:double)(children: DoubleColDivideLongColumn(col 14:double, col 2:bigint)(children: DoubleColMultiplyDoubleColumn(col 1:double, col 1:double) -> 14:double) -> 15:double) -> 16:double) -> 17:double) -> 18:double, DoubleScalarAddDoubleColumn(val -1.389, col 3:double) -> 19:double, DoubleColMultiplyDoubleColumn(col 3:double, col 20:double)(children: DoubleScalarAddDoubleColumn(val -1.389, col 3:double) -> 20:double) -> 21:double, DoubleColUnaryMinus(col 23:double)(children: DoubleColMultiplyDoubleColumn(col 3:double, col 22:double)(children: DoubleScalarAddDoubleColumn(val -1.389, col 3:double) -> 22:double) -> 23:double) -> 24:double, DecimalColMultiplyDecimalScalar(col 26:decimal(10,0), val 79.553)(children: CastLongToDecimal(col 5:int) -> 26:decimal(10,0)) -> 27:decimal(16,3), DoubleColDivideLongColumn(col 31:double, col 34:bigint)(children: VectorUDFAdaptor(greatest(0,(_col6 - ((_col7 * _col7) / _col8))))(children: DoubleColSubtractDoubleColumn(col 6:double, col 29:double)(children: DoubleColDivideLongColumn(col 28:double, col 8:bigint)(children: DoubleColMultiplyDoubleColumn(col 7:double, col 7:double) -> 28:double) -> 29:double) -> 30:double) -> 31:double, IfExprNullCondExpr(col 32:boolean, null, col 33:bigint)(children: LongColEqualLongScalar(col 8:bigint, val 1) -> 32:boolean, LongColSubtractLongScalar(col 8:bigint, val 1) -> 33:bigint) -> 34:bigint) -> 35:double, DoubleScalarModuloDoubleColumn(val 10.175, col 38:double)(children: DoubleColUnaryMinus(col 37:double)(children: DoubleColMultiplyDoubleColumn(col 3:double, col 36:double)(children: DoubleScalarAddDoubleColumn(val -1.389, col 3:double) -> 36:double) -> 37:double) -> 38:double) -> 39:double, LongScalarModuloLongColumn(val -563, col 5:int) -> 40:int
                   Statistics: Num rows: 1 Data size: 196 Basic stats: COMPLETE Column stats: COMPLETE
                   File Output Operator
                     compressed: false
diff --git a/ql/src/test/results/clientpositive/llap/parquet_vectorization_12.q.out b/ql/src/test/results/clientpositive/llap/parquet_vectorization_12.q.out
index 92f329c3f8..1ba06844f9 100644
--- a/ql/src/test/results/clientpositive/llap/parquet_vectorization_12.q.out
+++ b/ql/src/test/results/clientpositive/llap/parquet_vectorization_12.q.out
@@ -150,7 +150,7 @@ STAGE PLANS:
                 enabled: true
                 enableConditionsMet: hive.vectorized.execution.reduce.enabled IS true, hive.execution.engine tez IN [tez] IS true
                 allNative: false
-                usesVectorUDFAdaptor: false
+                usesVectorUDFAdaptor: true
                 vectorized: true
             Reduce Operator Tree:
               Group By Operator
@@ -168,13 +168,13 @@ STAGE PLANS:
                 outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11
                 Statistics: Num rows: 1903 Data size: 283900 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
-                  expressions: _col1 (type: bigint), _col3 (type: boolean), _col2 (type: string), _col0 (type: double), (-6432.0D * _col0) (type: double), (- _col1) (type: bigint), _col4 (type: bigint), (_col1 * _col4) (type: bigint), power(((_col5 - ((_col6 * _col6) / _col7)) / if((_col7 = 1L), null, (_col7 - 1))), 0.5) (type: double), ((-6432.0D * _col0) / -6432.0D) (type: double), (- ((-6432.0D * _col0) / -6432.0D)) (type: double), (_col8 / _col9) (type: double), (- (-6432.0D * _col0)) (type: double), (-5638.15 + CAST( _col1 AS decimal(19,0))) (type: decimal(22,2)), _col10 (type: bigint), ((_col8 / _col9) / (-6432.0D * _col0)) (type: double), (((-6432.0D * _col0) / -6432.0D) + (- (-6432.0D * _col0))) (type: double), power(((_col11 - ((_col8 * _col8) / _col9)) / _col9), 0.5) (type: double)
+                  expressions: _col1 (type: bigint), _col3 (type: boolean), _col2 (type: string), _col0 (type: double), (-6432.0D * _col0) (type: double), (- _col1) (type: bigint), _col4 (type: bigint), (_col1 * _col4) (type: bigint), power(((_col5 - ((_col6 * _col6) / _col7)) / if((_col7 = 1L), null, (_col7 - 1))), 0.5) (type: double), ((-6432.0D * _col0) / -6432.0D) (type: double), (- ((-6432.0D * _col0) / -6432.0D)) (type: double), (_col8 / _col9) (type: double), (- (-6432.0D * _col0)) (type: double), (-5638.15 + CAST( _col1 AS decimal(19,0))) (type: decimal(22,2)), _col10 (type: bigint), ((_col8 / _col9) / (-6432.0D * _col0)) (type: double), (((-6432.0D * _col0) / -6432.0D) + (- (-6432.0D * _col0))) (type: double), power((greatest(0,(_col11 - ((_col8 * _col8) / _col9))) / _col9), 0.5) (type: double)
                   outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col18, _col19
                   Select Vectorization:
                       className: VectorSelectOperator
                       native: true
-                      projectedOutputColumnNums: [1, 3, 2, 0, 12, 13, 4, 14, 22, 24, 27, 28, 30, 32, 10, 35, 40, 45]
-                      selectExpressions: DoubleScalarMultiplyDoubleColumn(val -6432.0, col 0:double) -> 12:double, LongColUnaryMinus(col 1:bigint) -> 13:bigint, LongColMultiplyLongColumn(col 1:bigint, col 4:bigint) -> 14:bigint, FuncPowerDoubleToDouble(col 21:double)(children: DoubleColDivideLongColumn(col 17:double, col 20:bigint)(children: DoubleColSubtractDoubleColumn(col 5:double, col 16:double)(children: DoubleColDivideLongColumn(col 15:double, col 7:bigint)(children: DoubleColMultiplyDoubleColumn(col 6:double, col 6:double) -> 15:double) -> 16:double) -> 17:double, IfExprNullCondExpr(col 18:boolean, null, col 19:bigint)(children: LongColEqualLongScalar(col 7:bigint, val 1) -> 18:boolean, LongColSubtractLongScalar(col 7:bigint, val 1) -> 19:bigint) -> 20:bigint) -> 21:double) -> 22:double, DoubleColDivideDoubleScalar(col 23:double, val -6432.0)(children: DoubleScalarMultiplyDoubleColumn(val -6432.0, col 0:double) -> 23:double) -> 24:double, DoubleColUnaryMinus(col 26:double)(children: DoubleColDivideDoubleScalar(col 25:double, val -6432.0)(children: DoubleScalarMultiplyDoubleColumn(val -6432.0, col 0:double) -> 25:double) -> 26:double) -> 27:double, DoubleColDivideLongColumn(col 8:double, col 9:bigint) -> 28:double, DoubleColUnaryMinus(col 29:double)(children: DoubleScalarMultiplyDoubleColumn(val -6432.0, col 0:double) -> 29:double) -> 30:double, DecimalScalarAddDecimalColumn(val -5638.15, col 31:decimal(19,0))(children: CastLongToDecimal(col 1:bigint) -> 31:decimal(19,0)) -> 32:decimal(22,2), DoubleColDivideDoubleColumn(col 33:double, col 34:double)(children: DoubleColDivideLongColumn(col 8:double, col 9:bigint) -> 33:double, DoubleScalarMultiplyDoubleColumn(val -6432.0, col 0:double) -> 34:double) -> 35:double, DoubleColAddDoubleColumn(col 37:double, col 39:double)(children: DoubleColDivideDoubleScalar(col 36:double, val -6432.0)(children: DoubleScalarMultiplyDoubleColumn(val -6432.0, col 0:double) -> 36:double) -> 37:double, DoubleColUnaryMinus(col 38:double)(children: DoubleScalarMultiplyDoubleColumn(val -6432.0, col 0:double) -> 38:double) -> 39:double) -> 40:double, FuncPowerDoubleToDouble(col 44:double)(children: DoubleColDivideLongColumn(col 43:double, col 9:bigint)(children: DoubleColSubtractDoubleColumn(col 11:double, col 42:double)(children: DoubleColDivideLongColumn(col 41:double, col 9:bigint)(children: DoubleColMultiplyDoubleColumn(col 8:double, col 8:double) -> 41:double) -> 42:double) -> 43:double) -> 44:double) -> 45:double
+                      projectedOutputColumnNums: [1, 3, 2, 0, 12, 13, 4, 14, 22, 24, 27, 28, 30, 32, 10, 35, 40, 46]
+                      selectExpressions: DoubleScalarMultiplyDoubleColumn(val -6432.0, col 0:double) -> 12:double, LongColUnaryMinus(col 1:bigint) -> 13:bigint, LongColMultiplyLongColumn(col 1:bigint, col 4:bigint) -> 14:bigint, FuncPowerDoubleToDouble(col 21:double)(children: DoubleColDivideLongColumn(col 17:double, col 20:bigint)(children: DoubleColSubtractDoubleColumn(col 5:double, col 16:double)(children: DoubleColDivideLongColumn(col 15:double, col 7:bigint)(children: DoubleColMultiplyDoubleColumn(col 6:double, col 6:double) -> 15:double) -> 16:double) -> 17:double, IfExprNullCondExpr(col 18:boolean, null, col 19:bigint)(children: LongColEqualLongScalar(col 7:bigint, val 1) -> 18:boolean, LongColSubtractLongScalar(col 7:bigint, val 1) -> 19:bigint) -> 20:bigint) -> 21:double) -> 22:double, DoubleColDivideDoubleScalar(col 23:double, val -6432.0)(children: DoubleScalarMultiplyDoubleColumn(val -6432.0, col 0:double) -> 23:double) -> 24:double, DoubleColUnaryMinus(col 26:double)(children: DoubleColDivideDoubleScalar(col 25:double, val -6432.0)(children: DoubleScalarMultiplyDoubleColumn(val -6432.0, col 0:double) -> 25:double) -> 26:double) -> 27:double, DoubleColDivideLongColumn(col 8:double, col 9:bigint) -> 28:double, DoubleColUnaryMinus(col 29:double)(children: DoubleScalarMultiplyDoubleColumn(val -6432.0, col 0:double) -> 29:double) -> 30:double, DecimalScalarAddDecimalColumn(val -5638.15, col 31:decimal(19,0))(children: CastLongToDecimal(col 1:bigint) -> 31:decimal(19,0)) -> 32:decimal(22,2), DoubleColDivideDoubleColumn(col 33:double, col 34:double)(children: DoubleColDivideLongColumn(col 8:double, col 9:bigint) -> 33:double, DoubleScalarMultiplyDoubleColumn(val -6432.0, col 0:double) -> 34:double) -> 35:double, DoubleColAddDoubleColumn(col 37:double, col 39:double)(children: DoubleColDivideDoubleScalar(col 36:double, val -6432.0)(children: DoubleScalarMultiplyDoubleColumn(val -6432.0, col 0:double) -> 36:double) -> 37:double, DoubleColUnaryMinus(col 38:double)(children: DoubleScalarMultiplyDoubleColumn(val -6432.0, col 0:double) -> 38:double) -> 39:double) -> 40:double, FuncPowerDoubleToDouble(col 45:double)(children: DoubleColDivideLongColumn(col 44:double, col 9:bigint)(children: VectorUDFAdaptor(greatest(0,(_col11 - ((_col8 * _col8) / _col9))))(children: DoubleColSubtractDoubleColumn(col 11:double, col 42:double)(children: DoubleColDivideLongColumn(col 41:double, col 9:bigint)(children: DoubleColMultiplyDoubleColumn(col 8:double, col 8:double) -> 41:double) -> 42:double) -> 43:double) -> 44:double) -> 45:double) -> 46:double
                   Statistics: Num rows: 1903 Data size: 573156 Basic stats: COMPLETE Column stats: COMPLETE
                   Reduce Output Operator
                     key expressions: _col3 (type: double), _col0 (type: bigint), _col2 (type: string)
diff --git a/ql/src/test/results/clientpositive/llap/parquet_vectorization_14.q.out b/ql/src/test/results/clientpositive/llap/parquet_vectorization_14.q.out
index b333d723d9..5acc12c3b7 100644
--- a/ql/src/test/results/clientpositive/llap/parquet_vectorization_14.q.out
+++ b/ql/src/test/results/clientpositive/llap/parquet_vectorization_14.q.out
@@ -152,7 +152,7 @@ STAGE PLANS:
                 enabled: true
                 enableConditionsMet: hive.vectorized.execution.reduce.enabled IS true, hive.execution.engine tez IN [tez] IS true
                 allNative: false
-                usesVectorUDFAdaptor: false
+                usesVectorUDFAdaptor: true
                 vectorized: true
             Reduce Operator Tree:
               Group By Operator
@@ -170,13 +170,13 @@ STAGE PLANS:
                 outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12
                 Statistics: Num rows: 758 Data size: 130530 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
-                  expressions: _col3 (type: timestamp), _col1 (type: float), _col0 (type: string), _col4 (type: boolean), _col2 (type: double), (-26.28D + _col2) (type: double), (- (-26.28D + _col2)) (type: double), power(((_col5 - ((_col6 * _col6) / _col7)) / if((_col7 = 1L), null, (_col7 - 1))), 0.5) (type: double), (_col1 * -26.28) (type: float), _col8 (type: float), (- _col1) (type: float), (- _col8) (type: float), ((- (-26.28D + _col2)) / 10.175D) (type: double), power(((_col9 - ((_col10 * _col10) / _col11)) / _col11), 0.5) (type: double), _col12 (type: bigint), (- ((- (-26.28D + _col2)) / 10.175D)) (type: double), (-1.389D % power(((_col5 - ((_col6 * _col6) / _col7)) / if((_col7 = 1L), null, (_col7 - 1))), 0.5)) (type: double), (UDFToDouble(_col1) - _col2) (type: double), ((_col9 - ((_col10 * _col10) / _col11)) / _col11) (type: double), (((_col9 - ((_col10 * _col10) / _col11)) / _col11) % 10.175D) (type: double), ((_col9 - ((_col10 * _col10) / _col11)) / if((_col11 = 1L), null, (_col11 - 1))) (type: double), (- (UDFToDouble(_col1) - _col2)) (type: double)
+                  expressions: _col3 (type: timestamp), _col1 (type: float), _col0 (type: string), _col4 (type: boolean), _col2 (type: double), (-26.28D + _col2) (type: double), (- (-26.28D + _col2)) (type: double), power((greatest(0,(_col5 - ((_col6 * _col6) / _col7))) / if((_col7 = 1L), null, (_col7 - 1))), 0.5) (type: double), (_col1 * -26.28) (type: float), _col8 (type: float), (- _col1) (type: float), (- _col8) (type: float), ((- (-26.28D + _col2)) / 10.175D) (type: double), power(((_col9 - ((_col10 * _col10) / _col11)) / _col11), 0.5) (type: double), _col12 (type: bigint), (- ((- (-26.28D + _col2)) / 10.175D)) (type: double), (-1.389D % power((greatest(0,(_col5 - ((_col6 * _col6) / _col7))) / if((_col7 = 1L), null, (_col7 - 1))), 0.5)) (type: double), (UDFToDouble(_col1) - _col2) (type: double), ((_col9 - ((_col10 * _col10) / _col11)) / _col11) (type: double), (((_col9 - ((_col10 * _col10) / _col11)) / _col11) % 10.175D) (type: double), ((_col9 - ((_col10 * _col10) / _col11)) / if((_col11 = 1L), null, (_col11 - 1))) (type: double), (- (UDFToDouble(_col1) - _col2)) (type: double)
                   outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21
                   Select Vectorization:
                       className: VectorSelectOperator
                       native: true
-                      projectedOutputColumnNums: [3, 1, 0, 4, 2, 13, 15, 23, 24, 8, 25, 26, 29, 34, 12, 38, 47, 48, 52, 57, 64, 66]
-                      selectExpressions: DoubleScalarAddDoubleColumn(val -26.28, col 2:double) -> 13:double, DoubleColUnaryMinus(col 14:double)(children: DoubleScalarAddDoubleColumn(val -26.28, col 2:double) -> 14:double) -> 15:double, FuncPowerDoubleToDouble(col 22:double)(children: DoubleColDivideLongColumn(col 18:double, col 21:bigint)(children: DoubleColSubtractDoubleColumn(col 5:double, col 17:double)(children: DoubleColDivideLongColumn(col 16:double, col 7:bigint)(children: DoubleColMultiplyDoubleColumn(col 6:double, col 6:double) -> 16:double) -> 17:double) -> 18:double, IfExprNullCondExpr(col 19:boolean, null, col 20:bigint)(children: LongColEqualLongScalar(col 7:bigint, val 1) -> 19:boolean, LongColSubtractLongScalar(col 7:bigint, val 1) -> 20:bigint) -> 21:bigint) -> 22:double) -> 23:double, DoubleColMultiplyDoubleScalar(col 1:float, val -26.280000686645508) -> 24:float, DoubleColUnaryMinus(col 1:float) -> 25:float, DoubleColUnaryMinus(col 8:float) -> 26:float, DoubleColDivideDoubleScalar(col 28:double, val 10.175)(children: DoubleColUnaryMinus(col 27:double)(children: DoubleScalarAddDoubleColumn(val -26.28, col 2:double) -> 27:double) -> 28:double) -> 29:double, FuncPowerDoubleToDouble(col 33:double)(children: DoubleColDivideLongColumn(col 32:double, col 11:bigint)(children: DoubleColSubtractDoubleColumn(col 9:double, col 31:double)(children: DoubleColDivideLongColumn(col 30:double, col 11:bigint)(children: DoubleColMultiplyDoubleColumn(col 10:double, col 10:double) -> 30:double) -> 31:double) -> 32:double) -> 33:double) -> 34:double, DoubleColUnaryMinus(col 37:double)(children: DoubleColDivideDoubleScalar(col 36:double, val 10.175)(children: DoubleColUnaryMinus(col 35:double)(children: DoubleScalarAddDoubleColumn(val -26.28, col 2:double) -> 35:double) -> 36:double) -> 37:double) -> 38:double, DoubleScalarModuloDoubleColumn(val -1.389, col 46:double)(children: FuncPowerDoubleToDouble(col 45:double)(children: DoubleColDivideLongColumn(col 41:double, col 44:bigint)(children: DoubleColSubtractDoubleColumn(col 5:double, col 40:double)(children: DoubleColDivideLongColumn(col 39:double, col 7:bigint)(children: DoubleColMultiplyDoubleColumn(col 6:double, col 6:double) -> 39:double) -> 40:double) -> 41:double, IfExprNullCondExpr(col 42:boolean, null, col 43:bigint)(children: LongColEqualLongScalar(col 7:bigint, val 1) -> 42:boolean, LongColSubtractLongScalar(col 7:bigint, val 1) -> 43:bigint) -> 44:bigint) -> 45:double) -> 46:double) -> 47:double, DoubleColSubtractDoubleColumn(col 1:double, col 2:double)(children: col 1:float) -> 48:double, DoubleColDivideLongColumn(col 51:double, col 11:bigint)(children: DoubleColSubtractDoubleColumn(col 9:double, col 50:double)(children: DoubleColDivideLongColumn(col 49:double, col 11:bigint)(children: DoubleColMultiplyDoubleColumn(col 10:double, col 10:double) -> 49:double) -> 50:double) -> 51:double) -> 52:double, DoubleColModuloDoubleScalar(col 56:double, val 10.175)(children: DoubleColDivideLongColumn(col 55:double, col 11:bigint)(children: DoubleColSubtractDoubleColumn(col 9:double, col 54:double)(children: DoubleColDivideLongColumn(col 53:double, col 11:bigint)(children: DoubleColMultiplyDoubleColumn(col 10:double, col 10:double) -> 53:double) -> 54:double) -> 55:double) -> 56:double) -> 57:double, DoubleColDivideLongColumn(col 60:double, col 63:bigint)(children: DoubleColSubtractDoubleColumn(col 9:double, col 59:double)(children: DoubleColDivideLongColumn(col 58:double, col 11:bigint)(children: DoubleColMultiplyDoubleColumn(col 10:double, col 10:double) -> 58:double) -> 59:double) -> 60:double, IfExprNullCondExpr(col 61:boolean, null, col 62:bigint)(children: LongColEqualLongScalar(col 11:bigint, val 1) -> 61:boolean, LongColSubtractLongScalar(col 11:bigint, val 1) -> 62:bigint) -> 63:bigint) -> 64:double, DoubleColUnaryMinus(col 65:double)(children: DoubleColSubtractDoubleColumn(col 1:double, col 2:double)(children: col 1:float) -> 65:double) -> 66:double
+                      projectedOutputColumnNums: [3, 1, 0, 4, 2, 13, 15, 24, 25, 8, 26, 27, 30, 35, 12, 39, 49, 50, 54, 59, 66, 68]
+                      selectExpressions: DoubleScalarAddDoubleColumn(val -26.28, col 2:double) -> 13:double, DoubleColUnaryMinus(col 14:double)(children: DoubleScalarAddDoubleColumn(val -26.28, col 2:double) -> 14:double) -> 15:double, FuncPowerDoubleToDouble(col 23:double)(children: DoubleColDivideLongColumn(col 19:double, col 22:bigint)(children: VectorUDFAdaptor(greatest(0,(_col5 - ((_col6 * _col6) / _col7))))(children: DoubleColSubtractDoubleColumn(col 5:double, col 17:double)(children: DoubleColDivideLongColumn(col 16:double, col 7:bigint)(children: DoubleColMultiplyDoubleColumn(col 6:double, col 6:double) -> 16:double) -> 17:double) -> 18:double) -> 19:double, IfExprNullCondExpr(col 20:boolean, null, col 21:bigint)(children: LongColEqualLongScalar(col 7:bigint, val 1) -> 20:boolean, LongColSubtractLongScalar(col 7:bigint, val 1) -> 21:bigint) -> 22:bigint) -> 23:double) -> 24:double, DoubleColMultiplyDoubleScalar(col 1:float, val -26.280000686645508) -> 25:float, DoubleColUnaryMinus(col 1:float) -> 26:float, DoubleColUnaryMinus(col 8:float) -> 27:float, DoubleColDivideDoubleScalar(col 29:double, val 10.175)(children: DoubleColUnaryMinus(col 28:double)(children: DoubleScalarAddDoubleColumn(val -26.28, col 2:double) -> 28:double) -> 29:double) -> 30:double, FuncPowerDoubleToDouble(col 34:double)(children: DoubleColDivideLongColumn(col 33:double, col 11:bigint)(children: DoubleColSubtractDoubleColumn(col 9:double, col 32:double)(children: DoubleColDivideLongColumn(col 31:double, col 11:bigint)(children: DoubleColMultiplyDoubleColumn(col 10:double, col 10:double) -> 31:double) -> 32:double) -> 33:double) -> 34:double) -> 35:double, DoubleColUnaryMinus(col 38:double)(children: DoubleColDivideDoubleScalar(col 37:double, val 10.175)(children: DoubleColUnaryMinus(col 36:double)(children: DoubleScalarAddDoubleColumn(val -26.28, col 2:double) -> 36:double) -> 37:double) -> 38:double) -> 39:double, DoubleScalarModuloDoubleColumn(val -1.389, col 48:double)(children: FuncPowerDoubleToDouble(col 47:double)(children: DoubleColDivideLongColumn(col 43:double, col 46:bigint)(children: VectorUDFAdaptor(greatest(0,(_col5 - ((_col6 * _col6) / _col7))))(children: DoubleColSubtractDoubleColumn(col 5:double, col 41:double)(children: DoubleColDivideLongColumn(col 40:double, col 7:bigint)(children: DoubleColMultiplyDoubleColumn(col 6:double, col 6:double) -> 40:double) -> 41:double) -> 42:double) -> 43:double, IfExprNullCondExpr(col 44:boolean, null, col 45:bigint)(children: LongColEqualLongScalar(col 7:bigint, val 1) -> 44:boolean, LongColSubtractLongScalar(col 7:bigint, val 1) -> 45:bigint) -> 46:bigint) -> 47:double) -> 48:double) -> 49:double, DoubleColSubtractDoubleColumn(col 1:double, col 2:double)(children: col 1:float) -> 50:double, DoubleColDivideLongColumn(col 53:double, col 11:bigint)(children: DoubleColSubtractDoubleColumn(col 9:double, col 52:double)(children: DoubleColDivideLongColumn(col 51:double, col 11:bigint)(children: DoubleColMultiplyDoubleColumn(col 10:double, col 10:double) -> 51:double) -> 52:double) -> 53:double) -> 54:double, DoubleColModuloDoubleScalar(col 58:double, val 10.175)(children: DoubleColDivideLongColumn(col 57:double, col 11:bigint)(children: DoubleColSubtractDoubleColumn(col 9:double, col 56:double)(children: DoubleColDivideLongColumn(col 55:double, col 11:bigint)(children: DoubleColMultiplyDoubleColumn(col 10:double, col 10:double) -> 55:double) -> 56:double) -> 57:double) -> 58:double) -> 59:double, DoubleColDivideLongColumn(col 62:double, col 65:bigint)(children: DoubleColSubtractDoubleColumn(col 9:double, col 61:double)(children: DoubleColDivideLongColumn(col 60:double, col 11:bigint)(children: DoubleColMultiplyDoubleColumn(col 10:double, col 10:double) -> 60:double) -> 61:double) -> 62:double, IfExprNullCondExpr(col 63:boolean, null, col 64:bigint)(children: LongColEqualLongScalar(col 11:bigint, val 1) -> 63:boolean, LongColSubtractLongScalar(col 11:bigint, val 1) -> 64:bigint) -> 65:bigint) -> 66:double, DoubleColUnaryMinus(col 67:double)(children: DoubleColSubtractDoubleColumn(col 1:double, col 2:double)(children: col 1:float) -> 67:double) -> 68:double
                   Statistics: Num rows: 758 Data size: 176010 Basic stats: COMPLETE Column stats: COMPLETE
                   Reduce Output Operator
                     key expressions: _col2 (type: string), _col1 (type: float), _col4 (type: double), _col0 (type: timestamp)
diff --git a/ql/src/test/results/clientpositive/llap/parquet_vectorization_16.q.out b/ql/src/test/results/clientpositive/llap/parquet_vectorization_16.q.out
index c5f8c25398..eeab9c89af 100644
--- a/ql/src/test/results/clientpositive/llap/parquet_vectorization_16.q.out
+++ b/ql/src/test/results/clientpositive/llap/parquet_vectorization_16.q.out
@@ -125,7 +125,7 @@ STAGE PLANS:
                 enabled: true
                 enableConditionsMet: hive.vectorized.execution.reduce.enabled IS true, hive.execution.engine tez IN [tez] IS true
                 allNative: false
-                usesVectorUDFAdaptor: false
+                usesVectorUDFAdaptor: true
                 vectorized: true
             Reduce Operator Tree:
               Group By Operator
@@ -143,13 +143,13 @@ STAGE PLANS:
                 outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                 Statistics: Num rows: 5979 Data size: 825318 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
-                  expressions: _col0 (type: string), _col1 (type: double), _col2 (type: timestamp), (_col1 - 9763215.5639D) (type: double), (- (_col1 - 9763215.5639D)) (type: double), _col3 (type: bigint), power(((_col4 - ((_col5 * _col5) / _col3)) / if((_col3 = 1L), null, (_col3 - 1))), 0.5) (type: double), (- power(((_col4 - ((_col5 * _col5) / _col3)) / if((_col3 = 1L), null, (_col3 - 1))), 0.5)) (type: double), (power(((_col4 - ((_col5 * _col5) / _col3)) / if((_col3 = 1L), null, (_col3 - 1))), 0.5) * UDFToDouble(_col3)) (type: double), _col6 (type: double), (9763215.5639D / _col1) (type: double), (CAST( _col3 AS decimal(19,0)) / -1.389) (type: decimal(28,6)), power(((_col4 - ((_col5 * _col5) / _col3)) / if((_col3 = 1L), null, (_col3 - 1))), 0.5) (type: double)
+                  expressions: _col0 (type: string), _col1 (type: double), _col2 (type: timestamp), (_col1 - 9763215.5639D) (type: double), (- (_col1 - 9763215.5639D)) (type: double), _col3 (type: bigint), power((greatest(0,(_col4 - ((_col5 * _col5) / _col3))) / if((_col3 = 1L), null, (_col3 - 1))), 0.5) (type: double), (- power((greatest(0,(_col4 - ((_col5 * _col5) / _col3))) / if((_col3 = 1L), null, (_col3 - 1))), 0.5)) (type: double), (power((greatest(0,(_col4 - ((_col5 * _col5) / _col3))) / if((_col3 = 1L), null, (_col3 - 1))), 0.5) * UDFToDouble(_col3)) (type: double), _col6 (type: double), (9763215.5639D / _col1) (type: double), (CAST( _col3 AS decimal(19,0)) / -1.389) (type: decimal(28,6)), power((greatest(0,(_col4 - ((_col5 * _col5) / _col3))) / if((_col3 = 1L), null, (_col3 - 1))), 0.5) (type: double)
                   outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12
                   Select Vectorization:
                       className: VectorSelectOperator
                       native: true
-                      projectedOutputColumnNums: [0, 1, 2, 7, 9, 3, 17, 26, 36, 6, 37, 39, 47]
-                      selectExpressions: DoubleColSubtractDoubleScalar(col 1:double, val 9763215.5639) -> 7:double, DoubleColUnaryMinus(col 8:double)(children: DoubleColSubtractDoubleScalar(col 1:double, val 9763215.5639) -> 8:double) -> 9:double, FuncPowerDoubleToDouble(col 16:double)(children: DoubleColDivideLongColumn(col 12:double, col 15:bigint)(children: DoubleColSubtractDoubleColumn(col 4:double, col 11:double)(children: DoubleColDivideLongColumn(col 10:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 5:double, col 5:double) -> 10:double) -> 11:double) -> 12:double, IfExprNullCondExpr(col 13:boolean, null, col 14:bigint)(children: LongColEqualLongScalar(col 3:bigint, val 1) -> 13:boolean, LongColSubtractLongScalar(col 3:bigint, val 1) -> 14:bigint) -> 15:bigint) -> 16:double) -> 17:double, DoubleColUnaryMinus(col 25:double)(children: FuncPowerDoubleToDouble(col 24:double)(children: DoubleColDivideLongColumn(col 20:double, col 23:bigint)(children: DoubleColSubtractDoubleColumn(col 4:double, col 19:double)(children: DoubleColDivideLongColumn(col 18:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 5:double, col 5:double) -> 18:double) -> 19:double) -> 20:double, IfExprNullCondExpr(col 21:boolean, null, col 22:bigint)(children: LongColEqualLongScalar(col 3:bigint, val 1) -> 21:boolean, LongColSubtractLongScalar(col 3:bigint, val 1) -> 22:bigint) -> 23:bigint) -> 24:double) -> 25:double) -> 26:double, DoubleColMultiplyDoubleColumn(col 34:double, col 35:double)(children: FuncPowerDoubleToDouble(col 33:double)(children: DoubleColDivideLongColumn(col 29:double, col 32:bigint)(children: DoubleColSubtractDoubleColumn(col 4:double, col 28:double)(children: DoubleColDivideLongColumn(col 27:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 5:double, col 5:double) -> 27:double) -> 28:double) -> 29:double, IfExprNullCondExpr(col 30:boolean, null, col 31:bigint)(children: LongColEqualLongScalar(col 3:bigint, val 1) -> 30:boolean, LongColSubtractLongScalar(col 3:bigint, val 1) -> 31:bigint) -> 32:bigint) -> 33:double) -> 34:double, CastLongToDouble(col 3:bigint) -> 35:double) -> 36:double, DoubleScalarDivideDoubleColumn(val 9763215.5639, col 1:double) -> 37:double, DecimalColDivideDecimalScalar(col 38:decimal(19,0), val -1.389)(children: CastLongToDecimal(col 3:bigint) -> 38:decimal(19,0)) -> 39:decimal(28,6), FuncPowerDoubleToDouble(col 46:double)(children: DoubleColDivideLongColumn(col 42:double, col 45:bigint)(children: DoubleColSubtractDoubleColumn(col 4:double, col 41:double)(children: DoubleColDivideLongColumn(col 40:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 5:double, col 5:double) -> 40:double) -> 41:double) -> 42:double, IfExprNullCondExpr(col 43:boolean, null, col 44:bigint)(children: LongColEqualLongScalar(col 3:bigint, val 1) -> 43:boolean, LongColSubtractLongScalar(col 3:bigint, val 1) -> 44:bigint) -> 45:bigint) -> 46:double) -> 47:double
+                      projectedOutputColumnNums: [0, 1, 2, 7, 9, 3, 18, 28, 39, 6, 40, 42, 51]
+                      selectExpressions: DoubleColSubtractDoubleScalar(col 1:double, val 9763215.5639) -> 7:double, DoubleColUnaryMinus(col 8:double)(children: DoubleColSubtractDoubleScalar(col 1:double, val 9763215.5639) -> 8:double) -> 9:double, FuncPowerDoubleToDouble(col 17:double)(children: DoubleColDivideLongColumn(col 13:double, col 16:bigint)(children: VectorUDFAdaptor(greatest(0,(_col4 - ((_col5 * _col5) / _col3))))(children: DoubleColSubtractDoubleColumn(col 4:double, col 11:double)(children: DoubleColDivideLongColumn(col 10:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 5:double, col 5:double) -> 10:double) -> 11:double) -> 12:double) -> 13:double, IfExprNullCondExpr(col 14:boolean, null, col 15:bigint)(children: LongColEqualLongScalar(col 3:bigint, val 1) -> 14:boolean, LongColSubtractLongScalar(col 3:bigint, val 1) -> 15:bigint) -> 16:bigint) -> 17:double) -> 18:double, DoubleColUnaryMinus(col 27:double)(children: FuncPowerDoubleToDouble(col 26:double)(children: DoubleColDivideLongColumn(col 22:double, col 25:bigint)(children: VectorUDFAdaptor(greatest(0,(_col4 - ((_col5 * _col5) / _col3))))(children: DoubleColSubtractDoubleColumn(col 4:double, col 20:double)(children: DoubleColDivideLongColumn(col 19:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 5:double, col 5:double) -> 19:double) -> 20:double) -> 21:double) -> 22:double, IfExprNullCondExpr(col 23:boolean, null, col 24:bigint)(children: LongColEqualLongScalar(col 3:bigint, val 1) -> 23:boolean, LongColSubtractLongScalar(col 3:bigint, val 1) -> 24:bigint) -> 25:bigint) -> 26:double) -> 27:double) -> 28:double, DoubleColMultiplyDoubleColumn(col 37:double, col 38:double)(children: FuncPowerDoubleToDouble(col 36:double)(children: DoubleColDivideLongColumn(col 32:double, col 35:bigint)(children: VectorUDFAdaptor(greatest(0,(_col4 - ((_col5 * _col5) / _col3))))(children: DoubleColSubtractDoubleColumn(col 4:double, col 30:double)(children: DoubleColDivideLongColumn(col 29:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 5:double, col 5:double) -> 29:double) -> 30:double) -> 31:double) -> 32:double, IfExprNullCondExpr(col 33:boolean, null, col 34:bigint)(children: LongColEqualLongScalar(col 3:bigint, val 1) -> 33:boolean, LongColSubtractLongScalar(col 3:bigint, val 1) -> 34:bigint) -> 35:bigint) -> 36:double) -> 37:double, CastLongToDouble(col 3:bigint) -> 38:double) -> 39:double, DoubleScalarDivideDoubleColumn(val 9763215.5639, col 1:double) -> 40:double, DecimalColDivideDecimalScalar(col 41:decimal(19,0), val -1.389)(children: CastLongToDecimal(col 3:bigint) -> 41:decimal(19,0)) -> 42:decimal(28,6), FuncPowerDoubleToDouble(col 50:double)(children: DoubleColDivideLongColumn(col 46:double, col 49:bigint)(children: VectorUDFAdaptor(greatest(0,(_col4 - ((_col5 * _col5) / _col3))))(children: DoubleColSubtractDoubleColumn(col 4:double, col 44:double)(children: DoubleColDivideLongColumn(col 43:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 5:double, col 5:double) -> 43:double) -> 44:double) -> 45:double) -> 46:double, IfExprNullCondExpr(col 47:boolean, null, col 48:bigint)(children: LongColEqualLongScalar(col 3:bigint, val 1) -> 47:boolean, LongColSubtractLongScalar(col 3:bigint, val 1) -> 48:bigint) -> 49:bigint) -> 50:double) -> 51:double
                   Statistics: Num rows: 5979 Data size: 1734126 Basic stats: COMPLETE Column stats: COMPLETE
                   File Output Operator
                     compressed: false
diff --git a/ql/src/test/results/clientpositive/llap/parquet_vectorization_4.q.out b/ql/src/test/results/clientpositive/llap/parquet_vectorization_4.q.out
index e5e641105b..aecd787c79 100644
--- a/ql/src/test/results/clientpositive/llap/parquet_vectorization_4.q.out
+++ b/ql/src/test/results/clientpositive/llap/parquet_vectorization_4.q.out
@@ -127,7 +127,7 @@ STAGE PLANS:
                 enabled: true
                 enableConditionsMet: hive.vectorized.execution.reduce.enabled IS true, hive.execution.engine tez IN [tez] IS true
                 allNative: false
-                usesVectorUDFAdaptor: false
+                usesVectorUDFAdaptor: true
                 vectorized: true
             Reduce Operator Tree:
               Group By Operator
@@ -143,13 +143,13 @@ STAGE PLANS:
                 outputColumnNames: _col0, _col1, _col2, _col3, _col4
                 Statistics: Num rows: 1 Data size: 36 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
-                  expressions: _col0 (type: bigint), (_col0 * -563L) (type: bigint), (-3728L + _col0) (type: bigint), power(((_col1 - ((_col2 * _col2) / _col3)) / _col3), 0.5) (type: double), (- power(((_col1 - ((_col2 * _col2) / _col3)) / _col3), 0.5)) (type: double), (_col2 / _col3) (type: double), ((_col0 * -563L) % _col0) (type: bigint), (UDFToDouble(((_col0 * -563L) % _col0)) / (_col2 / _col3)) (type: double), ((_col1 - ((_col2 * _col2) / _col3)) / _col3) (type: double), (- (UDFToDouble(((_col0 * -563L) % _col0)) / (_col2 / _col3))) (type: double), ((-3728L + _col0) - (_col0 * -563L)) (type: bigint), _col4 (type: tinyint), _col4 (type: tinyint), (UDFToDouble(_col4) * (- (UDFToDouble(((_col0 * -563L) % _col0)) / (_col2 / _col3)))) (type: double)
+                  expressions: _col0 (type: bigint), (_col0 * -563L) (type: bigint), (-3728L + _col0) (type: bigint), power((greatest(0,(_col1 - ((_col2 * _col2) / _col3))) / _col3), 0.5) (type: double), (- power((greatest(0,(_col1 - ((_col2 * _col2) / _col3))) / _col3), 0.5)) (type: double), (_col2 / _col3) (type: double), ((_col0 * -563L) % _col0) (type: bigint), (UDFToDouble(((_col0 * -563L) % _col0)) / (_col2 / _col3)) (type: double), (greatest(0,(_col1 - ((_col2 * _col2) / _col3))) / _col3) (type: double), (- (UDFToDouble(((_col0 * -563L) % _col0)) / (_col2 / _col3))) (type: double), ((-3728L + _col0) - (_col0 * -563L)) (type: bigint), _col4 (type: tinyint), _col4 (type: tinyint), (UDFToDouble(_col4) * (- (UDFToDouble(((_col0 * -563L) % _col0)) / (_col2 / _col3)))) (type: double)
                   outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13
                   Select Vectorization:
                       className: VectorSelectOperator
                       native: true
-                      projectedOutputColumnNums: [0, 5, 6, 11, 17, 18, 20, 25, 29, 35, 38, 4, 4, 46]
-                      selectExpressions: LongColMultiplyLongScalar(col 0:bigint, val -563) -> 5:bigint, LongScalarAddLongColumn(val -3728, col 0:bigint) -> 6:bigint, FuncPowerDoubleToDouble(col 10:double)(children: DoubleColDivideLongColumn(col 9:double, col 3:bigint)(children: DoubleColSubtractDoubleColumn(col 1:double, col 8:double)(children: DoubleColDivideLongColumn(col 7:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 2:double, col 2:double) -> 7:double) -> 8:double) -> 9:double) -> 10:double) -> 11:double, DoubleColUnaryMinus(col 16:double)(children: FuncPowerDoubleToDouble(col 15:double)(children: DoubleColDivideLongColumn(col 14:double, col 3:bigint)(children: DoubleColSubtractDoubleColumn(col 1:double, col 13:double)(children: DoubleColDivideLongColumn(col 12:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 2:double, col 2:double) -> 12:double) -> 13:double) -> 14:double) -> 15:double) -> 16:double) -> 17:double, DoubleColDivideLongColumn(col 2:double, col 3:bigint) -> 18:double, LongColModuloLongColumn(col 19:bigint, col 0:bigint)(children: LongColMultiplyLongScalar(col 0:bigint, val -563) -> 19:bigint) -> 20:bigint, DoubleColDivideDoubleColumn(col 23:double, col 24:double)(children: CastLongToDouble(col 22:bigint)(children: LongColModuloLongColumn(col 21:bigint, col 0:bigint)(children: LongColMultiplyLongScalar(col 0:bigint, val -563) -> 21:bigint) -> 22:bigint) -> 23:double, DoubleColDivideLongColumn(col 2:double, col 3:bigint) -> 24:double) -> 25:double, DoubleColDivideLongColumn(col 28:double, col 3:bigint)(children: DoubleColSubtractDoubleColumn(col 1:double, col 27:double)(children: DoubleColDivideLongColumn(col 26:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 2:double, col 2:double) -> 26:double) -> 27:double) -> 28:double) -> 29:double, DoubleColUnaryMinus(col 34:double)(children: DoubleColDivideDoubleColumn(col 32:double, col 33:double)(children: CastLongToDouble(col 31:bigint)(children: LongColModuloLongColumn(col 30:bigint, col 0:bigint)(children: LongColMultiplyLongScalar(col 0:bigint, val -563) -> 30:bigint) -> 31:bigint) -> 32:double, DoubleColDivideLongColumn(col 2:double, col 3:bigint) -> 33:double) -> 34:double) -> 35:double, LongColSubtractLongColumn(col 36:bigint, col 37:bigint)(children: LongScalarAddLongColumn(val -3728, col 0:bigint) -> 36:bigint, LongColMultiplyLongScalar(col 0:bigint, val -563) -> 37:bigint) -> 38:bigint, DoubleColMultiplyDoubleColumn(col 39:double, col 45:double)(children: CastLongToDouble(col 4:tinyint) -> 39:double, DoubleColUnaryMinus(col 44:double)(children: DoubleColDivideDoubleColumn(col 42:double, col 43:double)(children: CastLongToDouble(col 41:bigint)(children: LongColModuloLongColumn(col 40:bigint, col 0:bigint)(children: LongColMultiplyLongScalar(col 0:bigint, val -563) -> 40:bigint) -> 41:bigint) -> 42:double, DoubleColDivideLongColumn(col 2:double, col 3:bigint) -> 43:double) -> 44:double) -> 45:double) -> 46:double
+                      projectedOutputColumnNums: [0, 5, 6, 12, 19, 20, 22, 27, 32, 38, 41, 4, 4, 49]
+                      selectExpressions: LongColMultiplyLongScalar(col 0:bigint, val -563) -> 5:bigint, LongScalarAddLongColumn(val -3728, col 0:bigint) -> 6:bigint, FuncPowerDoubleToDouble(col 11:double)(children: DoubleColDivideLongColumn(col 10:double, col 3:bigint)(children: VectorUDFAdaptor(greatest(0,(_col1 - ((_col2 * _col2) / _col3))))(children: DoubleColSubtractDoubleColumn(col 1:double, col 8:double)(children: DoubleColDivideLongColumn(col 7:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 2:double, col 2:double) -> 7:double) -> 8:double) -> 9:double) -> 10:double) -> 11:double) -> 12:double, DoubleColUnaryMinus(col 18:double)(children: FuncPowerDoubleToDouble(col 17:double)(children: DoubleColDivideLongColumn(col 16:double, col 3:bigint)(children: VectorUDFAdaptor(greatest(0,(_col1 - ((_col2 * _col2) / _col3))))(children: DoubleColSubtractDoubleColumn(col 1:double, col 14:double)(children: DoubleColDivideLongColumn(col 13:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 2:double, col 2:double) -> 13:double) -> 14:double) -> 15:double) -> 16:double) -> 17:double) -> 18:double) -> 19:double, DoubleColDivideLongColumn(col 2:double, col 3:bigint) -> 20:double, LongColModuloLongColumn(col 21:bigint, col 0:bigint)(children: LongColMultiplyLongScalar(col 0:bigint, val -563) -> 21:bigint) -> 22:bigint, DoubleColDivideDoubleColumn(col 25:double, col 26:double)(children: CastLongToDouble(col 24:bigint)(children: LongColModuloLongColumn(col 23:bigint, col 0:bigint)(children: LongColMultiplyLongScalar(col 0:bigint, val -563) -> 23:bigint) -> 24:bigint) -> 25:double, DoubleColDivideLongColumn(col 2:double, col 3:bigint) -> 26:double) -> 27:double, DoubleColDivideLongColumn(col 31:double, col 3:bigint)(children: VectorUDFAdaptor(greatest(0,(_col1 - ((_col2 * _col2) / _col3))))(children: DoubleColSubtractDoubleColumn(col 1:double, col 29:double)(children: DoubleColDivideLongColumn(col 28:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 2:double, col 2:double) -> 28:double) -> 29:double) -> 30:double) -> 31:double) -> 32:double, DoubleColUnaryMinus(col 37:double)(children: DoubleColDivideDoubleColumn(col 35:double, col 36:double)(children: CastLongToDouble(col 34:bigint)(children: LongColModuloLongColumn(col 33:bigint, col 0:bigint)(children: LongColMultiplyLongScalar(col 0:bigint, val -563) -> 33:bigint) -> 34:bigint) -> 35:double, DoubleColDivideLongColumn(col 2:double, col 3:bigint) -> 36:double) -> 37:double) -> 38:double, LongColSubtractLongColumn(col 39:bigint, col 40:bigint)(children: LongScalarAddLongColumn(val -3728, col 0:bigint) -> 39:bigint, LongColMultiplyLongScalar(col 0:bigint, val -563) -> 40:bigint) -> 41:bigint, DoubleColMultiplyDoubleColumn(col 42:double, col 48:double)(children: CastLongToDouble(col 4:tinyint) -> 42:double, DoubleColUnaryMinus(col 47:double)(children: DoubleColDivideDoubleColumn(col 45:double, col 46:double)(children: CastLongToDouble(col 44:bigint)(children: LongColModuloLongColumn(col 43:bigint, col 0:bigint)(children: LongColMultiplyLongScalar(col 0:bigint, val -563) -> 43:bigint) -> 44:bigint) -> 45:double, DoubleColDivideLongColumn(col 2:double, col 3:bigint) -> 46:double) -> 47:double) -> 48:double) -> 49:double
                   Statistics: Num rows: 1 Data size: 104 Basic stats: COMPLETE Column stats: COMPLETE
                   File Output Operator
                     compressed: false
diff --git a/ql/src/test/results/clientpositive/llap/parquet_vectorization_9.q.out b/ql/src/test/results/clientpositive/llap/parquet_vectorization_9.q.out
index c5f8c25398..eeab9c89af 100644
--- a/ql/src/test/results/clientpositive/llap/parquet_vectorization_9.q.out
+++ b/ql/src/test/results/clientpositive/llap/parquet_vectorization_9.q.out
@@ -125,7 +125,7 @@ STAGE PLANS:
                 enabled: true
                 enableConditionsMet: hive.vectorized.execution.reduce.enabled IS true, hive.execution.engine tez IN [tez] IS true
                 allNative: false
-                usesVectorUDFAdaptor: false
+                usesVectorUDFAdaptor: true
                 vectorized: true
             Reduce Operator Tree:
               Group By Operator
@@ -143,13 +143,13 @@ STAGE PLANS:
                 outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                 Statistics: Num rows: 5979 Data size: 825318 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
-                  expressions: _col0 (type: string), _col1 (type: double), _col2 (type: timestamp), (_col1 - 9763215.5639D) (type: double), (- (_col1 - 9763215.5639D)) (type: double), _col3 (type: bigint), power(((_col4 - ((_col5 * _col5) / _col3)) / if((_col3 = 1L), null, (_col3 - 1))), 0.5) (type: double), (- power(((_col4 - ((_col5 * _col5) / _col3)) / if((_col3 = 1L), null, (_col3 - 1))), 0.5)) (type: double), (power(((_col4 - ((_col5 * _col5) / _col3)) / if((_col3 = 1L), null, (_col3 - 1))), 0.5) * UDFToDouble(_col3)) (type: double), _col6 (type: double), (9763215.5639D / _col1) (type: double), (CAST( _col3 AS decimal(19,0)) / -1.389) (type: decimal(28,6)), power(((_col4 - ((_col5 * _col5) / _col3)) / if((_col3 = 1L), null, (_col3 - 1))), 0.5) (type: double)
+                  expressions: _col0 (type: string), _col1 (type: double), _col2 (type: timestamp), (_col1 - 9763215.5639D) (type: double), (- (_col1 - 9763215.5639D)) (type: double), _col3 (type: bigint), power((greatest(0,(_col4 - ((_col5 * _col5) / _col3))) / if((_col3 = 1L), null, (_col3 - 1))), 0.5) (type: double), (- power((greatest(0,(_col4 - ((_col5 * _col5) / _col3))) / if((_col3 = 1L), null, (_col3 - 1))), 0.5)) (type: double), (power((greatest(0,(_col4 - ((_col5 * _col5) / _col3))) / if((_col3 = 1L), null, (_col3 - 1))), 0.5) * UDFToDouble(_col3)) (type: double), _col6 (type: double), (9763215.5639D / _col1) (type: double), (CAST( _col3 AS decimal(19,0)) / -1.389) (type: decimal(28,6)), power((greatest(0,(_col4 - ((_col5 * _col5) / _col3))) / if((_col3 = 1L), null, (_col3 - 1))), 0.5) (type: double)
                   outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12
                   Select Vectorization:
                       className: VectorSelectOperator
                       native: true
-                      projectedOutputColumnNums: [0, 1, 2, 7, 9, 3, 17, 26, 36, 6, 37, 39, 47]
-                      selectExpressions: DoubleColSubtractDoubleScalar(col 1:double, val 9763215.5639) -> 7:double, DoubleColUnaryMinus(col 8:double)(children: DoubleColSubtractDoubleScalar(col 1:double, val 9763215.5639) -> 8:double) -> 9:double, FuncPowerDoubleToDouble(col 16:double)(children: DoubleColDivideLongColumn(col 12:double, col 15:bigint)(children: DoubleColSubtractDoubleColumn(col 4:double, col 11:double)(children: DoubleColDivideLongColumn(col 10:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 5:double, col 5:double) -> 10:double) -> 11:double) -> 12:double, IfExprNullCondExpr(col 13:boolean, null, col 14:bigint)(children: LongColEqualLongScalar(col 3:bigint, val 1) -> 13:boolean, LongColSubtractLongScalar(col 3:bigint, val 1) -> 14:bigint) -> 15:bigint) -> 16:double) -> 17:double, DoubleColUnaryMinus(col 25:double)(children: FuncPowerDoubleToDouble(col 24:double)(children: DoubleColDivideLongColumn(col 20:double, col 23:bigint)(children: DoubleColSubtractDoubleColumn(col 4:double, col 19:double)(children: DoubleColDivideLongColumn(col 18:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 5:double, col 5:double) -> 18:double) -> 19:double) -> 20:double, IfExprNullCondExpr(col 21:boolean, null, col 22:bigint)(children: LongColEqualLongScalar(col 3:bigint, val 1) -> 21:boolean, LongColSubtractLongScalar(col 3:bigint, val 1) -> 22:bigint) -> 23:bigint) -> 24:double) -> 25:double) -> 26:double, DoubleColMultiplyDoubleColumn(col 34:double, col 35:double)(children: FuncPowerDoubleToDouble(col 33:double)(children: DoubleColDivideLongColumn(col 29:double, col 32:bigint)(children: DoubleColSubtractDoubleColumn(col 4:double, col 28:double)(children: DoubleColDivideLongColumn(col 27:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 5:double, col 5:double) -> 27:double) -> 28:double) -> 29:double, IfExprNullCondExpr(col 30:boolean, null, col 31:bigint)(children: LongColEqualLongScalar(col 3:bigint, val 1) -> 30:boolean, LongColSubtractLongScalar(col 3:bigint, val 1) -> 31:bigint) -> 32:bigint) -> 33:double) -> 34:double, CastLongToDouble(col 3:bigint) -> 35:double) -> 36:double, DoubleScalarDivideDoubleColumn(val 9763215.5639, col 1:double) -> 37:double, DecimalColDivideDecimalScalar(col 38:decimal(19,0), val -1.389)(children: CastLongToDecimal(col 3:bigint) -> 38:decimal(19,0)) -> 39:decimal(28,6), FuncPowerDoubleToDouble(col 46:double)(children: DoubleColDivideLongColumn(col 42:double, col 45:bigint)(children: DoubleColSubtractDoubleColumn(col 4:double, col 41:double)(children: DoubleColDivideLongColumn(col 40:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 5:double, col 5:double) -> 40:double) -> 41:double) -> 42:double, IfExprNullCondExpr(col 43:boolean, null, col 44:bigint)(children: LongColEqualLongScalar(col 3:bigint, val 1) -> 43:boolean, LongColSubtractLongScalar(col 3:bigint, val 1) -> 44:bigint) -> 45:bigint) -> 46:double) -> 47:double
+                      projectedOutputColumnNums: [0, 1, 2, 7, 9, 3, 18, 28, 39, 6, 40, 42, 51]
+                      selectExpressions: DoubleColSubtractDoubleScalar(col 1:double, val 9763215.5639) -> 7:double, DoubleColUnaryMinus(col 8:double)(children: DoubleColSubtractDoubleScalar(col 1:double, val 9763215.5639) -> 8:double) -> 9:double, FuncPowerDoubleToDouble(col 17:double)(children: DoubleColDivideLongColumn(col 13:double, col 16:bigint)(children: VectorUDFAdaptor(greatest(0,(_col4 - ((_col5 * _col5) / _col3))))(children: DoubleColSubtractDoubleColumn(col 4:double, col 11:double)(children: DoubleColDivideLongColumn(col 10:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 5:double, col 5:double) -> 10:double) -> 11:double) -> 12:double) -> 13:double, IfExprNullCondExpr(col 14:boolean, null, col 15:bigint)(children: LongColEqualLongScalar(col 3:bigint, val 1) -> 14:boolean, LongColSubtractLongScalar(col 3:bigint, val 1) -> 15:bigint) -> 16:bigint) -> 17:double) -> 18:double, DoubleColUnaryMinus(col 27:double)(children: FuncPowerDoubleToDouble(col 26:double)(children: DoubleColDivideLongColumn(col 22:double, col 25:bigint)(children: VectorUDFAdaptor(greatest(0,(_col4 - ((_col5 * _col5) / _col3))))(children: DoubleColSubtractDoubleColumn(col 4:double, col 20:double)(children: DoubleColDivideLongColumn(col 19:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 5:double, col 5:double) -> 19:double) -> 20:double) -> 21:double) -> 22:double, IfExprNullCondExpr(col 23:boolean, null, col 24:bigint)(children: LongColEqualLongScalar(col 3:bigint, val 1) -> 23:boolean, LongColSubtractLongScalar(col 3:bigint, val 1) -> 24:bigint) -> 25:bigint) -> 26:double) -> 27:double) -> 28:double, DoubleColMultiplyDoubleColumn(col 37:double, col 38:double)(children: FuncPowerDoubleToDouble(col 36:double)(children: DoubleColDivideLongColumn(col 32:double, col 35:bigint)(children: VectorUDFAdaptor(greatest(0,(_col4 - ((_col5 * _col5) / _col3))))(children: DoubleColSubtractDoubleColumn(col 4:double, col 30:double)(children: DoubleColDivideLongColumn(col 29:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 5:double, col 5:double) -> 29:double) -> 30:double) -> 31:double) -> 32:double, IfExprNullCondExpr(col 33:boolean, null, col 34:bigint)(children: LongColEqualLongScalar(col 3:bigint, val 1) -> 33:boolean, LongColSubtractLongScalar(col 3:bigint, val 1) -> 34:bigint) -> 35:bigint) -> 36:double) -> 37:double, CastLongToDouble(col 3:bigint) -> 38:double) -> 39:double, DoubleScalarDivideDoubleColumn(val 9763215.5639, col 1:double) -> 40:double, DecimalColDivideDecimalScalar(col 41:decimal(19,0), val -1.389)(children: CastLongToDecimal(col 3:bigint) -> 41:decimal(19,0)) -> 42:decimal(28,6), FuncPowerDoubleToDouble(col 50:double)(children: DoubleColDivideLongColumn(col 46:double, col 49:bigint)(children: VectorUDFAdaptor(greatest(0,(_col4 - ((_col5 * _col5) / _col3))))(children: DoubleColSubtractDoubleColumn(col 4:double, col 44:double)(children: DoubleColDivideLongColumn(col 43:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 5:double, col 5:double) -> 43:double) -> 44:double) -> 45:double) -> 46:double, IfExprNullCondExpr(col 47:boolean, null, col 48:bigint)(children: LongColEqualLongScalar(col 3:bigint, val 1) -> 47:boolean, LongColSubtractLongScalar(col 3:bigint, val 1) -> 48:bigint) -> 49:bigint) -> 50:double) -> 51:double
                   Statistics: Num rows: 5979 Data size: 1734126 Basic stats: COMPLETE Column stats: COMPLETE
                   File Output Operator
                     compressed: false
diff --git a/ql/src/test/results/clientpositive/llap/stddev_variance_with_double_decimal_test.q.out b/ql/src/test/results/clientpositive/llap/stddev_variance_with_double_decimal_test.q.out
new file mode 100644
index 0000000000..bf15193825
--- /dev/null
+++ b/ql/src/test/results/clientpositive/llap/stddev_variance_with_double_decimal_test.q.out
@@ -0,0 +1,209 @@
+PREHOOK: query: with tempDataset as (
+select 10 as account_id, cast(23.79 as double) interest_paid
+union all select 10, 23.79
+union all select 10, 23.79
+union all select 11, 64.34
+union all select 11, 64.34
+union all select 11, 64.34
+)
+select account_id, STDDEV(interest_paid) as sdev, variance(interest_paid) as vari from tempDataset group by account_id
+PREHOOK: type: QUERY
+PREHOOK: Input: _dummy_database@_dummy_table
+#### A masked pattern was here ####
+POSTHOOK: query: with tempDataset as (
+select 10 as account_id, cast(23.79 as double) interest_paid
+union all select 10, 23.79
+union all select 10, 23.79
+union all select 11, 64.34
+union all select 11, 64.34
+union all select 11, 64.34
+)
+select account_id, STDDEV(interest_paid) as sdev, variance(interest_paid) as vari from tempDataset group by account_id
+POSTHOOK: type: QUERY
+POSTHOOK: Input: _dummy_database@_dummy_table
+#### A masked pattern was here ####
+10	0.0	0.0
+11	0.0	0.0
+PREHOOK: query: create table cbo_test (key string, v1 double, v2 float, v3 decimal(30,2), v4 bigint)
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@cbo_test
+POSTHOOK: query: create table cbo_test (key string, v1 double, v2 float, v3 decimal(30,2), v4 bigint)
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@cbo_test
+PREHOOK: query: insert into cbo_test values
+  ("001400000000000000000006375905", 10230.72, 10230.72, 10230.69, 10230),
+  ("001400000000000000000006375905", 10230.72, 10230.72, 10230.69, 10230),
+  ("001400000000000000000006375905", 10230.72, 10230.72, 10230.69, 10230),
+  ("001400000000000000000006375905", 10230.72, 10230.72, 10230.69, 10230),
+  ("001400000000000000000006375905", 10230.72, 10230.72, 10230.69, 10230),
+  ("001400000000000000000006375905", 10230.72, 10230.72, 10230.69, 10230)
+PREHOOK: type: QUERY
+PREHOOK: Input: _dummy_database@_dummy_table
+PREHOOK: Output: default@cbo_test
+POSTHOOK: query: insert into cbo_test values
+  ("001400000000000000000006375905", 10230.72, 10230.72, 10230.69, 10230),
+  ("001400000000000000000006375905", 10230.72, 10230.72, 10230.69, 10230),
+  ("001400000000000000000006375905", 10230.72, 10230.72, 10230.69, 10230),
+  ("001400000000000000000006375905", 10230.72, 10230.72, 10230.69, 10230),
+  ("001400000000000000000006375905", 10230.72, 10230.72, 10230.69, 10230),
+  ("001400000000000000000006375905", 10230.72, 10230.72, 10230.69, 10230)
+POSTHOOK: type: QUERY
+POSTHOOK: Input: _dummy_database@_dummy_table
+POSTHOOK: Output: default@cbo_test
+POSTHOOK: Lineage: cbo_test.key SCRIPT []
+POSTHOOK: Lineage: cbo_test.v1 SCRIPT []
+POSTHOOK: Lineage: cbo_test.v2 SCRIPT []
+POSTHOOK: Lineage: cbo_test.v3 SCRIPT []
+POSTHOOK: Lineage: cbo_test.v4 SCRIPT []
+PREHOOK: query: explain select stddev(v1), stddev(v2), stddev(v3), stddev(v4) from cbo_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@cbo_test
+#### A masked pattern was here ####
+POSTHOOK: query: explain select stddev(v1), stddev(v2), stddev(v3), stddev(v4) from cbo_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@cbo_test
+#### A masked pattern was here ####
+STAGE DEPENDENCIES:
+  Stage-1 is a root stage
+  Stage-0 depends on stages: Stage-1
+
+STAGE PLANS:
+  Stage: Stage-1
+    Tez
+#### A masked pattern was here ####
+      Edges:
+        Reducer 2 <- Map 1 (CUSTOM_SIMPLE_EDGE)
+#### A masked pattern was here ####
+      Vertices:
+        Map 1 
+            Map Operator Tree:
+                TableScan
+                  alias: cbo_test
+                  Statistics: Num rows: 6 Data size: 792 Basic stats: COMPLETE Column stats: NONE
+                  Select Operator
+                    expressions: v1 (type: double), (v1 * v1) (type: double), UDFToDouble(v2) (type: double), (UDFToDouble(v2) * UDFToDouble(v2)) (type: double), UDFToDouble(v3) (type: double), (UDFToDouble(v3) * UDFToDouble(v3)) (type: double), UDFToDouble(v4) (type: double), (UDFToDouble(v4) * UDFToDouble(v4)) (type: double)
+                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
+                    Statistics: Num rows: 6 Data size: 792 Basic stats: COMPLETE Column stats: NONE
+                    Group By Operator
+                      aggregations: sum(_col1), sum(_col0), count(_col0), sum(_col3), sum(_col2), count(_col2), sum(_col5), sum(_col4), count(_col4), sum(_col7), sum(_col6), count(_col6)
+                      minReductionHashAggr: 0.99
+                      mode: hash
+                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11
+                      Statistics: Num rows: 1 Data size: 228 Basic stats: COMPLETE Column stats: NONE
+                      Reduce Output Operator
+                        null sort order: 
+                        sort order: 
+                        Statistics: Num rows: 1 Data size: 228 Basic stats: COMPLETE Column stats: NONE
+                        value expressions: _col0 (type: double), _col1 (type: double), _col2 (type: bigint), _col3 (type: double), _col4 (type: double), _col5 (type: bigint), _col6 (type: double), _col7 (type: double), _col8 (type: bigint), _col9 (type: double), _col10 (type: double), _col11 (type: bigint)
+            Execution mode: vectorized, llap
+            LLAP IO: all inputs
+        Reducer 2 
+            Execution mode: vectorized, llap
+            Reduce Operator Tree:
+              Group By Operator
+                aggregations: sum(VALUE._col0), sum(VALUE._col1), count(VALUE._col2), sum(VALUE._col3), sum(VALUE._col4), count(VALUE._col5), sum(VALUE._col6), sum(VALUE._col7), count(VALUE._col8), sum(VALUE._col9), sum(VALUE._col10), count(VALUE._col11)
+                mode: mergepartial
+                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11
+                Statistics: Num rows: 1 Data size: 228 Basic stats: COMPLETE Column stats: NONE
+                Select Operator
+                  expressions: power((greatest(0,(_col0 - ((_col1 * _col1) / _col2))) / _col2), 0.5) (type: double), power(((_col3 - ((_col4 * _col4) / _col5)) / _col5), 0.5) (type: double), power((greatest(0,(_col6 - ((_col7 * _col7) / _col8))) / _col8), 0.5) (type: double), power(((_col9 - ((_col10 * _col10) / _col11)) / _col11), 0.5) (type: double)
+                  outputColumnNames: _col0, _col1, _col2, _col3
+                  Statistics: Num rows: 1 Data size: 228 Basic stats: COMPLETE Column stats: NONE
+                  File Output Operator
+                    compressed: false
+                    Statistics: Num rows: 1 Data size: 228 Basic stats: COMPLETE Column stats: NONE
+                    table:
+                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+
+  Stage: Stage-0
+    Fetch Operator
+      limit: -1
+      Processor Tree:
+        ListSink
+
+PREHOOK: query: select stddev(v1), stddev(v2), stddev(v3), stddev(v4) from cbo_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@cbo_test
+#### A masked pattern was here ####
+POSTHOOK: query: select stddev(v1), stddev(v2), stddev(v3), stddev(v4) from cbo_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@cbo_test
+#### A masked pattern was here ####
+0.0	0.0	0.0	0.0
+PREHOOK: query: explain select stddev(v1), stddev(v2), stddev(v3), stddev(v4) from cbo_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@cbo_test
+#### A masked pattern was here ####
+POSTHOOK: query: explain select stddev(v1), stddev(v2), stddev(v3), stddev(v4) from cbo_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@cbo_test
+#### A masked pattern was here ####
+STAGE DEPENDENCIES:
+  Stage-1 is a root stage
+  Stage-0 depends on stages: Stage-1
+
+STAGE PLANS:
+  Stage: Stage-1
+    Tez
+#### A masked pattern was here ####
+      Edges:
+        Reducer 2 <- Map 1 (CUSTOM_SIMPLE_EDGE)
+#### A masked pattern was here ####
+      Vertices:
+        Map 1 
+            Map Operator Tree:
+                TableScan
+                  alias: cbo_test
+                  Statistics: Num rows: 6 Data size: 792 Basic stats: COMPLETE Column stats: NONE
+                  Select Operator
+                    expressions: v1 (type: double), v2 (type: float), v3 (type: decimal(30,2)), v4 (type: bigint)
+                    outputColumnNames: v1, v2, v3, v4
+                    Statistics: Num rows: 6 Data size: 792 Basic stats: COMPLETE Column stats: NONE
+                    Group By Operator
+                      aggregations: stddev(v1), stddev(v2), stddev(v3), stddev(v4)
+                      minReductionHashAggr: 0.99
+                      mode: hash
+                      outputColumnNames: _col0, _col1, _col2, _col3
+                      Statistics: Num rows: 1 Data size: 452 Basic stats: COMPLETE Column stats: NONE
+                      Reduce Output Operator
+                        null sort order: 
+                        sort order: 
+                        Statistics: Num rows: 1 Data size: 452 Basic stats: COMPLETE Column stats: NONE
+                        value expressions: _col0 (type: struct<count:bigint,sum:double,variance:double>), _col1 (type: struct<count:bigint,sum:double,variance:double>), _col2 (type: struct<count:bigint,sum:double,variance:double>), _col3 (type: struct<count:bigint,sum:double,variance:double>)
+            Execution mode: vectorized, llap
+            LLAP IO: all inputs
+        Reducer 2 
+            Execution mode: vectorized, llap
+            Reduce Operator Tree:
+              Group By Operator
+                aggregations: stddev(VALUE._col0), stddev(VALUE._col1), stddev(VALUE._col2), stddev(VALUE._col3)
+                mode: mergepartial
+                outputColumnNames: _col0, _col1, _col2, _col3
+                Statistics: Num rows: 1 Data size: 452 Basic stats: COMPLETE Column stats: NONE
+                File Output Operator
+                  compressed: false
+                  Statistics: Num rows: 1 Data size: 452 Basic stats: COMPLETE Column stats: NONE
+                  table:
+                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+
+  Stage: Stage-0
+    Fetch Operator
+      limit: -1
+      Processor Tree:
+        ListSink
+
+PREHOOK: query: select stddev(v1), stddev(v2), stddev(v3), stddev(v4) from cbo_test
+PREHOOK: type: QUERY
+PREHOOK: Input: default@cbo_test
+#### A masked pattern was here ####
+POSTHOOK: query: select stddev(v1), stddev(v2), stddev(v3), stddev(v4) from cbo_test
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@cbo_test
+#### A masked pattern was here ####
+5.42317860890711E-13	0.0	5.42317860890711E-13	0.0
diff --git a/ql/src/test/results/clientpositive/llap/udaf_binarysetfunctions.q.out b/ql/src/test/results/clientpositive/llap/udaf_binarysetfunctions.q.out
index 4272510974..900a2e5f8f 100644
--- a/ql/src/test/results/clientpositive/llap/udaf_binarysetfunctions.q.out
+++ b/ql/src/test/results/clientpositive/llap/udaf_binarysetfunctions.q.out
@@ -420,7 +420,7 @@ STAGE PLANS:
                 outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18
                 Statistics: Num rows: 7 Data size: 2492 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
-                  expressions: _col0 (type: int), ((_col1 - ((_col2 * _col2) / _col3)) / _col3) (type: double), ((_col4 - ((_col5 * _col5) / _col6)) / _col6) (type: double), _col7 (type: double), _col8 (type: double), _col9 (type: double), _col10 (type: bigint), _col11 (type: double), _col12 (type: double), _col13 (type: double), _col14 (type: double), _col15 (type: double), _col16 (type: double), _col17 (type: decimal(14,4)), _col18 (type: decimal(14,4))
+                  expressions: _col0 (type: int), (greatest(0,(_col1 - ((_col2 * _col2) / _col3))) / _col3) (type: double), (greatest(0,(_col4 - ((_col5 * _col5) / _col6))) / _col6) (type: double), _col7 (type: double), _col8 (type: double), _col9 (type: double), _col10 (type: bigint), _col11 (type: double), _col12 (type: double), _col13 (type: double), _col14 (type: double), _col15 (type: double), _col16 (type: double), _col17 (type: decimal(14,4)), _col18 (type: decimal(14,4))
                   outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14
                   Statistics: Num rows: 7 Data size: 2268 Basic stats: COMPLETE Column stats: COMPLETE
                   Reduce Output Operator
diff --git a/ql/src/test/results/clientpositive/llap/vector_decimal_aggregate.q.out b/ql/src/test/results/clientpositive/llap/vector_decimal_aggregate.q.out
index 6705110e46..34b2bed04b 100644
--- a/ql/src/test/results/clientpositive/llap/vector_decimal_aggregate.q.out
+++ b/ql/src/test/results/clientpositive/llap/vector_decimal_aggregate.q.out
@@ -323,7 +323,7 @@ STAGE PLANS:
                 reduceColumnNullOrder: z
                 reduceColumnSortOrder: +
                 allNative: false
-                usesVectorUDFAdaptor: false
+                usesVectorUDFAdaptor: true
                 vectorized: true
                 rowBatchContext:
                     dataColumnCount: 16
@@ -353,13 +353,13 @@ STAGE PLANS:
                   predicate: (_col15 > 1L) (type: boolean)
                   Statistics: Num rows: 2035 Data size: 1520120 Basic stats: COMPLETE Column stats: COMPLETE
                   Select Operator
-                    expressions: _col0 (type: int), _col1 (type: bigint), _col2 (type: decimal(20,10)), _col3 (type: decimal(20,10)), _col4 (type: decimal(30,10)), CAST( (_col4 / _col1) AS decimal(24,14)) (type: decimal(24,14)), power(((_col5 - ((_col6 * _col6) / _col7)) / _col7), 0.5) (type: double), power(((_col5 - ((_col6 * _col6) / _col7)) / if((_col7 = 1L), null, (_col7 - 1))), 0.5) (type: double), _col8 (type: bigint), _col9 (type: decimal(23,14)), _col10 (type: decimal(23,14)), _col11 (type: decimal(33,14)), CAST( (_col11 / _col8) AS decimal(27,18)) (type: decimal(27,18)), power(((_col12 - ((_col13 * _col13) / _col14)) / _col14), 0.5) (type: double), power(((_col12 - ((_col13 * _col13) / _col14)) / if((_col14 = 1L), null, (_col14 - 1))), 0.5) (type: double)
+                    expressions: _col0 (type: int), _col1 (type: bigint), _col2 (type: decimal(20,10)), _col3 (type: decimal(20,10)), _col4 (type: decimal(30,10)), CAST( (_col4 / _col1) AS decimal(24,14)) (type: decimal(24,14)), power((greatest(0,(_col5 - ((_col6 * _col6) / _col7))) / _col7), 0.5) (type: double), power((greatest(0,(_col5 - ((_col6 * _col6) / _col7))) / if((_col7 = 1L), null, (_col7 - 1))), 0.5) (type: double), _col8 (type: bigint), _col9 (type: decimal(23,14)), _col10 (type: decimal(23,14)), _col11 (type: decimal(33,14)), CAST( (_col11 / _col8) AS decimal(27,18)) (type: decimal(27,18)), power((greatest(0,(_col12 - ((_col13 * _col13) / _col14))) / _col14), 0.5) (type: double), power((greatest(0,(_col12 - ((_col13 * _col13) / _col14))) / if((_col14 = 1L), null, (_col14 - 1))), 0.5) (type: double)
                     outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14
                     Select Vectorization:
                         className: VectorSelectOperator
                         native: true
-                        projectedOutputColumnNums: [0, 1, 2, 3, 4, 18, 23, 31, 8, 9, 10, 11, 34, 39, 47]
-                        selectExpressions: CastDecimalToDecimal(col 17:decimal(38,18))(children: DecimalColDivideDecimalColumn(col 4:decimal(30,10), col 16:decimal(19,0))(children: CastLongToDecimal(col 1:bigint) -> 16:decimal(19,0)) -> 17:decimal(38,18)) -> 18:decimal(24,14), FuncPowerDoubleToDouble(col 22:double)(children: DoubleColDivideLongColumn(col 21:double, col 7:bigint)(children: DoubleColSubtractDoubleColumn(col 5:double, col 20:double)(children: DoubleColDivideLongColumn(col 19:double, col 7:bigint)(children: DoubleColMultiplyDoubleColumn(col 6:double, col 6:double) -> 19:double) -> 20:double) -> 21:double) -> 22:double) -> 23:double, FuncPowerDoubleToDouble(col 30:double)(children: DoubleColDivideLongColumn(col 26:double, col 29:bigint)(children: DoubleColSubtractDoubleColumn(col 5:double, col 25:double)(children: DoubleColDivideLongColumn(col 24:double, col 7:bigint)(children: DoubleColMultiplyDoubleColumn(col 6:double, col 6:double) -> 24:double) -> 25:double) -> 26:double, IfExprNullCondExpr(col 27:boolean, null, col 28:bigint)(children: LongColEqualLongScalar(col 7:bigint, val 1) -> 27:boolean, LongColSubtractLongScalar(col 7:bigint, val 1) -> 28:bigint) -> 29:bigint) -> 30:double) -> 31:double, CastDecimalToDecimal(col 33:decimal(38,19))(children: DecimalColDivideDecimalColumn(col 11:decimal(33,14), col 32:decimal(19,0))(children: CastLongToDecimal(col 8:bigint) -> 32:decimal(19,0)) -> 33:decimal(38,19)) -> 34:decimal(27,18), FuncPowerDoubleToDouble(col 38:double)(children: DoubleColDivideLongColumn(col 37:double, col 14:bigint)(children: DoubleColSubtractDoubleColumn(col 12:double, col 36:double)(children: DoubleColDivideLongColumn(col 35:double, col 14:bigint)(children: DoubleColMultiplyDoubleColumn(col 13:double, col 13:double) -> 35:double) -> 36:double) -> 37:double) -> 38:double) -> 39:double, FuncPowerDoubleToDouble(col 46:double)(children: DoubleColDivideLongColumn(col 42:double, col 45:bigint)(children: DoubleColSubtractDoubleColumn(col 12:double, col 41:double)(children: DoubleColDivideLongColumn(col 40:double, col 14:bigint)(children: DoubleColMultiplyDoubleColumn(col 13:double, col 13:double) -> 40:double) -> 41:double) -> 42:double, IfExprNullCondExpr(col 43:boolean, null, col 44:bigint)(children: LongColEqualLongScalar(col 14:bigint, val 1) -> 43:boolean, LongColSubtractLongScalar(col 14:bigint, val 1) -> 44:bigint) -> 45:bigint) -> 46:double) -> 47:double
+                        projectedOutputColumnNums: [0, 1, 2, 3, 4, 18, 24, 33, 8, 9, 10, 11, 36, 42, 51]
+                        selectExpressions: CastDecimalToDecimal(col 17:decimal(38,18))(children: DecimalColDivideDecimalColumn(col 4:decimal(30,10), col 16:decimal(19,0))(children: CastLongToDecimal(col 1:bigint) -> 16:decimal(19,0)) -> 17:decimal(38,18)) -> 18:decimal(24,14), FuncPowerDoubleToDouble(col 23:double)(children: DoubleColDivideLongColumn(col 22:double, col 7:bigint)(children: VectorUDFAdaptor(greatest(0,(_col5 - ((_col6 * _col6) / _col7))))(children: DoubleColSubtractDoubleColumn(col 5:double, col 20:double)(children: DoubleColDivideLongColumn(col 19:double, col 7:bigint)(children: DoubleColMultiplyDoubleColumn(col 6:double, col 6:double) -> 19:double) -> 20:double) -> 21:double) -> 22:double) -> 23:double) -> 24:double, FuncPowerDoubleToDouble(col 32:double)(children: DoubleColDivideLongColumn(col 28:double, col 31:bigint)(children: VectorUDFAdaptor(greatest(0,(_col5 - ((_col6 * _col6) / _col7))))(children: DoubleColSubtractDoubleColumn(col 5:double, col 26:double)(children: DoubleColDivideLongColumn(col 25:double, col 7:bigint)(children: DoubleColMultiplyDoubleColumn(col 6:double, col 6:double) -> 25:double) -> 26:double) -> 27:double) -> 28:double, IfExprNullCondExpr(col 29:boolean, null, col 30:bigint)(children: LongColEqualLongScalar(col 7:bigint, val 1) -> 29:boolean, LongColSubtractLongScalar(col 7:bigint, val 1) -> 30:bigint) -> 31:bigint) -> 32:double) -> 33:double, CastDecimalToDecimal(col 35:decimal(38,19))(children: DecimalColDivideDecimalColumn(col 11:decimal(33,14), col 34:decimal(19,0))(children: CastLongToDecimal(col 8:bigint) -> 34:decimal(19,0)) -> 35:decimal(38,19)) -> 36:decimal(27,18), FuncPowerDoubleToDouble(col 41:double)(children: DoubleColDivideLongColumn(col 40:double, col 14:bigint)(children: VectorUDFAdaptor(greatest(0,(_col12 - ((_col13 * _col13) / _col14))))(children: DoubleColSubtractDoubleColumn(col 12:double, col 38:double)(children: DoubleColDivideLongColumn(col 37:double, col 14:bigint)(children: DoubleColMultiplyDoubleColumn(col 13:double, col 13:double) -> 37:double) -> 38:double) -> 39:double) -> 40:double) -> 41:double) -> 42:double, FuncPowerDoubleToDouble(col 50:double)(children: DoubleColDivideLongColumn(col 46:double, col 49:bigint)(children: VectorUDFAdaptor(greatest(0,(_col12 - ((_col13 * _col13) / _col14))))(children: DoubleColSubtractDoubleColumn(col 12:double, col 44:double)(children: DoubleColDivideLongColumn(col 43:double, col 14:bigint)(children: DoubleColMultiplyDoubleColumn(col 13:double, col 13:double) -> 43:double) -> 44:double) -> 45:double) -> 46:double, IfExprNullCondExpr(col 47:boolean, null, col 48:bigint)(children: LongColEqualLongScalar(col 14:bigint, val 1) -> 47:boolean, LongColSubtractLongScalar(col 14:bigint, val 1) -> 48:bigint) -> 49:bigint) -> 50:double) -> 51:double
                     Statistics: Num rows: 2035 Data size: 1927120 Basic stats: COMPLETE Column stats: COMPLETE
                     File Output Operator
                       compressed: false
@@ -748,7 +748,7 @@ STAGE PLANS:
                 reduceColumnNullOrder: z
                 reduceColumnSortOrder: +
                 allNative: false
-                usesVectorUDFAdaptor: false
+                usesVectorUDFAdaptor: true
                 vectorized: true
                 rowBatchContext:
                     dataColumnCount: 16
@@ -778,13 +778,13 @@ STAGE PLANS:
                   predicate: (_col15 > 1L) (type: boolean)
                   Statistics: Num rows: 2035 Data size: 1520120 Basic stats: COMPLETE Column stats: COMPLETE
                   Select Operator
-                    expressions: _col0 (type: int), _col1 (type: bigint), _col2 (type: decimal(11,5)), _col3 (type: decimal(11,5)), _col4 (type: decimal(21,5)), CAST( (_col4 / _col1) AS decimal(15,9)) (type: decimal(15,9)), power(((_col5 - ((_col6 * _col6) / _col7)) / _col7), 0.5) (type: double), power(((_col5 - ((_col6 * _col6) / _col7)) / if((_col7 = 1L), null, (_col7 - 1))), 0.5) (type: double), _col8 (type: bigint), _col9 (type: decimal(16,0)), _col10 (type: decimal(16,0)), _col11 (type: decimal(26,0)), CAST( (_col11 / _col8) AS decimal(20,4)) (type: decimal(20,4)), power(((_col12 - ((_col13 * _col13) / _col14)) / _col14), 0.5) (type: double), power(((_col12 - ((_col13 * _col13) / _col14)) / if((_col14 = 1L), null, (_col14 - 1))), 0.5) (type: double)
+                    expressions: _col0 (type: int), _col1 (type: bigint), _col2 (type: decimal(11,5)), _col3 (type: decimal(11,5)), _col4 (type: decimal(21,5)), CAST( (_col4 / _col1) AS decimal(15,9)) (type: decimal(15,9)), power((greatest(0,(_col5 - ((_col6 * _col6) / _col7))) / _col7), 0.5) (type: double), power((greatest(0,(_col5 - ((_col6 * _col6) / _col7))) / if((_col7 = 1L), null, (_col7 - 1))), 0.5) (type: double), _col8 (type: bigint), _col9 (type: decimal(16,0)), _col10 (type: decimal(16,0)), _col11 (type: decimal(26,0)), CAST( (_col11 / _col8) AS decimal(20,4)) (type: decimal(20,4)), power((greatest(0,(_col12 - ((_col13 * _col13) / _col14))) / _col14), 0.5) (type: double), power((greatest(0,(_col12 - ((_col13 * _col13) / _col14))) / if((_col14 = 1L), null, (_col14 - 1))), 0.5) (type: double)
                     outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14
                     Select Vectorization:
                         className: VectorSelectOperator
                         native: true
-                        projectedOutputColumnNums: [0, 1, 2, 3, 4, 18, 23, 31, 8, 9, 10, 11, 34, 39, 47]
-                        selectExpressions: CastDecimalToDecimal(col 17:decimal(38,22))(children: DecimalColDivideDecimalColumn(col 4:decimal(21,5), col 16:decimal(19,0))(children: CastLongToDecimal(col 1:bigint) -> 16:decimal(19,0)) -> 17:decimal(38,22)) -> 18:decimal(15,9), FuncPowerDoubleToDouble(col 22:double)(children: DoubleColDivideLongColumn(col 21:double, col 7:bigint)(children: DoubleColSubtractDoubleColumn(col 5:double, col 20:double)(children: DoubleColDivideLongColumn(col 19:double, col 7:bigint)(children: DoubleColMultiplyDoubleColumn(col 6:double, col 6:double) -> 19:double) -> 20:double) -> 21:double) -> 22:double) -> 23:double, FuncPowerDoubleToDouble(col 30:double)(children: DoubleColDivideLongColumn(col 26:double, col 29:bigint)(children: DoubleColSubtractDoubleColumn(col 5:double, col 25:double)(children: DoubleColDivideLongColumn(col 24:double, col 7:bigint)(children: DoubleColMultiplyDoubleColumn(col 6:double, col 6:double) -> 24:double) -> 25:double) -> 26:double, IfExprNullCondExpr(col 27:boolean, null, col 28:bigint)(children: LongColEqualLongScalar(col 7:bigint, val 1) -> 27:boolean, LongColSubtractLongScalar(col 7:bigint, val 1) -> 28:bigint) -> 29:bigint) -> 30:double) -> 31:double, CastDecimalToDecimal(col 33:decimal(38,12))(children: DecimalColDivideDecimalColumn(col 11:decimal(26,0), col 32:decimal(19,0))(children: CastLongToDecimal(col 8:bigint) -> 32:decimal(19,0)) -> 33:decimal(38,12)) -> 34:decimal(20,4), FuncPowerDoubleToDouble(col 38:double)(children: DoubleColDivideLongColumn(col 37:double, col 14:bigint)(children: DoubleColSubtractDoubleColumn(col 12:double, col 36:double)(children: DoubleColDivideLongColumn(col 35:double, col 14:bigint)(children: DoubleColMultiplyDoubleColumn(col 13:double, col 13:double) -> 35:double) -> 36:double) -> 37:double) -> 38:double) -> 39:double, FuncPowerDoubleToDouble(col 46:double)(children: DoubleColDivideLongColumn(col 42:double, col 45:bigint)(children: DoubleColSubtractDoubleColumn(col 12:double, col 41:double)(children: DoubleColDivideLongColumn(col 40:double, col 14:bigint)(children: DoubleColMultiplyDoubleColumn(col 13:double, col 13:double) -> 40:double) -> 41:double) -> 42:double, IfExprNullCondExpr(col 43:boolean, null, col 44:bigint)(children: LongColEqualLongScalar(col 14:bigint, val 1) -> 43:boolean, LongColSubtractLongScalar(col 14:bigint, val 1) -> 44:bigint) -> 45:bigint) -> 46:double) -> 47:double
+                        projectedOutputColumnNums: [0, 1, 2, 3, 4, 18, 24, 33, 8, 9, 10, 11, 36, 42, 51]
+                        selectExpressions: CastDecimalToDecimal(col 17:decimal(38,22))(children: DecimalColDivideDecimalColumn(col 4:decimal(21,5), col 16:decimal(19,0))(children: CastLongToDecimal(col 1:bigint) -> 16:decimal(19,0)) -> 17:decimal(38,22)) -> 18:decimal(15,9), FuncPowerDoubleToDouble(col 23:double)(children: DoubleColDivideLongColumn(col 22:double, col 7:bigint)(children: VectorUDFAdaptor(greatest(0,(_col5 - ((_col6 * _col6) / _col7))))(children: DoubleColSubtractDoubleColumn(col 5:double, col 20:double)(children: DoubleColDivideLongColumn(col 19:double, col 7:bigint)(children: DoubleColMultiplyDoubleColumn(col 6:double, col 6:double) -> 19:double) -> 20:double) -> 21:double) -> 22:double) -> 23:double) -> 24:double, FuncPowerDoubleToDouble(col 32:double)(children: DoubleColDivideLongColumn(col 28:double, col 31:bigint)(children: VectorUDFAdaptor(greatest(0,(_col5 - ((_col6 * _col6) / _col7))))(children: DoubleColSubtractDoubleColumn(col 5:double, col 26:double)(children: DoubleColDivideLongColumn(col 25:double, col 7:bigint)(children: DoubleColMultiplyDoubleColumn(col 6:double, col 6:double) -> 25:double) -> 26:double) -> 27:double) -> 28:double, IfExprNullCondExpr(col 29:boolean, null, col 30:bigint)(children: LongColEqualLongScalar(col 7:bigint, val 1) -> 29:boolean, LongColSubtractLongScalar(col 7:bigint, val 1) -> 30:bigint) -> 31:bigint) -> 32:double) -> 33:double, CastDecimalToDecimal(col 35:decimal(38,12))(children: DecimalColDivideDecimalColumn(col 11:decimal(26,0), col 34:decimal(19,0))(children: CastLongToDecimal(col 8:bigint) -> 34:decimal(19,0)) -> 35:decimal(38,12)) -> 36:decimal(20,4), FuncPowerDoubleToDouble(col 41:double)(children: DoubleColDivideLongColumn(col 40:double, col 14:bigint)(children: VectorUDFAdaptor(greatest(0,(_col12 - ((_col13 * _col13) / _col14))))(children: DoubleColSubtractDoubleColumn(col 12:double, col 38:double)(children: DoubleColDivideLongColumn(col 37:double, col 14:bigint)(children: DoubleColMultiplyDoubleColumn(col 13:double, col 13:double) -> 37:double) -> 38:double) -> 39:double) -> 40:double) -> 41:double) -> 42:double, FuncPowerDoubleToDouble(col 50:double)(children: DoubleColDivideLongColumn(col 46:double, col 49:bigint)(children: VectorUDFAdaptor(greatest(0,(_col12 - ((_col13 * _col13) / _col14))))(children: DoubleColSubtractDoubleColumn(col 12:double, col 44:double)(children: DoubleColDivideLongColumn(col 43:double, col 14:bigint)(children: DoubleColMultiplyDoubleColumn(col 13:double, col 13:double) -> 43:double) -> 44:double) -> 45:double) -> 46:double, IfExprNullCondExpr(col 47:boolean, null, col 48:bigint)(children: LongColEqualLongScalar(col 14:bigint, val 1) -> 47:boolean, LongColSubtractLongScalar(col 14:bigint, val 1) -> 48:bigint) -> 49:bigint) -> 50:double) -> 51:double
                     Statistics: Num rows: 2035 Data size: 1927120 Basic stats: COMPLETE Column stats: COMPLETE
                     File Output Operator
                       compressed: false
diff --git a/ql/src/test/results/clientpositive/llap/vector_decimal_udf.q.out b/ql/src/test/results/clientpositive/llap/vector_decimal_udf.q.out
index c2077632c3..854ebc2dd8 100644
--- a/ql/src/test/results/clientpositive/llap/vector_decimal_udf.q.out
+++ b/ql/src/test/results/clientpositive/llap/vector_decimal_udf.q.out
@@ -3413,7 +3413,7 @@ STAGE PLANS:
                 reduceColumnNullOrder: z
                 reduceColumnSortOrder: +
                 allNative: false
-                usesVectorUDFAdaptor: false
+                usesVectorUDFAdaptor: true
                 vectorized: true
                 rowBatchContext:
                     dataColumnCount: 4
@@ -3436,13 +3436,13 @@ STAGE PLANS:
                 outputColumnNames: _col0, _col1, _col2, _col3
                 Statistics: Num rows: 17 Data size: 476 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
-                  expressions: _col0 (type: int), power(((_col1 - ((_col2 * _col2) / _col3)) / _col3), 0.5) (type: double), ((_col1 - ((_col2 * _col2) / _col3)) / _col3) (type: double)
+                  expressions: _col0 (type: int), power((greatest(0,(_col1 - ((_col2 * _col2) / _col3))) / _col3), 0.5) (type: double), (greatest(0,(_col1 - ((_col2 * _col2) / _col3))) / _col3) (type: double)
                   outputColumnNames: _col0, _col1, _col2
                   Select Vectorization:
                       className: VectorSelectOperator
                       native: true
-                      projectedOutputColumnNums: [0, 8, 12]
-                      selectExpressions: FuncPowerDoubleToDouble(col 7:double)(children: DoubleColDivideLongColumn(col 6:double, col 3:bigint)(children: DoubleColSubtractDoubleColumn(col 1:double, col 5:double)(children: DoubleColDivideLongColumn(col 4:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 2:double, col 2:double) -> 4:double) -> 5:double) -> 6:double) -> 7:double) -> 8:double, DoubleColDivideLongColumn(col 11:double, col 3:bigint)(children: DoubleColSubtractDoubleColumn(col 1:double, col 10:double)(children: DoubleColDivideLongColumn(col 9:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 2:double, col 2:double) -> 9:double) -> 10:double) -> 11:double) -> 12:double
+                      projectedOutputColumnNums: [0, 9, 14]
+                      selectExpressions: FuncPowerDoubleToDouble(col 8:double)(children: DoubleColDivideLongColumn(col 7:double, col 3:bigint)(children: VectorUDFAdaptor(greatest(0,(_col1 - ((_col2 * _col2) / _col3))))(children: DoubleColSubtractDoubleColumn(col 1:double, col 5:double)(children: DoubleColDivideLongColumn(col 4:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 2:double, col 2:double) -> 4:double) -> 5:double) -> 6:double) -> 7:double) -> 8:double) -> 9:double, DoubleColDivideLongColumn(col 13:double, col 3:bigint)(children: VectorUDFAdaptor(greatest(0,(_col1 - ((_col2 * _col2) / _col3))))(children: DoubleColSubtractDoubleColumn(col 1:double, col 11:double)(children: DoubleColDivideLongColumn(col 10:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 2:double, col 2:double) -> 10:double) -> 11:double) -> 12:double) -> 13:double) -> 14:double
                   Statistics: Num rows: 17 Data size: 340 Basic stats: COMPLETE Column stats: COMPLETE
                   File Output Operator
                     compressed: false
@@ -3583,7 +3583,7 @@ STAGE PLANS:
                 reduceColumnNullOrder: z
                 reduceColumnSortOrder: +
                 allNative: false
-                usesVectorUDFAdaptor: false
+                usesVectorUDFAdaptor: true
                 vectorized: true
                 rowBatchContext:
                     dataColumnCount: 4
@@ -3606,13 +3606,13 @@ STAGE PLANS:
                 outputColumnNames: _col0, _col1, _col2, _col3
                 Statistics: Num rows: 17 Data size: 476 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
-                  expressions: _col0 (type: int), power(((_col1 - ((_col2 * _col2) / _col3)) / if((_col3 = 1L), null, (_col3 - 1))), 0.5) (type: double), ((_col1 - ((_col2 * _col2) / _col3)) / if((_col3 = 1L), null, (_col3 - 1))) (type: double)
+                  expressions: _col0 (type: int), power((greatest(0,(_col1 - ((_col2 * _col2) / _col3))) / if((_col3 = 1L), null, (_col3 - 1))), 0.5) (type: double), (greatest(0,(_col1 - ((_col2 * _col2) / _col3))) / if((_col3 = 1L), null, (_col3 - 1))) (type: double)
                   outputColumnNames: _col0, _col1, _col2
                   Select Vectorization:
                       className: VectorSelectOperator
                       native: true
-                      projectedOutputColumnNums: [0, 11, 18]
-                      selectExpressions: FuncPowerDoubleToDouble(col 10:double)(children: DoubleColDivideLongColumn(col 6:double, col 9:bigint)(children: DoubleColSubtractDoubleColumn(col 1:double, col 5:double)(children: DoubleColDivideLongColumn(col 4:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 2:double, col 2:double) -> 4:double) -> 5:double) -> 6:double, IfExprNullCondExpr(col 7:boolean, null, col 8:bigint)(children: LongColEqualLongScalar(col 3:bigint, val 1) -> 7:boolean, LongColSubtractLongScalar(col 3:bigint, val 1) -> 8:bigint) -> 9:bigint) -> 10:double) -> 11:double, DoubleColDivideLongColumn(col 14:double, col 17:bigint)(children: DoubleColSubtractDoubleColumn(col 1:double, col 13:double)(children: DoubleColDivideLongColumn(col 12:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 2:double, col 2:double) -> 12:double) -> 13:double) -> 14:double, IfExprNullCondExpr(col 15:boolean, null, col 16:bigint)(children: LongColEqualLongScalar(col 3:bigint, val 1) -> 15:boolean, LongColSubtractLongScalar(col 3:bigint, val 1) -> 16:bigint) -> 17:bigint) -> 18:double
+                      projectedOutputColumnNums: [0, 12, 20]
+                      selectExpressions: FuncPowerDoubleToDouble(col 11:double)(children: DoubleColDivideLongColumn(col 7:double, col 10:bigint)(children: VectorUDFAdaptor(greatest(0,(_col1 - ((_col2 * _col2) / _col3))))(children: DoubleColSubtractDoubleColumn(col 1:double, col 5:double)(children: DoubleColDivideLongColumn(col 4:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 2:double, col 2:double) -> 4:double) -> 5:double) -> 6:double) -> 7:double, IfExprNullCondExpr(col 8:boolean, null, col 9:bigint)(children: LongColEqualLongScalar(col 3:bigint, val 1) -> 8:boolean, LongColSubtractLongScalar(col 3:bigint, val 1) -> 9:bigint) -> 10:bigint) -> 11:double) -> 12:double, DoubleColDivideLongColumn(col 16:double, col 19:bigint)(children: VectorUDFAdaptor(greatest(0,(_col1 - ((_col2 * _col2) / _col3))))(children: DoubleColSubtractDoubleColumn(col 1:double, col 14:double)(children: DoubleColDivideLongColumn(col 13:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 2:double, col 2:double) -> 13:double) -> 14:double) -> 15:double) -> 16:double, IfExprNullCondExpr(col 17:boolean, null, col 18:bigint)(children: LongColEqualLongScalar(col 3:bigint, val 1) -> 17:boolean, LongColSubtractLongScalar(col 3:bigint, val 1) -> 18:bigint) -> 19:bigint) -> 20:double
                   Statistics: Num rows: 17 Data size: 340 Basic stats: COMPLETE Column stats: COMPLETE
                   File Output Operator
                     compressed: false
@@ -7538,7 +7538,7 @@ STAGE PLANS:
                 reduceColumnNullOrder: z
                 reduceColumnSortOrder: +
                 allNative: false
-                usesVectorUDFAdaptor: false
+                usesVectorUDFAdaptor: true
                 vectorized: true
                 rowBatchContext:
                     dataColumnCount: 4
@@ -7561,13 +7561,13 @@ STAGE PLANS:
                 outputColumnNames: _col0, _col1, _col2, _col3
                 Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: NONE
                 Select Operator
-                  expressions: _col0 (type: int), power(((_col1 - ((_col2 * _col2) / _col3)) / _col3), 0.5) (type: double), ((_col1 - ((_col2 * _col2) / _col3)) / _col3) (type: double)
+                  expressions: _col0 (type: int), power((greatest(0,(_col1 - ((_col2 * _col2) / _col3))) / _col3), 0.5) (type: double), (greatest(0,(_col1 - ((_col2 * _col2) / _col3))) / _col3) (type: double)
                   outputColumnNames: _col0, _col1, _col2
                   Select Vectorization:
                       className: VectorSelectOperator
                       native: true
-                      projectedOutputColumnNums: [0, 8, 12]
-                      selectExpressions: FuncPowerDoubleToDouble(col 7:double)(children: DoubleColDivideLongColumn(col 6:double, col 3:bigint)(children: DoubleColSubtractDoubleColumn(col 1:double, col 5:double)(children: DoubleColDivideLongColumn(col 4:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 2:double, col 2:double) -> 4:double) -> 5:double) -> 6:double) -> 7:double) -> 8:double, DoubleColDivideLongColumn(col 11:double, col 3:bigint)(children: DoubleColSubtractDoubleColumn(col 1:double, col 10:double)(children: DoubleColDivideLongColumn(col 9:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 2:double, col 2:double) -> 9:double) -> 10:double) -> 11:double) -> 12:double
+                      projectedOutputColumnNums: [0, 9, 14]
+                      selectExpressions: FuncPowerDoubleToDouble(col 8:double)(children: DoubleColDivideLongColumn(col 7:double, col 3:bigint)(children: VectorUDFAdaptor(greatest(0,(_col1 - ((_col2 * _col2) / _col3))))(children: DoubleColSubtractDoubleColumn(col 1:double, col 5:double)(children: DoubleColDivideLongColumn(col 4:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 2:double, col 2:double) -> 4:double) -> 5:double) -> 6:double) -> 7:double) -> 8:double) -> 9:double, DoubleColDivideLongColumn(col 13:double, col 3:bigint)(children: VectorUDFAdaptor(greatest(0,(_col1 - ((_col2 * _col2) / _col3))))(children: DoubleColSubtractDoubleColumn(col 1:double, col 11:double)(children: DoubleColDivideLongColumn(col 10:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 2:double, col 2:double) -> 10:double) -> 11:double) -> 12:double) -> 13:double) -> 14:double
                   Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: NONE
                   File Output Operator
                     compressed: false
@@ -7708,7 +7708,7 @@ STAGE PLANS:
                 reduceColumnNullOrder: z
                 reduceColumnSortOrder: +
                 allNative: false
-                usesVectorUDFAdaptor: false
+                usesVectorUDFAdaptor: true
                 vectorized: true
                 rowBatchContext:
                     dataColumnCount: 4
@@ -7731,13 +7731,13 @@ STAGE PLANS:
                 outputColumnNames: _col0, _col1, _col2, _col3
                 Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: NONE
                 Select Operator
-                  expressions: _col0 (type: int), power(((_col1 - ((_col2 * _col2) / _col3)) / if((_col3 = 1L), null, (_col3 - 1))), 0.5) (type: double), ((_col1 - ((_col2 * _col2) / _col3)) / if((_col3 = 1L), null, (_col3 - 1))) (type: double)
+                  expressions: _col0 (type: int), power((greatest(0,(_col1 - ((_col2 * _col2) / _col3))) / if((_col3 = 1L), null, (_col3 - 1))), 0.5) (type: double), (greatest(0,(_col1 - ((_col2 * _col2) / _col3))) / if((_col3 = 1L), null, (_col3 - 1))) (type: double)
                   outputColumnNames: _col0, _col1, _col2
                   Select Vectorization:
                       className: VectorSelectOperator
                       native: true
-                      projectedOutputColumnNums: [0, 11, 18]
-                      selectExpressions: FuncPowerDoubleToDouble(col 10:double)(children: DoubleColDivideLongColumn(col 6:double, col 9:bigint)(children: DoubleColSubtractDoubleColumn(col 1:double, col 5:double)(children: DoubleColDivideLongColumn(col 4:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 2:double, col 2:double) -> 4:double) -> 5:double) -> 6:double, IfExprNullCondExpr(col 7:boolean, null, col 8:bigint)(children: LongColEqualLongScalar(col 3:bigint, val 1) -> 7:boolean, LongColSubtractLongScalar(col 3:bigint, val 1) -> 8:bigint) -> 9:bigint) -> 10:double) -> 11:double, DoubleColDivideLongColumn(col 14:double, col 17:bigint)(children: DoubleColSubtractDoubleColumn(col 1:double, col 13:double)(children: DoubleColDivideLongColumn(col 12:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 2:double, col 2:double) -> 12:double) -> 13:double) -> 14:double, IfExprNullCondExpr(col 15:boolean, null, col 16:bigint)(children: LongColEqualLongScalar(col 3:bigint, val 1) -> 15:boolean, LongColSubtractLongScalar(col 3:bigint, val 1) -> 16:bigint) -> 17:bigint) -> 18:double
+                      projectedOutputColumnNums: [0, 12, 20]
+                      selectExpressions: FuncPowerDoubleToDouble(col 11:double)(children: DoubleColDivideLongColumn(col 7:double, col 10:bigint)(children: VectorUDFAdaptor(greatest(0,(_col1 - ((_col2 * _col2) / _col3))))(children: DoubleColSubtractDoubleColumn(col 1:double, col 5:double)(children: DoubleColDivideLongColumn(col 4:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 2:double, col 2:double) -> 4:double) -> 5:double) -> 6:double) -> 7:double, IfExprNullCondExpr(col 8:boolean, null, col 9:bigint)(children: LongColEqualLongScalar(col 3:bigint, val 1) -> 8:boolean, LongColSubtractLongScalar(col 3:bigint, val 1) -> 9:bigint) -> 10:bigint) -> 11:double) -> 12:double, DoubleColDivideLongColumn(col 16:double, col 19:bigint)(children: VectorUDFAdaptor(greatest(0,(_col1 - ((_col2 * _col2) / _col3))))(children: DoubleColSubtractDoubleColumn(col 1:double, col 14:double)(children: DoubleColDivideLongColumn(col 13:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 2:double, col 2:double) -> 13:double) -> 14:double) -> 15:double) -> 16:double, IfExprNullCondExpr(col 17:boolean, null, col 18:bigint)(children: LongColEqualLongScalar(col 3:bigint, val 1) -> 17:boolean, LongColSubtractLongScalar(col 3:bigint, val 1) -> 18:bigint) -> 19:bigint) -> 20:double
                   Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: NONE
                   File Output Operator
                     compressed: false
diff --git a/ql/src/test/results/clientpositive/llap/vectorization_1.q.out b/ql/src/test/results/clientpositive/llap/vectorization_1.q.out
index f8eaa6c757..2df95500de 100644
--- a/ql/src/test/results/clientpositive/llap/vectorization_1.q.out
+++ b/ql/src/test/results/clientpositive/llap/vectorization_1.q.out
@@ -133,7 +133,7 @@ STAGE PLANS:
                 reduceColumnNullOrder: 
                 reduceColumnSortOrder: 
                 allNative: false
-                usesVectorUDFAdaptor: false
+                usesVectorUDFAdaptor: true
                 vectorized: true
                 rowBatchContext:
                     dataColumnCount: 10
@@ -154,13 +154,13 @@ STAGE PLANS:
                 outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                 Statistics: Num rows: 1 Data size: 72 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
-                  expressions: ((_col0 - ((_col1 * _col1) / _col2)) / _col2) (type: double), (((_col0 - ((_col1 * _col1) / _col2)) / _col2) / -26.28D) (type: double), _col3 (type: double), (-1.389D + _col3) (type: double), (_col3 * (-1.389D + _col3)) (type: double), _col4 (type: tinyint), (- (_col3 * (-1.389D + _col3))) (type: double), _col5 (type: int), (CAST( _col5 AS decimal(10,0)) * 79.553) (type: decimal(16,3)), ((_col6 - ((_col7 * _col7) / _col8)) / if((_col8 = 1L), null, (_col8 - 1))) (type: double), (10.175D % (- (_col3 * (-1.389D + _col3)))) (type: double), _col9 (type: bigint), (-563 % _col5) (type: int)
+                  expressions: ((_col0 - ((_col1 * _col1) / _col2)) / _col2) (type: double), (((_col0 - ((_col1 * _col1) / _col2)) / _col2) / -26.28D) (type: double), _col3 (type: double), (-1.389D + _col3) (type: double), (_col3 * (-1.389D + _col3)) (type: double), _col4 (type: tinyint), (- (_col3 * (-1.389D + _col3))) (type: double), _col5 (type: int), (CAST( _col5 AS decimal(10,0)) * 79.553) (type: decimal(16,3)), (greatest(0,(_col6 - ((_col7 * _col7) / _col8))) / if((_col8 = 1L), null, (_col8 - 1))) (type: double), (10.175D % (- (_col3 * (-1.389D + _col3)))) (type: double), _col9 (type: bigint), (-563 % _col5) (type: int)
                   outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12
                   Select Vectorization:
                       className: VectorSelectOperator
                       native: true
-                      projectedOutputColumnNums: [13, 18, 3, 19, 21, 4, 24, 5, 27, 34, 38, 9, 39]
-                      selectExpressions: DoubleColDivideLongColumn(col 12:double, col 2:bigint)(children: DoubleColSubtractDoubleColumn(col 0:double, col 11:double)(children: DoubleColDivideLongColumn(col 10:double, col 2:bigint)(children: DoubleColMultiplyDoubleColumn(col 1:double, col 1:double) -> 10:double) -> 11:double) -> 12:double) -> 13:double, DoubleColDivideDoubleScalar(col 17:double, val -26.28)(children: DoubleColDivideLongColumn(col 16:double, col 2:bigint)(children: DoubleColSubtractDoubleColumn(col 0:double, col 15:double)(children: DoubleColDivideLongColumn(col 14:double, col 2:bigint)(children: DoubleColMultiplyDoubleColumn(col 1:double, col 1:double) -> 14:double) -> 15:double) -> 16:double) -> 17:double) -> 18:double, DoubleScalarAddDoubleColumn(val -1.389, col 3:double) -> 19:double, DoubleColMultiplyDoubleColumn(col 3:double, col 20:double)(children: DoubleScalarAddDoubleColumn(val -1.389, col 3:double) -> 20:double) -> 21:double, DoubleColUnaryMinus(col 23:double)(children: DoubleColMultiplyDoubleColumn(col 3:double, col 22:double)(children: DoubleScalarAddDoubleColumn(val -1.389, col 3:double) -> 22:double) -> 23:double) -> 24:double, DecimalColMultiplyDecimalScalar(col 26:decimal(10,0), val 79.553)(children: CastLongToDecimal(col 5:int) -> 26:decimal(10,0)) -> 27:decimal(16,3), DoubleColDivideLongColumn(col 30:double, col 33:bigint)(children: DoubleColSubtractDoubleColumn(col 6:double, col 29:double)(children: DoubleColDivideLongColumn(col 28:double, col 8:bigint)(children: DoubleColMultiplyDoubleColumn(col 7:double, col 7:double) -> 28:double) -> 29:double) -> 30:double, IfExprNullCondExpr(col 31:boolean, null, col 32:bigint)(children: LongColEqualLongScalar(col 8:bigint, val 1) -> 31:boolean, LongColSubtractLongScalar(col 8:bigint, val 1) -> 32:bigint) -> 33:bigint) -> 34:double, DoubleScalarModuloDoubleColumn(val 10.175, col 37:double)(children: DoubleColUnaryMinus(col 36:double)(children: DoubleColMultiplyDoubleColumn(col 3:double, col 35:double)(children: DoubleScalarAddDoubleColumn(val -1.389, col 3:double) -> 35:double) -> 36:double) -> 37:double) -> 38:double, LongScalarModuloLongColumn(val -563, col 5:int) -> 39:int
+                      projectedOutputColumnNums: [13, 18, 3, 19, 21, 4, 24, 5, 27, 35, 39, 9, 40]
+                      selectExpressions: DoubleColDivideLongColumn(col 12:double, col 2:bigint)(children: DoubleColSubtractDoubleColumn(col 0:double, col 11:double)(children: DoubleColDivideLongColumn(col 10:double, col 2:bigint)(children: DoubleColMultiplyDoubleColumn(col 1:double, col 1:double) -> 10:double) -> 11:double) -> 12:double) -> 13:double, DoubleColDivideDoubleScalar(col 17:double, val -26.28)(children: DoubleColDivideLongColumn(col 16:double, col 2:bigint)(children: DoubleColSubtractDoubleColumn(col 0:double, col 15:double)(children: DoubleColDivideLongColumn(col 14:double, col 2:bigint)(children: DoubleColMultiplyDoubleColumn(col 1:double, col 1:double) -> 14:double) -> 15:double) -> 16:double) -> 17:double) -> 18:double, DoubleScalarAddDoubleColumn(val -1.389, col 3:double) -> 19:double, DoubleColMultiplyDoubleColumn(col 3:double, col 20:double)(children: DoubleScalarAddDoubleColumn(val -1.389, col 3:double) -> 20:double) -> 21:double, DoubleColUnaryMinus(col 23:double)(children: DoubleColMultiplyDoubleColumn(col 3:double, col 22:double)(children: DoubleScalarAddDoubleColumn(val -1.389, col 3:double) -> 22:double) -> 23:double) -> 24:double, DecimalColMultiplyDecimalScalar(col 26:decimal(10,0), val 79.553)(children: CastLongToDecimal(col 5:int) -> 26:decimal(10,0)) -> 27:decimal(16,3), DoubleColDivideLongColumn(col 31:double, col 34:bigint)(children: VectorUDFAdaptor(greatest(0,(_col6 - ((_col7 * _col7) / _col8))))(children: DoubleColSubtractDoubleColumn(col 6:double, col 29:double)(children: DoubleColDivideLongColumn(col 28:double, col 8:bigint)(children: DoubleColMultiplyDoubleColumn(col 7:double, col 7:double) -> 28:double) -> 29:double) -> 30:double) -> 31:double, IfExprNullCondExpr(col 32:boolean, null, col 33:bigint)(children: LongColEqualLongScalar(col 8:bigint, val 1) -> 32:boolean, LongColSubtractLongScalar(col 8:bigint, val 1) -> 33:bigint) -> 34:bigint) -> 35:double, DoubleScalarModuloDoubleColumn(val 10.175, col 38:double)(children: DoubleColUnaryMinus(col 37:double)(children: DoubleColMultiplyDoubleColumn(col 3:double, col 36:double)(children: DoubleScalarAddDoubleColumn(val -1.389, col 3:double) -> 36:double) -> 37:double) -> 38:double) -> 39:double, LongScalarModuloLongColumn(val -563, col 5:int) -> 40:int
                   Statistics: Num rows: 1 Data size: 196 Basic stats: COMPLETE Column stats: COMPLETE
                   File Output Operator
                     compressed: false
diff --git a/ql/src/test/results/clientpositive/llap/vectorization_12.q.out b/ql/src/test/results/clientpositive/llap/vectorization_12.q.out
index dbae880e0d..dc32125930 100644
--- a/ql/src/test/results/clientpositive/llap/vectorization_12.q.out
+++ b/ql/src/test/results/clientpositive/llap/vectorization_12.q.out
@@ -161,7 +161,7 @@ STAGE PLANS:
                 reduceColumnNullOrder: zzzz
                 reduceColumnSortOrder: ++++
                 allNative: false
-                usesVectorUDFAdaptor: false
+                usesVectorUDFAdaptor: true
                 vectorized: true
                 rowBatchContext:
                     dataColumnCount: 12
@@ -184,13 +184,13 @@ STAGE PLANS:
                 outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11
                 Statistics: Num rows: 1903 Data size: 283900 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
-                  expressions: _col1 (type: bigint), _col3 (type: boolean), _col2 (type: string), _col0 (type: double), (-6432.0D * _col0) (type: double), (- _col1) (type: bigint), _col4 (type: bigint), (_col1 * _col4) (type: bigint), power(((_col5 - ((_col6 * _col6) / _col7)) / if((_col7 = 1L), null, (_col7 - 1))), 0.5) (type: double), ((-6432.0D * _col0) / -6432.0D) (type: double), (- ((-6432.0D * _col0) / -6432.0D)) (type: double), (_col8 / _col9) (type: double), (- (-6432.0D * _col0)) (type: double), (-5638.15 + CAST( _col1 AS decimal(19,0))) (type: decimal(22,2)), _col10 (type: bigint), ((_col8 / _col9) / (-6432.0D * _col0)) (type: double), (((-6432.0D * _col0) / -6432.0D) + (- (-6432.0D * _col0))) (type: double), power(((_col11 - ((_col8 * _col8) / _col9)) / _col9), 0.5) (type: double)
+                  expressions: _col1 (type: bigint), _col3 (type: boolean), _col2 (type: string), _col0 (type: double), (-6432.0D * _col0) (type: double), (- _col1) (type: bigint), _col4 (type: bigint), (_col1 * _col4) (type: bigint), power(((_col5 - ((_col6 * _col6) / _col7)) / if((_col7 = 1L), null, (_col7 - 1))), 0.5) (type: double), ((-6432.0D * _col0) / -6432.0D) (type: double), (- ((-6432.0D * _col0) / -6432.0D)) (type: double), (_col8 / _col9) (type: double), (- (-6432.0D * _col0)) (type: double), (-5638.15 + CAST( _col1 AS decimal(19,0))) (type: decimal(22,2)), _col10 (type: bigint), ((_col8 / _col9) / (-6432.0D * _col0)) (type: double), (((-6432.0D * _col0) / -6432.0D) + (- (-6432.0D * _col0))) (type: double), power((greatest(0,(_col11 - ((_col8 * _col8) / _col9))) / _col9), 0.5) (type: double)
                   outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col18, _col19
                   Select Vectorization:
                       className: VectorSelectOperator
                       native: true
-                      projectedOutputColumnNums: [1, 3, 2, 0, 12, 13, 4, 14, 22, 24, 27, 28, 30, 32, 10, 35, 40, 45]
-                      selectExpressions: DoubleScalarMultiplyDoubleColumn(val -6432.0, col 0:double) -> 12:double, LongColUnaryMinus(col 1:bigint) -> 13:bigint, LongColMultiplyLongColumn(col 1:bigint, col 4:bigint) -> 14:bigint, FuncPowerDoubleToDouble(col 21:double)(children: DoubleColDivideLongColumn(col 17:double, col 20:bigint)(children: DoubleColSubtractDoubleColumn(col 5:double, col 16:double)(children: DoubleColDivideLongColumn(col 15:double, col 7:bigint)(children: DoubleColMultiplyDoubleColumn(col 6:double, col 6:double) -> 15:double) -> 16:double) -> 17:double, IfExprNullCondExpr(col 18:boolean, null, col 19:bigint)(children: LongColEqualLongScalar(col 7:bigint, val 1) -> 18:boolean, LongColSubtractLongScalar(col 7:bigint, val 1) -> 19:bigint) -> 20:bigint) -> 21:double) -> 22:double, DoubleColDivideDoubleScalar(col 23:double, val -6432.0)(children: DoubleScalarMultiplyDoubleColumn(val -6432.0, col 0:double) -> 23:double) -> 24:double, DoubleColUnaryMinus(col 26:double)(children: DoubleColDivideDoubleScalar(col 25:double, val -6432.0)(children: DoubleScalarMultiplyDoubleColumn(val -6432.0, col 0:double) -> 25:double) -> 26:double) -> 27:double, DoubleColDivideLongColumn(col 8:double, col 9:bigint) -> 28:double, DoubleColUnaryMinus(col 29:double)(children: DoubleScalarMultiplyDoubleColumn(val -6432.0, col 0:double) -> 29:double) -> 30:double, DecimalScalarAddDecimalColumn(val -5638.15, col 31:decimal(19,0))(children: CastLongToDecimal(col 1:bigint) -> 31:decimal(19,0)) -> 32:decimal(22,2), DoubleColDivideDoubleColumn(col 33:double, col 34:double)(children: DoubleColDivideLongColumn(col 8:double, col 9:bigint) -> 33:double, DoubleScalarMultiplyDoubleColumn(val -6432.0, col 0:double) -> 34:double) -> 35:double, DoubleColAddDoubleColumn(col 37:double, col 39:double)(children: DoubleColDivideDoubleScalar(col 36:double, val -6432.0)(children: DoubleScalarMultiplyDoubleColumn(val -6432.0, col 0:double) -> 36:double) -> 37:double, DoubleColUnaryMinus(col 38:double)(children: DoubleScalarMultiplyDoubleColumn(val -6432.0, col 0:double) -> 38:double) -> 39:double) -> 40:double, FuncPowerDoubleToDouble(col 44:double)(children: DoubleColDivideLongColumn(col 43:double, col 9:bigint)(children: DoubleColSubtractDoubleColumn(col 11:double, col 42:double)(children: DoubleColDivideLongColumn(col 41:double, col 9:bigint)(children: DoubleColMultiplyDoubleColumn(col 8:double, col 8:double) -> 41:double) -> 42:double) -> 43:double) -> 44:double) -> 45:double
+                      projectedOutputColumnNums: [1, 3, 2, 0, 12, 13, 4, 14, 22, 24, 27, 28, 30, 32, 10, 35, 40, 46]
+                      selectExpressions: DoubleScalarMultiplyDoubleColumn(val -6432.0, col 0:double) -> 12:double, LongColUnaryMinus(col 1:bigint) -> 13:bigint, LongColMultiplyLongColumn(col 1:bigint, col 4:bigint) -> 14:bigint, FuncPowerDoubleToDouble(col 21:double)(children: DoubleColDivideLongColumn(col 17:double, col 20:bigint)(children: DoubleColSubtractDoubleColumn(col 5:double, col 16:double)(children: DoubleColDivideLongColumn(col 15:double, col 7:bigint)(children: DoubleColMultiplyDoubleColumn(col 6:double, col 6:double) -> 15:double) -> 16:double) -> 17:double, IfExprNullCondExpr(col 18:boolean, null, col 19:bigint)(children: LongColEqualLongScalar(col 7:bigint, val 1) -> 18:boolean, LongColSubtractLongScalar(col 7:bigint, val 1) -> 19:bigint) -> 20:bigint) -> 21:double) -> 22:double, DoubleColDivideDoubleScalar(col 23:double, val -6432.0)(children: DoubleScalarMultiplyDoubleColumn(val -6432.0, col 0:double) -> 23:double) -> 24:double, DoubleColUnaryMinus(col 26:double)(children: DoubleColDivideDoubleScalar(col 25:double, val -6432.0)(children: DoubleScalarMultiplyDoubleColumn(val -6432.0, col 0:double) -> 25:double) -> 26:double) -> 27:double, DoubleColDivideLongColumn(col 8:double, col 9:bigint) -> 28:double, DoubleColUnaryMinus(col 29:double)(children: DoubleScalarMultiplyDoubleColumn(val -6432.0, col 0:double) -> 29:double) -> 30:double, DecimalScalarAddDecimalColumn(val -5638.15, col 31:decimal(19,0))(children: CastLongToDecimal(col 1:bigint) -> 31:decimal(19,0)) -> 32:decimal(22,2), DoubleColDivideDoubleColumn(col 33:double, col 34:double)(children: DoubleColDivideLongColumn(col 8:double, col 9:bigint) -> 33:double, DoubleScalarMultiplyDoubleColumn(val -6432.0, col 0:double) -> 34:double) -> 35:double, DoubleColAddDoubleColumn(col 37:double, col 39:double)(children: DoubleColDivideDoubleScalar(col 36:double, val -6432.0)(children: DoubleScalarMultiplyDoubleColumn(val -6432.0, col 0:double) -> 36:double) -> 37:double, DoubleColUnaryMinus(col 38:double)(children: DoubleScalarMultiplyDoubleColumn(val -6432.0, col 0:double) -> 38:double) -> 39:double) -> 40:double, FuncPowerDoubleToDouble(col 45:double)(children: DoubleColDivideLongColumn(col 44:double, col 9:bigint)(children: VectorUDFAdaptor(greatest(0,(_col11 - ((_col8 * _col8) / _col9))))(children: DoubleColSubtractDoubleColumn(col 11:double, col 42:double)(children: DoubleColDivideLongColumn(col 41:double, col 9:bigint)(children: DoubleColMultiplyDoubleColumn(col 8:double, col 8:double) -> 41:double) -> 42:double) -> 43:double) -> 44:double) -> 45:double) -> 46:double
                   Statistics: Num rows: 1903 Data size: 573156 Basic stats: COMPLETE Column stats: COMPLETE
                   Reduce Output Operator
                     key expressions: _col3 (type: double), _col0 (type: bigint), _col2 (type: string)
@@ -201,7 +201,7 @@ STAGE PLANS:
                         keyColumns: 0:double, 1:bigint, 2:string
                         native: true
                         nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
-                        valueColumns: 3:boolean, 12:double, 13:bigint, 4:bigint, 14:bigint, 22:double, 24:double, 27:double, 28:double, 30:double, 32:decimal(22,2), 10:bigint, 35:double, 40:double, 45:double
+                        valueColumns: 3:boolean, 12:double, 13:bigint, 4:bigint, 14:bigint, 22:double, 24:double, 27:double, 28:double, 30:double, 32:decimal(22,2), 10:bigint, 35:double, 40:double, 46:double
                     Statistics: Num rows: 1903 Data size: 573156 Basic stats: COMPLETE Column stats: COMPLETE
                     value expressions: _col1 (type: boolean), _col4 (type: double), _col5 (type: bigint), _col6 (type: bigint), _col7 (type: bigint), _col8 (type: double), _col9 (type: double), _col10 (type: double), _col11 (type: double), _col12 (type: double), _col13 (type: decimal(22,2)), _col14 (type: bigint), _col15 (type: double), _col18 (type: double), _col19 (type: double)
         Reducer 3 
diff --git a/ql/src/test/results/clientpositive/llap/vectorization_14.q.out b/ql/src/test/results/clientpositive/llap/vectorization_14.q.out
index 7038c3a78b..25bfeb19bf 100644
--- a/ql/src/test/results/clientpositive/llap/vectorization_14.q.out
+++ b/ql/src/test/results/clientpositive/llap/vectorization_14.q.out
@@ -163,7 +163,7 @@ STAGE PLANS:
                 reduceColumnNullOrder: zzzzz
                 reduceColumnSortOrder: +++++
                 allNative: false
-                usesVectorUDFAdaptor: false
+                usesVectorUDFAdaptor: true
                 vectorized: true
                 rowBatchContext:
                     dataColumnCount: 13
@@ -186,13 +186,13 @@ STAGE PLANS:
                 outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12
                 Statistics: Num rows: 758 Data size: 130530 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
-                  expressions: _col3 (type: timestamp), _col1 (type: float), _col0 (type: string), _col4 (type: boolean), _col2 (type: double), (-26.28D + _col2) (type: double), (- (-26.28D + _col2)) (type: double), power(((_col5 - ((_col6 * _col6) / _col7)) / if((_col7 = 1L), null, (_col7 - 1))), 0.5) (type: double), (_col1 * -26.28) (type: float), _col8 (type: float), (- _col1) (type: float), (- _col8) (type: float), ((- (-26.28D + _col2)) / 10.175D) (type: double), power(((_col9 - ((_col10 * _col10) / _col11)) / _col11), 0.5) (type: double), _col12 (type: bigint), (- ((- (-26.28D + _col2)) / 10.175D)) (type: double), (-1.389D % power(((_col5 - ((_col6 * _col6) / _col7)) / if((_col7 = 1L), null, (_col7 - 1))), 0.5)) (type: double), (UDFToDouble(_col1) - _col2) (type: double), ((_col9 - ((_col10 * _col10) / _col11)) / _col11) (type: double), (((_col9 - ((_col10 * _col10) / _col11)) / _col11) % 10.175D) (type: double), ((_col9 - ((_col10 * _col10) / _col11)) / if((_col11 = 1L), null, (_col11 - 1))) (type: double), (- (UDFToDouble(_col1) - _col2)) (type: double)
+                  expressions: _col3 (type: timestamp), _col1 (type: float), _col0 (type: string), _col4 (type: boolean), _col2 (type: double), (-26.28D + _col2) (type: double), (- (-26.28D + _col2)) (type: double), power((greatest(0,(_col5 - ((_col6 * _col6) / _col7))) / if((_col7 = 1L), null, (_col7 - 1))), 0.5) (type: double), (_col1 * -26.28) (type: float), _col8 (type: float), (- _col1) (type: float), (- _col8) (type: float), ((- (-26.28D + _col2)) / 10.175D) (type: double), power(((_col9 - ((_col10 * _col10) / _col11)) / _col11), 0.5) (type: double), _col12 (type: bigint), (- ((- (-26.28D + _col2)) / 10.175D)) (type: double), (-1.389D % power((greatest(0,(_col5 - ((_col6 * _col6) / _col7))) / if((_col7 = 1L), null, (_col7 - 1))), 0.5)) (type: double), (UDFToDouble(_col1) - _col2) (type: double), ((_col9 - ((_col10 * _col10) / _col11)) / _col11) (type: double), (((_col9 - ((_col10 * _col10) / _col11)) / _col11) % 10.175D) (type: double), ((_col9 - ((_col10 * _col10) / _col11)) / if((_col11 = 1L), null, (_col11 - 1))) (type: double), (- (UDFToDouble(_col1) - _col2)) (type: double)
                   outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21
                   Select Vectorization:
                       className: VectorSelectOperator
                       native: true
-                      projectedOutputColumnNums: [3, 1, 0, 4, 2, 13, 15, 23, 24, 8, 25, 26, 29, 34, 12, 38, 47, 48, 52, 57, 64, 66]
-                      selectExpressions: DoubleScalarAddDoubleColumn(val -26.28, col 2:double) -> 13:double, DoubleColUnaryMinus(col 14:double)(children: DoubleScalarAddDoubleColumn(val -26.28, col 2:double) -> 14:double) -> 15:double, FuncPowerDoubleToDouble(col 22:double)(children: DoubleColDivideLongColumn(col 18:double, col 21:bigint)(children: DoubleColSubtractDoubleColumn(col 5:double, col 17:double)(children: DoubleColDivideLongColumn(col 16:double, col 7:bigint)(children: DoubleColMultiplyDoubleColumn(col 6:double, col 6:double) -> 16:double) -> 17:double) -> 18:double, IfExprNullCondExpr(col 19:boolean, null, col 20:bigint)(children: LongColEqualLongScalar(col 7:bigint, val 1) -> 19:boolean, LongColSubtractLongScalar(col 7:bigint, val 1) -> 20:bigint) -> 21:bigint) -> 22:double) -> 23:double, DoubleColMultiplyDoubleScalar(col 1:float, val -26.280000686645508) -> 24:float, DoubleColUnaryMinus(col 1:float) -> 25:float, DoubleColUnaryMinus(col 8:float) -> 26:float, DoubleColDivideDoubleScalar(col 28:double, val 10.175)(children: DoubleColUnaryMinus(col 27:double)(children: DoubleScalarAddDoubleColumn(val -26.28, col 2:double) -> 27:double) -> 28:double) -> 29:double, FuncPowerDoubleToDouble(col 33:double)(children: DoubleColDivideLongColumn(col 32:double, col 11:bigint)(children: DoubleColSubtractDoubleColumn(col 9:double, col 31:double)(children: DoubleColDivideLongColumn(col 30:double, col 11:bigint)(children: DoubleColMultiplyDoubleColumn(col 10:double, col 10:double) -> 30:double) -> 31:double) -> 32:double) -> 33:double) -> 34:double, DoubleColUnaryMinus(col 37:double)(children: DoubleColDivideDoubleScalar(col 36:double, val 10.175)(children: DoubleColUnaryMinus(col 35:double)(children: DoubleScalarAddDoubleColumn(val -26.28, col 2:double) -> 35:double) -> 36:double) -> 37:double) -> 38:double, DoubleScalarModuloDoubleColumn(val -1.389, col 46:double)(children: FuncPowerDoubleToDouble(col 45:double)(children: DoubleColDivideLongColumn(col 41:double, col 44:bigint)(children: DoubleColSubtractDoubleColumn(col 5:double, col 40:double)(children: DoubleColDivideLongColumn(col 39:double, col 7:bigint)(children: DoubleColMultiplyDoubleColumn(col 6:double, col 6:double) -> 39:double) -> 40:double) -> 41:double, IfExprNullCondExpr(col 42:boolean, null, col 43:bigint)(children: LongColEqualLongScalar(col 7:bigint, val 1) -> 42:boolean, LongColSubtractLongScalar(col 7:bigint, val 1) -> 43:bigint) -> 44:bigint) -> 45:double) -> 46:double) -> 47:double, DoubleColSubtractDoubleColumn(col 1:double, col 2:double)(children: col 1:float) -> 48:double, DoubleColDivideLongColumn(col 51:double, col 11:bigint)(children: DoubleColSubtractDoubleColumn(col 9:double, col 50:double)(children: DoubleColDivideLongColumn(col 49:double, col 11:bigint)(children: DoubleColMultiplyDoubleColumn(col 10:double, col 10:double) -> 49:double) -> 50:double) -> 51:double) -> 52:double, DoubleColModuloDoubleScalar(col 56:double, val 10.175)(children: DoubleColDivideLongColumn(col 55:double, col 11:bigint)(children: DoubleColSubtractDoubleColumn(col 9:double, col 54:double)(children: DoubleColDivideLongColumn(col 53:double, col 11:bigint)(children: DoubleColMultiplyDoubleColumn(col 10:double, col 10:double) -> 53:double) -> 54:double) -> 55:double) -> 56:double) -> 57:double, DoubleColDivideLongColumn(col 60:double, col 63:bigint)(children: DoubleColSubtractDoubleColumn(col 9:double, col 59:double)(children: DoubleColDivideLongColumn(col 58:double, col 11:bigint)(children: DoubleColMultiplyDoubleColumn(col 10:double, col 10:double) -> 58:double) -> 59:double) -> 60:double, IfExprNullCondExpr(col 61:boolean, null, col 62:bigint)(children: LongColEqualLongScalar(col 11:bigint, val 1) -> 61:boolean, LongColSubtractLongScalar(col 11:bigint, val 1) -> 62:bigint) -> 63:bigint) -> 64:double, DoubleColUnaryMinus(col 65:double)(children: DoubleColSubtractDoubleColumn(col 1:double, col 2:double)(children: col 1:float) -> 65:double) -> 66:double
+                      projectedOutputColumnNums: [3, 1, 0, 4, 2, 13, 15, 24, 25, 8, 26, 27, 30, 35, 12, 39, 49, 50, 54, 59, 66, 68]
+                      selectExpressions: DoubleScalarAddDoubleColumn(val -26.28, col 2:double) -> 13:double, DoubleColUnaryMinus(col 14:double)(children: DoubleScalarAddDoubleColumn(val -26.28, col 2:double) -> 14:double) -> 15:double, FuncPowerDoubleToDouble(col 23:double)(children: DoubleColDivideLongColumn(col 19:double, col 22:bigint)(children: VectorUDFAdaptor(greatest(0,(_col5 - ((_col6 * _col6) / _col7))))(children: DoubleColSubtractDoubleColumn(col 5:double, col 17:double)(children: DoubleColDivideLongColumn(col 16:double, col 7:bigint)(children: DoubleColMultiplyDoubleColumn(col 6:double, col 6:double) -> 16:double) -> 17:double) -> 18:double) -> 19:double, IfExprNullCondExpr(col 20:boolean, null, col 21:bigint)(children: LongColEqualLongScalar(col 7:bigint, val 1) -> 20:boolean, LongColSubtractLongScalar(col 7:bigint, val 1) -> 21:bigint) -> 22:bigint) -> 23:double) -> 24:double, DoubleColMultiplyDoubleScalar(col 1:float, val -26.280000686645508) -> 25:float, DoubleColUnaryMinus(col 1:float) -> 26:float, DoubleColUnaryMinus(col 8:float) -> 27:float, DoubleColDivideDoubleScalar(col 29:double, val 10.175)(children: DoubleColUnaryMinus(col 28:double)(children: DoubleScalarAddDoubleColumn(val -26.28, col 2:double) -> 28:double) -> 29:double) -> 30:double, FuncPowerDoubleToDouble(col 34:double)(children: DoubleColDivideLongColumn(col 33:double, col 11:bigint)(children: DoubleColSubtractDoubleColumn(col 9:double, col 32:double)(children: DoubleColDivideLongColumn(col 31:double, col 11:bigint)(children: DoubleColMultiplyDoubleColumn(col 10:double, col 10:double) -> 31:double) -> 32:double) -> 33:double) -> 34:double) -> 35:double, DoubleColUnaryMinus(col 38:double)(children: DoubleColDivideDoubleScalar(col 37:double, val 10.175)(children: DoubleColUnaryMinus(col 36:double)(children: DoubleScalarAddDoubleColumn(val -26.28, col 2:double) -> 36:double) -> 37:double) -> 38:double) -> 39:double, DoubleScalarModuloDoubleColumn(val -1.389, col 48:double)(children: FuncPowerDoubleToDouble(col 47:double)(children: DoubleColDivideLongColumn(col 43:double, col 46:bigint)(children: VectorUDFAdaptor(greatest(0,(_col5 - ((_col6 * _col6) / _col7))))(children: DoubleColSubtractDoubleColumn(col 5:double, col 41:double)(children: DoubleColDivideLongColumn(col 40:double, col 7:bigint)(children: DoubleColMultiplyDoubleColumn(col 6:double, col 6:double) -> 40:double) -> 41:double) -> 42:double) -> 43:double, IfExprNullCondExpr(col 44:boolean, null, col 45:bigint)(children: LongColEqualLongScalar(col 7:bigint, val 1) -> 44:boolean, LongColSubtractLongScalar(col 7:bigint, val 1) -> 45:bigint) -> 46:bigint) -> 47:double) -> 48:double) -> 49:double, DoubleColSubtractDoubleColumn(col 1:double, col 2:double)(children: col 1:float) -> 50:double, DoubleColDivideLongColumn(col 53:double, col 11:bigint)(children: DoubleColSubtractDoubleColumn(col 9:double, col 52:double)(children: DoubleColDivideLongColumn(col 51:double, col 11:bigint)(children: DoubleColMultiplyDoubleColumn(col 10:double, col 10:double) -> 51:double) -> 52:double) -> 53:double) -> 54:double, DoubleColModuloDoubleScalar(col 58:double, val 10.175)(children: DoubleColDivideLongColumn(col 57:double, col 11:bigint)(children: DoubleColSubtractDoubleColumn(col 9:double, col 56:double)(children: DoubleColDivideLongColumn(col 55:double, col 11:bigint)(children: DoubleColMultiplyDoubleColumn(col 10:double, col 10:double) -> 55:double) -> 56:double) -> 57:double) -> 58:double) -> 59:double, DoubleColDivideLongColumn(col 62:double, col 65:bigint)(children: DoubleColSubtractDoubleColumn(col 9:double, col 61:double)(children: DoubleColDivideLongColumn(col 60:double, col 11:bigint)(children: DoubleColMultiplyDoubleColumn(col 10:double, col 10:double) -> 60:double) -> 61:double) -> 62:double, IfExprNullCondExpr(col 63:boolean, null, col 64:bigint)(children: LongColEqualLongScalar(col 11:bigint, val 1) -> 63:boolean, LongColSubtractLongScalar(col 11:bigint, val 1) -> 64:bigint) -> 65:bigint) -> 66:double, DoubleColUnaryMinus(col 67:double)(children: DoubleColSubtractDoubleColumn(col 1:double, col 2:double)(children: col 1:float) -> 67:double) -> 68:double
                   Statistics: Num rows: 758 Data size: 176010 Basic stats: COMPLETE Column stats: COMPLETE
                   Reduce Output Operator
                     key expressions: _col2 (type: string), _col1 (type: float), _col4 (type: double), _col0 (type: timestamp)
@@ -203,7 +203,7 @@ STAGE PLANS:
                         keyColumns: 0:string, 1:float, 2:double, 3:timestamp
                         native: true
                         nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
-                        valueColumns: 4:boolean, 13:double, 15:double, 23:double, 24:float, 8:float, 25:float, 26:float, 29:double, 34:double, 12:bigint, 38:double, 47:double, 48:double, 52:double, 57:double, 64:double, 66:double
+                        valueColumns: 4:boolean, 13:double, 15:double, 24:double, 25:float, 8:float, 26:float, 27:float, 30:double, 35:double, 12:bigint, 39:double, 49:double, 50:double, 54:double, 59:double, 66:double, 68:double
                     Statistics: Num rows: 758 Data size: 176010 Basic stats: COMPLETE Column stats: COMPLETE
                     value expressions: _col3 (type: boolean), _col5 (type: double), _col6 (type: double), _col7 (type: double), _col8 (type: float), _col9 (type: float), _col10 (type: float), _col11 (type: float), _col12 (type: double), _col13 (type: double), _col14 (type: bigint), _col15 (type: double), _col16 (type: double), _col17 (type: double), _col18 (type: double), _col19 (type: double), _col20 (type: double), _col21 (type: double)
         Reducer 3 
diff --git a/ql/src/test/results/clientpositive/llap/vectorization_16.q.out b/ql/src/test/results/clientpositive/llap/vectorization_16.q.out
index 3470389578..7e8cb81144 100644
--- a/ql/src/test/results/clientpositive/llap/vectorization_16.q.out
+++ b/ql/src/test/results/clientpositive/llap/vectorization_16.q.out
@@ -136,7 +136,7 @@ STAGE PLANS:
                 reduceColumnNullOrder: zzz
                 reduceColumnSortOrder: +++
                 allNative: false
-                usesVectorUDFAdaptor: false
+                usesVectorUDFAdaptor: true
                 vectorized: true
                 rowBatchContext:
                     dataColumnCount: 7
@@ -159,13 +159,13 @@ STAGE PLANS:
                 outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                 Statistics: Num rows: 5979 Data size: 825318 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
-                  expressions: _col0 (type: string), _col1 (type: double), _col2 (type: timestamp), (_col1 - 9763215.5639D) (type: double), (- (_col1 - 9763215.5639D)) (type: double), _col3 (type: bigint), power(((_col4 - ((_col5 * _col5) / _col3)) / if((_col3 = 1L), null, (_col3 - 1))), 0.5) (type: double), (- power(((_col4 - ((_col5 * _col5) / _col3)) / if((_col3 = 1L), null, (_col3 - 1))), 0.5)) (type: double), (power(((_col4 - ((_col5 * _col5) / _col3)) / if((_col3 = 1L), null, (_col3 - 1))), 0.5) * UDFToDouble(_col3)) (type: double), _col6 (type: double), (9763215.5639D / _col1) (type: double), (CAST( _col3 AS decimal(19,0)) / -1.389) (type: decimal(28,6)), power(((_col4 - ((_col5 * _col5) / _col3)) / if((_col3 = 1L), null, (_col3 - 1))), 0.5) (type: double)
+                  expressions: _col0 (type: string), _col1 (type: double), _col2 (type: timestamp), (_col1 - 9763215.5639D) (type: double), (- (_col1 - 9763215.5639D)) (type: double), _col3 (type: bigint), power((greatest(0,(_col4 - ((_col5 * _col5) / _col3))) / if((_col3 = 1L), null, (_col3 - 1))), 0.5) (type: double), (- power((greatest(0,(_col4 - ((_col5 * _col5) / _col3))) / if((_col3 = 1L), null, (_col3 - 1))), 0.5)) (type: double), (power((greatest(0,(_col4 - ((_col5 * _col5) / _col3))) / if((_col3 = 1L), null, (_col3 - 1))), 0.5) * UDFToDouble(_col3)) (type: double), _col6 (type: double), (9763215.5639D / _col1) (type: double), (CAST( _col3 AS decimal(19,0)) / -1.389) (type: decimal(28,6)), power((greatest(0,(_col4 - ((_col5 * _col5) / _col3))) / if((_col3 = 1L), null, (_col3 - 1))), 0.5) (type: double)
                   outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12
                   Select Vectorization:
                       className: VectorSelectOperator
                       native: true
-                      projectedOutputColumnNums: [0, 1, 2, 7, 9, 3, 17, 26, 36, 6, 37, 39, 47]
-                      selectExpressions: DoubleColSubtractDoubleScalar(col 1:double, val 9763215.5639) -> 7:double, DoubleColUnaryMinus(col 8:double)(children: DoubleColSubtractDoubleScalar(col 1:double, val 9763215.5639) -> 8:double) -> 9:double, FuncPowerDoubleToDouble(col 16:double)(children: DoubleColDivideLongColumn(col 12:double, col 15:bigint)(children: DoubleColSubtractDoubleColumn(col 4:double, col 11:double)(children: DoubleColDivideLongColumn(col 10:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 5:double, col 5:double) -> 10:double) -> 11:double) -> 12:double, IfExprNullCondExpr(col 13:boolean, null, col 14:bigint)(children: LongColEqualLongScalar(col 3:bigint, val 1) -> 13:boolean, LongColSubtractLongScalar(col 3:bigint, val 1) -> 14:bigint) -> 15:bigint) -> 16:double) -> 17:double, DoubleColUnaryMinus(col 25:double)(children: FuncPowerDoubleToDouble(col 24:double)(children: DoubleColDivideLongColumn(col 20:double, col 23:bigint)(children: DoubleColSubtractDoubleColumn(col 4:double, col 19:double)(children: DoubleColDivideLongColumn(col 18:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 5:double, col 5:double) -> 18:double) -> 19:double) -> 20:double, IfExprNullCondExpr(col 21:boolean, null, col 22:bigint)(children: LongColEqualLongScalar(col 3:bigint, val 1) -> 21:boolean, LongColSubtractLongScalar(col 3:bigint, val 1) -> 22:bigint) -> 23:bigint) -> 24:double) -> 25:double) -> 26:double, DoubleColMultiplyDoubleColumn(col 34:double, col 35:double)(children: FuncPowerDoubleToDouble(col 33:double)(children: DoubleColDivideLongColumn(col 29:double, col 32:bigint)(children: DoubleColSubtractDoubleColumn(col 4:double, col 28:double)(children: DoubleColDivideLongColumn(col 27:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 5:double, col 5:double) -> 27:double) -> 28:double) -> 29:double, IfExprNullCondExpr(col 30:boolean, null, col 31:bigint)(children: LongColEqualLongScalar(col 3:bigint, val 1) -> 30:boolean, LongColSubtractLongScalar(col 3:bigint, val 1) -> 31:bigint) -> 32:bigint) -> 33:double) -> 34:double, CastLongToDouble(col 3:bigint) -> 35:double) -> 36:double, DoubleScalarDivideDoubleColumn(val 9763215.5639, col 1:double) -> 37:double, DecimalColDivideDecimalScalar(col 38:decimal(19,0), val -1.389)(children: CastLongToDecimal(col 3:bigint) -> 38:decimal(19,0)) -> 39:decimal(28,6), FuncPowerDoubleToDouble(col 46:double)(children: DoubleColDivideLongColumn(col 42:double, col 45:bigint)(children: DoubleColSubtractDoubleColumn(col 4:double, col 41:double)(children: DoubleColDivideLongColumn(col 40:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 5:double, col 5:double) -> 40:double) -> 41:double) -> 42:double, IfExprNullCondExpr(col 43:boolean, null, col 44:bigint)(children: LongColEqualLongScalar(col 3:bigint, val 1) -> 43:boolean, LongColSubtractLongScalar(col 3:bigint, val 1) -> 44:bigint) -> 45:bigint) -> 46:double) -> 47:double
+                      projectedOutputColumnNums: [0, 1, 2, 7, 9, 3, 18, 28, 39, 6, 40, 42, 51]
+                      selectExpressions: DoubleColSubtractDoubleScalar(col 1:double, val 9763215.5639) -> 7:double, DoubleColUnaryMinus(col 8:double)(children: DoubleColSubtractDoubleScalar(col 1:double, val 9763215.5639) -> 8:double) -> 9:double, FuncPowerDoubleToDouble(col 17:double)(children: DoubleColDivideLongColumn(col 13:double, col 16:bigint)(children: VectorUDFAdaptor(greatest(0,(_col4 - ((_col5 * _col5) / _col3))))(children: DoubleColSubtractDoubleColumn(col 4:double, col 11:double)(children: DoubleColDivideLongColumn(col 10:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 5:double, col 5:double) -> 10:double) -> 11:double) -> 12:double) -> 13:double, IfExprNullCondExpr(col 14:boolean, null, col 15:bigint)(children: LongColEqualLongScalar(col 3:bigint, val 1) -> 14:boolean, LongColSubtractLongScalar(col 3:bigint, val 1) -> 15:bigint) -> 16:bigint) -> 17:double) -> 18:double, DoubleColUnaryMinus(col 27:double)(children: FuncPowerDoubleToDouble(col 26:double)(children: DoubleColDivideLongColumn(col 22:double, col 25:bigint)(children: VectorUDFAdaptor(greatest(0,(_col4 - ((_col5 * _col5) / _col3))))(children: DoubleColSubtractDoubleColumn(col 4:double, col 20:double)(children: DoubleColDivideLongColumn(col 19:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 5:double, col 5:double) -> 19:double) -> 20:double) -> 21:double) -> 22:double, IfExprNullCondExpr(col 23:boolean, null, col 24:bigint)(children: LongColEqualLongScalar(col 3:bigint, val 1) -> 23:boolean, LongColSubtractLongScalar(col 3:bigint, val 1) -> 24:bigint) -> 25:bigint) -> 26:double) -> 27:double) -> 28:double, DoubleColMultiplyDoubleColumn(col 37:double, col 38:double)(children: FuncPowerDoubleToDouble(col 36:double)(children: DoubleColDivideLongColumn(col 32:double, col 35:bigint)(children: VectorUDFAdaptor(greatest(0,(_col4 - ((_col5 * _col5) / _col3))))(children: DoubleColSubtractDoubleColumn(col 4:double, col 30:double)(children: DoubleColDivideLongColumn(col 29:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 5:double, col 5:double) -> 29:double) -> 30:double) -> 31:double) -> 32:double, IfExprNullCondExpr(col 33:boolean, null, col 34:bigint)(children: LongColEqualLongScalar(col 3:bigint, val 1) -> 33:boolean, LongColSubtractLongScalar(col 3:bigint, val 1) -> 34:bigint) -> 35:bigint) -> 36:double) -> 37:double, CastLongToDouble(col 3:bigint) -> 38:double) -> 39:double, DoubleScalarDivideDoubleColumn(val 9763215.5639, col 1:double) -> 40:double, DecimalColDivideDecimalScalar(col 41:decimal(19,0), val -1.389)(children: CastLongToDecimal(col 3:bigint) -> 41:decimal(19,0)) -> 42:decimal(28,6), FuncPowerDoubleToDouble(col 50:double)(children: DoubleColDivideLongColumn(col 46:double, col 49:bigint)(children: VectorUDFAdaptor(greatest(0,(_col4 - ((_col5 * _col5) / _col3))))(children: DoubleColSubtractDoubleColumn(col 4:double, col 44:double)(children: DoubleColDivideLongColumn(col 43:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 5:double, col 5:double) -> 43:double) -> 44:double) -> 45:double) -> 46:double, IfExprNullCondExpr(col 47:boolean, null, col 48:bigint)(children: LongColEqualLongScalar(col 3:bigint, val 1) -> 47:boolean, LongColSubtractLongScalar(col 3:bigint, val 1) -> 48:bigint) -> 49:bigint) -> 50:double) -> 51:double
                   Statistics: Num rows: 5979 Data size: 1734126 Basic stats: COMPLETE Column stats: COMPLETE
                   File Output Operator
                     compressed: false
diff --git a/ql/src/test/results/clientpositive/llap/vectorization_4.q.out b/ql/src/test/results/clientpositive/llap/vectorization_4.q.out
index 0f53eda28f..07a4df90ae 100644
--- a/ql/src/test/results/clientpositive/llap/vectorization_4.q.out
+++ b/ql/src/test/results/clientpositive/llap/vectorization_4.q.out
@@ -137,7 +137,7 @@ STAGE PLANS:
                 reduceColumnNullOrder: 
                 reduceColumnSortOrder: 
                 allNative: false
-                usesVectorUDFAdaptor: false
+                usesVectorUDFAdaptor: true
                 vectorized: true
                 rowBatchContext:
                     dataColumnCount: 5
@@ -158,13 +158,13 @@ STAGE PLANS:
                 outputColumnNames: _col0, _col1, _col2, _col3, _col4
                 Statistics: Num rows: 1 Data size: 36 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
-                  expressions: _col0 (type: bigint), (_col0 * -563L) (type: bigint), (-3728L + _col0) (type: bigint), power(((_col1 - ((_col2 * _col2) / _col3)) / _col3), 0.5) (type: double), (- power(((_col1 - ((_col2 * _col2) / _col3)) / _col3), 0.5)) (type: double), (_col2 / _col3) (type: double), ((_col0 * -563L) % _col0) (type: bigint), (UDFToDouble(((_col0 * -563L) % _col0)) / (_col2 / _col3)) (type: double), ((_col1 - ((_col2 * _col2) / _col3)) / _col3) (type: double), (- (UDFToDouble(((_col0 * -563L) % _col0)) / (_col2 / _col3))) (type: double), ((-3728L + _col0) - (_col0 * -563L)) (type: bigint), _col4 (type: tinyint), _col4 (type: tinyint), (UDFToDouble(_col4) * (- (UDFToDouble(((_col0 * -563L) % _col0)) / (_col2 / _col3)))) (type: double)
+                  expressions: _col0 (type: bigint), (_col0 * -563L) (type: bigint), (-3728L + _col0) (type: bigint), power((greatest(0,(_col1 - ((_col2 * _col2) / _col3))) / _col3), 0.5) (type: double), (- power((greatest(0,(_col1 - ((_col2 * _col2) / _col3))) / _col3), 0.5)) (type: double), (_col2 / _col3) (type: double), ((_col0 * -563L) % _col0) (type: bigint), (UDFToDouble(((_col0 * -563L) % _col0)) / (_col2 / _col3)) (type: double), (greatest(0,(_col1 - ((_col2 * _col2) / _col3))) / _col3) (type: double), (- (UDFToDouble(((_col0 * -563L) % _col0)) / (_col2 / _col3))) (type: double), ((-3728L + _col0) - (_col0 * -563L)) (type: bigint), _col4 (type: tinyint), _col4 (type: tinyint), (UDFToDouble(_col4) * (- (UDFToDouble(((_col0 * -563L) % _col0)) / (_col2 / _col3)))) (type: double)
                   outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13
                   Select Vectorization:
                       className: VectorSelectOperator
                       native: true
-                      projectedOutputColumnNums: [0, 5, 6, 11, 17, 18, 20, 25, 29, 35, 38, 4, 4, 46]
-                      selectExpressions: LongColMultiplyLongScalar(col 0:bigint, val -563) -> 5:bigint, LongScalarAddLongColumn(val -3728, col 0:bigint) -> 6:bigint, FuncPowerDoubleToDouble(col 10:double)(children: DoubleColDivideLongColumn(col 9:double, col 3:bigint)(children: DoubleColSubtractDoubleColumn(col 1:double, col 8:double)(children: DoubleColDivideLongColumn(col 7:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 2:double, col 2:double) -> 7:double) -> 8:double) -> 9:double) -> 10:double) -> 11:double, DoubleColUnaryMinus(col 16:double)(children: FuncPowerDoubleToDouble(col 15:double)(children: DoubleColDivideLongColumn(col 14:double, col 3:bigint)(children: DoubleColSubtractDoubleColumn(col 1:double, col 13:double)(children: DoubleColDivideLongColumn(col 12:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 2:double, col 2:double) -> 12:double) -> 13:double) -> 14:double) -> 15:double) -> 16:double) -> 17:double, DoubleColDivideLongColumn(col 2:double, col 3:bigint) -> 18:double, LongColModuloLongColumn(col 19:bigint, col 0:bigint)(children: LongColMultiplyLongScalar(col 0:bigint, val -563) -> 19:bigint) -> 20:bigint, DoubleColDivideDoubleColumn(col 23:double, col 24:double)(children: CastLongToDouble(col 22:bigint)(children: LongColModuloLongColumn(col 21:bigint, col 0:bigint)(children: LongColMultiplyLongScalar(col 0:bigint, val -563) -> 21:bigint) -> 22:bigint) -> 23:double, DoubleColDivideLongColumn(col 2:double, col 3:bigint) -> 24:double) -> 25:double, DoubleColDivideLongColumn(col 28:double, col 3:bigint)(children: DoubleColSubtractDoubleColumn(col 1:double, col 27:double)(children: DoubleColDivideLongColumn(col 26:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 2:double, col 2:double) -> 26:double) -> 27:double) -> 28:double) -> 29:double, DoubleColUnaryMinus(col 34:double)(children: DoubleColDivideDoubleColumn(col 32:double, col 33:double)(children: CastLongToDouble(col 31:bigint)(children: LongColModuloLongColumn(col 30:bigint, col 0:bigint)(children: LongColMultiplyLongScalar(col 0:bigint, val -563) -> 30:bigint) -> 31:bigint) -> 32:double, DoubleColDivideLongColumn(col 2:double, col 3:bigint) -> 33:double) -> 34:double) -> 35:double, LongColSubtractLongColumn(col 36:bigint, col 37:bigint)(children: LongScalarAddLongColumn(val -3728, col 0:bigint) -> 36:bigint, LongColMultiplyLongScalar(col 0:bigint, val -563) -> 37:bigint) -> 38:bigint, DoubleColMultiplyDoubleColumn(col 39:double, col 45:double)(children: CastLongToDouble(col 4:tinyint) -> 39:double, DoubleColUnaryMinus(col 44:double)(children: DoubleColDivideDoubleColumn(col 42:double, col 43:double)(children: CastLongToDouble(col 41:bigint)(children: LongColModuloLongColumn(col 40:bigint, col 0:bigint)(children: LongColMultiplyLongScalar(col 0:bigint, val -563) -> 40:bigint) -> 41:bigint) -> 42:double, DoubleColDivideLongColumn(col 2:double, col 3:bigint) -> 43:double) -> 44:double) -> 45:double) -> 46:double
+                      projectedOutputColumnNums: [0, 5, 6, 12, 19, 20, 22, 27, 32, 38, 41, 4, 4, 49]
+                      selectExpressions: LongColMultiplyLongScalar(col 0:bigint, val -563) -> 5:bigint, LongScalarAddLongColumn(val -3728, col 0:bigint) -> 6:bigint, FuncPowerDoubleToDouble(col 11:double)(children: DoubleColDivideLongColumn(col 10:double, col 3:bigint)(children: VectorUDFAdaptor(greatest(0,(_col1 - ((_col2 * _col2) / _col3))))(children: DoubleColSubtractDoubleColumn(col 1:double, col 8:double)(children: DoubleColDivideLongColumn(col 7:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 2:double, col 2:double) -> 7:double) -> 8:double) -> 9:double) -> 10:double) -> 11:double) -> 12:double, DoubleColUnaryMinus(col 18:double)(children: FuncPowerDoubleToDouble(col 17:double)(children: DoubleColDivideLongColumn(col 16:double, col 3:bigint)(children: VectorUDFAdaptor(greatest(0,(_col1 - ((_col2 * _col2) / _col3))))(children: DoubleColSubtractDoubleColumn(col 1:double, col 14:double)(children: DoubleColDivideLongColumn(col 13:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 2:double, col 2:double) -> 13:double) -> 14:double) -> 15:double) -> 16:double) -> 17:double) -> 18:double) -> 19:double, DoubleColDivideLongColumn(col 2:double, col 3:bigint) -> 20:double, LongColModuloLongColumn(col 21:bigint, col 0:bigint)(children: LongColMultiplyLongScalar(col 0:bigint, val -563) -> 21:bigint) -> 22:bigint, DoubleColDivideDoubleColumn(col 25:double, col 26:double)(children: CastLongToDouble(col 24:bigint)(children: LongColModuloLongColumn(col 23:bigint, col 0:bigint)(children: LongColMultiplyLongScalar(col 0:bigint, val -563) -> 23:bigint) -> 24:bigint) -> 25:double, DoubleColDivideLongColumn(col 2:double, col 3:bigint) -> 26:double) -> 27:double, DoubleColDivideLongColumn(col 31:double, col 3:bigint)(children: VectorUDFAdaptor(greatest(0,(_col1 - ((_col2 * _col2) / _col3))))(children: DoubleColSubtractDoubleColumn(col 1:double, col 29:double)(children: DoubleColDivideLongColumn(col 28:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 2:double, col 2:double) -> 28:double) -> 29:double) -> 30:double) -> 31:double) -> 32:double, DoubleColUnaryMinus(col 37:double)(children: DoubleColDivideDoubleColumn(col 35:double, col 36:double)(children: CastLongToDouble(col 34:bigint)(children: LongColModuloLongColumn(col 33:bigint, col 0:bigint)(children: LongColMultiplyLongScalar(col 0:bigint, val -563) -> 33:bigint) -> 34:bigint) -> 35:double, DoubleColDivideLongColumn(col 2:double, col 3:bigint) -> 36:double) -> 37:double) -> 38:double, LongColSubtractLongColumn(col 39:bigint, col 40:bigint)(children: LongScalarAddLongColumn(val -3728, col 0:bigint) -> 39:bigint, LongColMultiplyLongScalar(col 0:bigint, val -563) -> 40:bigint) -> 41:bigint, DoubleColMultiplyDoubleColumn(col 42:double, col 48:double)(children: CastLongToDouble(col 4:tinyint) -> 42:double, DoubleColUnaryMinus(col 47:double)(children: DoubleColDivideDoubleColumn(col 45:double, col 46:double)(children: CastLongToDouble(col 44:bigint)(children: LongColModuloLongColumn(col 43:bigint, col 0:bigint)(children: LongColMultiplyLongScalar(col 0:bigint, val -563) -> 43:bigint) -> 44:bigint) -> 45:double, DoubleColDivideLongColumn(col 2:double, col 3:bigint) -> 46:double) -> 47:double) -> 48:double) -> 49:double
                   Statistics: Num rows: 1 Data size: 104 Basic stats: COMPLETE Column stats: COMPLETE
                   File Output Operator
                     compressed: false
diff --git a/ql/src/test/results/clientpositive/llap/vectorization_9.q.out b/ql/src/test/results/clientpositive/llap/vectorization_9.q.out
index 3470389578..7e8cb81144 100644
--- a/ql/src/test/results/clientpositive/llap/vectorization_9.q.out
+++ b/ql/src/test/results/clientpositive/llap/vectorization_9.q.out
@@ -136,7 +136,7 @@ STAGE PLANS:
                 reduceColumnNullOrder: zzz
                 reduceColumnSortOrder: +++
                 allNative: false
-                usesVectorUDFAdaptor: false
+                usesVectorUDFAdaptor: true
                 vectorized: true
                 rowBatchContext:
                     dataColumnCount: 7
@@ -159,13 +159,13 @@ STAGE PLANS:
                 outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                 Statistics: Num rows: 5979 Data size: 825318 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
-                  expressions: _col0 (type: string), _col1 (type: double), _col2 (type: timestamp), (_col1 - 9763215.5639D) (type: double), (- (_col1 - 9763215.5639D)) (type: double), _col3 (type: bigint), power(((_col4 - ((_col5 * _col5) / _col3)) / if((_col3 = 1L), null, (_col3 - 1))), 0.5) (type: double), (- power(((_col4 - ((_col5 * _col5) / _col3)) / if((_col3 = 1L), null, (_col3 - 1))), 0.5)) (type: double), (power(((_col4 - ((_col5 * _col5) / _col3)) / if((_col3 = 1L), null, (_col3 - 1))), 0.5) * UDFToDouble(_col3)) (type: double), _col6 (type: double), (9763215.5639D / _col1) (type: double), (CAST( _col3 AS decimal(19,0)) / -1.389) (type: decimal(28,6)), power(((_col4 - ((_col5 * _col5) / _col3)) / if((_col3 = 1L), null, (_col3 - 1))), 0.5) (type: double)
+                  expressions: _col0 (type: string), _col1 (type: double), _col2 (type: timestamp), (_col1 - 9763215.5639D) (type: double), (- (_col1 - 9763215.5639D)) (type: double), _col3 (type: bigint), power((greatest(0,(_col4 - ((_col5 * _col5) / _col3))) / if((_col3 = 1L), null, (_col3 - 1))), 0.5) (type: double), (- power((greatest(0,(_col4 - ((_col5 * _col5) / _col3))) / if((_col3 = 1L), null, (_col3 - 1))), 0.5)) (type: double), (power((greatest(0,(_col4 - ((_col5 * _col5) / _col3))) / if((_col3 = 1L), null, (_col3 - 1))), 0.5) * UDFToDouble(_col3)) (type: double), _col6 (type: double), (9763215.5639D / _col1) (type: double), (CAST( _col3 AS decimal(19,0)) / -1.389) (type: decimal(28,6)), power((greatest(0,(_col4 - ((_col5 * _col5) / _col3))) / if((_col3 = 1L), null, (_col3 - 1))), 0.5) (type: double)
                   outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12
                   Select Vectorization:
                       className: VectorSelectOperator
                       native: true
-                      projectedOutputColumnNums: [0, 1, 2, 7, 9, 3, 17, 26, 36, 6, 37, 39, 47]
-                      selectExpressions: DoubleColSubtractDoubleScalar(col 1:double, val 9763215.5639) -> 7:double, DoubleColUnaryMinus(col 8:double)(children: DoubleColSubtractDoubleScalar(col 1:double, val 9763215.5639) -> 8:double) -> 9:double, FuncPowerDoubleToDouble(col 16:double)(children: DoubleColDivideLongColumn(col 12:double, col 15:bigint)(children: DoubleColSubtractDoubleColumn(col 4:double, col 11:double)(children: DoubleColDivideLongColumn(col 10:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 5:double, col 5:double) -> 10:double) -> 11:double) -> 12:double, IfExprNullCondExpr(col 13:boolean, null, col 14:bigint)(children: LongColEqualLongScalar(col 3:bigint, val 1) -> 13:boolean, LongColSubtractLongScalar(col 3:bigint, val 1) -> 14:bigint) -> 15:bigint) -> 16:double) -> 17:double, DoubleColUnaryMinus(col 25:double)(children: FuncPowerDoubleToDouble(col 24:double)(children: DoubleColDivideLongColumn(col 20:double, col 23:bigint)(children: DoubleColSubtractDoubleColumn(col 4:double, col 19:double)(children: DoubleColDivideLongColumn(col 18:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 5:double, col 5:double) -> 18:double) -> 19:double) -> 20:double, IfExprNullCondExpr(col 21:boolean, null, col 22:bigint)(children: LongColEqualLongScalar(col 3:bigint, val 1) -> 21:boolean, LongColSubtractLongScalar(col 3:bigint, val 1) -> 22:bigint) -> 23:bigint) -> 24:double) -> 25:double) -> 26:double, DoubleColMultiplyDoubleColumn(col 34:double, col 35:double)(children: FuncPowerDoubleToDouble(col 33:double)(children: DoubleColDivideLongColumn(col 29:double, col 32:bigint)(children: DoubleColSubtractDoubleColumn(col 4:double, col 28:double)(children: DoubleColDivideLongColumn(col 27:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 5:double, col 5:double) -> 27:double) -> 28:double) -> 29:double, IfExprNullCondExpr(col 30:boolean, null, col 31:bigint)(children: LongColEqualLongScalar(col 3:bigint, val 1) -> 30:boolean, LongColSubtractLongScalar(col 3:bigint, val 1) -> 31:bigint) -> 32:bigint) -> 33:double) -> 34:double, CastLongToDouble(col 3:bigint) -> 35:double) -> 36:double, DoubleScalarDivideDoubleColumn(val 9763215.5639, col 1:double) -> 37:double, DecimalColDivideDecimalScalar(col 38:decimal(19,0), val -1.389)(children: CastLongToDecimal(col 3:bigint) -> 38:decimal(19,0)) -> 39:decimal(28,6), FuncPowerDoubleToDouble(col 46:double)(children: DoubleColDivideLongColumn(col 42:double, col 45:bigint)(children: DoubleColSubtractDoubleColumn(col 4:double, col 41:double)(children: DoubleColDivideLongColumn(col 40:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 5:double, col 5:double) -> 40:double) -> 41:double) -> 42:double, IfExprNullCondExpr(col 43:boolean, null, col 44:bigint)(children: LongColEqualLongScalar(col 3:bigint, val 1) -> 43:boolean, LongColSubtractLongScalar(col 3:bigint, val 1) -> 44:bigint) -> 45:bigint) -> 46:double) -> 47:double
+                      projectedOutputColumnNums: [0, 1, 2, 7, 9, 3, 18, 28, 39, 6, 40, 42, 51]
+                      selectExpressions: DoubleColSubtractDoubleScalar(col 1:double, val 9763215.5639) -> 7:double, DoubleColUnaryMinus(col 8:double)(children: DoubleColSubtractDoubleScalar(col 1:double, val 9763215.5639) -> 8:double) -> 9:double, FuncPowerDoubleToDouble(col 17:double)(children: DoubleColDivideLongColumn(col 13:double, col 16:bigint)(children: VectorUDFAdaptor(greatest(0,(_col4 - ((_col5 * _col5) / _col3))))(children: DoubleColSubtractDoubleColumn(col 4:double, col 11:double)(children: DoubleColDivideLongColumn(col 10:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 5:double, col 5:double) -> 10:double) -> 11:double) -> 12:double) -> 13:double, IfExprNullCondExpr(col 14:boolean, null, col 15:bigint)(children: LongColEqualLongScalar(col 3:bigint, val 1) -> 14:boolean, LongColSubtractLongScalar(col 3:bigint, val 1) -> 15:bigint) -> 16:bigint) -> 17:double) -> 18:double, DoubleColUnaryMinus(col 27:double)(children: FuncPowerDoubleToDouble(col 26:double)(children: DoubleColDivideLongColumn(col 22:double, col 25:bigint)(children: VectorUDFAdaptor(greatest(0,(_col4 - ((_col5 * _col5) / _col3))))(children: DoubleColSubtractDoubleColumn(col 4:double, col 20:double)(children: DoubleColDivideLongColumn(col 19:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 5:double, col 5:double) -> 19:double) -> 20:double) -> 21:double) -> 22:double, IfExprNullCondExpr(col 23:boolean, null, col 24:bigint)(children: LongColEqualLongScalar(col 3:bigint, val 1) -> 23:boolean, LongColSubtractLongScalar(col 3:bigint, val 1) -> 24:bigint) -> 25:bigint) -> 26:double) -> 27:double) -> 28:double, DoubleColMultiplyDoubleColumn(col 37:double, col 38:double)(children: FuncPowerDoubleToDouble(col 36:double)(children: DoubleColDivideLongColumn(col 32:double, col 35:bigint)(children: VectorUDFAdaptor(greatest(0,(_col4 - ((_col5 * _col5) / _col3))))(children: DoubleColSubtractDoubleColumn(col 4:double, col 30:double)(children: DoubleColDivideLongColumn(col 29:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 5:double, col 5:double) -> 29:double) -> 30:double) -> 31:double) -> 32:double, IfExprNullCondExpr(col 33:boolean, null, col 34:bigint)(children: LongColEqualLongScalar(col 3:bigint, val 1) -> 33:boolean, LongColSubtractLongScalar(col 3:bigint, val 1) -> 34:bigint) -> 35:bigint) -> 36:double) -> 37:double, CastLongToDouble(col 3:bigint) -> 38:double) -> 39:double, DoubleScalarDivideDoubleColumn(val 9763215.5639, col 1:double) -> 40:double, DecimalColDivideDecimalScalar(col 41:decimal(19,0), val -1.389)(children: CastLongToDecimal(col 3:bigint) -> 41:decimal(19,0)) -> 42:decimal(28,6), FuncPowerDoubleToDouble(col 50:double)(children: DoubleColDivideLongColumn(col 46:double, col 49:bigint)(children: VectorUDFAdaptor(greatest(0,(_col4 - ((_col5 * _col5) / _col3))))(children: DoubleColSubtractDoubleColumn(col 4:double, col 44:double)(children: DoubleColDivideLongColumn(col 43:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 5:double, col 5:double) -> 43:double) -> 44:double) -> 45:double) -> 46:double, IfExprNullCondExpr(col 47:boolean, null, col 48:bigint)(children: LongColEqualLongScalar(col 3:bigint, val 1) -> 47:boolean, LongColSubtractLongScalar(col 3:bigint, val 1) -> 48:bigint) -> 49:bigint) -> 50:double) -> 51:double
                   Statistics: Num rows: 5979 Data size: 1734126 Basic stats: COMPLETE Column stats: COMPLETE
                   File Output Operator
                     compressed: false
diff --git a/ql/src/test/results/clientpositive/llap/vectorization_input_format_excludes.q.out b/ql/src/test/results/clientpositive/llap/vectorization_input_format_excludes.q.out
index 7b659f3a49..ae37170904 100644
--- a/ql/src/test/results/clientpositive/llap/vectorization_input_format_excludes.q.out
+++ b/ql/src/test/results/clientpositive/llap/vectorization_input_format_excludes.q.out
@@ -216,7 +216,7 @@ STAGE PLANS:
                 enabled: true
                 enableConditionsMet: hive.vectorized.execution.reduce.enabled IS true, hive.execution.engine tez IN [tez] IS true
                 allNative: false
-                usesVectorUDFAdaptor: false
+                usesVectorUDFAdaptor: true
                 vectorized: true
             Reduce Operator Tree:
               Group By Operator
@@ -226,7 +226,7 @@ STAGE PLANS:
                 outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                 Statistics: Num rows: 128 Data size: 7556 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
-                  expressions: _col0 (type: tinyint), _col1 (type: int), _col2 (type: smallint), _col3 (type: bigint), (_col4 / _col5) (type: double), power(((_col6 - ((_col7 * _col7) / _col8)) / _col8), 0.5) (type: double)
+                  expressions: _col0 (type: tinyint), _col1 (type: int), _col2 (type: smallint), _col3 (type: bigint), (_col4 / _col5) (type: double), power((greatest(0,(_col6 - ((_col7 * _col7) / _col8))) / _col8), 0.5) (type: double)
                   outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                   Statistics: Num rows: 128 Data size: 4484 Basic stats: COMPLETE Column stats: COMPLETE
                   File Output Operator
@@ -553,7 +553,7 @@ STAGE PLANS:
                 enabled: true
                 enableConditionsMet: hive.vectorized.execution.reduce.enabled IS true, hive.execution.engine tez IN [tez] IS true
                 allNative: false
-                usesVectorUDFAdaptor: false
+                usesVectorUDFAdaptor: true
                 vectorized: true
             Reduce Operator Tree:
               Group By Operator
@@ -563,7 +563,7 @@ STAGE PLANS:
                 outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                 Statistics: Num rows: 128 Data size: 7556 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
-                  expressions: _col0 (type: tinyint), _col1 (type: int), _col2 (type: smallint), _col3 (type: bigint), (_col4 / _col5) (type: double), power(((_col6 - ((_col7 * _col7) / _col8)) / _col8), 0.5) (type: double)
+                  expressions: _col0 (type: tinyint), _col1 (type: int), _col2 (type: smallint), _col3 (type: bigint), (_col4 / _col5) (type: double), power((greatest(0,(_col6 - ((_col7 * _col7) / _col8))) / _col8), 0.5) (type: double)
                   outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                   Statistics: Num rows: 128 Data size: 4484 Basic stats: COMPLETE Column stats: COMPLETE
                   File Output Operator
@@ -900,7 +900,7 @@ STAGE PLANS:
                 enabled: true
                 enableConditionsMet: hive.vectorized.execution.reduce.enabled IS true, hive.execution.engine tez IN [tez] IS true
                 allNative: false
-                usesVectorUDFAdaptor: false
+                usesVectorUDFAdaptor: true
                 vectorized: true
             Reduce Operator Tree:
               Group By Operator
@@ -910,7 +910,7 @@ STAGE PLANS:
                 outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                 Statistics: Num rows: 128 Data size: 7556 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
-                  expressions: _col0 (type: tinyint), _col1 (type: int), _col2 (type: smallint), _col3 (type: bigint), (_col4 / _col5) (type: double), power(((_col6 - ((_col7 * _col7) / _col8)) / _col8), 0.5) (type: double)
+                  expressions: _col0 (type: tinyint), _col1 (type: int), _col2 (type: smallint), _col3 (type: bigint), (_col4 / _col5) (type: double), power((greatest(0,(_col6 - ((_col7 * _col7) / _col8))) / _col8), 0.5) (type: double)
                   outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                   Statistics: Num rows: 128 Data size: 4484 Basic stats: COMPLETE Column stats: COMPLETE
                   File Output Operator
@@ -1285,7 +1285,7 @@ STAGE PLANS:
                 enabled: true
                 enableConditionsMet: hive.vectorized.execution.reduce.enabled IS true, hive.execution.engine tez IN [tez] IS true
                 allNative: false
-                usesVectorUDFAdaptor: false
+                usesVectorUDFAdaptor: true
                 vectorized: true
             Reduce Operator Tree:
               Group By Operator
@@ -1295,7 +1295,7 @@ STAGE PLANS:
                 outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                 Statistics: Num rows: 128 Data size: 7556 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
-                  expressions: _col0 (type: tinyint), _col1 (type: int), _col2 (type: smallint), _col3 (type: bigint), (_col4 / _col5) (type: double), power(((_col6 - ((_col7 * _col7) / _col8)) / _col8), 0.5) (type: double)
+                  expressions: _col0 (type: tinyint), _col1 (type: int), _col2 (type: smallint), _col3 (type: bigint), (_col4 / _col5) (type: double), power((greatest(0,(_col6 - ((_col7 * _col7) / _col8))) / _col8), 0.5) (type: double)
                   outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                   Statistics: Num rows: 128 Data size: 4484 Basic stats: COMPLETE Column stats: COMPLETE
                   File Output Operator
diff --git a/ql/src/test/results/clientpositive/llap/vectorization_short_regress.q.out b/ql/src/test/results/clientpositive/llap/vectorization_short_regress.q.out
index b4331a4c33..da82903d79 100644
--- a/ql/src/test/results/clientpositive/llap/vectorization_short_regress.q.out
+++ b/ql/src/test/results/clientpositive/llap/vectorization_short_regress.q.out
@@ -694,7 +694,7 @@ STAGE PLANS:
                 enabled: true
                 enableConditionsMet: hive.vectorized.execution.reduce.enabled IS true, hive.execution.engine tez IN [tez] IS true
                 allNative: false
-                usesVectorUDFAdaptor: false
+                usesVectorUDFAdaptor: true
                 vectorized: true
             Reduce Operator Tree:
               Group By Operator
@@ -710,13 +710,13 @@ STAGE PLANS:
                 outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13
                 Statistics: Num rows: 1 Data size: 104 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
-                  expressions: ((_col0 - ((_col1 * _col1) / _col2)) / _col2) (type: double), (- ((_col0 - ((_col1 * _col1) / _col2)) / _col2)) (type: double), (((_col0 - ((_col1 * _col1) / _col2)) / _col2) - (- ((_col0 - ((_col1 * _col1) / _col2)) / _col2))) (type: double), _col3 (type: bigint), (CAST( _col3 AS decimal(19,0)) % 79.553) (type: decimal(5,3)), _col4 (type: tinyint), (UDFToDouble(_col3) - (- ((_col0 - ((_col1 * _col1) / _col2)) / _col2))) (type: double), ((_col0 - ((_col1 * _col1) / _col2)) / _col2) (type: double), (-1.0D % (- ((_col0 - ((_col1 * _col1) / _col2)) / _col2))) (type: double), _col3 (type: bigint), (- _col3) (type: bigint), power(((_col5 - ((_col6 * _col6) / _col7)) / _col7), 0.5) (type: double), (- ((_col0 - ((_col1 * _col1) / _col2)) / _col2)) (type: double), (762L * (- _col3)) (type: bigint), _col8 (type: int), (UDFToLong(_col4) + (762L * (- _col3))) (type: bigint), ((- ((_col0 - ((_col1 * _col1) / _col2)) / _col2)) + UDFToDouble(_col8)) (type: double), power(((_col9 - ((_col10 * _col10) / _col11)) / if((_col11 = 1L), null, (_col11 - 1))), 0.5) (type: double), ((- _col3) % _col3) (type: bigint), _col12 (type: bigint), (UDFToDouble(_col13) / _col12) (type: double), (-3728L % (UDFToLong(_col4) + (762L * (- _col3)))) (type: bigint)
+                  expressions: ((_col0 - ((_col1 * _col1) / _col2)) / _col2) (type: double), (- ((_col0 - ((_col1 * _col1) / _col2)) / _col2)) (type: double), (((_col0 - ((_col1 * _col1) / _col2)) / _col2) - (- ((_col0 - ((_col1 * _col1) / _col2)) / _col2))) (type: double), _col3 (type: bigint), (CAST( _col3 AS decimal(19,0)) % 79.553) (type: decimal(5,3)), _col4 (type: tinyint), (UDFToDouble(_col3) - (- ((_col0 - ((_col1 * _col1) / _col2)) / _col2))) (type: double), ((_col0 - ((_col1 * _col1) / _col2)) / _col2) (type: double), (-1.0D % (- ((_col0 - ((_col1 * _col1) / _col2)) / _col2))) (type: double), _col3 (type: bigint), (- _col3) (type: bigint), power(((_col5 - ((_col6 * _col6) / _col7)) / _col7), 0.5) (type: double), (- ((_col0 - ((_col1 * _col1) / _col2)) / _col2)) (type: double), (762L * (- _col3)) (type: bigint), _col8 (type: int), (UDFToLong(_col4) + (762L * (- _col3))) (type: bigint), ((- ((_col0 - ((_col1 * _col1) / _col2)) / _col2)) + UDFToDouble(_col8)) (type: double), power((greatest(0,(_col9 - ((_col10 * _col10) / _col11))) / if((_col11 = 1L), null, (_col11 - 1))), 0.5) (type: double), ((- _col3) % _col3) (type: bigint), _col12 (type: bigint), (UDFToDouble(_col13) / _col12) (type: double), (-3728L % (UDFToLong(_col4) + (762L * (- _col3)))) (type: bigint)
                   outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21
                   Select Vectorization:
                       className: VectorSelectOperator
                       native: true
-                      projectedOutputColumnNums: [17, 22, 32, 3, 34, 4, 41, 45, 51, 3, 52, 57, 62, 64, 8, 67, 74, 82, 84, 12, 86, 90]
-                      selectExpressions: DoubleColDivideLongColumn(col 16:double, col 2:bigint)(children: DoubleColSubtractDoubleColumn(col 0:double, col 15:double)(children: DoubleColDivideLongColumn(col 14:double, col 2:bigint)(children: DoubleColMultiplyDoubleColumn(col 1:double, col 1:double) -> 14:double) -> 15:double) -> 16:double) -> 17:double, DoubleColUnaryMinus(col 21:double)(children: DoubleColDivideLongColumn(col 20:double, col 2:bigint)(children: DoubleColSubtractDoubleColumn(col 0:double, col 19:double)(children: DoubleColDivideLongColumn(col 18:double, col 2:bigint)(children: DoubleColMultiplyDoubleColumn(col 1:double, col 1:double) -> 18:double) -> 19:double) -> 20:double) -> 21:double) -> 22:double, DoubleColSubtractDoubleColumn(col 26:double, col 31:double)(children: DoubleColDivideLongColumn(col 25:double, col 2:bigint)(children: DoubleColSubtractDoubleColumn(col 0:double, col 24:double)(children: DoubleColDivideLongColumn(col 23:double, col 2:bigint)(children: DoubleColMultiplyDoubleColumn(col 1:double, col 1:double) -> 23:double) -> 24:double) -> 25:double) -> 26:double, DoubleColUnaryMinus(col 30:double)(children: DoubleColDivideLongColumn(col 29:double, col 2:bigint)(children: DoubleColSubtractDoubleColumn(col 0:double, col 28:double)(children: DoubleColDivideLongColumn(col 27:double, col 2:bigint)(children: DoubleColMultiplyDoubleColumn(col 1:double, col 1:double) -> 27:double) -> 28:double) -> 29:double) -> 30:double) -> 31:double) -> 32:double, DecimalColModuloDecimalScalar(col 33:decimal(19,0), val 79.553)(children: CastLongToDecimal(col 3:bigint) -> 33:decimal(19,0)) -> 34:decimal(5,3), DoubleColSubtractDoubleColumn(col 35:double, col 40:double)(children: CastLongToDouble(col 3:bigint) -> 35:double, DoubleColUnaryMinus(col 39:double)(children: DoubleColDivideLongColumn(col 38:double, col 2:bigint)(children: DoubleColSubtractDoubleColumn(col 0:double, col 37:double)(children: DoubleColDivideLongColumn(col 36:double, col 2:bigint)(children: DoubleColMultiplyDoubleColumn(col 1:double, col 1:double) -> 36:double) -> 37:double) -> 38:double) -> 39:double) -> 40:double) -> 41:double, DoubleColDivideLongColumn(col 44:double, col 2:bigint)(children: DoubleColSubtractDoubleColumn(col 0:double, col 43:double)(children: DoubleColDivideLongColumn(col 42:double, col 2:bigint)(children: DoubleColMultiplyDoubleColumn(col 1:double, col 1:double) -> 42:double) -> 43:double) -> 44:double) -> 45:double, DoubleScalarModuloDoubleColumn(val -1.0, col 50:double)(children: DoubleColUnaryMinus(col 49:double)(children: DoubleColDivideLongColumn(col 48:double, col 2:bigint)(children: DoubleColSubtractDoubleColumn(col 0:double, col 47:double)(children: DoubleColDivideLongColumn(col 46:double, col 2:bigint)(children: DoubleColMultiplyDoubleColumn(col 1:double, col 1:double) -> 46:double) -> 47:double) -> 48:double) -> 49:double) -> 50:double) -> 51:double, LongColUnaryMinus(col 3:bigint) -> 52:bigint, FuncPowerDoubleToDouble(col 56:double)(children: DoubleColDivideLongColumn(col 55:double, col 7:bigint)(children: DoubleColSubtractDoubleColumn(col 5:double, col 54:double)(children: DoubleColDivideLongColumn(col 53:double, col 7:bigint)(children: DoubleColMultiplyDoubleColumn(col 6:double, col 6:double) -> 53:double) -> 54:double) -> 55:double) -> 56:double) -> 57:double, DoubleColUnaryMinus(col 61:double)(children: DoubleColDivideLongColumn(col 60:double, col 2:bigint)(children: DoubleColSubtractDoubleColumn(col 0:double, col 59:double)(children: DoubleColDivideLongColumn(col 58:double, col 2:bigint)(children: DoubleColMultiplyDoubleColumn(col 1:double, col 1:double) -> 58:double) -> 59:double) -> 60:double) -> 61:double) -> 62:double, LongScalarMultiplyLongColumn(val 762, col 63:bigint)(children: LongColUnaryMinus(col 3:bigint) -> 63:bigint) -> 64:bigint, LongColAddLongColumn(col 4:bigint, col 66:bigint)(children: col 4:tinyint, LongScalarMultiplyLongColumn(val 762, col 65:bigint)(children: LongColUnaryMinus(col 3:bigint) -> 65:bigint) -> 66:bigint) -> 67:bigint, DoubleColAddDoubleColumn(col 72:double, col 73:double)(children: DoubleColUnaryMinus(col 71:double)(children: DoubleColDivideLongColumn(col 70:double, col 2:bigint)(children: DoubleColSubtractDoubleColumn(col 0:double, col 69:double)(children: DoubleColDivideLongColumn(col 68:double, col 2:bigint)(children: DoubleColMultiplyDoubleColumn(col 1:double, col 1:double) -> 68:double) -> 69:double) -> 70:double) -> 71:double) -> 72:double, CastLongToDouble(col 8:int) -> 73:double) -> 74:double, FuncPowerDoubleToDouble(col 81:double)(children: DoubleColDivideLongColumn(col 77:double, col 80:bigint)(children: DoubleColSubtractDoubleColumn(col 9:double, col 76:double)(children: DoubleColDivideLongColumn(col 75:double, col 11:bigint)(children: DoubleColMultiplyDoubleColumn(col 10:double, col 10:double) -> 75:double) -> 76:double) -> 77:double, IfExprNullCondExpr(col 78:boolean, null, col 79:bigint)(children: LongColEqualLongScalar(col 11:bigint, val 1) -> 78:boolean, LongColSubtractLongScalar(col 11:bigint, val 1) -> 79:bigint) -> 80:bigint) -> 81:double) -> 82:double, LongColModuloLongColumn(col 83:bigint, col 3:bigint)(children: LongColUnaryMinus(col 3:bigint) -> 83:bigint) -> 84:bigint, DoubleColDivideLongColumn(col 85:double, col 12:bigint)(children: CastLongToDouble(col 13:bigint) -> 85:double) -> 86:double, LongScalarModuloLongColumn(val -3728, col 89:bigint)(children: LongColAddLongColumn(col 4:bigint, col 88:bigint)(children: col 4:tinyint, LongScalarMultiplyLongColumn(val 762, col 87:bigint)(children: LongColUnaryMinus(col 3:bigint) -> 87:bigint) -> 88:bigint) -> 89:bigint) -> 90:bigint
+                      projectedOutputColumnNums: [17, 22, 32, 3, 34, 4, 41, 45, 51, 3, 52, 57, 62, 64, 8, 67, 74, 83, 85, 12, 87, 91]
+                      selectExpressions: DoubleColDivideLongColumn(col 16:double, col 2:bigint)(children: DoubleColSubtractDoubleColumn(col 0:double, col 15:double)(children: DoubleColDivideLongColumn(col 14:double, col 2:bigint)(children: DoubleColMultiplyDoubleColumn(col 1:double, col 1:double) -> 14:double) -> 15:double) -> 16:double) -> 17:double, DoubleColUnaryMinus(col 21:double)(children: DoubleColDivideLongColumn(col 20:double, col 2:bigint)(children: DoubleColSubtractDoubleColumn(col 0:double, col 19:double)(children: DoubleColDivideLongColumn(col 18:double, col 2:bigint)(children: DoubleColMultiplyDoubleColumn(col 1:double, col 1:double) -> 18:double) -> 19:double) -> 20:double) -> 21:double) -> 22:double, DoubleColSubtractDoubleColumn(col 26:double, col 31:double)(children: DoubleColDivideLongColumn(col 25:double, col 2:bigint)(children: DoubleColSubtractDoubleColumn(col 0:double, col 24:double)(children: DoubleColDivideLongColumn(col 23:double, col 2:bigint)(children: DoubleColMultiplyDoubleColumn(col 1:double, col 1:double) -> 23:double) -> 24:double) -> 25:double) -> 26:double, DoubleColUnaryMinus(col 30:double)(children: DoubleColDivideLongColumn(col 29:double, col 2:bigint)(children: DoubleColSubtractDoubleColumn(col 0:double, col 28:double)(children: DoubleColDivideLongColumn(col 27:double, col 2:bigint)(children: DoubleColMultiplyDoubleColumn(col 1:double, col 1:double) -> 27:double) -> 28:double) -> 29:double) -> 30:double) -> 31:double) -> 32:double, DecimalColModuloDecimalScalar(col 33:decimal(19,0), val 79.553)(children: CastLongToDecimal(col 3:bigint) -> 33:decimal(19,0)) -> 34:decimal(5,3), DoubleColSubtractDoubleColumn(col 35:double, col 40:double)(children: CastLongToDouble(col 3:bigint) -> 35:double, DoubleColUnaryMinus(col 39:double)(children: DoubleColDivideLongColumn(col 38:double, col 2:bigint)(children: DoubleColSubtractDoubleColumn(col 0:double, col 37:double)(children: DoubleColDivideLongColumn(col 36:double, col 2:bigint)(children: DoubleColMultiplyDoubleColumn(col 1:double, col 1:double) -> 36:double) -> 37:double) -> 38:double) -> 39:double) -> 40:double) -> 41:double, DoubleColDivideLongColumn(col 44:double, col 2:bigint)(children: DoubleColSubtractDoubleColumn(col 0:double, col 43:double)(children: DoubleColDivideLongColumn(col 42:double, col 2:bigint)(children: DoubleColMultiplyDoubleColumn(col 1:double, col 1:double) -> 42:double) -> 43:double) -> 44:double) -> 45:double, DoubleScalarModuloDoubleColumn(val -1.0, col 50:double)(children: DoubleColUnaryMinus(col 49:double)(children: DoubleColDivideLongColumn(col 48:double, col 2:bigint)(children: DoubleColSubtractDoubleColumn(col 0:double, col 47:double)(children: DoubleColDivideLongColumn(col 46:double, col 2:bigint)(children: DoubleColMultiplyDoubleColumn(col 1:double, col 1:double) -> 46:double) -> 47:double) -> 48:double) -> 49:double) -> 50:double) -> 51:double, LongColUnaryMinus(col 3:bigint) -> 52:bigint, FuncPowerDoubleToDouble(col 56:double)(children: DoubleColDivideLongColumn(col 55:double, col 7:bigint)(children: DoubleColSubtractDoubleColumn(col 5:double, col 54:double)(children: DoubleColDivideLongColumn(col 53:double, col 7:bigint)(children: DoubleColMultiplyDoubleColumn(col 6:double, col 6:double) -> 53:double) -> 54:double) -> 55:double) -> 56:double) -> 57:double, DoubleColUnaryMinus(col 61:double)(children: DoubleColDivideLongColumn(col 60:double, col 2:bigint)(children: DoubleColSubtractDoubleColumn(col 0:double, col 59:double)(children: DoubleColDivideLongColumn(col 58:double, col 2:bigint)(children: DoubleColMultiplyDoubleColumn(col 1:double, col 1:double) -> 58:double) -> 59:double) -> 60:double) -> 61:double) -> 62:double, LongScalarMultiplyLongColumn(val 762, col 63:bigint)(children: LongColUnaryMinus(col 3:bigint) -> 63:bigint) -> 64:bigint, LongColAddLongColumn(col 4:bigint, col 66:bigint)(children: col 4:tinyint, LongScalarMultiplyLongColumn(val 762, col 65:bigint)(children: LongColUnaryMinus(col 3:bigint) -> 65:bigint) -> 66:bigint) -> 67:bigint, DoubleColAddDoubleColumn(col 72:double, col 73:double)(children: DoubleColUnaryMinus(col 71:double)(children: DoubleColDivideLongColumn(col 70:double, col 2:bigint)(children: DoubleColSubtractDoubleColumn(col 0:double, col 69:double)(children: DoubleColDivideLongColumn(col 68:double, col 2:bigint)(children: DoubleColMultiplyDoubleColumn(col 1:double, col 1:double) -> 68:double) -> 69:double) -> 70:double) -> 71:double) -> 72:double, CastLongToDouble(col 8:int) -> 73:double) -> 74:double, FuncPowerDoubleToDouble(col 82:double)(children: DoubleColDivideLongColumn(col 78:double, col 81:bigint)(children: VectorUDFAdaptor(greatest(0,(_col9 - ((_col10 * _col10) / _col11))))(children: DoubleColSubtractDoubleColumn(col 9:double, col 76:double)(children: DoubleColDivideLongColumn(col 75:double, col 11:bigint)(children: DoubleColMultiplyDoubleColumn(col 10:double, col 10:double) -> 75:double) -> 76:double) -> 77:double) -> 78:double, IfExprNullCondExpr(col 79:boolean, null, col 80:bigint)(children: LongColEqualLongScalar(col 11:bigint, val 1) -> 79:boolean, LongColSubtractLongScalar(col 11:bigint, val 1) -> 80:bigint) -> 81:bigint) -> 82:double) -> 83:double, LongColModuloLongColumn(col 84:bigint, col 3:bigint)(children: LongColUnaryMinus(col 3:bigint) -> 84:bigint) -> 85:bigint, DoubleColDivideLongColumn(col 86:double, col 12:bigint)(children: CastLongToDouble(col 13:bigint) -> 86:double) -> 87:double, LongScalarModuloLongColumn(val -3728, col 90:bigint)(children: LongColAddLongColumn(col 4:bigint, col 89:bigint)(children: col 4:tinyint, LongScalarMultiplyLongColumn(val 762, col 88:bigint)(children: LongColUnaryMinus(col 3:bigint) -> 88:bigint) -> 89:bigint) -> 90:bigint) -> 91:bigint
                   Statistics: Num rows: 1 Data size: 272 Basic stats: COMPLETE Column stats: COMPLETE
                   File Output Operator
                     compressed: false
@@ -2643,7 +2643,7 @@ STAGE PLANS:
                 enabled: true
                 enableConditionsMet: hive.vectorized.execution.reduce.enabled IS true, hive.execution.engine tez IN [tez] IS true
                 allNative: false
-                usesVectorUDFAdaptor: false
+                usesVectorUDFAdaptor: true
                 vectorized: true
             Reduce Operator Tree:
               Group By Operator
@@ -2661,24 +2661,33 @@ STAGE PLANS:
                 outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                 Statistics: Num rows: 3372 Data size: 155032 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
-                  expressions: _col0 (type: double), ((_col1 - ((_col2 * _col2) / _col3)) / if((_col3 = 1L), null, (_col3 - 1))) (type: double), (2563.58D * ((_col1 - ((_col2 * _col2) / _col3)) / if((_col3 = 1L), null, (_col3 - 1)))) (type: double), (- ((_col1 - ((_col2 * _col2) / _col3)) / if((_col3 = 1L), null, (_col3 - 1)))) (type: double), _col4 (type: bigint), ((2563.58D * ((_col1 - ((_col2 * _col2) / _col3)) / if((_col3 = 1L), null, (_col3 - 1)))) + -5638.15D) (type: double), ((- ((_col1 - ((_col2 * _col2) / _col3)) / if((_col3 = 1L), null, (_col3 - 1)))) * ((2563.58D * ((_col1 - ((_col2 * _col2) / _col3)) / if((_col3 = 1L), null, (_col3 - 1)))) + -5638.15D)) (type: double), _col5 (type: double), ((_col1 - ((_col2 * _col2) / _col3)) / _col3) (type: double), (_col0 - (- ((_col1 - ((_col2 * _col2) / _col3)) / if((_col3 = 1L), null, (_col3 - 1))))) (type: double), power(((_col1 - ((_col2 * _col2) / _col3)) / _col3), 0.5) (type: double), (_col0 + ((_col1 - ((_col2 * _col2) / _col3)) / if((_col3 = 1L), null, (_col3 - 1)))) (type: double), (_col0 * 762.0D) (type: double), _col2 (type: double), (-863.257D % (_col0 * 762.0D)) (type: double)
-                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14
+                  expressions: _col0 (type: double), (greatest(0,(_col1 - ((_col2 * _col2) / _col3))) / if((_col3 = 1L), null, (_col3 - 1))) (type: double), _col4 (type: bigint), _col5 (type: double), (greatest(0,(_col1 - ((_col2 * _col2) / _col3))) / _col3) (type: double), power((greatest(0,(_col1 - ((_col2 * _col2) / _col3))) / _col3), 0.5) (type: double), _col2 (type: double)
+                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                   Select Vectorization:
                       className: VectorSelectOperator
                       native: true
-                      projectedOutputColumnNums: [0, 12, 20, 28, 4, 37, 55, 5, 59, 68, 73, 81, 82, 2, 84]
-                      selectExpressions: DoubleColDivideLongColumn(col 8:double, col 11:bigint)(children: DoubleColSubtractDoubleColumn(col 1:double, col 7:double)(children: DoubleColDivideLongColumn(col 6:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 2:double, col 2:double) -> 6:double) -> 7:double) -> 8:double, IfExprNullCondExpr(col 9:boolean, null, col 10:bigint)(children: LongColEqualLongScalar(col 3:bigint, val 1) -> 9:boolean, LongColSubtractLongScalar(col 3:bigint, val 1) -> 10:bigint) -> 11:bigint) -> 12:double, DoubleScalarMultiplyDoubleColumn(val 2563.58, col 19:double)(children: DoubleColDivideLongColumn(col 15:double, col 18:bigint)(children: DoubleColSubtractDoubleColumn(col 1:double, col 14:double)(children: DoubleColDivideLongColumn(col 13:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 2:double, col 2:double) -> 13:double) -> 14:double) -> 15:double, IfExprNullCondExpr(col 16:boolean, null, col 17:bigint)(children: LongColEqualLongScalar(col 3:bigint, val 1) -> 16:boolean, LongColSubtractLongScalar(col 3:bigint, val 1) -> 17:bigint) -> 18:bigint) -> 19:double) -> 20:double, DoubleColUnaryMinus(col 27:double)(children: DoubleColDivideLongColumn(col 23:double, col 26:bigint)(children: DoubleColSubtractDoubleColumn(col 1:double, col 22:double)(children: DoubleColDivideLongColumn(col 21:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 2:double, col 2:double) -> 21:double) -> 22:double) -> 23:double, IfExprNullCondExpr(col 24:boolean, null, col 25:bigint)(children: LongColEqualLongScalar(col 3:bigint, val 1) -> 24:boolean, LongColSubtractLongScalar(col 3:bigint, val 1) -> 25:bigint) -> 26:bigint) -> 27:double) -> 28:double, DoubleColAddDoubleScalar(col 36:double, val -5638.15)(children: DoubleScalarMultiplyDoubleColumn(val 2563.58, col 35:double)(children: DoubleColDivideLongColumn(col 31:double, col 34:bigint)(children: DoubleColSubtractDoubleColumn(col 1:double, col 30:double)(children: DoubleColDivideLongColumn(col 29:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 2:double, col 2:double) -> 29:double) -> 30:double) -> 31:double, IfExprNullCondExpr(col 32:boolean, null, col 33:bigint)(children: LongColEqualLongScalar(col 3:bigint, val 1) -> 32:boolean, LongColSubtractLongScalar(col 3:bigint, val 1) -> 33:bigint) -> 34:bigint) -> 35:double) -> 36:double) -> 37:double, DoubleColMultiplyDoubleColumn(col 45:double, col 54:double)(children: DoubleColUnaryMinus(col 44:double)(children: DoubleColDivideLongColumn(col 40:double, col 43:bigint)(children: DoubleColSubtractDoubleColumn(col 1:double, col 39:double)(children: DoubleColDivideLongColumn(col 38:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 2:double, col 2:double) -> 38:double) -> 39:double) -> 40:double, IfExprNullCondExpr(col 41:boolean, null, col 42:bigint)(children: LongColEqualLongScalar(col 3:bigint, val 1) -> 41:boolean, LongColSubtractLongScalar(col 3:bigint, val 1) -> 42:bigint) -> 43:bigint) -> 44:double) -> 45:double, DoubleColAddDoubleScalar(col 53:double, val -5638.15)(children: DoubleScalarMultiplyDoubleColumn(val 2563.58, col 52:double)(children: DoubleColDivideLongColumn(col 48:double, col 51:bigint)(children: DoubleColSubtractDoubleColumn(col 1:double, col 47:double)(children: DoubleColDivideLongColumn(col 46:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 2:double, col 2:double) -> 46:double) -> 47:double) -> 48:double, IfExprNullCondExpr(col 49:boolean, null, col 50:bigint)(children: LongColEqualLongScalar(col 3:bigint, val 1) -> 49:boolean, LongColSubtractLongScalar(col 3:bigint, val 1) -> 50:bigint) -> 51:bigint) -> 52:double) -> 53:double) -> 54:double) -> 55:double, DoubleColDivideLongColumn(col 58:double, col 3:bigint)(children: DoubleColSubtractDoubleColumn(col 1:double, col 57:double)(children: DoubleColDivideLongColumn(col 56:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 2:double, col 2:double) -> 56:double) -> 57:double) -> 58:double) -> 59:double, DoubleColSubtractDoubleColumn(col 0:double, col 67:double)(children: DoubleColUnaryMinus(col 66:double)(children: DoubleColDivideLongColumn(col 62:double, col 65:bigint)(children: DoubleColSubtractDoubleColumn(col 1:double, col 61:double)(children: DoubleColDivideLongColumn(col 60:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 2:double, col 2:double) -> 60:double) -> 61:double) -> 62:double, IfExprNullCondExpr(col 63:boolean, null, col 64:bigint)(children: LongColEqualLongScalar(col 3:bigint, val 1) -> 63:boolean, LongColSubtractLongScalar(col 3:bigint, val 1) -> 64:bigint) -> 65:bigint) -> 66:double) -> 67:double) -> 68:double, FuncPowerDoubleToDouble(col 72:double)(children: DoubleColDivideLongColumn(col 71:double, col 3:bigint)(children: DoubleColSubtractDoubleColumn(col 1:double, col 70:double)(children: DoubleColDivideLongColumn(col 69:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 2:double, col 2:double) -> 69:double) -> 70:double) -> 71:double) -> 72:double) -> 73:double, DoubleColAddDoubleColumn(col 0:double, col 80:double)(children: DoubleColDivideLongColumn(col 76:double, col 79:bigint)(children: DoubleColSubtractDoubleColumn(col 1:double, col 75:double)(children: DoubleColDivideLongColumn(col 74:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 2:double, col 2:double) -> 74:double) -> 75:double) -> 76:double, IfExprNullCondExpr(col 77:boolean, null, col 78:bigint)(children: LongColEqualLongScalar(col 3:bigint, val 1) -> 77:boolean, LongColSubtractLongScalar(col 3:bigint, val 1) -> 78:bigint) -> 79:bigint) -> 80:double) -> 81:double, DoubleColMultiplyDoubleScalar(col 0:double, val 762.0) -> 82:double, DoubleScalarModuloDoubleColumn(val -863.257, col 83:double)(children: DoubleColMultiplyDoubleScalar(col 0:double, val 762.0) -> 83:double) -> 84:double
-                  Statistics: Num rows: 3372 Data size: 397816 Basic stats: COMPLETE Column stats: COMPLETE
-                  Reduce Output Operator
-                    key expressions: _col0 (type: double)
-                    null sort order: z
-                    sort order: +
-                    Reduce Sink Vectorization:
-                        className: VectorReduceSinkObjectHashOperator
+                      projectedOutputColumnNums: [0, 13, 4, 5, 18, 24, 2]
+                      selectExpressions: DoubleColDivideLongColumn(col 9:double, col 12:bigint)(children: VectorUDFAdaptor(greatest(0,(_col1 - ((_col2 * _col2) / _col3))))(children: DoubleColSubtractDoubleColumn(col 1:double, col 7:double)(children: DoubleColDivideLongColumn(col 6:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 2:double, col 2:double) -> 6:double) -> 7:double) -> 8:double) -> 9:double, IfExprNullCondExpr(col 10:boolean, null, col 11:bigint)(children: LongColEqualLongScalar(col 3:bigint, val 1) -> 10:boolean, LongColSubtractLongScalar(col 3:bigint, val 1) -> 11:bigint) -> 12:bigint) -> 13:double, DoubleColDivideLongColumn(col 17:double, col 3:bigint)(children: VectorUDFAdaptor(greatest(0,(_col1 - ((_col2 * _col2) / _col3))))(children: DoubleColSubtractDoubleColumn(col 1:double, col 15:double)(children: DoubleColDivideLongColumn(col 14:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 2:double, col 2:double) -> 14:double) -> 15:double) -> 16:double) -> 17:double) -> 18:double, FuncPowerDoubleToDouble(col 23:double)(children: DoubleColDivideLongColumn(col 22:double, col 3:bigint)(children: VectorUDFAdaptor(greatest(0,(_col1 - ((_col2 * _col2) / _col3))))(children: DoubleColSubtractDoubleColumn(col 1:double, col 20:double)(children: DoubleColDivideLongColumn(col 19:double, col 3:bigint)(children: DoubleColMultiplyDoubleColumn(col 2:double, col 2:double) -> 19:double) -> 20:double) -> 21:double) -> 22:double) -> 23:double) -> 24:double
+                  Statistics: Num rows: 3372 Data size: 182008 Basic stats: COMPLETE Column stats: COMPLETE
+                  Select Operator
+                    expressions: _col0 (type: double), _col1 (type: double), (2563.58D * _col1) (type: double), (- _col1) (type: double), _col2 (type: bigint), ((2563.58D * _col1) + -5638.15D) (type: double), ((- _col1) * ((2563.58D * _col1) + -5638.15D)) (type: double), _col3 (type: double), _col4 (type: double), (_col0 - (- _col1)) (type: double), _col5 (type: double), (_col0 + _col1) (type: double), (_col0 * 762.0D) (type: double), _col6 (type: double), (-863.257D % (_col0 * 762.0D)) (type: double)
+                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14
+                    Select Vectorization:
+                        className: VectorSelectOperator
                         native: true
-                        nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
+                        projectedOutputColumnNums: [0, 13, 25, 26, 4, 28, 32, 5, 18, 34, 24, 35, 36, 2, 38]
+                        selectExpressions: DoubleScalarMultiplyDoubleColumn(val 2563.58, col 13:double) -> 25:double, DoubleColUnaryMinus(col 13:double) -> 26:double, DoubleColAddDoubleScalar(col 27:double, val -5638.15)(children: DoubleScalarMultiplyDoubleColumn(val 2563.58, col 13:double) -> 27:double) -> 28:double, DoubleColMultiplyDoubleColumn(col 29:double, col 31:double)(children: DoubleColUnaryMinus(col 13:double) -> 29:double, DoubleColAddDoubleScalar(col 30:double, val -5638.15)(children: DoubleScalarMultiplyDoubleColumn(val 2563.58, col 13:double) -> 30:double) -> 31:double) -> 32:double, DoubleColSubtractDoubleColumn(col 0:double, col 33:double)(children: DoubleColUnaryMinus(col 13:double) -> 33:double) -> 34:double, DoubleColAddDoubleColumn(col 0:double, col 13:double) -> 35:double, DoubleColMultiplyDoubleScalar(col 0:double, val 762.0) -> 36:double, DoubleScalarModuloDoubleColumn(val -863.257, col 37:double)(children: DoubleColMultiplyDoubleScalar(col 0:double, val 762.0) -> 37:double) -> 38:double
                     Statistics: Num rows: 3372 Data size: 397816 Basic stats: COMPLETE Column stats: COMPLETE
-                    value expressions: _col1 (type: double), _col2 (type: double), _col3 (type: double), _col4 (type: bigint), _col5 (type: double), _col6 (type: double), _col7 (type: double), _col8 (type: double), _col9 (type: double), _col10 (type: double), _col11 (type: double), _col12 (type: double), _col13 (type: double), _col14 (type: double)
+                    Reduce Output Operator
+                      key expressions: _col0 (type: double)
+                      null sort order: z
+                      sort order: +
+                      Reduce Sink Vectorization:
+                          className: VectorReduceSinkObjectHashOperator
+                          native: true
+                          nativeConditionsMet: hive.vectorized.execution.reducesink.new.enabled IS true, hive.execution.engine tez IN [tez] IS true, No PTF TopN IS true, No DISTINCT columns IS true, BinarySortableSerDe for keys IS true, LazyBinarySerDe for values IS true
+                      Statistics: Num rows: 3372 Data size: 397816 Basic stats: COMPLETE Column stats: COMPLETE
+                      value expressions: _col1 (type: double), _col2 (type: double), _col3 (type: double), _col4 (type: bigint), _col5 (type: double), _col6 (type: double), _col7 (type: double), _col8 (type: double), _col9 (type: double), _col10 (type: double), _col11 (type: double), _col12 (type: double), _col13 (type: double), _col14 (type: double)
         Reducer 3 
             Execution mode: vectorized, llap
             Reduce Vectorization:
diff --git a/ql/src/test/results/clientpositive/llap/vectorized_parquet.q.out b/ql/src/test/results/clientpositive/llap/vectorized_parquet.q.out
index 21815728b3..78eb986611 100644
--- a/ql/src/test/results/clientpositive/llap/vectorized_parquet.q.out
+++ b/ql/src/test/results/clientpositive/llap/vectorized_parquet.q.out
@@ -186,7 +186,7 @@ STAGE PLANS:
                 enabled: true
                 enableConditionsMet: hive.vectorized.execution.reduce.enabled IS true, hive.execution.engine tez IN [tez] IS true
                 allNative: false
-                usesVectorUDFAdaptor: false
+                usesVectorUDFAdaptor: true
                 vectorized: true
             Reduce Operator Tree:
               Group By Operator
@@ -196,7 +196,7 @@ STAGE PLANS:
                 outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                 Statistics: Num rows: 128 Data size: 7556 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
-                  expressions: _col0 (type: tinyint), _col1 (type: int), _col2 (type: smallint), _col3 (type: bigint), (_col4 / _col5) (type: double), power(((_col6 - ((_col7 * _col7) / _col8)) / _col8), 0.5) (type: double)
+                  expressions: _col0 (type: tinyint), _col1 (type: int), _col2 (type: smallint), _col3 (type: bigint), (_col4 / _col5) (type: double), power((greatest(0,(_col6 - ((_col7 * _col7) / _col8))) / _col8), 0.5) (type: double)
                   outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                   Statistics: Num rows: 128 Data size: 4484 Basic stats: COMPLETE Column stats: COMPLETE
                   File Output Operator
diff --git a/ql/src/test/results/clientpositive/llap/vectorized_parquet_types.q.out b/ql/src/test/results/clientpositive/llap/vectorized_parquet_types.q.out
index 589bb7f599..51a5fc25c0 100644
--- a/ql/src/test/results/clientpositive/llap/vectorized_parquet_types.q.out
+++ b/ql/src/test/results/clientpositive/llap/vectorized_parquet_types.q.out
@@ -351,7 +351,7 @@ STAGE PLANS:
                 enabled: true
                 enableConditionsMet: hive.vectorized.execution.reduce.enabled IS true, hive.execution.engine tez IN [tez] IS true
                 allNative: false
-                usesVectorUDFAdaptor: false
+                usesVectorUDFAdaptor: true
                 vectorized: true
             Reduce Operator Tree:
               Group By Operator
@@ -369,13 +369,13 @@ STAGE PLANS:
                 outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                 Statistics: Num rows: 3 Data size: 516 Basic stats: COMPLETE Column stats: COMPLETE
                 Select Operator
-                  expressions: _col0 (type: tinyint), _col1 (type: int), _col2 (type: smallint), _col3 (type: bigint), (_col4 / _col5) (type: double), power(((_col6 - ((_col7 * _col7) / _col8)) / _col8), 0.5) (type: double), _col9 (type: decimal(4,2))
+                  expressions: _col0 (type: tinyint), _col1 (type: int), _col2 (type: smallint), _col3 (type: bigint), (_col4 / _col5) (type: double), power((greatest(0,(_col6 - ((_col7 * _col7) / _col8))) / _col8), 0.5) (type: double), _col9 (type: decimal(4,2))
                   outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                   Select Vectorization:
                       className: VectorSelectOperator
                       native: true
-                      projectedOutputColumnNums: [0, 1, 2, 3, 10, 15, 9]
-                      selectExpressions: DoubleColDivideLongColumn(col 4:double, col 5:bigint) -> 10:double, FuncPowerDoubleToDouble(col 14:double)(children: DoubleColDivideLongColumn(col 13:double, col 8:bigint)(children: DoubleColSubtractDoubleColumn(col 6:double, col 12:double)(children: DoubleColDivideLongColumn(col 11:double, col 8:bigint)(children: DoubleColMultiplyDoubleColumn(col 7:double, col 7:double) -> 11:double) -> 12:double) -> 13:double) -> 14:double) -> 15:double
+                      projectedOutputColumnNums: [0, 1, 2, 3, 10, 16, 9]
+                      selectExpressions: DoubleColDivideLongColumn(col 4:double, col 5:bigint) -> 10:double, FuncPowerDoubleToDouble(col 15:double)(children: DoubleColDivideLongColumn(col 14:double, col 8:bigint)(children: VectorUDFAdaptor(greatest(0,(_col6 - ((_col7 * _col7) / _col8))))(children: DoubleColSubtractDoubleColumn(col 6:double, col 12:double)(children: DoubleColDivideLongColumn(col 11:double, col 8:bigint)(children: DoubleColMultiplyDoubleColumn(col 7:double, col 7:double) -> 11:double) -> 12:double) -> 13:double) -> 14:double) -> 15:double) -> 16:double
                   Statistics: Num rows: 3 Data size: 444 Basic stats: COMPLETE Column stats: COMPLETE
                   Reduce Output Operator
                     key expressions: _col0 (type: tinyint)
