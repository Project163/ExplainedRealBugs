diff --git a/ql/src/java/org/apache/hadoop/hive/ql/ddl/table/storage/compact/AlterTableCompactAnalyzer.java b/ql/src/java/org/apache/hadoop/hive/ql/ddl/table/storage/compact/AlterTableCompactAnalyzer.java
index dd721d676a..df95c80a53 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/ddl/table/storage/compact/AlterTableCompactAnalyzer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/ddl/table/storage/compact/AlterTableCompactAnalyzer.java
@@ -73,6 +73,7 @@ protected void analyzeCommand(TableName tableName, Map<String, String> partition
     }
 
     AlterTableCompactDesc desc = new AlterTableCompactDesc(tableName, partitionSpec, type, isBlocking, poolName, mapProp);
+    addInputsOutputsAlterTable(tableName, partitionSpec, desc, desc.getType(), false);
     rootTasks.add(TaskFactory.get(new DDLWork(getInputs(), getOutputs(), desc)));
   }
 }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/ddl/table/storage/compact/AlterTableCompactDesc.java b/ql/src/java/org/apache/hadoop/hive/ql/ddl/table/storage/compact/AlterTableCompactDesc.java
index ac4aaa9feb..98088ea5f4 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/ddl/table/storage/compact/AlterTableCompactDesc.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/ddl/table/storage/compact/AlterTableCompactDesc.java
@@ -22,6 +22,9 @@
 
 import org.apache.hadoop.hive.common.TableName;
 import org.apache.hadoop.hive.ql.ddl.DDLDesc.DDLDescWithWriteId;
+import org.apache.hadoop.hive.ql.ddl.table.AbstractAlterTableDesc;
+import org.apache.hadoop.hive.ql.ddl.table.AlterTableType;
+import org.apache.hadoop.hive.ql.parse.SemanticException;
 import org.apache.hadoop.hive.ql.plan.Explain;
 import org.apache.hadoop.hive.ql.plan.Explain.Level;
 
@@ -30,7 +33,7 @@
  * commands.
  */
 @Explain(displayName = "Compact", explainLevels = { Level.USER, Level.DEFAULT, Level.EXTENDED })
-public class AlterTableCompactDesc implements DDLDescWithWriteId {
+public class AlterTableCompactDesc extends AbstractAlterTableDesc implements DDLDescWithWriteId {
   private final String tableName;
   private final Map<String, String> partitionSpec;
   private final String compactionType;
@@ -40,7 +43,8 @@ public class AlterTableCompactDesc implements DDLDescWithWriteId {
   private Long writeId;
 
   public AlterTableCompactDesc(TableName tableName, Map<String, String> partitionSpec, String compactionType,
-      boolean isBlocking, String poolName, Map<String, String> properties) {
+      boolean isBlocking, String poolName, Map<String, String> properties) throws SemanticException{
+    super(AlterTableType.COMPACT, tableName, partitionSpec, null, false, false, properties);
     this.tableName = tableName.getNotEmptyDbTable();
     this.partitionSpec = partitionSpec;
     this.compactionType = compactionType;
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/ddl/table/storage/concatenate/AlterTableConcatenateAnalyzer.java b/ql/src/java/org/apache/hadoop/hive/ql/ddl/table/storage/concatenate/AlterTableConcatenateAnalyzer.java
index b5acbe71e1..f9743506b6 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/ddl/table/storage/concatenate/AlterTableConcatenateAnalyzer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/ddl/table/storage/concatenate/AlterTableConcatenateAnalyzer.java
@@ -41,6 +41,8 @@
 import org.apache.hadoop.hive.ql.exec.Task;
 import org.apache.hadoop.hive.ql.exec.TaskFactory;
 import org.apache.hadoop.hive.ql.exec.Utilities;
+import org.apache.hadoop.hive.ql.hooks.ReadEntity;
+import org.apache.hadoop.hive.ql.hooks.WriteEntity;
 import org.apache.hadoop.hive.ql.io.AcidUtils;
 import org.apache.hadoop.hive.ql.io.RCFileInputFormat;
 import org.apache.hadoop.hive.ql.io.orc.OrcInputFormat;
@@ -103,6 +105,7 @@ private void compactAcidTable(TableName tableName, Map<String, String> partition
 
     AlterTableCompactDesc desc = new AlterTableCompactDesc(tableName, partitionSpec, CompactionType.MAJOR.name(), isBlocking,
         poolName, null);
+    addInputsOutputsAlterTable(tableName, partitionSpec, desc, desc.getType(), false);
     rootTasks.add(TaskFactory.get(new DDLWork(getInputs(), getOutputs(), desc)));
     setAcidDdlDesc(getTable(tableName), desc);
   }
@@ -187,7 +190,7 @@ private void createConcatenateTasks(TableName tableName, Table table, Map<String
 
   @SuppressWarnings("rawtypes")
   private Task<?> createMergeTask(TableName tableName, Table table, Map<String, String> partitionSpec, Path oldLocation,
-      ListBucketingCtx lbCtx, Class<? extends InputFormat> inputFormatClass, Path queryTmpDir) {
+      ListBucketingCtx lbCtx, Class<? extends InputFormat> inputFormatClass, Path queryTmpDir) throws SemanticException {
     AlterTableConcatenateDesc desc = new AlterTableConcatenateDesc(tableName, partitionSpec, lbCtx, oldLocation,
         queryTmpDir, inputFormatClass, Utilities.getTableDesc(table));
     DDLWork ddlWork = new DDLWork(getInputs(), getOutputs(), desc);
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/ddl/table/storage/concatenate/AlterTableConcatenateDesc.java b/ql/src/java/org/apache/hadoop/hive/ql/ddl/table/storage/concatenate/AlterTableConcatenateDesc.java
index 476abad68f..e928342930 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/ddl/table/storage/concatenate/AlterTableConcatenateDesc.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/ddl/table/storage/concatenate/AlterTableConcatenateDesc.java
@@ -23,6 +23,9 @@
 import org.apache.hadoop.fs.Path;
 import org.apache.hadoop.hive.common.TableName;
 import org.apache.hadoop.hive.ql.ddl.DDLDesc;
+import org.apache.hadoop.hive.ql.ddl.table.AbstractAlterTableDesc;
+import org.apache.hadoop.hive.ql.ddl.table.AlterTableType;
+import org.apache.hadoop.hive.ql.parse.SemanticException;
 import org.apache.hadoop.hive.ql.plan.Explain;
 import org.apache.hadoop.hive.ql.plan.ListBucketingCtx;
 import org.apache.hadoop.hive.ql.plan.TableDesc;
@@ -34,7 +37,7 @@
  */
 @Explain(displayName = "Concatenate", explainLevels = { Level.USER, Level.DEFAULT, Level.EXTENDED })
 @SuppressWarnings("rawtypes")
-public class AlterTableConcatenateDesc implements DDLDesc {
+public class AlterTableConcatenateDesc extends AbstractAlterTableDesc implements DDLDesc {
   private final String tableName;
   private final Map<String, String> partitionSpec;
   private final ListBucketingCtx lbCtx;
@@ -44,7 +47,8 @@ public class AlterTableConcatenateDesc implements DDLDesc {
   private final TableDesc tableDesc;
 
   public AlterTableConcatenateDesc(TableName tableName, Map<String, String> partitionSpec, ListBucketingCtx lbCtx,
-      Path inputDir, Path outputDir, Class<? extends InputFormat> inputFormatClass, TableDesc tableDesc) {
+      Path inputDir, Path outputDir, Class<? extends InputFormat> inputFormatClass, TableDesc tableDesc) throws SemanticException {
+    super(AlterTableType.MERGEFILES, tableName, partitionSpec, null, false, false, null);
     this.tableName = tableName.getNotEmptyDbTable();
     this.partitionSpec = partitionSpec;
     this.lbCtx = lbCtx;
@@ -54,11 +58,6 @@ public AlterTableConcatenateDesc(TableName tableName, Map<String, String> partit
     this.tableDesc = tableDesc;
   }
 
-  @Explain(displayName = "table name")
-  public String getTableName() {
-    return tableName;
-  }
-
   /** For Explain only. */
   @Explain(displayName = "partition spec")
   public Map<String, String> getPartitionSpec() {
diff --git a/ql/src/test/queries/clientpositive/dbtxnmgr_compact1.q b/ql/src/test/queries/clientpositive/dbtxnmgr_compact1.q
index 6cbdb1dbf7..b8e4bc2727 100644
--- a/ql/src/test/queries/clientpositive/dbtxnmgr_compact1.q
+++ b/ql/src/test/queries/clientpositive/dbtxnmgr_compact1.q
@@ -13,7 +13,7 @@ alter table T1_n153 compact 'major';
 
 alter table T2_n153 compact 'minor';
 
-explain alter table t compact 'MAJOR' pool 'test';
+explain alter table T1_n153 compact 'MAJOR' pool 'test';
 
 show compactions;
 
diff --git a/ql/src/test/results/clientnegative/compact_non_acid_table.q.out b/ql/src/test/results/clientnegative/compact_non_acid_table.q.out
index dc8b01eccc..e2c7019259 100644
--- a/ql/src/test/results/clientnegative/compact_non_acid_table.q.out
+++ b/ql/src/test/results/clientnegative/compact_non_acid_table.q.out
@@ -8,4 +8,6 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@not_an_acid_table
 PREHOOK: query: alter table not_an_acid_table compact 'major'
 PREHOOK: type: ALTERTABLE_COMPACT
+PREHOOK: Input: default@not_an_acid_table
+PREHOOK: Output: default@not_an_acid_table
 FAILED: Execution Error, return code 10286 from org.apache.hadoop.hive.ql.ddl.DDLTask. Compaction is not allowed on non-ACID table default.not_an_acid_table
diff --git a/ql/src/test/results/clientpositive/llap/acid_insert_overwrite_update.q.out b/ql/src/test/results/clientpositive/llap/acid_insert_overwrite_update.q.out
index e220dddba6..6a8666398b 100644
--- a/ql/src/test/results/clientpositive/llap/acid_insert_overwrite_update.q.out
+++ b/ql/src/test/results/clientpositive/llap/acid_insert_overwrite_update.q.out
@@ -95,8 +95,12 @@ POSTHOOK: Input: default@sequential_update
 LOOKS OKAY	delta_0000004_0000004_0001
 PREHOOK: query: alter table sequential_update compact 'major'
 PREHOOK: type: ALTERTABLE_COMPACT
+PREHOOK: Input: default@sequential_update
+PREHOOK: Output: default@sequential_update
 POSTHOOK: query: alter table sequential_update compact 'major'
 POSTHOOK: type: ALTERTABLE_COMPACT
+POSTHOOK: Input: default@sequential_update
+POSTHOOK: Output: default@sequential_update
 PREHOOK: query: select distinct IF(seq==1, 'LOOKS OKAY', 'BROKEN'), regexp_extract(INPUT__FILE__NAME, '.*/(.*)/[^/]*', 1) from sequential_update
 PREHOOK: type: QUERY
 PREHOOK: Input: default@sequential_update
@@ -243,16 +247,28 @@ POSTHOOK: Input: default@orc_test_txn@year=2018
 LOOKS OKAY
 PREHOOK: query: alter table orc_test_txn partition(year='2016') compact 'major'
 PREHOOK: type: ALTERTABLE_COMPACT
+PREHOOK: Input: default@orc_test_txn
+PREHOOK: Output: default@orc_test_txn@year=2016
 POSTHOOK: query: alter table orc_test_txn partition(year='2016') compact 'major'
 POSTHOOK: type: ALTERTABLE_COMPACT
+POSTHOOK: Input: default@orc_test_txn
+POSTHOOK: Output: default@orc_test_txn@year=2016
 PREHOOK: query: alter table orc_test_txn partition(year='2017') compact 'major'
 PREHOOK: type: ALTERTABLE_COMPACT
+PREHOOK: Input: default@orc_test_txn
+PREHOOK: Output: default@orc_test_txn@year=2017
 POSTHOOK: query: alter table orc_test_txn partition(year='2017') compact 'major'
 POSTHOOK: type: ALTERTABLE_COMPACT
+POSTHOOK: Input: default@orc_test_txn
+POSTHOOK: Output: default@orc_test_txn@year=2017
 PREHOOK: query: alter table orc_test_txn partition(year='2018') compact 'major'
 PREHOOK: type: ALTERTABLE_COMPACT
+PREHOOK: Input: default@orc_test_txn
+PREHOOK: Output: default@orc_test_txn@year=2018
 POSTHOOK: query: alter table orc_test_txn partition(year='2018') compact 'major'
 POSTHOOK: type: ALTERTABLE_COMPACT
+POSTHOOK: Input: default@orc_test_txn
+POSTHOOK: Output: default@orc_test_txn@year=2018
 PREHOOK: query: select distinct IF(id==1, 'LOOKS OKAY', 'BROKEN') from orc_test_txn
 PREHOOK: type: QUERY
 PREHOOK: Input: default@orc_test_txn
diff --git a/ql/src/test/results/clientpositive/llap/dbtxnmgr_compact1.q.out b/ql/src/test/results/clientpositive/llap/dbtxnmgr_compact1.q.out
index 85a1190e85..24f3b1340c 100644
--- a/ql/src/test/results/clientpositive/llap/dbtxnmgr_compact1.q.out
+++ b/ql/src/test/results/clientpositive/llap/dbtxnmgr_compact1.q.out
@@ -16,16 +16,28 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@T2_n153
 PREHOOK: query: alter table T1_n153 compact 'major'
 PREHOOK: type: ALTERTABLE_COMPACT
+PREHOOK: Input: default@t1_n153
+PREHOOK: Output: default@t1_n153
 POSTHOOK: query: alter table T1_n153 compact 'major'
 POSTHOOK: type: ALTERTABLE_COMPACT
+POSTHOOK: Input: default@t1_n153
+POSTHOOK: Output: default@t1_n153
 PREHOOK: query: alter table T2_n153 compact 'minor'
 PREHOOK: type: ALTERTABLE_COMPACT
+PREHOOK: Input: default@t2_n153
+PREHOOK: Output: default@t2_n153
 POSTHOOK: query: alter table T2_n153 compact 'minor'
 POSTHOOK: type: ALTERTABLE_COMPACT
-PREHOOK: query: explain alter table t compact 'MAJOR' pool 'test'
+POSTHOOK: Input: default@t2_n153
+POSTHOOK: Output: default@t2_n153
+PREHOOK: query: explain alter table T1_n153 compact 'MAJOR' pool 'test'
 PREHOOK: type: ALTERTABLE_COMPACT
-POSTHOOK: query: explain alter table t compact 'MAJOR' pool 'test'
+PREHOOK: Input: default@t1_n153
+PREHOOK: Output: default@t1_n153
+POSTHOOK: query: explain alter table T1_n153 compact 'MAJOR' pool 'test'
 POSTHOOK: type: ALTERTABLE_COMPACT
+POSTHOOK: Input: default@t1_n153
+POSTHOOK: Output: default@t1_n153
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
@@ -33,8 +45,9 @@ STAGE PLANS:
   Stage: Stage-0
     Compact
       compaction type: major
+      table name: default.T1_n153
       pool: test
-      table name: default.t
+      table name: default.T1_n153
 
 PREHOOK: query: show compactions
 PREHOOK: type: SHOW COMPACTIONS
diff --git a/ql/src/test/results/clientpositive/llap/dbtxnmgr_compact2.q.out b/ql/src/test/results/clientpositive/llap/dbtxnmgr_compact2.q.out
index 9d744e2c61..92e4762a60 100644
--- a/ql/src/test/results/clientpositive/llap/dbtxnmgr_compact2.q.out
+++ b/ql/src/test/results/clientpositive/llap/dbtxnmgr_compact2.q.out
@@ -22,12 +22,20 @@ POSTHOOK: Output: default@t1_n105
 POSTHOOK: Output: default@t1_n105@ds=yesterday
 PREHOOK: query: alter table T1_n105 partition (ds = 'today') compact 'major'
 PREHOOK: type: ALTERTABLE_COMPACT
+PREHOOK: Input: default@t1_n105
+PREHOOK: Output: default@t1_n105@ds=today
 POSTHOOK: query: alter table T1_n105 partition (ds = 'today') compact 'major'
 POSTHOOK: type: ALTERTABLE_COMPACT
+POSTHOOK: Input: default@t1_n105
+POSTHOOK: Output: default@t1_n105@ds=today
 PREHOOK: query: explain alter table T1_n105 partition (ds = 'yesterday') compact 'minor'
 PREHOOK: type: ALTERTABLE_COMPACT
+PREHOOK: Input: default@t1_n105
+PREHOOK: Output: default@t1_n105@ds=yesterday
 POSTHOOK: query: explain alter table T1_n105 partition (ds = 'yesterday') compact 'minor'
 POSTHOOK: type: ALTERTABLE_COMPACT
+POSTHOOK: Input: default@t1_n105
+POSTHOOK: Output: default@t1_n105@ds=yesterday
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
@@ -35,14 +43,19 @@ STAGE PLANS:
   Stage: Stage-0
     Compact
       compaction type: minor
+      table name: default.T1_n105
       partition spec:
         ds yesterday
       table name: default.T1_n105
 
 PREHOOK: query: alter table T1_n105 partition (ds = 'yesterday') compact 'minor'
 PREHOOK: type: ALTERTABLE_COMPACT
+PREHOOK: Input: default@t1_n105
+PREHOOK: Output: default@t1_n105@ds=yesterday
 POSTHOOK: query: alter table T1_n105 partition (ds = 'yesterday') compact 'minor'
 POSTHOOK: type: ALTERTABLE_COMPACT
+POSTHOOK: Input: default@t1_n105
+POSTHOOK: Output: default@t1_n105@ds=yesterday
 PREHOOK: query: drop table T1_n105
 PREHOOK: type: DROPTABLE
 PREHOOK: Input: default@t1_n105
diff --git a/ql/src/test/results/clientpositive/llap/dbtxnmgr_compact3.q.out b/ql/src/test/results/clientpositive/llap/dbtxnmgr_compact3.q.out
index bdbbaae963..aeebfeabc9 100644
--- a/ql/src/test/results/clientpositive/llap/dbtxnmgr_compact3.q.out
+++ b/ql/src/test/results/clientpositive/llap/dbtxnmgr_compact3.q.out
@@ -28,12 +28,20 @@ POSTHOOK: Output: D1@T2_n71
 POSTHOOK: Output: database:d1
 PREHOOK: query: alter table T1_n71 compact 'major'
 PREHOOK: type: ALTERTABLE_COMPACT
+PREHOOK: Input: d1@t1_n71
+PREHOOK: Output: d1@t1_n71
 POSTHOOK: query: alter table T1_n71 compact 'major'
 POSTHOOK: type: ALTERTABLE_COMPACT
+POSTHOOK: Input: d1@t1_n71
+POSTHOOK: Output: d1@t1_n71
 PREHOOK: query: alter table T2_n71 compact 'minor'
 PREHOOK: type: ALTERTABLE_COMPACT
+PREHOOK: Input: d1@t2_n71
+PREHOOK: Output: d1@t2_n71
 POSTHOOK: query: alter table T2_n71 compact 'minor'
 POSTHOOK: type: ALTERTABLE_COMPACT
+POSTHOOK: Input: d1@t2_n71
+POSTHOOK: Output: d1@t2_n71
 PREHOOK: query: drop table T1_n71
 PREHOOK: type: DROPTABLE
 PREHOOK: Input: d1@t1_n71
diff --git a/ql/src/test/results/clientpositive/llap/dbtxnmgr_showlocks.q.out b/ql/src/test/results/clientpositive/llap/dbtxnmgr_showlocks.q.out
index 691dc33e0d..ad2b8eceb5 100644
--- a/ql/src/test/results/clientpositive/llap/dbtxnmgr_showlocks.q.out
+++ b/ql/src/test/results/clientpositive/llap/dbtxnmgr_showlocks.q.out
@@ -121,8 +121,12 @@ POSTHOOK: Lineage: partitioned_acid_table PARTITION(p=abc).a SCRIPT []
 POSTHOOK: Lineage: partitioned_acid_table PARTITION(p=abc).b SCRIPT []
 PREHOOK: query: alter table partitioned_acid_table partition(p='abc') compact 'minor'
 PREHOOK: type: ALTERTABLE_COMPACT
+PREHOOK: Input: default@partitioned_acid_table
+PREHOOK: Output: default@partitioned_acid_table@p=abc
 POSTHOOK: query: alter table partitioned_acid_table partition(p='abc') compact 'minor'
 POSTHOOK: type: ALTERTABLE_COMPACT
+POSTHOOK: Input: default@partitioned_acid_table
+POSTHOOK: Output: default@partitioned_acid_table@p=abc
 PREHOOK: query: explain show compactions
 PREHOOK: type: SHOW COMPACTIONS
 POSTHOOK: query: explain show compactions
diff --git a/ql/src/test/results/clientpositive/llap/orc_merge10.q.out b/ql/src/test/results/clientpositive/llap/orc_merge10.q.out
index 4c95874d30..7784e6e5ae 100644
--- a/ql/src/test/results/clientpositive/llap/orc_merge10.q.out
+++ b/ql/src/test/results/clientpositive/llap/orc_merge10.q.out
@@ -641,10 +641,10 @@ STAGE DEPENDENCIES:
 STAGE PLANS:
   Stage: Stage-0
     Concatenate
+      table name: default.orcfile_merge1
       partition spec:
         ds 1
         part 0
-      table name: default.orcfile_merge1
 
   Stage: Stage-1
     Move Operator
diff --git a/ql/src/test/results/clientpositive/llap/orc_merge6.q.out b/ql/src/test/results/clientpositive/llap/orc_merge6.q.out
index 066f9dbf9b..af020c3f75 100644
--- a/ql/src/test/results/clientpositive/llap/orc_merge6.q.out
+++ b/ql/src/test/results/clientpositive/llap/orc_merge6.q.out
@@ -992,10 +992,10 @@ STAGE DEPENDENCIES:
 STAGE PLANS:
   Stage: Stage-0
     Concatenate
+      table name: default.orc_merge5a_n1
       partition spec:
         hour 24
         year 2000
-      table name: default.orc_merge5a_n1
 
   Stage: Stage-1
     Move Operator
diff --git a/ql/src/test/results/clientpositive/llap/orc_merge7.q.out b/ql/src/test/results/clientpositive/llap/orc_merge7.q.out
index 25d9100614..eafa65c8ef 100644
--- a/ql/src/test/results/clientpositive/llap/orc_merge7.q.out
+++ b/ql/src/test/results/clientpositive/llap/orc_merge7.q.out
@@ -667,9 +667,9 @@ STAGE DEPENDENCIES:
 STAGE PLANS:
   Stage: Stage-0
     Concatenate
+      table name: default.orc_merge5a_n0
       partition spec:
         st 80.0
-      table name: default.orc_merge5a_n0
 
   Stage: Stage-1
     Move Operator
diff --git a/ql/src/test/results/clientpositive/llap/orc_merge_incompat2.q.out b/ql/src/test/results/clientpositive/llap/orc_merge_incompat2.q.out
index b1fcb21108..daf54c2eb7 100644
--- a/ql/src/test/results/clientpositive/llap/orc_merge_incompat2.q.out
+++ b/ql/src/test/results/clientpositive/llap/orc_merge_incompat2.q.out
@@ -346,9 +346,9 @@ STAGE DEPENDENCIES:
 STAGE PLANS:
   Stage: Stage-0
     Concatenate
+      table name: default.orc_merge5a
       partition spec:
         st 80.0
-      table name: default.orc_merge5a
 
   Stage: Stage-1
     Move Operator
diff --git a/ql/src/test/results/clientpositive/llap/schema_evol_orc_acid_part_update.q.out b/ql/src/test/results/clientpositive/llap/schema_evol_orc_acid_part_update.q.out
index 82ffbdedc5..4b48acd77f 100644
--- a/ql/src/test/results/clientpositive/llap/schema_evol_orc_acid_part_update.q.out
+++ b/ql/src/test/results/clientpositive/llap/schema_evol_orc_acid_part_update.q.out
@@ -177,12 +177,20 @@ insert_num	part	a	b	c	d
 115	1	32768	new	99	major glaciation
 PREHOOK: query: alter table partitioned_update_1_n1 partition(part=1) compact 'major'
 PREHOOK: type: ALTERTABLE_COMPACT
+PREHOOK: Input: default@partitioned_update_1_n1
+PREHOOK: Output: default@partitioned_update_1_n1@part=1
 POSTHOOK: query: alter table partitioned_update_1_n1 partition(part=1) compact 'major'
 POSTHOOK: type: ALTERTABLE_COMPACT
+POSTHOOK: Input: default@partitioned_update_1_n1
+POSTHOOK: Output: default@partitioned_update_1_n1@part=1
 PREHOOK: query: alter table partitioned_update_1_n1 partition(part=2) compact 'major'
 PREHOOK: type: ALTERTABLE_COMPACT
+PREHOOK: Input: default@partitioned_update_1_n1
+PREHOOK: Output: default@partitioned_update_1_n1@part=2
 POSTHOOK: query: alter table partitioned_update_1_n1 partition(part=2) compact 'major'
 POSTHOOK: type: ALTERTABLE_COMPACT
+POSTHOOK: Input: default@partitioned_update_1_n1
+POSTHOOK: Output: default@partitioned_update_1_n1@part=2
 PREHOOK: query: select insert_num,part,a,b,c,d from partitioned_update_1_n1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@partitioned_update_1_n1
@@ -345,12 +353,20 @@ insert_num	part	a	b	c	d
 115	1	32768	new	32768	major glaciation
 PREHOOK: query: alter table partitioned_delete_1_n1 partition(part=1) compact 'major'
 PREHOOK: type: ALTERTABLE_COMPACT
+PREHOOK: Input: default@partitioned_delete_1_n1
+PREHOOK: Output: default@partitioned_delete_1_n1@part=1
 POSTHOOK: query: alter table partitioned_delete_1_n1 partition(part=1) compact 'major'
 POSTHOOK: type: ALTERTABLE_COMPACT
+POSTHOOK: Input: default@partitioned_delete_1_n1
+POSTHOOK: Output: default@partitioned_delete_1_n1@part=1
 PREHOOK: query: alter table partitioned_delete_1_n1 partition(part=2) compact 'major'
 PREHOOK: type: ALTERTABLE_COMPACT
+PREHOOK: Input: default@partitioned_delete_1_n1
+PREHOOK: Output: default@partitioned_delete_1_n1@part=2
 POSTHOOK: query: alter table partitioned_delete_1_n1 partition(part=2) compact 'major'
 POSTHOOK: type: ALTERTABLE_COMPACT
+POSTHOOK: Input: default@partitioned_delete_1_n1
+POSTHOOK: Output: default@partitioned_delete_1_n1@part=2
 PREHOOK: query: select insert_num,part,a,b,c,d from partitioned_delete_1_n1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@partitioned_delete_1_n1
@@ -510,12 +526,20 @@ insert_num	part	a	b	c	d
 113	1	40000	new	40000	Delaware
 PREHOOK: query: alter table partitioned_delete_2_n1 partition(part=1) compact 'major'
 PREHOOK: type: ALTERTABLE_COMPACT
+PREHOOK: Input: default@partitioned_delete_2_n1
+PREHOOK: Output: default@partitioned_delete_2_n1@part=1
 POSTHOOK: query: alter table partitioned_delete_2_n1 partition(part=1) compact 'major'
 POSTHOOK: type: ALTERTABLE_COMPACT
+POSTHOOK: Input: default@partitioned_delete_2_n1
+POSTHOOK: Output: default@partitioned_delete_2_n1@part=1
 PREHOOK: query: alter table partitioned_delete_2_n1 partition(part=2) compact 'major'
 PREHOOK: type: ALTERTABLE_COMPACT
+PREHOOK: Input: default@partitioned_delete_2_n1
+PREHOOK: Output: default@partitioned_delete_2_n1@part=2
 POSTHOOK: query: alter table partitioned_delete_2_n1 partition(part=2) compact 'major'
 POSTHOOK: type: ALTERTABLE_COMPACT
+POSTHOOK: Input: default@partitioned_delete_2_n1
+POSTHOOK: Output: default@partitioned_delete_2_n1@part=2
 PREHOOK: query: select insert_num,part,a,b,c,d from partitioned_delete_2_n1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@partitioned_delete_2_n1
diff --git a/ql/src/test/results/clientpositive/llap/schema_evol_orc_acid_part_update_llap_io.q.out b/ql/src/test/results/clientpositive/llap/schema_evol_orc_acid_part_update_llap_io.q.out
index 5ec3911397..78845def13 100644
--- a/ql/src/test/results/clientpositive/llap/schema_evol_orc_acid_part_update_llap_io.q.out
+++ b/ql/src/test/results/clientpositive/llap/schema_evol_orc_acid_part_update_llap_io.q.out
@@ -177,12 +177,20 @@ insert_num	part	a	b	c	d
 115	1	32768	new	99	major glaciation
 PREHOOK: query: alter table partitioned_update_1 partition(part=1) compact 'major'
 PREHOOK: type: ALTERTABLE_COMPACT
+PREHOOK: Input: default@partitioned_update_1
+PREHOOK: Output: default@partitioned_update_1@part=1
 POSTHOOK: query: alter table partitioned_update_1 partition(part=1) compact 'major'
 POSTHOOK: type: ALTERTABLE_COMPACT
+POSTHOOK: Input: default@partitioned_update_1
+POSTHOOK: Output: default@partitioned_update_1@part=1
 PREHOOK: query: alter table partitioned_update_1 partition(part=2) compact 'major'
 PREHOOK: type: ALTERTABLE_COMPACT
+PREHOOK: Input: default@partitioned_update_1
+PREHOOK: Output: default@partitioned_update_1@part=2
 POSTHOOK: query: alter table partitioned_update_1 partition(part=2) compact 'major'
 POSTHOOK: type: ALTERTABLE_COMPACT
+POSTHOOK: Input: default@partitioned_update_1
+POSTHOOK: Output: default@partitioned_update_1@part=2
 PREHOOK: query: select insert_num,part,a,b,c,d from partitioned_update_1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@partitioned_update_1
@@ -345,12 +353,20 @@ insert_num	part	a	b	c	d
 115	1	32768	new	32768	major glaciation
 PREHOOK: query: alter table partitioned_delete_1 partition(part=1) compact 'major'
 PREHOOK: type: ALTERTABLE_COMPACT
+PREHOOK: Input: default@partitioned_delete_1
+PREHOOK: Output: default@partitioned_delete_1@part=1
 POSTHOOK: query: alter table partitioned_delete_1 partition(part=1) compact 'major'
 POSTHOOK: type: ALTERTABLE_COMPACT
+POSTHOOK: Input: default@partitioned_delete_1
+POSTHOOK: Output: default@partitioned_delete_1@part=1
 PREHOOK: query: alter table partitioned_delete_1 partition(part=2) compact 'major'
 PREHOOK: type: ALTERTABLE_COMPACT
+PREHOOK: Input: default@partitioned_delete_1
+PREHOOK: Output: default@partitioned_delete_1@part=2
 POSTHOOK: query: alter table partitioned_delete_1 partition(part=2) compact 'major'
 POSTHOOK: type: ALTERTABLE_COMPACT
+POSTHOOK: Input: default@partitioned_delete_1
+POSTHOOK: Output: default@partitioned_delete_1@part=2
 PREHOOK: query: select insert_num,part,a,b,c,d from partitioned_delete_1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@partitioned_delete_1
@@ -510,12 +526,20 @@ insert_num	part	a	b	c	d
 113	1	40000	new	40000	Delaware
 PREHOOK: query: alter table partitioned_delete_2 partition(part=1) compact 'major'
 PREHOOK: type: ALTERTABLE_COMPACT
+PREHOOK: Input: default@partitioned_delete_2
+PREHOOK: Output: default@partitioned_delete_2@part=1
 POSTHOOK: query: alter table partitioned_delete_2 partition(part=1) compact 'major'
 POSTHOOK: type: ALTERTABLE_COMPACT
+POSTHOOK: Input: default@partitioned_delete_2
+POSTHOOK: Output: default@partitioned_delete_2@part=1
 PREHOOK: query: alter table partitioned_delete_2 partition(part=2) compact 'major'
 PREHOOK: type: ALTERTABLE_COMPACT
+PREHOOK: Input: default@partitioned_delete_2
+PREHOOK: Output: default@partitioned_delete_2@part=2
 POSTHOOK: query: alter table partitioned_delete_2 partition(part=2) compact 'major'
 POSTHOOK: type: ALTERTABLE_COMPACT
+POSTHOOK: Input: default@partitioned_delete_2
+POSTHOOK: Output: default@partitioned_delete_2@part=2
 PREHOOK: query: select insert_num,part,a,b,c,d from partitioned_delete_2
 PREHOOK: type: QUERY
 PREHOOK: Input: default@partitioned_delete_2
diff --git a/ql/src/test/results/clientpositive/llap/schema_evol_orc_acid_table_update.q.out b/ql/src/test/results/clientpositive/llap/schema_evol_orc_acid_table_update.q.out
index 210302edd2..8b56e0e88b 100644
--- a/ql/src/test/results/clientpositive/llap/schema_evol_orc_acid_table_update.q.out
+++ b/ql/src/test/results/clientpositive/llap/schema_evol_orc_acid_table_update.q.out
@@ -142,8 +142,12 @@ NULL	new	99	baffling
 NULL	original	99	NULL
 PREHOOK: query: alter table table5_n2 compact 'major'
 PREHOOK: type: ALTERTABLE_COMPACT
+PREHOOK: Input: default@table5_n2
+PREHOOK: Output: default@table5_n2
 POSTHOOK: query: alter table table5_n2 compact 'major'
 POSTHOOK: type: ALTERTABLE_COMPACT
+POSTHOOK: Input: default@table5_n2
+POSTHOOK: Output: default@table5_n2
 PREHOOK: query: select a,b,c,d from table5_n2
 PREHOOK: type: QUERY
 PREHOOK: Input: default@table5_n2
@@ -288,8 +292,12 @@ NULL	new	NULL	baffling
 NULL	original	NULL	NULL
 PREHOOK: query: alter table table6_n1 compact 'major'
 PREHOOK: type: ALTERTABLE_COMPACT
+PREHOOK: Input: default@table6_n1
+PREHOOK: Output: default@table6_n1
 POSTHOOK: query: alter table table6_n1 compact 'major'
 POSTHOOK: type: ALTERTABLE_COMPACT
+POSTHOOK: Input: default@table6_n1
+POSTHOOK: Output: default@table6_n1
 PREHOOK: query: select a,b,c,d from table6_n1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@table6_n1
@@ -427,8 +435,12 @@ NULL	new	NULL	baffling
 NULL	original	NULL	NULL
 PREHOOK: query: alter table table7_n1 compact 'major'
 PREHOOK: type: ALTERTABLE_COMPACT
+PREHOOK: Input: default@table7_n1
+PREHOOK: Output: default@table7_n1
 POSTHOOK: query: alter table table7_n1 compact 'major'
 POSTHOOK: type: ALTERTABLE_COMPACT
+POSTHOOK: Input: default@table7_n1
+POSTHOOK: Output: default@table7_n1
 PREHOOK: query: select a,b,c,d from table7_n1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@table7_n1
diff --git a/ql/src/test/results/clientpositive/llap/schema_evol_orc_acid_table_update_llap_io.q.out b/ql/src/test/results/clientpositive/llap/schema_evol_orc_acid_table_update_llap_io.q.out
index dc7cad88c1..8e7ceb14f5 100644
--- a/ql/src/test/results/clientpositive/llap/schema_evol_orc_acid_table_update_llap_io.q.out
+++ b/ql/src/test/results/clientpositive/llap/schema_evol_orc_acid_table_update_llap_io.q.out
@@ -142,8 +142,12 @@ NULL	new	99	baffling
 NULL	original	99	NULL
 PREHOOK: query: alter table table5_n0 compact 'major'
 PREHOOK: type: ALTERTABLE_COMPACT
+PREHOOK: Input: default@table5_n0
+PREHOOK: Output: default@table5_n0
 POSTHOOK: query: alter table table5_n0 compact 'major'
 POSTHOOK: type: ALTERTABLE_COMPACT
+POSTHOOK: Input: default@table5_n0
+POSTHOOK: Output: default@table5_n0
 PREHOOK: query: select a,b,c,d from table5_n0
 PREHOOK: type: QUERY
 PREHOOK: Input: default@table5_n0
@@ -288,8 +292,12 @@ NULL	new	NULL	baffling
 NULL	original	NULL	NULL
 PREHOOK: query: alter table table6_n0 compact 'major'
 PREHOOK: type: ALTERTABLE_COMPACT
+PREHOOK: Input: default@table6_n0
+PREHOOK: Output: default@table6_n0
 POSTHOOK: query: alter table table6_n0 compact 'major'
 POSTHOOK: type: ALTERTABLE_COMPACT
+POSTHOOK: Input: default@table6_n0
+POSTHOOK: Output: default@table6_n0
 PREHOOK: query: select a,b,c,d from table6_n0
 PREHOOK: type: QUERY
 PREHOOK: Input: default@table6_n0
@@ -427,8 +435,12 @@ NULL	new	NULL	baffling
 NULL	original	NULL	NULL
 PREHOOK: query: alter table table7_n0 compact 'major'
 PREHOOK: type: ALTERTABLE_COMPACT
+PREHOOK: Input: default@table7_n0
+PREHOOK: Output: default@table7_n0
 POSTHOOK: query: alter table table7_n0 compact 'major'
 POSTHOOK: type: ALTERTABLE_COMPACT
+POSTHOOK: Input: default@table7_n0
+POSTHOOK: Output: default@table7_n0
 PREHOOK: query: select a,b,c,d from table7_n0
 PREHOOK: type: QUERY
 PREHOOK: Input: default@table7_n0
diff --git a/ql/src/test/results/clientpositive/llap/schema_evol_orc_acidvec_part_update.q.out b/ql/src/test/results/clientpositive/llap/schema_evol_orc_acidvec_part_update.q.out
index e0c60770fb..fe7ed9a010 100644
--- a/ql/src/test/results/clientpositive/llap/schema_evol_orc_acidvec_part_update.q.out
+++ b/ql/src/test/results/clientpositive/llap/schema_evol_orc_acidvec_part_update.q.out
@@ -177,12 +177,20 @@ insert_num	part	a	b	c	d
 115	1	32768	new	99	major glaciation
 PREHOOK: query: alter table partitioned_update_1_n2 partition(part=1) compact 'major'
 PREHOOK: type: ALTERTABLE_COMPACT
+PREHOOK: Input: default@partitioned_update_1_n2
+PREHOOK: Output: default@partitioned_update_1_n2@part=1
 POSTHOOK: query: alter table partitioned_update_1_n2 partition(part=1) compact 'major'
 POSTHOOK: type: ALTERTABLE_COMPACT
+POSTHOOK: Input: default@partitioned_update_1_n2
+POSTHOOK: Output: default@partitioned_update_1_n2@part=1
 PREHOOK: query: alter table partitioned_update_1_n2 partition(part=2) compact 'major'
 PREHOOK: type: ALTERTABLE_COMPACT
+PREHOOK: Input: default@partitioned_update_1_n2
+PREHOOK: Output: default@partitioned_update_1_n2@part=2
 POSTHOOK: query: alter table partitioned_update_1_n2 partition(part=2) compact 'major'
 POSTHOOK: type: ALTERTABLE_COMPACT
+POSTHOOK: Input: default@partitioned_update_1_n2
+POSTHOOK: Output: default@partitioned_update_1_n2@part=2
 PREHOOK: query: select insert_num,part,a,b,c,d from partitioned_update_1_n2
 PREHOOK: type: QUERY
 PREHOOK: Input: default@partitioned_update_1_n2
@@ -345,12 +353,20 @@ insert_num	part	a	b	c	d
 115	1	32768	new	32768	major glaciation
 PREHOOK: query: alter table partitioned_delete_1_n2 partition(part=1) compact 'major'
 PREHOOK: type: ALTERTABLE_COMPACT
+PREHOOK: Input: default@partitioned_delete_1_n2
+PREHOOK: Output: default@partitioned_delete_1_n2@part=1
 POSTHOOK: query: alter table partitioned_delete_1_n2 partition(part=1) compact 'major'
 POSTHOOK: type: ALTERTABLE_COMPACT
+POSTHOOK: Input: default@partitioned_delete_1_n2
+POSTHOOK: Output: default@partitioned_delete_1_n2@part=1
 PREHOOK: query: alter table partitioned_delete_1_n2 partition(part=2) compact 'major'
 PREHOOK: type: ALTERTABLE_COMPACT
+PREHOOK: Input: default@partitioned_delete_1_n2
+PREHOOK: Output: default@partitioned_delete_1_n2@part=2
 POSTHOOK: query: alter table partitioned_delete_1_n2 partition(part=2) compact 'major'
 POSTHOOK: type: ALTERTABLE_COMPACT
+POSTHOOK: Input: default@partitioned_delete_1_n2
+POSTHOOK: Output: default@partitioned_delete_1_n2@part=2
 PREHOOK: query: select insert_num,part,a,b,c,d from partitioned_delete_1_n2
 PREHOOK: type: QUERY
 PREHOOK: Input: default@partitioned_delete_1_n2
@@ -510,12 +526,20 @@ insert_num	part	a	b	c	d
 113	1	40000	new	40000	Delaware
 PREHOOK: query: alter table partitioned_delete_2_n2 partition(part=1) compact 'major'
 PREHOOK: type: ALTERTABLE_COMPACT
+PREHOOK: Input: default@partitioned_delete_2_n2
+PREHOOK: Output: default@partitioned_delete_2_n2@part=1
 POSTHOOK: query: alter table partitioned_delete_2_n2 partition(part=1) compact 'major'
 POSTHOOK: type: ALTERTABLE_COMPACT
+POSTHOOK: Input: default@partitioned_delete_2_n2
+POSTHOOK: Output: default@partitioned_delete_2_n2@part=1
 PREHOOK: query: alter table partitioned_delete_2_n2 partition(part=2) compact 'major'
 PREHOOK: type: ALTERTABLE_COMPACT
+PREHOOK: Input: default@partitioned_delete_2_n2
+PREHOOK: Output: default@partitioned_delete_2_n2@part=2
 POSTHOOK: query: alter table partitioned_delete_2_n2 partition(part=2) compact 'major'
 POSTHOOK: type: ALTERTABLE_COMPACT
+POSTHOOK: Input: default@partitioned_delete_2_n2
+POSTHOOK: Output: default@partitioned_delete_2_n2@part=2
 PREHOOK: query: select insert_num,part,a,b,c,d from partitioned_delete_2_n2
 PREHOOK: type: QUERY
 PREHOOK: Input: default@partitioned_delete_2_n2
diff --git a/ql/src/test/results/clientpositive/llap/schema_evol_orc_acidvec_part_update_llap_io.q.out b/ql/src/test/results/clientpositive/llap/schema_evol_orc_acidvec_part_update_llap_io.q.out
index 121066db98..2d41821352 100644
--- a/ql/src/test/results/clientpositive/llap/schema_evol_orc_acidvec_part_update_llap_io.q.out
+++ b/ql/src/test/results/clientpositive/llap/schema_evol_orc_acidvec_part_update_llap_io.q.out
@@ -177,12 +177,20 @@ insert_num	part	a	b	c	d
 115	1	32768	new	99	major glaciation
 PREHOOK: query: alter table partitioned_update_1_n0 partition(part=1) compact 'major'
 PREHOOK: type: ALTERTABLE_COMPACT
+PREHOOK: Input: default@partitioned_update_1_n0
+PREHOOK: Output: default@partitioned_update_1_n0@part=1
 POSTHOOK: query: alter table partitioned_update_1_n0 partition(part=1) compact 'major'
 POSTHOOK: type: ALTERTABLE_COMPACT
+POSTHOOK: Input: default@partitioned_update_1_n0
+POSTHOOK: Output: default@partitioned_update_1_n0@part=1
 PREHOOK: query: alter table partitioned_update_1_n0 partition(part=2) compact 'major'
 PREHOOK: type: ALTERTABLE_COMPACT
+PREHOOK: Input: default@partitioned_update_1_n0
+PREHOOK: Output: default@partitioned_update_1_n0@part=2
 POSTHOOK: query: alter table partitioned_update_1_n0 partition(part=2) compact 'major'
 POSTHOOK: type: ALTERTABLE_COMPACT
+POSTHOOK: Input: default@partitioned_update_1_n0
+POSTHOOK: Output: default@partitioned_update_1_n0@part=2
 PREHOOK: query: select insert_num,part,a,b,c,d from partitioned_update_1_n0
 PREHOOK: type: QUERY
 PREHOOK: Input: default@partitioned_update_1_n0
@@ -345,12 +353,20 @@ insert_num	part	a	b	c	d
 115	1	32768	new	32768	major glaciation
 PREHOOK: query: alter table partitioned_delete_1_n0 partition(part=1) compact 'major'
 PREHOOK: type: ALTERTABLE_COMPACT
+PREHOOK: Input: default@partitioned_delete_1_n0
+PREHOOK: Output: default@partitioned_delete_1_n0@part=1
 POSTHOOK: query: alter table partitioned_delete_1_n0 partition(part=1) compact 'major'
 POSTHOOK: type: ALTERTABLE_COMPACT
+POSTHOOK: Input: default@partitioned_delete_1_n0
+POSTHOOK: Output: default@partitioned_delete_1_n0@part=1
 PREHOOK: query: alter table partitioned_delete_1_n0 partition(part=2) compact 'major'
 PREHOOK: type: ALTERTABLE_COMPACT
+PREHOOK: Input: default@partitioned_delete_1_n0
+PREHOOK: Output: default@partitioned_delete_1_n0@part=2
 POSTHOOK: query: alter table partitioned_delete_1_n0 partition(part=2) compact 'major'
 POSTHOOK: type: ALTERTABLE_COMPACT
+POSTHOOK: Input: default@partitioned_delete_1_n0
+POSTHOOK: Output: default@partitioned_delete_1_n0@part=2
 PREHOOK: query: select insert_num,part,a,b,c,d from partitioned_delete_1_n0
 PREHOOK: type: QUERY
 PREHOOK: Input: default@partitioned_delete_1_n0
@@ -510,12 +526,20 @@ insert_num	part	a	b	c	d
 113	1	40000	new	40000	Delaware
 PREHOOK: query: alter table partitioned_delete_2_n0 partition(part=1) compact 'major'
 PREHOOK: type: ALTERTABLE_COMPACT
+PREHOOK: Input: default@partitioned_delete_2_n0
+PREHOOK: Output: default@partitioned_delete_2_n0@part=1
 POSTHOOK: query: alter table partitioned_delete_2_n0 partition(part=1) compact 'major'
 POSTHOOK: type: ALTERTABLE_COMPACT
+POSTHOOK: Input: default@partitioned_delete_2_n0
+POSTHOOK: Output: default@partitioned_delete_2_n0@part=1
 PREHOOK: query: alter table partitioned_delete_2_n0 partition(part=2) compact 'major'
 PREHOOK: type: ALTERTABLE_COMPACT
+PREHOOK: Input: default@partitioned_delete_2_n0
+PREHOOK: Output: default@partitioned_delete_2_n0@part=2
 POSTHOOK: query: alter table partitioned_delete_2_n0 partition(part=2) compact 'major'
 POSTHOOK: type: ALTERTABLE_COMPACT
+POSTHOOK: Input: default@partitioned_delete_2_n0
+POSTHOOK: Output: default@partitioned_delete_2_n0@part=2
 PREHOOK: query: select insert_num,part,a,b,c,d from partitioned_delete_2_n0
 PREHOOK: type: QUERY
 PREHOOK: Input: default@partitioned_delete_2_n0
diff --git a/ql/src/test/results/clientpositive/llap/schema_evol_orc_acidvec_table_update.q.out b/ql/src/test/results/clientpositive/llap/schema_evol_orc_acidvec_table_update.q.out
index 854c256df6..3dd3647d00 100644
--- a/ql/src/test/results/clientpositive/llap/schema_evol_orc_acidvec_table_update.q.out
+++ b/ql/src/test/results/clientpositive/llap/schema_evol_orc_acidvec_table_update.q.out
@@ -142,8 +142,12 @@ NULL	new	99	baffling
 NULL	original	99	NULL
 PREHOOK: query: alter table table5_n3 compact 'major'
 PREHOOK: type: ALTERTABLE_COMPACT
+PREHOOK: Input: default@table5_n3
+PREHOOK: Output: default@table5_n3
 POSTHOOK: query: alter table table5_n3 compact 'major'
 POSTHOOK: type: ALTERTABLE_COMPACT
+POSTHOOK: Input: default@table5_n3
+POSTHOOK: Output: default@table5_n3
 PREHOOK: query: select a,b,c,d from table5_n3
 PREHOOK: type: QUERY
 PREHOOK: Input: default@table5_n3
@@ -288,8 +292,12 @@ NULL	new	NULL	baffling
 NULL	original	NULL	NULL
 PREHOOK: query: alter table table6_n2 compact 'major'
 PREHOOK: type: ALTERTABLE_COMPACT
+PREHOOK: Input: default@table6_n2
+PREHOOK: Output: default@table6_n2
 POSTHOOK: query: alter table table6_n2 compact 'major'
 POSTHOOK: type: ALTERTABLE_COMPACT
+POSTHOOK: Input: default@table6_n2
+POSTHOOK: Output: default@table6_n2
 PREHOOK: query: select a,b,c,d from table6_n2
 PREHOOK: type: QUERY
 PREHOOK: Input: default@table6_n2
@@ -427,8 +435,12 @@ NULL	new	NULL	baffling
 NULL	original	NULL	NULL
 PREHOOK: query: alter table table7_n2 compact 'major'
 PREHOOK: type: ALTERTABLE_COMPACT
+PREHOOK: Input: default@table7_n2
+PREHOOK: Output: default@table7_n2
 POSTHOOK: query: alter table table7_n2 compact 'major'
 POSTHOOK: type: ALTERTABLE_COMPACT
+POSTHOOK: Input: default@table7_n2
+POSTHOOK: Output: default@table7_n2
 PREHOOK: query: select a,b,c,d from table7_n2
 PREHOOK: type: QUERY
 PREHOOK: Input: default@table7_n2
diff --git a/ql/src/test/results/clientpositive/llap/schema_evol_orc_acidvec_table_update_llap_io.q.out b/ql/src/test/results/clientpositive/llap/schema_evol_orc_acidvec_table_update_llap_io.q.out
index 536f41e0fa..43adfa5f7a 100644
--- a/ql/src/test/results/clientpositive/llap/schema_evol_orc_acidvec_table_update_llap_io.q.out
+++ b/ql/src/test/results/clientpositive/llap/schema_evol_orc_acidvec_table_update_llap_io.q.out
@@ -142,8 +142,12 @@ NULL	new	99	baffling
 NULL	original	99	NULL
 PREHOOK: query: alter table table5 compact 'major'
 PREHOOK: type: ALTERTABLE_COMPACT
+PREHOOK: Input: default@table5
+PREHOOK: Output: default@table5
 POSTHOOK: query: alter table table5 compact 'major'
 POSTHOOK: type: ALTERTABLE_COMPACT
+POSTHOOK: Input: default@table5
+POSTHOOK: Output: default@table5
 PREHOOK: query: select a,b,c,d from table5
 PREHOOK: type: QUERY
 PREHOOK: Input: default@table5
@@ -288,8 +292,12 @@ NULL	new	NULL	baffling
 NULL	original	NULL	NULL
 PREHOOK: query: alter table table6 compact 'major'
 PREHOOK: type: ALTERTABLE_COMPACT
+PREHOOK: Input: default@table6
+PREHOOK: Output: default@table6
 POSTHOOK: query: alter table table6 compact 'major'
 POSTHOOK: type: ALTERTABLE_COMPACT
+POSTHOOK: Input: default@table6
+POSTHOOK: Output: default@table6
 PREHOOK: query: select a,b,c,d from table6
 PREHOOK: type: QUERY
 PREHOOK: Input: default@table6
@@ -427,8 +435,12 @@ NULL	new	NULL	baffling
 NULL	original	NULL	NULL
 PREHOOK: query: alter table table7 compact 'major'
 PREHOOK: type: ALTERTABLE_COMPACT
+PREHOOK: Input: default@table7
+PREHOOK: Output: default@table7
 POSTHOOK: query: alter table table7 compact 'major'
 POSTHOOK: type: ALTERTABLE_COMPACT
+POSTHOOK: Input: default@table7
+POSTHOOK: Output: default@table7
 PREHOOK: query: select a,b,c,d from table7
 PREHOOK: type: QUERY
 PREHOOK: Input: default@table7
diff --git a/ql/src/test/results/clientpositive/llap/sysdb.q.out b/ql/src/test/results/clientpositive/llap/sysdb.q.out
index 0ecb692dc7..1c2fc5062f 100644
--- a/ql/src/test/results/clientpositive/llap/sysdb.q.out
+++ b/ql/src/test/results/clientpositive/llap/sysdb.q.out
@@ -46,12 +46,20 @@ POSTHOOK: Output: database:default
 POSTHOOK: Output: default@scr_txn_2
 PREHOOK: query: alter table scr_txn compact 'major'
 PREHOOK: type: ALTERTABLE_COMPACT
+PREHOOK: Input: default@scr_txn
+PREHOOK: Output: default@scr_txn
 POSTHOOK: query: alter table scr_txn compact 'major'
 POSTHOOK: type: ALTERTABLE_COMPACT
+POSTHOOK: Input: default@scr_txn
+POSTHOOK: Output: default@scr_txn
 PREHOOK: query: alter table scr_txn_2 compact 'minor'
 PREHOOK: type: ALTERTABLE_COMPACT
+PREHOOK: Input: default@scr_txn_2
+PREHOOK: Output: default@scr_txn_2
 POSTHOOK: query: alter table scr_txn_2 compact 'minor'
 POSTHOOK: type: ALTERTABLE_COMPACT
+POSTHOOK: Input: default@scr_txn_2
+POSTHOOK: Output: default@scr_txn_2
 PREHOOK: query: CREATE TEMPORARY TABLE src_tmp (key int, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/tez/acid_vectorization_original_tez.q.out b/ql/src/test/results/clientpositive/tez/acid_vectorization_original_tez.q.out
index a4ab46ea76..a054e08c71 100644
--- a/ql/src/test/results/clientpositive/tez/acid_vectorization_original_tez.q.out
+++ b/ql/src/test/results/clientpositive/tez/acid_vectorization_original_tez.q.out
@@ -818,8 +818,12 @@ POSTHOOK: Input: default@over10k_orc_bucketed_n0
 POSTHOOK: Output: hdfs://### HDFS PATH ###
 PREHOOK: query: explain alter table over10k_orc_bucketed_n0 compact 'major' WITH OVERWRITE TBLPROPERTIES ('compactor.mapreduce.map.memory.mb'='500', 'compactor.mapreduce.reduce.memory.mb'='500','compactor.mapreduce.map.memory.mb'='500', 'compactor.hive.tez.container.size'='500')
 PREHOOK: type: ALTERTABLE_COMPACT
+PREHOOK: Input: default@over10k_orc_bucketed_n0
+PREHOOK: Output: default@over10k_orc_bucketed_n0
 POSTHOOK: query: explain alter table over10k_orc_bucketed_n0 compact 'major' WITH OVERWRITE TBLPROPERTIES ('compactor.mapreduce.map.memory.mb'='500', 'compactor.mapreduce.reduce.memory.mb'='500','compactor.mapreduce.map.memory.mb'='500', 'compactor.hive.tez.container.size'='500')
 POSTHOOK: type: ALTERTABLE_COMPACT
+POSTHOOK: Input: default@over10k_orc_bucketed_n0
+POSTHOOK: Output: default@over10k_orc_bucketed_n0
 STAGE DEPENDENCIES:
   Stage-0 is a root stage
 
@@ -827,6 +831,11 @@ STAGE PLANS:
   Stage: Stage-0
     Compact
       compaction type: major
+      table name: default.over10k_orc_bucketed_n0
+      properties:
+        compactor.hive.tez.container.size 500
+        compactor.mapreduce.map.memory.mb 500
+        compactor.mapreduce.reduce.memory.mb 500
       properties:
         compactor.hive.tez.container.size 500
         compactor.mapreduce.map.memory.mb 500
@@ -835,8 +844,12 @@ STAGE PLANS:
 
 PREHOOK: query: alter table over10k_orc_bucketed_n0 compact 'major' WITH OVERWRITE TBLPROPERTIES ('compactor.mapreduce.map.memory.mb'='500', 'compactor.mapreduce.reduce.memory.mb'='500','compactor.mapreduce.map.memory.mb'='500', 'compactor.hive.tez.container.size'='500')
 PREHOOK: type: ALTERTABLE_COMPACT
+PREHOOK: Input: default@over10k_orc_bucketed_n0
+PREHOOK: Output: default@over10k_orc_bucketed_n0
 POSTHOOK: query: alter table over10k_orc_bucketed_n0 compact 'major' WITH OVERWRITE TBLPROPERTIES ('compactor.mapreduce.map.memory.mb'='500', 'compactor.mapreduce.reduce.memory.mb'='500','compactor.mapreduce.map.memory.mb'='500', 'compactor.hive.tez.container.size'='500')
 POSTHOOK: type: ALTERTABLE_COMPACT
+POSTHOOK: Input: default@over10k_orc_bucketed_n0
+POSTHOOK: Output: default@over10k_orc_bucketed_n0
 PREHOOK: query: select ROW__ID, t, si, i from over10k_orc_bucketed_n0 where b = 4294967363 and t < 100 order by ROW__ID
 PREHOOK: type: QUERY
 PREHOOK: Input: default@over10k_orc_bucketed_n0
