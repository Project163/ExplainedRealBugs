diff --git a/contrib/src/test/results/clientnegative/serde_regex.q.out b/contrib/src/test/results/clientnegative/serde_regex.q.out
index 8078b2c1fa..c5a22b05e7 100644
--- a/contrib/src/test/results/clientnegative/serde_regex.q.out
+++ b/contrib/src/test/results/clientnegative/serde_regex.q.out
@@ -1,7 +1,9 @@
 PREHOOK: query: USE default
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:default
 POSTHOOK: query: USE default
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:default
 PREHOOK: query: --  This should fail because Regex SerDe supports only columns of type string
 EXPLAIN
 CREATE TABLE serde_regex(
@@ -74,4 +76,5 @@ WITH SERDEPROPERTIES (
 STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@serde_regex
 FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask. java.lang.RuntimeException: MetaException(message:org.apache.hadoop.hive.serde2.SerDeException org.apache.hadoop.hive.contrib.serde2.RegexSerDe only accepts string columns, but column[5] named status has type int)
diff --git a/contrib/src/test/results/clientpositive/fileformat_base64.q.out b/contrib/src/test/results/clientpositive/fileformat_base64.q.out
index 0bd238e044..852e351156 100644
--- a/contrib/src/test/results/clientpositive/fileformat_base64.q.out
+++ b/contrib/src/test/results/clientpositive/fileformat_base64.q.out
@@ -29,6 +29,7 @@ PREHOOK: query: CREATE TABLE base64_test(key INT, value STRING) STORED AS
   OUTPUTFORMAT 'org.apache.hadoop.hive.contrib.fileformat.base64.Base64TextOutputFormat'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@base64_test
 POSTHOOK: query: CREATE TABLE base64_test(key INT, value STRING) STORED AS
   INPUTFORMAT 'org.apache.hadoop.hive.contrib.fileformat.base64.Base64TextInputFormat'
   OUTPUTFORMAT 'org.apache.hadoop.hive.contrib.fileformat.base64.Base64TextOutputFormat'
diff --git a/contrib/src/test/results/clientpositive/serde_regex.q.out b/contrib/src/test/results/clientpositive/serde_regex.q.out
index b75ccec085..13019eb05d 100644
--- a/contrib/src/test/results/clientpositive/serde_regex.q.out
+++ b/contrib/src/test/results/clientpositive/serde_regex.q.out
@@ -68,6 +68,7 @@ WITH SERDEPROPERTIES (
 STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@serde_regex
 POSTHOOK: query: CREATE TABLE serde_regex(
   host STRING,
   identity STRING,
diff --git a/contrib/src/test/results/clientpositive/serde_s3.q.out b/contrib/src/test/results/clientpositive/serde_s3.q.out
index 58e6337418..abe72a53e2 100644
--- a/contrib/src/test/results/clientpositive/serde_s3.q.out
+++ b/contrib/src/test/results/clientpositive/serde_s3.q.out
@@ -7,6 +7,7 @@ ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.s3.S3LogDeserializer'
 STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@s3log
 POSTHOOK: query: CREATE TABLE s3log
 ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.s3.S3LogDeserializer'
 STORED AS TEXTFILE
diff --git a/contrib/src/test/results/clientpositive/serde_typedbytes.q.out b/contrib/src/test/results/clientpositive/serde_typedbytes.q.out
index 6613fa463c..dd30bab86e 100644
--- a/contrib/src/test/results/clientpositive/serde_typedbytes.q.out
+++ b/contrib/src/test/results/clientpositive/serde_typedbytes.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/contrib/src/test/results/clientpositive/serde_typedbytes2.q.out b/contrib/src/test/results/clientpositive/serde_typedbytes2.q.out
index 3e0c9bd40d..93afe5e5e5 100644
--- a/contrib/src/test/results/clientpositive/serde_typedbytes2.q.out
+++ b/contrib/src/test/results/clientpositive/serde_typedbytes2.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: CREATE TABLE dest1(key SMALLINT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key SMALLINT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/contrib/src/test/results/clientpositive/serde_typedbytes3.q.out b/contrib/src/test/results/clientpositive/serde_typedbytes3.q.out
index 02f1578468..bbefb28440 100644
--- a/contrib/src/test/results/clientpositive/serde_typedbytes3.q.out
+++ b/contrib/src/test/results/clientpositive/serde_typedbytes3.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: CREATE TABLE dest1(key STRING, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key STRING, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/contrib/src/test/results/clientpositive/serde_typedbytes4.q.out b/contrib/src/test/results/clientpositive/serde_typedbytes4.q.out
index 17ea825642..1e1ab3de14 100644
--- a/contrib/src/test/results/clientpositive/serde_typedbytes4.q.out
+++ b/contrib/src/test/results/clientpositive/serde_typedbytes4.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: CREATE TABLE dest1(key STRING, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key STRING, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/contrib/src/test/results/clientpositive/serde_typedbytes5.q.out b/contrib/src/test/results/clientpositive/serde_typedbytes5.q.out
index fc350fb7a8..43404a4c2d 100644
--- a/contrib/src/test/results/clientpositive/serde_typedbytes5.q.out
+++ b/contrib/src/test/results/clientpositive/serde_typedbytes5.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/contrib/src/test/results/clientpositive/serde_typedbytes6.q.out b/contrib/src/test/results/clientpositive/serde_typedbytes6.q.out
index d14ed2e511..1a64d480bb 100644
--- a/contrib/src/test/results/clientpositive/serde_typedbytes6.q.out
+++ b/contrib/src/test/results/clientpositive/serde_typedbytes6.q.out
@@ -13,6 +13,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: CREATE TABLE table1 (a STRING) ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.TypedBytesSerDe'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table1
 POSTHOOK: query: CREATE TABLE table1 (a STRING) ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.TypedBytesSerDe'
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -20,6 +21,7 @@ POSTHOOK: Output: default@table1
 PREHOOK: query: CREATE TABLE table2 (a STRING, b STRING) ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.TypedBytesSerDe'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table2
 POSTHOOK: query: CREATE TABLE table2 (a STRING, b STRING) ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.TypedBytesSerDe'
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -27,6 +29,7 @@ POSTHOOK: Output: default@table2
 PREHOOK: query: CREATE TABLE table3 (a STRING, b STRING, c STRING) ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.TypedBytesSerDe'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table3
 POSTHOOK: query: CREATE TABLE table3 (a STRING, b STRING, c STRING) ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.TypedBytesSerDe'
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/contrib/src/test/results/clientpositive/serde_typedbytes_null.q.out b/contrib/src/test/results/clientpositive/serde_typedbytes_null.q.out
index 916fff8cf4..26956cb8e2 100644
--- a/contrib/src/test/results/clientpositive/serde_typedbytes_null.q.out
+++ b/contrib/src/test/results/clientpositive/serde_typedbytes_null.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: CREATE TABLE table1 (a STRING) ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.TypedBytesSerDe' STORED AS SEQUENCEFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table1
 POSTHOOK: query: CREATE TABLE table1 (a STRING) ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.TypedBytesSerDe' STORED AS SEQUENCEFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/hbase-handler/src/test/results/negative/cascade_dbdrop.q.out b/hbase-handler/src/test/results/negative/cascade_dbdrop.q.out
index e26f47b216..61e333c164 100644
--- a/hbase-handler/src/test/results/negative/cascade_dbdrop.q.out
+++ b/hbase-handler/src/test/results/negative/cascade_dbdrop.q.out
@@ -1,7 +1,9 @@
 PREHOOK: query: CREATE DATABASE hbaseDB
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:hbaseDB
 POSTHOOK: query: CREATE DATABASE hbaseDB
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:hbaseDB
 PREHOOK: query: -- EXCLUDE_HADOOP_MAJOR_VERSIONS(0.20, 0.20S)
 -- Hadoop 0.23 changes the behavior FsShell on Exit Codes
 -- In Hadoop 0.20
@@ -18,6 +20,7 @@ WITH SERDEPROPERTIES ("hbase.columns.mapping" = ":key,cf:string")
 TBLPROPERTIES ("hbase.table.name" = "hbase_table_0")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:hbasedb
+PREHOOK: Output: hbaseDB@hbaseDB.hbase_table_0
 POSTHOOK: query: -- EXCLUDE_HADOOP_MAJOR_VERSIONS(0.20, 0.20S)
 -- Hadoop 0.23 changes the behavior FsShell on Exit Codes
 -- In Hadoop 0.20
@@ -34,6 +37,7 @@ WITH SERDEPROPERTIES ("hbase.columns.mapping" = ":key,cf:string")
 TBLPROPERTIES ("hbase.table.name" = "hbase_table_0")
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:hbasedb
+POSTHOOK: Output: hbaseDB@hbaseDB.hbase_table_0
 POSTHOOK: Output: hbaseDB@hbase_table_0
 Found 3 items
 #### A masked pattern was here ####
diff --git a/hbase-handler/src/test/results/negative/generatehfiles_require_family_path.q.out b/hbase-handler/src/test/results/negative/generatehfiles_require_family_path.q.out
index f0abcd51fa..487dd66008 100644
--- a/hbase-handler/src/test/results/negative/generatehfiles_require_family_path.q.out
+++ b/hbase-handler/src/test/results/negative/generatehfiles_require_family_path.q.out
@@ -11,6 +11,7 @@ STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'
 WITH SERDEPROPERTIES ('hbase.columns.mapping' = ':key,cf:string')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@hbase_bulk
 POSTHOOK: query: CREATE TABLE hbase_bulk (key INT, value STRING)
 STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'
 WITH SERDEPROPERTIES ('hbase.columns.mapping' = ':key,cf:string')
diff --git a/hbase-handler/src/test/results/positive/external_table_ppd.q.out b/hbase-handler/src/test/results/positive/external_table_ppd.q.out
index 3519279a44..6d48edb615 100644
--- a/hbase-handler/src/test/results/positive/external_table_ppd.q.out
+++ b/hbase-handler/src/test/results/positive/external_table_ppd.q.out
@@ -16,6 +16,7 @@ TBLPROPERTIES ("hbase.table.name" = "t_hive",
                "hbase.table.default.storage.type" = "binary")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t_hbase
 POSTHOOK: query: CREATE TABLE t_hbase(key STRING,
                      tinyint_col TINYINT,
                      smallint_col SMALLINT,
diff --git a/hbase-handler/src/test/results/positive/hbase_binary_external_table_queries.q.out b/hbase-handler/src/test/results/positive/hbase_binary_external_table_queries.q.out
index 340e7ba2f1..2f43030e68 100644
--- a/hbase-handler/src/test/results/positive/hbase_binary_external_table_queries.q.out
+++ b/hbase-handler/src/test/results/positive/hbase_binary_external_table_queries.q.out
@@ -10,6 +10,7 @@ WITH SERDEPROPERTIES ("hbase.columns.mapping" = ":key,cf:cq-boolean,cf:cq-byte,c
 TBLPROPERTIES ("hbase.table.name" = "HiveExternalTable")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t_ext_hbase_1
 POSTHOOK: query: CREATE EXTERNAL TABLE t_ext_hbase_1
 (key STRING, c_bool BOOLEAN, c_byte TINYINT, c_short SMALLINT,
  c_int INT, c_long BIGINT, c_string STRING, c_float FLOAT, c_double DOUBLE)
@@ -50,6 +51,7 @@ WITH SERDEPROPERTIES ("hbase.columns.mapping" = ":key#b,cf:cq-boolean#b,cf:cq-by
 TBLPROPERTIES ("hbase.table.name" = "HiveExternalTable")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t_ext_hbase_2
 POSTHOOK: query: CREATE EXTERNAL TABLE t_ext_hbase_2
 (key STRING, c_bool BOOLEAN, c_byte TINYINT, c_short SMALLINT,
  c_int INT, c_long BIGINT, c_string STRING, c_float FLOAT, c_double DOUBLE)
@@ -92,6 +94,7 @@ TBLPROPERTIES (
 "hbase.table.default.storage.type" = "binary")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t_ext_hbase_3
 POSTHOOK: query: CREATE EXTERNAL TABLE t_ext_hbase_3
 (key STRING, c_bool BOOLEAN, c_byte TINYINT, c_short SMALLINT,
  c_int INT, c_long BIGINT, c_string STRING, c_float FLOAT, c_double DOUBLE)
diff --git a/hbase-handler/src/test/results/positive/hbase_binary_map_queries.q.out b/hbase-handler/src/test/results/positive/hbase_binary_map_queries.q.out
index 5981b8de64..feaca4bf38 100644
--- a/hbase-handler/src/test/results/positive/hbase_binary_map_queries.q.out
+++ b/hbase-handler/src/test/results/positive/hbase_binary_map_queries.q.out
@@ -12,6 +12,7 @@ PREHOOK: query: CREATE TABLE hbase_src(key STRING,
                        string_col STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@hbase_src
 POSTHOOK: query: CREATE TABLE hbase_src(key STRING,
                        tinyint_col TINYINT,
                        smallint_col SMALLINT,
@@ -63,6 +64,7 @@ WITH SERDEPROPERTIES ("hbase.columns.mapping"=":key,cf-tinyint:,cf-smallint:,cf-
 TBLPROPERTIES ("hbase.table.name"="t_hive_maps")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t_hbase_maps
 POSTHOOK: query: CREATE TABLE t_hbase_maps(key STRING,
                           tinyint_map_col MAP<TINYINT, TINYINT>,
                           smallint_map_col MAP<SMALLINT, SMALLINT>,
@@ -166,6 +168,7 @@ WITH SERDEPROPERTIES ("hbase.columns.mapping"=":key,cf-tinyint:,cf-smallint:,cf-
 TBLPROPERTIES ("hbase.table.name"="t_hive_maps")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t_ext_hbase_maps
 POSTHOOK: query: CREATE EXTERNAL TABLE t_ext_hbase_maps(key STRING,
                                        tinyint_map_col MAP<TINYINT, TINYINT>,
                                        smallint_map_col MAP<SMALLINT, SMALLINT>,
@@ -217,6 +220,7 @@ WITH SERDEPROPERTIES ("hbase.columns.mapping"=":key#b,cf-tinyint:#bi:bi,cf-small
 TBLPROPERTIES ("hbase.table.name"="t_hive_maps")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t_ext_hbase_maps_1
 POSTHOOK: query: CREATE EXTERNAL TABLE t_ext_hbase_maps_1(key STRING,
                                          tinyint_map_col MAP<TINYINT, TINYINT>,
                                          smallint_map_col MAP<SMALLINT, SMALLINT>,
@@ -270,6 +274,7 @@ TBLPROPERTIES (
 "hbase.table.default.storage.type"="binary")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t_ext_hbase_maps_2
 POSTHOOK: query: CREATE EXTERNAL TABLE t_ext_hbase_maps_2(key STRING,
                                          tinyint_map_col MAP<TINYINT, TINYINT>,
                                          smallint_map_col MAP<SMALLINT, SMALLINT>,
@@ -323,6 +328,7 @@ WITH SERDEPROPERTIES ("hbase.columns.mapping"=":key#b,cf-tinyint:#b:b,cf-smallin
 TBLPROPERTIES ("hbase.table.name"="t_hive_maps_1")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t_hbase_maps_1
 POSTHOOK: query: CREATE TABLE t_hbase_maps_1(key STRING,
                             tinyint_map_col MAP<TINYINT, TINYINT>,
                             smallint_map_col MAP<SMALLINT, SMALLINT>,
@@ -426,6 +432,7 @@ WITH SERDEPROPERTIES ("hbase.columns.mapping"=":key#b,cf-tinyint:#bi:bi,cf-small
 TBLPROPERTIES ("hbase.table.name"="t_hive_maps_1")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t_ext_hbase_maps_3
 POSTHOOK: query: CREATE EXTERNAL TABLE t_ext_hbase_maps_3(key STRING,
                                          tinyint_map_col MAP<TINYINT, TINYINT>,
                                          smallint_map_col MAP<SMALLINT, SMALLINT>,
@@ -477,6 +484,7 @@ WITH SERDEPROPERTIES ("hbase.columns.mapping"=":key,cf-tinyint:,cf-smallint:,cf-
 TBLPROPERTIES ("hbase.table.name"="t_hive_maps_1")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t_ext_hbase_maps_4
 POSTHOOK: query: CREATE EXTERNAL TABLE t_ext_hbase_maps_4(key STRING,
                                          tinyint_map_col MAP<TINYINT, TINYINT>,
                                          smallint_map_col MAP<SMALLINT, SMALLINT>,
@@ -530,6 +538,7 @@ TBLPROPERTIES (
 "hbase.table.default.storage.type"="binary")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t_ext_hbase_maps_5
 POSTHOOK: query: CREATE EXTERNAL TABLE t_ext_hbase_maps_5(key STRING,
                                          tinyint_map_col MAP<TINYINT, TINYINT>,
                                          smallint_map_col MAP<SMALLINT, SMALLINT>,
diff --git a/hbase-handler/src/test/results/positive/hbase_binary_map_queries_prefix.q.out b/hbase-handler/src/test/results/positive/hbase_binary_map_queries_prefix.q.out
index bd59719e92..5d21134368 100644
--- a/hbase-handler/src/test/results/positive/hbase_binary_map_queries_prefix.q.out
+++ b/hbase-handler/src/test/results/positive/hbase_binary_map_queries_prefix.q.out
@@ -12,6 +12,7 @@ PREHOOK: query: CREATE TABLE hbase_src(key STRING,
                        string_col STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@hbase_src
 POSTHOOK: query: CREATE TABLE hbase_src(key STRING,
                        tinyint_col TINYINT,
                        smallint_col SMALLINT,
@@ -57,6 +58,7 @@ WITH SERDEPROPERTIES ("hbase.columns.mapping"=":key,cf-string:,cf-string:simple_
 TBLPROPERTIES ("hbase.table.name"="t_hive_maps")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t_hbase_maps
 POSTHOOK: query: CREATE TABLE t_hbase_maps(key STRING,
                           string_map_col MAP<STRING, STRING>,
                           simple_string_col STRING)
@@ -123,6 +125,7 @@ WITH SERDEPROPERTIES ("hbase.columns.mapping"=":key,cf-string:string_col.*,cf-st
 TBLPROPERTIES ("hbase.table.name"="t_hive_maps")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t_ext_hbase_maps
 POSTHOOK: query: CREATE EXTERNAL TABLE t_ext_hbase_maps(key STRING,
                                        string_map_cols MAP<STRING, STRING>, simple_string_col STRING)
 STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'
diff --git a/hbase-handler/src/test/results/positive/hbase_binary_storage_queries.q.out b/hbase-handler/src/test/results/positive/hbase_binary_storage_queries.q.out
index edaa88dd6a..578ddb2ce5 100644
--- a/hbase-handler/src/test/results/positive/hbase_binary_storage_queries.q.out
+++ b/hbase-handler/src/test/results/positive/hbase_binary_storage_queries.q.out
@@ -16,6 +16,7 @@ TBLPROPERTIES ("hbase.table.name" = "t_hive",
                "hbase.table.default.storage.type" = "binary")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t_hbase
 POSTHOOK: query: CREATE TABLE t_hbase(key STRING,
                      tinyint_col TINYINT,
                      smallint_col SMALLINT,
@@ -192,6 +193,7 @@ WITH SERDEPROPERTIES ("hbase.columns.mapping" = ":key#b,cf:binarybyte#b,cf:binar
 TBLPROPERTIES ("hbase.table.name" = "t_hive")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t_hbase_1
 POSTHOOK: query: CREATE EXTERNAL TABLE t_hbase_1(key STRING,
                                 tinyint_col TINYINT,
                                 smallint_col SMALLINT,
@@ -341,6 +343,7 @@ WITH SERDEPROPERTIES ("hbase.columns.mapping" = ":key#-,cf:binarybyte#-,cf:binar
 TBLPROPERTIES ("hbase.table.name" = "t_hive_2")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t_hbase_2
 POSTHOOK: query: CREATE TABLE t_hbase_2(key STRING,
                      tinyint_col TINYINT,
                      smallint_col SMALLINT,
@@ -475,6 +478,7 @@ WITH SERDEPROPERTIES ("hbase.columns.mapping" = ":key#b,cf:binarybyte#b,cf:binar
 TBLPROPERTIES ("hbase.table.name" = "t_hive_2")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t_hbase_3
 POSTHOOK: query: CREATE EXTERNAL TABLE t_hbase_3(key STRING,
                                 tinyint_col TINYINT,
                                 smallint_col SMALLINT,
@@ -577,6 +581,7 @@ TBLPROPERTIES (
 "hbase.table.default.storage.type" = "binary")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t_hbase_4
 POSTHOOK: query: CREATE EXTERNAL TABLE t_hbase_4(key STRING,
                      tinyint_col TINYINT,
                      smallint_col SMALLINT,
diff --git a/hbase-handler/src/test/results/positive/hbase_bulk.m.out b/hbase-handler/src/test/results/positive/hbase_bulk.m.out
index d6ba9fe8f2..0dc5802a7f 100644
--- a/hbase-handler/src/test/results/positive/hbase_bulk.m.out
+++ b/hbase-handler/src/test/results/positive/hbase_bulk.m.out
@@ -15,6 +15,7 @@ OUTPUTFORMAT 'org.apache.hadoop.hive.hbase.HiveHFileOutputFormat'
 #### A masked pattern was here ####
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@hbsort
 POSTHOOK: query: -- this is a dummy table used for controlling how the HFiles are
 -- created
 create table hbsort(key string, val string, val2 string)
@@ -39,6 +40,7 @@ outputformat
 PREHOOK: type: CREATETABLE
 #### A masked pattern was here ####
 PREHOOK: Output: database:default
+PREHOOK: Output: default@hbpartition
 POSTHOOK: query: -- this is a dummy table used for controlling how the input file
 -- for TotalOrderPartitioner is created
 create table hbpartition(part_break string)
diff --git a/hbase-handler/src/test/results/positive/hbase_custom_key.q.out b/hbase-handler/src/test/results/positive/hbase_custom_key.q.out
index 4586f2b985..b47fed225e 100644
--- a/hbase-handler/src/test/results/positive/hbase_custom_key.q.out
+++ b/hbase-handler/src/test/results/positive/hbase_custom_key.q.out
@@ -6,6 +6,7 @@ WITH SERDEPROPERTIES (
     "hbase.composite.key.factory"="org.apache.hadoop.hive.hbase.TestHBaseKeyFactory")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@hbase_ck_1
 POSTHOOK: query: CREATE TABLE hbase_ck_1(key struct<col1:string,col2:string,col3:string>, value string)
 STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'
 WITH SERDEPROPERTIES (
@@ -22,6 +23,7 @@ WITH SERDEPROPERTIES (
     "hbase.columns.mapping" = ":key,cf:string")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@hbase_ck_2
 POSTHOOK: query: CREATE EXTERNAL TABLE hbase_ck_2(key string, value string)
 STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'
 WITH SERDEPROPERTIES (
diff --git a/hbase-handler/src/test/results/positive/hbase_custom_key2.q.out b/hbase-handler/src/test/results/positive/hbase_custom_key2.q.out
index a200e3dafb..53d58abdd4 100644
--- a/hbase-handler/src/test/results/positive/hbase_custom_key2.q.out
+++ b/hbase-handler/src/test/results/positive/hbase_custom_key2.q.out
@@ -6,6 +6,7 @@ WITH SERDEPROPERTIES (
     "hbase.composite.key.factory"="org.apache.hadoop.hive.hbase.TestHBaseKeyFactory2")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@hbase_ck_4
 POSTHOOK: query: CREATE TABLE hbase_ck_4(key struct<col1:string,col2:string,col3:string>, value string)
 STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'
 WITH SERDEPROPERTIES (
diff --git a/hbase-handler/src/test/results/positive/hbase_custom_key3.q.out b/hbase-handler/src/test/results/positive/hbase_custom_key3.q.out
index 1777caf905..c8aad2b3f8 100644
--- a/hbase-handler/src/test/results/positive/hbase_custom_key3.q.out
+++ b/hbase-handler/src/test/results/positive/hbase_custom_key3.q.out
@@ -6,6 +6,7 @@ WITH SERDEPROPERTIES (
     "hbase.composite.key.factory"="org.apache.hadoop.hive.hbase.TestHBaseKeyFactory3")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@hbase_ck_5
 POSTHOOK: query: CREATE TABLE hbase_ck_5(key struct<col1:string,col2:string,col3:string>, value string)
 STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'
 WITH SERDEPROPERTIES (
diff --git a/hbase-handler/src/test/results/positive/hbase_handler_bulk.q.out b/hbase-handler/src/test/results/positive/hbase_handler_bulk.q.out
index 9c248455ed..b08a5c5f19 100644
--- a/hbase-handler/src/test/results/positive/hbase_handler_bulk.q.out
+++ b/hbase-handler/src/test/results/positive/hbase_handler_bulk.q.out
@@ -13,6 +13,7 @@ with serdeproperties ('hbase.columns.mapping' = ':key,cf:val')
 tblproperties ('hbase.table.name' = 'positive_hbase_handler_bulk')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@hb_target
 POSTHOOK: query: -- this is the target HBase table
 create table hb_target(key int, val string)
 stored by 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'
diff --git a/hbase-handler/src/test/results/positive/hbase_joins.q.out b/hbase-handler/src/test/results/positive/hbase_joins.q.out
index 5e1352a838..1c21f732ea 100644
--- a/hbase-handler/src/test/results/positive/hbase_joins.q.out
+++ b/hbase-handler/src/test/results/positive/hbase_joins.q.out
@@ -23,6 +23,7 @@ WITH SERDEPROPERTIES (
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@users
 POSTHOOK: query: -- From HIVE-1257
 
 CREATE TABLE users(key string, state string, country string, country_id int)
@@ -40,6 +41,7 @@ WITH SERDEPROPERTIES (
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@states
 POSTHOOK: query: CREATE TABLE states(key string, name string)
 STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'
 WITH SERDEPROPERTIES (
@@ -55,6 +57,7 @@ WITH SERDEPROPERTIES (
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@countries
 POSTHOOK: query: CREATE TABLE countries(key string, name string, country string, country_id int)
 STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'
 WITH SERDEPROPERTIES (
@@ -224,6 +227,7 @@ STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'
 WITH SERDEPROPERTIES ("hbase.columns.mapping" = ":key,f:userid,f:nickname,f:created")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@users
 POSTHOOK: query: CREATE TABLE users(key int, userid int, username string, created int) 
 STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'
 WITH SERDEPROPERTIES ("hbase.columns.mapping" = ":key,f:userid,f:nickname,f:created")
@@ -235,6 +239,7 @@ STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'
 WITH SERDEPROPERTIES ("hbase.columns.mapping" = ":key,f:userid,f:level")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@users_level
 POSTHOOK: query: CREATE TABLE users_level(key int, userid int, level int)
 STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'
 WITH SERDEPROPERTIES ("hbase.columns.mapping" = ":key,f:userid,f:level")
diff --git a/hbase-handler/src/test/results/positive/hbase_ppd_key_range.q.out b/hbase-handler/src/test/results/positive/hbase_ppd_key_range.q.out
index 399a1f3141..4e4364ee65 100644
--- a/hbase-handler/src/test/results/positive/hbase_ppd_key_range.q.out
+++ b/hbase-handler/src/test/results/positive/hbase_ppd_key_range.q.out
@@ -3,6 +3,7 @@ STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'
 WITH SERDEPROPERTIES ("hbase.columns.mapping" = ":key,cf:string")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@hbase_pushdown
 POSTHOOK: query: CREATE TABLE hbase_pushdown(key string, value string) 
 STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'
 WITH SERDEPROPERTIES ("hbase.columns.mapping" = ":key,cf:string")
diff --git a/hbase-handler/src/test/results/positive/hbase_pushdown.q.out b/hbase-handler/src/test/results/positive/hbase_pushdown.q.out
index 93a7ae41a0..520285adae 100644
--- a/hbase-handler/src/test/results/positive/hbase_pushdown.q.out
+++ b/hbase-handler/src/test/results/positive/hbase_pushdown.q.out
@@ -3,6 +3,7 @@ STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'
 WITH SERDEPROPERTIES ("hbase.columns.mapping" = ":key,cf:string")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@hbase_pushdown
 POSTHOOK: query: CREATE TABLE hbase_pushdown(key int, value string) 
 STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'
 WITH SERDEPROPERTIES ("hbase.columns.mapping" = ":key,cf:string")
diff --git a/hbase-handler/src/test/results/positive/hbase_queries.q.out b/hbase-handler/src/test/results/positive/hbase_queries.q.out
index ab06ab7ce8..df324d524a 100644
--- a/hbase-handler/src/test/results/positive/hbase_queries.q.out
+++ b/hbase-handler/src/test/results/positive/hbase_queries.q.out
@@ -8,6 +8,7 @@ WITH SERDEPROPERTIES ("hbase.columns.mapping" = "cf:string")
 TBLPROPERTIES ("hbase.table.name" = "hbase_table_0")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@hbase_table_1
 POSTHOOK: query: CREATE TABLE hbase_table_1(key int, value string) 
 STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'
 WITH SERDEPROPERTIES ("hbase.columns.mapping" = "cf:string")
@@ -81,6 +82,7 @@ WITH SERDEPROPERTIES ("hbase.columns.mapping" = "cf:string")
 TBLPROPERTIES ("hbase.table.name" = "hbase_table_0")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@hbase_table_2
 POSTHOOK: query: CREATE EXTERNAL TABLE hbase_table_2(key int, value string) 
 STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'
 WITH SERDEPROPERTIES ("hbase.columns.mapping" = "cf:string")
@@ -378,6 +380,7 @@ STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'
 WITH SERDEPROPERTIES ("hbase.columns.mapping" = "cf:string")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@empty_hbase_table
 POSTHOOK: query: CREATE TABLE empty_hbase_table(key int, value string) 
 STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'
 WITH SERDEPROPERTIES ("hbase.columns.mapping" = "cf:string")
@@ -391,6 +394,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: CREATE TABLE empty_normal_table(key int, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@empty_normal_table
 POSTHOOK: query: CREATE TABLE empty_normal_table(key int, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -450,6 +454,7 @@ WITH SERDEPROPERTIES (
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@hbase_table_3
 POSTHOOK: query: CREATE TABLE hbase_table_3(key int, value string, count int) 
 STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'
 WITH SERDEPROPERTIES (
@@ -640,6 +645,7 @@ WITH SERDEPROPERTIES (
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@hbase_table_4
 POSTHOOK: query: CREATE TABLE hbase_table_4(key int, value1 string, value2 int, value3 int) 
 STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'
 WITH SERDEPROPERTIES (
@@ -678,6 +684,7 @@ WITH SERDEPROPERTIES ("hbase.columns.mapping" = "a:")
 TBLPROPERTIES ("hbase.table.name" = "hbase_table_4")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@hbase_table_5
 POSTHOOK: query: CREATE EXTERNAL TABLE hbase_table_5(key int, value map<string,string>) 
 STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'
 WITH SERDEPROPERTIES ("hbase.columns.mapping" = "a:")
@@ -706,6 +713,7 @@ WITH SERDEPROPERTIES (
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@hbase_table_6
 POSTHOOK: query: CREATE TABLE hbase_table_6(key int, value map<string,string>) 
 STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'
 WITH SERDEPROPERTIES (
@@ -745,6 +753,7 @@ WITH SERDEPROPERTIES (
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@hbase_table_7
 POSTHOOK: query: CREATE TABLE hbase_table_7(value map<string,string>, key int) 
 STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'
 WITH SERDEPROPERTIES (
@@ -786,6 +795,7 @@ WITH SERDEPROPERTIES (
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@hbase_table_8
 POSTHOOK: query: CREATE TABLE hbase_table_8(key int, value1 string, value2 int, value3 int) 
 STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'
 WITH SERDEPROPERTIES (
diff --git a/hbase-handler/src/test/results/positive/hbase_scan_params.q.out b/hbase-handler/src/test/results/positive/hbase_scan_params.q.out
index 3f0669cd64..1ccaba0038 100644
--- a/hbase-handler/src/test/results/positive/hbase_scan_params.q.out
+++ b/hbase-handler/src/test/results/positive/hbase_scan_params.q.out
@@ -4,6 +4,7 @@ WITH SERDEPROPERTIES ("hbase.columns.mapping" = ":key,cf:string",
 "hbase.scan.cache" = "500", "hbase.scan.cacheblocks" = "true", "hbase.scan.batch" = "1")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@hbase_pushdown
 POSTHOOK: query: CREATE TABLE hbase_pushdown(key int, value string)
 STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'
 WITH SERDEPROPERTIES ("hbase.columns.mapping" = ":key,cf:string",
diff --git a/hbase-handler/src/test/results/positive/hbase_single_sourced_multi_insert.q.out b/hbase-handler/src/test/results/positive/hbase_single_sourced_multi_insert.q.out
index 744f5fceef..a9052fee9d 100644
--- a/hbase-handler/src/test/results/positive/hbase_single_sourced_multi_insert.q.out
+++ b/hbase-handler/src/test/results/positive/hbase_single_sourced_multi_insert.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- HIVE-4375 Single sourced multi insert consists of native and
 CREATE TABLE src_x1(key string, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_x1
 POSTHOOK: query: -- HIVE-4375 Single sourced multi insert consists of native and non-native table mixed throws NPE
 CREATE TABLE src_x1(key string, value string)
 POSTHOOK: type: CREATETABLE
@@ -12,6 +13,7 @@ STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'
 WITH SERDEPROPERTIES ("hbase.columns.mapping" = ":key, cf:value")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_x2
 POSTHOOK: query: CREATE TABLE src_x2(key string, value string)
 STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'
 WITH SERDEPROPERTIES ("hbase.columns.mapping" = ":key, cf:value")
diff --git a/hbase-handler/src/test/results/positive/hbase_stats.q.out b/hbase-handler/src/test/results/positive/hbase_stats.q.out
index 80e1c6de2c..f12b1367aa 100644
--- a/hbase-handler/src/test/results/positive/hbase_stats.q.out
+++ b/hbase-handler/src/test/results/positive/hbase_stats.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table stats_src like src
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@stats_src
 POSTHOOK: query: create table stats_src like src
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -62,6 +63,7 @@ Storage Desc Params:
 PREHOOK: query: create table stats_part like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@stats_part
 POSTHOOK: query: create table stats_part like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/hbase-handler/src/test/results/positive/hbase_stats2.q.out b/hbase-handler/src/test/results/positive/hbase_stats2.q.out
index 5dcbc5ae7f..a60dee2473 100644
--- a/hbase-handler/src/test/results/positive/hbase_stats2.q.out
+++ b/hbase-handler/src/test/results/positive/hbase_stats2.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table stats_src like src
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@stats_src
 POSTHOOK: query: create table stats_src like src
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -62,6 +63,7 @@ Storage Desc Params:
 PREHOOK: query: create table stats_part like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@stats_part
 POSTHOOK: query: create table stats_part like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/hbase-handler/src/test/results/positive/hbase_stats3.q.out b/hbase-handler/src/test/results/positive/hbase_stats3.q.out
index deed6be67f..114847ce6d 100644
--- a/hbase-handler/src/test/results/positive/hbase_stats3.q.out
+++ b/hbase-handler/src/test/results/positive/hbase_stats3.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table stats_part like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@stats_part
 POSTHOOK: query: create table stats_part like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/hbase-handler/src/test/results/positive/hbase_stats_empty_partition.q.out b/hbase-handler/src/test/results/positive/hbase_stats_empty_partition.q.out
index f201772c51..65e0a6fbaa 100644
--- a/hbase-handler/src/test/results/positive/hbase_stats_empty_partition.q.out
+++ b/hbase-handler/src/test/results/positive/hbase_stats_empty_partition.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: -- This test verifies that writing an empty partition succeeds w
 create table tmptable(key string, value string) partitioned by (part string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmptable
 POSTHOOK: query: -- This test verifies that writing an empty partition succeeds when
 -- hive.stats.reliable is set to true.
 
diff --git a/hbase-handler/src/test/results/positive/ppd_key_ranges.q.out b/hbase-handler/src/test/results/positive/ppd_key_ranges.q.out
index 7e77cb37b8..5936735394 100644
--- a/hbase-handler/src/test/results/positive/ppd_key_ranges.q.out
+++ b/hbase-handler/src/test/results/positive/ppd_key_ranges.q.out
@@ -3,6 +3,7 @@ STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'
 WITH SERDEPROPERTIES ("hbase.columns.mapping" = ":key#binary,cf:string")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@hbase_ppd_keyrange
 POSTHOOK: query: CREATE TABLE hbase_ppd_keyrange(key int, value string) 
 STORED BY 'org.apache.hadoop.hive.hbase.HBaseStorageHandler'
 WITH SERDEPROPERTIES ("hbase.columns.mapping" = ":key#binary,cf:string")
diff --git a/hcatalog/core/src/test/java/org/apache/hive/hcatalog/cli/TestSemanticAnalysis.java b/hcatalog/core/src/test/java/org/apache/hive/hcatalog/cli/TestSemanticAnalysis.java
index a465562d95..1e25ed368e 100644
--- a/hcatalog/core/src/test/java/org/apache/hive/hcatalog/cli/TestSemanticAnalysis.java
+++ b/hcatalog/core/src/test/java/org/apache/hive/hcatalog/cli/TestSemanticAnalysis.java
@@ -37,6 +37,7 @@
 import org.apache.hadoop.hive.metastore.api.Table;
 import org.apache.hadoop.hive.ql.CommandNeedRetryException;
 import org.apache.hadoop.hive.ql.Driver;
+import org.apache.hadoop.hive.ql.ErrorMsg;
 import org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat;
 import org.apache.hadoop.hive.ql.io.RCFileInputFormat;
 import org.apache.hadoop.hive.ql.io.RCFileOutputFormat;
@@ -120,7 +121,7 @@ public void testAlterTblFFpart() throws MetaException, TException, NoSuchObjectE
   @Test
   public void testUsNonExistentDB() throws CommandNeedRetryException {
     CommandProcessorResponse resp = hcatDriver.run("use no_such_db");
-    assertEquals(1, resp.getResponseCode());
+    assertEquals(ErrorMsg.DATABASE_NOT_EXISTS.getErrorCode(), resp.getResponseCode());
   }
 
   @Test
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/DDLSemanticAnalyzer.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/DDLSemanticAnalyzer.java
index 11896104a1..f31a40909e 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/DDLSemanticAnalyzer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/DDLSemanticAnalyzer.java
@@ -805,6 +805,8 @@ private void analyzeCreateDatabase(ASTNode ast) throws SemanticException {
     if (dbProps != null) {
       createDatabaseDesc.setDatabaseProperties(dbProps);
     }
+    Database database = new Database(dbName, dbComment, dbLocation, dbProps);
+    outputs.add(new WriteEntity(database, WriteEntity.WriteType.DDL_NO_LOCK));
 
     rootTasks.add(TaskFactory.get(new DDLWork(getInputs(), getOutputs(),
         createDatabaseDesc), conf));
@@ -855,8 +857,12 @@ private void analyzeDropDatabase(ASTNode ast) throws SemanticException {
     rootTasks.add(TaskFactory.get(new DDLWork(getInputs(), getOutputs(), dropDatabaseDesc), conf));
   }
 
-  private void analyzeSwitchDatabase(ASTNode ast) {
+  private void analyzeSwitchDatabase(ASTNode ast) throws SemanticException {
     String dbName = unescapeIdentifier(ast.getChild(0).getText());
+    Database database = getDatabase(dbName, true);
+    ReadEntity dbReadEntity = new ReadEntity(database);
+    dbReadEntity.noLockNeeded();
+    inputs.add(dbReadEntity);
     SwitchDatabaseDesc switchDatabaseDesc = new SwitchDatabaseDesc(dbName);
     rootTasks.add(TaskFactory.get(new DDLWork(getInputs(), getOutputs(),
         switchDatabaseDesc), conf));
@@ -1075,7 +1081,7 @@ private boolean isFullSpec(Table table, Map<String, String> partSpec) {
   private void analyzeCreateIndex(ASTNode ast) throws SemanticException {
     String indexName = unescapeIdentifier(ast.getChild(0).getText());
     String typeName = unescapeSQLString(ast.getChild(1).getText());
-    String[] qualified = getQualifiedTableName((ASTNode) ast.getChild(2));
+    String[] qTabName = getQualifiedTableName((ASTNode) ast.getChild(2));
     List<String> indexedCols = getColumnNames((ASTNode) ast.getChild(3));
 
     IndexType indexType = HiveIndex.getIndexType(typeName);
@@ -1140,15 +1146,15 @@ private void analyzeCreateIndex(ASTNode ast) throws SemanticException {
     }
 
     storageFormat.fillDefaultStorageFormat();
-
     if (indexTableName == null) {
-      indexTableName = MetaStoreUtils.getIndexTableName(qualified[0], qualified[1], indexName);
-      indexTableName = qualified[0] + "." + indexTableName; // on same database with base table
+      indexTableName = MetaStoreUtils.getIndexTableName(qTabName[0], qTabName[1], indexName);
+      indexTableName = qTabName[0] + "." + indexTableName; // on same database with base table
     } else {
       indexTableName = getDotName(Utilities.getDbTableName(indexTableName));
     }
+    inputs.add(new ReadEntity(getTable(qTabName)));
 
-    CreateIndexDesc crtIndexDesc = new CreateIndexDesc(getDotName(qualified), indexName,
+    CreateIndexDesc crtIndexDesc = new CreateIndexDesc(getDotName(qTabName), indexName,
         indexedCols, indexTableName, deferredRebuild, storageFormat.getInputFormat(),
         storageFormat.getOutputFormat(),
         storageFormat.getStorageHandler(), typeName, location, idxProps, tblProps,
@@ -1176,6 +1182,8 @@ private void analyzeDropIndex(ASTNode ast) throws SemanticException {
       }
     }
 
+    inputs.add(new ReadEntity(getTable(tableName)));
+
     DropIndexDesc dropIdxDesc = new DropIndexDesc(indexName, tableName);
     rootTasks.add(TaskFactory.get(new DDLWork(getInputs(), getOutputs(),
         dropIdxDesc), conf));
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
index 3fcd54b97e..7a71ec7435 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
@@ -10163,6 +10163,7 @@ private ASTNode analyzeCreateTable(ASTNode ast, QB qb)
     String dbName = qualified.length == 1 ? SessionState.get().getCurrentDatabase() : qualified[0];
     Database database  = getDatabase(dbName);
     outputs.add(new WriteEntity(database, WriteEntity.WriteType.DDL_SHARED));
+    outputs.add(new WriteEntity(new Table(dbName, tableName), WriteEntity.WriteType.DDL_NO_LOCK));
 
     if (isTemporary) {
       if (partCols.size() > 0) {
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/plan/HiveOperation.java b/ql/src/java/org/apache/hadoop/hive/ql/plan/HiveOperation.java
index 14ce6aaa4c..67be666360 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/plan/HiveOperation.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/plan/HiveOperation.java
@@ -27,7 +27,7 @@ public enum HiveOperation {
   IMPORT("IMPORT", null, new Privilege[]{Privilege.ALTER_METADATA, Privilege.ALTER_DATA}),
   CREATEDATABASE("CREATEDATABASE", null, new Privilege[]{Privilege.CREATE}),
   DROPDATABASE("DROPDATABASE", null, new Privilege[]{Privilege.DROP}),
-  SWITCHDATABASE("SWITCHDATABASE", new Privilege[]{Privilege.SELECT}, null),
+  SWITCHDATABASE("SWITCHDATABASE", null, null),
   LOCKDB("LOCKDATABASE",  new Privilege[]{Privilege.LOCK}, null),
   UNLOCKDB("UNLOCKDATABASE",  new Privilege[]{Privilege.LOCK}, null),
   DROPTABLE ("DROPTABLE", null, new Privilege[]{Privilege.DROP}),
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/security/authorization/plugin/sqlstd/Operation2Privilege.java b/ql/src/java/org/apache/hadoop/hive/ql/security/authorization/plugin/sqlstd/Operation2Privilege.java
index 85f8526cf7..45404fe130 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/security/authorization/plugin/sqlstd/Operation2Privilege.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/security/authorization/plugin/sqlstd/Operation2Privilege.java
@@ -27,6 +27,7 @@
 import org.apache.hadoop.hive.ql.security.authorization.plugin.HiveOperationType;
 import org.apache.hadoop.hive.ql.security.authorization.plugin.HivePrivilegeObject;
 import org.apache.hadoop.hive.ql.security.authorization.plugin.HivePrivilegeObject.HivePrivObjectActionType;
+import org.apache.hadoop.hive.ql.security.authorization.plugin.HivePrivilegeObject.HivePrivilegeObjectType;
 
 /**
  * Mapping of operation to its required input and output privileges
@@ -43,6 +44,7 @@ private static class PrivRequirement {
     // The following fields specify the criteria on objects for this priv to be required
     private final IOType ioType;
     private final HivePrivObjectActionType actionType;
+    private final HivePrivilegeObjectType objectType;
 
 
     private PrivRequirement(SQLPrivTypeGrant[] privs, IOType ioType) {
@@ -51,11 +53,22 @@ private PrivRequirement(SQLPrivTypeGrant[] privs, IOType ioType) {
 
     private PrivRequirement(SQLPrivTypeGrant[] privs, IOType ioType,
         HivePrivObjectActionType actionType) {
+      this(privs, ioType, actionType, null);
+    }
+
+    private PrivRequirement(SQLPrivTypeGrant[] privs, HivePrivilegeObjectType objectType) {
+      this(privs, null, null, objectType);
+    }
+
+    private PrivRequirement(SQLPrivTypeGrant[] privs, IOType ioType,
+        HivePrivObjectActionType actionType, HivePrivilegeObjectType objectType) {
       this.reqPrivs = privs;
       this.ioType = ioType;
       this.actionType = actionType;
+      this.objectType = objectType;
     }
 
+
     /**
      * Utility function that takes a input and output privilege objects
      * @param inGrant
@@ -70,6 +83,15 @@ static List<PrivRequirement> newIOPrivRequirement(SQLPrivTypeGrant[] inGrants,
       return privReqs;
     }
 
+    /**
+     * Utility function that converts PrivRequirement array into list
+     * @param privs
+     * @return
+     */
+    static List<PrivRequirement> newPrivRequirementList(PrivRequirement... privs) {
+      return new ArrayList<PrivRequirement>(Arrays.asList(privs));
+    }
+
     private SQLPrivTypeGrant[] getReqPrivs() {
       return reqPrivs;
     }
@@ -82,6 +104,10 @@ private HivePrivObjectActionType getActionType() {
       return actionType;
     }
 
+    public HivePrivilegeObjectType getObjectType() {
+      return objectType;
+    }
+
   }
 
   private static Map<HiveOperationType, List<PrivRequirement>> op2Priv;
@@ -107,9 +133,9 @@ private HivePrivObjectActionType getActionType() {
 (SEL_NOGRANT_AR,
         SEL_NOGRANT_AR)); //??
 
-    op2Priv.put(HiveOperationType.CREATEDATABASE,
-        PrivRequirement.newIOPrivRequirement
-(ADMIN_PRIV_AR, OWNER_INS_SEL_DEL_NOGRANT_AR));
+    op2Priv.put(HiveOperationType.CREATEDATABASE, PrivRequirement.newPrivRequirementList(
+        new PrivRequirement(OWNER_INS_SEL_DEL_NOGRANT_AR, HivePrivilegeObjectType.DFS_URI),
+        new PrivRequirement(OWNER_INS_SEL_DEL_NOGRANT_AR, HivePrivilegeObjectType.LOCAL_URI)));
 
     op2Priv.put(HiveOperationType.DROPDATABASE, PrivRequirement.newIOPrivRequirement
 (null, OWNER_PRIV_AR));
@@ -304,9 +330,9 @@ private HivePrivObjectActionType getActionType() {
 (null, null));
 
     // require db ownership, if there is a file require SELECT , INSERT, and DELETE
-    op2Priv.put(HiveOperationType.CREATETABLE,
-        PrivRequirement.newIOPrivRequirement
-(OWNER_INS_SEL_DEL_NOGRANT_AR, OWNER_PRIV_AR));
+    op2Priv.put(HiveOperationType.CREATETABLE, PrivRequirement.newPrivRequirementList(
+        new PrivRequirement(OWNER_INS_SEL_DEL_NOGRANT_AR, IOType.INPUT),
+        new PrivRequirement(OWNER_PRIV_AR, HivePrivilegeObjectType.DATABASE)));
 
     op2Priv.put(HiveOperationType.ALTERDATABASE, PrivRequirement.newIOPrivRequirement
 (null, ADMIN_PRIV_AR));
@@ -392,20 +418,17 @@ public static RequiredPrivileges getRequiredPrivs(HiveOperationType hiveOpType,
     List<PrivRequirement> opPrivs = op2Priv.get(hiveOpType);
     RequiredPrivileges reqPrivs = new RequiredPrivileges();
 
-    // Find the PrivRequirements that match on IOType and ActionType, and add
-    // the privilege
-    // required to reqPrivs
+    // Find the PrivRequirements that match on IOType, ActionType, and HivePrivilegeObjectType add
+    // the privilege required to reqPrivs
     for (PrivRequirement opPriv : opPrivs) {
-      if (opPriv.getIOType() != ioType) {
+      if (opPriv.getIOType() != null && opPriv.getIOType() != ioType) {
+        continue;
+      }
+      if (opPriv.getActionType() != null && opPriv.getActionType() != hObj.getActionType()) {
         continue;
       }
-      if (opPriv.getActionType() != null) {
-        // if action in PrivRequirement is null, it means that
-        // the privileges are required irrespective of hObj's action type
-        // If it is not null, action type has to match
-        if (hObj.getActionType() != opPriv.getActionType()) {
-          continue;
-        }
+      if (opPriv.getObjectType() != null && opPriv.getObjectType() != hObj.getType()) {
+        continue;
       }
       reqPrivs.addAll(opPriv.getReqPrivs());
     }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/security/authorization/plugin/sqlstd/SQLStdHiveAuthorizationValidator.java b/ql/src/java/org/apache/hadoop/hive/ql/security/authorization/plugin/sqlstd/SQLStdHiveAuthorizationValidator.java
index 83a0b45352..9ceac0cad7 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/security/authorization/plugin/sqlstd/SQLStdHiveAuthorizationValidator.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/security/authorization/plugin/sqlstd/SQLStdHiveAuthorizationValidator.java
@@ -94,6 +94,11 @@ private void checkPrivileges(HiveOperationType hiveOpType, List<HivePrivilegeObj
       RequiredPrivileges requiredPrivs = Operation2Privilege.getRequiredPrivs(hiveOpType, hiveObj,
           ioType);
 
+      if(requiredPrivs.getRequiredPrivilegeSet().isEmpty()){
+        // no privileges required, so don't need to check this object privileges
+        continue;
+      }
+
       // find available privileges
       RequiredPrivileges availPrivs = new RequiredPrivileges(); //start with an empty priv set;
       switch (hiveObj.getType()) {
diff --git a/ql/src/test/queries/clientnegative/authorization_create_index.q b/ql/src/test/queries/clientnegative/authorization_create_index.q
new file mode 100644
index 0000000000..3c19afe6e1
--- /dev/null
+++ b/ql/src/test/queries/clientnegative/authorization_create_index.q
@@ -0,0 +1,6 @@
+set hive.security.authorization.manager=org.apache.hadoop.hive.ql.security.authorization.plugin.sqlstd.SQLStdHiveAuthorizerFactoryForTest;
+set hive.security.authenticator.manager=org.apache.hadoop.hive.ql.security.SessionStateConfigUserAuthenticator;
+set hive.security.authorization.enabled=true;
+create table t1 (a int);
+set user.name=user2;
+create index t1_index on table t1(a) as 'COMPACT' WITH DEFERRED REBUILD;
diff --git a/ql/src/test/queries/clientnegative/authorization_drop_index.q b/ql/src/test/queries/clientnegative/authorization_drop_index.q
new file mode 100644
index 0000000000..1df9f98f47
--- /dev/null
+++ b/ql/src/test/queries/clientnegative/authorization_drop_index.q
@@ -0,0 +1,7 @@
+set hive.security.authorization.manager=org.apache.hadoop.hive.ql.security.authorization.plugin.sqlstd.SQLStdHiveAuthorizerFactoryForTest;
+set hive.security.authenticator.manager=org.apache.hadoop.hive.ql.security.SessionStateConfigUserAuthenticator;
+set hive.security.authorization.enabled=true;
+create table t1 (a int);
+create index t1_index on table t1(a) as 'COMPACT' WITH DEFERRED REBUILD;
+set user.name=user2;
+drop index t1_index on t1;
diff --git a/ql/src/test/queries/clientpositive/virtual_column.q b/ql/src/test/queries/clientpositive/virtual_column.q
index 30fde395eb..e74a608909 100644
--- a/ql/src/test/queries/clientpositive/virtual_column.q
+++ b/ql/src/test/queries/clientpositive/virtual_column.q
@@ -14,6 +14,3 @@ CREATE TABLE src_index_test_rc (key int, value string) STORED AS RCFILE;
 set hive.io.rcfile.record.buffer.size = 1024;
 INSERT OVERWRITE TABLE src_index_test_rc SELECT * FROM src;
 select INPUT__FILE__NAME, key, BLOCK__OFFSET__INSIDE__FILE from src_index_test_rc order by key;
-
-DROP TABLE src_index_test_rc;
-DROP INDEX src_index on src_index_test_rc;
diff --git a/ql/src/test/results/clientnegative/add_partition_with_whitelist.q.out b/ql/src/test/results/clientnegative/add_partition_with_whitelist.q.out
index 2971c41b33..4905036073 100644
--- a/ql/src/test/results/clientnegative/add_partition_with_whitelist.q.out
+++ b/ql/src/test/results/clientnegative/add_partition_with_whitelist.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- This pattern matches all printable ASCII characters (disallow
 CREATE TABLE part_whitelist_test (key STRING, value STRING) PARTITIONED BY (ds STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part_whitelist_test
 POSTHOOK: query: -- This pattern matches all printable ASCII characters (disallow unicode) and disallows commas
 
 CREATE TABLE part_whitelist_test (key STRING, value STRING) PARTITIONED BY (ds STRING)
diff --git a/ql/src/test/results/clientnegative/addpart1.q.out b/ql/src/test/results/clientnegative/addpart1.q.out
index 95f00ef0de..e1255bc0f9 100644
--- a/ql/src/test/results/clientnegative/addpart1.q.out
+++ b/ql/src/test/results/clientnegative/addpart1.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table addpart1 (a int) partitioned by (b string, c string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@addpart1
 POSTHOOK: query: create table addpart1 (a int) partitioned by (b string, c string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/alter_concatenate_indexed_table.q.out b/ql/src/test/results/clientnegative/alter_concatenate_indexed_table.q.out
index ef85e063f1..19fbf51a76 100644
--- a/ql/src/test/results/clientnegative/alter_concatenate_indexed_table.q.out
+++ b/ql/src/test/results/clientnegative/alter_concatenate_indexed_table.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table src_rc_concatenate_test(key int, value string) stored as rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_rc_concatenate_test
 POSTHOOK: query: create table src_rc_concatenate_test(key int, value string) stored as rcfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -66,8 +67,10 @@ POSTHOOK: Input: default@src_rc_concatenate_test
 214	-7678496319
 PREHOOK: query: create index src_rc_concatenate_test_index on table src_rc_concatenate_test(key) as 'compact' WITH DEFERRED REBUILD IDXPROPERTIES ("prop1"="val1", "prop2"="val2")
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@src_rc_concatenate_test
 POSTHOOK: query: create index src_rc_concatenate_test_index on table src_rc_concatenate_test(key) as 'compact' WITH DEFERRED REBUILD IDXPROPERTIES ("prop1"="val1", "prop2"="val2")
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@src_rc_concatenate_test
 POSTHOOK: Output: default@default__src_rc_concatenate_test_src_rc_concatenate_test_index__
 PREHOOK: query: show indexes on src_rc_concatenate_test
 PREHOOK: type: SHOWINDEXES
diff --git a/ql/src/test/results/clientnegative/alter_file_format.q.out b/ql/src/test/results/clientnegative/alter_file_format.q.out
index fd5de50cc2..d0c470b1f0 100644
--- a/ql/src/test/results/clientnegative/alter_file_format.q.out
+++ b/ql/src/test/results/clientnegative/alter_file_format.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table alter_file_format_test (key int, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@alter_file_format_test
 POSTHOOK: query: create table alter_file_format_test (key int, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/alter_non_native.q.out b/ql/src/test/results/clientnegative/alter_non_native.q.out
index f377d56df9..64c4cee9c4 100644
--- a/ql/src/test/results/clientnegative/alter_non_native.q.out
+++ b/ql/src/test/results/clientnegative/alter_non_native.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: CREATE TABLE non_native1(key int, value string)
 STORED BY 'org.apache.hadoop.hive.ql.metadata.DefaultStorageHandler'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@non_native1
 POSTHOOK: query: CREATE TABLE non_native1(key int, value string) 
 STORED BY 'org.apache.hadoop.hive.ql.metadata.DefaultStorageHandler'
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientnegative/alter_partition_coltype_2columns.q.out b/ql/src/test/results/clientnegative/alter_partition_coltype_2columns.q.out
index 9a64ae9c26..e757d89b65 100644
--- a/ql/src/test/results/clientnegative/alter_partition_coltype_2columns.q.out
+++ b/ql/src/test/results/clientnegative/alter_partition_coltype_2columns.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- create testing table
 create table alter_coltype(key string, value string) partitioned by (dt string, ts string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@alter_coltype
 POSTHOOK: query: -- create testing table
 create table alter_coltype(key string, value string) partitioned by (dt string, ts string)
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientnegative/alter_partition_coltype_invalidcolname.q.out b/ql/src/test/results/clientnegative/alter_partition_coltype_invalidcolname.q.out
index 2f32b81ac8..56ff714e00 100644
--- a/ql/src/test/results/clientnegative/alter_partition_coltype_invalidcolname.q.out
+++ b/ql/src/test/results/clientnegative/alter_partition_coltype_invalidcolname.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- create testing table
 create table alter_coltype(key string, value string) partitioned by (dt string, ts string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@alter_coltype
 POSTHOOK: query: -- create testing table
 create table alter_coltype(key string, value string) partitioned by (dt string, ts string)
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientnegative/alter_partition_coltype_invalidtype.q.out b/ql/src/test/results/clientnegative/alter_partition_coltype_invalidtype.q.out
index 3fea2752c5..b8ced17918 100644
--- a/ql/src/test/results/clientnegative/alter_partition_coltype_invalidtype.q.out
+++ b/ql/src/test/results/clientnegative/alter_partition_coltype_invalidtype.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- create testing table
 create table alter_coltype(key string, value string) partitioned by (dt string, ts string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@alter_coltype
 POSTHOOK: query: -- create testing table
 create table alter_coltype(key string, value string) partitioned by (dt string, ts string)
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientnegative/alter_partition_invalidspec.q.out b/ql/src/test/results/clientnegative/alter_partition_invalidspec.q.out
index 3948debecc..404115fba5 100644
--- a/ql/src/test/results/clientnegative/alter_partition_invalidspec.q.out
+++ b/ql/src/test/results/clientnegative/alter_partition_invalidspec.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- Create table
 create table if not exists alter_part_invalidspec(key string, value string ) partitioned by (year string, month string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@alter_part_invalidspec
 POSTHOOK: query: -- Create table
 create table if not exists alter_part_invalidspec(key string, value string ) partitioned by (year string, month string) stored as textfile
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientnegative/alter_partition_nodrop.q.out b/ql/src/test/results/clientnegative/alter_partition_nodrop.q.out
index 8e34126c00..1c78cffb0c 100644
--- a/ql/src/test/results/clientnegative/alter_partition_nodrop.q.out
+++ b/ql/src/test/results/clientnegative/alter_partition_nodrop.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- Create table
 create table if not exists alter_part_nodrop_part(key string, value string ) partitioned by (year string, month string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@alter_part_nodrop_part
 POSTHOOK: query: -- Create table
 create table if not exists alter_part_nodrop_part(key string, value string ) partitioned by (year string, month string) stored as textfile
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientnegative/alter_partition_nodrop_table.q.out b/ql/src/test/results/clientnegative/alter_partition_nodrop_table.q.out
index 64705a5261..3c425da88c 100644
--- a/ql/src/test/results/clientnegative/alter_partition_nodrop_table.q.out
+++ b/ql/src/test/results/clientnegative/alter_partition_nodrop_table.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- Create table
 create table if not exists alter_part_nodrop_table(key string, value string ) partitioned by (year string, month string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@alter_part_nodrop_table
 POSTHOOK: query: -- Create table
 create table if not exists alter_part_nodrop_table(key string, value string ) partitioned by (year string, month string) stored as textfile
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientnegative/alter_partition_offline.q.out b/ql/src/test/results/clientnegative/alter_partition_offline.q.out
index 29b094d80f..fe2ebfb4db 100644
--- a/ql/src/test/results/clientnegative/alter_partition_offline.q.out
+++ b/ql/src/test/results/clientnegative/alter_partition_offline.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- create table
 create table if not exists alter_part_offline (key string, value string ) partitioned by (year string, month string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@alter_part_offline
 POSTHOOK: query: -- create table
 create table if not exists alter_part_offline (key string, value string ) partitioned by (year string, month string) stored as textfile
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientnegative/alter_partition_with_whitelist.q.out b/ql/src/test/results/clientnegative/alter_partition_with_whitelist.q.out
index abc2dd72dd..33eab1278d 100644
--- a/ql/src/test/results/clientnegative/alter_partition_with_whitelist.q.out
+++ b/ql/src/test/results/clientnegative/alter_partition_with_whitelist.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- This pattern matches all printable ASCII characters (disallow
 CREATE TABLE part_whitelist_test (key STRING, value STRING) PARTITIONED BY (ds STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part_whitelist_test
 POSTHOOK: query: -- This pattern matches all printable ASCII characters (disallow unicode) and disallows commas
 
 CREATE TABLE part_whitelist_test (key STRING, value STRING) PARTITIONED BY (ds STRING)
diff --git a/ql/src/test/results/clientnegative/alter_rename_partition_failure.q.out b/ql/src/test/results/clientnegative/alter_rename_partition_failure.q.out
index 319c06569a..f1640be1d2 100644
--- a/ql/src/test/results/clientnegative/alter_rename_partition_failure.q.out
+++ b/ql/src/test/results/clientnegative/alter_rename_partition_failure.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table alter_rename_partition_src ( col1 string ) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@alter_rename_partition_src
 POSTHOOK: query: create table alter_rename_partition_src ( col1 string ) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -16,6 +17,7 @@ POSTHOOK: Output: default@alter_rename_partition_src
 PREHOOK: query: create table alter_rename_partition ( col1 string ) partitioned by (pcol1 string , pcol2 string) stored as sequencefile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@alter_rename_partition
 POSTHOOK: query: create table alter_rename_partition ( col1 string ) partitioned by (pcol1 string , pcol2 string) stored as sequencefile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/alter_rename_partition_failure2.q.out b/ql/src/test/results/clientnegative/alter_rename_partition_failure2.q.out
index 37fddb98e3..635df4ec0d 100644
--- a/ql/src/test/results/clientnegative/alter_rename_partition_failure2.q.out
+++ b/ql/src/test/results/clientnegative/alter_rename_partition_failure2.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table alter_rename_partition_src ( col1 string ) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@alter_rename_partition_src
 POSTHOOK: query: create table alter_rename_partition_src ( col1 string ) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -16,6 +17,7 @@ POSTHOOK: Output: default@alter_rename_partition_src
 PREHOOK: query: create table alter_rename_partition ( col1 string ) partitioned by (pcol1 string , pcol2 string) stored as sequencefile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@alter_rename_partition
 POSTHOOK: query: create table alter_rename_partition ( col1 string ) partitioned by (pcol1 string , pcol2 string) stored as sequencefile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/alter_rename_partition_failure3.q.out b/ql/src/test/results/clientnegative/alter_rename_partition_failure3.q.out
index c417625a2d..c3dfc20a3c 100644
--- a/ql/src/test/results/clientnegative/alter_rename_partition_failure3.q.out
+++ b/ql/src/test/results/clientnegative/alter_rename_partition_failure3.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table alter_rename_partition_src ( col1 string ) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@alter_rename_partition_src
 POSTHOOK: query: create table alter_rename_partition_src ( col1 string ) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -16,6 +17,7 @@ POSTHOOK: Output: default@alter_rename_partition_src
 PREHOOK: query: create table alter_rename_partition ( col1 string ) partitioned by (pcol1 string , pcol2 string) stored as sequencefile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@alter_rename_partition
 POSTHOOK: query: create table alter_rename_partition ( col1 string ) partitioned by (pcol1 string , pcol2 string) stored as sequencefile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/alter_table_add_partition.q.out b/ql/src/test/results/clientnegative/alter_table_add_partition.q.out
index 2a5b9b0a11..beb47c0eaa 100644
--- a/ql/src/test/results/clientnegative/alter_table_add_partition.q.out
+++ b/ql/src/test/results/clientnegative/alter_table_add_partition.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table mp (a int) partitioned by (b int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@mp
 POSTHOOK: query: create table mp (a int) partitioned by (b int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/alter_table_wrong_regex.q.out b/ql/src/test/results/clientnegative/alter_table_wrong_regex.q.out
index 83a1e6b266..9bb6470f02 100644
--- a/ql/src/test/results/clientnegative/alter_table_wrong_regex.q.out
+++ b/ql/src/test/results/clientnegative/alter_table_wrong_regex.q.out
@@ -7,6 +7,7 @@ PREHOOK: query: create table aa ( test STRING )
   WITH SERDEPROPERTIES ("input.regex" = "(.*)", "output.format.string" = "$1s")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@aa
 POSTHOOK: query: create table aa ( test STRING )
   ROW FORMAT SERDE 'org.apache.hadoop.hive.contrib.serde2.RegexSerDe'
   WITH SERDEPROPERTIES ("input.regex" = "(.*)", "output.format.string" = "$1s")
diff --git a/ql/src/test/results/clientnegative/alter_view_failure8.q.out b/ql/src/test/results/clientnegative/alter_view_failure8.q.out
index d3c98190d9..f2a0d148f6 100644
--- a/ql/src/test/results/clientnegative/alter_view_failure8.q.out
+++ b/ql/src/test/results/clientnegative/alter_view_failure8.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- should fail:  can't use ALTER VIEW on a table
 CREATE TABLE invites (foo INT, bar STRING) PARTITIONED BY (ds STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@invites
 POSTHOOK: query: -- should fail:  can't use ALTER VIEW on a table
 CREATE TABLE invites (foo INT, bar STRING) PARTITIONED BY (ds STRING)
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientnegative/altern1.q.out b/ql/src/test/results/clientnegative/altern1.q.out
index 75e097b5de..ff3c670864 100644
--- a/ql/src/test/results/clientnegative/altern1.q.out
+++ b/ql/src/test/results/clientnegative/altern1.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table altern1(a int, b int) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@altern1
 POSTHOOK: query: create table altern1(a int, b int) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/archive1.q.out b/ql/src/test/results/clientnegative/archive1.q.out
index 98663033cf..099b6738f8 100644
--- a/ql/src/test/results/clientnegative/archive1.q.out
+++ b/ql/src/test/results/clientnegative/archive1.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: -- Tests trying to archive a partition twice.
 CREATE TABLE srcpart_archived LIKE srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcpart_archived
 POSTHOOK: query: -- Tests trying to archive a partition twice.
 -- EXCLUDE_HADOOP_MAJOR_VERSIONS(0.17, 0.18, 0.19)
 
diff --git a/ql/src/test/results/clientnegative/archive2.q.out b/ql/src/test/results/clientnegative/archive2.q.out
index 1e51d41aaf..77d5faeeed 100644
--- a/ql/src/test/results/clientnegative/archive2.q.out
+++ b/ql/src/test/results/clientnegative/archive2.q.out
@@ -11,6 +11,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table tstsrcpart like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tstsrcpart
 POSTHOOK: query: create table tstsrcpart like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/archive_corrupt.q.out b/ql/src/test/results/clientnegative/archive_corrupt.q.out
index 60c2d574fe..56e8ec42a6 100644
--- a/ql/src/test/results/clientnegative/archive_corrupt.q.out
+++ b/ql/src/test/results/clientnegative/archive_corrupt.q.out
@@ -1,7 +1,9 @@
 PREHOOK: query: USE default
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:default
 POSTHOOK: query: USE default
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:default
 PREHOOK: query: drop table tstsrcpart
 PREHOOK: type: DROPTABLE
 POSTHOOK: query: drop table tstsrcpart
@@ -9,6 +11,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table tstsrcpart like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tstsrcpart
 POSTHOOK: query: create table tstsrcpart like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/archive_insert1.q.out b/ql/src/test/results/clientnegative/archive_insert1.q.out
index 4dc3dd9217..6a073a8e04 100644
--- a/ql/src/test/results/clientnegative/archive_insert1.q.out
+++ b/ql/src/test/results/clientnegative/archive_insert1.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: -- Tests trying to insert into archived partition.
 CREATE TABLE tstsrcpart LIKE srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tstsrcpart
 POSTHOOK: query: -- Tests trying to insert into archived partition.
 -- EXCLUDE_HADOOP_MAJOR_VERSIONS(0.17, 0.18, 0.19)
 
diff --git a/ql/src/test/results/clientnegative/archive_insert2.q.out b/ql/src/test/results/clientnegative/archive_insert2.q.out
index 1a875b663f..78d9dde394 100644
--- a/ql/src/test/results/clientnegative/archive_insert2.q.out
+++ b/ql/src/test/results/clientnegative/archive_insert2.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: -- Tests trying to insert into archived partition.
 CREATE TABLE tstsrcpart LIKE srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tstsrcpart
 POSTHOOK: query: -- Tests trying to insert into archived partition.
 -- EXCLUDE_HADOOP_MAJOR_VERSIONS(0.17, 0.18, 0.19)
 
diff --git a/ql/src/test/results/clientnegative/archive_insert3.q.out b/ql/src/test/results/clientnegative/archive_insert3.q.out
index 7ea6a44368..baa1f60a6a 100644
--- a/ql/src/test/results/clientnegative/archive_insert3.q.out
+++ b/ql/src/test/results/clientnegative/archive_insert3.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: -- Tests trying to create partition inside of archived directory
 CREATE TABLE tstsrcpart LIKE srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tstsrcpart
 POSTHOOK: query: -- Tests trying to create partition inside of archived directory.
 -- EXCLUDE_HADOOP_MAJOR_VERSIONS(0.17, 0.18, 0.19)
 
diff --git a/ql/src/test/results/clientnegative/archive_insert4.q.out b/ql/src/test/results/clientnegative/archive_insert4.q.out
index a19c1ad82c..41785ffcf1 100644
--- a/ql/src/test/results/clientnegative/archive_insert4.q.out
+++ b/ql/src/test/results/clientnegative/archive_insert4.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: -- Tests trying to (possible) dynamic insert into archived parti
 CREATE TABLE tstsrcpart LIKE srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tstsrcpart
 POSTHOOK: query: -- Tests trying to (possible) dynamic insert into archived partition.
 -- EXCLUDE_HADOOP_MAJOR_VERSIONS(0.17, 0.18, 0.19)
 
diff --git a/ql/src/test/results/clientnegative/archive_multi1.q.out b/ql/src/test/results/clientnegative/archive_multi1.q.out
index 302f89f007..b065aac6d6 100644
--- a/ql/src/test/results/clientnegative/archive_multi1.q.out
+++ b/ql/src/test/results/clientnegative/archive_multi1.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: -- Tests trying to archive a partition twice.
 CREATE TABLE tstsrcpart LIKE srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tstsrcpart
 POSTHOOK: query: -- Tests trying to archive a partition twice.
 -- EXCLUDE_HADOOP_MAJOR_VERSIONS(0.17, 0.18, 0.19)
 
diff --git a/ql/src/test/results/clientnegative/archive_multi2.q.out b/ql/src/test/results/clientnegative/archive_multi2.q.out
index 8bd5bba86d..81808d26d6 100644
--- a/ql/src/test/results/clientnegative/archive_multi2.q.out
+++ b/ql/src/test/results/clientnegative/archive_multi2.q.out
@@ -11,6 +11,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table tstsrcpart like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tstsrcpart
 POSTHOOK: query: create table tstsrcpart like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/archive_multi3.q.out b/ql/src/test/results/clientnegative/archive_multi3.q.out
index 028c825e8a..f7deb7f090 100644
--- a/ql/src/test/results/clientnegative/archive_multi3.q.out
+++ b/ql/src/test/results/clientnegative/archive_multi3.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: -- Tests trying to archive outer partition group containing othe
 CREATE TABLE tstsrcpart LIKE srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tstsrcpart
 POSTHOOK: query: -- Tests trying to archive outer partition group containing other partition inside.
 -- EXCLUDE_HADOOP_MAJOR_VERSIONS(0.17, 0.18, 0.19)
 
diff --git a/ql/src/test/results/clientnegative/archive_multi4.q.out b/ql/src/test/results/clientnegative/archive_multi4.q.out
index 4dc72041be..1306448fc5 100644
--- a/ql/src/test/results/clientnegative/archive_multi4.q.out
+++ b/ql/src/test/results/clientnegative/archive_multi4.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: -- Tests trying to archive inner partition contained in archived
 CREATE TABLE tstsrcpart LIKE srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tstsrcpart
 POSTHOOK: query: -- Tests trying to archive inner partition contained in archived partition group.
 -- EXCLUDE_HADOOP_MAJOR_VERSIONS(0.17, 0.18, 0.19)
 
diff --git a/ql/src/test/results/clientnegative/archive_multi5.q.out b/ql/src/test/results/clientnegative/archive_multi5.q.out
index 85b3475994..c8fae7e232 100644
--- a/ql/src/test/results/clientnegative/archive_multi5.q.out
+++ b/ql/src/test/results/clientnegative/archive_multi5.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: -- Tests trying to unarchive outer partition group containing ot
 CREATE TABLE tstsrcpart LIKE srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tstsrcpart
 POSTHOOK: query: -- Tests trying to unarchive outer partition group containing other partition inside.
 -- EXCLUDE_HADOOP_MAJOR_VERSIONS(0.17, 0.18, 0.19)
 
diff --git a/ql/src/test/results/clientnegative/archive_multi6.q.out b/ql/src/test/results/clientnegative/archive_multi6.q.out
index 133f8a70a6..d468f6e52c 100644
--- a/ql/src/test/results/clientnegative/archive_multi6.q.out
+++ b/ql/src/test/results/clientnegative/archive_multi6.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: -- Tests trying to unarchive inner partition contained in archiv
 CREATE TABLE tstsrcpart LIKE srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tstsrcpart
 POSTHOOK: query: -- Tests trying to unarchive inner partition contained in archived partition group.
 -- EXCLUDE_HADOOP_MAJOR_VERSIONS(0.17, 0.18, 0.19)
 
diff --git a/ql/src/test/results/clientnegative/archive_multi7.q.out b/ql/src/test/results/clientnegative/archive_multi7.q.out
index d814d5fa12..05dbb9e1a0 100644
--- a/ql/src/test/results/clientnegative/archive_multi7.q.out
+++ b/ql/src/test/results/clientnegative/archive_multi7.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: -- Tests trying to archive a partition group with custom locatio
 CREATE TABLE tstsrcpart LIKE srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tstsrcpart
 POSTHOOK: query: -- Tests trying to archive a partition group with custom locations.
 -- EXCLUDE_HADOOP_MAJOR_VERSIONS(0.17, 0.18, 0.19)
 
diff --git a/ql/src/test/results/clientnegative/archive_partspec1.q.out b/ql/src/test/results/clientnegative/archive_partspec1.q.out
index 831fab950f..da4817c677 100644
--- a/ql/src/test/results/clientnegative/archive_partspec1.q.out
+++ b/ql/src/test/results/clientnegative/archive_partspec1.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: -- Tests trying to archive a partition twice.
 CREATE TABLE srcpart_archived LIKE srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcpart_archived
 POSTHOOK: query: -- Tests trying to archive a partition twice.
 -- EXCLUDE_HADOOP_MAJOR_VERSIONS(0.17, 0.18, 0.19)
 
diff --git a/ql/src/test/results/clientnegative/archive_partspec2.q.out b/ql/src/test/results/clientnegative/archive_partspec2.q.out
index 77cd7a7c3f..f58b9f8224 100644
--- a/ql/src/test/results/clientnegative/archive_partspec2.q.out
+++ b/ql/src/test/results/clientnegative/archive_partspec2.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: -- Tests trying to archive a partition twice.
 CREATE TABLE srcpart_archived LIKE srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcpart_archived
 POSTHOOK: query: -- Tests trying to archive a partition twice.
 -- EXCLUDE_HADOOP_MAJOR_VERSIONS(0.17, 0.18, 0.19)
 
diff --git a/ql/src/test/results/clientnegative/archive_partspec3.q.out b/ql/src/test/results/clientnegative/archive_partspec3.q.out
index e357a33c54..c53ffa65c9 100644
--- a/ql/src/test/results/clientnegative/archive_partspec3.q.out
+++ b/ql/src/test/results/clientnegative/archive_partspec3.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: -- Tests trying to archive a partition twice.
 CREATE TABLE srcpart_archived LIKE srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcpart_archived
 POSTHOOK: query: -- Tests trying to archive a partition twice.
 -- EXCLUDE_HADOOP_MAJOR_VERSIONS(0.17, 0.18, 0.19)
 
diff --git a/ql/src/test/results/clientnegative/archive_partspec4.q.out b/ql/src/test/results/clientnegative/archive_partspec4.q.out
index f39c267b9c..8c740ce656 100644
--- a/ql/src/test/results/clientnegative/archive_partspec4.q.out
+++ b/ql/src/test/results/clientnegative/archive_partspec4.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: -- Tests trying to archive a partition twice.
 CREATE TABLE srcpart_archived LIKE srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcpart_archived
 POSTHOOK: query: -- Tests trying to archive a partition twice.
 -- EXCLUDE_HADOOP_MAJOR_VERSIONS(0.17, 0.18, 0.19)
 
diff --git a/ql/src/test/results/clientnegative/archive_partspec5.q.out b/ql/src/test/results/clientnegative/archive_partspec5.q.out
index 1cb2928fcd..c18de52cb2 100644
--- a/ql/src/test/results/clientnegative/archive_partspec5.q.out
+++ b/ql/src/test/results/clientnegative/archive_partspec5.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: -- Tests trying to archive a partition twice.
 CREATE TABLE srcpart_archived (key string, value string) partitioned by (ds string, hr int, min int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcpart_archived
 POSTHOOK: query: -- Tests trying to archive a partition twice.
 -- EXCLUDE_HADOOP_MAJOR_VERSIONS(0.17, 0.18, 0.19)
 
diff --git a/ql/src/test/results/clientnegative/authorization_addpartition.q.out b/ql/src/test/results/clientnegative/authorization_addpartition.q.out
index 9ab2ef825a..0424b4b973 100644
--- a/ql/src/test/results/clientnegative/authorization_addpartition.q.out
+++ b/ql/src/test/results/clientnegative/authorization_addpartition.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- check add partition without insert privilege
 create table tpart(i int, j int) partitioned by (k string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tpart
 POSTHOOK: query: -- check add partition without insert privilege
 create table tpart(i int, j int) partitioned by (k string)
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientnegative/authorization_alter_db_owner.q.out b/ql/src/test/results/clientnegative/authorization_alter_db_owner.q.out
index 6f65f30a82..cb4397d1db 100644
--- a/ql/src/test/results/clientnegative/authorization_alter_db_owner.q.out
+++ b/ql/src/test/results/clientnegative/authorization_alter_db_owner.q.out
@@ -2,8 +2,10 @@
 
 create database dbao
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:dbao
 #### A masked pattern was here ####
 
 create database dbao
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:dbao
 FAILED: HiveAccessControlException Permission denied: Principal [name=user1, type=USER] does not have following privileges for operation ALTERDATABASE_OWNER [[ADMIN PRIVILEGE] on Object [type=DATABASE, name=dbao]]
diff --git a/ql/src/test/results/clientnegative/authorization_create_index.q.out b/ql/src/test/results/clientnegative/authorization_create_index.q.out
new file mode 100644
index 0000000000..0e1f41ee59
--- /dev/null
+++ b/ql/src/test/results/clientnegative/authorization_create_index.q.out
@@ -0,0 +1,9 @@
+PREHOOK: query: create table t1 (a int)
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@t1
+POSTHOOK: query: create table t1 (a int)
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@t1
+FAILED: HiveAccessControlException Permission denied: Principal [name=user2, type=USER] does not have following privileges for operation CREATEINDEX [[OBJECT OWNERSHIP] on Object [type=TABLE_OR_VIEW, name=default.t1]]
diff --git a/ql/src/test/results/clientnegative/authorization_createview.q.out b/ql/src/test/results/clientnegative/authorization_createview.q.out
index ea14743037..335e902c4e 100644
--- a/ql/src/test/results/clientnegative/authorization_createview.q.out
+++ b/ql/src/test/results/clientnegative/authorization_createview.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- check create view without select privileges
 create table t1(i int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t1
 POSTHOOK: query: -- check create view without select privileges
 create table t1(i int)
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientnegative/authorization_ctas.q.out b/ql/src/test/results/clientnegative/authorization_ctas.q.out
index ad704fa608..34840d6d82 100644
--- a/ql/src/test/results/clientnegative/authorization_ctas.q.out
+++ b/ql/src/test/results/clientnegative/authorization_ctas.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- check query without select privilege fails
 create table t1(i int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t1
 POSTHOOK: query: -- check query without select privilege fails
 create table t1(i int)
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientnegative/authorization_desc_table_nosel.q.out b/ql/src/test/results/clientnegative/authorization_desc_table_nosel.q.out
index bb402ec394..0cb604994a 100644
--- a/ql/src/test/results/clientnegative/authorization_desc_table_nosel.q.out
+++ b/ql/src/test/results/clientnegative/authorization_desc_table_nosel.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- check if alter table fails as different user
 create table t1(i int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t1
 POSTHOOK: query: -- check if alter table fails as different user
 create table t1(i int)
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientnegative/authorization_drop_db_cascade.q.out b/ql/src/test/results/clientnegative/authorization_drop_db_cascade.q.out
index 2eb7184dfe..8ffa555f1a 100644
--- a/ql/src/test/results/clientnegative/authorization_drop_db_cascade.q.out
+++ b/ql/src/test/results/clientnegative/authorization_drop_db_cascade.q.out
@@ -1,15 +1,19 @@
 PREHOOK: query: -- ensure that drop database cascade works
 create database dba1
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:dba1
 POSTHOOK: query: -- ensure that drop database cascade works
 create database dba1
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:dba1
 PREHOOK: query: create table dba1.tab1(i int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:dba1
+PREHOOK: Output: dba1@dba1.tab1
 POSTHOOK: query: create table dba1.tab1(i int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:dba1
+POSTHOOK: Output: dba1@dba1.tab1
 POSTHOOK: Output: dba1@tab1
 PREHOOK: query: drop database dba1 cascade
 PREHOOK: type: DROPDATABASE
@@ -24,15 +28,19 @@ POSTHOOK: Output: dba1@tab1
 PREHOOK: query: -- check if drop database fails if the db has a table for which user does not have permission
 create database dba2
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:dba2
 POSTHOOK: query: -- check if drop database fails if the db has a table for which user does not have permission
 create database dba2
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:dba2
 PREHOOK: query: create table dba2.tab2(i int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:dba2
+PREHOOK: Output: dba2@dba2.tab2
 POSTHOOK: query: create table dba2.tab2(i int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:dba2
+POSTHOOK: Output: dba2@dba2.tab2
 POSTHOOK: Output: dba2@tab2
 PREHOOK: query: set role ADMIN
 PREHOOK: type: SHOW_ROLES
diff --git a/ql/src/test/results/clientnegative/authorization_drop_db_empty.q.out b/ql/src/test/results/clientnegative/authorization_drop_db_empty.q.out
index 097f0deec2..fcffd70ee7 100644
--- a/ql/src/test/results/clientnegative/authorization_drop_db_empty.q.out
+++ b/ql/src/test/results/clientnegative/authorization_drop_db_empty.q.out
@@ -1,9 +1,11 @@
 #### A masked pattern was here ####
 create database dba1
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:dba1
 #### A masked pattern was here ####
 create database dba1
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:dba1
 PREHOOK: query: set role ADMIN
 PREHOOK: type: SHOW_ROLES
 POSTHOOK: query: set role ADMIN
@@ -38,8 +40,10 @@ public
 
 PREHOOK: query: create database dba2
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:dba2
 POSTHOOK: query: create database dba2
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:dba2
 PREHOOK: query: show current roles
 PREHOOK: type: SHOW_ROLES
 POSTHOOK: query: show current roles
diff --git a/ql/src/test/results/clientnegative/authorization_drop_index.q.out b/ql/src/test/results/clientnegative/authorization_drop_index.q.out
new file mode 100644
index 0000000000..72d782dcd9
--- /dev/null
+++ b/ql/src/test/results/clientnegative/authorization_drop_index.q.out
@@ -0,0 +1,16 @@
+PREHOOK: query: create table t1 (a int)
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@t1
+POSTHOOK: query: create table t1 (a int)
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@t1
+PREHOOK: query: create index t1_index on table t1(a) as 'COMPACT' WITH DEFERRED REBUILD
+PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@t1
+POSTHOOK: query: create index t1_index on table t1(a) as 'COMPACT' WITH DEFERRED REBUILD
+POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@t1
+POSTHOOK: Output: default@default__t1_t1_index__
+FAILED: HiveAccessControlException Permission denied: Principal [name=user2, type=USER] does not have following privileges for operation DROPINDEX [[OBJECT OWNERSHIP] on Object [type=TABLE_OR_VIEW, name=default.t1]]
diff --git a/ql/src/test/results/clientnegative/authorization_droppartition.q.out b/ql/src/test/results/clientnegative/authorization_droppartition.q.out
index a5b8ce24bd..9c06fa4ff1 100644
--- a/ql/src/test/results/clientnegative/authorization_droppartition.q.out
+++ b/ql/src/test/results/clientnegative/authorization_droppartition.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- check drop partition without delete privilege
 create table tpart(i int, j int) partitioned by (k string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tpart
 POSTHOOK: query: -- check drop partition without delete privilege
 create table tpart(i int, j int) partitioned by (k string)
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientnegative/authorization_fail_1.q.out b/ql/src/test/results/clientnegative/authorization_fail_1.q.out
index 3f9c4ed080..5c78f2a7b9 100644
--- a/ql/src/test/results/clientnegative/authorization_fail_1.q.out
+++ b/ql/src/test/results/clientnegative/authorization_fail_1.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table authorization_fail_1 (key int, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@authorization_fail_1
 POSTHOOK: query: create table authorization_fail_1 (key int, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/authorization_fail_2.q.out b/ql/src/test/results/clientnegative/authorization_fail_2.q.out
index b2aadb715a..242cccf4f6 100644
--- a/ql/src/test/results/clientnegative/authorization_fail_2.q.out
+++ b/ql/src/test/results/clientnegative/authorization_fail_2.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table authorization_fail_2 (key int, value string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@authorization_fail_2
 POSTHOOK: query: create table authorization_fail_2 (key int, value string) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/authorization_fail_3.q.out b/ql/src/test/results/clientnegative/authorization_fail_3.q.out
index 8cc246d5d0..32f61887e1 100644
--- a/ql/src/test/results/clientnegative/authorization_fail_3.q.out
+++ b/ql/src/test/results/clientnegative/authorization_fail_3.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_BEFORE_DIFF
 create table authorization_fail_3 (key int, value string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@authorization_fail_3
 POSTHOOK: query: -- SORT_BEFORE_DIFF
 
 create table authorization_fail_3 (key int, value string) partitioned by (ds string)
diff --git a/ql/src/test/results/clientnegative/authorization_fail_4.q.out b/ql/src/test/results/clientnegative/authorization_fail_4.q.out
index 1eddbf709f..88bf24a60f 100644
--- a/ql/src/test/results/clientnegative/authorization_fail_4.q.out
+++ b/ql/src/test/results/clientnegative/authorization_fail_4.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_BEFORE_DIFF
 create table authorization_fail_4 (key int, value string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@authorization_fail_4
 POSTHOOK: query: -- SORT_BEFORE_DIFF
 
 create table authorization_fail_4 (key int, value string) partitioned by (ds string)
diff --git a/ql/src/test/results/clientnegative/authorization_fail_5.q.out b/ql/src/test/results/clientnegative/authorization_fail_5.q.out
index 365d5ce273..443a27f97f 100644
--- a/ql/src/test/results/clientnegative/authorization_fail_5.q.out
+++ b/ql/src/test/results/clientnegative/authorization_fail_5.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_BEFORE_DIFF
 create table authorization_fail (key int, value string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@authorization_fail
 POSTHOOK: query: -- SORT_BEFORE_DIFF
 
 create table authorization_fail (key int, value string) partitioned by (ds string)
diff --git a/ql/src/test/results/clientnegative/authorization_fail_6.q.out b/ql/src/test/results/clientnegative/authorization_fail_6.q.out
index 9c7d80e27b..2f9f052c37 100644
--- a/ql/src/test/results/clientnegative/authorization_fail_6.q.out
+++ b/ql/src/test/results/clientnegative/authorization_fail_6.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_BEFORE_DIFF
 create table authorization_part_fail (key int, value string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@authorization_part_fail
 POSTHOOK: query: -- SORT_BEFORE_DIFF
 
 create table authorization_part_fail (key int, value string) partitioned by (ds string)
diff --git a/ql/src/test/results/clientnegative/authorization_fail_7.q.out b/ql/src/test/results/clientnegative/authorization_fail_7.q.out
index 77ead3800c..f282703102 100644
--- a/ql/src/test/results/clientnegative/authorization_fail_7.q.out
+++ b/ql/src/test/results/clientnegative/authorization_fail_7.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_BEFORE_DIFF
 create table authorization_fail (key int, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@authorization_fail
 POSTHOOK: query: -- SORT_BEFORE_DIFF
 
 create table authorization_fail (key int, value string)
diff --git a/ql/src/test/results/clientnegative/authorization_fail_8.q.out b/ql/src/test/results/clientnegative/authorization_fail_8.q.out
index 6c9fcf4c6e..a4292d148c 100644
--- a/ql/src/test/results/clientnegative/authorization_fail_8.q.out
+++ b/ql/src/test/results/clientnegative/authorization_fail_8.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table authorization_fail (key int, value string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@authorization_fail
 POSTHOOK: query: create table authorization_fail (key int, value string) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/authorization_fail_drop_db.q.out b/ql/src/test/results/clientnegative/authorization_fail_drop_db.q.out
index da6e47b2c2..8a7041373e 100644
--- a/ql/src/test/results/clientnegative/authorization_fail_drop_db.q.out
+++ b/ql/src/test/results/clientnegative/authorization_fail_drop_db.q.out
@@ -1,5 +1,7 @@
 PREHOOK: query: create database db_fail_to_drop
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:db_fail_to_drop
 POSTHOOK: query: create database db_fail_to_drop
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:db_fail_to_drop
 Authorization failed:No privilege 'Drop' found for outputs { database:db_fail_to_drop}. Use SHOW GRANT to get more details.
diff --git a/ql/src/test/results/clientnegative/authorization_grant_table_allpriv.q.out b/ql/src/test/results/clientnegative/authorization_grant_table_allpriv.q.out
index 8098d5dd82..40fa685848 100644
--- a/ql/src/test/results/clientnegative/authorization_grant_table_allpriv.q.out
+++ b/ql/src/test/results/clientnegative/authorization_grant_table_allpriv.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- current user has been set (comment line before the set cmd is
 CREATE TABLE table_priv_allf(i int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table_priv_allf
 POSTHOOK: query: -- current user has been set (comment line before the set cmd is resulting in parse error!!)
 
 CREATE TABLE table_priv_allf(i int)
diff --git a/ql/src/test/results/clientnegative/authorization_grant_table_dup.q.out b/ql/src/test/results/clientnegative/authorization_grant_table_dup.q.out
index 52defe6e3c..1a70539234 100644
--- a/ql/src/test/results/clientnegative/authorization_grant_table_dup.q.out
+++ b/ql/src/test/results/clientnegative/authorization_grant_table_dup.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- current user has been set (comment line before the set cmd is
 CREATE TABLE  tauth_gdup(i int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tauth_gdup
 POSTHOOK: query: -- current user has been set (comment line before the set cmd is resulting in parse error!!)
 
 CREATE TABLE  tauth_gdup(i int)
diff --git a/ql/src/test/results/clientnegative/authorization_grant_table_fail1.q.out b/ql/src/test/results/clientnegative/authorization_grant_table_fail1.q.out
index cec3619908..ed9af222be 100644
--- a/ql/src/test/results/clientnegative/authorization_grant_table_fail1.q.out
+++ b/ql/src/test/results/clientnegative/authorization_grant_table_fail1.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- current user has been set (comment line before the set cmd is
 CREATE TABLE  table_priv_gfail1(i int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table_priv_gfail1
 POSTHOOK: query: -- current user has been set (comment line before the set cmd is resulting in parse error!!)
 
 CREATE TABLE  table_priv_gfail1(i int)
diff --git a/ql/src/test/results/clientnegative/authorization_grant_table_fail_nogrant.q.out b/ql/src/test/results/clientnegative/authorization_grant_table_fail_nogrant.q.out
index 67f048fe86..0b70bcc2dc 100644
--- a/ql/src/test/results/clientnegative/authorization_grant_table_fail_nogrant.q.out
+++ b/ql/src/test/results/clientnegative/authorization_grant_table_fail_nogrant.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- current user has been set (comment line before the set cmd is
 CREATE TABLE table_priv_gfail1(i int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table_priv_gfail1
 POSTHOOK: query: -- current user has been set (comment line before the set cmd is resulting in parse error!!)
 
 CREATE TABLE table_priv_gfail1(i int)
diff --git a/ql/src/test/results/clientnegative/authorization_insert_noinspriv.q.out b/ql/src/test/results/clientnegative/authorization_insert_noinspriv.q.out
index 63ef757a0e..174c96c0b8 100644
--- a/ql/src/test/results/clientnegative/authorization_insert_noinspriv.q.out
+++ b/ql/src/test/results/clientnegative/authorization_insert_noinspriv.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- check insert without select priv
 create table t1(i int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t1
 POSTHOOK: query: -- check insert without select priv
 create table t1(i int)
 POSTHOOK: type: CREATETABLE
@@ -10,6 +11,7 @@ POSTHOOK: Output: default@t1
 PREHOOK: query: create table user2tab(i int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@user2tab
 POSTHOOK: query: create table user2tab(i int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/authorization_insert_noselectpriv.q.out b/ql/src/test/results/clientnegative/authorization_insert_noselectpriv.q.out
index c9ed7542b7..0bc491a73b 100644
--- a/ql/src/test/results/clientnegative/authorization_insert_noselectpriv.q.out
+++ b/ql/src/test/results/clientnegative/authorization_insert_noselectpriv.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- check insert without select priv
 create table t1(i int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t1
 POSTHOOK: query: -- check insert without select priv
 create table t1(i int)
 POSTHOOK: type: CREATETABLE
@@ -10,6 +11,7 @@ POSTHOOK: Output: default@t1
 PREHOOK: query: create table t2(i int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t2
 POSTHOOK: query: create table t2(i int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/authorization_insertoverwrite_nodel.q.out b/ql/src/test/results/clientnegative/authorization_insertoverwrite_nodel.q.out
index 10a5df0aa4..926066b8aa 100644
--- a/ql/src/test/results/clientnegative/authorization_insertoverwrite_nodel.q.out
+++ b/ql/src/test/results/clientnegative/authorization_insertoverwrite_nodel.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- check insert overwrite without delete priv
 create table t1(i int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t1
 POSTHOOK: query: -- check insert overwrite without delete priv
 create table t1(i int)
 POSTHOOK: type: CREATETABLE
@@ -29,6 +30,7 @@ default	t1			user1	USER	INSERT	false	-1	hive_test_user
 PREHOOK: query: create table user1tab(i int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@user1tab
 POSTHOOK: query: create table user1tab(i int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/authorization_invalid_priv_v1.q.out b/ql/src/test/results/clientnegative/authorization_invalid_priv_v1.q.out
index d1ccf03e11..f18b51624e 100644
--- a/ql/src/test/results/clientnegative/authorization_invalid_priv_v1.q.out
+++ b/ql/src/test/results/clientnegative/authorization_invalid_priv_v1.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table if not exists authorization_invalid_v1 (key int, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@authorization_invalid_v1
 POSTHOOK: query: create table if not exists authorization_invalid_v1 (key int, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/authorization_invalid_priv_v2.q.out b/ql/src/test/results/clientnegative/authorization_invalid_priv_v2.q.out
index 1fb2abc2da..9accae066e 100644
--- a/ql/src/test/results/clientnegative/authorization_invalid_priv_v2.q.out
+++ b/ql/src/test/results/clientnegative/authorization_invalid_priv_v2.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table if not exists authorization_invalid_v2 (key int, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@authorization_invalid_v2
 POSTHOOK: query: create table if not exists authorization_invalid_v2 (key int, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/authorization_not_owner_alter_tab_rename.q.out b/ql/src/test/results/clientnegative/authorization_not_owner_alter_tab_rename.q.out
index c3bd34f5f0..7d680f918b 100644
--- a/ql/src/test/results/clientnegative/authorization_not_owner_alter_tab_rename.q.out
+++ b/ql/src/test/results/clientnegative/authorization_not_owner_alter_tab_rename.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- check if alter table fails as different user
 create table t1(i int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t1
 POSTHOOK: query: -- check if alter table fails as different user
 create table t1(i int)
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientnegative/authorization_not_owner_alter_tab_serdeprop.q.out b/ql/src/test/results/clientnegative/authorization_not_owner_alter_tab_serdeprop.q.out
index 3b3df095e9..37e55dc097 100644
--- a/ql/src/test/results/clientnegative/authorization_not_owner_alter_tab_serdeprop.q.out
+++ b/ql/src/test/results/clientnegative/authorization_not_owner_alter_tab_serdeprop.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- check if alter table fails as different user
 create table t1(i int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t1
 POSTHOOK: query: -- check if alter table fails as different user
 create table t1(i int)
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientnegative/authorization_not_owner_drop_tab.q.out b/ql/src/test/results/clientnegative/authorization_not_owner_drop_tab.q.out
index 14b4521a75..1e359a326d 100644
--- a/ql/src/test/results/clientnegative/authorization_not_owner_drop_tab.q.out
+++ b/ql/src/test/results/clientnegative/authorization_not_owner_drop_tab.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- check if create table fails as different user
 create table t1(i int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t1
 POSTHOOK: query: -- check if create table fails as different user
 create table t1(i int)
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientnegative/authorization_not_owner_drop_view.q.out b/ql/src/test/results/clientnegative/authorization_not_owner_drop_view.q.out
index 73c214bc49..305d6d8d8e 100644
--- a/ql/src/test/results/clientnegative/authorization_not_owner_drop_view.q.out
+++ b/ql/src/test/results/clientnegative/authorization_not_owner_drop_view.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- check if create table fails as different user
 create table t1(i int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t1
 POSTHOOK: query: -- check if create table fails as different user
 create table t1(i int)
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientnegative/authorization_part.q.out b/ql/src/test/results/clientnegative/authorization_part.q.out
index fa80590466..26e645b07b 100644
--- a/ql/src/test/results/clientnegative/authorization_part.q.out
+++ b/ql/src/test/results/clientnegative/authorization_part.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_BEFORE_DIFF
 create table authorization_part_fail (key int, value string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@authorization_part_fail
 POSTHOOK: query: -- SORT_BEFORE_DIFF
 
 create table authorization_part_fail (key int, value string) partitioned by (ds string)
diff --git a/ql/src/test/results/clientnegative/authorization_priv_current_role_neg.q.out b/ql/src/test/results/clientnegative/authorization_priv_current_role_neg.q.out
index b20ebc848f..7a9d382e06 100644
--- a/ql/src/test/results/clientnegative/authorization_priv_current_role_neg.q.out
+++ b/ql/src/test/results/clientnegative/authorization_priv_current_role_neg.q.out
@@ -19,6 +19,7 @@ POSTHOOK: type: GRANT_ROLE
 PREHOOK: query: create table tpriv_current_role(i int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tpriv_current_role
 POSTHOOK: query: create table tpriv_current_role(i int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/authorization_revoke_table_fail1.q.out b/ql/src/test/results/clientnegative/authorization_revoke_table_fail1.q.out
index eb3abec583..7e7e25b47f 100644
--- a/ql/src/test/results/clientnegative/authorization_revoke_table_fail1.q.out
+++ b/ql/src/test/results/clientnegative/authorization_revoke_table_fail1.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- current user has been set (comment line before the set cmd is
 CREATE TABLE table_priv_rfail1(i int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table_priv_rfail1
 POSTHOOK: query: -- current user has been set (comment line before the set cmd is resulting in parse error!!)
 
 CREATE TABLE table_priv_rfail1(i int)
diff --git a/ql/src/test/results/clientnegative/authorization_revoke_table_fail2.q.out b/ql/src/test/results/clientnegative/authorization_revoke_table_fail2.q.out
index e304632216..0bb252f5db 100644
--- a/ql/src/test/results/clientnegative/authorization_revoke_table_fail2.q.out
+++ b/ql/src/test/results/clientnegative/authorization_revoke_table_fail2.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- current user has been set (comment line before the set cmd is
 CREATE TABLE table_priv_rfai2(i int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table_priv_rfai2
 POSTHOOK: query: -- current user has been set (comment line before the set cmd is resulting in parse error!!)
 
 CREATE TABLE table_priv_rfai2(i int)
diff --git a/ql/src/test/results/clientnegative/authorization_rolehierarchy_privs.q.out b/ql/src/test/results/clientnegative/authorization_rolehierarchy_privs.q.out
index 46e3ca74e4..12ce96ecdf 100644
--- a/ql/src/test/results/clientnegative/authorization_rolehierarchy_privs.q.out
+++ b/ql/src/test/results/clientnegative/authorization_rolehierarchy_privs.q.out
@@ -45,6 +45,7 @@ POSTHOOK: type: GRANT_ROLE
 PREHOOK: query: create table t1(i int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t1
 POSTHOOK: query: create table t1(i int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/authorization_select.q.out b/ql/src/test/results/clientnegative/authorization_select.q.out
index c718e8c357..69cf766758 100644
--- a/ql/src/test/results/clientnegative/authorization_select.q.out
+++ b/ql/src/test/results/clientnegative/authorization_select.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- check query without select privilege fails
 create table t1(i int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t1
 POSTHOOK: query: -- check query without select privilege fails
 create table t1(i int)
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientnegative/authorization_select_view.q.out b/ql/src/test/results/clientnegative/authorization_select_view.q.out
index 877f77f258..ba1fc89636 100644
--- a/ql/src/test/results/clientnegative/authorization_select_view.q.out
+++ b/ql/src/test/results/clientnegative/authorization_select_view.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- check create view without select privileges
 create table t1(i int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t1
 POSTHOOK: query: -- check create view without select privileges
 create table t1(i int)
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientnegative/authorization_show_grant_otheruser_wtab.q.out b/ql/src/test/results/clientnegative/authorization_show_grant_otheruser_wtab.q.out
index 4189d0e09b..47d5c7ab68 100644
--- a/ql/src/test/results/clientnegative/authorization_show_grant_otheruser_wtab.q.out
+++ b/ql/src/test/results/clientnegative/authorization_show_grant_otheruser_wtab.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table t1(i int, j int, k int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t1
 POSTHOOK: query: create table t1(i int, j int, k int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/authorization_show_parts_nosel.q.out b/ql/src/test/results/clientnegative/authorization_show_parts_nosel.q.out
index 2f7b723335..25d0c2ed14 100644
--- a/ql/src/test/results/clientnegative/authorization_show_parts_nosel.q.out
+++ b/ql/src/test/results/clientnegative/authorization_show_parts_nosel.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- check if alter table fails as different user
 create table t_show_parts(i int) partitioned by (j string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t_show_parts
 POSTHOOK: query: -- check if alter table fails as different user
 create table t_show_parts(i int) partitioned by (j string)
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientnegative/authorization_table_grant_nosuchrole.q.out b/ql/src/test/results/clientnegative/authorization_table_grant_nosuchrole.q.out
index a01a2296a4..464c4333f2 100644
--- a/ql/src/test/results/clientnegative/authorization_table_grant_nosuchrole.q.out
+++ b/ql/src/test/results/clientnegative/authorization_table_grant_nosuchrole.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: ----------------------------------------
 create table t1(i int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t1
 POSTHOOK: query: ----------------------------------------
 -- granting object privilege to a role that does not exist should fail
 ----------------------------------------
diff --git a/ql/src/test/results/clientnegative/authorization_truncate.q.out b/ql/src/test/results/clientnegative/authorization_truncate.q.out
index a414b33563..1c675fe83b 100644
--- a/ql/src/test/results/clientnegative/authorization_truncate.q.out
+++ b/ql/src/test/results/clientnegative/authorization_truncate.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- check add partition without insert privilege
 create table t1(i int, j int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t1
 POSTHOOK: query: -- check add partition without insert privilege
 create table t1(i int, j int)
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientnegative/authorization_uri_add_partition.q.out b/ql/src/test/results/clientnegative/authorization_uri_add_partition.q.out
index 15b5bce947..7d00214a1a 100644
--- a/ql/src/test/results/clientnegative/authorization_uri_add_partition.q.out
+++ b/ql/src/test/results/clientnegative/authorization_uri_add_partition.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table tpart(i int, j int) partitioned by (k string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tpart
 POSTHOOK: query: create table tpart(i int, j int) partitioned by (k string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/authorization_uri_alterpart_loc.q.out b/ql/src/test/results/clientnegative/authorization_uri_alterpart_loc.q.out
index 39a4e4fac2..d655b90977 100644
--- a/ql/src/test/results/clientnegative/authorization_uri_alterpart_loc.q.out
+++ b/ql/src/test/results/clientnegative/authorization_uri_alterpart_loc.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table tpart(i int, j int) partitioned by (k string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tpart
 POSTHOOK: query: create table tpart(i int, j int) partitioned by (k string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/authorization_uri_altertab_setloc.q.out b/ql/src/test/results/clientnegative/authorization_uri_altertab_setloc.q.out
index c0adf59743..97b81b16b3 100644
--- a/ql/src/test/results/clientnegative/authorization_uri_altertab_setloc.q.out
+++ b/ql/src/test/results/clientnegative/authorization_uri_altertab_setloc.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table t1(i int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t1
 POSTHOOK: query: create table t1(i int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/authorization_uri_index.q.out b/ql/src/test/results/clientnegative/authorization_uri_index.q.out
index c0adf59743..97b81b16b3 100644
--- a/ql/src/test/results/clientnegative/authorization_uri_index.q.out
+++ b/ql/src/test/results/clientnegative/authorization_uri_index.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table t1(i int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t1
 POSTHOOK: query: create table t1(i int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/authorization_uri_insert.q.out b/ql/src/test/results/clientnegative/authorization_uri_insert.q.out
index 86319a3132..d282ea58cb 100644
--- a/ql/src/test/results/clientnegative/authorization_uri_insert.q.out
+++ b/ql/src/test/results/clientnegative/authorization_uri_insert.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table t1(i int, j int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t1
 POSTHOOK: query: create table t1(i int, j int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/authorization_uri_insert_local.q.out b/ql/src/test/results/clientnegative/authorization_uri_insert_local.q.out
index 86319a3132..d282ea58cb 100644
--- a/ql/src/test/results/clientnegative/authorization_uri_insert_local.q.out
+++ b/ql/src/test/results/clientnegative/authorization_uri_insert_local.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table t1(i int, j int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t1
 POSTHOOK: query: create table t1(i int, j int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/authorization_uri_load_data.q.out b/ql/src/test/results/clientnegative/authorization_uri_load_data.q.out
index c0adf59743..97b81b16b3 100644
--- a/ql/src/test/results/clientnegative/authorization_uri_load_data.q.out
+++ b/ql/src/test/results/clientnegative/authorization_uri_load_data.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table t1(i int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t1
 POSTHOOK: query: create table t1(i int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/authorize_create_tbl.q.out b/ql/src/test/results/clientnegative/authorize_create_tbl.q.out
index 2322e427cd..5db06f1246 100644
--- a/ql/src/test/results/clientnegative/authorize_create_tbl.q.out
+++ b/ql/src/test/results/clientnegative/authorize_create_tbl.q.out
@@ -1,9 +1,13 @@
 PREHOOK: query: create database db23221
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:db23221
 POSTHOOK: query: create database db23221
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:db23221
 PREHOOK: query: use db23221
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:db23221
 POSTHOOK: query: use db23221
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:db23221
 FAILED: HiveAccessControlException Permission denied: Principal [name=user44, type=USER] does not have following privileges for operation CREATETABLE [[OBJECT OWNERSHIP] on Object [type=DATABASE, name=db23221]]
diff --git a/ql/src/test/results/clientnegative/bad_sample_clause.q.out b/ql/src/test/results/clientnegative/bad_sample_clause.q.out
index ce137eb475..9fc779792f 100644
--- a/ql/src/test/results/clientnegative/bad_sample_clause.q.out
+++ b/ql/src/test/results/clientnegative/bad_sample_clause.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key INT, value STRING, dt STRING, hr STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key INT, value STRING, dt STRING, hr STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/bucket_mapjoin_mismatch1.q.out b/ql/src/test/results/clientnegative/bucket_mapjoin_mismatch1.q.out
index 0f5171501f..a73db84b87 100644
--- a/ql/src/test/results/clientnegative/bucket_mapjoin_mismatch1.q.out
+++ b/ql/src/test/results/clientnegative/bucket_mapjoin_mismatch1.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: CREATE TABLE srcbucket_mapjoin_part (key int, value string)
   STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcbucket_mapjoin_part
 POSTHOOK: query: CREATE TABLE srcbucket_mapjoin_part (key int, value string) 
   partitioned by (ds string) CLUSTERED BY (key) INTO 3 BUCKETS
   STORED AS TEXTFILE
@@ -45,6 +46,7 @@ PREHOOK: query: CREATE TABLE srcbucket_mapjoin_part_2 (key int, value string)
   STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcbucket_mapjoin_part_2
 POSTHOOK: query: CREATE TABLE srcbucket_mapjoin_part_2 (key int, value string)
   partitioned by (ds string) CLUSTERED BY (key) INTO 2 BUCKETS
   STORED AS TEXTFILE
diff --git a/ql/src/test/results/clientnegative/bucket_mapjoin_wrong_table_metadata_1.q.out b/ql/src/test/results/clientnegative/bucket_mapjoin_wrong_table_metadata_1.q.out
index a0d1bed1ae..f4522d23be 100644
--- a/ql/src/test/results/clientnegative/bucket_mapjoin_wrong_table_metadata_1.q.out
+++ b/ql/src/test/results/clientnegative/bucket_mapjoin_wrong_table_metadata_1.q.out
@@ -14,6 +14,7 @@ PREHOOK: query: create table table1(key string, value string) clustered by (key,
 into 2 BUCKETS stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table1
 POSTHOOK: query: create table table1(key string, value string) clustered by (key, value)
 into 2 BUCKETS stored as textfile
 POSTHOOK: type: CREATETABLE
@@ -23,6 +24,7 @@ PREHOOK: query: create table table2(key string, value string) clustered by (valu
 into 2 BUCKETS stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table2
 POSTHOOK: query: create table table2(key string, value string) clustered by (value, key)
 into 2 BUCKETS stored as textfile
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientnegative/bucket_mapjoin_wrong_table_metadata_2.q.out b/ql/src/test/results/clientnegative/bucket_mapjoin_wrong_table_metadata_2.q.out
index 2b87c65b0b..9aa9b5d675 100644
--- a/ql/src/test/results/clientnegative/bucket_mapjoin_wrong_table_metadata_2.q.out
+++ b/ql/src/test/results/clientnegative/bucket_mapjoin_wrong_table_metadata_2.q.out
@@ -14,6 +14,7 @@ PREHOOK: query: create table table1(key string, value string) partitioned by (ds
 into 2 BUCKETS stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table1
 POSTHOOK: query: create table table1(key string, value string) partitioned by (ds string) clustered by (key, value)
 into 2 BUCKETS stored as textfile
 POSTHOOK: type: CREATETABLE
@@ -23,6 +24,7 @@ PREHOOK: query: create table table2(key string, value string) clustered by (valu
 into 2 BUCKETS stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table2
 POSTHOOK: query: create table table2(key string, value string) clustered by (value, key)
 into 2 BUCKETS stored as textfile
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientnegative/char_pad_convert_fail0.q.out b/ql/src/test/results/clientnegative/char_pad_convert_fail0.q.out
index 22a59296d1..d6f5502343 100644
--- a/ql/src/test/results/clientnegative/char_pad_convert_fail0.q.out
+++ b/ql/src/test/results/clientnegative/char_pad_convert_fail0.q.out
@@ -14,6 +14,7 @@ PREHOOK: query: create table over1k(
        fields terminated by '|'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@over1k
 POSTHOOK: query: create table over1k(
            t tinyint,
            si smallint,
diff --git a/ql/src/test/results/clientnegative/char_pad_convert_fail1.q.out b/ql/src/test/results/clientnegative/char_pad_convert_fail1.q.out
index 44ff41f897..81ceeec742 100644
--- a/ql/src/test/results/clientnegative/char_pad_convert_fail1.q.out
+++ b/ql/src/test/results/clientnegative/char_pad_convert_fail1.q.out
@@ -14,6 +14,7 @@ PREHOOK: query: create table over1k(
        fields terminated by '|'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@over1k
 POSTHOOK: query: create table over1k(
            t tinyint,
            si smallint,
diff --git a/ql/src/test/results/clientnegative/char_pad_convert_fail2.q.out b/ql/src/test/results/clientnegative/char_pad_convert_fail2.q.out
index 014cefca0e..90f9356499 100644
--- a/ql/src/test/results/clientnegative/char_pad_convert_fail2.q.out
+++ b/ql/src/test/results/clientnegative/char_pad_convert_fail2.q.out
@@ -14,6 +14,7 @@ PREHOOK: query: create table over1k(
        fields terminated by '|'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@over1k
 POSTHOOK: query: create table over1k(
            t tinyint,
            si smallint,
diff --git a/ql/src/test/results/clientnegative/char_pad_convert_fail3.q.out b/ql/src/test/results/clientnegative/char_pad_convert_fail3.q.out
index daf7952dde..9896eaef4a 100644
--- a/ql/src/test/results/clientnegative/char_pad_convert_fail3.q.out
+++ b/ql/src/test/results/clientnegative/char_pad_convert_fail3.q.out
@@ -14,6 +14,7 @@ PREHOOK: query: create table over1k(
        fields terminated by '|'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@over1k
 POSTHOOK: query: create table over1k(
            t tinyint,
            si smallint,
diff --git a/ql/src/test/results/clientnegative/clusterbydistributeby.q.out b/ql/src/test/results/clientnegative/clusterbydistributeby.q.out
index c8ec1db30a..388a62976a 100644
--- a/ql/src/test/results/clientnegative/clusterbydistributeby.q.out
+++ b/ql/src/test/results/clientnegative/clusterbydistributeby.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key INT, ten INT, one INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key INT, ten INT, one INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/clusterbysortby.q.out b/ql/src/test/results/clientnegative/clusterbysortby.q.out
index f331e99bcd..1a26f62138 100644
--- a/ql/src/test/results/clientnegative/clusterbysortby.q.out
+++ b/ql/src/test/results/clientnegative/clusterbysortby.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key INT, ten INT, one INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key INT, ten INT, one INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/column_change_skewedcol_type1.q.out b/ql/src/test/results/clientnegative/column_change_skewedcol_type1.q.out
index 7b1803e0ff..bafa7ed0b5 100644
--- a/ql/src/test/results/clientnegative/column_change_skewedcol_type1.q.out
+++ b/ql/src/test/results/clientnegative/column_change_skewedcol_type1.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE skewedtable (key STRING, value STRING) SKEWED BY (key) ON (1,5,6)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@skewedtable
 POSTHOOK: query: CREATE TABLE skewedtable (key STRING, value STRING) SKEWED BY (key) ON (1,5,6)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/column_rename1.q.out b/ql/src/test/results/clientnegative/column_rename1.q.out
index ff227ddb7c..01549c2665 100644
--- a/ql/src/test/results/clientnegative/column_rename1.q.out
+++ b/ql/src/test/results/clientnegative/column_rename1.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table tstsrc like src
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tstsrc
 POSTHOOK: query: create table tstsrc like src
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/column_rename2.q.out b/ql/src/test/results/clientnegative/column_rename2.q.out
index 5cf40aba9d..41c2219d10 100644
--- a/ql/src/test/results/clientnegative/column_rename2.q.out
+++ b/ql/src/test/results/clientnegative/column_rename2.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table tstsrc like src
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tstsrc
 POSTHOOK: query: create table tstsrc like src
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/column_rename4.q.out b/ql/src/test/results/clientnegative/column_rename4.q.out
index 09287c26ff..d5729f127a 100644
--- a/ql/src/test/results/clientnegative/column_rename4.q.out
+++ b/ql/src/test/results/clientnegative/column_rename4.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table tstsrc like src
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tstsrc
 POSTHOOK: query: create table tstsrc like src
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/column_rename5.q.out b/ql/src/test/results/clientnegative/column_rename5.q.out
index 7b1803e0ff..bafa7ed0b5 100644
--- a/ql/src/test/results/clientnegative/column_rename5.q.out
+++ b/ql/src/test/results/clientnegative/column_rename5.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE skewedtable (key STRING, value STRING) SKEWED BY (key) ON (1,5,6)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@skewedtable
 POSTHOOK: query: CREATE TABLE skewedtable (key STRING, value STRING) SKEWED BY (key) ON (1,5,6)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/columnstats_partlvl_invalid_values.q.out b/ql/src/test/results/clientnegative/columnstats_partlvl_invalid_values.q.out
index e3855d6cb4..3261f78fab 100644
--- a/ql/src/test/results/clientnegative/columnstats_partlvl_invalid_values.q.out
+++ b/ql/src/test/results/clientnegative/columnstats_partlvl_invalid_values.q.out
@@ -6,6 +6,7 @@ PREHOOK: query: CREATE TABLE Employee_Part(employeeID int, employeeName String)
 row format delimited fields terminated by '|'  stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@Employee_Part
 POSTHOOK: query: CREATE TABLE Employee_Part(employeeID int, employeeName String) partitioned by (employeeSalary double, country string)
 row format delimited fields terminated by '|'  stored as textfile
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientnegative/columnstats_partlvl_multiple_part_clause.q.out b/ql/src/test/results/clientnegative/columnstats_partlvl_multiple_part_clause.q.out
index 118626e535..ce79830a6c 100644
--- a/ql/src/test/results/clientnegative/columnstats_partlvl_multiple_part_clause.q.out
+++ b/ql/src/test/results/clientnegative/columnstats_partlvl_multiple_part_clause.q.out
@@ -6,6 +6,7 @@ PREHOOK: query: CREATE TABLE Employee_Part(employeeID int, employeeName String)
 row format delimited fields terminated by '|'  stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@Employee_Part
 POSTHOOK: query: CREATE TABLE Employee_Part(employeeID int, employeeName String) partitioned by (employeeSalary double, country string)
 row format delimited fields terminated by '|'  stored as textfile
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientnegative/columnstats_tbllvl.q.out b/ql/src/test/results/clientnegative/columnstats_tbllvl.q.out
index 5471cbad66..5aa4ae6404 100644
--- a/ql/src/test/results/clientnegative/columnstats_tbllvl.q.out
+++ b/ql/src/test/results/clientnegative/columnstats_tbllvl.q.out
@@ -15,6 +15,7 @@ PREHOOK: query: CREATE TABLE UserVisits_web_text_none (
 row format delimited fields terminated by '|'  stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@UserVisits_web_text_none
 POSTHOOK: query: CREATE TABLE UserVisits_web_text_none (
   sourceIP string,
   destURL string,
diff --git a/ql/src/test/results/clientnegative/columnstats_tbllvl_complex_type.q.out b/ql/src/test/results/clientnegative/columnstats_tbllvl_complex_type.q.out
index addaa895f0..0bb1a0dfd7 100644
--- a/ql/src/test/results/clientnegative/columnstats_tbllvl_complex_type.q.out
+++ b/ql/src/test/results/clientnegative/columnstats_tbllvl_complex_type.q.out
@@ -10,6 +10,7 @@ PREHOOK: query: CREATE TABLE table_complex_type (
        ) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table_complex_type
 POSTHOOK: query: CREATE TABLE table_complex_type (
        a STRING,
        b ARRAY<STRING>,
diff --git a/ql/src/test/results/clientnegative/columnstats_tbllvl_incorrect_column.q.out b/ql/src/test/results/clientnegative/columnstats_tbllvl_incorrect_column.q.out
index 5471cbad66..5aa4ae6404 100644
--- a/ql/src/test/results/clientnegative/columnstats_tbllvl_incorrect_column.q.out
+++ b/ql/src/test/results/clientnegative/columnstats_tbllvl_incorrect_column.q.out
@@ -15,6 +15,7 @@ PREHOOK: query: CREATE TABLE UserVisits_web_text_none (
 row format delimited fields terminated by '|'  stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@UserVisits_web_text_none
 POSTHOOK: query: CREATE TABLE UserVisits_web_text_none (
   sourceIP string,
   destURL string,
diff --git a/ql/src/test/results/clientnegative/compute_stats_long.q.out b/ql/src/test/results/clientnegative/compute_stats_long.q.out
index 3be6320fab..298e5e4beb 100644
--- a/ql/src/test/results/clientnegative/compute_stats_long.q.out
+++ b/ql/src/test/results/clientnegative/compute_stats_long.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table tab_int(a int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tab_int
 POSTHOOK: query: create table tab_int(a int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/create_table_wrong_regex.q.out b/ql/src/test/results/clientnegative/create_table_wrong_regex.q.out
index 5f80270d29..931f2a7294 100644
--- a/ql/src/test/results/clientnegative/create_table_wrong_regex.q.out
+++ b/ql/src/test/results/clientnegative/create_table_wrong_regex.q.out
@@ -7,6 +7,7 @@ PREHOOK: query: create table aa ( test STRING )
   WITH SERDEPROPERTIES ("input.regex" = "[^\\](.*)", "output.format.string" = "$1s")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@aa
 FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask. java.util.regex.PatternSyntaxException: Unclosed character class near index 7
 [^\](.*)
        ^
diff --git a/ql/src/test/results/clientnegative/create_view_failure1.q.out b/ql/src/test/results/clientnegative/create_view_failure1.q.out
index e1c9a0c2a4..5609590fde 100644
--- a/ql/src/test/results/clientnegative/create_view_failure1.q.out
+++ b/ql/src/test/results/clientnegative/create_view_failure1.q.out
@@ -6,6 +6,7 @@ PREHOOK: query: -- views and tables share the same namespace
 CREATE TABLE xxx12(key int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@xxx12
 POSTHOOK: query: -- views and tables share the same namespace
 CREATE TABLE xxx12(key int)
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientnegative/create_view_failure2.q.out b/ql/src/test/results/clientnegative/create_view_failure2.q.out
index 6c8a26d6a3..cfe318ab89 100644
--- a/ql/src/test/results/clientnegative/create_view_failure2.q.out
+++ b/ql/src/test/results/clientnegative/create_view_failure2.q.out
@@ -14,4 +14,5 @@ POSTHOOK: Output: default@xxx4
 PREHOOK: query: CREATE TABLE xxx4(key int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@xxx4
 FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask. AlreadyExistsException(message:Table xxx4 already exists)
diff --git a/ql/src/test/results/clientnegative/database_create_already_exists.q.out b/ql/src/test/results/clientnegative/database_create_already_exists.q.out
index 86aee91cc8..74ca7c452a 100644
--- a/ql/src/test/results/clientnegative/database_create_already_exists.q.out
+++ b/ql/src/test/results/clientnegative/database_create_already_exists.q.out
@@ -6,9 +6,12 @@ default
 PREHOOK: query: -- Try to create a database that already exists
 CREATE DATABASE test_db
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:test_db
 POSTHOOK: query: -- Try to create a database that already exists
 CREATE DATABASE test_db
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:test_db
 PREHOOK: query: CREATE DATABASE test_db
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:test_db
 FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask. Database test_db already exists
diff --git a/ql/src/test/results/clientnegative/database_create_invalid_name.q.out b/ql/src/test/results/clientnegative/database_create_invalid_name.q.out
index 8d4294958d..207cb078a1 100644
--- a/ql/src/test/results/clientnegative/database_create_invalid_name.q.out
+++ b/ql/src/test/results/clientnegative/database_create_invalid_name.q.out
@@ -6,4 +6,5 @@ default
 PREHOOK: query: -- Try to create a database with an invalid name
 CREATE DATABASE `test.db`
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:test.db
 FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask. InvalidObjectException(message:test.db is not a valid database name)
diff --git a/ql/src/test/results/clientnegative/database_drop_not_empty.q.out b/ql/src/test/results/clientnegative/database_drop_not_empty.q.out
index db5b5a44f1..a750d02815 100644
--- a/ql/src/test/results/clientnegative/database_drop_not_empty.q.out
+++ b/ql/src/test/results/clientnegative/database_drop_not_empty.q.out
@@ -6,24 +6,31 @@ default
 PREHOOK: query: -- Try to drop a non-empty database
 CREATE DATABASE test_db
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:test_db
 POSTHOOK: query: -- Try to drop a non-empty database
 CREATE DATABASE test_db
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:test_db
 PREHOOK: query: USE test_db
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:test_db
 POSTHOOK: query: USE test_db
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:test_db
 PREHOOK: query: CREATE TABLE t(a INT)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:test_db
+PREHOOK: Output: test_db@t
 POSTHOOK: query: CREATE TABLE t(a INT)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:test_db
 POSTHOOK: Output: test_db@t
 PREHOOK: query: USE default
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:default
 POSTHOOK: query: USE default
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:default
 PREHOOK: query: DROP DATABASE test_db
 PREHOOK: type: DROPDATABASE
 PREHOOK: Input: database:test_db
diff --git a/ql/src/test/results/clientnegative/database_drop_not_empty_restrict.q.out b/ql/src/test/results/clientnegative/database_drop_not_empty_restrict.q.out
index ebed9a4e4a..167c862592 100644
--- a/ql/src/test/results/clientnegative/database_drop_not_empty_restrict.q.out
+++ b/ql/src/test/results/clientnegative/database_drop_not_empty_restrict.q.out
@@ -6,24 +6,31 @@ default
 PREHOOK: query: -- Try to drop a non-empty database in restrict mode
 CREATE DATABASE db_drop_non_empty_restrict
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:db_drop_non_empty_restrict
 POSTHOOK: query: -- Try to drop a non-empty database in restrict mode
 CREATE DATABASE db_drop_non_empty_restrict
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:db_drop_non_empty_restrict
 PREHOOK: query: USE db_drop_non_empty_restrict
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:db_drop_non_empty_restrict
 POSTHOOK: query: USE db_drop_non_empty_restrict
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:db_drop_non_empty_restrict
 PREHOOK: query: CREATE TABLE t(a INT)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:db_drop_non_empty_restrict
+PREHOOK: Output: db_drop_non_empty_restrict@t
 POSTHOOK: query: CREATE TABLE t(a INT)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:db_drop_non_empty_restrict
 POSTHOOK: Output: db_drop_non_empty_restrict@t
 PREHOOK: query: USE default
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:default
 POSTHOOK: query: USE default
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:default
 PREHOOK: query: DROP DATABASE db_drop_non_empty_restrict
 PREHOOK: type: DROPDATABASE
 PREHOOK: Input: database:db_drop_non_empty_restrict
diff --git a/ql/src/test/results/clientnegative/database_switch_does_not_exist.q.out b/ql/src/test/results/clientnegative/database_switch_does_not_exist.q.out
index 1d640e349a..2f2c0e3a91 100644
--- a/ql/src/test/results/clientnegative/database_switch_does_not_exist.q.out
+++ b/ql/src/test/results/clientnegative/database_switch_does_not_exist.q.out
@@ -3,7 +3,4 @@ PREHOOK: type: SHOWDATABASES
 POSTHOOK: query: SHOW DATABASES
 POSTHOOK: type: SHOWDATABASES
 default
-PREHOOK: query: -- Try to switch to a database that does not exist
-USE does_not_exist
-PREHOOK: type: SWITCHDATABASE
-FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask. Database does not exist: does_not_exist
+FAILED: SemanticException [Error 10072]: Database does not exist: does_not_exist
diff --git a/ql/src/test/results/clientnegative/dbtxnmgr_nodblock.q.out b/ql/src/test/results/clientnegative/dbtxnmgr_nodblock.q.out
index 478667990a..b8bbe93d60 100644
--- a/ql/src/test/results/clientnegative/dbtxnmgr_nodblock.q.out
+++ b/ql/src/test/results/clientnegative/dbtxnmgr_nodblock.q.out
@@ -4,8 +4,10 @@ POSTHOOK: query: drop database if exists drop_nodblock
 POSTHOOK: type: DROPDATABASE
 PREHOOK: query: create database drop_nodblock
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:drop_nodblock
 POSTHOOK: query: create database drop_nodblock
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:drop_nodblock
 PREHOOK: query: lock database drop_nodblock shared
 PREHOOK: type: LOCKDATABASE
 FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask. Current transaction manager does not support explicit lock requests.  Transaction manager:   org.apache.hadoop.hive.ql.lockmgr.DbTxnManager
diff --git a/ql/src/test/results/clientnegative/dbtxnmgr_nodbunlock.q.out b/ql/src/test/results/clientnegative/dbtxnmgr_nodbunlock.q.out
index 14abcafc82..ea7a3ebe24 100644
--- a/ql/src/test/results/clientnegative/dbtxnmgr_nodbunlock.q.out
+++ b/ql/src/test/results/clientnegative/dbtxnmgr_nodbunlock.q.out
@@ -4,8 +4,10 @@ POSTHOOK: query: drop database if exists drop_nodbunlock
 POSTHOOK: type: DROPDATABASE
 PREHOOK: query: create database drop_nodbunlock
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:drop_nodbunlock
 POSTHOOK: query: create database drop_nodbunlock
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:drop_nodbunlock
 PREHOOK: query: unlock database drop_nodbunlock
 PREHOOK: type: UNLOCKDATABASE
 FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask. Current transaction manager does not support explicit lock requests.  Transaction manager:   org.apache.hadoop.hive.ql.lockmgr.DbTxnManager
diff --git a/ql/src/test/results/clientnegative/dbtxnmgr_notablelock.q.out b/ql/src/test/results/clientnegative/dbtxnmgr_notablelock.q.out
index 19aed990ef..3fad08c584 100644
--- a/ql/src/test/results/clientnegative/dbtxnmgr_notablelock.q.out
+++ b/ql/src/test/results/clientnegative/dbtxnmgr_notablelock.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table drop_notablelock (c int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@drop_notablelock
 POSTHOOK: query: create table drop_notablelock (c int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/dbtxnmgr_notableunlock.q.out b/ql/src/test/results/clientnegative/dbtxnmgr_notableunlock.q.out
index 38b9d1e4de..2d9a20f253 100644
--- a/ql/src/test/results/clientnegative/dbtxnmgr_notableunlock.q.out
+++ b/ql/src/test/results/clientnegative/dbtxnmgr_notableunlock.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table drop_notableunlock (c int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@drop_notableunlock
 POSTHOOK: query: create table drop_notableunlock (c int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/ddltime.q.out b/ql/src/test/results/clientnegative/ddltime.q.out
index e18eed9fb0..25d9af6198 100644
--- a/ql/src/test/results/clientnegative/ddltime.q.out
+++ b/ql/src/test/results/clientnegative/ddltime.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table T2 like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T2
 POSTHOOK: query: create table T2 like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/decimal_precision.q.out b/ql/src/test/results/clientnegative/decimal_precision.q.out
index 212cebf042..de53284e24 100644
--- a/ql/src/test/results/clientnegative/decimal_precision.q.out
+++ b/ql/src/test/results/clientnegative/decimal_precision.q.out
@@ -8,6 +8,7 @@ ROW FORMAT DELIMITED
 STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@DECIMAL_PRECISION
 POSTHOOK: query: CREATE TABLE DECIMAL_PRECISION(dec decimal) 
 ROW FORMAT DELIMITED
    FIELDS TERMINATED BY ' '
diff --git a/ql/src/test/results/clientnegative/decimal_precision_1.q.out b/ql/src/test/results/clientnegative/decimal_precision_1.q.out
index 6edd57048c..2b59b38633 100644
--- a/ql/src/test/results/clientnegative/decimal_precision_1.q.out
+++ b/ql/src/test/results/clientnegative/decimal_precision_1.q.out
@@ -8,6 +8,7 @@ ROW FORMAT DELIMITED
 STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@DECIMAL_PRECISION
 POSTHOOK: query: CREATE TABLE DECIMAL_PRECISION(dec decimal) 
 ROW FORMAT DELIMITED
    FIELDS TERMINATED BY ' '
diff --git a/ql/src/test/results/clientnegative/default_partition_name.q.out b/ql/src/test/results/clientnegative/default_partition_name.q.out
index 588b818ec0..f0add0a8a6 100644
--- a/ql/src/test/results/clientnegative/default_partition_name.q.out
+++ b/ql/src/test/results/clientnegative/default_partition_name.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table default_partition_name (key int, value string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@default_partition_name
 POSTHOOK: query: create table default_partition_name (key int, value string) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/deletejar.q.out b/ql/src/test/results/clientnegative/deletejar.q.out
index 91560ee229..d52186be89 100644
--- a/ql/src/test/results/clientnegative/deletejar.q.out
+++ b/ql/src/test/results/clientnegative/deletejar.q.out
@@ -1,4 +1,5 @@
 PREHOOK: query: CREATE TABLE DELETEJAR(KEY STRING, VALUE STRING) ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.TestSerDe' STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@DELETEJAR
 FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask. Cannot validate serde: org.apache.hadoop.hive.serde2.TestSerDe
diff --git a/ql/src/test/results/clientnegative/desc_failure3.q.out b/ql/src/test/results/clientnegative/desc_failure3.q.out
index 4b505c2e3f..ce77731bd8 100644
--- a/ql/src/test/results/clientnegative/desc_failure3.q.out
+++ b/ql/src/test/results/clientnegative/desc_failure3.q.out
@@ -1,12 +1,16 @@
 PREHOOK: query: CREATE DATABASE db1
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:db1
 POSTHOOK: query: CREATE DATABASE db1
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:db1
 PREHOOK: query: CREATE TABLE db1.t1(key1 INT, value1 STRING) PARTITIONED BY (ds STRING, part STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:db1
+PREHOOK: Output: db1@db1.t1
 POSTHOOK: query: CREATE TABLE db1.t1(key1 INT, value1 STRING) PARTITIONED BY (ds STRING, part STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:db1
+POSTHOOK: Output: db1@db1.t1
 POSTHOOK: Output: db1@t1
 FAILED: SemanticException [Error 10004]: Invalid table alias or column reference db1.t1.key1
diff --git a/ql/src/test/results/clientnegative/disallow_incompatible_type_change_on1.q.out b/ql/src/test/results/clientnegative/disallow_incompatible_type_change_on1.q.out
index 714183c8b6..8fee4e1921 100644
--- a/ql/src/test/results/clientnegative/disallow_incompatible_type_change_on1.q.out
+++ b/ql/src/test/results/clientnegative/disallow_incompatible_type_change_on1.q.out
@@ -10,6 +10,7 @@ POSTHOOK: Input: default@src
 PREHOOK: query: CREATE TABLE test_table123 (a INT, b MAP<STRING, STRING>) PARTITIONED BY (ds STRING) STORED AS SEQUENCEFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table123
 POSTHOOK: query: CREATE TABLE test_table123 (a INT, b MAP<STRING, STRING>) PARTITIONED BY (ds STRING) STORED AS SEQUENCEFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/disallow_incompatible_type_change_on2.q.out b/ql/src/test/results/clientnegative/disallow_incompatible_type_change_on2.q.out
index 090d427c30..c32efa6ddc 100644
--- a/ql/src/test/results/clientnegative/disallow_incompatible_type_change_on2.q.out
+++ b/ql/src/test/results/clientnegative/disallow_incompatible_type_change_on2.q.out
@@ -10,6 +10,7 @@ POSTHOOK: Input: default@src
 PREHOOK: query: CREATE TABLE test_table123 (a INT, b STRING) PARTITIONED BY (ds STRING) STORED AS SEQUENCEFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table123
 POSTHOOK: query: CREATE TABLE test_table123 (a INT, b STRING) PARTITIONED BY (ds STRING) STORED AS SEQUENCEFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/drop_partition_failure.q.out b/ql/src/test/results/clientnegative/drop_partition_failure.q.out
index cde0abb34c..67f0a08128 100644
--- a/ql/src/test/results/clientnegative/drop_partition_failure.q.out
+++ b/ql/src/test/results/clientnegative/drop_partition_failure.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table mp (a string) partitioned by (b string, c string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@mp
 POSTHOOK: query: create table mp (a string) partitioned by (b string, c string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/drop_partition_filter_failure.q.out b/ql/src/test/results/clientnegative/drop_partition_filter_failure.q.out
index c4f533bfac..b1bf8d4359 100644
--- a/ql/src/test/results/clientnegative/drop_partition_filter_failure.q.out
+++ b/ql/src/test/results/clientnegative/drop_partition_filter_failure.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table ptestfilter1 (a string, b int) partitioned by (c string, d string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@ptestfilter1
 POSTHOOK: query: create table ptestfilter1 (a string, b int) partitioned by (c string, d string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/drop_table_failure3.q.out b/ql/src/test/results/clientnegative/drop_table_failure3.q.out
index 9c1ff799d3..3dfa2bc247 100644
--- a/ql/src/test/results/clientnegative/drop_table_failure3.q.out
+++ b/ql/src/test/results/clientnegative/drop_table_failure3.q.out
@@ -1,14 +1,19 @@
 PREHOOK: query: create database dtf3
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:dtf3
 POSTHOOK: query: create database dtf3
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:dtf3
 PREHOOK: query: use dtf3
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:dtf3
 POSTHOOK: query: use dtf3
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:dtf3
 PREHOOK: query: create table drop_table_failure_temp(col STRING) partitioned by (p STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:dtf3
+PREHOOK: Output: dtf3@drop_table_failure_temp
 POSTHOOK: query: create table drop_table_failure_temp(col STRING) partitioned by (p STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:dtf3
diff --git a/ql/src/test/results/clientnegative/drop_view_failure1.q.out b/ql/src/test/results/clientnegative/drop_view_failure1.q.out
index 3a0038df38..f954ac77ea 100644
--- a/ql/src/test/results/clientnegative/drop_view_failure1.q.out
+++ b/ql/src/test/results/clientnegative/drop_view_failure1.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE xxx1(key int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@xxx1
 POSTHOOK: query: CREATE TABLE xxx1(key int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/duplicate_insert1.q.out b/ql/src/test/results/clientnegative/duplicate_insert1.q.out
index da654e3d7e..79f3bd49e8 100644
--- a/ql/src/test/results/clientnegative/duplicate_insert1.q.out
+++ b/ql/src/test/results/clientnegative/duplicate_insert1.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table dest1_din1(key int, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1_din1
 POSTHOOK: query: create table dest1_din1(key int, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/duplicate_insert2.q.out b/ql/src/test/results/clientnegative/duplicate_insert2.q.out
index 9ff815f96f..71f8d9131e 100644
--- a/ql/src/test/results/clientnegative/duplicate_insert2.q.out
+++ b/ql/src/test/results/clientnegative/duplicate_insert2.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table dest1_din2(key int, value string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1_din2
 POSTHOOK: query: create table dest1_din2(key int, value string) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/dyn_part1.q.out b/ql/src/test/results/clientnegative/dyn_part1.q.out
index 54d981ff04..62d01fbef8 100644
--- a/ql/src/test/results/clientnegative/dyn_part1.q.out
+++ b/ql/src/test/results/clientnegative/dyn_part1.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table dynamic_partition (key string) partitioned by (value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dynamic_partition
 POSTHOOK: query: create table dynamic_partition (key string) partitioned by (value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/dyn_part2.q.out b/ql/src/test/results/clientnegative/dyn_part2.q.out
index da6c8c6e99..f2b6b44c83 100644
--- a/ql/src/test/results/clientnegative/dyn_part2.q.out
+++ b/ql/src/test/results/clientnegative/dyn_part2.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table nzhang_part1 (key string, value string) partitioned by (ds string, hr string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@nzhang_part1
 POSTHOOK: query: create table nzhang_part1 (key string, value string) partitioned by (ds string, hr string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/dyn_part3.q.out b/ql/src/test/results/clientnegative/dyn_part3.q.out
index 658ce5f2fe..b9f1442446 100644
--- a/ql/src/test/results/clientnegative/dyn_part3.q.out
+++ b/ql/src/test/results/clientnegative/dyn_part3.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table nzhang_part( key string) partitioned by (value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@nzhang_part
 POSTHOOK: query: create table nzhang_part( key string) partitioned by (value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/dyn_part4.q.out b/ql/src/test/results/clientnegative/dyn_part4.q.out
index 3d81c88cf7..69c3f8568b 100644
--- a/ql/src/test/results/clientnegative/dyn_part4.q.out
+++ b/ql/src/test/results/clientnegative/dyn_part4.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table nzhang_part4 (key string) partitioned by (ds string, hr string, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@nzhang_part4
 POSTHOOK: query: create table nzhang_part4 (key string) partitioned by (ds string, hr string, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/dyn_part_max.q.out b/ql/src/test/results/clientnegative/dyn_part_max.q.out
index 000521fb17..dd5e8e9550 100644
--- a/ql/src/test/results/clientnegative/dyn_part_max.q.out
+++ b/ql/src/test/results/clientnegative/dyn_part_max.q.out
@@ -1,13 +1,16 @@
 PREHOOK: query: USE default
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:default
 POSTHOOK: query: USE default
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:default
 PREHOOK: query: -- Test of hive.exec.max.dynamic.partitions
 -- Set hive.exec.max.dynamic.partitions.pernode to a large value so it will be ignored
 
 CREATE TABLE max_parts(key STRING) PARTITIONED BY (value STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@max_parts
 POSTHOOK: query: -- Test of hive.exec.max.dynamic.partitions
 -- Set hive.exec.max.dynamic.partitions.pernode to a large value so it will be ignored
 
diff --git a/ql/src/test/results/clientnegative/dyn_part_max_per_node.q.out b/ql/src/test/results/clientnegative/dyn_part_max_per_node.q.out
index 4a463543d2..b8c21ed573 100644
--- a/ql/src/test/results/clientnegative/dyn_part_max_per_node.q.out
+++ b/ql/src/test/results/clientnegative/dyn_part_max_per_node.q.out
@@ -1,12 +1,15 @@
 PREHOOK: query: USE default
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:default
 POSTHOOK: query: USE default
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:default
 PREHOOK: query: -- Test of hive.exec.max.dynamic.partitions.pernode
 
 CREATE TABLE max_parts(key STRING) PARTITIONED BY (value STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@max_parts
 POSTHOOK: query: -- Test of hive.exec.max.dynamic.partitions.pernode
 
 CREATE TABLE max_parts(key STRING) PARTITIONED BY (value STRING)
diff --git a/ql/src/test/results/clientnegative/dynamic_partitions_with_whitelist.q.out b/ql/src/test/results/clientnegative/dynamic_partitions_with_whitelist.q.out
index 90e32f85dc..f069ae894e 100644
--- a/ql/src/test/results/clientnegative/dynamic_partitions_with_whitelist.q.out
+++ b/ql/src/test/results/clientnegative/dynamic_partitions_with_whitelist.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table source_table like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@source_table
 POSTHOOK: query: create table source_table like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@source_table
 PREHOOK: query: create table dest_table like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_table
 POSTHOOK: query: create table dest_table like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/exchange_partition_neg_incomplete_partition.q.out b/ql/src/test/results/clientnegative/exchange_partition_neg_incomplete_partition.q.out
index 716fb8ad82..f4c06f9ece 100644
--- a/ql/src/test/results/clientnegative/exchange_partition_neg_incomplete_partition.q.out
+++ b/ql/src/test/results/clientnegative/exchange_partition_neg_incomplete_partition.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE exchange_part_test1 (f1 string) PARTITIONED BY (ds STRING, hr STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exchange_part_test1
 POSTHOOK: query: CREATE TABLE exchange_part_test1 (f1 string) PARTITIONED BY (ds STRING, hr STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@exchange_part_test1
 PREHOOK: query: CREATE TABLE exchange_part_test2 (f1 string) PARTITIONED BY (ds STRING, hr STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exchange_part_test2
 POSTHOOK: query: CREATE TABLE exchange_part_test2 (f1 string) PARTITIONED BY (ds STRING, hr STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/exchange_partition_neg_partition_exists.q.out b/ql/src/test/results/clientnegative/exchange_partition_neg_partition_exists.q.out
index dc105277ef..48adc043d5 100644
--- a/ql/src/test/results/clientnegative/exchange_partition_neg_partition_exists.q.out
+++ b/ql/src/test/results/clientnegative/exchange_partition_neg_partition_exists.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE exchange_part_test1 (f1 string) PARTITIONED BY (ds STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exchange_part_test1
 POSTHOOK: query: CREATE TABLE exchange_part_test1 (f1 string) PARTITIONED BY (ds STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@exchange_part_test1
 PREHOOK: query: CREATE TABLE exchange_part_test2 (f1 string) PARTITIONED BY (ds STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exchange_part_test2
 POSTHOOK: query: CREATE TABLE exchange_part_test2 (f1 string) PARTITIONED BY (ds STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/exchange_partition_neg_partition_exists2.q.out b/ql/src/test/results/clientnegative/exchange_partition_neg_partition_exists2.q.out
index 219b71293c..3a78201483 100644
--- a/ql/src/test/results/clientnegative/exchange_partition_neg_partition_exists2.q.out
+++ b/ql/src/test/results/clientnegative/exchange_partition_neg_partition_exists2.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE exchange_part_test1 (f1 string) PARTITIONED BY (ds STRING, hr STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exchange_part_test1
 POSTHOOK: query: CREATE TABLE exchange_part_test1 (f1 string) PARTITIONED BY (ds STRING, hr STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@exchange_part_test1
 PREHOOK: query: CREATE TABLE exchange_part_test2 (f1 string) PARTITIONED BY (ds STRING, hr STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exchange_part_test2
 POSTHOOK: query: CREATE TABLE exchange_part_test2 (f1 string) PARTITIONED BY (ds STRING, hr STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/exchange_partition_neg_partition_exists3.q.out b/ql/src/test/results/clientnegative/exchange_partition_neg_partition_exists3.q.out
index 90a81e110a..8655a258f3 100644
--- a/ql/src/test/results/clientnegative/exchange_partition_neg_partition_exists3.q.out
+++ b/ql/src/test/results/clientnegative/exchange_partition_neg_partition_exists3.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE exchange_part_test1 (f1 string) PARTITIONED BY (ds STRING, hr STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exchange_part_test1
 POSTHOOK: query: CREATE TABLE exchange_part_test1 (f1 string) PARTITIONED BY (ds STRING, hr STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@exchange_part_test1
 PREHOOK: query: CREATE TABLE exchange_part_test2 (f1 string) PARTITIONED BY (ds STRING, hr STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exchange_part_test2
 POSTHOOK: query: CREATE TABLE exchange_part_test2 (f1 string) PARTITIONED BY (ds STRING, hr STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/exchange_partition_neg_partition_missing.q.out b/ql/src/test/results/clientnegative/exchange_partition_neg_partition_missing.q.out
index 0e7f535279..6757e6089d 100644
--- a/ql/src/test/results/clientnegative/exchange_partition_neg_partition_missing.q.out
+++ b/ql/src/test/results/clientnegative/exchange_partition_neg_partition_missing.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE exchange_part_test1 (f1 string) PARTITIONED BY (ds STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exchange_part_test1
 POSTHOOK: query: CREATE TABLE exchange_part_test1 (f1 string) PARTITIONED BY (ds STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@exchange_part_test1
 PREHOOK: query: CREATE TABLE exchange_part_test2 (f1 string) PARTITIONED BY (ds STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exchange_part_test2
 POSTHOOK: query: CREATE TABLE exchange_part_test2 (f1 string) PARTITIONED BY (ds STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/exchange_partition_neg_table_missing2.q.out b/ql/src/test/results/clientnegative/exchange_partition_neg_table_missing2.q.out
index 64e731f7ff..43ea9d7b12 100644
--- a/ql/src/test/results/clientnegative/exchange_partition_neg_table_missing2.q.out
+++ b/ql/src/test/results/clientnegative/exchange_partition_neg_table_missing2.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE exchange_part_test1 (f1 string) PARTITIONED BY (ds STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exchange_part_test1
 POSTHOOK: query: CREATE TABLE exchange_part_test1 (f1 string) PARTITIONED BY (ds STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/exchange_partition_neg_test.q.out b/ql/src/test/results/clientnegative/exchange_partition_neg_test.q.out
index 7cdf556010..f3194ce63f 100644
--- a/ql/src/test/results/clientnegative/exchange_partition_neg_test.q.out
+++ b/ql/src/test/results/clientnegative/exchange_partition_neg_test.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE exchange_part_test1 (f1 string) PARTITIONED BY (ds STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exchange_part_test1
 POSTHOOK: query: CREATE TABLE exchange_part_test1 (f1 string) PARTITIONED BY (ds STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@exchange_part_test1
 PREHOOK: query: CREATE TABLE exchange_part_test2 (f1 string, f2 string) PARTITIONED BY (ds STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exchange_part_test2
 POSTHOOK: query: CREATE TABLE exchange_part_test2 (f1 string, f2 string) PARTITIONED BY (ds STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/exim_00_unsupported_schema.q.out b/ql/src/test/results/clientnegative/exim_00_unsupported_schema.q.out
index 03940dc9b3..03515ea2d6 100644
--- a/ql/src/test/results/clientnegative/exim_00_unsupported_schema.q.out
+++ b/ql/src/test/results/clientnegative/exim_00_unsupported_schema.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: create table exim_department ( dep_id int comment "department id
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exim_department
 POSTHOOK: query: create table exim_department ( dep_id int comment "department id")
 	stored as textfile
 	tblproperties("creator"="krishna")
diff --git a/ql/src/test/results/clientnegative/exim_01_nonpart_over_loaded.q.out b/ql/src/test/results/clientnegative/exim_01_nonpart_over_loaded.q.out
index 3f30f3493e..7442b1bc8b 100644
--- a/ql/src/test/results/clientnegative/exim_01_nonpart_over_loaded.q.out
+++ b/ql/src/test/results/clientnegative/exim_01_nonpart_over_loaded.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: create table exim_department ( dep_id int comment "department id
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exim_department
 POSTHOOK: query: create table exim_department ( dep_id int comment "department id")
 	stored as textfile
 	tblproperties("creator"="krishna")
@@ -36,17 +37,22 @@ POSTHOOK: Input: default@exim_department
 POSTHOOK: Output: default@exim_department
 PREHOOK: query: create database importer
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:importer
 POSTHOOK: query: create database importer
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:importer
 PREHOOK: query: use importer
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:importer
 POSTHOOK: query: use importer
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:importer
 PREHOOK: query: create table exim_department ( dep_id int comment "department identifier")
 	stored as textfile
 	tblproperties("maker"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:importer
+PREHOOK: Output: importer@exim_department
 POSTHOOK: query: create table exim_department ( dep_id int comment "department identifier")
 	stored as textfile
 	tblproperties("maker"="krishna")
diff --git a/ql/src/test/results/clientnegative/exim_02_all_part_over_overlap.q.out b/ql/src/test/results/clientnegative/exim_02_all_part_over_overlap.q.out
index 2bac0b2fa6..3c05600c73 100644
--- a/ql/src/test/results/clientnegative/exim_02_all_part_over_overlap.q.out
+++ b/ql/src/test/results/clientnegative/exim_02_all_part_over_overlap.q.out
@@ -5,6 +5,7 @@ PREHOOK: query: create table exim_employee ( emp_id int comment "employee id")
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exim_employee
 POSTHOOK: query: create table exim_employee ( emp_id int comment "employee id") 	
 	comment "employee table"
 	partitioned by (emp_country string comment "two char iso code", emp_state string comment "free text")
@@ -82,12 +83,16 @@ POSTHOOK: Input: default@exim_employee
 POSTHOOK: Output: default@exim_employee
 PREHOOK: query: create database importer
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:importer
 POSTHOOK: query: create database importer
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:importer
 PREHOOK: query: use importer
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:importer
 POSTHOOK: query: use importer
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:importer
 PREHOOK: query: create table exim_employee ( emp_id int comment "employee id") 	
 	comment "table of employees"
 	partitioned by (emp_country string comment "iso code", emp_state string comment "free-form text")
@@ -95,6 +100,7 @@ PREHOOK: query: create table exim_employee ( emp_id int comment "employee id")
 	tblproperties("maker"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:importer
+PREHOOK: Output: importer@exim_employee
 POSTHOOK: query: create table exim_employee ( emp_id int comment "employee id") 	
 	comment "table of employees"
 	partitioned by (emp_country string comment "iso code", emp_state string comment "free-form text")
diff --git a/ql/src/test/results/clientnegative/exim_03_nonpart_noncompat_colschema.q.out b/ql/src/test/results/clientnegative/exim_03_nonpart_noncompat_colschema.q.out
index 45c6206df3..b61c38c174 100644
--- a/ql/src/test/results/clientnegative/exim_03_nonpart_noncompat_colschema.q.out
+++ b/ql/src/test/results/clientnegative/exim_03_nonpart_noncompat_colschema.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: create table exim_department ( dep_id int comment "department id
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exim_department
 POSTHOOK: query: create table exim_department ( dep_id int comment "department id") 	
 	stored as textfile	
 	tblproperties("creator"="krishna")
@@ -36,17 +37,22 @@ POSTHOOK: Input: default@exim_department
 POSTHOOK: Output: default@exim_department
 PREHOOK: query: create database importer
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:importer
 POSTHOOK: query: create database importer
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:importer
 PREHOOK: query: use importer
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:importer
 POSTHOOK: query: use importer
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:importer
 PREHOOK: query: create table exim_department ( dep_key int comment "department id") 	
 	stored as textfile	
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:importer
+PREHOOK: Output: importer@exim_department
 POSTHOOK: query: create table exim_department ( dep_key int comment "department id") 	
 	stored as textfile	
 	tblproperties("creator"="krishna")
diff --git a/ql/src/test/results/clientnegative/exim_04_nonpart_noncompat_colnumber.q.out b/ql/src/test/results/clientnegative/exim_04_nonpart_noncompat_colnumber.q.out
index 23858ef8fe..f8f5ea7283 100644
--- a/ql/src/test/results/clientnegative/exim_04_nonpart_noncompat_colnumber.q.out
+++ b/ql/src/test/results/clientnegative/exim_04_nonpart_noncompat_colnumber.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: create table exim_department ( dep_id int comment "department id
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exim_department
 POSTHOOK: query: create table exim_department ( dep_id int comment "department id") 	
 	stored as textfile	
 	tblproperties("creator"="krishna")
@@ -36,17 +37,22 @@ POSTHOOK: Input: default@exim_department
 POSTHOOK: Output: default@exim_department
 PREHOOK: query: create database importer
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:importer
 POSTHOOK: query: create database importer
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:importer
 PREHOOK: query: use importer
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:importer
 POSTHOOK: query: use importer
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:importer
 PREHOOK: query: create table exim_department ( dep_id int comment "department id", dep_name string) 	
 	stored as textfile	
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:importer
+PREHOOK: Output: importer@exim_department
 POSTHOOK: query: create table exim_department ( dep_id int comment "department id", dep_name string) 	
 	stored as textfile	
 	tblproperties("creator"="krishna")
diff --git a/ql/src/test/results/clientnegative/exim_05_nonpart_noncompat_coltype.q.out b/ql/src/test/results/clientnegative/exim_05_nonpart_noncompat_coltype.q.out
index 2a8e43ae69..f118aa77fc 100644
--- a/ql/src/test/results/clientnegative/exim_05_nonpart_noncompat_coltype.q.out
+++ b/ql/src/test/results/clientnegative/exim_05_nonpart_noncompat_coltype.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: create table exim_department ( dep_id int comment "department id
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exim_department
 POSTHOOK: query: create table exim_department ( dep_id int comment "department id") 	
 	stored as textfile	
 	tblproperties("creator"="krishna")
@@ -36,17 +37,22 @@ POSTHOOK: Input: default@exim_department
 POSTHOOK: Output: default@exim_department
 PREHOOK: query: create database importer
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:importer
 POSTHOOK: query: create database importer
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:importer
 PREHOOK: query: use importer
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:importer
 POSTHOOK: query: use importer
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:importer
 PREHOOK: query: create table exim_department ( dep_id bigint comment "department id") 	
 	stored as textfile	
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:importer
+PREHOOK: Output: importer@exim_department
 POSTHOOK: query: create table exim_department ( dep_id bigint comment "department id") 	
 	stored as textfile	
 	tblproperties("creator"="krishna")
diff --git a/ql/src/test/results/clientnegative/exim_06_nonpart_noncompat_storage.q.out b/ql/src/test/results/clientnegative/exim_06_nonpart_noncompat_storage.q.out
index b0012c80e7..4b0fbdb57e 100644
--- a/ql/src/test/results/clientnegative/exim_06_nonpart_noncompat_storage.q.out
+++ b/ql/src/test/results/clientnegative/exim_06_nonpart_noncompat_storage.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: create table exim_department ( dep_id int comment "department id
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exim_department
 POSTHOOK: query: create table exim_department ( dep_id int comment "department id") 	
 	stored as textfile	
 	tblproperties("creator"="krishna")
@@ -36,17 +37,22 @@ POSTHOOK: Input: default@exim_department
 POSTHOOK: Output: default@exim_department
 PREHOOK: query: create database importer
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:importer
 POSTHOOK: query: create database importer
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:importer
 PREHOOK: query: use importer
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:importer
 POSTHOOK: query: use importer
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:importer
 PREHOOK: query: create table exim_department ( dep_id int comment "department id") 	
 	stored as rcfile	
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:importer
+PREHOOK: Output: importer@exim_department
 POSTHOOK: query: create table exim_department ( dep_id int comment "department id") 	
 	stored as rcfile	
 	tblproperties("creator"="krishna")
diff --git a/ql/src/test/results/clientnegative/exim_07_nonpart_noncompat_ifof.q.out b/ql/src/test/results/clientnegative/exim_07_nonpart_noncompat_ifof.q.out
index be6782e69c..2c63d1be55 100644
--- a/ql/src/test/results/clientnegative/exim_07_nonpart_noncompat_ifof.q.out
+++ b/ql/src/test/results/clientnegative/exim_07_nonpart_noncompat_ifof.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: create table exim_department ( dep_id int comment "department id
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exim_department
 POSTHOOK: query: create table exim_department ( dep_id int comment "department id") 	
 	stored as textfile	
 	tblproperties("creator"="krishna")
@@ -36,12 +37,16 @@ POSTHOOK: Input: default@exim_department
 POSTHOOK: Output: default@exim_department
 PREHOOK: query: create database importer
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:importer
 POSTHOOK: query: create database importer
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:importer
 PREHOOK: query: use importer
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:importer
 POSTHOOK: query: use importer
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:importer
 PREHOOK: query: create table exim_department ( dep_id int comment "department id") 	
 	stored as inputformat "org.apache.hadoop.hive.ql.io.BucketizedHiveInputFormat" 
 		outputformat "org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat" 
@@ -50,6 +55,7 @@ PREHOOK: query: create table exim_department ( dep_id int comment "department id
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:importer
+PREHOOK: Output: importer@exim_department
 POSTHOOK: query: create table exim_department ( dep_id int comment "department id") 	
 	stored as inputformat "org.apache.hadoop.hive.ql.io.BucketizedHiveInputFormat" 
 		outputformat "org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat" 
diff --git a/ql/src/test/results/clientnegative/exim_08_nonpart_noncompat_serde.q.out b/ql/src/test/results/clientnegative/exim_08_nonpart_noncompat_serde.q.out
index 2a7eccef78..6098ad58ef 100644
--- a/ql/src/test/results/clientnegative/exim_08_nonpart_noncompat_serde.q.out
+++ b/ql/src/test/results/clientnegative/exim_08_nonpart_noncompat_serde.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: create table exim_department ( dep_id int comment "department id
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exim_department
 POSTHOOK: query: create table exim_department ( dep_id int comment "department id") 	
 	stored as textfile	
 	tblproperties("creator"="krishna")
@@ -36,18 +37,23 @@ POSTHOOK: Input: default@exim_department
 POSTHOOK: Output: default@exim_department
 PREHOOK: query: create database importer
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:importer
 POSTHOOK: query: create database importer
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:importer
 PREHOOK: query: use importer
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:importer
 POSTHOOK: query: use importer
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:importer
 PREHOOK: query: create table exim_department ( dep_id int comment "department id") 	
 	row format serde "org.apache.hadoop.hive.serde2.columnar.ColumnarSerDe"
 	stored as textfile
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:importer
+PREHOOK: Output: importer@exim_department
 POSTHOOK: query: create table exim_department ( dep_id int comment "department id") 	
 	row format serde "org.apache.hadoop.hive.serde2.columnar.ColumnarSerDe"
 	stored as textfile
diff --git a/ql/src/test/results/clientnegative/exim_09_nonpart_noncompat_serdeparam.q.out b/ql/src/test/results/clientnegative/exim_09_nonpart_noncompat_serdeparam.q.out
index e4c835b7c5..e3cc0241d3 100644
--- a/ql/src/test/results/clientnegative/exim_09_nonpart_noncompat_serdeparam.q.out
+++ b/ql/src/test/results/clientnegative/exim_09_nonpart_noncompat_serdeparam.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: create table exim_department ( dep_id int comment "department id
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exim_department
 POSTHOOK: query: create table exim_department ( dep_id int comment "department id") 	
 	stored as textfile	
 	tblproperties("creator"="krishna")
@@ -36,12 +37,16 @@ POSTHOOK: Input: default@exim_department
 POSTHOOK: Output: default@exim_department
 PREHOOK: query: create database importer
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:importer
 POSTHOOK: query: create database importer
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:importer
 PREHOOK: query: use importer
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:importer
 POSTHOOK: query: use importer
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:importer
 PREHOOK: query: create table exim_department ( dep_id int comment "department id") 	
 	row format serde "org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe"
 		with serdeproperties ("serialization.format"="0")
@@ -52,6 +57,7 @@ PREHOOK: query: create table exim_department ( dep_id int comment "department id
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:importer
+PREHOOK: Output: importer@exim_department
 POSTHOOK: query: create table exim_department ( dep_id int comment "department id") 	
 	row format serde "org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe"
 		with serdeproperties ("serialization.format"="0")
diff --git a/ql/src/test/results/clientnegative/exim_10_nonpart_noncompat_bucketing.q.out b/ql/src/test/results/clientnegative/exim_10_nonpart_noncompat_bucketing.q.out
index 4107301e88..8dc3df0f8e 100644
--- a/ql/src/test/results/clientnegative/exim_10_nonpart_noncompat_bucketing.q.out
+++ b/ql/src/test/results/clientnegative/exim_10_nonpart_noncompat_bucketing.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: create table exim_department ( dep_id int comment "department id
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exim_department
 POSTHOOK: query: create table exim_department ( dep_id int comment "department id") 	
 	stored as textfile	
 	tblproperties("creator"="krishna")
@@ -36,18 +37,23 @@ POSTHOOK: Input: default@exim_department
 POSTHOOK: Output: default@exim_department
 PREHOOK: query: create database importer
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:importer
 POSTHOOK: query: create database importer
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:importer
 PREHOOK: query: use importer
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:importer
 POSTHOOK: query: use importer
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:importer
 PREHOOK: query: create table exim_department ( dep_id int comment "department id") 	
 	clustered by (dep_id) into 10 buckets
 	stored as textfile
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:importer
+PREHOOK: Output: importer@exim_department
 POSTHOOK: query: create table exim_department ( dep_id int comment "department id") 	
 	clustered by (dep_id) into 10 buckets
 	stored as textfile
diff --git a/ql/src/test/results/clientnegative/exim_11_nonpart_noncompat_sorting.q.out b/ql/src/test/results/clientnegative/exim_11_nonpart_noncompat_sorting.q.out
index fa6c9c54f8..9220c8e806 100644
--- a/ql/src/test/results/clientnegative/exim_11_nonpart_noncompat_sorting.q.out
+++ b/ql/src/test/results/clientnegative/exim_11_nonpart_noncompat_sorting.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: create table exim_department ( dep_id int comment "department id
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exim_department
 POSTHOOK: query: create table exim_department ( dep_id int comment "department id") 	
 	clustered by (dep_id) sorted by (dep_id desc) into 10 buckets
 	stored as textfile	
@@ -38,18 +39,23 @@ POSTHOOK: Input: default@exim_department
 POSTHOOK: Output: default@exim_department
 PREHOOK: query: create database importer
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:importer
 POSTHOOK: query: create database importer
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:importer
 PREHOOK: query: use importer
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:importer
 POSTHOOK: query: use importer
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:importer
 PREHOOK: query: create table exim_department ( dep_id int comment "department id") 	
 	clustered by (dep_id) sorted by (dep_id asc) into 10 buckets
 	stored as textfile
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:importer
+PREHOOK: Output: importer@exim_department
 POSTHOOK: query: create table exim_department ( dep_id int comment "department id") 	
 	clustered by (dep_id) sorted by (dep_id asc) into 10 buckets
 	stored as textfile
diff --git a/ql/src/test/results/clientnegative/exim_12_nonnative_export.q.out b/ql/src/test/results/clientnegative/exim_12_nonnative_export.q.out
index 76e3ee644a..5da4daaa27 100644
--- a/ql/src/test/results/clientnegative/exim_12_nonnative_export.q.out
+++ b/ql/src/test/results/clientnegative/exim_12_nonnative_export.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: create table exim_department ( dep_id int comment "department id
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exim_department
 POSTHOOK: query: create table exim_department ( dep_id int comment "department id") 	
 	clustered by (dep_id) sorted by (dep_id desc) into 10 buckets
 	stored by "org.apache.hadoop.hive.ql.metadata.DefaultStorageHandler"	
diff --git a/ql/src/test/results/clientnegative/exim_13_nonnative_import.q.out b/ql/src/test/results/clientnegative/exim_13_nonnative_import.q.out
index e719442dc1..d8206432e3 100644
--- a/ql/src/test/results/clientnegative/exim_13_nonnative_import.q.out
+++ b/ql/src/test/results/clientnegative/exim_13_nonnative_import.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: create table exim_department ( dep_id int comment "department id
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exim_department
 POSTHOOK: query: create table exim_department ( dep_id int comment "department id") 	
 	stored as textfile	
 	tblproperties("creator"="krishna")
@@ -36,17 +37,22 @@ POSTHOOK: Input: default@exim_department
 POSTHOOK: Output: default@exim_department
 PREHOOK: query: create database importer
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:importer
 POSTHOOK: query: create database importer
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:importer
 PREHOOK: query: use importer
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:importer
 POSTHOOK: query: use importer
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:importer
 PREHOOK: query: create table exim_department ( dep_id int comment "department id") 	
 	stored by "org.apache.hadoop.hive.ql.metadata.DefaultStorageHandler"	
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:importer
+PREHOOK: Output: importer@exim_department
 POSTHOOK: query: create table exim_department ( dep_id int comment "department id") 	
 	stored by "org.apache.hadoop.hive.ql.metadata.DefaultStorageHandler"	
 	tblproperties("creator"="krishna")
diff --git a/ql/src/test/results/clientnegative/exim_14_nonpart_part.q.out b/ql/src/test/results/clientnegative/exim_14_nonpart_part.q.out
index b79ca01984..da116ef012 100644
--- a/ql/src/test/results/clientnegative/exim_14_nonpart_part.q.out
+++ b/ql/src/test/results/clientnegative/exim_14_nonpart_part.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: create table exim_department ( dep_id int comment "department id
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exim_department
 POSTHOOK: query: create table exim_department ( dep_id int comment "department id") 	
 	stored as textfile	
 	tblproperties("creator"="krishna")
@@ -36,18 +37,23 @@ POSTHOOK: Input: default@exim_department
 POSTHOOK: Output: default@exim_department
 PREHOOK: query: create database importer
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:importer
 POSTHOOK: query: create database importer
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:importer
 PREHOOK: query: use importer
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:importer
 POSTHOOK: query: use importer
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:importer
 PREHOOK: query: create table exim_department ( dep_id int comment "department id") 	
 	partitioned by (dep_org string)
 	stored as textfile		
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:importer
+PREHOOK: Output: importer@exim_department
 POSTHOOK: query: create table exim_department ( dep_id int comment "department id") 	
 	partitioned by (dep_org string)
 	stored as textfile		
diff --git a/ql/src/test/results/clientnegative/exim_15_part_nonpart.q.out b/ql/src/test/results/clientnegative/exim_15_part_nonpart.q.out
index b063fa7ebd..dfbf0250c0 100644
--- a/ql/src/test/results/clientnegative/exim_15_part_nonpart.q.out
+++ b/ql/src/test/results/clientnegative/exim_15_part_nonpart.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: create table exim_department ( dep_id int comment "department id
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exim_department
 POSTHOOK: query: create table exim_department ( dep_id int comment "department id") 	
 	partitioned by (dep_org string)
 	stored as textfile	
@@ -39,17 +40,22 @@ POSTHOOK: Input: default@exim_department
 POSTHOOK: Output: default@exim_department
 PREHOOK: query: create database importer
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:importer
 POSTHOOK: query: create database importer
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:importer
 PREHOOK: query: use importer
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:importer
 POSTHOOK: query: use importer
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:importer
 PREHOOK: query: create table exim_department ( dep_id int comment "department id") 	
 	stored as textfile		
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:importer
+PREHOOK: Output: importer@exim_department
 POSTHOOK: query: create table exim_department ( dep_id int comment "department id") 	
 	stored as textfile		
 	tblproperties("creator"="krishna")
diff --git a/ql/src/test/results/clientnegative/exim_16_part_noncompat_schema.q.out b/ql/src/test/results/clientnegative/exim_16_part_noncompat_schema.q.out
index 249ac3e304..4cb6ca7019 100644
--- a/ql/src/test/results/clientnegative/exim_16_part_noncompat_schema.q.out
+++ b/ql/src/test/results/clientnegative/exim_16_part_noncompat_schema.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: create table exim_department ( dep_id int comment "department id
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exim_department
 POSTHOOK: query: create table exim_department ( dep_id int comment "department id") 	
 	partitioned by (dep_org string)
 	stored as textfile	
@@ -39,18 +40,23 @@ POSTHOOK: Input: default@exim_department
 POSTHOOK: Output: default@exim_department
 PREHOOK: query: create database importer
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:importer
 POSTHOOK: query: create database importer
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:importer
 PREHOOK: query: use importer
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:importer
 POSTHOOK: query: use importer
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:importer
 PREHOOK: query: create table exim_department ( dep_id int comment "department id") 	
 	partitioned by (dep_mgr string)
 	stored as textfile		
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:importer
+PREHOOK: Output: importer@exim_department
 POSTHOOK: query: create table exim_department ( dep_id int comment "department id") 	
 	partitioned by (dep_mgr string)
 	stored as textfile		
diff --git a/ql/src/test/results/clientnegative/exim_17_part_spec_underspec.q.out b/ql/src/test/results/clientnegative/exim_17_part_spec_underspec.q.out
index 893ad6d93c..23caa4ac82 100644
--- a/ql/src/test/results/clientnegative/exim_17_part_spec_underspec.q.out
+++ b/ql/src/test/results/clientnegative/exim_17_part_spec_underspec.q.out
@@ -5,6 +5,7 @@ PREHOOK: query: create table exim_employee ( emp_id int comment "employee id")
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exim_employee
 POSTHOOK: query: create table exim_employee ( emp_id int comment "employee id") 	
 	comment "employee table"
 	partitioned by (emp_country string comment "two char iso code", emp_state string comment "free text")
@@ -82,10 +83,14 @@ POSTHOOK: Input: default@exim_employee
 POSTHOOK: Output: default@exim_employee
 PREHOOK: query: create database importer
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:importer
 POSTHOOK: query: create database importer
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:importer
 PREHOOK: query: use importer
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:importer
 POSTHOOK: query: use importer
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:importer
 FAILED: SemanticException [Error 10006]: Partition not found  - Specified partition not found in import directory
diff --git a/ql/src/test/results/clientnegative/exim_18_part_spec_missing.q.out b/ql/src/test/results/clientnegative/exim_18_part_spec_missing.q.out
index 893ad6d93c..23caa4ac82 100644
--- a/ql/src/test/results/clientnegative/exim_18_part_spec_missing.q.out
+++ b/ql/src/test/results/clientnegative/exim_18_part_spec_missing.q.out
@@ -5,6 +5,7 @@ PREHOOK: query: create table exim_employee ( emp_id int comment "employee id")
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exim_employee
 POSTHOOK: query: create table exim_employee ( emp_id int comment "employee id") 	
 	comment "employee table"
 	partitioned by (emp_country string comment "two char iso code", emp_state string comment "free text")
@@ -82,10 +83,14 @@ POSTHOOK: Input: default@exim_employee
 POSTHOOK: Output: default@exim_employee
 PREHOOK: query: create database importer
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:importer
 POSTHOOK: query: create database importer
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:importer
 PREHOOK: query: use importer
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:importer
 POSTHOOK: query: use importer
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:importer
 FAILED: SemanticException [Error 10006]: Partition not found  - Specified partition not found in import directory
diff --git a/ql/src/test/results/clientnegative/exim_19_external_over_existing.q.out b/ql/src/test/results/clientnegative/exim_19_external_over_existing.q.out
index aa68e26a5e..763efb2f95 100644
--- a/ql/src/test/results/clientnegative/exim_19_external_over_existing.q.out
+++ b/ql/src/test/results/clientnegative/exim_19_external_over_existing.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: create table exim_department ( dep_id int comment "department id
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exim_department
 POSTHOOK: query: create table exim_department ( dep_id int comment "department id") 	
 	stored as textfile	
 	tblproperties("creator"="krishna")
@@ -36,17 +37,22 @@ POSTHOOK: Input: default@exim_department
 POSTHOOK: Output: default@exim_department
 PREHOOK: query: create database importer
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:importer
 POSTHOOK: query: create database importer
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:importer
 PREHOOK: query: use importer
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:importer
 POSTHOOK: query: use importer
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:importer
 PREHOOK: query: create  table exim_department ( dep_id int comment "department id") 	
 	stored as textfile
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:importer
+PREHOOK: Output: importer@exim_department
 POSTHOOK: query: create  table exim_department ( dep_id int comment "department id") 	
 	stored as textfile
 	tblproperties("creator"="krishna")
diff --git a/ql/src/test/results/clientnegative/exim_20_managed_location_over_existing.q.out b/ql/src/test/results/clientnegative/exim_20_managed_location_over_existing.q.out
index fd4a418b4c..77d58cb9c1 100644
--- a/ql/src/test/results/clientnegative/exim_20_managed_location_over_existing.q.out
+++ b/ql/src/test/results/clientnegative/exim_20_managed_location_over_existing.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: create table exim_department ( dep_id int comment "department id
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exim_department
 POSTHOOK: query: create table exim_department ( dep_id int comment "department id") 	
 	stored as textfile	
 	tblproperties("creator"="krishna")
@@ -36,12 +37,16 @@ POSTHOOK: Input: default@exim_department
 POSTHOOK: Output: default@exim_department
 PREHOOK: query: create database importer
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:importer
 POSTHOOK: query: create database importer
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:importer
 PREHOOK: query: use importer
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:importer
 POSTHOOK: query: use importer
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:importer
 #### A masked pattern was here ####
 PREHOOK: query: create table exim_department ( dep_id int comment "department id") 	
 	stored as textfile
@@ -50,6 +55,7 @@ PREHOOK: query: create table exim_department ( dep_id int comment "department id
 PREHOOK: type: CREATETABLE
 #### A masked pattern was here ####
 PREHOOK: Output: database:importer
+PREHOOK: Output: importer@exim_department
 POSTHOOK: query: create table exim_department ( dep_id int comment "department id") 	
 	stored as textfile
 	location 'ql/test/data/tablestore/exim_department'
diff --git a/ql/src/test/results/clientnegative/exim_21_part_managed_external.q.out b/ql/src/test/results/clientnegative/exim_21_part_managed_external.q.out
index 2ce5f1e65b..fd27f29f34 100644
--- a/ql/src/test/results/clientnegative/exim_21_part_managed_external.q.out
+++ b/ql/src/test/results/clientnegative/exim_21_part_managed_external.q.out
@@ -5,6 +5,7 @@ PREHOOK: query: create table exim_employee ( emp_id int comment "employee id")
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exim_employee
 POSTHOOK: query: create table exim_employee ( emp_id int comment "employee id") 	
 	comment "employee table"
 	partitioned by (emp_country string comment "two char iso code", emp_state string comment "free text")
@@ -82,12 +83,16 @@ POSTHOOK: Input: default@exim_employee
 POSTHOOK: Output: default@exim_employee
 PREHOOK: query: create database importer
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:importer
 POSTHOOK: query: create database importer
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:importer
 PREHOOK: query: use importer
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:importer
 POSTHOOK: query: use importer
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:importer
 PREHOOK: query: create table exim_employee ( emp_id int comment "employee id") 	
 	comment "employee table"
 	partitioned by (emp_country string comment "two char iso code", emp_state string comment "free text")
@@ -95,6 +100,7 @@ PREHOOK: query: create table exim_employee ( emp_id int comment "employee id")
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:importer
+PREHOOK: Output: importer@exim_employee
 POSTHOOK: query: create table exim_employee ( emp_id int comment "employee id") 	
 	comment "employee table"
 	partitioned by (emp_country string comment "two char iso code", emp_state string comment "free text")
diff --git a/ql/src/test/results/clientnegative/exim_22_export_authfail.q.out b/ql/src/test/results/clientnegative/exim_22_export_authfail.q.out
index c7b9c49b62..2dfe38e988 100644
--- a/ql/src/test/results/clientnegative/exim_22_export_authfail.q.out
+++ b/ql/src/test/results/clientnegative/exim_22_export_authfail.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table exim_department ( dep_id int) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exim_department
 POSTHOOK: query: create table exim_department ( dep_id int) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/exim_23_import_exist_authfail.q.out b/ql/src/test/results/clientnegative/exim_23_import_exist_authfail.q.out
index c6fb9de8fc..4e65479564 100644
--- a/ql/src/test/results/clientnegative/exim_23_import_exist_authfail.q.out
+++ b/ql/src/test/results/clientnegative/exim_23_import_exist_authfail.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table exim_department ( dep_id int) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exim_department
 POSTHOOK: query: create table exim_department ( dep_id int) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -32,15 +33,20 @@ POSTHOOK: Input: default@exim_department
 POSTHOOK: Output: default@exim_department
 PREHOOK: query: create database importer
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:importer
 POSTHOOK: query: create database importer
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:importer
 PREHOOK: query: use importer
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:importer
 POSTHOOK: query: use importer
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:importer
 PREHOOK: query: create table exim_department ( dep_id int) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:importer
+PREHOOK: Output: importer@exim_department
 POSTHOOK: query: create table exim_department ( dep_id int) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:importer
diff --git a/ql/src/test/results/clientnegative/exim_24_import_part_authfail.q.out b/ql/src/test/results/clientnegative/exim_24_import_part_authfail.q.out
index 945d3d267e..1a9a34da50 100644
--- a/ql/src/test/results/clientnegative/exim_24_import_part_authfail.q.out
+++ b/ql/src/test/results/clientnegative/exim_24_import_part_authfail.q.out
@@ -5,6 +5,7 @@ PREHOOK: query: create table exim_employee ( emp_id int comment "employee id")
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exim_employee
 POSTHOOK: query: create table exim_employee ( emp_id int comment "employee id") 	
 	comment "employee table"
 	partitioned by (emp_country string comment "two char iso code", emp_state string comment "free text")
@@ -43,12 +44,16 @@ POSTHOOK: Input: default@exim_employee
 POSTHOOK: Output: default@exim_employee
 PREHOOK: query: create database importer
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:importer
 POSTHOOK: query: create database importer
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:importer
 PREHOOK: query: use importer
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:importer
 POSTHOOK: query: use importer
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:importer
 PREHOOK: query: create table exim_employee ( emp_id int comment "employee id") 	
 	comment "employee table"
 	partitioned by (emp_country string comment "two char iso code", emp_state string comment "free text")
@@ -56,6 +61,7 @@ PREHOOK: query: create table exim_employee ( emp_id int comment "employee id")
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:importer
+PREHOOK: Output: importer@exim_employee
 POSTHOOK: query: create table exim_employee ( emp_id int comment "employee id") 	
 	comment "employee table"
 	partitioned by (emp_country string comment "two char iso code", emp_state string comment "free text")
diff --git a/ql/src/test/results/clientnegative/exim_25_import_nonexist_authfail.q.out b/ql/src/test/results/clientnegative/exim_25_import_nonexist_authfail.q.out
index e606d722c5..d38b7fdaaa 100644
--- a/ql/src/test/results/clientnegative/exim_25_import_nonexist_authfail.q.out
+++ b/ql/src/test/results/clientnegative/exim_25_import_nonexist_authfail.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table exim_department ( dep_id int) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exim_department
 POSTHOOK: query: create table exim_department ( dep_id int) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -32,10 +33,14 @@ POSTHOOK: Input: default@exim_department
 POSTHOOK: Output: default@exim_department
 PREHOOK: query: create database importer
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:importer
 POSTHOOK: query: create database importer
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:importer
 PREHOOK: query: use importer
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:importer
 POSTHOOK: query: use importer
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:importer
 Authorization failed:No privilege 'Create' found for outputs { database:importer}. Use SHOW GRANT to get more details.
diff --git a/ql/src/test/results/clientnegative/external1.q.out b/ql/src/test/results/clientnegative/external1.q.out
index 696beaa4e4..c5836273e3 100644
--- a/ql/src/test/results/clientnegative/external1.q.out
+++ b/ql/src/test/results/clientnegative/external1.q.out
@@ -2,4 +2,5 @@
 PREHOOK: type: CREATETABLE
 #### A masked pattern was here ####
 PREHOOK: Output: database:default
+PREHOOK: Output: default@external1
 FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask. MetaException(message:Got exception: java.io.IOException No FileSystem for scheme: invalidscheme)
diff --git a/ql/src/test/results/clientnegative/external2.q.out b/ql/src/test/results/clientnegative/external2.q.out
index a6048850bf..4fc7c11e67 100644
--- a/ql/src/test/results/clientnegative/external2.q.out
+++ b/ql/src/test/results/clientnegative/external2.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create external table external2(a int, b int) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@external2
 POSTHOOK: query: create external table external2(a int, b int) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/fetchtask_ioexception.q.out b/ql/src/test/results/clientnegative/fetchtask_ioexception.q.out
index 2d84b1cd60..f5b0b5d2d7 100644
--- a/ql/src/test/results/clientnegative/fetchtask_ioexception.q.out
+++ b/ql/src/test/results/clientnegative/fetchtask_ioexception.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: CREATE TABLE fetchtask_ioexception (
   VALUE STRING) STORED AS SEQUENCEFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@fetchtask_ioexception
 POSTHOOK: query: CREATE TABLE fetchtask_ioexception (
   KEY STRING,
   VALUE STRING) STORED AS SEQUENCEFILE
diff --git a/ql/src/test/results/clientnegative/file_with_header_footer_negative.q.out b/ql/src/test/results/clientnegative/file_with_header_footer_negative.q.out
index 43e2086bfa..1794ae64ed 100644
--- a/ql/src/test/results/clientnegative/file_with_header_footer_negative.q.out
+++ b/ql/src/test/results/clientnegative/file_with_header_footer_negative.q.out
@@ -2,6 +2,7 @@
 PREHOOK: type: CREATETABLE
 #### A masked pattern was here ####
 PREHOOK: Output: database:default
+PREHOOK: Output: default@header_footer_table_1
 #### A masked pattern was here ####
 POSTHOOK: type: CREATETABLE
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientnegative/fileformat_void_input.q.out b/ql/src/test/results/clientnegative/fileformat_void_input.q.out
index 6c51c1dcc6..6043258506 100644
--- a/ql/src/test/results/clientnegative/fileformat_void_input.q.out
+++ b/ql/src/test/results/clientnegative/fileformat_void_input.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS
   OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS
   INPUTFORMAT 'java.lang.Void'
   OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat'
diff --git a/ql/src/test/results/clientnegative/groupby2_map_skew_multi_distinct.q.out b/ql/src/test/results/clientnegative/groupby2_map_skew_multi_distinct.q.out
index 8de35cc0fd..fdf4428380 100644
--- a/ql/src/test/results/clientnegative/groupby2_map_skew_multi_distinct.q.out
+++ b/ql/src/test/results/clientnegative/groupby2_map_skew_multi_distinct.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key STRING, c1 INT, c2 STRING, c3 INT, c4 INT) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key STRING, c1 INT, c2 STRING, c3 INT, c4 INT) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/groupby2_multi_distinct.q.out b/ql/src/test/results/clientnegative/groupby2_multi_distinct.q.out
index 445e17d206..b219fe60cd 100644
--- a/ql/src/test/results/clientnegative/groupby2_multi_distinct.q.out
+++ b/ql/src/test/results/clientnegative/groupby2_multi_distinct.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest_g2(key STRING, c1 INT, c2 STRING, c3 INT, c4 INT) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_g2
 POSTHOOK: query: CREATE TABLE dest_g2(key STRING, c1 INT, c2 STRING, c3 INT, c4 INT) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/groupby3_map_skew_multi_distinct.q.out b/ql/src/test/results/clientnegative/groupby3_map_skew_multi_distinct.q.out
index e0662244f9..3c5506b313 100644
--- a/ql/src/test/results/clientnegative/groupby3_map_skew_multi_distinct.q.out
+++ b/ql/src/test/results/clientnegative/groupby3_map_skew_multi_distinct.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(c1 DOUBLE, c2 DOUBLE, c3 DOUBLE, c4 DOUBLE, c5 DOUBLE, c6 DOUBLE, c7 DOUBLE, c8 DOUBLE, c9 DOUBLE, c10 DOUBLE, c11 DOUBLE) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(c1 DOUBLE, c2 DOUBLE, c3 DOUBLE, c4 DOUBLE, c5 DOUBLE, c6 DOUBLE, c7 DOUBLE, c8 DOUBLE, c9 DOUBLE, c10 DOUBLE, c11 DOUBLE) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/groupby3_multi_distinct.q.out b/ql/src/test/results/clientnegative/groupby3_multi_distinct.q.out
index e0662244f9..3c5506b313 100644
--- a/ql/src/test/results/clientnegative/groupby3_multi_distinct.q.out
+++ b/ql/src/test/results/clientnegative/groupby3_multi_distinct.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(c1 DOUBLE, c2 DOUBLE, c3 DOUBLE, c4 DOUBLE, c5 DOUBLE, c6 DOUBLE, c7 DOUBLE, c8 DOUBLE, c9 DOUBLE, c10 DOUBLE, c11 DOUBLE) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(c1 DOUBLE, c2 DOUBLE, c3 DOUBLE, c4 DOUBLE, c5 DOUBLE, c6 DOUBLE, c7 DOUBLE, c8 DOUBLE, c9 DOUBLE, c10 DOUBLE, c11 DOUBLE) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/groupby_grouping_id1.q.out b/ql/src/test/results/clientnegative/groupby_grouping_id1.q.out
index 5980f26f64..912b8d3dea 100644
--- a/ql/src/test/results/clientnegative/groupby_grouping_id1.q.out
+++ b/ql/src/test/results/clientnegative/groupby_grouping_id1.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE T1(key STRING, val STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: CREATE TABLE T1(key STRING, val STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/groupby_grouping_sets1.q.out b/ql/src/test/results/clientnegative/groupby_grouping_sets1.q.out
index e21677832e..8290d4c468 100644
--- a/ql/src/test/results/clientnegative/groupby_grouping_sets1.q.out
+++ b/ql/src/test/results/clientnegative/groupby_grouping_sets1.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE T1(a STRING, b STRING, c STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: CREATE TABLE T1(a STRING, b STRING, c STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/groupby_grouping_sets2.q.out b/ql/src/test/results/clientnegative/groupby_grouping_sets2.q.out
index e21677832e..8290d4c468 100644
--- a/ql/src/test/results/clientnegative/groupby_grouping_sets2.q.out
+++ b/ql/src/test/results/clientnegative/groupby_grouping_sets2.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE T1(a STRING, b STRING, c STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: CREATE TABLE T1(a STRING, b STRING, c STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/groupby_grouping_sets3.q.out b/ql/src/test/results/clientnegative/groupby_grouping_sets3.q.out
index 158c50da17..815f04fcda 100644
--- a/ql/src/test/results/clientnegative/groupby_grouping_sets3.q.out
+++ b/ql/src/test/results/clientnegative/groupby_grouping_sets3.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE T1(a STRING, b STRING, c STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: CREATE TABLE T1(a STRING, b STRING, c STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/groupby_grouping_sets4.q.out b/ql/src/test/results/clientnegative/groupby_grouping_sets4.q.out
index a9c0665058..4a595cb07b 100644
--- a/ql/src/test/results/clientnegative/groupby_grouping_sets4.q.out
+++ b/ql/src/test/results/clientnegative/groupby_grouping_sets4.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE T1(a STRING, b STRING, c STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: CREATE TABLE T1(a STRING, b STRING, c STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/groupby_grouping_sets5.q.out b/ql/src/test/results/clientnegative/groupby_grouping_sets5.q.out
index a9c0665058..4a595cb07b 100644
--- a/ql/src/test/results/clientnegative/groupby_grouping_sets5.q.out
+++ b/ql/src/test/results/clientnegative/groupby_grouping_sets5.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE T1(a STRING, b STRING, c STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: CREATE TABLE T1(a STRING, b STRING, c STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/groupby_grouping_sets6.q.out b/ql/src/test/results/clientnegative/groupby_grouping_sets6.q.out
index 510e8b4206..a2f399a754 100644
--- a/ql/src/test/results/clientnegative/groupby_grouping_sets6.q.out
+++ b/ql/src/test/results/clientnegative/groupby_grouping_sets6.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE T1(a STRING, b STRING, c STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY ' ' STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: CREATE TABLE T1(a STRING, b STRING, c STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY ' ' STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/groupby_grouping_sets7.q.out b/ql/src/test/results/clientnegative/groupby_grouping_sets7.q.out
index 4adfc97f1e..226de5ab1a 100644
--- a/ql/src/test/results/clientnegative/groupby_grouping_sets7.q.out
+++ b/ql/src/test/results/clientnegative/groupby_grouping_sets7.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE T1(a STRING, b STRING, c STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY ' ' STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: CREATE TABLE T1(a STRING, b STRING, c STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY ' ' STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/illegal_partition_type.q.out b/ql/src/test/results/clientnegative/illegal_partition_type.q.out
index 0d02acc999..fce549b2a1 100644
--- a/ql/src/test/results/clientnegative/illegal_partition_type.q.out
+++ b/ql/src/test/results/clientnegative/illegal_partition_type.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- begin part(string, int) pass(string, string)
 CREATE TABLE tab1 (id1 int,id2 string) PARTITIONED BY(month string,day int) ROW FORMAT DELIMITED FIELDS TERMINATED BY ','
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tab1
 POSTHOOK: query: -- begin part(string, int) pass(string, string)
 CREATE TABLE tab1 (id1 int,id2 string) PARTITIONED BY(month string,day int) ROW FORMAT DELIMITED FIELDS TERMINATED BY ','
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientnegative/illegal_partition_type2.q.out b/ql/src/test/results/clientnegative/illegal_partition_type2.q.out
index aec0fa12d2..3442d99aea 100644
--- a/ql/src/test/results/clientnegative/illegal_partition_type2.q.out
+++ b/ql/src/test/results/clientnegative/illegal_partition_type2.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table tab1 (id1 int, id2 string) PARTITIONED BY(month string,day int) row format delimited fields terminated by ','
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tab1
 POSTHOOK: query: create table tab1 (id1 int, id2 string) PARTITIONED BY(month string,day int) row format delimited fields terminated by ','
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/illegal_partition_type3.q.out b/ql/src/test/results/clientnegative/illegal_partition_type3.q.out
index 7386258757..cb2173a46f 100644
--- a/ql/src/test/results/clientnegative/illegal_partition_type3.q.out
+++ b/ql/src/test/results/clientnegative/illegal_partition_type3.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table tab1(c int) partitioned by (i int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tab1
 POSTHOOK: query: create table tab1(c int) partitioned by (i int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/illegal_partition_type4.q.out b/ql/src/test/results/clientnegative/illegal_partition_type4.q.out
index fe90afb839..e38808633c 100644
--- a/ql/src/test/results/clientnegative/illegal_partition_type4.q.out
+++ b/ql/src/test/results/clientnegative/illegal_partition_type4.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table tab1(s string) PARTITIONED BY(dt date, st string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tab1
 POSTHOOK: query: create table tab1(s string) PARTITIONED BY(dt date, st string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/index_bitmap_no_map_aggr.q.out b/ql/src/test/results/clientnegative/index_bitmap_no_map_aggr.q.out
index 31cada1f03..b29d3a6698 100644
--- a/ql/src/test/results/clientnegative/index_bitmap_no_map_aggr.q.out
+++ b/ql/src/test/results/clientnegative/index_bitmap_no_map_aggr.q.out
@@ -12,7 +12,9 @@ STAGE PLANS:
 
 PREHOOK: query: CREATE INDEX src1_index ON TABLE src(key) as 'BITMAP' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: CREATE INDEX src1_index ON TABLE src(key) as 'BITMAP' WITH DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@default__src_src1_index__
 FAILED: SemanticException org.apache.hadoop.hive.ql.parse.SemanticException: org.apache.hadoop.hive.ql.metadata.HiveException: Cannot construct index without map-side aggregation
diff --git a/ql/src/test/results/clientnegative/index_compact_entry_limit.q.out b/ql/src/test/results/clientnegative/index_compact_entry_limit.q.out
index 85614ca2ce..b65f94e850 100644
--- a/ql/src/test/results/clientnegative/index_compact_entry_limit.q.out
+++ b/ql/src/test/results/clientnegative/index_compact_entry_limit.q.out
@@ -1,11 +1,15 @@
 PREHOOK: query: drop index src_index on src
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: drop index src_index on src
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@src
 PREHOOK: query: CREATE INDEX src_index ON TABLE src(key) as 'COMPACT' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: CREATE INDEX src_index ON TABLE src(key) as 'COMPACT' WITH DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@default__src_src_index__
 PREHOOK: query: ALTER INDEX src_index ON src REBUILD
 PREHOOK: type: ALTERINDEX_REBUILD
diff --git a/ql/src/test/results/clientnegative/index_compact_size_limit.q.out b/ql/src/test/results/clientnegative/index_compact_size_limit.q.out
index 7c6bb0ae36..299cc4748b 100644
--- a/ql/src/test/results/clientnegative/index_compact_size_limit.q.out
+++ b/ql/src/test/results/clientnegative/index_compact_size_limit.q.out
@@ -1,11 +1,15 @@
 PREHOOK: query: drop index src_index on src
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: drop index src_index on src
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@src
 PREHOOK: query: CREATE INDEX src_index ON TABLE src(key) as 'COMPACT' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: CREATE INDEX src_index ON TABLE src(key) as 'COMPACT' WITH DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@default__src_src_index__
 PREHOOK: query: ALTER INDEX src_index ON src REBUILD
 PREHOOK: type: ALTERINDEX_REBUILD
diff --git a/ql/src/test/results/clientnegative/insert_into1.q.out b/ql/src/test/results/clientnegative/insert_into1.q.out
index 4bfbc98f8c..066f04d1cc 100644
--- a/ql/src/test/results/clientnegative/insert_into1.q.out
+++ b/ql/src/test/results/clientnegative/insert_into1.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: CREATE TABLE insert_into1_neg (key int, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@insert_into1_neg
 POSTHOOK: query: CREATE TABLE insert_into1_neg (key int, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/insert_into2.q.out b/ql/src/test/results/clientnegative/insert_into2.q.out
index 845d041365..b839efeb7d 100644
--- a/ql/src/test/results/clientnegative/insert_into2.q.out
+++ b/ql/src/test/results/clientnegative/insert_into2.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: CREATE TABLE insert_into1_neg (key int, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@insert_into1_neg
 POSTHOOK: query: CREATE TABLE insert_into1_neg (key int, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/insert_into3.q.out b/ql/src/test/results/clientnegative/insert_into3.q.out
index baa6d5bf2c..91aeb5b9a1 100644
--- a/ql/src/test/results/clientnegative/insert_into3.q.out
+++ b/ql/src/test/results/clientnegative/insert_into3.q.out
@@ -6,6 +6,7 @@ PREHOOK: query: CREATE TABLE insert_into3_neg (key int, value string)
   PARTITIONED BY (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@insert_into3_neg
 POSTHOOK: query: CREATE TABLE insert_into3_neg (key int, value string) 
   PARTITIONED BY (ds string)
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientnegative/insert_into4.q.out b/ql/src/test/results/clientnegative/insert_into4.q.out
index 4e7c6fc5c9..303fb6aa2e 100644
--- a/ql/src/test/results/clientnegative/insert_into4.q.out
+++ b/ql/src/test/results/clientnegative/insert_into4.q.out
@@ -6,6 +6,7 @@ PREHOOK: query: CREATE TABLE insert_into3_neg (key int, value string)
   PARTITIONED BY (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@insert_into3_neg
 POSTHOOK: query: CREATE TABLE insert_into3_neg (key int, value string) 
   PARTITIONED BY (ds string)
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientnegative/insert_into5.q.out b/ql/src/test/results/clientnegative/insert_into5.q.out
index 51bceb299e..26ad5607b7 100644
--- a/ql/src/test/results/clientnegative/insert_into5.q.out
+++ b/ql/src/test/results/clientnegative/insert_into5.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: CREATE TABLE insert_into5_neg (key int, value string) TBLPROPERTIES ("immutable"="true")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@insert_into5_neg
 POSTHOOK: query: CREATE TABLE insert_into5_neg (key int, value string) TBLPROPERTIES ("immutable"="true")
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/insert_into6.q.out b/ql/src/test/results/clientnegative/insert_into6.q.out
index 717c5d1e01..8d2145dff8 100644
--- a/ql/src/test/results/clientnegative/insert_into6.q.out
+++ b/ql/src/test/results/clientnegative/insert_into6.q.out
@@ -6,6 +6,7 @@ PREHOOK: query: CREATE TABLE insert_into6_neg (key int, value string)
   PARTITIONED BY (ds string) TBLPROPERTIES("immutable"="true")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@insert_into6_neg
 POSTHOOK: query: CREATE TABLE insert_into6_neg (key int, value string)
   PARTITIONED BY (ds string) TBLPROPERTIES("immutable"="true")
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientnegative/insertexternal1.q.out b/ql/src/test/results/clientnegative/insertexternal1.q.out
index 3df5013944..c227185348 100644
--- a/ql/src/test/results/clientnegative/insertexternal1.q.out
+++ b/ql/src/test/results/clientnegative/insertexternal1.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create external table texternal(key string, val string) partitioned by (insertdate string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@texternal
 POSTHOOK: query: create external table texternal(key string, val string) partitioned by (insertdate string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/insertover_dynapart_ifnotexists.q.out b/ql/src/test/results/clientnegative/insertover_dynapart_ifnotexists.q.out
index e46c7a672a..a40ffabba7 100644
--- a/ql/src/test/results/clientnegative/insertover_dynapart_ifnotexists.q.out
+++ b/ql/src/test/results/clientnegative/insertover_dynapart_ifnotexists.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table srcpart_dp like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcpart_dp
 POSTHOOK: query: create table srcpart_dp like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@srcpart_dp
 PREHOOK: query: create table destpart_dp like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@destpart_dp
 POSTHOOK: query: create table destpart_dp like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/invalid_cast_from_binary_1.q.out b/ql/src/test/results/clientnegative/invalid_cast_from_binary_1.q.out
index 0897a2c3aa..f2db9d2e02 100644
--- a/ql/src/test/results/clientnegative/invalid_cast_from_binary_1.q.out
+++ b/ql/src/test/results/clientnegative/invalid_cast_from_binary_1.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table tbl (a binary)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl
 POSTHOOK: query: create table tbl (a binary)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/invalid_cast_from_binary_2.q.out b/ql/src/test/results/clientnegative/invalid_cast_from_binary_2.q.out
index 0384fd93e7..41e1c803c5 100644
--- a/ql/src/test/results/clientnegative/invalid_cast_from_binary_2.q.out
+++ b/ql/src/test/results/clientnegative/invalid_cast_from_binary_2.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table tbl (a binary)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl
 POSTHOOK: query: create table tbl (a binary)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/invalid_cast_from_binary_3.q.out b/ql/src/test/results/clientnegative/invalid_cast_from_binary_3.q.out
index bd5abe7106..23e3403260 100644
--- a/ql/src/test/results/clientnegative/invalid_cast_from_binary_3.q.out
+++ b/ql/src/test/results/clientnegative/invalid_cast_from_binary_3.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table tbl (a binary)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl
 POSTHOOK: query: create table tbl (a binary)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/invalid_cast_from_binary_4.q.out b/ql/src/test/results/clientnegative/invalid_cast_from_binary_4.q.out
index 5e2df110d6..3541ef683a 100644
--- a/ql/src/test/results/clientnegative/invalid_cast_from_binary_4.q.out
+++ b/ql/src/test/results/clientnegative/invalid_cast_from_binary_4.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table tbl (a binary)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl
 POSTHOOK: query: create table tbl (a binary)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/invalid_cast_from_binary_5.q.out b/ql/src/test/results/clientnegative/invalid_cast_from_binary_5.q.out
index 58ad9ebf2d..177039c100 100644
--- a/ql/src/test/results/clientnegative/invalid_cast_from_binary_5.q.out
+++ b/ql/src/test/results/clientnegative/invalid_cast_from_binary_5.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table tbl (a binary)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl
 POSTHOOK: query: create table tbl (a binary)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/invalid_cast_from_binary_6.q.out b/ql/src/test/results/clientnegative/invalid_cast_from_binary_6.q.out
index 693034b85f..668380f32a 100644
--- a/ql/src/test/results/clientnegative/invalid_cast_from_binary_6.q.out
+++ b/ql/src/test/results/clientnegative/invalid_cast_from_binary_6.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table tbl (a binary)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl
 POSTHOOK: query: create table tbl (a binary)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/invalid_select_column.q.out b/ql/src/test/results/clientnegative/invalid_select_column.q.out
index 1ace0e9774..88bcde67f0 100644
--- a/ql/src/test/results/clientnegative/invalid_select_column.q.out
+++ b/ql/src/test/results/clientnegative/invalid_select_column.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- Create table
 create table if not exists test_invalid_column(key string, value string ) partitioned by (year string, month string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_invalid_column
 POSTHOOK: query: -- Create table
 create table if not exists test_invalid_column(key string, value string ) partitioned by (year string, month string) stored as textfile
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientnegative/invalid_select_column_with_subquery.q.out b/ql/src/test/results/clientnegative/invalid_select_column_with_subquery.q.out
index 354ed93b33..14e18c03cb 100644
--- a/ql/src/test/results/clientnegative/invalid_select_column_with_subquery.q.out
+++ b/ql/src/test/results/clientnegative/invalid_select_column_with_subquery.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- Create table
 create table if not exists test_invalid_column(key string, value string ) partitioned by (year string, month string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_invalid_column
 POSTHOOK: query: -- Create table
 create table if not exists test_invalid_column(key string, value string ) partitioned by (year string, month string) stored as textfile
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientnegative/invalid_select_column_with_tablename.q.out b/ql/src/test/results/clientnegative/invalid_select_column_with_tablename.q.out
index 226ee37c0b..5f8bd12f87 100644
--- a/ql/src/test/results/clientnegative/invalid_select_column_with_tablename.q.out
+++ b/ql/src/test/results/clientnegative/invalid_select_column_with_tablename.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- Create table
 create table if not exists test_invalid_column(key string, value string ) partitioned by (year string, month string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_invalid_column
 POSTHOOK: query: -- Create table
 create table if not exists test_invalid_column(key string, value string ) partitioned by (year string, month string) stored as textfile
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientnegative/invalid_t_alter1.q.out b/ql/src/test/results/clientnegative/invalid_t_alter1.q.out
index 232f663970..fe85e660d3 100644
--- a/ql/src/test/results/clientnegative/invalid_t_alter1.q.out
+++ b/ql/src/test/results/clientnegative/invalid_t_alter1.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE alter_test (d STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@alter_test
 POSTHOOK: query: CREATE TABLE alter_test (d STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/invalid_t_alter2.q.out b/ql/src/test/results/clientnegative/invalid_t_alter2.q.out
index 232f663970..fe85e660d3 100644
--- a/ql/src/test/results/clientnegative/invalid_t_alter2.q.out
+++ b/ql/src/test/results/clientnegative/invalid_t_alter2.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE alter_test (d STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@alter_test
 POSTHOOK: query: CREATE TABLE alter_test (d STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/invalidate_view1.q.out b/ql/src/test/results/clientnegative/invalidate_view1.q.out
index c9da48db2f..59caaafdb8 100644
--- a/ql/src/test/results/clientnegative/invalidate_view1.q.out
+++ b/ql/src/test/results/clientnegative/invalidate_view1.q.out
@@ -12,6 +12,7 @@ PREHOOK: query: -- create two levels of view reference, then invalidate intermed
 CREATE TABLE xxx10 (key int, value int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@xxx10
 POSTHOOK: query: -- create two levels of view reference, then invalidate intermediate view
 -- by dropping a column from underlying table, and verify that
 -- querying outermost view results in full error context
diff --git a/ql/src/test/results/clientnegative/join28.q.out b/ql/src/test/results/clientnegative/join28.q.out
index f3211cbc3b..e371feaff2 100644
--- a/ql/src/test/results/clientnegative/join28.q.out
+++ b/ql/src/test/results/clientnegative/join28.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest_j1(key STRING, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_j1
 POSTHOOK: query: CREATE TABLE dest_j1(key STRING, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/join29.q.out b/ql/src/test/results/clientnegative/join29.q.out
index b8b273912c..4fdf554f7e 100644
--- a/ql/src/test/results/clientnegative/join29.q.out
+++ b/ql/src/test/results/clientnegative/join29.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest_j1(key STRING, cnt1 INT, cnt2 INT)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_j1
 POSTHOOK: query: CREATE TABLE dest_j1(key STRING, cnt1 INT, cnt2 INT)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/join32.q.out b/ql/src/test/results/clientnegative/join32.q.out
index da3494be04..6281e2874e 100644
--- a/ql/src/test/results/clientnegative/join32.q.out
+++ b/ql/src/test/results/clientnegative/join32.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest_j1(key STRING, value STRING, val2 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_j1
 POSTHOOK: query: CREATE TABLE dest_j1(key STRING, value STRING, val2 STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/join35.q.out b/ql/src/test/results/clientnegative/join35.q.out
index 333c83813d..0488a8363b 100644
--- a/ql/src/test/results/clientnegative/join35.q.out
+++ b/ql/src/test/results/clientnegative/join35.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest_j1(key STRING, value STRING, val2 INT) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_j1
 POSTHOOK: query: CREATE TABLE dest_j1(key STRING, value STRING, val2 INT) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/limit_partition_stats.q.out b/ql/src/test/results/clientnegative/limit_partition_stats.q.out
index e9cc549f1d..5a5fe1fa27 100644
--- a/ql/src/test/results/clientnegative/limit_partition_stats.q.out
+++ b/ql/src/test/results/clientnegative/limit_partition_stats.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table part (c int) partitioned by (d string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part
 POSTHOOK: query: create table part (c int) partitioned by (d string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/load_exist_part_authfail.q.out b/ql/src/test/results/clientnegative/load_exist_part_authfail.q.out
index 787b1ebe04..491cfd0745 100644
--- a/ql/src/test/results/clientnegative/load_exist_part_authfail.q.out
+++ b/ql/src/test/results/clientnegative/load_exist_part_authfail.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table hive_test_src ( col1 string ) partitioned by (pcol1 string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@hive_test_src
 POSTHOOK: query: create table hive_test_src ( col1 string ) partitioned by (pcol1 string) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/load_non_native.q.out b/ql/src/test/results/clientnegative/load_non_native.q.out
index c3d5663f80..4441a88674 100644
--- a/ql/src/test/results/clientnegative/load_non_native.q.out
+++ b/ql/src/test/results/clientnegative/load_non_native.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: CREATE TABLE non_native2(key int, value string)
 STORED BY 'org.apache.hadoop.hive.ql.metadata.DefaultStorageHandler'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@non_native2
 POSTHOOK: query: CREATE TABLE non_native2(key int, value string) 
 STORED BY 'org.apache.hadoop.hive.ql.metadata.DefaultStorageHandler'
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientnegative/load_nonpart_authfail.q.out b/ql/src/test/results/clientnegative/load_nonpart_authfail.q.out
index cf48b14435..945f3ec1c2 100644
--- a/ql/src/test/results/clientnegative/load_nonpart_authfail.q.out
+++ b/ql/src/test/results/clientnegative/load_nonpart_authfail.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table hive_test_src ( col1 string ) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@hive_test_src
 POSTHOOK: query: create table hive_test_src ( col1 string ) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/load_part_authfail.q.out b/ql/src/test/results/clientnegative/load_part_authfail.q.out
index 2e896a89d5..4ea8be9631 100644
--- a/ql/src/test/results/clientnegative/load_part_authfail.q.out
+++ b/ql/src/test/results/clientnegative/load_part_authfail.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table hive_test_src ( col1 string ) partitioned by (pcol1 string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@hive_test_src
 POSTHOOK: query: create table hive_test_src ( col1 string ) partitioned by (pcol1 string) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/load_part_nospec.q.out b/ql/src/test/results/clientnegative/load_part_nospec.q.out
index 9331a1c8c2..bebaf92311 100644
--- a/ql/src/test/results/clientnegative/load_part_nospec.q.out
+++ b/ql/src/test/results/clientnegative/load_part_nospec.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table hive_test_src ( col1 string ) partitioned by (pcol1 string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@hive_test_src
 POSTHOOK: query: create table hive_test_src ( col1 string ) partitioned by (pcol1 string) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/load_stored_as_dirs.q.out b/ql/src/test/results/clientnegative/load_stored_as_dirs.q.out
index b89027f60a..22d4ee806b 100644
--- a/ql/src/test/results/clientnegative/load_stored_as_dirs.q.out
+++ b/ql/src/test/results/clientnegative/load_stored_as_dirs.q.out
@@ -3,6 +3,7 @@ CREATE TABLE  if not exists stored_as_dirs_multiple (col1 STRING, col2 int, col3
 SKEWED BY (col1, col2) ON (('s1',1), ('s3',3), ('s13',13), ('s78',78))  stored as DIRECTORIES
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@stored_as_dirs_multiple
 POSTHOOK: query: -- Load data can't work with table with stored as directories
 CREATE TABLE  if not exists stored_as_dirs_multiple (col1 STRING, col2 int, col3 STRING) 
 SKEWED BY (col1, col2) ON (('s1',1), ('s3',3), ('s13',13), ('s78',78))  stored as DIRECTORIES
diff --git a/ql/src/test/results/clientnegative/load_wrong_fileformat.q.out b/ql/src/test/results/clientnegative/load_wrong_fileformat.q.out
index 628841c4e5..732eb22a0b 100644
--- a/ql/src/test/results/clientnegative/load_wrong_fileformat.q.out
+++ b/ql/src/test/results/clientnegative/load_wrong_fileformat.q.out
@@ -5,6 +5,7 @@ PREHOOK: query: -- test for loading into tables with the correct file format
 CREATE TABLE load_wrong_fileformat_T1(name STRING) STORED AS SEQUENCEFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@load_wrong_fileformat_T1
 POSTHOOK: query: -- test for loading into tables with the correct file format
 -- test for loading into partitions with the correct file format
 
diff --git a/ql/src/test/results/clientnegative/load_wrong_fileformat_rc_seq.q.out b/ql/src/test/results/clientnegative/load_wrong_fileformat_rc_seq.q.out
index e94200b910..b68b8e665b 100644
--- a/ql/src/test/results/clientnegative/load_wrong_fileformat_rc_seq.q.out
+++ b/ql/src/test/results/clientnegative/load_wrong_fileformat_rc_seq.q.out
@@ -5,6 +5,7 @@ PREHOOK: query: -- test for loading into tables with the correct file format
 CREATE TABLE T1(name STRING) STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: -- test for loading into tables with the correct file format
 -- test for loading into partitions with the correct file format
 
diff --git a/ql/src/test/results/clientnegative/load_wrong_fileformat_txt_seq.q.out b/ql/src/test/results/clientnegative/load_wrong_fileformat_txt_seq.q.out
index eb42478f21..179a654808 100644
--- a/ql/src/test/results/clientnegative/load_wrong_fileformat_txt_seq.q.out
+++ b/ql/src/test/results/clientnegative/load_wrong_fileformat_txt_seq.q.out
@@ -5,6 +5,7 @@ PREHOOK: query: -- test for loading into tables with the correct file format
 CREATE TABLE T1(name STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: -- test for loading into tables with the correct file format
 -- test for loading into partitions with the correct file format
 
diff --git a/ql/src/test/results/clientnegative/load_wrong_noof_part.q.out b/ql/src/test/results/clientnegative/load_wrong_noof_part.q.out
index 80e80e33fa..cf11cdc136 100644
--- a/ql/src/test/results/clientnegative/load_wrong_noof_part.q.out
+++ b/ql/src/test/results/clientnegative/load_wrong_noof_part.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE loadpart1(a STRING, b STRING) PARTITIONED BY (ds STRING,ds1 STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@loadpart1
 POSTHOOK: query: CREATE TABLE loadpart1(a STRING, b STRING) PARTITIONED BY (ds STRING,ds1 STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/lockneg1.q.out b/ql/src/test/results/clientnegative/lockneg1.q.out
index c8f514d6c7..3a96cda24b 100644
--- a/ql/src/test/results/clientnegative/lockneg1.q.out
+++ b/ql/src/test/results/clientnegative/lockneg1.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table tstsrc like src
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tstsrc
 POSTHOOK: query: create table tstsrc like src
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/lockneg2.q.out b/ql/src/test/results/clientnegative/lockneg2.q.out
index 33a1f0bf01..31e9087e74 100644
--- a/ql/src/test/results/clientnegative/lockneg2.q.out
+++ b/ql/src/test/results/clientnegative/lockneg2.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table tstsrc like src
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tstsrc
 POSTHOOK: query: create table tstsrc like src
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/lockneg3.q.out b/ql/src/test/results/clientnegative/lockneg3.q.out
index 1173abad7d..e4f635731d 100644
--- a/ql/src/test/results/clientnegative/lockneg3.q.out
+++ b/ql/src/test/results/clientnegative/lockneg3.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table tstsrcpart like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tstsrcpart
 POSTHOOK: query: create table tstsrcpart like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/lockneg4.q.out b/ql/src/test/results/clientnegative/lockneg4.q.out
index a10250470e..c31a23c152 100644
--- a/ql/src/test/results/clientnegative/lockneg4.q.out
+++ b/ql/src/test/results/clientnegative/lockneg4.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table tstsrcpart like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tstsrcpart
 POSTHOOK: query: create table tstsrcpart like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/lockneg_query_tbl_in_locked_db.q.out b/ql/src/test/results/clientnegative/lockneg_query_tbl_in_locked_db.q.out
index cf19740c2c..134a57b646 100644
--- a/ql/src/test/results/clientnegative/lockneg_query_tbl_in_locked_db.q.out
+++ b/ql/src/test/results/clientnegative/lockneg_query_tbl_in_locked_db.q.out
@@ -1,14 +1,19 @@
 PREHOOK: query: create database lockneg1
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:lockneg1
 POSTHOOK: query: create database lockneg1
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:lockneg1
 PREHOOK: query: use lockneg1
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:lockneg1
 POSTHOOK: query: use lockneg1
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:lockneg1
 PREHOOK: query: create table tstsrcpart like default.srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:lockneg1
+PREHOOK: Output: lockneg1@tstsrcpart
 POSTHOOK: query: create table tstsrcpart like default.srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:lockneg1
diff --git a/ql/src/test/results/clientnegative/lockneg_try_db_lock_conflict.q.out b/ql/src/test/results/clientnegative/lockneg_try_db_lock_conflict.q.out
index 92d744762f..0a5d98a619 100644
--- a/ql/src/test/results/clientnegative/lockneg_try_db_lock_conflict.q.out
+++ b/ql/src/test/results/clientnegative/lockneg_try_db_lock_conflict.q.out
@@ -1,7 +1,9 @@
 PREHOOK: query: create database lockneg4
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:lockneg4
 POSTHOOK: query: create database lockneg4
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:lockneg4
 PREHOOK: query: lock database lockneg4 exclusive
 PREHOOK: type: LOCKDATABASE
 POSTHOOK: query: lock database lockneg4 exclusive
diff --git a/ql/src/test/results/clientnegative/lockneg_try_drop_locked_db.q.out b/ql/src/test/results/clientnegative/lockneg_try_drop_locked_db.q.out
index 2fcff1bd03..5ac4e3cda4 100644
--- a/ql/src/test/results/clientnegative/lockneg_try_drop_locked_db.q.out
+++ b/ql/src/test/results/clientnegative/lockneg_try_drop_locked_db.q.out
@@ -1,7 +1,9 @@
 PREHOOK: query: create database lockneg9
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:lockneg9
 POSTHOOK: query: create database lockneg9
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:lockneg9
 PREHOOK: query: lock database lockneg9 shared
 PREHOOK: type: LOCKDATABASE
 POSTHOOK: query: lock database lockneg9 shared
diff --git a/ql/src/test/results/clientnegative/lockneg_try_lock_db_in_use.q.out b/ql/src/test/results/clientnegative/lockneg_try_lock_db_in_use.q.out
index 02423381d8..97ab37a96c 100644
--- a/ql/src/test/results/clientnegative/lockneg_try_lock_db_in_use.q.out
+++ b/ql/src/test/results/clientnegative/lockneg_try_lock_db_in_use.q.out
@@ -1,14 +1,19 @@
 PREHOOK: query: create database lockneg2
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:lockneg2
 POSTHOOK: query: create database lockneg2
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:lockneg2
 PREHOOK: query: use lockneg2
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:lockneg2
 POSTHOOK: query: use lockneg2
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:lockneg2
 PREHOOK: query: create table tstsrcpart like default.srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:lockneg2
+PREHOOK: Output: lockneg2@tstsrcpart
 POSTHOOK: query: create table tstsrcpart like default.srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:lockneg2
diff --git a/ql/src/test/results/clientnegative/merge_negative_1.q.out b/ql/src/test/results/clientnegative/merge_negative_1.q.out
index e7bb8283d0..039a953481 100644
--- a/ql/src/test/results/clientnegative/merge_negative_1.q.out
+++ b/ql/src/test/results/clientnegative/merge_negative_1.q.out
@@ -1,13 +1,16 @@
 PREHOOK: query: create table src2 like src
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src2
 POSTHOOK: query: create table src2 like src
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@src2
 PREHOOK: query: CREATE INDEX src_index_merge_test ON TABLE src2(key) as 'COMPACT' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@src2
 POSTHOOK: query: CREATE INDEX src_index_merge_test ON TABLE src2(key) as 'COMPACT' WITH DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@src2
 POSTHOOK: Output: default@default__src2_src_index_merge_test__
 FAILED: SemanticException org.apache.hadoop.hive.ql.parse.SemanticException: can not do merge because source table default.src2 is indexed.
diff --git a/ql/src/test/results/clientnegative/merge_negative_2.q.out b/ql/src/test/results/clientnegative/merge_negative_2.q.out
index b75bff985b..04113ab152 100644
--- a/ql/src/test/results/clientnegative/merge_negative_2.q.out
+++ b/ql/src/test/results/clientnegative/merge_negative_2.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table srcpart2 (key int, value string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcpart2
 POSTHOOK: query: create table srcpart2 (key int, value string) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/merge_negative_3.q.out b/ql/src/test/results/clientnegative/merge_negative_3.q.out
index 6fd029eb68..906336d4d3 100644
--- a/ql/src/test/results/clientnegative/merge_negative_3.q.out
+++ b/ql/src/test/results/clientnegative/merge_negative_3.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table srcpart2 (key int, value string) partitioned by (ds string) clustered by (key) sorted by (key) into 2 buckets stored as RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcpart2
 POSTHOOK: query: create table srcpart2 (key int, value string) partitioned by (ds string) clustered by (key) sorted by (key) into 2 buckets stored as RCFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/nested_complex_neg.q.out b/ql/src/test/results/clientnegative/nested_complex_neg.q.out
index 59b554894e..a6f9ac5dac 100644
--- a/ql/src/test/results/clientnegative/nested_complex_neg.q.out
+++ b/ql/src/test/results/clientnegative/nested_complex_neg.q.out
@@ -6,4 +6,5 @@ max_nested_struct array<array<array<array<array<array<array<array<array<array<ar
 simple_string string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@nestedcomplex
 FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask. java.lang.RuntimeException: MetaException(message:org.apache.hadoop.hive.serde2.SerDeException Number of levels of nesting supported for LazySimpleSerde is 7 Unable to work with level 23. Use hive.serialization.extend.nesting.levels serde property for tables using LazySimpleSerde.)
diff --git a/ql/src/test/results/clientnegative/nopart_insert.q.out b/ql/src/test/results/clientnegative/nopart_insert.q.out
index f3d6a0ac6c..68aa500636 100644
--- a/ql/src/test/results/clientnegative/nopart_insert.q.out
+++ b/ql/src/test/results/clientnegative/nopart_insert.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE nopart_insert(a STRING, b STRING) PARTITIONED BY (ds STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@nopart_insert
 POSTHOOK: query: CREATE TABLE nopart_insert(a STRING, b STRING) PARTITIONED BY (ds STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/nopart_load.q.out b/ql/src/test/results/clientnegative/nopart_load.q.out
index 34637e4314..881514640c 100644
--- a/ql/src/test/results/clientnegative/nopart_load.q.out
+++ b/ql/src/test/results/clientnegative/nopart_load.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE nopart_load(a STRING, b STRING) PARTITIONED BY (ds STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@nopart_load
 POSTHOOK: query: CREATE TABLE nopart_load(a STRING, b STRING) PARTITIONED BY (ds STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/orc_merge1.q.out b/ql/src/test/results/clientnegative/orc_merge1.q.out
index 3ce84037e7..acf29692bf 100644
--- a/ql/src/test/results/clientnegative/orc_merge1.q.out
+++ b/ql/src/test/results/clientnegative/orc_merge1.q.out
@@ -6,6 +6,7 @@ PREHOOK: query: CREATE TABLE orcfile_merge (key INT, value STRING)
     PARTITIONED BY (ds STRING, part STRING) STORED AS ORC
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@orcfile_merge
 POSTHOOK: query: CREATE TABLE orcfile_merge (key INT, value STRING)
     PARTITIONED BY (ds STRING, part STRING) STORED AS ORC
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientnegative/orc_merge2.q.out b/ql/src/test/results/clientnegative/orc_merge2.q.out
index 3c5a52cf7b..3775c77917 100644
--- a/ql/src/test/results/clientnegative/orc_merge2.q.out
+++ b/ql/src/test/results/clientnegative/orc_merge2.q.out
@@ -6,6 +6,7 @@ PREHOOK: query: CREATE TABLE orcfile_merge (key INT, value STRING)
     PARTITIONED BY (ds STRING, part STRING) STORED AS ORC
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@orcfile_merge
 POSTHOOK: query: CREATE TABLE orcfile_merge (key INT, value STRING)
     PARTITIONED BY (ds STRING, part STRING) STORED AS ORC
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientnegative/orc_merge3.q.out b/ql/src/test/results/clientnegative/orc_merge3.q.out
index 2895bb037a..592485f7e9 100644
--- a/ql/src/test/results/clientnegative/orc_merge3.q.out
+++ b/ql/src/test/results/clientnegative/orc_merge3.q.out
@@ -6,6 +6,7 @@ PREHOOK: query: CREATE TABLE orcfile_merge (key INT, value STRING)
     PARTITIONED BY (ds STRING, part STRING) STORED AS ORC
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@orcfile_merge
 POSTHOOK: query: CREATE TABLE orcfile_merge (key INT, value STRING)
     PARTITIONED BY (ds STRING, part STRING) STORED AS ORC
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientnegative/orc_merge4.q.out b/ql/src/test/results/clientnegative/orc_merge4.q.out
index f76e1a3725..ba54295217 100644
--- a/ql/src/test/results/clientnegative/orc_merge4.q.out
+++ b/ql/src/test/results/clientnegative/orc_merge4.q.out
@@ -6,6 +6,7 @@ PREHOOK: query: CREATE TABLE orcfile_merge (key INT, value STRING)
     PARTITIONED BY (ds STRING, part STRING) STORED AS ORC
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@orcfile_merge
 POSTHOOK: query: CREATE TABLE orcfile_merge (key INT, value STRING)
     PARTITIONED BY (ds STRING, part STRING) STORED AS ORC
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientnegative/orc_merge5.q.out b/ql/src/test/results/clientnegative/orc_merge5.q.out
index 171e46ebc9..a95b4247bf 100644
--- a/ql/src/test/results/clientnegative/orc_merge5.q.out
+++ b/ql/src/test/results/clientnegative/orc_merge5.q.out
@@ -6,6 +6,7 @@ PREHOOK: query: CREATE TABLE orcfile_merge (key INT, value STRING)
     PARTITIONED BY (ds STRING, part STRING) STORED AS ORC
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@orcfile_merge
 POSTHOOK: query: CREATE TABLE orcfile_merge (key INT, value STRING)
     PARTITIONED BY (ds STRING, part STRING) STORED AS ORC
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientnegative/orderbysortby.q.out b/ql/src/test/results/clientnegative/orderbysortby.q.out
index 14999cd3eb..e62a8508eb 100644
--- a/ql/src/test/results/clientnegative/orderbysortby.q.out
+++ b/ql/src/test/results/clientnegative/orderbysortby.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key INT, ten INT, one INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key INT, ten INT, one INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/parquet_char.q.out b/ql/src/test/results/clientnegative/parquet_char.q.out
index eeaf33b3cc..8c9a52c634 100644
--- a/ql/src/test/results/clientnegative/parquet_char.q.out
+++ b/ql/src/test/results/clientnegative/parquet_char.q.out
@@ -5,4 +5,5 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table parquet_char (t char(10)) stored as parquet
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@parquet_char
 FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask. java.lang.UnsupportedOperationException: Parquet does not support char. See HIVE-6384
diff --git a/ql/src/test/results/clientnegative/parquet_date.q.out b/ql/src/test/results/clientnegative/parquet_date.q.out
index 39d56e4c4b..d1c38d64bc 100644
--- a/ql/src/test/results/clientnegative/parquet_date.q.out
+++ b/ql/src/test/results/clientnegative/parquet_date.q.out
@@ -5,4 +5,5 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table parquet_date (t date) stored as parquet
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@parquet_date
 FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask. java.lang.UnsupportedOperationException: Parquet does not support date. See HIVE-6384
diff --git a/ql/src/test/results/clientnegative/parquet_varchar.q.out b/ql/src/test/results/clientnegative/parquet_varchar.q.out
index c03a5b6bc9..90f6db2596 100644
--- a/ql/src/test/results/clientnegative/parquet_varchar.q.out
+++ b/ql/src/test/results/clientnegative/parquet_varchar.q.out
@@ -5,4 +5,5 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table parquet_varchar (t varchar(10)) stored as parquet
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@parquet_varchar
 FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask. java.lang.UnsupportedOperationException: Parquet does not support varchar. See HIVE-6384
diff --git a/ql/src/test/results/clientnegative/protectmode_part.q.out b/ql/src/test/results/clientnegative/protectmode_part.q.out
index 41cc5f964d..791fec284c 100644
--- a/ql/src/test/results/clientnegative/protectmode_part.q.out
+++ b/ql/src/test/results/clientnegative/protectmode_part.q.out
@@ -9,6 +9,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table tbl_protectmode3  (col string) partitioned by (p string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl_protectmode3
 POSTHOOK: query: create table tbl_protectmode3  (col string) partitioned by (p string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/protectmode_part1.q.out b/ql/src/test/results/clientnegative/protectmode_part1.q.out
index bf5a2b7b7e..6405888d38 100644
--- a/ql/src/test/results/clientnegative/protectmode_part1.q.out
+++ b/ql/src/test/results/clientnegative/protectmode_part1.q.out
@@ -9,6 +9,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table tbl_protectmode5_1 (col string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl_protectmode5_1
 POSTHOOK: query: create table tbl_protectmode5_1 (col string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -16,6 +17,7 @@ POSTHOOK: Output: default@tbl_protectmode5_1
 PREHOOK: query: create table tbl_protectmode5  (col string) partitioned by (p string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl_protectmode5
 POSTHOOK: query: create table tbl_protectmode5  (col string) partitioned by (p string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/protectmode_part2.q.out b/ql/src/test/results/clientnegative/protectmode_part2.q.out
index c2ab670d55..16d58c74d0 100644
--- a/ql/src/test/results/clientnegative/protectmode_part2.q.out
+++ b/ql/src/test/results/clientnegative/protectmode_part2.q.out
@@ -9,6 +9,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table tbl_protectmode6  (c1 string,c2 string) partitioned by (p string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl_protectmode6
 POSTHOOK: query: create table tbl_protectmode6  (c1 string,c2 string) partitioned by (p string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/protectmode_part_no_drop.q.out b/ql/src/test/results/clientnegative/protectmode_part_no_drop.q.out
index 857dafdd2e..84fa5737e9 100644
--- a/ql/src/test/results/clientnegative/protectmode_part_no_drop.q.out
+++ b/ql/src/test/results/clientnegative/protectmode_part_no_drop.q.out
@@ -9,6 +9,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table tbl_protectmode_no_drop  (c1 string,c2 string) partitioned by (p string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl_protectmode_no_drop
 POSTHOOK: query: create table tbl_protectmode_no_drop  (c1 string,c2 string) partitioned by (p string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/protectmode_tbl1.q.out b/ql/src/test/results/clientnegative/protectmode_tbl1.q.out
index 0d6b0ff89f..8a2ebf5f45 100644
--- a/ql/src/test/results/clientnegative/protectmode_tbl1.q.out
+++ b/ql/src/test/results/clientnegative/protectmode_tbl1.q.out
@@ -9,6 +9,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table tbl_protectmode_1  (col string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl_protectmode_1
 POSTHOOK: query: create table tbl_protectmode_1  (col string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/protectmode_tbl2.q.out b/ql/src/test/results/clientnegative/protectmode_tbl2.q.out
index 7d600d2343..d94a341a7a 100644
--- a/ql/src/test/results/clientnegative/protectmode_tbl2.q.out
+++ b/ql/src/test/results/clientnegative/protectmode_tbl2.q.out
@@ -9,6 +9,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table tbl_protectmode2  (col string) partitioned by (p string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl_protectmode2
 POSTHOOK: query: create table tbl_protectmode2  (col string) partitioned by (p string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/protectmode_tbl3.q.out b/ql/src/test/results/clientnegative/protectmode_tbl3.q.out
index fd4ddcbe0b..1c4fe31c22 100644
--- a/ql/src/test/results/clientnegative/protectmode_tbl3.q.out
+++ b/ql/src/test/results/clientnegative/protectmode_tbl3.q.out
@@ -9,6 +9,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table tbl_protectmode_4  (col string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl_protectmode_4
 POSTHOOK: query: create table tbl_protectmode_4  (col string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/protectmode_tbl4.q.out b/ql/src/test/results/clientnegative/protectmode_tbl4.q.out
index 2c4dc6c9ea..c820884c81 100644
--- a/ql/src/test/results/clientnegative/protectmode_tbl4.q.out
+++ b/ql/src/test/results/clientnegative/protectmode_tbl4.q.out
@@ -13,6 +13,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table tbl_protectmode_tbl4_src (col string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl_protectmode_tbl4_src
 POSTHOOK: query: create table tbl_protectmode_tbl4_src (col string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -20,6 +21,7 @@ POSTHOOK: Output: default@tbl_protectmode_tbl4_src
 PREHOOK: query: create table tbl_protectmode_tbl4  (col string) partitioned by (p string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl_protectmode_tbl4
 POSTHOOK: query: create table tbl_protectmode_tbl4  (col string) partitioned by (p string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/protectmode_tbl5.q.out b/ql/src/test/results/clientnegative/protectmode_tbl5.q.out
index bc5e9d37b3..6f991073b2 100644
--- a/ql/src/test/results/clientnegative/protectmode_tbl5.q.out
+++ b/ql/src/test/results/clientnegative/protectmode_tbl5.q.out
@@ -13,6 +13,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table tbl_protectmode_tbl5_src (col string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl_protectmode_tbl5_src
 POSTHOOK: query: create table tbl_protectmode_tbl5_src (col string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -20,6 +21,7 @@ POSTHOOK: Output: default@tbl_protectmode_tbl5_src
 PREHOOK: query: create table tbl_protectmode_tbl5  (col string) partitioned by (p string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl_protectmode_tbl5
 POSTHOOK: query: create table tbl_protectmode_tbl5  (col string) partitioned by (p string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/protectmode_tbl6.q.out b/ql/src/test/results/clientnegative/protectmode_tbl6.q.out
index d38a05be15..65b10de06c 100644
--- a/ql/src/test/results/clientnegative/protectmode_tbl6.q.out
+++ b/ql/src/test/results/clientnegative/protectmode_tbl6.q.out
@@ -9,6 +9,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table tbl_protectmode_tbl6 (col string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl_protectmode_tbl6
 POSTHOOK: query: create table tbl_protectmode_tbl6 (col string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/protectmode_tbl7.q.out b/ql/src/test/results/clientnegative/protectmode_tbl7.q.out
index dd40c8d608..0a0e07dcb8 100644
--- a/ql/src/test/results/clientnegative/protectmode_tbl7.q.out
+++ b/ql/src/test/results/clientnegative/protectmode_tbl7.q.out
@@ -9,6 +9,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table tbl_protectmode_tbl7  (col string) partitioned by (p string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl_protectmode_tbl7
 POSTHOOK: query: create table tbl_protectmode_tbl7  (col string) partitioned by (p string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/protectmode_tbl8.q.out b/ql/src/test/results/clientnegative/protectmode_tbl8.q.out
index 3f312a6a9f..443ec87402 100644
--- a/ql/src/test/results/clientnegative/protectmode_tbl8.q.out
+++ b/ql/src/test/results/clientnegative/protectmode_tbl8.q.out
@@ -9,6 +9,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table tbl_protectmode_tbl8  (col string) partitioned by (p string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl_protectmode_tbl8
 POSTHOOK: query: create table tbl_protectmode_tbl8  (col string) partitioned by (p string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/protectmode_tbl_no_drop.q.out b/ql/src/test/results/clientnegative/protectmode_tbl_no_drop.q.out
index ac0d794891..10574346b0 100644
--- a/ql/src/test/results/clientnegative/protectmode_tbl_no_drop.q.out
+++ b/ql/src/test/results/clientnegative/protectmode_tbl_no_drop.q.out
@@ -9,6 +9,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table tbl_protectmode__no_drop  (col string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl_protectmode__no_drop
 POSTHOOK: query: create table tbl_protectmode__no_drop  (col string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/ptf_negative_AggrFuncsWithNoGBYNoPartDef.q.out b/ql/src/test/results/clientnegative/ptf_negative_AggrFuncsWithNoGBYNoPartDef.q.out
index a19f7e6496..896a1348c0 100644
--- a/ql/src/test/results/clientnegative/ptf_negative_AggrFuncsWithNoGBYNoPartDef.q.out
+++ b/ql/src/test/results/clientnegative/ptf_negative_AggrFuncsWithNoGBYNoPartDef.q.out
@@ -15,6 +15,7 @@ PREHOOK: query: CREATE TABLE part(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part
 POSTHOOK: query: CREATE TABLE part( 
     p_partkey INT,
     p_name STRING,
diff --git a/ql/src/test/results/clientnegative/ptf_negative_AmbiguousWindowDefn.q.out b/ql/src/test/results/clientnegative/ptf_negative_AmbiguousWindowDefn.q.out
index 0ec7ac14bd..a23080566e 100644
--- a/ql/src/test/results/clientnegative/ptf_negative_AmbiguousWindowDefn.q.out
+++ b/ql/src/test/results/clientnegative/ptf_negative_AmbiguousWindowDefn.q.out
@@ -15,6 +15,7 @@ PREHOOK: query: CREATE TABLE part(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part
 POSTHOOK: query: CREATE TABLE part( 
     p_partkey INT,
     p_name STRING,
diff --git a/ql/src/test/results/clientnegative/ptf_negative_DistributeByOrderBy.q.out b/ql/src/test/results/clientnegative/ptf_negative_DistributeByOrderBy.q.out
index 66122a3fef..23b36b10fe 100644
--- a/ql/src/test/results/clientnegative/ptf_negative_DistributeByOrderBy.q.out
+++ b/ql/src/test/results/clientnegative/ptf_negative_DistributeByOrderBy.q.out
@@ -15,6 +15,7 @@ PREHOOK: query: CREATE TABLE part(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part
 POSTHOOK: query: CREATE TABLE part( 
     p_partkey INT,
     p_name STRING,
diff --git a/ql/src/test/results/clientnegative/ptf_negative_DuplicateWindowAlias.q.out b/ql/src/test/results/clientnegative/ptf_negative_DuplicateWindowAlias.q.out
index 4713de3cd0..137b7ef38f 100644
--- a/ql/src/test/results/clientnegative/ptf_negative_DuplicateWindowAlias.q.out
+++ b/ql/src/test/results/clientnegative/ptf_negative_DuplicateWindowAlias.q.out
@@ -15,6 +15,7 @@ PREHOOK: query: CREATE TABLE part(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part
 POSTHOOK: query: CREATE TABLE part( 
     p_partkey INT,
     p_name STRING,
diff --git a/ql/src/test/results/clientnegative/ptf_negative_HavingLeadWithNoGBYNoWindowing.q.out b/ql/src/test/results/clientnegative/ptf_negative_HavingLeadWithNoGBYNoWindowing.q.out
index 460d7ae734..863ff2f976 100644
--- a/ql/src/test/results/clientnegative/ptf_negative_HavingLeadWithNoGBYNoWindowing.q.out
+++ b/ql/src/test/results/clientnegative/ptf_negative_HavingLeadWithNoGBYNoWindowing.q.out
@@ -15,6 +15,7 @@ PREHOOK: query: CREATE TABLE part(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part
 POSTHOOK: query: CREATE TABLE part( 
     p_partkey INT,
     p_name STRING,
diff --git a/ql/src/test/results/clientnegative/ptf_negative_HavingLeadWithPTF.q.out b/ql/src/test/results/clientnegative/ptf_negative_HavingLeadWithPTF.q.out
index 460d7ae734..863ff2f976 100644
--- a/ql/src/test/results/clientnegative/ptf_negative_HavingLeadWithPTF.q.out
+++ b/ql/src/test/results/clientnegative/ptf_negative_HavingLeadWithPTF.q.out
@@ -15,6 +15,7 @@ PREHOOK: query: CREATE TABLE part(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part
 POSTHOOK: query: CREATE TABLE part( 
     p_partkey INT,
     p_name STRING,
diff --git a/ql/src/test/results/clientnegative/ptf_negative_InvalidValueBoundary.q.out b/ql/src/test/results/clientnegative/ptf_negative_InvalidValueBoundary.q.out
index 5944c1fe4c..4c3b42ff93 100644
--- a/ql/src/test/results/clientnegative/ptf_negative_InvalidValueBoundary.q.out
+++ b/ql/src/test/results/clientnegative/ptf_negative_InvalidValueBoundary.q.out
@@ -16,6 +16,7 @@ PREHOOK: query: CREATE TABLE part(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part
 POSTHOOK: query: CREATE TABLE part( 
     p_partkey INT,
     p_name STRING,
diff --git a/ql/src/test/results/clientnegative/ptf_negative_JoinWithAmbigousAlias.q.out b/ql/src/test/results/clientnegative/ptf_negative_JoinWithAmbigousAlias.q.out
index e939344178..2bebf0a5aa 100644
--- a/ql/src/test/results/clientnegative/ptf_negative_JoinWithAmbigousAlias.q.out
+++ b/ql/src/test/results/clientnegative/ptf_negative_JoinWithAmbigousAlias.q.out
@@ -15,6 +15,7 @@ PREHOOK: query: CREATE TABLE part(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part
 POSTHOOK: query: CREATE TABLE part( 
     p_partkey INT,
     p_name STRING,
diff --git a/ql/src/test/results/clientnegative/ptf_negative_PartitionBySortBy.q.out b/ql/src/test/results/clientnegative/ptf_negative_PartitionBySortBy.q.out
index e1771dfc79..38dfd73b40 100644
--- a/ql/src/test/results/clientnegative/ptf_negative_PartitionBySortBy.q.out
+++ b/ql/src/test/results/clientnegative/ptf_negative_PartitionBySortBy.q.out
@@ -15,6 +15,7 @@ PREHOOK: query: CREATE TABLE part(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part
 POSTHOOK: query: CREATE TABLE part( 
     p_partkey INT,
     p_name STRING,
diff --git a/ql/src/test/results/clientnegative/ptf_negative_WhereWithRankCond.q.out b/ql/src/test/results/clientnegative/ptf_negative_WhereWithRankCond.q.out
index d2f4eaa4a9..f75cd1817d 100644
--- a/ql/src/test/results/clientnegative/ptf_negative_WhereWithRankCond.q.out
+++ b/ql/src/test/results/clientnegative/ptf_negative_WhereWithRankCond.q.out
@@ -15,6 +15,7 @@ PREHOOK: query: CREATE TABLE part(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part
 POSTHOOK: query: CREATE TABLE part( 
     p_partkey INT,
     p_name STRING,
diff --git a/ql/src/test/results/clientnegative/ptf_window_boundaries.q.out b/ql/src/test/results/clientnegative/ptf_window_boundaries.q.out
index 477a1ca8a1..a183240634 100644
--- a/ql/src/test/results/clientnegative/ptf_window_boundaries.q.out
+++ b/ql/src/test/results/clientnegative/ptf_window_boundaries.q.out
@@ -12,6 +12,7 @@ CREATE TABLE part(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part
 POSTHOOK: query: -- data setup
 CREATE TABLE part( 
     p_partkey INT,
diff --git a/ql/src/test/results/clientnegative/ptf_window_boundaries2.q.out b/ql/src/test/results/clientnegative/ptf_window_boundaries2.q.out
index 6dcc0fa49c..f5a9561009 100644
--- a/ql/src/test/results/clientnegative/ptf_window_boundaries2.q.out
+++ b/ql/src/test/results/clientnegative/ptf_window_boundaries2.q.out
@@ -12,6 +12,7 @@ CREATE TABLE part(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part
 POSTHOOK: query: -- data setup
 CREATE TABLE part( 
     p_partkey INT,
diff --git a/ql/src/test/results/clientnegative/recursive_view.q.out b/ql/src/test/results/clientnegative/recursive_view.q.out
index fdc5dc8eb5..9dc22d3083 100644
--- a/ql/src/test/results/clientnegative/recursive_view.q.out
+++ b/ql/src/test/results/clientnegative/recursive_view.q.out
@@ -25,6 +25,7 @@ POSTHOOK: type: DROPVIEW
 PREHOOK: query: create table t (id int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t
 POSTHOOK: query: create table t (id int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/sa_fail_hook3.q.out b/ql/src/test/results/clientnegative/sa_fail_hook3.q.out
index ecc76fbd14..38b2ba1817 100644
--- a/ql/src/test/results/clientnegative/sa_fail_hook3.q.out
+++ b/ql/src/test/results/clientnegative/sa_fail_hook3.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table mp2 (a string) partitioned by (b string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@mp2
 POSTHOOK: query: create table mp2 (a string) partitioned by (b string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/serde_regex.q.out b/ql/src/test/results/clientnegative/serde_regex.q.out
index efe40d4221..fc29724b6b 100644
--- a/ql/src/test/results/clientnegative/serde_regex.q.out
+++ b/ql/src/test/results/clientnegative/serde_regex.q.out
@@ -1,7 +1,9 @@
 PREHOOK: query: USE default
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:default
 POSTHOOK: query: USE default
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:default
 PREHOOK: query: --  This should fail because Regex SerDe doesn't support STRUCT
 CREATE TABLE serde_regex(
   host STRING,
@@ -20,4 +22,5 @@ WITH SERDEPROPERTIES (
 STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@serde_regex
 FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask. java.lang.RuntimeException: MetaException(message:org.apache.hadoop.hive.serde2.SerDeException org.apache.hadoop.hive.serde2.RegexSerDe doesn't allow column [9] named strct with type struct<a:int,b:string>)
diff --git a/ql/src/test/results/clientnegative/serde_regex2.q.out b/ql/src/test/results/clientnegative/serde_regex2.q.out
index 8ed0bee0e7..198f79bb37 100644
--- a/ql/src/test/results/clientnegative/serde_regex2.q.out
+++ b/ql/src/test/results/clientnegative/serde_regex2.q.out
@@ -1,7 +1,9 @@
 PREHOOK: query: USE default
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:default
 POSTHOOK: query: USE default
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:default
 PREHOOK: query: -- Mismatch between the number of matching groups and columns, throw run time exception. Ideally this should throw a compile time exception. See JIRA-3023 for more details.
  CREATE TABLE serde_regex(
   host STRING,
@@ -20,6 +22,7 @@ WITH SERDEPROPERTIES (
 STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@serde_regex
 POSTHOOK: query: -- Mismatch between the number of matching groups and columns, throw run time exception. Ideally this should throw a compile time exception. See JIRA-3023 for more details.
  CREATE TABLE serde_regex(
   host STRING,
diff --git a/ql/src/test/results/clientnegative/serde_regex3.q.out b/ql/src/test/results/clientnegative/serde_regex3.q.out
index 4eea70452a..1df4cd6748 100644
--- a/ql/src/test/results/clientnegative/serde_regex3.q.out
+++ b/ql/src/test/results/clientnegative/serde_regex3.q.out
@@ -1,7 +1,9 @@
 PREHOOK: query: USE default
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:default
 POSTHOOK: query: USE default
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:default
 PREHOOK: query: -- null input.regex, raise an exception
  CREATE TABLE serde_regex(
   host STRING,
@@ -17,4 +19,5 @@ ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.RegexSerDe'
 STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@serde_regex
 FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask. java.lang.RuntimeException: MetaException(message:org.apache.hadoop.hive.serde2.SerDeException This table does not have serde property "input.regex"!)
diff --git a/ql/src/test/results/clientnegative/set_table_property.q.out b/ql/src/test/results/clientnegative/set_table_property.q.out
index 0e449193e4..2278456166 100644
--- a/ql/src/test/results/clientnegative/set_table_property.q.out
+++ b/ql/src/test/results/clientnegative/set_table_property.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table testTable(col1 int, col2 int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@testTable
 POSTHOOK: query: create table testTable(col1 int, col2 int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/show_columns3.q.out b/ql/src/test/results/clientnegative/show_columns3.q.out
index 4479fd0eaf..a84dedb5d1 100644
--- a/ql/src/test/results/clientnegative/show_columns3.q.out
+++ b/ql/src/test/results/clientnegative/show_columns3.q.out
@@ -1,20 +1,27 @@
 PREHOOK: query: CREATE DATABASE test_db
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:test_db
 POSTHOOK: query: CREATE DATABASE test_db
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:test_db
 PREHOOK: query: USE test_db
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:test_db
 POSTHOOK: query: USE test_db
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:test_db
 PREHOOK: query: CREATE TABLE foo(a INT)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:test_db
+PREHOOK: Output: test_db@foo
 POSTHOOK: query: CREATE TABLE foo(a INT)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:test_db
 POSTHOOK: Output: test_db@foo
 PREHOOK: query: use default
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:default
 POSTHOOK: query: use default
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:default
 FAILED: SemanticException Duplicates declaration for database name
diff --git a/ql/src/test/results/clientnegative/show_create_table_index.q.out b/ql/src/test/results/clientnegative/show_create_table_index.q.out
index 162ef9b004..7f03efd696 100644
--- a/ql/src/test/results/clientnegative/show_create_table_index.q.out
+++ b/ql/src/test/results/clientnegative/show_create_table_index.q.out
@@ -1,13 +1,16 @@
 PREHOOK: query: CREATE TABLE tmp_showcrt (key int, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmp_showcrt
 POSTHOOK: query: CREATE TABLE tmp_showcrt (key int, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@tmp_showcrt
 PREHOOK: query: CREATE INDEX tmp_index on table tmp_showcrt(key) as 'compact' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@tmp_showcrt
 POSTHOOK: query: CREATE INDEX tmp_index on table tmp_showcrt(key) as 'compact' WITH DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@tmp_showcrt
 POSTHOOK: Output: default@default__tmp_showcrt_tmp_index__
 FAILED: SemanticException [Error 10144]: SHOW CREATE TABLE does not support tables of type INDEX_TABLE. default__tmp_showcrt_tmp_index__ has table type INDEX_TABLE
diff --git a/ql/src/test/results/clientnegative/smb_bucketmapjoin.q.out b/ql/src/test/results/clientnegative/smb_bucketmapjoin.q.out
index fa8d7bbc30..23938d26d3 100644
--- a/ql/src/test/results/clientnegative/smb_bucketmapjoin.q.out
+++ b/ql/src/test/results/clientnegative/smb_bucketmapjoin.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE smb_bucket4_1(key int, value string) CLUSTERED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@smb_bucket4_1
 POSTHOOK: query: CREATE TABLE smb_bucket4_1(key int, value string) CLUSTERED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@smb_bucket4_1
 PREHOOK: query: CREATE TABLE smb_bucket4_2(key int, value string) CLUSTERED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@smb_bucket4_2
 POSTHOOK: query: CREATE TABLE smb_bucket4_2(key int, value string) CLUSTERED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/smb_mapjoin_14.q.out b/ql/src/test/results/clientnegative/smb_mapjoin_14.q.out
index fa931e3acd..de32df3b31 100644
--- a/ql/src/test/results/clientnegative/smb_mapjoin_14.q.out
+++ b/ql/src/test/results/clientnegative/smb_mapjoin_14.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE tbl1(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl1
 POSTHOOK: query: CREATE TABLE tbl1(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@tbl1
 PREHOOK: query: CREATE TABLE tbl2(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl2
 POSTHOOK: query: CREATE TABLE tbl2(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/sortmerge_mapjoin_mismatch_1.q.out b/ql/src/test/results/clientnegative/sortmerge_mapjoin_mismatch_1.q.out
index 0ef2053a23..4fc6f27bba 100644
--- a/ql/src/test/results/clientnegative/sortmerge_mapjoin_mismatch_1.q.out
+++ b/ql/src/test/results/clientnegative/sortmerge_mapjoin_mismatch_1.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: create table table_asc(key int, value string) CLUSTERED BY (key)
 INTO 1 BUCKETS STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table_asc
 POSTHOOK: query: create table table_asc(key int, value string) CLUSTERED BY (key) SORTED BY (key asc) 
 INTO 1 BUCKETS STORED AS RCFILE
 POSTHOOK: type: CREATETABLE
@@ -11,6 +12,7 @@ PREHOOK: query: create table table_desc(key int, value string) CLUSTERED BY (key
 INTO 1 BUCKETS STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table_desc
 POSTHOOK: query: create table table_desc(key int, value string) CLUSTERED BY (key) SORTED BY (key desc) 
 INTO 1 BUCKETS STORED AS RCFILE
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientnegative/stats_aggregator_error_1.q.out b/ql/src/test/results/clientnegative/stats_aggregator_error_1.q.out
index d433b6c6e3..47ba34b6dd 100644
--- a/ql/src/test/results/clientnegative/stats_aggregator_error_1.q.out
+++ b/ql/src/test/results/clientnegative/stats_aggregator_error_1.q.out
@@ -7,6 +7,7 @@ PREHOOK: query: -- In this test, there is a dummy stats aggregator which throws
 create table tmptable(key string, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmptable
 POSTHOOK: query: -- In this test, there is a dummy stats aggregator which throws an error when the
 -- method connect is called (as indicated by the parameter hive.test.dummystats.aggregator)
 -- If stats need not be reliable, the statement succeeds. However, if stats are supposed
diff --git a/ql/src/test/results/clientnegative/stats_aggregator_error_2.q.out b/ql/src/test/results/clientnegative/stats_aggregator_error_2.q.out
index d9c5c06277..ff3e0739fd 100644
--- a/ql/src/test/results/clientnegative/stats_aggregator_error_2.q.out
+++ b/ql/src/test/results/clientnegative/stats_aggregator_error_2.q.out
@@ -6,6 +6,7 @@ PREHOOK: query: -- In this test, the stats aggregator does not exists.
 create table tmptable(key string, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmptable
 POSTHOOK: query: -- In this test, the stats aggregator does not exists.
 -- If stats need not be reliable, the statement succeeds. However, if stats are supposed
 -- to be reliable (by setting hive.stats.reliable to true), the insert statement fails
diff --git a/ql/src/test/results/clientnegative/stats_noscan_non_native.q.out b/ql/src/test/results/clientnegative/stats_noscan_non_native.q.out
index 48565f577f..99d9c0f0e0 100644
--- a/ql/src/test/results/clientnegative/stats_noscan_non_native.q.out
+++ b/ql/src/test/results/clientnegative/stats_noscan_non_native.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: CREATE TABLE non_native1(key int, value string)
 STORED BY 'org.apache.hadoop.hive.ql.metadata.DefaultStorageHandler'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@non_native1
 POSTHOOK: query: CREATE TABLE non_native1(key int, value string) 
 STORED BY 'org.apache.hadoop.hive.ql.metadata.DefaultStorageHandler'
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientnegative/stats_partialscan_autogether.q.out b/ql/src/test/results/clientnegative/stats_partialscan_autogether.q.out
index 0d5347ebe7..321ebe5318 100644
--- a/ql/src/test/results/clientnegative/stats_partialscan_autogether.q.out
+++ b/ql/src/test/results/clientnegative/stats_partialscan_autogether.q.out
@@ -6,6 +6,7 @@ partitioned by (ds string, hr string)
 stored as rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@analyze_srcpart_partial_scan
 POSTHOOK: query: -- test analyze table ... compute statistics partialscan
 
 -- 1. prepare data
diff --git a/ql/src/test/results/clientnegative/stats_partialscan_non_external.q.out b/ql/src/test/results/clientnegative/stats_partialscan_non_external.q.out
index 7fb1a76a48..ce3073b3f3 100644
--- a/ql/src/test/results/clientnegative/stats_partialscan_non_external.q.out
+++ b/ql/src/test/results/clientnegative/stats_partialscan_non_external.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE EXTERNAL TABLE external_table (key int, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@external_table
 POSTHOOK: query: CREATE EXTERNAL TABLE external_table (key int, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/stats_partialscan_non_native.q.out b/ql/src/test/results/clientnegative/stats_partialscan_non_native.q.out
index 1abeff9731..9d46969a0d 100644
--- a/ql/src/test/results/clientnegative/stats_partialscan_non_native.q.out
+++ b/ql/src/test/results/clientnegative/stats_partialscan_non_native.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: CREATE TABLE non_native1(key int, value string)
 STORED BY 'org.apache.hadoop.hive.ql.metadata.DefaultStorageHandler'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@non_native1
 POSTHOOK: query: CREATE TABLE non_native1(key int, value string) 
 STORED BY 'org.apache.hadoop.hive.ql.metadata.DefaultStorageHandler'
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientnegative/stats_partscan_norcfile.q.out b/ql/src/test/results/clientnegative/stats_partscan_norcfile.q.out
index 06d5f6c367..7f7763be75 100644
--- a/ql/src/test/results/clientnegative/stats_partscan_norcfile.q.out
+++ b/ql/src/test/results/clientnegative/stats_partscan_norcfile.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- test analyze table ... compute statistics partialscan
 create table analyze_srcpart_partial_scan like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@analyze_srcpart_partial_scan
 POSTHOOK: query: -- test analyze table ... compute statistics partialscan
 
 create table analyze_srcpart_partial_scan like srcpart
diff --git a/ql/src/test/results/clientnegative/stats_publisher_error_1.q.out b/ql/src/test/results/clientnegative/stats_publisher_error_1.q.out
index ae898609af..f0e403406b 100644
--- a/ql/src/test/results/clientnegative/stats_publisher_error_1.q.out
+++ b/ql/src/test/results/clientnegative/stats_publisher_error_1.q.out
@@ -7,6 +7,7 @@ PREHOOK: query: -- In this test, there is a dummy stats publisher which throws a
 create table tmptable(key string, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmptable
 POSTHOOK: query: -- In this test, there is a dummy stats publisher which throws an error when the
 -- method connect is called (as indicated by the parameter hive.test.dummystats.publisher)
 -- If stats need not be reliable, the statement succeeds. However, if stats are supposed
diff --git a/ql/src/test/results/clientnegative/stats_publisher_error_2.q.out b/ql/src/test/results/clientnegative/stats_publisher_error_2.q.out
index 5cec747477..c10108bf6a 100644
--- a/ql/src/test/results/clientnegative/stats_publisher_error_2.q.out
+++ b/ql/src/test/results/clientnegative/stats_publisher_error_2.q.out
@@ -6,6 +6,7 @@ PREHOOK: query: -- In this test, the stats publisher does not exists.
 create table tmptable(key string, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmptable
 POSTHOOK: query: -- In this test, the stats publisher does not exists.
 -- If stats need not be reliable, the statement succeeds. However, if stats are supposed
 -- to be reliable (by setting hive.stats.reliable to true), the insert statement fails
diff --git a/ql/src/test/results/clientnegative/subquery_nested_subquery.q.out b/ql/src/test/results/clientnegative/subquery_nested_subquery.q.out
index 4950ec99d7..4a7dab6b18 100644
--- a/ql/src/test/results/clientnegative/subquery_nested_subquery.q.out
+++ b/ql/src/test/results/clientnegative/subquery_nested_subquery.q.out
@@ -11,6 +11,7 @@ PREHOOK: query: CREATE TABLE part(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part
 POSTHOOK: query: CREATE TABLE part( 
     p_partkey INT,
     p_name STRING,
diff --git a/ql/src/test/results/clientnegative/subquery_windowing_corr.q.out b/ql/src/test/results/clientnegative/subquery_windowing_corr.q.out
index d45f8f1f0b..c54f54e91e 100644
--- a/ql/src/test/results/clientnegative/subquery_windowing_corr.q.out
+++ b/ql/src/test/results/clientnegative/subquery_windowing_corr.q.out
@@ -16,6 +16,7 @@ CREATE TABLE part(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part
 POSTHOOK: query: -- data setup
 CREATE TABLE part( 
     p_partkey INT,
diff --git a/ql/src/test/results/clientnegative/temp_table_authorize_create_tbl.q.out b/ql/src/test/results/clientnegative/temp_table_authorize_create_tbl.q.out
index 2322e427cd..5db06f1246 100644
--- a/ql/src/test/results/clientnegative/temp_table_authorize_create_tbl.q.out
+++ b/ql/src/test/results/clientnegative/temp_table_authorize_create_tbl.q.out
@@ -1,9 +1,13 @@
 PREHOOK: query: create database db23221
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:db23221
 POSTHOOK: query: create database db23221
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:db23221
 PREHOOK: query: use db23221
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:db23221
 POSTHOOK: query: use db23221
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:db23221
 FAILED: HiveAccessControlException Permission denied: Principal [name=user44, type=USER] does not have following privileges for operation CREATETABLE [[OBJECT OWNERSHIP] on Object [type=DATABASE, name=db23221]]
diff --git a/ql/src/test/results/clientnegative/temp_table_column_stats.q.out b/ql/src/test/results/clientnegative/temp_table_column_stats.q.out
index 4b0c0bc2bf..486597a6fd 100644
--- a/ql/src/test/results/clientnegative/temp_table_column_stats.q.out
+++ b/ql/src/test/results/clientnegative/temp_table_column_stats.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create temporary table tmp1 (c1 string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmp1
 POSTHOOK: query: create temporary table tmp1 (c1 string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/temp_table_create_like_partitions.q.out b/ql/src/test/results/clientnegative/temp_table_create_like_partitions.q.out
index d7b0e6df6a..d0a8cb4f4b 100644
--- a/ql/src/test/results/clientnegative/temp_table_create_like_partitions.q.out
+++ b/ql/src/test/results/clientnegative/temp_table_create_like_partitions.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table tab1 (c1 string) partitioned by (p1 string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tab1
 POSTHOOK: query: create table tab1 (c1 string) partitioned by (p1 string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@tab1
 PREHOOK: query: create table tmp1 like tab1
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmp1
 POSTHOOK: query: create table tmp1 like tab1
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/temp_table_index.q.out b/ql/src/test/results/clientnegative/temp_table_index.q.out
index f45271303d..643d59222d 100644
--- a/ql/src/test/results/clientnegative/temp_table_index.q.out
+++ b/ql/src/test/results/clientnegative/temp_table_index.q.out
@@ -1,10 +1,12 @@
 PREHOOK: query: create temporary table tmp1 (c1 string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmp1
 POSTHOOK: query: create temporary table tmp1 (c1 string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@tmp1
 PREHOOK: query: create index tmp1_idx on table tmp1 (c1) as 'COMPACT' with deferred rebuild
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@tmp1
 FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask. org.apache.hadoop.hive.ql.metadata.HiveException: tableName=default.tmp1 is a TEMPORARY TABLE. Index on TEMPORARY TABLE is not supported.
diff --git a/ql/src/test/results/clientnegative/temp_table_rename.q.out b/ql/src/test/results/clientnegative/temp_table_rename.q.out
index c8d4861b69..7622a2528e 100644
--- a/ql/src/test/results/clientnegative/temp_table_rename.q.out
+++ b/ql/src/test/results/clientnegative/temp_table_rename.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create temporary table tmp1 (c1 string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmp1
 POSTHOOK: query: create temporary table tmp1 (c1 string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@tmp1
 PREHOOK: query: create temporary table tmp2 (d1 string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmp2
 POSTHOOK: query: create temporary table tmp2 (d1 string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/truncate_bucketed_column.q.out b/ql/src/test/results/clientnegative/truncate_bucketed_column.q.out
index edad90cb15..80981e81a9 100644
--- a/ql/src/test/results/clientnegative/truncate_bucketed_column.q.out
+++ b/ql/src/test/results/clientnegative/truncate_bucketed_column.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- Tests truncating a bucketed column
 CREATE TABLE test_tab (key STRING, value STRING) CLUSTERED BY (key) INTO 2 BUCKETS STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_tab
 POSTHOOK: query: -- Tests truncating a bucketed column
 
 CREATE TABLE test_tab (key STRING, value STRING) CLUSTERED BY (key) INTO 2 BUCKETS STORED AS RCFILE
diff --git a/ql/src/test/results/clientnegative/truncate_column_indexed_table.q.out b/ql/src/test/results/clientnegative/truncate_column_indexed_table.q.out
index 2ca7f9bcae..2844c7b204 100644
--- a/ql/src/test/results/clientnegative/truncate_column_indexed_table.q.out
+++ b/ql/src/test/results/clientnegative/truncate_column_indexed_table.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- Tests truncating a column from an indexed table
 CREATE TABLE test_tab (key STRING, value STRING) STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_tab
 POSTHOOK: query: -- Tests truncating a column from an indexed table
 
 CREATE TABLE test_tab (key STRING, value STRING) STORED AS RCFILE
@@ -21,7 +22,9 @@ POSTHOOK: Lineage: test_tab.key SIMPLE [(src)src.FieldSchema(name:key, type:stri
 POSTHOOK: Lineage: test_tab.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: CREATE INDEX test_tab_index ON TABLE test_tab (key) as 'COMPACT' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@test_tab
 POSTHOOK: query: CREATE INDEX test_tab_index ON TABLE test_tab (key) as 'COMPACT' WITH DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@test_tab
 POSTHOOK: Output: default@default__test_tab_test_tab_index__
 FAILED: SemanticException org.apache.hadoop.hive.ql.parse.SemanticException: Can not truncate columns from table with indexes
diff --git a/ql/src/test/results/clientnegative/truncate_column_list_bucketing.q.out b/ql/src/test/results/clientnegative/truncate_column_list_bucketing.q.out
index bf08bcc670..ede76475e2 100644
--- a/ql/src/test/results/clientnegative/truncate_column_list_bucketing.q.out
+++ b/ql/src/test/results/clientnegative/truncate_column_list_bucketing.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- Tests truncating a column on which a table is list bucketed
 CREATE TABLE test_tab (key STRING, value STRING) STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_tab
 POSTHOOK: query: -- Tests truncating a column on which a table is list bucketed
 
 CREATE TABLE test_tab (key STRING, value STRING) STORED AS RCFILE
diff --git a/ql/src/test/results/clientnegative/truncate_column_seqfile.q.out b/ql/src/test/results/clientnegative/truncate_column_seqfile.q.out
index 9e0aa2dfe6..2fb494b09e 100644
--- a/ql/src/test/results/clientnegative/truncate_column_seqfile.q.out
+++ b/ql/src/test/results/clientnegative/truncate_column_seqfile.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- Tests truncating a column from a table stored as a sequence f
 CREATE TABLE test_tab (key STRING, value STRING) STORED AS SEQUENCEFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_tab
 POSTHOOK: query: -- Tests truncating a column from a table stored as a sequence file
 
 CREATE TABLE test_tab (key STRING, value STRING) STORED AS SEQUENCEFILE
diff --git a/ql/src/test/results/clientnegative/truncate_nonexistant_column.q.out b/ql/src/test/results/clientnegative/truncate_nonexistant_column.q.out
index 028b25c97a..8112fa66fd 100644
--- a/ql/src/test/results/clientnegative/truncate_nonexistant_column.q.out
+++ b/ql/src/test/results/clientnegative/truncate_nonexistant_column.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- Tests attempting to truncate a column in a table that doesn't
 CREATE TABLE test_tab (key STRING, value STRING) STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_tab
 POSTHOOK: query: -- Tests attempting to truncate a column in a table that doesn't exist
 
 CREATE TABLE test_tab (key STRING, value STRING) STORED AS RCFILE
diff --git a/ql/src/test/results/clientnegative/truncate_partition_column.q.out b/ql/src/test/results/clientnegative/truncate_partition_column.q.out
index b47029f6ca..9197c71b53 100644
--- a/ql/src/test/results/clientnegative/truncate_partition_column.q.out
+++ b/ql/src/test/results/clientnegative/truncate_partition_column.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- Tests truncating a partition column
 CREATE TABLE test_tab (key STRING, value STRING) PARTITIONED BY (part STRING) STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_tab
 POSTHOOK: query: -- Tests truncating a partition column
 
 CREATE TABLE test_tab (key STRING, value STRING) PARTITIONED BY (part STRING) STORED AS RCFILE
diff --git a/ql/src/test/results/clientnegative/truncate_partition_column2.q.out b/ql/src/test/results/clientnegative/truncate_partition_column2.q.out
index 1a818474c3..baaf6103f8 100644
--- a/ql/src/test/results/clientnegative/truncate_partition_column2.q.out
+++ b/ql/src/test/results/clientnegative/truncate_partition_column2.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- Tests truncating a partition column
 CREATE TABLE test_tab (key STRING, value STRING) PARTITIONED BY (part STRING) STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_tab
 POSTHOOK: query: -- Tests truncating a partition column
 
 CREATE TABLE test_tab (key STRING, value STRING) PARTITIONED BY (part STRING) STORED AS RCFILE
diff --git a/ql/src/test/results/clientnegative/truncate_table_failure3.q.out b/ql/src/test/results/clientnegative/truncate_table_failure3.q.out
index fafa821e4f..3145560f71 100644
--- a/ql/src/test/results/clientnegative/truncate_table_failure3.q.out
+++ b/ql/src/test/results/clientnegative/truncate_table_failure3.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create external table external1 (a int, b int) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@external1
 POSTHOOK: query: create external table external1 (a int, b int) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/truncate_table_failure4.q.out b/ql/src/test/results/clientnegative/truncate_table_failure4.q.out
index 1a85ffbdac..db4a765930 100644
--- a/ql/src/test/results/clientnegative/truncate_table_failure4.q.out
+++ b/ql/src/test/results/clientnegative/truncate_table_failure4.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: CREATE TABLE non_native(key int, value string)
 STORED BY 'org.apache.hadoop.hive.ql.metadata.DefaultStorageHandler'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@non_native
 POSTHOOK: query: CREATE TABLE non_native(key int, value string)
 STORED BY 'org.apache.hadoop.hive.ql.metadata.DefaultStorageHandler'
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientnegative/union2.q.out b/ql/src/test/results/clientnegative/union2.q.out
index cc14124293..07b6fa98bb 100644
--- a/ql/src/test/results/clientnegative/union2.q.out
+++ b/ql/src/test/results/clientnegative/union2.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table if not exists union2_t1(r string, c string, v array<string>)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@union2_t1
 POSTHOOK: query: create table if not exists union2_t1(r string, c string, v array<string>)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@union2_t1
 PREHOOK: query: create table if not exists union2_t2(s string, c string, v string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@union2_t2
 POSTHOOK: query: create table if not exists union2_t2(s string, c string, v string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/union22.q.out b/ql/src/test/results/clientnegative/union22.q.out
index 73640330eb..1db78af180 100644
--- a/ql/src/test/results/clientnegative/union22.q.out
+++ b/ql/src/test/results/clientnegative/union22.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table dst_union22(k1 string, k2 string, k3 string, k4 string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dst_union22
 POSTHOOK: query: create table dst_union22(k1 string, k2 string, k3 string, k4 string) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@dst_union22
 PREHOOK: query: create table dst_union22_delta(k0 string, k1 string, k2 string, k3 string, k4 string, k5 string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dst_union22_delta
 POSTHOOK: query: create table dst_union22_delta(k0 string, k1 string, k2 string, k3 string, k4 string, k5 string) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/union3.q.out b/ql/src/test/results/clientnegative/union3.q.out
index 1d73063d33..de1c62ba75 100644
--- a/ql/src/test/results/clientnegative/union3.q.out
+++ b/ql/src/test/results/clientnegative/union3.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- Ensure that UNION ALL columns are in the correct order on bot
 CREATE TABLE IF NOT EXISTS union3  (bar int, baz int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@union3
 POSTHOOK: query: -- Ensure that UNION ALL columns are in the correct order on both sides
 -- Ensure that the appropriate error message is propagated
 CREATE TABLE IF NOT EXISTS union3  (bar int, baz int)
diff --git a/ql/src/test/results/clientnegative/unset_table_property.q.out b/ql/src/test/results/clientnegative/unset_table_property.q.out
index 45a5e12538..8f94c9d28d 100644
--- a/ql/src/test/results/clientnegative/unset_table_property.q.out
+++ b/ql/src/test/results/clientnegative/unset_table_property.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE testTable(col1 INT, col2 INT)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@testTable
 POSTHOOK: query: CREATE TABLE testTable(col1 INT, col2 INT)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientnegative/windowing_leadlag_in_udaf.q.out b/ql/src/test/results/clientnegative/windowing_leadlag_in_udaf.q.out
index a7e02f9c17..05ae8bcf81 100644
--- a/ql/src/test/results/clientnegative/windowing_leadlag_in_udaf.q.out
+++ b/ql/src/test/results/clientnegative/windowing_leadlag_in_udaf.q.out
@@ -15,6 +15,7 @@ PREHOOK: query: CREATE TABLE part(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part
 POSTHOOK: query: CREATE TABLE part( 
     p_partkey INT,
     p_name STRING,
diff --git a/ql/src/test/results/clientnegative/windowing_ll_no_neg.q.out b/ql/src/test/results/clientnegative/windowing_ll_no_neg.q.out
index c2bf9cffb9..6fb4b00e9a 100644
--- a/ql/src/test/results/clientnegative/windowing_ll_no_neg.q.out
+++ b/ql/src/test/results/clientnegative/windowing_ll_no_neg.q.out
@@ -16,6 +16,7 @@ CREATE TABLE part(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part
 POSTHOOK: query: -- data setup
 CREATE TABLE part(
     p_partkey INT,
diff --git a/ql/src/test/results/clientnegative/windowing_ll_no_over.q.out b/ql/src/test/results/clientnegative/windowing_ll_no_over.q.out
index 746e90bed6..0d5bc98d01 100644
--- a/ql/src/test/results/clientnegative/windowing_ll_no_over.q.out
+++ b/ql/src/test/results/clientnegative/windowing_ll_no_over.q.out
@@ -15,6 +15,7 @@ PREHOOK: query: CREATE TABLE part(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part
 POSTHOOK: query: CREATE TABLE part( 
     p_partkey INT,
     p_name STRING,
diff --git a/ql/src/test/results/clientnegative/wrong_column_type.q.out b/ql/src/test/results/clientnegative/wrong_column_type.q.out
index 67619c2bc9..be48c4eeea 100644
--- a/ql/src/test/results/clientnegative/wrong_column_type.q.out
+++ b/ql/src/test/results/clientnegative/wrong_column_type.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(a float)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(a float)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/add_part_exist.q.out b/ql/src/test/results/clientpositive/add_part_exist.q.out
index 730fcfaf9e..4c22d6ac84 100644
--- a/ql/src/test/results/clientpositive/add_part_exist.q.out
+++ b/ql/src/test/results/clientpositive/add_part_exist.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE add_part_test (key STRING, value STRING) PARTITIONED BY (ds STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@add_part_test
 POSTHOOK: query: CREATE TABLE add_part_test (key STRING, value STRING) PARTITIONED BY (ds STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -93,19 +94,24 @@ srcpart
 PREHOOK: query: -- Test ALTER TABLE ADD PARTITION in non-default Database
 CREATE DATABASE add_part_test_db
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:add_part_test_db
 POSTHOOK: query: -- Test ALTER TABLE ADD PARTITION in non-default Database
 CREATE DATABASE add_part_test_db
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:add_part_test_db
 PREHOOK: query: USE add_part_test_db
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:add_part_test_db
 POSTHOOK: query: USE add_part_test_db
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:add_part_test_db
 PREHOOK: query: SHOW TABLES
 PREHOOK: type: SHOWTABLES
 POSTHOOK: query: SHOW TABLES
 POSTHOOK: type: SHOWTABLES
 PREHOOK: query: CREATE TABLE add_part_test (key STRING, value STRING) PARTITIONED BY (ds STRING)
 PREHOOK: type: CREATETABLE
+PREHOOK: Output: add_part_test_db@add_part_test
 PREHOOK: Output: database:add_part_test_db
 POSTHOOK: query: CREATE TABLE add_part_test (key STRING, value STRING) PARTITIONED BY (ds STRING)
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/add_part_multiple.q.out b/ql/src/test/results/clientpositive/add_part_multiple.q.out
index ac612062ca..975baa5d0e 100644
--- a/ql/src/test/results/clientpositive/add_part_multiple.q.out
+++ b/ql/src/test/results/clientpositive/add_part_multiple.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- HIVE-5122 locations for 2nd, 3rd... partition are ignored
 CREATE TABLE add_part_test (key STRING, value STRING) PARTITIONED BY (ds STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@add_part_test
 POSTHOOK: query: -- HIVE-5122 locations for 2nd, 3rd... partition are ignored
 
 CREATE TABLE add_part_test (key STRING, value STRING) PARTITIONED BY (ds STRING)
diff --git a/ql/src/test/results/clientpositive/add_partition_no_whitelist.q.out b/ql/src/test/results/clientpositive/add_partition_no_whitelist.q.out
index 35188753a3..4c4be4ae4d 100644
--- a/ql/src/test/results/clientpositive/add_partition_no_whitelist.q.out
+++ b/ql/src/test/results/clientpositive/add_partition_no_whitelist.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- Test with no partition name whitelist pattern
 CREATE TABLE part_nowhitelist_test (key STRING, value STRING) PARTITIONED BY (ds STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part_nowhitelist_test
 POSTHOOK: query: -- Test with no partition name whitelist pattern
 
 CREATE TABLE part_nowhitelist_test (key STRING, value STRING) PARTITIONED BY (ds STRING)
diff --git a/ql/src/test/results/clientpositive/add_partition_with_whitelist.q.out b/ql/src/test/results/clientpositive/add_partition_with_whitelist.q.out
index 6fda5c9cc2..d996d6d5d5 100644
--- a/ql/src/test/results/clientpositive/add_partition_with_whitelist.q.out
+++ b/ql/src/test/results/clientpositive/add_partition_with_whitelist.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- This pattern matches only letters.
 CREATE TABLE part_whitelist_test (key STRING, value STRING) PARTITIONED BY (ds STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part_whitelist_test
 POSTHOOK: query: -- This pattern matches only letters.
 
 CREATE TABLE part_whitelist_test (key STRING, value STRING) PARTITIONED BY (ds STRING)
diff --git a/ql/src/test/results/clientpositive/alter1.q.out b/ql/src/test/results/clientpositive/alter1.q.out
index 94fa640067..1cfaf75c59 100644
--- a/ql/src/test/results/clientpositive/alter1.q.out
+++ b/ql/src/test/results/clientpositive/alter1.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table alter1(a int, b int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@alter1
 POSTHOOK: query: create table alter1(a int, b int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -203,20 +204,25 @@ PREHOOK: query: -- With non-default Database
 
 CREATE DATABASE alter1_db
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:alter1_db
 POSTHOOK: query: -- With non-default Database
 
 CREATE DATABASE alter1_db
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:alter1_db
 PREHOOK: query: USE alter1_db
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:alter1_db
 POSTHOOK: query: USE alter1_db
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:alter1_db
 PREHOOK: query: SHOW TABLES
 PREHOOK: type: SHOWTABLES
 POSTHOOK: query: SHOW TABLES
 POSTHOOK: type: SHOWTABLES
 PREHOOK: query: CREATE TABLE alter1(a INT, b INT)
 PREHOOK: type: CREATETABLE
+PREHOOK: Output: alter1_db@alter1
 PREHOOK: Output: database:alter1_db
 POSTHOOK: query: CREATE TABLE alter1(a INT, b INT)
 POSTHOOK: type: CREATETABLE
@@ -403,8 +409,10 @@ POSTHOOK: Input: alter1_db@alter1
 POSTHOOK: Output: alter1_db@alter1
 PREHOOK: query: USE default
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:default
 POSTHOOK: query: USE default
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:default
 PREHOOK: query: DROP DATABASE alter1_db
 PREHOOK: type: DROPDATABASE
 PREHOOK: Input: database:alter1_db
diff --git a/ql/src/test/results/clientpositive/alter2.q.out b/ql/src/test/results/clientpositive/alter2.q.out
index eb3f981beb..3356ab967a 100644
--- a/ql/src/test/results/clientpositive/alter2.q.out
+++ b/ql/src/test/results/clientpositive/alter2.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table alter2(a int, b int) partitioned by (insertdate string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@alter2
 POSTHOOK: query: create table alter2(a int, b int) partitioned by (insertdate string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -103,6 +104,7 @@ POSTHOOK: Output: default@alter2
 PREHOOK: query: create external table alter2(a int, b int) partitioned by (insertdate string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@alter2
 POSTHOOK: query: create external table alter2(a int, b int) partitioned by (insertdate string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -221,20 +223,25 @@ PREHOOK: query: -- Using non-default Database
 
 CREATE DATABASE alter2_db
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:alter2_db
 POSTHOOK: query: -- Using non-default Database
 
 CREATE DATABASE alter2_db
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:alter2_db
 PREHOOK: query: USE alter2_db
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:alter2_db
 POSTHOOK: query: USE alter2_db
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:alter2_db
 PREHOOK: query: SHOW TABLES
 PREHOOK: type: SHOWTABLES
 POSTHOOK: query: SHOW TABLES
 POSTHOOK: type: SHOWTABLES
 PREHOOK: query: CREATE TABLE alter2(a int, b int) PARTITIONED BY (insertdate string)
 PREHOOK: type: CREATETABLE
+PREHOOK: Output: alter2_db@alter2
 PREHOOK: Output: database:alter2_db
 POSTHOOK: query: CREATE TABLE alter2(a int, b int) PARTITIONED BY (insertdate string)
 POSTHOOK: type: CREATETABLE
@@ -337,6 +344,7 @@ POSTHOOK: Input: alter2_db@alter2
 POSTHOOK: Output: alter2_db@alter2
 PREHOOK: query: CREATE EXTERNAL TABLE alter2(a int, b int) PARTITIONED BY (insertdate string)
 PREHOOK: type: CREATETABLE
+PREHOOK: Output: alter2_db@alter2
 PREHOOK: Output: database:alter2_db
 POSTHOOK: query: CREATE EXTERNAL TABLE alter2(a int, b int) PARTITIONED BY (insertdate string)
 POSTHOOK: type: CREATETABLE
@@ -439,8 +447,10 @@ POSTHOOK: Input: alter2_db@alter2
 POSTHOOK: Output: alter2_db@alter2
 PREHOOK: query: USE default
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:default
 POSTHOOK: query: USE default
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:default
 PREHOOK: query: DROP DATABASE alter2_db
 PREHOOK: type: DROPDATABASE
 PREHOOK: Input: database:alter2_db
diff --git a/ql/src/test/results/clientpositive/alter3.q.out b/ql/src/test/results/clientpositive/alter3.q.out
index ba03a53cea..70353d3d8b 100644
--- a/ql/src/test/results/clientpositive/alter3.q.out
+++ b/ql/src/test/results/clientpositive/alter3.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table alter3_src ( col1 string ) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@alter3_src
 POSTHOOK: query: create table alter3_src ( col1 string ) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -16,6 +17,7 @@ POSTHOOK: Output: default@alter3_src
 PREHOOK: query: create table alter3 ( col1 string ) partitioned by (pcol1 string , pcol2 string) stored as sequencefile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@alter3
 POSTHOOK: query: create table alter3 ( col1 string ) partitioned by (pcol1 string , pcol2 string) stored as sequencefile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -23,6 +25,7 @@ POSTHOOK: Output: default@alter3
 PREHOOK: query: create table alter3_like like alter3
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@alter3_like
 POSTHOOK: query: create table alter3_like like alter3
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -193,20 +196,25 @@ PREHOOK: query: -- With non-default Database
 
 CREATE DATABASE alter3_db
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:alter3_db
 POSTHOOK: query: -- With non-default Database
 
 CREATE DATABASE alter3_db
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:alter3_db
 PREHOOK: query: USE alter3_db
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:alter3_db
 POSTHOOK: query: USE alter3_db
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:alter3_db
 PREHOOK: query: SHOW TABLES
 PREHOOK: type: SHOWTABLES
 POSTHOOK: query: SHOW TABLES
 POSTHOOK: type: SHOWTABLES
 PREHOOK: query: CREATE TABLE alter3_src (col1 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
+PREHOOK: Output: alter3_db@alter3_src
 PREHOOK: Output: database:alter3_db
 POSTHOOK: query: CREATE TABLE alter3_src (col1 STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
@@ -222,6 +230,7 @@ POSTHOOK: type: LOAD
 POSTHOOK: Output: alter3_db@alter3_src
 PREHOOK: query: CREATE TABLE alter3 (col1 STRING) PARTITIONED BY (pcol1 STRING, pcol2 STRING) STORED AS SEQUENCEFILE
 PREHOOK: type: CREATETABLE
+PREHOOK: Output: alter3_db@alter3
 PREHOOK: Output: database:alter3_db
 POSTHOOK: query: CREATE TABLE alter3 (col1 STRING) PARTITIONED BY (pcol1 STRING, pcol2 STRING) STORED AS SEQUENCEFILE
 POSTHOOK: type: CREATETABLE
@@ -229,6 +238,7 @@ POSTHOOK: Output: alter3_db@alter3
 POSTHOOK: Output: database:alter3_db
 PREHOOK: query: CREATE TABLE alter3_like LIKE alter3
 PREHOOK: type: CREATETABLE
+PREHOOK: Output: alter3_db@alter3_like
 PREHOOK: Output: database:alter3_db
 POSTHOOK: query: CREATE TABLE alter3_like LIKE alter3
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/alter4.q.out b/ql/src/test/results/clientpositive/alter4.q.out
index 50f1a48035..42fa2d1fab 100644
--- a/ql/src/test/results/clientpositive/alter4.q.out
+++ b/ql/src/test/results/clientpositive/alter4.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE set_bucketing_test (key INT, value STRING) CLUSTERED BY (key) INTO 10 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@set_bucketing_test
 POSTHOOK: query: CREATE TABLE set_bucketing_test (key INT, value STRING) CLUSTERED BY (key) INTO 10 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -60,20 +61,25 @@ PREHOOK: query: -- with non-default Database
 
 CREATE DATABASE alter4_db
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:alter4_db
 POSTHOOK: query: -- with non-default Database
 
 CREATE DATABASE alter4_db
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:alter4_db
 PREHOOK: query: USE alter4_db
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:alter4_db
 POSTHOOK: query: USE alter4_db
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:alter4_db
 PREHOOK: query: SHOW TABLES
 PREHOOK: type: SHOWTABLES
 POSTHOOK: query: SHOW TABLES
 POSTHOOK: type: SHOWTABLES
 PREHOOK: query: CREATE TABLE set_bucketing_test (key INT, value STRING) CLUSTERED BY (key) INTO 10 BUCKETS
 PREHOOK: type: CREATETABLE
+PREHOOK: Output: alter4_db@set_bucketing_test
 PREHOOK: Output: database:alter4_db
 POSTHOOK: query: CREATE TABLE set_bucketing_test (key INT, value STRING) CLUSTERED BY (key) INTO 10 BUCKETS
 POSTHOOK: type: CREATETABLE
@@ -117,8 +123,10 @@ POSTHOOK: Input: alter4_db@set_bucketing_test
 POSTHOOK: Output: alter4_db@set_bucketing_test
 PREHOOK: query: USE default
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:default
 POSTHOOK: query: USE default
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:default
 PREHOOK: query: DROP DATABASE alter4_db
 PREHOOK: type: DROPDATABASE
 PREHOOK: Input: database:alter4_db
diff --git a/ql/src/test/results/clientpositive/alter5.q.out b/ql/src/test/results/clientpositive/alter5.q.out
index 40a7578513..a83b68dc12 100644
--- a/ql/src/test/results/clientpositive/alter5.q.out
+++ b/ql/src/test/results/clientpositive/alter5.q.out
@@ -5,6 +5,7 @@ PREHOOK: query: --
 create table alter5_src ( col1 string ) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@alter5_src
 POSTHOOK: query: --
 -- Added to validate the fix for HIVE-2117 - explicit partition location
 --
@@ -24,6 +25,7 @@ POSTHOOK: Output: default@alter5_src
 PREHOOK: query: create table alter5 ( col1 string ) partitioned by (dt string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@alter5
 POSTHOOK: query: create table alter5 ( col1 string ) partitioned by (dt string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -135,20 +137,25 @@ PREHOOK: query: -- With non-default Database
 
 CREATE DATABASE alter5_db
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:alter5_db
 POSTHOOK: query: -- With non-default Database
 
 CREATE DATABASE alter5_db
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:alter5_db
 PREHOOK: query: USE alter5_db
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:alter5_db
 POSTHOOK: query: USE alter5_db
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:alter5_db
 PREHOOK: query: SHOW TABLES
 PREHOOK: type: SHOWTABLES
 POSTHOOK: query: SHOW TABLES
 POSTHOOK: type: SHOWTABLES
 PREHOOK: query: create table alter5_src ( col1 string ) stored as textfile
 PREHOOK: type: CREATETABLE
+PREHOOK: Output: alter5_db@alter5_src
 PREHOOK: Output: database:alter5_db
 POSTHOOK: query: create table alter5_src ( col1 string ) stored as textfile
 POSTHOOK: type: CREATETABLE
@@ -164,6 +171,7 @@ POSTHOOK: type: LOAD
 POSTHOOK: Output: alter5_db@alter5_src
 PREHOOK: query: create table alter5 ( col1 string ) partitioned by (dt string)
 PREHOOK: type: CREATETABLE
+PREHOOK: Output: alter5_db@alter5
 PREHOOK: Output: database:alter5_db
 POSTHOOK: query: create table alter5 ( col1 string ) partitioned by (dt string)
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/alter_char1.q.out b/ql/src/test/results/clientpositive/alter_char1.q.out
index f98009bf32..017da600ac 100644
--- a/ql/src/test/results/clientpositive/alter_char1.q.out
+++ b/ql/src/test/results/clientpositive/alter_char1.q.out
@@ -9,6 +9,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table alter_char_1 (key string, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@alter_char_1
 POSTHOOK: query: create table alter_char_1 (key string, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/alter_char2.q.out b/ql/src/test/results/clientpositive/alter_char2.q.out
index dcdd9903c0..7ea86cae29 100644
--- a/ql/src/test/results/clientpositive/alter_char2.q.out
+++ b/ql/src/test/results/clientpositive/alter_char2.q.out
@@ -9,6 +9,7 @@ PREHOOK: query: create table alter_char2 (
 ) partitioned by (hr int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@alter_char2
 POSTHOOK: query: create table alter_char2 (
   c1 char(255)
 ) partitioned by (hr int)
diff --git a/ql/src/test/results/clientpositive/alter_concatenate_indexed_table.q.out b/ql/src/test/results/clientpositive/alter_concatenate_indexed_table.q.out
index 20af0c7b65..ffcbcf9d89 100644
--- a/ql/src/test/results/clientpositive/alter_concatenate_indexed_table.q.out
+++ b/ql/src/test/results/clientpositive/alter_concatenate_indexed_table.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table src_rc_concatenate_test(key int, value string) stored as rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_rc_concatenate_test
 POSTHOOK: query: create table src_rc_concatenate_test(key int, value string) stored as rcfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -66,8 +67,10 @@ POSTHOOK: Input: default@src_rc_concatenate_test
 214	-7678496319
 PREHOOK: query: create index src_rc_concatenate_test_index on table src_rc_concatenate_test(key) as 'compact' WITH DEFERRED REBUILD IDXPROPERTIES ("prop1"="val1", "prop2"="val2")
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@src_rc_concatenate_test
 POSTHOOK: query: create index src_rc_concatenate_test_index on table src_rc_concatenate_test(key) as 'compact' WITH DEFERRED REBUILD IDXPROPERTIES ("prop1"="val1", "prop2"="val2")
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@src_rc_concatenate_test
 POSTHOOK: Output: default@default__src_rc_concatenate_test_src_rc_concatenate_test_index__
 PREHOOK: query: show indexes on src_rc_concatenate_test
 PREHOOK: type: SHOWINDEXES
@@ -119,11 +122,14 @@ POSTHOOK: Input: default@src_rc_concatenate_test
 214	-7678496319
 PREHOOK: query: drop index src_rc_concatenate_test_index on src_rc_concatenate_test
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@src_rc_concatenate_test
 POSTHOOK: query: drop index src_rc_concatenate_test_index on src_rc_concatenate_test
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@src_rc_concatenate_test
 PREHOOK: query: create table src_rc_concatenate_test_part(key int, value string) partitioned by (ds string) stored as rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_rc_concatenate_test_part
 POSTHOOK: query: create table src_rc_concatenate_test_part(key int, value string) partitioned by (ds string) stored as rcfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -200,8 +206,10 @@ POSTHOOK: Input: default@src_rc_concatenate_test_part@ds=2011
 214	-7678496319
 PREHOOK: query: create index src_rc_concatenate_test_part_index on table src_rc_concatenate_test_part(key) as 'compact' WITH DEFERRED REBUILD IDXPROPERTIES ("prop1"="val1", "prop2"="val2")
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@src_rc_concatenate_test_part
 POSTHOOK: query: create index src_rc_concatenate_test_part_index on table src_rc_concatenate_test_part(key) as 'compact' WITH DEFERRED REBUILD IDXPROPERTIES ("prop1"="val1", "prop2"="val2")
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@src_rc_concatenate_test_part
 POSTHOOK: Output: default@default__src_rc_concatenate_test_part_src_rc_concatenate_test_part_index__
 PREHOOK: query: show indexes on src_rc_concatenate_test_part
 PREHOOK: type: SHOWINDEXES
@@ -257,5 +265,7 @@ POSTHOOK: Input: default@src_rc_concatenate_test_part@ds=2011
 214	-7678496319
 PREHOOK: query: drop index src_rc_concatenate_test_part_index on src_rc_concatenate_test_part
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@src_rc_concatenate_test_part
 POSTHOOK: query: drop index src_rc_concatenate_test_part_index on src_rc_concatenate_test_part
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@src_rc_concatenate_test_part
diff --git a/ql/src/test/results/clientpositive/alter_db_owner.q.out b/ql/src/test/results/clientpositive/alter_db_owner.q.out
index 83ffab4b99..19b88df5fa 100644
--- a/ql/src/test/results/clientpositive/alter_db_owner.q.out
+++ b/ql/src/test/results/clientpositive/alter_db_owner.q.out
@@ -1,7 +1,9 @@
 PREHOOK: query: create database db_alter_onr
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:db_alter_onr
 POSTHOOK: query: create database db_alter_onr
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:db_alter_onr
 PREHOOK: query: describe database db_alter_onr
 PREHOOK: type: DESCDATABASE
 POSTHOOK: query: describe database db_alter_onr
diff --git a/ql/src/test/results/clientpositive/alter_file_format.q.out b/ql/src/test/results/clientpositive/alter_file_format.q.out
index b172c20fde..4d6389a49f 100644
--- a/ql/src/test/results/clientpositive/alter_file_format.q.out
+++ b/ql/src/test/results/clientpositive/alter_file_format.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table alter_file_format_test (key int, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@alter_file_format_test
 POSTHOOK: query: create table alter_file_format_test (key int, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -314,6 +315,7 @@ PREHOOK: query: --partitioned table
 create table alter_partition_format_test (key int, value string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@alter_partition_format_test
 POSTHOOK: query: --partitioned table
 create table alter_partition_format_test (key int, value string) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/alter_index.q.out b/ql/src/test/results/clientpositive/alter_index.q.out
index 7a8c7edee0..2093e2fc4e 100644
--- a/ql/src/test/results/clientpositive/alter_index.q.out
+++ b/ql/src/test/results/clientpositive/alter_index.q.out
@@ -1,11 +1,15 @@
 PREHOOK: query: drop index src_index_8 on src
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: drop index src_index_8 on src
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@src
 PREHOOK: query: create index src_index_8 on table src(key) as 'compact' WITH DEFERRED REBUILD IDXPROPERTIES ("prop1"="val1", "prop2"="val2")
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: create index src_index_8 on table src(key) as 'compact' WITH DEFERRED REBUILD IDXPROPERTIES ("prop1"="val1", "prop2"="val2")
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@default__src_src_index_8__
 PREHOOK: query: desc extended default__src_src_index_8__
 PREHOOK: type: DESCTABLE
@@ -35,8 +39,10 @@ _offsets            	array<bigint>
 #### A masked pattern was here ####
 PREHOOK: query: drop index src_index_8 on src
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: drop index src_index_8 on src
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@src
 PREHOOK: query: show tables
 PREHOOK: type: SHOWTABLES
 POSTHOOK: query: show tables
diff --git a/ql/src/test/results/clientpositive/alter_merge.q.out b/ql/src/test/results/clientpositive/alter_merge.q.out
index a35313eb4c..17d86b83ba 100644
--- a/ql/src/test/results/clientpositive/alter_merge.q.out
+++ b/ql/src/test/results/clientpositive/alter_merge.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table src_rc_merge_test(key int, value string) stored as rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_rc_merge_test
 POSTHOOK: query: create table src_rc_merge_test(key int, value string) stored as rcfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -110,6 +111,7 @@ POSTHOOK: Input: default@src_rc_merge_test
 PREHOOK: query: create table src_rc_merge_test_part(key int, value string) partitioned by (ds string) stored as rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_rc_merge_test_part
 POSTHOOK: query: create table src_rc_merge_test_part(key int, value string) partitioned by (ds string) stored as rcfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/alter_merge_2.q.out b/ql/src/test/results/clientpositive/alter_merge_2.q.out
index 2b41a1760a..e118c39204 100644
--- a/ql/src/test/results/clientpositive/alter_merge_2.q.out
+++ b/ql/src/test/results/clientpositive/alter_merge_2.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table src_rc_merge_test_part(key int, value string) partitioned by (ds string, ts string) stored as rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_rc_merge_test_part
 POSTHOOK: query: create table src_rc_merge_test_part(key int, value string) partitioned by (ds string, ts string) stored as rcfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/alter_merge_2_orc.q.out b/ql/src/test/results/clientpositive/alter_merge_2_orc.q.out
index 09ede0728c..1ccae8e944 100644
--- a/ql/src/test/results/clientpositive/alter_merge_2_orc.q.out
+++ b/ql/src/test/results/clientpositive/alter_merge_2_orc.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table src_orc_merge_test_part(key int, value string) partitioned by (ds string, ts string) stored as orc
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_orc_merge_test_part
 POSTHOOK: query: create table src_orc_merge_test_part(key int, value string) partitioned by (ds string, ts string) stored as orc
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/alter_merge_3.q.out b/ql/src/test/results/clientpositive/alter_merge_3.q.out
index 572ff65531..f637da2759 100644
--- a/ql/src/test/results/clientpositive/alter_merge_3.q.out
+++ b/ql/src/test/results/clientpositive/alter_merge_3.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table src_rc_merge_test_part (key int, value string) partitioned by (ds string) stored as rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_rc_merge_test_part
 POSTHOOK: query: create table src_rc_merge_test_part (key int, value string) partitioned by (ds string) stored as rcfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/alter_merge_orc.q.out b/ql/src/test/results/clientpositive/alter_merge_orc.q.out
index 2610541b70..f26e38c246 100644
--- a/ql/src/test/results/clientpositive/alter_merge_orc.q.out
+++ b/ql/src/test/results/clientpositive/alter_merge_orc.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table src_orc_merge_test(key int, value string) stored as orc
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_orc_merge_test
 POSTHOOK: query: create table src_orc_merge_test(key int, value string) stored as orc
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -116,6 +117,7 @@ POSTHOOK: Input: default@src_orc_merge_test
 PREHOOK: query: create table src_orc_merge_test_part(key int, value string) partitioned by (ds string) stored as orc
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_orc_merge_test_part
 POSTHOOK: query: create table src_orc_merge_test_part(key int, value string) partitioned by (ds string) stored as orc
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/alter_merge_stats.q.out b/ql/src/test/results/clientpositive/alter_merge_stats.q.out
index 49c5556629..fdd2ddc4a1 100644
--- a/ql/src/test/results/clientpositive/alter_merge_stats.q.out
+++ b/ql/src/test/results/clientpositive/alter_merge_stats.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table src_rc_merge_test_stat(key int, value string) stored as rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_rc_merge_test_stat
 POSTHOOK: query: create table src_rc_merge_test_stat(key int, value string) stored as rcfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -112,6 +113,7 @@ value               	string
 PREHOOK: query: create table src_rc_merge_test_part_stat(key int, value string) partitioned by (ds string) stored as rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_rc_merge_test_part_stat
 POSTHOOK: query: create table src_rc_merge_test_part_stat(key int, value string) partitioned by (ds string) stored as rcfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/alter_merge_stats_orc.q.out b/ql/src/test/results/clientpositive/alter_merge_stats_orc.q.out
index 09a1672cd2..64e51d52e5 100644
--- a/ql/src/test/results/clientpositive/alter_merge_stats_orc.q.out
+++ b/ql/src/test/results/clientpositive/alter_merge_stats_orc.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table src_orc_merge_test_stat(key int, value string) stored as orc
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_orc_merge_test_stat
 POSTHOOK: query: create table src_orc_merge_test_stat(key int, value string) stored as orc
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -157,6 +158,7 @@ Storage Desc Params:
 PREHOOK: query: create table src_orc_merge_test_part_stat(key int, value string) partitioned by (ds string) stored as orc
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_orc_merge_test_part_stat
 POSTHOOK: query: create table src_orc_merge_test_part_stat(key int, value string) partitioned by (ds string) stored as orc
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/alter_numbuckets_partitioned_table2_h23.q.out b/ql/src/test/results/clientpositive/alter_numbuckets_partitioned_table2_h23.q.out
index 787677cb8c..bdff1d75e6 100644
--- a/ql/src/test/results/clientpositive/alter_numbuckets_partitioned_table2_h23.q.out
+++ b/ql/src/test/results/clientpositive/alter_numbuckets_partitioned_table2_h23.q.out
@@ -5,6 +5,7 @@ PREHOOK: query: -- EXCLUDE_HADOOP_MAJOR_VERSIONS(0.20,0.20S)
 CREATE TABLE tst1(key STRING, value STRING) PARTITIONED BY (ds STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tst1
 POSTHOOK: query: -- EXCLUDE_HADOOP_MAJOR_VERSIONS(0.20,0.20S)
 -- Tests that when overwriting a partition in a table after altering the bucketing/sorting metadata
 -- the partition metadata is updated as well.
diff --git a/ql/src/test/results/clientpositive/alter_numbuckets_partitioned_table_h23.q.out b/ql/src/test/results/clientpositive/alter_numbuckets_partitioned_table_h23.q.out
index 7e887c3321..5047b23479 100644
--- a/ql/src/test/results/clientpositive/alter_numbuckets_partitioned_table_h23.q.out
+++ b/ql/src/test/results/clientpositive/alter_numbuckets_partitioned_table_h23.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- EXCLUDE_HADOOP_MAJOR_VERSIONS(0.20,0.20S)
 create table tst1(key string, value string) partitioned by (ds string) clustered by (key) into 10 buckets
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tst1
 POSTHOOK: query: -- EXCLUDE_HADOOP_MAJOR_VERSIONS(0.20,0.20S)
 create table tst1(key string, value string) partitioned by (ds string) clustered by (key) into 10 buckets
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/alter_partition_clusterby_sortby.q.out b/ql/src/test/results/clientpositive/alter_partition_clusterby_sortby.q.out
index 05e7d9f17b..eb08b6fcf6 100644
--- a/ql/src/test/results/clientpositive/alter_partition_clusterby_sortby.q.out
+++ b/ql/src/test/results/clientpositive/alter_partition_clusterby_sortby.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table alter_table_partition_clusterby_sortby (a int, b int) partitioned by (c string) clustered by (a, b) sorted by (a desc, b asc) into 4 buckets
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@alter_table_partition_clusterby_sortby
 POSTHOOK: query: create table alter_table_partition_clusterby_sortby (a int, b int) partitioned by (c string) clustered by (a, b) sorted by (a desc, b asc) into 4 buckets
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/alter_partition_coltype.q.out b/ql/src/test/results/clientpositive/alter_partition_coltype.q.out
index ba6953981b..25eb48c833 100644
--- a/ql/src/test/results/clientpositive/alter_partition_coltype.q.out
+++ b/ql/src/test/results/clientpositive/alter_partition_coltype.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- create testing table.
 create table alter_coltype(key string, value string) partitioned by (dt string, ts string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@alter_coltype
 POSTHOOK: query: -- create testing table.
 create table alter_coltype(key string, value string) partitioned by (dt string, ts string)
 POSTHOOK: type: CREATETABLE
@@ -941,6 +942,7 @@ POSTHOOK: Output: default@alter_coltype
 PREHOOK: query: create table alterdynamic_part_table(intcol string) partitioned by (partcol1 string, partcol2 string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@alterdynamic_part_table
 POSTHOOK: query: create table alterdynamic_part_table(intcol string) partitioned by (partcol1 string, partcol2 string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/alter_partition_format_loc.q.out b/ql/src/test/results/clientpositive/alter_partition_format_loc.q.out
index 37bda45651..3152bda644 100644
--- a/ql/src/test/results/clientpositive/alter_partition_format_loc.q.out
+++ b/ql/src/test/results/clientpositive/alter_partition_format_loc.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table alter_partition_format_test (key int, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@alter_partition_format_test
 POSTHOOK: query: create table alter_partition_format_test (key int, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -63,6 +64,7 @@ PREHOOK: query: --partitioned table
 create table alter_partition_format_test (key int, value string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@alter_partition_format_test
 POSTHOOK: query: --partitioned table
 create table alter_partition_format_test (key int, value string) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/alter_partition_protect_mode.q.out b/ql/src/test/results/clientpositive/alter_partition_protect_mode.q.out
index 995c1fa074..80990d9cbe 100644
--- a/ql/src/test/results/clientpositive/alter_partition_protect_mode.q.out
+++ b/ql/src/test/results/clientpositive/alter_partition_protect_mode.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- Create table
 create table if not exists alter_part_protect_mode(key string, value string ) partitioned by (year string, month string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@alter_part_protect_mode
 POSTHOOK: query: -- Create table
 create table if not exists alter_part_protect_mode(key string, value string ) partitioned by (year string, month string) stored as textfile
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/alter_partition_update_status.q.out b/ql/src/test/results/clientpositive/alter_partition_update_status.q.out
index 165caf378e..7e33a7e8ec 100644
--- a/ql/src/test/results/clientpositive/alter_partition_update_status.q.out
+++ b/ql/src/test/results/clientpositive/alter_partition_update_status.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table src_stat_part_one(key string, value string) partitioned by (partitionId int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_stat_part_one
 POSTHOOK: query: create table src_stat_part_one(key string, value string) partitioned by (partitionId int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -52,6 +53,7 @@ key                 	string
 PREHOOK: query: create table src_stat_part_two(key string, value string) partitioned by (px int, py string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_stat_part_two
 POSTHOOK: query: create table src_stat_part_two(key string, value string) partitioned by (px int, py string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/alter_partition_with_whitelist.q.out b/ql/src/test/results/clientpositive/alter_partition_with_whitelist.q.out
index 7224132a28..040ec4584d 100644
--- a/ql/src/test/results/clientpositive/alter_partition_with_whitelist.q.out
+++ b/ql/src/test/results/clientpositive/alter_partition_with_whitelist.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- This pattern matches only letters.
 CREATE TABLE part_whitelist_test (key STRING, value STRING) PARTITIONED BY (ds STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part_whitelist_test
 POSTHOOK: query: -- This pattern matches only letters.
 
 CREATE TABLE part_whitelist_test (key STRING, value STRING) PARTITIONED BY (ds STRING)
diff --git a/ql/src/test/results/clientpositive/alter_rename_partition.q.out b/ql/src/test/results/clientpositive/alter_rename_partition.q.out
index 8ce9126267..82eeb82add 100644
--- a/ql/src/test/results/clientpositive/alter_rename_partition.q.out
+++ b/ql/src/test/results/clientpositive/alter_rename_partition.q.out
@@ -24,6 +24,7 @@ srcpart
 PREHOOK: query: create table alter_rename_partition_src ( col1 string ) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@alter_rename_partition_src
 POSTHOOK: query: create table alter_rename_partition_src ( col1 string ) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -39,6 +40,7 @@ POSTHOOK: Output: default@alter_rename_partition_src
 PREHOOK: query: create table alter_rename_partition ( col1 string ) partitioned by (pcol1 string , pcol2 string) stored as sequencefile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@alter_rename_partition
 POSTHOOK: query: create table alter_rename_partition ( col1 string ) partitioned by (pcol1 string , pcol2 string) stored as sequencefile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -144,20 +146,25 @@ PREHOOK: query: -- With non-default Database
 
 CREATE DATABASE alter_rename_partition_db
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:alter_rename_partition_db
 POSTHOOK: query: -- With non-default Database
 
 CREATE DATABASE alter_rename_partition_db
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:alter_rename_partition_db
 PREHOOK: query: USE alter_rename_partition_db
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:alter_rename_partition_db
 POSTHOOK: query: USE alter_rename_partition_db
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:alter_rename_partition_db
 PREHOOK: query: SHOW TABLES
 PREHOOK: type: SHOWTABLES
 POSTHOOK: query: SHOW TABLES
 POSTHOOK: type: SHOWTABLES
 PREHOOK: query: CREATE TABLE alter_rename_partition_src (col1 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
+PREHOOK: Output: alter_rename_partition_db@alter_rename_partition_src
 PREHOOK: Output: database:alter_rename_partition_db
 POSTHOOK: query: CREATE TABLE alter_rename_partition_src (col1 STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
@@ -173,6 +180,7 @@ POSTHOOK: type: LOAD
 POSTHOOK: Output: alter_rename_partition_db@alter_rename_partition_src
 PREHOOK: query: CREATE TABLE alter_rename_partition (col1 STRING) PARTITIONED BY (pcol1 STRING, pcol2 STRING) STORED AS SEQUENCEFILE
 PREHOOK: type: CREATETABLE
+PREHOOK: Output: alter_rename_partition_db@alter_rename_partition
 PREHOOK: Output: database:alter_rename_partition_db
 POSTHOOK: query: CREATE TABLE alter_rename_partition (col1 STRING) PARTITIONED BY (pcol1 STRING, pcol2 STRING) STORED AS SEQUENCEFILE
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/alter_rename_partition_authorization.q.out b/ql/src/test/results/clientpositive/alter_rename_partition_authorization.q.out
index 4d49f1ef32..5e7c3e2283 100644
--- a/ql/src/test/results/clientpositive/alter_rename_partition_authorization.q.out
+++ b/ql/src/test/results/clientpositive/alter_rename_partition_authorization.q.out
@@ -12,6 +12,7 @@ POSTHOOK: Output: default@src_auth_tmp
 PREHOOK: query: create table authorization_part (key int, value string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@authorization_part
 POSTHOOK: query: create table authorization_part (key int, value string) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/alter_rename_table.q.out b/ql/src/test/results/clientpositive/alter_rename_table.q.out
index 723d687130..b9cf49f6be 100644
--- a/ql/src/test/results/clientpositive/alter_rename_table.q.out
+++ b/ql/src/test/results/clientpositive/alter_rename_table.q.out
@@ -1,17 +1,23 @@
 PREHOOK: query: create database source
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:source
 POSTHOOK: query: create database source
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:source
 PREHOOK: query: create database target
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:target
 POSTHOOK: query: create database target
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:target
 PREHOOK: query: create table source.src like default.src
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:source
+PREHOOK: Output: source@source.src
 POSTHOOK: query: create table source.src like default.src
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:source
+POSTHOOK: Output: source@source.src
 POSTHOOK: Output: source@src
 PREHOOK: query: load data local inpath '../../data/files/kv1.txt' overwrite into table source.src
 PREHOOK: type: LOAD
@@ -24,9 +30,11 @@ POSTHOOK: Output: source@src
 PREHOOK: query: create table source.srcpart like default.srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:source
+PREHOOK: Output: source@source.srcpart
 POSTHOOK: query: create table source.srcpart like default.srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:source
+POSTHOOK: Output: source@source.srcpart
 POSTHOOK: Output: source@srcpart
 PREHOOK: query: load data local inpath '../../data/files/kv1.txt' overwrite into table source.srcpart partition (ds='2008-04-08', hr='11')
 PREHOOK: type: LOAD
diff --git a/ql/src/test/results/clientpositive/alter_skewed_table.q.out b/ql/src/test/results/clientpositive/alter_skewed_table.q.out
index 5cf963e860..e6bfc5aad5 100644
--- a/ql/src/test/results/clientpositive/alter_skewed_table.q.out
+++ b/ql/src/test/results/clientpositive/alter_skewed_table.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table original (key STRING, value STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@original
 POSTHOOK: query: create table original (key STRING, value STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -94,6 +95,7 @@ POSTHOOK: Output: default@original
 PREHOOK: query: create table original2 (key STRING, value STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@original2
 POSTHOOK: query: create table original2 (key STRING, value STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -187,6 +189,7 @@ POSTHOOK: Output: default@original2
 PREHOOK: query: create table original3 (key STRING, value STRING) SKEWED BY (key, value) ON ((1,1),(5,6))
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@original3
 POSTHOOK: query: create table original3 (key STRING, value STRING) SKEWED BY (key, value) ON ((1,1),(5,6))
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/alter_table_not_sorted.q.out b/ql/src/test/results/clientpositive/alter_table_not_sorted.q.out
index 0e496e3fe8..b03146b7db 100644
--- a/ql/src/test/results/clientpositive/alter_table_not_sorted.q.out
+++ b/ql/src/test/results/clientpositive/alter_table_not_sorted.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table alter_table_not_sorted (a int, b int) clustered by (a) sorted by (a) into 4 buckets
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@alter_table_not_sorted
 POSTHOOK: query: create table alter_table_not_sorted (a int, b int) clustered by (a) sorted by (a) into 4 buckets
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/alter_table_serde.q.out b/ql/src/test/results/clientpositive/alter_table_serde.q.out
index 655e084280..1c1707c5b8 100644
--- a/ql/src/test/results/clientpositive/alter_table_serde.q.out
+++ b/ql/src/test/results/clientpositive/alter_table_serde.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- test table
 create table test_table (id int, query string, name string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table
 POSTHOOK: query: -- test table
 create table test_table (id int, query string, name string)
 POSTHOOK: type: CREATETABLE
@@ -68,6 +69,7 @@ PREHOOK: query: --- test partitioned table
 create table test_table (id int, query string, name string) partitioned by (dt string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table
 POSTHOOK: query: --- test partitioned table
 create table test_table (id int, query string, name string) partitioned by (dt string)
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/alter_table_serde2.q.out b/ql/src/test/results/clientpositive/alter_table_serde2.q.out
index 81231bc180..dc1dae3915 100644
--- a/ql/src/test/results/clientpositive/alter_table_serde2.q.out
+++ b/ql/src/test/results/clientpositive/alter_table_serde2.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: -- Tests that when overwriting a partition in a table after alte
 CREATE TABLE tst1(key STRING, value STRING) PARTITIONED BY (ds STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tst1
 POSTHOOK: query: -- Tests that when overwriting a partition in a table after altering the serde properties
 -- the partition metadata is updated as well.
 
diff --git a/ql/src/test/results/clientpositive/alter_table_update_status.q.out b/ql/src/test/results/clientpositive/alter_table_update_status.q.out
index 3e294ba91d..14940af40b 100644
--- a/ql/src/test/results/clientpositive/alter_table_update_status.q.out
+++ b/ql/src/test/results/clientpositive/alter_table_update_status.q.out
@@ -11,6 +11,7 @@ PREHOOK: query: create table src_stat_int (
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_stat_int
 POSTHOOK: query: create table src_stat_int (
   key         double,
   value       string
diff --git a/ql/src/test/results/clientpositive/alter_varchar1.q.out b/ql/src/test/results/clientpositive/alter_varchar1.q.out
index 3ea433f5ff..e74a7ed353 100644
--- a/ql/src/test/results/clientpositive/alter_varchar1.q.out
+++ b/ql/src/test/results/clientpositive/alter_varchar1.q.out
@@ -9,6 +9,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table alter_varchar_1 (key string, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@alter_varchar_1
 POSTHOOK: query: create table alter_varchar_1 (key string, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/alter_varchar2.q.out b/ql/src/test/results/clientpositive/alter_varchar2.q.out
index e1a3890fa0..c589bf29c2 100644
--- a/ql/src/test/results/clientpositive/alter_varchar2.q.out
+++ b/ql/src/test/results/clientpositive/alter_varchar2.q.out
@@ -9,6 +9,7 @@ PREHOOK: query: create table alter_varchar2 (
 ) partitioned by (hr int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@alter_varchar2
 POSTHOOK: query: create table alter_varchar2 (
   c1 varchar(255)
 ) partitioned by (hr int)
diff --git a/ql/src/test/results/clientpositive/alter_view_rename.q.out b/ql/src/test/results/clientpositive/alter_view_rename.q.out
index 2e142a3d0e..0f3dd14e62 100644
--- a/ql/src/test/results/clientpositive/alter_view_rename.q.out
+++ b/ql/src/test/results/clientpositive/alter_view_rename.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE invites (foo INT, bar STRING) PARTITIONED BY (ds STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@invites
 POSTHOOK: query: CREATE TABLE invites (foo INT, bar STRING) PARTITIONED BY (ds STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/analyze_table_null_partition.q.out b/ql/src/test/results/clientpositive/analyze_table_null_partition.q.out
index a811f81283..c7254d127f 100644
--- a/ql/src/test/results/clientpositive/analyze_table_null_partition.q.out
+++ b/ql/src/test/results/clientpositive/analyze_table_null_partition.q.out
@@ -9,6 +9,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: CREATE TABLE test1(name string, age int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test1
 POSTHOOK: query: CREATE TABLE test1(name string, age int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -16,6 +17,7 @@ POSTHOOK: Output: default@test1
 PREHOOK: query: CREATE TABLE test2(name string) PARTITIONED by (age int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test2
 POSTHOOK: query: CREATE TABLE test2(name string) PARTITIONED by (age int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/annotate_stats_filter.q.out b/ql/src/test/results/clientpositive/annotate_stats_filter.q.out
index ee93ef0d2f..70df1894f0 100644
--- a/ql/src/test/results/clientpositive/annotate_stats_filter.q.out
+++ b/ql/src/test/results/clientpositive/annotate_stats_filter.q.out
@@ -6,6 +6,7 @@ PREHOOK: query: create table if not exists loc_staging (
 ) row format delimited fields terminated by '|' stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@loc_staging
 POSTHOOK: query: create table if not exists loc_staging (
   state string,
   locid int,
@@ -18,6 +19,7 @@ POSTHOOK: Output: default@loc_staging
 PREHOOK: query: create table loc_orc like loc_staging
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@loc_orc
 POSTHOOK: query: create table loc_orc like loc_staging
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/annotate_stats_groupby.q.out b/ql/src/test/results/clientpositive/annotate_stats_groupby.q.out
index 224db2897c..9c37d9b7a9 100644
--- a/ql/src/test/results/clientpositive/annotate_stats_groupby.q.out
+++ b/ql/src/test/results/clientpositive/annotate_stats_groupby.q.out
@@ -6,6 +6,7 @@ PREHOOK: query: create table if not exists loc_staging (
 ) row format delimited fields terminated by '|' stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@loc_staging
 POSTHOOK: query: create table if not exists loc_staging (
   state string,
   locid int,
@@ -18,6 +19,7 @@ POSTHOOK: Output: default@loc_staging
 PREHOOK: query: create table loc_orc like loc_staging
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@loc_orc
 POSTHOOK: query: create table loc_orc like loc_staging
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/annotate_stats_join.q.out b/ql/src/test/results/clientpositive/annotate_stats_join.q.out
index 9a1f32c6d6..bfd6b51e0f 100644
--- a/ql/src/test/results/clientpositive/annotate_stats_join.q.out
+++ b/ql/src/test/results/clientpositive/annotate_stats_join.q.out
@@ -5,6 +5,7 @@ PREHOOK: query: create table if not exists emp (
 ) row format delimited fields terminated by '|' stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@emp
 POSTHOOK: query: create table if not exists emp (
   lastname string,
   deptid int,
@@ -19,6 +20,7 @@ PREHOOK: query: create table if not exists dept (
 ) row format delimited fields terminated by '|' stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dept
 POSTHOOK: query: create table if not exists dept (
   deptid int,
   deptname string
@@ -34,6 +36,7 @@ PREHOOK: query: create table if not exists loc (
 ) row format delimited fields terminated by '|' stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@loc
 POSTHOOK: query: create table if not exists loc (
   state string,
   locid int,
diff --git a/ql/src/test/results/clientpositive/annotate_stats_limit.q.out b/ql/src/test/results/clientpositive/annotate_stats_limit.q.out
index 24e6d182a3..b61a5970f2 100644
--- a/ql/src/test/results/clientpositive/annotate_stats_limit.q.out
+++ b/ql/src/test/results/clientpositive/annotate_stats_limit.q.out
@@ -6,6 +6,7 @@ PREHOOK: query: create table if not exists loc_staging (
 ) row format delimited fields terminated by '|' stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@loc_staging
 POSTHOOK: query: create table if not exists loc_staging (
   state string,
   locid int,
@@ -18,6 +19,7 @@ POSTHOOK: Output: default@loc_staging
 PREHOOK: query: create table loc_orc like loc_staging
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@loc_orc
 POSTHOOK: query: create table loc_orc like loc_staging
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/annotate_stats_part.q.out b/ql/src/test/results/clientpositive/annotate_stats_part.q.out
index e078ed4bbd..10993c3efc 100644
--- a/ql/src/test/results/clientpositive/annotate_stats_part.q.out
+++ b/ql/src/test/results/clientpositive/annotate_stats_part.q.out
@@ -6,6 +6,7 @@ PREHOOK: query: create table if not exists loc_staging (
 ) row format delimited fields terminated by '|' stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@loc_staging
 POSTHOOK: query: create table if not exists loc_staging (
   state string,
   locid int,
@@ -30,6 +31,7 @@ PREHOOK: query: create table if not exists loc_orc (
 ) partitioned by(year string) stored as orc
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@loc_orc
 POSTHOOK: query: create table if not exists loc_orc (
   state string,
   locid int,
diff --git a/ql/src/test/results/clientpositive/annotate_stats_select.q.out b/ql/src/test/results/clientpositive/annotate_stats_select.q.out
index 9d4cf9843a..1b3b334cfb 100644
--- a/ql/src/test/results/clientpositive/annotate_stats_select.q.out
+++ b/ql/src/test/results/clientpositive/annotate_stats_select.q.out
@@ -19,6 +19,7 @@ collection items terminated by ','
 map keys terminated by ':' stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@alltypes
 POSTHOOK: query: create table if not exists alltypes (
  bo1 boolean,
  ti1 tinyint,
@@ -44,6 +45,7 @@ POSTHOOK: Output: default@alltypes
 PREHOOK: query: create table alltypes_orc like alltypes
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@alltypes_orc
 POSTHOOK: query: create table alltypes_orc like alltypes
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/annotate_stats_table.q.out b/ql/src/test/results/clientpositive/annotate_stats_table.q.out
index c804700bb0..e0e70211e8 100644
--- a/ql/src/test/results/clientpositive/annotate_stats_table.q.out
+++ b/ql/src/test/results/clientpositive/annotate_stats_table.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: create table if not exists emp_staging (
 ) row format delimited fields terminated by '|' stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@emp_staging
 POSTHOOK: query: create table if not exists emp_staging (
   lastname string,
   deptid int
@@ -14,6 +15,7 @@ POSTHOOK: Output: default@emp_staging
 PREHOOK: query: create table if not exists emp_orc like emp_staging
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@emp_orc
 POSTHOOK: query: create table if not exists emp_orc like emp_staging
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/annotate_stats_union.q.out b/ql/src/test/results/clientpositive/annotate_stats_union.q.out
index 8f0682dafd..1e8c46bdc4 100644
--- a/ql/src/test/results/clientpositive/annotate_stats_union.q.out
+++ b/ql/src/test/results/clientpositive/annotate_stats_union.q.out
@@ -6,6 +6,7 @@ PREHOOK: query: create table if not exists loc_staging (
 ) row format delimited fields terminated by '|' stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@loc_staging
 POSTHOOK: query: create table if not exists loc_staging (
   state string,
   locid int,
@@ -18,6 +19,7 @@ POSTHOOK: Output: default@loc_staging
 PREHOOK: query: create table loc_orc like loc_staging
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@loc_orc
 POSTHOOK: query: create table loc_orc like loc_staging
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -240,12 +242,16 @@ STAGE PLANS:
 
 PREHOOK: query: create database test
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:test
 POSTHOOK: query: create database test
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:test
 PREHOOK: query: use test
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:test
 POSTHOOK: query: use test
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:test
 PREHOOK: query: create table if not exists loc_staging (
   state string,
   locid int,
@@ -254,6 +260,7 @@ PREHOOK: query: create table if not exists loc_staging (
 ) row format delimited fields terminated by '|' stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:test
+PREHOOK: Output: test@loc_staging
 POSTHOOK: query: create table if not exists loc_staging (
   state string,
   locid int,
@@ -266,6 +273,7 @@ POSTHOOK: Output: test@loc_staging
 PREHOOK: query: create table loc_orc like loc_staging
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:test
+PREHOOK: Output: test@loc_orc
 POSTHOOK: query: create table loc_orc like loc_staging
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:test
diff --git a/ql/src/test/results/clientpositive/archive_excludeHadoop20.q.out b/ql/src/test/results/clientpositive/archive_excludeHadoop20.q.out
index 35cdfb65e1..7ed53cbcef 100644
--- a/ql/src/test/results/clientpositive/archive_excludeHadoop20.q.out
+++ b/ql/src/test/results/clientpositive/archive_excludeHadoop20.q.out
@@ -13,6 +13,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table tstsrc like src
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tstsrc
 POSTHOOK: query: create table tstsrc like src
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -30,6 +31,7 @@ POSTHOOK: Lineage: tstsrc.value SIMPLE [(src)src.FieldSchema(name:value, type:st
 PREHOOK: query: create table tstsrcpart (key string, value string) partitioned by (ds string, hr string) clustered by (key) into 10 buckets
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tstsrcpart
 POSTHOOK: query: create table tstsrcpart (key string, value string) partitioned by (ds string, hr string) clustered by (key) into 10 buckets
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -190,6 +192,7 @@ PARTITIONED by (ds STRING)
 CLUSTERED BY (key) INTO 10 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@harbucket
 POSTHOOK: query: CREATE TABLE harbucket(key INT)
 PARTITIONED by (ds STRING)
 CLUSTERED BY (key) INTO 10 BUCKETS
@@ -273,6 +276,7 @@ PREHOOK: query: CREATE TABLE old_name(key INT)
 PARTITIONED by (ds STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@old_name
 POSTHOOK: query: CREATE TABLE old_name(key INT)
 PARTITIONED by (ds STRING)
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/archive_multi.q.out b/ql/src/test/results/clientpositive/archive_multi.q.out
index 511f2bd2e9..7e84deff35 100644
--- a/ql/src/test/results/clientpositive/archive_multi.q.out
+++ b/ql/src/test/results/clientpositive/archive_multi.q.out
@@ -9,6 +9,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table tstsrc like src
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tstsrc
 POSTHOOK: query: create table tstsrc like src
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -26,6 +27,7 @@ POSTHOOK: Lineage: tstsrc.value SIMPLE [(src)src.FieldSchema(name:value, type:st
 PREHOOK: query: create table tstsrcpart like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tstsrcpart
 POSTHOOK: query: create table tstsrcpart like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/authorization_1_sql_std.q.out b/ql/src/test/results/clientpositive/authorization_1_sql_std.q.out
index 84cd0052e6..44c2fbdb88 100644
--- a/ql/src/test/results/clientpositive/authorization_1_sql_std.q.out
+++ b/ql/src/test/results/clientpositive/authorization_1_sql_std.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table src_autho_test (key STRING, value STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_autho_test
 POSTHOOK: query: create table src_autho_test (key STRING, value STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/authorization_2.q.out b/ql/src/test/results/clientpositive/authorization_2.q.out
index fc586d9572..0da0ec2d61 100644
--- a/ql/src/test/results/clientpositive/authorization_2.q.out
+++ b/ql/src/test/results/clientpositive/authorization_2.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_BEFORE_DIFF
 create table authorization_part (key int, value string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@authorization_part
 POSTHOOK: query: -- SORT_BEFORE_DIFF
 
 create table authorization_part (key int, value string) partitioned by (ds string)
diff --git a/ql/src/test/results/clientpositive/authorization_5.q.out b/ql/src/test/results/clientpositive/authorization_5.q.out
index 7da3d70111..6e5187e476 100644
--- a/ql/src/test/results/clientpositive/authorization_5.q.out
+++ b/ql/src/test/results/clientpositive/authorization_5.q.out
@@ -2,10 +2,12 @@ PREHOOK: query: -- SORT_BEFORE_DIFF
 
 CREATE DATABASE IF NOT EXISTS test_db COMMENT 'Hive test database'
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:test_db
 POSTHOOK: query: -- SORT_BEFORE_DIFF
 
 CREATE DATABASE IF NOT EXISTS test_db COMMENT 'Hive test database'
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:test_db
 PREHOOK: query: SHOW DATABASES
 PREHOOK: type: SHOWDATABASES
 POSTHOOK: query: SHOW DATABASES
diff --git a/ql/src/test/results/clientpositive/authorization_6.q.out b/ql/src/test/results/clientpositive/authorization_6.q.out
index d931eac488..02c4109dce 100644
--- a/ql/src/test/results/clientpositive/authorization_6.q.out
+++ b/ql/src/test/results/clientpositive/authorization_6.q.out
@@ -12,6 +12,7 @@ POSTHOOK: Output: default@src_auth_tmp
 PREHOOK: query: create table authorization_part (key int, value string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@authorization_part
 POSTHOOK: query: create table authorization_part (key int, value string) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -141,6 +142,7 @@ POSTHOOK: Output: default@authorization_part
 PREHOOK: query: create table authorization_part (key int, value string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@authorization_part
 POSTHOOK: query: create table authorization_part (key int, value string) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/authorization_7.q.out b/ql/src/test/results/clientpositive/authorization_7.q.out
index 1931ec8e91..00d3ee426b 100644
--- a/ql/src/test/results/clientpositive/authorization_7.q.out
+++ b/ql/src/test/results/clientpositive/authorization_7.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: GRANT_PRIVILEGE
 PREHOOK: query: CREATE TABLE src_authorization_7 (key int, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_authorization_7
 POSTHOOK: query: CREATE TABLE src_authorization_7 (key int, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -36,6 +37,7 @@ POSTHOOK: type: GRANT_PRIVILEGE
 PREHOOK: query: CREATE TABLE src_authorization_7 (key int, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_authorization_7
 POSTHOOK: query: CREATE TABLE src_authorization_7 (key int, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/authorization_8.q.out b/ql/src/test/results/clientpositive/authorization_8.q.out
index f97c38f434..47791fd4c1 100644
--- a/ql/src/test/results/clientpositive/authorization_8.q.out
+++ b/ql/src/test/results/clientpositive/authorization_8.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: GRANT_PRIVILEGE
 PREHOOK: query: CREATE TABLE tbl_j5jbymsx8e (key INT, value STRING) PARTITIONED BY (ds STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl_j5jbymsx8e
 POSTHOOK: query: CREATE TABLE tbl_j5jbymsx8e (key INT, value STRING) PARTITIONED BY (ds STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/authorization_9.q.out b/ql/src/test/results/clientpositive/authorization_9.q.out
index 2f7282c4b1..7f95f5e3d7 100644
--- a/ql/src/test/results/clientpositive/authorization_9.q.out
+++ b/ql/src/test/results/clientpositive/authorization_9.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_BEFORE_DIFF
 create table dummy (key string, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dummy
 POSTHOOK: query: -- SORT_BEFORE_DIFF
 
 create table dummy (key string, value string)
diff --git a/ql/src/test/results/clientpositive/authorization_admin_almighty1.q.out b/ql/src/test/results/clientpositive/authorization_admin_almighty1.q.out
index d4f9555864..5bf93adf6b 100644
--- a/ql/src/test/results/clientpositive/authorization_admin_almighty1.q.out
+++ b/ql/src/test/results/clientpositive/authorization_admin_almighty1.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- actions from admin should work as if admin has all privileges
 create table t1(i int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t1
 POSTHOOK: query: -- actions from admin should work as if admin has all privileges
 
 create table t1(i int)
diff --git a/ql/src/test/results/clientpositive/authorization_admin_almighty2.q.out b/ql/src/test/results/clientpositive/authorization_admin_almighty2.q.out
index 34dbef84d8..be6f12ac4f 100644
--- a/ql/src/test/results/clientpositive/authorization_admin_almighty2.q.out
+++ b/ql/src/test/results/clientpositive/authorization_admin_almighty2.q.out
@@ -1,9 +1,11 @@
 PREHOOK: query: -- test commands such as dfs,add,delete,compile allowed only by admin user, after following statement
 use default
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:default
 POSTHOOK: query: -- test commands such as dfs,add,delete,compile allowed only by admin user, after following statement
 use default
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:default
 PREHOOK: query: set role admin
 PREHOOK: type: SHOW_ROLES
 POSTHOOK: query: set role admin
@@ -11,6 +13,7 @@ POSTHOOK: type: SHOW_ROLES
 PREHOOK: query: create table a_table1(a int, b int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@a_table1
 POSTHOOK: query: create table a_table1(a int, b int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/authorization_create_table_owner_privs.q.out b/ql/src/test/results/clientpositive/authorization_create_table_owner_privs.q.out
index 08a6ecac60..7130db8f28 100644
--- a/ql/src/test/results/clientpositive/authorization_create_table_owner_privs.q.out
+++ b/ql/src/test/results/clientpositive/authorization_create_table_owner_privs.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table create_table_creator_priv_test(i int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@create_table_creator_priv_test
 POSTHOOK: query: create table create_table_creator_priv_test(i int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/authorization_create_temp_table.q.out b/ql/src/test/results/clientpositive/authorization_create_temp_table.q.out
index 5200fb16ba..b171d6cf8d 100644
--- a/ql/src/test/results/clientpositive/authorization_create_temp_table.q.out
+++ b/ql/src/test/results/clientpositive/authorization_create_temp_table.q.out
@@ -14,6 +14,7 @@ POSTHOOK: Output: default@authorization_create_temp_table_1
 PREHOOK: query: create temporary table tmp1(c1 string, c2 string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmp1
 POSTHOOK: query: create temporary table tmp1(c1 string, c2 string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/authorization_explain.q.out b/ql/src/test/results/clientpositive/authorization_explain.q.out
index 3aeb170909..e5e605bce3 100644
--- a/ql/src/test/results/clientpositive/authorization_explain.q.out
+++ b/ql/src/test/results/clientpositive/authorization_explain.q.out
@@ -30,6 +30,7 @@ PREHOOK: type: SWITCHDATABASE
 POSTHOOK: query: explain authorization use default
 POSTHOOK: type: SWITCHDATABASE
 INPUTS: 
+  database:default
 OUTPUTS: 
 CURRENT_USER: 
   hive_test_user
@@ -39,4 +40,4 @@ PREHOOK: query: explain formatted authorization use default
 PREHOOK: type: SWITCHDATABASE
 POSTHOOK: query: explain formatted authorization use default
 POSTHOOK: type: SWITCHDATABASE
-{"OUTPUTS":[],"INPUTS":[],"OPERATION":"SWITCHDATABASE","CURRENT_USER":"hive_test_user"}
+{"OUTPUTS":[],"INPUTS":["database:default"],"OPERATION":"SWITCHDATABASE","CURRENT_USER":"hive_test_user"}
diff --git a/ql/src/test/results/clientpositive/authorization_grant_public_role.q.out b/ql/src/test/results/clientpositive/authorization_grant_public_role.q.out
index 846c3afab0..17b6c8a846 100644
--- a/ql/src/test/results/clientpositive/authorization_grant_public_role.q.out
+++ b/ql/src/test/results/clientpositive/authorization_grant_public_role.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- current user has been set (comment line before the set cmd is
 CREATE TABLE  t_gpr1(i int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t_gpr1
 POSTHOOK: query: -- current user has been set (comment line before the set cmd is resulting in parse error!!)
 
 CREATE TABLE  t_gpr1(i int)
diff --git a/ql/src/test/results/clientpositive/authorization_grant_table_priv.q.out b/ql/src/test/results/clientpositive/authorization_grant_table_priv.q.out
index c33fb62e9a..58ede72017 100644
--- a/ql/src/test/results/clientpositive/authorization_grant_table_priv.q.out
+++ b/ql/src/test/results/clientpositive/authorization_grant_table_priv.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- current user has been set (comment line before the set cmd is
 CREATE TABLE  table_priv1(i int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table_priv1
 POSTHOOK: query: -- current user has been set (comment line before the set cmd is resulting in parse error!!)
 
 CREATE TABLE  table_priv1(i int)
diff --git a/ql/src/test/results/clientpositive/authorization_index.q.out b/ql/src/test/results/clientpositive/authorization_index.q.out
index 7318515059..273931a86e 100644
--- a/ql/src/test/results/clientpositive/authorization_index.q.out
+++ b/ql/src/test/results/clientpositive/authorization_index.q.out
@@ -1,14 +1,17 @@
 PREHOOK: query: create table t1 (a int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t1
 POSTHOOK: query: create table t1 (a int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@t1
 PREHOOK: query: create index t1_index on table t1(a) as 'COMPACT' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@t1
 POSTHOOK: query: create index t1_index on table t1(a) as 'COMPACT' WITH DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@t1
 POSTHOOK: Output: default@default__t1_t1_index__
 PREHOOK: query: desc formatted default__t1_t1_index__
 PREHOOK: type: DESCTABLE
diff --git a/ql/src/test/results/clientpositive/authorization_insert.q.out b/ql/src/test/results/clientpositive/authorization_insert.q.out
index 7aefbfe2a6..d49e6c20eb 100644
--- a/ql/src/test/results/clientpositive/authorization_insert.q.out
+++ b/ql/src/test/results/clientpositive/authorization_insert.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- current user has been set (comment line before the set cmd is
 CREATE TABLE  t_auth_ins(i int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t_auth_ins
 POSTHOOK: query: -- current user has been set (comment line before the set cmd is resulting in parse error!!)
 
 CREATE TABLE  t_auth_ins(i int)
@@ -12,6 +13,7 @@ POSTHOOK: Output: default@t_auth_ins
 PREHOOK: query: CREATE TABLE t_select(i int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t_select
 POSTHOOK: query: CREATE TABLE t_select(i int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/authorization_owner_actions.q.out b/ql/src/test/results/clientpositive/authorization_owner_actions.q.out
index 6ce89e906f..ad818884d8 100644
--- a/ql/src/test/results/clientpositive/authorization_owner_actions.q.out
+++ b/ql/src/test/results/clientpositive/authorization_owner_actions.q.out
@@ -2,6 +2,7 @@
 create table t1(i int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t1
 #### A masked pattern was here ####
 create table t1(i int)
 POSTHOOK: type: CREATETABLE
@@ -26,6 +27,7 @@ POSTHOOK: Output: default@t1
 PREHOOK: query: create table t1(i int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t1
 POSTHOOK: query: create table t1(i int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/authorization_owner_actions_db.q.out b/ql/src/test/results/clientpositive/authorization_owner_actions_db.q.out
index f2d2691594..2d4e37fce8 100644
--- a/ql/src/test/results/clientpositive/authorization_owner_actions_db.q.out
+++ b/ql/src/test/results/clientpositive/authorization_owner_actions_db.q.out
@@ -14,8 +14,10 @@ POSTHOOK: query: grant role testrole to user hrt_1
 POSTHOOK: type: GRANT_ROLE
 PREHOOK: query: create database testdb
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:testdb
 POSTHOOK: query: create database testdb
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:testdb
 #### A masked pattern was here ####
 PREHOOK: type: ALTERDATABASE_OWNER
 PREHOOK: Output: database:testdb
@@ -31,13 +33,16 @@ testdb		location/in/test	testrole	ROLE
 -- create table
 use testdb
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:testdb
 #### A masked pattern was here ####
 -- create table
 use testdb
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:testdb
 PREHOOK: query: create table foobar (foo string, bar string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:testdb
+PREHOOK: Output: testdb@foobar
 POSTHOOK: query: create table foobar (foo string, bar string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:testdb
diff --git a/ql/src/test/results/clientpositive/authorization_parts.q.out b/ql/src/test/results/clientpositive/authorization_parts.q.out
index 6c70744073..bda6e8305b 100644
--- a/ql/src/test/results/clientpositive/authorization_parts.q.out
+++ b/ql/src/test/results/clientpositive/authorization_parts.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- check add partition without insert privilege
 create table tpart(i int, j int) partitioned by (k string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tpart
 POSTHOOK: query: -- check add partition without insert privilege
 create table tpart(i int, j int) partitioned by (k string)
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/authorization_revoke_table_priv.q.out b/ql/src/test/results/clientpositive/authorization_revoke_table_priv.q.out
index 2f01568a2c..187dc63349 100644
--- a/ql/src/test/results/clientpositive/authorization_revoke_table_priv.q.out
+++ b/ql/src/test/results/clientpositive/authorization_revoke_table_priv.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- current user has been set (comment line before the set cmd is
 CREATE TABLE table_priv_rev(i int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table_priv_rev
 POSTHOOK: query: -- current user has been set (comment line before the set cmd is resulting in parse error!!)
 
 CREATE TABLE table_priv_rev(i int)
diff --git a/ql/src/test/results/clientpositive/authorization_show_grant.q.out b/ql/src/test/results/clientpositive/authorization_show_grant.q.out
index 717637e204..2e7d7f6b14 100644
--- a/ql/src/test/results/clientpositive/authorization_show_grant.q.out
+++ b/ql/src/test/results/clientpositive/authorization_show_grant.q.out
@@ -26,6 +26,7 @@ PREHOOK: query: -- create table and grant privileges to a role
 create table t1(i int, j int, k int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t1
 POSTHOOK: query: -- create table and grant privileges to a role
 create table t1(i int, j int, k int)
 POSTHOOK: type: CREATETABLE
@@ -34,6 +35,7 @@ POSTHOOK: Output: default@t1
 PREHOOK: query: create table t2(i int, j int, k int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t2
 POSTHOOK: query: create table t2(i int, j int, k int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/authorization_view_sqlstd.q.out b/ql/src/test/results/clientpositive/authorization_view_sqlstd.q.out
index a4b59b3e0c..279554d31d 100644
--- a/ql/src/test/results/clientpositive/authorization_view_sqlstd.q.out
+++ b/ql/src/test/results/clientpositive/authorization_view_sqlstd.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- Test view authorization , and 'show grant' variants
 create table t1(i int, j int, k int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t1
 POSTHOOK: query: -- Test view authorization , and 'show grant' variants
 
 create table t1(i int, j int, k int)
diff --git a/ql/src/test/results/clientpositive/auto_join1.q.out b/ql/src/test/results/clientpositive/auto_join1.q.out
index 13a2d6ce7b..c0bdcdd584 100644
--- a/ql/src/test/results/clientpositive/auto_join1.q.out
+++ b/ql/src/test/results/clientpositive/auto_join1.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest_j1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_j1
 POSTHOOK: query: CREATE TABLE dest_j1(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/auto_join14.q.out b/ql/src/test/results/clientpositive/auto_join14.q.out
index 2ba47e96d9..565206054e 100644
--- a/ql/src/test/results/clientpositive/auto_join14.q.out
+++ b/ql/src/test/results/clientpositive/auto_join14.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- EXCLUDE_HADOOP_MAJOR_VERSIONS(0.20, 0.20S)
 CREATE TABLE dest1(c1 INT, c2 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: -- EXCLUDE_HADOOP_MAJOR_VERSIONS(0.20, 0.20S)
 
 CREATE TABLE dest1(c1 INT, c2 STRING) STORED AS TEXTFILE
diff --git a/ql/src/test/results/clientpositive/auto_join17.q.out b/ql/src/test/results/clientpositive/auto_join17.q.out
index 3c68f5dc69..0a68cb19fb 100644
--- a/ql/src/test/results/clientpositive/auto_join17.q.out
+++ b/ql/src/test/results/clientpositive/auto_join17.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key1 INT, value1 STRING, key2 INT, value2 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key1 INT, value1 STRING, key2 INT, value2 STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/auto_join19.q.out b/ql/src/test/results/clientpositive/auto_join19.q.out
index eab7182c07..a7f0f6b193 100644
--- a/ql/src/test/results/clientpositive/auto_join19.q.out
+++ b/ql/src/test/results/clientpositive/auto_join19.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/auto_join2.q.out b/ql/src/test/results/clientpositive/auto_join2.q.out
index 4e8a70604c..839f4a059c 100644
--- a/ql/src/test/results/clientpositive/auto_join2.q.out
+++ b/ql/src/test/results/clientpositive/auto_join2.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest_j2(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_j2
 POSTHOOK: query: CREATE TABLE dest_j2(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/auto_join24.q.out b/ql/src/test/results/clientpositive/auto_join24.q.out
index 33c98cd0c6..1fa3e6ea54 100644
--- a/ql/src/test/results/clientpositive/auto_join24.q.out
+++ b/ql/src/test/results/clientpositive/auto_join24.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table tst1(key STRING, cnt INT)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tst1
 POSTHOOK: query: create table tst1(key STRING, cnt INT)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/auto_join25.q.out b/ql/src/test/results/clientpositive/auto_join25.q.out
index 21188f89c9..08cbe4287c 100644
--- a/ql/src/test/results/clientpositive/auto_join25.q.out
+++ b/ql/src/test/results/clientpositive/auto_join25.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- This test tests the scenario when the mapper dies. So, create
 CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: -- This test tests the scenario when the mapper dies. So, create a conditional task for the mapjoin
 CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
@@ -52,6 +53,7 @@ RUN: Stage-1:MAPRED
 PREHOOK: query: CREATE TABLE dest_j2(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_j2
 POSTHOOK: query: CREATE TABLE dest_j2(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -94,6 +96,7 @@ RUN: Stage-1:MAPRED
 PREHOOK: query: CREATE TABLE dest_j1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_j1
 POSTHOOK: query: CREATE TABLE dest_j1(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/auto_join26.q.out b/ql/src/test/results/clientpositive/auto_join26.q.out
index 37fe6df6f7..6f1ccaeafa 100644
--- a/ql/src/test/results/clientpositive/auto_join26.q.out
+++ b/ql/src/test/results/clientpositive/auto_join26.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: --SORT_QUERY_RESULTS
 CREATE TABLE dest_j1(key INT, cnt INT)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_j1
 POSTHOOK: query: --SORT_QUERY_RESULTS
 
 CREATE TABLE dest_j1(key INT, cnt INT)
diff --git a/ql/src/test/results/clientpositive/auto_join3.q.out b/ql/src/test/results/clientpositive/auto_join3.q.out
index 0c58f4caee..78a7908171 100644
--- a/ql/src/test/results/clientpositive/auto_join3.q.out
+++ b/ql/src/test/results/clientpositive/auto_join3.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/auto_join32.q.out b/ql/src/test/results/clientpositive/auto_join32.q.out
index 22672185e6..7fca969a45 100644
--- a/ql/src/test/results/clientpositive/auto_join32.q.out
+++ b/ql/src/test/results/clientpositive/auto_join32.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- empty tables
 create table studenttab10k (name string, age int, gpa double)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@studenttab10k
 POSTHOOK: query: -- empty tables
 create table studenttab10k (name string, age int, gpa double)
 POSTHOOK: type: CREATETABLE
@@ -10,6 +11,7 @@ POSTHOOK: Output: default@studenttab10k
 PREHOOK: query: create table votertab10k (name string, age int, registration string, contributions float)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@votertab10k
 POSTHOOK: query: create table votertab10k (name string, age int, registration string, contributions float)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -134,6 +136,7 @@ PREHOOK: query: -- smb
 create table studenttab10k_smb (name string, age int, gpa double) clustered by (name) sorted by (name) into 2 buckets
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@studenttab10k_smb
 POSTHOOK: query: -- smb
 create table studenttab10k_smb (name string, age int, gpa double) clustered by (name) sorted by (name) into 2 buckets
 POSTHOOK: type: CREATETABLE
@@ -142,6 +145,7 @@ POSTHOOK: Output: default@studenttab10k_smb
 PREHOOK: query: create table votertab10k_smb (name string, age int, registration string, contributions float) clustered by (name) sorted by (name) into 2 buckets
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@votertab10k_smb
 POSTHOOK: query: create table votertab10k_smb (name string, age int, registration string, contributions float) clustered by (name) sorted by (name) into 2 buckets
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -350,6 +354,7 @@ PREHOOK: query: -- smb + partitions
 create table studenttab10k_part (name string, age int, gpa double) partitioned by (p string) clustered by (name) sorted by (name) into 2 buckets
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@studenttab10k_part
 POSTHOOK: query: -- smb + partitions
 create table studenttab10k_part (name string, age int, gpa double) partitioned by (p string) clustered by (name) sorted by (name) into 2 buckets
 POSTHOOK: type: CREATETABLE
@@ -358,6 +363,7 @@ POSTHOOK: Output: default@studenttab10k_part
 PREHOOK: query: create table votertab10k_part (name string, age int, registration string, contributions float) partitioned by (p string) clustered by (name) sorted by (name) into 2 buckets
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@votertab10k_part
 POSTHOOK: query: create table votertab10k_part (name string, age int, registration string, contributions float) partitioned by (p string) clustered by (name) sorted by (name) into 2 buckets
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/auto_join4.q.out b/ql/src/test/results/clientpositive/auto_join4.q.out
index 714e3ee341..6624e93e01 100644
--- a/ql/src/test/results/clientpositive/auto_join4.q.out
+++ b/ql/src/test/results/clientpositive/auto_join4.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(c1 INT, c2 STRING, c3 INT, c4 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(c1 INT, c2 STRING, c3 INT, c4 STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/auto_join5.q.out b/ql/src/test/results/clientpositive/auto_join5.q.out
index 17fbc9ad5a..c0552d9088 100644
--- a/ql/src/test/results/clientpositive/auto_join5.q.out
+++ b/ql/src/test/results/clientpositive/auto_join5.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(c1 INT, c2 STRING, c3 INT, c4 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(c1 INT, c2 STRING, c3 INT, c4 STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/auto_join6.q.out b/ql/src/test/results/clientpositive/auto_join6.q.out
index 5c0b44ba17..c23fbde368 100644
--- a/ql/src/test/results/clientpositive/auto_join6.q.out
+++ b/ql/src/test/results/clientpositive/auto_join6.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(c1 INT, c2 STRING, c3 INT, c4 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(c1 INT, c2 STRING, c3 INT, c4 STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/auto_join7.q.out b/ql/src/test/results/clientpositive/auto_join7.q.out
index 5345f9c42b..71607296e1 100644
--- a/ql/src/test/results/clientpositive/auto_join7.q.out
+++ b/ql/src/test/results/clientpositive/auto_join7.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(c1 INT, c2 STRING, c3 INT, c4 STRING, c5 INT, c6 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(c1 INT, c2 STRING, c3 INT, c4 STRING, c5 INT, c6 STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/auto_join8.q.out b/ql/src/test/results/clientpositive/auto_join8.q.out
index ea528724f1..a33a81cda7 100644
--- a/ql/src/test/results/clientpositive/auto_join8.q.out
+++ b/ql/src/test/results/clientpositive/auto_join8.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(c1 INT, c2 STRING, c3 INT, c4 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(c1 INT, c2 STRING, c3 INT, c4 STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/auto_join9.q.out b/ql/src/test/results/clientpositive/auto_join9.q.out
index 63762df891..609277a3b8 100644
--- a/ql/src/test/results/clientpositive/auto_join9.q.out
+++ b/ql/src/test/results/clientpositive/auto_join9.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/auto_join_filters.q.out b/ql/src/test/results/clientpositive/auto_join_filters.q.out
index 690fa1e983..a8c022140e 100644
--- a/ql/src/test/results/clientpositive/auto_join_filters.q.out
+++ b/ql/src/test/results/clientpositive/auto_join_filters.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE myinput1(key int, value int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@myinput1
 POSTHOOK: query: CREATE TABLE myinput1(key int, value int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -254,6 +255,7 @@ POSTHOOK: Input: default@myinput1
 PREHOOK: query: CREATE TABLE smb_input1(key int, value int) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@smb_input1
 POSTHOOK: query: CREATE TABLE smb_input1(key int, value int) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -261,6 +263,7 @@ POSTHOOK: Output: default@smb_input1
 PREHOOK: query: CREATE TABLE smb_input2(key int, value int) CLUSTERED BY (value) SORTED BY (value) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@smb_input2
 POSTHOOK: query: CREATE TABLE smb_input2(key int, value int) CLUSTERED BY (value) SORTED BY (value) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/auto_join_nulls.q.out b/ql/src/test/results/clientpositive/auto_join_nulls.q.out
index b61f8a0d7d..7abde8fe0f 100644
--- a/ql/src/test/results/clientpositive/auto_join_nulls.q.out
+++ b/ql/src/test/results/clientpositive/auto_join_nulls.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE myinput1(key int, value int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@myinput1
 POSTHOOK: query: CREATE TABLE myinput1(key int, value int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/auto_join_reordering_values.q.out b/ql/src/test/results/clientpositive/auto_join_reordering_values.q.out
index 37b626c7d1..03cdcb5c9b 100644
--- a/ql/src/test/results/clientpositive/auto_join_reordering_values.q.out
+++ b/ql/src/test/results/clientpositive/auto_join_reordering_values.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- HIVE-5056 RS has expression list for values, but it's ignored
 create table testsrc ( `key` int,`val` string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@testsrc
 POSTHOOK: query: -- HIVE-5056 RS has expression list for values, but it's ignored in MapJoinProcessor
 
 create table testsrc ( `key` int,`val` string)
@@ -24,6 +25,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table orderpayment_small (`dealid` int,`date` string,`time` string, `cityid` int, `userid` int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@orderpayment_small
 POSTHOOK: query: create table orderpayment_small (`dealid` int,`date` string,`time` string, `cityid` int, `userid` int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -48,6 +50,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table user_small( userid int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@user_small
 POSTHOOK: query: create table user_small( userid int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/auto_smb_mapjoin_14.q.out b/ql/src/test/results/clientpositive/auto_smb_mapjoin_14.q.out
index 74639911a6..76900412b7 100644
--- a/ql/src/test/results/clientpositive/auto_smb_mapjoin_14.q.out
+++ b/ql/src/test/results/clientpositive/auto_smb_mapjoin_14.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE tbl1(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE tbl1(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
@@ -12,6 +13,7 @@ POSTHOOK: Output: default@tbl1
 PREHOOK: query: CREATE TABLE tbl2(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl2
 POSTHOOK: query: CREATE TABLE tbl2(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -1357,6 +1359,7 @@ POSTHOOK: Input: default@tbl2
 PREHOOK: query: CREATE TABLE dest1(key int, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key int, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -1364,6 +1367,7 @@ POSTHOOK: Output: default@dest1
 PREHOOK: query: CREATE TABLE dest2(key int, val1 string, val2 string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest2
 POSTHOOK: query: CREATE TABLE dest2(key int, val1 string, val2 string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -1647,6 +1651,7 @@ POSTHOOK: Output: default@dest2
 PREHOOK: query: CREATE TABLE dest2(key int, cnt int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest2
 POSTHOOK: query: CREATE TABLE dest2(key int, cnt int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/auto_sortmerge_join_1.q.out b/ql/src/test/results/clientpositive/auto_sortmerge_join_1.q.out
index 3f367922f0..5a7f174a52 100644
--- a/ql/src/test/results/clientpositive/auto_sortmerge_join_1.q.out
+++ b/ql/src/test/results/clientpositive/auto_sortmerge_join_1.q.out
@@ -4,6 +4,7 @@ CREATE TABLE bucket_small (key string, value string) partitioned by (ds string)
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucket_small
 POSTHOOK: query: -- small 1 part, 2 bucket & big 2 part, 4 bucket
 
 CREATE TABLE bucket_small (key string, value string) partitioned by (ds string) 
@@ -31,6 +32,7 @@ POSTHOOK: Output: default@bucket_small@ds=2008-04-08
 PREHOOK: query: CREATE TABLE bucket_big (key string, value string) partitioned by (ds string) CLUSTERED BY (key) SORTED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucket_big
 POSTHOOK: query: CREATE TABLE bucket_big (key string, value string) partitioned by (ds string) CLUSTERED BY (key) SORTED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/auto_sortmerge_join_10.q.out b/ql/src/test/results/clientpositive/auto_sortmerge_join_10.q.out
index 3b791af637..488fc50c01 100644
--- a/ql/src/test/results/clientpositive/auto_sortmerge_join_10.q.out
+++ b/ql/src/test/results/clientpositive/auto_sortmerge_join_10.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE tbl1(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl1
 POSTHOOK: query: CREATE TABLE tbl1(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@tbl1
 PREHOOK: query: CREATE TABLE tbl2(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl2
 POSTHOOK: query: CREATE TABLE tbl2(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/auto_sortmerge_join_11.q.out b/ql/src/test/results/clientpositive/auto_sortmerge_join_11.q.out
index 21bb3a4e71..8372a6312a 100644
--- a/ql/src/test/results/clientpositive/auto_sortmerge_join_11.q.out
+++ b/ql/src/test/results/clientpositive/auto_sortmerge_join_11.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- small 1 part, 2 bucket & big 2 part, 4 bucket
 CREATE TABLE bucket_small (key string, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucket_small
 POSTHOOK: query: -- small 1 part, 2 bucket & big 2 part, 4 bucket
 
 CREATE TABLE bucket_small (key string, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
@@ -29,6 +30,7 @@ POSTHOOK: Output: default@bucket_small@ds=2008-04-08
 PREHOOK: query: CREATE TABLE bucket_big (key string, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucket_big
 POSTHOOK: query: CREATE TABLE bucket_big (key string, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/auto_sortmerge_join_12.q.out b/ql/src/test/results/clientpositive/auto_sortmerge_join_12.q.out
index dc8bd8740d..eaf6c15418 100644
--- a/ql/src/test/results/clientpositive/auto_sortmerge_join_12.q.out
+++ b/ql/src/test/results/clientpositive/auto_sortmerge_join_12.q.out
@@ -4,6 +4,7 @@ CREATE TABLE bucket_small (key string, value string) partitioned by (ds string)
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucket_small
 POSTHOOK: query: -- small 1 part, 2 bucket & big 2 part, 4 bucket
 
 CREATE TABLE bucket_small (key string, value string) partitioned by (ds string)
@@ -31,6 +32,7 @@ POSTHOOK: Output: default@bucket_small@ds=2008-04-08
 PREHOOK: query: CREATE TABLE bucket_big (key string, value string) partitioned by (ds string) CLUSTERED BY (key) SORTED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucket_big
 POSTHOOK: query: CREATE TABLE bucket_big (key string, value string) partitioned by (ds string) CLUSTERED BY (key) SORTED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -105,6 +107,7 @@ PREHOOK: query: CREATE TABLE bucket_medium (key string, value string) partitione
 CLUSTERED BY (key) SORTED BY (key) INTO 3 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucket_medium
 POSTHOOK: query: CREATE TABLE bucket_medium (key string, value string) partitioned by (ds string)
 CLUSTERED BY (key) SORTED BY (key) INTO 3 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/auto_sortmerge_join_13.q.out b/ql/src/test/results/clientpositive/auto_sortmerge_join_13.q.out
index ab82fea4cb..37d31c3d77 100644
--- a/ql/src/test/results/clientpositive/auto_sortmerge_join_13.q.out
+++ b/ql/src/test/results/clientpositive/auto_sortmerge_join_13.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE tbl1(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE tbl1(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
@@ -12,6 +13,7 @@ POSTHOOK: Output: default@tbl1
 PREHOOK: query: CREATE TABLE tbl2(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl2
 POSTHOOK: query: CREATE TABLE tbl2(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -39,6 +41,7 @@ POSTHOOK: Lineage: tbl2.value SIMPLE [(src)src.FieldSchema(name:value, type:stri
 PREHOOK: query: CREATE TABLE dest1(k1 int, k2 int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(k1 int, k2 int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -46,6 +49,7 @@ POSTHOOK: Output: default@dest1
 PREHOOK: query: CREATE TABLE dest2(k1 string, k2 string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest2
 POSTHOOK: query: CREATE TABLE dest2(k1 string, k2 string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/auto_sortmerge_join_14.q.out b/ql/src/test/results/clientpositive/auto_sortmerge_join_14.q.out
index 12628ebfd6..69bd43af9a 100644
--- a/ql/src/test/results/clientpositive/auto_sortmerge_join_14.q.out
+++ b/ql/src/test/results/clientpositive/auto_sortmerge_join_14.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE tbl1(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl1
 POSTHOOK: query: CREATE TABLE tbl1(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@tbl1
 PREHOOK: query: CREATE TABLE tbl2(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl2
 POSTHOOK: query: CREATE TABLE tbl2(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/auto_sortmerge_join_15.q.out b/ql/src/test/results/clientpositive/auto_sortmerge_join_15.q.out
index 082a690e42..10b20d84eb 100644
--- a/ql/src/test/results/clientpositive/auto_sortmerge_join_15.q.out
+++ b/ql/src/test/results/clientpositive/auto_sortmerge_join_15.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE tbl1(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl1
 POSTHOOK: query: CREATE TABLE tbl1(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@tbl1
 PREHOOK: query: CREATE TABLE tbl2(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl2
 POSTHOOK: query: CREATE TABLE tbl2(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/auto_sortmerge_join_16.q.out b/ql/src/test/results/clientpositive/auto_sortmerge_join_16.q.out
index 6140d4c3f5..03507dd063 100644
--- a/ql/src/test/results/clientpositive/auto_sortmerge_join_16.q.out
+++ b/ql/src/test/results/clientpositive/auto_sortmerge_join_16.q.out
@@ -6,6 +6,7 @@ value STRING
 PARTITIONED BY (file_tag STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@stage_bucket_big
 POSTHOOK: query: CREATE TABLE stage_bucket_big
 (
 key BIGINT,
@@ -25,6 +26,7 @@ clustered by (key) sorted by (key) into 12 buckets
 stored as RCFile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucket_big
 POSTHOOK: query: CREATE TABLE bucket_big
 (
 key BIGINT,
@@ -44,6 +46,7 @@ value string
 PARTITIONED BY (file_tag STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@stage_bucket_small
 POSTHOOK: query: CREATE TABLE stage_bucket_small
 (
 key BIGINT,
@@ -63,6 +66,7 @@ clustered by (key) sorted by (key) into 12 buckets
 stored as RCFile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucket_small
 POSTHOOK: query: CREATE TABLE bucket_small
 (
 key BIGINT,
diff --git a/ql/src/test/results/clientpositive/auto_sortmerge_join_2.q.out b/ql/src/test/results/clientpositive/auto_sortmerge_join_2.q.out
index fffbd53fe7..72242bbd71 100644
--- a/ql/src/test/results/clientpositive/auto_sortmerge_join_2.q.out
+++ b/ql/src/test/results/clientpositive/auto_sortmerge_join_2.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- small 1 part, 4 bucket & big 2 part, 2 bucket
 CREATE TABLE bucket_small (key string, value string) partitioned by (ds string) CLUSTERED BY (key) SORTED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucket_small
 POSTHOOK: query: -- small 1 part, 4 bucket & big 2 part, 2 bucket
 CREATE TABLE bucket_small (key string, value string) partitioned by (ds string) CLUSTERED BY (key) SORTED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
@@ -43,6 +44,7 @@ POSTHOOK: Output: default@bucket_small@ds=2008-04-08
 PREHOOK: query: CREATE TABLE bucket_big (key string, value string) partitioned by (ds string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucket_big
 POSTHOOK: query: CREATE TABLE bucket_big (key string, value string) partitioned by (ds string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/auto_sortmerge_join_3.q.out b/ql/src/test/results/clientpositive/auto_sortmerge_join_3.q.out
index 7578180d58..35fa02fa60 100644
--- a/ql/src/test/results/clientpositive/auto_sortmerge_join_3.q.out
+++ b/ql/src/test/results/clientpositive/auto_sortmerge_join_3.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- small 2 part, 2 bucket & big 1 part, 4 bucket
 CREATE TABLE bucket_small (key string, value string) partitioned by (ds string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucket_small
 POSTHOOK: query: -- small 2 part, 2 bucket & big 1 part, 4 bucket
 CREATE TABLE bucket_small (key string, value string) partitioned by (ds string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
@@ -44,6 +45,7 @@ POSTHOOK: Output: default@bucket_small@ds=2008-04-09
 PREHOOK: query: CREATE TABLE bucket_big (key string, value string) partitioned by (ds string) CLUSTERED BY (key) SORTED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucket_big
 POSTHOOK: query: CREATE TABLE bucket_big (key string, value string) partitioned by (ds string) CLUSTERED BY (key) SORTED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/auto_sortmerge_join_4.q.out b/ql/src/test/results/clientpositive/auto_sortmerge_join_4.q.out
index a04e7d0614..4fea70d4e4 100644
--- a/ql/src/test/results/clientpositive/auto_sortmerge_join_4.q.out
+++ b/ql/src/test/results/clientpositive/auto_sortmerge_join_4.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- small 2 part, 4 bucket & big 1 part, 2 bucket
 CREATE TABLE bucket_small (key string, value string) partitioned by (ds string) CLUSTERED BY (key) SORTED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucket_small
 POSTHOOK: query: -- small 2 part, 4 bucket & big 1 part, 2 bucket
 CREATE TABLE bucket_small (key string, value string) partitioned by (ds string) CLUSTERED BY (key) SORTED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
@@ -76,6 +77,7 @@ POSTHOOK: Output: default@bucket_small@ds=2008-04-09
 PREHOOK: query: CREATE TABLE bucket_big (key string, value string) partitioned by (ds string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucket_big
 POSTHOOK: query: CREATE TABLE bucket_big (key string, value string) partitioned by (ds string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/auto_sortmerge_join_5.q.out b/ql/src/test/results/clientpositive/auto_sortmerge_join_5.q.out
index 31fb7985ff..30a8436343 100644
--- a/ql/src/test/results/clientpositive/auto_sortmerge_join_5.q.out
+++ b/ql/src/test/results/clientpositive/auto_sortmerge_join_5.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- small no part, 4 bucket & big no part, 2 bucket
 CREATE TABLE bucket_small (key string, value string) CLUSTERED BY (key) SORTED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucket_small
 POSTHOOK: query: -- small no part, 4 bucket & big no part, 2 bucket
 CREATE TABLE bucket_small (key string, value string) CLUSTERED BY (key) SORTED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
@@ -42,6 +43,7 @@ POSTHOOK: Output: default@bucket_small
 PREHOOK: query: CREATE TABLE bucket_big (key string, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucket_big
 POSTHOOK: query: CREATE TABLE bucket_big (key string, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/auto_sortmerge_join_6.q.out b/ql/src/test/results/clientpositive/auto_sortmerge_join_6.q.out
index 2dae094d57..1747119adb 100644
--- a/ql/src/test/results/clientpositive/auto_sortmerge_join_6.q.out
+++ b/ql/src/test/results/clientpositive/auto_sortmerge_join_6.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE tbl1(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl1
 POSTHOOK: query: CREATE TABLE tbl1(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@tbl1
 PREHOOK: query: CREATE TABLE tbl2(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl2
 POSTHOOK: query: CREATE TABLE tbl2(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -15,6 +17,7 @@ POSTHOOK: Output: default@tbl2
 PREHOOK: query: CREATE TABLE tbl3(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl3
 POSTHOOK: query: CREATE TABLE tbl3(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -22,6 +25,7 @@ POSTHOOK: Output: default@tbl3
 PREHOOK: query: CREATE TABLE tbl4(key int, value string) CLUSTERED BY (value) SORTED BY (value) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl4
 POSTHOOK: query: CREATE TABLE tbl4(key int, value string) CLUSTERED BY (value) SORTED BY (value) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/auto_sortmerge_join_7.q.out b/ql/src/test/results/clientpositive/auto_sortmerge_join_7.q.out
index 5b6521bca4..abb1db4a87 100644
--- a/ql/src/test/results/clientpositive/auto_sortmerge_join_7.q.out
+++ b/ql/src/test/results/clientpositive/auto_sortmerge_join_7.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- small 2 part, 4 bucket & big 2 part, 2 bucket
 CREATE TABLE bucket_small (key string, value string) partitioned by (ds string) CLUSTERED BY (key) SORTED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucket_small
 POSTHOOK: query: -- small 2 part, 4 bucket & big 2 part, 2 bucket
 CREATE TABLE bucket_small (key string, value string) partitioned by (ds string) CLUSTERED BY (key) SORTED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
@@ -76,6 +77,7 @@ POSTHOOK: Output: default@bucket_small@ds=2008-04-09
 PREHOOK: query: CREATE TABLE bucket_big (key string, value string) partitioned by (ds string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucket_big
 POSTHOOK: query: CREATE TABLE bucket_big (key string, value string) partitioned by (ds string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/auto_sortmerge_join_8.q.out b/ql/src/test/results/clientpositive/auto_sortmerge_join_8.q.out
index 59fef228de..9226dc6b29 100644
--- a/ql/src/test/results/clientpositive/auto_sortmerge_join_8.q.out
+++ b/ql/src/test/results/clientpositive/auto_sortmerge_join_8.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- small 2 part, 2 bucket & big 2 part, 4 bucket
 CREATE TABLE bucket_small (key string, value string) partitioned by (ds string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucket_small
 POSTHOOK: query: -- small 2 part, 2 bucket & big 2 part, 4 bucket
 CREATE TABLE bucket_small (key string, value string) partitioned by (ds string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
@@ -44,6 +45,7 @@ POSTHOOK: Output: default@bucket_small@ds=2008-04-09
 PREHOOK: query: CREATE TABLE bucket_big (key string, value string) partitioned by (ds string) CLUSTERED BY (key) SORTED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucket_big
 POSTHOOK: query: CREATE TABLE bucket_big (key string, value string) partitioned by (ds string) CLUSTERED BY (key) SORTED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/auto_sortmerge_join_9.q.out b/ql/src/test/results/clientpositive/auto_sortmerge_join_9.q.out
index 2a01f4b933..95b264f8c2 100644
--- a/ql/src/test/results/clientpositive/auto_sortmerge_join_9.q.out
+++ b/ql/src/test/results/clientpositive/auto_sortmerge_join_9.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE tbl1(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE tbl1(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
@@ -12,6 +13,7 @@ POSTHOOK: Output: default@tbl1
 PREHOOK: query: CREATE TABLE tbl2(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl2
 POSTHOOK: query: CREATE TABLE tbl2(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/avro_add_column.q.out b/ql/src/test/results/clientpositive/avro_add_column.q.out
index 163feca528..3aae56225a 100644
--- a/ql/src/test/results/clientpositive/avro_add_column.q.out
+++ b/ql/src/test/results/clientpositive/avro_add_column.q.out
@@ -7,6 +7,7 @@ CREATE TABLE doctors (
 STORED AS AVRO
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@doctors
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 -- verify that we can actually read avro files
diff --git a/ql/src/test/results/clientpositive/avro_add_column2.q.out b/ql/src/test/results/clientpositive/avro_add_column2.q.out
index 32a6f5e773..0e26cd59f3 100644
--- a/ql/src/test/results/clientpositive/avro_add_column2.q.out
+++ b/ql/src/test/results/clientpositive/avro_add_column2.q.out
@@ -8,6 +8,7 @@ CREATE TABLE doctors (
 STORED AS AVRO
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@doctors
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 -- verify that we can actually read avro files
@@ -33,6 +34,7 @@ PREHOOK: query: CREATE TABLE doctors_copy (
 STORED AS AVRO
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@doctors_copy
 POSTHOOK: query: CREATE TABLE doctors_copy (
   number int,
   first_name string)
diff --git a/ql/src/test/results/clientpositive/avro_add_column3.q.out b/ql/src/test/results/clientpositive/avro_add_column3.q.out
index fe934e1d8e..0418b29ca9 100644
--- a/ql/src/test/results/clientpositive/avro_add_column3.q.out
+++ b/ql/src/test/results/clientpositive/avro_add_column3.q.out
@@ -8,6 +8,7 @@ CREATE TABLE doctors (
 STORED AS AVRO
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@doctors
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 -- verify that we can actually read avro files
@@ -34,6 +35,7 @@ PARTITIONED BY (part int)
 STORED AS AVRO
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@doctors_copy
 POSTHOOK: query: CREATE TABLE doctors_copy (
   number int,
   first_name string)
diff --git a/ql/src/test/results/clientpositive/avro_change_schema.q.out b/ql/src/test/results/clientpositive/avro_change_schema.q.out
index 4a9569da64..5d52d21547 100644
--- a/ql/src/test/results/clientpositive/avro_change_schema.q.out
+++ b/ql/src/test/results/clientpositive/avro_change_schema.q.out
@@ -14,6 +14,7 @@ TBLPROPERTIES ('avro.schema.literal'='{ "namespace": "org.apache.hive",
   ] }')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@avro2
 POSTHOOK: query: -- verify that we can update the table properties
 CREATE TABLE avro2
 ROW FORMAT
diff --git a/ql/src/test/results/clientpositive/avro_compression_enabled.q.out b/ql/src/test/results/clientpositive/avro_compression_enabled.q.out
index 235264018a..bcb967a115 100644
--- a/ql/src/test/results/clientpositive/avro_compression_enabled.q.out
+++ b/ql/src/test/results/clientpositive/avro_compression_enabled.q.out
@@ -36,6 +36,7 @@ TBLPROPERTIES ('avro.schema.literal'='{
 }')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@doctors4
 POSTHOOK: query: -- verify that new joins bring in correct schemas (including evolved schemas)
 
 CREATE TABLE doctors4
diff --git a/ql/src/test/results/clientpositive/avro_compression_enabled_native.q.out b/ql/src/test/results/clientpositive/avro_compression_enabled_native.q.out
index b8fa61eaa9..687f17ecfe 100644
--- a/ql/src/test/results/clientpositive/avro_compression_enabled_native.q.out
+++ b/ql/src/test/results/clientpositive/avro_compression_enabled_native.q.out
@@ -8,6 +8,7 @@ CREATE TABLE doctors4 (
 STORED AS AVRO
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@doctors4
 POSTHOOK: query: -- verify that new joins bring in correct schemas (including evolved schemas)
 
 CREATE TABLE doctors4 (
diff --git a/ql/src/test/results/clientpositive/avro_decimal.q.out b/ql/src/test/results/clientpositive/avro_decimal.q.out
index 1868de30e7..88268ceb3a 100644
--- a/ql/src/test/results/clientpositive/avro_decimal.q.out
+++ b/ql/src/test/results/clientpositive/avro_decimal.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: CREATE TABLE dec(name string, value decimal(8,4))
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dec
 POSTHOOK: query: CREATE TABLE dec(name string, value decimal(8,4))
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -54,6 +55,7 @@ TBLPROPERTIES (
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@avro_dec
 POSTHOOK: query: CREATE TABLE `avro_dec`(
   `name` string COMMENT 'from deserializer',
   `value` decimal(5,2) COMMENT 'from deserializer')
@@ -127,6 +129,7 @@ TBLPROPERTIES (
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@avro_dec1
 POSTHOOK: query: CREATE TABLE `avro_dec1`(
   `name` string COMMENT 'from deserializer',
   `value` decimal(4,1) COMMENT 'from deserializer')
diff --git a/ql/src/test/results/clientpositive/avro_decimal_native.q.out b/ql/src/test/results/clientpositive/avro_decimal_native.q.out
index bc87a7d236..c8ae0fb240 100644
--- a/ql/src/test/results/clientpositive/avro_decimal_native.q.out
+++ b/ql/src/test/results/clientpositive/avro_decimal_native.q.out
@@ -7,6 +7,7 @@ PREHOOK: query: CREATE TABLE dec (
   value decimal(8,4))
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dec
 POSTHOOK: query: CREATE TABLE dec (
   name string,
   value decimal(8,4))
@@ -49,6 +50,7 @@ COMMENT 'just drop the schema right into the HQL'
 STORED AS AVRO
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@avro_dec
 POSTHOOK: query: CREATE TABLE avro_dec(
   name string,
   value decimal(5,2))
@@ -104,6 +106,7 @@ COMMENT 'just drop the schema right into the HQL'
 STORED AS AVRO
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@avro_dec1
 POSTHOOK: query: CREATE TABLE avro_dec1(
   name string,
   value decimal(4,1))
diff --git a/ql/src/test/results/clientpositive/avro_evolved_schemas.q.out b/ql/src/test/results/clientpositive/avro_evolved_schemas.q.out
index 568f34459e..2f81b1ab9a 100644
--- a/ql/src/test/results/clientpositive/avro_evolved_schemas.q.out
+++ b/ql/src/test/results/clientpositive/avro_evolved_schemas.q.out
@@ -37,6 +37,7 @@ TBLPROPERTIES ('avro.schema.literal'='{
 }')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@doctors_with_new_field
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 -- verify that new fields in schema get propagated to table scans
diff --git a/ql/src/test/results/clientpositive/avro_joins.q.out b/ql/src/test/results/clientpositive/avro_joins.q.out
index eba7eb9fbb..7e47fe0f25 100644
--- a/ql/src/test/results/clientpositive/avro_joins.q.out
+++ b/ql/src/test/results/clientpositive/avro_joins.q.out
@@ -38,6 +38,7 @@ TBLPROPERTIES ('avro.schema.literal'='{
 }')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@doctors4
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 -- verify that new joins bring in correct schemas (including evolved schemas)
@@ -127,6 +128,7 @@ TBLPROPERTIES ('avro.schema.literal'='{
 }')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@episodes
 POSTHOOK: query: CREATE TABLE episodes
 ROW FORMAT
 SERDE 'org.apache.hadoop.hive.serde2.avro.AvroSerDe'
diff --git a/ql/src/test/results/clientpositive/avro_joins_native.q.out b/ql/src/test/results/clientpositive/avro_joins_native.q.out
index 39d3c97c6f..ca22a7279b 100644
--- a/ql/src/test/results/clientpositive/avro_joins_native.q.out
+++ b/ql/src/test/results/clientpositive/avro_joins_native.q.out
@@ -9,6 +9,7 @@ CREATE TABLE doctors4 (
 STORED AS AVRO
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@doctors4
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 -- verify that new joins bring in correct schemas (including evolved schemas)
@@ -45,6 +46,7 @@ PREHOOK: query: CREATE TABLE episodes (
 STORED AS AVRO
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@episodes
 POSTHOOK: query: CREATE TABLE episodes (
   title string COMMENT "episode title",
   air_date string COMMENT "initial date",
diff --git a/ql/src/test/results/clientpositive/avro_native.q.out b/ql/src/test/results/clientpositive/avro_native.q.out
index 68bb9c514f..2de4df1b84 100644
--- a/ql/src/test/results/clientpositive/avro_native.q.out
+++ b/ql/src/test/results/clientpositive/avro_native.q.out
@@ -8,6 +8,7 @@ CREATE TABLE doctors (
 STORED AS AVRO
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@doctors
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 -- verify that we can actually read avro files
diff --git a/ql/src/test/results/clientpositive/avro_nullable_fields.q.out b/ql/src/test/results/clientpositive/avro_nullable_fields.q.out
index d3e55a259a..5dbec57a1b 100644
--- a/ql/src/test/results/clientpositive/avro_nullable_fields.q.out
+++ b/ql/src/test/results/clientpositive/avro_nullable_fields.q.out
@@ -18,6 +18,7 @@ CREATE TABLE test_serializer(string1 STRING,
  STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_serializer
 POSTHOOK: query: -- Verify that nullable fields properly work
 CREATE TABLE test_serializer(string1 STRING,
                              int1 INT,
@@ -83,6 +84,7 @@ PREHOOK: query: CREATE TABLE as_avro
   )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@as_avro
 POSTHOOK: query: CREATE TABLE as_avro
   ROW FORMAT
   SERDE 'org.apache.hadoop.hive.serde2.avro.AvroSerDe'
diff --git a/ql/src/test/results/clientpositive/avro_partitioned.q.out b/ql/src/test/results/clientpositive/avro_partitioned.q.out
index 108714b073..890cd9f764 100644
--- a/ql/src/test/results/clientpositive/avro_partitioned.q.out
+++ b/ql/src/test/results/clientpositive/avro_partitioned.q.out
@@ -30,6 +30,7 @@ TBLPROPERTIES ('avro.schema.literal'='{
 }')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@episodes
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 -- Verify that table scans work with partitioned Avro tables
 CREATE TABLE episodes
@@ -102,6 +103,7 @@ TBLPROPERTIES ('avro.schema.literal'='{
 }')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@episodes_partitioned
 POSTHOOK: query: CREATE TABLE episodes_partitioned
 PARTITIONED BY (doctor_pt INT)
 ROW FORMAT
@@ -305,6 +307,7 @@ INPUTFORMAT 'org.apache.hadoop.hive.ql.io.avro.AvroContainerInputFormat'
 OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.avro.AvroContainerOutputFormat'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@episodes_partitioned_serdeproperties
 POSTHOOK: query: -- Verify that reading from an Avro partition works
 -- even if it has an old schema relative to the current table level schema
 
diff --git a/ql/src/test/results/clientpositive/avro_partitioned_native.q.out b/ql/src/test/results/clientpositive/avro_partitioned_native.q.out
index 3af8d9eedf..c02c656a45 100644
--- a/ql/src/test/results/clientpositive/avro_partitioned_native.q.out
+++ b/ql/src/test/results/clientpositive/avro_partitioned_native.q.out
@@ -7,6 +7,7 @@ CREATE TABLE episodes (
 STORED AS AVRO
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@episodes
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 -- Verify that table scans work with partitioned Avro tables
 CREATE TABLE episodes (
@@ -33,6 +34,7 @@ PARTITIONED BY (doctor_pt INT)
 STORED AS AVRO
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@episodes_partitioned
 POSTHOOK: query: CREATE TABLE episodes_partitioned (
   title string COMMENT "episode title",
   air_date string COMMENT "initial date",
diff --git a/ql/src/test/results/clientpositive/avro_sanity_test.q.out b/ql/src/test/results/clientpositive/avro_sanity_test.q.out
index 8528bc5542..687579e69b 100644
--- a/ql/src/test/results/clientpositive/avro_sanity_test.q.out
+++ b/ql/src/test/results/clientpositive/avro_sanity_test.q.out
@@ -31,6 +31,7 @@ TBLPROPERTIES ('avro.schema.literal'='{
 }')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@doctors
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 -- verify that we can actually read avro files
diff --git a/ql/src/test/results/clientpositive/avro_schema_error_message.q.out b/ql/src/test/results/clientpositive/avro_schema_error_message.q.out
index 1ead961108..967a84737a 100644
--- a/ql/src/test/results/clientpositive/avro_schema_error_message.q.out
+++ b/ql/src/test/results/clientpositive/avro_schema_error_message.q.out
@@ -8,6 +8,7 @@ INPUTFORMAT 'org.apache.hadoop.hive.ql.io.avro.AvroContainerInputFormat'
 OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.avro.AvroContainerOutputFormat'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@avro_with_no_schema
 POSTHOOK: query: -- verify we get the sentinel schema if we don't provide one
 
 CREATE TABLE avro_with_no_schema
diff --git a/ql/src/test/results/clientpositive/avro_schema_evolution_native.q.out b/ql/src/test/results/clientpositive/avro_schema_evolution_native.q.out
index f471601e9d..84d8051422 100644
--- a/ql/src/test/results/clientpositive/avro_schema_evolution_native.q.out
+++ b/ql/src/test/results/clientpositive/avro_schema_evolution_native.q.out
@@ -7,6 +7,7 @@ CREATE TABLE episodes (
 STORED AS AVRO
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@episodes
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 -- Verify that table scans work with partitioned Avro tables
 CREATE TABLE episodes (
@@ -33,6 +34,7 @@ PARTITIONED BY (doctor_pt INT)
 STORED AS AVRO
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@episodes_partitioned
 POSTHOOK: query: CREATE TABLE episodes_partitioned (
   title string COMMENT "episode title",
   air_date string COMMENT "initial date",
diff --git a/ql/src/test/results/clientpositive/avro_schema_literal.q.out b/ql/src/test/results/clientpositive/avro_schema_literal.q.out
index 05537178e2..b13694d160 100644
--- a/ql/src/test/results/clientpositive/avro_schema_literal.q.out
+++ b/ql/src/test/results/clientpositive/avro_schema_literal.q.out
@@ -30,6 +30,7 @@ TBLPROPERTIES ('avro.schema.literal'='{
   ] }')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@avro1
 POSTHOOK: query: CREATE TABLE avro1
 ROW FORMAT
 SERDE 'org.apache.hadoop.hive.serde2.avro.AvroSerDe'
diff --git a/ql/src/test/results/clientpositive/ba_table1.q.out b/ql/src/test/results/clientpositive/ba_table1.q.out
index d35e6eef5a..14862a7f28 100644
--- a/ql/src/test/results/clientpositive/ba_table1.q.out
+++ b/ql/src/test/results/clientpositive/ba_table1.q.out
@@ -11,6 +11,7 @@ PREHOOK: query: -- This query tests a) binary type works correctly in grammar b)
 create table ba_test (ba_key binary, ba_val binary)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@ba_test
 POSTHOOK: query: -- This query tests a) binary type works correctly in grammar b) string can be cast into binary c) binary can be stored in a table d) binary data can be loaded back again and queried d) order-by on a binary key 
 
 create table ba_test (ba_key binary, ba_val binary)
diff --git a/ql/src/test/results/clientpositive/ba_table2.q.out b/ql/src/test/results/clientpositive/ba_table2.q.out
index 957401617b..4159648632 100644
--- a/ql/src/test/results/clientpositive/ba_table2.q.out
+++ b/ql/src/test/results/clientpositive/ba_table2.q.out
@@ -11,6 +11,7 @@ PREHOOK: query: -- All the test in ba_test1.q + using LazyBinarySerde instead of
 create table ba_test (ba_key binary, ba_val binary)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@ba_test
 POSTHOOK: query: -- All the test in ba_test1.q + using LazyBinarySerde instead of LazySimpleSerde
 
 create table ba_test (ba_key binary, ba_val binary)
diff --git a/ql/src/test/results/clientpositive/ba_table3.q.out b/ql/src/test/results/clientpositive/ba_table3.q.out
index 5492e6db89..e1089d37cf 100644
--- a/ql/src/test/results/clientpositive/ba_table3.q.out
+++ b/ql/src/test/results/clientpositive/ba_table3.q.out
@@ -7,6 +7,7 @@ PREHOOK: query: -- All the tests of ba_table1.q + test for a group-by and aggreg
 create table ba_test (ba_key binary, ba_val binary)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@ba_test
 POSTHOOK: query: -- All the tests of ba_table1.q + test for a group-by and aggregation on a binary key.
 
 create table ba_test (ba_key binary, ba_val binary)
diff --git a/ql/src/test/results/clientpositive/ba_table_udfs.q.out b/ql/src/test/results/clientpositive/ba_table_udfs.q.out
index 0be108aa6d..26eb1654cc 100644
--- a/ql/src/test/results/clientpositive/ba_table_udfs.q.out
+++ b/ql/src/test/results/clientpositive/ba_table_udfs.q.out
@@ -2,15 +2,18 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 
 USE default
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:default
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 USE default
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:default
 PREHOOK: query: CREATE TABLE dest1(bytes1 BINARY,
                    bytes2 BINARY,
                    string STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(bytes1 BINARY,
                    bytes2 BINARY,
                    string STRING)
diff --git a/ql/src/test/results/clientpositive/ba_table_union.q.out b/ql/src/test/results/clientpositive/ba_table_union.q.out
index 7c6725a3ad..706a537e5e 100644
--- a/ql/src/test/results/clientpositive/ba_table_union.q.out
+++ b/ql/src/test/results/clientpositive/ba_table_union.q.out
@@ -6,6 +6,7 @@ PREHOOK: query: -- this query tests ba_table1.q + nested queries with multiple o
 create table ba_test (ba_key binary, ba_val binary)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@ba_test
 POSTHOOK: query: -- this query tests ba_table1.q + nested queries with multiple operations on binary data types + union on binary types 
 create table ba_test (ba_key binary, ba_val binary)
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/binary_output_format.q.out b/ql/src/test/results/clientpositive/binary_output_format.q.out
index 294aabbf7c..b42222d1e8 100644
--- a/ql/src/test/results/clientpositive/binary_output_format.q.out
+++ b/ql/src/test/results/clientpositive/binary_output_format.q.out
@@ -10,6 +10,7 @@ STORED AS
   OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveBinaryOutputFormat'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: -- Create a table with binary output format
 CREATE TABLE dest1(mydata STRING)
 ROW FORMAT SERDE
diff --git a/ql/src/test/results/clientpositive/binary_table_bincolserde.q.out b/ql/src/test/results/clientpositive/binary_table_bincolserde.q.out
index 570a46a41c..24c5edcd32 100644
--- a/ql/src/test/results/clientpositive/binary_table_bincolserde.q.out
+++ b/ql/src/test/results/clientpositive/binary_table_bincolserde.q.out
@@ -7,6 +7,7 @@ PREHOOK: query: -- Tests everything in binary_table_colserde.q + uses LazyBinary
 create table ba_test (ba_key binary, ba_val binary) stored as rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@ba_test
 POSTHOOK: query: -- Tests everything in binary_table_colserde.q + uses LazyBinaryColumnarSerde
 
 create table ba_test (ba_key binary, ba_val binary) stored as rcfile
diff --git a/ql/src/test/results/clientpositive/binary_table_colserde.q.out b/ql/src/test/results/clientpositive/binary_table_colserde.q.out
index 6c6169c4a9..3a026f3902 100644
--- a/ql/src/test/results/clientpositive/binary_table_colserde.q.out
+++ b/ql/src/test/results/clientpositive/binary_table_colserde.q.out
@@ -7,6 +7,7 @@ PREHOOK: query: -- Everything in ba_table1.q + columnar serde in RCFILE.
 create table ba_test (ba_key binary, ba_val binary) stored as rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@ba_test
 POSTHOOK: query: -- Everything in ba_table1.q + columnar serde in RCFILE.
 
 create table ba_test (ba_key binary, ba_val binary) stored as rcfile
diff --git a/ql/src/test/results/clientpositive/binarysortable_1.q.out b/ql/src/test/results/clientpositive/binarysortable_1.q.out
index 632dca1919..7ff3fd4069 100644
--- a/ql/src/test/results/clientpositive/binarysortable_1.q.out
+++ b/ql/src/test/results/clientpositive/binarysortable_1.q.out
@@ -4,6 +4,7 @@ FIELDS TERMINATED BY '9'
 STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@mytable
 POSTHOOK: query: CREATE TABLE mytable(key STRING, value STRING)
 ROW FORMAT DELIMITED
 FIELDS TERMINATED BY '9'
diff --git a/ql/src/test/results/clientpositive/bool_literal.q.out b/ql/src/test/results/clientpositive/bool_literal.q.out
index 59dff8c8be..f9b816c52d 100644
--- a/ql/src/test/results/clientpositive/bool_literal.q.out
+++ b/ql/src/test/results/clientpositive/bool_literal.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: CREATE TABLE bool_literal(key int, value boolean)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bool_literal
 POSTHOOK: query: CREATE TABLE bool_literal(key int, value boolean)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/bucket1.q.out b/ql/src/test/results/clientpositive/bucket1.q.out
index 17451ae2a4..6737a8509d 100644
--- a/ql/src/test/results/clientpositive/bucket1.q.out
+++ b/ql/src/test/results/clientpositive/bucket1.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE bucket1_1(key int, value string) CLUSTERED BY (key) INTO 100 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucket1_1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE bucket1_1(key int, value string) CLUSTERED BY (key) INTO 100 BUCKETS
diff --git a/ql/src/test/results/clientpositive/bucket2.q.out b/ql/src/test/results/clientpositive/bucket2.q.out
index f16e2af258..a945d8e0ff 100644
--- a/ql/src/test/results/clientpositive/bucket2.q.out
+++ b/ql/src/test/results/clientpositive/bucket2.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE bucket2_1(key int, value string) CLUSTERED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucket2_1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE bucket2_1(key int, value string) CLUSTERED BY (key) INTO 2 BUCKETS
diff --git a/ql/src/test/results/clientpositive/bucket3.q.out b/ql/src/test/results/clientpositive/bucket3.q.out
index 551a98d095..e81ef660d0 100644
--- a/ql/src/test/results/clientpositive/bucket3.q.out
+++ b/ql/src/test/results/clientpositive/bucket3.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE bucket3_1(key int, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucket3_1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE bucket3_1(key int, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 2 BUCKETS
diff --git a/ql/src/test/results/clientpositive/bucket4.q.out b/ql/src/test/results/clientpositive/bucket4.q.out
index 8851161cf3..ddaad9805c 100644
--- a/ql/src/test/results/clientpositive/bucket4.q.out
+++ b/ql/src/test/results/clientpositive/bucket4.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE bucket4_1(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucket4_1
 POSTHOOK: query: CREATE TABLE bucket4_1(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/bucket5.q.out b/ql/src/test/results/clientpositive/bucket5.q.out
index 70a4fdf2ea..7432c7d1e1 100644
--- a/ql/src/test/results/clientpositive/bucket5.q.out
+++ b/ql/src/test/results/clientpositive/bucket5.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: -- Tests that when a multi insert inserts into a bucketed table
 CREATE TABLE bucketed_table(key INT, value STRING) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucketed_table
 POSTHOOK: query: -- Tests that when a multi insert inserts into a bucketed table and a table which is not bucketed
 -- the bucketed table is not merged and the table which is not bucketed is
 
@@ -14,6 +15,7 @@ POSTHOOK: Output: default@bucketed_table
 PREHOOK: query: CREATE TABLE unbucketed_table(key INT, value STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@unbucketed_table
 POSTHOOK: query: CREATE TABLE unbucketed_table(key INT, value STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/bucket6.q.out b/ql/src/test/results/clientpositive/bucket6.q.out
index cd17edadd2..9e7d5b7fd4 100644
--- a/ql/src/test/results/clientpositive/bucket6.q.out
+++ b/ql/src/test/results/clientpositive/bucket6.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE src_bucket(key STRING, value STRING) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_bucket
 POSTHOOK: query: CREATE TABLE src_bucket(key STRING, value STRING) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/bucket_groupby.q.out b/ql/src/test/results/clientpositive/bucket_groupby.q.out
index ba0f8d8a63..2f0405158a 100644
--- a/ql/src/test/results/clientpositive/bucket_groupby.q.out
+++ b/ql/src/test/results/clientpositive/bucket_groupby.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table clustergroupby(key string, value string) partitioned by(ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@clustergroupby
 POSTHOOK: query: create table clustergroupby(key string, value string) partitioned by(ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -995,6 +996,7 @@ POSTHOOK: Output: default@clustergroupby
 PREHOOK: query: create table clustergroupby(key string, value string) partitioned by(ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@clustergroupby
 POSTHOOK: query: create table clustergroupby(key string, value string) partitioned by(ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -1293,6 +1295,7 @@ POSTHOOK: Output: default@clustergroupby
 PREHOOK: query: create table clustergroupby(key string, value string) partitioned by(ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@clustergroupby
 POSTHOOK: query: create table clustergroupby(key string, value string) partitioned by(ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/bucket_if_with_path_filter.q.out b/ql/src/test/results/clientpositive/bucket_if_with_path_filter.q.out
index 38792a6db4..b4ca9e6841 100644
--- a/ql/src/test/results/clientpositive/bucket_if_with_path_filter.q.out
+++ b/ql/src/test/results/clientpositive/bucket_if_with_path_filter.q.out
@@ -2,6 +2,7 @@
 PREHOOK: type: CREATETABLE
 #### A masked pattern was here ####
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t1
 #### A masked pattern was here ####
 POSTHOOK: type: CREATETABLE
 #### A masked pattern was here ####
@@ -10,6 +11,7 @@ POSTHOOK: Output: default@t1
 PREHOOK: query: Create table t2 (dt string) stored as orc
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t2
 POSTHOOK: query: Create table t2 (dt string) stored as orc
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/bucket_map_join_1.q.out b/ql/src/test/results/clientpositive/bucket_map_join_1.q.out
index 63fb0d19e6..b194a2be3e 100644
--- a/ql/src/test/results/clientpositive/bucket_map_join_1.q.out
+++ b/ql/src/test/results/clientpositive/bucket_map_join_1.q.out
@@ -10,6 +10,7 @@ PREHOOK: query: create table table1(key string, value string) clustered by (key,
 sorted by (key, value) into 1 BUCKETS stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table1
 POSTHOOK: query: create table table1(key string, value string) clustered by (key, value)
 sorted by (key, value) into 1 BUCKETS stored as textfile
 POSTHOOK: type: CREATETABLE
@@ -19,6 +20,7 @@ PREHOOK: query: create table table2(key string, value string) clustered by (valu
 sorted by (value, key) into 1 BUCKETS stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table2
 POSTHOOK: query: create table table2(key string, value string) clustered by (value, key)
 sorted by (value, key) into 1 BUCKETS stored as textfile
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/bucket_map_join_2.q.out b/ql/src/test/results/clientpositive/bucket_map_join_2.q.out
index 21f2d5a317..07c8878541 100644
--- a/ql/src/test/results/clientpositive/bucket_map_join_2.q.out
+++ b/ql/src/test/results/clientpositive/bucket_map_join_2.q.out
@@ -10,6 +10,7 @@ PREHOOK: query: create table table1(key string, value string) clustered by (key,
 sorted by (key desc, value desc) into 1 BUCKETS stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table1
 POSTHOOK: query: create table table1(key string, value string) clustered by (key, value)
 sorted by (key desc, value desc) into 1 BUCKETS stored as textfile
 POSTHOOK: type: CREATETABLE
@@ -19,6 +20,7 @@ PREHOOK: query: create table table2(key string, value string) clustered by (valu
 sorted by (value desc, key desc) into 1 BUCKETS stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table2
 POSTHOOK: query: create table table2(key string, value string) clustered by (value, key)
 sorted by (value desc, key desc) into 1 BUCKETS stored as textfile
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/bucket_num_reducers.q.out b/ql/src/test/results/clientpositive/bucket_num_reducers.q.out
index 833b18a385..a760592b71 100644
--- a/ql/src/test/results/clientpositive/bucket_num_reducers.q.out
+++ b/ql/src/test/results/clientpositive/bucket_num_reducers.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: -- This test sets number of mapred tasks to 10 for a database wi
 CREATE TABLE bucket_nr(key int, value string) CLUSTERED BY (key) INTO 50 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucket_nr
 POSTHOOK: query: -- This test sets number of mapred tasks to 10 for a database with 50 buckets, 
 -- and uses a post-hook to confirm that 10 tasks were created
 
diff --git a/ql/src/test/results/clientpositive/bucket_num_reducers2.q.out b/ql/src/test/results/clientpositive/bucket_num_reducers2.q.out
index d1c499f22e..a16a50239a 100644
--- a/ql/src/test/results/clientpositive/bucket_num_reducers2.q.out
+++ b/ql/src/test/results/clientpositive/bucket_num_reducers2.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: -- This test sets the maximum number of reduce tasks to 2 for ov
 CREATE TABLE test_table(key int, value string) CLUSTERED BY (key) INTO 3 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table
 POSTHOOK: query: -- This test sets the maximum number of reduce tasks to 2 for overwriting a
 -- table with 3 buckets, and uses a post-hook to confirm that 1 reducer was used
 
diff --git a/ql/src/test/results/clientpositive/bucketcontext_1.q.out b/ql/src/test/results/clientpositive/bucketcontext_1.q.out
index 5212de3d10..0ea304dbff 100644
--- a/ql/src/test/results/clientpositive/bucketcontext_1.q.out
+++ b/ql/src/test/results/clientpositive/bucketcontext_1.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- small 1 part, 2 bucket & big 2 part, 4 bucket
 CREATE TABLE bucket_small (key string, value string) partitioned by (ds string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucket_small
 POSTHOOK: query: -- small 1 part, 2 bucket & big 2 part, 4 bucket
 CREATE TABLE bucket_small (key string, value string) partitioned by (ds string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
@@ -27,6 +28,7 @@ POSTHOOK: Output: default@bucket_small@ds=2008-04-08
 PREHOOK: query: CREATE TABLE bucket_big (key string, value string) partitioned by (ds string) CLUSTERED BY (key) SORTED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucket_big
 POSTHOOK: query: CREATE TABLE bucket_big (key string, value string) partitioned by (ds string) CLUSTERED BY (key) SORTED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/bucketcontext_2.q.out b/ql/src/test/results/clientpositive/bucketcontext_2.q.out
index d86c43009e..e961f062d1 100644
--- a/ql/src/test/results/clientpositive/bucketcontext_2.q.out
+++ b/ql/src/test/results/clientpositive/bucketcontext_2.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- small 1 part, 4 bucket & big 2 part, 2 bucket
 CREATE TABLE bucket_small (key string, value string) partitioned by (ds string) CLUSTERED BY (key) SORTED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucket_small
 POSTHOOK: query: -- small 1 part, 4 bucket & big 2 part, 2 bucket
 CREATE TABLE bucket_small (key string, value string) partitioned by (ds string) CLUSTERED BY (key) SORTED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
@@ -43,6 +44,7 @@ POSTHOOK: Output: default@bucket_small@ds=2008-04-08
 PREHOOK: query: CREATE TABLE bucket_big (key string, value string) partitioned by (ds string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucket_big
 POSTHOOK: query: CREATE TABLE bucket_big (key string, value string) partitioned by (ds string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/bucketcontext_3.q.out b/ql/src/test/results/clientpositive/bucketcontext_3.q.out
index a536e8b268..1de62119c2 100644
--- a/ql/src/test/results/clientpositive/bucketcontext_3.q.out
+++ b/ql/src/test/results/clientpositive/bucketcontext_3.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- small 2 part, 2 bucket & big 1 part, 4 bucket
 CREATE TABLE bucket_small (key string, value string) partitioned by (ds string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucket_small
 POSTHOOK: query: -- small 2 part, 2 bucket & big 1 part, 4 bucket
 CREATE TABLE bucket_small (key string, value string) partitioned by (ds string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
@@ -44,6 +45,7 @@ POSTHOOK: Output: default@bucket_small@ds=2008-04-09
 PREHOOK: query: CREATE TABLE bucket_big (key string, value string) partitioned by (ds string) CLUSTERED BY (key) SORTED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucket_big
 POSTHOOK: query: CREATE TABLE bucket_big (key string, value string) partitioned by (ds string) CLUSTERED BY (key) SORTED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/bucketcontext_4.q.out b/ql/src/test/results/clientpositive/bucketcontext_4.q.out
index 26c8720aec..f0e369dfd8 100644
--- a/ql/src/test/results/clientpositive/bucketcontext_4.q.out
+++ b/ql/src/test/results/clientpositive/bucketcontext_4.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- small 2 part, 4 bucket & big 1 part, 2 bucket
 CREATE TABLE bucket_small (key string, value string) partitioned by (ds string) CLUSTERED BY (key) SORTED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucket_small
 POSTHOOK: query: -- small 2 part, 4 bucket & big 1 part, 2 bucket
 CREATE TABLE bucket_small (key string, value string) partitioned by (ds string) CLUSTERED BY (key) SORTED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
@@ -76,6 +77,7 @@ POSTHOOK: Output: default@bucket_small@ds=2008-04-09
 PREHOOK: query: CREATE TABLE bucket_big (key string, value string) partitioned by (ds string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucket_big
 POSTHOOK: query: CREATE TABLE bucket_big (key string, value string) partitioned by (ds string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/bucketcontext_5.q.out b/ql/src/test/results/clientpositive/bucketcontext_5.q.out
index 2619cfb44f..085cce9f89 100644
--- a/ql/src/test/results/clientpositive/bucketcontext_5.q.out
+++ b/ql/src/test/results/clientpositive/bucketcontext_5.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- small no part, 4 bucket & big no part, 2 bucket
 CREATE TABLE bucket_small (key string, value string) CLUSTERED BY (key) SORTED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucket_small
 POSTHOOK: query: -- small no part, 4 bucket & big no part, 2 bucket
 CREATE TABLE bucket_small (key string, value string) CLUSTERED BY (key) SORTED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
@@ -42,6 +43,7 @@ POSTHOOK: Output: default@bucket_small
 PREHOOK: query: CREATE TABLE bucket_big (key string, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucket_big
 POSTHOOK: query: CREATE TABLE bucket_big (key string, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/bucketcontext_6.q.out b/ql/src/test/results/clientpositive/bucketcontext_6.q.out
index 4c42ca7370..209be0a66d 100644
--- a/ql/src/test/results/clientpositive/bucketcontext_6.q.out
+++ b/ql/src/test/results/clientpositive/bucketcontext_6.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- small no part, 4 bucket & big 2 part, 2 bucket
 CREATE TABLE bucket_small (key string, value string) CLUSTERED BY (key) SORTED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucket_small
 POSTHOOK: query: -- small no part, 4 bucket & big 2 part, 2 bucket
 CREATE TABLE bucket_small (key string, value string) CLUSTERED BY (key) SORTED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
@@ -42,6 +43,7 @@ POSTHOOK: Output: default@bucket_small
 PREHOOK: query: CREATE TABLE bucket_big (key string, value string) partitioned by (ds string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucket_big
 POSTHOOK: query: CREATE TABLE bucket_big (key string, value string) partitioned by (ds string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/bucketcontext_7.q.out b/ql/src/test/results/clientpositive/bucketcontext_7.q.out
index 7e5afb56f6..11054d64a7 100644
--- a/ql/src/test/results/clientpositive/bucketcontext_7.q.out
+++ b/ql/src/test/results/clientpositive/bucketcontext_7.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- small 2 part, 4 bucket & big 2 part, 2 bucket
 CREATE TABLE bucket_small (key string, value string) partitioned by (ds string) CLUSTERED BY (key) SORTED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucket_small
 POSTHOOK: query: -- small 2 part, 4 bucket & big 2 part, 2 bucket
 CREATE TABLE bucket_small (key string, value string) partitioned by (ds string) CLUSTERED BY (key) SORTED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
@@ -76,6 +77,7 @@ POSTHOOK: Output: default@bucket_small@ds=2008-04-09
 PREHOOK: query: CREATE TABLE bucket_big (key string, value string) partitioned by (ds string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucket_big
 POSTHOOK: query: CREATE TABLE bucket_big (key string, value string) partitioned by (ds string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/bucketcontext_8.q.out b/ql/src/test/results/clientpositive/bucketcontext_8.q.out
index 243b67a76e..e9927028c3 100644
--- a/ql/src/test/results/clientpositive/bucketcontext_8.q.out
+++ b/ql/src/test/results/clientpositive/bucketcontext_8.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- small 2 part, 2 bucket & big 2 part, 4 bucket
 CREATE TABLE bucket_small (key string, value string) partitioned by (ds string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucket_small
 POSTHOOK: query: -- small 2 part, 2 bucket & big 2 part, 4 bucket
 CREATE TABLE bucket_small (key string, value string) partitioned by (ds string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
@@ -44,6 +45,7 @@ POSTHOOK: Output: default@bucket_small@ds=2008-04-09
 PREHOOK: query: CREATE TABLE bucket_big (key string, value string) partitioned by (ds string) CLUSTERED BY (key) SORTED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucket_big
 POSTHOOK: query: CREATE TABLE bucket_big (key string, value string) partitioned by (ds string) CLUSTERED BY (key) SORTED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/bucketizedhiveinputformat.q.out b/ql/src/test/results/clientpositive/bucketizedhiveinputformat.q.out
index 1b3ca1d1d4..277b0f7a28 100644
--- a/ql/src/test/results/clientpositive/bucketizedhiveinputformat.q.out
+++ b/ql/src/test/results/clientpositive/bucketizedhiveinputformat.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE T1(name STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: CREATE TABLE T1(name STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -16,6 +17,7 @@ POSTHOOK: Output: default@t1
 PREHOOK: query: CREATE TABLE T2(name STRING) STORED AS SEQUENCEFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T2
 POSTHOOK: query: CREATE TABLE T2(name STRING) STORED AS SEQUENCEFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -42,6 +44,7 @@ POSTHOOK: Lineage: t2.name SIMPLE [(t1)t1.FieldSchema(name:name, type:string, co
 PREHOOK: query: CREATE TABLE T3(name STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T3
 POSTHOOK: query: CREATE TABLE T3(name STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/bucketizedhiveinputformat_auto.q.out b/ql/src/test/results/clientpositive/bucketizedhiveinputformat_auto.q.out
index 64b5f9f03a..215efdd2c6 100644
--- a/ql/src/test/results/clientpositive/bucketizedhiveinputformat_auto.q.out
+++ b/ql/src/test/results/clientpositive/bucketizedhiveinputformat_auto.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE bucket_small (key string, value string) partitioned by (ds string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucket_small
 POSTHOOK: query: CREATE TABLE bucket_small (key string, value string) partitioned by (ds string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -25,6 +26,7 @@ POSTHOOK: Output: default@bucket_small@ds=2008-04-08
 PREHOOK: query: CREATE TABLE bucket_big (key string, value string) partitioned by (ds string) CLUSTERED BY (key) SORTED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucket_big
 POSTHOOK: query: CREATE TABLE bucket_big (key string, value string) partitioned by (ds string) CLUSTERED BY (key) SORTED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/bucketmapjoin1.q.out b/ql/src/test/results/clientpositive/bucketmapjoin1.q.out
index 10f1af47ef..1746abae96 100644
--- a/ql/src/test/results/clientpositive/bucketmapjoin1.q.out
+++ b/ql/src/test/results/clientpositive/bucketmapjoin1.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE srcbucket_mapjoin(key int, value string) CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcbucket_mapjoin
 POSTHOOK: query: CREATE TABLE srcbucket_mapjoin(key int, value string) CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@srcbucket_mapjoin
 PREHOOK: query: CREATE TABLE srcbucket_mapjoin_part (key int, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcbucket_mapjoin_part
 POSTHOOK: query: CREATE TABLE srcbucket_mapjoin_part (key int, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -15,6 +17,7 @@ POSTHOOK: Output: default@srcbucket_mapjoin_part
 PREHOOK: query: CREATE TABLE srcbucket_mapjoin_part_2 (key int, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcbucket_mapjoin_part_2
 POSTHOOK: query: CREATE TABLE srcbucket_mapjoin_part_2 (key int, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -344,6 +347,7 @@ POSTHOOK: Output: default@srcbucket_mapjoin_part_2@ds=2008-04-08
 PREHOOK: query: create table bucketmapjoin_hash_result_1 (key bigint , value1 bigint, value2 bigint)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucketmapjoin_hash_result_1
 POSTHOOK: query: create table bucketmapjoin_hash_result_1 (key bigint , value1 bigint, value2 bigint)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -351,6 +355,7 @@ POSTHOOK: Output: default@bucketmapjoin_hash_result_1
 PREHOOK: query: create table bucketmapjoin_hash_result_2 (key bigint , value1 bigint, value2 bigint)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucketmapjoin_hash_result_2
 POSTHOOK: query: create table bucketmapjoin_hash_result_2 (key bigint , value1 bigint, value2 bigint)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -358,6 +363,7 @@ POSTHOOK: Output: default@bucketmapjoin_hash_result_2
 PREHOOK: query: create table bucketmapjoin_tmp_result (key string , value1 string, value2 string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucketmapjoin_tmp_result
 POSTHOOK: query: create table bucketmapjoin_tmp_result (key string , value1 string, value2 string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/bucketmapjoin10.q.out b/ql/src/test/results/clientpositive/bucketmapjoin10.q.out
index f852cde51f..c77f417883 100644
--- a/ql/src/test/results/clientpositive/bucketmapjoin10.q.out
+++ b/ql/src/test/results/clientpositive/bucketmapjoin10.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: CREATE TABLE srcbucket_mapjoin_part_1 (key INT, value STRING) PA
 CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcbucket_mapjoin_part_1
 POSTHOOK: query: CREATE TABLE srcbucket_mapjoin_part_1 (key INT, value STRING) PARTITIONED BY (part STRING) 
 CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
@@ -61,6 +62,7 @@ PREHOOK: query: CREATE TABLE srcbucket_mapjoin_part_2 (key INT, value STRING) PA
 CLUSTERED BY (key) INTO 3 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcbucket_mapjoin_part_2
 POSTHOOK: query: CREATE TABLE srcbucket_mapjoin_part_2 (key INT, value STRING) PARTITIONED BY (part STRING) 
 CLUSTERED BY (key) INTO 3 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/bucketmapjoin11.q.out b/ql/src/test/results/clientpositive/bucketmapjoin11.q.out
index 97e80fb390..c85ba9246e 100644
--- a/ql/src/test/results/clientpositive/bucketmapjoin11.q.out
+++ b/ql/src/test/results/clientpositive/bucketmapjoin11.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: CREATE TABLE srcbucket_mapjoin_part_1 (key INT, value STRING) PA
 CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcbucket_mapjoin_part_1
 POSTHOOK: query: CREATE TABLE srcbucket_mapjoin_part_1 (key INT, value STRING) PARTITIONED BY (part STRING) 
 CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
@@ -69,6 +70,7 @@ PREHOOK: query: CREATE TABLE srcbucket_mapjoin_part_2 (key INT, value STRING) PA
 CLUSTERED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcbucket_mapjoin_part_2
 POSTHOOK: query: CREATE TABLE srcbucket_mapjoin_part_2 (key INT, value STRING) PARTITIONED BY (part STRING) 
 CLUSTERED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/bucketmapjoin12.q.out b/ql/src/test/results/clientpositive/bucketmapjoin12.q.out
index e486ca5975..9e8c327367 100644
--- a/ql/src/test/results/clientpositive/bucketmapjoin12.q.out
+++ b/ql/src/test/results/clientpositive/bucketmapjoin12.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: CREATE TABLE srcbucket_mapjoin_part_1 (key INT, value STRING) PA
 CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcbucket_mapjoin_part_1
 POSTHOOK: query: CREATE TABLE srcbucket_mapjoin_part_1 (key INT, value STRING) PARTITIONED BY (part STRING) 
 CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
@@ -28,6 +29,7 @@ PREHOOK: query: CREATE TABLE srcbucket_mapjoin_part_2 (key INT, value STRING) PA
 CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcbucket_mapjoin_part_2
 POSTHOOK: query: CREATE TABLE srcbucket_mapjoin_part_2 (key INT, value STRING) PARTITIONED BY (part STRING) 
 CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
@@ -62,6 +64,7 @@ PREHOOK: query: CREATE TABLE srcbucket_mapjoin_part_3 (key INT, value STRING) PA
 STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcbucket_mapjoin_part_3
 POSTHOOK: query: CREATE TABLE srcbucket_mapjoin_part_3 (key INT, value STRING) PARTITIONED BY (part STRING)
 STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/bucketmapjoin13.q.out b/ql/src/test/results/clientpositive/bucketmapjoin13.q.out
index 79fe3b3edc..760a2b8c73 100644
--- a/ql/src/test/results/clientpositive/bucketmapjoin13.q.out
+++ b/ql/src/test/results/clientpositive/bucketmapjoin13.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: CREATE TABLE srcbucket_mapjoin_part_1 (key INT, value STRING) PA
 CLUSTERED BY (value) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcbucket_mapjoin_part_1
 POSTHOOK: query: CREATE TABLE srcbucket_mapjoin_part_1 (key INT, value STRING) PARTITIONED BY (part STRING) 
 CLUSTERED BY (value) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
@@ -47,6 +48,7 @@ PREHOOK: query: CREATE TABLE srcbucket_mapjoin_part_2 (key INT, value STRING) PA
 CLUSTERED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcbucket_mapjoin_part_2
 POSTHOOK: query: CREATE TABLE srcbucket_mapjoin_part_2 (key INT, value STRING) PARTITIONED BY (part STRING) 
 CLUSTERED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/bucketmapjoin2.q.out b/ql/src/test/results/clientpositive/bucketmapjoin2.q.out
index 297412fdbb..729f3f460b 100644
--- a/ql/src/test/results/clientpositive/bucketmapjoin2.q.out
+++ b/ql/src/test/results/clientpositive/bucketmapjoin2.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE srcbucket_mapjoin_part (key int, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcbucket_mapjoin_part
 POSTHOOK: query: CREATE TABLE srcbucket_mapjoin_part (key int, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -41,6 +42,7 @@ POSTHOOK: Output: default@srcbucket_mapjoin_part@ds=2008-04-08
 PREHOOK: query: CREATE TABLE srcbucket_mapjoin_part_2 (key int, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcbucket_mapjoin_part_2
 POSTHOOK: query: CREATE TABLE srcbucket_mapjoin_part_2 (key int, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -65,6 +67,7 @@ POSTHOOK: Output: default@srcbucket_mapjoin_part_2@ds=2008-04-08
 PREHOOK: query: create table bucketmapjoin_hash_result_1 (key bigint , value1 bigint, value2 bigint)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucketmapjoin_hash_result_1
 POSTHOOK: query: create table bucketmapjoin_hash_result_1 (key bigint , value1 bigint, value2 bigint)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -72,6 +75,7 @@ POSTHOOK: Output: default@bucketmapjoin_hash_result_1
 PREHOOK: query: create table bucketmapjoin_hash_result_2 (key bigint , value1 bigint, value2 bigint)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucketmapjoin_hash_result_2
 POSTHOOK: query: create table bucketmapjoin_hash_result_2 (key bigint , value1 bigint, value2 bigint)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -79,6 +83,7 @@ POSTHOOK: Output: default@bucketmapjoin_hash_result_2
 PREHOOK: query: create table bucketmapjoin_tmp_result (key string , value1 string, value2 string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucketmapjoin_tmp_result
 POSTHOOK: query: create table bucketmapjoin_tmp_result (key string , value1 string, value2 string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/bucketmapjoin3.q.out b/ql/src/test/results/clientpositive/bucketmapjoin3.q.out
index 7f307a047d..f63bb5760c 100644
--- a/ql/src/test/results/clientpositive/bucketmapjoin3.q.out
+++ b/ql/src/test/results/clientpositive/bucketmapjoin3.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE srcbucket_mapjoin(key int, value string) CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcbucket_mapjoin
 POSTHOOK: query: CREATE TABLE srcbucket_mapjoin(key int, value string) CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -24,6 +25,7 @@ POSTHOOK: Output: default@srcbucket_mapjoin
 PREHOOK: query: CREATE TABLE srcbucket_mapjoin_part (key int, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcbucket_mapjoin_part
 POSTHOOK: query: CREATE TABLE srcbucket_mapjoin_part (key int, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -64,6 +66,7 @@ POSTHOOK: Output: default@srcbucket_mapjoin_part@ds=2008-04-08
 PREHOOK: query: CREATE TABLE srcbucket_mapjoin_part_2 (key int, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcbucket_mapjoin_part_2
 POSTHOOK: query: CREATE TABLE srcbucket_mapjoin_part_2 (key int, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -88,6 +91,7 @@ POSTHOOK: Output: default@srcbucket_mapjoin_part_2@ds=2008-04-08
 PREHOOK: query: create table bucketmapjoin_hash_result_1 (key bigint , value1 bigint, value2 bigint)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucketmapjoin_hash_result_1
 POSTHOOK: query: create table bucketmapjoin_hash_result_1 (key bigint , value1 bigint, value2 bigint)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -95,6 +99,7 @@ POSTHOOK: Output: default@bucketmapjoin_hash_result_1
 PREHOOK: query: create table bucketmapjoin_hash_result_2 (key bigint , value1 bigint, value2 bigint)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucketmapjoin_hash_result_2
 POSTHOOK: query: create table bucketmapjoin_hash_result_2 (key bigint , value1 bigint, value2 bigint)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -102,6 +107,7 @@ POSTHOOK: Output: default@bucketmapjoin_hash_result_2
 PREHOOK: query: create table bucketmapjoin_tmp_result (key string , value1 string, value2 string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucketmapjoin_tmp_result
 POSTHOOK: query: create table bucketmapjoin_tmp_result (key string , value1 string, value2 string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/bucketmapjoin4.q.out b/ql/src/test/results/clientpositive/bucketmapjoin4.q.out
index f0f9aeed26..a58af3a322 100644
--- a/ql/src/test/results/clientpositive/bucketmapjoin4.q.out
+++ b/ql/src/test/results/clientpositive/bucketmapjoin4.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE srcbucket_mapjoin(key int, value string) CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcbucket_mapjoin
 POSTHOOK: query: CREATE TABLE srcbucket_mapjoin(key int, value string) CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -24,6 +25,7 @@ POSTHOOK: Output: default@srcbucket_mapjoin
 PREHOOK: query: CREATE TABLE srcbucket_mapjoin_part (key int, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcbucket_mapjoin_part
 POSTHOOK: query: CREATE TABLE srcbucket_mapjoin_part (key int, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -64,6 +66,7 @@ POSTHOOK: Output: default@srcbucket_mapjoin_part@ds=2008-04-08
 PREHOOK: query: CREATE TABLE srcbucket_mapjoin_part_2 (key int, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcbucket_mapjoin_part_2
 POSTHOOK: query: CREATE TABLE srcbucket_mapjoin_part_2 (key int, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -88,6 +91,7 @@ POSTHOOK: Output: default@srcbucket_mapjoin_part_2@ds=2008-04-08
 PREHOOK: query: create table bucketmapjoin_hash_result_1 (key bigint , value1 bigint, value2 bigint)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucketmapjoin_hash_result_1
 POSTHOOK: query: create table bucketmapjoin_hash_result_1 (key bigint , value1 bigint, value2 bigint)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -95,6 +99,7 @@ POSTHOOK: Output: default@bucketmapjoin_hash_result_1
 PREHOOK: query: create table bucketmapjoin_hash_result_2 (key bigint , value1 bigint, value2 bigint)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucketmapjoin_hash_result_2
 POSTHOOK: query: create table bucketmapjoin_hash_result_2 (key bigint , value1 bigint, value2 bigint)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -102,6 +107,7 @@ POSTHOOK: Output: default@bucketmapjoin_hash_result_2
 PREHOOK: query: create table bucketmapjoin_tmp_result (key string , value1 string, value2 string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucketmapjoin_tmp_result
 POSTHOOK: query: create table bucketmapjoin_tmp_result (key string , value1 string, value2 string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/bucketmapjoin5.q.out b/ql/src/test/results/clientpositive/bucketmapjoin5.q.out
index 79e1c3d7e3..08ad318d94 100644
--- a/ql/src/test/results/clientpositive/bucketmapjoin5.q.out
+++ b/ql/src/test/results/clientpositive/bucketmapjoin5.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE srcbucket_mapjoin(key int, value string) CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcbucket_mapjoin
 POSTHOOK: query: CREATE TABLE srcbucket_mapjoin(key int, value string) CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -24,6 +25,7 @@ POSTHOOK: Output: default@srcbucket_mapjoin
 PREHOOK: query: CREATE TABLE srcbucket_mapjoin_part (key int, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcbucket_mapjoin_part
 POSTHOOK: query: CREATE TABLE srcbucket_mapjoin_part (key int, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -97,6 +99,7 @@ POSTHOOK: Output: default@srcbucket_mapjoin_part@ds=2008-04-09
 PREHOOK: query: CREATE TABLE srcbucket_mapjoin_part_2 (key int, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcbucket_mapjoin_part_2
 POSTHOOK: query: CREATE TABLE srcbucket_mapjoin_part_2 (key int, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -138,6 +141,7 @@ POSTHOOK: Output: default@srcbucket_mapjoin_part_2@ds=2008-04-09
 PREHOOK: query: create table bucketmapjoin_hash_result_1 (key bigint , value1 bigint, value2 bigint)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucketmapjoin_hash_result_1
 POSTHOOK: query: create table bucketmapjoin_hash_result_1 (key bigint , value1 bigint, value2 bigint)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -145,6 +149,7 @@ POSTHOOK: Output: default@bucketmapjoin_hash_result_1
 PREHOOK: query: create table bucketmapjoin_hash_result_2 (key bigint , value1 bigint, value2 bigint)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucketmapjoin_hash_result_2
 POSTHOOK: query: create table bucketmapjoin_hash_result_2 (key bigint , value1 bigint, value2 bigint)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -152,6 +157,7 @@ POSTHOOK: Output: default@bucketmapjoin_hash_result_2
 PREHOOK: query: create table bucketmapjoin_tmp_result (key string , value1 string, value2 string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucketmapjoin_tmp_result
 POSTHOOK: query: create table bucketmapjoin_tmp_result (key string , value1 string, value2 string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/bucketmapjoin6.q.out b/ql/src/test/results/clientpositive/bucketmapjoin6.q.out
index 18c5a2bb52..198404b5bb 100644
--- a/ql/src/test/results/clientpositive/bucketmapjoin6.q.out
+++ b/ql/src/test/results/clientpositive/bucketmapjoin6.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 create table tmp1 (a string, b string) clustered by (a) sorted by (a) into 10 buckets
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmp1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 create table tmp1 (a string, b string) clustered by (a) sorted by (a) into 10 buckets
@@ -12,6 +13,7 @@ POSTHOOK: Output: default@tmp1
 PREHOOK: query: create table tmp2 (a string, b string) clustered by (a) sorted by (a) into 10 buckets
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmp2
 POSTHOOK: query: create table tmp2 (a string, b string) clustered by (a) sorted by (a) into 10 buckets
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -39,6 +41,7 @@ POSTHOOK: Lineage: tmp2.b SIMPLE [(src)src.FieldSchema(name:value, type:string,
 PREHOOK: query: create table tmp3 (a string, b string, c string) clustered by (a) sorted by (a) into 10 buckets
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmp3
 POSTHOOK: query: create table tmp3 (a string, b string, c string) clustered by (a) sorted by (a) into 10 buckets
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/bucketmapjoin7.q.out b/ql/src/test/results/clientpositive/bucketmapjoin7.q.out
index 76baf50f6b..8cc001e2a6 100644
--- a/ql/src/test/results/clientpositive/bucketmapjoin7.q.out
+++ b/ql/src/test/results/clientpositive/bucketmapjoin7.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: CREATE TABLE srcbucket_mapjoin_part_1 (key INT, value STRING) PA
 CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcbucket_mapjoin_part_1
 POSTHOOK: query: CREATE TABLE srcbucket_mapjoin_part_1 (key INT, value STRING) PARTITIONED BY (ds STRING, hr STRING) 
 CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
@@ -28,6 +29,7 @@ PREHOOK: query: CREATE TABLE srcbucket_mapjoin_part_2 (key INT, value STRING) PA
 CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcbucket_mapjoin_part_2
 POSTHOOK: query: CREATE TABLE srcbucket_mapjoin_part_2 (key INT, value STRING) PARTITIONED BY (ds STRING, hr STRING) 
 CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/bucketmapjoin8.q.out b/ql/src/test/results/clientpositive/bucketmapjoin8.q.out
index e504c9d9bb..e573f590b2 100644
--- a/ql/src/test/results/clientpositive/bucketmapjoin8.q.out
+++ b/ql/src/test/results/clientpositive/bucketmapjoin8.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: CREATE TABLE srcbucket_mapjoin_part_1 (key INT, value STRING) PA
 CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcbucket_mapjoin_part_1
 POSTHOOK: query: CREATE TABLE srcbucket_mapjoin_part_1 (key INT, value STRING) PARTITIONED BY (part STRING) 
 CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
@@ -28,6 +29,7 @@ PREHOOK: query: CREATE TABLE srcbucket_mapjoin_part_2 (key INT, value STRING) PA
 CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcbucket_mapjoin_part_2
 POSTHOOK: query: CREATE TABLE srcbucket_mapjoin_part_2 (key INT, value STRING) PARTITIONED BY (part STRING) 
 CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/bucketmapjoin9.q.out b/ql/src/test/results/clientpositive/bucketmapjoin9.q.out
index 18f350a220..c6f94f5942 100644
--- a/ql/src/test/results/clientpositive/bucketmapjoin9.q.out
+++ b/ql/src/test/results/clientpositive/bucketmapjoin9.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: CREATE TABLE srcbucket_mapjoin_part_1 (key INT, value STRING) PA
 CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcbucket_mapjoin_part_1
 POSTHOOK: query: CREATE TABLE srcbucket_mapjoin_part_1 (key INT, value STRING) PARTITIONED BY (part STRING) 
 CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
@@ -28,6 +29,7 @@ PREHOOK: query: CREATE TABLE srcbucket_mapjoin_part_2 (key INT, value STRING) PA
 CLUSTERED BY (key) INTO 3 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcbucket_mapjoin_part_2
 POSTHOOK: query: CREATE TABLE srcbucket_mapjoin_part_2 (key INT, value STRING) PARTITIONED BY (part STRING) 
 CLUSTERED BY (key) INTO 3 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/bucketmapjoin_negative.q.out b/ql/src/test/results/clientpositive/bucketmapjoin_negative.q.out
index 751e32f578..fa2692ebda 100644
--- a/ql/src/test/results/clientpositive/bucketmapjoin_negative.q.out
+++ b/ql/src/test/results/clientpositive/bucketmapjoin_negative.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE srcbucket_mapjoin(key int, value string) CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcbucket_mapjoin
 POSTHOOK: query: CREATE TABLE srcbucket_mapjoin(key int, value string) CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -24,6 +25,7 @@ POSTHOOK: Output: default@srcbucket_mapjoin
 PREHOOK: query: CREATE TABLE srcbucket_mapjoin_part (key int, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 3 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcbucket_mapjoin_part
 POSTHOOK: query: CREATE TABLE srcbucket_mapjoin_part (key int, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 3 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -56,6 +58,7 @@ POSTHOOK: Output: default@srcbucket_mapjoin_part@ds=2008-04-08
 PREHOOK: query: create table bucketmapjoin_tmp_result (key string , value1 string, value2 string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucketmapjoin_tmp_result
 POSTHOOK: query: create table bucketmapjoin_tmp_result (key string , value1 string, value2 string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/bucketmapjoin_negative2.q.out b/ql/src/test/results/clientpositive/bucketmapjoin_negative2.q.out
index 3eb70d1cb5..7810b12f61 100644
--- a/ql/src/test/results/clientpositive/bucketmapjoin_negative2.q.out
+++ b/ql/src/test/results/clientpositive/bucketmapjoin_negative2.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE srcbucket_mapjoin(key int, value string) CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcbucket_mapjoin
 POSTHOOK: query: CREATE TABLE srcbucket_mapjoin(key int, value string) CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -24,6 +25,7 @@ POSTHOOK: Output: default@srcbucket_mapjoin
 PREHOOK: query: CREATE TABLE srcbucket_mapjoin_part_2 (key int, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcbucket_mapjoin_part_2
 POSTHOOK: query: CREATE TABLE srcbucket_mapjoin_part_2 (key int, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -65,6 +67,7 @@ POSTHOOK: Output: default@srcbucket_mapjoin_part_2@ds=2008-04-09
 PREHOOK: query: create table bucketmapjoin_tmp_result (key string , value1 string, value2 string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucketmapjoin_tmp_result
 POSTHOOK: query: create table bucketmapjoin_tmp_result (key string , value1 string, value2 string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/bucketmapjoin_negative3.q.out b/ql/src/test/results/clientpositive/bucketmapjoin_negative3.q.out
index 34abe4f6f5..b2abb45114 100644
--- a/ql/src/test/results/clientpositive/bucketmapjoin_negative3.q.out
+++ b/ql/src/test/results/clientpositive/bucketmapjoin_negative3.q.out
@@ -17,6 +17,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table test1 (key string, value string) clustered by (key) sorted by (key) into 3 buckets
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test1
 POSTHOOK: query: create table test1 (key string, value string) clustered by (key) sorted by (key) into 3 buckets
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -24,6 +25,7 @@ POSTHOOK: Output: default@test1
 PREHOOK: query: create table test2 (key string, value string) clustered by (value) sorted by (value) into 3 buckets
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test2
 POSTHOOK: query: create table test2 (key string, value string) clustered by (value) sorted by (value) into 3 buckets
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -31,6 +33,7 @@ POSTHOOK: Output: default@test2
 PREHOOK: query: create table test3 (key string, value string) clustered by (key, value) sorted by (key, value) into 3 buckets
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test3
 POSTHOOK: query: create table test3 (key string, value string) clustered by (key, value) sorted by (key, value) into 3 buckets
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -38,6 +41,7 @@ POSTHOOK: Output: default@test3
 PREHOOK: query: create table test4 (key string, value string) clustered by (value, key) sorted by (value, key) into 3 buckets
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test4
 POSTHOOK: query: create table test4 (key string, value string) clustered by (value, key) sorted by (value, key) into 3 buckets
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/bucketsortoptimize_insert_1.q.out b/ql/src/test/results/clientpositive/bucketsortoptimize_insert_1.q.out
index b166d39aec..75de953ca3 100644
--- a/ql/src/test/results/clientpositive/bucketsortoptimize_insert_1.q.out
+++ b/ql/src/test/results/clientpositive/bucketsortoptimize_insert_1.q.out
@@ -3,6 +3,7 @@ CREATE TABLE test_table1 (key INT, value STRING) PARTITIONED BY (ds STRING)
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table1
 POSTHOOK: query: -- Create two bucketed and sorted tables
 CREATE TABLE test_table1 (key INT, value STRING) PARTITIONED BY (ds STRING)
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
@@ -13,6 +14,7 @@ PREHOOK: query: CREATE TABLE test_table2 (key INT, value STRING) PARTITIONED BY
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table2
 POSTHOOK: query: CREATE TABLE test_table2 (key INT, value STRING) PARTITIONED BY (ds STRING)
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/bucketsortoptimize_insert_2.q.out b/ql/src/test/results/clientpositive/bucketsortoptimize_insert_2.q.out
index 673cb495c5..97cab5b7f3 100644
--- a/ql/src/test/results/clientpositive/bucketsortoptimize_insert_2.q.out
+++ b/ql/src/test/results/clientpositive/bucketsortoptimize_insert_2.q.out
@@ -3,6 +3,7 @@ CREATE TABLE test_table1 (key INT, value STRING) PARTITIONED BY (ds STRING)
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table1
 POSTHOOK: query: -- Create two bucketed and sorted tables
 CREATE TABLE test_table1 (key INT, value STRING) PARTITIONED BY (ds STRING)
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
@@ -13,6 +14,7 @@ PREHOOK: query: CREATE TABLE test_table2 (key INT, value STRING) PARTITIONED BY
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table2
 POSTHOOK: query: CREATE TABLE test_table2 (key INT, value STRING) PARTITIONED BY (ds STRING)
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
@@ -22,6 +24,7 @@ PREHOOK: query: CREATE TABLE test_table3 (key INT, value STRING) PARTITIONED BY
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table3
 POSTHOOK: query: CREATE TABLE test_table3 (key INT, value STRING) PARTITIONED BY (ds STRING)
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/bucketsortoptimize_insert_3.q.out b/ql/src/test/results/clientpositive/bucketsortoptimize_insert_3.q.out
index 9e6fde7a33..7456ab08bc 100644
--- a/ql/src/test/results/clientpositive/bucketsortoptimize_insert_3.q.out
+++ b/ql/src/test/results/clientpositive/bucketsortoptimize_insert_3.q.out
@@ -3,6 +3,7 @@ CREATE TABLE test_table1 (key INT, value STRING) PARTITIONED BY (ds STRING)
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table1
 POSTHOOK: query: -- Create two bucketed and sorted tables
 CREATE TABLE test_table1 (key INT, value STRING) PARTITIONED BY (ds STRING)
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
@@ -13,6 +14,7 @@ PREHOOK: query: CREATE TABLE test_table2 (value STRING, key INT) PARTITIONED BY
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table2
 POSTHOOK: query: CREATE TABLE test_table2 (value STRING, key INT) PARTITIONED BY (ds STRING)
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
@@ -139,6 +141,7 @@ PREHOOK: query: CREATE TABLE test_table3 (key INT, value STRING) PARTITIONED BY
 CLUSTERED BY (value) SORTED BY (value) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table3
 POSTHOOK: query: CREATE TABLE test_table3 (key INT, value STRING) PARTITIONED BY (ds STRING)
 CLUSTERED BY (value) SORTED BY (value) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/bucketsortoptimize_insert_4.q.out b/ql/src/test/results/clientpositive/bucketsortoptimize_insert_4.q.out
index 8b24e734a7..4ff5c2490a 100644
--- a/ql/src/test/results/clientpositive/bucketsortoptimize_insert_4.q.out
+++ b/ql/src/test/results/clientpositive/bucketsortoptimize_insert_4.q.out
@@ -3,6 +3,7 @@ CREATE TABLE test_table1 (key INT, value STRING) PARTITIONED BY (ds STRING)
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table1
 POSTHOOK: query: -- Create two bucketed and sorted tables
 CREATE TABLE test_table1 (key INT, value STRING) PARTITIONED BY (ds STRING)
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
@@ -13,6 +14,7 @@ PREHOOK: query: CREATE TABLE test_table2 (key INT, value STRING) PARTITIONED BY
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table2
 POSTHOOK: query: CREATE TABLE test_table2 (key INT, value STRING) PARTITIONED BY (ds STRING)
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
@@ -22,6 +24,7 @@ PREHOOK: query: CREATE TABLE test_table3 (key INT, key2 INT, value STRING) PARTI
 CLUSTERED BY (key2) SORTED BY (key2) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table3
 POSTHOOK: query: CREATE TABLE test_table3 (key INT, key2 INT, value STRING) PARTITIONED BY (ds STRING)
 CLUSTERED BY (key2) SORTED BY (key2) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
@@ -195,6 +198,7 @@ PREHOOK: query: CREATE TABLE test_table3 (key INT, value STRING) PARTITIONED BY
 CLUSTERED BY (value) SORTED BY (value) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table3
 POSTHOOK: query: CREATE TABLE test_table3 (key INT, value STRING) PARTITIONED BY (ds STRING)
 CLUSTERED BY (value) SORTED BY (value) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/bucketsortoptimize_insert_5.q.out b/ql/src/test/results/clientpositive/bucketsortoptimize_insert_5.q.out
index 22b9a88512..0cd45d49df 100644
--- a/ql/src/test/results/clientpositive/bucketsortoptimize_insert_5.q.out
+++ b/ql/src/test/results/clientpositive/bucketsortoptimize_insert_5.q.out
@@ -3,6 +3,7 @@ CREATE TABLE test_table1 (key INT, value STRING) PARTITIONED BY (ds STRING)
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table1
 POSTHOOK: query: -- Create two bucketed and sorted tables
 CREATE TABLE test_table1 (key INT, value STRING) PARTITIONED BY (ds STRING)
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
@@ -13,6 +14,7 @@ PREHOOK: query: CREATE TABLE test_table2 (key INT, value STRING) PARTITIONED BY
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table2
 POSTHOOK: query: CREATE TABLE test_table2 (key INT, value STRING) PARTITIONED BY (ds STRING)
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
@@ -22,6 +24,7 @@ PREHOOK: query: CREATE TABLE test_table3 (key INT, value STRING) PARTITIONED BY
 CLUSTERED BY (key) SORTED BY (key desc) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table3
 POSTHOOK: query: CREATE TABLE test_table3 (key INT, value STRING) PARTITIONED BY (ds STRING)
 CLUSTERED BY (key) SORTED BY (key desc) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/bucketsortoptimize_insert_6.q.out b/ql/src/test/results/clientpositive/bucketsortoptimize_insert_6.q.out
index a8395653df..6e7e2408b5 100644
--- a/ql/src/test/results/clientpositive/bucketsortoptimize_insert_6.q.out
+++ b/ql/src/test/results/clientpositive/bucketsortoptimize_insert_6.q.out
@@ -3,6 +3,7 @@ CREATE TABLE test_table1 (key INT, key2 INT, value STRING) PARTITIONED BY (ds ST
 CLUSTERED BY (key, key2) SORTED BY (key ASC, key2 DESC) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table1
 POSTHOOK: query: -- Create two bucketed and sorted tables
 CREATE TABLE test_table1 (key INT, key2 INT, value STRING) PARTITIONED BY (ds STRING)
 CLUSTERED BY (key, key2) SORTED BY (key ASC, key2 DESC) INTO 2 BUCKETS
@@ -13,6 +14,7 @@ PREHOOK: query: CREATE TABLE test_table2 (key INT, key2 INT, value STRING) PARTI
 CLUSTERED BY (key, key2) SORTED BY (key ASC, key2 DESC) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table2
 POSTHOOK: query: CREATE TABLE test_table2 (key INT, key2 INT, value STRING) PARTITIONED BY (ds STRING)
 CLUSTERED BY (key, key2) SORTED BY (key ASC, key2 DESC) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
@@ -22,6 +24,7 @@ PREHOOK: query: CREATE TABLE test_table3 (key INT, key2 INT, value STRING) PARTI
 CLUSTERED BY (key, key2) SORTED BY (key ASC, key2 DESC) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table3
 POSTHOOK: query: CREATE TABLE test_table3 (key INT, key2 INT, value STRING) PARTITIONED BY (ds STRING)
 CLUSTERED BY (key, key2) SORTED BY (key ASC, key2 DESC) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
@@ -1043,6 +1046,7 @@ PREHOOK: query: CREATE TABLE test_table4 (key INT, key2 INT, value STRING) PARTI
 CLUSTERED BY (key, key2) SORTED BY (key DESC, key2 DESC) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table4
 POSTHOOK: query: CREATE TABLE test_table4 (key INT, key2 INT, value STRING) PARTITIONED BY (ds STRING)
 CLUSTERED BY (key, key2) SORTED BY (key DESC, key2 DESC) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/bucketsortoptimize_insert_7.q.out b/ql/src/test/results/clientpositive/bucketsortoptimize_insert_7.q.out
index 1827db1e6d..802da21094 100644
--- a/ql/src/test/results/clientpositive/bucketsortoptimize_insert_7.q.out
+++ b/ql/src/test/results/clientpositive/bucketsortoptimize_insert_7.q.out
@@ -3,6 +3,7 @@ CREATE TABLE test_table1 (key INT, value STRING) PARTITIONED BY (ds STRING)
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table1
 POSTHOOK: query: -- Create two bucketed and sorted tables
 CREATE TABLE test_table1 (key INT, value STRING) PARTITIONED BY (ds STRING)
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
@@ -13,6 +14,7 @@ PREHOOK: query: CREATE TABLE test_table2 (key INT, value STRING) PARTITIONED BY
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table2
 POSTHOOK: query: CREATE TABLE test_table2 (key INT, value STRING) PARTITIONED BY (ds STRING)
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
@@ -22,6 +24,7 @@ PREHOOK: query: CREATE TABLE test_table3 (key INT, value STRING) PARTITIONED BY
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table3
 POSTHOOK: query: CREATE TABLE test_table3 (key INT, value STRING) PARTITIONED BY (ds STRING)
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/bucketsortoptimize_insert_8.q.out b/ql/src/test/results/clientpositive/bucketsortoptimize_insert_8.q.out
index 104435795c..aa29b700b6 100644
--- a/ql/src/test/results/clientpositive/bucketsortoptimize_insert_8.q.out
+++ b/ql/src/test/results/clientpositive/bucketsortoptimize_insert_8.q.out
@@ -3,6 +3,7 @@ CREATE TABLE test_table1 (key INT, value STRING) PARTITIONED BY (ds STRING)
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table1
 POSTHOOK: query: -- Create two bucketed and sorted tables
 CREATE TABLE test_table1 (key INT, value STRING) PARTITIONED BY (ds STRING)
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
@@ -13,6 +14,7 @@ PREHOOK: query: CREATE TABLE test_table2 (key INT, value STRING) PARTITIONED BY
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table2
 POSTHOOK: query: CREATE TABLE test_table2 (key INT, value STRING) PARTITIONED BY (ds STRING)
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
@@ -22,6 +24,7 @@ PREHOOK: query: CREATE TABLE test_table3 (key INT, key2 INT, value STRING) PARTI
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table3
 POSTHOOK: query: CREATE TABLE test_table3 (key INT, key2 INT, value STRING) PARTITIONED BY (ds STRING)
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/case_sensitivity.q.out b/ql/src/test/results/clientpositive/case_sensitivity.q.out
index 1e5b6024a9..226a0527ca 100644
--- a/ql/src/test/results/clientpositive/case_sensitivity.q.out
+++ b/ql/src/test/results/clientpositive/case_sensitivity.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE DEST1(Key INT, VALUE STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@DEST1
 POSTHOOK: query: CREATE TABLE DEST1(Key INT, VALUE STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/cast1.q.out b/ql/src/test/results/clientpositive/cast1.q.out
index a8c3820882..fc2d63f56c 100644
--- a/ql/src/test/results/clientpositive/cast1.q.out
+++ b/ql/src/test/results/clientpositive/cast1.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(c1 INT, c2 DOUBLE, c3 DOUBLE, c4 DOUBLE, c5 INT, c6 STRING, c7 INT) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(c1 INT, c2 DOUBLE, c3 DOUBLE, c4 DOUBLE, c5 INT, c6 STRING, c7 INT) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/char_1.q.out b/ql/src/test/results/clientpositive/char_1.q.out
index e60233b04a..615f02973b 100644
--- a/ql/src/test/results/clientpositive/char_1.q.out
+++ b/ql/src/test/results/clientpositive/char_1.q.out
@@ -13,6 +13,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table char1 (key char(10), value char(20))
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@char1
 POSTHOOK: query: create table char1 (key char(10), value char(20))
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -20,6 +21,7 @@ POSTHOOK: Output: default@char1
 PREHOOK: query: create table char1_1 (key string, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@char1_1
 POSTHOOK: query: create table char1_1 (key string, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/char_2.q.out b/ql/src/test/results/clientpositive/char_2.q.out
index 7a557c54b5..801a3f1ae4 100644
--- a/ql/src/test/results/clientpositive/char_2.q.out
+++ b/ql/src/test/results/clientpositive/char_2.q.out
@@ -8,6 +8,7 @@ PREHOOK: query: create table char_2 (
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@char_2
 POSTHOOK: query: create table char_2 (
   key char(10),
   value char(20)
diff --git a/ql/src/test/results/clientpositive/char_join1.q.out b/ql/src/test/results/clientpositive/char_join1.q.out
index e0db8fb3cc..48e6ad82de 100644
--- a/ql/src/test/results/clientpositive/char_join1.q.out
+++ b/ql/src/test/results/clientpositive/char_join1.q.out
@@ -20,6 +20,7 @@ PREHOOK: query: create table  char_join1_ch1 (
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@char_join1_ch1
 POSTHOOK: query: create table  char_join1_ch1 (
   c1 int,
   c2 char(10)
@@ -33,6 +34,7 @@ PREHOOK: query: create table  char_join1_ch2 (
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@char_join1_ch2
 POSTHOOK: query: create table  char_join1_ch2 (
   c1 int,
   c2 char(20)
@@ -46,6 +48,7 @@ PREHOOK: query: create table  char_join1_str (
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@char_join1_str
 POSTHOOK: query: create table  char_join1_str (
   c1 int,
   c2 string
diff --git a/ql/src/test/results/clientpositive/char_nested_types.q.out b/ql/src/test/results/clientpositive/char_nested_types.q.out
index 1988ea7e78..66b7bb61c8 100644
--- a/ql/src/test/results/clientpositive/char_nested_types.q.out
+++ b/ql/src/test/results/clientpositive/char_nested_types.q.out
@@ -25,6 +25,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table char_nested_1 (key int, value char(20))
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@char_nested_1
 POSTHOOK: query: create table char_nested_1 (key int, value char(20))
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -45,6 +46,7 @@ PREHOOK: query: -- arrays
 create table char_nested_array (c1 array<char(20)>)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@char_nested_array
 POSTHOOK: query: -- arrays
 create table char_nested_array (c1 array<char(20)>)
 POSTHOOK: type: CREATETABLE
@@ -81,6 +83,7 @@ PREHOOK: query: -- maps
 create table char_nested_map (c1 map<int, char(20)>)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@char_nested_map
 POSTHOOK: query: -- maps
 create table char_nested_map (c1 map<int, char(20)>)
 POSTHOOK: type: CREATETABLE
@@ -117,6 +120,7 @@ PREHOOK: query: -- structs
 create table char_nested_struct (c1 struct<a:int, b:char(20), c:string>)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@char_nested_struct
 POSTHOOK: query: -- structs
 create table char_nested_struct (c1 struct<a:int, b:char(20), c:string>)
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/char_pad_convert.q.out b/ql/src/test/results/clientpositive/char_pad_convert.q.out
index 1f81426abc..26102e43f8 100644
--- a/ql/src/test/results/clientpositive/char_pad_convert.q.out
+++ b/ql/src/test/results/clientpositive/char_pad_convert.q.out
@@ -14,6 +14,7 @@ PREHOOK: query: create table over1k(
        fields terminated by '|'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@over1k
 POSTHOOK: query: create table over1k(
            t tinyint,
            si smallint,
diff --git a/ql/src/test/results/clientpositive/char_serde.q.out b/ql/src/test/results/clientpositive/char_serde.q.out
index 4a79358cf9..8f6f8ce834 100644
--- a/ql/src/test/results/clientpositive/char_serde.q.out
+++ b/ql/src/test/results/clientpositive/char_serde.q.out
@@ -36,6 +36,7 @@ with serdeproperties (
 stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@char_serde_regex
 POSTHOOK: query: --
 -- RegexSerDe
 --
@@ -94,6 +95,7 @@ create table  char_serde_lb (
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@char_serde_lb
 POSTHOOK: query: --
 -- LazyBinary
 --
@@ -159,6 +161,7 @@ create table  char_serde_ls (
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@char_serde_ls
 POSTHOOK: query: --
 -- LazySimple
 --
@@ -224,6 +227,7 @@ create table  char_serde_c (
 ) stored as rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@char_serde_c
 POSTHOOK: query: --
 -- Columnar
 --
@@ -289,6 +293,7 @@ create table char_serde_lbc (
 ) stored as rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@char_serde_lbc
 POSTHOOK: query: --
 -- LazyBinaryColumnar
 --
@@ -354,6 +359,7 @@ create table char_serde_orc (
 ) stored as orc
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@char_serde_orc
 POSTHOOK: query: --
 -- ORC
 --
diff --git a/ql/src/test/results/clientpositive/char_udf1.q.out b/ql/src/test/results/clientpositive/char_udf1.q.out
index 7143325560..e2feb0078b 100644
--- a/ql/src/test/results/clientpositive/char_udf1.q.out
+++ b/ql/src/test/results/clientpositive/char_udf1.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table char_udf_1 (c1 string, c2 string, c3 char(10), c4 char(20))
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@char_udf_1
 POSTHOOK: query: create table char_udf_1 (c1 string, c2 string, c3 char(10), c4 char(20))
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/char_union1.q.out b/ql/src/test/results/clientpositive/char_union1.q.out
index 8df98a7f7b..bdc4a1d296 100644
--- a/ql/src/test/results/clientpositive/char_union1.q.out
+++ b/ql/src/test/results/clientpositive/char_union1.q.out
@@ -16,6 +16,7 @@ PREHOOK: query: create table  char_union1_ch1 (
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@char_union1_ch1
 POSTHOOK: query: create table  char_union1_ch1 (
   c1 int,
   c2 char(10)
@@ -29,6 +30,7 @@ PREHOOK: query: create table  char_union1_ch2 (
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@char_union1_ch2
 POSTHOOK: query: create table  char_union1_ch2 (
   c1 int,
   c2 char(20)
@@ -42,6 +44,7 @@ PREHOOK: query: create table  char_union1_str (
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@char_union1_str
 POSTHOOK: query: create table  char_union1_str (
   c1 int,
   c2 string
diff --git a/ql/src/test/results/clientpositive/char_varchar_udf.q.out b/ql/src/test/results/clientpositive/char_varchar_udf.q.out
index 285fd4dadc..8af214509f 100644
--- a/ql/src/test/results/clientpositive/char_varchar_udf.q.out
+++ b/ql/src/test/results/clientpositive/char_varchar_udf.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: CREATE TABLE char_varchar_udf (c char(8), vc varchar(10)) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@char_varchar_udf
 POSTHOOK: query: CREATE TABLE char_varchar_udf (c char(8), vc varchar(10)) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t'
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/colstats_all_nulls.q.out b/ql/src/test/results/clientpositive/colstats_all_nulls.q.out
index 8eb51d4c26..1186aa8b9e 100644
--- a/ql/src/test/results/clientpositive/colstats_all_nulls.q.out
+++ b/ql/src/test/results/clientpositive/colstats_all_nulls.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE src_null(a bigint) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_null
 POSTHOOK: query: CREATE TABLE src_null(a bigint) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/column_access_stats.q.out b/ql/src/test/results/clientpositive/column_access_stats.q.out
index d2e9a768c0..644cd2d799 100644
--- a/ql/src/test/results/clientpositive/column_access_stats.q.out
+++ b/ql/src/test/results/clientpositive/column_access_stats.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE T1(key STRING, val STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 PREHOOK: query: LOAD DATA LOCAL INPATH '../../data/files/T1.txt' INTO TABLE T1
 PREHOOK: type: LOAD
 #### A masked pattern was here ####
@@ -11,12 +12,15 @@ PREHOOK: Output: default@t1
 PREHOOK: query: CREATE TABLE T2(key STRING, val STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T2
 PREHOOK: query: CREATE TABLE T3(key STRING, val STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T3
 PREHOOK: query: CREATE TABLE T4(key STRING, val STRING) PARTITIONED BY (p STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T4
 PREHOOK: query: -- Simple select queries
 SELECT key FROM T1
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/columnarserde_create_shortcut.q.out b/ql/src/test/results/clientpositive/columnarserde_create_shortcut.q.out
index cce8187560..f87c0cab30 100644
--- a/ql/src/test/results/clientpositive/columnarserde_create_shortcut.q.out
+++ b/ql/src/test/results/clientpositive/columnarserde_create_shortcut.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE columnarserde_create_shortcut(a array<int>, b array<string>, c map<string,string>, d int, e string) STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@columnarserde_create_shortcut
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE columnarserde_create_shortcut(a array<int>, b array<string>, c map<string,string>, d int, e string) STORED AS RCFILE
@@ -121,6 +122,7 @@ NULL	NULL	NULL	0	NULL
 PREHOOK: query: CREATE table columnShortcutTable (key STRING, value STRING) STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@columnShortcutTable
 POSTHOOK: query: CREATE table columnShortcutTable (key STRING, value STRING) STORED AS RCFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/columnstats_partlvl.q.out b/ql/src/test/results/clientpositive/columnstats_partlvl.q.out
index 84633c91f1..626541c1b2 100644
--- a/ql/src/test/results/clientpositive/columnstats_partlvl.q.out
+++ b/ql/src/test/results/clientpositive/columnstats_partlvl.q.out
@@ -6,6 +6,7 @@ PREHOOK: query: CREATE TABLE Employee_Part(employeeID int, employeeName String)
 row format delimited fields terminated by '|'  stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@Employee_Part
 POSTHOOK: query: CREATE TABLE Employee_Part(employeeID int, employeeName String) partitioned by (employeeSalary double)
 row format delimited fields terminated by '|'  stored as textfile
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/columnstats_partlvl_dp.q.out b/ql/src/test/results/clientpositive/columnstats_partlvl_dp.q.out
index f2c530ce46..1c95486a88 100644
--- a/ql/src/test/results/clientpositive/columnstats_partlvl_dp.q.out
+++ b/ql/src/test/results/clientpositive/columnstats_partlvl_dp.q.out
@@ -6,6 +6,7 @@ PREHOOK: query: CREATE TABLE Employee_Part(employeeID int, employeeName String)
 row format delimited fields terminated by '|'  stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@Employee_Part
 POSTHOOK: query: CREATE TABLE Employee_Part(employeeID int, employeeName String) partitioned by (employeeSalary double, country string)
 row format delimited fields terminated by '|'  stored as textfile
 POSTHOOK: type: CREATETABLE
@@ -396,6 +397,7 @@ PREHOOK: query: CREATE TABLE Employee(employeeID int, employeeName String) parti
 row format delimited fields terminated by '|'  stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@Employee
 POSTHOOK: query: CREATE TABLE Employee(employeeID int, employeeName String) partitioned by (employeeSalary double, country string)
 row format delimited fields terminated by '|'  stored as textfile
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/columnstats_tbllvl.q.out b/ql/src/test/results/clientpositive/columnstats_tbllvl.q.out
index 3f187bec0c..d6fd01f1d9 100644
--- a/ql/src/test/results/clientpositive/columnstats_tbllvl.q.out
+++ b/ql/src/test/results/clientpositive/columnstats_tbllvl.q.out
@@ -15,6 +15,7 @@ PREHOOK: query: CREATE TABLE UserVisits_web_text_none (
 row format delimited fields terminated by '|'  stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@UserVisits_web_text_none
 POSTHOOK: query: CREATE TABLE UserVisits_web_text_none (
   sourceIP string,
   destURL string,
@@ -316,6 +317,7 @@ PREHOOK: query: CREATE TABLE empty_tab(
 row format delimited fields terminated by '|'  stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@empty_tab
 POSTHOOK: query: CREATE TABLE empty_tab(
    a int,
    b double,
diff --git a/ql/src/test/results/clientpositive/combine1.q.out b/ql/src/test/results/clientpositive/combine1.q.out
index 688800e1d8..1c1224a40b 100644
--- a/ql/src/test/results/clientpositive/combine1.q.out
+++ b/ql/src/test/results/clientpositive/combine1.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 create table combine1_1(key string, value string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@combine1_1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 create table combine1_1(key string, value string) stored as textfile
diff --git a/ql/src/test/results/clientpositive/combine2.q.out b/ql/src/test/results/clientpositive/combine2.q.out
index 2d97590a22..13b09bd130 100644
--- a/ql/src/test/results/clientpositive/combine2.q.out
+++ b/ql/src/test/results/clientpositive/combine2.q.out
@@ -1,7 +1,9 @@
 PREHOOK: query: USE default
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:default
 POSTHOOK: query: USE default
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:default
 PREHOOK: query: -- EXCLUDE_OS_WINDOWS
 -- excluded on windows because of difference in file name encoding logic
 
@@ -10,6 +12,7 @@ PREHOOK: query: -- EXCLUDE_OS_WINDOWS
 create table combine2(key string) partitioned by (value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@combine2
 POSTHOOK: query: -- EXCLUDE_OS_WINDOWS
 -- excluded on windows because of difference in file name encoding logic
 
diff --git a/ql/src/test/results/clientpositive/combine3.q.out b/ql/src/test/results/clientpositive/combine3.q.out
index d64e38d8b1..d84a7baa4e 100644
--- a/ql/src/test/results/clientpositive/combine3.q.out
+++ b/ql/src/test/results/clientpositive/combine3.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table combine_3_srcpart_seq_rc (key int , value string) partitioned by (ds string, hr string) stored as sequencefile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@combine_3_srcpart_seq_rc
 POSTHOOK: query: create table combine_3_srcpart_seq_rc (key int , value string) partitioned by (ds string, hr string) stored as sequencefile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -122,6 +123,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: CREATE TABLE combine_3_srcpart_seq_rc_bucket(key int, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 2 BUCKETS stored as sequencefile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@combine_3_srcpart_seq_rc_bucket
 POSTHOOK: query: CREATE TABLE combine_3_srcpart_seq_rc_bucket(key int, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 2 BUCKETS stored as sequencefile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/compute_stats_binary.q.out b/ql/src/test/results/clientpositive/compute_stats_binary.q.out
index d2e0b05cb7..db8606fe4f 100644
--- a/ql/src/test/results/clientpositive/compute_stats_binary.q.out
+++ b/ql/src/test/results/clientpositive/compute_stats_binary.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table tab_binary(a binary)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tab_binary
 POSTHOOK: query: create table tab_binary(a binary)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/compute_stats_boolean.q.out b/ql/src/test/results/clientpositive/compute_stats_boolean.q.out
index 440bc16a6b..9f1669172e 100644
--- a/ql/src/test/results/clientpositive/compute_stats_boolean.q.out
+++ b/ql/src/test/results/clientpositive/compute_stats_boolean.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table tab_bool(a boolean)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tab_bool
 POSTHOOK: query: create table tab_bool(a boolean)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/compute_stats_decimal.q.out b/ql/src/test/results/clientpositive/compute_stats_decimal.q.out
index 2a65efe471..35abb37a79 100644
--- a/ql/src/test/results/clientpositive/compute_stats_decimal.q.out
+++ b/ql/src/test/results/clientpositive/compute_stats_decimal.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table tab_decimal(a decimal(10,3))
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tab_decimal
 POSTHOOK: query: create table tab_decimal(a decimal(10,3))
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/compute_stats_double.q.out b/ql/src/test/results/clientpositive/compute_stats_double.q.out
index 8915e703b4..f6b40522cd 100644
--- a/ql/src/test/results/clientpositive/compute_stats_double.q.out
+++ b/ql/src/test/results/clientpositive/compute_stats_double.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table tab_double(a double)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tab_double
 POSTHOOK: query: create table tab_double(a double)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/compute_stats_empty_table.q.out b/ql/src/test/results/clientpositive/compute_stats_empty_table.q.out
index 7e75469acc..f76c760b38 100644
--- a/ql/src/test/results/clientpositive/compute_stats_empty_table.q.out
+++ b/ql/src/test/results/clientpositive/compute_stats_empty_table.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table tab_empty(a boolean, b int, c double, d string, e binary)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tab_empty
 POSTHOOK: query: create table tab_empty(a boolean, b int, c double, d string, e binary)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/compute_stats_long.q.out b/ql/src/test/results/clientpositive/compute_stats_long.q.out
index 1727a8efb4..2c6171d7a3 100644
--- a/ql/src/test/results/clientpositive/compute_stats_long.q.out
+++ b/ql/src/test/results/clientpositive/compute_stats_long.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table tab_int(a int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tab_int
 POSTHOOK: query: create table tab_int(a int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/compute_stats_string.q.out b/ql/src/test/results/clientpositive/compute_stats_string.q.out
index 1d0e347b34..bdf9d85530 100644
--- a/ql/src/test/results/clientpositive/compute_stats_string.q.out
+++ b/ql/src/test/results/clientpositive/compute_stats_string.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table tab_string(a string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tab_string
 POSTHOOK: query: create table tab_string(a string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/concatenate_inherit_table_location.q.out b/ql/src/test/results/clientpositive/concatenate_inherit_table_location.q.out
index f3a7f02583..72ac05571f 100644
--- a/ql/src/test/results/clientpositive/concatenate_inherit_table_location.q.out
+++ b/ql/src/test/results/clientpositive/concatenate_inherit_table_location.q.out
@@ -4,6 +4,7 @@ STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 #### A masked pattern was here ####
 PREHOOK: Output: database:default
+PREHOOK: Output: default@citl_table
 POSTHOOK: query: CREATE TABLE citl_table (key STRING, value STRING) PARTITIONED BY (part STRING)
 STORED AS RCFILE
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/constprog_dp.q.out b/ql/src/test/results/clientpositive/constprog_dp.q.out
index adff821ed1..4ceb68a085 100644
--- a/ql/src/test/results/clientpositive/constprog_dp.q.out
+++ b/ql/src/test/results/clientpositive/constprog_dp.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table dest(key string, value string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest
 POSTHOOK: query: create table dest(key string, value string) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/constprog_type.q.out b/ql/src/test/results/clientpositive/constprog_type.q.out
index 2a0047a2cb..a07aad1803 100644
--- a/ql/src/test/results/clientpositive/constprog_type.q.out
+++ b/ql/src/test/results/clientpositive/constprog_type.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(d date, t timestamp)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(d date, t timestamp)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/convert_enum_to_string.q.out b/ql/src/test/results/clientpositive/convert_enum_to_string.q.out
index 4c89b29a1e..a1ef04f242 100644
--- a/ql/src/test/results/clientpositive/convert_enum_to_string.q.out
+++ b/ql/src/test/results/clientpositive/convert_enum_to_string.q.out
@@ -8,6 +8,7 @@ create table convert_enum_to_string
       "serialization.format"="org.apache.thrift.protocol.TBinaryProtocol")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@convert_enum_to_string
 POSTHOOK: query: -- Ensure Enum fields are converted to strings (instead of struct<value:int>)
 
 create table convert_enum_to_string
diff --git a/ql/src/test/results/clientpositive/correlationoptimizer11.q.out b/ql/src/test/results/clientpositive/correlationoptimizer11.q.out
index 22dc4d5c43..48191523cf 100644
--- a/ql/src/test/results/clientpositive/correlationoptimizer11.q.out
+++ b/ql/src/test/results/clientpositive/correlationoptimizer11.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: -- Tests in this file are used to make sure Correlation Optimize
 CREATE TABLE part_table(key string, value string) PARTITIONED BY (partitionId int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part_table
 POSTHOOK: query: -- Tests in this file are used to make sure Correlation Optimizer
 -- can correctly handle tables with partitions
 
diff --git a/ql/src/test/results/clientpositive/correlationoptimizer13.q.out b/ql/src/test/results/clientpositive/correlationoptimizer13.q.out
index e3a8a5c4f7..f2a217bcf2 100644
--- a/ql/src/test/results/clientpositive/correlationoptimizer13.q.out
+++ b/ql/src/test/results/clientpositive/correlationoptimizer13.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE tmp(c1 INT, c2 INT, c3 STRING, c4 STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmp
 POSTHOOK: query: CREATE TABLE tmp(c1 INT, c2 INT, c3 STRING, c4 STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/correlationoptimizer4.q.out b/ql/src/test/results/clientpositive/correlationoptimizer4.q.out
index f9c2225b2a..31bd28b183 100644
--- a/ql/src/test/results/clientpositive/correlationoptimizer4.q.out
+++ b/ql/src/test/results/clientpositive/correlationoptimizer4.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE T1(key INT, val STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: CREATE TABLE T1(key INT, val STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -16,6 +17,7 @@ POSTHOOK: Output: default@t1
 PREHOOK: query: CREATE TABLE T2(key INT, val STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T2
 POSTHOOK: query: CREATE TABLE T2(key INT, val STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -31,6 +33,7 @@ POSTHOOK: Output: default@t2
 PREHOOK: query: CREATE TABLE T3(key INT, val STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T3
 POSTHOOK: query: CREATE TABLE T3(key INT, val STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/correlationoptimizer5.q.out b/ql/src/test/results/clientpositive/correlationoptimizer5.q.out
index df41d7232c..b187a855af 100644
--- a/ql/src/test/results/clientpositive/correlationoptimizer5.q.out
+++ b/ql/src/test/results/clientpositive/correlationoptimizer5.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE T1(key INT, val STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: CREATE TABLE T1(key INT, val STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -16,6 +17,7 @@ POSTHOOK: Output: default@t1
 PREHOOK: query: CREATE TABLE T2(key INT, val STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T2
 POSTHOOK: query: CREATE TABLE T2(key INT, val STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -31,6 +33,7 @@ POSTHOOK: Output: default@t2
 PREHOOK: query: CREATE TABLE T3(key INT, val STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T3
 POSTHOOK: query: CREATE TABLE T3(key INT, val STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -46,6 +49,7 @@ POSTHOOK: Output: default@t3
 PREHOOK: query: CREATE TABLE T4(key INT, val STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T4
 POSTHOOK: query: CREATE TABLE T4(key INT, val STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -61,6 +65,7 @@ POSTHOOK: Output: default@t4
 PREHOOK: query: CREATE TABLE dest_co1(key INT, val STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_co1
 POSTHOOK: query: CREATE TABLE dest_co1(key INT, val STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -68,6 +73,7 @@ POSTHOOK: Output: default@dest_co1
 PREHOOK: query: CREATE TABLE dest_co2(key INT, val STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_co2
 POSTHOOK: query: CREATE TABLE dest_co2(key INT, val STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -75,6 +81,7 @@ POSTHOOK: Output: default@dest_co2
 PREHOOK: query: CREATE TABLE dest_co3(key INT, val STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_co3
 POSTHOOK: query: CREATE TABLE dest_co3(key INT, val STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/correlationoptimizer9.q.out b/ql/src/test/results/clientpositive/correlationoptimizer9.q.out
index 6be395b3d7..38da3c38ba 100644
--- a/ql/src/test/results/clientpositive/correlationoptimizer9.q.out
+++ b/ql/src/test/results/clientpositive/correlationoptimizer9.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE tmp(c1 INT, c2 INT, c3 STRING, c4 STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmp
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE tmp(c1 INT, c2 INT, c3 STRING, c4 STRING)
diff --git a/ql/src/test/results/clientpositive/count.q.out b/ql/src/test/results/clientpositive/count.q.out
index 4fec7c7f52..9618367105 100644
--- a/ql/src/test/results/clientpositive/count.q.out
+++ b/ql/src/test/results/clientpositive/count.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table abcd (a int, b int, c int, d int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@abcd
 POSTHOOK: query: create table abcd (a int, b int, c int, d int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/cp_mj_rc.q.out b/ql/src/test/results/clientpositive/cp_mj_rc.q.out
index cd207eb471..1f36a8f3bd 100644
--- a/ql/src/test/results/clientpositive/cp_mj_rc.q.out
+++ b/ql/src/test/results/clientpositive/cp_mj_rc.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table src_six_columns (k1 string, v1 string, k2 string, v2 string, k3 string, v3 string) stored as rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_six_columns
 POSTHOOK: query: create table src_six_columns (k1 string, v1 string, k2 string, v2 string, k3 string, v3 string) stored as rcfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -22,6 +23,7 @@ POSTHOOK: Lineage: src_six_columns.v3 SIMPLE [(src)src.FieldSchema(name:value, t
 PREHOOK: query: create table src_two_columns (k1 string, v1 string) stored as rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_two_columns
 POSTHOOK: query: create table src_two_columns (k1 string, v1 string) stored as rcfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/create_1.q.out b/ql/src/test/results/clientpositive/create_1.q.out
index e6d9e9e561..489496aa32 100644
--- a/ql/src/test/results/clientpositive/create_1.q.out
+++ b/ql/src/test/results/clientpositive/create_1.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE table1 (a STRING, b STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table1
 POSTHOOK: query: CREATE TABLE table1 (a STRING, b STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -30,6 +31,7 @@ POSTHOOK: type: CREATETABLE
 PREHOOK: query: CREATE TABLE IF NOT EXISTS table2 (a STRING, b INT) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table2
 POSTHOOK: query: CREATE TABLE IF NOT EXISTS table2 (a STRING, b INT) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -57,6 +59,7 @@ ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t'
 STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table3
 POSTHOOK: query: CREATE TABLE table3 (a STRING, b STRING)
 ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t'
 STORED AS TEXTFILE
@@ -86,6 +89,7 @@ ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t'
 STORED AS SEQUENCEFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table4
 POSTHOOK: query: CREATE TABLE table4 (a STRING, b STRING)
 ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t'
 STORED AS SEQUENCEFILE
@@ -115,6 +119,7 @@ ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t'
 STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table5
 POSTHOOK: query: CREATE TABLE table5 (a STRING, b STRING)
 ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t'
 STORED AS RCFILE
diff --git a/ql/src/test/results/clientpositive/create_alter_list_bucketing_table1.q.out b/ql/src/test/results/clientpositive/create_alter_list_bucketing_table1.q.out
index c875dbbc75..c5a253d477 100644
--- a/ql/src/test/results/clientpositive/create_alter_list_bucketing_table1.q.out
+++ b/ql/src/test/results/clientpositive/create_alter_list_bucketing_table1.q.out
@@ -6,6 +6,7 @@ CREATE TABLE  if not exists stored_as_dirs_multiple (col1 STRING, col2 int, col3
 SKEWED BY (col1, col2) ON (('s1',1), ('s3',3), ('s13',13), ('s78',78))  stored as DIRECTORIES
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@stored_as_dirs_multiple
 POSTHOOK: query: -- Test stored as directories
 -- it covers a few cases
 
@@ -152,6 +153,7 @@ PREHOOK: query: -- 4. alter a table to stored as directories
 CREATE TABLE stored_as_dirs_single (key STRING, value STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@stored_as_dirs_single
 POSTHOOK: query: -- 4. alter a table to stored as directories
 CREATE TABLE stored_as_dirs_single (key STRING, value STRING)
 POSTHOOK: type: CREATETABLE
@@ -310,6 +312,7 @@ PREHOOK: query: -- 7. create table like
 create table stored_as_dirs_single_like like stored_as_dirs_single
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@stored_as_dirs_single_like
 POSTHOOK: query: -- 7. create table like
 create table stored_as_dirs_single_like like stored_as_dirs_single
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/create_default_prop.q.out b/ql/src/test/results/clientpositive/create_default_prop.q.out
index ca44bea112..c841407b22 100644
--- a/ql/src/test/results/clientpositive/create_default_prop.q.out
+++ b/ql/src/test/results/clientpositive/create_default_prop.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE table_p1 (a STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table_p1
 POSTHOOK: query: CREATE TABLE table_p1 (a STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -17,6 +18,7 @@ a                   	string
 PREHOOK: query: CREATE TABLE table_p2 LIKE table_p1
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table_p2
 POSTHOOK: query: CREATE TABLE table_p2 LIKE table_p1
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/create_escape.q.out b/ql/src/test/results/clientpositive/create_escape.q.out
index 924c740b91..dbabb1439f 100644
--- a/ql/src/test/results/clientpositive/create_escape.q.out
+++ b/ql/src/test/results/clientpositive/create_escape.q.out
@@ -3,6 +3,7 @@ ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' ESCAPED BY '\\'
 STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table1
 POSTHOOK: query: CREATE TABLE table1 (a STRING, b STRING)
 ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' ESCAPED BY '\\'
 STORED AS TEXTFILE
diff --git a/ql/src/test/results/clientpositive/create_func1.q.out b/ql/src/test/results/clientpositive/create_func1.q.out
index daa4ecced3..798f77f0bb 100644
--- a/ql/src/test/results/clientpositive/create_func1.q.out
+++ b/ql/src/test/results/clientpositive/create_func1.q.out
@@ -11,8 +11,10 @@ POSTHOOK: Input: default@src
 true	false
 PREHOOK: query: create database mydb
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:mydb
 POSTHOOK: query: create database mydb
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:mydb
 PREHOOK: query: create function mydb.func1 as 'org.apache.hadoop.hive.ql.udf.generic.GenericUDFUpper'
 PREHOOK: type: CREATEFUNCTION
 PREHOOK: Output: database:mydb
@@ -61,8 +63,10 @@ POSTHOOK: Output: database:mydb
 POSTHOOK: Output: mydb.qtest_get_java_boolean
 PREHOOK: query: use default
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:default
 POSTHOOK: query: use default
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:default
 PREHOOK: query: -- unqualified function should resolve to one in default db
 select qtest_get_java_boolean('abc'), default.qtest_get_java_boolean('abc'), mydb.qtest_get_java_boolean('abc') from default.src limit 1
 PREHOOK: type: QUERY
@@ -76,8 +80,10 @@ POSTHOOK: Input: default@src
 NULL	NULL	ABC
 PREHOOK: query: use mydb
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:mydb
 POSTHOOK: query: use mydb
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:mydb
 PREHOOK: query: -- unqualified function should resolve to one in mydb db
 select qtest_get_java_boolean('abc'), default.qtest_get_java_boolean('abc'), mydb.qtest_get_java_boolean('abc') from default.src limit 1
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/create_genericudf.q.out b/ql/src/test/results/clientpositive/create_genericudf.q.out
index ba96685535..586f0bae7f 100644
--- a/ql/src/test/results/clientpositive/create_genericudf.q.out
+++ b/ql/src/test/results/clientpositive/create_genericudf.q.out
@@ -19,6 +19,7 @@ POSTHOOK: Output: test_translate
 PREHOOK: query: CREATE TABLE dest1(c1 STRING, c2 STRING, c3 STRING, c4 STRING, c5 STRING, c6 STRING, c7 STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(c1 STRING, c2 STRING, c3 STRING, c4 STRING, c5 STRING, c6 STRING, c7 STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/create_insert_outputformat.q.out b/ql/src/test/results/clientpositive/create_insert_outputformat.q.out
index f6786dc4f5..b3dd93bb75 100644
--- a/ql/src/test/results/clientpositive/create_insert_outputformat.q.out
+++ b/ql/src/test/results/clientpositive/create_insert_outputformat.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: CREATE TABLE table_test_output_format(key INT, value STRING) STO
   OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table_test_output_format
 POSTHOOK: query: CREATE TABLE table_test_output_format(key INT, value STRING) STORED AS
   INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat'
   OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat'
@@ -34,6 +35,7 @@ PREHOOK: query: CREATE TABLE table_test_output_format_sequencefile(key INT, valu
   OUTPUTFORMAT 'org.apache.hadoop.mapred.SequenceFileOutputFormat'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table_test_output_format_sequencefile
 POSTHOOK: query: CREATE TABLE table_test_output_format_sequencefile(key INT, value STRING) STORED AS
   INPUTFORMAT 'org.apache.hadoop.mapred.SequenceFileInputFormat'
   OUTPUTFORMAT 'org.apache.hadoop.mapred.SequenceFileOutputFormat'
@@ -65,6 +67,7 @@ PREHOOK: query: CREATE TABLE table_test_output_format_hivesequencefile(key INT,
   OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table_test_output_format_hivesequencefile
 POSTHOOK: query: CREATE TABLE table_test_output_format_hivesequencefile(key INT, value STRING) STORED AS
   INPUTFORMAT 'org.apache.hadoop.mapred.SequenceFileInputFormat'
   OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat'
diff --git a/ql/src/test/results/clientpositive/create_like.q.out b/ql/src/test/results/clientpositive/create_like.q.out
index caaab36d9b..a3d0980997 100644
--- a/ql/src/test/results/clientpositive/create_like.q.out
+++ b/ql/src/test/results/clientpositive/create_like.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE table1 (a STRING, b STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table1
 POSTHOOK: query: CREATE TABLE table1 (a STRING, b STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -39,6 +40,7 @@ Storage Desc Params:
 PREHOOK: query: CREATE TABLE table2 LIKE table1
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table2
 POSTHOOK: query: CREATE TABLE table2 LIKE table1
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -85,6 +87,7 @@ POSTHOOK: type: CREATETABLE
 PREHOOK: query: CREATE EXTERNAL TABLE IF NOT EXISTS table3 LIKE table1
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table3
 POSTHOOK: query: CREATE EXTERNAL TABLE IF NOT EXISTS table3 LIKE table1
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -164,6 +167,7 @@ POSTHOOK: Input: default@table2
 PREHOOK: type: CREATETABLE
 #### A masked pattern was here ####
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table4
 #### A masked pattern was here ####
 POSTHOOK: type: CREATETABLE
 #### A masked pattern was here ####
@@ -173,6 +177,7 @@ POSTHOOK: Output: default@table4
 PREHOOK: type: CREATETABLE
 #### A masked pattern was here ####
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table5
 #### A masked pattern was here ####
 POSTHOOK: type: CREATETABLE
 #### A masked pattern was here ####
@@ -240,6 +245,7 @@ POSTHOOK: Output: default@table4
 PREHOOK: type: CREATETABLE
 #### A masked pattern was here ####
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table4
 #### A masked pattern was here ####
 POSTHOOK: type: CREATETABLE
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/create_like2.q.out b/ql/src/test/results/clientpositive/create_like2.q.out
index d7f1dfd47b..e5c6f9c4db 100644
--- a/ql/src/test/results/clientpositive/create_like2.q.out
+++ b/ql/src/test/results/clientpositive/create_like2.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: -- Tests the copying over of Table Parameters according to a Hiv
 CREATE TABLE table1(a INT, b STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table1
 POSTHOOK: query: -- Tests the copying over of Table Parameters according to a HiveConf setting
 -- when doing a CREATE TABLE LIKE.
 
@@ -22,6 +23,7 @@ POSTHOOK: Output: default@table1
 PREHOOK: query: CREATE TABLE table2 LIKE table1
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table2
 POSTHOOK: query: CREATE TABLE table2 LIKE table1
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/create_like_tbl_props.q.out b/ql/src/test/results/clientpositive/create_like_tbl_props.q.out
index 7a8d387701..2ac28472ca 100644
--- a/ql/src/test/results/clientpositive/create_like_tbl_props.q.out
+++ b/ql/src/test/results/clientpositive/create_like_tbl_props.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- Test that CREATE TABLE LIKE commands can take explicit table
 CREATE TABLE test_table LIKE src TBLPROPERTIES('key'='value')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table
 POSTHOOK: query: -- Test that CREATE TABLE LIKE commands can take explicit table properties
 
 CREATE TABLE test_table LIKE src TBLPROPERTIES('key'='value')
@@ -46,6 +47,7 @@ PREHOOK: query: --Test that CREATE TABLE LIKE commands can take default table pr
 CREATE TABLE test_table1 LIKE src
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table1
 POSTHOOK: query: --Test that CREATE TABLE LIKE commands can take default table properties
 
 CREATE TABLE test_table1 LIKE src
@@ -89,6 +91,7 @@ PREHOOK: query: -- Test that CREATE TABLE LIKE commands can take default and exp
 CREATE TABLE test_table2 LIKE src TBLPROPERTIES('key2' = 'value2')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table2
 POSTHOOK: query: -- Test that CREATE TABLE LIKE commands can take default and explicit table properties
 
 CREATE TABLE test_table2 LIKE src TBLPROPERTIES('key2' = 'value2')
@@ -133,6 +136,7 @@ PREHOOK: query: -- Test that properties inherited are overwritten by explicitly
 CREATE TABLE test_table3 LIKE test_table2 TBLPROPERTIES('key2' = 'value3')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table3
 POSTHOOK: query: -- Test that properties inherited are overwritten by explicitly set ones
 
 CREATE TABLE test_table3 LIKE test_table2 TBLPROPERTIES('key2' = 'value3')
@@ -186,6 +190,7 @@ POSTHOOK: Output: default@test_view
 PREHOOK: query: CREATE TABLE test_table4 LIKE test_view TBLPROPERTIES('key'='value')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table4
 POSTHOOK: query: CREATE TABLE test_table4 LIKE test_view TBLPROPERTIES('key'='value')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/create_like_view.q.out b/ql/src/test/results/clientpositive/create_like_view.q.out
index c0cbdd83fb..bcd35d6c62 100644
--- a/ql/src/test/results/clientpositive/create_like_view.q.out
+++ b/ql/src/test/results/clientpositive/create_like_view.q.out
@@ -21,6 +21,7 @@ POSTHOOK: type: DROPVIEW
 PREHOOK: query: CREATE TABLE table1 (a STRING, b STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table1
 POSTHOOK: query: CREATE TABLE table1 (a STRING, b STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -74,6 +75,7 @@ POSTHOOK: Output: default@view1
 PREHOOK: query: CREATE TABLE table2 LIKE view1
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table2
 POSTHOOK: query: CREATE TABLE table2 LIKE view1
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -128,6 +130,7 @@ POSTHOOK: type: CREATETABLE
 PREHOOK: query: CREATE EXTERNAL TABLE IF NOT EXISTS table3 LIKE view1
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table3
 POSTHOOK: query: CREATE EXTERNAL TABLE IF NOT EXISTS table3 LIKE view1
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -247,6 +250,7 @@ POSTHOOK: Output: default@view1
 PREHOOK: query: create table table1 like view1
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table1
 POSTHOOK: query: create table table1 like view1
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/create_merge_compressed.q.out b/ql/src/test/results/clientpositive/create_merge_compressed.q.out
index c82d24a8dc..58f517c895 100644
--- a/ql/src/test/results/clientpositive/create_merge_compressed.q.out
+++ b/ql/src/test/results/clientpositive/create_merge_compressed.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table src_rc_merge_test(key int, value string) stored as rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_rc_merge_test
 POSTHOOK: query: create table src_rc_merge_test(key int, value string) stored as rcfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -16,6 +17,7 @@ POSTHOOK: Output: default@src_rc_merge_test
 PREHOOK: query: create table tgt_rc_merge_test(key int, value string) stored as rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tgt_rc_merge_test
 POSTHOOK: query: create table tgt_rc_merge_test(key int, value string) stored as rcfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/create_nested_type.q.out b/ql/src/test/results/clientpositive/create_nested_type.q.out
index 388266e4a1..e338f3fdcd 100644
--- a/ql/src/test/results/clientpositive/create_nested_type.q.out
+++ b/ql/src/test/results/clientpositive/create_nested_type.q.out
@@ -6,6 +6,7 @@ PREHOOK: query: CREATE TABLE table1 (
        ) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table1
 POSTHOOK: query: CREATE TABLE table1 (
        a STRING,
        b ARRAY<STRING>,
diff --git a/ql/src/test/results/clientpositive/create_or_replace_view.q.out b/ql/src/test/results/clientpositive/create_or_replace_view.q.out
index 36dfe77087..52ff417467 100644
--- a/ql/src/test/results/clientpositive/create_or_replace_view.q.out
+++ b/ql/src/test/results/clientpositive/create_or_replace_view.q.out
@@ -290,6 +290,7 @@ PREHOOK: query: -- updating to fix view with invalid definition
 create table srcpart_temp like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcpart_temp
 POSTHOOK: query: -- updating to fix view with invalid definition
 create table srcpart_temp like srcpart
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/create_skewed_table1.q.out b/ql/src/test/results/clientpositive/create_skewed_table1.q.out
index b3f61edfc2..e8d85a5bb4 100644
--- a/ql/src/test/results/clientpositive/create_skewed_table1.q.out
+++ b/ql/src/test/results/clientpositive/create_skewed_table1.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE list_bucket_single (key STRING, value STRING) SKEWED BY (key) ON ('1','5','6')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@list_bucket_single
 POSTHOOK: query: CREATE TABLE list_bucket_single (key STRING, value STRING) SKEWED BY (key) ON ('1','5','6')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@list_bucket_single
 PREHOOK: query: CREATE TABLE list_bucket_single_2 (key STRING, value STRING) SKEWED BY (key) ON ((1),(5),(6))
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@list_bucket_single_2
 POSTHOOK: query: CREATE TABLE list_bucket_single_2 (key STRING, value STRING) SKEWED BY (key) ON ((1),(5),(6))
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -15,6 +17,7 @@ POSTHOOK: Output: default@list_bucket_single_2
 PREHOOK: query: CREATE TABLE list_bucket_multiple (col1 STRING, col2 int, col3 STRING) SKEWED BY (col1, col2) ON (('s1',1), ('s3',3), ('s13',13), ('s78',78))
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@list_bucket_multiple
 POSTHOOK: query: CREATE TABLE list_bucket_multiple (col1 STRING, col2 int, col3 STRING) SKEWED BY (col1, col2) ON (('s1',1), ('s3',3), ('s13',13), ('s78',78))
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/create_struct_table.q.out b/ql/src/test/results/clientpositive/create_struct_table.q.out
index 9127316f9a..f4c7829d89 100644
--- a/ql/src/test/results/clientpositive/create_struct_table.q.out
+++ b/ql/src/test/results/clientpositive/create_struct_table.q.out
@@ -4,6 +4,7 @@ row format delimited
   collection items terminated by '\001'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@abc
 POSTHOOK: query: create table abc(strct struct<a:int, b:string, c:string>)
 row format delimited
   fields terminated by '\t'
diff --git a/ql/src/test/results/clientpositive/create_udaf.q.out b/ql/src/test/results/clientpositive/create_udaf.q.out
index 9f20f7964b..3aaf5a0985 100644
--- a/ql/src/test/results/clientpositive/create_udaf.q.out
+++ b/ql/src/test/results/clientpositive/create_udaf.q.out
@@ -19,6 +19,7 @@ POSTHOOK: Output: test_max
 PREHOOK: query: CREATE TABLE dest1(col INT)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(col INT)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/create_union_table.q.out b/ql/src/test/results/clientpositive/create_union_table.q.out
index e7ac6fb31b..a3f0918a24 100644
--- a/ql/src/test/results/clientpositive/create_union_table.q.out
+++ b/ql/src/test/results/clientpositive/create_union_table.q.out
@@ -21,6 +21,7 @@ PREHOOK: query: create table abc(mydata uniontype<int,double,array<string>,struc
 strct struct<a:int, b:string, c:string>)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@abc
 POSTHOOK: query: create table abc(mydata uniontype<int,double,array<string>,struct<a:int,b:string>>,
 strct struct<a:int, b:string, c:string>)
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/create_view.q.out b/ql/src/test/results/clientpositive/create_view.q.out
index cc67e28dae..45bae20de5 100644
--- a/ql/src/test/results/clientpositive/create_view.q.out
+++ b/ql/src/test/results/clientpositive/create_view.q.out
@@ -408,6 +408,7 @@ View Expanded Text: 	SELECT `_c0` AS `valoo` FROM (SELECT upper(`src`.`value`) F
 PREHOOK: query: CREATE TABLE table1 (key int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table1
 POSTHOOK: query: CREATE TABLE table1 (key int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/create_view_translate.q.out b/ql/src/test/results/clientpositive/create_view_translate.q.out
index 26dad2f25c..94b4dd6444 100644
--- a/ql/src/test/results/clientpositive/create_view_translate.q.out
+++ b/ql/src/test/results/clientpositive/create_view_translate.q.out
@@ -112,6 +112,7 @@ PREHOOK: query: -- HIVE-4116 Can't use views using map datatype.
 CREATE TABLE items (id INT, name STRING, info MAP<STRING,STRING>)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@items
 POSTHOOK: query: -- HIVE-4116 Can't use views using map datatype.
 
 CREATE TABLE items (id INT, name STRING, info MAP<STRING,STRING>)
diff --git a/ql/src/test/results/clientpositive/ct_case_insensitive.q.out b/ql/src/test/results/clientpositive/ct_case_insensitive.q.out
index 2bc28c8d08..1432b27418 100644
--- a/ql/src/test/results/clientpositive/ct_case_insensitive.q.out
+++ b/ql/src/test/results/clientpositive/ct_case_insensitive.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE tmp_pyang_bucket3 (userId INT) CLUSTERED BY (userid) INTO 32 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmp_pyang_bucket3
 POSTHOOK: query: CREATE TABLE tmp_pyang_bucket3 (userId INT) CLUSTERED BY (userid) INTO 32 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -16,6 +17,7 @@ POSTHOOK: Output: default@tmp_pyang_bucket3
 PREHOOK: query: CREATE TABLE tmp_pyang_bucket3 (userId INT) CLUSTERED BY (userid) SORTED BY (USERID) INTO 32 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmp_pyang_bucket3
 POSTHOOK: query: CREATE TABLE tmp_pyang_bucket3 (userId INT) CLUSTERED BY (userid) SORTED BY (USERID) INTO 32 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/ctas.q.out b/ql/src/test/results/clientpositive/ctas.q.out
index 7c1533a630..3c3d22b603 100644
--- a/ql/src/test/results/clientpositive/ctas.q.out
+++ b/ql/src/test/results/clientpositive/ctas.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- EXCLUDE_HADOOP_MAJOR_VERSIONS(0.20, 0.20S)
 create table nzhang_Tmp(a int, b string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@nzhang_Tmp
 POSTHOOK: query: -- EXCLUDE_HADOOP_MAJOR_VERSIONS(0.20, 0.20S)
 
 create table nzhang_Tmp(a int, b string)
@@ -912,6 +913,7 @@ POSTHOOK: Output: default@nzhang_ctas5
 PREHOOK: query: create table nzhang_ctas6 (key string, `to` string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@nzhang_ctas6
 POSTHOOK: query: create table nzhang_ctas6 (key string, `to` string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/ctas_char.q.out b/ql/src/test/results/clientpositive/ctas_char.q.out
index c2bd10c6c1..071034f079 100644
--- a/ql/src/test/results/clientpositive/ctas_char.q.out
+++ b/ql/src/test/results/clientpositive/ctas_char.q.out
@@ -13,6 +13,7 @@ POSTHOOK: type: DROPVIEW
 PREHOOK: query: create table ctas_char_1 (key char(10), value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@ctas_char_1
 POSTHOOK: query: create table ctas_char_1 (key char(10), value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/ctas_date.q.out b/ql/src/test/results/clientpositive/ctas_date.q.out
index c72b96a818..97bcff905b 100644
--- a/ql/src/test/results/clientpositive/ctas_date.q.out
+++ b/ql/src/test/results/clientpositive/ctas_date.q.out
@@ -17,6 +17,7 @@ POSTHOOK: type: DROPVIEW
 PREHOOK: query: create table ctas_date_1 (key int, value string, dd date)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@ctas_date_1
 POSTHOOK: query: create table ctas_date_1 (key int, value string, dd date)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/ctas_uses_database_location.q.out b/ql/src/test/results/clientpositive/ctas_uses_database_location.q.out
index a38c2b5471..c1ee330b75 100644
--- a/ql/src/test/results/clientpositive/ctas_uses_database_location.q.out
+++ b/ql/src/test/results/clientpositive/ctas_uses_database_location.q.out
@@ -5,6 +5,7 @@ PREHOOK: query: -- Tests that CTAS queries in non-default databases use the loca
 CREATE DATABASE db1
 #### A masked pattern was here ####
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:db1
 #### A masked pattern was here ####
 POSTHOOK: query: -- Tests that CTAS queries in non-default databases use the location of the database
 -- not the hive.metastore.warehouse.dir for intermediate files (FileSinkOperator output).
@@ -13,11 +14,14 @@ POSTHOOK: query: -- Tests that CTAS queries in non-default databases use the loc
 CREATE DATABASE db1
 #### A masked pattern was here ####
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:db1
 #### A masked pattern was here ####
 PREHOOK: query: USE db1
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:db1
 POSTHOOK: query: USE db1
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:db1
 PREHOOK: query: EXPLAIN CREATE TABLE table_db1 AS SELECT * FROM default.src
 PREHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: query: EXPLAIN CREATE TABLE table_db1 AS SELECT * FROM default.src
diff --git a/ql/src/test/results/clientpositive/ctas_varchar.q.out b/ql/src/test/results/clientpositive/ctas_varchar.q.out
index 1e3429547e..6a2116f0fc 100644
--- a/ql/src/test/results/clientpositive/ctas_varchar.q.out
+++ b/ql/src/test/results/clientpositive/ctas_varchar.q.out
@@ -13,6 +13,7 @@ POSTHOOK: type: DROPVIEW
 PREHOOK: query: create table ctas_varchar_1 (key varchar(10), value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@ctas_varchar_1
 POSTHOOK: query: create table ctas_varchar_1 (key varchar(10), value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/cte_2.q.out b/ql/src/test/results/clientpositive/cte_2.q.out
index 4d90cf6ef2..75398644b1 100644
--- a/ql/src/test/results/clientpositive/cte_2.q.out
+++ b/ql/src/test/results/clientpositive/cte_2.q.out
@@ -20,6 +20,7 @@ PREHOOK: query: -- insert test
 create table s1 like src
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@s1
 POSTHOOK: query: -- insert test
 create table s1 like src
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/custom_input_output_format.q.out b/ql/src/test/results/clientpositive/custom_input_output_format.q.out
index 950789f7e4..662ed1acec 100644
--- a/ql/src/test/results/clientpositive/custom_input_output_format.q.out
+++ b/ql/src/test/results/clientpositive/custom_input_output_format.q.out
@@ -5,6 +5,7 @@ CREATE TABLE src1_rot13_iof(key STRING, value STRING)
             OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.udf.Rot13OutputFormat'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src1_rot13_iof
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE src1_rot13_iof(key STRING, value STRING)
diff --git a/ql/src/test/results/clientpositive/database.q.out b/ql/src/test/results/clientpositive/database.q.out
index bacd18fe5f..00041196bf 100644
--- a/ql/src/test/results/clientpositive/database.q.out
+++ b/ql/src/test/results/clientpositive/database.q.out
@@ -10,9 +10,11 @@ default
 PREHOOK: query: -- CREATE with comment
 CREATE DATABASE test_db COMMENT 'Hive test database'
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:test_db
 POSTHOOK: query: -- CREATE with comment
 CREATE DATABASE test_db COMMENT 'Hive test database'
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:test_db
 PREHOOK: query: SHOW DATABASES
 PREHOOK: type: SHOWDATABASES
 POSTHOOK: query: SHOW DATABASES
@@ -22,9 +24,11 @@ test_db
 PREHOOK: query: -- CREATE INE already exists
 CREATE DATABASE IF NOT EXISTS test_db
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:test_db
 POSTHOOK: query: -- CREATE INE already exists
 CREATE DATABASE IF NOT EXISTS test_db
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:test_db
 PREHOOK: query: SHOW DATABASES
 PREHOOK: type: SHOWDATABASES
 POSTHOOK: query: SHOW DATABASES
@@ -57,9 +61,11 @@ default
 PREHOOK: query: -- CREATE INE doesn't exist
 CREATE DATABASE IF NOT EXISTS test_db COMMENT 'Hive test database'
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:test_db
 POSTHOOK: query: -- CREATE INE doesn't exist
 CREATE DATABASE IF NOT EXISTS test_db COMMENT 'Hive test database'
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:test_db
 PREHOOK: query: SHOW DATABASES
 PREHOOK: type: SHOWDATABASES
 POSTHOOK: query: SHOW DATABASES
@@ -90,9 +96,11 @@ POSTHOOK: type: DROPDATABASE
 PREHOOK: query: -- SHOW
 CREATE DATABASE test_db
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:test_db
 POSTHOOK: query: -- SHOW
 CREATE DATABASE test_db
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:test_db
 PREHOOK: query: SHOW DATABASES
 PREHOOK: type: SHOWDATABASES
 POSTHOOK: query: SHOW DATABASES
@@ -115,8 +123,10 @@ POSTHOOK: type: SHOWDATABASES
 default
 PREHOOK: query: USE test_db
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:test_db
 POSTHOOK: query: USE test_db
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:test_db
 PREHOOK: query: SHOW DATABASES
 PREHOOK: type: SHOWDATABASES
 POSTHOOK: query: SHOW DATABASES
@@ -127,6 +137,7 @@ PREHOOK: query: -- CREATE table in non-default DB
 CREATE TABLE test_table (col1 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:test_db
+PREHOOK: Output: test_db@test_table
 POSTHOOK: query: -- CREATE table in non-default DB
 CREATE TABLE test_table (col1 STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
@@ -161,6 +172,7 @@ PREHOOK: query: -- CREATE LIKE in non-default DB
 CREATE TABLE test_table_like LIKE test_table
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:test_db
+PREHOOK: Output: test_db@test_table_like
 POSTHOOK: query: -- CREATE LIKE in non-default DB
 CREATE TABLE test_table_like LIKE test_table
 POSTHOOK: type: CREATETABLE
@@ -225,6 +237,7 @@ test_table_like
 PREHOOK: query: CREATE TABLE test_table (col1 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:test_db
+PREHOOK: Output: test_db@test_table
 POSTHOOK: query: CREATE TABLE test_table (col1 STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:test_db
@@ -246,12 +259,15 @@ POSTHOOK: Input: test_db@test_table
 PREHOOK: query: -- CREATE table that already exists in DEFAULT
 USE test_db
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:test_db
 POSTHOOK: query: -- CREATE table that already exists in DEFAULT
 USE test_db
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:test_db
 PREHOOK: query: CREATE TABLE src (col1 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:test_db
+PREHOOK: Output: test_db@src
 POSTHOOK: query: CREATE TABLE src (col1 STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:test_db
@@ -273,8 +289,10 @@ POSTHOOK: Input: test_db@src
 #### A masked pattern was here ####
 PREHOOK: query: USE default
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:default
 POSTHOOK: query: USE default
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:default
 PREHOOK: query: SELECT * FROM src LIMIT 10
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
@@ -296,9 +314,11 @@ POSTHOOK: Input: default@src
 PREHOOK: query: -- DROP DATABASE
 USE test_db
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:test_db
 POSTHOOK: query: -- DROP DATABASE
 USE test_db
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:test_db
 PREHOOK: query: DROP TABLE src
 PREHOOK: type: DROPTABLE
 PREHOOK: Input: test_db@src
@@ -329,8 +349,10 @@ POSTHOOK: query: SHOW TABLES
 POSTHOOK: type: SHOWTABLES
 PREHOOK: query: USE default
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:default
 POSTHOOK: query: USE default
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:default
 PREHOOK: query: DROP DATABASE test_db
 PREHOOK: type: DROPDATABASE
 PREHOOK: Input: database:test_db
@@ -347,9 +369,11 @@ default
 PREHOOK: query: -- DROP EMPTY DATABASE CASCADE
 CREATE DATABASE to_drop_db1
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:to_drop_db1
 POSTHOOK: query: -- DROP EMPTY DATABASE CASCADE
 CREATE DATABASE to_drop_db1
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:to_drop_db1
 PREHOOK: query: SHOW DATABASES
 PREHOOK: type: SHOWDATABASES
 POSTHOOK: query: SHOW DATABASES
@@ -358,8 +382,10 @@ default
 to_drop_db1
 PREHOOK: query: USE default
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:default
 POSTHOOK: query: USE default
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:default
 PREHOOK: query: DROP DATABASE to_drop_db1 CASCADE
 PREHOOK: type: DROPDATABASE
 PREHOOK: Input: database:to_drop_db1
@@ -376,9 +402,11 @@ default
 PREHOOK: query: -- DROP NON-EMPTY DATABASE CASCADE
 CREATE DATABASE to_drop_db2
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:to_drop_db2
 POSTHOOK: query: -- DROP NON-EMPTY DATABASE CASCADE
 CREATE DATABASE to_drop_db2
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:to_drop_db2
 PREHOOK: query: SHOW DATABASES
 PREHOOK: type: SHOWDATABASES
 POSTHOOK: query: SHOW DATABASES
@@ -387,11 +415,14 @@ default
 to_drop_db2
 PREHOOK: query: USE to_drop_db2
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:to_drop_db2
 POSTHOOK: query: USE to_drop_db2
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:to_drop_db2
 PREHOOK: query: CREATE TABLE temp_tbl (c STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:to_drop_db2
+PREHOOK: Output: to_drop_db2@temp_tbl
 POSTHOOK: query: CREATE TABLE temp_tbl (c STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:to_drop_db2
@@ -399,6 +430,7 @@ POSTHOOK: Output: to_drop_db2@temp_tbl
 PREHOOK: query: CREATE TABLE temp_tbl2 LIKE temp_tbl
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:to_drop_db2
+PREHOOK: Output: to_drop_db2@temp_tbl2
 POSTHOOK: query: CREATE TABLE temp_tbl2 LIKE temp_tbl
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:to_drop_db2
@@ -414,8 +446,10 @@ POSTHOOK: Output: to_drop_db2@temp_tbl2
 POSTHOOK: Lineage: temp_tbl2.c EXPRESSION [(temp_tbl)temp_tbl.null, ]
 PREHOOK: query: USE default
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:default
 POSTHOOK: query: USE default
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:default
 PREHOOK: query: DROP DATABASE to_drop_db2 CASCADE
 PREHOOK: type: DROPDATABASE
 PREHOOK: Input: database:to_drop_db2
@@ -436,9 +470,11 @@ default
 PREHOOK: query: -- DROP NON-EMPTY DATABASE CASCADE IF EXISTS
 CREATE DATABASE to_drop_db3
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:to_drop_db3
 POSTHOOK: query: -- DROP NON-EMPTY DATABASE CASCADE IF EXISTS
 CREATE DATABASE to_drop_db3
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:to_drop_db3
 PREHOOK: query: SHOW DATABASES
 PREHOOK: type: SHOWDATABASES
 POSTHOOK: query: SHOW DATABASES
@@ -447,19 +483,24 @@ default
 to_drop_db3
 PREHOOK: query: USE to_drop_db3
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:to_drop_db3
 POSTHOOK: query: USE to_drop_db3
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:to_drop_db3
 PREHOOK: query: CREATE TABLE temp_tbl (c STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:to_drop_db3
+PREHOOK: Output: to_drop_db3@temp_tbl
 POSTHOOK: query: CREATE TABLE temp_tbl (c STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:to_drop_db3
 POSTHOOK: Output: to_drop_db3@temp_tbl
 PREHOOK: query: USE default
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:default
 POSTHOOK: query: USE default
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:default
 PREHOOK: query: DROP DATABASE IF EXISTS to_drop_db3 CASCADE
 PREHOOK: type: DROPDATABASE
 PREHOOK: Input: database:to_drop_db3
@@ -495,9 +536,11 @@ POSTHOOK: type: DROPDATABASE
 PREHOOK: query: -- DROP EMPTY DATABASE RESTRICT
 CREATE DATABASE to_drop_db4
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:to_drop_db4
 POSTHOOK: query: -- DROP EMPTY DATABASE RESTRICT
 CREATE DATABASE to_drop_db4
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:to_drop_db4
 PREHOOK: query: SHOW DATABASES
 PREHOOK: type: SHOWDATABASES
 POSTHOOK: query: SHOW DATABASES
@@ -523,26 +566,32 @@ PREHOOK: query: --
 
 CREATE DATABASE db1
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:db1
 POSTHOOK: query: --
 -- Canonical Name Tests
 --
 
 CREATE DATABASE db1
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:db1
 PREHOOK: query: CREATE DATABASE db2
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:db2
 POSTHOOK: query: CREATE DATABASE db2
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:db2
 PREHOOK: query: -- CREATE foreign table
 CREATE TABLE db1.src(key STRING, value STRING)
 STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:db1
+PREHOOK: Output: db1@db1.src
 POSTHOOK: query: -- CREATE foreign table
 CREATE TABLE db1.src(key STRING, value STRING)
 STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:db1
+POSTHOOK: Output: db1@db1.src
 POSTHOOK: Output: db1@src
 PREHOOK: query: -- LOAD into foreign table
 LOAD DATA LOCAL INPATH '../../data/files/kv1.txt'
@@ -1072,12 +1121,14 @@ PARTITIONED BY (ds STRING, hr STRING)
 STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:db1
+PREHOOK: Output: db1@db1.srcpart
 POSTHOOK: query: -- CREATE Partitioned foreign table
 CREATE TABLE db1.srcpart(key STRING, value STRING)
 PARTITIONED BY (ds STRING, hr STRING)
 STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:db1
+POSTHOOK: Output: db1@db1.srcpart
 POSTHOOK: Output: db1@srcpart
 PREHOOK: query: -- LOAD data into Partitioned foreign table
 LOAD DATA LOCAL INPATH '../../data/files/kv1.txt'
@@ -1195,9 +1246,11 @@ POSTHOOK: Input: db1@srcpart@ds=2008-04-08/hr=11
 PREHOOK: query: -- SELECT JOINed product of two foreign tables
 USE db2
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:db2
 POSTHOOK: query: -- SELECT JOINed product of two foreign tables
 USE db2
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:db2
 PREHOOK: query: SELECT a.* FROM db1.src a JOIN default.src1 b
 ON (a.key = b.key)
 PREHOOK: type: QUERY
@@ -1293,8 +1346,10 @@ val_66
 val_8
 PREHOOK: query: USE default
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:default
 POSTHOOK: query: USE default
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:default
 PREHOOK: query: SELECT * FROM (
   SELECT value FROM db1.conflict_name
 UNION ALL
@@ -1320,6 +1375,7 @@ CREATE TABLE bucketized_src (key INT, value STRING)
 CLUSTERED BY (key) SORTED BY (key) INTO 1 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucketized_src
 POSTHOOK: query: -- TABLESAMPLES
 CREATE TABLE bucketized_src (key INT, value STRING)
 CLUSTERED BY (key) SORTED BY (key) INTO 1 BUCKETS
@@ -1351,15 +1407,19 @@ PREHOOK: query: -- CREATE TABLE LIKE
 CREATE TABLE db2.src1 LIKE default.src
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:db2
+PREHOOK: Output: db2@db2.src1
 POSTHOOK: query: -- CREATE TABLE LIKE
 CREATE TABLE db2.src1 LIKE default.src
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:db2
+POSTHOOK: Output: db2@db2.src1
 POSTHOOK: Output: db2@src1
 PREHOOK: query: USE db2
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:db2
 POSTHOOK: query: USE db2
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:db2
 PREHOOK: query: DESC EXTENDED src1
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: db2@src1
@@ -1401,5 +1461,7 @@ POSTHOOK: Input: default@src
 0
 PREHOOK: query: USE default
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:default
 POSTHOOK: query: USE default
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:default
diff --git a/ql/src/test/results/clientpositive/database_drop.q.out b/ql/src/test/results/clientpositive/database_drop.q.out
index 0620b6725a..bc78c94d14 100644
--- a/ql/src/test/results/clientpositive/database_drop.q.out
+++ b/ql/src/test/results/clientpositive/database_drop.q.out
@@ -6,6 +6,7 @@ PREHOOK: query: -- create database with multiple tables, indexes and views.
 
 CREATE DATABASE db5
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:db5
 POSTHOOK: query: -- create database with multiple tables, indexes and views.
 -- Use both partitioned and non-partitioned tables, as well as
 -- tables and indexes with specific storage locations
@@ -14,6 +15,7 @@ POSTHOOK: query: -- create database with multiple tables, indexes and views.
 
 CREATE DATABASE db5
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:db5
 PREHOOK: query: SHOW DATABASES
 PREHOOK: type: SHOWDATABASES
 POSTHOOK: query: SHOW DATABASES
@@ -22,13 +24,16 @@ db5
 default
 PREHOOK: query: USE db5
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:db5
 POSTHOOK: query: USE db5
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:db5
 #### A masked pattern was here ####
 PREHOOK: query: -- add a table, index and view
 CREATE TABLE temp_tbl (id INT, name STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:db5
+PREHOOK: Output: db5@temp_tbl
 POSTHOOK: query: -- add a table, index and view
 CREATE TABLE temp_tbl (id INT, name STRING)
 POSTHOOK: type: CREATETABLE
@@ -51,8 +56,10 @@ POSTHOOK: Input: db5@temp_tbl
 POSTHOOK: Output: db5@temp_tbl_view
 PREHOOK: query: CREATE INDEX idx1 ON TABLE temp_tbl(id) AS 'COMPACT' with DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: db5@temp_tbl
 POSTHOOK: query: CREATE INDEX idx1 ON TABLE temp_tbl(id) AS 'COMPACT' with DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: db5@temp_tbl
 POSTHOOK: Output: db5@db5__temp_tbl_idx1__
 PREHOOK: query: ALTER INDEX idx1 ON temp_tbl REBUILD
 PREHOOK: type: ALTERINDEX_REBUILD
@@ -70,6 +77,7 @@ PREHOOK: query: -- add a table, index and view with a different storage location
 PREHOOK: type: CREATETABLE
 #### A masked pattern was here ####
 PREHOOK: Output: database:db5
+PREHOOK: Output: db5@temp_tbl2
 POSTHOOK: query: -- add a table, index and view with a different storage location
 #### A masked pattern was here ####
 POSTHOOK: type: CREATETABLE
@@ -93,8 +101,10 @@ POSTHOOK: Input: db5@temp_tbl2
 POSTHOOK: Output: db5@temp_tbl2_view
 #### A masked pattern was here ####
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: db5@temp_tbl2
 #### A masked pattern was here ####
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: db5@temp_tbl2
 POSTHOOK: Output: db5@db5__temp_tbl2_idx2__
 #### A masked pattern was here ####
 PREHOOK: query: ALTER INDEX idx2 ON temp_tbl2 REBUILD
@@ -112,6 +122,7 @@ PREHOOK: query: -- add a partitioned table, index and view
 CREATE TABLE part_tab (id INT, name STRING)  PARTITIONED BY (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:db5
+PREHOOK: Output: db5@part_tab
 POSTHOOK: query: -- add a partitioned table, index and view
 CREATE TABLE part_tab (id INT, name STRING)  PARTITIONED BY (ds string)
 POSTHOOK: type: CREATETABLE
@@ -137,8 +148,10 @@ POSTHOOK: Output: db5@part_tab
 POSTHOOK: Output: db5@part_tab@ds=2009-04-09
 PREHOOK: query: CREATE INDEX idx3 ON TABLE part_tab(id) AS 'COMPACT' with DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: db5@part_tab
 POSTHOOK: query: CREATE INDEX idx3 ON TABLE part_tab(id) AS 'COMPACT' with DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: db5@part_tab
 POSTHOOK: Output: db5@db5__part_tab_idx3__
 PREHOOK: query: ALTER INDEX idx3 ON part_tab PARTITION (ds='2008-04-09') REBUILD
 PREHOOK: type: ALTERINDEX_REBUILD
@@ -172,6 +185,7 @@ CREATE TABLE part_tab2 (id INT, name STRING)  PARTITIONED BY (ds string)
 PREHOOK: type: CREATETABLE
 #### A masked pattern was here ####
 PREHOOK: Output: database:db5
+PREHOOK: Output: db5@part_tab2
 POSTHOOK: query: -- add a partitioned table, index and view with a different storage location
 CREATE TABLE part_tab2 (id INT, name STRING)  PARTITIONED BY (ds string)
 #### A masked pattern was here ####
@@ -200,10 +214,12 @@ POSTHOOK: Output: db5@part_tab2@ds=2009-04-09
 PREHOOK: query: CREATE INDEX idx4 ON TABLE part_tab2(id) AS 'COMPACT' with DEFERRED REBUILD
 #### A masked pattern was here ####
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: db5@part_tab2
 #### A masked pattern was here ####
 POSTHOOK: query: CREATE INDEX idx4 ON TABLE part_tab2(id) AS 'COMPACT' with DEFERRED REBUILD
 #### A masked pattern was here ####
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: db5@part_tab2
 POSTHOOK: Output: db5@db5__part_tab2_idx4__
 #### A masked pattern was here ####
 PREHOOK: query: ALTER INDEX idx4 ON part_tab2 PARTITION (ds='2008-04-09') REBUILD
@@ -238,6 +254,7 @@ CREATE TABLE part_tab3 (id INT, name STRING)  PARTITIONED BY (ds string)
 PREHOOK: type: CREATETABLE
 #### A masked pattern was here ####
 PREHOOK: Output: database:db5
+PREHOOK: Output: db5@part_tab3
 POSTHOOK: query: -- add a partitioned table, index and view with a different storage location
 CREATE TABLE part_tab3 (id INT, name STRING)  PARTITIONED BY (ds string)
 #### A masked pattern was here ####
@@ -275,10 +292,12 @@ POSTHOOK: Output: db5@part_tab3@ds=2009-04-09
 PREHOOK: query: CREATE INDEX idx5 ON TABLE part_tab3(id) AS 'COMPACT' with DEFERRED REBUILD
 #### A masked pattern was here ####
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: db5@part_tab3
 #### A masked pattern was here ####
 POSTHOOK: query: CREATE INDEX idx5 ON TABLE part_tab3(id) AS 'COMPACT' with DEFERRED REBUILD
 #### A masked pattern was here ####
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: db5@part_tab3
 POSTHOOK: Output: db5@db5__part_tab3_idx5__
 #### A masked pattern was here ####
 PREHOOK: query: ALTER INDEX idx5 ON part_tab3 PARTITION (ds='2008-04-09') REBUILD
@@ -316,6 +335,7 @@ CREATE EXTERNAL TABLE extab1(id INT, name STRING) ROW FORMAT
 PREHOOK: type: CREATETABLE
 #### A masked pattern was here ####
 PREHOOK: Output: database:db5
+PREHOOK: Output: db5@extab1
 POSTHOOK: query: -- add an external table
 CREATE EXTERNAL TABLE extab1(id INT, name STRING) ROW FORMAT
               DELIMITED FIELDS TERMINATED BY ''
diff --git a/ql/src/test/results/clientpositive/database_location.q.out b/ql/src/test/results/clientpositive/database_location.q.out
index b5f352f949..3ad6bbb8e6 100644
--- a/ql/src/test/results/clientpositive/database_location.q.out
+++ b/ql/src/test/results/clientpositive/database_location.q.out
@@ -1,7 +1,9 @@
 PREHOOK: query: CREATE DATABASE db1
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:db1
 POSTHOOK: query: CREATE DATABASE db1
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:db1
 PREHOOK: query: DESCRIBE DATABASE EXTENDED db1
 PREHOOK: type: DESCDATABASE
 POSTHOOK: query: DESCRIBE DATABASE EXTENDED db1
@@ -9,11 +11,14 @@ POSTHOOK: type: DESCDATABASE
 db1		location/in/test	hive_test_user	USER	
 PREHOOK: query: USE db1
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:db1
 POSTHOOK: query: USE db1
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:db1
 PREHOOK: query: CREATE TABLE table_db1 (name STRING, value INT)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:db1
+PREHOOK: Output: db1@table_db1
 POSTHOOK: query: CREATE TABLE table_db1 (name STRING, value INT)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:db1
@@ -58,11 +63,13 @@ PREHOOK: query: CREATE DATABASE db2
 COMMENT 'database 2'
 #### A masked pattern was here ####
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:db2
 #### A masked pattern was here ####
 POSTHOOK: query: CREATE DATABASE db2
 COMMENT 'database 2'
 #### A masked pattern was here ####
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:db2
 #### A masked pattern was here ####
 PREHOOK: query: DESCRIBE DATABASE EXTENDED db2
 PREHOOK: type: DESCDATABASE
@@ -71,11 +78,14 @@ POSTHOOK: type: DESCDATABASE
 db2	database 2	location/in/test	hive_test_user	USER	
 PREHOOK: query: USE db2
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:db2
 POSTHOOK: query: USE db2
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:db2
 PREHOOK: query: CREATE TABLE table_db2 (name STRING, value INT)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:db2
+PREHOOK: Output: db2@table_db2
 POSTHOOK: query: CREATE TABLE table_db2 (name STRING, value INT)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:db2
diff --git a/ql/src/test/results/clientpositive/database_properties.q.out b/ql/src/test/results/clientpositive/database_properties.q.out
index 3066296233..86a1c43405 100644
--- a/ql/src/test/results/clientpositive/database_properties.q.out
+++ b/ql/src/test/results/clientpositive/database_properties.q.out
@@ -1,7 +1,9 @@
 PREHOOK: query: create database db1
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:db1
 POSTHOOK: query: create database db1
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:db1
 PREHOOK: query: show databases
 PREHOOK: type: SHOWDATABASES
 POSTHOOK: query: show databases
@@ -13,11 +15,13 @@ PREHOOK: query: create database db2 with dbproperties (
   'hive.warehouse.dir' = '/user/hive/warehouse',
 #### A masked pattern was here ####
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:db2
 POSTHOOK: query: create database db2 with dbproperties (
   'mapred.jobtracker.url'='http://my.jobtracker.com:53000',
   'hive.warehouse.dir' = '/user/hive/warehouse',
 #### A masked pattern was here ####
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:db2
 PREHOOK: query: describe database db2
 PREHOOK: type: DESCDATABASE
 POSTHOOK: query: describe database db2
diff --git a/ql/src/test/results/clientpositive/date_1.q.out b/ql/src/test/results/clientpositive/date_1.q.out
index 3bf3109f30..df9fc47442 100644
--- a/ql/src/test/results/clientpositive/date_1.q.out
+++ b/ql/src/test/results/clientpositive/date_1.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table date_1 (d date)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@date_1
 POSTHOOK: query: create table date_1 (d date)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/date_2.q.out b/ql/src/test/results/clientpositive/date_2.q.out
index e6ac753b34..402dae8e05 100644
--- a/ql/src/test/results/clientpositive/date_2.q.out
+++ b/ql/src/test/results/clientpositive/date_2.q.out
@@ -11,6 +11,7 @@ PREHOOK: query: create table date_2 (
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@date_2
 POSTHOOK: query: create table date_2 (
   ORIGIN_CITY_NAME string,
   DEST_CITY_NAME string,
diff --git a/ql/src/test/results/clientpositive/date_3.q.out b/ql/src/test/results/clientpositive/date_3.q.out
index fe8846752c..8833479cad 100644
--- a/ql/src/test/results/clientpositive/date_3.q.out
+++ b/ql/src/test/results/clientpositive/date_3.q.out
@@ -7,6 +7,7 @@ PREHOOK: query: create table date_3 (
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@date_3
 POSTHOOK: query: create table date_3 (
   c1 int
 )
diff --git a/ql/src/test/results/clientpositive/date_4.q.out b/ql/src/test/results/clientpositive/date_4.q.out
index 94c2538227..02e5c96145 100644
--- a/ql/src/test/results/clientpositive/date_4.q.out
+++ b/ql/src/test/results/clientpositive/date_4.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table date_4 (d date)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@date_4
 POSTHOOK: query: create table date_4 (d date)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/date_join1.q.out b/ql/src/test/results/clientpositive/date_join1.q.out
index 2086840f6c..8a9d312206 100644
--- a/ql/src/test/results/clientpositive/date_join1.q.out
+++ b/ql/src/test/results/clientpositive/date_join1.q.out
@@ -11,6 +11,7 @@ PREHOOK: query: create table date_join1 (
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@date_join1
 POSTHOOK: query: create table date_join1 (
   ORIGIN_CITY_NAME string,
   DEST_CITY_NAME string,
diff --git a/ql/src/test/results/clientpositive/date_serde.q.out b/ql/src/test/results/clientpositive/date_serde.q.out
index c462b76186..ff09f7000c 100644
--- a/ql/src/test/results/clientpositive/date_serde.q.out
+++ b/ql/src/test/results/clientpositive/date_serde.q.out
@@ -39,6 +39,7 @@ with serdeproperties (
 stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@date_serde_regex
 POSTHOOK: query: --
 -- RegexSerDe
 --
@@ -239,6 +240,7 @@ create table date_serde_lb (
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@date_serde_lb
 POSTHOOK: query: --
 -- LazyBinary
 --
@@ -296,6 +298,7 @@ create table date_serde_ls (
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@date_serde_ls
 POSTHOOK: query: --
 -- LazySimple
 --
@@ -353,6 +356,7 @@ create table date_serde_c (
 ) stored as rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@date_serde_c
 POSTHOOK: query: --
 -- Columnar
 --
@@ -410,6 +414,7 @@ create table date_serde_lbc (
 ) stored as rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@date_serde_lbc
 POSTHOOK: query: --
 -- LazyBinaryColumnar
 --
@@ -467,6 +472,7 @@ create table date_serde_orc (
 ) stored as orc
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@date_serde_orc
 POSTHOOK: query: --
 -- ORC
 --
diff --git a/ql/src/test/results/clientpositive/date_udf.q.out b/ql/src/test/results/clientpositive/date_udf.q.out
index eb6829c5c7..9b37da60c0 100644
--- a/ql/src/test/results/clientpositive/date_udf.q.out
+++ b/ql/src/test/results/clientpositive/date_udf.q.out
@@ -13,6 +13,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table date_udf (d date)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@date_udf
 POSTHOOK: query: create table date_udf (d date)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -20,6 +21,7 @@ POSTHOOK: Output: default@date_udf
 PREHOOK: query: create table date_udf_string (d string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@date_udf_string
 POSTHOOK: query: create table date_udf_string (d string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -53,6 +55,7 @@ PREHOOK: query: create table date_udf_flight (
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@date_udf_flight
 POSTHOOK: query: create table date_udf_flight (
   ORIGIN_CITY_NAME string,
   DEST_CITY_NAME string,
diff --git a/ql/src/test/results/clientpositive/dbtxnmgr_compact1.q.out b/ql/src/test/results/clientpositive/dbtxnmgr_compact1.q.out
index a59a3e6dcc..46216f9fc2 100644
--- a/ql/src/test/results/clientpositive/dbtxnmgr_compact1.q.out
+++ b/ql/src/test/results/clientpositive/dbtxnmgr_compact1.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table T1(key string, val string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: create table T1(key string, val string) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/dbtxnmgr_compact2.q.out b/ql/src/test/results/clientpositive/dbtxnmgr_compact2.q.out
index f7c73942b2..40280a9d37 100644
--- a/ql/src/test/results/clientpositive/dbtxnmgr_compact2.q.out
+++ b/ql/src/test/results/clientpositive/dbtxnmgr_compact2.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table T1(key string, val string) partitioned by (ds string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: create table T1(key string, val string) partitioned by (ds string) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/dbtxnmgr_compact3.q.out b/ql/src/test/results/clientpositive/dbtxnmgr_compact3.q.out
index 09acb95336..07e4e6d284 100644
--- a/ql/src/test/results/clientpositive/dbtxnmgr_compact3.q.out
+++ b/ql/src/test/results/clientpositive/dbtxnmgr_compact3.q.out
@@ -1,13 +1,18 @@
 PREHOOK: query: create database D1
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:D1
 POSTHOOK: query: create database D1
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:D1
 PREHOOK: query: use D1
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:d1
 POSTHOOK: query: use D1
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:d1
 PREHOOK: query: create table T1(key string, val string) stored as textfile
 PREHOOK: type: CREATETABLE
+PREHOOK: Output: D1@T1
 PREHOOK: Output: database:d1
 POSTHOOK: query: create table T1(key string, val string) stored as textfile
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/dbtxnmgr_ddl1.q.out b/ql/src/test/results/clientpositive/dbtxnmgr_ddl1.q.out
index fe7d5823d9..bdf3c34cf1 100644
--- a/ql/src/test/results/clientpositive/dbtxnmgr_ddl1.q.out
+++ b/ql/src/test/results/clientpositive/dbtxnmgr_ddl1.q.out
@@ -1,7 +1,9 @@
 PREHOOK: query: create database D1
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:D1
 POSTHOOK: query: create database D1
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:D1
 PREHOOK: query: alter database D1 set dbproperties('test'='yesthisis')
 PREHOOK: type: ALTERDATABASE
 PREHOOK: Output: database:d1
@@ -19,6 +21,7 @@ POSTHOOK: Output: database:d1
 PREHOOK: query: create table T1(key string, val string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: create table T1(key string, val string) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -26,6 +29,7 @@ POSTHOOK: Output: default@T1
 PREHOOK: query: create table T2 like T1
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T2
 POSTHOOK: query: create table T2 like T1
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -65,6 +69,7 @@ PREHOOK: query: create table T4 (key char(10), val decimal(5,2), b int)
     stored as orc
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T4
 POSTHOOK: query: create table T4 (key char(10), val decimal(5,2), b int)
     partitioned by (ds string)
     clustered by (b) into 10 buckets
@@ -148,6 +153,7 @@ POSTHOOK: Output: default@t4@ds=tomorrow
 PREHOOK: query: create table T5 (a string, b int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T5
 POSTHOOK: query: create table T5 (a string, b int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -172,6 +178,7 @@ POSTHOOK: Output: default@t4@ds=tomorrow
 PREHOOK: query: create table T7 (a string, b int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T7
 POSTHOOK: query: create table T7 (a string, b int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/dbtxnmgr_query1.q.out b/ql/src/test/results/clientpositive/dbtxnmgr_query1.q.out
index 6ba7b3426d..2e14e8ddaf 100644
--- a/ql/src/test/results/clientpositive/dbtxnmgr_query1.q.out
+++ b/ql/src/test/results/clientpositive/dbtxnmgr_query1.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table T1(key string, val string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: create table T1(key string, val string) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -30,6 +31,7 @@ POSTHOOK: Input: default@t1
 PREHOOK: query: create table T2(key string, val string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T2
 POSTHOOK: query: create table T2(key string, val string) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/dbtxnmgr_query2.q.out b/ql/src/test/results/clientpositive/dbtxnmgr_query2.q.out
index 0abe1c1281..ad19a82418 100644
--- a/ql/src/test/results/clientpositive/dbtxnmgr_query2.q.out
+++ b/ql/src/test/results/clientpositive/dbtxnmgr_query2.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table T1(key string, val string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: create table T1(key string, val string) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -30,6 +31,7 @@ POSTHOOK: Input: default@t1
 PREHOOK: query: create table T2(key string, val string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T2
 POSTHOOK: query: create table T2(key string, val string) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/dbtxnmgr_query3.q.out b/ql/src/test/results/clientpositive/dbtxnmgr_query3.q.out
index 39bc8948d6..a306d7a91b 100644
--- a/ql/src/test/results/clientpositive/dbtxnmgr_query3.q.out
+++ b/ql/src/test/results/clientpositive/dbtxnmgr_query3.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table T1(key string, val string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: create table T1(key string, val string) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -30,6 +31,7 @@ POSTHOOK: Input: default@t1
 PREHOOK: query: create table T2(key string, val string) partitioned by (pval string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T2
 POSTHOOK: query: create table T2(key string, val string) partitioned by (pval string) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/dbtxnmgr_query4.q.out b/ql/src/test/results/clientpositive/dbtxnmgr_query4.q.out
index 3838fae8de..92e59bbe88 100644
--- a/ql/src/test/results/clientpositive/dbtxnmgr_query4.q.out
+++ b/ql/src/test/results/clientpositive/dbtxnmgr_query4.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table T1(key string, val string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: create table T1(key string, val string) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -30,6 +31,7 @@ POSTHOOK: Input: default@t1
 PREHOOK: query: create table T2(key string) partitioned by (val string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T2
 POSTHOOK: query: create table T2(key string) partitioned by (val string) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/dbtxnmgr_query5.q.out b/ql/src/test/results/clientpositive/dbtxnmgr_query5.q.out
index 0244f45ce3..5ce9780be7 100644
--- a/ql/src/test/results/clientpositive/dbtxnmgr_query5.q.out
+++ b/ql/src/test/results/clientpositive/dbtxnmgr_query5.q.out
@@ -1,14 +1,19 @@
 PREHOOK: query: create database foo
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:foo
 POSTHOOK: query: create database foo
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:foo
 PREHOOK: query: use foo
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:foo
 POSTHOOK: query: use foo
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:foo
 PREHOOK: query: create table T1(key string, val string) partitioned by (ds string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:foo
+PREHOOK: Output: foo@T1
 POSTHOOK: query: create table T1(key string, val string) partitioned by (ds string) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:foo
diff --git a/ql/src/test/results/clientpositive/ddltime.q.out b/ql/src/test/results/clientpositive/ddltime.q.out
index d5b902e221..ec8938d220 100644
--- a/ql/src/test/results/clientpositive/ddltime.q.out
+++ b/ql/src/test/results/clientpositive/ddltime.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table T1 like src
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: create table T1 like src
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -78,6 +79,7 @@ value               	string              	default
 PREHOOK: query: create table if not exists T2 like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T2
 POSTHOOK: query: create table if not exists T2 like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/decimal_1.q.out b/ql/src/test/results/clientpositive/decimal_1.q.out
index ab71d25b19..17090f7059 100644
--- a/ql/src/test/results/clientpositive/decimal_1.q.out
+++ b/ql/src/test/results/clientpositive/decimal_1.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table decimal_1 (t decimal(4,2), u decimal(5), v decimal)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@decimal_1
 POSTHOOK: query: create table decimal_1 (t decimal(4,2), u decimal(5), v decimal)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/decimal_10_0.q.out b/ql/src/test/results/clientpositive/decimal_10_0.q.out
index 722a0a0f81..ae3426c50c 100644
--- a/ql/src/test/results/clientpositive/decimal_10_0.q.out
+++ b/ql/src/test/results/clientpositive/decimal_10_0.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: CREATE TABLE DECIMAL (dec decimal)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@DECIMAL
 POSTHOOK: query: CREATE TABLE DECIMAL (dec decimal)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/decimal_2.q.out b/ql/src/test/results/clientpositive/decimal_2.q.out
index 794bad075b..934590c66d 100644
--- a/ql/src/test/results/clientpositive/decimal_2.q.out
+++ b/ql/src/test/results/clientpositive/decimal_2.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table decimal_2 (t decimal(18,9))
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@decimal_2
 POSTHOOK: query: create table decimal_2 (t decimal(18,9))
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/decimal_3.q.out b/ql/src/test/results/clientpositive/decimal_3.q.out
index 524fa62efe..8e9a30a8e2 100644
--- a/ql/src/test/results/clientpositive/decimal_3.q.out
+++ b/ql/src/test/results/clientpositive/decimal_3.q.out
@@ -8,6 +8,7 @@ ROW FORMAT DELIMITED
 STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@DECIMAL_3
 POSTHOOK: query: CREATE TABLE DECIMAL_3(key decimal(38,18), value int)
 ROW FORMAT DELIMITED
    FIELDS TERMINATED BY ' '
diff --git a/ql/src/test/results/clientpositive/decimal_4.q.out b/ql/src/test/results/clientpositive/decimal_4.q.out
index 7444e83c07..50662af1ed 100644
--- a/ql/src/test/results/clientpositive/decimal_4.q.out
+++ b/ql/src/test/results/clientpositive/decimal_4.q.out
@@ -12,6 +12,7 @@ ROW FORMAT DELIMITED
 STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@DECIMAL_4_1
 POSTHOOK: query: CREATE TABLE DECIMAL_4_1(key decimal(35,25), value int) 
 ROW FORMAT DELIMITED
    FIELDS TERMINATED BY ' '
@@ -23,6 +24,7 @@ PREHOOK: query: CREATE TABLE DECIMAL_4_2(key decimal(35,25), value decimal(35,25
 STORED AS ORC
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@DECIMAL_4_2
 POSTHOOK: query: CREATE TABLE DECIMAL_4_2(key decimal(35,25), value decimal(35,25)) 
 STORED AS ORC
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/decimal_5.q.out b/ql/src/test/results/clientpositive/decimal_5.q.out
index 52dae22bd5..0f24b8a9e8 100644
--- a/ql/src/test/results/clientpositive/decimal_5.q.out
+++ b/ql/src/test/results/clientpositive/decimal_5.q.out
@@ -8,6 +8,7 @@ ROW FORMAT DELIMITED
 STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@DECIMAL_5
 POSTHOOK: query: CREATE TABLE DECIMAL_5(key decimal(10,5), value int)
 ROW FORMAT DELIMITED
    FIELDS TERMINATED BY ' '
diff --git a/ql/src/test/results/clientpositive/decimal_6.q.out b/ql/src/test/results/clientpositive/decimal_6.q.out
index 4338b52981..c0cad1f8c5 100644
--- a/ql/src/test/results/clientpositive/decimal_6.q.out
+++ b/ql/src/test/results/clientpositive/decimal_6.q.out
@@ -16,6 +16,7 @@ ROW FORMAT DELIMITED
 STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@DECIMAL_6_1
 POSTHOOK: query: CREATE TABLE DECIMAL_6_1(key decimal(10,5), value int)
 ROW FORMAT DELIMITED
    FIELDS TERMINATED BY ' '
@@ -29,6 +30,7 @@ ROW FORMAT DELIMITED
 STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@DECIMAL_6_2
 POSTHOOK: query: CREATE TABLE DECIMAL_6_2(key decimal(17,4), value int)
 ROW FORMAT DELIMITED
    FIELDS TERMINATED BY ' '
diff --git a/ql/src/test/results/clientpositive/decimal_join.q.out b/ql/src/test/results/clientpositive/decimal_join.q.out
index 833ba5d74e..940ffc5271 100644
--- a/ql/src/test/results/clientpositive/decimal_join.q.out
+++ b/ql/src/test/results/clientpositive/decimal_join.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- HIVE-5292 Join on decimal columns fails
 create table src_dec (key decimal(3,0), value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_dec
 POSTHOOK: query: -- HIVE-5292 Join on decimal columns fails
 
 create table src_dec (key decimal(3,0), value string)
diff --git a/ql/src/test/results/clientpositive/decimal_precision.q.out b/ql/src/test/results/clientpositive/decimal_precision.q.out
index ea08b737b1..f3f2cbc1a2 100644
--- a/ql/src/test/results/clientpositive/decimal_precision.q.out
+++ b/ql/src/test/results/clientpositive/decimal_precision.q.out
@@ -8,6 +8,7 @@ ROW FORMAT DELIMITED
 STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@DECIMAL_PRECISION
 POSTHOOK: query: CREATE TABLE DECIMAL_PRECISION(dec decimal(20,10))
 ROW FORMAT DELIMITED
    FIELDS TERMINATED BY ' '
diff --git a/ql/src/test/results/clientpositive/decimal_serde.q.out b/ql/src/test/results/clientpositive/decimal_serde.q.out
index 8c4dd435f7..194d2ca4eb 100644
--- a/ql/src/test/results/clientpositive/decimal_serde.q.out
+++ b/ql/src/test/results/clientpositive/decimal_serde.q.out
@@ -20,6 +20,7 @@ ROW FORMAT DELIMITED
 STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@DECIMAL_TEXT
 POSTHOOK: query: CREATE TABLE DECIMAL_TEXT (key decimal, value int) 
 ROW FORMAT DELIMITED
    FIELDS TERMINATED BY ' '
diff --git a/ql/src/test/results/clientpositive/decimal_udf.q.out b/ql/src/test/results/clientpositive/decimal_udf.q.out
index 02a0caa674..1d5fee97c6 100644
--- a/ql/src/test/results/clientpositive/decimal_udf.q.out
+++ b/ql/src/test/results/clientpositive/decimal_udf.q.out
@@ -8,6 +8,7 @@ ROW FORMAT DELIMITED
 STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@DECIMAL_UDF
 POSTHOOK: query: CREATE TABLE DECIMAL_UDF (key decimal(20,10), value int)
 ROW FORMAT DELIMITED
    FIELDS TERMINATED BY ' '
diff --git a/ql/src/test/results/clientpositive/default_partition_name.q.out b/ql/src/test/results/clientpositive/default_partition_name.q.out
index c3690ba188..16cea1952d 100644
--- a/ql/src/test/results/clientpositive/default_partition_name.q.out
+++ b/ql/src/test/results/clientpositive/default_partition_name.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table default_partition_name (key int, value string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@default_partition_name
 POSTHOOK: query: create table default_partition_name (key int, value string) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/delimiter.q.out b/ql/src/test/results/clientpositive/delimiter.q.out
index f3a61a9466..064d5dfab2 100644
--- a/ql/src/test/results/clientpositive/delimiter.q.out
+++ b/ql/src/test/results/clientpositive/delimiter.q.out
@@ -5,6 +5,7 @@ lines terminated by '\n'
 stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@impressions
 POSTHOOK: query: create table impressions (imp string, msg string)
 row format delimited
 fields terminated by '\t'
diff --git a/ql/src/test/results/clientpositive/desc_tbl_part_cols.q.out b/ql/src/test/results/clientpositive/desc_tbl_part_cols.q.out
index 843626a112..e874412d21 100644
--- a/ql/src/test/results/clientpositive/desc_tbl_part_cols.q.out
+++ b/ql/src/test/results/clientpositive/desc_tbl_part_cols.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table t1 (a int, b string) partitioned by (c int, d string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t1
 POSTHOOK: query: create table t1 (a int, b string) partitioned by (c int, d string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/describe_comment_indent.q.out b/ql/src/test/results/clientpositive/describe_comment_indent.q.out
index 79826e8164..5ded49507f 100644
--- a/ql/src/test/results/clientpositive/describe_comment_indent.q.out
+++ b/ql/src/test/results/clientpositive/describe_comment_indent.q.out
@@ -11,6 +11,7 @@ COMMENT 'table comment
 two lines'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table
 POSTHOOK: query: -- test comment indent processing for multi-line comments
 
 CREATE TABLE test_table(
diff --git a/ql/src/test/results/clientpositive/describe_comment_nonascii.q.out b/ql/src/test/results/clientpositive/describe_comment_nonascii.q.out
index 3600454461..12f385db22 100644
--- a/ql/src/test/results/clientpositive/describe_comment_nonascii.q.out
+++ b/ql/src/test/results/clientpositive/describe_comment_nonascii.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- HIVE-2905 showing non-ascii comments
 create table dummy (col1 string, col2 string, col3 string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dummy
 POSTHOOK: query: -- HIVE-2905 showing non-ascii comments
 
 create table dummy (col1 string, col2 string, col3 string)
diff --git a/ql/src/test/results/clientpositive/describe_database.q.out b/ql/src/test/results/clientpositive/describe_database.q.out
index 757508b59f..45e5a42f66 100644
--- a/ql/src/test/results/clientpositive/describe_database.q.out
+++ b/ql/src/test/results/clientpositive/describe_database.q.out
@@ -1,7 +1,9 @@
 PREHOOK: query: create database test_db with dbproperties ('key1' = 'value1', 'key2' = 'value2')
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:test_db
 POSTHOOK: query: create database test_db with dbproperties ('key1' = 'value1', 'key2' = 'value2')
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:test_db
 PREHOOK: query: desc database extended test_db
 PREHOOK: type: DESCDATABASE
 POSTHOOK: query: desc database extended test_db
diff --git a/ql/src/test/results/clientpositive/describe_database_json.q.out b/ql/src/test/results/clientpositive/describe_database_json.q.out
index cd33346554..3fa0ca9ad3 100644
--- a/ql/src/test/results/clientpositive/describe_database_json.q.out
+++ b/ql/src/test/results/clientpositive/describe_database_json.q.out
@@ -1,7 +1,9 @@
 #### A masked pattern was here ####
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:jsondb1
 #### A masked pattern was here ####
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:jsondb1
 #### A masked pattern was here ####
 PREHOOK: query: DESCRIBE DATABASE jsondb1
 PREHOOK: type: DESCDATABASE
@@ -33,8 +35,10 @@ POSTHOOK: Input: database:jsondb1
 POSTHOOK: Output: database:jsondb1
 PREHOOK: query: CREATE DATABASE jsondb1
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:jsondb1
 POSTHOOK: query: CREATE DATABASE jsondb1
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:jsondb1
 PREHOOK: query: DESCRIBE DATABASE jsondb1
 PREHOOK: type: DESCDATABASE
 POSTHOOK: query: DESCRIBE DATABASE jsondb1
diff --git a/ql/src/test/results/clientpositive/describe_pretty.q.out b/ql/src/test/results/clientpositive/describe_pretty.q.out
index 527529b002..1c05e0d6f3 100644
--- a/ql/src/test/results/clientpositive/describe_pretty.q.out
+++ b/ql/src/test/results/clientpositive/describe_pretty.q.out
@@ -17,6 +17,7 @@ COMMENT 'table comment
 two lines'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table
 POSTHOOK: query: -- test comment indent processing for multi-line comments
 
 CREATE TABLE test_table(
@@ -211,6 +212,7 @@ comment',
     col4 STRING COMMENT 'col4 very long comment that is greater than 80 chars and is likely to spill into multiple lines')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table_very_long_column_name
 POSTHOOK: query: CREATE TABLE test_table_very_long_column_name(
     col1 INT COMMENT 'col1 one line comment',
     col2_abcdefghiklmnopqrstuvxyz STRING COMMENT 'col2
@@ -288,6 +290,7 @@ two lines'
 PARTITIONED BY (ds STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table_partitioned
 POSTHOOK: query: CREATE TABLE test_table_partitioned(
     col1 INT COMMENT 'col1 one line comment',
     col2 STRING COMMENT 'col2
diff --git a/ql/src/test/results/clientpositive/describe_syntax.q.out b/ql/src/test/results/clientpositive/describe_syntax.q.out
index 5718641d1d..3e445f5155 100644
--- a/ql/src/test/results/clientpositive/describe_syntax.q.out
+++ b/ql/src/test/results/clientpositive/describe_syntax.q.out
@@ -1,18 +1,24 @@
 PREHOOK: query: CREATE DATABASE db1
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:db1
 POSTHOOK: query: CREATE DATABASE db1
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:db1
 PREHOOK: query: CREATE TABLE db1.t1(key1 INT, value1 STRING) PARTITIONED BY (ds STRING, part STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:db1
+PREHOOK: Output: db1@db1.t1
 POSTHOOK: query: CREATE TABLE db1.t1(key1 INT, value1 STRING) PARTITIONED BY (ds STRING, part STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:db1
+POSTHOOK: Output: db1@db1.t1
 POSTHOOK: Output: db1@t1
 PREHOOK: query: use db1
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:db1
 POSTHOOK: query: use db1
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:db1
 PREHOOK: query: ALTER TABLE t1 ADD PARTITION (ds='3', part='3')
 PREHOOK: type: ALTERTABLE_ADDPARTS
 PREHOOK: Output: db1@t1
diff --git a/ql/src/test/results/clientpositive/describe_table.q.out b/ql/src/test/results/clientpositive/describe_table.q.out
index f90ed6cd22..a7bc58fcb1 100644
--- a/ql/src/test/results/clientpositive/describe_table.q.out
+++ b/ql/src/test/results/clientpositive/describe_table.q.out
@@ -341,6 +341,7 @@ Storage Desc Params:
 PREHOOK: query: create table srcpart_serdeprops like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcpart_serdeprops
 POSTHOOK: query: create table srcpart_serdeprops like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/describe_table_json.q.out b/ql/src/test/results/clientpositive/describe_table_json.q.out
index 51a5e5c295..0e9cf764e2 100644
--- a/ql/src/test/results/clientpositive/describe_table_json.q.out
+++ b/ql/src/test/results/clientpositive/describe_table_json.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE IF NOT EXISTS jsontable (key INT, value STRING) COMMENT 'json table' STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@jsontable
 POSTHOOK: query: CREATE TABLE IF NOT EXISTS jsontable (key INT, value STRING) COMMENT 'json table' STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/diff_part_input_formats.q.out b/ql/src/test/results/clientpositive/diff_part_input_formats.q.out
index 695ebca7ed..2b4691794e 100644
--- a/ql/src/test/results/clientpositive/diff_part_input_formats.q.out
+++ b/ql/src/test/results/clientpositive/diff_part_input_formats.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: -- Tests the case where a table is changed from sequence file to
 CREATE TABLE part_test (key STRING, value STRING) PARTITIONED BY (ds STRING) STORED AS SEQUENCEFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part_test
 POSTHOOK: query: -- Tests the case where a table is changed from sequence file to a RC file,
 -- resulting in partitions in both file formats. If no valid partitions are
 -- selected, then it should still use RC file for reading the dummy partition.
diff --git a/ql/src/test/results/clientpositive/disable_file_format_check.q.out b/ql/src/test/results/clientpositive/disable_file_format_check.q.out
index 95f662db58..8bdfb27fa1 100644
--- a/ql/src/test/results/clientpositive/disable_file_format_check.q.out
+++ b/ql/src/test/results/clientpositive/disable_file_format_check.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table kv_fileformat_check_txt (key string, value string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@kv_fileformat_check_txt
 POSTHOOK: query: create table kv_fileformat_check_txt (key string, value string) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -16,6 +17,7 @@ POSTHOOK: Output: default@kv_fileformat_check_txt
 PREHOOK: query: create table kv_fileformat_check_seq (key string, value string) stored as sequencefile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@kv_fileformat_check_seq
 POSTHOOK: query: create table kv_fileformat_check_seq (key string, value string) stored as sequencefile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/disable_merge_for_bucketing.q.out b/ql/src/test/results/clientpositive/disable_merge_for_bucketing.q.out
index 96775a12c7..cc38864cc2 100644
--- a/ql/src/test/results/clientpositive/disable_merge_for_bucketing.q.out
+++ b/ql/src/test/results/clientpositive/disable_merge_for_bucketing.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE bucket2_1(key int, value string) CLUSTERED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucket2_1
 POSTHOOK: query: CREATE TABLE bucket2_1(key int, value string) CLUSTERED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/disallow_incompatible_type_change_off.q.out b/ql/src/test/results/clientpositive/disallow_incompatible_type_change_off.q.out
index 28a983ce63..ad347328de 100644
--- a/ql/src/test/results/clientpositive/disallow_incompatible_type_change_off.q.out
+++ b/ql/src/test/results/clientpositive/disallow_incompatible_type_change_off.q.out
@@ -10,6 +10,7 @@ POSTHOOK: Input: default@src
 PREHOOK: query: CREATE TABLE test_table123 (a INT, b MAP<STRING, STRING>) PARTITIONED BY (ds STRING) STORED AS SEQUENCEFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table123
 POSTHOOK: query: CREATE TABLE test_table123 (a INT, b MAP<STRING, STRING>) PARTITIONED BY (ds STRING) STORED AS SEQUENCEFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/display_colstats_tbllvl.q.out b/ql/src/test/results/clientpositive/display_colstats_tbllvl.q.out
index a1e6202bfe..7745be7524 100644
--- a/ql/src/test/results/clientpositive/display_colstats_tbllvl.q.out
+++ b/ql/src/test/results/clientpositive/display_colstats_tbllvl.q.out
@@ -15,6 +15,7 @@ PREHOOK: query: CREATE TABLE UserVisits_web_text_none (
 row format delimited fields terminated by '|'  stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@UserVisits_web_text_none
 POSTHOOK: query: CREATE TABLE UserVisits_web_text_none (
   sourceIP string,
   destURL string,
@@ -276,6 +277,7 @@ PREHOOK: query: CREATE TABLE empty_tab(
 row format delimited fields terminated by '|'  stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@empty_tab
 POSTHOOK: query: CREATE TABLE empty_tab(
    a int,
    b double,
@@ -371,12 +373,16 @@ POSTHOOK: Input: default@empty_tab
 b                   	double              	0.0                 	0.0                 	0                   	0                   	                    	                    	                    	                    	from deserializer   
 PREHOOK: query: CREATE DATABASE test
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:test
 POSTHOOK: query: CREATE DATABASE test
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:test
 PREHOOK: query: USE test
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:test
 POSTHOOK: query: USE test
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:test
 PREHOOK: query: CREATE TABLE UserVisits_web_text_none (
   sourceIP string,
   destURL string,
@@ -390,6 +396,7 @@ PREHOOK: query: CREATE TABLE UserVisits_web_text_none (
 row format delimited fields terminated by '|'  stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:test
+PREHOOK: Output: test@UserVisits_web_text_none
 POSTHOOK: query: CREATE TABLE UserVisits_web_text_none (
   sourceIP string,
   destURL string,
diff --git a/ql/src/test/results/clientpositive/distinct_stats.q.out b/ql/src/test/results/clientpositive/distinct_stats.q.out
index 92a975de60..be46e25c15 100644
--- a/ql/src/test/results/clientpositive/distinct_stats.q.out
+++ b/ql/src/test/results/clientpositive/distinct_stats.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table t1 (a string, b string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t1
 POSTHOOK: query: create table t1 (a string, b string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/drop_database_removes_partition_dirs.q.out b/ql/src/test/results/clientpositive/drop_database_removes_partition_dirs.q.out
index 7c07ea5990..499c99616f 100644
--- a/ql/src/test/results/clientpositive/drop_database_removes_partition_dirs.q.out
+++ b/ql/src/test/results/clientpositive/drop_database_removes_partition_dirs.q.out
@@ -3,15 +3,19 @@ PREHOOK: query: -- This test verifies that if a partition exists outside a table
 
 CREATE DATABASE test_database
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:test_database
 POSTHOOK: query: -- This test verifies that if a partition exists outside a table's current location when the
 -- database is dropped the partition's location is dropped as well.
 
 CREATE DATABASE test_database
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:test_database
 PREHOOK: query: USE test_database
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:test_database
 POSTHOOK: query: USE test_database
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:test_database
 PREHOOK: query: CREATE TABLE test_table (key STRING, value STRING)
 PARTITIONED BY (part STRING)
 STORED AS RCFILE
@@ -19,6 +23,7 @@ STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 #### A masked pattern was here ####
 PREHOOK: Output: database:test_database
+PREHOOK: Output: test_database@test_table
 POSTHOOK: query: CREATE TABLE test_table (key STRING, value STRING)
 PARTITIONED BY (part STRING)
 STORED AS RCFILE
@@ -54,8 +59,10 @@ Found 1 items
 #### A masked pattern was here ####
 PREHOOK: query: USE default
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:default
 POSTHOOK: query: USE default
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:default
 PREHOOK: query: DROP DATABASE test_database CASCADE
 PREHOOK: type: DROPDATABASE
 PREHOOK: Input: database:test_database
diff --git a/ql/src/test/results/clientpositive/drop_index.q.out b/ql/src/test/results/clientpositive/drop_index.q.out
index c7c4a78592..71afdffead 100644
--- a/ql/src/test/results/clientpositive/drop_index.q.out
+++ b/ql/src/test/results/clientpositive/drop_index.q.out
@@ -1,4 +1,6 @@
 PREHOOK: query: DROP INDEX IF EXISTS UnknownIndex ON src
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: DROP INDEX IF EXISTS UnknownIndex ON src
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@src
diff --git a/ql/src/test/results/clientpositive/drop_index_removes_partition_dirs.q.out b/ql/src/test/results/clientpositive/drop_index_removes_partition_dirs.q.out
index d08575863a..5b8bffa671 100644
--- a/ql/src/test/results/clientpositive/drop_index_removes_partition_dirs.q.out
+++ b/ql/src/test/results/clientpositive/drop_index_removes_partition_dirs.q.out
@@ -8,6 +8,7 @@ STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 #### A masked pattern was here ####
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table
 POSTHOOK: query: -- This test verifies that if a partition exists outside an index table's current location when the
 -- index is dropped the partition's location is dropped as well.
 
@@ -23,10 +24,12 @@ PREHOOK: query: CREATE INDEX test_index ON
 TABLE test_table(key) AS 'compact' WITH DEFERRED REBUILD
 IN TABLE test_index_table
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@test_table
 POSTHOOK: query: CREATE INDEX test_index ON 
 TABLE test_table(key) AS 'compact' WITH DEFERRED REBUILD
 IN TABLE test_index_table
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@test_table
 POSTHOOK: Output: default@test_index_table
 PREHOOK: query: ALTER TABLE test_index_table ADD PARTITION (part = '1')
 #### A masked pattern was here ####
@@ -43,6 +46,8 @@ Found 1 items
 #### A masked pattern was here ####
 PREHOOK: query: DROP INDEX test_index ON test_table
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@test_table
 POSTHOOK: query: DROP INDEX test_index ON test_table
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@test_table
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/drop_multi_partitions.q.out b/ql/src/test/results/clientpositive/drop_multi_partitions.q.out
index 87e4e61774..58a472c671 100644
--- a/ql/src/test/results/clientpositive/drop_multi_partitions.q.out
+++ b/ql/src/test/results/clientpositive/drop_multi_partitions.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table mp (a string) partitioned by (b string, c string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@mp
 POSTHOOK: query: create table mp (a string) partitioned by (b string, c string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/drop_partitions_filter.q.out b/ql/src/test/results/clientpositive/drop_partitions_filter.q.out
index cf03fba274..3075ab4544 100644
--- a/ql/src/test/results/clientpositive/drop_partitions_filter.q.out
+++ b/ql/src/test/results/clientpositive/drop_partitions_filter.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table ptestfilter (a string, b int) partitioned by (c string, d string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@ptestfilter
 POSTHOOK: query: create table ptestfilter (a string, b int) partitioned by (c string, d string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/drop_partitions_filter2.q.out b/ql/src/test/results/clientpositive/drop_partitions_filter2.q.out
index f08481c9a1..92f9805b54 100644
--- a/ql/src/test/results/clientpositive/drop_partitions_filter2.q.out
+++ b/ql/src/test/results/clientpositive/drop_partitions_filter2.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table ptestfilter (a string, b int) partitioned by (c int, d int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@ptestfilter
 POSTHOOK: query: create table ptestfilter (a string, b int) partitioned by (c int, d int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/drop_partitions_filter3.q.out b/ql/src/test/results/clientpositive/drop_partitions_filter3.q.out
index cc68b1e42a..bfb422156b 100644
--- a/ql/src/test/results/clientpositive/drop_partitions_filter3.q.out
+++ b/ql/src/test/results/clientpositive/drop_partitions_filter3.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table ptestfilter (a string, b int) partitioned by (c string, d int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@ptestfilter
 POSTHOOK: query: create table ptestfilter (a string, b int) partitioned by (c string, d int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/drop_partitions_ignore_protection.q.out b/ql/src/test/results/clientpositive/drop_partitions_ignore_protection.q.out
index 5188520dd5..c3303d0573 100644
--- a/ql/src/test/results/clientpositive/drop_partitions_ignore_protection.q.out
+++ b/ql/src/test/results/clientpositive/drop_partitions_ignore_protection.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table tbl_protectmode_no_drop  (c1 string,c2 string) partitioned by (p string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl_protectmode_no_drop
 POSTHOOK: query: create table tbl_protectmode_no_drop  (c1 string,c2 string) partitioned by (p string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/drop_table2.q.out b/ql/src/test/results/clientpositive/drop_table2.q.out
index 3624f48f35..d6a8c3a5dc 100644
--- a/ql/src/test/results/clientpositive/drop_table2.q.out
+++ b/ql/src/test/results/clientpositive/drop_table2.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table if not exists temp(col STRING) partitioned by (p STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@temp
 POSTHOOK: query: create table if not exists temp(col STRING) partitioned by (p STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -46,6 +47,7 @@ POSTHOOK: Output: default@temp
 PREHOOK: query: create table if not exists temp(col STRING) partitioned by (p STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@temp
 POSTHOOK: query: create table if not exists temp(col STRING) partitioned by (p STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/drop_table_removes_partition_dirs.q.out b/ql/src/test/results/clientpositive/drop_table_removes_partition_dirs.q.out
index f3b93c82aa..effd78fb2d 100644
--- a/ql/src/test/results/clientpositive/drop_table_removes_partition_dirs.q.out
+++ b/ql/src/test/results/clientpositive/drop_table_removes_partition_dirs.q.out
@@ -8,6 +8,7 @@ STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 #### A masked pattern was here ####
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table
 POSTHOOK: query: -- This test verifies that if a partition exists outside the table's current location when the
 -- table is dropped the partition's location is dropped as well.
 
diff --git a/ql/src/test/results/clientpositive/drop_with_concurrency.q.out b/ql/src/test/results/clientpositive/drop_with_concurrency.q.out
index a81b2bd5b9..2c00f51b73 100644
--- a/ql/src/test/results/clientpositive/drop_with_concurrency.q.out
+++ b/ql/src/test/results/clientpositive/drop_with_concurrency.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table drop_with_concurrency_1 (c1 int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@drop_with_concurrency_1
 POSTHOOK: query: create table drop_with_concurrency_1 (c1 int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/dynamic_partition_skip_default.q.out b/ql/src/test/results/clientpositive/dynamic_partition_skip_default.q.out
index 61a7599a79..f2bebe4e1b 100644
--- a/ql/src/test/results/clientpositive/dynamic_partition_skip_default.q.out
+++ b/ql/src/test/results/clientpositive/dynamic_partition_skip_default.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table dynamic_part_table(intcol string) partitioned by (partcol1 string, partcol2 string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dynamic_part_table
 POSTHOOK: query: create table dynamic_part_table(intcol string) partitioned by (partcol1 string, partcol2 string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/dynpart_sort_opt_vectorization.q.out b/ql/src/test/results/clientpositive/dynpart_sort_opt_vectorization.q.out
index 0ba45f3ebd..fa03c9622d 100644
--- a/ql/src/test/results/clientpositive/dynpart_sort_opt_vectorization.q.out
+++ b/ql/src/test/results/clientpositive/dynpart_sort_opt_vectorization.q.out
@@ -14,6 +14,7 @@ PREHOOK: query: create table over1k(
        fields terminated by '|'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@over1k
 POSTHOOK: query: create table over1k(
            t tinyint,
            si smallint,
@@ -42,6 +43,7 @@ POSTHOOK: Output: default@over1k
 PREHOOK: query: create table over1k_orc like over1k
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@over1k_orc
 POSTHOOK: query: create table over1k_orc like over1k
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -81,6 +83,7 @@ PREHOOK: query: create table over1k_part_orc(
        partitioned by (ds string, t tinyint) stored as orc
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@over1k_part_orc
 POSTHOOK: query: create table over1k_part_orc(
            si smallint,
            i int,
@@ -93,6 +96,7 @@ POSTHOOK: Output: default@over1k_part_orc
 PREHOOK: query: create table over1k_part_limit_orc like over1k_part_orc
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@over1k_part_limit_orc
 POSTHOOK: query: create table over1k_part_limit_orc like over1k_part_orc
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -114,6 +118,7 @@ PREHOOK: query: create table over1k_part_buck_orc(
        clustered by (si) into 4 buckets stored as orc
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@over1k_part_buck_orc
 POSTHOOK: query: create table over1k_part_buck_orc(
            si smallint,
            i int,
@@ -134,6 +139,7 @@ PREHOOK: query: create table over1k_part_buck_sort_orc(
        sorted by (f) into 4 buckets stored as orc
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@over1k_part_buck_sort_orc
 POSTHOOK: query: create table over1k_part_buck_sort_orc(
            si smallint,
            i int,
@@ -1252,6 +1258,7 @@ create table over1k_part2_orc(
        partitioned by (ds string, t tinyint)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@over1k_part2_orc
 POSTHOOK: query: -- tests for HIVE-6883
 create table over1k_part2_orc(
            si smallint,
@@ -1712,6 +1719,7 @@ create table over1k_part_buck_sort2_orc(
        sorted by (f) into 1 buckets
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@over1k_part_buck_sort2_orc
 POSTHOOK: query: -- hadoop-1 does not honor number of reducers in local mode. There is always only 1 reducer irrespective of the number of buckets.
 -- Hence all records go to one bucket and all other buckets will be empty. Similar to HIVE-6867. However, hadoop-2 honors number
 -- of reducers and records are spread across all reducers. To avoid this inconsistency we will make number of buckets to 1 for this test.
diff --git a/ql/src/test/results/clientpositive/dynpart_sort_optimization.q.out b/ql/src/test/results/clientpositive/dynpart_sort_optimization.q.out
index db0e28b998..941aa9efd1 100644
--- a/ql/src/test/results/clientpositive/dynpart_sort_optimization.q.out
+++ b/ql/src/test/results/clientpositive/dynpart_sort_optimization.q.out
@@ -14,6 +14,7 @@ PREHOOK: query: create table over1k(
        fields terminated by '|'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@over1k
 POSTHOOK: query: create table over1k(
            t tinyint,
            si smallint,
@@ -47,6 +48,7 @@ PREHOOK: query: create table over1k_part(
        partitioned by (ds string, t tinyint)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@over1k_part
 POSTHOOK: query: create table over1k_part(
            si smallint,
            i int,
@@ -59,6 +61,7 @@ POSTHOOK: Output: default@over1k_part
 PREHOOK: query: create table over1k_part_limit like over1k_part
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@over1k_part_limit
 POSTHOOK: query: create table over1k_part_limit like over1k_part
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -72,6 +75,7 @@ PREHOOK: query: create table over1k_part_buck(
        clustered by (si) into 4 buckets
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@over1k_part_buck
 POSTHOOK: query: create table over1k_part_buck(
            si smallint,
            i int,
@@ -92,6 +96,7 @@ PREHOOK: query: create table over1k_part_buck_sort(
        sorted by (f) into 4 buckets
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@over1k_part_buck_sort
 POSTHOOK: query: create table over1k_part_buck_sort(
            si smallint,
            i int,
@@ -1158,6 +1163,7 @@ create table over1k_part2(
        partitioned by (ds string, t tinyint)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@over1k_part2
 POSTHOOK: query: -- tests for HIVE-6883
 create table over1k_part2(
            si smallint,
@@ -1616,6 +1622,7 @@ create table over1k_part_buck_sort2(
        sorted by (f) into 1 buckets
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@over1k_part_buck_sort2
 POSTHOOK: query: -- hadoop-1 does not honor number of reducers in local mode. There is always only 1 reducer irrespective of the number of buckets.
 -- Hence all records go to one bucket and all other buckets will be empty. Similar to HIVE-6867. However, hadoop-2 honors number
 -- of reducers and records are spread across all reducers. To avoid this inconsistency we will make number of buckets to 1 for this test.
diff --git a/ql/src/test/results/clientpositive/empty_dir_in_table.q.out b/ql/src/test/results/clientpositive/empty_dir_in_table.q.out
index c835f134b8..e804de3f76 100644
--- a/ql/src/test/results/clientpositive/empty_dir_in_table.q.out
+++ b/ql/src/test/results/clientpositive/empty_dir_in_table.q.out
@@ -2,6 +2,7 @@
 PREHOOK: type: CREATETABLE
 #### A masked pattern was here ####
 PREHOOK: Output: database:default
+PREHOOK: Output: default@roottable
 #### A masked pattern was here ####
 POSTHOOK: type: CREATETABLE
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/enforce_order.q.out b/ql/src/test/results/clientpositive/enforce_order.q.out
index 5cea7a5101..3e430886e5 100644
--- a/ql/src/test/results/clientpositive/enforce_order.q.out
+++ b/ql/src/test/results/clientpositive/enforce_order.q.out
@@ -9,6 +9,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table table_asc(key string, value string) clustered by (key) sorted by (key ASC) into 1 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table_asc
 POSTHOOK: query: create table table_asc(key string, value string) clustered by (key) sorted by (key ASC) into 1 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -16,6 +17,7 @@ POSTHOOK: Output: default@table_asc
 PREHOOK: query: create table table_desc(key string, value string) clustered by (key) sorted by (key DESC) into 1 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table_desc
 POSTHOOK: query: create table table_desc(key string, value string) clustered by (key) sorted by (key DESC) into 1 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/escape1.q.out b/ql/src/test/results/clientpositive/escape1.q.out
index d49094d3b2..22aebba6fa 100644
--- a/ql/src/test/results/clientpositive/escape1.q.out
+++ b/ql/src/test/results/clientpositive/escape1.q.out
@@ -15,6 +15,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: CREATE TABLE escape_raw (s STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@escape_raw
 POSTHOOK: query: CREATE TABLE escape_raw (s STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -175,6 +176,7 @@ z
 PREHOOK: query: CREATE TABLE escape1 (a STRING) PARTITIONED BY (ds STRING, part STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@escape1
 POSTHOOK: query: CREATE TABLE escape1 (a STRING) PARTITIONED BY (ds STRING, part STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/escape2.q.out b/ql/src/test/results/clientpositive/escape2.q.out
index b5f8ac6aaf..0661a3d486 100644
--- a/ql/src/test/results/clientpositive/escape2.q.out
+++ b/ql/src/test/results/clientpositive/escape2.q.out
@@ -15,6 +15,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: CREATE TABLE escape_raw (s STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@escape_raw
 POSTHOOK: query: CREATE TABLE escape_raw (s STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -175,6 +176,7 @@ z
 PREHOOK: query: CREATE TABLE escape2(a STRING) PARTITIONED BY (ds STRING, part STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@escape2
 POSTHOOK: query: CREATE TABLE escape2(a STRING) PARTITIONED BY (ds STRING, part STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/exchange_partition.q.out b/ql/src/test/results/clientpositive/exchange_partition.q.out
index 8be28aca87..381a9fddf6 100644
--- a/ql/src/test/results/clientpositive/exchange_partition.q.out
+++ b/ql/src/test/results/clientpositive/exchange_partition.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE exchange_part_test1 (f1 string) PARTITIONED BY (ds STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exchange_part_test1
 POSTHOOK: query: CREATE TABLE exchange_part_test1 (f1 string) PARTITIONED BY (ds STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@exchange_part_test1
 PREHOOK: query: CREATE TABLE exchange_part_test2 (f1 string) PARTITIONED BY (ds STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exchange_part_test2
 POSTHOOK: query: CREATE TABLE exchange_part_test2 (f1 string) PARTITIONED BY (ds STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/exchange_partition2.q.out b/ql/src/test/results/clientpositive/exchange_partition2.q.out
index db43dd0ebb..d47fb050db 100644
--- a/ql/src/test/results/clientpositive/exchange_partition2.q.out
+++ b/ql/src/test/results/clientpositive/exchange_partition2.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE exchange_part_test1 (f1 string) PARTITIONED BY (ds STRING, hr STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exchange_part_test1
 POSTHOOK: query: CREATE TABLE exchange_part_test1 (f1 string) PARTITIONED BY (ds STRING, hr STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@exchange_part_test1
 PREHOOK: query: CREATE TABLE exchange_part_test2 (f1 string) PARTITIONED BY (ds STRING, hr STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exchange_part_test2
 POSTHOOK: query: CREATE TABLE exchange_part_test2 (f1 string) PARTITIONED BY (ds STRING, hr STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/exchange_partition3.q.out b/ql/src/test/results/clientpositive/exchange_partition3.q.out
index ffcd9dff95..3133ad74bf 100644
--- a/ql/src/test/results/clientpositive/exchange_partition3.q.out
+++ b/ql/src/test/results/clientpositive/exchange_partition3.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE exchange_part_test1 (f1 string) PARTITIONED BY (ds STRING, hr STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exchange_part_test1
 POSTHOOK: query: CREATE TABLE exchange_part_test1 (f1 string) PARTITIONED BY (ds STRING, hr STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@exchange_part_test1
 PREHOOK: query: CREATE TABLE exchange_part_test2 (f1 string) PARTITIONED BY (ds STRING, hr STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exchange_part_test2
 POSTHOOK: query: CREATE TABLE exchange_part_test2 (f1 string) PARTITIONED BY (ds STRING, hr STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/exim_00_nonpart_empty.q.out b/ql/src/test/results/clientpositive/exim_00_nonpart_empty.q.out
index d8081f6ea6..57202437eb 100644
--- a/ql/src/test/results/clientpositive/exim_00_nonpart_empty.q.out
+++ b/ql/src/test/results/clientpositive/exim_00_nonpart_empty.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: create table exim_department ( dep_id int comment "department id
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exim_department
 POSTHOOK: query: create table exim_department ( dep_id int comment "department id") 	
 	stored as textfile	
 	tblproperties("creator"="krishna")
@@ -28,12 +29,16 @@ POSTHOOK: Input: default@exim_department
 POSTHOOK: Output: default@exim_department
 PREHOOK: query: create database importer
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:importer
 POSTHOOK: query: create database importer
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:importer
 PREHOOK: query: use importer
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:importer
 POSTHOOK: query: use importer
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:importer
 PREHOOK: query: import from 'ql/test/data/exports/exim_department'
 PREHOOK: type: IMPORT
 POSTHOOK: query: import from 'ql/test/data/exports/exim_department'
diff --git a/ql/src/test/results/clientpositive/exim_01_nonpart.q.out b/ql/src/test/results/clientpositive/exim_01_nonpart.q.out
index 59987923f3..22a55965a8 100644
--- a/ql/src/test/results/clientpositive/exim_01_nonpart.q.out
+++ b/ql/src/test/results/clientpositive/exim_01_nonpart.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: create table exim_department ( dep_id int comment "department id
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exim_department
 POSTHOOK: query: create table exim_department ( dep_id int comment "department id") 	
 	stored as textfile	
 	tblproperties("creator"="krishna")
@@ -36,12 +37,16 @@ POSTHOOK: Input: default@exim_department
 POSTHOOK: Output: default@exim_department
 PREHOOK: query: create database importer
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:importer
 POSTHOOK: query: create database importer
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:importer
 PREHOOK: query: use importer
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:importer
 POSTHOOK: query: use importer
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:importer
 PREHOOK: query: import from 'ql/test/data/exports/exim_department'
 PREHOOK: type: IMPORT
 POSTHOOK: query: import from 'ql/test/data/exports/exim_department'
diff --git a/ql/src/test/results/clientpositive/exim_02_00_part_empty.q.out b/ql/src/test/results/clientpositive/exim_02_00_part_empty.q.out
index 3f45fecd5e..ded481bc40 100644
--- a/ql/src/test/results/clientpositive/exim_02_00_part_empty.q.out
+++ b/ql/src/test/results/clientpositive/exim_02_00_part_empty.q.out
@@ -5,6 +5,7 @@ PREHOOK: query: create table exim_employee ( emp_id int comment "employee id")
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exim_employee
 POSTHOOK: query: create table exim_employee ( emp_id int comment "employee id") 	
 	comment "employee table"
 	partitioned by (emp_country string comment "two char iso code", emp_state string comment "free text")
@@ -30,12 +31,16 @@ POSTHOOK: Input: default@exim_employee
 POSTHOOK: Output: default@exim_employee
 PREHOOK: query: create database importer
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:importer
 POSTHOOK: query: create database importer
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:importer
 PREHOOK: query: use importer
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:importer
 POSTHOOK: query: use importer
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:importer
 PREHOOK: query: import from 'ql/test/data/exports/exim_employee'
 PREHOOK: type: IMPORT
 POSTHOOK: query: import from 'ql/test/data/exports/exim_employee'
diff --git a/ql/src/test/results/clientpositive/exim_02_part.q.out b/ql/src/test/results/clientpositive/exim_02_part.q.out
index 172d0da362..8afceffa39 100644
--- a/ql/src/test/results/clientpositive/exim_02_part.q.out
+++ b/ql/src/test/results/clientpositive/exim_02_part.q.out
@@ -5,6 +5,7 @@ PREHOOK: query: create table exim_employee ( emp_id int comment "employee id")
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exim_employee
 POSTHOOK: query: create table exim_employee ( emp_id int comment "employee id") 	
 	comment "employee table"
 	partitioned by (emp_country string comment "two char iso code", emp_state string comment "free text")
@@ -43,12 +44,16 @@ POSTHOOK: Input: default@exim_employee
 POSTHOOK: Output: default@exim_employee
 PREHOOK: query: create database importer
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:importer
 POSTHOOK: query: create database importer
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:importer
 PREHOOK: query: use importer
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:importer
 POSTHOOK: query: use importer
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:importer
 PREHOOK: query: import from 'ql/test/data/exports/exim_employee'
 PREHOOK: type: IMPORT
 POSTHOOK: query: import from 'ql/test/data/exports/exim_employee'
diff --git a/ql/src/test/results/clientpositive/exim_03_nonpart_over_compat.q.out b/ql/src/test/results/clientpositive/exim_03_nonpart_over_compat.q.out
index 98ac40ddbc..7403d720a2 100644
--- a/ql/src/test/results/clientpositive/exim_03_nonpart_over_compat.q.out
+++ b/ql/src/test/results/clientpositive/exim_03_nonpart_over_compat.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: create table exim_department ( dep_id int comment "department id
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exim_department
 POSTHOOK: query: create table exim_department ( dep_id int comment "department id") 	
 	stored as textfile	
 	tblproperties("creator"="krishna")
@@ -36,17 +37,22 @@ POSTHOOK: Input: default@exim_department
 POSTHOOK: Output: default@exim_department
 PREHOOK: query: create database importer
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:importer
 POSTHOOK: query: create database importer
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:importer
 PREHOOK: query: use importer
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:importer
 POSTHOOK: query: use importer
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:importer
 PREHOOK: query: create table exim_department ( dep_id int comment "department identifier") 	
 	stored as textfile	
 	tblproperties("maker"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:importer
+PREHOOK: Output: importer@exim_department
 POSTHOOK: query: create table exim_department ( dep_id int comment "department identifier") 	
 	stored as textfile	
 	tblproperties("maker"="krishna")
diff --git a/ql/src/test/results/clientpositive/exim_04_all_part.q.out b/ql/src/test/results/clientpositive/exim_04_all_part.q.out
index 3ef7b15746..77d15e289a 100644
--- a/ql/src/test/results/clientpositive/exim_04_all_part.q.out
+++ b/ql/src/test/results/clientpositive/exim_04_all_part.q.out
@@ -5,6 +5,7 @@ PREHOOK: query: create table exim_employee ( emp_id int comment "employee id")
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exim_employee
 POSTHOOK: query: create table exim_employee ( emp_id int comment "employee id") 	
 	comment "employee table"
 	partitioned by (emp_country string comment "two char iso code", emp_state string comment "free text")
@@ -82,12 +83,16 @@ POSTHOOK: Input: default@exim_employee
 POSTHOOK: Output: default@exim_employee
 PREHOOK: query: create database importer
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:importer
 POSTHOOK: query: create database importer
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:importer
 PREHOOK: query: use importer
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:importer
 POSTHOOK: query: use importer
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:importer
 PREHOOK: query: import from 'ql/test/data/exports/exim_employee'
 PREHOOK: type: IMPORT
 POSTHOOK: query: import from 'ql/test/data/exports/exim_employee'
diff --git a/ql/src/test/results/clientpositive/exim_04_evolved_parts.q.out b/ql/src/test/results/clientpositive/exim_04_evolved_parts.q.out
index ac5c67d0af..ae274a437c 100644
--- a/ql/src/test/results/clientpositive/exim_04_evolved_parts.q.out
+++ b/ql/src/test/results/clientpositive/exim_04_evolved_parts.q.out
@@ -6,6 +6,7 @@ PREHOOK: query: create table exim_employee (emp_id int comment 'employee id', em
  stored as rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exim_employee
 POSTHOOK: query: create table exim_employee (emp_id int comment 'employee id', emp_name string, emp_dob string comment 'employee date of birth', emp_sex string comment 'M/F') 
  comment 'employee table' 
  partitioned by (emp_country string comment '2-char code', emp_state string comment '2-char code')
@@ -88,12 +89,16 @@ POSTHOOK: Input: default@exim_employee
 POSTHOOK: Output: default@exim_employee
 PREHOOK: query: create database importer
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:importer
 POSTHOOK: query: create database importer
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:importer
 PREHOOK: query: use importer
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:importer
 POSTHOOK: query: use importer
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:importer
 PREHOOK: query: import from 'ql/test/data/exports/exim_employee'
 PREHOOK: type: IMPORT
 POSTHOOK: query: import from 'ql/test/data/exports/exim_employee'
diff --git a/ql/src/test/results/clientpositive/exim_05_some_part.q.out b/ql/src/test/results/clientpositive/exim_05_some_part.q.out
index 5bc044fcd9..8f65d081c5 100644
--- a/ql/src/test/results/clientpositive/exim_05_some_part.q.out
+++ b/ql/src/test/results/clientpositive/exim_05_some_part.q.out
@@ -5,6 +5,7 @@ PREHOOK: query: create table exim_employee ( emp_id int comment "employee id")
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exim_employee
 POSTHOOK: query: create table exim_employee ( emp_id int comment "employee id") 	
 	comment "employee table"
 	partitioned by (emp_country string comment "two char iso code", emp_state string comment "free text")
@@ -78,12 +79,16 @@ POSTHOOK: Input: default@exim_employee
 POSTHOOK: Output: default@exim_employee
 PREHOOK: query: create database importer
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:importer
 POSTHOOK: query: create database importer
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:importer
 PREHOOK: query: use importer
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:importer
 POSTHOOK: query: use importer
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:importer
 PREHOOK: query: import from 'ql/test/data/exports/exim_employee'
 PREHOOK: type: IMPORT
 POSTHOOK: query: import from 'ql/test/data/exports/exim_employee'
diff --git a/ql/src/test/results/clientpositive/exim_06_one_part.q.out b/ql/src/test/results/clientpositive/exim_06_one_part.q.out
index d8d3c45b38..0024fefc1d 100644
--- a/ql/src/test/results/clientpositive/exim_06_one_part.q.out
+++ b/ql/src/test/results/clientpositive/exim_06_one_part.q.out
@@ -5,6 +5,7 @@ PREHOOK: query: create table exim_employee ( emp_id int comment "employee id")
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exim_employee
 POSTHOOK: query: create table exim_employee ( emp_id int comment "employee id") 	
 	comment "employee table"
 	partitioned by (emp_country string comment "two char iso code", emp_state string comment "free text")
@@ -76,12 +77,16 @@ POSTHOOK: Input: default@exim_employee
 POSTHOOK: Output: default@exim_employee
 PREHOOK: query: create database importer
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:importer
 POSTHOOK: query: create database importer
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:importer
 PREHOOK: query: use importer
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:importer
 POSTHOOK: query: use importer
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:importer
 PREHOOK: query: import from 'ql/test/data/exports/exim_employee'
 PREHOOK: type: IMPORT
 POSTHOOK: query: import from 'ql/test/data/exports/exim_employee'
diff --git a/ql/src/test/results/clientpositive/exim_07_all_part_over_nonoverlap.q.out b/ql/src/test/results/clientpositive/exim_07_all_part_over_nonoverlap.q.out
index 25c4f31c36..c6f136829c 100644
--- a/ql/src/test/results/clientpositive/exim_07_all_part_over_nonoverlap.q.out
+++ b/ql/src/test/results/clientpositive/exim_07_all_part_over_nonoverlap.q.out
@@ -5,6 +5,7 @@ PREHOOK: query: create table exim_employee ( emp_id int comment "employee id")
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exim_employee
 POSTHOOK: query: create table exim_employee ( emp_id int comment "employee id") 	
 	comment "employee table"
 	partitioned by (emp_country string comment "two char iso code", emp_state string comment "free text")
@@ -82,12 +83,16 @@ POSTHOOK: Input: default@exim_employee
 POSTHOOK: Output: default@exim_employee
 PREHOOK: query: create database importer
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:importer
 POSTHOOK: query: create database importer
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:importer
 PREHOOK: query: use importer
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:importer
 POSTHOOK: query: use importer
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:importer
 PREHOOK: query: create table exim_employee ( emp_id int comment "employee id") 	
 	comment "table of employees"
 	partitioned by (emp_country string comment "iso code", emp_state string comment "free-form text")
@@ -95,6 +100,7 @@ PREHOOK: query: create table exim_employee ( emp_id int comment "employee id")
 	tblproperties("maker"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:importer
+PREHOOK: Output: importer@exim_employee
 POSTHOOK: query: create table exim_employee ( emp_id int comment "employee id") 	
 	comment "table of employees"
 	partitioned by (emp_country string comment "iso code", emp_state string comment "free-form text")
diff --git a/ql/src/test/results/clientpositive/exim_08_nonpart_rename.q.out b/ql/src/test/results/clientpositive/exim_08_nonpart_rename.q.out
index 708d9021b3..b712de1eb3 100644
--- a/ql/src/test/results/clientpositive/exim_08_nonpart_rename.q.out
+++ b/ql/src/test/results/clientpositive/exim_08_nonpart_rename.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: create table exim_department ( dep_id int comment "department id
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exim_department
 POSTHOOK: query: create table exim_department ( dep_id int comment "department id") 	
 	stored as textfile	
 	tblproperties("creator"="krishna")
@@ -36,18 +37,23 @@ POSTHOOK: Input: default@exim_department
 POSTHOOK: Output: default@exim_department
 PREHOOK: query: create database importer
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:importer
 POSTHOOK: query: create database importer
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:importer
 PREHOOK: query: use importer
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:importer
 POSTHOOK: query: use importer
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:importer
 PREHOOK: query: create table exim_department ( dep_id int comment "department id") 	
 	partitioned by (emp_org string)
 	stored as textfile	
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:importer
+PREHOOK: Output: importer@exim_department
 POSTHOOK: query: create table exim_department ( dep_id int comment "department id") 	
 	partitioned by (emp_org string)
 	stored as textfile	
diff --git a/ql/src/test/results/clientpositive/exim_09_part_spec_nonoverlap.q.out b/ql/src/test/results/clientpositive/exim_09_part_spec_nonoverlap.q.out
index 3d5956704b..ad197b8468 100644
--- a/ql/src/test/results/clientpositive/exim_09_part_spec_nonoverlap.q.out
+++ b/ql/src/test/results/clientpositive/exim_09_part_spec_nonoverlap.q.out
@@ -5,6 +5,7 @@ PREHOOK: query: create table exim_employee ( emp_id int comment "employee id")
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exim_employee
 POSTHOOK: query: create table exim_employee ( emp_id int comment "employee id") 	
 	comment "employee table"
 	partitioned by (emp_country string comment "two char iso code", emp_state string comment "free text")
@@ -82,12 +83,16 @@ POSTHOOK: Input: default@exim_employee
 POSTHOOK: Output: default@exim_employee
 PREHOOK: query: create database importer
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:importer
 POSTHOOK: query: create database importer
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:importer
 PREHOOK: query: use importer
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:importer
 POSTHOOK: query: use importer
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:importer
 PREHOOK: query: create table exim_employee ( emp_id int comment "employee id") 	
 	comment "employee table"
 	partitioned by (emp_country string comment "two char iso code", emp_state string comment "free text")
@@ -95,6 +100,7 @@ PREHOOK: query: create table exim_employee ( emp_id int comment "employee id")
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:importer
+PREHOOK: Output: importer@exim_employee
 POSTHOOK: query: create table exim_employee ( emp_id int comment "employee id") 	
 	comment "employee table"
 	partitioned by (emp_country string comment "two char iso code", emp_state string comment "free text")
diff --git a/ql/src/test/results/clientpositive/exim_10_external_managed.q.out b/ql/src/test/results/clientpositive/exim_10_external_managed.q.out
index e2f11138d5..8d924315d4 100644
--- a/ql/src/test/results/clientpositive/exim_10_external_managed.q.out
+++ b/ql/src/test/results/clientpositive/exim_10_external_managed.q.out
@@ -6,6 +6,7 @@ PREHOOK: query: create external table exim_department ( dep_id int comment "depa
 PREHOOK: type: CREATETABLE
 #### A masked pattern was here ####
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exim_department
 POSTHOOK: query: create external table exim_department ( dep_id int comment "department id") 	
 	stored as textfile	
 	location 'ql/test/data/tablestore/exim_department'
@@ -42,12 +43,16 @@ POSTHOOK: Output: default@exim_department
 #### A masked pattern was here ####
 PREHOOK: query: create database importer
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:importer
 POSTHOOK: query: create database importer
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:importer
 PREHOOK: query: use importer
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:importer
 POSTHOOK: query: use importer
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:importer
 PREHOOK: query: import from 'ql/test/data/exports/exim_department'
 PREHOOK: type: IMPORT
 POSTHOOK: query: import from 'ql/test/data/exports/exim_department'
diff --git a/ql/src/test/results/clientpositive/exim_11_managed_external.q.out b/ql/src/test/results/clientpositive/exim_11_managed_external.q.out
index 1aa9e1404d..8cc4224977 100644
--- a/ql/src/test/results/clientpositive/exim_11_managed_external.q.out
+++ b/ql/src/test/results/clientpositive/exim_11_managed_external.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: create table exim_department ( dep_id int comment "department id
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exim_department
 POSTHOOK: query: create table exim_department ( dep_id int comment "department id") 	
 	stored as textfile	
 	tblproperties("creator"="krishna")
@@ -36,12 +37,16 @@ POSTHOOK: Input: default@exim_department
 POSTHOOK: Output: default@exim_department
 PREHOOK: query: create database importer
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:importer
 POSTHOOK: query: create database importer
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:importer
 PREHOOK: query: use importer
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:importer
 POSTHOOK: query: use importer
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:importer
 PREHOOK: query: import external table exim_department from 'ql/test/data/exports/exim_department'
 PREHOOK: type: IMPORT
 POSTHOOK: query: import external table exim_department from 'ql/test/data/exports/exim_department'
diff --git a/ql/src/test/results/clientpositive/exim_12_external_location.q.out b/ql/src/test/results/clientpositive/exim_12_external_location.q.out
index 9960740d39..5e5c32fb3a 100644
--- a/ql/src/test/results/clientpositive/exim_12_external_location.q.out
+++ b/ql/src/test/results/clientpositive/exim_12_external_location.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: create table exim_department ( dep_id int comment "department id
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exim_department
 POSTHOOK: query: create table exim_department ( dep_id int comment "department id") 	
 	stored as textfile	
 	tblproperties("creator"="krishna")
@@ -36,12 +37,16 @@ POSTHOOK: Input: default@exim_department
 POSTHOOK: Output: default@exim_department
 PREHOOK: query: create database importer
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:importer
 POSTHOOK: query: create database importer
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:importer
 PREHOOK: query: use importer
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:importer
 POSTHOOK: query: use importer
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:importer
 #### A masked pattern was here ####
 PREHOOK: query: import external table exim_department from 'ql/test/data/exports/exim_department' 
 	location 'ql/test/data/tablestore/exim_department'
diff --git a/ql/src/test/results/clientpositive/exim_13_managed_location.q.out b/ql/src/test/results/clientpositive/exim_13_managed_location.q.out
index afcfb37c87..ae7bf56e0f 100644
--- a/ql/src/test/results/clientpositive/exim_13_managed_location.q.out
+++ b/ql/src/test/results/clientpositive/exim_13_managed_location.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: create table exim_department ( dep_id int comment "department id
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exim_department
 POSTHOOK: query: create table exim_department ( dep_id int comment "department id") 	
 	stored as textfile	
 	tblproperties("creator"="krishna")
@@ -36,12 +37,16 @@ POSTHOOK: Input: default@exim_department
 POSTHOOK: Output: default@exim_department
 PREHOOK: query: create database importer
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:importer
 POSTHOOK: query: create database importer
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:importer
 PREHOOK: query: use importer
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:importer
 POSTHOOK: query: use importer
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:importer
 #### A masked pattern was here ####
 PREHOOK: query: import table exim_department from 'ql/test/data/exports/exim_department' 
 	location 'ql/test/data/tablestore/exim_department'
diff --git a/ql/src/test/results/clientpositive/exim_14_managed_location_over_existing.q.out b/ql/src/test/results/clientpositive/exim_14_managed_location_over_existing.q.out
index afe3523c32..0bccb9fb79 100644
--- a/ql/src/test/results/clientpositive/exim_14_managed_location_over_existing.q.out
+++ b/ql/src/test/results/clientpositive/exim_14_managed_location_over_existing.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: create table exim_department ( dep_id int comment "department id
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exim_department
 POSTHOOK: query: create table exim_department ( dep_id int comment "department id") 	
 	stored as textfile	
 	tblproperties("creator"="krishna")
@@ -36,12 +37,16 @@ POSTHOOK: Input: default@exim_department
 POSTHOOK: Output: default@exim_department
 PREHOOK: query: create database importer
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:importer
 POSTHOOK: query: create database importer
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:importer
 PREHOOK: query: use importer
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:importer
 POSTHOOK: query: use importer
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:importer
 #### A masked pattern was here ####
 PREHOOK: query: create table exim_department ( dep_id int comment "department id") 	
 	stored as textfile
@@ -50,6 +55,7 @@ PREHOOK: query: create table exim_department ( dep_id int comment "department id
 PREHOOK: type: CREATETABLE
 #### A masked pattern was here ####
 PREHOOK: Output: database:importer
+PREHOOK: Output: importer@exim_department
 POSTHOOK: query: create table exim_department ( dep_id int comment "department id") 	
 	stored as textfile
 	location 'ql/test/data/tablestore/exim_department'
diff --git a/ql/src/test/results/clientpositive/exim_15_external_part.q.out b/ql/src/test/results/clientpositive/exim_15_external_part.q.out
index e60aeb906f..26d8e6f2b5 100644
--- a/ql/src/test/results/clientpositive/exim_15_external_part.q.out
+++ b/ql/src/test/results/clientpositive/exim_15_external_part.q.out
@@ -5,6 +5,7 @@ PREHOOK: query: create table exim_employee ( emp_id int comment "employee id")
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exim_employee
 POSTHOOK: query: create table exim_employee ( emp_id int comment "employee id") 	
 	comment "employee table"
 	partitioned by (emp_country string comment "two char iso code", emp_state string comment "free text")
@@ -82,12 +83,16 @@ POSTHOOK: Input: default@exim_employee
 POSTHOOK: Output: default@exim_employee
 PREHOOK: query: create database importer
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:importer
 POSTHOOK: query: create database importer
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:importer
 PREHOOK: query: use importer
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:importer
 POSTHOOK: query: use importer
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:importer
 #### A masked pattern was here ####
 PREHOOK: query: create external table exim_employee ( emp_id int comment "employee id") 	
 	comment "employee table"
@@ -98,6 +103,7 @@ PREHOOK: query: create external table exim_employee ( emp_id int comment "employ
 PREHOOK: type: CREATETABLE
 #### A masked pattern was here ####
 PREHOOK: Output: database:importer
+PREHOOK: Output: importer@exim_employee
 POSTHOOK: query: create external table exim_employee ( emp_id int comment "employee id") 	
 	comment "employee table"
 	partitioned by (emp_country string comment "two char iso code", emp_state string comment "free text")
diff --git a/ql/src/test/results/clientpositive/exim_16_part_external.q.out b/ql/src/test/results/clientpositive/exim_16_part_external.q.out
index 7f5497c9bb..23e790afd9 100644
--- a/ql/src/test/results/clientpositive/exim_16_part_external.q.out
+++ b/ql/src/test/results/clientpositive/exim_16_part_external.q.out
@@ -5,6 +5,7 @@ PREHOOK: query: create table exim_employee ( emp_id int comment "employee id")
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exim_employee
 POSTHOOK: query: create table exim_employee ( emp_id int comment "employee id") 	
 	comment "employee table"
 	partitioned by (emp_country string comment "two char iso code", emp_state string comment "free text")
@@ -82,12 +83,16 @@ POSTHOOK: Input: default@exim_employee
 POSTHOOK: Output: default@exim_employee
 PREHOOK: query: create database importer
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:importer
 POSTHOOK: query: create database importer
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:importer
 PREHOOK: query: use importer
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:importer
 POSTHOOK: query: use importer
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:importer
 #### A masked pattern was here ####
 PREHOOK: query: create external table exim_employee ( emp_id int comment "employee id") 	
 	comment "employee table"
@@ -98,6 +103,7 @@ PREHOOK: query: create external table exim_employee ( emp_id int comment "employ
 PREHOOK: type: CREATETABLE
 #### A masked pattern was here ####
 PREHOOK: Output: database:importer
+PREHOOK: Output: importer@exim_employee
 POSTHOOK: query: create external table exim_employee ( emp_id int comment "employee id") 	
 	comment "employee table"
 	partitioned by (emp_country string comment "two char iso code", emp_state string comment "free text")
diff --git a/ql/src/test/results/clientpositive/exim_17_part_managed.q.out b/ql/src/test/results/clientpositive/exim_17_part_managed.q.out
index ee18917a73..e129fe6d7a 100644
--- a/ql/src/test/results/clientpositive/exim_17_part_managed.q.out
+++ b/ql/src/test/results/clientpositive/exim_17_part_managed.q.out
@@ -5,6 +5,7 @@ PREHOOK: query: create table exim_employee ( emp_id int comment "employee id")
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exim_employee
 POSTHOOK: query: create table exim_employee ( emp_id int comment "employee id") 	
 	comment "employee table"
 	partitioned by (emp_country string comment "two char iso code", emp_state string comment "free text")
@@ -82,12 +83,16 @@ POSTHOOK: Input: default@exim_employee
 POSTHOOK: Output: default@exim_employee
 PREHOOK: query: create database importer
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:importer
 POSTHOOK: query: create database importer
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:importer
 PREHOOK: query: use importer
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:importer
 POSTHOOK: query: use importer
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:importer
 #### A masked pattern was here ####
 PREHOOK: query: create table exim_employee ( emp_id int comment "employee id") 	
 	comment "employee table"
@@ -96,6 +101,7 @@ PREHOOK: query: create table exim_employee ( emp_id int comment "employee id")
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:importer
+PREHOOK: Output: importer@exim_employee
 POSTHOOK: query: create table exim_employee ( emp_id int comment "employee id") 	
 	comment "employee table"
 	partitioned by (emp_country string comment "two char iso code", emp_state string comment "free text")
diff --git a/ql/src/test/results/clientpositive/exim_18_part_external.q.out b/ql/src/test/results/clientpositive/exim_18_part_external.q.out
index 13398ea574..95f85480a4 100644
--- a/ql/src/test/results/clientpositive/exim_18_part_external.q.out
+++ b/ql/src/test/results/clientpositive/exim_18_part_external.q.out
@@ -5,6 +5,7 @@ PREHOOK: query: create table exim_employee ( emp_id int comment "employee id")
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exim_employee
 POSTHOOK: query: create table exim_employee ( emp_id int comment "employee id") 	
 	comment "employee table"
 	partitioned by (emp_country string comment "two char iso code", emp_state string comment "free text")
@@ -82,12 +83,16 @@ POSTHOOK: Input: default@exim_employee
 POSTHOOK: Output: default@exim_employee
 PREHOOK: query: create database importer
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:importer
 POSTHOOK: query: create database importer
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:importer
 PREHOOK: query: use importer
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:importer
 POSTHOOK: query: use importer
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:importer
 PREHOOK: query: import external table exim_employee partition (emp_country="us", emp_state="tn") 
 	from 'ql/test/data/exports/exim_employee'
 PREHOOK: type: IMPORT
diff --git a/ql/src/test/results/clientpositive/exim_19_00_part_external_location.q.out b/ql/src/test/results/clientpositive/exim_19_00_part_external_location.q.out
index c967d01bf8..7a8830f945 100644
--- a/ql/src/test/results/clientpositive/exim_19_00_part_external_location.q.out
+++ b/ql/src/test/results/clientpositive/exim_19_00_part_external_location.q.out
@@ -5,6 +5,7 @@ PREHOOK: query: create table exim_employee ( emp_id int comment "employee id")
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exim_employee
 POSTHOOK: query: create table exim_employee ( emp_id int comment "employee id") 	
 	comment "employee table"
 	partitioned by (emp_country string comment "two char iso code", emp_state string comment "free text")
@@ -56,12 +57,16 @@ POSTHOOK: Input: default@exim_employee
 POSTHOOK: Output: default@exim_employee
 PREHOOK: query: create database importer
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:importer
 POSTHOOK: query: create database importer
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:importer
 PREHOOK: query: use importer
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:importer
 POSTHOOK: query: use importer
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:importer
 #### A masked pattern was here ####
 PREHOOK: query: import external table exim_employee 
 	from 'ql/test/data/exports/exim_employee'
diff --git a/ql/src/test/results/clientpositive/exim_19_part_external_location.q.out b/ql/src/test/results/clientpositive/exim_19_part_external_location.q.out
index 4702002b59..278a6cd524 100644
--- a/ql/src/test/results/clientpositive/exim_19_part_external_location.q.out
+++ b/ql/src/test/results/clientpositive/exim_19_part_external_location.q.out
@@ -5,6 +5,7 @@ PREHOOK: query: create table exim_employee ( emp_id int comment "employee id")
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exim_employee
 POSTHOOK: query: create table exim_employee ( emp_id int comment "employee id") 	
 	comment "employee table"
 	partitioned by (emp_country string comment "two char iso code", emp_state string comment "free text")
@@ -82,12 +83,16 @@ POSTHOOK: Input: default@exim_employee
 POSTHOOK: Output: default@exim_employee
 PREHOOK: query: create database importer
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:importer
 POSTHOOK: query: create database importer
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:importer
 PREHOOK: query: use importer
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:importer
 POSTHOOK: query: use importer
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:importer
 #### A masked pattern was here ####
 PREHOOK: query: import external table exim_employee partition (emp_country="us", emp_state="tn") 
 	from 'ql/test/data/exports/exim_employee'
diff --git a/ql/src/test/results/clientpositive/exim_20_part_managed_location.q.out b/ql/src/test/results/clientpositive/exim_20_part_managed_location.q.out
index c4a121ba2e..6a32f0a0fc 100644
--- a/ql/src/test/results/clientpositive/exim_20_part_managed_location.q.out
+++ b/ql/src/test/results/clientpositive/exim_20_part_managed_location.q.out
@@ -5,6 +5,7 @@ PREHOOK: query: create table exim_employee ( emp_id int comment "employee id")
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exim_employee
 POSTHOOK: query: create table exim_employee ( emp_id int comment "employee id") 	
 	comment "employee table"
 	partitioned by (emp_country string comment "two char iso code", emp_state string comment "free text")
@@ -82,12 +83,16 @@ POSTHOOK: Input: default@exim_employee
 POSTHOOK: Output: default@exim_employee
 PREHOOK: query: create database importer
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:importer
 POSTHOOK: query: create database importer
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:importer
 PREHOOK: query: use importer
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:importer
 POSTHOOK: query: use importer
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:importer
 #### A masked pattern was here ####
 PREHOOK: query: import table exim_employee partition (emp_country="us", emp_state="tn") 
 	from 'ql/test/data/exports/exim_employee'
diff --git a/ql/src/test/results/clientpositive/exim_21_export_authsuccess.q.out b/ql/src/test/results/clientpositive/exim_21_export_authsuccess.q.out
index 10702fd51a..56addeeebb 100644
--- a/ql/src/test/results/clientpositive/exim_21_export_authsuccess.q.out
+++ b/ql/src/test/results/clientpositive/exim_21_export_authsuccess.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table exim_department ( dep_id int) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exim_department
 POSTHOOK: query: create table exim_department ( dep_id int) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/exim_22_import_exist_authsuccess.q.out b/ql/src/test/results/clientpositive/exim_22_import_exist_authsuccess.q.out
index d6f68096ba..b17d509a96 100644
--- a/ql/src/test/results/clientpositive/exim_22_import_exist_authsuccess.q.out
+++ b/ql/src/test/results/clientpositive/exim_22_import_exist_authsuccess.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table exim_department ( dep_id int) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exim_department
 POSTHOOK: query: create table exim_department ( dep_id int) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -32,15 +33,20 @@ POSTHOOK: Input: default@exim_department
 POSTHOOK: Output: default@exim_department
 PREHOOK: query: create database importer
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:importer
 POSTHOOK: query: create database importer
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:importer
 PREHOOK: query: use importer
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:importer
 POSTHOOK: query: use importer
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:importer
 PREHOOK: query: create table exim_department ( dep_id int) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:importer
+PREHOOK: Output: importer@exim_department
 POSTHOOK: query: create table exim_department ( dep_id int) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:importer
diff --git a/ql/src/test/results/clientpositive/exim_23_import_part_authsuccess.q.out b/ql/src/test/results/clientpositive/exim_23_import_part_authsuccess.q.out
index b0c7a94c2b..99ccf435c3 100644
--- a/ql/src/test/results/clientpositive/exim_23_import_part_authsuccess.q.out
+++ b/ql/src/test/results/clientpositive/exim_23_import_part_authsuccess.q.out
@@ -5,6 +5,7 @@ PREHOOK: query: create table exim_employee ( emp_id int comment "employee id")
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exim_employee
 POSTHOOK: query: create table exim_employee ( emp_id int comment "employee id") 	
 	comment "employee table"
 	partitioned by (emp_country string comment "two char iso code", emp_state string comment "free text")
@@ -43,12 +44,16 @@ POSTHOOK: Input: default@exim_employee
 POSTHOOK: Output: default@exim_employee
 PREHOOK: query: create database importer
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:importer
 POSTHOOK: query: create database importer
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:importer
 PREHOOK: query: use importer
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:importer
 POSTHOOK: query: use importer
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:importer
 PREHOOK: query: create table exim_employee ( emp_id int comment "employee id") 	
 	comment "employee table"
 	partitioned by (emp_country string comment "two char iso code", emp_state string comment "free text")
@@ -56,6 +61,7 @@ PREHOOK: query: create table exim_employee ( emp_id int comment "employee id")
 	tblproperties("creator"="krishna")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:importer
+PREHOOK: Output: importer@exim_employee
 POSTHOOK: query: create table exim_employee ( emp_id int comment "employee id") 	
 	comment "employee table"
 	partitioned by (emp_country string comment "two char iso code", emp_state string comment "free text")
diff --git a/ql/src/test/results/clientpositive/exim_24_import_nonexist_authsuccess.q.out b/ql/src/test/results/clientpositive/exim_24_import_nonexist_authsuccess.q.out
index 5ef4f775a1..c7225f79fa 100644
--- a/ql/src/test/results/clientpositive/exim_24_import_nonexist_authsuccess.q.out
+++ b/ql/src/test/results/clientpositive/exim_24_import_nonexist_authsuccess.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table exim_department ( dep_id int) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exim_department
 POSTHOOK: query: create table exim_department ( dep_id int) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -32,12 +33,16 @@ POSTHOOK: Input: default@exim_department
 POSTHOOK: Output: default@exim_department
 PREHOOK: query: create database importer
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:importer
 POSTHOOK: query: create database importer
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:importer
 PREHOOK: query: use importer
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:importer
 POSTHOOK: query: use importer
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:importer
 PREHOOK: query: grant Create on database importer to user hive_test_user
 PREHOOK: type: GRANT_PRIVILEGE
 POSTHOOK: query: grant Create on database importer to user hive_test_user
diff --git a/ql/src/test/results/clientpositive/exim_hidden_files.q.out b/ql/src/test/results/clientpositive/exim_hidden_files.q.out
index 451ad9aaeb..95d8b28d18 100644
--- a/ql/src/test/results/clientpositive/exim_hidden_files.q.out
+++ b/ql/src/test/results/clientpositive/exim_hidden_files.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table exim_employee ( emp_id int) partitioned by (emp_country string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@exim_employee
 POSTHOOK: query: create table exim_employee ( emp_id int) partitioned by (emp_country string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -32,12 +33,16 @@ POSTHOOK: Input: default@exim_employee
 POSTHOOK: Output: default@exim_employee
 PREHOOK: query: create database importer
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:importer
 POSTHOOK: query: create database importer
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:importer
 PREHOOK: query: use importer
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:importer
 POSTHOOK: query: use importer
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:importer
 PREHOOK: query: import from 'ql/test/data/exports/exim_employee'
 PREHOOK: type: IMPORT
 POSTHOOK: query: import from 'ql/test/data/exports/exim_employee'
@@ -114,5 +119,7 @@ POSTHOOK: Input: database:importer
 POSTHOOK: Output: database:importer
 PREHOOK: query: use default
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:default
 POSTHOOK: query: use default
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:default
diff --git a/ql/src/test/results/clientpositive/explain_dependency2.q.out b/ql/src/test/results/clientpositive/explain_dependency2.q.out
index d57655e01b..cb4e6c3d90 100644
--- a/ql/src/test/results/clientpositive/explain_dependency2.q.out
+++ b/ql/src/test/results/clientpositive/explain_dependency2.q.out
@@ -55,6 +55,7 @@ POSTHOOK: type: QUERY
 PREHOOK: query: create table tstsrcpart like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tstsrcpart
 POSTHOOK: query: create table tstsrcpart like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/explain_rearrange.q.out b/ql/src/test/results/clientpositive/explain_rearrange.q.out
index ad9e991f60..7bbad100d1 100644
--- a/ql/src/test/results/clientpositive/explain_rearrange.q.out
+++ b/ql/src/test/results/clientpositive/explain_rearrange.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- query from auto_sortmerge_join_9.q
 CREATE TABLE tbl1(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl1
 POSTHOOK: query: -- query from auto_sortmerge_join_9.q
 
 CREATE TABLE tbl1(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
@@ -12,6 +13,7 @@ POSTHOOK: Output: default@tbl1
 PREHOOK: query: CREATE TABLE tbl2(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl2
 POSTHOOK: query: CREATE TABLE tbl2(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/external_table_with_space_in_location_path.q.out b/ql/src/test/results/clientpositive/external_table_with_space_in_location_path.q.out
index f4e3d4d73b..831e339919 100644
--- a/ql/src/test/results/clientpositive/external_table_with_space_in_location_path.q.out
+++ b/ql/src/test/results/clientpositive/external_table_with_space_in_location_path.q.out
@@ -2,6 +2,7 @@
 PREHOOK: type: CREATETABLE
 #### A masked pattern was here ####
 PREHOOK: Output: database:default
+PREHOOK: Output: default@spacetest
 #### A masked pattern was here ####
 POSTHOOK: type: CREATETABLE
 #### A masked pattern was here ####
@@ -38,6 +39,7 @@ POSTHOOK: Output: default@spacetest
 PREHOOK: query: CREATE EXTERNAL TABLE spacetestpartition (id int, message string) PARTITIONED BY (day int) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@spacetestpartition
 POSTHOOK: query: CREATE EXTERNAL TABLE spacetestpartition (id int, message string) PARTITIONED BY (day int) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t'
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/file_with_header_footer.q.out b/ql/src/test/results/clientpositive/file_with_header_footer.q.out
index a266012f87..ca3dadb2b9 100644
--- a/ql/src/test/results/clientpositive/file_with_header_footer.q.out
+++ b/ql/src/test/results/clientpositive/file_with_header_footer.q.out
@@ -2,6 +2,7 @@
 PREHOOK: type: CREATETABLE
 #### A masked pattern was here ####
 PREHOOK: Output: database:default
+PREHOOK: Output: default@header_footer_table_1
 #### A masked pattern was here ####
 POSTHOOK: type: CREATETABLE
 #### A masked pattern was here ####
@@ -48,6 +49,7 @@ david3	oozie	22
 PREHOOK: query: CREATE EXTERNAL TABLE header_footer_table_2 (name string, message string, id int) PARTITIONED BY (year int, month int, day int) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' tblproperties ("skip.header.line.count"="1", "skip.footer.line.count"="2")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@header_footer_table_2
 POSTHOOK: query: CREATE EXTERNAL TABLE header_footer_table_2 (name string, message string, id int) PARTITIONED BY (year int, month int, day int) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' tblproperties ("skip.header.line.count"="1", "skip.footer.line.count"="2")
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -133,6 +135,7 @@ david3	oozie	22	2012	1	3
 PREHOOK: type: CREATETABLE
 #### A masked pattern was here ####
 PREHOOK: Output: database:default
+PREHOOK: Output: default@emptytable
 #### A masked pattern was here ####
 POSTHOOK: type: CREATETABLE
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/fileformat_mix.q.out b/ql/src/test/results/clientpositive/fileformat_mix.q.out
index 04d91ad194..7465914e81 100644
--- a/ql/src/test/results/clientpositive/fileformat_mix.q.out
+++ b/ql/src/test/results/clientpositive/fileformat_mix.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table fileformat_mix_test (src int, value string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@fileformat_mix_test
 POSTHOOK: query: create table fileformat_mix_test (src int, value string) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/fileformat_sequencefile.q.out b/ql/src/test/results/clientpositive/fileformat_sequencefile.q.out
index f93fd234d3..94a88701ec 100644
--- a/ql/src/test/results/clientpositive/fileformat_sequencefile.q.out
+++ b/ql/src/test/results/clientpositive/fileformat_sequencefile.q.out
@@ -25,6 +25,7 @@ PREHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS
   OUTPUTFORMAT 'org.apache.hadoop.mapred.SequenceFileOutputFormat'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS
   INPUTFORMAT 'org.apache.hadoop.mapred.SequenceFileInputFormat'
   OUTPUTFORMAT 'org.apache.hadoop.mapred.SequenceFileOutputFormat'
diff --git a/ql/src/test/results/clientpositive/fileformat_text.q.out b/ql/src/test/results/clientpositive/fileformat_text.q.out
index 6dc596c9cf..4815d05bc9 100644
--- a/ql/src/test/results/clientpositive/fileformat_text.q.out
+++ b/ql/src/test/results/clientpositive/fileformat_text.q.out
@@ -25,6 +25,7 @@ PREHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS
   OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS
   INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat'
   OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat'
diff --git a/ql/src/test/results/clientpositive/filter_join_breaktask.q.out b/ql/src/test/results/clientpositive/filter_join_breaktask.q.out
index ff91afe5c5..3deb166179 100644
--- a/ql/src/test/results/clientpositive/filter_join_breaktask.q.out
+++ b/ql/src/test/results/clientpositive/filter_join_breaktask.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE filter_join_breaktask(key int, value string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@filter_join_breaktask
 POSTHOOK: query: CREATE TABLE filter_join_breaktask(key int, value string) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/filter_join_breaktask2.q.out b/ql/src/test/results/clientpositive/filter_join_breaktask2.q.out
index bca31b116c..d81bc93e95 100644
--- a/ql/src/test/results/clientpositive/filter_join_breaktask2.q.out
+++ b/ql/src/test/results/clientpositive/filter_join_breaktask2.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: create table T1(c1 string, c2 string, c3 string, c4 string, c5 s
 partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: create table T1(c1 string, c2 string, c3 string, c4 string, c5 string, c6 string, c7 string) 
 partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
@@ -10,6 +11,7 @@ POSTHOOK: Output: default@T1
 PREHOOK: query: create table T2(c1 string, c2 string, c3 string, c0 string, c4 string, c5 string, c6 string, c7 string, c8 string, c9 string, c10 string, c11 string, c12 string, c13 string, c14 string, c15 string, c16 string, c17 string, c18 string, c19 string, c20 string, c21 string, c22 string, c23 string, c24 string,  c25 string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T2
 POSTHOOK: query: create table T2(c1 string, c2 string, c3 string, c0 string, c4 string, c5 string, c6 string, c7 string, c8 string, c9 string, c10 string, c11 string, c12 string, c13 string, c14 string, c15 string, c16 string, c17 string, c18 string, c19 string, c20 string, c21 string, c22 string, c23 string, c24 string,  c25 string) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -17,6 +19,7 @@ POSTHOOK: Output: default@T2
 PREHOOK: query: create table T3 (c0 bigint,  c1 bigint, c2 int) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T3
 POSTHOOK: query: create table T3 (c0 bigint,  c1 bigint, c2 int) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -24,6 +27,7 @@ POSTHOOK: Output: default@T3
 PREHOOK: query: create table T4 (c0 bigint, c1 string, c2 string, c3 string, c4 string, c5 string, c6 string, c7 string, c8 string, c9 string, c10 string, c11 string, c12 string, c13 string, c14 string, c15 string, c16 string, c17 string, c18 string, c19 string, c20 string, c21 string, c22 string, c23 string, c24 string, c25 string, c26 string, c27 string, c28 string, c29 string, c30 string, c31 string, c32 string, c33 string, c34 string, c35 string, c36 string, c37 string, c38 string, c39 string, c40 string, c41 string, c42 string, c43 string, c44 string, c45 string, c46 string, c47 string, c48 string, c49 string, c50 string, c51 string, c52 string, c53 string, c54 string, c55 string, c56 string, c57 string, c58 string, c59 string, c60 string, c61 string, c62 string, c63 string, c64 string, c65 string, c66 string, c67 bigint, c68 string, c69 string, c70 bigint, c71 bigint, c72 bigint, c73 string, c74 string, c75 string, c76 string, c77 string, c78 string, c79 string, c80 string, c81 bigint, c82 bigint, c83 bigint) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T4
 POSTHOOK: query: create table T4 (c0 bigint, c1 string, c2 string, c3 string, c4 string, c5 string, c6 string, c7 string, c8 string, c9 string, c10 string, c11 string, c12 string, c13 string, c14 string, c15 string, c16 string, c17 string, c18 string, c19 string, c20 string, c21 string, c22 string, c23 string, c24 string, c25 string, c26 string, c27 string, c28 string, c29 string, c30 string, c31 string, c32 string, c33 string, c34 string, c35 string, c36 string, c37 string, c38 string, c39 string, c40 string, c41 string, c42 string, c43 string, c44 string, c45 string, c46 string, c47 string, c48 string, c49 string, c50 string, c51 string, c52 string, c53 string, c54 string, c55 string, c56 string, c57 string, c58 string, c59 string, c60 string, c61 string, c62 string, c63 string, c64 string, c65 string, c66 string, c67 bigint, c68 string, c69 string, c70 bigint, c71 bigint, c72 bigint, c73 string, c74 string, c75 string, c76 string, c77 string, c78 string, c79 string, c80 string, c81 bigint, c82 bigint, c83 bigint) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/filter_numeric.q.out b/ql/src/test/results/clientpositive/filter_numeric.q.out
index 32c0335ea6..ae52ba0d20 100644
--- a/ql/src/test/results/clientpositive/filter_numeric.q.out
+++ b/ql/src/test/results/clientpositive/filter_numeric.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_AND_HASH_QUERY_RESULTS
 create table partint(key string, value string) partitioned by (ds string, hr int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@partint
 POSTHOOK: query: -- SORT_AND_HASH_QUERY_RESULTS
 
 create table partint(key string, value string) partitioned by (ds string, hr int)
diff --git a/ql/src/test/results/clientpositive/global_limit.q.out b/ql/src/test/results/clientpositive/global_limit.q.out
index e590198f60..31cbeb1247 100644
--- a/ql/src/test/results/clientpositive/global_limit.q.out
+++ b/ql/src/test/results/clientpositive/global_limit.q.out
@@ -17,6 +17,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table gl_src1 (key int, value string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@gl_src1
 POSTHOOK: query: create table gl_src1 (key int, value string) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -1120,6 +1121,7 @@ PREHOOK: query: -- empty table
 create table gl_src2 (key int, value string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@gl_src2
 POSTHOOK: query: -- empty table
 create table gl_src2 (key int, value string) stored as textfile
 POSTHOOK: type: CREATETABLE
@@ -1137,6 +1139,7 @@ PREHOOK: query: -- partition
 create table gl_src_part1 (key int, value string) partitioned by (p string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@gl_src_part1
 POSTHOOK: query: -- partition
 create table gl_src_part1 (key int, value string) partitioned by (p string) stored as textfile
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/groupby1.q.out b/ql/src/test/results/clientpositive/groupby1.q.out
index 7461ce0e5e..6d34a58118 100644
--- a/ql/src/test/results/clientpositive/groupby1.q.out
+++ b/ql/src/test/results/clientpositive/groupby1.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest_g1(key INT, value DOUBLE) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_g1
 POSTHOOK: query: CREATE TABLE dest_g1(key INT, value DOUBLE) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/groupby10.q.out b/ql/src/test/results/clientpositive/groupby10.q.out
index b969b8005f..d694a45523 100644
--- a/ql/src/test/results/clientpositive/groupby10.q.out
+++ b/ql/src/test/results/clientpositive/groupby10.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key INT, val1 INT, val2 INT)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key INT, val1 INT, val2 INT)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@dest1
 PREHOOK: query: CREATE TABLE dest2(key INT, val1 INT, val2 INT)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest2
 POSTHOOK: query: CREATE TABLE dest2(key INT, val1 INT, val2 INT)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -15,6 +17,7 @@ POSTHOOK: Output: default@dest2
 PREHOOK: query: CREATE TABLE INPUT(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@INPUT
 POSTHOOK: query: CREATE TABLE INPUT(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/groupby11.q.out b/ql/src/test/results/clientpositive/groupby11.q.out
index 1112eff219..1bbc221e68 100644
--- a/ql/src/test/results/clientpositive/groupby11.q.out
+++ b/ql/src/test/results/clientpositive/groupby11.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key STRING, val1 INT, val2 INT) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key STRING, val1 INT, val2 INT) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@dest1
 PREHOOK: query: CREATE TABLE dest2(key STRING, val1 INT, val2 INT) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest2
 POSTHOOK: query: CREATE TABLE dest2(key STRING, val1 INT, val2 INT) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/groupby12.q.out b/ql/src/test/results/clientpositive/groupby12.q.out
index cc2db17cdc..4e9d1fce6c 100644
--- a/ql/src/test/results/clientpositive/groupby12.q.out
+++ b/ql/src/test/results/clientpositive/groupby12.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/groupby1_limit.q.out b/ql/src/test/results/clientpositive/groupby1_limit.q.out
index 6198e789d8..63ad65a436 100644
--- a/ql/src/test/results/clientpositive/groupby1_limit.q.out
+++ b/ql/src/test/results/clientpositive/groupby1_limit.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE dest1(key INT, value DOUBLE) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE dest1(key INT, value DOUBLE) STORED AS TEXTFILE
diff --git a/ql/src/test/results/clientpositive/groupby1_map.q.out b/ql/src/test/results/clientpositive/groupby1_map.q.out
index b9242731e3..2c55fc512c 100644
--- a/ql/src/test/results/clientpositive/groupby1_map.q.out
+++ b/ql/src/test/results/clientpositive/groupby1_map.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE dest1(key INT, value DOUBLE) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE dest1(key INT, value DOUBLE) STORED AS TEXTFILE
diff --git a/ql/src/test/results/clientpositive/groupby1_map_nomap.q.out b/ql/src/test/results/clientpositive/groupby1_map_nomap.q.out
index a27b74e884..da8e1ca3da 100644
--- a/ql/src/test/results/clientpositive/groupby1_map_nomap.q.out
+++ b/ql/src/test/results/clientpositive/groupby1_map_nomap.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key INT, value DOUBLE) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key INT, value DOUBLE) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/groupby1_map_skew.q.out b/ql/src/test/results/clientpositive/groupby1_map_skew.q.out
index 48f189ec84..735b1aca3b 100644
--- a/ql/src/test/results/clientpositive/groupby1_map_skew.q.out
+++ b/ql/src/test/results/clientpositive/groupby1_map_skew.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE dest1(key INT, value DOUBLE) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE dest1(key INT, value DOUBLE) STORED AS TEXTFILE
diff --git a/ql/src/test/results/clientpositive/groupby1_noskew.q.out b/ql/src/test/results/clientpositive/groupby1_noskew.q.out
index e8b683769e..326ba08c96 100644
--- a/ql/src/test/results/clientpositive/groupby1_noskew.q.out
+++ b/ql/src/test/results/clientpositive/groupby1_noskew.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE dest_g1(key INT, value DOUBLE) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_g1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE dest_g1(key INT, value DOUBLE) STORED AS TEXTFILE
diff --git a/ql/src/test/results/clientpositive/groupby2.q.out b/ql/src/test/results/clientpositive/groupby2.q.out
index dd6ddceea7..6e08c92b13 100644
--- a/ql/src/test/results/clientpositive/groupby2.q.out
+++ b/ql/src/test/results/clientpositive/groupby2.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest_g2(key STRING, c1 INT, c2 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_g2
 POSTHOOK: query: CREATE TABLE dest_g2(key STRING, c1 INT, c2 STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/groupby2_map.q.out b/ql/src/test/results/clientpositive/groupby2_map.q.out
index 9b2724106f..9c079805f9 100644
--- a/ql/src/test/results/clientpositive/groupby2_map.q.out
+++ b/ql/src/test/results/clientpositive/groupby2_map.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE dest1(key STRING, c1 INT, c2 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE dest1(key STRING, c1 INT, c2 STRING) STORED AS TEXTFILE
diff --git a/ql/src/test/results/clientpositive/groupby2_map_multi_distinct.q.out b/ql/src/test/results/clientpositive/groupby2_map_multi_distinct.q.out
index 8fe9098bce..9ee786290b 100644
--- a/ql/src/test/results/clientpositive/groupby2_map_multi_distinct.q.out
+++ b/ql/src/test/results/clientpositive/groupby2_map_multi_distinct.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE dest1(key STRING, c1 INT, c2 STRING, c3 INT, c4 INT) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE dest1(key STRING, c1 INT, c2 STRING, c3 INT, c4 INT) STORED AS TEXTFILE
diff --git a/ql/src/test/results/clientpositive/groupby2_map_skew.q.out b/ql/src/test/results/clientpositive/groupby2_map_skew.q.out
index 3e87998e70..6207676053 100644
--- a/ql/src/test/results/clientpositive/groupby2_map_skew.q.out
+++ b/ql/src/test/results/clientpositive/groupby2_map_skew.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key STRING, c1 INT, c2 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key STRING, c1 INT, c2 STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/groupby2_noskew.q.out b/ql/src/test/results/clientpositive/groupby2_noskew.q.out
index 01d7f4f7ce..6d51f83e4c 100644
--- a/ql/src/test/results/clientpositive/groupby2_noskew.q.out
+++ b/ql/src/test/results/clientpositive/groupby2_noskew.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE dest_g2(key STRING, c1 INT, c2 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_g2
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE dest_g2(key STRING, c1 INT, c2 STRING) STORED AS TEXTFILE
diff --git a/ql/src/test/results/clientpositive/groupby2_noskew_multi_distinct.q.out b/ql/src/test/results/clientpositive/groupby2_noskew_multi_distinct.q.out
index 5e04d028a3..cc1cd2cbb7 100644
--- a/ql/src/test/results/clientpositive/groupby2_noskew_multi_distinct.q.out
+++ b/ql/src/test/results/clientpositive/groupby2_noskew_multi_distinct.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE dest_g2(key STRING, c1 INT, c2 STRING, c3 INT, c4 INT) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_g2
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE dest_g2(key STRING, c1 INT, c2 STRING, c3 INT, c4 INT) STORED AS TEXTFILE
diff --git a/ql/src/test/results/clientpositive/groupby3.q.out b/ql/src/test/results/clientpositive/groupby3.q.out
index 11130683c1..6df4ac662e 100644
--- a/ql/src/test/results/clientpositive/groupby3.q.out
+++ b/ql/src/test/results/clientpositive/groupby3.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(c1 DOUBLE, c2 DOUBLE, c3 DOUBLE, c4 DOUBLE, c5 DOUBLE, c6 DOUBLE, c7 DOUBLE, c8 DOUBLE, c9 DOUBLE) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(c1 DOUBLE, c2 DOUBLE, c3 DOUBLE, c4 DOUBLE, c5 DOUBLE, c6 DOUBLE, c7 DOUBLE, c8 DOUBLE, c9 DOUBLE) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/groupby3_map.q.out b/ql/src/test/results/clientpositive/groupby3_map.q.out
index 3c7a3fe128..87cf30c167 100644
--- a/ql/src/test/results/clientpositive/groupby3_map.q.out
+++ b/ql/src/test/results/clientpositive/groupby3_map.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(c1 DOUBLE, c2 DOUBLE, c3 DOUBLE, c4 DOUBLE, c5 DOUBLE, c6 DOUBLE, c7 DOUBLE, c8 DOUBLE, c9 DOUBLE) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(c1 DOUBLE, c2 DOUBLE, c3 DOUBLE, c4 DOUBLE, c5 DOUBLE, c6 DOUBLE, c7 DOUBLE, c8 DOUBLE, c9 DOUBLE) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/groupby3_map_multi_distinct.q.out b/ql/src/test/results/clientpositive/groupby3_map_multi_distinct.q.out
index d6dbfa28ce..3f92d77aeb 100644
--- a/ql/src/test/results/clientpositive/groupby3_map_multi_distinct.q.out
+++ b/ql/src/test/results/clientpositive/groupby3_map_multi_distinct.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(c1 DOUBLE, c2 DOUBLE, c3 DOUBLE, c4 DOUBLE, c5 DOUBLE, c6 DOUBLE, c7 DOUBLE, c8 DOUBLE, c9 DOUBLE, c10 DOUBLE, c11 DOUBLE) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(c1 DOUBLE, c2 DOUBLE, c3 DOUBLE, c4 DOUBLE, c5 DOUBLE, c6 DOUBLE, c7 DOUBLE, c8 DOUBLE, c9 DOUBLE, c10 DOUBLE, c11 DOUBLE) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/groupby3_map_skew.q.out b/ql/src/test/results/clientpositive/groupby3_map_skew.q.out
index 9721c5fbfe..63cd5e12fd 100644
--- a/ql/src/test/results/clientpositive/groupby3_map_skew.q.out
+++ b/ql/src/test/results/clientpositive/groupby3_map_skew.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(c1 DOUBLE, c2 DOUBLE, c3 DOUBLE, c4 DOUBLE, c5 DOUBLE, c6 DOUBLE, c7 DOUBLE, c8 DOUBLE, c9 DOUBLE) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(c1 DOUBLE, c2 DOUBLE, c3 DOUBLE, c4 DOUBLE, c5 DOUBLE, c6 DOUBLE, c7 DOUBLE, c8 DOUBLE, c9 DOUBLE) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/groupby3_noskew.q.out b/ql/src/test/results/clientpositive/groupby3_noskew.q.out
index 063f021978..42f3d08909 100644
--- a/ql/src/test/results/clientpositive/groupby3_noskew.q.out
+++ b/ql/src/test/results/clientpositive/groupby3_noskew.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(c1 DOUBLE, c2 DOUBLE, c3 DOUBLE, c4 DOUBLE, c5 DOUBLE, c6 DOUBLE, c7 DOUBLE, c8 DOUBLE, c9 DOUBLE) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(c1 DOUBLE, c2 DOUBLE, c3 DOUBLE, c4 DOUBLE, c5 DOUBLE, c6 DOUBLE, c7 DOUBLE, c8 DOUBLE, c9 DOUBLE) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/groupby3_noskew_multi_distinct.q.out b/ql/src/test/results/clientpositive/groupby3_noskew_multi_distinct.q.out
index f5287d530f..21da81ec51 100644
--- a/ql/src/test/results/clientpositive/groupby3_noskew_multi_distinct.q.out
+++ b/ql/src/test/results/clientpositive/groupby3_noskew_multi_distinct.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(c1 DOUBLE, c2 DOUBLE, c3 DOUBLE, c4 DOUBLE, c5 DOUBLE, c6 DOUBLE, c7 DOUBLE, c8 DOUBLE, c9 DOUBLE, c10 DOUBLE, c11 DOUBLE) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(c1 DOUBLE, c2 DOUBLE, c3 DOUBLE, c4 DOUBLE, c5 DOUBLE, c6 DOUBLE, c7 DOUBLE, c8 DOUBLE, c9 DOUBLE, c10 DOUBLE, c11 DOUBLE) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/groupby4.q.out b/ql/src/test/results/clientpositive/groupby4.q.out
index 3fb8ee013a..b7733c9e63 100644
--- a/ql/src/test/results/clientpositive/groupby4.q.out
+++ b/ql/src/test/results/clientpositive/groupby4.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(c1 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(c1 STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/groupby4_map.q.out b/ql/src/test/results/clientpositive/groupby4_map.q.out
index 16170aeccb..711bbe00a6 100644
--- a/ql/src/test/results/clientpositive/groupby4_map.q.out
+++ b/ql/src/test/results/clientpositive/groupby4_map.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key INT) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key INT) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/groupby4_map_skew.q.out b/ql/src/test/results/clientpositive/groupby4_map_skew.q.out
index b45badce4f..3880a92d34 100644
--- a/ql/src/test/results/clientpositive/groupby4_map_skew.q.out
+++ b/ql/src/test/results/clientpositive/groupby4_map_skew.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key INT) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key INT) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/groupby4_noskew.q.out b/ql/src/test/results/clientpositive/groupby4_noskew.q.out
index d1959cd86f..5dc7ba9e01 100644
--- a/ql/src/test/results/clientpositive/groupby4_noskew.q.out
+++ b/ql/src/test/results/clientpositive/groupby4_noskew.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE dest1(c1 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE dest1(c1 STRING) STORED AS TEXTFILE
diff --git a/ql/src/test/results/clientpositive/groupby5.q.out b/ql/src/test/results/clientpositive/groupby5.q.out
index c26bea4dd7..2c74fa3a9f 100644
--- a/ql/src/test/results/clientpositive/groupby5.q.out
+++ b/ql/src/test/results/clientpositive/groupby5.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/groupby5_map.q.out b/ql/src/test/results/clientpositive/groupby5_map.q.out
index ddb06054d9..2d77b152d7 100644
--- a/ql/src/test/results/clientpositive/groupby5_map.q.out
+++ b/ql/src/test/results/clientpositive/groupby5_map.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key INT) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key INT) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/groupby5_map_skew.q.out b/ql/src/test/results/clientpositive/groupby5_map_skew.q.out
index 773b27e359..ec9308b63e 100644
--- a/ql/src/test/results/clientpositive/groupby5_map_skew.q.out
+++ b/ql/src/test/results/clientpositive/groupby5_map_skew.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key INT) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key INT) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/groupby5_noskew.q.out b/ql/src/test/results/clientpositive/groupby5_noskew.q.out
index 1992c8458c..7c437fff8a 100644
--- a/ql/src/test/results/clientpositive/groupby5_noskew.q.out
+++ b/ql/src/test/results/clientpositive/groupby5_noskew.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
diff --git a/ql/src/test/results/clientpositive/groupby6.q.out b/ql/src/test/results/clientpositive/groupby6.q.out
index c079777c2e..44a76e4241 100644
--- a/ql/src/test/results/clientpositive/groupby6.q.out
+++ b/ql/src/test/results/clientpositive/groupby6.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(c1 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(c1 STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/groupby6_map.q.out b/ql/src/test/results/clientpositive/groupby6_map.q.out
index 1cb77c6468..1b30a8d025 100644
--- a/ql/src/test/results/clientpositive/groupby6_map.q.out
+++ b/ql/src/test/results/clientpositive/groupby6_map.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE dest1(c1 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE dest1(c1 STRING) STORED AS TEXTFILE
diff --git a/ql/src/test/results/clientpositive/groupby6_map_skew.q.out b/ql/src/test/results/clientpositive/groupby6_map_skew.q.out
index df4dfa71ef..f2425a48c6 100644
--- a/ql/src/test/results/clientpositive/groupby6_map_skew.q.out
+++ b/ql/src/test/results/clientpositive/groupby6_map_skew.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE dest1(c1 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE dest1(c1 STRING) STORED AS TEXTFILE
diff --git a/ql/src/test/results/clientpositive/groupby6_noskew.q.out b/ql/src/test/results/clientpositive/groupby6_noskew.q.out
index 8452814128..324c4cf9ef 100644
--- a/ql/src/test/results/clientpositive/groupby6_noskew.q.out
+++ b/ql/src/test/results/clientpositive/groupby6_noskew.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE dest1(c1 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE dest1(c1 STRING) STORED AS TEXTFILE
diff --git a/ql/src/test/results/clientpositive/groupby7.q.out b/ql/src/test/results/clientpositive/groupby7.q.out
index db9d464746..ee0153a97b 100644
--- a/ql/src/test/results/clientpositive/groupby7.q.out
+++ b/ql/src/test/results/clientpositive/groupby7.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE DEST1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@DEST1
 POSTHOOK: query: CREATE TABLE DEST1(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@DEST1
 PREHOOK: query: CREATE TABLE DEST2(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@DEST2
 POSTHOOK: query: CREATE TABLE DEST2(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/groupby7_map.q.out b/ql/src/test/results/clientpositive/groupby7_map.q.out
index 79549fc814..89eb2ca1e5 100644
--- a/ql/src/test/results/clientpositive/groupby7_map.q.out
+++ b/ql/src/test/results/clientpositive/groupby7_map.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE DEST1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@DEST1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE DEST1(key INT, value STRING) STORED AS TEXTFILE
@@ -12,6 +13,7 @@ POSTHOOK: Output: default@DEST1
 PREHOOK: query: CREATE TABLE DEST2(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@DEST2
 POSTHOOK: query: CREATE TABLE DEST2(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/groupby7_map_multi_single_reducer.q.out b/ql/src/test/results/clientpositive/groupby7_map_multi_single_reducer.q.out
index 4dbdd0c135..79b7d29838 100644
--- a/ql/src/test/results/clientpositive/groupby7_map_multi_single_reducer.q.out
+++ b/ql/src/test/results/clientpositive/groupby7_map_multi_single_reducer.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE DEST1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@DEST1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE DEST1(key INT, value STRING) STORED AS TEXTFILE
@@ -12,6 +13,7 @@ POSTHOOK: Output: default@DEST1
 PREHOOK: query: CREATE TABLE DEST2(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@DEST2
 POSTHOOK: query: CREATE TABLE DEST2(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/groupby7_map_skew.q.out b/ql/src/test/results/clientpositive/groupby7_map_skew.q.out
index bb5c9118a8..12ba059856 100644
--- a/ql/src/test/results/clientpositive/groupby7_map_skew.q.out
+++ b/ql/src/test/results/clientpositive/groupby7_map_skew.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE DEST1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@DEST1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE DEST1(key INT, value STRING) STORED AS TEXTFILE
@@ -12,6 +13,7 @@ POSTHOOK: Output: default@DEST1
 PREHOOK: query: CREATE TABLE DEST2(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@DEST2
 POSTHOOK: query: CREATE TABLE DEST2(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/groupby7_noskew.q.out b/ql/src/test/results/clientpositive/groupby7_noskew.q.out
index a76ff2de1d..8ef7787da9 100644
--- a/ql/src/test/results/clientpositive/groupby7_noskew.q.out
+++ b/ql/src/test/results/clientpositive/groupby7_noskew.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE DEST1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@DEST1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE DEST1(key INT, value STRING) STORED AS TEXTFILE
@@ -12,6 +13,7 @@ POSTHOOK: Output: default@DEST1
 PREHOOK: query: CREATE TABLE DEST2(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@DEST2
 POSTHOOK: query: CREATE TABLE DEST2(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/groupby7_noskew_multi_single_reducer.q.out b/ql/src/test/results/clientpositive/groupby7_noskew_multi_single_reducer.q.out
index e2cac34f32..d9f4ff17a7 100644
--- a/ql/src/test/results/clientpositive/groupby7_noskew_multi_single_reducer.q.out
+++ b/ql/src/test/results/clientpositive/groupby7_noskew_multi_single_reducer.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE DEST1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@DEST1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE DEST1(key INT, value STRING) STORED AS TEXTFILE
@@ -12,6 +13,7 @@ POSTHOOK: Output: default@DEST1
 PREHOOK: query: CREATE TABLE DEST2(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@DEST2
 POSTHOOK: query: CREATE TABLE DEST2(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/groupby8.q.out b/ql/src/test/results/clientpositive/groupby8.q.out
index 98c3b9e912..7f5e226282 100644
--- a/ql/src/test/results/clientpositive/groupby8.q.out
+++ b/ql/src/test/results/clientpositive/groupby8.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE DEST1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@DEST1
 POSTHOOK: query: CREATE TABLE DEST1(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@DEST1
 PREHOOK: query: CREATE TABLE DEST2(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@DEST2
 POSTHOOK: query: CREATE TABLE DEST2(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/groupby8_map.q.out b/ql/src/test/results/clientpositive/groupby8_map.q.out
index d86a5ee409..0d922f75b0 100644
--- a/ql/src/test/results/clientpositive/groupby8_map.q.out
+++ b/ql/src/test/results/clientpositive/groupby8_map.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE DEST1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@DEST1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE DEST1(key INT, value STRING) STORED AS TEXTFILE
@@ -12,6 +13,7 @@ POSTHOOK: Output: default@DEST1
 PREHOOK: query: CREATE TABLE DEST2(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@DEST2
 POSTHOOK: query: CREATE TABLE DEST2(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/groupby8_map_skew.q.out b/ql/src/test/results/clientpositive/groupby8_map_skew.q.out
index d86a5ee409..0d922f75b0 100644
--- a/ql/src/test/results/clientpositive/groupby8_map_skew.q.out
+++ b/ql/src/test/results/clientpositive/groupby8_map_skew.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE DEST1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@DEST1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE DEST1(key INT, value STRING) STORED AS TEXTFILE
@@ -12,6 +13,7 @@ POSTHOOK: Output: default@DEST1
 PREHOOK: query: CREATE TABLE DEST2(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@DEST2
 POSTHOOK: query: CREATE TABLE DEST2(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/groupby8_noskew.q.out b/ql/src/test/results/clientpositive/groupby8_noskew.q.out
index d86a5ee409..0d922f75b0 100644
--- a/ql/src/test/results/clientpositive/groupby8_noskew.q.out
+++ b/ql/src/test/results/clientpositive/groupby8_noskew.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE DEST1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@DEST1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE DEST1(key INT, value STRING) STORED AS TEXTFILE
@@ -12,6 +13,7 @@ POSTHOOK: Output: default@DEST1
 PREHOOK: query: CREATE TABLE DEST2(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@DEST2
 POSTHOOK: query: CREATE TABLE DEST2(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/groupby9.q.out b/ql/src/test/results/clientpositive/groupby9.q.out
index 0da8f01c56..dd34d25819 100644
--- a/ql/src/test/results/clientpositive/groupby9.q.out
+++ b/ql/src/test/results/clientpositive/groupby9.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE DEST1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@DEST1
 POSTHOOK: query: CREATE TABLE DEST1(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@DEST1
 PREHOOK: query: CREATE TABLE DEST2(key INT, val1 STRING, val2 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@DEST2
 POSTHOOK: query: CREATE TABLE DEST2(key INT, val1 STRING, val2 STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/groupby_complex_types.q.out b/ql/src/test/results/clientpositive/groupby_complex_types.q.out
index c4163018f1..25cf1a17fb 100644
--- a/ql/src/test/results/clientpositive/groupby_complex_types.q.out
+++ b/ql/src/test/results/clientpositive/groupby_complex_types.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE DEST1(key ARRAY<STRING>, value BIGINT) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@DEST1
 POSTHOOK: query: CREATE TABLE DEST1(key ARRAY<STRING>, value BIGINT) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@DEST1
 PREHOOK: query: CREATE TABLE DEST2(key MAP<STRING, STRING>, value BIGINT) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@DEST2
 POSTHOOK: query: CREATE TABLE DEST2(key MAP<STRING, STRING>, value BIGINT) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -15,6 +17,7 @@ POSTHOOK: Output: default@DEST2
 PREHOOK: query: CREATE TABLE DEST3(key STRUCT<col1:STRING, col2:STRING>, value BIGINT) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@DEST3
 POSTHOOK: query: CREATE TABLE DEST3(key STRUCT<col1:STRING, col2:STRING>, value BIGINT) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/groupby_complex_types_multi_single_reducer.q.out b/ql/src/test/results/clientpositive/groupby_complex_types_multi_single_reducer.q.out
index 719c83da84..b803f31ea6 100644
--- a/ql/src/test/results/clientpositive/groupby_complex_types_multi_single_reducer.q.out
+++ b/ql/src/test/results/clientpositive/groupby_complex_types_multi_single_reducer.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE DEST1(key ARRAY<STRING>, value BIGINT) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@DEST1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE DEST1(key ARRAY<STRING>, value BIGINT) STORED AS TEXTFILE
@@ -12,6 +13,7 @@ POSTHOOK: Output: default@DEST1
 PREHOOK: query: CREATE TABLE DEST2(key MAP<STRING, STRING>, value BIGINT) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@DEST2
 POSTHOOK: query: CREATE TABLE DEST2(key MAP<STRING, STRING>, value BIGINT) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/groupby_cube1.q.out b/ql/src/test/results/clientpositive/groupby_cube1.q.out
index f8030a3abc..4246744abe 100644
--- a/ql/src/test/results/clientpositive/groupby_cube1.q.out
+++ b/ql/src/test/results/clientpositive/groupby_cube1.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE T1(key STRING, val STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE T1(key STRING, val STRING) STORED AS TEXTFILE
@@ -355,6 +356,7 @@ NULL	6
 PREHOOK: query: CREATE TABLE T2(key1 STRING, key2 STRING, val INT) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T2
 POSTHOOK: query: CREATE TABLE T2(key1 STRING, key2 STRING, val INT) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -362,6 +364,7 @@ POSTHOOK: Output: default@T2
 PREHOOK: query: CREATE TABLE T3(key1 STRING, key2 STRING, val INT) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T3
 POSTHOOK: query: CREATE TABLE T3(key1 STRING, key2 STRING, val INT) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/groupby_distinct_samekey.q.out b/ql/src/test/results/clientpositive/groupby_distinct_samekey.q.out
index 3dc4e456b6..3871381339 100644
--- a/ql/src/test/results/clientpositive/groupby_distinct_samekey.q.out
+++ b/ql/src/test/results/clientpositive/groupby_distinct_samekey.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- This test covers HIVE-2332
 create table t1 (int1 int, int2 int, str1 string, str2 string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t1
 POSTHOOK: query: -- This test covers HIVE-2332
 
 create table t1 (int1 int, int2 int, str1 string, str2 string)
diff --git a/ql/src/test/results/clientpositive/groupby_grouping_id1.q.out b/ql/src/test/results/clientpositive/groupby_grouping_id1.q.out
index 0f6123e96e..136edebc77 100644
--- a/ql/src/test/results/clientpositive/groupby_grouping_id1.q.out
+++ b/ql/src/test/results/clientpositive/groupby_grouping_id1.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE T1(key STRING, val STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: CREATE TABLE T1(key STRING, val STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/groupby_grouping_id2.q.out b/ql/src/test/results/clientpositive/groupby_grouping_id2.q.out
index 80d6c29e7d..4a0a9d2359 100644
--- a/ql/src/test/results/clientpositive/groupby_grouping_id2.q.out
+++ b/ql/src/test/results/clientpositive/groupby_grouping_id2.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE T1(key INT, value INT) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: CREATE TABLE T1(key INT, value INT) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/groupby_grouping_sets1.q.out b/ql/src/test/results/clientpositive/groupby_grouping_sets1.q.out
index 0665eb4944..5b70906a51 100644
--- a/ql/src/test/results/clientpositive/groupby_grouping_sets1.q.out
+++ b/ql/src/test/results/clientpositive/groupby_grouping_sets1.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE T1(a STRING, b STRING, c STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY ' ' STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: CREATE TABLE T1(a STRING, b STRING, c STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY ' ' STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/groupby_grouping_sets2.q.out b/ql/src/test/results/clientpositive/groupby_grouping_sets2.q.out
index b55494a057..1cd65f6285 100644
--- a/ql/src/test/results/clientpositive/groupby_grouping_sets2.q.out
+++ b/ql/src/test/results/clientpositive/groupby_grouping_sets2.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE T1(a STRING, b STRING, c STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY ' ' STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: CREATE TABLE T1(a STRING, b STRING, c STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY ' ' STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -230,6 +231,7 @@ NULL	3	5.0
 PREHOOK: query: CREATE TABLE T2(a STRING, b STRING, c int, d int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T2
 POSTHOOK: query: CREATE TABLE T2(a STRING, b STRING, c int, d int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/groupby_grouping_sets3.q.out b/ql/src/test/results/clientpositive/groupby_grouping_sets3.q.out
index b782aa88bd..f1ecbb43a5 100644
--- a/ql/src/test/results/clientpositive/groupby_grouping_sets3.q.out
+++ b/ql/src/test/results/clientpositive/groupby_grouping_sets3.q.out
@@ -5,6 +5,7 @@ PREHOOK: query: -- In this test, 2 files are loaded into table T1. The data cont
 CREATE TABLE T1(a STRING, b STRING, c STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY ' ' STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: -- In this test, 2 files are loaded into table T1. The data contains rows with the same value of a and b,
 -- with different number of rows for a and b in each file. Since bucketizedHiveInputFormat is used, 
 -- this tests that the aggregate function stores the partial aggregate state correctly even if an 
diff --git a/ql/src/test/results/clientpositive/groupby_grouping_sets4.q.out b/ql/src/test/results/clientpositive/groupby_grouping_sets4.q.out
index 6f9f10b6ec..c545506a22 100644
--- a/ql/src/test/results/clientpositive/groupby_grouping_sets4.q.out
+++ b/ql/src/test/results/clientpositive/groupby_grouping_sets4.q.out
@@ -5,6 +5,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE T1(a STRING, b STRING, c STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY ' ' STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 -- Set merging to false above to make the explain more readable
diff --git a/ql/src/test/results/clientpositive/groupby_grouping_sets5.q.out b/ql/src/test/results/clientpositive/groupby_grouping_sets5.q.out
index 8a08823889..ce229d38fb 100644
--- a/ql/src/test/results/clientpositive/groupby_grouping_sets5.q.out
+++ b/ql/src/test/results/clientpositive/groupby_grouping_sets5.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- Set merging to false above to make the explain more readable
 CREATE TABLE T1(a STRING, b STRING, c STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY ' ' STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: -- Set merging to false above to make the explain more readable
 
 CREATE TABLE T1(a STRING, b STRING, c STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY ' ' STORED AS TEXTFILE
diff --git a/ql/src/test/results/clientpositive/groupby_map_ppr.q.out b/ql/src/test/results/clientpositive/groupby_map_ppr.q.out
index 0eaf71e402..c9a5b37f82 100644
--- a/ql/src/test/results/clientpositive/groupby_map_ppr.q.out
+++ b/ql/src/test/results/clientpositive/groupby_map_ppr.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE dest1(key STRING, c1 INT, c2 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE dest1(key STRING, c1 INT, c2 STRING) STORED AS TEXTFILE
diff --git a/ql/src/test/results/clientpositive/groupby_map_ppr_multi_distinct.q.out b/ql/src/test/results/clientpositive/groupby_map_ppr_multi_distinct.q.out
index a9681c2178..fa2cb0c0b2 100644
--- a/ql/src/test/results/clientpositive/groupby_map_ppr_multi_distinct.q.out
+++ b/ql/src/test/results/clientpositive/groupby_map_ppr_multi_distinct.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE dest1(key STRING, c1 INT, c2 STRING, C3 INT, c4 INT) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE dest1(key STRING, c1 INT, c2 STRING, C3 INT, c4 INT) STORED AS TEXTFILE
diff --git a/ql/src/test/results/clientpositive/groupby_multi_insert_common_distinct.q.out b/ql/src/test/results/clientpositive/groupby_multi_insert_common_distinct.q.out
index 8bec9303af..bd261ab45d 100644
--- a/ql/src/test/results/clientpositive/groupby_multi_insert_common_distinct.q.out
+++ b/ql/src/test/results/clientpositive/groupby_multi_insert_common_distinct.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 create table dest1(key int, cnt int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 create table dest1(key int, cnt int)
@@ -12,6 +13,7 @@ POSTHOOK: Output: default@dest1
 PREHOOK: query: create table dest2(key int, cnt int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest2
 POSTHOOK: query: create table dest2(key int, cnt int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/groupby_multi_single_reducer.q.out b/ql/src/test/results/clientpositive/groupby_multi_single_reducer.q.out
index c53a0647c1..d8aa5ed6af 100644
--- a/ql/src/test/results/clientpositive/groupby_multi_single_reducer.q.out
+++ b/ql/src/test/results/clientpositive/groupby_multi_single_reducer.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE dest_g2(key STRING, c1 INT, c2 STRING, c3 INT, c4 INT) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_g2
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE dest_g2(key STRING, c1 INT, c2 STRING, c3 INT, c4 INT) STORED AS TEXTFILE
@@ -12,6 +13,7 @@ POSTHOOK: Output: default@dest_g2
 PREHOOK: query: CREATE TABLE dest_g3(key STRING, c1 INT, c2 STRING, c3 INT, c4 INT) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_g3
 POSTHOOK: query: CREATE TABLE dest_g3(key STRING, c1 INT, c2 STRING, c3 INT, c4 INT) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -19,6 +21,7 @@ POSTHOOK: Output: default@dest_g3
 PREHOOK: query: CREATE TABLE dest_g4(key STRING, c1 INT, c2 STRING, c3 INT, c4 INT) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_g4
 POSTHOOK: query: CREATE TABLE dest_g4(key STRING, c1 INT, c2 STRING, c3 INT, c4 INT) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -26,6 +29,7 @@ POSTHOOK: Output: default@dest_g4
 PREHOOK: query: CREATE TABLE dest_h2(key STRING, c1 INT, c2 STRING, c3 INT, c4 INT) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_h2
 POSTHOOK: query: CREATE TABLE dest_h2(key STRING, c1 INT, c2 STRING, c3 INT, c4 INT) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -33,6 +37,7 @@ POSTHOOK: Output: default@dest_h2
 PREHOOK: query: CREATE TABLE dest_h3(key STRING, c1 INT, c2 STRING, c3 INT, c4 INT) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_h3
 POSTHOOK: query: CREATE TABLE dest_h3(key STRING, c1 INT, c2 STRING, c3 INT, c4 INT) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/groupby_multi_single_reducer2.q.out b/ql/src/test/results/clientpositive/groupby_multi_single_reducer2.q.out
index 2a788fb248..1739a78fff 100644
--- a/ql/src/test/results/clientpositive/groupby_multi_single_reducer2.q.out
+++ b/ql/src/test/results/clientpositive/groupby_multi_single_reducer2.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest_g2(key STRING, c1 INT) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_g2
 POSTHOOK: query: CREATE TABLE dest_g2(key STRING, c1 INT) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@dest_g2
 PREHOOK: query: CREATE TABLE dest_g3(key STRING, c1 INT, c2 INT) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_g3
 POSTHOOK: query: CREATE TABLE dest_g3(key STRING, c1 INT, c2 INT) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/groupby_multi_single_reducer3.q.out b/ql/src/test/results/clientpositive/groupby_multi_single_reducer3.q.out
index e9302376e9..2c70254439 100644
--- a/ql/src/test/results/clientpositive/groupby_multi_single_reducer3.q.out
+++ b/ql/src/test/results/clientpositive/groupby_multi_single_reducer3.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- HIVE-3849 Aliased column in where clause for multi-groupby si
 create table e1 (key string, count int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@e1
 POSTHOOK: query: -- HIVE-3849 Aliased column in where clause for multi-groupby single reducer cannot be resolved
 create table e1 (key string, count int)
 POSTHOOK: type: CREATETABLE
@@ -10,6 +11,7 @@ POSTHOOK: Output: default@e1
 PREHOOK: query: create table e2 (key string, count int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@e2
 POSTHOOK: query: create table e2 (key string, count int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/groupby_position.q.out b/ql/src/test/results/clientpositive/groupby_position.q.out
index 07e9641830..96104aa4d1 100644
--- a/ql/src/test/results/clientpositive/groupby_position.q.out
+++ b/ql/src/test/results/clientpositive/groupby_position.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE testTable1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@testTable1
 POSTHOOK: query: CREATE TABLE testTable1(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@testTable1
 PREHOOK: query: CREATE TABLE testTable2(key INT, val1 STRING, val2 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@testTable2
 POSTHOOK: query: CREATE TABLE testTable2(key INT, val1 STRING, val2 STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/groupby_ppd.q.out b/ql/src/test/results/clientpositive/groupby_ppd.q.out
index 6ac83cfd19..a086527199 100644
--- a/ql/src/test/results/clientpositive/groupby_ppd.q.out
+++ b/ql/src/test/results/clientpositive/groupby_ppd.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- see HIVE-2382
 create table invites (id int, foo int, bar int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@invites
 POSTHOOK: query: -- see HIVE-2382
 create table invites (id int, foo int, bar int)
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/groupby_ppr.q.out b/ql/src/test/results/clientpositive/groupby_ppr.q.out
index b97886b03d..9c072c7a20 100644
--- a/ql/src/test/results/clientpositive/groupby_ppr.q.out
+++ b/ql/src/test/results/clientpositive/groupby_ppr.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key STRING, c1 INT, c2 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key STRING, c1 INT, c2 STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/groupby_ppr_multi_distinct.q.out b/ql/src/test/results/clientpositive/groupby_ppr_multi_distinct.q.out
index fe2d7dde16..0ddb9341ea 100644
--- a/ql/src/test/results/clientpositive/groupby_ppr_multi_distinct.q.out
+++ b/ql/src/test/results/clientpositive/groupby_ppr_multi_distinct.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key STRING, c1 INT, c2 STRING, c3 INT, c4 INT) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key STRING, c1 INT, c2 STRING, c3 INT, c4 INT) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/groupby_rollup1.q.out b/ql/src/test/results/clientpositive/groupby_rollup1.q.out
index 36fce4aefb..5db5cd5496 100644
--- a/ql/src/test/results/clientpositive/groupby_rollup1.q.out
+++ b/ql/src/test/results/clientpositive/groupby_rollup1.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE T1(key STRING, val STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE T1(key STRING, val STRING) STORED AS TEXTFILE
@@ -343,6 +344,7 @@ NULL	6
 PREHOOK: query: CREATE TABLE T2(key1 STRING, key2 STRING, val INT) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T2
 POSTHOOK: query: CREATE TABLE T2(key1 STRING, key2 STRING, val INT) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -350,6 +352,7 @@ POSTHOOK: Output: default@T2
 PREHOOK: query: CREATE TABLE T3(key1 STRING, key2 STRING, val INT) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T3
 POSTHOOK: query: CREATE TABLE T3(key1 STRING, key2 STRING, val INT) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/groupby_sort_10.q.out b/ql/src/test/results/clientpositive/groupby_sort_10.q.out
index 7e88029263..6a2f91e664 100644
--- a/ql/src/test/results/clientpositive/groupby_sort_10.q.out
+++ b/ql/src/test/results/clientpositive/groupby_sort_10.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: CREATE TABLE T1(key STRING, val STRING) PARTITIONED BY (ds strin
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: CREATE TABLE T1(key STRING, val STRING) PARTITIONED BY (ds string)
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/groupby_sort_11.q.out b/ql/src/test/results/clientpositive/groupby_sort_11.q.out
index 5aa7d8d702..311815ab99 100644
--- a/ql/src/test/results/clientpositive/groupby_sort_11.q.out
+++ b/ql/src/test/results/clientpositive/groupby_sort_11.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: CREATE TABLE T1(key STRING, val STRING) PARTITIONED BY (ds strin
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: CREATE TABLE T1(key STRING, val STRING) PARTITIONED BY (ds string)
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/groupby_sort_1_23.q.out b/ql/src/test/results/clientpositive/groupby_sort_1_23.q.out
index b963527d04..a74cb2b6b1 100644
--- a/ql/src/test/results/clientpositive/groupby_sort_1_23.q.out
+++ b/ql/src/test/results/clientpositive/groupby_sort_1_23.q.out
@@ -5,6 +5,7 @@ CREATE TABLE T1(key STRING, val STRING)
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: -- EXCLUDE_HADOOP_MAJOR_VERSIONS(0.20,0.20S)
 -- SORT_QUERY_RESULTS
 
@@ -36,6 +37,7 @@ POSTHOOK: Lineage: t1.val SIMPLE [(t1)t1.FieldSchema(name:val, type:string, comm
 PREHOOK: query: CREATE TABLE outputTbl1(key int, cnt int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@outputTbl1
 POSTHOOK: query: CREATE TABLE outputTbl1(key int, cnt int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -396,6 +398,7 @@ POSTHOOK: Input: default@outputtbl1
 PREHOOK: query: CREATE TABLE outputTbl2(key1 int, key2 string, cnt int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@outputTbl2
 POSTHOOK: query: CREATE TABLE outputTbl2(key1 int, key2 string, cnt int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -1433,6 +1436,7 @@ POSTHOOK: Input: default@outputtbl1
 PREHOOK: query: CREATE TABLE outputTbl3(key1 int, key2 int, cnt int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@outputTbl3
 POSTHOOK: query: CREATE TABLE outputTbl3(key1 int, key2 int, cnt int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -1797,6 +1801,7 @@ POSTHOOK: Input: default@outputtbl3
 PREHOOK: query: CREATE TABLE outputTbl4(key1 int, key2 int, key3 string, cnt int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@outputTbl4
 POSTHOOK: query: CREATE TABLE outputTbl4(key1 int, key2 int, key3 string, cnt int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -4353,6 +4358,7 @@ PREHOOK: query: CREATE TABLE T2(key STRING, val STRING)
 CLUSTERED BY (key, val) SORTED BY (key, val) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T2
 POSTHOOK: query: CREATE TABLE T2(key STRING, val STRING)
 CLUSTERED BY (key, val) SORTED BY (key, val) INTO 2 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
@@ -4997,6 +5003,7 @@ POSTHOOK: Input: default@outputtbl4
 PREHOOK: query: CREATE TABLE outputTbl5(key1 int, key2 int, key3 string, key4 int, cnt int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@outputTbl5
 POSTHOOK: query: CREATE TABLE outputTbl5(key1 int, key2 int, key3 string, key4 int, cnt int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -6268,6 +6275,7 @@ POSTHOOK: Input: default@outputtbl4
 PREHOOK: query: CREATE TABLE DEST1(key INT, cnt INT)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@DEST1
 POSTHOOK: query: CREATE TABLE DEST1(key INT, cnt INT)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -6275,6 +6283,7 @@ POSTHOOK: Output: default@DEST1
 PREHOOK: query: CREATE TABLE DEST2(key INT, val STRING, cnt INT)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@DEST2
 POSTHOOK: query: CREATE TABLE DEST2(key INT, val STRING, cnt INT)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/groupby_sort_2.q.out b/ql/src/test/results/clientpositive/groupby_sort_2.q.out
index c21b12e0bf..d665ee318b 100644
--- a/ql/src/test/results/clientpositive/groupby_sort_2.q.out
+++ b/ql/src/test/results/clientpositive/groupby_sort_2.q.out
@@ -4,6 +4,7 @@ CREATE TABLE T1(key STRING, val STRING)
 CLUSTERED BY (key) SORTED BY (val) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE T1(key STRING, val STRING)
@@ -34,6 +35,7 @@ POSTHOOK: Lineage: t1.val SIMPLE [(t1)t1.FieldSchema(name:val, type:string, comm
 PREHOOK: query: CREATE TABLE outputTbl1(val string, cnt int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@outputTbl1
 POSTHOOK: query: CREATE TABLE outputTbl1(val string, cnt int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/groupby_sort_3.q.out b/ql/src/test/results/clientpositive/groupby_sort_3.q.out
index 38a06d4328..d682913419 100644
--- a/ql/src/test/results/clientpositive/groupby_sort_3.q.out
+++ b/ql/src/test/results/clientpositive/groupby_sort_3.q.out
@@ -4,6 +4,7 @@ CREATE TABLE T1(key STRING, val STRING)
 CLUSTERED BY (key) SORTED BY (key, val) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE T1(key STRING, val STRING)
@@ -34,6 +35,7 @@ POSTHOOK: Lineage: t1.val SIMPLE [(t1)t1.FieldSchema(name:val, type:string, comm
 PREHOOK: query: CREATE TABLE outputTbl1(key string, val string, cnt int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@outputTbl1
 POSTHOOK: query: CREATE TABLE outputTbl1(key string, val string, cnt int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -170,6 +172,7 @@ POSTHOOK: Input: default@outputtbl1
 PREHOOK: query: CREATE TABLE outputTbl2(key string, cnt int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@outputTbl2
 POSTHOOK: query: CREATE TABLE outputTbl2(key string, cnt int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/groupby_sort_4.q.out b/ql/src/test/results/clientpositive/groupby_sort_4.q.out
index ccaa2bc044..c0f7f60e13 100644
--- a/ql/src/test/results/clientpositive/groupby_sort_4.q.out
+++ b/ql/src/test/results/clientpositive/groupby_sort_4.q.out
@@ -4,6 +4,7 @@ CREATE TABLE T1(key STRING, val STRING)
 CLUSTERED BY (key, val) SORTED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE T1(key STRING, val STRING)
@@ -34,6 +35,7 @@ POSTHOOK: Lineage: t1.val SIMPLE [(t1)t1.FieldSchema(name:val, type:string, comm
 PREHOOK: query: CREATE TABLE outputTbl1(key STRING, cnt INT)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@outputTbl1
 POSTHOOK: query: CREATE TABLE outputTbl1(key STRING, cnt INT)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -140,6 +142,7 @@ POSTHOOK: Input: default@outputtbl1
 PREHOOK: query: CREATE TABLE outputTbl2(key STRING, val STRING, cnt INT)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@outputTbl2
 POSTHOOK: query: CREATE TABLE outputTbl2(key STRING, val STRING, cnt INT)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/groupby_sort_5.q.out b/ql/src/test/results/clientpositive/groupby_sort_5.q.out
index 0e81a09a07..abadeb6f3b 100644
--- a/ql/src/test/results/clientpositive/groupby_sort_5.q.out
+++ b/ql/src/test/results/clientpositive/groupby_sort_5.q.out
@@ -4,6 +4,7 @@ CREATE TABLE T1(key STRING, val STRING)
 CLUSTERED BY (val) SORTED BY (key, val) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE T1(key STRING, val STRING)
@@ -34,6 +35,7 @@ POSTHOOK: Lineage: t1.val SIMPLE [(t1)t1.FieldSchema(name:val, type:string, comm
 PREHOOK: query: CREATE TABLE outputTbl1(key STRING, val STRING, cnt INT)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@outputTbl1
 POSTHOOK: query: CREATE TABLE outputTbl1(key STRING, val STRING, cnt INT)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -183,6 +185,7 @@ PREHOOK: query: CREATE TABLE T1(key STRING, val STRING)
 CLUSTERED BY (val, key) SORTED BY (key, val) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: CREATE TABLE T1(key STRING, val STRING)
 CLUSTERED BY (val, key) SORTED BY (key, val) INTO 2 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
@@ -353,6 +356,7 @@ PREHOOK: query: CREATE TABLE T1(key STRING, val STRING)
 CLUSTERED BY (val) SORTED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: CREATE TABLE T1(key STRING, val STRING)
 CLUSTERED BY (val) SORTED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
@@ -381,6 +385,7 @@ POSTHOOK: Lineage: t1.val SIMPLE [(t1)t1.FieldSchema(name:val, type:string, comm
 PREHOOK: query: CREATE TABLE outputTbl2(key STRING, cnt INT)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@outputTbl2
 POSTHOOK: query: CREATE TABLE outputTbl2(key STRING, cnt INT)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/groupby_sort_6.q.out b/ql/src/test/results/clientpositive/groupby_sort_6.q.out
index a18a3c1a16..cd1f979f15 100644
--- a/ql/src/test/results/clientpositive/groupby_sort_6.q.out
+++ b/ql/src/test/results/clientpositive/groupby_sort_6.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE T1(key STRING, val STRING) PARTITIONED BY (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE T1(key STRING, val STRING) PARTITIONED BY (ds string)
@@ -12,6 +13,7 @@ POSTHOOK: Output: default@T1
 PREHOOK: query: CREATE TABLE outputTbl1(key int, cnt int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@outputTbl1
 POSTHOOK: query: CREATE TABLE outputTbl1(key int, cnt int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/groupby_sort_7.q.out b/ql/src/test/results/clientpositive/groupby_sort_7.q.out
index 3160ee0847..aab1cbea79 100644
--- a/ql/src/test/results/clientpositive/groupby_sort_7.q.out
+++ b/ql/src/test/results/clientpositive/groupby_sort_7.q.out
@@ -4,6 +4,7 @@ CREATE TABLE T1(key STRING, val STRING) PARTITIONED BY (ds string)
 CLUSTERED BY (val) SORTED BY (key, val) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE T1(key STRING, val STRING) PARTITIONED BY (ds string)
@@ -37,6 +38,7 @@ POSTHOOK: Lineage: t1 PARTITION(ds=1).val SIMPLE [(t1)t1.FieldSchema(name:val, t
 PREHOOK: query: CREATE TABLE outputTbl1(key STRING, val STRING, cnt INT)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@outputTbl1
 POSTHOOK: query: CREATE TABLE outputTbl1(key STRING, val STRING, cnt INT)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/groupby_sort_8.q.out b/ql/src/test/results/clientpositive/groupby_sort_8.q.out
index a715786db6..e70abebdfa 100644
--- a/ql/src/test/results/clientpositive/groupby_sort_8.q.out
+++ b/ql/src/test/results/clientpositive/groupby_sort_8.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: CREATE TABLE T1(key STRING, val STRING) PARTITIONED BY (ds strin
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: CREATE TABLE T1(key STRING, val STRING) PARTITIONED BY (ds string)
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/groupby_sort_9.q.out b/ql/src/test/results/clientpositive/groupby_sort_9.q.out
index a96087f08f..0969c8decb 100644
--- a/ql/src/test/results/clientpositive/groupby_sort_9.q.out
+++ b/ql/src/test/results/clientpositive/groupby_sort_9.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: CREATE TABLE T1(key STRING, val STRING) PARTITIONED BY (ds strin
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: CREATE TABLE T1(key STRING, val STRING) PARTITIONED BY (ds string)
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/groupby_sort_skew_1_23.q.out b/ql/src/test/results/clientpositive/groupby_sort_skew_1_23.q.out
index fc4cdcc227..df9d51e68b 100644
--- a/ql/src/test/results/clientpositive/groupby_sort_skew_1_23.q.out
+++ b/ql/src/test/results/clientpositive/groupby_sort_skew_1_23.q.out
@@ -5,6 +5,7 @@ CREATE TABLE T1(key STRING, val STRING)
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: -- EXCLUDE_HADOOP_MAJOR_VERSIONS(0.20,0.20S)
 -- SORT_QUERY_RESULTS
 
@@ -36,6 +37,7 @@ POSTHOOK: Lineage: t1.val SIMPLE [(t1)t1.FieldSchema(name:val, type:string, comm
 PREHOOK: query: CREATE TABLE outputTbl1(key int, cnt int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@outputTbl1
 POSTHOOK: query: CREATE TABLE outputTbl1(key int, cnt int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -396,6 +398,7 @@ POSTHOOK: Input: default@outputtbl1
 PREHOOK: query: CREATE TABLE outputTbl2(key1 int, key2 string, cnt int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@outputTbl2
 POSTHOOK: query: CREATE TABLE outputTbl2(key1 int, key2 string, cnt int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -1498,6 +1501,7 @@ POSTHOOK: Input: default@outputtbl1
 PREHOOK: query: CREATE TABLE outputTbl3(key1 int, key2 int, cnt int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@outputTbl3
 POSTHOOK: query: CREATE TABLE outputTbl3(key1 int, key2 int, cnt int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -1862,6 +1866,7 @@ POSTHOOK: Input: default@outputtbl3
 PREHOOK: query: CREATE TABLE outputTbl4(key1 int, key2 int, key3 string, cnt int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@outputTbl4
 POSTHOOK: query: CREATE TABLE outputTbl4(key1 int, key2 int, key3 string, cnt int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -4743,6 +4748,7 @@ PREHOOK: query: CREATE TABLE T2(key STRING, val STRING)
 CLUSTERED BY (key, val) SORTED BY (key, val) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T2
 POSTHOOK: query: CREATE TABLE T2(key STRING, val STRING)
 CLUSTERED BY (key, val) SORTED BY (key, val) INTO 2 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
@@ -5452,6 +5458,7 @@ POSTHOOK: Input: default@outputtbl4
 PREHOOK: query: CREATE TABLE outputTbl5(key1 int, key2 int, key3 string, key4 int, cnt int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@outputTbl5
 POSTHOOK: query: CREATE TABLE outputTbl5(key1 int, key2 int, key3 string, key4 int, cnt int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -6723,6 +6730,7 @@ POSTHOOK: Input: default@outputtbl4
 PREHOOK: query: CREATE TABLE DEST1(key INT, cnt INT)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@DEST1
 POSTHOOK: query: CREATE TABLE DEST1(key INT, cnt INT)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -6730,6 +6738,7 @@ POSTHOOK: Output: default@DEST1
 PREHOOK: query: CREATE TABLE DEST2(key INT, val STRING, cnt INT)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@DEST2
 POSTHOOK: query: CREATE TABLE DEST2(key INT, val STRING, cnt INT)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/groupby_sort_test_1.q.out b/ql/src/test/results/clientpositive/groupby_sort_test_1.q.out
index d148fe0505..9e27aaaf8c 100644
--- a/ql/src/test/results/clientpositive/groupby_sort_test_1.q.out
+++ b/ql/src/test/results/clientpositive/groupby_sort_test_1.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: CREATE TABLE T1(key STRING, val STRING)
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: CREATE TABLE T1(key STRING, val STRING)
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
@@ -30,6 +31,7 @@ POSTHOOK: Lineage: t1.val SIMPLE [(t1)t1.FieldSchema(name:val, type:string, comm
 PREHOOK: query: CREATE TABLE outputTbl1(key int, cnt int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@outputTbl1
 POSTHOOK: query: CREATE TABLE outputTbl1(key int, cnt int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/having2.q.out b/ql/src/test/results/clientpositive/having2.q.out
index 8d7507b564..7a22550796 100644
--- a/ql/src/test/results/clientpositive/having2.q.out
+++ b/ql/src/test/results/clientpositive/having2.q.out
@@ -52,6 +52,7 @@ PREHOOK: query: CREATE TABLE TestV1_Staples (
       )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@TestV1_Staples
 POSTHOOK: query: CREATE TABLE TestV1_Staples (
       Item_Count INT,
       Ship_Priority STRING,
diff --git a/ql/src/test/results/clientpositive/hook_context_cs.q.out b/ql/src/test/results/clientpositive/hook_context_cs.q.out
index c3f335bbe7..bbaaa65c6c 100644
--- a/ql/src/test/results/clientpositive/hook_context_cs.q.out
+++ b/ql/src/test/results/clientpositive/hook_context_cs.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: CREATE TABLE vcsc (c STRING) PARTITIONED BY (ds STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@vcsc
 POSTHOOK: query: CREATE TABLE vcsc (c STRING) PARTITIONED BY (ds STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/implicit_cast1.q.out b/ql/src/test/results/clientpositive/implicit_cast1.q.out
index 445fdfe2a0..d4bcd64297 100644
--- a/ql/src/test/results/clientpositive/implicit_cast1.q.out
+++ b/ql/src/test/results/clientpositive/implicit_cast1.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE implicit_test1(a BIGINT, b STRING) ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.dynamic_type.DynamicSerDe' WITH SERDEPROPERTIES('serialization.format'= 'org.apache.hadoop.hive.serde2.thrift.TCTLSeparatedProtocol') STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@implicit_test1
 POSTHOOK: query: CREATE TABLE implicit_test1(a BIGINT, b STRING) ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.dynamic_type.DynamicSerDe' WITH SERDEPROPERTIES('serialization.format'= 'org.apache.hadoop.hive.serde2.thrift.TCTLSeparatedProtocol') STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/index_auth.q.out b/ql/src/test/results/clientpositive/index_auth.q.out
index f2289e87e8..385b639f92 100644
--- a/ql/src/test/results/clientpositive/index_auth.q.out
+++ b/ql/src/test/results/clientpositive/index_auth.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table foobar(key int, value string) PARTITIONED BY (ds string, hr string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@foobar
 POSTHOOK: query: create table foobar(key int, value string) PARTITIONED BY (ds string, hr string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -14,8 +15,10 @@ POSTHOOK: Output: default@foobar
 POSTHOOK: Output: default@foobar@ds=2008-04-08/hr=12
 PREHOOK: query: CREATE INDEX srcpart_AUTH_index ON TABLE foobar(key) as 'BITMAP' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@foobar
 POSTHOOK: query: CREATE INDEX srcpart_AUTH_index ON TABLE foobar(key) as 'BITMAP' WITH DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@foobar
 POSTHOOK: Output: default@default__foobar_srcpart_auth_index__
 PREHOOK: query: SHOW INDEXES ON foobar
 PREHOOK: type: SHOWINDEXES
@@ -62,8 +65,10 @@ POSTHOOK: Lineage: default__foobar_srcpart_auth_index__ PARTITION(ds=2008-04-08,
 POSTHOOK: Lineage: default__foobar_srcpart_auth_index__ PARTITION(ds=2008-04-08,hr=12).key SIMPLE [(foobar)foobar.FieldSchema(name:key, type:int, comment:null), ]
 PREHOOK: query: DROP INDEX srcpart_auth_index on foobar
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@foobar
 POSTHOOK: query: DROP INDEX srcpart_auth_index on foobar
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@foobar
 PREHOOK: query: DROP TABLE foobar
 PREHOOK: type: DROPTABLE
 PREHOOK: Input: default@foobar
diff --git a/ql/src/test/results/clientpositive/index_auto.q.out b/ql/src/test/results/clientpositive/index_auto.q.out
index 34077dca53..3a04fa75e9 100644
--- a/ql/src/test/results/clientpositive/index_auto.q.out
+++ b/ql/src/test/results/clientpositive/index_auto.q.out
@@ -35,8 +35,10 @@ POSTHOOK: Input: default@src
 98	val_98
 PREHOOK: query: CREATE INDEX src_index ON TABLE src(key) as 'COMPACT' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: CREATE INDEX src_index ON TABLE src(key) as 'COMPACT' WITH DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@default__src_src_index__
 PREHOOK: query: ALTER INDEX src_index ON src REBUILD
 PREHOOK: type: ALTERINDEX_REBUILD
@@ -260,5 +262,7 @@ POSTHOOK: Input: default@src
 98	val_98
 PREHOOK: query: DROP INDEX src_index on src
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: DROP INDEX src_index on src
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@src
diff --git a/ql/src/test/results/clientpositive/index_auto_empty.q.out b/ql/src/test/results/clientpositive/index_auto_empty.q.out
index 818b14efae..6a1a6c5717 100644
--- a/ql/src/test/results/clientpositive/index_auto_empty.q.out
+++ b/ql/src/test/results/clientpositive/index_auto_empty.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: -- Test to ensure that an empty index result is propagated corre
 CREATE TABLE temp(key STRING, val STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@temp
 POSTHOOK: query: -- Test to ensure that an empty index result is propagated correctly
 
 -- Create temp, and populate it with some values in src.
@@ -14,9 +15,11 @@ POSTHOOK: Output: default@temp
 PREHOOK: query: -- Build an index on temp.
 CREATE INDEX temp_index ON TABLE temp(key) as 'COMPACT' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@temp
 POSTHOOK: query: -- Build an index on temp.
 CREATE INDEX temp_index ON TABLE temp(key) as 'COMPACT' WITH DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@temp
 POSTHOOK: Output: default@default__temp_temp_index__
 PREHOOK: query: ALTER INDEX temp_index ON temp REBUILD
 PREHOOK: type: ALTERINDEX_REBUILD
diff --git a/ql/src/test/results/clientpositive/index_auto_file_format.q.out b/ql/src/test/results/clientpositive/index_auto_file_format.q.out
index ac9f735c05..7ea64f909d 100644
--- a/ql/src/test/results/clientpositive/index_auto_file_format.q.out
+++ b/ql/src/test/results/clientpositive/index_auto_file_format.q.out
@@ -2,10 +2,12 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 -- test automatic use of index on different file formats
 CREATE INDEX src_index ON TABLE src(key) as 'COMPACT' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 -- test automatic use of index on different file formats
 CREATE INDEX src_index ON TABLE src(key) as 'COMPACT' WITH DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@default__src_src_index__
 PREHOOK: query: ALTER INDEX src_index ON src REBUILD
 PREHOOK: type: ALTERINDEX_REBUILD
@@ -252,5 +254,7 @@ POSTHOOK: Input: default@src
 86	val_86
 PREHOOK: query: DROP INDEX src_index on src
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: DROP INDEX src_index on src
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@src
diff --git a/ql/src/test/results/clientpositive/index_auto_mult_tables.q.out b/ql/src/test/results/clientpositive/index_auto_mult_tables.q.out
index 7603d266dd..9348c452fa 100644
--- a/ql/src/test/results/clientpositive/index_auto_mult_tables.q.out
+++ b/ql/src/test/results/clientpositive/index_auto_mult_tables.q.out
@@ -136,8 +136,10 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
 87	val_87
 PREHOOK: query: CREATE INDEX src_index ON TABLE src(key) as 'BITMAP' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: CREATE INDEX src_index ON TABLE src(key) as 'BITMAP' WITH DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@default__src_src_index__
 PREHOOK: query: ALTER INDEX src_index ON src REBUILD
 PREHOOK: type: ALTERINDEX_REBUILD
@@ -153,8 +155,10 @@ POSTHOOK: Lineage: default__src_src_index__._offset SIMPLE [(src)src.FieldSchema
 POSTHOOK: Lineage: default__src_src_index__.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: CREATE INDEX srcpart_index ON TABLE srcpart(key) as 'BITMAP' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: CREATE INDEX srcpart_index ON TABLE srcpart(key) as 'BITMAP' WITH DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@srcpart
 POSTHOOK: Output: default@default__srcpart_srcpart_index__
 PREHOOK: query: ALTER INDEX srcpart_index ON srcpart REBUILD
 PREHOOK: type: ALTERINDEX_REBUILD
@@ -416,9 +420,13 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
 87	val_87
 PREHOOK: query: DROP INDEX src_index on src
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: DROP INDEX src_index on src
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@src
 PREHOOK: query: DROP INDEX srcpart_index on src
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: DROP INDEX srcpart_index on src
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@src
diff --git a/ql/src/test/results/clientpositive/index_auto_mult_tables_compact.q.out b/ql/src/test/results/clientpositive/index_auto_mult_tables_compact.q.out
index ecbd8448fe..a21b1703e0 100644
--- a/ql/src/test/results/clientpositive/index_auto_mult_tables_compact.q.out
+++ b/ql/src/test/results/clientpositive/index_auto_mult_tables_compact.q.out
@@ -136,8 +136,10 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
 87	val_87
 PREHOOK: query: CREATE INDEX src_index ON TABLE src(key) as 'COMPACT' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: CREATE INDEX src_index ON TABLE src(key) as 'COMPACT' WITH DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@default__src_src_index__
 PREHOOK: query: ALTER INDEX src_index ON src REBUILD
 PREHOOK: type: ALTERINDEX_REBUILD
@@ -152,8 +154,10 @@ POSTHOOK: Lineage: default__src_src_index__._offsets EXPRESSION [(src)src.FieldS
 POSTHOOK: Lineage: default__src_src_index__.key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: CREATE INDEX srcpart_index ON TABLE srcpart(key) as 'COMPACT' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: CREATE INDEX srcpart_index ON TABLE srcpart(key) as 'COMPACT' WITH DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@srcpart
 POSTHOOK: Output: default@default__srcpart_srcpart_index__
 PREHOOK: query: ALTER INDEX srcpart_index ON srcpart REBUILD
 PREHOOK: type: ALTERINDEX_REBUILD
@@ -462,9 +466,13 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
 87	val_87
 PREHOOK: query: DROP INDEX src_index on src
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: DROP INDEX src_index on src
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@src
 PREHOOK: query: DROP INDEX srcpart_index on src
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: DROP INDEX srcpart_index on src
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@src
diff --git a/ql/src/test/results/clientpositive/index_auto_multiple.q.out b/ql/src/test/results/clientpositive/index_auto_multiple.q.out
index 9c668ef37b..c46ff2bb3f 100644
--- a/ql/src/test/results/clientpositive/index_auto_multiple.q.out
+++ b/ql/src/test/results/clientpositive/index_auto_multiple.q.out
@@ -3,16 +3,20 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE INDEX src_key_index ON TABLE src(key) as 'COMPACT' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 -- With multiple indexes, make sure we choose which to use in a consistent order
 
 CREATE INDEX src_key_index ON TABLE src(key) as 'COMPACT' WITH DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@default__src_src_key_index__
 PREHOOK: query: CREATE INDEX src_val_index ON TABLE src(value) as 'COMPACT' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: CREATE INDEX src_val_index ON TABLE src(value) as 'COMPACT' WITH DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@default__src_src_val_index__
 PREHOOK: query: ALTER INDEX src_key_index ON src REBUILD
 PREHOOK: type: ALTERINDEX_REBUILD
@@ -154,9 +158,13 @@ POSTHOOK: Input: default@src
 86	val_86
 PREHOOK: query: DROP INDEX src_key_index ON src
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: DROP INDEX src_key_index ON src
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@src
 PREHOOK: query: DROP INDEX src_val_index ON src
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: DROP INDEX src_val_index ON src
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@src
diff --git a/ql/src/test/results/clientpositive/index_auto_partitioned.q.out b/ql/src/test/results/clientpositive/index_auto_partitioned.q.out
index 54d80ad828..79290d0c84 100644
--- a/ql/src/test/results/clientpositive/index_auto_partitioned.q.out
+++ b/ql/src/test/results/clientpositive/index_auto_partitioned.q.out
@@ -2,10 +2,12 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 -- test automatic use of index on table with partitions
 CREATE INDEX src_part_index ON TABLE srcpart(key) as 'COMPACT' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 -- test automatic use of index on table with partitions
 CREATE INDEX src_part_index ON TABLE srcpart(key) as 'COMPACT' WITH DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@srcpart
 POSTHOOK: Output: default@default__srcpart_src_part_index__
 PREHOOK: query: ALTER INDEX src_part_index ON srcpart REBUILD
 PREHOOK: type: ALTERINDEX_REBUILD
@@ -159,5 +161,7 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
 86	val_86
 PREHOOK: query: DROP INDEX src_part_index ON srcpart
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: DROP INDEX src_part_index ON srcpart
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@srcpart
diff --git a/ql/src/test/results/clientpositive/index_auto_self_join.q.out b/ql/src/test/results/clientpositive/index_auto_self_join.q.out
index 7bd782c3e6..b7c40bd75f 100644
--- a/ql/src/test/results/clientpositive/index_auto_self_join.q.out
+++ b/ql/src/test/results/clientpositive/index_auto_self_join.q.out
@@ -89,8 +89,10 @@ POSTHOOK: Input: default@src
 87	87
 PREHOOK: query: CREATE INDEX src_index ON TABLE src(key) as 'BITMAP' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: CREATE INDEX src_index ON TABLE src(key) as 'BITMAP' WITH DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@default__src_src_index__
 PREHOOK: query: ALTER INDEX src_index ON src REBUILD
 PREHOOK: type: ALTERINDEX_REBUILD
@@ -283,5 +285,7 @@ POSTHOOK: Input: default@src
 87	87
 PREHOOK: query: DROP INDEX src_index on src
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: DROP INDEX src_index on src
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@src
diff --git a/ql/src/test/results/clientpositive/index_auto_unused.q.out b/ql/src/test/results/clientpositive/index_auto_unused.q.out
index 0cf50e3156..75a23a8805 100644
--- a/ql/src/test/results/clientpositive/index_auto_unused.q.out
+++ b/ql/src/test/results/clientpositive/index_auto_unused.q.out
@@ -3,11 +3,13 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE INDEX src_index ON TABLE src(key) as 'COMPACT' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 -- test cases where the index should not be used automatically
 
 CREATE INDEX src_index ON TABLE src(key) as 'COMPACT' WITH DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@default__src_src_index__
 PREHOOK: query: ALTER INDEX src_index ON src REBUILD
 PREHOOK: type: ALTERINDEX_REBUILD
@@ -234,13 +236,17 @@ POSTHOOK: Input: default@src
 PREHOOK: query: -- columns are not covered by indexes
 DROP INDEX src_index on src
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: -- columns are not covered by indexes
 DROP INDEX src_index on src
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@src
 PREHOOK: query: CREATE INDEX src_val_index ON TABLE src(value) as 'COMPACT' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: CREATE INDEX src_val_index ON TABLE src(value) as 'COMPACT' WITH DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@default__src_src_val_index__
 PREHOOK: query: ALTER INDEX src_val_index ON src REBUILD
 PREHOOK: type: ALTERINDEX_REBUILD
@@ -319,14 +325,18 @@ POSTHOOK: Input: default@src
 98	val_98
 PREHOOK: query: DROP INDEX src_val_index on src
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: DROP INDEX src_val_index on src
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@src
 PREHOOK: query: -- required partitions have not been built yet
 CREATE INDEX src_part_index ON TABLE srcpart(key) as 'COMPACT' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: -- required partitions have not been built yet
 CREATE INDEX src_part_index ON TABLE srcpart(key) as 'COMPACT' WITH DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@srcpart
 POSTHOOK: Output: default@default__srcpart_src_part_index__
 PREHOOK: query: ALTER INDEX src_part_index ON srcpart PARTITION (ds='2008-04-08', hr=11) REBUILD
 PREHOOK: type: ALTERINDEX_REBUILD
@@ -400,5 +410,7 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
 9	val_9	2008-04-09	12
 PREHOOK: query: DROP INDEX src_part_index on srcpart
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: DROP INDEX src_part_index on srcpart
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@srcpart
diff --git a/ql/src/test/results/clientpositive/index_auto_update.q.out b/ql/src/test/results/clientpositive/index_auto_update.q.out
index 99f9d29b15..fbd6105214 100644
--- a/ql/src/test/results/clientpositive/index_auto_update.q.out
+++ b/ql/src/test/results/clientpositive/index_auto_update.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: -- Test if index is actually being used.
 CREATE TABLE temp(key STRING, val STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@temp
 POSTHOOK: query: -- Test if index is actually being used.
 
 -- Create temp, and populate it with some values in src.
@@ -24,9 +25,11 @@ POSTHOOK: Lineage: temp.val SIMPLE [(src)src.FieldSchema(name:value, type:string
 PREHOOK: query: -- Build an index on temp.
 CREATE INDEX temp_index ON TABLE temp(key) as 'COMPACT' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@temp
 POSTHOOK: query: -- Build an index on temp.
 CREATE INDEX temp_index ON TABLE temp(key) as 'COMPACT' WITH DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@temp
 POSTHOOK: Output: default@default__temp_temp_index__
 PREHOOK: query: ALTER INDEX temp_index ON temp REBUILD
 PREHOOK: type: ALTERINDEX_REBUILD
diff --git a/ql/src/test/results/clientpositive/index_bitmap.q.out b/ql/src/test/results/clientpositive/index_bitmap.q.out
index f5ffa05fe0..596312dbe1 100644
--- a/ql/src/test/results/clientpositive/index_bitmap.q.out
+++ b/ql/src/test/results/clientpositive/index_bitmap.q.out
@@ -2,10 +2,12 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 
 DROP INDEX srcpart_index_proj on srcpart
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 DROP INDEX srcpart_index_proj on srcpart
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@srcpart
 PREHOOK: query: EXPLAIN
 CREATE INDEX srcpart_index_proj ON TABLE srcpart(key) as 'BITMAP' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
@@ -20,8 +22,10 @@ STAGE PLANS:
 
 PREHOOK: query: CREATE INDEX srcpart_index_proj ON TABLE srcpart(key) as 'BITMAP' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: CREATE INDEX srcpart_index_proj ON TABLE srcpart(key) as 'BITMAP' WITH DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@srcpart
 POSTHOOK: Output: default@default__srcpart_srcpart_index_proj__
 PREHOOK: query: ALTER INDEX srcpart_index_proj ON srcpart REBUILD
 PREHOOK: type: ALTERINDEX_REBUILD
@@ -128,8 +132,10 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 100	val_100
 PREHOOK: query: DROP INDEX srcpart_index_proj on srcpart
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: DROP INDEX srcpart_index_proj on srcpart
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@srcpart
 PREHOOK: query: EXPLAIN
 CREATE INDEX srcpart_index_proj ON TABLE srcpart(key) as 'BITMAP' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
@@ -144,8 +150,10 @@ STAGE PLANS:
 
 PREHOOK: query: CREATE INDEX srcpart_index_proj ON TABLE srcpart(key) as 'BITMAP' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: CREATE INDEX srcpart_index_proj ON TABLE srcpart(key) as 'BITMAP' WITH DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@srcpart
 POSTHOOK: Output: default@default__srcpart_srcpart_index_proj__
 PREHOOK: query: ALTER  INDEX srcpart_index_proj ON srcpart REBUILD
 PREHOOK: type: ALTERINDEX_REBUILD
@@ -257,5 +265,7 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
 100	val_100
 PREHOOK: query: DROP INDEX srcpart_index_proj on srcpart
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: DROP INDEX srcpart_index_proj on srcpart
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@srcpart
diff --git a/ql/src/test/results/clientpositive/index_bitmap1.q.out b/ql/src/test/results/clientpositive/index_bitmap1.q.out
index 0cfdf3950d..b750407526 100644
--- a/ql/src/test/results/clientpositive/index_bitmap1.q.out
+++ b/ql/src/test/results/clientpositive/index_bitmap1.q.out
@@ -16,8 +16,10 @@ STAGE PLANS:
 
 PREHOOK: query: CREATE INDEX src_index ON TABLE src(key) as 'BITMAP' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: CREATE INDEX src_index ON TABLE src(key) as 'BITMAP' WITH DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@default__src_src_index__
 PREHOOK: query: ALTER INDEX src_index ON src REBUILD
 PREHOOK: type: ALTERINDEX_REBUILD
@@ -71,5 +73,7 @@ POSTHOOK: Input: default@src
 100	val_100
 PREHOOK: query: DROP INDEX src_index ON src
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: DROP INDEX src_index ON src
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@src
diff --git a/ql/src/test/results/clientpositive/index_bitmap2.q.out b/ql/src/test/results/clientpositive/index_bitmap2.q.out
index 3dcb1010af..73c5b90fbc 100644
--- a/ql/src/test/results/clientpositive/index_bitmap2.q.out
+++ b/ql/src/test/results/clientpositive/index_bitmap2.q.out
@@ -28,13 +28,17 @@ STAGE PLANS:
 
 PREHOOK: query: CREATE INDEX src1_index ON TABLE src(key) as 'BITMAP' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: CREATE INDEX src1_index ON TABLE src(key) as 'BITMAP' WITH DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@default__src_src1_index__
 PREHOOK: query: CREATE INDEX src2_index ON TABLE src(value) as 'BITMAP' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: CREATE INDEX src2_index ON TABLE src(value) as 'BITMAP' WITH DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@default__src_src2_index__
 PREHOOK: query: ALTER INDEX src1_index ON src REBUILD
 PREHOOK: type: ALTERINDEX_REBUILD
@@ -126,9 +130,13 @@ POSTHOOK: Input: default@src
 2	val_2
 PREHOOK: query: DROP INDEX src1_index ON src
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: DROP INDEX src1_index ON src
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@src
 PREHOOK: query: DROP INDEX src2_index ON src
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: DROP INDEX src2_index ON src
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@src
diff --git a/ql/src/test/results/clientpositive/index_bitmap3.q.out b/ql/src/test/results/clientpositive/index_bitmap3.q.out
index 7923902dd6..6689e84047 100644
--- a/ql/src/test/results/clientpositive/index_bitmap3.q.out
+++ b/ql/src/test/results/clientpositive/index_bitmap3.q.out
@@ -28,13 +28,17 @@ STAGE PLANS:
 
 PREHOOK: query: CREATE INDEX src1_index ON TABLE src(key) as 'BITMAP' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: CREATE INDEX src1_index ON TABLE src(key) as 'BITMAP' WITH DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@default__src_src1_index__
 PREHOOK: query: CREATE INDEX src2_index ON TABLE src(value) as 'BITMAP' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: CREATE INDEX src2_index ON TABLE src(value) as 'BITMAP' WITH DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@default__src_src2_index__
 PREHOOK: query: ALTER INDEX src1_index ON src REBUILD
 PREHOOK: type: ALTERINDEX_REBUILD
@@ -254,9 +258,13 @@ POSTHOOK: Input: default@src
 0	val_0
 PREHOOK: query: DROP INDEX src1_index ON src
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: DROP INDEX src1_index ON src
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@src
 PREHOOK: query: DROP INDEX src2_index ON src
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: DROP INDEX src2_index ON src
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@src
diff --git a/ql/src/test/results/clientpositive/index_bitmap_auto.q.out b/ql/src/test/results/clientpositive/index_bitmap_auto.q.out
index 5ad785dff7..9e3cd4a5c8 100644
--- a/ql/src/test/results/clientpositive/index_bitmap_auto.q.out
+++ b/ql/src/test/results/clientpositive/index_bitmap_auto.q.out
@@ -45,13 +45,17 @@ STAGE PLANS:
 
 PREHOOK: query: CREATE INDEX src1_index ON TABLE src(key) as 'BITMAP' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: CREATE INDEX src1_index ON TABLE src(key) as 'BITMAP' WITH DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@default__src_src1_index__
 PREHOOK: query: CREATE INDEX src2_index ON TABLE src(value) as 'BITMAP' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: CREATE INDEX src2_index ON TABLE src(value) as 'BITMAP' WITH DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@default__src_src2_index__
 PREHOOK: query: ALTER INDEX src1_index ON src REBUILD
 PREHOOK: type: ALTERINDEX_REBUILD
@@ -277,9 +281,13 @@ POSTHOOK: Input: default@src
 0	val_0
 PREHOOK: query: DROP INDEX src1_index ON src
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: DROP INDEX src1_index ON src
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@src
 PREHOOK: query: DROP INDEX src2_index ON src
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: DROP INDEX src2_index ON src
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@src
diff --git a/ql/src/test/results/clientpositive/index_bitmap_auto_partitioned.q.out b/ql/src/test/results/clientpositive/index_bitmap_auto_partitioned.q.out
index 08df8af186..4c3260467e 100644
--- a/ql/src/test/results/clientpositive/index_bitmap_auto_partitioned.q.out
+++ b/ql/src/test/results/clientpositive/index_bitmap_auto_partitioned.q.out
@@ -3,11 +3,13 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 -- test automatic use of index on table with partitions
 CREATE INDEX src_part_index ON TABLE srcpart(key) as 'BITMAP' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 -- test automatic use of index on table with partitions
 CREATE INDEX src_part_index ON TABLE srcpart(key) as 'BITMAP' WITH DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@srcpart
 POSTHOOK: Output: default@default__srcpart_src_part_index__
 PREHOOK: query: ALTER INDEX src_part_index ON srcpart REBUILD
 PREHOOK: type: ALTERINDEX_REBUILD
@@ -139,5 +141,7 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
 86	val_86
 PREHOOK: query: DROP INDEX src_part_index ON srcpart
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: DROP INDEX src_part_index ON srcpart
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@srcpart
diff --git a/ql/src/test/results/clientpositive/index_bitmap_compression.q.out b/ql/src/test/results/clientpositive/index_bitmap_compression.q.out
index 1217215ce4..8fd3c952c5 100644
--- a/ql/src/test/results/clientpositive/index_bitmap_compression.q.out
+++ b/ql/src/test/results/clientpositive/index_bitmap_compression.q.out
@@ -2,10 +2,12 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE INDEX src_index ON TABLE src(key) as 'BITMAP' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE INDEX src_index ON TABLE src(key) as 'BITMAP' WITH DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@default__src_src_index__
 PREHOOK: query: ALTER INDEX src_index ON src REBUILD
 PREHOOK: type: ALTERINDEX_REBUILD
@@ -134,5 +136,7 @@ POSTHOOK: Input: default@src
 98	val_98
 PREHOOK: query: DROP INDEX src_index on src
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: DROP INDEX src_index on src
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@src
diff --git a/ql/src/test/results/clientpositive/index_bitmap_rc.q.out b/ql/src/test/results/clientpositive/index_bitmap_rc.q.out
index 43ad288b89..45fe3399ff 100644
--- a/ql/src/test/results/clientpositive/index_bitmap_rc.q.out
+++ b/ql/src/test/results/clientpositive/index_bitmap_rc.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE srcpart_rc (key int, value string) PARTITIONED BY (ds string, hr int) STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcpart_rc
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE srcpart_rc (key int, value string) PARTITIONED BY (ds string, hr int) STORED AS RCFILE
@@ -71,8 +72,10 @@ STAGE PLANS:
 
 PREHOOK: query: CREATE INDEX srcpart_rc_index ON TABLE srcpart_rc(key) as 'BITMAP' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@srcpart_rc
 POSTHOOK: query: CREATE INDEX srcpart_rc_index ON TABLE srcpart_rc(key) as 'BITMAP' WITH DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@srcpart_rc
 POSTHOOK: Output: default@default__srcpart_rc_srcpart_rc_index__
 PREHOOK: query: ALTER INDEX srcpart_rc_index ON srcpart_rc REBUILD
 PREHOOK: type: ALTERINDEX_REBUILD
@@ -179,8 +182,10 @@ POSTHOOK: Input: default@srcpart_rc@ds=2008-04-08/hr=11
 100	val_100
 PREHOOK: query: DROP INDEX srcpart_rc_index on srcpart_rc
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@srcpart_rc
 POSTHOOK: query: DROP INDEX srcpart_rc_index on srcpart_rc
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@srcpart_rc
 PREHOOK: query: EXPLAIN
 CREATE INDEX srcpart_rc_index ON TABLE srcpart_rc(key) as 'BITMAP' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
@@ -195,8 +200,10 @@ STAGE PLANS:
 
 PREHOOK: query: CREATE INDEX srcpart_rc_index ON TABLE srcpart_rc(key) as 'BITMAP' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@srcpart_rc
 POSTHOOK: query: CREATE INDEX srcpart_rc_index ON TABLE srcpart_rc(key) as 'BITMAP' WITH DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@srcpart_rc
 POSTHOOK: Output: default@default__srcpart_rc_srcpart_rc_index__
 PREHOOK: query: ALTER  INDEX srcpart_rc_index ON srcpart_rc REBUILD
 PREHOOK: type: ALTERINDEX_REBUILD
@@ -308,8 +315,10 @@ POSTHOOK: Input: default@srcpart_rc@ds=2008-04-09/hr=12
 100	val_100
 PREHOOK: query: DROP INDEX srcpart_rc_index on srcpart_rc
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@srcpart_rc
 POSTHOOK: query: DROP INDEX srcpart_rc_index on srcpart_rc
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@srcpart_rc
 PREHOOK: query: DROP TABLE srcpart_rc
 PREHOOK: type: DROPTABLE
 PREHOOK: Input: default@srcpart_rc
diff --git a/ql/src/test/results/clientpositive/index_compact.q.out b/ql/src/test/results/clientpositive/index_compact.q.out
index 68be0f792f..a33f82a62d 100644
--- a/ql/src/test/results/clientpositive/index_compact.q.out
+++ b/ql/src/test/results/clientpositive/index_compact.q.out
@@ -2,10 +2,12 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 
 DROP INDEX srcpart_index_proj on srcpart
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 DROP INDEX srcpart_index_proj on srcpart
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@srcpart
 PREHOOK: query: EXPLAIN
 CREATE INDEX srcpart_index_proj ON TABLE srcpart(key) as 'COMPACT' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
@@ -20,8 +22,10 @@ STAGE PLANS:
 
 PREHOOK: query: CREATE INDEX srcpart_index_proj ON TABLE srcpart(key) as 'COMPACT' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: CREATE INDEX srcpart_index_proj ON TABLE srcpart(key) as 'COMPACT' WITH DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@srcpart
 POSTHOOK: Output: default@default__srcpart_srcpart_index_proj__
 PREHOOK: query: ALTER INDEX srcpart_index_proj ON srcpart REBUILD
 PREHOOK: type: ALTERINDEX_REBUILD
@@ -119,8 +123,10 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 100	val_100
 PREHOOK: query: DROP INDEX srcpart_index_proj on srcpart
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: DROP INDEX srcpart_index_proj on srcpart
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@srcpart
 PREHOOK: query: EXPLAIN
 CREATE INDEX srcpart_index_proj ON TABLE srcpart(key) as 'COMPACT' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
@@ -135,8 +141,10 @@ STAGE PLANS:
 
 PREHOOK: query: CREATE INDEX srcpart_index_proj ON TABLE srcpart(key) as 'COMPACT' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: CREATE INDEX srcpart_index_proj ON TABLE srcpart(key) as 'COMPACT' WITH DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@srcpart
 POSTHOOK: Output: default@default__srcpart_srcpart_index_proj__
 PREHOOK: query: ALTER  INDEX srcpart_index_proj ON srcpart REBUILD
 PREHOOK: type: ALTERINDEX_REBUILD
@@ -243,5 +251,7 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
 100	val_100
 PREHOOK: query: DROP INDEX srcpart_index_proj on srcpart
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: DROP INDEX srcpart_index_proj on srcpart
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@srcpart
diff --git a/ql/src/test/results/clientpositive/index_compact_1.q.out b/ql/src/test/results/clientpositive/index_compact_1.q.out
index 70cc452bfd..ba312bbe02 100644
--- a/ql/src/test/results/clientpositive/index_compact_1.q.out
+++ b/ql/src/test/results/clientpositive/index_compact_1.q.out
@@ -16,8 +16,10 @@ STAGE PLANS:
 
 PREHOOK: query: CREATE INDEX src_index ON TABLE src(key) as 'COMPACT' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: CREATE INDEX src_index ON TABLE src(key) as 'COMPACT' WITH DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@default__src_src_index__
 PREHOOK: query: ALTER INDEX src_index ON src REBUILD
 PREHOOK: type: ALTERINDEX_REBUILD
@@ -66,5 +68,7 @@ POSTHOOK: Input: default@src
 100	val_100
 PREHOOK: query: DROP INDEX src_index on src
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: DROP INDEX src_index on src
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@src
diff --git a/ql/src/test/results/clientpositive/index_compact_2.q.out b/ql/src/test/results/clientpositive/index_compact_2.q.out
index e016ba6ef2..fd4cdf960a 100644
--- a/ql/src/test/results/clientpositive/index_compact_2.q.out
+++ b/ql/src/test/results/clientpositive/index_compact_2.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE srcpart_rc (key int, value string) PARTITIONED BY (ds string, hr int) STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcpart_rc
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE srcpart_rc (key int, value string) PARTITIONED BY (ds string, hr int) STORED AS RCFILE
@@ -59,8 +60,10 @@ POSTHOOK: Lineage: srcpart_rc PARTITION(ds=2008-04-09,hr=12).key EXPRESSION [(sr
 POSTHOOK: Lineage: srcpart_rc PARTITION(ds=2008-04-09,hr=12).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: CREATE INDEX srcpart_rc_index ON TABLE srcpart_rc(key) as 'COMPACT' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@srcpart_rc
 POSTHOOK: query: CREATE INDEX srcpart_rc_index ON TABLE srcpart_rc(key) as 'COMPACT' WITH DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@srcpart_rc
 POSTHOOK: Output: default@default__srcpart_rc_srcpart_rc_index__
 PREHOOK: query: ALTER INDEX srcpart_rc_index ON srcpart_rc REBUILD
 PREHOOK: type: ALTERINDEX_REBUILD
@@ -158,8 +161,10 @@ POSTHOOK: Input: default@srcpart_rc@ds=2008-04-08/hr=11
 100	val_100
 PREHOOK: query: DROP INDEX srcpart_rc_index on srcpart_rc
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@srcpart_rc
 POSTHOOK: query: DROP INDEX srcpart_rc_index on srcpart_rc
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@srcpart_rc
 PREHOOK: query: EXPLAIN
 CREATE INDEX srcpart_rc_index ON TABLE srcpart_rc(key) as 'COMPACT' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
@@ -174,8 +179,10 @@ STAGE PLANS:
 
 PREHOOK: query: CREATE INDEX srcpart_rc_index ON TABLE srcpart_rc(key) as 'COMPACT' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@srcpart_rc
 POSTHOOK: query: CREATE INDEX srcpart_rc_index ON TABLE srcpart_rc(key) as 'COMPACT' WITH DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@srcpart_rc
 POSTHOOK: Output: default@default__srcpart_rc_srcpart_rc_index__
 PREHOOK: query: ALTER  INDEX srcpart_rc_index ON srcpart_rc REBUILD
 PREHOOK: type: ALTERINDEX_REBUILD
@@ -282,8 +289,10 @@ POSTHOOK: Input: default@srcpart_rc@ds=2008-04-09/hr=12
 100	val_100
 PREHOOK: query: DROP INDEX srcpart_rc_index on srcpart_rc
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@srcpart_rc
 POSTHOOK: query: DROP INDEX srcpart_rc_index on srcpart_rc
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@srcpart_rc
 PREHOOK: query: DROP TABLE srcpart_rc
 PREHOOK: type: DROPTABLE
 PREHOOK: Input: default@srcpart_rc
diff --git a/ql/src/test/results/clientpositive/index_compact_3.q.out b/ql/src/test/results/clientpositive/index_compact_3.q.out
index 2424e9fc39..931a4c442d 100644
--- a/ql/src/test/results/clientpositive/index_compact_3.q.out
+++ b/ql/src/test/results/clientpositive/index_compact_3.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE src_index_test_rc (key int, value string) STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_index_test_rc
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE src_index_test_rc (key int, value string) STORED AS RCFILE
@@ -21,8 +22,10 @@ POSTHOOK: Lineage: src_index_test_rc.key EXPRESSION [(src)src.FieldSchema(name:k
 POSTHOOK: Lineage: src_index_test_rc.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: CREATE INDEX src_index ON TABLE src_index_test_rc(key) as 'COMPACT' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@src_index_test_rc
 POSTHOOK: query: CREATE INDEX src_index ON TABLE src_index_test_rc(key) as 'COMPACT' WITH DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@src_index_test_rc
 POSTHOOK: Output: default@default__src_index_test_rc_src_index__
 PREHOOK: query: ALTER INDEX src_index ON src_index_test_rc REBUILD
 PREHOOK: type: ALTERINDEX_REBUILD
@@ -71,8 +74,10 @@ POSTHOOK: Input: default@src_index_test_rc
 100	val_100
 PREHOOK: query: DROP INDEX src_index on src_index_test_rc
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@src_index_test_rc
 POSTHOOK: query: DROP INDEX src_index on src_index_test_rc
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@src_index_test_rc
 PREHOOK: query: DROP TABLE src_index_test_rc
 PREHOOK: type: DROPTABLE
 PREHOOK: Input: default@src_index_test_rc
diff --git a/ql/src/test/results/clientpositive/index_compact_binary_search.q.out b/ql/src/test/results/clientpositive/index_compact_binary_search.q.out
index 98646e8e84..dbbd9edaf3 100644
--- a/ql/src/test/results/clientpositive/index_compact_binary_search.q.out
+++ b/ql/src/test/results/clientpositive/index_compact_binary_search.q.out
@@ -1,7 +1,9 @@
 PREHOOK: query: CREATE INDEX src_index ON TABLE src(key) as 'COMPACT' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: CREATE INDEX src_index ON TABLE src(key) as 'COMPACT' WITH DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@default__src_src_index__
 PREHOOK: query: ALTER INDEX src_index ON src REBUILD
 PREHOOK: type: ALTERINDEX_REBUILD
@@ -83,8 +85,10 @@ PREHOOK: Input: default@src
 97	val_97
 PREHOOK: query: DROP INDEX src_index ON src
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@src
 PREHOOK: query: CREATE INDEX src_index ON TABLE src(key) as 'COMPACT' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@src
 PREHOOK: query: ALTER INDEX src_index ON src REBUILD
 PREHOOK: type: ALTERINDEX_REBUILD
 PREHOOK: Input: default@src
@@ -158,8 +162,10 @@ PREHOOK: Input: default@src
 97	val_97
 PREHOOK: query: DROP INDEX src_index ON src
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@src
 PREHOOK: query: CREATE INDEX src_index ON TABLE src(key) as 'COMPACT' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@src
 PREHOOK: query: ALTER INDEX src_index ON src REBUILD
 PREHOOK: type: ALTERINDEX_REBUILD
 PREHOOK: Input: default@src
@@ -233,8 +239,10 @@ PREHOOK: Input: default@src
 97	val_97
 PREHOOK: query: DROP INDEX src_index ON src
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@src
 PREHOOK: query: CREATE INDEX src_index ON TABLE src(key) as 'COMPACT' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@src
 PREHOOK: query: ALTER INDEX src_index ON src REBUILD
 PREHOOK: type: ALTERINDEX_REBUILD
 PREHOOK: Input: default@src
@@ -308,8 +316,10 @@ PREHOOK: Input: default@src
 97	val_97
 PREHOOK: query: DROP INDEX src_index ON src
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@src
 PREHOOK: query: CREATE INDEX src_index ON TABLE src(key) as 'COMPACT' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@src
 PREHOOK: query: ALTER INDEX src_index ON src REBUILD
 PREHOOK: type: ALTERINDEX_REBUILD
 PREHOOK: Input: default@src
@@ -383,8 +393,10 @@ PREHOOK: Input: default@src
 97	val_97
 PREHOOK: query: DROP INDEX src_index ON src
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@src
 PREHOOK: query: CREATE INDEX src_index ON TABLE src(key) as 'COMPACT' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@src
 PREHOOK: query: ALTER INDEX src_index ON src REBUILD
 PREHOOK: type: ALTERINDEX_REBUILD
 PREHOOK: Input: default@src
@@ -458,3 +470,4 @@ PREHOOK: Input: default@src
 97	val_97
 PREHOOK: query: DROP INDEX src_index ON src
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@src
diff --git a/ql/src/test/results/clientpositive/index_compression.q.out b/ql/src/test/results/clientpositive/index_compression.q.out
index ab0a3a6481..9899270ac6 100644
--- a/ql/src/test/results/clientpositive/index_compression.q.out
+++ b/ql/src/test/results/clientpositive/index_compression.q.out
@@ -2,10 +2,12 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE INDEX src_index ON TABLE src(key) as 'COMPACT' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE INDEX src_index ON TABLE src(key) as 'COMPACT' WITH DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@default__src_src_index__
 PREHOOK: query: ALTER INDEX src_index ON src REBUILD
 PREHOOK: type: ALTERINDEX_REBUILD
@@ -156,5 +158,7 @@ POSTHOOK: Input: default@src
 98	val_98
 PREHOOK: query: DROP INDEX src_index on src
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: DROP INDEX src_index on src
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@src
diff --git a/ql/src/test/results/clientpositive/index_creation.q.out b/ql/src/test/results/clientpositive/index_creation.q.out
index da3bcb817d..a313266184 100644
--- a/ql/src/test/results/clientpositive/index_creation.q.out
+++ b/ql/src/test/results/clientpositive/index_creation.q.out
@@ -1,43 +1,61 @@
 PREHOOK: query: drop index src_index_2 on src
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: drop index src_index_2 on src
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@src
 PREHOOK: query: drop index src_index_3 on src
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: drop index src_index_3 on src
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@src
 PREHOOK: query: drop index src_index_4 on src
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: drop index src_index_4 on src
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@src
 PREHOOK: query: drop index src_index_5 on src
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: drop index src_index_5 on src
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@src
 PREHOOK: query: drop index src_index_6 on src
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: drop index src_index_6 on src
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@src
 PREHOOK: query: drop index src_index_7 on src
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: drop index src_index_7 on src
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@src
 PREHOOK: query: drop index src_index_8 on src
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: drop index src_index_8 on src
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@src
 PREHOOK: query: drop index src_index_9 on src
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: drop index src_index_9 on src
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@src
 PREHOOK: query: drop table `_t`
 PREHOOK: type: DROPTABLE
 POSTHOOK: query: drop table `_t`
 POSTHOOK: type: DROPTABLE
 PREHOOK: query: create index src_index_2 on table src(key) as 'compact' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: create index src_index_2 on table src(key) as 'compact' WITH DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@default__src_src_index_2__
 PREHOOK: query: desc extended default__src_src_index_2__
 PREHOOK: type: DESCTABLE
@@ -52,8 +70,10 @@ _offsets            	array<bigint>
 #### A masked pattern was here ####
 PREHOOK: query: create index src_index_3 on table src(key) as 'compact' WITH DEFERRED REBUILD in table src_idx_src_index_3
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: create index src_index_3 on table src(key) as 'compact' WITH DEFERRED REBUILD in table src_idx_src_index_3
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@src_idx_src_index_3
 PREHOOK: query: desc extended src_idx_src_index_3
 PREHOOK: type: DESCTABLE
@@ -68,8 +88,10 @@ _offsets            	array<bigint>
 #### A masked pattern was here ####
 PREHOOK: query: create index src_index_4 on table src(key) as 'compact' WITH DEFERRED REBUILD ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' STORED AS TEXTFILE
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: create index src_index_4 on table src(key) as 'compact' WITH DEFERRED REBUILD ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' STORED AS TEXTFILE
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@default__src_src_index_4__
 PREHOOK: query: desc extended default__src_src_index_4__
 PREHOOK: type: DESCTABLE
@@ -84,8 +106,10 @@ _offsets            	array<bigint>
 #### A masked pattern was here ####
 PREHOOK: query: create index src_index_5 on table src(key) as 'compact' WITH DEFERRED REBUILD ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' ESCAPED BY '\\'
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: create index src_index_5 on table src(key) as 'compact' WITH DEFERRED REBUILD ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' ESCAPED BY '\\'
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@default__src_src_index_5__
 PREHOOK: query: desc extended default__src_src_index_5__
 PREHOOK: type: DESCTABLE
@@ -100,8 +124,10 @@ _offsets            	array<bigint>
 #### A masked pattern was here ####
 PREHOOK: query: create index src_index_6 on table src(key) as 'compact' WITH DEFERRED REBUILD STORED AS RCFILE
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: create index src_index_6 on table src(key) as 'compact' WITH DEFERRED REBUILD STORED AS RCFILE
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@default__src_src_index_6__
 PREHOOK: query: desc extended default__src_src_index_6__
 PREHOOK: type: DESCTABLE
@@ -116,8 +142,10 @@ _offsets            	array<bigint>
 #### A masked pattern was here ####
 PREHOOK: query: create index src_index_7 on table src(key) as 'compact' WITH DEFERRED REBUILD in table src_idx_src_index_7 STORED AS RCFILE
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: create index src_index_7 on table src(key) as 'compact' WITH DEFERRED REBUILD in table src_idx_src_index_7 STORED AS RCFILE
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@src_idx_src_index_7
 PREHOOK: query: desc extended src_idx_src_index_7
 PREHOOK: type: DESCTABLE
@@ -132,8 +160,10 @@ _offsets            	array<bigint>
 #### A masked pattern was here ####
 PREHOOK: query: create index src_index_8 on table src(key) as 'compact' WITH DEFERRED REBUILD IDXPROPERTIES ("prop1"="val1", "prop2"="val2")
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: create index src_index_8 on table src(key) as 'compact' WITH DEFERRED REBUILD IDXPROPERTIES ("prop1"="val1", "prop2"="val2")
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@default__src_src_index_8__
 PREHOOK: query: desc extended default__src_src_index_8__
 PREHOOK: type: DESCTABLE
@@ -148,8 +178,10 @@ _offsets            	array<bigint>
 #### A masked pattern was here ####
 PREHOOK: query: create index src_index_9 on table src(key) as 'compact' WITH DEFERRED REBUILD TBLPROPERTIES ("prop1"="val1", "prop2"="val2")
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: create index src_index_9 on table src(key) as 'compact' WITH DEFERRED REBUILD TBLPROPERTIES ("prop1"="val1", "prop2"="val2")
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@default__src_src_index_9__
 PREHOOK: query: desc extended default__src_src_index_9__
 PREHOOK: type: DESCTABLE
@@ -165,14 +197,17 @@ _offsets            	array<bigint>
 PREHOOK: query: create table `_t`(`_i` int, `_j` int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@_t
 POSTHOOK: query: create table `_t`(`_i` int, `_j` int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@_t
 PREHOOK: query: create index x on table `_t`(`_j`) as 'compact' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@_t
 POSTHOOK: query: create index x on table `_t`(`_j`) as 'compact' WITH DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@_t
 POSTHOOK: Output: default@default___t_x__
 PREHOOK: query: alter index x on `_t` rebuild
 PREHOOK: type: ALTERINDEX_REBUILD
@@ -188,9 +223,11 @@ POSTHOOK: Lineage: default___t_x__._offsets EXPRESSION [(_t)_t.FieldSchema(name:
 PREHOOK: query: create index x2 on table `_t`(`_i`,`_j`) as 'compact' WITH DEFERRED
 REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@_t
 POSTHOOK: query: create index x2 on table `_t`(`_i`,`_j`) as 'compact' WITH DEFERRED
 REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@_t
 POSTHOOK: Output: default@default___t_x2__
 PREHOOK: query: alter index x2 on `_t` rebuild
 PREHOOK: type: ALTERINDEX_REBUILD
@@ -206,36 +243,52 @@ POSTHOOK: Lineage: default___t_x2__._j SIMPLE [(_t)_t.FieldSchema(name:_j, type:
 POSTHOOK: Lineage: default___t_x2__._offsets EXPRESSION [(_t)_t.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), ]
 PREHOOK: query: drop index src_index_2 on src
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: drop index src_index_2 on src
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@src
 PREHOOK: query: drop index src_index_3 on src
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: drop index src_index_3 on src
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@src
 PREHOOK: query: drop index src_index_4 on src
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: drop index src_index_4 on src
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@src
 PREHOOK: query: drop index src_index_5 on src
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: drop index src_index_5 on src
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@src
 PREHOOK: query: drop index src_index_6 on src
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: drop index src_index_6 on src
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@src
 PREHOOK: query: drop index src_index_7 on src
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: drop index src_index_7 on src
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@src
 PREHOOK: query: drop index src_index_8 on src
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: drop index src_index_8 on src
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@src
 PREHOOK: query: drop index src_index_9 on src
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@src
 POSTHOOK: query: drop index src_index_9 on src
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@src
 PREHOOK: query: drop table `_t`
 PREHOOK: type: DROPTABLE
 PREHOOK: Input: default@_t
diff --git a/ql/src/test/results/clientpositive/index_serde.q.out b/ql/src/test/results/clientpositive/index_serde.q.out
index bdad69c7bb..5b4cbfcc53 100644
--- a/ql/src/test/results/clientpositive/index_serde.q.out
+++ b/ql/src/test/results/clientpositive/index_serde.q.out
@@ -31,6 +31,7 @@ TBLPROPERTIES ('avro.schema.literal'='{
 }')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@doctors
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 -- Want to ensure we can build and use indices on tables stored with SerDes
 -- Build the (Avro backed) table
@@ -85,9 +86,11 @@ POSTHOOK: Output: default@doctors
 PREHOOK: query: -- Create and build an index
 CREATE INDEX doctors_index ON TABLE doctors(number) AS 'COMPACT' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@doctors
 POSTHOOK: query: -- Create and build an index
 CREATE INDEX doctors_index ON TABLE doctors(number) AS 'COMPACT' WITH DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@doctors
 POSTHOOK: Output: default@default__doctors_doctors_index__
 PREHOOK: query: DESCRIBE EXTENDED default__doctors_doctors_index__
 PREHOOK: type: DESCTABLE
@@ -233,8 +236,10 @@ POSTHOOK: Input: default@doctors
 9	Christopher	Eccleston
 PREHOOK: query: DROP INDEX doctors_index ON doctors
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@doctors
 POSTHOOK: query: DROP INDEX doctors_index ON doctors
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@doctors
 PREHOOK: query: DROP TABLE doctors
 PREHOOK: type: DROPTABLE
 PREHOOK: Input: default@doctors
diff --git a/ql/src/test/results/clientpositive/index_stale.q.out b/ql/src/test/results/clientpositive/index_stale.q.out
index 16596b8fb0..951bcf225b 100644
--- a/ql/src/test/results/clientpositive/index_stale.q.out
+++ b/ql/src/test/results/clientpositive/index_stale.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- test that stale indexes are not used
 CREATE TABLE temp(key STRING, val STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@temp
 POSTHOOK: query: -- test that stale indexes are not used
 
 CREATE TABLE temp(key STRING, val STRING) STORED AS TEXTFILE
@@ -22,9 +23,11 @@ POSTHOOK: Lineage: temp.val SIMPLE [(src)src.FieldSchema(name:value, type:string
 PREHOOK: query: -- Build an index on temp.
 CREATE INDEX temp_index ON TABLE temp(key) as 'COMPACT' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@temp
 POSTHOOK: query: -- Build an index on temp.
 CREATE INDEX temp_index ON TABLE temp(key) as 'COMPACT' WITH DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@temp
 POSTHOOK: Output: default@default__temp_temp_index__
 PREHOOK: query: ALTER INDEX temp_index ON temp REBUILD
 PREHOOK: type: ALTERINDEX_REBUILD
diff --git a/ql/src/test/results/clientpositive/index_stale_partitioned.q.out b/ql/src/test/results/clientpositive/index_stale_partitioned.q.out
index 1675b7d6e2..5988d7604a 100644
--- a/ql/src/test/results/clientpositive/index_stale_partitioned.q.out
+++ b/ql/src/test/results/clientpositive/index_stale_partitioned.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: -- Test if index is actually being used.
 CREATE TABLE temp(key STRING, val STRING) PARTITIONED BY (foo string) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@temp
 POSTHOOK: query: -- Test if index is actually being used.
 
 -- Create temp, and populate it with some values in src.
@@ -31,9 +32,11 @@ POSTHOOK: Lineage: temp PARTITION(foo=bar).val SIMPLE [(src)src.FieldSchema(name
 PREHOOK: query: -- Build an index on temp.
 CREATE INDEX temp_index ON TABLE temp(key) as 'COMPACT' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@temp
 POSTHOOK: query: -- Build an index on temp.
 CREATE INDEX temp_index ON TABLE temp(key) as 'COMPACT' WITH DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@temp
 POSTHOOK: Output: default@default__temp_temp_index__
 PREHOOK: query: ALTER INDEX temp_index ON temp PARTITION (foo = 'bar') REBUILD
 PREHOOK: type: ALTERINDEX_REBUILD
diff --git a/ql/src/test/results/clientpositive/infer_bucket_sort.q.out b/ql/src/test/results/clientpositive/infer_bucket_sort.q.out
index b06e6d4891..e513626da6 100644
--- a/ql/src/test/results/clientpositive/infer_bucket_sort.q.out
+++ b/ql/src/test/results/clientpositive/infer_bucket_sort.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: -- This tests inferring how data is bucketed/sorted from the ope
 CREATE TABLE test_table (key STRING, value STRING) PARTITIONED BY (part STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table
 POSTHOOK: query: -- This tests inferring how data is bucketed/sorted from the operators in the reducer
 -- and populating that information in partitions' metadata
 
diff --git a/ql/src/test/results/clientpositive/infer_bucket_sort_bucketed_table.q.out b/ql/src/test/results/clientpositive/infer_bucket_sort_bucketed_table.q.out
index 093c9bed0d..e0b5866826 100644
--- a/ql/src/test/results/clientpositive/infer_bucket_sort_bucketed_table.q.out
+++ b/ql/src/test/results/clientpositive/infer_bucket_sort_bucketed_table.q.out
@@ -4,6 +4,7 @@ CREATE TABLE test_table_bucketed (key STRING, value STRING) PARTITIONED BY (part
 CLUSTERED BY (value) SORTED BY (value) INTO 3 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table_bucketed
 POSTHOOK: query: -- Test writing to a bucketed table, the output should be bucketed by the bucketing key into the
 -- a number of files equal to the number of buckets
 CREATE TABLE test_table_bucketed (key STRING, value STRING) PARTITIONED BY (part STRING)
diff --git a/ql/src/test/results/clientpositive/infer_bucket_sort_convert_join.q.out b/ql/src/test/results/clientpositive/infer_bucket_sort_convert_join.q.out
index 1508d0e648..b82a0eabb9 100644
--- a/ql/src/test/results/clientpositive/infer_bucket_sort_convert_join.q.out
+++ b/ql/src/test/results/clientpositive/infer_bucket_sort_convert_join.q.out
@@ -5,6 +5,7 @@ PREHOOK: query: -- This tests inferring how data is bucketed/sorted from the ope
 CREATE TABLE test_table (key STRING, value STRING) PARTITIONED BY (part STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table
 POSTHOOK: query: -- This tests inferring how data is bucketed/sorted from the operators in the reducer
 -- and populating that information in partitions' metadata.  In particular, those cases
 -- where joins may be auto converted to map joins.
diff --git a/ql/src/test/results/clientpositive/infer_bucket_sort_dyn_part.q.out b/ql/src/test/results/clientpositive/infer_bucket_sort_dyn_part.q.out
index bb6145cff5..ea37c36487 100644
--- a/ql/src/test/results/clientpositive/infer_bucket_sort_dyn_part.q.out
+++ b/ql/src/test/results/clientpositive/infer_bucket_sort_dyn_part.q.out
@@ -5,6 +5,7 @@ PREHOOK: query: -- This tests inferring how data is bucketed/sorted from the ope
 CREATE TABLE test_table LIKE srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table
 POSTHOOK: query: -- This tests inferring how data is bucketed/sorted from the operators in the reducer
 -- and populating that information in partitions' metadata.  In particular, those cases
 -- where dynamic partitioning is used.
@@ -359,6 +360,7 @@ Storage Desc Params:
 PREHOOK: query: CREATE TABLE srcpart_merge_dp LIKE srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcpart_merge_dp
 POSTHOOK: query: CREATE TABLE srcpart_merge_dp LIKE srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -366,6 +368,7 @@ POSTHOOK: Output: default@srcpart_merge_dp
 PREHOOK: query: CREATE TABLE srcpart_merge_dp_rc LIKE srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcpart_merge_dp_rc
 POSTHOOK: query: CREATE TABLE srcpart_merge_dp_rc LIKE srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/infer_bucket_sort_grouping_operators.q.out b/ql/src/test/results/clientpositive/infer_bucket_sort_grouping_operators.q.out
index 3901b4107f..0d6d812cb1 100644
--- a/ql/src/test/results/clientpositive/infer_bucket_sort_grouping_operators.q.out
+++ b/ql/src/test/results/clientpositive/infer_bucket_sort_grouping_operators.q.out
@@ -5,6 +5,7 @@ PREHOOK: query: -- This tests inferring how data is bucketed/sorted from the ope
 CREATE TABLE test_table_out (key STRING, value STRING, agg STRING) PARTITIONED BY (part STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table_out
 POSTHOOK: query: -- This tests inferring how data is bucketed/sorted from the operators in the reducer
 -- and populating that information in partitions' metadata, in particular, this tests
 -- the grouping operators rollup/cube/grouping sets
@@ -16,6 +17,7 @@ POSTHOOK: Output: default@test_table_out
 PREHOOK: query: CREATE TABLE test_table_out_2 (key STRING, value STRING, grouping_key STRING, agg STRING) PARTITIONED BY (part STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table_out_2
 POSTHOOK: query: CREATE TABLE test_table_out_2 (key STRING, value STRING, grouping_key STRING, agg STRING) PARTITIONED BY (part STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/infer_bucket_sort_list_bucket.q.out b/ql/src/test/results/clientpositive/infer_bucket_sort_list_bucket.q.out
index 61282be537..4879cc4ad9 100644
--- a/ql/src/test/results/clientpositive/infer_bucket_sort_list_bucket.q.out
+++ b/ql/src/test/results/clientpositive/infer_bucket_sort_list_bucket.q.out
@@ -9,6 +9,7 @@ SKEWED BY (key) ON ("484")
 STORED AS DIRECTORIES
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@list_bucketing_table
 POSTHOOK: query: -- This tests that bucketing/sorting metadata is not inferred for tables with list bucketing
 
 -- INCLUDE_HADOOP_MAJOR_VERSIONS(0.23)
@@ -90,6 +91,7 @@ SKEWED BY (key) ON ("abc")
 STORED AS DIRECTORIES
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@list_bucketing_table2
 POSTHOOK: query: -- create a table skewed on a key which doesnt exist in the data
 CREATE TABLE list_bucketing_table2 (key STRING, value STRING) 
 PARTITIONED BY (part STRING) 
diff --git a/ql/src/test/results/clientpositive/infer_bucket_sort_map_operators.q.out b/ql/src/test/results/clientpositive/infer_bucket_sort_map_operators.q.out
index a5691e6db0..b6962b6ec6 100644
--- a/ql/src/test/results/clientpositive/infer_bucket_sort_map_operators.q.out
+++ b/ql/src/test/results/clientpositive/infer_bucket_sort_map_operators.q.out
@@ -6,6 +6,7 @@ CREATE TABLE test_table1 (key STRING, value STRING)
 CLUSTERED BY (key) SORTED BY (key DESC) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table1
 POSTHOOK: query: -- This tests inferring how data is bucketed/sorted from the operators in the reducer
 -- and populating that information in partitions' metadata, in particular, this tests
 -- that operators in the mapper have no effect
@@ -19,6 +20,7 @@ PREHOOK: query: CREATE TABLE test_table2 (key STRING, value STRING)
 CLUSTERED BY (key) SORTED BY (key DESC) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table2
 POSTHOOK: query: CREATE TABLE test_table2 (key STRING, value STRING)
 CLUSTERED BY (key) SORTED BY (key DESC) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
@@ -47,6 +49,7 @@ POSTHOOK: Lineage: test_table2.value SIMPLE [(src)src.FieldSchema(name:value, ty
 PREHOOK: query: CREATE TABLE test_table_out (key STRING, value STRING) PARTITIONED BY (part STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table_out
 POSTHOOK: query: CREATE TABLE test_table_out (key STRING, value STRING) PARTITIONED BY (part STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/infer_bucket_sort_merge.q.out b/ql/src/test/results/clientpositive/infer_bucket_sort_merge.q.out
index 66e34cda79..de252db62a 100644
--- a/ql/src/test/results/clientpositive/infer_bucket_sort_merge.q.out
+++ b/ql/src/test/results/clientpositive/infer_bucket_sort_merge.q.out
@@ -5,6 +5,7 @@ PREHOOK: query: -- This tests inferring how data is bucketed/sorted from the ope
 CREATE TABLE test_table (key STRING, value STRING) PARTITIONED BY (part STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table
 POSTHOOK: query: -- This tests inferring how data is bucketed/sorted from the operators in the reducer
 -- and populating that information in partitions' metadata.  In particular, those cases
 -- where where merging may or may not be used.
diff --git a/ql/src/test/results/clientpositive/infer_bucket_sort_multi_insert.q.out b/ql/src/test/results/clientpositive/infer_bucket_sort_multi_insert.q.out
index 14d79f0b9e..c7332ea2ba 100644
--- a/ql/src/test/results/clientpositive/infer_bucket_sort_multi_insert.q.out
+++ b/ql/src/test/results/clientpositive/infer_bucket_sort_multi_insert.q.out
@@ -5,6 +5,7 @@ PREHOOK: query: -- This tests inferring how data is bucketed/sorted from the ope
 CREATE TABLE test_table (key STRING, value STRING) PARTITIONED BY (part STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table
 POSTHOOK: query: -- This tests inferring how data is bucketed/sorted from the operators in the reducer
 -- and populating that information in partitions' metadata.  In particular, those cases
 -- where multi insert is used.
diff --git a/ql/src/test/results/clientpositive/infer_bucket_sort_num_buckets.q.out b/ql/src/test/results/clientpositive/infer_bucket_sort_num_buckets.q.out
index 86919b6527..0212227752 100644
--- a/ql/src/test/results/clientpositive/infer_bucket_sort_num_buckets.q.out
+++ b/ql/src/test/results/clientpositive/infer_bucket_sort_num_buckets.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE test_table (key INT, value STRING) PARTITIONED BY (ds STRING, hr STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table
 POSTHOOK: query: CREATE TABLE test_table (key INT, value STRING) PARTITIONED BY (ds STRING, hr STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/infer_bucket_sort_reducers_power_two.q.out b/ql/src/test/results/clientpositive/infer_bucket_sort_reducers_power_two.q.out
index 5c65abc6fe..2a0336e225 100644
--- a/ql/src/test/results/clientpositive/infer_bucket_sort_reducers_power_two.q.out
+++ b/ql/src/test/results/clientpositive/infer_bucket_sort_reducers_power_two.q.out
@@ -5,6 +5,7 @@ PREHOOK: query: -- This tests inferring how data is bucketed/sorted from the ope
 CREATE TABLE test_table (key STRING, value STRING) PARTITIONED BY (part STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table
 POSTHOOK: query: -- This tests inferring how data is bucketed/sorted from the operators in the reducer
 -- and populating that information in partitions' metadata, it also verifies that the
 -- number of reducers chosen will be a power of two
diff --git a/ql/src/test/results/clientpositive/infer_const_type.q.out b/ql/src/test/results/clientpositive/infer_const_type.q.out
index 4b5f6d4aed..4f4fe1cd32 100644
--- a/ql/src/test/results/clientpositive/infer_const_type.q.out
+++ b/ql/src/test/results/clientpositive/infer_const_type.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: CREATE TABLE infertypes(ti TINYINT, si SMALLINT, i INT, bi BIGINT, fl FLOAT, db DOUBLE, str STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@infertypes
 POSTHOOK: query: CREATE TABLE infertypes(ti TINYINT, si SMALLINT, i INT, bi BIGINT, fl FLOAT, db DOUBLE, str STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/init_file.q.out b/ql/src/test/results/clientpositive/init_file.q.out
index 7a376465a5..0f8cf0cc2c 100644
--- a/ql/src/test/results/clientpositive/init_file.q.out
+++ b/ql/src/test/results/clientpositive/init_file.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table tbl_created_by_init(i int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl_created_by_init
 POSTHOOK: query: create table tbl_created_by_init(i int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/innerjoin.q.out b/ql/src/test/results/clientpositive/innerjoin.q.out
index c8291e68b0..72ef8e51f0 100644
--- a/ql/src/test/results/clientpositive/innerjoin.q.out
+++ b/ql/src/test/results/clientpositive/innerjoin.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE dest_j1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_j1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE dest_j1(key INT, value STRING) STORED AS TEXTFILE
@@ -1136,6 +1137,7 @@ PREHOOK: query: -- verify that INNER is a non-reserved word for backwards compat
 create table inner(i int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@inner
 POSTHOOK: query: -- verify that INNER is a non-reserved word for backwards compatibility
 create table inner(i int)
 POSTHOOK: type: CREATETABLE
@@ -1152,6 +1154,7 @@ POSTHOOK: Input: default@inner
 PREHOOK: query: create table i(inner int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@i
 POSTHOOK: query: create table i(inner int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/inoutdriver.q.out b/ql/src/test/results/clientpositive/inoutdriver.q.out
index 3fa8ffbead..b23a5c2d11 100644
--- a/ql/src/test/results/clientpositive/inoutdriver.q.out
+++ b/ql/src/test/results/clientpositive/inoutdriver.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table test (a int) stored as inputformat 'org.apache.hadoop.hive.ql.io.RCFileInputFormat' outputformat 'org.apache.hadoop.hive.ql.io.RCFileOutputFormat' inputdriver 'RCFileInDriver' outputdriver 'RCFileOutDriver'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test
 POSTHOOK: query: create table test (a int) stored as inputformat 'org.apache.hadoop.hive.ql.io.RCFileInputFormat' outputformat 'org.apache.hadoop.hive.ql.io.RCFileOutputFormat' inputdriver 'RCFileInDriver' outputdriver 'RCFileOutDriver'
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/input1.q.out b/ql/src/test/results/clientpositive/input1.q.out
index 981aac31dd..2698f0a536 100644
--- a/ql/src/test/results/clientpositive/input1.q.out
+++ b/ql/src/test/results/clientpositive/input1.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE TEST1(A INT, B DOUBLE) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@TEST1
 POSTHOOK: query: CREATE TABLE TEST1(A INT, B DOUBLE) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/input10.q.out b/ql/src/test/results/clientpositive/input10.q.out
index 3c9f7c68b4..7d108d80bf 100644
--- a/ql/src/test/results/clientpositive/input10.q.out
+++ b/ql/src/test/results/clientpositive/input10.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE TEST10(key INT, value STRING) PARTITIONED BY(ds STRING, hr STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@TEST10
 POSTHOOK: query: CREATE TABLE TEST10(key INT, value STRING) PARTITIONED BY(ds STRING, hr STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/input11.q.out b/ql/src/test/results/clientpositive/input11.q.out
index ab884bdf3c..028b507c34 100644
--- a/ql/src/test/results/clientpositive/input11.q.out
+++ b/ql/src/test/results/clientpositive/input11.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/input11_limit.q.out b/ql/src/test/results/clientpositive/input11_limit.q.out
index 6a15165455..f009918be9 100644
--- a/ql/src/test/results/clientpositive/input11_limit.q.out
+++ b/ql/src/test/results/clientpositive/input11_limit.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
diff --git a/ql/src/test/results/clientpositive/input12.q.out b/ql/src/test/results/clientpositive/input12.q.out
index 2e19b17093..e74f20d0b3 100644
--- a/ql/src/test/results/clientpositive/input12.q.out
+++ b/ql/src/test/results/clientpositive/input12.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- EXCLUDE_HADOOP_MAJOR_VERSIONS(0.20, 0.20S)
 CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: -- EXCLUDE_HADOOP_MAJOR_VERSIONS(0.20, 0.20S)
 
 CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
@@ -12,6 +13,7 @@ POSTHOOK: Output: default@dest1
 PREHOOK: query: CREATE TABLE dest2(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest2
 POSTHOOK: query: CREATE TABLE dest2(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -19,6 +21,7 @@ POSTHOOK: Output: default@dest2
 PREHOOK: query: CREATE TABLE dest3(key INT) PARTITIONED BY(ds STRING, hr STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest3
 POSTHOOK: query: CREATE TABLE dest3(key INT) PARTITIONED BY(ds STRING, hr STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/input13.q.out b/ql/src/test/results/clientpositive/input13.q.out
index c8abcf7792..31362d5867 100644
--- a/ql/src/test/results/clientpositive/input13.q.out
+++ b/ql/src/test/results/clientpositive/input13.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@dest1
 PREHOOK: query: CREATE TABLE dest2(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest2
 POSTHOOK: query: CREATE TABLE dest2(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -15,6 +17,7 @@ POSTHOOK: Output: default@dest2
 PREHOOK: query: CREATE TABLE dest3(key INT) PARTITIONED BY(ds STRING, hr STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest3
 POSTHOOK: query: CREATE TABLE dest3(key INT) PARTITIONED BY(ds STRING, hr STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/input14.q.out b/ql/src/test/results/clientpositive/input14.q.out
index da546760dc..c3217631f9 100644
--- a/ql/src/test/results/clientpositive/input14.q.out
+++ b/ql/src/test/results/clientpositive/input14.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/input14_limit.q.out b/ql/src/test/results/clientpositive/input14_limit.q.out
index 6918ab46c0..04616b4c06 100644
--- a/ql/src/test/results/clientpositive/input14_limit.q.out
+++ b/ql/src/test/results/clientpositive/input14_limit.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/input15.q.out b/ql/src/test/results/clientpositive/input15.q.out
index 5035396e49..adfc307e3b 100644
--- a/ql/src/test/results/clientpositive/input15.q.out
+++ b/ql/src/test/results/clientpositive/input15.q.out
@@ -21,6 +21,7 @@ STAGE PLANS:
 PREHOOK: query: CREATE TABLE TEST15(key INT, value STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@TEST15
 POSTHOOK: query: CREATE TABLE TEST15(key INT, value STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/input16.q.out b/ql/src/test/results/clientpositive/input16.q.out
index d45fab3c56..550e78e78f 100644
--- a/ql/src/test/results/clientpositive/input16.q.out
+++ b/ql/src/test/results/clientpositive/input16.q.out
@@ -7,6 +7,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: CREATE TABLE INPUT16(KEY STRING, VALUE STRING) ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.TestSerDe' STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@INPUT16
 POSTHOOK: query: CREATE TABLE INPUT16(KEY STRING, VALUE STRING) ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.TestSerDe' STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/input16_cc.q.out b/ql/src/test/results/clientpositive/input16_cc.q.out
index ad32bac0e1..9ea34727c3 100644
--- a/ql/src/test/results/clientpositive/input16_cc.q.out
+++ b/ql/src/test/results/clientpositive/input16_cc.q.out
@@ -11,6 +11,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: CREATE TABLE INPUT16_CC(KEY STRING, VALUE STRING) ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.TestSerDe'  with serdeproperties ('testserde.default.serialization.format'='\003', 'dummy.prop.not.used'='dummyy.val') STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@INPUT16_CC
 POSTHOOK: query: CREATE TABLE INPUT16_CC(KEY STRING, VALUE STRING) ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.TestSerDe'  with serdeproperties ('testserde.default.serialization.format'='\003', 'dummy.prop.not.used'='dummyy.val') STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/input17.q.out b/ql/src/test/results/clientpositive/input17.q.out
index 30845ad9b9..a90977f795 100644
--- a/ql/src/test/results/clientpositive/input17.q.out
+++ b/ql/src/test/results/clientpositive/input17.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/input18.q.out b/ql/src/test/results/clientpositive/input18.q.out
index f9875b6559..631b347562 100644
--- a/ql/src/test/results/clientpositive/input18.q.out
+++ b/ql/src/test/results/clientpositive/input18.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/input19.q.out b/ql/src/test/results/clientpositive/input19.q.out
index 5394e422d6..f8baf10faa 100644
--- a/ql/src/test/results/clientpositive/input19.q.out
+++ b/ql/src/test/results/clientpositive/input19.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table apachelog(ipaddress STRING,identd STRING,user_name STRING,finishtime STRING,requestline string,returncode INT,size INT) ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.dynamic_type.DynamicSerDe' WITH SERDEPROPERTIES (  'serialization.format'= 'org.apache.hadoop.hive.serde2.thrift.TCTLSeparatedProtocol',  'quote.delim'= '("|\\[|\\])',  'field.delim'=' ',  'serialization.null.format'='-'  ) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@apachelog
 POSTHOOK: query: create table apachelog(ipaddress STRING,identd STRING,user_name STRING,finishtime STRING,requestline string,returncode INT,size INT) ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.dynamic_type.DynamicSerDe' WITH SERDEPROPERTIES (  'serialization.format'= 'org.apache.hadoop.hive.serde2.thrift.TCTLSeparatedProtocol',  'quote.delim'= '("|\\[|\\])',  'field.delim'=' ',  'serialization.null.format'='-'  ) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/input1_limit.q.out b/ql/src/test/results/clientpositive/input1_limit.q.out
index d706d2e5ea..a18f032119 100644
--- a/ql/src/test/results/clientpositive/input1_limit.q.out
+++ b/ql/src/test/results/clientpositive/input1_limit.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
@@ -12,6 +13,7 @@ POSTHOOK: Output: default@dest1
 PREHOOK: query: CREATE TABLE dest2(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest2
 POSTHOOK: query: CREATE TABLE dest2(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/input2.q.out b/ql/src/test/results/clientpositive/input2.q.out
index 7d80ad8a47..6ec74e04b4 100644
--- a/ql/src/test/results/clientpositive/input2.q.out
+++ b/ql/src/test/results/clientpositive/input2.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE TEST2a(A INT, B DOUBLE) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@TEST2a
 POSTHOOK: query: CREATE TABLE TEST2a(A INT, B DOUBLE) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -24,6 +25,7 @@ b                   	double
 PREHOOK: query: CREATE TABLE TEST2b(A ARRAY<INT>, B DOUBLE, C MAP<DOUBLE, INT>) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@TEST2b
 POSTHOOK: query: CREATE TABLE TEST2b(A ARRAY<INT>, B DOUBLE, C MAP<DOUBLE, INT>) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/input20.q.out b/ql/src/test/results/clientpositive/input20.q.out
index 96fbfac990..8a824dcc2c 100644
--- a/ql/src/test/results/clientpositive/input20.q.out
+++ b/ql/src/test/results/clientpositive/input20.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/input21.q.out b/ql/src/test/results/clientpositive/input21.q.out
index 8ef12a5075..f6559f3a8f 100644
--- a/ql/src/test/results/clientpositive/input21.q.out
+++ b/ql/src/test/results/clientpositive/input21.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE src_null(a STRING, b STRING, c STRING, d STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_null
 POSTHOOK: query: CREATE TABLE src_null(a STRING, b STRING, c STRING, d STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/input22.q.out b/ql/src/test/results/clientpositive/input22.q.out
index ba08f4265c..eecbcd3fab 100644
--- a/ql/src/test/results/clientpositive/input22.q.out
+++ b/ql/src/test/results/clientpositive/input22.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE INPUT4(KEY STRING, VALUE STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@INPUT4
 POSTHOOK: query: CREATE TABLE INPUT4(KEY STRING, VALUE STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/input24.q.out b/ql/src/test/results/clientpositive/input24.q.out
index 1353e07b62..4e20be66f4 100644
--- a/ql/src/test/results/clientpositive/input24.q.out
+++ b/ql/src/test/results/clientpositive/input24.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table tst(a int, b int) partitioned by (d string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tst
 POSTHOOK: query: create table tst(a int, b int) partitioned by (d string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/input25.q.out b/ql/src/test/results/clientpositive/input25.q.out
index b2b307dd6e..84e5f5981e 100644
--- a/ql/src/test/results/clientpositive/input25.q.out
+++ b/ql/src/test/results/clientpositive/input25.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table tst(a int, b int) partitioned by (d string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tst
 POSTHOOK: query: create table tst(a int, b int) partitioned by (d string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/input28.q.out b/ql/src/test/results/clientpositive/input28.q.out
index d5bda6afa8..227fc65d14 100644
--- a/ql/src/test/results/clientpositive/input28.q.out
+++ b/ql/src/test/results/clientpositive/input28.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table tst(a string, b string) partitioned by (d string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tst
 POSTHOOK: query: create table tst(a string, b string) partitioned by (d string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/input3.q.out b/ql/src/test/results/clientpositive/input3.q.out
index c04f1bd0b8..2bd5475569 100644
--- a/ql/src/test/results/clientpositive/input3.q.out
+++ b/ql/src/test/results/clientpositive/input3.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE TEST3a(A INT, B DOUBLE) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@TEST3a
 POSTHOOK: query: CREATE TABLE TEST3a(A INT, B DOUBLE) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -16,6 +17,7 @@ b                   	double
 PREHOOK: query: CREATE TABLE TEST3b(A ARRAY<INT>, B DOUBLE, C MAP<DOUBLE, INT>) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@TEST3b
 POSTHOOK: query: CREATE TABLE TEST3b(A ARRAY<INT>, B DOUBLE, C MAP<DOUBLE, INT>) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/input30.q.out b/ql/src/test/results/clientpositive/input30.q.out
index dfdbe4a8f7..2727d46b79 100644
--- a/ql/src/test/results/clientpositive/input30.q.out
+++ b/ql/src/test/results/clientpositive/input30.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table dest30(a int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest30
 POSTHOOK: query: create table dest30(a int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@dest30
 PREHOOK: query: create table tst_dest30(a int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tst_dest30
 POSTHOOK: query: create table tst_dest30(a int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/input31.q.out b/ql/src/test/results/clientpositive/input31.q.out
index a7c34e902e..00a458d09e 100644
--- a/ql/src/test/results/clientpositive/input31.q.out
+++ b/ql/src/test/results/clientpositive/input31.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table tst_dest31(a int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tst_dest31
 POSTHOOK: query: create table tst_dest31(a int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@tst_dest31
 PREHOOK: query: create table dest31(a int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest31
 POSTHOOK: query: create table dest31(a int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/input32.q.out b/ql/src/test/results/clientpositive/input32.q.out
index 9ac9669e13..39bf3038e7 100644
--- a/ql/src/test/results/clientpositive/input32.q.out
+++ b/ql/src/test/results/clientpositive/input32.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table dest32(a int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest32
 POSTHOOK: query: create table dest32(a int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@dest32
 PREHOOK: query: create table tst_dest32(a int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tst_dest32
 POSTHOOK: query: create table tst_dest32(a int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/input33.q.out b/ql/src/test/results/clientpositive/input33.q.out
index 9248971056..e30043db33 100644
--- a/ql/src/test/results/clientpositive/input33.q.out
+++ b/ql/src/test/results/clientpositive/input33.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/input34.q.out b/ql/src/test/results/clientpositive/input34.q.out
index 3f379ff2e7..ef789cd6d2 100644
--- a/ql/src/test/results/clientpositive/input34.q.out
+++ b/ql/src/test/results/clientpositive/input34.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/input35.q.out b/ql/src/test/results/clientpositive/input35.q.out
index b3a830898e..9c64e2f4ae 100644
--- a/ql/src/test/results/clientpositive/input35.q.out
+++ b/ql/src/test/results/clientpositive/input35.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/input36.q.out b/ql/src/test/results/clientpositive/input36.q.out
index bcc45f3b77..b5811c4c8a 100644
--- a/ql/src/test/results/clientpositive/input36.q.out
+++ b/ql/src/test/results/clientpositive/input36.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/input37.q.out b/ql/src/test/results/clientpositive/input37.q.out
index ccdc38fedb..0165b21edc 100644
--- a/ql/src/test/results/clientpositive/input37.q.out
+++ b/ql/src/test/results/clientpositive/input37.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table documents(contents string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@documents
 POSTHOOK: query: create table documents(contents string) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/input38.q.out b/ql/src/test/results/clientpositive/input38.q.out
index 8249a63237..ce97efe012 100644
--- a/ql/src/test/results/clientpositive/input38.q.out
+++ b/ql/src/test/results/clientpositive/input38.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key STRING, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key STRING, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/input39.q.out b/ql/src/test/results/clientpositive/input39.q.out
index 3e48b8f799..6868da7268 100644
--- a/ql/src/test/results/clientpositive/input39.q.out
+++ b/ql/src/test/results/clientpositive/input39.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: -- EXCLUDE_HADOOP_MAJOR_VERSIONS(0.20, 0.20S)
 create table t1(key string, value string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t1
 POSTHOOK: query: -- EXCLUDE_HADOOP_MAJOR_VERSIONS(0.20, 0.20S)
 
 
@@ -14,6 +15,7 @@ POSTHOOK: Output: default@t1
 PREHOOK: query: create table t2(key string, value string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t2
 POSTHOOK: query: create table t2(key string, value string) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/input3_limit.q.out b/ql/src/test/results/clientpositive/input3_limit.q.out
index 24a58db75c..f3e0152b78 100644
--- a/ql/src/test/results/clientpositive/input3_limit.q.out
+++ b/ql/src/test/results/clientpositive/input3_limit.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE T1(key STRING, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: CREATE TABLE T1(key STRING, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -24,6 +25,7 @@ POSTHOOK: Output: default@t1
 PREHOOK: query: CREATE TABLE T2(key STRING, value STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T2
 POSTHOOK: query: CREATE TABLE T2(key STRING, value STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/input4.q.out b/ql/src/test/results/clientpositive/input4.q.out
index e5e673de26..8281d7c77d 100644
--- a/ql/src/test/results/clientpositive/input4.q.out
+++ b/ql/src/test/results/clientpositive/input4.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE INPUT4(KEY STRING, VALUE STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@INPUT4
 POSTHOOK: query: CREATE TABLE INPUT4(KEY STRING, VALUE STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/input40.q.out b/ql/src/test/results/clientpositive/input40.q.out
index 38a312d421..bb0eabe257 100644
--- a/ql/src/test/results/clientpositive/input40.q.out
+++ b/ql/src/test/results/clientpositive/input40.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 create table tmp_insert_test (key string, value string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmp_insert_test
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 create table tmp_insert_test (key string, value string) stored as textfile
@@ -528,6 +529,7 @@ POSTHOOK: Input: default@tmp_insert_test
 PREHOOK: query: create table tmp_insert_test_p (key string, value string) partitioned by (ds string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmp_insert_test_p
 POSTHOOK: query: create table tmp_insert_test_p (key string, value string) partitioned by (ds string) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/input41.q.out b/ql/src/test/results/clientpositive/input41.q.out
index 0e330598b5..7cc1007743 100644
--- a/ql/src/test/results/clientpositive/input41.q.out
+++ b/ql/src/test/results/clientpositive/input41.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table dest_sp (cnt int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_sp
 POSTHOOK: query: create table dest_sp (cnt int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/input43.q.out b/ql/src/test/results/clientpositive/input43.q.out
index ed90c2e427..237df764c4 100644
--- a/ql/src/test/results/clientpositive/input43.q.out
+++ b/ql/src/test/results/clientpositive/input43.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table tst_src1 like src1
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tst_src1
 POSTHOOK: query: create table tst_src1 like src1
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/input44.q.out b/ql/src/test/results/clientpositive/input44.q.out
index d3b3df76b6..ecd116626d 100644
--- a/ql/src/test/results/clientpositive/input44.q.out
+++ b/ql/src/test/results/clientpositive/input44.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest
 POSTHOOK: query: CREATE TABLE dest(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/input46.q.out b/ql/src/test/results/clientpositive/input46.q.out
index fc3a254a86..c2ac3963e5 100644
--- a/ql/src/test/results/clientpositive/input46.q.out
+++ b/ql/src/test/results/clientpositive/input46.q.out
@@ -1,7 +1,9 @@
 PREHOOK: query: create database if not exists table_in_database_creation
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:table_in_database_creation
 POSTHOOK: query: create database if not exists table_in_database_creation
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:table_in_database_creation
 PREHOOK: query: create table table_in_database_creation.test1  as select * from src limit 1
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
@@ -19,16 +21,20 @@ POSTHOOK: Output: table_in_database_creation@test2
 PREHOOK: query: create table table_in_database_creation.test3 (a string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:table_in_database_creation
+PREHOOK: Output: table_in_database_creation@table_in_database_creation.test3
 POSTHOOK: query: create table table_in_database_creation.test3 (a string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:table_in_database_creation
+POSTHOOK: Output: table_in_database_creation@table_in_database_creation.test3
 POSTHOOK: Output: table_in_database_creation@test3
 PREHOOK: query: create table `table_in_database_creation.test4` (a string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:table_in_database_creation
+PREHOOK: Output: table_in_database_creation@table_in_database_creation.test4
 POSTHOOK: query: create table `table_in_database_creation.test4` (a string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:table_in_database_creation
+POSTHOOK: Output: table_in_database_creation@table_in_database_creation.test4
 POSTHOOK: Output: table_in_database_creation@test4
 PREHOOK: query: drop database table_in_database_creation cascade
 PREHOOK: type: DROPDATABASE
diff --git a/ql/src/test/results/clientpositive/input49.q.out b/ql/src/test/results/clientpositive/input49.q.out
index f46ca58ce3..2d51528955 100644
--- a/ql/src/test/results/clientpositive/input49.q.out
+++ b/ql/src/test/results/clientpositive/input49.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table intable (b boolean, d double, f float, i int, l bigint, s string, t tinyint)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@intable
 POSTHOOK: query: create table intable (b boolean, d double, f float, i int, l bigint, s string, t tinyint)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/input4_cb_delim.q.out b/ql/src/test/results/clientpositive/input4_cb_delim.q.out
index b657f4c273..97c0c1f371 100644
--- a/ql/src/test/results/clientpositive/input4_cb_delim.q.out
+++ b/ql/src/test/results/clientpositive/input4_cb_delim.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE INPUT4_CB(KEY STRING, VALUE STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\002' LINES TERMINATED BY '\012' STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@INPUT4_CB
 POSTHOOK: query: CREATE TABLE INPUT4_CB(KEY STRING, VALUE STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\002' LINES TERMINATED BY '\012' STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/input5.q.out b/ql/src/test/results/clientpositive/input5.q.out
index f6fb70d7d8..8502eaf35b 100644
--- a/ql/src/test/results/clientpositive/input5.q.out
+++ b/ql/src/test/results/clientpositive/input5.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key STRING, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key STRING, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/input6.q.out b/ql/src/test/results/clientpositive/input6.q.out
index 927a3471a3..9d4e4d032a 100644
--- a/ql/src/test/results/clientpositive/input6.q.out
+++ b/ql/src/test/results/clientpositive/input6.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key STRING, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key STRING, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/input7.q.out b/ql/src/test/results/clientpositive/input7.q.out
index 5bd55f9a9d..745f5887ee 100644
--- a/ql/src/test/results/clientpositive/input7.q.out
+++ b/ql/src/test/results/clientpositive/input7.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(c1 DOUBLE, c2 INT) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(c1 DOUBLE, c2 INT) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/input8.q.out b/ql/src/test/results/clientpositive/input8.q.out
index 11371503c6..410dd33663 100644
--- a/ql/src/test/results/clientpositive/input8.q.out
+++ b/ql/src/test/results/clientpositive/input8.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(c1 STRING, c2 INT, c3 DOUBLE) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(c1 STRING, c2 INT, c3 DOUBLE) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/input9.q.out b/ql/src/test/results/clientpositive/input9.q.out
index db142fb1fa..04abc0e13e 100644
--- a/ql/src/test/results/clientpositive/input9.q.out
+++ b/ql/src/test/results/clientpositive/input9.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(value STRING, key INT) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(value STRING, key INT) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/input_columnarserde.q.out b/ql/src/test/results/clientpositive/input_columnarserde.q.out
index 16d00fb944..11b38c8775 100644
--- a/ql/src/test/results/clientpositive/input_columnarserde.q.out
+++ b/ql/src/test/results/clientpositive/input_columnarserde.q.out
@@ -6,6 +6,7 @@ STORED AS
   OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.RCFileOutputFormat'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@input_columnarserde
 POSTHOOK: query: CREATE TABLE input_columnarserde(a array<int>, b array<string>, c map<string,string>, d int, e string)
 ROW FORMAT SERDE
   'org.apache.hadoop.hive.serde2.columnar.ColumnarSerDe'
diff --git a/ql/src/test/results/clientpositive/input_dynamicserde.q.out b/ql/src/test/results/clientpositive/input_dynamicserde.q.out
index 451647cfd6..35bacaaed4 100644
--- a/ql/src/test/results/clientpositive/input_dynamicserde.q.out
+++ b/ql/src/test/results/clientpositive/input_dynamicserde.q.out
@@ -7,6 +7,7 @@ LINES TERMINATED BY '10'
 STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(a array<int>, b array<string>, c map<string,string>, d int, e string)
 ROW FORMAT DELIMITED
 FIELDS TERMINATED BY '1'
diff --git a/ql/src/test/results/clientpositive/input_lazyserde.q.out b/ql/src/test/results/clientpositive/input_lazyserde.q.out
index 42f175336e..471078946c 100644
--- a/ql/src/test/results/clientpositive/input_lazyserde.q.out
+++ b/ql/src/test/results/clientpositive/input_lazyserde.q.out
@@ -9,6 +9,7 @@ LINES TERMINATED BY '10'
 STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE dest1(a array<int>, b array<string>, c map<string,string>, d int, e string)
@@ -141,6 +142,7 @@ POSTHOOK: Output: default@dest1
 PREHOOK: query: CREATE TABLE dest1(a array<int>) ROW FORMAT DELIMITED FIELDS TERMINATED BY '1' ESCAPED BY '\\'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(a array<int>) ROW FORMAT DELIMITED FIELDS TERMINATED BY '1' ESCAPED BY '\\'
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -184,6 +186,7 @@ POSTHOOK: Output: default@dest1
 PREHOOK: query: CREATE TABLE dest1(a map<string,string>) ROW FORMAT DELIMITED FIELDS TERMINATED BY '1' ESCAPED BY '\\'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(a map<string,string>) ROW FORMAT DELIMITED FIELDS TERMINATED BY '1' ESCAPED BY '\\'
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/input_part1.q.out b/ql/src/test/results/clientpositive/input_part1.q.out
index 22191f10e0..4a6ff86df5 100644
--- a/ql/src/test/results/clientpositive/input_part1.q.out
+++ b/ql/src/test/results/clientpositive/input_part1.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key INT, value STRING, hr STRING, ds STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key INT, value STRING, hr STRING, ds STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/input_part10.q.out b/ql/src/test/results/clientpositive/input_part10.q.out
index 88b683a3d5..22e9ec12e6 100644
--- a/ql/src/test/results/clientpositive/input_part10.q.out
+++ b/ql/src/test/results/clientpositive/input_part10.q.out
@@ -10,6 +10,7 @@ CREATE TABLE part_special (
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part_special
 POSTHOOK: query: -- EXCLUDE_OS_WINDOWS
 -- excluded on windows because of difference in file name encoding logic
 
diff --git a/ql/src/test/results/clientpositive/input_part2.q.out b/ql/src/test/results/clientpositive/input_part2.q.out
index 77c412a0c3..038308378b 100644
--- a/ql/src/test/results/clientpositive/input_part2.q.out
+++ b/ql/src/test/results/clientpositive/input_part2.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key INT, value STRING, hr STRING, ds STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key INT, value STRING, hr STRING, ds STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@dest1
 PREHOOK: query: CREATE TABLE dest2(key INT, value STRING, hr STRING, ds STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest2
 POSTHOOK: query: CREATE TABLE dest2(key INT, value STRING, hr STRING, ds STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/input_part5.q.out b/ql/src/test/results/clientpositive/input_part5.q.out
index 763c84b40d..76504d4a77 100644
--- a/ql/src/test/results/clientpositive/input_part5.q.out
+++ b/ql/src/test/results/clientpositive/input_part5.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table tmptable(key string, value string, hr string, ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmptable
 POSTHOOK: query: create table tmptable(key string, value string, hr string, ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/input_testsequencefile.q.out b/ql/src/test/results/clientpositive/input_testsequencefile.q.out
index 8d21328565..5d1c9c23a3 100644
--- a/ql/src/test/results/clientpositive/input_testsequencefile.q.out
+++ b/ql/src/test/results/clientpositive/input_testsequencefile.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest4_sequencefile(key INT, value STRING) STORED AS SEQUENCEFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest4_sequencefile
 POSTHOOK: query: CREATE TABLE dest4_sequencefile(key INT, value STRING) STORED AS SEQUENCEFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/input_testxpath.q.out b/ql/src/test/results/clientpositive/input_testxpath.q.out
index 3d40d9b873..0a5d1ce592 100644
--- a/ql/src/test/results/clientpositive/input_testxpath.q.out
+++ b/ql/src/test/results/clientpositive/input_testxpath.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key INT, value STRING, mapvalue STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key INT, value STRING, mapvalue STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/input_testxpath2.q.out b/ql/src/test/results/clientpositive/input_testxpath2.q.out
index 67adfb8080..1bea67f823 100644
--- a/ql/src/test/results/clientpositive/input_testxpath2.q.out
+++ b/ql/src/test/results/clientpositive/input_testxpath2.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(lint_size INT, lintstring_size INT, mstringstring_size INT) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(lint_size INT, lintstring_size INT, mstringstring_size INT) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/inputddl1.q.out b/ql/src/test/results/clientpositive/inputddl1.q.out
index 040242e00d..e3d21bf464 100644
--- a/ql/src/test/results/clientpositive/inputddl1.q.out
+++ b/ql/src/test/results/clientpositive/inputddl1.q.out
@@ -20,6 +20,7 @@ STAGE PLANS:
 PREHOOK: query: CREATE TABLE INPUTDDL1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@INPUTDDL1
 POSTHOOK: query: CREATE TABLE INPUTDDL1(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/inputddl2.q.out b/ql/src/test/results/clientpositive/inputddl2.q.out
index 78d6d776f4..f5c36c34f7 100644
--- a/ql/src/test/results/clientpositive/inputddl2.q.out
+++ b/ql/src/test/results/clientpositive/inputddl2.q.out
@@ -21,6 +21,7 @@ STAGE PLANS:
 PREHOOK: query: CREATE TABLE INPUTDDL2(key INT, value STRING) PARTITIONED BY(ds STRING, country STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@INPUTDDL2
 POSTHOOK: query: CREATE TABLE INPUTDDL2(key INT, value STRING) PARTITIONED BY(ds STRING, country STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/inputddl3.q.out b/ql/src/test/results/clientpositive/inputddl3.q.out
index 92f3fefdc2..e1ca708b3f 100644
--- a/ql/src/test/results/clientpositive/inputddl3.q.out
+++ b/ql/src/test/results/clientpositive/inputddl3.q.out
@@ -21,6 +21,7 @@ STAGE PLANS:
 PREHOOK: query: CREATE TABLE INPUTDDL3(key INT, value STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@INPUTDDL3
 POSTHOOK: query: CREATE TABLE INPUTDDL3(key INT, value STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/inputddl4.q.out b/ql/src/test/results/clientpositive/inputddl4.q.out
index ba9c3e40f4..d573d31c86 100644
--- a/ql/src/test/results/clientpositive/inputddl4.q.out
+++ b/ql/src/test/results/clientpositive/inputddl4.q.out
@@ -9,6 +9,7 @@ CREATE TABLE INPUTDDL4(viewTime STRING, userid INT,
     CLUSTERED BY(userid) SORTED BY(viewTime) INTO 32 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@INPUTDDL4
 POSTHOOK: query: -- a simple test to test sorted/clustered syntax
 
 CREATE TABLE INPUTDDL4(viewTime STRING, userid INT,
diff --git a/ql/src/test/results/clientpositive/inputddl5.q.out b/ql/src/test/results/clientpositive/inputddl5.q.out
index 54a3e7b384..f3956f08a9 100644
--- a/ql/src/test/results/clientpositive/inputddl5.q.out
+++ b/ql/src/test/results/clientpositive/inputddl5.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- test for internationalization
 CREATE TABLE INPUTDDL5(name STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@INPUTDDL5
 POSTHOOK: query: -- test for internationalization
 -- kv4.txt contains the utf-8 character 0xE982B5E993AE which we are verifying later on
 CREATE TABLE INPUTDDL5(name STRING) STORED AS TEXTFILE
diff --git a/ql/src/test/results/clientpositive/inputddl6.q.out b/ql/src/test/results/clientpositive/inputddl6.q.out
index 8de63a42e9..5a040e68b3 100644
--- a/ql/src/test/results/clientpositive/inputddl6.q.out
+++ b/ql/src/test/results/clientpositive/inputddl6.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: -- test for describe extended table
 CREATE TABLE INPUTDDL6(KEY STRING, VALUE STRING) PARTITIONED BY(ds STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@INPUTDDL6
 POSTHOOK: query: -- test for describe extended table
 -- test for describe extended table partition
 -- test for alter table drop partition
diff --git a/ql/src/test/results/clientpositive/inputddl7.q.out b/ql/src/test/results/clientpositive/inputddl7.q.out
index 3f2584d661..0d64baf6e2 100644
--- a/ql/src/test/results/clientpositive/inputddl7.q.out
+++ b/ql/src/test/results/clientpositive/inputddl7.q.out
@@ -5,6 +5,7 @@ PREHOOK: query: -- test for loading into tables with the correct file format
 CREATE TABLE T1(name STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: -- test for loading into tables with the correct file format
 -- test for loading into partitions with the correct file format
 
@@ -33,6 +34,7 @@ POSTHOOK: Input: default@t1
 PREHOOK: query: CREATE TABLE T2(name STRING) STORED AS SEQUENCEFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T2
 POSTHOOK: query: CREATE TABLE T2(name STRING) STORED AS SEQUENCEFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -57,6 +59,7 @@ POSTHOOK: Input: default@t2
 PREHOOK: query: CREATE TABLE T3(name STRING) PARTITIONED BY(ds STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T3
 POSTHOOK: query: CREATE TABLE T3(name STRING) PARTITIONED BY(ds STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -84,6 +87,7 @@ POSTHOOK: Input: default@t3@ds=2008-04-09
 PREHOOK: query: CREATE TABLE T4(name STRING) PARTITIONED BY(ds STRING) STORED AS SEQUENCEFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T4
 POSTHOOK: query: CREATE TABLE T4(name STRING) PARTITIONED BY(ds STRING) STORED AS SEQUENCEFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/inputddl8.q.out b/ql/src/test/results/clientpositive/inputddl8.q.out
index 39efb0c969..fc13356930 100644
--- a/ql/src/test/results/clientpositive/inputddl8.q.out
+++ b/ql/src/test/results/clientpositive/inputddl8.q.out
@@ -7,6 +7,7 @@ PREHOOK: query: CREATE TABLE INPUTDDL8 COMMENT 'This is a thrift based table'
     STORED AS SEQUENCEFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@INPUTDDL8
 POSTHOOK: query: CREATE TABLE INPUTDDL8 COMMENT 'This is a thrift based table'
     PARTITIONED BY(ds STRING, country STRING)
     CLUSTERED BY(aint) SORTED BY(lint) INTO 32 BUCKETS
diff --git a/ql/src/test/results/clientpositive/insert1.q.out b/ql/src/test/results/clientpositive/insert1.q.out
index df3d1fba77..1486b86ab8 100644
--- a/ql/src/test/results/clientpositive/insert1.q.out
+++ b/ql/src/test/results/clientpositive/insert1.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 create table insert1(key int, value string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@insert1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 create table insert1(key int, value string) stored as textfile
@@ -12,6 +13,7 @@ POSTHOOK: Output: default@insert1
 PREHOOK: query: create table insert2(key int, value string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@insert2
 POSTHOOK: query: create table insert2(key int, value string) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -207,16 +209,20 @@ STAGE PLANS:
 PREHOOK: query: -- HIVE-3465
 create database x
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:x
 POSTHOOK: query: -- HIVE-3465
 create database x
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:x
 PREHOOK: query: create table x.insert1(key int, value string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:x
+PREHOOK: Output: x@x.insert1
 POSTHOOK: query: create table x.insert1(key int, value string) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:x
 POSTHOOK: Output: x@insert1
+POSTHOOK: Output: x@x.insert1
 PREHOOK: query: explain insert into table x.INSERT1 select a.key, a.value from insert2 a WHERE (a.key=-1)
 PREHOOK: type: QUERY
 POSTHOOK: query: explain insert into table x.INSERT1 select a.key, a.value from insert2 a WHERE (a.key=-1)
@@ -567,16 +573,21 @@ STAGE PLANS:
 PREHOOK: query: -- HIVE-3676
 CREATE DATABASE db2
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:db2
 POSTHOOK: query: -- HIVE-3676
 CREATE DATABASE db2
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:db2
 PREHOOK: query: USE db2
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:db2
 POSTHOOK: query: USE db2
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:db2
 PREHOOK: query: CREATE TABLE result(col1 STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:db2
+PREHOOK: Output: db2@result
 POSTHOOK: query: CREATE TABLE result(col1 STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:db2
@@ -611,18 +622,24 @@ db2_insert1
 db2_insert2
 PREHOOK: query: USE default
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:default
 POSTHOOK: query: USE default
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:default
 PREHOOK: query: CREATE DATABASE db1
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:db1
 POSTHOOK: query: CREATE DATABASE db1
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:db1
 PREHOOK: query: CREATE TABLE db1.result(col1 STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:db1
+PREHOOK: Output: db1@db1.result
 POSTHOOK: query: CREATE TABLE db1.result(col1 STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:db1
+POSTHOOK: Output: db1@db1.result
 POSTHOOK: Output: db1@result
 PREHOOK: query: INSERT OVERWRITE TABLE db1.result SELECT 'db1_insert1' FROM src LIMIT 1
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/insert1_overwrite_partitions.q.out b/ql/src/test/results/clientpositive/insert1_overwrite_partitions.q.out
index 11f1ddf1f3..900babe46d 100644
--- a/ql/src/test/results/clientpositive/insert1_overwrite_partitions.q.out
+++ b/ql/src/test/results/clientpositive/insert1_overwrite_partitions.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE sourceTable (one string,two string) PARTITIONED BY (ds string,hr string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@sourceTable
 POSTHOOK: query: CREATE TABLE sourceTable (one string,two string) PARTITIONED BY (ds string,hr string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -26,6 +27,7 @@ POSTHOOK: Output: default@sourcetable@ds=2011-11-11/hr=12
 PREHOOK: query: CREATE TABLE destinTable (one string,two string) PARTITIONED BY (ds string,hr string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@destinTable
 POSTHOOK: query: CREATE TABLE destinTable (one string,two string) PARTITIONED BY (ds string,hr string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -159,6 +161,7 @@ POSTHOOK: Output: default@destintable
 PREHOOK: query: CREATE TABLE destinTable (one string,two string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@destinTable
 POSTHOOK: query: CREATE TABLE destinTable (one string,two string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/insert2_overwrite_partitions.q.out b/ql/src/test/results/clientpositive/insert2_overwrite_partitions.q.out
index 16aa42da2f..ee7e1e8860 100644
--- a/ql/src/test/results/clientpositive/insert2_overwrite_partitions.q.out
+++ b/ql/src/test/results/clientpositive/insert2_overwrite_partitions.q.out
@@ -1,17 +1,23 @@
 PREHOOK: query: CREATE DATABASE db1
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:db1
 POSTHOOK: query: CREATE DATABASE db1
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:db1
 PREHOOK: query: CREATE DATABASE db2
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:db2
 POSTHOOK: query: CREATE DATABASE db2
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:db2
 PREHOOK: query: CREATE TABLE db1.sourceTable (one string,two string) PARTITIONED BY (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:db1
+PREHOOK: Output: db1@db1.sourceTable
 POSTHOOK: query: CREATE TABLE db1.sourceTable (one string,two string) PARTITIONED BY (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:db1
+POSTHOOK: Output: db1@db1.sourceTable
 POSTHOOK: Output: db1@sourceTable
 PREHOOK: query: load data local inpath '../../data/files/kv1.txt' INTO TABLE db1.sourceTable partition(ds='2011-11-11')
 PREHOOK: type: LOAD
@@ -33,9 +39,11 @@ POSTHOOK: Output: db1@sourcetable@ds=2011-11-11
 PREHOOK: query: CREATE TABLE db2.destinTable (one string,two string) PARTITIONED BY (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:db2
+PREHOOK: Output: db2@db2.destinTable
 POSTHOOK: query: CREATE TABLE db2.destinTable (one string,two string) PARTITIONED BY (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:db2
+POSTHOOK: Output: db2@db2.destinTable
 POSTHOOK: Output: db2@destinTable
 PREHOOK: query: EXPLAIN INSERT OVERWRITE TABLE db2.destinTable PARTITION (ds='2011-11-11')
 SELECT one,two FROM db1.sourceTable WHERE ds='2011-11-11' order by one desc, two desc limit 5
diff --git a/ql/src/test/results/clientpositive/insert_compressed.q.out b/ql/src/test/results/clientpositive/insert_compressed.q.out
index 0cedd255b9..bff4bc58de 100644
--- a/ql/src/test/results/clientpositive/insert_compressed.q.out
+++ b/ql/src/test/results/clientpositive/insert_compressed.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table insert_compressed (key int, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@insert_compressed
 POSTHOOK: query: create table insert_compressed (key int, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/insert_into1.q.out b/ql/src/test/results/clientpositive/insert_into1.q.out
index a3a625c9c2..655e355982 100644
--- a/ql/src/test/results/clientpositive/insert_into1.q.out
+++ b/ql/src/test/results/clientpositive/insert_into1.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: CREATE TABLE insert_into1 (key int, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@insert_into1
 POSTHOOK: query: CREATE TABLE insert_into1 (key int, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/insert_into2.q.out b/ql/src/test/results/clientpositive/insert_into2.q.out
index 3ac3a03c97..0ed5b6c913 100644
--- a/ql/src/test/results/clientpositive/insert_into2.q.out
+++ b/ql/src/test/results/clientpositive/insert_into2.q.out
@@ -6,6 +6,7 @@ PREHOOK: query: CREATE TABLE insert_into2 (key int, value string)
   PARTITIONED BY (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@insert_into2
 POSTHOOK: query: CREATE TABLE insert_into2 (key int, value string) 
   PARTITIONED BY (ds string)
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/insert_into3.q.out b/ql/src/test/results/clientpositive/insert_into3.q.out
index 685d6cbead..61ef01ea8a 100644
--- a/ql/src/test/results/clientpositive/insert_into3.q.out
+++ b/ql/src/test/results/clientpositive/insert_into3.q.out
@@ -9,6 +9,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: CREATE TABLE insert_into3a (key int, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@insert_into3a
 POSTHOOK: query: CREATE TABLE insert_into3a (key int, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -16,6 +17,7 @@ POSTHOOK: Output: default@insert_into3a
 PREHOOK: query: CREATE TABLE insert_into3b (key int, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@insert_into3b
 POSTHOOK: query: CREATE TABLE insert_into3b (key int, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/insert_into4.q.out b/ql/src/test/results/clientpositive/insert_into4.q.out
index 8a3a3e7539..d40d7363a2 100644
--- a/ql/src/test/results/clientpositive/insert_into4.q.out
+++ b/ql/src/test/results/clientpositive/insert_into4.q.out
@@ -9,6 +9,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: CREATE TABLE insert_into4a (key int, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@insert_into4a
 POSTHOOK: query: CREATE TABLE insert_into4a (key int, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -16,6 +17,7 @@ POSTHOOK: Output: default@insert_into4a
 PREHOOK: query: CREATE TABLE insert_into4b (key int, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@insert_into4b
 POSTHOOK: query: CREATE TABLE insert_into4b (key int, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/insert_into5.q.out b/ql/src/test/results/clientpositive/insert_into5.q.out
index 1edeee45f8..7642e7865a 100644
--- a/ql/src/test/results/clientpositive/insert_into5.q.out
+++ b/ql/src/test/results/clientpositive/insert_into5.q.out
@@ -9,6 +9,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: CREATE TABLE insert_into5a (key int, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@insert_into5a
 POSTHOOK: query: CREATE TABLE insert_into5a (key int, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -16,6 +17,7 @@ POSTHOOK: Output: default@insert_into5a
 PREHOOK: query: CREATE TABLE insert_into5b (key int, value string) PARTITIONED BY (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@insert_into5b
 POSTHOOK: query: CREATE TABLE insert_into5b (key int, value string) PARTITIONED BY (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/insert_into6.q.out b/ql/src/test/results/clientpositive/insert_into6.q.out
index 9587b8f28d..2528ce1778 100644
--- a/ql/src/test/results/clientpositive/insert_into6.q.out
+++ b/ql/src/test/results/clientpositive/insert_into6.q.out
@@ -9,6 +9,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: CREATE TABLE insert_into6a (key int, value string) PARTITIONED BY (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@insert_into6a
 POSTHOOK: query: CREATE TABLE insert_into6a (key int, value string) PARTITIONED BY (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -16,6 +17,7 @@ POSTHOOK: Output: default@insert_into6a
 PREHOOK: query: CREATE TABLE insert_into6b (key int, value string) PARTITIONED BY (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@insert_into6b
 POSTHOOK: query: CREATE TABLE insert_into6b (key int, value string) PARTITIONED BY (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/insert_overwrite_local_directory_1.q.out b/ql/src/test/results/clientpositive/insert_overwrite_local_directory_1.q.out
index c7257b2e2c..9a4e861f9a 100644
--- a/ql/src/test/results/clientpositive/insert_overwrite_local_directory_1.q.out
+++ b/ql/src/test/results/clientpositive/insert_overwrite_local_directory_1.q.out
@@ -1028,6 +1028,7 @@ FIELDS TERMINATED BY '\t'
 COLLECTION ITEMS TERMINATED BY ','
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@array_table
 POSTHOOK: query: create table array_table (a array<string>, b array<string>)
 ROW FORMAT DELIMITED
 FIELDS TERMINATED BY '\t'
@@ -1099,6 +1100,7 @@ MAP KEYS TERMINATED BY ':'
 STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@map_table
 POSTHOOK: query: create table map_table (foo STRING , bar MAP<STRING, STRING>)
 ROW FORMAT DELIMITED
 FIELDS TERMINATED BY '\t'
@@ -1218,6 +1220,7 @@ STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 #### A masked pattern was here ####
 PREHOOK: Output: database:default
+PREHOOK: Output: default@local_rctable
 POSTHOOK: query: create external table local_rctable(value string, key string)
 STORED AS RCFILE
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/insertexternal1.q.out b/ql/src/test/results/clientpositive/insertexternal1.q.out
index 0c6bc6afc2..c3c7a7b1d8 100644
--- a/ql/src/test/results/clientpositive/insertexternal1.q.out
+++ b/ql/src/test/results/clientpositive/insertexternal1.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table texternal(key string, val string) partitioned by (insertdate string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@texternal
 POSTHOOK: query: create table texternal(key string, val string) partitioned by (insertdate string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/join1.q.out b/ql/src/test/results/clientpositive/join1.q.out
index 7fbf854b47..1097e1cf56 100644
--- a/ql/src/test/results/clientpositive/join1.q.out
+++ b/ql/src/test/results/clientpositive/join1.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest_j1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_j1
 POSTHOOK: query: CREATE TABLE dest_j1(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/join14.q.out b/ql/src/test/results/clientpositive/join14.q.out
index 3986123fd2..2ebe4b43a7 100644
--- a/ql/src/test/results/clientpositive/join14.q.out
+++ b/ql/src/test/results/clientpositive/join14.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- EXCLUDE_HADOOP_MAJOR_VERSIONS(0.20, 0.20S)
 CREATE TABLE dest1(c1 INT, c2 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: -- EXCLUDE_HADOOP_MAJOR_VERSIONS(0.20, 0.20S)
 
 CREATE TABLE dest1(c1 INT, c2 STRING) STORED AS TEXTFILE
diff --git a/ql/src/test/results/clientpositive/join17.q.out b/ql/src/test/results/clientpositive/join17.q.out
index bbf5e3d795..b090b090ff 100644
--- a/ql/src/test/results/clientpositive/join17.q.out
+++ b/ql/src/test/results/clientpositive/join17.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key1 INT, value1 STRING, key2 INT, value2 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key1 INT, value1 STRING, key2 INT, value2 STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/join19.q.out b/ql/src/test/results/clientpositive/join19.q.out
index 25cb4b36ad..55988924c7 100644
--- a/ql/src/test/results/clientpositive/join19.q.out
+++ b/ql/src/test/results/clientpositive/join19.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE triples (foo string, subject string, predicate string, object string, foo2 string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@triples
 POSTHOOK: query: CREATE TABLE triples (foo string, subject string, predicate string, object string, foo2 string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/join2.q.out b/ql/src/test/results/clientpositive/join2.q.out
index c80f8304f6..dea8751cc0 100644
--- a/ql/src/test/results/clientpositive/join2.q.out
+++ b/ql/src/test/results/clientpositive/join2.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest_j2(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_j2
 POSTHOOK: query: CREATE TABLE dest_j2(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/join24.q.out b/ql/src/test/results/clientpositive/join24.q.out
index a0e48110b1..ea7fdfea03 100644
--- a/ql/src/test/results/clientpositive/join24.q.out
+++ b/ql/src/test/results/clientpositive/join24.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table tst1(key STRING, cnt INT)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tst1
 POSTHOOK: query: create table tst1(key STRING, cnt INT)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/join25.q.out b/ql/src/test/results/clientpositive/join25.q.out
index d8c7b7de93..b7b7d6da76 100644
--- a/ql/src/test/results/clientpositive/join25.q.out
+++ b/ql/src/test/results/clientpositive/join25.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE dest_j1(key INT, value STRING, val2 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_j1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE dest_j1(key INT, value STRING, val2 STRING) STORED AS TEXTFILE
diff --git a/ql/src/test/results/clientpositive/join26.q.out b/ql/src/test/results/clientpositive/join26.q.out
index bf8cf57e5a..9f589d209c 100644
--- a/ql/src/test/results/clientpositive/join26.q.out
+++ b/ql/src/test/results/clientpositive/join26.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE dest_j1(key STRING, value STRING, val2 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_j1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE dest_j1(key STRING, value STRING, val2 STRING) STORED AS TEXTFILE
diff --git a/ql/src/test/results/clientpositive/join27.q.out b/ql/src/test/results/clientpositive/join27.q.out
index 351a2da667..a3963912d9 100644
--- a/ql/src/test/results/clientpositive/join27.q.out
+++ b/ql/src/test/results/clientpositive/join27.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE dest_j1(key INT, value STRING, val2 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_j1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE dest_j1(key INT, value STRING, val2 STRING) STORED AS TEXTFILE
diff --git a/ql/src/test/results/clientpositive/join28.q.out b/ql/src/test/results/clientpositive/join28.q.out
index 1e4e09fceb..70cdd425c9 100644
--- a/ql/src/test/results/clientpositive/join28.q.out
+++ b/ql/src/test/results/clientpositive/join28.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE dest_j1(key STRING, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_j1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE dest_j1(key STRING, value STRING) STORED AS TEXTFILE
diff --git a/ql/src/test/results/clientpositive/join29.q.out b/ql/src/test/results/clientpositive/join29.q.out
index aafd07eb3b..ba17a70cd4 100644
--- a/ql/src/test/results/clientpositive/join29.q.out
+++ b/ql/src/test/results/clientpositive/join29.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE dest_j1(key STRING, cnt1 INT, cnt2 INT)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_j1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE dest_j1(key STRING, cnt1 INT, cnt2 INT)
diff --git a/ql/src/test/results/clientpositive/join3.q.out b/ql/src/test/results/clientpositive/join3.q.out
index e4c34e536d..5454b6add1 100644
--- a/ql/src/test/results/clientpositive/join3.q.out
+++ b/ql/src/test/results/clientpositive/join3.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/join30.q.out b/ql/src/test/results/clientpositive/join30.q.out
index e5370fe3a1..a0621bfed2 100644
--- a/ql/src/test/results/clientpositive/join30.q.out
+++ b/ql/src/test/results/clientpositive/join30.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE dest_j1(key INT, cnt INT)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_j1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE dest_j1(key INT, cnt INT)
diff --git a/ql/src/test/results/clientpositive/join31.q.out b/ql/src/test/results/clientpositive/join31.q.out
index 7d10a535b8..09dd5ec1bb 100644
--- a/ql/src/test/results/clientpositive/join31.q.out
+++ b/ql/src/test/results/clientpositive/join31.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE dest_j1(key STRING, cnt INT)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_j1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE dest_j1(key STRING, cnt INT)
diff --git a/ql/src/test/results/clientpositive/join32.q.out b/ql/src/test/results/clientpositive/join32.q.out
index ff0d7cca27..aa44362d01 100644
--- a/ql/src/test/results/clientpositive/join32.q.out
+++ b/ql/src/test/results/clientpositive/join32.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE dest_j1(key STRING, value STRING, val2 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_j1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE dest_j1(key STRING, value STRING, val2 STRING) STORED AS TEXTFILE
diff --git a/ql/src/test/results/clientpositive/join32_lessSize.q.out b/ql/src/test/results/clientpositive/join32_lessSize.q.out
index 8c7c35f221..18c0d721a1 100644
--- a/ql/src/test/results/clientpositive/join32_lessSize.q.out
+++ b/ql/src/test/results/clientpositive/join32_lessSize.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE dest_j1(key STRING, value STRING, val2 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_j1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE dest_j1(key STRING, value STRING, val2 STRING) STORED AS TEXTFILE
@@ -12,6 +13,7 @@ POSTHOOK: Output: default@dest_j1
 PREHOOK: query: CREATE TABLE dest_j2(key STRING, value STRING, val2 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_j2
 POSTHOOK: query: CREATE TABLE dest_j2(key STRING, value STRING, val2 STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/join33.q.out b/ql/src/test/results/clientpositive/join33.q.out
index ff0d7cca27..aa44362d01 100644
--- a/ql/src/test/results/clientpositive/join33.q.out
+++ b/ql/src/test/results/clientpositive/join33.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE dest_j1(key STRING, value STRING, val2 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_j1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE dest_j1(key STRING, value STRING, val2 STRING) STORED AS TEXTFILE
diff --git a/ql/src/test/results/clientpositive/join34.q.out b/ql/src/test/results/clientpositive/join34.q.out
index b52777ac93..7dc6e008d2 100644
--- a/ql/src/test/results/clientpositive/join34.q.out
+++ b/ql/src/test/results/clientpositive/join34.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE dest_j1(key STRING, value STRING, val2 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_j1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE dest_j1(key STRING, value STRING, val2 STRING) STORED AS TEXTFILE
diff --git a/ql/src/test/results/clientpositive/join35.q.out b/ql/src/test/results/clientpositive/join35.q.out
index 20c69ea7dc..f41ea36027 100644
--- a/ql/src/test/results/clientpositive/join35.q.out
+++ b/ql/src/test/results/clientpositive/join35.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE dest_j1(key STRING, value STRING, val2 INT) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_j1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE dest_j1(key STRING, value STRING, val2 INT) STORED AS TEXTFILE
diff --git a/ql/src/test/results/clientpositive/join36.q.out b/ql/src/test/results/clientpositive/join36.q.out
index 7f76e35335..df8aceaaa9 100644
--- a/ql/src/test/results/clientpositive/join36.q.out
+++ b/ql/src/test/results/clientpositive/join36.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE tmp1(key INT, cnt INT)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmp1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE tmp1(key INT, cnt INT)
@@ -12,6 +13,7 @@ POSTHOOK: Output: default@tmp1
 PREHOOK: query: CREATE TABLE tmp2(key INT, cnt INT)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmp2
 POSTHOOK: query: CREATE TABLE tmp2(key INT, cnt INT)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -19,6 +21,7 @@ POSTHOOK: Output: default@tmp2
 PREHOOK: query: CREATE TABLE dest_j1(key INT, value INT, val2 INT)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_j1
 POSTHOOK: query: CREATE TABLE dest_j1(key INT, value INT, val2 INT)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/join37.q.out b/ql/src/test/results/clientpositive/join37.q.out
index 5e475d5ce5..dc92ddd654 100644
--- a/ql/src/test/results/clientpositive/join37.q.out
+++ b/ql/src/test/results/clientpositive/join37.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE dest_j1(key INT, value STRING, val2 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_j1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE dest_j1(key INT, value STRING, val2 STRING) STORED AS TEXTFILE
diff --git a/ql/src/test/results/clientpositive/join38.q.out b/ql/src/test/results/clientpositive/join38.q.out
index 8f5bd545cb..44dca4ed44 100644
--- a/ql/src/test/results/clientpositive/join38.q.out
+++ b/ql/src/test/results/clientpositive/join38.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table tmp(col0 string, col1 string,col2 string,col3 string,col4 string,col5 string,col6 string,col7 string,col8 string,col9 string,col10 string,col11 string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmp
 POSTHOOK: query: create table tmp(col0 string, col1 string,col2 string,col3 string,col4 string,col5 string,col6 string,col7 string,col8 string,col9 string,col10 string,col11 string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/join39.q.out b/ql/src/test/results/clientpositive/join39.q.out
index ced4d9eb79..a82a6feb4d 100644
--- a/ql/src/test/results/clientpositive/join39.q.out
+++ b/ql/src/test/results/clientpositive/join39.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE dest_j1(key STRING, value STRING, key1 string, val2 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_j1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE dest_j1(key STRING, value STRING, key1 string, val2 STRING) STORED AS TEXTFILE
diff --git a/ql/src/test/results/clientpositive/join4.q.out b/ql/src/test/results/clientpositive/join4.q.out
index 3fb377e4d9..d8a1c9def2 100644
--- a/ql/src/test/results/clientpositive/join4.q.out
+++ b/ql/src/test/results/clientpositive/join4.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(c1 INT, c2 STRING, c3 INT, c4 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(c1 INT, c2 STRING, c3 INT, c4 STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/join5.q.out b/ql/src/test/results/clientpositive/join5.q.out
index 99f265045d..385a0fe90b 100644
--- a/ql/src/test/results/clientpositive/join5.q.out
+++ b/ql/src/test/results/clientpositive/join5.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(c1 INT, c2 STRING, c3 INT, c4 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(c1 INT, c2 STRING, c3 INT, c4 STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/join6.q.out b/ql/src/test/results/clientpositive/join6.q.out
index 33c78a7e57..38fde0c1eb 100644
--- a/ql/src/test/results/clientpositive/join6.q.out
+++ b/ql/src/test/results/clientpositive/join6.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(c1 INT, c2 STRING, c3 INT, c4 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(c1 INT, c2 STRING, c3 INT, c4 STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/join7.q.out b/ql/src/test/results/clientpositive/join7.q.out
index acff93a55f..480856f9be 100644
--- a/ql/src/test/results/clientpositive/join7.q.out
+++ b/ql/src/test/results/clientpositive/join7.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(c1 INT, c2 STRING, c3 INT, c4 STRING, c5 INT, c6 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(c1 INT, c2 STRING, c3 INT, c4 STRING, c5 INT, c6 STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/join8.q.out b/ql/src/test/results/clientpositive/join8.q.out
index eef07ba0e5..48357fc8f1 100644
--- a/ql/src/test/results/clientpositive/join8.q.out
+++ b/ql/src/test/results/clientpositive/join8.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(c1 INT, c2 STRING, c3 INT, c4 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(c1 INT, c2 STRING, c3 INT, c4 STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/join9.q.out b/ql/src/test/results/clientpositive/join9.q.out
index 49eb3de206..4ece610fdd 100644
--- a/ql/src/test/results/clientpositive/join9.q.out
+++ b/ql/src/test/results/clientpositive/join9.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/join_1to1.q.out b/ql/src/test/results/clientpositive/join_1to1.q.out
index b123e3b9d3..643b82a150 100644
--- a/ql/src/test/results/clientpositive/join_1to1.q.out
+++ b/ql/src/test/results/clientpositive/join_1to1.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE join_1to1_1(key1 int, key2 int, value int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@join_1to1_1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE join_1to1_1(key1 int, key2 int, value int)
@@ -20,6 +21,7 @@ POSTHOOK: Output: default@join_1to1_1
 PREHOOK: query: CREATE TABLE join_1to1_2(key1 int, key2 int, value int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@join_1to1_2
 POSTHOOK: query: CREATE TABLE join_1to1_2(key1 int, key2 int, value int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/join_alt_syntax.q.out b/ql/src/test/results/clientpositive/join_alt_syntax.q.out
index a42edd8e59..801e32e48b 100644
--- a/ql/src/test/results/clientpositive/join_alt_syntax.q.out
+++ b/ql/src/test/results/clientpositive/join_alt_syntax.q.out
@@ -16,6 +16,7 @@ CREATE TABLE part(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part
 POSTHOOK: query: -- data setup
 CREATE TABLE part( 
     p_partkey INT,
diff --git a/ql/src/test/results/clientpositive/join_array.q.out b/ql/src/test/results/clientpositive/join_array.q.out
index 2c1bf96174..66c143afba 100644
--- a/ql/src/test/results/clientpositive/join_array.q.out
+++ b/ql/src/test/results/clientpositive/join_array.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table tinyA(a bigint, b bigint) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tinyA
 POSTHOOK: query: create table tinyA(a bigint, b bigint) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@tinyA
 PREHOOK: query: create table tinyB(a bigint, bList array<int>) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tinyB
 POSTHOOK: query: create table tinyB(a bigint, bList array<int>) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/join_casesensitive.q.out b/ql/src/test/results/clientpositive/join_casesensitive.q.out
index cac460721f..4978b88193 100644
--- a/ql/src/test/results/clientpositive/join_casesensitive.q.out
+++ b/ql/src/test/results/clientpositive/join_casesensitive.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE joinone(key1 int, key2 int, value int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@joinone
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE joinone(key1 int, key2 int, value int)
@@ -20,6 +21,7 @@ POSTHOOK: Output: default@joinone
 PREHOOK: query: CREATE TABLE joinTwo(key1 int, key2 int, value int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@joinTwo
 POSTHOOK: query: CREATE TABLE joinTwo(key1 int, key2 int, value int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/join_cond_pushdown_1.q.out b/ql/src/test/results/clientpositive/join_cond_pushdown_1.q.out
index 8edf5ab5fa..581de53efe 100644
--- a/ql/src/test/results/clientpositive/join_cond_pushdown_1.q.out
+++ b/ql/src/test/results/clientpositive/join_cond_pushdown_1.q.out
@@ -16,6 +16,7 @@ CREATE TABLE part(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part
 POSTHOOK: query: -- data setup
 CREATE TABLE part( 
     p_partkey INT,
diff --git a/ql/src/test/results/clientpositive/join_cond_pushdown_2.q.out b/ql/src/test/results/clientpositive/join_cond_pushdown_2.q.out
index 99fe9991dd..94d238fef1 100644
--- a/ql/src/test/results/clientpositive/join_cond_pushdown_2.q.out
+++ b/ql/src/test/results/clientpositive/join_cond_pushdown_2.q.out
@@ -16,6 +16,7 @@ CREATE TABLE part(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part
 POSTHOOK: query: -- data setup
 CREATE TABLE part( 
     p_partkey INT,
diff --git a/ql/src/test/results/clientpositive/join_cond_pushdown_3.q.out b/ql/src/test/results/clientpositive/join_cond_pushdown_3.q.out
index 867d878c64..1ce5e172e4 100644
--- a/ql/src/test/results/clientpositive/join_cond_pushdown_3.q.out
+++ b/ql/src/test/results/clientpositive/join_cond_pushdown_3.q.out
@@ -16,6 +16,7 @@ CREATE TABLE part(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part
 POSTHOOK: query: -- data setup
 CREATE TABLE part( 
     p_partkey INT,
diff --git a/ql/src/test/results/clientpositive/join_cond_pushdown_4.q.out b/ql/src/test/results/clientpositive/join_cond_pushdown_4.q.out
index c79b452161..e2f0682da2 100644
--- a/ql/src/test/results/clientpositive/join_cond_pushdown_4.q.out
+++ b/ql/src/test/results/clientpositive/join_cond_pushdown_4.q.out
@@ -16,6 +16,7 @@ CREATE TABLE part(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part
 POSTHOOK: query: -- data setup
 CREATE TABLE part( 
     p_partkey INT,
diff --git a/ql/src/test/results/clientpositive/join_cond_pushdown_unqual1.q.out b/ql/src/test/results/clientpositive/join_cond_pushdown_unqual1.q.out
index e2220e13ed..62eab2aef8 100644
--- a/ql/src/test/results/clientpositive/join_cond_pushdown_unqual1.q.out
+++ b/ql/src/test/results/clientpositive/join_cond_pushdown_unqual1.q.out
@@ -16,6 +16,7 @@ CREATE TABLE part(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part
 POSTHOOK: query: -- data setup
 CREATE TABLE part( 
     p_partkey INT,
@@ -52,6 +53,7 @@ PREHOOK: query: create table part2(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part2
 POSTHOOK: query: create table part2( 
     p2_partkey INT,
     p2_name STRING,
@@ -79,6 +81,7 @@ PREHOOK: query: create table part3(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part3
 POSTHOOK: query: create table part3( 
     p3_partkey INT,
     p3_name STRING,
diff --git a/ql/src/test/results/clientpositive/join_cond_pushdown_unqual2.q.out b/ql/src/test/results/clientpositive/join_cond_pushdown_unqual2.q.out
index dc4f966d7b..754bc40057 100644
--- a/ql/src/test/results/clientpositive/join_cond_pushdown_unqual2.q.out
+++ b/ql/src/test/results/clientpositive/join_cond_pushdown_unqual2.q.out
@@ -16,6 +16,7 @@ CREATE TABLE part(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part
 POSTHOOK: query: -- data setup
 CREATE TABLE part( 
     p_partkey INT,
@@ -52,6 +53,7 @@ PREHOOK: query: create table part2(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part2
 POSTHOOK: query: create table part2( 
     p2_partkey INT,
     p2_name STRING,
@@ -79,6 +81,7 @@ PREHOOK: query: create table part3(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part3
 POSTHOOK: query: create table part3( 
     p3_partkey INT,
     p3_name STRING,
diff --git a/ql/src/test/results/clientpositive/join_cond_pushdown_unqual3.q.out b/ql/src/test/results/clientpositive/join_cond_pushdown_unqual3.q.out
index a98eb49e59..804795e964 100644
--- a/ql/src/test/results/clientpositive/join_cond_pushdown_unqual3.q.out
+++ b/ql/src/test/results/clientpositive/join_cond_pushdown_unqual3.q.out
@@ -16,6 +16,7 @@ CREATE TABLE part(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part
 POSTHOOK: query: -- data setup
 CREATE TABLE part( 
     p_partkey INT,
@@ -52,6 +53,7 @@ PREHOOK: query: create table part2(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part2
 POSTHOOK: query: create table part2( 
     p2_partkey INT,
     p2_name STRING,
@@ -79,6 +81,7 @@ PREHOOK: query: create table part3(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part3
 POSTHOOK: query: create table part3( 
     p3_partkey INT,
     p3_name STRING,
diff --git a/ql/src/test/results/clientpositive/join_cond_pushdown_unqual4.q.out b/ql/src/test/results/clientpositive/join_cond_pushdown_unqual4.q.out
index 8bbf6161b8..8589651aa9 100644
--- a/ql/src/test/results/clientpositive/join_cond_pushdown_unqual4.q.out
+++ b/ql/src/test/results/clientpositive/join_cond_pushdown_unqual4.q.out
@@ -16,6 +16,7 @@ CREATE TABLE part(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part
 POSTHOOK: query: -- data setup
 CREATE TABLE part( 
     p_partkey INT,
@@ -52,6 +53,7 @@ PREHOOK: query: create table part2(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part2
 POSTHOOK: query: create table part2( 
     p2_partkey INT,
     p2_name STRING,
@@ -79,6 +81,7 @@ PREHOOK: query: create table part3(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part3
 POSTHOOK: query: create table part3( 
     p3_partkey INT,
     p3_name STRING,
diff --git a/ql/src/test/results/clientpositive/join_empty.q.out b/ql/src/test/results/clientpositive/join_empty.q.out
index 649d13c3cb..344345b633 100644
--- a/ql/src/test/results/clientpositive/join_empty.q.out
+++ b/ql/src/test/results/clientpositive/join_empty.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table srcpart_empty(key int, value string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcpart_empty
 POSTHOOK: query: create table srcpart_empty(key int, value string) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@srcpart_empty
 PREHOOK: query: create table src2_empty (key int, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src2_empty
 POSTHOOK: query: create table src2_empty (key int, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/join_filters.q.out b/ql/src/test/results/clientpositive/join_filters.q.out
index fd3abfe635..8a4e2a23b7 100644
--- a/ql/src/test/results/clientpositive/join_filters.q.out
+++ b/ql/src/test/results/clientpositive/join_filters.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_AND_HASH_QUERY_RESULTS
 CREATE TABLE myinput1(key int, value int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@myinput1
 POSTHOOK: query: -- SORT_AND_HASH_QUERY_RESULTS
 
 CREATE TABLE myinput1(key int, value int)
@@ -542,6 +543,7 @@ LNZKrcVNAvaeDALnsg72bw==
 PREHOOK: query: CREATE TABLE smb_input1(key int, value int) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@smb_input1
 POSTHOOK: query: CREATE TABLE smb_input1(key int, value int) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -549,6 +551,7 @@ POSTHOOK: Output: default@smb_input1
 PREHOOK: query: CREATE TABLE smb_input2(key int, value int) CLUSTERED BY (value) SORTED BY (value) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@smb_input2
 POSTHOOK: query: CREATE TABLE smb_input2(key int, value int) CLUSTERED BY (value) SORTED BY (value) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/join_hive_626.q.out b/ql/src/test/results/clientpositive/join_hive_626.q.out
index 2a0cd3380d..52b6c7867d 100644
--- a/ql/src/test/results/clientpositive/join_hive_626.q.out
+++ b/ql/src/test/results/clientpositive/join_hive_626.q.out
@@ -3,6 +3,7 @@ foo_c string, foo_d string) row format delimited fields terminated by ','
 stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@hive_foo
 POSTHOOK: query: create table hive_foo (foo_id int, foo_name string, foo_a string, foo_b string, 
 foo_c string, foo_d string) row format delimited fields terminated by ','
 stored as textfile
@@ -14,6 +15,7 @@ string, bar_a string, bar_b string, bar_c string, bar_d string) row format
 delimited fields terminated by ',' stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@hive_bar
 POSTHOOK: query: create table hive_bar (bar_id int, bar_0 int, foo_id int, bar_1 int, bar_name
 string, bar_a string, bar_b string, bar_c string, bar_d string) row format 
 delimited fields terminated by ',' stored as textfile
@@ -24,6 +26,7 @@ PREHOOK: query: create table hive_count (bar_id int, n int) row format delimited
 terminated by ',' stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@hive_count
 POSTHOOK: query: create table hive_count (bar_id int, n int) row format delimited fields 
 terminated by ',' stored as textfile
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/join_map_ppr.q.out b/ql/src/test/results/clientpositive/join_map_ppr.q.out
index 51fb6c6267..58f1898eaa 100644
--- a/ql/src/test/results/clientpositive/join_map_ppr.q.out
+++ b/ql/src/test/results/clientpositive/join_map_ppr.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE dest_j1(key STRING, value STRING, val2 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_j1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE dest_j1(key STRING, value STRING, val2 STRING) STORED AS TEXTFILE
@@ -595,6 +596,7 @@ POSTHOOK: Input: default@dest_j1
 PREHOOK: query: CREATE TABLE src_copy(key int, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_copy
 POSTHOOK: query: CREATE TABLE src_copy(key int, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -602,6 +604,7 @@ POSTHOOK: Output: default@src_copy
 PREHOOK: query: CREATE TABLE src1_copy(key string, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src1_copy
 POSTHOOK: query: CREATE TABLE src1_copy(key string, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/join_merging.q.out b/ql/src/test/results/clientpositive/join_merging.q.out
index 5eb93d9699..6d11ff8d5f 100644
--- a/ql/src/test/results/clientpositive/join_merging.q.out
+++ b/ql/src/test/results/clientpositive/join_merging.q.out
@@ -11,6 +11,7 @@ PREHOOK: query: CREATE TABLE part(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part
 POSTHOOK: query: CREATE TABLE part( 
     p_partkey INT,
     p_name STRING,
diff --git a/ql/src/test/results/clientpositive/join_nulls.q.out b/ql/src/test/results/clientpositive/join_nulls.q.out
index 3f9a79b53a..d5f20b7b13 100644
--- a/ql/src/test/results/clientpositive/join_nulls.q.out
+++ b/ql/src/test/results/clientpositive/join_nulls.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE myinput1(key int, value int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@myinput1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE myinput1(key int, value int)
@@ -434,6 +435,7 @@ NULL	NULL	48	NULL
 PREHOOK: query: CREATE TABLE smb_input1(key int, value int) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@smb_input1
 POSTHOOK: query: CREATE TABLE smb_input1(key int, value int) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -441,6 +443,7 @@ POSTHOOK: Output: default@smb_input1
 PREHOOK: query: CREATE TABLE smb_input2(key int, value int) CLUSTERED BY (value) SORTED BY (value) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@smb_input2
 POSTHOOK: query: CREATE TABLE smb_input2(key int, value int) CLUSTERED BY (value) SORTED BY (value) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/join_nullsafe.q.out b/ql/src/test/results/clientpositive/join_nullsafe.q.out
index 49c572717e..10c4e2e2dc 100644
--- a/ql/src/test/results/clientpositive/join_nullsafe.q.out
+++ b/ql/src/test/results/clientpositive/join_nullsafe.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE myinput1(key int, value int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@myinput1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE myinput1(key int, value int)
@@ -558,6 +559,7 @@ NULL	NULL	NULL	NULL
 PREHOOK: query: CREATE TABLE smb_input(key int, value int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@smb_input
 POSTHOOK: query: CREATE TABLE smb_input(key int, value int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -582,6 +584,7 @@ PREHOOK: query: -- smbs
 CREATE TABLE smb_input1(key int, value int) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@smb_input1
 POSTHOOK: query: -- smbs
 CREATE TABLE smb_input1(key int, value int) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
@@ -590,6 +593,7 @@ POSTHOOK: Output: default@smb_input1
 PREHOOK: query: CREATE TABLE smb_input2(key int, value int) CLUSTERED BY (value) SORTED BY (value) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@smb_input2
 POSTHOOK: query: CREATE TABLE smb_input2(key int, value int) CLUSTERED BY (value) SORTED BY (value) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/join_rc.q.out b/ql/src/test/results/clientpositive/join_rc.q.out
index 537865fb8e..d0c4462666 100644
--- a/ql/src/test/results/clientpositive/join_rc.q.out
+++ b/ql/src/test/results/clientpositive/join_rc.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table join_rc1(key string, value string) stored as RCFile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@join_rc1
 POSTHOOK: query: create table join_rc1(key string, value string) stored as RCFile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@join_rc1
 PREHOOK: query: create table join_rc2(key string, value string) stored as RCFile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@join_rc2
 POSTHOOK: query: create table join_rc2(key string, value string) stored as RCFile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/join_reorder.q.out b/ql/src/test/results/clientpositive/join_reorder.q.out
index caef085e45..c74dbf7d7b 100644
--- a/ql/src/test/results/clientpositive/join_reorder.q.out
+++ b/ql/src/test/results/clientpositive/join_reorder.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE T1(key STRING, val STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: CREATE TABLE T1(key STRING, val STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@T1
 PREHOOK: query: CREATE TABLE T2(key STRING, val STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T2
 POSTHOOK: query: CREATE TABLE T2(key STRING, val STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -15,6 +17,7 @@ POSTHOOK: Output: default@T2
 PREHOOK: query: CREATE TABLE T3(key STRING, val STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T3
 POSTHOOK: query: CREATE TABLE T3(key STRING, val STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/join_reorder2.q.out b/ql/src/test/results/clientpositive/join_reorder2.q.out
index 7a8a167f39..3a0abe1bf0 100644
--- a/ql/src/test/results/clientpositive/join_reorder2.q.out
+++ b/ql/src/test/results/clientpositive/join_reorder2.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE T1(key STRING, val STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: CREATE TABLE T1(key STRING, val STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@T1
 PREHOOK: query: CREATE TABLE T2(key STRING, val STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T2
 POSTHOOK: query: CREATE TABLE T2(key STRING, val STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -15,6 +17,7 @@ POSTHOOK: Output: default@T2
 PREHOOK: query: CREATE TABLE T3(key STRING, val STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T3
 POSTHOOK: query: CREATE TABLE T3(key STRING, val STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -22,6 +25,7 @@ POSTHOOK: Output: default@T3
 PREHOOK: query: CREATE TABLE T4(key STRING, val STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T4
 POSTHOOK: query: CREATE TABLE T4(key STRING, val STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/join_reorder3.q.out b/ql/src/test/results/clientpositive/join_reorder3.q.out
index 6a8c3ea149..0192acf663 100644
--- a/ql/src/test/results/clientpositive/join_reorder3.q.out
+++ b/ql/src/test/results/clientpositive/join_reorder3.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE T1(key STRING, val STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: CREATE TABLE T1(key STRING, val STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@T1
 PREHOOK: query: CREATE TABLE T2(key STRING, val STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T2
 POSTHOOK: query: CREATE TABLE T2(key STRING, val STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -15,6 +17,7 @@ POSTHOOK: Output: default@T2
 PREHOOK: query: CREATE TABLE T3(key STRING, val STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T3
 POSTHOOK: query: CREATE TABLE T3(key STRING, val STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -22,6 +25,7 @@ POSTHOOK: Output: default@T3
 PREHOOK: query: CREATE TABLE T4(key STRING, val STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T4
 POSTHOOK: query: CREATE TABLE T4(key STRING, val STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/join_reorder4.q.out b/ql/src/test/results/clientpositive/join_reorder4.q.out
index 93c783d1ae..cc15fa9d5a 100644
--- a/ql/src/test/results/clientpositive/join_reorder4.q.out
+++ b/ql/src/test/results/clientpositive/join_reorder4.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE T1(key1 STRING, val1 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: CREATE TABLE T1(key1 STRING, val1 STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@T1
 PREHOOK: query: CREATE TABLE T2(key2 STRING, val2 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T2
 POSTHOOK: query: CREATE TABLE T2(key2 STRING, val2 STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -15,6 +17,7 @@ POSTHOOK: Output: default@T2
 PREHOOK: query: CREATE TABLE T3(key3 STRING, val3 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T3
 POSTHOOK: query: CREATE TABLE T3(key3 STRING, val3 STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/join_star.q.out b/ql/src/test/results/clientpositive/join_star.q.out
index f63c1f876c..7f1fcb203e 100644
--- a/ql/src/test/results/clientpositive/join_star.q.out
+++ b/ql/src/test/results/clientpositive/join_star.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table fact(m1 int, m2 int, d1 int, d2 int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@fact
 POSTHOOK: query: create table fact(m1 int, m2 int, d1 int, d2 int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@fact
 PREHOOK: query: create table dim1(f1 int, f2 int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dim1
 POSTHOOK: query: create table dim1(f1 int, f2 int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -15,6 +17,7 @@ POSTHOOK: Output: default@dim1
 PREHOOK: query: create table dim2(f3 int, f4 int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dim2
 POSTHOOK: query: create table dim2(f3 int, f4 int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -22,6 +25,7 @@ POSTHOOK: Output: default@dim2
 PREHOOK: query: create table dim3(f5 int, f6 int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dim3
 POSTHOOK: query: create table dim3(f5 int, f6 int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -29,6 +33,7 @@ POSTHOOK: Output: default@dim3
 PREHOOK: query: create table dim4(f7 int, f8 int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dim4
 POSTHOOK: query: create table dim4(f7 int, f8 int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -36,6 +41,7 @@ POSTHOOK: Output: default@dim4
 PREHOOK: query: create table dim5(f9 int, f10 int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dim5
 POSTHOOK: query: create table dim5(f9 int, f10 int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -43,6 +49,7 @@ POSTHOOK: Output: default@dim5
 PREHOOK: query: create table dim6(f11 int, f12 int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dim6
 POSTHOOK: query: create table dim6(f11 int, f12 int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -50,6 +57,7 @@ POSTHOOK: Output: default@dim6
 PREHOOK: query: create table dim7(f13 int, f14 int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dim7
 POSTHOOK: query: create table dim7(f13 int, f14 int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/join_view.q.out b/ql/src/test/results/clientpositive/join_view.q.out
index 7c0a3df341..12256b1294 100644
--- a/ql/src/test/results/clientpositive/join_view.q.out
+++ b/ql/src/test/results/clientpositive/join_view.q.out
@@ -9,6 +9,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table invites (foo int, bar string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@invites
 POSTHOOK: query: create table invites (foo int, bar string) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -16,6 +17,7 @@ POSTHOOK: Output: default@invites
 PREHOOK: query: create table invites2 (foo int, bar string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@invites2
 POSTHOOK: query: create table invites2 (foo int, bar string) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/keyword_1.q.out b/ql/src/test/results/clientpositive/keyword_1.q.out
index 55c6701773..22bf5e38ab 100644
--- a/ql/src/test/results/clientpositive/keyword_1.q.out
+++ b/ql/src/test/results/clientpositive/keyword_1.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_BEFORE_DIFF
 create table test_user (user string, `group` string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_user
 POSTHOOK: query: -- SORT_BEFORE_DIFF
 
 create table test_user (user string, `group` string)
@@ -64,6 +65,7 @@ POSTHOOK: Output: default@test_user
 PREHOOK: query: create table test_user (role string, `group` string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_user
 POSTHOOK: query: create table test_user (role string, `group` string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/lateral_view.q.out b/ql/src/test/results/clientpositive/lateral_view.q.out
index 3b943b7d0b..6c9d578a62 100644
--- a/ql/src/test/results/clientpositive/lateral_view.q.out
+++ b/ql/src/test/results/clientpositive/lateral_view.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE tmp_pyang_lv (inputs string) STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmp_pyang_lv
 POSTHOOK: query: CREATE TABLE tmp_pyang_lv (inputs string) STORED AS RCFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -581,6 +582,7 @@ POSTHOOK: Input: default@tmp_pyang_lv
 PREHOOK: query: CREATE TABLE tmp_pyang_src_rcfile (key string, value array<string>) STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmp_pyang_src_rcfile
 POSTHOOK: query: CREATE TABLE tmp_pyang_src_rcfile (key string, value array<string>) STORED AS RCFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/lateral_view_cp.q.out b/ql/src/test/results/clientpositive/lateral_view_cp.q.out
index 3afef7bc46..22032fd37e 100644
--- a/ql/src/test/results/clientpositive/lateral_view_cp.q.out
+++ b/ql/src/test/results/clientpositive/lateral_view_cp.q.out
@@ -7,6 +7,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table array_valued_src (key string, value array<string>)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@array_valued_src
 POSTHOOK: query: create table array_valued_src (key string, value array<string>)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/lb_fs_stats.q.out b/ql/src/test/results/clientpositive/lb_fs_stats.q.out
index dd6f85a84b..94617145e9 100644
--- a/ql/src/test/results/clientpositive/lb_fs_stats.q.out
+++ b/ql/src/test/results/clientpositive/lb_fs_stats.q.out
@@ -5,6 +5,7 @@ PREHOOK: query: -- Tests truncating a column from a list bucketing table
 CREATE TABLE test_tab (key STRING, value STRING) PARTITIONED BY (part STRING) STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_tab
 POSTHOOK: query: -- Tests truncating a column from a list bucketing table
 
 -- INCLUDE_HADOOP_MAJOR_VERSIONS(0.23)
diff --git a/ql/src/test/results/clientpositive/leadlag.q.out b/ql/src/test/results/clientpositive/leadlag.q.out
index 4eb2641c86..c1ac87cc96 100644
--- a/ql/src/test/results/clientpositive/leadlag.q.out
+++ b/ql/src/test/results/clientpositive/leadlag.q.out
@@ -16,6 +16,7 @@ CREATE TABLE part(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part
 POSTHOOK: query: -- data setup
 CREATE TABLE part( 
     p_partkey INT,
diff --git a/ql/src/test/results/clientpositive/leadlag_queries.q.out b/ql/src/test/results/clientpositive/leadlag_queries.q.out
index 3d7f9afa8b..42ef72223a 100644
--- a/ql/src/test/results/clientpositive/leadlag_queries.q.out
+++ b/ql/src/test/results/clientpositive/leadlag_queries.q.out
@@ -12,6 +12,7 @@ CREATE TABLE part(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part
 POSTHOOK: query: -- data setup
 CREATE TABLE part( 
     p_partkey INT,
diff --git a/ql/src/test/results/clientpositive/leftsemijoin.q.out b/ql/src/test/results/clientpositive/leftsemijoin.q.out
index 3e10df1e4d..11f0bb053e 100644
--- a/ql/src/test/results/clientpositive/leftsemijoin.q.out
+++ b/ql/src/test/results/clientpositive/leftsemijoin.q.out
@@ -14,6 +14,7 @@ PREHOOK: query: CREATE TABLE sales (name STRING, id INT)
 ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@sales
 POSTHOOK: query: CREATE TABLE sales (name STRING, id INT)
 ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t'
 POSTHOOK: type: CREATETABLE
@@ -23,6 +24,7 @@ PREHOOK: query: CREATE TABLE things (id INT, name STRING) partitioned by (ds str
 ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@things
 POSTHOOK: query: CREATE TABLE things (id INT, name STRING) partitioned by (ds string)
 ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t'
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/leftsemijoin_mr.q.out b/ql/src/test/results/clientpositive/leftsemijoin_mr.q.out
index 0eeabda230..fe63057f84 100644
--- a/ql/src/test/results/clientpositive/leftsemijoin_mr.q.out
+++ b/ql/src/test/results/clientpositive/leftsemijoin_mr.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE T1(key INT)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: CREATE TABLE T1(key INT)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -16,6 +17,7 @@ POSTHOOK: Output: default@t1
 PREHOOK: query: CREATE TABLE T2(key INT)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T2
 POSTHOOK: query: CREATE TABLE T2(key INT)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/limit_pushdown_negative.q.out b/ql/src/test/results/clientpositive/limit_pushdown_negative.q.out
index f5b92b4b91..cc4211c4d5 100644
--- a/ql/src/test/results/clientpositive/limit_pushdown_negative.q.out
+++ b/ql/src/test/results/clientpositive/limit_pushdown_negative.q.out
@@ -219,6 +219,7 @@ PREHOOK: query: -- negative, RS + forward + multi-groupby
 CREATE TABLE dest_2(key STRING, c1 INT)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_2
 POSTHOOK: query: -- negative, RS + forward + multi-groupby
 CREATE TABLE dest_2(key STRING, c1 INT)
 POSTHOOK: type: CREATETABLE
@@ -227,6 +228,7 @@ POSTHOOK: Output: default@dest_2
 PREHOOK: query: CREATE TABLE dest_3(key STRING, c1 INT)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_3
 POSTHOOK: query: CREATE TABLE dest_3(key STRING, c1 INT)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/lineage1.q.out b/ql/src/test/results/clientpositive/lineage1.q.out
index 6d04f62372..6ad932b2ee 100644
--- a/ql/src/test/results/clientpositive/lineage1.q.out
+++ b/ql/src/test/results/clientpositive/lineage1.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest_l1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_l1
 POSTHOOK: query: CREATE TABLE dest_l1(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/list_bucket_dml_1.q.out b/ql/src/test/results/clientpositive/list_bucket_dml_1.q.out
index b7ac4fcf4e..104d8cc6d4 100644
--- a/ql/src/test/results/clientpositive/list_bucket_dml_1.q.out
+++ b/ql/src/test/results/clientpositive/list_bucket_dml_1.q.out
@@ -9,6 +9,7 @@ skewed by (key) on ("484")
 stored as DIRECTORIES
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@list_bucketing_dynamic_part
 POSTHOOK: query: -- list bucketing DML : dynamic partition and 2 stage query plan.
 
 -- INCLUDE_HADOOP_MAJOR_VERSIONS(0.23)
diff --git a/ql/src/test/results/clientpositive/list_bucket_dml_10.q.out b/ql/src/test/results/clientpositive/list_bucket_dml_10.q.out
index e45ab04a8b..e9367ac694 100644
--- a/ql/src/test/results/clientpositive/list_bucket_dml_10.q.out
+++ b/ql/src/test/results/clientpositive/list_bucket_dml_10.q.out
@@ -19,6 +19,7 @@ create table list_bucketing_static_part (key String, value String)
     STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@list_bucketing_static_part
 POSTHOOK: query: -- run this test case in minimr to ensure it works in cluster
 
 -- list bucketing DML: static partition. multiple skewed columns.
diff --git a/ql/src/test/results/clientpositive/list_bucket_dml_11.q.out b/ql/src/test/results/clientpositive/list_bucket_dml_11.q.out
index fe0f46960c..caea795104 100644
--- a/ql/src/test/results/clientpositive/list_bucket_dml_11.q.out
+++ b/ql/src/test/results/clientpositive/list_bucket_dml_11.q.out
@@ -12,6 +12,7 @@ create table list_bucketing_static_part (key String, value String)
     STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@list_bucketing_static_part
 POSTHOOK: query: -- Ensure it works if skewed column is not the first column in the table columns
 
 -- INCLUDE_HADOOP_MAJOR_VERSIONS(0.23)
diff --git a/ql/src/test/results/clientpositive/list_bucket_dml_12.q.out b/ql/src/test/results/clientpositive/list_bucket_dml_12.q.out
index 6a2c063d71..59df9f3638 100644
--- a/ql/src/test/results/clientpositive/list_bucket_dml_12.q.out
+++ b/ql/src/test/results/clientpositive/list_bucket_dml_12.q.out
@@ -11,6 +11,7 @@ create table list_bucketing_mul_col (col1 String, col2 String, col3 String, col4
     STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@list_bucketing_mul_col
 POSTHOOK: query: -- Ensure it works if skewed column is not the first column in the table columns
 
 -- INCLUDE_HADOOP_MAJOR_VERSIONS(0.23)
diff --git a/ql/src/test/results/clientpositive/list_bucket_dml_13.q.out b/ql/src/test/results/clientpositive/list_bucket_dml_13.q.out
index 4b7863cfe2..b8aebbcc21 100644
--- a/ql/src/test/results/clientpositive/list_bucket_dml_13.q.out
+++ b/ql/src/test/results/clientpositive/list_bucket_dml_13.q.out
@@ -11,6 +11,7 @@ create table list_bucketing_mul_col (col1 String, col2 String, col3 String, col4
     STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@list_bucketing_mul_col
 POSTHOOK: query: -- Ensure skewed value map has escaped directory name
 
 -- INCLUDE_HADOOP_MAJOR_VERSIONS(0.23)
diff --git a/ql/src/test/results/clientpositive/list_bucket_dml_14.q.out b/ql/src/test/results/clientpositive/list_bucket_dml_14.q.out
index 29b96818b6..d53903ed57 100644
--- a/ql/src/test/results/clientpositive/list_bucket_dml_14.q.out
+++ b/ql/src/test/results/clientpositive/list_bucket_dml_14.q.out
@@ -8,6 +8,7 @@ skewed by (key) on ("484")
 stored as DIRECTORIES
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@list_bucketing
 POSTHOOK: query: -- list bucketing DML : unpartitioned table and 2 stage query plan.
 
 -- INCLUDE_HADOOP_MAJOR_VERSIONS(0.23)
diff --git a/ql/src/test/results/clientpositive/list_bucket_dml_2.q.out b/ql/src/test/results/clientpositive/list_bucket_dml_2.q.out
index e0757fb41a..9b3cec66be 100644
--- a/ql/src/test/results/clientpositive/list_bucket_dml_2.q.out
+++ b/ql/src/test/results/clientpositive/list_bucket_dml_2.q.out
@@ -20,6 +20,7 @@ create table list_bucketing_static_part (key String, value String)
     STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@list_bucketing_static_part
 POSTHOOK: query: -- INCLUDE_HADOOP_MAJOR_VERSIONS(0.23)
 -- SORT_QUERY_RESULTS
 
diff --git a/ql/src/test/results/clientpositive/list_bucket_dml_3.q.out b/ql/src/test/results/clientpositive/list_bucket_dml_3.q.out
index 3e641d2745..718b70e898 100644
--- a/ql/src/test/results/clientpositive/list_bucket_dml_3.q.out
+++ b/ql/src/test/results/clientpositive/list_bucket_dml_3.q.out
@@ -6,6 +6,7 @@ PREHOOK: query: -- list bucketing DML : static partition and 2 stage query plan.
 create table list_bucketing_static_part (key String, value String) partitioned by (ds String, hr String) skewed by (key) on ("484") stored as DIRECTORIES
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@list_bucketing_static_part
 POSTHOOK: query: -- list bucketing DML : static partition and 2 stage query plan.
 
 -- INCLUDE_HADOOP_MAJOR_VERSIONS(0.23)
diff --git a/ql/src/test/results/clientpositive/list_bucket_dml_4.q.out b/ql/src/test/results/clientpositive/list_bucket_dml_4.q.out
index 9c4ff6ba20..99496d5952 100644
--- a/ql/src/test/results/clientpositive/list_bucket_dml_4.q.out
+++ b/ql/src/test/results/clientpositive/list_bucket_dml_4.q.out
@@ -24,6 +24,7 @@ create table list_bucketing_static_part (key String, value String)
     STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@list_bucketing_static_part
 POSTHOOK: query: -- INCLUDE_HADOOP_MAJOR_VERSIONS(0.23)
 -- SORT_QUERY_RESULTS
 
diff --git a/ql/src/test/results/clientpositive/list_bucket_dml_5.q.out b/ql/src/test/results/clientpositive/list_bucket_dml_5.q.out
index 9223a8c4c1..ca79fed4e9 100644
--- a/ql/src/test/results/clientpositive/list_bucket_dml_5.q.out
+++ b/ql/src/test/results/clientpositive/list_bucket_dml_5.q.out
@@ -10,6 +10,7 @@ skewed by (key, value) on (('484','val_484'),('51','val_14'),('103','val_103'))
 stored as DIRECTORIES
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@list_bucketing_dynamic_part
 POSTHOOK: query: -- list bucketing DML: multiple skewed columns. 2 stages
 
 -- INCLUDE_HADOOP_MAJOR_VERSIONS(0.23)
diff --git a/ql/src/test/results/clientpositive/list_bucket_dml_6.q.out b/ql/src/test/results/clientpositive/list_bucket_dml_6.q.out
index d1cde40963..d5deadb2b8 100644
--- a/ql/src/test/results/clientpositive/list_bucket_dml_6.q.out
+++ b/ql/src/test/results/clientpositive/list_bucket_dml_6.q.out
@@ -47,6 +47,7 @@ create table list_bucketing_dynamic_part (key String, value String)
     STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@list_bucketing_dynamic_part
 POSTHOOK: query: -- list bucketing DML: dynamic partition. multiple skewed columns. merge.
 -- The following explains merge example used in this test case
 -- DML will generated 2 partitions
diff --git a/ql/src/test/results/clientpositive/list_bucket_dml_7.q.out b/ql/src/test/results/clientpositive/list_bucket_dml_7.q.out
index 19000dc2a4..4aea4db8e7 100644
--- a/ql/src/test/results/clientpositive/list_bucket_dml_7.q.out
+++ b/ql/src/test/results/clientpositive/list_bucket_dml_7.q.out
@@ -21,6 +21,7 @@ CREATE TABLE list_bucketing_dynamic_part (key String, value STRING)
     STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@list_bucketing_dynamic_part
 POSTHOOK: query: -- INCLUDE_HADOOP_MAJOR_VERSIONS(0.23)
 -- SORT_QUERY_RESULTS
 
diff --git a/ql/src/test/results/clientpositive/list_bucket_dml_8.q.out b/ql/src/test/results/clientpositive/list_bucket_dml_8.q.out
index a8c007afca..ad174306b8 100644
--- a/ql/src/test/results/clientpositive/list_bucket_dml_8.q.out
+++ b/ql/src/test/results/clientpositive/list_bucket_dml_8.q.out
@@ -48,6 +48,7 @@ create table list_bucketing_dynamic_part (key String, value String)
     STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@list_bucketing_dynamic_part
 POSTHOOK: query: -- list bucketing alter table ... concatenate: 
 -- Use list bucketing DML to generate mutilple files in partitions by turning off merge
 -- dynamic partition. multiple skewed columns. merge.
diff --git a/ql/src/test/results/clientpositive/list_bucket_dml_9.q.out b/ql/src/test/results/clientpositive/list_bucket_dml_9.q.out
index 692bc1076d..f94a3cc208 100644
--- a/ql/src/test/results/clientpositive/list_bucket_dml_9.q.out
+++ b/ql/src/test/results/clientpositive/list_bucket_dml_9.q.out
@@ -24,6 +24,7 @@ create table list_bucketing_static_part (key String, value String)
     STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@list_bucketing_static_part
 POSTHOOK: query: -- INCLUDE_HADOOP_MAJOR_VERSIONS(0.23)
 -- SORT_QUERY_RESULTS
 
diff --git a/ql/src/test/results/clientpositive/list_bucket_query_multiskew_1.q.out b/ql/src/test/results/clientpositive/list_bucket_query_multiskew_1.q.out
index 4adfc7c5e5..5e9c0ff1c2 100644
--- a/ql/src/test/results/clientpositive/list_bucket_query_multiskew_1.q.out
+++ b/ql/src/test/results/clientpositive/list_bucket_query_multiskew_1.q.out
@@ -18,6 +18,7 @@ skewed by (key, value) on (('484','val_484'),('238','val_238'))
 stored as DIRECTORIES
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@fact_daily
 POSTHOOK: query: -- INCLUDE_HADOOP_MAJOR_VERSIONS(0.23)	
 
 -- List bucketing query logic test case. We simulate the directory structure by DML here. 
diff --git a/ql/src/test/results/clientpositive/list_bucket_query_multiskew_2.q.out b/ql/src/test/results/clientpositive/list_bucket_query_multiskew_2.q.out
index 00a7365dfb..2fc5d7fe88 100644
--- a/ql/src/test/results/clientpositive/list_bucket_query_multiskew_2.q.out
+++ b/ql/src/test/results/clientpositive/list_bucket_query_multiskew_2.q.out
@@ -18,6 +18,7 @@ skewed by (key, value) on (('484','val_484'),('238','val_238'))
 stored as DIRECTORIES
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@fact_daily
 POSTHOOK: query: -- INCLUDE_HADOOP_MAJOR_VERSIONS(0.23)	
 -- SORT_QUERY_RESULTS
 
diff --git a/ql/src/test/results/clientpositive/list_bucket_query_multiskew_3.q.out b/ql/src/test/results/clientpositive/list_bucket_query_multiskew_3.q.out
index f5392653e5..b8fe43075b 100644
--- a/ql/src/test/results/clientpositive/list_bucket_query_multiskew_3.q.out
+++ b/ql/src/test/results/clientpositive/list_bucket_query_multiskew_3.q.out
@@ -17,6 +17,7 @@ create table fact_daily (key String, value String)
 partitioned by (ds String, hr String)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@fact_daily
 POSTHOOK: query: -- INCLUDE_HADOOP_MAJOR_VERSIONS(0.23)	
 
 -- List bucketing query logic test case. We simulate the directory structure by DML here.
diff --git a/ql/src/test/results/clientpositive/list_bucket_query_oneskew_1.q.out b/ql/src/test/results/clientpositive/list_bucket_query_oneskew_1.q.out
index 167476877e..f0c681cc62 100644
--- a/ql/src/test/results/clientpositive/list_bucket_query_oneskew_1.q.out
+++ b/ql/src/test/results/clientpositive/list_bucket_query_oneskew_1.q.out
@@ -16,6 +16,7 @@ PREHOOK: query: -- INCLUDE_HADOOP_MAJOR_VERSIONS(0.23)
 CREATE TABLE fact_daily(x int) PARTITIONED BY (ds STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@fact_daily
 POSTHOOK: query: -- INCLUDE_HADOOP_MAJOR_VERSIONS(0.23)	
 -- SORT_QUERY_RESULTS
 
@@ -40,6 +41,7 @@ PREHOOK: query: CREATE TABLE fact_tz(x int) PARTITIONED BY (ds STRING, hr STRING
 PREHOOK: type: CREATETABLE
 #### A masked pattern was here ####
 PREHOOK: Output: database:default
+PREHOOK: Output: default@fact_tz
 POSTHOOK: query: CREATE TABLE fact_tz(x int) PARTITIONED BY (ds STRING, hr STRING)	
 #### A masked pattern was here ####
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/list_bucket_query_oneskew_2.q.out b/ql/src/test/results/clientpositive/list_bucket_query_oneskew_2.q.out
index 7e2298c53d..221ee709ab 100644
--- a/ql/src/test/results/clientpositive/list_bucket_query_oneskew_2.q.out
+++ b/ql/src/test/results/clientpositive/list_bucket_query_oneskew_2.q.out
@@ -17,6 +17,7 @@ PREHOOK: query: -- INCLUDE_HADOOP_MAJOR_VERSIONS(0.23)
 CREATE TABLE fact_daily(x int, y STRING) PARTITIONED BY (ds STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@fact_daily
 POSTHOOK: query: -- INCLUDE_HADOOP_MAJOR_VERSIONS(0.23)	
 -- SORT_QUERY_RESULTS
 
@@ -42,6 +43,7 @@ PREHOOK: query: CREATE TABLE fact_tz(x int, y STRING) PARTITIONED BY (ds STRING,
 PREHOOK: type: CREATETABLE
 #### A masked pattern was here ####
 PREHOOK: Output: database:default
+PREHOOK: Output: default@fact_tz
 POSTHOOK: query: CREATE TABLE fact_tz(x int, y STRING) PARTITIONED BY (ds STRING, hr STRING)	
 #### A masked pattern was here ####
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/list_bucket_query_oneskew_3.q.out b/ql/src/test/results/clientpositive/list_bucket_query_oneskew_3.q.out
index 01a80811eb..d6a075bb0c 100644
--- a/ql/src/test/results/clientpositive/list_bucket_query_oneskew_3.q.out
+++ b/ql/src/test/results/clientpositive/list_bucket_query_oneskew_3.q.out
@@ -17,6 +17,7 @@ PREHOOK: query: -- INCLUDE_HADOOP_MAJOR_VERSIONS(0.23)
 CREATE TABLE fact_daily(x int, y STRING, z STRING) PARTITIONED BY (ds STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@fact_daily
 POSTHOOK: query: -- INCLUDE_HADOOP_MAJOR_VERSIONS(0.23)	
 -- SORT_QUERY_RESULTS
 
@@ -42,6 +43,7 @@ PREHOOK: query: CREATE TABLE fact_tz(x int, y STRING, z STRING) PARTITIONED BY (
 PREHOOK: type: CREATETABLE
 #### A masked pattern was here ####
 PREHOOK: Output: database:default
+PREHOOK: Output: default@fact_tz
 POSTHOOK: query: CREATE TABLE fact_tz(x int, y STRING, z STRING) PARTITIONED BY (ds STRING, hr STRING)	
 #### A masked pattern was here ####
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/load_binary_data.q.out b/ql/src/test/results/clientpositive/load_binary_data.q.out
index fb8c85f056..fb7f42bf14 100644
--- a/ql/src/test/results/clientpositive/load_binary_data.q.out
+++ b/ql/src/test/results/clientpositive/load_binary_data.q.out
@@ -4,6 +4,7 @@ FIELDS TERMINATED BY '9'
 STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@mytable
 POSTHOOK: query: CREATE TABLE mytable(key binary, value int)
 ROW FORMAT DELIMITED
 FIELDS TERMINATED BY '9'
@@ -26,6 +27,7 @@ POSTHOOK: Output: default@mytable
 PREHOOK: query: create table dest1 (key binary, value int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: create table dest1 (key binary, value int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/load_dyn_part1.q.out b/ql/src/test/results/clientpositive/load_dyn_part1.q.out
index ba2177f873..205ee4918a 100644
--- a/ql/src/test/results/clientpositive/load_dyn_part1.q.out
+++ b/ql/src/test/results/clientpositive/load_dyn_part1.q.out
@@ -15,6 +15,7 @@ ds=2008-04-09/hr=12
 PREHOOK: query: create table if not exists nzhang_part1 like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@nzhang_part1
 POSTHOOK: query: create table if not exists nzhang_part1 like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -22,6 +23,7 @@ POSTHOOK: Output: default@nzhang_part1
 PREHOOK: query: create table if not exists nzhang_part2 like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@nzhang_part2
 POSTHOOK: query: create table if not exists nzhang_part2 like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/load_dyn_part10.q.out b/ql/src/test/results/clientpositive/load_dyn_part10.q.out
index 81b395f1fc..666f2ce26b 100644
--- a/ql/src/test/results/clientpositive/load_dyn_part10.q.out
+++ b/ql/src/test/results/clientpositive/load_dyn_part10.q.out
@@ -15,6 +15,7 @@ ds=2008-04-09/hr=12
 PREHOOK: query: create table if not exists nzhang_part10 like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@nzhang_part10
 POSTHOOK: query: create table if not exists nzhang_part10 like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/load_dyn_part11.q.out b/ql/src/test/results/clientpositive/load_dyn_part11.q.out
index 2cd19e24a9..225a6c9e36 100644
--- a/ql/src/test/results/clientpositive/load_dyn_part11.q.out
+++ b/ql/src/test/results/clientpositive/load_dyn_part11.q.out
@@ -11,6 +11,7 @@ ds=2008-04-09/hr=12
 PREHOOK: query: create table if not exists nzhang_part like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@nzhang_part
 POSTHOOK: query: create table if not exists nzhang_part like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/load_dyn_part12.q.out b/ql/src/test/results/clientpositive/load_dyn_part12.q.out
index bd7a26ecb5..bb511599e1 100644
--- a/ql/src/test/results/clientpositive/load_dyn_part12.q.out
+++ b/ql/src/test/results/clientpositive/load_dyn_part12.q.out
@@ -11,6 +11,7 @@ ds=2008-04-09/hr=12
 PREHOOK: query: create table if not exists nzhang_part12 like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@nzhang_part12
 POSTHOOK: query: create table if not exists nzhang_part12 like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/load_dyn_part13.q.out b/ql/src/test/results/clientpositive/load_dyn_part13.q.out
index 780cabb5a7..dd94ac56f5 100644
--- a/ql/src/test/results/clientpositive/load_dyn_part13.q.out
+++ b/ql/src/test/results/clientpositive/load_dyn_part13.q.out
@@ -11,6 +11,7 @@ ds=2008-04-09/hr=12
 PREHOOK: query: create table if not exists nzhang_part13 like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@nzhang_part13
 POSTHOOK: query: create table if not exists nzhang_part13 like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/load_dyn_part14.q.out b/ql/src/test/results/clientpositive/load_dyn_part14.q.out
index 8238b63551..1db00c910d 100644
--- a/ql/src/test/results/clientpositive/load_dyn_part14.q.out
+++ b/ql/src/test/results/clientpositive/load_dyn_part14.q.out
@@ -7,6 +7,7 @@ create table if not exists nzhang_part14 (key string)
   partitioned by (value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@nzhang_part14
 POSTHOOK: query: -- EXCLUDE_OS_WINDOWS
 -- excluded on windows because of difference in file name encoding logic
 
diff --git a/ql/src/test/results/clientpositive/load_dyn_part15.q.out b/ql/src/test/results/clientpositive/load_dyn_part15.q.out
index 1eaa245375..b10549790b 100644
--- a/ql/src/test/results/clientpositive/load_dyn_part15.q.out
+++ b/ql/src/test/results/clientpositive/load_dyn_part15.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: create table if not exists load_dyn_part15_test (key string)
   partitioned by (part_key string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@load_dyn_part15_test
 POSTHOOK: query: create table if not exists load_dyn_part15_test (key string) 
   partitioned by (part_key string)
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/load_dyn_part2.q.out b/ql/src/test/results/clientpositive/load_dyn_part2.q.out
index 4b05798818..855cca44cc 100644
--- a/ql/src/test/results/clientpositive/load_dyn_part2.q.out
+++ b/ql/src/test/results/clientpositive/load_dyn_part2.q.out
@@ -5,6 +5,7 @@ create table if not exists nzhang_part_bucket (key string, value string)
   clustered by (key) into 10 buckets
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@nzhang_part_bucket
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 create table if not exists nzhang_part_bucket (key string, value string) 
diff --git a/ql/src/test/results/clientpositive/load_dyn_part3.q.out b/ql/src/test/results/clientpositive/load_dyn_part3.q.out
index 3187898a4d..38a903e6e1 100644
--- a/ql/src/test/results/clientpositive/load_dyn_part3.q.out
+++ b/ql/src/test/results/clientpositive/load_dyn_part3.q.out
@@ -15,6 +15,7 @@ ds=2008-04-09/hr=12
 PREHOOK: query: create table if not exists nzhang_part3 like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@nzhang_part3
 POSTHOOK: query: create table if not exists nzhang_part3 like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/load_dyn_part4.q.out b/ql/src/test/results/clientpositive/load_dyn_part4.q.out
index 8cb1705d42..49db012c93 100644
--- a/ql/src/test/results/clientpositive/load_dyn_part4.q.out
+++ b/ql/src/test/results/clientpositive/load_dyn_part4.q.out
@@ -15,6 +15,7 @@ ds=2008-04-09/hr=12
 PREHOOK: query: create table if not exists nzhang_part4 like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@nzhang_part4
 POSTHOOK: query: create table if not exists nzhang_part4 like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/load_dyn_part5.q.out b/ql/src/test/results/clientpositive/load_dyn_part5.q.out
index a791ea1a88..a627bc438b 100644
--- a/ql/src/test/results/clientpositive/load_dyn_part5.q.out
+++ b/ql/src/test/results/clientpositive/load_dyn_part5.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table if not exists nzhang_part5 (key string) partitioned by (value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@nzhang_part5
 POSTHOOK: query: create table if not exists nzhang_part5 (key string) partitioned by (value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/load_dyn_part6.q.out b/ql/src/test/results/clientpositive/load_dyn_part6.q.out
index 11df113243..fce8eff2df 100644
--- a/ql/src/test/results/clientpositive/load_dyn_part6.q.out
+++ b/ql/src/test/results/clientpositive/load_dyn_part6.q.out
@@ -11,6 +11,7 @@ ds=2008-04-09/hr=12
 PREHOOK: query: create table if not exists nzhang_part6 like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@nzhang_part6
 POSTHOOK: query: create table if not exists nzhang_part6 like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/load_dyn_part7.q.out b/ql/src/test/results/clientpositive/load_dyn_part7.q.out
index 9bb4dff8e2..02f932770d 100644
--- a/ql/src/test/results/clientpositive/load_dyn_part7.q.out
+++ b/ql/src/test/results/clientpositive/load_dyn_part7.q.out
@@ -11,6 +11,7 @@ ds=2008-04-09/hr=12
 PREHOOK: query: create table if not exists nzhang_part7 like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@nzhang_part7
 POSTHOOK: query: create table if not exists nzhang_part7 like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/load_dyn_part8.q.out b/ql/src/test/results/clientpositive/load_dyn_part8.q.out
index 5994deb559..d3558a7949 100644
--- a/ql/src/test/results/clientpositive/load_dyn_part8.q.out
+++ b/ql/src/test/results/clientpositive/load_dyn_part8.q.out
@@ -15,6 +15,7 @@ ds=2008-04-09/hr=12
 PREHOOK: query: create table if not exists nzhang_part8 like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@nzhang_part8
 POSTHOOK: query: create table if not exists nzhang_part8 like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/load_dyn_part9.q.out b/ql/src/test/results/clientpositive/load_dyn_part9.q.out
index 583094cf20..fdafd3094c 100644
--- a/ql/src/test/results/clientpositive/load_dyn_part9.q.out
+++ b/ql/src/test/results/clientpositive/load_dyn_part9.q.out
@@ -15,6 +15,7 @@ ds=2008-04-09/hr=12
 PREHOOK: query: create table if not exists nzhang_part9 like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@nzhang_part9
 POSTHOOK: query: create table if not exists nzhang_part9 like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/load_exist_part_authsuccess.q.out b/ql/src/test/results/clientpositive/load_exist_part_authsuccess.q.out
index 65f954fb19..8ec7e628ec 100644
--- a/ql/src/test/results/clientpositive/load_exist_part_authsuccess.q.out
+++ b/ql/src/test/results/clientpositive/load_exist_part_authsuccess.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table hive_test_src ( col1 string ) partitioned by (pcol1 string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@hive_test_src
 POSTHOOK: query: create table hive_test_src ( col1 string ) partitioned by (pcol1 string) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/load_file_with_space_in_the_name.q.out b/ql/src/test/results/clientpositive/load_file_with_space_in_the_name.q.out
index 8b6313febb..2072651218 100644
--- a/ql/src/test/results/clientpositive/load_file_with_space_in_the_name.q.out
+++ b/ql/src/test/results/clientpositive/load_file_with_space_in_the_name.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: -- test for loading into tables with the file with space in the
 CREATE TABLE load_file_with_space_in_the_name(name STRING, age INT)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@load_file_with_space_in_the_name
 POSTHOOK: query: -- test for loading into tables with the file with space in the name
 
 
diff --git a/ql/src/test/results/clientpositive/load_fs.q.out b/ql/src/test/results/clientpositive/load_fs.q.out
index 5770a639f8..1bb4cb1d12 100644
--- a/ql/src/test/results/clientpositive/load_fs.q.out
+++ b/ql/src/test/results/clientpositive/load_fs.q.out
@@ -2,6 +2,7 @@
 PREHOOK: type: CREATETABLE
 #### A masked pattern was here ####
 PREHOOK: Output: database:default
+PREHOOK: Output: default@load_overwrite
 #### A masked pattern was here ####
 POSTHOOK: type: CREATETABLE
 #### A masked pattern was here ####
@@ -11,6 +12,7 @@ POSTHOOK: Output: default@load_overwrite
 PREHOOK: type: CREATETABLE
 #### A masked pattern was here ####
 PREHOOK: Output: database:default
+PREHOOK: Output: default@load_overwrite2
 #### A masked pattern was here ####
 POSTHOOK: type: CREATETABLE
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/load_fs2.q.out b/ql/src/test/results/clientpositive/load_fs2.q.out
index 7fe62e41ce..18465424ce 100644
--- a/ql/src/test/results/clientpositive/load_fs2.q.out
+++ b/ql/src/test/results/clientpositive/load_fs2.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: -- HIVE-3300 [jira] LOAD DATA INPATH fails if a hdfs file with s
 create table result (key string, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@result
 POSTHOOK: query: -- HIVE-3300 [jira] LOAD DATA INPATH fails if a hdfs file with same name is added to table
 -- 'loader' table is used only for uploading kv1.txt to HDFS (!hdfs -put is not working on minMRDriver)
 
@@ -14,6 +15,7 @@ POSTHOOK: Output: default@result
 PREHOOK: query: create table loader (key string, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@loader
 POSTHOOK: query: create table loader (key string, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/load_fs_overwrite.q.out b/ql/src/test/results/clientpositive/load_fs_overwrite.q.out
index 69fb9693b7..cafcdde8e1 100644
--- a/ql/src/test/results/clientpositive/load_fs_overwrite.q.out
+++ b/ql/src/test/results/clientpositive/load_fs_overwrite.q.out
@@ -14,6 +14,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: type: CREATETABLE
 #### A masked pattern was here ####
 PREHOOK: Output: database:default
+PREHOOK: Output: default@target
 #### A masked pattern was here ####
 POSTHOOK: type: CREATETABLE
 #### A masked pattern was here ####
@@ -23,6 +24,7 @@ POSTHOOK: Output: default@target
 PREHOOK: type: CREATETABLE
 #### A masked pattern was here ####
 PREHOOK: Output: database:default
+PREHOOK: Output: default@temp
 #### A masked pattern was here ####
 POSTHOOK: type: CREATETABLE
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/load_hdfs_file_with_space_in_the_name.q.out b/ql/src/test/results/clientpositive/load_hdfs_file_with_space_in_the_name.q.out
index d6c8bdf760..d934722f97 100644
--- a/ql/src/test/results/clientpositive/load_hdfs_file_with_space_in_the_name.q.out
+++ b/ql/src/test/results/clientpositive/load_hdfs_file_with_space_in_the_name.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE load_file_with_space_in_the_name(name STRING, age INT)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@load_file_with_space_in_the_name
 POSTHOOK: query: CREATE TABLE load_file_with_space_in_the_name(name STRING, age INT)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/load_local_dir_test.q.out b/ql/src/test/results/clientpositive/load_local_dir_test.q.out
index 4492255ff3..88d259db3c 100644
--- a/ql/src/test/results/clientpositive/load_local_dir_test.q.out
+++ b/ql/src/test/results/clientpositive/load_local_dir_test.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table load_local (id INT)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@load_local
 POSTHOOK: query: create table load_local (id INT)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/load_nonpart_authsuccess.q.out b/ql/src/test/results/clientpositive/load_nonpart_authsuccess.q.out
index f3b8d49997..6ed6f9c6b3 100644
--- a/ql/src/test/results/clientpositive/load_nonpart_authsuccess.q.out
+++ b/ql/src/test/results/clientpositive/load_nonpart_authsuccess.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table hive_test_src ( col1 string ) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@hive_test_src
 POSTHOOK: query: create table hive_test_src ( col1 string ) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/load_overwrite.q.out b/ql/src/test/results/clientpositive/load_overwrite.q.out
index 869c332520..6edd1b6d22 100644
--- a/ql/src/test/results/clientpositive/load_overwrite.q.out
+++ b/ql/src/test/results/clientpositive/load_overwrite.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table load_overwrite like src
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@load_overwrite
 POSTHOOK: query: create table load_overwrite like src
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/load_part_authsuccess.q.out b/ql/src/test/results/clientpositive/load_part_authsuccess.q.out
index 75f06097c3..8249dce82f 100644
--- a/ql/src/test/results/clientpositive/load_part_authsuccess.q.out
+++ b/ql/src/test/results/clientpositive/load_part_authsuccess.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table hive_test_src ( col1 string ) partitioned by (pcol1 string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@hive_test_src
 POSTHOOK: query: create table hive_test_src ( col1 string ) partitioned by (pcol1 string) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/loadpart1.q.out b/ql/src/test/results/clientpositive/loadpart1.q.out
index da17adb703..43a0840987 100644
--- a/ql/src/test/results/clientpositive/loadpart1.q.out
+++ b/ql/src/test/results/clientpositive/loadpart1.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table hive_test_src ( col1 string ) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@hive_test_src
 POSTHOOK: query: create table hive_test_src ( col1 string ) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -16,6 +17,7 @@ POSTHOOK: Output: default@hive_test_src
 PREHOOK: query: create table hive_test_dst ( col1 string ) partitioned by ( pcol1 string , pcol2 string) stored as sequencefile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@hive_test_dst
 POSTHOOK: query: create table hive_test_dst ( col1 string ) partitioned by ( pcol1 string , pcol2 string) stored as sequencefile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/loadpart2.q.out b/ql/src/test/results/clientpositive/loadpart2.q.out
index 44c99a15f2..201a9572f0 100644
--- a/ql/src/test/results/clientpositive/loadpart2.q.out
+++ b/ql/src/test/results/clientpositive/loadpart2.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table hive_test ( col1 string ) partitioned by ( pcol1 string , pcol2 string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@hive_test
 POSTHOOK: query: create table hive_test ( col1 string ) partitioned by ( pcol1 string , pcol2 string) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/lock1.q.out b/ql/src/test/results/clientpositive/lock1.q.out
index e89d745a3a..27545ea584 100644
--- a/ql/src/test/results/clientpositive/lock1.q.out
+++ b/ql/src/test/results/clientpositive/lock1.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table tstsrc like src
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tstsrc
 POSTHOOK: query: create table tstsrc like src
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/lock2.q.out b/ql/src/test/results/clientpositive/lock2.q.out
index f8dd6faae0..e699a8dc4b 100644
--- a/ql/src/test/results/clientpositive/lock2.q.out
+++ b/ql/src/test/results/clientpositive/lock2.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table tstsrc like src
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tstsrc
 POSTHOOK: query: create table tstsrc like src
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -26,6 +27,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table tstsrcpart like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tstsrcpart
 POSTHOOK: query: create table tstsrcpart like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/lock3.q.out b/ql/src/test/results/clientpositive/lock3.q.out
index 3815a59eec..ec9f09d580 100644
--- a/ql/src/test/results/clientpositive/lock3.q.out
+++ b/ql/src/test/results/clientpositive/lock3.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table tstsrcpart like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tstsrcpart
 POSTHOOK: query: create table tstsrcpart like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -86,6 +87,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table tst1 (key string, value string) partitioned by (a string, b string, c string, d string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tst1
 POSTHOOK: query: create table tst1 (key string, value string) partitioned by (a string, b string, c string, d string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/lock4.q.out b/ql/src/test/results/clientpositive/lock4.q.out
index 3815a59eec..ec9f09d580 100644
--- a/ql/src/test/results/clientpositive/lock4.q.out
+++ b/ql/src/test/results/clientpositive/lock4.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table tstsrcpart like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tstsrcpart
 POSTHOOK: query: create table tstsrcpart like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -86,6 +87,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table tst1 (key string, value string) partitioned by (a string, b string, c string, d string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tst1
 POSTHOOK: query: create table tst1 (key string, value string) partitioned by (a string, b string, c string, d string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/mapjoin_addjar.q.out b/ql/src/test/results/clientpositive/mapjoin_addjar.q.out
index 1fd8f7a4a7..c1078182b3 100644
--- a/ql/src/test/results/clientpositive/mapjoin_addjar.q.out
+++ b/ql/src/test/results/clientpositive/mapjoin_addjar.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: CREATE TABLE t1 (a string, b string)
 ROW FORMAT SERDE 'org.apache.hive.hcatalog.data.JsonSerDe'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t1
 POSTHOOK: query: CREATE TABLE t1 (a string, b string)
 ROW FORMAT SERDE 'org.apache.hive.hcatalog.data.JsonSerDe'
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/mapjoin_hook.q.out b/ql/src/test/results/clientpositive/mapjoin_hook.q.out
index 815e4d5d59..89632f2e73 100644
--- a/ql/src/test/results/clientpositive/mapjoin_hook.q.out
+++ b/ql/src/test/results/clientpositive/mapjoin_hook.q.out
@@ -4,6 +4,7 @@ RUN: Stage-0:DDL
 PREHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 RUN: Stage-0:DDL
 PREHOOK: query: INSERT OVERWRITE TABLE dest1 
 SELECT /*+ MAPJOIN(x) */ x.key, count(1) FROM src1 x JOIN src y ON (x.key = y.key) group by x.key
diff --git a/ql/src/test/results/clientpositive/mapjoin_memcheck.q.out b/ql/src/test/results/clientpositive/mapjoin_memcheck.q.out
index 36abdc7001..b3463946cf 100644
--- a/ql/src/test/results/clientpositive/mapjoin_memcheck.q.out
+++ b/ql/src/test/results/clientpositive/mapjoin_memcheck.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 create table src0 like src
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src0
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 create table src0 like src
diff --git a/ql/src/test/results/clientpositive/mapjoin_subquery2.q.out b/ql/src/test/results/clientpositive/mapjoin_subquery2.q.out
index eebcaa2e41..ab3d8c9125 100644
--- a/ql/src/test/results/clientpositive/mapjoin_subquery2.q.out
+++ b/ql/src/test/results/clientpositive/mapjoin_subquery2.q.out
@@ -14,6 +14,7 @@ PREHOOK: query: CREATE TABLE x (name STRING, id INT)
 ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@x
 POSTHOOK: query: CREATE TABLE x (name STRING, id INT)
 ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t'
 POSTHOOK: type: CREATETABLE
@@ -23,6 +24,7 @@ PREHOOK: query: CREATE TABLE y (id INT, name STRING)
 ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@y
 POSTHOOK: query: CREATE TABLE y (id INT, name STRING)
 ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t'
 POSTHOOK: type: CREATETABLE
@@ -32,6 +34,7 @@ PREHOOK: query: CREATE TABLE z (id INT, name STRING)
 ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@z
 POSTHOOK: query: CREATE TABLE z (id INT, name STRING)
 ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t'
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/mapjoin_test_outer.q.out b/ql/src/test/results/clientpositive/mapjoin_test_outer.q.out
index 41fb50f747..6c47a0b28e 100644
--- a/ql/src/test/results/clientpositive/mapjoin_test_outer.q.out
+++ b/ql/src/test/results/clientpositive/mapjoin_test_outer.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: --HIVE-2101 mapjoin sometimes gives wrong results if there is a
 create table dest_1 (key STRING, value STRING) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_1
 POSTHOOK: query: --HIVE-2101 mapjoin sometimes gives wrong results if there is a filter in the on condition
 
 create table dest_1 (key STRING, value STRING) stored as textfile
@@ -32,6 +33,7 @@ POSTHOOK: Lineage: dest_1.value SIMPLE []
 PREHOOK: query: create table dest_2 (key STRING, value STRING) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_2
 POSTHOOK: query: create table dest_2 (key STRING, value STRING) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/mapreduce1.q.out b/ql/src/test/results/clientpositive/mapreduce1.q.out
index 0d31fca179..9c1f0aa02e 100644
--- a/ql/src/test/results/clientpositive/mapreduce1.q.out
+++ b/ql/src/test/results/clientpositive/mapreduce1.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key INT, ten INT, one INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key INT, ten INT, one INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/mapreduce2.q.out b/ql/src/test/results/clientpositive/mapreduce2.q.out
index b7ebf0695b..03660fdbe8 100644
--- a/ql/src/test/results/clientpositive/mapreduce2.q.out
+++ b/ql/src/test/results/clientpositive/mapreduce2.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key INT, ten INT, one INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key INT, ten INT, one INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/mapreduce3.q.out b/ql/src/test/results/clientpositive/mapreduce3.q.out
index deb14f50cb..355e05382d 100644
--- a/ql/src/test/results/clientpositive/mapreduce3.q.out
+++ b/ql/src/test/results/clientpositive/mapreduce3.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key INT, ten INT, one INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key INT, ten INT, one INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/mapreduce4.q.out b/ql/src/test/results/clientpositive/mapreduce4.q.out
index ecc6de6dcd..657bb37891 100644
--- a/ql/src/test/results/clientpositive/mapreduce4.q.out
+++ b/ql/src/test/results/clientpositive/mapreduce4.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key INT, ten INT, one INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key INT, ten INT, one INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/mapreduce5.q.out b/ql/src/test/results/clientpositive/mapreduce5.q.out
index 109d697435..306b2cdd40 100644
--- a/ql/src/test/results/clientpositive/mapreduce5.q.out
+++ b/ql/src/test/results/clientpositive/mapreduce5.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key INT, ten INT, one INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key INT, ten INT, one INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/mapreduce6.q.out b/ql/src/test/results/clientpositive/mapreduce6.q.out
index 81066156a4..17f38559ad 100644
--- a/ql/src/test/results/clientpositive/mapreduce6.q.out
+++ b/ql/src/test/results/clientpositive/mapreduce6.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key INT, ten INT, one INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key INT, ten INT, one INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/mapreduce7.q.out b/ql/src/test/results/clientpositive/mapreduce7.q.out
index f6d724ac0c..8f95f9da1a 100644
--- a/ql/src/test/results/clientpositive/mapreduce7.q.out
+++ b/ql/src/test/results/clientpositive/mapreduce7.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(k STRING, v STRING, key INT, ten INT, one INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(k STRING, v STRING, key INT, ten INT, one INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/mapreduce8.q.out b/ql/src/test/results/clientpositive/mapreduce8.q.out
index 9132ee9b40..a5af9c58f4 100644
--- a/ql/src/test/results/clientpositive/mapreduce8.q.out
+++ b/ql/src/test/results/clientpositive/mapreduce8.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(k STRING, v STRING, key INT, ten INT, one INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(k STRING, v STRING, key INT, ten INT, one INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/merge1.q.out b/ql/src/test/results/clientpositive/merge1.q.out
index a6c3f5bb53..986ae785be 100644
--- a/ql/src/test/results/clientpositive/merge1.q.out
+++ b/ql/src/test/results/clientpositive/merge1.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table dest1(key int, val int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: create table dest1(key int, val int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -458,6 +459,7 @@ POSTHOOK: Output: default@dest1
 PREHOOK: query: create table test_src(key string, value string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_src
 POSTHOOK: query: create table test_src(key string, value string) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -465,6 +467,7 @@ POSTHOOK: Output: default@test_src
 PREHOOK: query: create table dest1(key string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: create table dest1(key string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/merge2.q.out b/ql/src/test/results/clientpositive/merge2.q.out
index 7bb6e36a72..b6639b559c 100644
--- a/ql/src/test/results/clientpositive/merge2.q.out
+++ b/ql/src/test/results/clientpositive/merge2.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table test1(key int, val int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test1
 POSTHOOK: query: create table test1(key int, val int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -458,6 +459,7 @@ POSTHOOK: Output: default@test1
 PREHOOK: query: create table test_src(key string, value string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_src
 POSTHOOK: query: create table test_src(key string, value string) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -465,6 +467,7 @@ POSTHOOK: Output: default@test_src
 PREHOOK: query: create table test1(key string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test1
 POSTHOOK: query: create table test1(key string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/merge3.q.out b/ql/src/test/results/clientpositive/merge3.q.out
index 21f3940eb4..ad666e21e5 100644
--- a/ql/src/test/results/clientpositive/merge3.q.out
+++ b/ql/src/test/results/clientpositive/merge3.q.out
@@ -22,6 +22,7 @@ POSTHOOK: Output: default@merge_src
 PREHOOK: query: create table merge_src_part (key string, value string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@merge_src_part
 POSTHOOK: query: create table merge_src_part (key string, value string) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -2371,6 +2372,7 @@ Storage Desc Params:
 PREHOOK: query: create table merge_src_part2 like merge_src_part
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@merge_src_part2
 POSTHOOK: query: create table merge_src_part2 like merge_src_part
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -4823,6 +4825,7 @@ POSTHOOK: Output: default@merge_src_part2
 PREHOOK: query: create table merge_src_part2 like merge_src_part
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@merge_src_part2
 POSTHOOK: query: create table merge_src_part2 like merge_src_part
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/merge4.q.out b/ql/src/test/results/clientpositive/merge4.q.out
index 45a96e7d79..b7ea0920a1 100644
--- a/ql/src/test/results/clientpositive/merge4.q.out
+++ b/ql/src/test/results/clientpositive/merge4.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 create table nzhang_part like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@nzhang_part
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 create table nzhang_part like srcpart
diff --git a/ql/src/test/results/clientpositive/merge_dynamic_partition.q.out b/ql/src/test/results/clientpositive/merge_dynamic_partition.q.out
index f1daf68f68..85294bfbeb 100644
--- a/ql/src/test/results/clientpositive/merge_dynamic_partition.q.out
+++ b/ql/src/test/results/clientpositive/merge_dynamic_partition.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 create table srcpart_merge_dp like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcpart_merge_dp
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 create table srcpart_merge_dp like srcpart
@@ -12,6 +13,7 @@ POSTHOOK: Output: default@srcpart_merge_dp
 PREHOOK: query: create table merge_dynamic_part like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@merge_dynamic_part
 POSTHOOK: query: create table merge_dynamic_part like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/merge_dynamic_partition2.q.out b/ql/src/test/results/clientpositive/merge_dynamic_partition2.q.out
index edbe4644bd..5a2afb01ac 100644
--- a/ql/src/test/results/clientpositive/merge_dynamic_partition2.q.out
+++ b/ql/src/test/results/clientpositive/merge_dynamic_partition2.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table srcpart_merge_dp like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcpart_merge_dp
 POSTHOOK: query: create table srcpart_merge_dp like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@srcpart_merge_dp
 PREHOOK: query: create table merge_dynamic_part like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@merge_dynamic_part
 POSTHOOK: query: create table merge_dynamic_part like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/merge_dynamic_partition3.q.out b/ql/src/test/results/clientpositive/merge_dynamic_partition3.q.out
index a78dbc2c82..06b11dc43c 100644
--- a/ql/src/test/results/clientpositive/merge_dynamic_partition3.q.out
+++ b/ql/src/test/results/clientpositive/merge_dynamic_partition3.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 create table srcpart_merge_dp like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcpart_merge_dp
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 create table srcpart_merge_dp like srcpart
@@ -12,6 +13,7 @@ POSTHOOK: Output: default@srcpart_merge_dp
 PREHOOK: query: create table merge_dynamic_part like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@merge_dynamic_part
 POSTHOOK: query: create table merge_dynamic_part like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/merge_dynamic_partition4.q.out b/ql/src/test/results/clientpositive/merge_dynamic_partition4.q.out
index 0f57a2172d..0899648c10 100644
--- a/ql/src/test/results/clientpositive/merge_dynamic_partition4.q.out
+++ b/ql/src/test/results/clientpositive/merge_dynamic_partition4.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: -- this test verifies that the block merge task that can follow
 create table srcpart_merge_dp like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcpart_merge_dp
 POSTHOOK: query: -- this test verifies that the block merge task that can follow a query to generate dynamic
 -- partitions does not produce incorrect results by dropping partitions
 
@@ -14,6 +15,7 @@ POSTHOOK: Output: default@srcpart_merge_dp
 PREHOOK: query: create table srcpart_merge_dp_rc like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcpart_merge_dp_rc
 POSTHOOK: query: create table srcpart_merge_dp_rc like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -29,6 +31,7 @@ POSTHOOK: Output: default@srcpart_merge_dp_rc
 PREHOOK: query: create table merge_dynamic_part like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@merge_dynamic_part
 POSTHOOK: query: create table merge_dynamic_part like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/merge_dynamic_partition5.q.out b/ql/src/test/results/clientpositive/merge_dynamic_partition5.q.out
index 65f195ed08..06534697af 100644
--- a/ql/src/test/results/clientpositive/merge_dynamic_partition5.q.out
+++ b/ql/src/test/results/clientpositive/merge_dynamic_partition5.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- this is to test the case where some dynamic partitions are me
 create table srcpart_merge_dp like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcpart_merge_dp
 POSTHOOK: query: -- this is to test the case where some dynamic partitions are merged and some are moved
 
 create table srcpart_merge_dp like srcpart
@@ -12,6 +13,7 @@ POSTHOOK: Output: default@srcpart_merge_dp
 PREHOOK: query: create table srcpart_merge_dp_rc like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcpart_merge_dp_rc
 POSTHOOK: query: create table srcpart_merge_dp_rc like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -27,6 +29,7 @@ POSTHOOK: Output: default@srcpart_merge_dp_rc
 PREHOOK: query: create table merge_dynamic_part like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@merge_dynamic_part
 POSTHOOK: query: create table merge_dynamic_part like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/mergejoins.q.out b/ql/src/test/results/clientpositive/mergejoins.q.out
index 4e0957249b..f5529908f2 100644
--- a/ql/src/test/results/clientpositive/mergejoins.q.out
+++ b/ql/src/test/results/clientpositive/mergejoins.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table a (val1 int, val2 int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@a
 POSTHOOK: query: create table a (val1 int, val2 int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@a
 PREHOOK: query: create table b (val1 int, val2 int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@b
 POSTHOOK: query: create table b (val1 int, val2 int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -15,6 +17,7 @@ POSTHOOK: Output: default@b
 PREHOOK: query: create table c (val1 int, val2 int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@c
 POSTHOOK: query: create table c (val1 int, val2 int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -22,6 +25,7 @@ POSTHOOK: Output: default@c
 PREHOOK: query: create table d (val1 int, val2 int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@d
 POSTHOOK: query: create table d (val1 int, val2 int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -29,6 +33,7 @@ POSTHOOK: Output: default@d
 PREHOOK: query: create table e (val1 int, val2 int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@e
 POSTHOOK: query: create table e (val1 int, val2 int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/mergejoins_mixed.q.out b/ql/src/test/results/clientpositive/mergejoins_mixed.q.out
index bd9ca71621..4c6329fd88 100644
--- a/ql/src/test/results/clientpositive/mergejoins_mixed.q.out
+++ b/ql/src/test/results/clientpositive/mergejoins_mixed.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- HIVE-3464
 create table a (key string, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@a
 POSTHOOK: query: -- HIVE-3464
 
 create table a (key string, value string)
diff --git a/ql/src/test/results/clientpositive/metadata_export_drop.q.out b/ql/src/test/results/clientpositive/metadata_export_drop.q.out
index e70860b5c3..5031f41444 100644
--- a/ql/src/test/results/clientpositive/metadata_export_drop.q.out
+++ b/ql/src/test/results/clientpositive/metadata_export_drop.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table tmp_meta_export_listener_drop_test (foo string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmp_meta_export_listener_drop_test
 POSTHOOK: query: create table tmp_meta_export_listener_drop_test (foo string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/metadata_only_queries.q.out b/ql/src/test/results/clientpositive/metadata_only_queries.q.out
index a52bceecb7..e273570a85 100644
--- a/ql/src/test/results/clientpositive/metadata_only_queries.q.out
+++ b/ql/src/test/results/clientpositive/metadata_only_queries.q.out
@@ -14,6 +14,7 @@ PREHOOK: query: create table over10k(
        fields terminated by '|'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@over10k
 POSTHOOK: query: create table over10k(
            t tinyint,
            si smallint,
@@ -53,6 +54,7 @@ PREHOOK: query: create table stats_tbl(
            bin binary)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@stats_tbl
 POSTHOOK: query: create table stats_tbl(
            t tinyint,
            si smallint,
@@ -82,6 +84,7 @@ PREHOOK: query: create table stats_tbl_part(
            bin binary) partitioned by (dt string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@stats_tbl_part
 POSTHOOK: query: create table stats_tbl_part(
            t tinyint,
            si smallint,
diff --git a/ql/src/test/results/clientpositive/metadata_only_queries_with_filters.q.out b/ql/src/test/results/clientpositive/metadata_only_queries_with_filters.q.out
index 62c9cc3173..f556c970f9 100644
--- a/ql/src/test/results/clientpositive/metadata_only_queries_with_filters.q.out
+++ b/ql/src/test/results/clientpositive/metadata_only_queries_with_filters.q.out
@@ -14,6 +14,7 @@ PREHOOK: query: create table over10k(
        fields terminated by '|'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@over10k
 POSTHOOK: query: create table over10k(
            t tinyint,
            si smallint,
@@ -53,6 +54,7 @@ PREHOOK: query: create table stats_tbl_part(
            bin binary) partitioned by (dt int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@stats_tbl_part
 POSTHOOK: query: create table stats_tbl_part(
            t tinyint,
            si smallint,
diff --git a/ql/src/test/results/clientpositive/metadataonly1.q.out b/ql/src/test/results/clientpositive/metadataonly1.q.out
index 2b623d2256..b90cb98248 100644
--- a/ql/src/test/results/clientpositive/metadataonly1.q.out
+++ b/ql/src/test/results/clientpositive/metadataonly1.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE TEST1(A INT, B DOUBLE) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@TEST1
 POSTHOOK: query: CREATE TABLE TEST1(A INT, B DOUBLE) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -989,6 +990,7 @@ POSTHOOK: Input: default@test1@ds=2
 PREHOOK: query: CREATE TABLE TEST2(A INT, B DOUBLE) partitioned by (ds string, hr string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@TEST2
 POSTHOOK: query: CREATE TABLE TEST2(A INT, B DOUBLE) partitioned by (ds string, hr string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/mi.q.out b/ql/src/test/results/clientpositive/mi.q.out
index 7bd0a2807e..35e054a672 100644
--- a/ql/src/test/results/clientpositive/mi.q.out
+++ b/ql/src/test/results/clientpositive/mi.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 create table nzhang_t1 like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@nzhang_t1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 create table nzhang_t1 like srcpart
@@ -12,6 +13,7 @@ POSTHOOK: Output: default@nzhang_t1
 PREHOOK: query: create table nzhang_t2 like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@nzhang_t2
 POSTHOOK: query: create table nzhang_t2 like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/misc_json.q.out b/ql/src/test/results/clientpositive/misc_json.q.out
index eddfa29312..29f875abe0 100644
--- a/ql/src/test/results/clientpositive/misc_json.q.out
+++ b/ql/src/test/results/clientpositive/misc_json.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE IF NOT EXISTS jsontable (key INT, value STRING) COMMENT 'json table' STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@jsontable
 POSTHOOK: query: CREATE TABLE IF NOT EXISTS jsontable (key INT, value STRING) COMMENT 'json table' STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/multiMapJoin1.q.out b/ql/src/test/results/clientpositive/multiMapJoin1.q.out
index 39e9712f86..3ee8c23901 100644
--- a/ql/src/test/results/clientpositive/multiMapJoin1.q.out
+++ b/ql/src/test/results/clientpositive/multiMapJoin1.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table smallTbl1(key string, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@smallTbl1
 POSTHOOK: query: create table smallTbl1(key string, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -24,6 +25,7 @@ RUN: Stage-2:STATS
 PREHOOK: query: create table smallTbl2(key string, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@smallTbl2
 POSTHOOK: query: create table smallTbl2(key string, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -47,6 +49,7 @@ RUN: Stage-2:STATS
 PREHOOK: query: create table smallTbl3(key string, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@smallTbl3
 POSTHOOK: query: create table smallTbl3(key string, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -70,6 +73,7 @@ RUN: Stage-2:STATS
 PREHOOK: query: create table smallTbl4(key string, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@smallTbl4
 POSTHOOK: query: create table smallTbl4(key string, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -93,6 +97,7 @@ RUN: Stage-2:STATS
 PREHOOK: query: create table bigTbl(key string, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bigTbl
 POSTHOOK: query: create table bigTbl(key string, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -678,6 +683,7 @@ RUN: Stage-0:DDL
 PREHOOK: query: create table bigTbl(key1 string, key2 string, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bigTbl
 POSTHOOK: query: create table bigTbl(key1 string, key2 string, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/multiMapJoin2.q.out b/ql/src/test/results/clientpositive/multiMapJoin2.q.out
index bb1d3db8df..2f47502c06 100644
--- a/ql/src/test/results/clientpositive/multiMapJoin2.q.out
+++ b/ql/src/test/results/clientpositive/multiMapJoin2.q.out
@@ -2191,6 +2191,7 @@ PREHOOK: query: -- Check if we can correctly handle partitioned table.
 CREATE TABLE part_table(key string, value string) PARTITIONED BY (partitionId int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part_table
 POSTHOOK: query: -- Check if we can correctly handle partitioned table.
 CREATE TABLE part_table(key string, value string) PARTITIONED BY (partitionId int)
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/multi_insert.q.out b/ql/src/test/results/clientpositive/multi_insert.q.out
index f58801c4f6..fd13c617b5 100644
--- a/ql/src/test/results/clientpositive/multi_insert.q.out
+++ b/ql/src/test/results/clientpositive/multi_insert.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 create table src_multi1 like src
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_multi1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 create table src_multi1 like src
@@ -12,6 +13,7 @@ POSTHOOK: Output: default@src_multi1
 PREHOOK: query: create table src_multi2 like src
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_multi2
 POSTHOOK: query: create table src_multi2 like src
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/multi_insert_gby.q.out b/ql/src/test/results/clientpositive/multi_insert_gby.q.out
index 13b72309e8..879da2d3f6 100644
--- a/ql/src/test/results/clientpositive/multi_insert_gby.q.out
+++ b/ql/src/test/results/clientpositive/multi_insert_gby.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 create table e1 (key string, count int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@e1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 --HIVE-3699 Multiple insert overwrite into multiple tables query stores same results in all tables
@@ -14,6 +15,7 @@ POSTHOOK: Output: default@e1
 PREHOOK: query: create table e2 (key string, count int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@e2
 POSTHOOK: query: create table e2 (key string, count int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/multi_insert_gby2.q.out b/ql/src/test/results/clientpositive/multi_insert_gby2.q.out
index 5f7f3d6954..882bc0c6e5 100644
--- a/ql/src/test/results/clientpositive/multi_insert_gby2.q.out
+++ b/ql/src/test/results/clientpositive/multi_insert_gby2.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: --HIVE-3699 Multiple insert overwrite into multiple tables query
 create table e1 (count int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@e1
 POSTHOOK: query: --HIVE-3699 Multiple insert overwrite into multiple tables query stores same results in all tables
 create table e1 (count int)
 POSTHOOK: type: CREATETABLE
@@ -10,6 +11,7 @@ POSTHOOK: Output: default@e1
 PREHOOK: query: create table e2 (percentile double)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@e2
 POSTHOOK: query: create table e2 (percentile double)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/multi_insert_gby3.q.out b/ql/src/test/results/clientpositive/multi_insert_gby3.q.out
index 3cbcdc128e..82ddd92e92 100644
--- a/ql/src/test/results/clientpositive/multi_insert_gby3.q.out
+++ b/ql/src/test/results/clientpositive/multi_insert_gby3.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table e1 (key string, keyD double)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@e1
 POSTHOOK: query: create table e1 (key string, keyD double)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@e1
 PREHOOK: query: create table e2 (key string, keyD double, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@e2
 POSTHOOK: query: create table e2 (key string, keyD double, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -15,6 +17,7 @@ POSTHOOK: Output: default@e2
 PREHOOK: query: create table e3 (key string, keyD double)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@e3
 POSTHOOK: query: create table e3 (key string, keyD double)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/multi_insert_lateral_view.q.out b/ql/src/test/results/clientpositive/multi_insert_lateral_view.q.out
index edcc182e08..83df255e9e 100644
--- a/ql/src/test/results/clientpositive/multi_insert_lateral_view.q.out
+++ b/ql/src/test/results/clientpositive/multi_insert_lateral_view.q.out
@@ -12,6 +12,7 @@ POSTHOOK: Output: default@src_10
 PREHOOK: query: create table src_lv1 (key string, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_lv1
 POSTHOOK: query: create table src_lv1 (key string, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -19,6 +20,7 @@ POSTHOOK: Output: default@src_lv1
 PREHOOK: query: create table src_lv2 (key string, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_lv2
 POSTHOOK: query: create table src_lv2 (key string, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -26,6 +28,7 @@ POSTHOOK: Output: default@src_lv2
 PREHOOK: query: create table src_lv3 (key string, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_lv3
 POSTHOOK: query: create table src_lv3 (key string, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -1270,6 +1273,7 @@ val_98	98.0
 PREHOOK: query: create table src_lv4 (key string, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_lv4
 POSTHOOK: query: create table src_lv4 (key string, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/multi_insert_move_tasks_share_dependencies.q.out b/ql/src/test/results/clientpositive/multi_insert_move_tasks_share_dependencies.q.out
index d364548569..b1b6a11f37 100644
--- a/ql/src/test/results/clientpositive/multi_insert_move_tasks_share_dependencies.q.out
+++ b/ql/src/test/results/clientpositive/multi_insert_move_tasks_share_dependencies.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 create table src_multi1 like src
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_multi1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 create table src_multi1 like src
@@ -12,6 +13,7 @@ POSTHOOK: Output: default@src_multi1
 PREHOOK: query: create table src_multi2 like src
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_multi2
 POSTHOOK: query: create table src_multi2 like src
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/multi_sahooks.q.out b/ql/src/test/results/clientpositive/multi_sahooks.q.out
index ebf6430de7..66206b4438 100644
--- a/ql/src/test/results/clientpositive/multi_sahooks.q.out
+++ b/ql/src/test/results/clientpositive/multi_sahooks.q.out
@@ -7,6 +7,7 @@ DummySemanticAnalyzerHook1 Post: Hive rocks!! Count: 0
 PREHOOK: query: create table tbl_sahook (c string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl_sahook
 POSTHOOK: query: create table tbl_sahook (c string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -37,6 +38,7 @@ DummySemanticAnalyzerHook1 Post: Hive rocks!! Count: 0
 PREHOOK: query: create table tbl_sahooks (c string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl_sahooks
 POSTHOOK: query: create table tbl_sahooks (c string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -67,6 +69,7 @@ DummySemanticAnalyzerHook1 Post: Hive rocks!! Count: 0
 PREHOOK: query: create table tbl_sahooks (c string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl_sahooks
 POSTHOOK: query: create table tbl_sahooks (c string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -99,6 +102,7 @@ DummySemanticAnalyzerHook1 Post: Hive rocks!! Count: 1
 PREHOOK: query: create table tbl_sahooks (c string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl_sahooks
 POSTHOOK: query: create table tbl_sahooks (c string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/multigroupby_singlemr.q.out b/ql/src/test/results/clientpositive/multigroupby_singlemr.q.out
index 5dbb96f378..4b806932a8 100644
--- a/ql/src/test/results/clientpositive/multigroupby_singlemr.q.out
+++ b/ql/src/test/results/clientpositive/multigroupby_singlemr.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE TBL(C1 INT, C2 INT, C3 INT, C4 INT)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@TBL
 POSTHOOK: query: CREATE TABLE TBL(C1 INT, C2 INT, C3 INT, C4 INT)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@TBL
 PREHOOK: query: CREATE TABLE DEST1(d1 INT, d2 INT) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@DEST1
 POSTHOOK: query: CREATE TABLE DEST1(d1 INT, d2 INT) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -15,6 +17,7 @@ POSTHOOK: Output: default@DEST1
 PREHOOK: query: CREATE TABLE DEST2(d1 INT, d2 INT, d3 INT) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@DEST2
 POSTHOOK: query: CREATE TABLE DEST2(d1 INT, d2 INT, d3 INT) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -22,6 +25,7 @@ POSTHOOK: Output: default@DEST2
 PREHOOK: query: CREATE TABLE DEST3(d1 INT, d2 INT, d3 INT, d4 INT) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@DEST3
 POSTHOOK: query: CREATE TABLE DEST3(d1 INT, d2 INT, d3 INT, d4 INT) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -29,6 +33,7 @@ POSTHOOK: Output: default@DEST3
 PREHOOK: query: CREATE TABLE DEST4(d1 INT, d2 INT, d3 INT, d4 INT) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@DEST4
 POSTHOOK: query: CREATE TABLE DEST4(d1 INT, d2 INT, d3 INT, d4 INT) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/nested_complex.q.out b/ql/src/test/results/clientpositive/nested_complex.q.out
index a841955fbe..4add82d8a5 100644
--- a/ql/src/test/results/clientpositive/nested_complex.q.out
+++ b/ql/src/test/results/clientpositive/nested_complex.q.out
@@ -12,6 +12,7 @@ WITH SERDEPROPERTIES (
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@nestedcomplex
 POSTHOOK: query: create table nestedcomplex (
 simple_int int,
 max_nested_array  array<array<array<array<array<array<array<array<array<array<array<array<array<array<array<array<array<array<array<array<array<array<array<int>>>>>>>>>>>>>>>>>>>>>>>,
diff --git a/ql/src/test/results/clientpositive/nestedvirtual.q.out b/ql/src/test/results/clientpositive/nestedvirtual.q.out
index b56a7d8e6a..bc0be7c79a 100644
--- a/ql/src/test/results/clientpositive/nestedvirtual.q.out
+++ b/ql/src/test/results/clientpositive/nestedvirtual.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE pokes (foo INT, bar STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@pokes
 POSTHOOK: query: CREATE TABLE pokes (foo INT, bar STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@pokes
 PREHOOK: query: create table pokes2(foo INT, bar STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@pokes2
 POSTHOOK: query: create table pokes2(foo INT, bar STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -48,6 +50,7 @@ POSTHOOK: Output: default@pokes2
 PREHOOK: query: CREATE TABLE pokes (foo INT, bar STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@pokes
 POSTHOOK: query: CREATE TABLE pokes (foo INT, bar STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -55,6 +58,7 @@ POSTHOOK: Output: default@pokes
 PREHOOK: query: create table pokes2(foo INT, bar STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@pokes2
 POSTHOOK: query: create table pokes2(foo INT, bar STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -95,6 +99,7 @@ POSTHOOK: Output: default@pokes2
 PREHOOK: query: CREATE TABLE pokes (foo INT, bar STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@pokes
 POSTHOOK: query: CREATE TABLE pokes (foo INT, bar STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -102,6 +107,7 @@ POSTHOOK: Output: default@pokes
 PREHOOK: query: create table pokes2(foo INT, bar STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@pokes2
 POSTHOOK: query: create table pokes2(foo INT, bar STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/newline.q.out b/ql/src/test/results/clientpositive/newline.q.out
index 04ccba7a71..305d1e8fdd 100644
--- a/ql/src/test/results/clientpositive/newline.q.out
+++ b/ql/src/test/results/clientpositive/newline.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 create table tmp_tmp(key string, value string) stored as rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmp_tmp
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 create table tmp_tmp(key string, value string) stored as rcfile
@@ -52,6 +53,7 @@ POSTHOOK: Output: default@tmp_tmp
 PREHOOK: query: create table tmp_tmp(key string, value string) stored as rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmp_tmp
 POSTHOOK: query: create table tmp_tmp(key string, value string) stored as rcfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/nomore_ambiguous_table_col.q.out b/ql/src/test/results/clientpositive/nomore_ambiguous_table_col.q.out
index 9502d706f0..7a353b165c 100644
--- a/ql/src/test/results/clientpositive/nomore_ambiguous_table_col.q.out
+++ b/ql/src/test/results/clientpositive/nomore_ambiguous_table_col.q.out
@@ -9,6 +9,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table ambiguous (key string, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@ambiguous
 POSTHOOK: query: create table ambiguous (key string, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/nonreserved_keywords_input37.q.out b/ql/src/test/results/clientpositive/nonreserved_keywords_input37.q.out
index 487ac94c08..819da226d5 100644
--- a/ql/src/test/results/clientpositive/nonreserved_keywords_input37.q.out
+++ b/ql/src/test/results/clientpositive/nonreserved_keywords_input37.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE table(string string) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table
 POSTHOOK: query: CREATE TABLE table(string string) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/nonreserved_keywords_insert_into1.q.out b/ql/src/test/results/clientpositive/nonreserved_keywords_insert_into1.q.out
index 3687032a22..3561297983 100644
--- a/ql/src/test/results/clientpositive/nonreserved_keywords_insert_into1.q.out
+++ b/ql/src/test/results/clientpositive/nonreserved_keywords_insert_into1.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: CREATE TABLE insert (key INT, as STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@insert
 POSTHOOK: query: CREATE TABLE insert (key INT, as STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/notable_alias1.q.out b/ql/src/test/results/clientpositive/notable_alias1.q.out
index b7052d53b8..fe4f5983fa 100644
--- a/ql/src/test/results/clientpositive/notable_alias1.q.out
+++ b/ql/src/test/results/clientpositive/notable_alias1.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(dummy STRING, key INT, value DOUBLE) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(dummy STRING, key INT, value DOUBLE) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/notable_alias2.q.out b/ql/src/test/results/clientpositive/notable_alias2.q.out
index b7a86fedd8..d051c4802c 100644
--- a/ql/src/test/results/clientpositive/notable_alias2.q.out
+++ b/ql/src/test/results/clientpositive/notable_alias2.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(dummy STRING, key INT, value DOUBLE) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(dummy STRING, key INT, value DOUBLE) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/notable_alias3.q.out b/ql/src/test/results/clientpositive/notable_alias3.q.out
index cd40469773..ddc28ddbe3 100644
--- a/ql/src/test/results/clientpositive/notable_alias3.q.out
+++ b/ql/src/test/results/clientpositive/notable_alias3.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(c string, key INT, value DOUBLE) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(c string, key INT, value DOUBLE) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/null_column.q.out b/ql/src/test/results/clientpositive/null_column.q.out
index 1d08d58644..339c725895 100644
--- a/ql/src/test/results/clientpositive/null_column.q.out
+++ b/ql/src/test/results/clientpositive/null_column.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table temp_null(a int) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@temp_null
 POSTHOOK: query: create table temp_null(a int) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -30,6 +31,7 @@ NULL	NULL
 PREHOOK: query: create table tt(a int, b string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tt
 POSTHOOK: query: create table tt(a int, b string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -61,6 +63,7 @@ NULL	NULL
 PREHOOK: query: create table tt_b(a int, b string) row format serde "org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe"
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tt_b
 POSTHOOK: query: create table tt_b(a int, b string) row format serde "org.apache.hadoop.hive.serde2.lazybinary.LazyBinarySerDe"
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -106,6 +109,7 @@ POSTHOOK: Output: target/warehouse/null_columns.out
 PREHOOK: query: create table temp_null2 (key string, value string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@temp_null2
 POSTHOOK: query: create table temp_null2 (key string, value string) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/nullformat.q.out b/ql/src/test/results/clientpositive/nullformat.q.out
index 386996c28d..553b129304 100644
--- a/ql/src/test/results/clientpositive/nullformat.q.out
+++ b/ql/src/test/results/clientpositive/nullformat.q.out
@@ -7,6 +7,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: CREATE TABLE base_tab(a STRING, b STRING, c STRING, d STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@base_tab
 POSTHOOK: query: CREATE TABLE base_tab(a STRING, b STRING, c STRING, d STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -57,6 +58,7 @@ STAGE PLANS:
 PREHOOK: query: CREATE TABLE null_tab1(a STRING, b STRING) ROW FORMAT DELIMITED NULL DEFINED AS 'fooNull'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@null_tab1
 POSTHOOK: query: CREATE TABLE null_tab1(a STRING, b STRING) ROW FORMAT DELIMITED NULL DEFINED AS 'fooNull'
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/nullformatCTAS.q.out b/ql/src/test/results/clientpositive/nullformatCTAS.q.out
index 5f3f9d869b..1d76a6d293 100644
--- a/ql/src/test/results/clientpositive/nullformatCTAS.q.out
+++ b/ql/src/test/results/clientpositive/nullformatCTAS.q.out
@@ -7,6 +7,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: CREATE TABLE base_tab(a STRING, b STRING, c STRING, d STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@base_tab
 POSTHOOK: query: CREATE TABLE base_tab(a STRING, b STRING, c STRING, d STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/nullformatdir.q.out b/ql/src/test/results/clientpositive/nullformatdir.q.out
index 69b63e0122..14a79b2d48 100644
--- a/ql/src/test/results/clientpositive/nullformatdir.q.out
+++ b/ql/src/test/results/clientpositive/nullformatdir.q.out
@@ -7,6 +7,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: CREATE TABLE base_tab(a STRING, b STRING, c STRING, d STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@base_tab
 POSTHOOK: query: CREATE TABLE base_tab(a STRING, b STRING, c STRING, d STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -58,6 +59,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: CREATE TABLE null_tab2(a STRING, b STRING) ROW FORMAT DELIMITED NULL DEFINED AS 'fooNull'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@null_tab2
 POSTHOOK: query: CREATE TABLE null_tab2(a STRING, b STRING) ROW FORMAT DELIMITED NULL DEFINED AS 'fooNull'
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/nullgroup3.q.out b/ql/src/test/results/clientpositive/nullgroup3.q.out
index 7dcfa0d021..81252e4f14 100644
--- a/ql/src/test/results/clientpositive/nullgroup3.q.out
+++ b/ql/src/test/results/clientpositive/nullgroup3.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE tstparttbl(KEY STRING, VALUE STRING) PARTITIONED BY(ds string) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tstparttbl
 POSTHOOK: query: CREATE TABLE tstparttbl(KEY STRING, VALUE STRING) PARTITIONED BY(ds string) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -91,6 +92,7 @@ POSTHOOK: Input: default@tstparttbl@ds=2008-04-09
 PREHOOK: query: CREATE TABLE tstparttbl2(KEY STRING, VALUE STRING) PARTITIONED BY(ds string) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tstparttbl2
 POSTHOOK: query: CREATE TABLE tstparttbl2(KEY STRING, VALUE STRING) PARTITIONED BY(ds string) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -189,6 +191,7 @@ POSTHOOK: Output: default@tstparttbl
 PREHOOK: query: CREATE TABLE tstparttbl(KEY STRING, VALUE STRING) PARTITIONED BY(ds string) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tstparttbl
 POSTHOOK: query: CREATE TABLE tstparttbl(KEY STRING, VALUE STRING) PARTITIONED BY(ds string) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -287,6 +290,7 @@ POSTHOOK: Output: default@tstparttbl2
 PREHOOK: query: CREATE TABLE tstparttbl2(KEY STRING, VALUE STRING) PARTITIONED BY(ds string) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tstparttbl2
 POSTHOOK: query: CREATE TABLE tstparttbl2(KEY STRING, VALUE STRING) PARTITIONED BY(ds string) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/nullgroup5.q.out b/ql/src/test/results/clientpositive/nullgroup5.q.out
index a8dfb3321a..f4013804f4 100644
--- a/ql/src/test/results/clientpositive/nullgroup5.q.out
+++ b/ql/src/test/results/clientpositive/nullgroup5.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE tstparttbl(KEY STRING, VALUE STRING) PARTITIONED BY(ds string) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tstparttbl
 POSTHOOK: query: CREATE TABLE tstparttbl(KEY STRING, VALUE STRING) PARTITIONED BY(ds string) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -17,6 +18,7 @@ POSTHOOK: Output: default@tstparttbl@ds=2009-04-09
 PREHOOK: query: CREATE TABLE tstparttbl2(KEY STRING, VALUE STRING) PARTITIONED BY(ds string) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tstparttbl2
 POSTHOOK: query: CREATE TABLE tstparttbl2(KEY STRING, VALUE STRING) PARTITIONED BY(ds string) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/nullinput.q.out b/ql/src/test/results/clientpositive/nullinput.q.out
index db70faa6ad..819d262159 100644
--- a/ql/src/test/results/clientpositive/nullinput.q.out
+++ b/ql/src/test/results/clientpositive/nullinput.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table tstnullinut(a string, b string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tstnullinut
 POSTHOOK: query: create table tstnullinut(a string, b string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/nullinput2.q.out b/ql/src/test/results/clientpositive/nullinput2.q.out
index 25c82217ae..9c131b9c50 100644
--- a/ql/src/test/results/clientpositive/nullinput2.q.out
+++ b/ql/src/test/results/clientpositive/nullinput2.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table nulltbl(key int) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@nulltbl
 POSTHOOK: query: create table nulltbl(key int) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/nullscript.q.out b/ql/src/test/results/clientpositive/nullscript.q.out
index 4bbd0632f4..e7951d5304 100644
--- a/ql/src/test/results/clientpositive/nullscript.q.out
+++ b/ql/src/test/results/clientpositive/nullscript.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE nullscript(KEY STRING, VALUE STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@nullscript
 POSTHOOK: query: CREATE TABLE nullscript(KEY STRING, VALUE STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/orc_analyze.q.out b/ql/src/test/results/clientpositive/orc_analyze.q.out
index 880a13a493..979d2a7600 100644
--- a/ql/src/test/results/clientpositive/orc_analyze.q.out
+++ b/ql/src/test/results/clientpositive/orc_analyze.q.out
@@ -8,6 +8,7 @@ PREHOOK: query: CREATE TABLE orc_create_people_staging (
   state string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@orc_create_people_staging
 POSTHOOK: query: CREATE TABLE orc_create_people_staging (
   id int,
   first_name string,
@@ -40,6 +41,7 @@ CREATE TABLE orc_create_people (
 STORED AS orc
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@orc_create_people
 POSTHOOK: query: -- non-partitioned table
 -- partial scan gather
 CREATE TABLE orc_create_people (
@@ -136,6 +138,7 @@ CREATE TABLE orc_create_people (
 STORED AS orc
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@orc_create_people
 POSTHOOK: query: -- auto stats gather
 CREATE TABLE orc_create_people (
   id int,
@@ -226,6 +229,7 @@ PARTITIONED BY (state string)
 STORED AS orc
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@orc_create_people
 POSTHOOK: query: -- partitioned table
 -- partial scan gather
 CREATE TABLE orc_create_people (
@@ -383,6 +387,7 @@ PARTITIONED BY (state string)
 STORED AS orc
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@orc_create_people
 POSTHOOK: query: -- auto stats gather
 CREATE TABLE orc_create_people (
   id int,
@@ -533,6 +538,7 @@ into 4 buckets
 STORED AS orc
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@orc_create_people
 POSTHOOK: query: -- partitioned and bucketed table
 -- partial scan gather
 CREATE TABLE orc_create_people (
@@ -696,6 +702,7 @@ into 4 buckets
 STORED AS orc
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@orc_create_people
 POSTHOOK: query: -- auto stats gather
 CREATE TABLE orc_create_people (
   id int,
@@ -847,6 +854,7 @@ PARTITIONED BY (state string)
 STORED AS orc
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@orc_create_people
 POSTHOOK: query: -- create table with partitions containing text and ORC files.
 -- ORC files implements StatsProvidingRecordReader but text files does not.
 -- So the partition containing text file should not have statistics.
diff --git a/ql/src/test/results/clientpositive/orc_create.q.out b/ql/src/test/results/clientpositive/orc_create.q.out
index fbd39a2e1d..8fc88b3ea1 100644
--- a/ql/src/test/results/clientpositive/orc_create.q.out
+++ b/ql/src/test/results/clientpositive/orc_create.q.out
@@ -33,6 +33,7 @@ PREHOOK: query: CREATE TABLE orc_create_staging (
     MAP KEYS TERMINATED BY ':'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@orc_create_staging
 POSTHOOK: query: CREATE TABLE orc_create_staging (
   str STRING,
   mp  MAP<STRING,STRING>,
@@ -86,6 +87,7 @@ PREHOOK: query: CREATE TABLE orc_create (key INT, value STRING)
    STORED AS ORC
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@orc_create
 POSTHOOK: query: CREATE TABLE orc_create (key INT, value STRING)
    PARTITIONED BY (ds string)
    STORED AS ORC
@@ -140,6 +142,7 @@ PREHOOK: query: CREATE TABLE orc_create (key INT, value STRING)
    PARTITIONED BY (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@orc_create
 POSTHOOK: query: CREATE TABLE orc_create (key INT, value STRING)
    PARTITIONED BY (ds string)
 POSTHOOK: type: CREATETABLE
@@ -237,6 +240,7 @@ PREHOOK: query: CREATE TABLE orc_create (key INT, value STRING)
    PARTITIONED BY (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@orc_create
 POSTHOOK: query: CREATE TABLE orc_create (key INT, value STRING)
    PARTITIONED BY (ds string)
 POSTHOOK: type: CREATETABLE
@@ -286,6 +290,7 @@ PREHOOK: query: CREATE TABLE orc_create_complex (
 ) STORED AS ORC
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@orc_create_complex
 POSTHOOK: query: CREATE TABLE orc_create_complex (
   str STRING,
   mp  MAP<STRING,STRING>,
@@ -424,6 +429,7 @@ PREHOOK: query: CREATE TABLE orc_create_people_staging (
   state string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@orc_create_people_staging
 POSTHOOK: query: CREATE TABLE orc_create_people_staging (
   id int,
   first_name string,
@@ -456,6 +462,7 @@ PARTITIONED BY (state string)
 STORED AS orc
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@orc_create_people
 POSTHOOK: query: CREATE TABLE orc_create_people (
   id int,
   first_name string,
diff --git a/ql/src/test/results/clientpositive/orc_createas1.q.out b/ql/src/test/results/clientpositive/orc_createas1.q.out
index 7e74d49f5d..a1044803b7 100644
--- a/ql/src/test/results/clientpositive/orc_createas1.q.out
+++ b/ql/src/test/results/clientpositive/orc_createas1.q.out
@@ -14,6 +14,7 @@ PREHOOK: query: CREATE TABLE orc_createas1a (key INT, value STRING)
     PARTITIONED BY (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@orc_createas1a
 POSTHOOK: query: CREATE TABLE orc_createas1a (key INT, value STRING)
     PARTITIONED BY (ds string)
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/orc_dictionary_threshold.q.out b/ql/src/test/results/clientpositive/orc_dictionary_threshold.q.out
index 6e8aabaa8e..10ed4ac196 100644
--- a/ql/src/test/results/clientpositive/orc_dictionary_threshold.q.out
+++ b/ql/src/test/results/clientpositive/orc_dictionary_threshold.q.out
@@ -8,6 +8,7 @@ STORED AS INPUTFORMAT 'org.apache.hadoop.hive.ql.io.orc.OrcInputFormat'
 OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_orc
 POSTHOOK: query: -- Set the threshold to -1 to guarantee dictionary encoding is turned off
 -- Tests that the data can be read back correctly when a string column is stored
 -- without dictionary encoding
@@ -63,6 +64,7 @@ POSTHOOK: Output: default@test_orc
 PREHOOK: query: CREATE TABLE src_thousand(key STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_thousand
 POSTHOOK: query: CREATE TABLE src_thousand(key STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/orc_diff_part_cols.q.out b/ql/src/test/results/clientpositive/orc_diff_part_cols.q.out
index 82617835c4..e33d0f462a 100644
--- a/ql/src/test/results/clientpositive/orc_diff_part_cols.q.out
+++ b/ql/src/test/results/clientpositive/orc_diff_part_cols.q.out
@@ -7,6 +7,7 @@ STORED AS INPUTFORMAT 'org.apache.hadoop.hive.ql.io.orc.OrcInputFormat'
 OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_orc
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE test_orc (key STRING)
diff --git a/ql/src/test/results/clientpositive/orc_diff_part_cols2.q.out b/ql/src/test/results/clientpositive/orc_diff_part_cols2.q.out
index 5ee40d4119..91385c6f17 100644
--- a/ql/src/test/results/clientpositive/orc_diff_part_cols2.q.out
+++ b/ql/src/test/results/clientpositive/orc_diff_part_cols2.q.out
@@ -7,6 +7,7 @@ CREATE TABLE test_orc (key STRING)
 STORED AS ORC
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_orc
 POSTHOOK: query: -- Create a table with one column, write to it, then add an additional column
 -- This can break reads
 
diff --git a/ql/src/test/results/clientpositive/orc_empty_files.q.out b/ql/src/test/results/clientpositive/orc_empty_files.q.out
index af9ceb8320..2426ca34a6 100644
--- a/ql/src/test/results/clientpositive/orc_empty_files.q.out
+++ b/ql/src/test/results/clientpositive/orc_empty_files.q.out
@@ -5,6 +5,7 @@ STORED AS INPUTFORMAT 'org.apache.hadoop.hive.ql.io.orc.OrcInputFormat'
 OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_orc
 POSTHOOK: query: CREATE TABLE test_orc (key STRING, cnt INT)
 CLUSTERED BY (key) INTO 3 BUCKETS
 ROW FORMAT SERDE 'org.apache.hadoop.hive.ql.io.orc.OrcSerde' 
diff --git a/ql/src/test/results/clientpositive/orc_empty_strings.q.out b/ql/src/test/results/clientpositive/orc_empty_strings.q.out
index 572634690f..9ab4e8df66 100644
--- a/ql/src/test/results/clientpositive/orc_empty_strings.q.out
+++ b/ql/src/test/results/clientpositive/orc_empty_strings.q.out
@@ -6,6 +6,7 @@ STORED AS INPUTFORMAT 'org.apache.hadoop.hive.ql.io.orc.OrcInputFormat'
 OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_orc
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE test_orc (key STRING)
diff --git a/ql/src/test/results/clientpositive/orc_ends_with_nulls.q.out b/ql/src/test/results/clientpositive/orc_ends_with_nulls.q.out
index b0fde68a06..5011a4a826 100644
--- a/ql/src/test/results/clientpositive/orc_ends_with_nulls.q.out
+++ b/ql/src/test/results/clientpositive/orc_ends_with_nulls.q.out
@@ -4,6 +4,7 @@ STORED AS INPUTFORMAT 'org.apache.hadoop.hive.ql.io.orc.OrcInputFormat'
 OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_orc
 POSTHOOK: query: CREATE TABLE test_orc (key STRING)
 ROW FORMAT SERDE 'org.apache.hadoop.hive.ql.io.orc.OrcSerde' 
 STORED AS INPUTFORMAT 'org.apache.hadoop.hive.ql.io.orc.OrcInputFormat' 
@@ -26,6 +27,7 @@ PREHOOK: query: -- nulls.txt is a file containing a non-null string row followed
 CREATE TABLE src_null(a STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_null
 POSTHOOK: query: -- nulls.txt is a file containing a non-null string row followed by 1000 null string rows
 -- this produces the effect that the number of non-null rows between the last and second
 -- to last index stride are the same (there's only two index strides)
diff --git a/ql/src/test/results/clientpositive/orc_merge1.q.out b/ql/src/test/results/clientpositive/orc_merge1.q.out
index e0a1229a5c..fc3e206838 100644
--- a/ql/src/test/results/clientpositive/orc_merge1.q.out
+++ b/ql/src/test/results/clientpositive/orc_merge1.q.out
@@ -10,6 +10,7 @@ PREHOOK: query: CREATE TABLE orcfile_merge1 (key INT, value STRING)
     PARTITIONED BY (ds STRING, part STRING) STORED AS ORC
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@orcfile_merge1
 POSTHOOK: query: CREATE TABLE orcfile_merge1 (key INT, value STRING) 
     PARTITIONED BY (ds STRING, part STRING) STORED AS ORC
 POSTHOOK: type: CREATETABLE
@@ -19,6 +20,7 @@ PREHOOK: query: CREATE TABLE orcfile_merge1b (key INT, value STRING)
     PARTITIONED BY (ds STRING, part STRING) STORED AS ORC
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@orcfile_merge1b
 POSTHOOK: query: CREATE TABLE orcfile_merge1b (key INT, value STRING) 
     PARTITIONED BY (ds STRING, part STRING) STORED AS ORC
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/orc_merge2.q.out b/ql/src/test/results/clientpositive/orc_merge2.q.out
index 3e4b3402c1..55b1de30da 100644
--- a/ql/src/test/results/clientpositive/orc_merge2.q.out
+++ b/ql/src/test/results/clientpositive/orc_merge2.q.out
@@ -7,6 +7,7 @@ PREHOOK: query: CREATE TABLE orcfile_merge2a (key INT, value STRING)
     STORED AS ORC
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@orcfile_merge2a
 POSTHOOK: query: CREATE TABLE orcfile_merge2a (key INT, value STRING)
     PARTITIONED BY (one string, two string, three string)
     STORED AS ORC
diff --git a/ql/src/test/results/clientpositive/orc_merge3.q.out b/ql/src/test/results/clientpositive/orc_merge3.q.out
index 93edc38363..258f5385b1 100644
--- a/ql/src/test/results/clientpositive/orc_merge3.q.out
+++ b/ql/src/test/results/clientpositive/orc_merge3.q.out
@@ -10,6 +10,7 @@ PREHOOK: query: CREATE TABLE orcfile_merge3a (key int, value string)
     PARTITIONED BY (ds string) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@orcfile_merge3a
 POSTHOOK: query: CREATE TABLE orcfile_merge3a (key int, value string) 
     PARTITIONED BY (ds string) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
@@ -18,6 +19,7 @@ POSTHOOK: Output: default@orcfile_merge3a
 PREHOOK: query: CREATE TABLE orcfile_merge3b (key int, value string) STORED AS ORC
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@orcfile_merge3b
 POSTHOOK: query: CREATE TABLE orcfile_merge3b (key int, value string) STORED AS ORC
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/orc_merge4.q.out b/ql/src/test/results/clientpositive/orc_merge4.q.out
index 423fb3fffb..3a2bb88f5d 100644
--- a/ql/src/test/results/clientpositive/orc_merge4.q.out
+++ b/ql/src/test/results/clientpositive/orc_merge4.q.out
@@ -10,6 +10,7 @@ PREHOOK: query: CREATE TABLE orcfile_merge3a (key int, value string)
     PARTITIONED BY (ds string) STORED AS ORC
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@orcfile_merge3a
 POSTHOOK: query: CREATE TABLE orcfile_merge3a (key int, value string) 
     PARTITIONED BY (ds string) STORED AS ORC
 POSTHOOK: type: CREATETABLE
@@ -18,6 +19,7 @@ POSTHOOK: Output: default@orcfile_merge3a
 PREHOOK: query: CREATE TABLE orcfile_merge3b (key int, value string) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@orcfile_merge3b
 POSTHOOK: query: CREATE TABLE orcfile_merge3b (key int, value string) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/orc_min_max.q.out b/ql/src/test/results/clientpositive/orc_min_max.q.out
index eb29a1b686..59dcba5fde 100644
--- a/ql/src/test/results/clientpositive/orc_min_max.q.out
+++ b/ql/src/test/results/clientpositive/orc_min_max.q.out
@@ -20,6 +20,7 @@ collection items terminated by ','
 map keys terminated by ':' stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@alltypes
 POSTHOOK: query: create table if not exists alltypes (
  bo boolean,
  ti tinyint,
@@ -46,6 +47,7 @@ POSTHOOK: Output: default@alltypes
 PREHOOK: query: create table alltypes_orc like alltypes
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@alltypes_orc
 POSTHOOK: query: create table alltypes_orc like alltypes
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/orc_ppd_char.q.out b/ql/src/test/results/clientpositive/orc_ppd_char.q.out
index 07a0f2c20b..79838c1d5b 100644
--- a/ql/src/test/results/clientpositive/orc_ppd_char.q.out
+++ b/ql/src/test/results/clientpositive/orc_ppd_char.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table newtypesorc(c char(10), v varchar(10), d decimal(5,3), da date) stored as orc tblproperties("orc.stripe.size"="16777216")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@newtypesorc
 POSTHOOK: query: create table newtypesorc(c char(10), v varchar(10), d decimal(5,3), da date) stored as orc tblproperties("orc.stripe.size"="16777216")
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/orc_ppd_date.q.out b/ql/src/test/results/clientpositive/orc_ppd_date.q.out
index e99948112c..e07739d097 100644
--- a/ql/src/test/results/clientpositive/orc_ppd_date.q.out
+++ b/ql/src/test/results/clientpositive/orc_ppd_date.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table newtypesorc(c char(10), v varchar(10), d decimal(5,3), da date) stored as orc tblproperties("orc.stripe.size"="16777216")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@newtypesorc
 POSTHOOK: query: create table newtypesorc(c char(10), v varchar(10), d decimal(5,3), da date) stored as orc tblproperties("orc.stripe.size"="16777216")
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/orc_ppd_decimal.q.out b/ql/src/test/results/clientpositive/orc_ppd_decimal.q.out
index 5a97e2e09c..0c11ea8f3b 100644
--- a/ql/src/test/results/clientpositive/orc_ppd_decimal.q.out
+++ b/ql/src/test/results/clientpositive/orc_ppd_decimal.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table newtypesorc(c char(10), v varchar(10), d decimal(5,3), da date) stored as orc tblproperties("orc.stripe.size"="16777216")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@newtypesorc
 POSTHOOK: query: create table newtypesorc(c char(10), v varchar(10), d decimal(5,3), da date) stored as orc tblproperties("orc.stripe.size"="16777216")
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/orc_ppd_varchar.q.out b/ql/src/test/results/clientpositive/orc_ppd_varchar.q.out
index 3e036a31d1..3c43b2f953 100644
--- a/ql/src/test/results/clientpositive/orc_ppd_varchar.q.out
+++ b/ql/src/test/results/clientpositive/orc_ppd_varchar.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table newtypesorc(c char(10), v varchar(10), d decimal(5,3), da date) stored as orc tblproperties("orc.stripe.size"="16777216")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@newtypesorc
 POSTHOOK: query: create table newtypesorc(c char(10), v varchar(10), d decimal(5,3), da date) stored as orc tblproperties("orc.stripe.size"="16777216")
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/orc_predicate_pushdown.q.out b/ql/src/test/results/clientpositive/orc_predicate_pushdown.q.out
index 890cb2c8b1..f25b442b48 100644
--- a/ql/src/test/results/clientpositive/orc_predicate_pushdown.q.out
+++ b/ql/src/test/results/clientpositive/orc_predicate_pushdown.q.out
@@ -14,6 +14,7 @@ CREATE TABLE orc_pred(t tinyint,
 STORED AS ORC
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@orc_pred
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE orc_pred(t tinyint,
@@ -54,6 +55,7 @@ ROW FORMAT DELIMITED FIELDS TERMINATED BY '|'
 STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@staging
 POSTHOOK: query: CREATE TABLE staging(t tinyint,
            si smallint,
            i int,
diff --git a/ql/src/test/results/clientpositive/orc_split_elimination.q.out b/ql/src/test/results/clientpositive/orc_split_elimination.q.out
index c37e889b5d..7134ff532f 100644
--- a/ql/src/test/results/clientpositive/orc_split_elimination.q.out
+++ b/ql/src/test/results/clientpositive/orc_split_elimination.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 create table orc_split_elim (userid bigint, string1 string, subtype double, decimal1 decimal, ts timestamp) stored as orc
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@orc_split_elim
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 create table orc_split_elim (userid bigint, string1 string, subtype double, decimal1 decimal, ts timestamp) stored as orc
@@ -267,6 +268,7 @@ PREHOOK: query: -- partitioned table
 create table orc_split_elim_part (userid bigint, string1 string, subtype double, decimal1 decimal, ts timestamp) partitioned by (country string, year int) stored as orc
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@orc_split_elim_part
 POSTHOOK: query: -- partitioned table
 create table orc_split_elim_part (userid bigint, string1 string, subtype double, decimal1 decimal, ts timestamp) partitioned by (country string, year int) stored as orc
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/orc_vectorization_ppd.q.out b/ql/src/test/results/clientpositive/orc_vectorization_ppd.q.out
index 921813b768..738abc47cb 100644
--- a/ql/src/test/results/clientpositive/orc_vectorization_ppd.q.out
+++ b/ql/src/test/results/clientpositive/orc_vectorization_ppd.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- create table with 1000 rows
 create table srcorc(key string, value string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcorc
 POSTHOOK: query: -- create table with 1000 rows
 create table srcorc(key string, value string) stored as textfile
 POSTHOOK: type: CREATETABLE
@@ -36,6 +37,7 @@ s3 string)
 stored as ORC tblproperties("orc.row.index.stride"="1000", "orc.stripe.size"="100000", "orc.compress.size"="10000")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@vectororc
 POSTHOOK: query: -- load table with each row group having 1000 rows and stripe 1 & 2 having 5000 & 2000 rows respectively
 create table if not exists vectororc
 (s1 string,
@@ -141,6 +143,7 @@ s3 string)
 stored as ORC tblproperties("orc.row.index.stride"="1000", "orc.stripe.size"="100000", "orc.compress.size"="10000")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@testorc
 POSTHOOK: query: -- since vectororc table has multiple orc file we will load them into a single file using another table
 create table if not exists testorc
 (s1 string,
diff --git a/ql/src/test/results/clientpositive/orc_wide_table.q.out b/ql/src/test/results/clientpositive/orc_wide_table.q.out
index 6bd6a5ad30..fcb7657907 100644
--- a/ql/src/test/results/clientpositive/orc_wide_table.q.out
+++ b/ql/src/test/results/clientpositive/orc_wide_table.q.out
@@ -2010,6 +2010,7 @@ PREHOOK: query: create table test_txt(
 ) row format delimited fields terminated by ','
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_txt
 POSTHOOK: query: create table test_txt(
 	c1 varchar(64),
 	c2 int,
@@ -4026,6 +4027,7 @@ POSTHOOK: Output: default@test_txt
 PREHOOK: query: create table test_orc like test_txt
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_orc
 POSTHOOK: query: create table test_orc like test_txt
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/order_within_subquery.q.out b/ql/src/test/results/clientpositive/order_within_subquery.q.out
index be95ccdfcb..bac225313c 100644
--- a/ql/src/test/results/clientpositive/order_within_subquery.q.out
+++ b/ql/src/test/results/clientpositive/order_within_subquery.q.out
@@ -11,6 +11,7 @@ PREHOOK: query: CREATE TABLE part(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part
 POSTHOOK: query: CREATE TABLE part( 
     p_partkey INT,
     p_name STRING,
diff --git a/ql/src/test/results/clientpositive/parallel.q.out b/ql/src/test/results/clientpositive/parallel.q.out
index 5a2dc44a71..3759c8ce28 100644
--- a/ql/src/test/results/clientpositive/parallel.q.out
+++ b/ql/src/test/results/clientpositive/parallel.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 create table if not exists src_a like src
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_a
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 create table if not exists src_a like src
@@ -12,6 +13,7 @@ POSTHOOK: Output: default@src_a
 PREHOOK: query: create table if not exists src_b like src
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_b
 POSTHOOK: query: create table if not exists src_b like src
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/parallel_orderby.q.out b/ql/src/test/results/clientpositive/parallel_orderby.q.out
index 78848e88d3..2b3c145f24 100644
--- a/ql/src/test/results/clientpositive/parallel_orderby.q.out
+++ b/ql/src/test/results/clientpositive/parallel_orderby.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table src5 (key string, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src5
 POSTHOOK: query: create table src5 (key string, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/parquet_columnar.q.out b/ql/src/test/results/clientpositive/parquet_columnar.q.out
index a4ed37242e..479027bbb4 100644
--- a/ql/src/test/results/clientpositive/parquet_columnar.q.out
+++ b/ql/src/test/results/clientpositive/parquet_columnar.q.out
@@ -18,6 +18,7 @@ PREHOOK: query: CREATE TABLE parquet_columnar_access_stage (
   FIELDS TERMINATED BY '|'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@parquet_columnar_access_stage
 POSTHOOK: query: CREATE TABLE parquet_columnar_access_stage (
     s string, 
     i int, 
@@ -35,6 +36,7 @@ PREHOOK: query: CREATE TABLE parquet_columnar_access (
   ) STORED AS PARQUET
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@parquet_columnar_access
 POSTHOOK: query: CREATE TABLE parquet_columnar_access (
     s string,
     x int,
diff --git a/ql/src/test/results/clientpositive/parquet_create.q.out b/ql/src/test/results/clientpositive/parquet_create.q.out
index 86da1bc1bc..58ea1f2775 100644
--- a/ql/src/test/results/clientpositive/parquet_create.q.out
+++ b/ql/src/test/results/clientpositive/parquet_create.q.out
@@ -18,6 +18,7 @@ COLLECTION ITEMS TERMINATED BY ','
 MAP KEYS TERMINATED BY ':'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@parquet_create_staging
 POSTHOOK: query: CREATE TABLE parquet_create_staging (
     id int,
     str string,
@@ -40,6 +41,7 @@ PREHOOK: query: CREATE TABLE parquet_create (
 ) STORED AS PARQUET
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@parquet_create
 POSTHOOK: query: CREATE TABLE parquet_create (
     id int,
     str string,
diff --git a/ql/src/test/results/clientpositive/parquet_ctas.q.out b/ql/src/test/results/clientpositive/parquet_ctas.q.out
index f25520319d..ad3210fc5a 100644
--- a/ql/src/test/results/clientpositive/parquet_ctas.q.out
+++ b/ql/src/test/results/clientpositive/parquet_ctas.q.out
@@ -21,6 +21,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table staging (key int, value string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@staging
 POSTHOOK: query: create table staging (key int, value string) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/parquet_decimal.q.out b/ql/src/test/results/clientpositive/parquet_decimal.q.out
index b2d542fc89..cd87b925e1 100644
--- a/ql/src/test/results/clientpositive/parquet_decimal.q.out
+++ b/ql/src/test/results/clientpositive/parquet_decimal.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: CREATE TABLE dec(name string, value decimal(8,4))
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dec
 POSTHOOK: query: CREATE TABLE dec(name string, value decimal(8,4))
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -24,6 +25,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: CREATE TABLE parq_dec(name string, value decimal(5,2)) STORED AS PARQUET
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@parq_dec
 POSTHOOK: query: CREATE TABLE parq_dec(name string, value decimal(5,2)) STORED AS PARQUET
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -105,6 +107,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: CREATE TABLE parq_dec1(name string, value decimal(4,1)) STORED AS PARQUET
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@parq_dec1
 POSTHOOK: query: CREATE TABLE parq_dec1(name string, value decimal(4,1)) STORED AS PARQUET
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/parquet_decimal1.q.out b/ql/src/test/results/clientpositive/parquet_decimal1.q.out
index 9ff09504fe..bd146f89bd 100644
--- a/ql/src/test/results/clientpositive/parquet_decimal1.q.out
+++ b/ql/src/test/results/clientpositive/parquet_decimal1.q.out
@@ -6,6 +6,7 @@ PREHOOK: query: CREATE TABLE dec_comp(arr ARRAY<decimal(5,2)>, m MAP<String, dec
 ROW FORMAT DELIMITED FIELDS TERMINATED BY '|' COLLECTION ITEMS TERMINATED BY ','  MAP KEYS TERMINATED by ':'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dec_comp
 POSTHOOK: query: CREATE TABLE dec_comp(arr ARRAY<decimal(5,2)>, m MAP<String, decimal(5,2)>, s STRUCT<i:int, d:decimal(5,2)>)
 ROW FORMAT DELIMITED FIELDS TERMINATED BY '|' COLLECTION ITEMS TERMINATED BY ','  MAP KEYS TERMINATED by ':'
 POSTHOOK: type: CREATETABLE
@@ -37,6 +38,7 @@ PREHOOK: query: CREATE TABLE parq_dec_comp(arr ARRAY<decimal(5,2)>, m MAP<String
 STORED AS PARQUET
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@parq_dec_comp
 POSTHOOK: query: CREATE TABLE parq_dec_comp(arr ARRAY<decimal(5,2)>, m MAP<String, decimal(5,2)>, s STRUCT<i:int, d:decimal(5,2)>)
 STORED AS PARQUET
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/parquet_mixed_case.q.out b/ql/src/test/results/clientpositive/parquet_mixed_case.q.out
index cd9d560a3f..5b8cf5970c 100644
--- a/ql/src/test/results/clientpositive/parquet_mixed_case.q.out
+++ b/ql/src/test/results/clientpositive/parquet_mixed_case.q.out
@@ -11,6 +11,7 @@ PREHOOK: query: CREATE TABLE parquet_mixed_case (
 ) STORED AS PARQUET
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@parquet_mixed_case
 POSTHOOK: query: CREATE TABLE parquet_mixed_case (
   lowerCase string,
   UPPERcase string,
diff --git a/ql/src/test/results/clientpositive/parquet_partitioned.q.out b/ql/src/test/results/clientpositive/parquet_partitioned.q.out
index 46880f8f37..2aafb291cc 100644
--- a/ql/src/test/results/clientpositive/parquet_partitioned.q.out
+++ b/ql/src/test/results/clientpositive/parquet_partitioned.q.out
@@ -18,6 +18,7 @@ PREHOOK: query: CREATE TABLE parquet_partitioned_staging (
 FIELDS TERMINATED BY '|'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@parquet_partitioned_staging
 POSTHOOK: query: CREATE TABLE parquet_partitioned_staging (
     id int,
     str string,
@@ -34,6 +35,7 @@ PREHOOK: query: CREATE TABLE parquet_partitioned (
 STORED AS PARQUET
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@parquet_partitioned
 POSTHOOK: query: CREATE TABLE parquet_partitioned (
     id int,
     str string
diff --git a/ql/src/test/results/clientpositive/parquet_serde.q.out b/ql/src/test/results/clientpositive/parquet_serde.q.out
index c8f9853541..e753180a68 100644
--- a/ql/src/test/results/clientpositive/parquet_serde.q.out
+++ b/ql/src/test/results/clientpositive/parquet_serde.q.out
@@ -11,6 +11,7 @@ PREHOOK: query: CREATE TABLE parquet_mixed_fileformat (
 FIELDS TERMINATED BY '|'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@parquet_mixed_fileformat
 POSTHOOK: query: CREATE TABLE parquet_mixed_fileformat (
     id int,
     str string,
diff --git a/ql/src/test/results/clientpositive/parquet_types.q.out b/ql/src/test/results/clientpositive/parquet_types.q.out
index dc6dc73479..3acb0520ba 100644
--- a/ql/src/test/results/clientpositive/parquet_types.q.out
+++ b/ql/src/test/results/clientpositive/parquet_types.q.out
@@ -18,6 +18,7 @@ PREHOOK: query: CREATE TABLE parquet_types_staging (
 FIELDS TERMINATED BY '|'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@parquet_types_staging
 POSTHOOK: query: CREATE TABLE parquet_types_staging (
   cint int,
   ctinyint tinyint,
@@ -42,6 +43,7 @@ PREHOOK: query: CREATE TABLE parquet_types (
 ) STORED AS PARQUET
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@parquet_types
 POSTHOOK: query: CREATE TABLE parquet_types (
   cint int,
   ctinyint tinyint,
diff --git a/ql/src/test/results/clientpositive/partInit.q.out b/ql/src/test/results/clientpositive/partInit.q.out
index 3ec95045cb..da125cf208 100644
--- a/ql/src/test/results/clientpositive/partInit.q.out
+++ b/ql/src/test/results/clientpositive/partInit.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE empty (c INT) PARTITIONED BY (p INT)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@empty
 POSTHOOK: query: CREATE TABLE empty (c INT) PARTITIONED BY (p INT)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/part_inherit_tbl_props.q.out b/ql/src/test/results/clientpositive/part_inherit_tbl_props.q.out
index 15e8d75bd7..144d89e26b 100644
--- a/ql/src/test/results/clientpositive/part_inherit_tbl_props.q.out
+++ b/ql/src/test/results/clientpositive/part_inherit_tbl_props.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- The property needs to be unset at the end of the test till HI
 create table mytbl (c1 tinyint) partitioned by (c2 string) tblproperties ('a'='myval','b'='yourval','c'='noval')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@mytbl
 POSTHOOK: query: -- The property needs to be unset at the end of the test till HIVE-3109/HIVE-3112 is fixed
 
 create table mytbl (c1 tinyint) partitioned by (c2 string) tblproperties ('a'='myval','b'='yourval','c'='noval')
diff --git a/ql/src/test/results/clientpositive/part_inherit_tbl_props_empty.q.out b/ql/src/test/results/clientpositive/part_inherit_tbl_props_empty.q.out
index 6e11ac4baf..758712f0a5 100644
--- a/ql/src/test/results/clientpositive/part_inherit_tbl_props_empty.q.out
+++ b/ql/src/test/results/clientpositive/part_inherit_tbl_props_empty.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table mytbl (c1 tinyint) partitioned by (c2 string) tblproperties ('a'='myval','b'='yourval','c'='noval')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@mytbl
 POSTHOOK: query: create table mytbl (c1 tinyint) partitioned by (c2 string) tblproperties ('a'='myval','b'='yourval','c'='noval')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/part_inherit_tbl_props_with_star.q.out b/ql/src/test/results/clientpositive/part_inherit_tbl_props_with_star.q.out
index 88fe5b599e..85ad687b4f 100644
--- a/ql/src/test/results/clientpositive/part_inherit_tbl_props_with_star.q.out
+++ b/ql/src/test/results/clientpositive/part_inherit_tbl_props_with_star.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- The property needs to be unset at the end of the test till HI
 create table mytbl (c1 tinyint) partitioned by (c2 string) tblproperties ('a'='myval','b'='yourval','c'='noval')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@mytbl
 POSTHOOK: query: -- The property needs to be unset at the end of the test till HIVE-3109/HIVE-3112 is fixed
 
 create table mytbl (c1 tinyint) partitioned by (c2 string) tblproperties ('a'='myval','b'='yourval','c'='noval')
diff --git a/ql/src/test/results/clientpositive/partcols1.q.out b/ql/src/test/results/clientpositive/partcols1.q.out
index 55a173834e..e92cfef35d 100644
--- a/ql/src/test/results/clientpositive/partcols1.q.out
+++ b/ql/src/test/results/clientpositive/partcols1.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table test1(col1 string) partitioned by (partitionId int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test1
 POSTHOOK: query: create table test1(col1 string) partitioned by (partitionId int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/partition_date.q.out b/ql/src/test/results/clientpositive/partition_date.q.out
index 266ce6f102..9720a48958 100644
--- a/ql/src/test/results/clientpositive/partition_date.q.out
+++ b/ql/src/test/results/clientpositive/partition_date.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table partition_date_1 (key string, value string) partitioned by (dt date, region string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@partition_date_1
 POSTHOOK: query: create table partition_date_1 (key string, value string) partitioned by (dt date, region string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/partition_date2.q.out b/ql/src/test/results/clientpositive/partition_date2.q.out
index 6ad8528db6..bf3a59d581 100644
--- a/ql/src/test/results/clientpositive/partition_date2.q.out
+++ b/ql/src/test/results/clientpositive/partition_date2.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table partition_date2_1 (key string, value string) partitioned by (dt date, region int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@partition_date2_1
 POSTHOOK: query: create table partition_date2_1 (key string, value string) partitioned by (dt date, region int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/partition_decode_name.q.out b/ql/src/test/results/clientpositive/partition_decode_name.q.out
index 2195782d08..3730f69c0b 100644
--- a/ql/src/test/results/clientpositive/partition_decode_name.q.out
+++ b/ql/src/test/results/clientpositive/partition_decode_name.q.out
@@ -18,6 +18,7 @@ POSTHOOK: Output: default@sc
 PREHOOK: query: create table sc_part (key string) partitioned by (ts string) stored as rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@sc_part
 POSTHOOK: query: create table sc_part (key string) partitioned by (ts string) stored as rcfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/partition_schema1.q.out b/ql/src/test/results/clientpositive/partition_schema1.q.out
index 298af900e5..48935369d7 100644
--- a/ql/src/test/results/clientpositive/partition_schema1.q.out
+++ b/ql/src/test/results/clientpositive/partition_schema1.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table partition_schema1(key string, value string) partitioned by (dt string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@partition_schema1
 POSTHOOK: query: create table partition_schema1(key string, value string) partitioned by (dt string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/partition_serde_format.q.out b/ql/src/test/results/clientpositive/partition_serde_format.q.out
index b57a094131..f04de01649 100644
--- a/ql/src/test/results/clientpositive/partition_serde_format.q.out
+++ b/ql/src/test/results/clientpositive/partition_serde_format.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table src_part_serde (key int, value string) partitioned by (ds string) stored as sequencefile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_part_serde
 POSTHOOK: query: create table src_part_serde (key int, value string) partitioned by (ds string) stored as sequencefile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/partition_special_char.q.out b/ql/src/test/results/clientpositive/partition_special_char.q.out
index 64feb99ede..d45d9e4ee9 100644
--- a/ql/src/test/results/clientpositive/partition_special_char.q.out
+++ b/ql/src/test/results/clientpositive/partition_special_char.q.out
@@ -18,6 +18,7 @@ POSTHOOK: Output: default@sc
 PREHOOK: query: create table sc_part (key string) partitioned by (ts string) stored as rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@sc_part
 POSTHOOK: query: create table sc_part (key string) partitioned by (ts string) stored as rcfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/partition_type_check.q.out b/ql/src/test/results/clientpositive/partition_type_check.q.out
index c61f4fc4c0..e25d527e7e 100644
--- a/ql/src/test/results/clientpositive/partition_type_check.q.out
+++ b/ql/src/test/results/clientpositive/partition_type_check.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- begin part(string, string) pass(string, int)
 CREATE TABLE tab1 (id1 int,id2 string) PARTITIONED BY(month string,day string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tab1
 POSTHOOK: query: -- begin part(string, string) pass(string, int)
 CREATE TABLE tab1 (id1 int,id2 string) PARTITIONED BY(month string,day string) stored as textfile
 POSTHOOK: type: CREATETABLE
@@ -44,6 +45,7 @@ PREHOOK: query: -- begin part(string, int) pass(string, string)
 CREATE TABLE tab1 (id1 int,id2 string) PARTITIONED BY(month string,day int) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tab1
 POSTHOOK: query: -- begin part(string, int) pass(string, string)
 CREATE TABLE tab1 (id1 int,id2 string) PARTITIONED BY(month string,day int) stored as textfile
 POSTHOOK: type: CREATETABLE
@@ -86,6 +88,7 @@ PREHOOK: query: -- begin part(string, date) pass(string, date)
 create table tab1 (id1 int, id2 string) PARTITIONED BY(month string,day date) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tab1
 POSTHOOK: query: -- begin part(string, date) pass(string, date)
 create table tab1 (id1 int, id2 string) PARTITIONED BY(month string,day date) stored as textfile
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/partition_varchar1.q.out b/ql/src/test/results/clientpositive/partition_varchar1.q.out
index a25a79aaa9..5b6649f30c 100644
--- a/ql/src/test/results/clientpositive/partition_varchar1.q.out
+++ b/ql/src/test/results/clientpositive/partition_varchar1.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table partition_varchar_1 (key string, value varchar(20)) partitioned by (dt varchar(10), region int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@partition_varchar_1
 POSTHOOK: query: create table partition_varchar_1 (key string, value varchar(20)) partitioned by (dt varchar(10), region int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/partition_varchar2.q.out b/ql/src/test/results/clientpositive/partition_varchar2.q.out
index a88498ed93..16e0f2dd0d 100644
--- a/ql/src/test/results/clientpositive/partition_varchar2.q.out
+++ b/ql/src/test/results/clientpositive/partition_varchar2.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table partition_varchar_2 (key string, value varchar(20)) partitioned by (dt varchar(15), region int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@partition_varchar_2
 POSTHOOK: query: create table partition_varchar_2 (key string, value varchar(20)) partitioned by (dt varchar(15), region int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/partition_vs_table_metadata.q.out b/ql/src/test/results/clientpositive/partition_vs_table_metadata.q.out
index 6293e357fc..6fc8b06547 100644
--- a/ql/src/test/results/clientpositive/partition_vs_table_metadata.q.out
+++ b/ql/src/test/results/clientpositive/partition_vs_table_metadata.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table partition_vs_table(key string, value string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@partition_vs_table
 POSTHOOK: query: create table partition_vs_table(key string, value string) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/partition_wise_fileformat.q.out b/ql/src/test/results/clientpositive/partition_wise_fileformat.q.out
index ffcc9c6740..8c2d1a015a 100644
--- a/ql/src/test/results/clientpositive/partition_wise_fileformat.q.out
+++ b/ql/src/test/results/clientpositive/partition_wise_fileformat.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table partition_test_partitioned(key string, value string) partitioned by (dt string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@partition_test_partitioned
 POSTHOOK: query: create table partition_test_partitioned(key string, value string) partitioned by (dt string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/partition_wise_fileformat10.q.out b/ql/src/test/results/clientpositive/partition_wise_fileformat10.q.out
index fb04264e61..171193e447 100644
--- a/ql/src/test/results/clientpositive/partition_wise_fileformat10.q.out
+++ b/ql/src/test/results/clientpositive/partition_wise_fileformat10.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- This tests that the schema can be changed for binary serde da
 create table prt(key string, value string) partitioned by (dt string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@prt
 POSTHOOK: query: -- This tests that the schema can be changed for binary serde data
 create table prt(key string, value string) partitioned by (dt string)
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/partition_wise_fileformat11.q.out b/ql/src/test/results/clientpositive/partition_wise_fileformat11.q.out
index e0d9bf285a..0b39b77f9f 100644
--- a/ql/src/test/results/clientpositive/partition_wise_fileformat11.q.out
+++ b/ql/src/test/results/clientpositive/partition_wise_fileformat11.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- This tests that the schema can be changed for binary serde da
 create table partition_test_partitioned(key string, value string) partitioned by (dt string) stored as rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@partition_test_partitioned
 POSTHOOK: query: -- This tests that the schema can be changed for binary serde data
 create table partition_test_partitioned(key string, value string) partitioned by (dt string) stored as rcfile
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/partition_wise_fileformat12.q.out b/ql/src/test/results/clientpositive/partition_wise_fileformat12.q.out
index 788b9a5314..2bf75a7d33 100644
--- a/ql/src/test/results/clientpositive/partition_wise_fileformat12.q.out
+++ b/ql/src/test/results/clientpositive/partition_wise_fileformat12.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- This tests that the schema can be changed for binary serde da
 create table partition_test_partitioned(key string, value string) partitioned by (dt string) stored as rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@partition_test_partitioned
 POSTHOOK: query: -- This tests that the schema can be changed for binary serde data
 create table partition_test_partitioned(key string, value string) partitioned by (dt string) stored as rcfile
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/partition_wise_fileformat13.q.out b/ql/src/test/results/clientpositive/partition_wise_fileformat13.q.out
index e2b42ce3b7..da6881cad4 100644
--- a/ql/src/test/results/clientpositive/partition_wise_fileformat13.q.out
+++ b/ql/src/test/results/clientpositive/partition_wise_fileformat13.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- This tests that the schema can be changed for partitioned tab
 create table T1(key string, value string) partitioned by (dt string) stored as rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: -- This tests that the schema can be changed for partitioned tables for binary serde data for joins
 create table T1(key string, value string) partitioned by (dt string) stored as rcfile
 POSTHOOK: type: CREATETABLE
@@ -54,6 +55,7 @@ POSTHOOK: Output: default@t1
 PREHOOK: query: create table T2(key string, value string) partitioned by (dt string) stored as rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T2
 POSTHOOK: query: create table T2(key string, value string) partitioned by (dt string) stored as rcfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/partition_wise_fileformat14.q.out b/ql/src/test/results/clientpositive/partition_wise_fileformat14.q.out
index f09bcf3844..3e4e7c3d83 100644
--- a/ql/src/test/results/clientpositive/partition_wise_fileformat14.q.out
+++ b/ql/src/test/results/clientpositive/partition_wise_fileformat14.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: CREATE TABLE tbl1(key int, value string) PARTITIONED by (ds stri
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl1
 POSTHOOK: query: CREATE TABLE tbl1(key int, value string) PARTITIONED by (ds string)
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS rcfile
 POSTHOOK: type: CREATETABLE
@@ -11,6 +12,7 @@ PREHOOK: query: CREATE TABLE tbl2(key int, value string) PARTITIONED by (ds stri
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl2
 POSTHOOK: query: CREATE TABLE tbl2(key int, value string) PARTITIONED by (ds string)
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS rcfile
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/partition_wise_fileformat15.q.out b/ql/src/test/results/clientpositive/partition_wise_fileformat15.q.out
index 4f78eae908..16d259e63c 100644
--- a/ql/src/test/results/clientpositive/partition_wise_fileformat15.q.out
+++ b/ql/src/test/results/clientpositive/partition_wise_fileformat15.q.out
@@ -3,6 +3,7 @@ create table partition_test_partitioned(key string, value string)
 partitioned by (dt string) stored as rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@partition_test_partitioned
 POSTHOOK: query: -- This tests that the schema can be changed for binary serde data
 create table partition_test_partitioned(key string, value string)
 partitioned by (dt string) stored as rcfile
diff --git a/ql/src/test/results/clientpositive/partition_wise_fileformat16.q.out b/ql/src/test/results/clientpositive/partition_wise_fileformat16.q.out
index 63bbc7a2a7..c1bcb1a658 100644
--- a/ql/src/test/results/clientpositive/partition_wise_fileformat16.q.out
+++ b/ql/src/test/results/clientpositive/partition_wise_fileformat16.q.out
@@ -3,6 +3,7 @@ create table partition_test_partitioned(key string, value string)
 partitioned by (dt string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@partition_test_partitioned
 POSTHOOK: query: -- This tests that the schema can be changed for binary serde data
 create table partition_test_partitioned(key string, value string)
 partitioned by (dt string) stored as textfile
diff --git a/ql/src/test/results/clientpositive/partition_wise_fileformat17.q.out b/ql/src/test/results/clientpositive/partition_wise_fileformat17.q.out
index 11590bfd48..e9502e0fa8 100644
--- a/ql/src/test/results/clientpositive/partition_wise_fileformat17.q.out
+++ b/ql/src/test/results/clientpositive/partition_wise_fileformat17.q.out
@@ -13,6 +13,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: CREATE TABLE PW17(USER STRING, COMPLEXDT ARRAY<INT>) PARTITIONED BY (YEAR STRING) ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.CustomSerDe1'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@PW17
 POSTHOOK: query: CREATE TABLE PW17(USER STRING, COMPLEXDT ARRAY<INT>) PARTITIONED BY (YEAR STRING) ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.CustomSerDe1'
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -68,6 +69,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: CREATE TABLE PW17_2(USER STRING, COMPLEXDT ARRAY<INT>) ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.CustomSerDe1'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@PW17_2
 POSTHOOK: query: CREATE TABLE PW17_2(USER STRING, COMPLEXDT ARRAY<INT>) ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.CustomSerDe1'
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -98,6 +100,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: CREATE TABLE PW17_3(USER STRING, COMPLEXDT ARRAY<ARRAY<INT> >) PARTITIONED BY (YEAR STRING) ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.CustomSerDe3'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@PW17_3
 POSTHOOK: query: CREATE TABLE PW17_3(USER STRING, COMPLEXDT ARRAY<ARRAY<INT> >) PARTITIONED BY (YEAR STRING) ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.CustomSerDe3'
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -151,6 +154,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: CREATE TABLE PW17_4(USER STRING, COMPLEXDT ARRAY<ARRAY<INT> >) ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.CustomSerDe3'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@PW17_4
 POSTHOOK: query: CREATE TABLE PW17_4(USER STRING, COMPLEXDT ARRAY<ARRAY<INT> >) ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.CustomSerDe3'
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/partition_wise_fileformat18.q.out b/ql/src/test/results/clientpositive/partition_wise_fileformat18.q.out
index d9b5ba5b8c..5d75ff8cea 100644
--- a/ql/src/test/results/clientpositive/partition_wise_fileformat18.q.out
+++ b/ql/src/test/results/clientpositive/partition_wise_fileformat18.q.out
@@ -15,6 +15,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: CREATE TABLE PW18(USER STRING, COMPLEXDT UNIONTYPE<INT, DOUBLE>) PARTITIONED BY (YEAR STRING) ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.CustomSerDe5'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@PW18
 POSTHOOK: query: CREATE TABLE PW18(USER STRING, COMPLEXDT UNIONTYPE<INT, DOUBLE>) PARTITIONED BY (YEAR STRING) ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.CustomSerDe5'
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -62,6 +63,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: CREATE TABLE PW18_2(USER STRING, COMPLEXDT UNIONTYPE<INT, DOUBLE>) ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.CustomSerDe5'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@PW18_2
 POSTHOOK: query: CREATE TABLE PW18_2(USER STRING, COMPLEXDT UNIONTYPE<INT, DOUBLE>) ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.CustomSerDe5'
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/partition_wise_fileformat2.q.out b/ql/src/test/results/clientpositive/partition_wise_fileformat2.q.out
index 4c3f682f05..2537f24cc1 100644
--- a/ql/src/test/results/clientpositive/partition_wise_fileformat2.q.out
+++ b/ql/src/test/results/clientpositive/partition_wise_fileformat2.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table partition_test_partitioned(key string, value string) partitioned by (dt string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@partition_test_partitioned
 POSTHOOK: query: create table partition_test_partitioned(key string, value string) partitioned by (dt string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/partition_wise_fileformat3.q.out b/ql/src/test/results/clientpositive/partition_wise_fileformat3.q.out
index 08c73faa1c..976fc06496 100644
--- a/ql/src/test/results/clientpositive/partition_wise_fileformat3.q.out
+++ b/ql/src/test/results/clientpositive/partition_wise_fileformat3.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table partition_test_partitioned(key string, value string) partitioned by (dt string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@partition_test_partitioned
 POSTHOOK: query: create table partition_test_partitioned(key string, value string) partitioned by (dt string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/partition_wise_fileformat4.q.out b/ql/src/test/results/clientpositive/partition_wise_fileformat4.q.out
index 48b1c9b262..e8c3a1779e 100644
--- a/ql/src/test/results/clientpositive/partition_wise_fileformat4.q.out
+++ b/ql/src/test/results/clientpositive/partition_wise_fileformat4.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table partition_test_partitioned(key string, value string) partitioned by (dt string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@partition_test_partitioned
 POSTHOOK: query: create table partition_test_partitioned(key string, value string) partitioned by (dt string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/partition_wise_fileformat5.q.out b/ql/src/test/results/clientpositive/partition_wise_fileformat5.q.out
index fee5c3a1b9..97e48b1ff0 100644
--- a/ql/src/test/results/clientpositive/partition_wise_fileformat5.q.out
+++ b/ql/src/test/results/clientpositive/partition_wise_fileformat5.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table partition_test_partitioned(key string, value string) partitioned by (dt string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@partition_test_partitioned
 POSTHOOK: query: create table partition_test_partitioned(key string, value string) partitioned by (dt string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/partition_wise_fileformat6.q.out b/ql/src/test/results/clientpositive/partition_wise_fileformat6.q.out
index 975f02a858..1ae15e0592 100644
--- a/ql/src/test/results/clientpositive/partition_wise_fileformat6.q.out
+++ b/ql/src/test/results/clientpositive/partition_wise_fileformat6.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table partition_test_partitioned(key string, value string) partitioned by (dt string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@partition_test_partitioned
 POSTHOOK: query: create table partition_test_partitioned(key string, value string) partitioned by (dt string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/partition_wise_fileformat7.q.out b/ql/src/test/results/clientpositive/partition_wise_fileformat7.q.out
index 0a283fca4d..5c2c7855aa 100644
--- a/ql/src/test/results/clientpositive/partition_wise_fileformat7.q.out
+++ b/ql/src/test/results/clientpositive/partition_wise_fileformat7.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table partition_test_partitioned(key string, value string) partitioned by (dt string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@partition_test_partitioned
 POSTHOOK: query: create table partition_test_partitioned(key string, value string) partitioned by (dt string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/partition_wise_fileformat8.q.out b/ql/src/test/results/clientpositive/partition_wise_fileformat8.q.out
index ed3fe0696e..a7b1123143 100644
--- a/ql/src/test/results/clientpositive/partition_wise_fileformat8.q.out
+++ b/ql/src/test/results/clientpositive/partition_wise_fileformat8.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- This tests that a query can span multiple partitions which ca
 create table partition_test_partitioned(key string, value string) partitioned by (dt string) stored as rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@partition_test_partitioned
 POSTHOOK: query: -- This tests that a query can span multiple partitions which can not only have different file formats, but
 -- also different serdes
 create table partition_test_partitioned(key string, value string) partitioned by (dt string) stored as rcfile
diff --git a/ql/src/test/results/clientpositive/partition_wise_fileformat9.q.out b/ql/src/test/results/clientpositive/partition_wise_fileformat9.q.out
index 2ed973fa7a..706d647dee 100644
--- a/ql/src/test/results/clientpositive/partition_wise_fileformat9.q.out
+++ b/ql/src/test/results/clientpositive/partition_wise_fileformat9.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- This tests that a query can span multiple partitions which ca
 create table partition_test_partitioned(key string, value string) partitioned by (dt string) stored as rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@partition_test_partitioned
 POSTHOOK: query: -- This tests that a query can span multiple partitions which can not only have different file formats, but
 -- also different serdes
 create table partition_test_partitioned(key string, value string) partitioned by (dt string) stored as rcfile
diff --git a/ql/src/test/results/clientpositive/partitions_json.q.out b/ql/src/test/results/clientpositive/partitions_json.q.out
index da6bdd2f14..e934f59391 100644
--- a/ql/src/test/results/clientpositive/partitions_json.q.out
+++ b/ql/src/test/results/clientpositive/partitions_json.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE add_part_test (key STRING, value STRING) PARTITIONED BY (ds STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@add_part_test
 POSTHOOK: query: CREATE TABLE add_part_test (key STRING, value STRING) PARTITIONED BY (ds STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/pcr.q.out b/ql/src/test/results/clientpositive/pcr.q.out
index c734f749ed..615525008d 100644
--- a/ql/src/test/results/clientpositive/pcr.q.out
+++ b/ql/src/test/results/clientpositive/pcr.q.out
@@ -13,6 +13,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table pcr_t1 (key int, value string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@pcr_t1
 POSTHOOK: query: create table pcr_t1 (key int, value string) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -3966,6 +3967,7 @@ POSTHOOK: Input: default@pcr_t1@ds=2000-04-10
 PREHOOK: query: create table pcr_t2 (key int, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@pcr_t2
 POSTHOOK: query: create table pcr_t2 (key int, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -3973,6 +3975,7 @@ POSTHOOK: Output: default@pcr_t2
 PREHOOK: query: create table pcr_t3 (key int, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@pcr_t3
 POSTHOOK: query: create table pcr_t3 (key int, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -5857,6 +5860,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table pcr_foo (key int, value string) partitioned by (ds int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@pcr_foo
 POSTHOOK: query: create table pcr_foo (key int, value string) partitioned by (ds int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -5987,6 +5991,7 @@ row format delimited
   collection items terminated by '\001'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@ab
 POSTHOOK: query: -- Cover org.apache.hadoop.hive.ql.optimizer.pcr.PcrExprProcFactory.FieldExprProcessor.
 -- Create a table with a struct data:
 create table ab(strct struct<a:int, b:string>)
@@ -6015,6 +6020,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table foo_field (s struct<a:int,b:string>) partitioned by (ds int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@foo_field
 POSTHOOK: query: create table foo_field (s struct<a:int,b:string>) partitioned by (ds int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/ppd_constant_expr.q.out b/ql/src/test/results/clientpositive/ppd_constant_expr.q.out
index 9cff339456..001f3a1e2c 100644
--- a/ql/src/test/results/clientpositive/ppd_constant_expr.q.out
+++ b/ql/src/test/results/clientpositive/ppd_constant_expr.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE ppd_constant_expr(c1 STRING, c2 INT, c3 DOUBLE) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@ppd_constant_expr
 POSTHOOK: query: CREATE TABLE ppd_constant_expr(c1 STRING, c2 INT, c3 DOUBLE) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/ppd_field_garbage.q.out b/ql/src/test/results/clientpositive/ppd_field_garbage.q.out
index 0b74a41517..e99c305362 100644
--- a/ql/src/test/results/clientpositive/ppd_field_garbage.q.out
+++ b/ql/src/test/results/clientpositive/ppd_field_garbage.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- ppd leaves invalid expr in field expr
 CREATE TABLE test_issue (fileid int, infos ARRAY<STRUCT<user:INT>>, test_c STRUCT<user_c:STRUCT<age:INT>>)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_issue
 POSTHOOK: query: -- ppd leaves invalid expr in field expr
 CREATE TABLE test_issue (fileid int, infos ARRAY<STRUCT<user:INT>>, test_c STRUCT<user_c:STRUCT<age:INT>>)
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/ppd_join4.q.out b/ql/src/test/results/clientpositive/ppd_join4.q.out
index 2c52a12e36..c995f603c3 100644
--- a/ql/src/test/results/clientpositive/ppd_join4.q.out
+++ b/ql/src/test/results/clientpositive/ppd_join4.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table dual(a string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dual
 POSTHOOK: query: create table dual(a string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -12,6 +13,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table test_tbl (id string,name string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_tbl
 POSTHOOK: query: create table test_tbl (id string,name string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/ppd_join5.q.out b/ql/src/test/results/clientpositive/ppd_join5.q.out
index 1559ad8846..1461723885 100644
--- a/ql/src/test/results/clientpositive/ppd_join5.q.out
+++ b/ql/src/test/results/clientpositive/ppd_join5.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table t1 (id1 string, id2 string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t1
 POSTHOOK: query: create table t1 (id1 string, id2 string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@t1
 PREHOOK: query: create table t2 (id string, d int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t2
 POSTHOOK: query: create table t2 (id string, d int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/ppd_multi_insert.q.out b/ql/src/test/results/clientpositive/ppd_multi_insert.q.out
index f3cb9107ce..cc2144d5d5 100644
--- a/ql/src/test/results/clientpositive/ppd_multi_insert.q.out
+++ b/ql/src/test/results/clientpositive/ppd_multi_insert.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE mi1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@mi1
 POSTHOOK: query: CREATE TABLE mi1(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@mi1
 PREHOOK: query: CREATE TABLE mi2(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@mi2
 POSTHOOK: query: CREATE TABLE mi2(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -15,6 +17,7 @@ POSTHOOK: Output: default@mi2
 PREHOOK: query: CREATE TABLE mi3(key INT) PARTITIONED BY(ds STRING, hr STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@mi3
 POSTHOOK: query: CREATE TABLE mi3(key INT) PARTITIONED BY(ds STRING, hr STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/ppd_outer_join5.q.out b/ql/src/test/results/clientpositive/ppd_outer_join5.q.out
index 9cb47e16d7..4bd7653bf4 100644
--- a/ql/src/test/results/clientpositive/ppd_outer_join5.q.out
+++ b/ql/src/test/results/clientpositive/ppd_outer_join5.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table t1 (id int, key string, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t1
 POSTHOOK: query: create table t1 (id int, key string, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@t1
 PREHOOK: query: create table t2 (id int, key string, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t2
 POSTHOOK: query: create table t2 (id int, key string, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -15,6 +17,7 @@ POSTHOOK: Output: default@t2
 PREHOOK: query: create table t3 (id int, key string, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t3
 POSTHOOK: query: create table t3 (id int, key string, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -22,6 +25,7 @@ POSTHOOK: Output: default@t3
 PREHOOK: query: create table t4 (id int, key string, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t4
 POSTHOOK: query: create table t4 (id int, key string, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/ppd_repeated_alias.q.out b/ql/src/test/results/clientpositive/ppd_repeated_alias.q.out
index d64589f7ce..1ec9b414c3 100644
--- a/ql/src/test/results/clientpositive/ppd_repeated_alias.q.out
+++ b/ql/src/test/results/clientpositive/ppd_repeated_alias.q.out
@@ -9,6 +9,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table pokes (foo int, bar int, blah int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@pokes
 POSTHOOK: query: create table pokes (foo int, bar int, blah int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -16,6 +17,7 @@ POSTHOOK: Output: default@pokes
 PREHOOK: query: create table pokes2 (foo int, bar int, blah int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@pokes2
 POSTHOOK: query: create table pokes2 (foo int, bar int, blah int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/ppd_union_view.q.out b/ql/src/test/results/clientpositive/ppd_union_view.q.out
index 7b0c52861d..405c912517 100644
--- a/ql/src/test/results/clientpositive/ppd_union_view.q.out
+++ b/ql/src/test/results/clientpositive/ppd_union_view.q.out
@@ -9,6 +9,7 @@ POSTHOOK: type: DROPVIEW
 PREHOOK: query: create table t1_new (key string, value string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t1_new
 POSTHOOK: query: create table t1_new (key string, value string) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -40,6 +41,7 @@ POSTHOOK: Lineage: t1_new PARTITION(ds=2011-10-16).value SIMPLE []
 PREHOOK: query: create table t1_old (keymap string, value string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t1_old
 POSTHOOK: query: create table t1_old (keymap string, value string) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -71,6 +73,7 @@ POSTHOOK: Lineage: t1_old PARTITION(ds=2011-10-14).value SIMPLE []
 PREHOOK: query: create table t1_mapping (key string, keymap string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t1_mapping
 POSTHOOK: query: create table t1_mapping (key string, keymap string) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/ppr_pushdown.q.out b/ql/src/test/results/clientpositive/ppr_pushdown.q.out
index 993b99d1ae..5c59810c2d 100644
--- a/ql/src/test/results/clientpositive/ppr_pushdown.q.out
+++ b/ql/src/test/results/clientpositive/ppr_pushdown.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table ppr_test (key string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@ppr_test
 POSTHOOK: query: create table ppr_test (key string) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/ppr_pushdown2.q.out b/ql/src/test/results/clientpositive/ppr_pushdown2.q.out
index cb3dc38f29..14fd7c3dec 100644
--- a/ql/src/test/results/clientpositive/ppr_pushdown2.q.out
+++ b/ql/src/test/results/clientpositive/ppr_pushdown2.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table ppr_test (key string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@ppr_test
 POSTHOOK: query: create table ppr_test (key string) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -48,6 +49,7 @@ POSTHOOK: Input: default@ppr_test@ds=22
 PREHOOK: query: create table ppr_test2 (key string) partitioned by (ds string, s string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@ppr_test2
 POSTHOOK: query: create table ppr_test2 (key string) partitioned by (ds string, s string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -95,6 +97,7 @@ POSTHOOK: Input: default@ppr_test2@ds=1/s=2
 PREHOOK: query: create table ppr_test3 (key string) partitioned by (col string, ol string, l string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@ppr_test3
 POSTHOOK: query: create table ppr_test3 (key string) partitioned by (col string, ol string, l string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/print_header.q.out b/ql/src/test/results/clientpositive/print_header.q.out
index 408b957ceb..48d7455196 100644
--- a/ql/src/test/results/clientpositive/print_header.q.out
+++ b/ql/src/test/results/clientpositive/print_header.q.out
@@ -51,5 +51,7 @@ src.key	_c1
 114	114.0
 PREHOOK: query: use default
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:default
 POSTHOOK: query: use default
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:default
diff --git a/ql/src/test/results/clientpositive/progress_1.q.out b/ql/src/test/results/clientpositive/progress_1.q.out
index c22d9c468d..077176f306 100644
--- a/ql/src/test/results/clientpositive/progress_1.q.out
+++ b/ql/src/test/results/clientpositive/progress_1.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE PROGRESS_1(key int, value string) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@PROGRESS_1
 POSTHOOK: query: CREATE TABLE PROGRESS_1(key int, value string) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/protectmode.q.out b/ql/src/test/results/clientpositive/protectmode.q.out
index d747ac4cd5..03262931bf 100644
--- a/ql/src/test/results/clientpositive/protectmode.q.out
+++ b/ql/src/test/results/clientpositive/protectmode.q.out
@@ -13,6 +13,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table tbl1  (col string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl1
 POSTHOOK: query: create table tbl1  (col string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -86,6 +87,7 @@ POSTHOOK: Input: default@tbl1
 PREHOOK: query: create table tbl2  (col string) partitioned by (p string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl2
 POSTHOOK: query: create table tbl2  (col string) partitioned by (p string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/protectmode2.q.out b/ql/src/test/results/clientpositive/protectmode2.q.out
index 6e4c55c4da..4ac3e61d2f 100644
--- a/ql/src/test/results/clientpositive/protectmode2.q.out
+++ b/ql/src/test/results/clientpositive/protectmode2.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table tbl1 (col string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl1
 POSTHOOK: query: create table tbl1 (col string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -83,6 +84,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table tbl2 (col string) partitioned by (p string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl2
 POSTHOOK: query: create table tbl2 (col string) partitioned by (p string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/ptf.q.out b/ql/src/test/results/clientpositive/ptf.q.out
index 34d2ef0171..25ad0a905a 100644
--- a/ql/src/test/results/clientpositive/ptf.q.out
+++ b/ql/src/test/results/clientpositive/ptf.q.out
@@ -16,6 +16,7 @@ CREATE TABLE part(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part
 POSTHOOK: query: -- data setup
 CREATE TABLE part( 
     p_partkey INT,
@@ -826,6 +827,7 @@ dr INT,
 s DOUBLE)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part_4
 POSTHOOK: query: -- 17. testMultipleInserts2SWQsWithPTF
 CREATE TABLE part_4( 
 p_mfgr STRING, 
@@ -848,6 +850,7 @@ cud DOUBLE,
 fv1 INT)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part_5
 POSTHOOK: query: CREATE TABLE part_5( 
 p_mfgr STRING, 
 p_name STRING, 
diff --git a/ql/src/test/results/clientpositive/ptf_decimal.q.out b/ql/src/test/results/clientpositive/ptf_decimal.q.out
index bacf181a90..de984c4540 100644
--- a/ql/src/test/results/clientpositive/ptf_decimal.q.out
+++ b/ql/src/test/results/clientpositive/ptf_decimal.q.out
@@ -16,6 +16,7 @@ CREATE TABLE part(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part
 POSTHOOK: query: -- data setup
 CREATE TABLE part( 
     p_partkey INT,
diff --git a/ql/src/test/results/clientpositive/ptf_general_queries.q.out b/ql/src/test/results/clientpositive/ptf_general_queries.q.out
index 75b5e6698c..df42af51c2 100644
--- a/ql/src/test/results/clientpositive/ptf_general_queries.q.out
+++ b/ql/src/test/results/clientpositive/ptf_general_queries.q.out
@@ -16,6 +16,7 @@ CREATE TABLE part(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part
 POSTHOOK: query: -- data setup
 CREATE TABLE part( 
     p_partkey INT,
diff --git a/ql/src/test/results/clientpositive/ptf_matchpath.q.out b/ql/src/test/results/clientpositive/ptf_matchpath.q.out
index 2ceee12b76..f04c998fd3 100644
--- a/ql/src/test/results/clientpositive/ptf_matchpath.q.out
+++ b/ql/src/test/results/clientpositive/ptf_matchpath.q.out
@@ -13,6 +13,7 @@ FL_NUM string
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@flights_tiny
 POSTHOOK: query: create table flights_tiny ( 
 ORIGIN_CITY_NAME string, 
 DEST_CITY_NAME string, 
diff --git a/ql/src/test/results/clientpositive/ptf_rcfile.q.out b/ql/src/test/results/clientpositive/ptf_rcfile.q.out
index 87c412f02d..7cc0933028 100644
--- a/ql/src/test/results/clientpositive/ptf_rcfile.q.out
+++ b/ql/src/test/results/clientpositive/ptf_rcfile.q.out
@@ -15,6 +15,7 @@ PREHOOK: query: CREATE TABLE part_rc(
 )  STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part_rc
 POSTHOOK: query: CREATE TABLE part_rc( 
     p_partkey INT,
     p_name STRING,
diff --git a/ql/src/test/results/clientpositive/ptf_register_tblfn.q.out b/ql/src/test/results/clientpositive/ptf_register_tblfn.q.out
index d205371429..5a0235067d 100644
--- a/ql/src/test/results/clientpositive/ptf_register_tblfn.q.out
+++ b/ql/src/test/results/clientpositive/ptf_register_tblfn.q.out
@@ -13,6 +13,7 @@ FL_NUM string
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@flights_tiny
 POSTHOOK: query: create table flights_tiny ( 
 ORIGIN_CITY_NAME string, 
 DEST_CITY_NAME string, 
diff --git a/ql/src/test/results/clientpositive/ptf_seqfile.q.out b/ql/src/test/results/clientpositive/ptf_seqfile.q.out
index 2b3d76e0f0..eb0f070eed 100644
--- a/ql/src/test/results/clientpositive/ptf_seqfile.q.out
+++ b/ql/src/test/results/clientpositive/ptf_seqfile.q.out
@@ -15,6 +15,7 @@ PREHOOK: query: CREATE TABLE part_seq(
 ) STORED AS SEQUENCEFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part_seq
 POSTHOOK: query: CREATE TABLE part_seq( 
     p_partkey INT,
     p_name STRING,
diff --git a/ql/src/test/results/clientpositive/ptf_streaming.q.out b/ql/src/test/results/clientpositive/ptf_streaming.q.out
index d0392726e6..c082643bcb 100644
--- a/ql/src/test/results/clientpositive/ptf_streaming.q.out
+++ b/ql/src/test/results/clientpositive/ptf_streaming.q.out
@@ -16,6 +16,7 @@ CREATE TABLE part(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part
 POSTHOOK: query: -- data setup
 CREATE TABLE part( 
     p_partkey INT,
diff --git a/ql/src/test/results/clientpositive/push_or.q.out b/ql/src/test/results/clientpositive/push_or.q.out
index 1065574675..fe7ca60604 100644
--- a/ql/src/test/results/clientpositive/push_or.q.out
+++ b/ql/src/test/results/clientpositive/push_or.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table push_or (key int, value string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@push_or
 POSTHOOK: query: create table push_or (key int, value string) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/ql_rewrite_gbtoidx.q.out b/ql/src/test/results/clientpositive/ql_rewrite_gbtoidx.q.out
index 38255d84ed..0e7c4afb12 100644
--- a/ql/src/test/results/clientpositive/ql_rewrite_gbtoidx.q.out
+++ b/ql/src/test/results/clientpositive/ql_rewrite_gbtoidx.q.out
@@ -22,6 +22,7 @@ ROW FORMAT DELIMITED
 FIELDS TERMINATED BY '|'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@lineitem
 POSTHOOK: query: CREATE TABLE lineitem (L_ORDERKEY      INT,
                                 L_PARTKEY       INT,
                                 L_SUPPKEY       INT,
@@ -53,8 +54,10 @@ POSTHOOK: type: LOAD
 POSTHOOK: Output: default@lineitem
 PREHOOK: query: CREATE INDEX lineitem_lshipdate_idx ON TABLE lineitem(l_shipdate) AS 'org.apache.hadoop.hive.ql.index.AggregateIndexHandler' WITH DEFERRED REBUILD IDXPROPERTIES("AGGREGATES"="count(l_shipdate)")
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@lineitem
 POSTHOOK: query: CREATE INDEX lineitem_lshipdate_idx ON TABLE lineitem(l_shipdate) AS 'org.apache.hadoop.hive.ql.index.AggregateIndexHandler' WITH DEFERRED REBUILD IDXPROPERTIES("AGGREGATES"="count(l_shipdate)")
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@lineitem
 POSTHOOK: Output: default@default__lineitem_lineitem_lshipdate_idx__
 PREHOOK: query: ALTER INDEX lineitem_lshipdate_idx ON lineitem REBUILD
 PREHOOK: type: ALTERINDEX_REBUILD
@@ -992,14 +995,17 @@ STAGE PLANS:
 PREHOOK: query: CREATE TABLE tbl(key int, value int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl
 POSTHOOK: query: CREATE TABLE tbl(key int, value int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@tbl
 PREHOOK: query: CREATE INDEX tbl_key_idx ON TABLE tbl(key) AS 'org.apache.hadoop.hive.ql.index.AggregateIndexHandler' WITH DEFERRED REBUILD IDXPROPERTIES("AGGREGATES"="count(key)")
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@tbl
 POSTHOOK: query: CREATE INDEX tbl_key_idx ON TABLE tbl(key) AS 'org.apache.hadoop.hive.ql.index.AggregateIndexHandler' WITH DEFERRED REBUILD IDXPROPERTIES("AGGREGATES"="count(key)")
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@tbl
 POSTHOOK: Output: default@default__tbl_tbl_key_idx__
 PREHOOK: query: ALTER INDEX tbl_key_idx ON tbl REBUILD
 PREHOOK: type: ALTERINDEX_REBUILD
@@ -2166,6 +2172,7 @@ POSTHOOK: Output: default@tbl
 PREHOOK: query: CREATE TABLE tblpart (key int, value string) PARTITIONED BY (ds string, hr int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tblpart
 POSTHOOK: query: CREATE TABLE tblpart (key int, value string) PARTITIONED BY (ds string, hr int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -2220,8 +2227,10 @@ POSTHOOK: Lineage: tblpart PARTITION(ds=2008-04-09,hr=12).key EXPRESSION [(srcpa
 POSTHOOK: Lineage: tblpart PARTITION(ds=2008-04-09,hr=12).value SIMPLE [(srcpart)srcpart.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: CREATE INDEX tbl_part_index ON TABLE tblpart(key) AS 'org.apache.hadoop.hive.ql.index.AggregateIndexHandler' WITH DEFERRED REBUILD IDXPROPERTIES("AGGREGATES"="count(key)")
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@tblpart
 POSTHOOK: query: CREATE INDEX tbl_part_index ON TABLE tblpart(key) AS 'org.apache.hadoop.hive.ql.index.AggregateIndexHandler' WITH DEFERRED REBUILD IDXPROPERTIES("AGGREGATES"="count(key)")
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@tblpart
 POSTHOOK: Output: default@default__tblpart_tbl_part_index__
 PREHOOK: query: ALTER INDEX tbl_part_index ON tblpart PARTITION (ds='2008-04-08', hr=11) REBUILD
 PREHOOK: type: ALTERINDEX_REBUILD
@@ -2399,8 +2408,10 @@ STAGE PLANS:
 
 PREHOOK: query: DROP INDEX tbl_part_index on tblpart
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@tblpart
 POSTHOOK: query: DROP INDEX tbl_part_index on tblpart
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@tblpart
 PREHOOK: query: DROP TABLE tblpart
 PREHOOK: type: DROPTABLE
 PREHOOK: Input: default@tblpart
@@ -2412,6 +2423,7 @@ POSTHOOK: Output: default@tblpart
 PREHOOK: query: CREATE TABLE tbl(key int, value int) ROW FORMAT DELIMITED FIELDS TERMINATED BY '|'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl
 POSTHOOK: query: CREATE TABLE tbl(key int, value int) ROW FORMAT DELIMITED FIELDS TERMINATED BY '|'
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -2426,8 +2438,10 @@ POSTHOOK: type: LOAD
 POSTHOOK: Output: default@tbl
 PREHOOK: query: CREATE INDEX tbl_key_idx ON TABLE tbl(key) AS 'org.apache.hadoop.hive.ql.index.AggregateIndexHandler' WITH DEFERRED REBUILD IDXPROPERTIES("AGGREGATES"="count(key)")
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@tbl
 POSTHOOK: query: CREATE INDEX tbl_key_idx ON TABLE tbl(key) AS 'org.apache.hadoop.hive.ql.index.AggregateIndexHandler' WITH DEFERRED REBUILD IDXPROPERTIES("AGGREGATES"="count(key)")
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@tbl
 POSTHOOK: Output: default@default__tbl_tbl_key_idx__
 PREHOOK: query: ALTER INDEX tbl_key_idx ON tbl REBUILD
 PREHOOK: type: ALTERINDEX_REBUILD
diff --git a/ql/src/test/results/clientpositive/quote1.q.out b/ql/src/test/results/clientpositive/quote1.q.out
index 84348234bd..462f821fb7 100644
--- a/ql/src/test/results/clientpositive/quote1.q.out
+++ b/ql/src/test/results/clientpositive/quote1.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(`location` INT, `type` STRING) PARTITIONED BY(`table` STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(`location` INT, `type` STRING) PARTITIONED BY(`table` STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/quotedid_alter.q.out b/ql/src/test/results/clientpositive/quotedid_alter.q.out
index f1064d0067..8d2ef57fa2 100644
--- a/ql/src/test/results/clientpositive/quotedid_alter.q.out
+++ b/ql/src/test/results/clientpositive/quotedid_alter.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table src_b3(`x+1` string, `!@#$%^&*()_q` string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_b3
 POSTHOOK: query: create table src_b3(`x+1` string, `!@#$%^&*()_q` string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -19,6 +20,7 @@ PREHOOK: query: -- alter partition
 create table src_p3(`x+1` string, `y&y` string) partitioned by (`!@#$%^&*()_q` string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_p3
 POSTHOOK: query: -- alter partition
 create table src_p3(`x+1` string, `y&y` string) partitioned by (`!@#$%^&*()_q` string)
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/quotedid_basic.q.out b/ql/src/test/results/clientpositive/quotedid_basic.q.out
index 0f86eed8f6..095ad186ea 100644
--- a/ql/src/test/results/clientpositive/quotedid_basic.q.out
+++ b/ql/src/test/results/clientpositive/quotedid_basic.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- basic
 create table t1(`x+1` string, `y&y` string, `!@#$%^&*()_q` string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t1
 POSTHOOK: query: -- basic
 create table t1(`x+1` string, `y&y` string, `!@#$%^&*()_q` string)
 POSTHOOK: type: CREATETABLE
@@ -317,6 +318,7 @@ PREHOOK: query: -- escaped back ticks
 create table t4(`x+1``` string, `y&y` string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t4
 POSTHOOK: query: -- escaped back ticks
 create table t4(`x+1``` string, `y&y` string)
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/quotedid_partition.q.out b/ql/src/test/results/clientpositive/quotedid_partition.q.out
index 014d93e02f..6253b33878 100644
--- a/ql/src/test/results/clientpositive/quotedid_partition.q.out
+++ b/ql/src/test/results/clientpositive/quotedid_partition.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table src_p(`x+1` string, `y&y` string) partitioned by (`!@#$%^&*()_q` string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_p
 POSTHOOK: query: create table src_p(`x+1` string, `y&y` string) partitioned by (`!@#$%^&*()_q` string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -85,6 +86,7 @@ STAGE PLANS:
 PREHOOK: query: create table src_p2(`x+1` string) partitioned by (`!@#$%^&*()_q` string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_p2
 POSTHOOK: query: create table src_p2(`x+1` string) partitioned by (`!@#$%^&*()_q` string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/quotedid_skew.q.out b/ql/src/test/results/clientpositive/quotedid_skew.q.out
index b112f7a583..4ff30b5eb0 100644
--- a/ql/src/test/results/clientpositive/quotedid_skew.q.out
+++ b/ql/src/test/results/clientpositive/quotedid_skew.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: CREATE TABLE T1(`!@#$%^&*()_q` string, `y&y` string)
 SKEWED BY (`!@#$%^&*()_q`) ON ((2)) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: CREATE TABLE T1(`!@#$%^&*()_q` string, `y&y` string)
 SKEWED BY (`!@#$%^&*()_q`) ON ((2)) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
@@ -19,6 +20,7 @@ PREHOOK: query: CREATE TABLE T2(`!@#$%^&*()_q` string, `y&y` string)
 SKEWED BY (`!@#$%^&*()_q`) ON ((2)) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T2
 POSTHOOK: query: CREATE TABLE T2(`!@#$%^&*()_q` string, `y&y` string)
 SKEWED BY (`!@#$%^&*()_q`) ON ((2)) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/quotedid_smb.q.out b/ql/src/test/results/clientpositive/quotedid_smb.q.out
index 0ed5d0c27b..7b8777f9d6 100644
--- a/ql/src/test/results/clientpositive/quotedid_smb.q.out
+++ b/ql/src/test/results/clientpositive/quotedid_smb.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: create table src_b(`x+1` string, `!@#$%^&*()_q` string)
 clustered by (`!@#$%^&*()_q`) sorted by (`!@#$%^&*()_q`) into 2 buckets
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_b
 POSTHOOK: query: create table src_b(`x+1` string, `!@#$%^&*()_q` string)  
 clustered by (`!@#$%^&*()_q`) sorted by (`!@#$%^&*()_q`) into 2 buckets
 POSTHOOK: type: CREATETABLE
@@ -23,6 +24,7 @@ PREHOOK: query: create table src_b2(`x+1` string, `!@#$%^&*()_q` string)
 clustered by (`!@#$%^&*()_q`) sorted by (`!@#$%^&*()_q`) into 2 buckets
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_b2
 POSTHOOK: query: create table src_b2(`x+1` string, `!@#$%^&*()_q` string)  
 clustered by (`!@#$%^&*()_q`) sorted by (`!@#$%^&*()_q`) into 2 buckets
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/quotedid_tblproperty.q.out b/ql/src/test/results/clientpositive/quotedid_tblproperty.q.out
index fb24da8d7d..ca1dbe6f5e 100644
--- a/ql/src/test/results/clientpositive/quotedid_tblproperty.q.out
+++ b/ql/src/test/results/clientpositive/quotedid_tblproperty.q.out
@@ -3,6 +3,7 @@ STORED AS TEXTFILE
 TBLPROPERTIES('columns'='valid_colname,invalid.colname')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@xyz
 POSTHOOK: query: CREATE TABLE xyz(KEY STRING, VALUE STRING) ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.TestSerDe' 
 STORED AS TEXTFILE
 TBLPROPERTIES('columns'='valid_colname,invalid.colname')
diff --git a/ql/src/test/results/clientpositive/rand_partitionpruner2.q.out b/ql/src/test/results/clientpositive/rand_partitionpruner2.q.out
index 557dd9dae0..2425d7387a 100644
--- a/ql/src/test/results/clientpositive/rand_partitionpruner2.q.out
+++ b/ql/src/test/results/clientpositive/rand_partitionpruner2.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- scanning partitioned data
 create table tmptable(key string, value string, hr string, ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmptable
 POSTHOOK: query: -- scanning partitioned data
 
 create table tmptable(key string, value string, hr string, ds string)
diff --git a/ql/src/test/results/clientpositive/rcfile_bigdata.q.out b/ql/src/test/results/clientpositive/rcfile_bigdata.q.out
index 3d558d947f..c1ada45ad0 100644
--- a/ql/src/test/results/clientpositive/rcfile_bigdata.q.out
+++ b/ql/src/test/results/clientpositive/rcfile_bigdata.q.out
@@ -6,6 +6,7 @@ STORED AS
   OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.RCFileOutputFormat'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@columnTable_Bigdata
 POSTHOOK: query: CREATE table columnTable_Bigdata (key STRING, value STRING)
 ROW FORMAT SERDE
   'org.apache.hadoop.hive.serde2.columnar.ColumnarSerDe'
diff --git a/ql/src/test/results/clientpositive/rcfile_columnar.q.out b/ql/src/test/results/clientpositive/rcfile_columnar.q.out
index 673c137101..183f3d1954 100644
--- a/ql/src/test/results/clientpositive/rcfile_columnar.q.out
+++ b/ql/src/test/results/clientpositive/rcfile_columnar.q.out
@@ -6,6 +6,7 @@ STORED AS
   OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.RCFileOutputFormat'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@columnTable
 POSTHOOK: query: CREATE table columnTable (key STRING, value STRING)
 ROW FORMAT SERDE
   'org.apache.hadoop.hive.serde2.columnar.ColumnarSerDe'
diff --git a/ql/src/test/results/clientpositive/rcfile_createas1.q.out b/ql/src/test/results/clientpositive/rcfile_createas1.q.out
index 119e0eead0..c8d65c9549 100644
--- a/ql/src/test/results/clientpositive/rcfile_createas1.q.out
+++ b/ql/src/test/results/clientpositive/rcfile_createas1.q.out
@@ -10,6 +10,7 @@ PREHOOK: query: CREATE TABLE rcfile_createas1a (key INT, value STRING)
     PARTITIONED BY (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@rcfile_createas1a
 POSTHOOK: query: CREATE TABLE rcfile_createas1a (key INT, value STRING)
     PARTITIONED BY (ds string)
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/rcfile_default_format.q.out b/ql/src/test/results/clientpositive/rcfile_default_format.q.out
index 0837df5bff..243cb7907e 100644
--- a/ql/src/test/results/clientpositive/rcfile_default_format.q.out
+++ b/ql/src/test/results/clientpositive/rcfile_default_format.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE rcfile_default_format (key STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@rcfile_default_format
 POSTHOOK: query: CREATE TABLE rcfile_default_format (key STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -81,6 +82,7 @@ Storage Desc Params:
 PREHOOK: query: CREATE TABLE rcfile_default_format_txtfile (key STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@rcfile_default_format_txtfile
 POSTHOOK: query: CREATE TABLE rcfile_default_format_txtfile (key STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -218,6 +220,7 @@ Storage Desc Params:
 PREHOOK: query: CREATE TABLE rcfile_default_format_default_serde (key STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@rcfile_default_format_default_serde
 POSTHOOK: query: CREATE TABLE rcfile_default_format_default_serde (key STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -298,6 +301,7 @@ Storage Desc Params:
 PREHOOK: query: CREATE TABLE rcfile_default_serde (key STRING) STORED AS rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@rcfile_default_serde
 POSTHOOK: query: CREATE TABLE rcfile_default_serde (key STRING) STORED AS rcfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/rcfile_lazydecompress.q.out b/ql/src/test/results/clientpositive/rcfile_lazydecompress.q.out
index e65f33794c..461ee38a61 100644
--- a/ql/src/test/results/clientpositive/rcfile_lazydecompress.q.out
+++ b/ql/src/test/results/clientpositive/rcfile_lazydecompress.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE table rcfileTableLazyDecompress (key STRING, value STRING) STORED AS RCFile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@rcfileTableLazyDecompress
 POSTHOOK: query: CREATE table rcfileTableLazyDecompress (key STRING, value STRING) STORED AS RCFile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/rcfile_merge1.q.out b/ql/src/test/results/clientpositive/rcfile_merge1.q.out
index e8ed908215..ac6a2bdb4d 100644
--- a/ql/src/test/results/clientpositive/rcfile_merge1.q.out
+++ b/ql/src/test/results/clientpositive/rcfile_merge1.q.out
@@ -10,6 +10,7 @@ PREHOOK: query: CREATE TABLE rcfile_merge1 (key INT, value STRING)
     PARTITIONED BY (ds STRING, part STRING) STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@rcfile_merge1
 POSTHOOK: query: CREATE TABLE rcfile_merge1 (key INT, value STRING) 
     PARTITIONED BY (ds STRING, part STRING) STORED AS RCFILE
 POSTHOOK: type: CREATETABLE
@@ -19,6 +20,7 @@ PREHOOK: query: CREATE TABLE rcfile_merge1b (key INT, value STRING)
     PARTITIONED BY (ds STRING, part STRING) STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@rcfile_merge1b
 POSTHOOK: query: CREATE TABLE rcfile_merge1b (key INT, value STRING) 
     PARTITIONED BY (ds STRING, part STRING) STORED AS RCFILE
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/rcfile_merge2.q.out b/ql/src/test/results/clientpositive/rcfile_merge2.q.out
index 7b06efda23..d8a61f3316 100644
--- a/ql/src/test/results/clientpositive/rcfile_merge2.q.out
+++ b/ql/src/test/results/clientpositive/rcfile_merge2.q.out
@@ -7,6 +7,7 @@ PREHOOK: query: CREATE TABLE rcfile_merge2a (key INT, value STRING)
     STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@rcfile_merge2a
 POSTHOOK: query: CREATE TABLE rcfile_merge2a (key INT, value STRING)
     PARTITIONED BY (one string, two string, three string)
     STORED AS RCFILE
diff --git a/ql/src/test/results/clientpositive/rcfile_merge3.q.out b/ql/src/test/results/clientpositive/rcfile_merge3.q.out
index 66e45952e3..5c717b5eca 100644
--- a/ql/src/test/results/clientpositive/rcfile_merge3.q.out
+++ b/ql/src/test/results/clientpositive/rcfile_merge3.q.out
@@ -10,6 +10,7 @@ PREHOOK: query: CREATE TABLE rcfile_merge3a (key int, value string)
     PARTITIONED BY (ds string) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@rcfile_merge3a
 POSTHOOK: query: CREATE TABLE rcfile_merge3a (key int, value string) 
     PARTITIONED BY (ds string) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
@@ -18,6 +19,7 @@ POSTHOOK: Output: default@rcfile_merge3a
 PREHOOK: query: CREATE TABLE rcfile_merge3b (key int, value string) STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@rcfile_merge3b
 POSTHOOK: query: CREATE TABLE rcfile_merge3b (key int, value string) STORED AS RCFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/rcfile_merge4.q.out b/ql/src/test/results/clientpositive/rcfile_merge4.q.out
index dacaa7d2f8..6171434311 100644
--- a/ql/src/test/results/clientpositive/rcfile_merge4.q.out
+++ b/ql/src/test/results/clientpositive/rcfile_merge4.q.out
@@ -10,6 +10,7 @@ PREHOOK: query: CREATE TABLE rcfile_merge3a (key int, value string)
     PARTITIONED BY (ds string) STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@rcfile_merge3a
 POSTHOOK: query: CREATE TABLE rcfile_merge3a (key int, value string) 
     PARTITIONED BY (ds string) STORED AS RCFILE
 POSTHOOK: type: CREATETABLE
@@ -18,6 +19,7 @@ POSTHOOK: Output: default@rcfile_merge3a
 PREHOOK: query: CREATE TABLE rcfile_merge3b (key int, value string) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@rcfile_merge3b
 POSTHOOK: query: CREATE TABLE rcfile_merge3b (key int, value string) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/rcfile_null_value.q.out b/ql/src/test/results/clientpositive/rcfile_null_value.q.out
index 9947fe5f5d..5cbb753dc5 100644
--- a/ql/src/test/results/clientpositive/rcfile_null_value.q.out
+++ b/ql/src/test/results/clientpositive/rcfile_null_value.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE src1_rc(key STRING, value STRING) STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src1_rc
 POSTHOOK: query: CREATE TABLE src1_rc(key STRING, value STRING) STORED AS RCFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -51,6 +52,7 @@ POSTHOOK: Input: default@src1_rc
 PREHOOK: query: CREATE TABLE dest1_rc(c1 INT, c2 STRING, c3 INT, c4 STRING) STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1_rc
 POSTHOOK: query: CREATE TABLE dest1_rc(c1 INT, c2 STRING, c3 INT, c4 STRING) STORED AS RCFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/rcfile_toleratecorruptions.q.out b/ql/src/test/results/clientpositive/rcfile_toleratecorruptions.q.out
index 589b2676fb..7b81717e3e 100644
--- a/ql/src/test/results/clientpositive/rcfile_toleratecorruptions.q.out
+++ b/ql/src/test/results/clientpositive/rcfile_toleratecorruptions.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE test_src(key int, value string) stored as RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_src
 POSTHOOK: query: CREATE TABLE test_src(key int, value string) stored as RCFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/rcfile_union.q.out b/ql/src/test/results/clientpositive/rcfile_union.q.out
index 750cd773ac..77ad47cf68 100644
--- a/ql/src/test/results/clientpositive/rcfile_union.q.out
+++ b/ql/src/test/results/clientpositive/rcfile_union.q.out
@@ -4,6 +4,7 @@ ROW FORMAT SERDE
 STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@rcfile_unionTable
 POSTHOOK: query: CREATE table rcfile_unionTable (b STRING, c STRING)
 ROW FORMAT SERDE
   'org.apache.hadoop.hive.serde2.columnar.ColumnarSerDe'
diff --git a/ql/src/test/results/clientpositive/recursive_dir.q.out b/ql/src/test/results/clientpositive/recursive_dir.q.out
index 29081395aa..599b255e74 100644
--- a/ql/src/test/results/clientpositive/recursive_dir.q.out
+++ b/ql/src/test/results/clientpositive/recursive_dir.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- INCLUDE_HADOOP_MAJOR_VERSIONS(0.23)
 CREATE TABLE fact_daily(x int) PARTITIONED BY (ds STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@fact_daily
 POSTHOOK: query: -- INCLUDE_HADOOP_MAJOR_VERSIONS(0.23)
 
 CREATE TABLE fact_daily(x int) PARTITIONED BY (ds STRING)
@@ -14,6 +15,7 @@ PREHOOK: query: CREATE TABLE fact_tz(x int) PARTITIONED BY (ds STRING, hr STRING
 PREHOOK: type: CREATETABLE
 #### A masked pattern was here ####
 PREHOOK: Output: database:default
+PREHOOK: Output: default@fact_tz
 POSTHOOK: query: CREATE TABLE fact_tz(x int) PARTITIONED BY (ds STRING, hr STRING)
 #### A masked pattern was here ####
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/reduce_deduplicate.q.out b/ql/src/test/results/clientpositive/reduce_deduplicate.q.out
index e8cb966565..bd8647145b 100644
--- a/ql/src/test/results/clientpositive/reduce_deduplicate.q.out
+++ b/ql/src/test/results/clientpositive/reduce_deduplicate.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE bucket5_1(key string, value string) CLUSTERED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucket5_1
 POSTHOOK: query: CREATE TABLE bucket5_1(key string, value string) CLUSTERED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -201,6 +202,7 @@ POSTHOOK: Input: default@src
 PREHOOK: query: create table complex_tbl_1(aid string, bid string, t int, ctime string, etime bigint, l string, et string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@complex_tbl_1
 POSTHOOK: query: create table complex_tbl_1(aid string, bid string, t int, ctime string, etime bigint, l string, et string) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -208,6 +210,7 @@ POSTHOOK: Output: default@complex_tbl_1
 PREHOOK: query: create table complex_tbl_2(aet string, aes string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@complex_tbl_2
 POSTHOOK: query: create table complex_tbl_2(aet string, aes string) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/reduce_deduplicate_exclude_gby.q.out b/ql/src/test/results/clientpositive/reduce_deduplicate_exclude_gby.q.out
index 1b3ed8e00b..f48482e8b1 100644
--- a/ql/src/test/results/clientpositive/reduce_deduplicate_exclude_gby.q.out
+++ b/ql/src/test/results/clientpositive/reduce_deduplicate_exclude_gby.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table t1( key_int1 int, key_int2 int, key_string1 string, key_string2 string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t1
 POSTHOOK: query: create table t1( key_int1 int, key_int2 int, key_string1 string, key_string2 string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/reducesink_dedup.q.out b/ql/src/test/results/clientpositive/reducesink_dedup.q.out
index a353f14dfb..8678b90cc1 100644
--- a/ql/src/test/results/clientpositive/reducesink_dedup.q.out
+++ b/ql/src/test/results/clientpositive/reducesink_dedup.q.out
@@ -16,6 +16,7 @@ CREATE TABLE part(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part
 POSTHOOK: query: -- data setup
 CREATE TABLE part( 
     p_partkey INT,
diff --git a/ql/src/test/results/clientpositive/remote_script.q.out b/ql/src/test/results/clientpositive/remote_script.q.out
index d5e95be218..6ec994930f 100644
--- a/ql/src/test/results/clientpositive/remote_script.q.out
+++ b/ql/src/test/results/clientpositive/remote_script.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table tmp_tmp(key string, value string) stored as rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmp_tmp
 POSTHOOK: query: create table tmp_tmp(key string, value string) stored as rcfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/rename_column.q.out b/ql/src/test/results/clientpositive/rename_column.q.out
index c2c2e3ee62..4704acfed3 100644
--- a/ql/src/test/results/clientpositive/rename_column.q.out
+++ b/ql/src/test/results/clientpositive/rename_column.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE kv_rename_test(a int, b int, c int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@kv_rename_test
 POSTHOOK: query: CREATE TABLE kv_rename_test(a int, b int, c int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -157,16 +158,21 @@ srcpart
 PREHOOK: query: -- Using non-default Database
 CREATE DATABASE kv_rename_test_db
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:kv_rename_test_db
 POSTHOOK: query: -- Using non-default Database
 CREATE DATABASE kv_rename_test_db
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:kv_rename_test_db
 PREHOOK: query: USE kv_rename_test_db
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:kv_rename_test_db
 POSTHOOK: query: USE kv_rename_test_db
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:kv_rename_test_db
 PREHOOK: query: CREATE TABLE kv_rename_test(a int, b int, c int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:kv_rename_test_db
+PREHOOK: Output: kv_rename_test_db@kv_rename_test
 POSTHOOK: query: CREATE TABLE kv_rename_test(a int, b int, c int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:kv_rename_test_db
diff --git a/ql/src/test/results/clientpositive/rename_external_partition_location.q.out b/ql/src/test/results/clientpositive/rename_external_partition_location.q.out
index 2bf6fd0fda..1670b4efbb 100644
--- a/ql/src/test/results/clientpositive/rename_external_partition_location.q.out
+++ b/ql/src/test/results/clientpositive/rename_external_partition_location.q.out
@@ -5,6 +5,7 @@ PREHOOK: query: CREATE EXTERNAL TABLE ex_table ( key INT, value STRING)
 PREHOOK: type: CREATETABLE
 #### A masked pattern was here ####
 PREHOOK: Output: database:default
+PREHOOK: Output: default@ex_table
 POSTHOOK: query: CREATE EXTERNAL TABLE ex_table ( key INT, value STRING)
     PARTITIONED BY (part STRING)
     STORED AS textfile
diff --git a/ql/src/test/results/clientpositive/rename_partition_location.q.out b/ql/src/test/results/clientpositive/rename_partition_location.q.out
index 91981f7fcb..b83bdd0e47 100644
--- a/ql/src/test/results/clientpositive/rename_partition_location.q.out
+++ b/ql/src/test/results/clientpositive/rename_partition_location.q.out
@@ -7,6 +7,7 @@ STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 #### A masked pattern was here ####
 PREHOOK: Output: database:default
+PREHOOK: Output: default@rename_partition_table
 POSTHOOK: query: -- This test verifies that if the tables location changes, renaming a partition will not change
 -- the partition location accordingly
 
diff --git a/ql/src/test/results/clientpositive/rename_table_location.q.out b/ql/src/test/results/clientpositive/rename_table_location.q.out
index 7d65b609ed..7f481af47e 100644
--- a/ql/src/test/results/clientpositive/rename_table_location.q.out
+++ b/ql/src/test/results/clientpositive/rename_table_location.q.out
@@ -7,6 +7,7 @@ STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 #### A masked pattern was here ####
 PREHOOK: Output: database:default
+PREHOOK: Output: default@rename_partition_table
 POSTHOOK: query: -- This test verifies that if the tables location changes, renaming a table will not change
 -- the table location scheme
 
diff --git a/ql/src/test/results/clientpositive/repair.q.out b/ql/src/test/results/clientpositive/repair.q.out
index 012f129040..86ac031b89 100644
--- a/ql/src/test/results/clientpositive/repair.q.out
+++ b/ql/src/test/results/clientpositive/repair.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: CREATE TABLE repairtable(col STRING) PARTITIONED BY (p1 STRING, p2 STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@repairtable
 POSTHOOK: query: CREATE TABLE repairtable(col STRING) PARTITIONED BY (p1 STRING, p2 STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/root_dir_external_table.q.out b/ql/src/test/results/clientpositive/root_dir_external_table.q.out
index 0e6067d05b..238a409a1d 100644
--- a/ql/src/test/results/clientpositive/root_dir_external_table.q.out
+++ b/ql/src/test/results/clientpositive/root_dir_external_table.q.out
@@ -8,6 +8,7 @@ POSTHOOK: Input: default@src
 PREHOOK: type: CREATETABLE
 #### A masked pattern was here ####
 PREHOOK: Output: database:default
+PREHOOK: Output: default@roottable
 #### A masked pattern was here ####
 POSTHOOK: type: CREATETABLE
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/sample1.q.out b/ql/src/test/results/clientpositive/sample1.q.out
index e6adac938d..736b722f59 100644
--- a/ql/src/test/results/clientpositive/sample1.q.out
+++ b/ql/src/test/results/clientpositive/sample1.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key INT, value STRING, dt STRING, hr STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key INT, value STRING, dt STRING, hr STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/sample10.q.out b/ql/src/test/results/clientpositive/sample10.q.out
index 82eec67aa1..6de9ea8e25 100644
--- a/ql/src/test/results/clientpositive/sample10.q.out
+++ b/ql/src/test/results/clientpositive/sample10.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- EXCLUDE_HADOOP_MAJOR_VERSIONS(0.17, 0.18, 0.19)
 create table srcpartbucket (key string, value string) partitioned by (ds string, hr string) clustered by (key) into 4 buckets
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcpartbucket
 POSTHOOK: query: -- EXCLUDE_HADOOP_MAJOR_VERSIONS(0.17, 0.18, 0.19)
 
 create table srcpartbucket (key string, value string) partitioned by (ds string, hr string) clustered by (key) into 4 buckets
diff --git a/ql/src/test/results/clientpositive/sample2.q.out b/ql/src/test/results/clientpositive/sample2.q.out
index 3f8a4cc54f..6e42fe7015 100644
--- a/ql/src/test/results/clientpositive/sample2.q.out
+++ b/ql/src/test/results/clientpositive/sample2.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/sample4.q.out b/ql/src/test/results/clientpositive/sample4.q.out
index e6ee033603..61a8cc0535 100644
--- a/ql/src/test/results/clientpositive/sample4.q.out
+++ b/ql/src/test/results/clientpositive/sample4.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/sample5.q.out b/ql/src/test/results/clientpositive/sample5.q.out
index 57accb32a2..7e845356fb 100644
--- a/ql/src/test/results/clientpositive/sample5.q.out
+++ b/ql/src/test/results/clientpositive/sample5.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/sample6.q.out b/ql/src/test/results/clientpositive/sample6.q.out
index a115d87134..155cdea0c8 100644
--- a/ql/src/test/results/clientpositive/sample6.q.out
+++ b/ql/src/test/results/clientpositive/sample6.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -3140,6 +3141,7 @@ POSTHOOK: Input: default@srcbucket2
 PREHOOK: query: CREATE TABLE empty_bucket (key int, value string) CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@empty_bucket
 POSTHOOK: query: CREATE TABLE empty_bucket (key int, value string) CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/sample7.q.out b/ql/src/test/results/clientpositive/sample7.q.out
index bc5a023d64..72ed459d66 100644
--- a/ql/src/test/results/clientpositive/sample7.q.out
+++ b/ql/src/test/results/clientpositive/sample7.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/sample_islocalmode_hook.q.out b/ql/src/test/results/clientpositive/sample_islocalmode_hook.q.out
index 4835aef2bd..99bc23b419 100644
--- a/ql/src/test/results/clientpositive/sample_islocalmode_hook.q.out
+++ b/ql/src/test/results/clientpositive/sample_islocalmode_hook.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: -- EXCLUDE_HADOOP_MAJOR_VERSIONS(0.20, 0.20S)
 create table sih_i_part (key int, value string) partitioned by (p string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@sih_i_part
 POSTHOOK: query: -- EXCLUDE_HADOOP_MAJOR_VERSIONS(0.20, 0.20S)
 
 -- create file inputs
diff --git a/ql/src/test/results/clientpositive/schemeAuthority.q.out b/ql/src/test/results/clientpositive/schemeAuthority.q.out
index d64ee5547e..1daf7c732a 100644
--- a/ql/src/test/results/clientpositive/schemeAuthority.q.out
+++ b/ql/src/test/results/clientpositive/schemeAuthority.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create external table dynPart (key string) partitioned by (value string) row format delimited fields terminated by '\\t' stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dynPart
 POSTHOOK: query: create external table dynPart (key string) partitioned by (value string) row format delimited fields terminated by '\\t' stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/schemeAuthority2.q.out b/ql/src/test/results/clientpositive/schemeAuthority2.q.out
index 0aa13e89bb..ad67a4dfa1 100644
--- a/ql/src/test/results/clientpositive/schemeAuthority2.q.out
+++ b/ql/src/test/results/clientpositive/schemeAuthority2.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create external table dynPart (key string) partitioned by (value string, value2 string) row format delimited fields terminated by '\\t' stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dynPart
 POSTHOOK: query: create external table dynPart (key string) partitioned by (value string, value2 string) row format delimited fields terminated by '\\t' stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/scriptfile1.q.out b/ql/src/test/results/clientpositive/scriptfile1.q.out
index 6bf2e23a7c..c8d120c461 100644
--- a/ql/src/test/results/clientpositive/scriptfile1.q.out
+++ b/ql/src/test/results/clientpositive/scriptfile1.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- EXCLUDE_OS_WINDOWS
 CREATE TABLE dest1(key INT, value STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: -- EXCLUDE_OS_WINDOWS
 CREATE TABLE dest1(key INT, value STRING)
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/select_unquote_and.q.out b/ql/src/test/results/clientpositive/select_unquote_and.q.out
index 127fcb65b5..55d4a857dc 100644
--- a/ql/src/test/results/clientpositive/select_unquote_and.q.out
+++ b/ql/src/test/results/clientpositive/select_unquote_and.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE npe_test (key STRING, value STRING) PARTITIONED BY (ds STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@npe_test
 POSTHOOK: query: CREATE TABLE npe_test (key STRING, value STRING) PARTITIONED BY (ds STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/select_unquote_not.q.out b/ql/src/test/results/clientpositive/select_unquote_not.q.out
index 0016c69e1e..9e0f928704 100644
--- a/ql/src/test/results/clientpositive/select_unquote_not.q.out
+++ b/ql/src/test/results/clientpositive/select_unquote_not.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE npe_test (key STRING, value STRING) PARTITIONED BY (ds STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@npe_test
 POSTHOOK: query: CREATE TABLE npe_test (key STRING, value STRING) PARTITIONED BY (ds STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/select_unquote_or.q.out b/ql/src/test/results/clientpositive/select_unquote_or.q.out
index 537b9bbff8..f7fa467a44 100644
--- a/ql/src/test/results/clientpositive/select_unquote_or.q.out
+++ b/ql/src/test/results/clientpositive/select_unquote_or.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE npe_test (key STRING, value STRING) PARTITIONED BY (ds STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@npe_test
 POSTHOOK: query: CREATE TABLE npe_test (key STRING, value STRING) PARTITIONED BY (ds STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/semijoin.q.out b/ql/src/test/results/clientpositive/semijoin.q.out
index 4a60bf64f4..b2324af6f3 100644
--- a/ql/src/test/results/clientpositive/semijoin.q.out
+++ b/ql/src/test/results/clientpositive/semijoin.q.out
@@ -92,6 +92,7 @@ POSTHOOK: Input: default@t3
 PREHOOK: query: create table t4 (key int, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t4
 POSTHOOK: query: create table t4 (key int, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/serde_regex.q.out b/ql/src/test/results/clientpositive/serde_regex.q.out
index e231a09712..65e7decd22 100644
--- a/ql/src/test/results/clientpositive/serde_regex.q.out
+++ b/ql/src/test/results/clientpositive/serde_regex.q.out
@@ -64,6 +64,7 @@ WITH SERDEPROPERTIES (
 STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@serde_regex
 POSTHOOK: query: CREATE TABLE serde_regex(
   host STRING,
   identity STRING,
@@ -171,6 +172,7 @@ WITH SERDEPROPERTIES (
 STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@serde_regex1
 POSTHOOK: query: CREATE TABLE serde_regex1(
   key decimal(38,18),
   value int)
diff --git a/ql/src/test/results/clientpositive/serde_reported_schema.q.out b/ql/src/test/results/clientpositive/serde_reported_schema.q.out
index a7b2438499..dab76cbf75 100644
--- a/ql/src/test/results/clientpositive/serde_reported_schema.q.out
+++ b/ql/src/test/results/clientpositive/serde_reported_schema.q.out
@@ -6,6 +6,7 @@ PREHOOK: query: create table int_string
       "serialization.format"="org.apache.thrift.protocol.TBinaryProtocol")
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@int_string
 POSTHOOK: query: create table int_string
   partitioned by (b string)
   row format serde "org.apache.hadoop.hive.serde2.thrift.ThriftDeserializer"
diff --git a/ql/src/test/results/clientpositive/show_columns.q.out b/ql/src/test/results/clientpositive/show_columns.q.out
index 1b74802a08..c653671761 100644
--- a/ql/src/test/results/clientpositive/show_columns.q.out
+++ b/ql/src/test/results/clientpositive/show_columns.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE shcol_test(KEY STRING, VALUE STRING) PARTITIONED BY(ds STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@shcol_test
 POSTHOOK: query: CREATE TABLE shcol_test(KEY STRING, VALUE STRING) PARTITIONED BY(ds STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -38,16 +39,21 @@ ds
 PREHOOK: query: -- SHOW COLUMNS
 CREATE DATABASE test_db
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:test_db
 POSTHOOK: query: -- SHOW COLUMNS
 CREATE DATABASE test_db
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:test_db
 PREHOOK: query: USE test_db
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:test_db
 POSTHOOK: query: USE test_db
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:test_db
 PREHOOK: query: CREATE TABLE foo(a INT)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:test_db
+PREHOOK: Output: test_db@foo
 POSTHOOK: query: CREATE TABLE foo(a INT)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:test_db
@@ -55,9 +61,11 @@ POSTHOOK: Output: test_db@foo
 PREHOOK: query: -- SHOW COLUMNS basic syntax tests
 USE test_db
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:test_db
 POSTHOOK: query: -- SHOW COLUMNS basic syntax tests
 USE test_db
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:test_db
 PREHOOK: query: SHOW COLUMNS from foo
 PREHOOK: type: SHOWCOLUMNS
 PREHOOK: Input: test_db@foo
@@ -75,16 +83,21 @@ a
 PREHOOK: query: -- SHOW COLUMNS from a database with a name that requires escaping
 CREATE DATABASE `database`
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:database
 POSTHOOK: query: -- SHOW COLUMNS from a database with a name that requires escaping
 CREATE DATABASE `database`
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:database
 PREHOOK: query: USE `database`
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:database
 POSTHOOK: query: USE `database`
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:database
 PREHOOK: query: CREATE TABLE foo(a INT)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:database
+PREHOOK: Output: database@foo
 POSTHOOK: query: CREATE TABLE foo(a INT)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:database
@@ -98,8 +111,10 @@ POSTHOOK: Input: database@foo
 a                   
 PREHOOK: query: use default
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:default
 POSTHOOK: query: use default
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:default
 PREHOOK: query: SHOW COLUMNS from test_db.foo
 PREHOOK: type: SHOWCOLUMNS
 PREHOOK: Input: test_db@foo
diff --git a/ql/src/test/results/clientpositive/show_create_table_alter.q.out b/ql/src/test/results/clientpositive/show_create_table_alter.q.out
index 3cf552f921..ddb4c270fc 100644
--- a/ql/src/test/results/clientpositive/show_create_table_alter.q.out
+++ b/ql/src/test/results/clientpositive/show_create_table_alter.q.out
@@ -4,6 +4,7 @@ CREATE EXTERNAL TABLE tmp_showcrt1 (key smallint, value float)
 CLUSTERED BY (key) SORTED BY (value DESC) INTO 5 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmp_showcrt1
 POSTHOOK: query: -- Test SHOW CREATE TABLE on an external, clustered and sorted table. Then test the query again after ALTERs.
 
 CREATE EXTERNAL TABLE tmp_showcrt1 (key smallint, value float)
diff --git a/ql/src/test/results/clientpositive/show_create_table_db_table.q.out b/ql/src/test/results/clientpositive/show_create_table_db_table.q.out
index 16c24018e0..cf0a88dcbc 100644
--- a/ql/src/test/results/clientpositive/show_create_table_db_table.q.out
+++ b/ql/src/test/results/clientpositive/show_create_table_db_table.q.out
@@ -2,10 +2,12 @@ PREHOOK: query: -- Test SHOW CREATE TABLE on a table name of format "db.table".
 
 CREATE DATABASE tmp_feng comment 'for show create table test'
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:tmp_feng
 POSTHOOK: query: -- Test SHOW CREATE TABLE on a table name of format "db.table".
 
 CREATE DATABASE tmp_feng comment 'for show create table test'
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:tmp_feng
 PREHOOK: query: SHOW DATABASES
 PREHOOK: type: SHOWDATABASES
 POSTHOOK: query: SHOW DATABASES
@@ -15,14 +17,18 @@ tmp_feng
 PREHOOK: query: CREATE TABLE tmp_feng.tmp_showcrt (key string, value int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:tmp_feng
+PREHOOK: Output: tmp_feng@tmp_feng.tmp_showcrt
 POSTHOOK: query: CREATE TABLE tmp_feng.tmp_showcrt (key string, value int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:tmp_feng
+POSTHOOK: Output: tmp_feng@tmp_feng.tmp_showcrt
 POSTHOOK: Output: tmp_feng@tmp_showcrt
 PREHOOK: query: USE default
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:default
 POSTHOOK: query: USE default
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:default
 PREHOOK: query: SHOW CREATE TABLE tmp_feng.tmp_showcrt
 PREHOOK: type: SHOW_CREATETABLE
 PREHOOK: Input: tmp_feng@tmp_showcrt
diff --git a/ql/src/test/results/clientpositive/show_create_table_delimited.q.out b/ql/src/test/results/clientpositive/show_create_table_delimited.q.out
index 07d08acf73..79f29dec76 100644
--- a/ql/src/test/results/clientpositive/show_create_table_delimited.q.out
+++ b/ql/src/test/results/clientpositive/show_create_table_delimited.q.out
@@ -7,6 +7,7 @@ STORED AS textfile
 PREHOOK: type: CREATETABLE
 #### A masked pattern was here ####
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmp_showcrt1
 POSTHOOK: query: -- Test SHOW CREATE TABLE on a table with delimiters, stored format, and location.
 
 CREATE TABLE tmp_showcrt1 (key int, value string, newvalue bigint)
diff --git a/ql/src/test/results/clientpositive/show_create_table_partitioned.q.out b/ql/src/test/results/clientpositive/show_create_table_partitioned.q.out
index 6b6b23301c..100fde6dec 100644
--- a/ql/src/test/results/clientpositive/show_create_table_partitioned.q.out
+++ b/ql/src/test/results/clientpositive/show_create_table_partitioned.q.out
@@ -5,6 +5,7 @@ COMMENT 'temporary table'
 PARTITIONED BY (value bigint COMMENT 'some value')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmp_showcrt1
 POSTHOOK: query: -- Test SHOW CREATE TABLE on a table with partitions and column comments.
 
 CREATE EXTERNAL TABLE tmp_showcrt1 (key string, newvalue boolean COMMENT 'a new value')
diff --git a/ql/src/test/results/clientpositive/show_create_table_serde.q.out b/ql/src/test/results/clientpositive/show_create_table_serde.q.out
index a7500ba0ee..f1656b642d 100644
--- a/ql/src/test/results/clientpositive/show_create_table_serde.q.out
+++ b/ql/src/test/results/clientpositive/show_create_table_serde.q.out
@@ -8,6 +8,7 @@ STORED AS INPUTFORMAT 'org.apache.hadoop.hive.ql.io.RCFileInputFormat'
 OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.RCFileOutputFormat'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmp_showcrt1
 POSTHOOK: query: -- Test SHOW CREATE TABLE on a table with serde.
 
 -- without a storage handler
@@ -55,6 +56,7 @@ STORED BY 'org.apache.hadoop.hive.ql.metadata.DefaultStorageHandler'
 WITH SERDEPROPERTIES ('field.delim'=',', 'serialization.format'='$')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmp_showcrt1
 POSTHOOK: query: -- with a storage handler and serde properties
 CREATE EXTERNAL TABLE tmp_showcrt1 (key string, value boolean)
 ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.columnar.ColumnarSerDe'
diff --git a/ql/src/test/results/clientpositive/show_create_table_temp_table.q.out b/ql/src/test/results/clientpositive/show_create_table_temp_table.q.out
index 6306d906c4..0d9d0c772c 100644
--- a/ql/src/test/results/clientpositive/show_create_table_temp_table.q.out
+++ b/ql/src/test/results/clientpositive/show_create_table_temp_table.q.out
@@ -1,14 +1,18 @@
 PREHOOK: query: create database tmpdb
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:tmpdb
 POSTHOOK: query: create database tmpdb
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:tmpdb
 PREHOOK: query: create temporary table tmpdb.tmp1 (c1 string, c2 string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:tmpdb
+PREHOOK: Output: tmpdb@tmpdb.tmp1
 POSTHOOK: query: create temporary table tmpdb.tmp1 (c1 string, c2 string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:tmpdb
 POSTHOOK: Output: tmpdb@tmp1
+POSTHOOK: Output: tmpdb@tmpdb.tmp1
 PREHOOK: query: show create table tmpdb.tmp1
 PREHOOK: type: SHOW_CREATETABLE
 PREHOOK: Input: tmpdb@tmp1
diff --git a/ql/src/test/results/clientpositive/show_indexes_edge_cases.q.out b/ql/src/test/results/clientpositive/show_indexes_edge_cases.q.out
index 095ba3aa5b..cc6a4058a0 100644
--- a/ql/src/test/results/clientpositive/show_indexes_edge_cases.q.out
+++ b/ql/src/test/results/clientpositive/show_indexes_edge_cases.q.out
@@ -9,6 +9,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: CREATE TABLE show_idx_empty(KEY STRING, VALUE STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@show_idx_empty
 POSTHOOK: query: CREATE TABLE show_idx_empty(KEY STRING, VALUE STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -16,29 +17,38 @@ POSTHOOK: Output: default@show_idx_empty
 PREHOOK: query: CREATE TABLE show_idx_full(KEY STRING, VALUE1 STRING, VALUE2 STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@show_idx_full
 POSTHOOK: query: CREATE TABLE show_idx_full(KEY STRING, VALUE1 STRING, VALUE2 STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@show_idx_full
 PREHOOK: query: CREATE INDEX idx_1 ON TABLE show_idx_full(KEY) AS "COMPACT" WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@show_idx_full
 POSTHOOK: query: CREATE INDEX idx_1 ON TABLE show_idx_full(KEY) AS "COMPACT" WITH DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@show_idx_full
 POSTHOOK: Output: default@default__show_idx_full_idx_1__
 PREHOOK: query: CREATE INDEX idx_2 ON TABLE show_idx_full(VALUE1) AS "COMPACT" WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@show_idx_full
 POSTHOOK: query: CREATE INDEX idx_2 ON TABLE show_idx_full(VALUE1) AS "COMPACT" WITH DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@show_idx_full
 POSTHOOK: Output: default@default__show_idx_full_idx_2__
 PREHOOK: query: CREATE INDEX idx_comment ON TABLE show_idx_full(VALUE2) AS "COMPACT" WITH DEFERRED REBUILD COMMENT "index comment"
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@show_idx_full
 POSTHOOK: query: CREATE INDEX idx_comment ON TABLE show_idx_full(VALUE2) AS "COMPACT" WITH DEFERRED REBUILD COMMENT "index comment"
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@show_idx_full
 POSTHOOK: Output: default@default__show_idx_full_idx_comment__
 PREHOOK: query: CREATE INDEX idx_compound ON TABLE show_idx_full(KEY, VALUE1) AS "COMPACT" WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@show_idx_full
 POSTHOOK: query: CREATE INDEX idx_compound ON TABLE show_idx_full(KEY, VALUE1) AS "COMPACT" WITH DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@show_idx_full
 POSTHOOK: Output: default@default__show_idx_full_idx_compound__
 PREHOOK: query: ALTER INDEX idx_1 ON show_idx_full REBUILD
 PREHOOK: type: ALTERINDEX_REBUILD
@@ -137,12 +147,16 @@ POSTHOOK: query: SHOW INDEXES ON show_idx_empty
 POSTHOOK: type: SHOWINDEXES
 PREHOOK: query: DROP INDEX idx_1 on show_idx_full
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@show_idx_full
 POSTHOOK: query: DROP INDEX idx_1 on show_idx_full
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@show_idx_full
 PREHOOK: query: DROP INDEX idx_2 on show_idx_full
 PREHOOK: type: DROPINDEX
+PREHOOK: Input: default@show_idx_full
 POSTHOOK: query: DROP INDEX idx_2 on show_idx_full
 POSTHOOK: type: DROPINDEX
+POSTHOOK: Input: default@show_idx_full
 PREHOOK: query: DROP TABLE show_idx_empty
 PREHOOK: type: DROPTABLE
 PREHOOK: Input: default@show_idx_empty
diff --git a/ql/src/test/results/clientpositive/show_indexes_syntax.q.out b/ql/src/test/results/clientpositive/show_indexes_syntax.q.out
index fe471807fb..bc96359b27 100644
--- a/ql/src/test/results/clientpositive/show_indexes_syntax.q.out
+++ b/ql/src/test/results/clientpositive/show_indexes_syntax.q.out
@@ -5,14 +5,17 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: CREATE TABLE show_idx_t1(KEY STRING, VALUE STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@show_idx_t1
 POSTHOOK: query: CREATE TABLE show_idx_t1(KEY STRING, VALUE STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@show_idx_t1
 PREHOOK: query: CREATE INDEX idx_t1 ON TABLE show_idx_t1(KEY) AS "COMPACT" WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@show_idx_t1
 POSTHOOK: query: CREATE INDEX idx_t1 ON TABLE show_idx_t1(KEY) AS "COMPACT" WITH DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@show_idx_t1
 POSTHOOK: Output: default@default__show_idx_t1_idx_t1__
 PREHOOK: query: ALTER INDEX idx_t1 ON show_idx_t1 REBUILD
 PREHOOK: type: ALTERINDEX_REBUILD
diff --git a/ql/src/test/results/clientpositive/show_partitions.q.out b/ql/src/test/results/clientpositive/show_partitions.q.out
index 0f35a354ef..b439273407 100644
--- a/ql/src/test/results/clientpositive/show_partitions.q.out
+++ b/ql/src/test/results/clientpositive/show_partitions.q.out
@@ -76,15 +76,20 @@ POSTHOOK: Input: default@srcpart
 ds=2008-04-08/hr=12
 PREHOOK: query: CREATE DATABASE db1
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:db1
 POSTHOOK: query: CREATE DATABASE db1
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:db1
 PREHOOK: query: USE db1
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:db1
 POSTHOOK: query: USE db1
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:db1
 PREHOOK: query: CREATE TABLE srcpart (key1 INT, value1 STRING) PARTITIONED BY (ds STRING, hr STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:db1
+PREHOOK: Output: db1@srcpart
 POSTHOOK: query: CREATE TABLE srcpart (key1 INT, value1 STRING) PARTITIONED BY (ds STRING, hr STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:db1
@@ -146,8 +151,10 @@ POSTHOOK: Input: db1@srcpart
 ds=3/hr=3
 PREHOOK: query: use default
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:default
 POSTHOOK: query: use default
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:default
 PREHOOK: query: -- from default to db1
 SHOW PARTITIONS db1.srcpart PARTITION(ds='4')
 PREHOOK: type: SHOWPARTITIONS
diff --git a/ql/src/test/results/clientpositive/show_tables.q.out b/ql/src/test/results/clientpositive/show_tables.q.out
index 0ddcf27956..0d4aa5713e 100644
--- a/ql/src/test/results/clientpositive/show_tables.q.out
+++ b/ql/src/test/results/clientpositive/show_tables.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE shtb_test1(KEY STRING, VALUE STRING) PARTITIONED BY(ds STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@shtb_test1
 POSTHOOK: query: CREATE TABLE shtb_test1(KEY STRING, VALUE STRING) PARTITIONED BY(ds STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@shtb_test1
 PREHOOK: query: CREATE TABLE shtb_test2(KEY STRING, VALUE STRING) PARTITIONED BY(ds STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@shtb_test2
 POSTHOOK: query: CREATE TABLE shtb_test2(KEY STRING, VALUE STRING) PARTITIONED BY(ds STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -73,16 +75,21 @@ shtb_test2
 PREHOOK: query: -- SHOW TABLES FROM/IN database
 CREATE DATABASE test_db
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:test_db
 POSTHOOK: query: -- SHOW TABLES FROM/IN database
 CREATE DATABASE test_db
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:test_db
 PREHOOK: query: USE test_db
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:test_db
 POSTHOOK: query: USE test_db
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:test_db
 PREHOOK: query: CREATE TABLE foo(a INT)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:test_db
+PREHOOK: Output: test_db@foo
 POSTHOOK: query: CREATE TABLE foo(a INT)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:test_db
@@ -90,6 +97,7 @@ POSTHOOK: Output: test_db@foo
 PREHOOK: query: CREATE TABLE bar(a INT)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:test_db
+PREHOOK: Output: test_db@bar
 POSTHOOK: query: CREATE TABLE bar(a INT)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:test_db
@@ -97,6 +105,7 @@ POSTHOOK: Output: test_db@bar
 PREHOOK: query: CREATE TABLE baz(a INT)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:test_db
+PREHOOK: Output: test_db@baz
 POSTHOOK: query: CREATE TABLE baz(a INT)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:test_db
@@ -104,9 +113,11 @@ POSTHOOK: Output: test_db@baz
 PREHOOK: query: -- SHOW TABLES basic syntax tests
 USE default
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:default
 POSTHOOK: query: -- SHOW TABLES basic syntax tests
 USE default
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:default
 PREHOOK: query: SHOW TABLES FROM test_db
 PREHOOK: type: SHOWTABLES
 POSTHOOK: query: SHOW TABLES FROM test_db
@@ -162,24 +173,31 @@ POSTHOOK: type: SHOWTABLES
 PREHOOK: query: -- SHOW TABLES from a database with a name that requires escaping
 CREATE DATABASE `database`
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:database
 POSTHOOK: query: -- SHOW TABLES from a database with a name that requires escaping
 CREATE DATABASE `database`
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:database
 PREHOOK: query: USE `database`
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:database
 POSTHOOK: query: USE `database`
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:database
 PREHOOK: query: CREATE TABLE foo(a INT)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:database
+PREHOOK: Output: database@foo
 POSTHOOK: query: CREATE TABLE foo(a INT)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:database
 POSTHOOK: Output: database@foo
 PREHOOK: query: USE default
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:default
 POSTHOOK: query: USE default
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:default
 PREHOOK: query: SHOW TABLES FROM `database` LIKE "foo"
 PREHOOK: type: SHOWTABLES
 POSTHOOK: query: SHOW TABLES FROM `database` LIKE "foo"
diff --git a/ql/src/test/results/clientpositive/show_tblproperties.q.out b/ql/src/test/results/clientpositive/show_tblproperties.q.out
index 57b774e9de..c206c600e3 100644
--- a/ql/src/test/results/clientpositive/show_tblproperties.q.out
+++ b/ql/src/test/results/clientpositive/show_tblproperties.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table tmpfoo (a String)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmpfoo
 POSTHOOK: query: create table tmpfoo (a String)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -69,15 +70,20 @@ POSTHOOK: type: SHOW_TBLPROPERTIES
 bar value	 
 PREHOOK: query: CREATE DATABASE db1
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:db1
 POSTHOOK: query: CREATE DATABASE db1
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:db1
 PREHOOK: query: USE db1
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:db1
 POSTHOOK: query: USE db1
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:db1
 PREHOOK: query: CREATE TABLE tmpfoo (b STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:db1
+PREHOOK: Output: db1@tmpfoo
 POSTHOOK: query: CREATE TABLE tmpfoo (b STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:db1
@@ -140,8 +146,10 @@ POSTHOOK: type: SHOW_TBLPROPERTIES
 bar value1	 
 PREHOOK: query: use default
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:default
 POSTHOOK: query: use default
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:default
 PREHOOK: query: -- from default to db1
 show tblproperties db1.tmpfoo
 PREHOOK: type: SHOW_TBLPROPERTIES
diff --git a/ql/src/test/results/clientpositive/skewjoin.q.out b/ql/src/test/results/clientpositive/skewjoin.q.out
index 20b681c4eb..c77e54de05 100644
--- a/ql/src/test/results/clientpositive/skewjoin.q.out
+++ b/ql/src/test/results/clientpositive/skewjoin.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE T1(key STRING, val STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: CREATE TABLE T1(key STRING, val STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@T1
 PREHOOK: query: CREATE TABLE T2(key STRING, val STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T2
 POSTHOOK: query: CREATE TABLE T2(key STRING, val STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -15,6 +17,7 @@ POSTHOOK: Output: default@T2
 PREHOOK: query: CREATE TABLE T3(key STRING, val STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T3
 POSTHOOK: query: CREATE TABLE T3(key STRING, val STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -22,6 +25,7 @@ POSTHOOK: Output: default@T3
 PREHOOK: query: CREATE TABLE T4(key STRING, val STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T4
 POSTHOOK: query: CREATE TABLE T4(key STRING, val STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -29,6 +33,7 @@ POSTHOOK: Output: default@T4
 PREHOOK: query: CREATE TABLE dest_j1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_j1
 POSTHOOK: query: CREATE TABLE dest_j1(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/skewjoin_union_remove_1.q.out b/ql/src/test/results/clientpositive/skewjoin_union_remove_1.q.out
index 7678cb9379..81c362e21b 100644
--- a/ql/src/test/results/clientpositive/skewjoin_union_remove_1.q.out
+++ b/ql/src/test/results/clientpositive/skewjoin_union_remove_1.q.out
@@ -10,6 +10,7 @@ CREATE TABLE T1(key STRING, val STRING)
 SKEWED BY (key) ON ((2)) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: -- This is to test the union->selectstar->filesink and skewjoin optimization
 -- Union of 2 map-reduce subqueries is performed for the skew join
 -- There is no need to write the temporary results of the sub-queries, and then read them 
@@ -35,6 +36,7 @@ PREHOOK: query: CREATE TABLE T2(key STRING, val STRING)
 SKEWED BY (key) ON ((3)) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T2
 POSTHOOK: query: CREATE TABLE T2(key STRING, val STRING)
 SKEWED BY (key) ON ((3)) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
@@ -325,6 +327,7 @@ NULL	NULL	5	15
 PREHOOK: query: create table DEST1(key1 STRING, val1 STRING, key2 STRING, val2 STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@DEST1
 POSTHOOK: query: create table DEST1(key1 STRING, val1 STRING, key2 STRING, val2 STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/skewjoin_union_remove_2.q.out b/ql/src/test/results/clientpositive/skewjoin_union_remove_2.q.out
index bb9af2fac1..2f26156126 100644
--- a/ql/src/test/results/clientpositive/skewjoin_union_remove_2.q.out
+++ b/ql/src/test/results/clientpositive/skewjoin_union_remove_2.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: CREATE TABLE T1(key STRING, val STRING)
 SKEWED BY (key) ON ((2), (8)) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: CREATE TABLE T1(key STRING, val STRING)
 SKEWED BY (key) ON ((2), (8)) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
@@ -19,6 +20,7 @@ PREHOOK: query: CREATE TABLE T2(key STRING, val STRING)
 SKEWED BY (key) ON ((3), (8)) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T2
 POSTHOOK: query: CREATE TABLE T2(key STRING, val STRING)
 SKEWED BY (key) ON ((3), (8)) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
@@ -35,6 +37,7 @@ POSTHOOK: Output: default@t2
 PREHOOK: query: CREATE TABLE T3(key STRING, val STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T3
 POSTHOOK: query: CREATE TABLE T3(key STRING, val STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/skewjoinopt1.q.out b/ql/src/test/results/clientpositive/skewjoinopt1.q.out
index eeeca5acf6..18f7c6cf60 100644
--- a/ql/src/test/results/clientpositive/skewjoinopt1.q.out
+++ b/ql/src/test/results/clientpositive/skewjoinopt1.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: CREATE TABLE T1(key STRING, val STRING)
 SKEWED BY (key) ON ((2)) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: CREATE TABLE T1(key STRING, val STRING)
 SKEWED BY (key) ON ((2)) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
@@ -19,6 +20,7 @@ PREHOOK: query: CREATE TABLE T2(key STRING, val STRING)
 SKEWED BY (key) ON ((3)) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T2
 POSTHOOK: query: CREATE TABLE T2(key STRING, val STRING)
 SKEWED BY (key) ON ((3)) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/skewjoinopt10.q.out b/ql/src/test/results/clientpositive/skewjoinopt10.q.out
index 99789f93a2..d7ca8f7b43 100644
--- a/ql/src/test/results/clientpositive/skewjoinopt10.q.out
+++ b/ql/src/test/results/clientpositive/skewjoinopt10.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE T1(key STRING, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: CREATE TABLE T1(key STRING, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -20,6 +21,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table array_valued_T1 (key string, value array<string>) SKEWED BY (key) ON ((8))
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@array_valued_T1
 POSTHOOK: query: create table array_valued_T1 (key string, value array<string>) SKEWED BY (key) ON ((8))
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/skewjoinopt11.q.out b/ql/src/test/results/clientpositive/skewjoinopt11.q.out
index f1457dedd2..ccca84cb69 100644
--- a/ql/src/test/results/clientpositive/skewjoinopt11.q.out
+++ b/ql/src/test/results/clientpositive/skewjoinopt11.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: CREATE TABLE T1(key STRING, val STRING)
 SKEWED BY (key) ON ((2)) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: CREATE TABLE T1(key STRING, val STRING)	
 SKEWED BY (key) ON ((2)) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
@@ -18,6 +19,7 @@ POSTHOOK: Output: default@t1
 PREHOOK: query: CREATE TABLE T2(key STRING, val STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T2
 POSTHOOK: query: CREATE TABLE T2(key STRING, val STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/skewjoinopt12.q.out b/ql/src/test/results/clientpositive/skewjoinopt12.q.out
index f9cfd89b4d..ead9476e59 100644
--- a/ql/src/test/results/clientpositive/skewjoinopt12.q.out
+++ b/ql/src/test/results/clientpositive/skewjoinopt12.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: CREATE TABLE T1(key STRING, val STRING)
 SKEWED BY (key, val) ON ((2, 12), (8, 18)) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: CREATE TABLE T1(key STRING, val STRING)
 SKEWED BY (key, val) ON ((2, 12), (8, 18)) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
@@ -19,6 +20,7 @@ PREHOOK: query: CREATE TABLE T2(key STRING, val STRING)
 SKEWED BY (key, val) ON ((3, 13), (8, 18)) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T2
 POSTHOOK: query: CREATE TABLE T2(key STRING, val STRING)
 SKEWED BY (key, val) ON ((3, 13), (8, 18)) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/skewjoinopt13.q.out b/ql/src/test/results/clientpositive/skewjoinopt13.q.out
index 1bcc1bfc5a..d564dcce51 100644
--- a/ql/src/test/results/clientpositive/skewjoinopt13.q.out
+++ b/ql/src/test/results/clientpositive/skewjoinopt13.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE T1(key STRING, val STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: CREATE TABLE T1(key STRING, val STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -16,6 +17,7 @@ POSTHOOK: Output: default@t1
 PREHOOK: query: CREATE TABLE T2(key STRING, val STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T2
 POSTHOOK: query: CREATE TABLE T2(key STRING, val STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -32,6 +34,7 @@ PREHOOK: query: CREATE TABLE T3(key STRING, val STRING)
 SKEWED BY (val) ON ((12)) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T3
 POSTHOOK: query: CREATE TABLE T3(key STRING, val STRING)
 SKEWED BY (val) ON ((12)) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/skewjoinopt14.q.out b/ql/src/test/results/clientpositive/skewjoinopt14.q.out
index e9ae0948da..9a14a6dae2 100644
--- a/ql/src/test/results/clientpositive/skewjoinopt14.q.out
+++ b/ql/src/test/results/clientpositive/skewjoinopt14.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: CREATE TABLE T1(key STRING, val STRING)
 SKEWED BY (key) ON ((2)) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: CREATE TABLE T1(key STRING, val STRING)
 SKEWED BY (key) ON ((2)) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
@@ -18,6 +19,7 @@ POSTHOOK: Output: default@t1
 PREHOOK: query: CREATE TABLE T2(key STRING, val STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T2
 POSTHOOK: query: CREATE TABLE T2(key STRING, val STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -34,6 +36,7 @@ PREHOOK: query: CREATE TABLE T3(key STRING, val STRING)
 SKEWED BY (val) ON ((12)) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T3
 POSTHOOK: query: CREATE TABLE T3(key STRING, val STRING)
 SKEWED BY (val) ON ((12)) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/skewjoinopt15.q.out b/ql/src/test/results/clientpositive/skewjoinopt15.q.out
index 52f1db395f..271b14b413 100644
--- a/ql/src/test/results/clientpositive/skewjoinopt15.q.out
+++ b/ql/src/test/results/clientpositive/skewjoinopt15.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE tmpT1(key STRING, val STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmpT1
 POSTHOOK: query: CREATE TABLE tmpT1(key STRING, val STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -17,6 +18,7 @@ PREHOOK: query: -- testing skew on other data types - int
 CREATE TABLE T1(key INT, val STRING) SKEWED BY (key) ON ((2))
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: -- testing skew on other data types - int
 CREATE TABLE T1(key INT, val STRING) SKEWED BY (key) ON ((2))
 POSTHOOK: type: CREATETABLE
@@ -35,6 +37,7 @@ POSTHOOK: Lineage: t1.val SIMPLE [(tmpt1)tmpt1.FieldSchema(name:val, type:string
 PREHOOK: query: CREATE TABLE tmpT2(key STRING, val STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmpT2
 POSTHOOK: query: CREATE TABLE tmpT2(key STRING, val STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -50,6 +53,7 @@ POSTHOOK: Output: default@tmpt2
 PREHOOK: query: CREATE TABLE T2(key INT, val STRING) SKEWED BY (key) ON ((3))
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T2
 POSTHOOK: query: CREATE TABLE T2(key INT, val STRING) SKEWED BY (key) ON ((3))
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/skewjoinopt16.q.out b/ql/src/test/results/clientpositive/skewjoinopt16.q.out
index c6397e2016..4e66784939 100644
--- a/ql/src/test/results/clientpositive/skewjoinopt16.q.out
+++ b/ql/src/test/results/clientpositive/skewjoinopt16.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: CREATE TABLE T1(key STRING, val STRING)
 SKEWED BY (key, val) ON ((2, 12)) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: CREATE TABLE T1(key STRING, val STRING)
 SKEWED BY (key, val) ON ((2, 12)) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
@@ -19,6 +20,7 @@ PREHOOK: query: CREATE TABLE T2(key STRING, val STRING)
 SKEWED BY (key) ON ((3)) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T2
 POSTHOOK: query: CREATE TABLE T2(key STRING, val STRING)
 SKEWED BY (key) ON ((3)) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/skewjoinopt17.q.out b/ql/src/test/results/clientpositive/skewjoinopt17.q.out
index 7d4703074e..98b8dcaedf 100644
--- a/ql/src/test/results/clientpositive/skewjoinopt17.q.out
+++ b/ql/src/test/results/clientpositive/skewjoinopt17.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: CREATE TABLE T1(key STRING, val STRING)
 SKEWED BY (key, val) ON ((2, 12)) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: CREATE TABLE T1(key STRING, val STRING)
 SKEWED BY (key, val) ON ((2, 12)) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
@@ -19,6 +20,7 @@ PREHOOK: query: CREATE TABLE T2(key STRING, val STRING)
 SKEWED BY (key) ON ((2)) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T2
 POSTHOOK: query: CREATE TABLE T2(key STRING, val STRING)
 SKEWED BY (key) ON ((2)) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
@@ -225,6 +227,7 @@ PREHOOK: query: CREATE TABLE T1(key STRING, val STRING)
 SKEWED BY (key, val) ON ((2, 12)) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: CREATE TABLE T1(key STRING, val STRING)
 SKEWED BY (key, val) ON ((2, 12)) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
@@ -242,6 +245,7 @@ PREHOOK: query: CREATE TABLE T2(key STRING, val STRING)
 SKEWED BY (key) ON ((2)) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T2
 POSTHOOK: query: CREATE TABLE T2(key STRING, val STRING)
 SKEWED BY (key) ON ((2)) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/skewjoinopt18.q.out b/ql/src/test/results/clientpositive/skewjoinopt18.q.out
index f1d2131d3b..c48aa8d56a 100644
--- a/ql/src/test/results/clientpositive/skewjoinopt18.q.out
+++ b/ql/src/test/results/clientpositive/skewjoinopt18.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE tmpT1(key STRING, val STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmpT1
 POSTHOOK: query: CREATE TABLE tmpT1(key STRING, val STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -17,6 +18,7 @@ PREHOOK: query: -- testing skew on other data types - int
 CREATE TABLE T1(key INT, val STRING) SKEWED BY (key) ON ((2))
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: -- testing skew on other data types - int
 CREATE TABLE T1(key INT, val STRING) SKEWED BY (key) ON ((2))
 POSTHOOK: type: CREATETABLE
@@ -39,6 +41,7 @@ CREATE TABLE T2(key STRING, val STRING)
 SKEWED BY (key) ON ((3)) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T2
 POSTHOOK: query: -- Tke skewed column is same in both the tables, however it is
 -- INT in one of the tables, and STRING in the other table
 
diff --git a/ql/src/test/results/clientpositive/skewjoinopt19.q.out b/ql/src/test/results/clientpositive/skewjoinopt19.q.out
index 257e1081a3..5e0670e96f 100644
--- a/ql/src/test/results/clientpositive/skewjoinopt19.q.out
+++ b/ql/src/test/results/clientpositive/skewjoinopt19.q.out
@@ -3,6 +3,7 @@ CLUSTERED BY (key) INTO 4 BUCKETS
 SKEWED BY (key) ON ((2)) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: CREATE TABLE T1(key STRING, val STRING)
 CLUSTERED BY (key) INTO 4 BUCKETS
 SKEWED BY (key) ON ((2)) STORED AS TEXTFILE
@@ -20,6 +21,7 @@ POSTHOOK: Output: default@t1
 PREHOOK: query: CREATE TABLE T2(key STRING, val STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T2
 POSTHOOK: query: CREATE TABLE T2(key STRING, val STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/skewjoinopt2.q.out b/ql/src/test/results/clientpositive/skewjoinopt2.q.out
index fb06a4b45e..57a1472425 100644
--- a/ql/src/test/results/clientpositive/skewjoinopt2.q.out
+++ b/ql/src/test/results/clientpositive/skewjoinopt2.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: CREATE TABLE T1(key STRING, val STRING)
 SKEWED BY (key) ON ((2), (7)) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: CREATE TABLE T1(key STRING, val STRING)
 SKEWED BY (key) ON ((2), (7)) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
@@ -19,6 +20,7 @@ PREHOOK: query: CREATE TABLE T2(key STRING, val STRING)
 SKEWED BY (key) ON ((3), (8)) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T2
 POSTHOOK: query: CREATE TABLE T2(key STRING, val STRING)
 SKEWED BY (key) ON ((3), (8)) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/skewjoinopt20.q.out b/ql/src/test/results/clientpositive/skewjoinopt20.q.out
index 31ace72a8c..73d18086e4 100644
--- a/ql/src/test/results/clientpositive/skewjoinopt20.q.out
+++ b/ql/src/test/results/clientpositive/skewjoinopt20.q.out
@@ -3,6 +3,7 @@ CLUSTERED BY (key) SORTED BY (key) INTO 4 BUCKETS
 SKEWED BY (key) ON ((2)) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: CREATE TABLE T1(key STRING, val STRING)
 CLUSTERED BY (key) SORTED BY (key) INTO 4 BUCKETS
 SKEWED BY (key) ON ((2)) STORED AS TEXTFILE
@@ -20,6 +21,7 @@ POSTHOOK: Output: default@t1
 PREHOOK: query: CREATE TABLE T2(key STRING, val STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T2
 POSTHOOK: query: CREATE TABLE T2(key STRING, val STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/skewjoinopt3.q.out b/ql/src/test/results/clientpositive/skewjoinopt3.q.out
index 842f8c146e..5bc2024d3a 100644
--- a/ql/src/test/results/clientpositive/skewjoinopt3.q.out
+++ b/ql/src/test/results/clientpositive/skewjoinopt3.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: CREATE TABLE T1(key STRING, val STRING)
 SKEWED BY (key) ON ((2), (8)) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: CREATE TABLE T1(key STRING, val STRING)
 SKEWED BY (key) ON ((2), (8)) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
@@ -19,6 +20,7 @@ PREHOOK: query: CREATE TABLE T2(key STRING, val STRING)
 SKEWED BY (key) ON ((3), (8)) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T2
 POSTHOOK: query: CREATE TABLE T2(key STRING, val STRING)
 SKEWED BY (key) ON ((3), (8)) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/skewjoinopt4.q.out b/ql/src/test/results/clientpositive/skewjoinopt4.q.out
index 1dc65b55c6..6ac101b3a1 100644
--- a/ql/src/test/results/clientpositive/skewjoinopt4.q.out
+++ b/ql/src/test/results/clientpositive/skewjoinopt4.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: CREATE TABLE T1(key STRING, val STRING)
 SKEWED BY (key) ON ((2)) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: CREATE TABLE T1(key STRING, val STRING)
 SKEWED BY (key) ON ((2)) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
@@ -18,6 +19,7 @@ POSTHOOK: Output: default@t1
 PREHOOK: query: CREATE TABLE T2(key STRING, val STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T2
 POSTHOOK: query: CREATE TABLE T2(key STRING, val STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/skewjoinopt5.q.out b/ql/src/test/results/clientpositive/skewjoinopt5.q.out
index cc1ca521a6..fdb914f460 100644
--- a/ql/src/test/results/clientpositive/skewjoinopt5.q.out
+++ b/ql/src/test/results/clientpositive/skewjoinopt5.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: CREATE TABLE T1(key STRING, val STRING)
 SKEWED BY (key, val) ON ((2, 12)) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: CREATE TABLE T1(key STRING, val STRING)
 SKEWED BY (key, val) ON ((2, 12)) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
@@ -19,6 +20,7 @@ PREHOOK: query: CREATE TABLE T2(key STRING, val STRING)
 SKEWED BY (key) ON ((3)) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T2
 POSTHOOK: query: CREATE TABLE T2(key STRING, val STRING)
 SKEWED BY (key) ON ((3)) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/skewjoinopt6.q.out b/ql/src/test/results/clientpositive/skewjoinopt6.q.out
index f7dfd7f79a..311070108b 100644
--- a/ql/src/test/results/clientpositive/skewjoinopt6.q.out
+++ b/ql/src/test/results/clientpositive/skewjoinopt6.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: CREATE TABLE T1(key STRING, val STRING)
 SKEWED BY (key, val) ON ((2, 12), (8, 18)) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: CREATE TABLE T1(key STRING, val STRING)
 SKEWED BY (key, val) ON ((2, 12), (8, 18)) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
@@ -19,6 +20,7 @@ PREHOOK: query: CREATE TABLE T2(key STRING, val STRING)
 SKEWED BY (key, val) ON ((3, 13), (8, 18)) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T2
 POSTHOOK: query: CREATE TABLE T2(key STRING, val STRING)
 SKEWED BY (key, val) ON ((3, 13), (8, 18)) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/skewjoinopt7.q.out b/ql/src/test/results/clientpositive/skewjoinopt7.q.out
index 12cc3fb33c..f2f126799c 100644
--- a/ql/src/test/results/clientpositive/skewjoinopt7.q.out
+++ b/ql/src/test/results/clientpositive/skewjoinopt7.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: CREATE TABLE T1(key STRING, val STRING)
 SKEWED BY (key) ON ((2), (8)) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: CREATE TABLE T1(key STRING, val STRING)
 SKEWED BY (key) ON ((2), (8)) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
@@ -19,6 +20,7 @@ PREHOOK: query: CREATE TABLE T2(key STRING, val STRING)
 SKEWED BY (key) ON ((3), (8)) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T2
 POSTHOOK: query: CREATE TABLE T2(key STRING, val STRING)
 SKEWED BY (key) ON ((3), (8)) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
@@ -35,6 +37,7 @@ POSTHOOK: Output: default@t2
 PREHOOK: query: CREATE TABLE T3(key STRING, val STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T3
 POSTHOOK: query: CREATE TABLE T3(key STRING, val STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/skewjoinopt8.q.out b/ql/src/test/results/clientpositive/skewjoinopt8.q.out
index 04c39755cf..79c18af5a6 100644
--- a/ql/src/test/results/clientpositive/skewjoinopt8.q.out
+++ b/ql/src/test/results/clientpositive/skewjoinopt8.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE T1(key STRING, val STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: CREATE TABLE T1(key STRING, val STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -17,6 +18,7 @@ PREHOOK: query: CREATE TABLE T2(key STRING, val STRING)
 SKEWED BY (key) ON ((3), (8)) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T2
 POSTHOOK: query: CREATE TABLE T2(key STRING, val STRING)
 SKEWED BY (key) ON ((3), (8)) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
@@ -33,6 +35,7 @@ POSTHOOK: Output: default@t2
 PREHOOK: query: CREATE TABLE T3(key STRING, val STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T3
 POSTHOOK: query: CREATE TABLE T3(key STRING, val STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/skewjoinopt9.q.out b/ql/src/test/results/clientpositive/skewjoinopt9.q.out
index cd99523bb7..58dad77254 100644
--- a/ql/src/test/results/clientpositive/skewjoinopt9.q.out
+++ b/ql/src/test/results/clientpositive/skewjoinopt9.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: CREATE TABLE T1(key STRING, val STRING)
 SKEWED BY (key) ON ((2)) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: CREATE TABLE T1(key STRING, val STRING)
 SKEWED BY (key) ON ((2)) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
@@ -18,6 +19,7 @@ POSTHOOK: Output: default@t1
 PREHOOK: query: CREATE TABLE T2(key STRING, val STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T2
 POSTHOOK: query: CREATE TABLE T2(key STRING, val STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/smb_mapjoin9.q.out b/ql/src/test/results/clientpositive/smb_mapjoin9.q.out
index 49283e59cf..9500ba41d2 100644
--- a/ql/src/test/results/clientpositive/smb_mapjoin9.q.out
+++ b/ql/src/test/results/clientpositive/smb_mapjoin9.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table hive_test_smb_bucket1 (key int, value string) partitioned by (ds string) clustered by (key) sorted by (key) into 2 buckets
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@hive_test_smb_bucket1
 POSTHOOK: query: create table hive_test_smb_bucket1 (key int, value string) partitioned by (ds string) clustered by (key) sorted by (key) into 2 buckets
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@hive_test_smb_bucket1
 PREHOOK: query: create table hive_test_smb_bucket2 (key int, value string) partitioned by (ds string) clustered by (key) sorted by (key) into 2 buckets
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@hive_test_smb_bucket2
 POSTHOOK: query: create table hive_test_smb_bucket2 (key int, value string) partitioned by (ds string) clustered by (key) sorted by (key) into 2 buckets
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/smb_mapjoin_1.q.out b/ql/src/test/results/clientpositive/smb_mapjoin_1.q.out
index bcc51b7b31..8d679f8fba 100644
--- a/ql/src/test/results/clientpositive/smb_mapjoin_1.q.out
+++ b/ql/src/test/results/clientpositive/smb_mapjoin_1.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table smb_bucket_1(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 1 BUCKETS STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@smb_bucket_1
 POSTHOOK: query: create table smb_bucket_1(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 1 BUCKETS STORED AS RCFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@smb_bucket_1
 PREHOOK: query: create table smb_bucket_2(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 1 BUCKETS STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@smb_bucket_2
 POSTHOOK: query: create table smb_bucket_2(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 1 BUCKETS STORED AS RCFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -15,6 +17,7 @@ POSTHOOK: Output: default@smb_bucket_2
 PREHOOK: query: create table smb_bucket_3(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 1 BUCKETS STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@smb_bucket_3
 POSTHOOK: query: create table smb_bucket_3(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 1 BUCKETS STORED AS RCFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/smb_mapjoin_10.q.out b/ql/src/test/results/clientpositive/smb_mapjoin_10.q.out
index 3fb7fd1543..9a5cdc0671 100644
--- a/ql/src/test/results/clientpositive/smb_mapjoin_10.q.out
+++ b/ql/src/test/results/clientpositive/smb_mapjoin_10.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table tmp_smb_bucket_10(userid int, pageid int, postid int, type string) partitioned by (ds string) CLUSTERED BY (userid) SORTED BY (pageid, postid, type, userid) INTO 2 BUCKETS STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmp_smb_bucket_10
 POSTHOOK: query: create table tmp_smb_bucket_10(userid int, pageid int, postid int, type string) partitioned by (ds string) CLUSTERED BY (userid) SORTED BY (pageid, postid, type, userid) INTO 2 BUCKETS STORED AS RCFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/smb_mapjoin_11.q.out b/ql/src/test/results/clientpositive/smb_mapjoin_11.q.out
index d59b801a4f..f9a7aa295e 100644
--- a/ql/src/test/results/clientpositive/smb_mapjoin_11.q.out
+++ b/ql/src/test/results/clientpositive/smb_mapjoin_11.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: -- This test verifies that the output of a sort merge join on 2
 CREATE TABLE test_table1 (key INT, value STRING) PARTITIONED BY (ds STRING) CLUSTERED BY (key) SORTED BY (key) INTO 16 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table1
 POSTHOOK: query: -- This test verifies that the output of a sort merge join on 2 partitions (one on each side of the join) is bucketed
 
 -- Create two bucketed and sorted tables
@@ -14,6 +15,7 @@ POSTHOOK: Output: default@test_table1
 PREHOOK: query: CREATE TABLE test_table2 (key INT, value STRING) PARTITIONED BY (ds STRING) CLUSTERED BY (key) SORTED BY (key) INTO 16 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table2
 POSTHOOK: query: CREATE TABLE test_table2 (key INT, value STRING) PARTITIONED BY (ds STRING) CLUSTERED BY (key) SORTED BY (key) INTO 16 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -40,6 +42,7 @@ PREHOOK: query: -- Create a bucketed table
 CREATE TABLE test_table3 (key INT, value STRING) PARTITIONED BY (ds STRING) CLUSTERED BY (key) INTO 16 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table3
 POSTHOOK: query: -- Create a bucketed table
 CREATE TABLE test_table3 (key INT, value STRING) PARTITIONED BY (ds STRING) CLUSTERED BY (key) INTO 16 BUCKETS
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/smb_mapjoin_12.q.out b/ql/src/test/results/clientpositive/smb_mapjoin_12.q.out
index ab3f93f78b..6d3c37ee30 100644
--- a/ql/src/test/results/clientpositive/smb_mapjoin_12.q.out
+++ b/ql/src/test/results/clientpositive/smb_mapjoin_12.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: -- This test verifies that the output of a sort merge join on 1
 CREATE TABLE test_table1 (key INT, value STRING) PARTITIONED BY (ds STRING) CLUSTERED BY (key) SORTED BY (key) INTO 16 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table1
 POSTHOOK: query: -- This test verifies that the output of a sort merge join on 1 big partition with multiple small partitions is bucketed and sorted
 
 -- Create two bucketed and sorted tables
@@ -14,6 +15,7 @@ POSTHOOK: Output: default@test_table1
 PREHOOK: query: CREATE TABLE test_table2 (key INT, value STRING) PARTITIONED BY (ds STRING) CLUSTERED BY (key) SORTED BY (key) INTO 16 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table2
 POSTHOOK: query: CREATE TABLE test_table2 (key INT, value STRING) PARTITIONED BY (ds STRING) CLUSTERED BY (key) SORTED BY (key) INTO 16 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -52,6 +54,7 @@ PREHOOK: query: -- Create a bucketed table
 CREATE TABLE test_table3 (key INT, value STRING) PARTITIONED BY (ds STRING) CLUSTERED BY (key) SORTED BY (key) INTO 16 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table3
 POSTHOOK: query: -- Create a bucketed table
 CREATE TABLE test_table3 (key INT, value STRING) PARTITIONED BY (ds STRING) CLUSTERED BY (key) SORTED BY (key) INTO 16 BUCKETS
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/smb_mapjoin_13.q.out b/ql/src/test/results/clientpositive/smb_mapjoin_13.q.out
index 8ad8578578..fb80ee4ea0 100644
--- a/ql/src/test/results/clientpositive/smb_mapjoin_13.q.out
+++ b/ql/src/test/results/clientpositive/smb_mapjoin_13.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: -- This test verifies that the sort merge join optimizer works w
 CREATE TABLE test_table1 (key INT, value STRING) CLUSTERED BY (key) SORTED BY (key ASC) INTO 16 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table1
 POSTHOOK: query: -- This test verifies that the sort merge join optimizer works when the tables are joined on columns with different names
 
 -- Create bucketed and sorted tables
@@ -14,6 +15,7 @@ POSTHOOK: Output: default@test_table1
 PREHOOK: query: CREATE TABLE test_table2 (value INT, key STRING) CLUSTERED BY (value) SORTED BY (value ASC) INTO 16 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table2
 POSTHOOK: query: CREATE TABLE test_table2 (value INT, key STRING) CLUSTERED BY (value) SORTED BY (value ASC) INTO 16 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -21,6 +23,7 @@ POSTHOOK: Output: default@test_table2
 PREHOOK: query: CREATE TABLE test_table3 (key INT, value STRING) CLUSTERED BY (key, value) SORTED BY (key ASC, value ASC) INTO 16 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table3
 POSTHOOK: query: CREATE TABLE test_table3 (key INT, value STRING) CLUSTERED BY (key, value) SORTED BY (key ASC, value ASC) INTO 16 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -28,6 +31,7 @@ POSTHOOK: Output: default@test_table3
 PREHOOK: query: CREATE TABLE test_table4 (key INT, value STRING) CLUSTERED BY (key, value) SORTED BY (value ASC, key ASC) INTO 16 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table4
 POSTHOOK: query: CREATE TABLE test_table4 (key INT, value STRING) CLUSTERED BY (key, value) SORTED BY (value ASC, key ASC) INTO 16 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/smb_mapjoin_14.q.out b/ql/src/test/results/clientpositive/smb_mapjoin_14.q.out
index 5590f92d77..05f5e00a19 100644
--- a/ql/src/test/results/clientpositive/smb_mapjoin_14.q.out
+++ b/ql/src/test/results/clientpositive/smb_mapjoin_14.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE tbl1(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl1
 POSTHOOK: query: CREATE TABLE tbl1(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@tbl1
 PREHOOK: query: CREATE TABLE tbl2(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl2
 POSTHOOK: query: CREATE TABLE tbl2(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/smb_mapjoin_15.q.out b/ql/src/test/results/clientpositive/smb_mapjoin_15.q.out
index c4ce208165..2424be8693 100644
--- a/ql/src/test/results/clientpositive/smb_mapjoin_15.q.out
+++ b/ql/src/test/results/clientpositive/smb_mapjoin_15.q.out
@@ -5,6 +5,7 @@ PREHOOK: query: -- This test verifies that the sort merge join optimizer works w
 CREATE TABLE test_table1 (key INT, value STRING) CLUSTERED BY (key) SORTED BY (key ASC, value ASC) INTO 16 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table1
 POSTHOOK: query: -- This test verifies that the sort merge join optimizer works when the tables are sorted on columns which is a superset
 -- of join columns
 
@@ -16,6 +17,7 @@ POSTHOOK: Output: default@test_table1
 PREHOOK: query: CREATE TABLE test_table2 (key INT, value STRING) CLUSTERED BY (key) SORTED BY (key ASC, value ASC) INTO 16 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table2
 POSTHOOK: query: CREATE TABLE test_table2 (key INT, value STRING) CLUSTERED BY (key) SORTED BY (key ASC, value ASC) INTO 16 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -253,6 +255,7 @@ PREHOOK: query: -- Create bucketed and sorted tables
 CREATE TABLE test_table1 (key INT, key2 INT, value STRING) CLUSTERED BY (key) SORTED BY (key ASC, key2 ASC, value ASC) INTO 16 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table1
 POSTHOOK: query: -- Create bucketed and sorted tables
 CREATE TABLE test_table1 (key INT, key2 INT, value STRING) CLUSTERED BY (key) SORTED BY (key ASC, key2 ASC, value ASC) INTO 16 BUCKETS
 POSTHOOK: type: CREATETABLE
@@ -261,6 +264,7 @@ POSTHOOK: Output: default@test_table1
 PREHOOK: query: CREATE TABLE test_table2 (key INT, key2 INT, value STRING) CLUSTERED BY (key) SORTED BY (key ASC, key2 ASC, value ASC) INTO 16 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table2
 POSTHOOK: query: CREATE TABLE test_table2 (key INT, key2 INT, value STRING) CLUSTERED BY (key) SORTED BY (key ASC, key2 ASC, value ASC) INTO 16 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/smb_mapjoin_16.q.out b/ql/src/test/results/clientpositive/smb_mapjoin_16.q.out
index a979a64231..15568ddae7 100644
--- a/ql/src/test/results/clientpositive/smb_mapjoin_16.q.out
+++ b/ql/src/test/results/clientpositive/smb_mapjoin_16.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- Create bucketed and sorted tables
 CREATE TABLE test_table1 (key INT, value STRING) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table1
 POSTHOOK: query: -- Create bucketed and sorted tables
 CREATE TABLE test_table1 (key INT, value STRING) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
@@ -10,6 +11,7 @@ POSTHOOK: Output: default@test_table1
 PREHOOK: query: CREATE TABLE test_table2 (key INT, value STRING) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table2
 POSTHOOK: query: CREATE TABLE test_table2 (key INT, value STRING) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/smb_mapjoin_17.q.out b/ql/src/test/results/clientpositive/smb_mapjoin_17.q.out
index 9ead57aced..d91dd1d8da 100644
--- a/ql/src/test/results/clientpositive/smb_mapjoin_17.q.out
+++ b/ql/src/test/results/clientpositive/smb_mapjoin_17.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- Create bucketed and sorted tables
 CREATE TABLE test_table1 (key INT, value STRING) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table1
 POSTHOOK: query: -- Create bucketed and sorted tables
 CREATE TABLE test_table1 (key INT, value STRING) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
@@ -10,6 +11,7 @@ POSTHOOK: Output: default@test_table1
 PREHOOK: query: CREATE TABLE test_table2 (key INT, value STRING) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table2
 POSTHOOK: query: CREATE TABLE test_table2 (key INT, value STRING) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -17,6 +19,7 @@ POSTHOOK: Output: default@test_table2
 PREHOOK: query: CREATE TABLE test_table3 (key INT, value STRING) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table3
 POSTHOOK: query: CREATE TABLE test_table3 (key INT, value STRING) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -24,6 +27,7 @@ POSTHOOK: Output: default@test_table3
 PREHOOK: query: CREATE TABLE test_table4 (key INT, value STRING) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table4
 POSTHOOK: query: CREATE TABLE test_table4 (key INT, value STRING) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -31,6 +35,7 @@ POSTHOOK: Output: default@test_table4
 PREHOOK: query: CREATE TABLE test_table5 (key INT, value STRING) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table5
 POSTHOOK: query: CREATE TABLE test_table5 (key INT, value STRING) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -38,6 +43,7 @@ POSTHOOK: Output: default@test_table5
 PREHOOK: query: CREATE TABLE test_table6 (key INT, value STRING) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table6
 POSTHOOK: query: CREATE TABLE test_table6 (key INT, value STRING) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -45,6 +51,7 @@ POSTHOOK: Output: default@test_table6
 PREHOOK: query: CREATE TABLE test_table7 (key INT, value STRING) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table7
 POSTHOOK: query: CREATE TABLE test_table7 (key INT, value STRING) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -52,6 +59,7 @@ POSTHOOK: Output: default@test_table7
 PREHOOK: query: CREATE TABLE test_table8 (key INT, value STRING) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table8
 POSTHOOK: query: CREATE TABLE test_table8 (key INT, value STRING) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/smb_mapjoin_18.q.out b/ql/src/test/results/clientpositive/smb_mapjoin_18.q.out
index 244bcf6bd2..610618838a 100644
--- a/ql/src/test/results/clientpositive/smb_mapjoin_18.q.out
+++ b/ql/src/test/results/clientpositive/smb_mapjoin_18.q.out
@@ -3,6 +3,7 @@ CREATE TABLE test_table1 (key INT, value STRING) PARTITIONED BY (ds STRING)
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table1
 POSTHOOK: query: -- Create two bucketed and sorted tables
 CREATE TABLE test_table1 (key INT, value STRING) PARTITIONED BY (ds STRING)
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
@@ -13,6 +14,7 @@ PREHOOK: query: CREATE TABLE test_table2 (key INT, value STRING) PARTITIONED BY
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table2
 POSTHOOK: query: CREATE TABLE test_table2 (key INT, value STRING) PARTITIONED BY (ds STRING)
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/smb_mapjoin_19.q.out b/ql/src/test/results/clientpositive/smb_mapjoin_19.q.out
index 74bc5fcf06..95137cd95d 100644
--- a/ql/src/test/results/clientpositive/smb_mapjoin_19.q.out
+++ b/ql/src/test/results/clientpositive/smb_mapjoin_19.q.out
@@ -3,6 +3,7 @@ CREATE TABLE test_table1 (key INT, value STRING) PARTITIONED BY (ds STRING)
 CLUSTERED BY (key) SORTED BY (key) INTO 16 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table1
 POSTHOOK: query: -- Create two bucketed and sorted tables
 CREATE TABLE test_table1 (key INT, value STRING) PARTITIONED BY (ds STRING)
 CLUSTERED BY (key) SORTED BY (key) INTO 16 BUCKETS
@@ -13,6 +14,7 @@ PREHOOK: query: CREATE TABLE test_table2 (key INT, value STRING) PARTITIONED BY
 CLUSTERED BY (key) SORTED BY (key) INTO 16 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table2
 POSTHOOK: query: CREATE TABLE test_table2 (key INT, value STRING) PARTITIONED BY (ds STRING)
 CLUSTERED BY (key) SORTED BY (key) INTO 16 BUCKETS
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/smb_mapjoin_2.q.out b/ql/src/test/results/clientpositive/smb_mapjoin_2.q.out
index a5f7e66ae6..8019a5deb5 100644
--- a/ql/src/test/results/clientpositive/smb_mapjoin_2.q.out
+++ b/ql/src/test/results/clientpositive/smb_mapjoin_2.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table smb_bucket_1(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 1 BUCKETS STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@smb_bucket_1
 POSTHOOK: query: create table smb_bucket_1(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 1 BUCKETS STORED AS RCFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@smb_bucket_1
 PREHOOK: query: create table smb_bucket_2(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 1 BUCKETS STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@smb_bucket_2
 POSTHOOK: query: create table smb_bucket_2(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 1 BUCKETS STORED AS RCFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -15,6 +17,7 @@ POSTHOOK: Output: default@smb_bucket_2
 PREHOOK: query: create table smb_bucket_3(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 1 BUCKETS STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@smb_bucket_3
 POSTHOOK: query: create table smb_bucket_3(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 1 BUCKETS STORED AS RCFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/smb_mapjoin_20.q.out b/ql/src/test/results/clientpositive/smb_mapjoin_20.q.out
index d81e8be588..999dabd6ea 100644
--- a/ql/src/test/results/clientpositive/smb_mapjoin_20.q.out
+++ b/ql/src/test/results/clientpositive/smb_mapjoin_20.q.out
@@ -3,6 +3,7 @@ CREATE TABLE test_table1 (key int, value STRING) PARTITIONED BY (ds STRING)
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table1
 POSTHOOK: query: -- Create two bucketed and sorted tables
 CREATE TABLE test_table1 (key int, value STRING) PARTITIONED BY (ds STRING)
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
@@ -13,6 +14,7 @@ PREHOOK: query: CREATE TABLE test_table2 (key STRING, value1 STRING, value2 stri
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table2
 POSTHOOK: query: CREATE TABLE test_table2 (key STRING, value1 STRING, value2 string) PARTITIONED BY (ds STRING)
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
@@ -143,6 +145,7 @@ PREHOOK: query: CREATE TABLE test_table3 (key STRING, value1 int, value2 string)
 CLUSTERED BY (value1) SORTED BY (value1) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table3
 POSTHOOK: query: CREATE TABLE test_table3 (key STRING, value1 int, value2 string) PARTITIONED BY (ds STRING)
 CLUSTERED BY (value1) SORTED BY (value1) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/smb_mapjoin_21.q.out b/ql/src/test/results/clientpositive/smb_mapjoin_21.q.out
index 687fa85663..539b70e419 100644
--- a/ql/src/test/results/clientpositive/smb_mapjoin_21.q.out
+++ b/ql/src/test/results/clientpositive/smb_mapjoin_21.q.out
@@ -3,6 +3,7 @@ CREATE TABLE test_table1 (key INT, value STRING) PARTITIONED BY (ds STRING)
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table1
 POSTHOOK: query: -- Create two bucketed and sorted tables
 CREATE TABLE test_table1 (key INT, value STRING) PARTITIONED BY (ds STRING)
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
@@ -13,6 +14,7 @@ PREHOOK: query: CREATE TABLE test_table2 (key INT, value STRING) PARTITIONED BY
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table2
 POSTHOOK: query: CREATE TABLE test_table2 (key INT, value STRING) PARTITIONED BY (ds STRING)
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
@@ -94,6 +96,7 @@ PREHOOK: query: CREATE TABLE test_table2 (key INT, value STRING) PARTITIONED BY
 CLUSTERED BY (key) SORTED BY (key desc) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table2
 POSTHOOK: query: CREATE TABLE test_table2 (key INT, value STRING) PARTITIONED BY (ds STRING)
 CLUSTERED BY (key) SORTED BY (key desc) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
@@ -172,6 +175,7 @@ PREHOOK: query: CREATE TABLE test_table2 (key INT, value STRING) PARTITIONED BY
 CLUSTERED BY (key) SORTED BY (key, value) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table2
 POSTHOOK: query: CREATE TABLE test_table2 (key INT, value STRING) PARTITIONED BY (ds STRING)
 CLUSTERED BY (key) SORTED BY (key, value) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
@@ -250,6 +254,7 @@ PREHOOK: query: CREATE TABLE test_table2 (key INT, value STRING) PARTITIONED BY
 CLUSTERED BY (key) SORTED BY (value) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table2
 POSTHOOK: query: CREATE TABLE test_table2 (key INT, value STRING) PARTITIONED BY (ds STRING)
 CLUSTERED BY (key) SORTED BY (value) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
@@ -328,6 +333,7 @@ PREHOOK: query: CREATE TABLE test_table2 (key INT, value STRING) PARTITIONED BY
 CLUSTERED BY (key) SORTED BY (key) INTO 4 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table2
 POSTHOOK: query: CREATE TABLE test_table2 (key INT, value STRING) PARTITIONED BY (ds STRING)
 CLUSTERED BY (key) SORTED BY (key) INTO 4 BUCKETS
 POSTHOOK: type: CREATETABLE
@@ -406,6 +412,7 @@ PREHOOK: query: CREATE TABLE test_table2 (key INT, value STRING) PARTITIONED BY
 CLUSTERED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table2
 POSTHOOK: query: CREATE TABLE test_table2 (key INT, value STRING) PARTITIONED BY (ds STRING)
 CLUSTERED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/smb_mapjoin_22.q.out b/ql/src/test/results/clientpositive/smb_mapjoin_22.q.out
index c0757446d1..8f1dbd67f8 100644
--- a/ql/src/test/results/clientpositive/smb_mapjoin_22.q.out
+++ b/ql/src/test/results/clientpositive/smb_mapjoin_22.q.out
@@ -3,6 +3,7 @@ CREATE TABLE test_table1 (key INT, value STRING)
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table1
 POSTHOOK: query: -- Create two bucketed and sorted tables
 CREATE TABLE test_table1 (key INT, value STRING)
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
@@ -13,6 +14,7 @@ PREHOOK: query: CREATE TABLE test_table2 (key INT, value STRING)
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table2
 POSTHOOK: query: CREATE TABLE test_table2 (key INT, value STRING)
 CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
@@ -146,6 +148,7 @@ PREHOOK: query: CREATE TABLE test_table1 (key INT, value STRING)
 CLUSTERED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table1
 POSTHOOK: query: CREATE TABLE test_table1 (key INT, value STRING)
 CLUSTERED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
@@ -155,6 +158,7 @@ PREHOOK: query: CREATE TABLE test_table2 (key INT, value STRING)
 CLUSTERED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table2
 POSTHOOK: query: CREATE TABLE test_table2 (key INT, value STRING)
 CLUSTERED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/smb_mapjoin_25.q.out b/ql/src/test/results/clientpositive/smb_mapjoin_25.q.out
index f6a377ba96..140c46c5dc 100644
--- a/ql/src/test/results/clientpositive/smb_mapjoin_25.q.out
+++ b/ql/src/test/results/clientpositive/smb_mapjoin_25.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table smb_bucket_1(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 1 BUCKETS STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@smb_bucket_1
 POSTHOOK: query: create table smb_bucket_1(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 1 BUCKETS STORED AS RCFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@smb_bucket_1
 PREHOOK: query: create table smb_bucket_2(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 1 BUCKETS STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@smb_bucket_2
 POSTHOOK: query: create table smb_bucket_2(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 1 BUCKETS STORED AS RCFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -15,6 +17,7 @@ POSTHOOK: Output: default@smb_bucket_2
 PREHOOK: query: create table smb_bucket_3(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 1 BUCKETS STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@smb_bucket_3
 POSTHOOK: query: create table smb_bucket_3(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 1 BUCKETS STORED AS RCFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/smb_mapjoin_3.q.out b/ql/src/test/results/clientpositive/smb_mapjoin_3.q.out
index 379210f87f..f21e4c16c1 100644
--- a/ql/src/test/results/clientpositive/smb_mapjoin_3.q.out
+++ b/ql/src/test/results/clientpositive/smb_mapjoin_3.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table smb_bucket_1(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 1 BUCKETS STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@smb_bucket_1
 POSTHOOK: query: create table smb_bucket_1(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 1 BUCKETS STORED AS RCFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@smb_bucket_1
 PREHOOK: query: create table smb_bucket_2(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 1 BUCKETS STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@smb_bucket_2
 POSTHOOK: query: create table smb_bucket_2(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 1 BUCKETS STORED AS RCFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -15,6 +17,7 @@ POSTHOOK: Output: default@smb_bucket_2
 PREHOOK: query: create table smb_bucket_3(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 1 BUCKETS STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@smb_bucket_3
 POSTHOOK: query: create table smb_bucket_3(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 1 BUCKETS STORED AS RCFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/smb_mapjoin_4.q.out b/ql/src/test/results/clientpositive/smb_mapjoin_4.q.out
index 67d9f32575..d4e5b5e450 100644
--- a/ql/src/test/results/clientpositive/smb_mapjoin_4.q.out
+++ b/ql/src/test/results/clientpositive/smb_mapjoin_4.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table smb_bucket_1(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 1 BUCKETS STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@smb_bucket_1
 POSTHOOK: query: create table smb_bucket_1(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 1 BUCKETS STORED AS RCFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@smb_bucket_1
 PREHOOK: query: create table smb_bucket_2(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 1 BUCKETS STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@smb_bucket_2
 POSTHOOK: query: create table smb_bucket_2(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 1 BUCKETS STORED AS RCFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -15,6 +17,7 @@ POSTHOOK: Output: default@smb_bucket_2
 PREHOOK: query: create table smb_bucket_3(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 1 BUCKETS STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@smb_bucket_3
 POSTHOOK: query: create table smb_bucket_3(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 1 BUCKETS STORED AS RCFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/smb_mapjoin_5.q.out b/ql/src/test/results/clientpositive/smb_mapjoin_5.q.out
index 6dbf754073..83c23663c2 100644
--- a/ql/src/test/results/clientpositive/smb_mapjoin_5.q.out
+++ b/ql/src/test/results/clientpositive/smb_mapjoin_5.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table smb_bucket_1(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 1 BUCKETS STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@smb_bucket_1
 POSTHOOK: query: create table smb_bucket_1(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 1 BUCKETS STORED AS RCFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@smb_bucket_1
 PREHOOK: query: create table smb_bucket_2(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 1 BUCKETS STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@smb_bucket_2
 POSTHOOK: query: create table smb_bucket_2(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 1 BUCKETS STORED AS RCFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -15,6 +17,7 @@ POSTHOOK: Output: default@smb_bucket_2
 PREHOOK: query: create table smb_bucket_3(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 1 BUCKETS STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@smb_bucket_3
 POSTHOOK: query: create table smb_bucket_3(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 1 BUCKETS STORED AS RCFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/smb_mapjoin_6.q.out b/ql/src/test/results/clientpositive/smb_mapjoin_6.q.out
index 0eee3edde2..bbf2b0b204 100644
--- a/ql/src/test/results/clientpositive/smb_mapjoin_6.q.out
+++ b/ql/src/test/results/clientpositive/smb_mapjoin_6.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE smb_bucket4_1(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@smb_bucket4_1
 POSTHOOK: query: CREATE TABLE smb_bucket4_1(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS RCFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@smb_bucket4_1
 PREHOOK: query: CREATE TABLE smb_bucket4_2(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@smb_bucket4_2
 POSTHOOK: query: CREATE TABLE smb_bucket4_2(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS STORED AS RCFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -15,6 +17,7 @@ POSTHOOK: Output: default@smb_bucket4_2
 PREHOOK: query: create table smb_join_results(k1 int, v1 string, k2 int, v2 string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@smb_join_results
 POSTHOOK: query: create table smb_join_results(k1 int, v1 string, k2 int, v2 string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -22,6 +25,7 @@ POSTHOOK: Output: default@smb_join_results
 PREHOOK: query: create table normal_join_results(k1 int, v1 string, k2 int, v2 string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@normal_join_results
 POSTHOOK: query: create table normal_join_results(k1 int, v1 string, k2 int, v2 string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/smb_mapjoin_7.q.out b/ql/src/test/results/clientpositive/smb_mapjoin_7.q.out
index a10978b977..d413ed3bbf 100644
--- a/ql/src/test/results/clientpositive/smb_mapjoin_7.q.out
+++ b/ql/src/test/results/clientpositive/smb_mapjoin_7.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE smb_bucket4_1(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@smb_bucket4_1
 POSTHOOK: query: CREATE TABLE smb_bucket4_1(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@smb_bucket4_1
 PREHOOK: query: CREATE TABLE smb_bucket4_2(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@smb_bucket4_2
 POSTHOOK: query: CREATE TABLE smb_bucket4_2(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -15,6 +17,7 @@ POSTHOOK: Output: default@smb_bucket4_2
 PREHOOK: query: create table smb_join_results(k1 int, v1 string, k2 int, v2 string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@smb_join_results
 POSTHOOK: query: create table smb_join_results(k1 int, v1 string, k2 int, v2 string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -22,6 +25,7 @@ POSTHOOK: Output: default@smb_join_results
 PREHOOK: query: create table smb_join_results_empty_bigtable(k1 int, v1 string, k2 int, v2 string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@smb_join_results_empty_bigtable
 POSTHOOK: query: create table smb_join_results_empty_bigtable(k1 int, v1 string, k2 int, v2 string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -29,6 +33,7 @@ POSTHOOK: Output: default@smb_join_results_empty_bigtable
 PREHOOK: query: create table normal_join_results(k1 int, v1 string, k2 int, v2 string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@normal_join_results
 POSTHOOK: query: create table normal_join_results(k1 int, v1 string, k2 int, v2 string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/smb_mapjoin_8.q.out b/ql/src/test/results/clientpositive/smb_mapjoin_8.q.out
index 94f9869c60..802f83964c 100644
--- a/ql/src/test/results/clientpositive/smb_mapjoin_8.q.out
+++ b/ql/src/test/results/clientpositive/smb_mapjoin_8.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table smb_bucket_input (key int, value string) stored as rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@smb_bucket_input
 POSTHOOK: query: create table smb_bucket_input (key int, value string) stored as rcfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -16,6 +17,7 @@ POSTHOOK: Output: default@smb_bucket_input
 PREHOOK: query: CREATE TABLE smb_bucket4_1(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 1 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@smb_bucket4_1
 POSTHOOK: query: CREATE TABLE smb_bucket4_1(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 1 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -23,6 +25,7 @@ POSTHOOK: Output: default@smb_bucket4_1
 PREHOOK: query: CREATE TABLE smb_bucket4_2(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 1 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@smb_bucket4_2
 POSTHOOK: query: CREATE TABLE smb_bucket4_2(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 1 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -30,6 +33,7 @@ POSTHOOK: Output: default@smb_bucket4_2
 PREHOOK: query: CREATE TABLE smb_bucket4_3(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 1 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@smb_bucket4_3
 POSTHOOK: query: CREATE TABLE smb_bucket4_3(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 1 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/sort_merge_join_desc_1.q.out b/ql/src/test/results/clientpositive/sort_merge_join_desc_1.q.out
index 7009535b33..539f247634 100644
--- a/ql/src/test/results/clientpositive/sort_merge_join_desc_1.q.out
+++ b/ql/src/test/results/clientpositive/sort_merge_join_desc_1.q.out
@@ -9,6 +9,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table table_desc1(key string, value string) clustered by (key) sorted by (key DESC) into 1 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table_desc1
 POSTHOOK: query: create table table_desc1(key string, value string) clustered by (key) sorted by (key DESC) into 1 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -16,6 +17,7 @@ POSTHOOK: Output: default@table_desc1
 PREHOOK: query: create table table_desc2(key string, value string) clustered by (key) sorted by (key DESC) into 1 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table_desc2
 POSTHOOK: query: create table table_desc2(key string, value string) clustered by (key) sorted by (key DESC) into 1 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/sort_merge_join_desc_2.q.out b/ql/src/test/results/clientpositive/sort_merge_join_desc_2.q.out
index f8cb20e90d..0000c23f50 100644
--- a/ql/src/test/results/clientpositive/sort_merge_join_desc_2.q.out
+++ b/ql/src/test/results/clientpositive/sort_merge_join_desc_2.q.out
@@ -10,6 +10,7 @@ PREHOOK: query: create table table_desc1(key string, value string) clustered by
 sorted by (key DESC, value DESC) into 1 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table_desc1
 POSTHOOK: query: create table table_desc1(key string, value string) clustered by (key, value)
 sorted by (key DESC, value DESC) into 1 BUCKETS
 POSTHOOK: type: CREATETABLE
@@ -19,6 +20,7 @@ PREHOOK: query: create table table_desc2(key string, value string) clustered by
 sorted by (key DESC, value DESC) into 1 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table_desc2
 POSTHOOK: query: create table table_desc2(key string, value string) clustered by (key, value)
 sorted by (key DESC, value DESC) into 1 BUCKETS
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/sort_merge_join_desc_3.q.out b/ql/src/test/results/clientpositive/sort_merge_join_desc_3.q.out
index add2bc5241..5631477775 100644
--- a/ql/src/test/results/clientpositive/sort_merge_join_desc_3.q.out
+++ b/ql/src/test/results/clientpositive/sort_merge_join_desc_3.q.out
@@ -10,6 +10,7 @@ PREHOOK: query: create table table_desc1(key string, value string) clustered by
 sorted by (key DESC, value ASC) into 1 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table_desc1
 POSTHOOK: query: create table table_desc1(key string, value string) clustered by (key, value)
 sorted by (key DESC, value ASC) into 1 BUCKETS
 POSTHOOK: type: CREATETABLE
@@ -19,6 +20,7 @@ PREHOOK: query: create table table_desc2(key string, value string) clustered by
 sorted by (key DESC, value ASC) into 1 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table_desc2
 POSTHOOK: query: create table table_desc2(key string, value string) clustered by (key, value)
 sorted by (key DESC, value ASC) into 1 BUCKETS
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/sort_merge_join_desc_4.q.out b/ql/src/test/results/clientpositive/sort_merge_join_desc_4.q.out
index 6daf6bc002..a0fbc2a72e 100644
--- a/ql/src/test/results/clientpositive/sort_merge_join_desc_4.q.out
+++ b/ql/src/test/results/clientpositive/sort_merge_join_desc_4.q.out
@@ -10,6 +10,7 @@ PREHOOK: query: create table table_desc1(key string, value string) clustered by
 sorted by (key DESC, value ASC) into 1 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table_desc1
 POSTHOOK: query: create table table_desc1(key string, value string) clustered by (key, value)
 sorted by (key DESC, value ASC) into 1 BUCKETS
 POSTHOOK: type: CREATETABLE
@@ -19,6 +20,7 @@ PREHOOK: query: create table table_desc2(key string, value string) clustered by
 sorted by (key DESC, value DESC) into 1 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table_desc2
 POSTHOOK: query: create table table_desc2(key string, value string) clustered by (key, value)
 sorted by (key DESC, value DESC) into 1 BUCKETS
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/sort_merge_join_desc_5.q.out b/ql/src/test/results/clientpositive/sort_merge_join_desc_5.q.out
index ba8928b825..dc76dff295 100644
--- a/ql/src/test/results/clientpositive/sort_merge_join_desc_5.q.out
+++ b/ql/src/test/results/clientpositive/sort_merge_join_desc_5.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: CREATE TABLE srcbucket_mapjoin_part_1 (key INT, value STRING) PA
 CLUSTERED BY (key) SORTED BY (key DESC) INTO 1 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcbucket_mapjoin_part_1
 POSTHOOK: query: CREATE TABLE srcbucket_mapjoin_part_1 (key INT, value STRING) PARTITIONED BY (part STRING) 
 CLUSTERED BY (key) SORTED BY (key DESC) INTO 1 BUCKETS
 POSTHOOK: type: CREATETABLE
@@ -21,6 +22,7 @@ PREHOOK: query: CREATE TABLE srcbucket_mapjoin_part_2 (key INT, value STRING) PA
 CLUSTERED BY (key) SORTED BY (key DESC) INTO 1 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcbucket_mapjoin_part_2
 POSTHOOK: query: CREATE TABLE srcbucket_mapjoin_part_2 (key INT, value STRING) PARTITIONED BY (part STRING) 
 CLUSTERED BY (key) SORTED BY (key DESC) INTO 1 BUCKETS
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/sort_merge_join_desc_6.q.out b/ql/src/test/results/clientpositive/sort_merge_join_desc_6.q.out
index d51a54e051..b41cf22e24 100644
--- a/ql/src/test/results/clientpositive/sort_merge_join_desc_6.q.out
+++ b/ql/src/test/results/clientpositive/sort_merge_join_desc_6.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: CREATE TABLE srcbucket_mapjoin_part_1 (key INT, value STRING) PA
 CLUSTERED BY (key) SORTED BY (key DESC) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcbucket_mapjoin_part_1
 POSTHOOK: query: CREATE TABLE srcbucket_mapjoin_part_1 (key INT, value STRING) PARTITIONED BY (part STRING) 
 CLUSTERED BY (key) SORTED BY (key DESC) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
@@ -21,6 +22,7 @@ PREHOOK: query: CREATE TABLE srcbucket_mapjoin_part_2 (key INT, value STRING) PA
 CLUSTERED BY (key) SORTED BY (value DESC) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcbucket_mapjoin_part_2
 POSTHOOK: query: CREATE TABLE srcbucket_mapjoin_part_2 (key INT, value STRING) PARTITIONED BY (part STRING) 
 CLUSTERED BY (key) SORTED BY (value DESC) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/sort_merge_join_desc_7.q.out b/ql/src/test/results/clientpositive/sort_merge_join_desc_7.q.out
index fcb63672e3..1354e2d478 100644
--- a/ql/src/test/results/clientpositive/sort_merge_join_desc_7.q.out
+++ b/ql/src/test/results/clientpositive/sort_merge_join_desc_7.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: CREATE TABLE srcbucket_mapjoin_part_1 (key INT, value STRING) PA
 CLUSTERED BY (key, value) SORTED BY (key DESC) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcbucket_mapjoin_part_1
 POSTHOOK: query: CREATE TABLE srcbucket_mapjoin_part_1 (key INT, value STRING) PARTITIONED BY (part STRING) 
 CLUSTERED BY (key, value) SORTED BY (key DESC) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
@@ -39,6 +40,7 @@ PREHOOK: query: CREATE TABLE srcbucket_mapjoin_part_2 (key INT, value STRING) PA
 CLUSTERED BY (key, value) SORTED BY (value DESC) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcbucket_mapjoin_part_2
 POSTHOOK: query: CREATE TABLE srcbucket_mapjoin_part_2 (key INT, value STRING) PARTITIONED BY (part STRING) 
 CLUSTERED BY (key, value) SORTED BY (value DESC) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/split.q.out b/ql/src/test/results/clientpositive/split.q.out
index ef4720ff78..a5a368eda8 100644
--- a/ql/src/test/results/clientpositive/split.q.out
+++ b/ql/src/test/results/clientpositive/split.q.out
@@ -6,6 +6,7 @@ PREHOOK: query: CREATE table tmp_jo_tab_test (message_line STRING)
 STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmp_jo_tab_test
 POSTHOOK: query: CREATE table tmp_jo_tab_test (message_line STRING)
 STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/stats0.q.out b/ql/src/test/results/clientpositive/stats0.q.out
index 712a4747c3..1d6e3f786a 100644
--- a/ql/src/test/results/clientpositive/stats0.q.out
+++ b/ql/src/test/results/clientpositive/stats0.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE stats_non_partitioned (key string, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@stats_non_partitioned
 POSTHOOK: query: CREATE TABLE stats_non_partitioned (key string, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -682,6 +683,7 @@ POSTHOOK: Input: default@stats_non_partitioned
 PREHOOK: query: CREATE TABLE stats_partitioned(key string, value string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@stats_partitioned
 POSTHOOK: query: CREATE TABLE stats_partitioned(key string, value string) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -1314,6 +1316,7 @@ POSTHOOK: Output: default@stats_partitioned
 PREHOOK: query: CREATE TABLE stats_non_partitioned (key string, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@stats_non_partitioned
 POSTHOOK: query: CREATE TABLE stats_non_partitioned (key string, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -2153,6 +2156,7 @@ POSTHOOK: Input: default@stats_non_partitioned
 PREHOOK: query: CREATE TABLE stats_partitioned(key string, value string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@stats_partitioned
 POSTHOOK: query: CREATE TABLE stats_partitioned(key string, value string) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/stats1.q.out b/ql/src/test/results/clientpositive/stats1.q.out
index d7bf559547..d0af917dcd 100644
--- a/ql/src/test/results/clientpositive/stats1.q.out
+++ b/ql/src/test/results/clientpositive/stats1.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table tmptable(key string, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmptable
 POSTHOOK: query: create table tmptable(key string, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/stats10.q.out b/ql/src/test/results/clientpositive/stats10.q.out
index d0a08db7cc..fef03598d0 100644
--- a/ql/src/test/results/clientpositive/stats10.q.out
+++ b/ql/src/test/results/clientpositive/stats10.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE bucket3_1(key int, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucket3_1
 POSTHOOK: query: CREATE TABLE bucket3_1(key int, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/stats11.q.out b/ql/src/test/results/clientpositive/stats11.q.out
index c5531c5ccc..ea0d5898fc 100644
--- a/ql/src/test/results/clientpositive/stats11.q.out
+++ b/ql/src/test/results/clientpositive/stats11.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE srcbucket_mapjoin(key int, value string) CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcbucket_mapjoin
 POSTHOOK: query: CREATE TABLE srcbucket_mapjoin(key int, value string) CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -24,6 +25,7 @@ POSTHOOK: Output: default@srcbucket_mapjoin
 PREHOOK: query: CREATE TABLE srcbucket_mapjoin_part (key int, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcbucket_mapjoin_part
 POSTHOOK: query: CREATE TABLE srcbucket_mapjoin_part (key int, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -254,6 +256,7 @@ Storage Desc Params:
 PREHOOK: query: CREATE TABLE srcbucket_mapjoin_part_2 (key int, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcbucket_mapjoin_part_2
 POSTHOOK: query: CREATE TABLE srcbucket_mapjoin_part_2 (key int, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -278,6 +281,7 @@ POSTHOOK: Output: default@srcbucket_mapjoin_part_2@ds=2008-04-08
 PREHOOK: query: create table bucketmapjoin_hash_result_1 (key bigint , value1 bigint, value2 bigint)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucketmapjoin_hash_result_1
 POSTHOOK: query: create table bucketmapjoin_hash_result_1 (key bigint , value1 bigint, value2 bigint)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -285,6 +289,7 @@ POSTHOOK: Output: default@bucketmapjoin_hash_result_1
 PREHOOK: query: create table bucketmapjoin_hash_result_2 (key bigint , value1 bigint, value2 bigint)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucketmapjoin_hash_result_2
 POSTHOOK: query: create table bucketmapjoin_hash_result_2 (key bigint , value1 bigint, value2 bigint)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -292,6 +297,7 @@ POSTHOOK: Output: default@bucketmapjoin_hash_result_2
 PREHOOK: query: create table bucketmapjoin_tmp_result (key string , value1 string, value2 string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucketmapjoin_tmp_result
 POSTHOOK: query: create table bucketmapjoin_tmp_result (key string , value1 string, value2 string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/stats12.q.out b/ql/src/test/results/clientpositive/stats12.q.out
index 7afa17cbc8..2588380feb 100644
--- a/ql/src/test/results/clientpositive/stats12.q.out
+++ b/ql/src/test/results/clientpositive/stats12.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table analyze_srcpart like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@analyze_srcpart
 POSTHOOK: query: create table analyze_srcpart like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/stats13.q.out b/ql/src/test/results/clientpositive/stats13.q.out
index 3034b15c4c..f72e310835 100644
--- a/ql/src/test/results/clientpositive/stats13.q.out
+++ b/ql/src/test/results/clientpositive/stats13.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table analyze_srcpart like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@analyze_srcpart
 POSTHOOK: query: create table analyze_srcpart like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -342,6 +343,7 @@ Storage Desc Params:
 PREHOOK: query: create table analyze_srcpart2 like analyze_srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@analyze_srcpart2
 POSTHOOK: query: create table analyze_srcpart2 like analyze_srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/stats14.q.out b/ql/src/test/results/clientpositive/stats14.q.out
index 80e1c6de2c..f12b1367aa 100644
--- a/ql/src/test/results/clientpositive/stats14.q.out
+++ b/ql/src/test/results/clientpositive/stats14.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table stats_src like src
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@stats_src
 POSTHOOK: query: create table stats_src like src
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -62,6 +63,7 @@ Storage Desc Params:
 PREHOOK: query: create table stats_part like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@stats_part
 POSTHOOK: query: create table stats_part like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/stats15.q.out b/ql/src/test/results/clientpositive/stats15.q.out
index 5dcbc5ae7f..a60dee2473 100644
--- a/ql/src/test/results/clientpositive/stats15.q.out
+++ b/ql/src/test/results/clientpositive/stats15.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table stats_src like src
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@stats_src
 POSTHOOK: query: create table stats_src like src
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -62,6 +63,7 @@ Storage Desc Params:
 PREHOOK: query: create table stats_part like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@stats_part
 POSTHOOK: query: create table stats_part like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/stats16.q.out b/ql/src/test/results/clientpositive/stats16.q.out
index c21b607f0e..3f0f2ea1d4 100644
--- a/ql/src/test/results/clientpositive/stats16.q.out
+++ b/ql/src/test/results/clientpositive/stats16.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table stats16 (key int, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@stats16
 POSTHOOK: query: create table stats16 (key int, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/stats18.q.out b/ql/src/test/results/clientpositive/stats18.q.out
index be213d3d33..a0618466db 100644
--- a/ql/src/test/results/clientpositive/stats18.q.out
+++ b/ql/src/test/results/clientpositive/stats18.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table stats_part like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@stats_part
 POSTHOOK: query: create table stats_part like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/stats19.q.out b/ql/src/test/results/clientpositive/stats19.q.out
index 39094f282e..499a8bd391 100644
--- a/ql/src/test/results/clientpositive/stats19.q.out
+++ b/ql/src/test/results/clientpositive/stats19.q.out
@@ -6,6 +6,7 @@ PREHOOK: query: -- Note, its important that the partitions created below have a
 create table stats_part like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@stats_part
 POSTHOOK: query: -- Note, its important that the partitions created below have a name greater than 16 characters in
 -- length since KeyVerifyingStatsAggregator depends on checking that a keyPrefix is hashed by the
 -- length of the keyPrefix, having a partition name greather than 16 characters guarantees no false
diff --git a/ql/src/test/results/clientpositive/stats2.q.out b/ql/src/test/results/clientpositive/stats2.q.out
index 4cb1b5986f..824b418fa5 100644
--- a/ql/src/test/results/clientpositive/stats2.q.out
+++ b/ql/src/test/results/clientpositive/stats2.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table analyze_t1 like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@analyze_t1
 POSTHOOK: query: create table analyze_t1 like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/stats20.q.out b/ql/src/test/results/clientpositive/stats20.q.out
index b128394172..4ac7bc5ceb 100644
--- a/ql/src/test/results/clientpositive/stats20.q.out
+++ b/ql/src/test/results/clientpositive/stats20.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE stats_partitioned(key string, value string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@stats_partitioned
 POSTHOOK: query: CREATE TABLE stats_partitioned(key string, value string) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/stats3.q.out b/ql/src/test/results/clientpositive/stats3.q.out
index 30292c63d4..dd3a95b587 100644
--- a/ql/src/test/results/clientpositive/stats3.q.out
+++ b/ql/src/test/results/clientpositive/stats3.q.out
@@ -9,6 +9,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table hive_test_src ( col1 string ) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@hive_test_src
 POSTHOOK: query: create table hive_test_src ( col1 string ) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -106,6 +107,7 @@ Storage Desc Params:
 PREHOOK: query: create table hive_test_dst ( col1 string ) partitioned by ( pcol1 string , pcol2 string) stored as sequencefile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@hive_test_dst
 POSTHOOK: query: create table hive_test_dst ( col1 string ) partitioned by ( pcol1 string , pcol2 string) stored as sequencefile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/stats4.q.out b/ql/src/test/results/clientpositive/stats4.q.out
index 99305bf8fb..b52f3aec66 100644
--- a/ql/src/test/results/clientpositive/stats4.q.out
+++ b/ql/src/test/results/clientpositive/stats4.q.out
@@ -23,6 +23,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table if not exists nzhang_part1 like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@nzhang_part1
 POSTHOOK: query: create table if not exists nzhang_part1 like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -30,6 +31,7 @@ POSTHOOK: Output: default@nzhang_part1
 PREHOOK: query: create table if not exists nzhang_part2 like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@nzhang_part2
 POSTHOOK: query: create table if not exists nzhang_part2 like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/stats6.q.out b/ql/src/test/results/clientpositive/stats6.q.out
index 66e399ffa8..b4435f2ca3 100644
--- a/ql/src/test/results/clientpositive/stats6.q.out
+++ b/ql/src/test/results/clientpositive/stats6.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table analyze_srcpart like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@analyze_srcpart
 POSTHOOK: query: create table analyze_srcpart like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/stats7.q.out b/ql/src/test/results/clientpositive/stats7.q.out
index 1d340325b7..097546b274 100644
--- a/ql/src/test/results/clientpositive/stats7.q.out
+++ b/ql/src/test/results/clientpositive/stats7.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table analyze_srcpart like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@analyze_srcpart
 POSTHOOK: query: create table analyze_srcpart like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/stats8.q.out b/ql/src/test/results/clientpositive/stats8.q.out
index 31201b380e..ae5040b214 100644
--- a/ql/src/test/results/clientpositive/stats8.q.out
+++ b/ql/src/test/results/clientpositive/stats8.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table analyze_srcpart like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@analyze_srcpart
 POSTHOOK: query: create table analyze_srcpart like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/stats9.q.out b/ql/src/test/results/clientpositive/stats9.q.out
index a52f356c24..8563f3befa 100644
--- a/ql/src/test/results/clientpositive/stats9.q.out
+++ b/ql/src/test/results/clientpositive/stats9.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table analyze_srcbucket like srcbucket
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@analyze_srcbucket
 POSTHOOK: query: create table analyze_srcbucket like srcbucket
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/stats_aggregator_error_1.q.out b/ql/src/test/results/clientpositive/stats_aggregator_error_1.q.out
index 5ccc175f5f..4c34ebf98a 100644
--- a/ql/src/test/results/clientpositive/stats_aggregator_error_1.q.out
+++ b/ql/src/test/results/clientpositive/stats_aggregator_error_1.q.out
@@ -7,6 +7,7 @@ PREHOOK: query: -- In this test, there is a dummy stats aggregator which throws
 create table tmptable(key string, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmptable
 POSTHOOK: query: -- In this test, there is a dummy stats aggregator which throws an error when various
 -- methods are called (as indicated by the parameter hive.test.dummystats.aggregator)
 -- Since stats need not be reliable (by setting hive.stats.reliable to false), the 
diff --git a/ql/src/test/results/clientpositive/stats_counter_partitioned.q.out b/ql/src/test/results/clientpositive/stats_counter_partitioned.q.out
index 8bdc2ec35f..ab1270c712 100644
--- a/ql/src/test/results/clientpositive/stats_counter_partitioned.q.out
+++ b/ql/src/test/results/clientpositive/stats_counter_partitioned.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- partitioned table analyze
 create table dummy (key string, value string) partitioned by (ds string, hr string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dummy
 POSTHOOK: query: -- partitioned table analyze 
 
 create table dummy (key string, value string) partitioned by (ds string, hr string)
@@ -140,6 +141,7 @@ PREHOOK: query: -- static partitioned table on insert
 create table dummy (key string, value string) partitioned by (ds string, hr string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dummy
 POSTHOOK: query: -- static partitioned table on insert
 
 create table dummy (key string, value string) partitioned by (ds string, hr string)
@@ -263,6 +265,7 @@ PREHOOK: query: -- dynamic partitioned table on insert
 create table dummy (key int) partitioned by (hr int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dummy
 POSTHOOK: query: -- dynamic partitioned table on insert
 
 create table dummy (key int) partitioned by (hr int)
@@ -272,6 +275,7 @@ POSTHOOK: Output: default@dummy
 PREHOOK: query: CREATE TABLE tbl(key int, value int) ROW FORMAT DELIMITED FIELDS TERMINATED BY '|'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl
 POSTHOOK: query: CREATE TABLE tbl(key int, value int) ROW FORMAT DELIMITED FIELDS TERMINATED BY '|'
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/stats_empty_dyn_part.q.out b/ql/src/test/results/clientpositive/stats_empty_dyn_part.q.out
index 6f76283bae..23fdda7d3e 100644
--- a/ql/src/test/results/clientpositive/stats_empty_dyn_part.q.out
+++ b/ql/src/test/results/clientpositive/stats_empty_dyn_part.q.out
@@ -5,6 +5,7 @@ PREHOOK: query: -- This test verifies writing a query using dynamic partitions
 create table tmptable(key string) partitioned by (part string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmptable
 POSTHOOK: query: -- This test verifies writing a query using dynamic partitions
 -- which results in no partitions actually being created with
 -- hive.stats.reliable set to true
diff --git a/ql/src/test/results/clientpositive/stats_empty_partition.q.out b/ql/src/test/results/clientpositive/stats_empty_partition.q.out
index f201772c51..65e0a6fbaa 100644
--- a/ql/src/test/results/clientpositive/stats_empty_partition.q.out
+++ b/ql/src/test/results/clientpositive/stats_empty_partition.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: -- This test verifies that writing an empty partition succeeds w
 create table tmptable(key string, value string) partitioned by (part string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmptable
 POSTHOOK: query: -- This test verifies that writing an empty partition succeeds when
 -- hive.stats.reliable is set to true.
 
diff --git a/ql/src/test/results/clientpositive/stats_invalidation.q.out b/ql/src/test/results/clientpositive/stats_invalidation.q.out
index 2b81914997..f8c1731cff 100644
--- a/ql/src/test/results/clientpositive/stats_invalidation.q.out
+++ b/ql/src/test/results/clientpositive/stats_invalidation.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE stats_invalid (key string, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@stats_invalid
 POSTHOOK: query: CREATE TABLE stats_invalid (key string, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/stats_list_bucket.q.out b/ql/src/test/results/clientpositive/stats_list_bucket.q.out
index 0ce0ceaed5..8f68e8b607 100644
--- a/ql/src/test/results/clientpositive/stats_list_bucket.q.out
+++ b/ql/src/test/results/clientpositive/stats_list_bucket.q.out
@@ -19,6 +19,7 @@ stored as directories
 stored as rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@stats_list_bucket
 POSTHOOK: query: create table stats_list_bucket (
   c1 string,
   c2 string
@@ -108,6 +109,7 @@ stored as directories
 stored as rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@stats_list_bucket_1
 POSTHOOK: query: -- Also try non-partitioned table with list bucketing.
 -- Stats should show the same number of rows.
 
diff --git a/ql/src/test/results/clientpositive/stats_noscan_1.q.out b/ql/src/test/results/clientpositive/stats_noscan_1.q.out
index d1f13d1fe8..80c30923e4 100644
--- a/ql/src/test/results/clientpositive/stats_noscan_1.q.out
+++ b/ql/src/test/results/clientpositive/stats_noscan_1.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: -- test analyze table ... compute statistics noscan
 create table analyze_srcpart like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@analyze_srcpart
 POSTHOOK: query: -- test analyze table ... compute statistics noscan
 
 -- 1. test full spec
@@ -294,6 +295,7 @@ PREHOOK: query: -- 2. test partial spec
 create table analyze_srcpart_partial like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@analyze_srcpart_partial
 POSTHOOK: query: -- 2. test partial spec
 create table analyze_srcpart_partial like srcpart
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/stats_noscan_2.q.out b/ql/src/test/results/clientpositive/stats_noscan_2.q.out
index d5ee5a746e..238727ded7 100644
--- a/ql/src/test/results/clientpositive/stats_noscan_2.q.out
+++ b/ql/src/test/results/clientpositive/stats_noscan_2.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: -- test analyze table compute statistiscs [noscan] on external t
 PREHOOK: type: CREATETABLE
 #### A masked pattern was here ####
 PREHOOK: Output: database:default
+PREHOOK: Output: default@anaylyze_external
 POSTHOOK: query: -- test analyze table compute statistiscs [noscan] on external table 
 -- 1 test table
 #### A masked pattern was here ####
@@ -126,6 +127,7 @@ PREHOOK: query: -- 2 test partition
 create table texternal(key string, val string) partitioned by (insertdate string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@texternal
 POSTHOOK: query: -- 2 test partition
 -- prepare data
 create table texternal(key string, val string) partitioned by (insertdate string)
@@ -167,6 +169,7 @@ PREHOOK: query: -- create external table
 PREHOOK: type: CREATETABLE
 #### A masked pattern was here ####
 PREHOOK: Output: database:default
+PREHOOK: Output: default@anaylyze_external
 POSTHOOK: query: -- create external table
 #### A masked pattern was here ####
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/stats_only_null.q.out b/ql/src/test/results/clientpositive/stats_only_null.q.out
index 6e6d2c260b..063da37aaa 100644
--- a/ql/src/test/results/clientpositive/stats_only_null.q.out
+++ b/ql/src/test/results/clientpositive/stats_only_null.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE temps_null(a double, b int, c STRING, d smallint) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@temps_null
 POSTHOOK: query: CREATE TABLE temps_null(a double, b int, c STRING, d smallint) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@temps_null
 PREHOOK: query: CREATE TABLE stats_null(a double, b int, c STRING, d smallint) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@stats_null
 POSTHOOK: query: CREATE TABLE stats_null(a double, b int, c STRING, d smallint) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -15,6 +17,7 @@ POSTHOOK: Output: default@stats_null
 PREHOOK: query: CREATE TABLE stats_null_part(a double, b int, c STRING, d smallint) partitioned by (dt string) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@stats_null_part
 POSTHOOK: query: CREATE TABLE stats_null_part(a double, b int, c STRING, d smallint) partitioned by (dt string) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/stats_partscan_1_23.q.out b/ql/src/test/results/clientpositive/stats_partscan_1_23.q.out
index dc1baf18c0..548893525e 100644
--- a/ql/src/test/results/clientpositive/stats_partscan_1_23.q.out
+++ b/ql/src/test/results/clientpositive/stats_partscan_1_23.q.out
@@ -11,6 +11,7 @@ partitioned by (ds string, hr string)
 stored as rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@analyze_srcpart_partial_scan
 POSTHOOK: query: -- INCLUDE_HADOOP_MAJOR_VERSIONS(0.23)
 -- This test uses mapred.max.split.size/mapred.max.split.size for controlling
 -- number of input splits.
diff --git a/ql/src/test/results/clientpositive/stats_publisher_error_1.q.out b/ql/src/test/results/clientpositive/stats_publisher_error_1.q.out
index 16ce5e7df7..01632f4775 100644
--- a/ql/src/test/results/clientpositive/stats_publisher_error_1.q.out
+++ b/ql/src/test/results/clientpositive/stats_publisher_error_1.q.out
@@ -7,6 +7,7 @@ PREHOOK: query: -- In this test, there is a dummy stats publisher which throws a
 create table tmptable(key string, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmptable
 POSTHOOK: query: -- In this test, there is a dummy stats publisher which throws an error when various
 -- methods are called (as indicated by the parameter hive.test.dummystats.publisher)
 -- Since stats need not be reliable (by setting hive.stats.reliable to false), the
diff --git a/ql/src/test/results/clientpositive/statsfs.q.out b/ql/src/test/results/clientpositive/statsfs.q.out
index e89c4b2514..b0bca41708 100644
--- a/ql/src/test/results/clientpositive/statsfs.q.out
+++ b/ql/src/test/results/clientpositive/statsfs.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- stats computation on partitioned table with analyze command
 create table t1 (key string, value string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t1
 POSTHOOK: query: -- stats computation on partitioned table with analyze command
 
 create table t1 (key string, value string) partitioned by (ds string)
@@ -138,6 +139,7 @@ PREHOOK: query: -- stats computation on partitioned table with autogather on ins
 create table t1 (key string, value string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t1
 POSTHOOK: query: -- stats computation on partitioned table with autogather on insert query
 
 create table t1 (key string, value string) partitioned by (ds string)
@@ -259,6 +261,7 @@ PREHOOK: query: -- analyze stmt on unpartitioned table
 create table t1 (key string, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t1
 POSTHOOK: query: -- analyze stmt on unpartitioned table
 
 create table t1 (key string, value string)
@@ -330,6 +333,7 @@ PREHOOK: query: -- stats computation on unpartitioned table with autogather on i
 create table t1 (key string, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t1
 POSTHOOK: query: -- stats computation on unpartitioned table with autogather on insert query
 
 create table t1 (key string, value string)
@@ -396,6 +400,7 @@ PREHOOK: query: -- stats computation on partitioned table with autogather on ins
 create table t1 (key string, value string) partitioned by (ds string, hr string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t1
 POSTHOOK: query: -- stats computation on partitioned table with autogather on insert query with dynamic partitioning
 
 
diff --git a/ql/src/test/results/clientpositive/storage_format_descriptor.q.out b/ql/src/test/results/clientpositive/storage_format_descriptor.q.out
index a1ee54bfb1..4b728da607 100644
--- a/ql/src/test/results/clientpositive/storage_format_descriptor.q.out
+++ b/ql/src/test/results/clientpositive/storage_format_descriptor.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: CREATE TABLE stored_as_custom_text_serde(key string, value string) STORED AS customtextserde
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@stored_as_custom_text_serde
 POSTHOOK: query: CREATE TABLE stored_as_custom_text_serde(key string, value string) STORED AS customtextserde
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/subquery_in.q.out b/ql/src/test/results/clientpositive/subquery_in.q.out
index 6ceeb167fe..9634f67036 100644
--- a/ql/src/test/results/clientpositive/subquery_in.q.out
+++ b/ql/src/test/results/clientpositive/subquery_in.q.out
@@ -20,6 +20,7 @@ CREATE TABLE part(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part
 POSTHOOK: query: -- data setup
 CREATE TABLE part( 
     p_partkey INT,
@@ -67,6 +68,7 @@ ROW FORMAT DELIMITED
 FIELDS TERMINATED BY '|'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@lineitem
 POSTHOOK: query: CREATE TABLE lineitem (L_ORDERKEY      INT,
                                 L_PARTKEY       INT,
                                 L_SUPPKEY       INT,
diff --git a/ql/src/test/results/clientpositive/subquery_in_explain_rewrite.q.out b/ql/src/test/results/clientpositive/subquery_in_explain_rewrite.q.out
index 9a09fa8570..e56c96ee24 100644
--- a/ql/src/test/results/clientpositive/subquery_in_explain_rewrite.q.out
+++ b/ql/src/test/results/clientpositive/subquery_in_explain_rewrite.q.out
@@ -16,6 +16,7 @@ CREATE TABLE part(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part
 POSTHOOK: query: -- data setup
 CREATE TABLE part( 
     p_partkey INT,
@@ -55,6 +56,7 @@ ROW FORMAT DELIMITED
 FIELDS TERMINATED BY '|'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@lineitem
 POSTHOOK: query: CREATE TABLE lineitem (L_ORDERKEY      INT,
                                 L_PARTKEY       INT,
                                 L_SUPPKEY       INT,
diff --git a/ql/src/test/results/clientpositive/subquery_in_having.q.out b/ql/src/test/results/clientpositive/subquery_in_having.q.out
index 8eae55f9ac..32d47b5056 100644
--- a/ql/src/test/results/clientpositive/subquery_in_having.q.out
+++ b/ql/src/test/results/clientpositive/subquery_in_having.q.out
@@ -14,6 +14,7 @@ CREATE TABLE part(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 -- data setup
diff --git a/ql/src/test/results/clientpositive/subquery_multiinsert.q.out b/ql/src/test/results/clientpositive/subquery_multiinsert.q.out
index 1f1ec9d57e..5887c78b7d 100644
--- a/ql/src/test/results/clientpositive/subquery_multiinsert.q.out
+++ b/ql/src/test/results/clientpositive/subquery_multiinsert.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: CREATE TABLE src_4(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_4
 POSTHOOK: query: CREATE TABLE src_4(
   key STRING, 
   value STRING
@@ -18,6 +19,7 @@ PREHOOK: query: CREATE TABLE src_5(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_5
 POSTHOOK: query: CREATE TABLE src_5( 
   key STRING, 
   value STRING
diff --git a/ql/src/test/results/clientpositive/subquery_notin.q.out b/ql/src/test/results/clientpositive/subquery_notin.q.out
index 22cb1ac982..924dcf7660 100644
--- a/ql/src/test/results/clientpositive/subquery_notin.q.out
+++ b/ql/src/test/results/clientpositive/subquery_notin.q.out
@@ -16,6 +16,7 @@ CREATE TABLE part(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part
 POSTHOOK: query: -- data setup
 CREATE TABLE part( 
     p_partkey INT,
@@ -63,6 +64,7 @@ ROW FORMAT DELIMITED
 FIELDS TERMINATED BY '|'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@lineitem
 POSTHOOK: query: CREATE TABLE lineitem (L_ORDERKEY      INT,
                                 L_PARTKEY       INT,
                                 L_SUPPKEY       INT,
diff --git a/ql/src/test/results/clientpositive/subquery_notin_having.q.out b/ql/src/test/results/clientpositive/subquery_notin_having.q.out
index 55b6b711b4..a862121a5c 100644
--- a/ql/src/test/results/clientpositive/subquery_notin_having.q.out
+++ b/ql/src/test/results/clientpositive/subquery_notin_having.q.out
@@ -16,6 +16,7 @@ CREATE TABLE part(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part
 POSTHOOK: query: -- data setup
 CREATE TABLE part( 
     p_partkey INT,
diff --git a/ql/src/test/results/clientpositive/subquery_unqualcolumnrefs.q.out b/ql/src/test/results/clientpositive/subquery_unqualcolumnrefs.q.out
index 548d21448f..a34dae6491 100644
--- a/ql/src/test/results/clientpositive/subquery_unqualcolumnrefs.q.out
+++ b/ql/src/test/results/clientpositive/subquery_unqualcolumnrefs.q.out
@@ -16,6 +16,7 @@ CREATE TABLE part(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part
 POSTHOOK: query: -- data setup
 CREATE TABLE part( 
     p_partkey INT,
@@ -34,6 +35,7 @@ POSTHOOK: Output: default@part
 PREHOOK: query: create table src11 (key1 string, value1 string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src11
 POSTHOOK: query: create table src11 (key1 string, value1 string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -51,6 +53,7 @@ PREHOOK: query: create table part2(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part2
 POSTHOOK: query: create table part2( 
     p2_partkey INT,
     p2_name STRING,
diff --git a/ql/src/test/results/clientpositive/symlink_text_input_format.q.out b/ql/src/test/results/clientpositive/symlink_text_input_format.q.out
index 33981865b3..65d9a894e6 100644
--- a/ql/src/test/results/clientpositive/symlink_text_input_format.q.out
+++ b/ql/src/test/results/clientpositive/symlink_text_input_format.q.out
@@ -23,6 +23,7 @@ STAGE PLANS:
 PREHOOK: query: CREATE TABLE symlink_text_input_format (key STRING, value STRING) STORED AS INPUTFORMAT 'org.apache.hadoop.hive.ql.io.SymlinkTextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@symlink_text_input_format
 POSTHOOK: query: CREATE TABLE symlink_text_input_format (key STRING, value STRING) STORED AS INPUTFORMAT 'org.apache.hadoop.hive.ql.io.SymlinkTextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.IgnoreKeyTextOutputFormat'
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/table_access_keys_stats.q.out b/ql/src/test/results/clientpositive/table_access_keys_stats.q.out
index ca39c7a56a..adea0f6c3a 100644
--- a/ql/src/test/results/clientpositive/table_access_keys_stats.q.out
+++ b/ql/src/test/results/clientpositive/table_access_keys_stats.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- This test is used for testing the TableAccessAnalyzer
 CREATE TABLE T1(key STRING, val STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 PREHOOK: query: LOAD DATA LOCAL INPATH '../../data/files/T1.txt' INTO TABLE T1
 PREHOOK: type: LOAD
 #### A masked pattern was here ####
@@ -10,9 +11,11 @@ PREHOOK: Output: default@t1
 PREHOOK: query: CREATE TABLE T2(key STRING, val STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T2
 PREHOOK: query: CREATE TABLE T3(key STRING, val STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T3
 PREHOOK: query: -- Simple group-by queries
 SELECT key, count(1) FROM T1 GROUP BY key
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/tablename_with_select.q.out b/ql/src/test/results/clientpositive/tablename_with_select.q.out
index a9181e5bf2..5827420be1 100644
--- a/ql/src/test/results/clientpositive/tablename_with_select.q.out
+++ b/ql/src/test/results/clientpositive/tablename_with_select.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE tmp_select(a INT, b STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmp_select
 POSTHOOK: query: CREATE TABLE tmp_select(a INT, b STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/temp_table.q.out b/ql/src/test/results/clientpositive/temp_table.q.out
index 150101ea72..b2dc8b33c5 100644
--- a/ql/src/test/results/clientpositive/temp_table.q.out
+++ b/ql/src/test/results/clientpositive/temp_table.q.out
@@ -357,6 +357,7 @@ POSTHOOK: Input: default@foo
 PREHOOK: query: CREATE TEMPORARY TABLE baz LIKE foo
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@baz
 POSTHOOK: query: CREATE TEMPORARY TABLE baz LIKE foo
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -374,6 +375,7 @@ POSTHOOK: Lineage: baz.value SIMPLE [(foo)foo.FieldSchema(name:value, type:strin
 PREHOOK: query: CREATE TEMPORARY TABLE bay (key string, value string) STORED AS orc
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bay
 POSTHOOK: query: CREATE TEMPORARY TABLE bay (key string, value string) STORED AS orc
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -433,12 +435,16 @@ srcbucket2
 srcpart
 PREHOOK: query: CREATE DATABASE two
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:two
 POSTHOOK: query: CREATE DATABASE two
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:two
 PREHOOK: query: USE two
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:two
 POSTHOOK: query: USE two
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:two
 PREHOOK: query: SHOW TABLES
 PREHOOK: type: SHOWTABLES
 POSTHOOK: query: SHOW TABLES
@@ -457,8 +463,10 @@ POSTHOOK: type: SHOWTABLES
 foo
 PREHOOK: query: use default
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:default
 POSTHOOK: query: use default
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:default
 PREHOOK: query: DROP DATABASE two CASCADE
 PREHOOK: type: DROPDATABASE
 PREHOOK: Input: database:two
diff --git a/ql/src/test/results/clientpositive/temp_table_external.q.out b/ql/src/test/results/clientpositive/temp_table_external.q.out
index 9973bce2c5..001cd98f49 100644
--- a/ql/src/test/results/clientpositive/temp_table_external.q.out
+++ b/ql/src/test/results/clientpositive/temp_table_external.q.out
@@ -3,6 +3,7 @@ Found 1 items
 PREHOOK: type: CREATETABLE
 #### A masked pattern was here ####
 PREHOOK: Output: database:default
+PREHOOK: Output: default@temp_table_external
 #### A masked pattern was here ####
 POSTHOOK: type: CREATETABLE
 #### A masked pattern was here ####
diff --git a/ql/src/test/results/clientpositive/temp_table_gb1.q.out b/ql/src/test/results/clientpositive/temp_table_gb1.q.out
index f3032e0661..eaaf561005 100644
--- a/ql/src/test/results/clientpositive/temp_table_gb1.q.out
+++ b/ql/src/test/results/clientpositive/temp_table_gb1.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- Taken from groupby2.q
 CREATE TABLE dest_g2(key STRING, c1 INT, c2 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_g2
 POSTHOOK: query: -- Taken from groupby2.q
 CREATE TABLE dest_g2(key STRING, c1 INT, c2 STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/temp_table_names.q.out b/ql/src/test/results/clientpositive/temp_table_names.q.out
index 1e0f973c3b..7c79777404 100644
--- a/ql/src/test/results/clientpositive/temp_table_names.q.out
+++ b/ql/src/test/results/clientpositive/temp_table_names.q.out
@@ -1,10 +1,12 @@
 PREHOOK: query: -- Test temp tables with upper/lower case names
 create temporary table Default.Temp_Table_Names (C1 string, c2 string)
 PREHOOK: type: CREATETABLE
+PREHOOK: Output: Default@Default.Temp_Table_Names
 PREHOOK: Output: database:default
 POSTHOOK: query: -- Test temp tables with upper/lower case names
 create temporary table Default.Temp_Table_Names (C1 string, c2 string)
 POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: Default@Default.Temp_Table_Names
 POSTHOOK: Output: Default@Temp_Table_Names
 POSTHOOK: Output: database:default
 PREHOOK: query: show tables 'Temp_Table*'
diff --git a/ql/src/test/results/clientpositive/temp_table_options1.q.out b/ql/src/test/results/clientpositive/temp_table_options1.q.out
index 994681f2c3..01cc978e9f 100644
--- a/ql/src/test/results/clientpositive/temp_table_options1.q.out
+++ b/ql/src/test/results/clientpositive/temp_table_options1.q.out
@@ -6,6 +6,7 @@ lines terminated by '\n'
 stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@impressions
 POSTHOOK: query: -- Delimiter test, taken from delimiter.q
 create temporary table impressions (imp string, msg string)
 row format delimited
@@ -72,6 +73,7 @@ with serdeproperties (
 stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@date_serde_regex
 POSTHOOK: query: -- Try different SerDe formats, taken from date_serde.q
 
 --
@@ -274,6 +276,7 @@ create temporary table date_serde_lb (
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@date_serde_lb
 POSTHOOK: query: --
 -- LazyBinary
 --
@@ -331,6 +334,7 @@ create temporary table date_serde_ls (
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@date_serde_ls
 POSTHOOK: query: --
 -- LazySimple
 --
@@ -388,6 +392,7 @@ create temporary table date_serde_c (
 ) stored as rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@date_serde_c
 POSTHOOK: query: --
 -- Columnar
 --
@@ -445,6 +450,7 @@ create temporary table date_serde_lbc (
 ) stored as rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@date_serde_lbc
 POSTHOOK: query: --
 -- LazyBinaryColumnar
 --
@@ -502,6 +508,7 @@ create temporary table date_serde_orc (
 ) stored as orc
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@date_serde_orc
 POSTHOOK: query: --
 -- ORC
 --
diff --git a/ql/src/test/results/clientpositive/temp_table_precedence.q.out b/ql/src/test/results/clientpositive/temp_table_precedence.q.out
index 8574c2dabd..b4b003e18e 100644
--- a/ql/src/test/results/clientpositive/temp_table_precedence.q.out
+++ b/ql/src/test/results/clientpositive/temp_table_precedence.q.out
@@ -1,16 +1,20 @@
 PREHOOK: query: create database ttp
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:ttp
 POSTHOOK: query: create database ttp
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:ttp
 PREHOOK: query: -- Create non-temp tables
 create table ttp.tab1 (a1 string, a2 string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:ttp
+PREHOOK: Output: ttp@ttp.tab1
 POSTHOOK: query: -- Create non-temp tables
 create table ttp.tab1 (a1 string, a2 string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:ttp
 POSTHOOK: Output: ttp@tab1
+POSTHOOK: Output: ttp@ttp.tab1
 PREHOOK: query: insert overwrite table ttp.tab1 select * from src where key = 5 limit 5
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
@@ -43,10 +47,12 @@ POSTHOOK: Input: ttp@tab1
 PREHOOK: query: create table ttp.tab2 (b1 string, b2 string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:ttp
+PREHOOK: Output: ttp@ttp.tab2
 POSTHOOK: query: create table ttp.tab2 (b1 string, b2 string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:ttp
 POSTHOOK: Output: ttp@tab2
+POSTHOOK: Output: ttp@ttp.tab2
 PREHOOK: query: insert overwrite table ttp.tab2 select * from src where key = 2 limit 5
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
@@ -78,11 +84,13 @@ PREHOOK: query: -- Now create temp table with same name
 create temporary table ttp.tab1 (c1 int, c2 string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:ttp
+PREHOOK: Output: ttp@ttp.tab1
 POSTHOOK: query: -- Now create temp table with same name
 create temporary table ttp.tab1 (c1 int, c2 string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:ttp
 POSTHOOK: Output: ttp@tab1
+POSTHOOK: Output: ttp@ttp.tab1
 PREHOOK: query: insert overwrite table ttp.tab1 select * from src where key = 0 limit 5
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
@@ -117,9 +125,11 @@ POSTHOOK: Input: ttp@tab1
 PREHOOK: query: -- rename the temp table, and now we can see our non-temp table again
 use ttp
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:ttp
 POSTHOOK: query: -- rename the temp table, and now we can see our non-temp table again
 use ttp
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:ttp
 PREHOOK: query: alter table tab1 rename to tab2
 PREHOOK: type: ALTERTABLE_RENAME
 PREHOOK: Input: ttp@tab1
@@ -131,8 +141,10 @@ POSTHOOK: Output: ttp@tab1
 POSTHOOK: Output: ttp@tab2
 PREHOOK: query: use default
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:default
 POSTHOOK: query: use default
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:default
 PREHOOK: query: describe ttp.tab1
 PREHOOK: type: DESCTABLE
 PREHOOK: Input: ttp@tab1
diff --git a/ql/src/test/results/clientpositive/temp_table_windowing_expressions.q.out b/ql/src/test/results/clientpositive/temp_table_windowing_expressions.q.out
index b6996b4f78..241db10160 100644
--- a/ql/src/test/results/clientpositive/temp_table_windowing_expressions.q.out
+++ b/ql/src/test/results/clientpositive/temp_table_windowing_expressions.q.out
@@ -16,6 +16,7 @@ CREATE TEMPORARY TABLE part(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part
 POSTHOOK: query: -- data setup
 CREATE TEMPORARY TABLE part( 
     p_partkey INT,
@@ -59,6 +60,7 @@ PREHOOK: query: create temporary table over10k(
        fields terminated by '|'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@over10k
 POSTHOOK: query: create temporary table over10k(
            t tinyint,
            si smallint,
@@ -672,6 +674,7 @@ PREHOOK: query: -- multi table insert test
 create table t1 (a1 int, b1 string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t1
 POSTHOOK: query: -- multi table insert test
 create table t1 (a1 int, b1 string)
 POSTHOOK: type: CREATETABLE
@@ -680,6 +683,7 @@ POSTHOOK: Output: default@t1
 PREHOOK: query: create table t2 (a1 int, b1 string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t2
 POSTHOOK: query: create table t2 (a1 int, b1 string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/test_boolean_whereclause.q.out b/ql/src/test/results/clientpositive/test_boolean_whereclause.q.out
index c66b62ae4e..f98eb0f0ce 100644
--- a/ql/src/test/results/clientpositive/test_boolean_whereclause.q.out
+++ b/ql/src/test/results/clientpositive/test_boolean_whereclause.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table if not exists test_boolean(dummy tinyint)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_boolean
 POSTHOOK: query: create table if not exists test_boolean(dummy tinyint)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/tez/alter_merge_2_orc.q.out b/ql/src/test/results/clientpositive/tez/alter_merge_2_orc.q.out
index 09ede0728c..1ccae8e944 100644
--- a/ql/src/test/results/clientpositive/tez/alter_merge_2_orc.q.out
+++ b/ql/src/test/results/clientpositive/tez/alter_merge_2_orc.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table src_orc_merge_test_part(key int, value string) partitioned by (ds string, ts string) stored as orc
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_orc_merge_test_part
 POSTHOOK: query: create table src_orc_merge_test_part(key int, value string) partitioned by (ds string, ts string) stored as orc
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/tez/alter_merge_orc.q.out b/ql/src/test/results/clientpositive/tez/alter_merge_orc.q.out
index 2610541b70..f26e38c246 100644
--- a/ql/src/test/results/clientpositive/tez/alter_merge_orc.q.out
+++ b/ql/src/test/results/clientpositive/tez/alter_merge_orc.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table src_orc_merge_test(key int, value string) stored as orc
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_orc_merge_test
 POSTHOOK: query: create table src_orc_merge_test(key int, value string) stored as orc
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -116,6 +117,7 @@ POSTHOOK: Input: default@src_orc_merge_test
 PREHOOK: query: create table src_orc_merge_test_part(key int, value string) partitioned by (ds string) stored as orc
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_orc_merge_test_part
 POSTHOOK: query: create table src_orc_merge_test_part(key int, value string) partitioned by (ds string) stored as orc
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/tez/alter_merge_stats_orc.q.out b/ql/src/test/results/clientpositive/tez/alter_merge_stats_orc.q.out
index 09a1672cd2..64e51d52e5 100644
--- a/ql/src/test/results/clientpositive/tez/alter_merge_stats_orc.q.out
+++ b/ql/src/test/results/clientpositive/tez/alter_merge_stats_orc.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table src_orc_merge_test_stat(key int, value string) stored as orc
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_orc_merge_test_stat
 POSTHOOK: query: create table src_orc_merge_test_stat(key int, value string) stored as orc
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -157,6 +158,7 @@ Storage Desc Params:
 PREHOOK: query: create table src_orc_merge_test_part_stat(key int, value string) partitioned by (ds string) stored as orc
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_orc_merge_test_part_stat
 POSTHOOK: query: create table src_orc_merge_test_part_stat(key int, value string) partitioned by (ds string) stored as orc
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/tez/auto_join1.q.out b/ql/src/test/results/clientpositive/tez/auto_join1.q.out
index f1b0d6a126..aded535faf 100644
--- a/ql/src/test/results/clientpositive/tez/auto_join1.q.out
+++ b/ql/src/test/results/clientpositive/tez/auto_join1.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest_j1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_j1
 POSTHOOK: query: CREATE TABLE dest_j1(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/tez/bucket2.q.out b/ql/src/test/results/clientpositive/tez/bucket2.q.out
index 66eba00a35..4121b05fcd 100644
--- a/ql/src/test/results/clientpositive/tez/bucket2.q.out
+++ b/ql/src/test/results/clientpositive/tez/bucket2.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE bucket2_1(key int, value string) CLUSTERED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucket2_1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE bucket2_1(key int, value string) CLUSTERED BY (key) INTO 2 BUCKETS
diff --git a/ql/src/test/results/clientpositive/tez/bucket3.q.out b/ql/src/test/results/clientpositive/tez/bucket3.q.out
index 41c680e961..3904d98077 100644
--- a/ql/src/test/results/clientpositive/tez/bucket3.q.out
+++ b/ql/src/test/results/clientpositive/tez/bucket3.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 CREATE TABLE bucket3_1(key int, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucket3_1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE bucket3_1(key int, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 2 BUCKETS
diff --git a/ql/src/test/results/clientpositive/tez/bucket4.q.out b/ql/src/test/results/clientpositive/tez/bucket4.q.out
index 28544f2f23..3990d60e78 100644
--- a/ql/src/test/results/clientpositive/tez/bucket4.q.out
+++ b/ql/src/test/results/clientpositive/tez/bucket4.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE bucket4_1(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucket4_1
 POSTHOOK: query: CREATE TABLE bucket4_1(key int, value string) CLUSTERED BY (key) SORTED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/tez/bucket_map_join_tez1.q.out b/ql/src/test/results/clientpositive/tez/bucket_map_join_tez1.q.out
index f356cd4b5a..2408ab881c 100644
--- a/ql/src/test/results/clientpositive/tez/bucket_map_join_tez1.q.out
+++ b/ql/src/test/results/clientpositive/tez/bucket_map_join_tez1.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE srcbucket_mapjoin(key int, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcbucket_mapjoin
 POSTHOOK: query: CREATE TABLE srcbucket_mapjoin(key int, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@srcbucket_mapjoin
 PREHOOK: query: CREATE TABLE tab_part (key int, value string) PARTITIONED BY(ds STRING) CLUSTERED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tab_part
 POSTHOOK: query: CREATE TABLE tab_part (key int, value string) PARTITIONED BY(ds STRING) CLUSTERED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -15,6 +17,7 @@ POSTHOOK: Output: default@tab_part
 PREHOOK: query: CREATE TABLE srcbucket_mapjoin_part (key int, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcbucket_mapjoin_part
 POSTHOOK: query: CREATE TABLE srcbucket_mapjoin_part (key int, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -86,6 +89,7 @@ POSTHOOK: Lineage: tab_part PARTITION(ds=2008-04-08).value SIMPLE [(srcbucket_ma
 PREHOOK: query: CREATE TABLE tab(key int, value string) PARTITIONED BY(ds STRING) CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tab
 POSTHOOK: query: CREATE TABLE tab(key int, value string) PARTITIONED BY(ds STRING) CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -990,6 +994,7 @@ STAGE PLANS:
 PREHOOK: query: CREATE TABLE tab1(key int, value string) CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tab1
 POSTHOOK: query: CREATE TABLE tab1(key int, value string) CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/tez/bucket_map_join_tez2.q.out b/ql/src/test/results/clientpositive/tez/bucket_map_join_tez2.q.out
index d8573b5d07..4a3f5b9fd1 100644
--- a/ql/src/test/results/clientpositive/tez/bucket_map_join_tez2.q.out
+++ b/ql/src/test/results/clientpositive/tez/bucket_map_join_tez2.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE srcbucket_mapjoin(key int, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcbucket_mapjoin
 POSTHOOK: query: CREATE TABLE srcbucket_mapjoin(key int, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@srcbucket_mapjoin
 PREHOOK: query: CREATE TABLE tab_part (key int, value string) PARTITIONED BY(ds STRING) CLUSTERED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tab_part
 POSTHOOK: query: CREATE TABLE tab_part (key int, value string) PARTITIONED BY(ds STRING) CLUSTERED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -15,6 +17,7 @@ POSTHOOK: Output: default@tab_part
 PREHOOK: query: CREATE TABLE srcbucket_mapjoin_part (key int, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcbucket_mapjoin_part
 POSTHOOK: query: CREATE TABLE srcbucket_mapjoin_part (key int, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -86,6 +89,7 @@ POSTHOOK: Lineage: tab_part PARTITION(ds=2008-04-08).value SIMPLE [(srcbucket_ma
 PREHOOK: query: CREATE TABLE tab(key int, value string) PARTITIONED BY(ds STRING) CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tab
 POSTHOOK: query: CREATE TABLE tab(key int, value string) PARTITIONED BY(ds STRING) CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -198,6 +202,7 @@ STAGE PLANS:
 PREHOOK: query: CREATE TABLE tab1(key int, value string) CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tab1
 POSTHOOK: query: CREATE TABLE tab1(key int, value string) CLUSTERED BY (key) INTO 2 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/tez/count.q.out b/ql/src/test/results/clientpositive/tez/count.q.out
index a065e8977b..fe63101015 100644
--- a/ql/src/test/results/clientpositive/tez/count.q.out
+++ b/ql/src/test/results/clientpositive/tez/count.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table abcd (a int, b int, c int, d int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@abcd
 POSTHOOK: query: create table abcd (a int, b int, c int, d int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/tez/create_merge_compressed.q.out b/ql/src/test/results/clientpositive/tez/create_merge_compressed.q.out
index c82d24a8dc..58f517c895 100644
--- a/ql/src/test/results/clientpositive/tez/create_merge_compressed.q.out
+++ b/ql/src/test/results/clientpositive/tez/create_merge_compressed.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table src_rc_merge_test(key int, value string) stored as rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_rc_merge_test
 POSTHOOK: query: create table src_rc_merge_test(key int, value string) stored as rcfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -16,6 +17,7 @@ POSTHOOK: Output: default@src_rc_merge_test
 PREHOOK: query: create table tgt_rc_merge_test(key int, value string) stored as rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tgt_rc_merge_test
 POSTHOOK: query: create table tgt_rc_merge_test(key int, value string) stored as rcfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/tez/ctas.q.out b/ql/src/test/results/clientpositive/tez/ctas.q.out
index 9c6b780295..5ff7981326 100644
--- a/ql/src/test/results/clientpositive/tez/ctas.q.out
+++ b/ql/src/test/results/clientpositive/tez/ctas.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- EXCLUDE_HADOOP_MAJOR_VERSIONS(0.20, 0.20S)
 create table nzhang_Tmp(a int, b string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@nzhang_Tmp
 POSTHOOK: query: -- EXCLUDE_HADOOP_MAJOR_VERSIONS(0.20, 0.20S)
 
 create table nzhang_Tmp(a int, b string)
@@ -875,6 +876,7 @@ POSTHOOK: Output: default@nzhang_ctas5
 PREHOOK: query: create table nzhang_ctas6 (key string, `to` string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@nzhang_ctas6
 POSTHOOK: query: create table nzhang_ctas6 (key string, `to` string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/tez/custom_input_output_format.q.out b/ql/src/test/results/clientpositive/tez/custom_input_output_format.q.out
index 950789f7e4..662ed1acec 100644
--- a/ql/src/test/results/clientpositive/tez/custom_input_output_format.q.out
+++ b/ql/src/test/results/clientpositive/tez/custom_input_output_format.q.out
@@ -5,6 +5,7 @@ CREATE TABLE src1_rot13_iof(key STRING, value STRING)
             OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.udf.Rot13OutputFormat'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src1_rot13_iof
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 CREATE TABLE src1_rot13_iof(key STRING, value STRING)
diff --git a/ql/src/test/results/clientpositive/tez/disable_merge_for_bucketing.q.out b/ql/src/test/results/clientpositive/tez/disable_merge_for_bucketing.q.out
index eb75ba1c58..29545dcd99 100644
--- a/ql/src/test/results/clientpositive/tez/disable_merge_for_bucketing.q.out
+++ b/ql/src/test/results/clientpositive/tez/disable_merge_for_bucketing.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE bucket2_1(key int, value string) CLUSTERED BY (key) INTO 2 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucket2_1
 POSTHOOK: query: CREATE TABLE bucket2_1(key int, value string) CLUSTERED BY (key) INTO 2 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/tez/dynpart_sort_optimization.q.out b/ql/src/test/results/clientpositive/tez/dynpart_sort_optimization.q.out
index 48f58049c8..e2f8673138 100644
--- a/ql/src/test/results/clientpositive/tez/dynpart_sort_optimization.q.out
+++ b/ql/src/test/results/clientpositive/tez/dynpart_sort_optimization.q.out
@@ -14,6 +14,7 @@ PREHOOK: query: create table over1k(
        fields terminated by '|'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@over1k
 POSTHOOK: query: create table over1k(
            t tinyint,
            si smallint,
@@ -47,6 +48,7 @@ PREHOOK: query: create table over1k_part(
        partitioned by (ds string, t tinyint)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@over1k_part
 POSTHOOK: query: create table over1k_part(
            si smallint,
            i int,
@@ -59,6 +61,7 @@ POSTHOOK: Output: default@over1k_part
 PREHOOK: query: create table over1k_part_limit like over1k_part
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@over1k_part_limit
 POSTHOOK: query: create table over1k_part_limit like over1k_part
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -72,6 +75,7 @@ PREHOOK: query: create table over1k_part_buck(
        clustered by (si) into 4 buckets
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@over1k_part_buck
 POSTHOOK: query: create table over1k_part_buck(
            si smallint,
            i int,
@@ -92,6 +96,7 @@ PREHOOK: query: create table over1k_part_buck_sort(
        sorted by (f) into 4 buckets
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@over1k_part_buck_sort
 POSTHOOK: query: create table over1k_part_buck_sort(
            si smallint,
            i int,
@@ -1218,6 +1223,7 @@ create table over1k_part2(
        partitioned by (ds string, t tinyint)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@over1k_part2
 POSTHOOK: query: -- tests for HIVE-6883
 create table over1k_part2(
            si smallint,
@@ -1686,6 +1692,7 @@ create table over1k_part_buck_sort2(
        sorted by (f) into 1 buckets
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@over1k_part_buck_sort2
 POSTHOOK: query: -- hadoop-1 does not honor number of reducers in local mode. There is always only 1 reducer irrespective of the number of buckets.
 -- Hence all records go to one bucket and all other buckets will be empty. Similar to HIVE-6867. However, hadoop-2 honors number
 -- of reducers and records are spread across all reducers. To avoid this inconsistency we will make number of buckets to 1 for this test.
diff --git a/ql/src/test/results/clientpositive/tez/enforce_order.q.out b/ql/src/test/results/clientpositive/tez/enforce_order.q.out
index 5cea7a5101..3e430886e5 100644
--- a/ql/src/test/results/clientpositive/tez/enforce_order.q.out
+++ b/ql/src/test/results/clientpositive/tez/enforce_order.q.out
@@ -9,6 +9,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table table_asc(key string, value string) clustered by (key) sorted by (key ASC) into 1 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table_asc
 POSTHOOK: query: create table table_asc(key string, value string) clustered by (key) sorted by (key ASC) into 1 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -16,6 +17,7 @@ POSTHOOK: Output: default@table_asc
 PREHOOK: query: create table table_desc(key string, value string) clustered by (key) sorted by (key DESC) into 1 BUCKETS
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table_desc
 POSTHOOK: query: create table table_desc(key string, value string) clustered by (key) sorted by (key DESC) into 1 BUCKETS
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/tez/filter_join_breaktask.q.out b/ql/src/test/results/clientpositive/tez/filter_join_breaktask.q.out
index bd46d85f5b..eae733fef3 100644
--- a/ql/src/test/results/clientpositive/tez/filter_join_breaktask.q.out
+++ b/ql/src/test/results/clientpositive/tez/filter_join_breaktask.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE filter_join_breaktask(key int, value string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@filter_join_breaktask
 POSTHOOK: query: CREATE TABLE filter_join_breaktask(key int, value string) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/tez/filter_join_breaktask2.q.out b/ql/src/test/results/clientpositive/tez/filter_join_breaktask2.q.out
index bca31b116c..d81bc93e95 100644
--- a/ql/src/test/results/clientpositive/tez/filter_join_breaktask2.q.out
+++ b/ql/src/test/results/clientpositive/tez/filter_join_breaktask2.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: create table T1(c1 string, c2 string, c3 string, c4 string, c5 s
 partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: create table T1(c1 string, c2 string, c3 string, c4 string, c5 string, c6 string, c7 string) 
 partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
@@ -10,6 +11,7 @@ POSTHOOK: Output: default@T1
 PREHOOK: query: create table T2(c1 string, c2 string, c3 string, c0 string, c4 string, c5 string, c6 string, c7 string, c8 string, c9 string, c10 string, c11 string, c12 string, c13 string, c14 string, c15 string, c16 string, c17 string, c18 string, c19 string, c20 string, c21 string, c22 string, c23 string, c24 string,  c25 string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T2
 POSTHOOK: query: create table T2(c1 string, c2 string, c3 string, c0 string, c4 string, c5 string, c6 string, c7 string, c8 string, c9 string, c10 string, c11 string, c12 string, c13 string, c14 string, c15 string, c16 string, c17 string, c18 string, c19 string, c20 string, c21 string, c22 string, c23 string, c24 string,  c25 string) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -17,6 +19,7 @@ POSTHOOK: Output: default@T2
 PREHOOK: query: create table T3 (c0 bigint,  c1 bigint, c2 int) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T3
 POSTHOOK: query: create table T3 (c0 bigint,  c1 bigint, c2 int) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -24,6 +27,7 @@ POSTHOOK: Output: default@T3
 PREHOOK: query: create table T4 (c0 bigint, c1 string, c2 string, c3 string, c4 string, c5 string, c6 string, c7 string, c8 string, c9 string, c10 string, c11 string, c12 string, c13 string, c14 string, c15 string, c16 string, c17 string, c18 string, c19 string, c20 string, c21 string, c22 string, c23 string, c24 string, c25 string, c26 string, c27 string, c28 string, c29 string, c30 string, c31 string, c32 string, c33 string, c34 string, c35 string, c36 string, c37 string, c38 string, c39 string, c40 string, c41 string, c42 string, c43 string, c44 string, c45 string, c46 string, c47 string, c48 string, c49 string, c50 string, c51 string, c52 string, c53 string, c54 string, c55 string, c56 string, c57 string, c58 string, c59 string, c60 string, c61 string, c62 string, c63 string, c64 string, c65 string, c66 string, c67 bigint, c68 string, c69 string, c70 bigint, c71 bigint, c72 bigint, c73 string, c74 string, c75 string, c76 string, c77 string, c78 string, c79 string, c80 string, c81 bigint, c82 bigint, c83 bigint) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T4
 POSTHOOK: query: create table T4 (c0 bigint, c1 string, c2 string, c3 string, c4 string, c5 string, c6 string, c7 string, c8 string, c9 string, c10 string, c11 string, c12 string, c13 string, c14 string, c15 string, c16 string, c17 string, c18 string, c19 string, c20 string, c21 string, c22 string, c23 string, c24 string, c25 string, c26 string, c27 string, c28 string, c29 string, c30 string, c31 string, c32 string, c33 string, c34 string, c35 string, c36 string, c37 string, c38 string, c39 string, c40 string, c41 string, c42 string, c43 string, c44 string, c45 string, c46 string, c47 string, c48 string, c49 string, c50 string, c51 string, c52 string, c53 string, c54 string, c55 string, c56 string, c57 string, c58 string, c59 string, c60 string, c61 string, c62 string, c63 string, c64 string, c65 string, c66 string, c67 bigint, c68 string, c69 string, c70 bigint, c71 bigint, c72 bigint, c73 string, c74 string, c75 string, c76 string, c77 string, c78 string, c79 string, c80 string, c81 bigint, c82 bigint, c83 bigint) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/tez/groupby1.q.out b/ql/src/test/results/clientpositive/tez/groupby1.q.out
index 91ee60a6f2..4d299451fa 100644
--- a/ql/src/test/results/clientpositive/tez/groupby1.q.out
+++ b/ql/src/test/results/clientpositive/tez/groupby1.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest_g1(key INT, value DOUBLE) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_g1
 POSTHOOK: query: CREATE TABLE dest_g1(key INT, value DOUBLE) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/tez/groupby2.q.out b/ql/src/test/results/clientpositive/tez/groupby2.q.out
index 73bdcf992f..085be4f9f9 100644
--- a/ql/src/test/results/clientpositive/tez/groupby2.q.out
+++ b/ql/src/test/results/clientpositive/tez/groupby2.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest_g2(key STRING, c1 INT, c2 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_g2
 POSTHOOK: query: CREATE TABLE dest_g2(key STRING, c1 INT, c2 STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/tez/groupby3.q.out b/ql/src/test/results/clientpositive/tez/groupby3.q.out
index 53ede7882f..63260f4651 100644
--- a/ql/src/test/results/clientpositive/tez/groupby3.q.out
+++ b/ql/src/test/results/clientpositive/tez/groupby3.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(c1 DOUBLE, c2 DOUBLE, c3 DOUBLE, c4 DOUBLE, c5 DOUBLE, c6 DOUBLE, c7 DOUBLE, c8 DOUBLE, c9 DOUBLE) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(c1 DOUBLE, c2 DOUBLE, c3 DOUBLE, c4 DOUBLE, c5 DOUBLE, c6 DOUBLE, c7 DOUBLE, c8 DOUBLE, c9 DOUBLE) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/tez/insert1.q.out b/ql/src/test/results/clientpositive/tez/insert1.q.out
index 1779d37fe4..e15b224df0 100644
--- a/ql/src/test/results/clientpositive/tez/insert1.q.out
+++ b/ql/src/test/results/clientpositive/tez/insert1.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 create table insert1(key int, value string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@insert1
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 create table insert1(key int, value string) stored as textfile
@@ -12,6 +13,7 @@ POSTHOOK: Output: default@insert1
 PREHOOK: query: create table insert2(key int, value string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@insert2
 POSTHOOK: query: create table insert2(key int, value string) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -133,16 +135,20 @@ STAGE PLANS:
 PREHOOK: query: -- HIVE-3465
 create database x
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:x
 POSTHOOK: query: -- HIVE-3465
 create database x
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:x
 PREHOOK: query: create table x.insert1(key int, value string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:x
+PREHOOK: Output: x@x.insert1
 POSTHOOK: query: create table x.insert1(key int, value string) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:x
 POSTHOOK: Output: x@insert1
+POSTHOOK: Output: x@x.insert1
 PREHOOK: query: explain insert into table x.INSERT1 select a.key, a.value from insert2 a WHERE (a.key=-1)
 PREHOOK: type: QUERY
 POSTHOOK: query: explain insert into table x.INSERT1 select a.key, a.value from insert2 a WHERE (a.key=-1)
@@ -338,16 +344,21 @@ STAGE PLANS:
 PREHOOK: query: -- HIVE-3676
 CREATE DATABASE db2
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:db2
 POSTHOOK: query: -- HIVE-3676
 CREATE DATABASE db2
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:db2
 PREHOOK: query: USE db2
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:db2
 POSTHOOK: query: USE db2
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:db2
 PREHOOK: query: CREATE TABLE result(col1 STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:db2
+PREHOOK: Output: db2@result
 POSTHOOK: query: CREATE TABLE result(col1 STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:db2
@@ -382,18 +393,24 @@ db2_insert1
 db2_insert2
 PREHOOK: query: USE default
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:default
 POSTHOOK: query: USE default
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:default
 PREHOOK: query: CREATE DATABASE db1
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:db1
 POSTHOOK: query: CREATE DATABASE db1
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:db1
 PREHOOK: query: CREATE TABLE db1.result(col1 STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:db1
+PREHOOK: Output: db1@db1.result
 POSTHOOK: query: CREATE TABLE db1.result(col1 STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:db1
+POSTHOOK: Output: db1@db1.result
 POSTHOOK: Output: db1@result
 PREHOOK: query: INSERT OVERWRITE TABLE db1.result SELECT 'db1_insert1' FROM src LIMIT 1
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/tez/insert_into1.q.out b/ql/src/test/results/clientpositive/tez/insert_into1.q.out
index 2bd40dd1e3..d74995557e 100644
--- a/ql/src/test/results/clientpositive/tez/insert_into1.q.out
+++ b/ql/src/test/results/clientpositive/tez/insert_into1.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: CREATE TABLE insert_into1 (key int, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@insert_into1
 POSTHOOK: query: CREATE TABLE insert_into1 (key int, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/tez/insert_into2.q.out b/ql/src/test/results/clientpositive/tez/insert_into2.q.out
index 67a7ea9402..ed6d7fe99d 100644
--- a/ql/src/test/results/clientpositive/tez/insert_into2.q.out
+++ b/ql/src/test/results/clientpositive/tez/insert_into2.q.out
@@ -6,6 +6,7 @@ PREHOOK: query: CREATE TABLE insert_into2 (key int, value string)
   PARTITIONED BY (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@insert_into2
 POSTHOOK: query: CREATE TABLE insert_into2 (key int, value string) 
   PARTITIONED BY (ds string)
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/tez/join1.q.out b/ql/src/test/results/clientpositive/tez/join1.q.out
index b0192f89e4..1cb7ee5303 100644
--- a/ql/src/test/results/clientpositive/tez/join1.q.out
+++ b/ql/src/test/results/clientpositive/tez/join1.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest_j1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest_j1
 POSTHOOK: query: CREATE TABLE dest_j1(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/tez/leftsemijoin.q.out b/ql/src/test/results/clientpositive/tez/leftsemijoin.q.out
index 3e10df1e4d..11f0bb053e 100644
--- a/ql/src/test/results/clientpositive/tez/leftsemijoin.q.out
+++ b/ql/src/test/results/clientpositive/tez/leftsemijoin.q.out
@@ -14,6 +14,7 @@ PREHOOK: query: CREATE TABLE sales (name STRING, id INT)
 ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@sales
 POSTHOOK: query: CREATE TABLE sales (name STRING, id INT)
 ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t'
 POSTHOOK: type: CREATETABLE
@@ -23,6 +24,7 @@ PREHOOK: query: CREATE TABLE things (id INT, name STRING) partitioned by (ds str
 ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@things
 POSTHOOK: query: CREATE TABLE things (id INT, name STRING) partitioned by (ds string)
 ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t'
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/tez/load_dyn_part1.q.out b/ql/src/test/results/clientpositive/tez/load_dyn_part1.q.out
index 07f332cb3d..10acd9070b 100644
--- a/ql/src/test/results/clientpositive/tez/load_dyn_part1.q.out
+++ b/ql/src/test/results/clientpositive/tez/load_dyn_part1.q.out
@@ -15,6 +15,7 @@ ds=2008-04-09/hr=12
 PREHOOK: query: create table if not exists nzhang_part1 like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@nzhang_part1
 POSTHOOK: query: create table if not exists nzhang_part1 like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -22,6 +23,7 @@ POSTHOOK: Output: default@nzhang_part1
 PREHOOK: query: create table if not exists nzhang_part2 like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@nzhang_part2
 POSTHOOK: query: create table if not exists nzhang_part2 like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/tez/load_dyn_part2.q.out b/ql/src/test/results/clientpositive/tez/load_dyn_part2.q.out
index 0535af9bac..f96edb2f74 100644
--- a/ql/src/test/results/clientpositive/tez/load_dyn_part2.q.out
+++ b/ql/src/test/results/clientpositive/tez/load_dyn_part2.q.out
@@ -5,6 +5,7 @@ create table if not exists nzhang_part_bucket (key string, value string)
   clustered by (key) into 10 buckets
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@nzhang_part_bucket
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 create table if not exists nzhang_part_bucket (key string, value string) 
diff --git a/ql/src/test/results/clientpositive/tez/load_dyn_part3.q.out b/ql/src/test/results/clientpositive/tez/load_dyn_part3.q.out
index 3a18064e87..43d291c879 100644
--- a/ql/src/test/results/clientpositive/tez/load_dyn_part3.q.out
+++ b/ql/src/test/results/clientpositive/tez/load_dyn_part3.q.out
@@ -15,6 +15,7 @@ ds=2008-04-09/hr=12
 PREHOOK: query: create table if not exists nzhang_part3 like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@nzhang_part3
 POSTHOOK: query: create table if not exists nzhang_part3 like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/tez/mapjoin_decimal.q.out b/ql/src/test/results/clientpositive/tez/mapjoin_decimal.q.out
index 9abaa46d22..07529b8d02 100644
--- a/ql/src/test/results/clientpositive/tez/mapjoin_decimal.q.out
+++ b/ql/src/test/results/clientpositive/tez/mapjoin_decimal.q.out
@@ -13,6 +13,7 @@ ROW FORMAT DELIMITED FIELDS TERMINATED BY '|'
 STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@over1k
 POSTHOOK: query: CREATE TABLE over1k(t tinyint,
            si smallint,
            i int,
@@ -40,6 +41,7 @@ POSTHOOK: Output: default@over1k
 PREHOOK: query: CREATE TABLE t1(dec decimal(4,2)) STORED AS ORC
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t1
 POSTHOOK: query: CREATE TABLE t1(dec decimal(4,2)) STORED AS ORC
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -56,6 +58,7 @@ POSTHOOK: Lineage: t1.dec SIMPLE [(over1k)over1k.FieldSchema(name:dec, type:deci
 PREHOOK: query: CREATE TABLE t2(dec decimal(4,0)) STORED AS ORC
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t2
 POSTHOOK: query: CREATE TABLE t2(dec decimal(4,0)) STORED AS ORC
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/tez/mapreduce1.q.out b/ql/src/test/results/clientpositive/tez/mapreduce1.q.out
index 30ca7aac27..d7c283b4f0 100644
--- a/ql/src/test/results/clientpositive/tez/mapreduce1.q.out
+++ b/ql/src/test/results/clientpositive/tez/mapreduce1.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key INT, ten INT, one INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key INT, ten INT, one INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/tez/mapreduce2.q.out b/ql/src/test/results/clientpositive/tez/mapreduce2.q.out
index cb2ba71f03..c2fccfc2e0 100644
--- a/ql/src/test/results/clientpositive/tez/mapreduce2.q.out
+++ b/ql/src/test/results/clientpositive/tez/mapreduce2.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key INT, ten INT, one INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key INT, ten INT, one INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/tez/merge1.q.out b/ql/src/test/results/clientpositive/tez/merge1.q.out
index f01654024b..4ef85990c2 100644
--- a/ql/src/test/results/clientpositive/tez/merge1.q.out
+++ b/ql/src/test/results/clientpositive/tez/merge1.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table dest1(key int, val int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: create table dest1(key int, val int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -424,6 +425,7 @@ POSTHOOK: Output: default@dest1
 PREHOOK: query: create table test_src(key string, value string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_src
 POSTHOOK: query: create table test_src(key string, value string) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -431,6 +433,7 @@ POSTHOOK: Output: default@test_src
 PREHOOK: query: create table dest1(key string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: create table dest1(key string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/tez/merge2.q.out b/ql/src/test/results/clientpositive/tez/merge2.q.out
index 96a2715394..d31f1b871f 100644
--- a/ql/src/test/results/clientpositive/tez/merge2.q.out
+++ b/ql/src/test/results/clientpositive/tez/merge2.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table test1(key int, val int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test1
 POSTHOOK: query: create table test1(key int, val int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -424,6 +425,7 @@ POSTHOOK: Output: default@test1
 PREHOOK: query: create table test_src(key string, value string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_src
 POSTHOOK: query: create table test_src(key string, value string) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -431,6 +433,7 @@ POSTHOOK: Output: default@test_src
 PREHOOK: query: create table test1(key string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test1
 POSTHOOK: query: create table test1(key string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/tez/metadata_only_queries.q.out b/ql/src/test/results/clientpositive/tez/metadata_only_queries.q.out
index 1d8c76a218..7942ce76be 100644
--- a/ql/src/test/results/clientpositive/tez/metadata_only_queries.q.out
+++ b/ql/src/test/results/clientpositive/tez/metadata_only_queries.q.out
@@ -14,6 +14,7 @@ PREHOOK: query: create table over10k(
        fields terminated by '|'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@over10k
 POSTHOOK: query: create table over10k(
            t tinyint,
            si smallint,
@@ -53,6 +54,7 @@ PREHOOK: query: create table stats_tbl(
            bin binary)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@stats_tbl
 POSTHOOK: query: create table stats_tbl(
            t tinyint,
            si smallint,
@@ -82,6 +84,7 @@ PREHOOK: query: create table stats_tbl_part(
            bin binary) partitioned by (dt string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@stats_tbl_part
 POSTHOOK: query: create table stats_tbl_part(
            t tinyint,
            si smallint,
diff --git a/ql/src/test/results/clientpositive/tez/metadataonly1.q.out b/ql/src/test/results/clientpositive/tez/metadataonly1.q.out
index 46393a7cd2..0f8f3af25b 100644
--- a/ql/src/test/results/clientpositive/tez/metadataonly1.q.out
+++ b/ql/src/test/results/clientpositive/tez/metadataonly1.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE TEST1(A INT, B DOUBLE) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@TEST1
 POSTHOOK: query: CREATE TABLE TEST1(A INT, B DOUBLE) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -930,6 +931,7 @@ POSTHOOK: Input: default@test1@ds=2
 PREHOOK: query: CREATE TABLE TEST2(A INT, B DOUBLE) partitioned by (ds string, hr string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@TEST2
 POSTHOOK: query: CREATE TABLE TEST2(A INT, B DOUBLE) partitioned by (ds string, hr string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/tez/orc_analyze.q.out b/ql/src/test/results/clientpositive/tez/orc_analyze.q.out
index 880a13a493..979d2a7600 100644
--- a/ql/src/test/results/clientpositive/tez/orc_analyze.q.out
+++ b/ql/src/test/results/clientpositive/tez/orc_analyze.q.out
@@ -8,6 +8,7 @@ PREHOOK: query: CREATE TABLE orc_create_people_staging (
   state string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@orc_create_people_staging
 POSTHOOK: query: CREATE TABLE orc_create_people_staging (
   id int,
   first_name string,
@@ -40,6 +41,7 @@ CREATE TABLE orc_create_people (
 STORED AS orc
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@orc_create_people
 POSTHOOK: query: -- non-partitioned table
 -- partial scan gather
 CREATE TABLE orc_create_people (
@@ -136,6 +138,7 @@ CREATE TABLE orc_create_people (
 STORED AS orc
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@orc_create_people
 POSTHOOK: query: -- auto stats gather
 CREATE TABLE orc_create_people (
   id int,
@@ -226,6 +229,7 @@ PARTITIONED BY (state string)
 STORED AS orc
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@orc_create_people
 POSTHOOK: query: -- partitioned table
 -- partial scan gather
 CREATE TABLE orc_create_people (
@@ -383,6 +387,7 @@ PARTITIONED BY (state string)
 STORED AS orc
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@orc_create_people
 POSTHOOK: query: -- auto stats gather
 CREATE TABLE orc_create_people (
   id int,
@@ -533,6 +538,7 @@ into 4 buckets
 STORED AS orc
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@orc_create_people
 POSTHOOK: query: -- partitioned and bucketed table
 -- partial scan gather
 CREATE TABLE orc_create_people (
@@ -696,6 +702,7 @@ into 4 buckets
 STORED AS orc
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@orc_create_people
 POSTHOOK: query: -- auto stats gather
 CREATE TABLE orc_create_people (
   id int,
@@ -847,6 +854,7 @@ PARTITIONED BY (state string)
 STORED AS orc
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@orc_create_people
 POSTHOOK: query: -- create table with partitions containing text and ORC files.
 -- ORC files implements StatsProvidingRecordReader but text files does not.
 -- So the partition containing text file should not have statistics.
diff --git a/ql/src/test/results/clientpositive/tez/orc_merge1.q.out b/ql/src/test/results/clientpositive/tez/orc_merge1.q.out
index 62c316f05b..f79f878884 100644
--- a/ql/src/test/results/clientpositive/tez/orc_merge1.q.out
+++ b/ql/src/test/results/clientpositive/tez/orc_merge1.q.out
@@ -10,6 +10,7 @@ PREHOOK: query: CREATE TABLE orcfile_merge1 (key INT, value STRING)
     PARTITIONED BY (ds STRING, part STRING) STORED AS ORC
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@orcfile_merge1
 POSTHOOK: query: CREATE TABLE orcfile_merge1 (key INT, value STRING) 
     PARTITIONED BY (ds STRING, part STRING) STORED AS ORC
 POSTHOOK: type: CREATETABLE
@@ -19,6 +20,7 @@ PREHOOK: query: CREATE TABLE orcfile_merge1b (key INT, value STRING)
     PARTITIONED BY (ds STRING, part STRING) STORED AS ORC
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@orcfile_merge1b
 POSTHOOK: query: CREATE TABLE orcfile_merge1b (key INT, value STRING) 
     PARTITIONED BY (ds STRING, part STRING) STORED AS ORC
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/tez/orc_merge2.q.out b/ql/src/test/results/clientpositive/tez/orc_merge2.q.out
index d71327643f..f0d92e80c5 100644
--- a/ql/src/test/results/clientpositive/tez/orc_merge2.q.out
+++ b/ql/src/test/results/clientpositive/tez/orc_merge2.q.out
@@ -7,6 +7,7 @@ PREHOOK: query: CREATE TABLE orcfile_merge2a (key INT, value STRING)
     STORED AS ORC
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@orcfile_merge2a
 POSTHOOK: query: CREATE TABLE orcfile_merge2a (key INT, value STRING)
     PARTITIONED BY (one string, two string, three string)
     STORED AS ORC
diff --git a/ql/src/test/results/clientpositive/tez/orc_merge3.q.out b/ql/src/test/results/clientpositive/tez/orc_merge3.q.out
index 38c65fac30..534bb0aec0 100644
--- a/ql/src/test/results/clientpositive/tez/orc_merge3.q.out
+++ b/ql/src/test/results/clientpositive/tez/orc_merge3.q.out
@@ -10,6 +10,7 @@ PREHOOK: query: CREATE TABLE orcfile_merge3a (key int, value string)
     PARTITIONED BY (ds string) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@orcfile_merge3a
 POSTHOOK: query: CREATE TABLE orcfile_merge3a (key int, value string) 
     PARTITIONED BY (ds string) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
@@ -18,6 +19,7 @@ POSTHOOK: Output: default@orcfile_merge3a
 PREHOOK: query: CREATE TABLE orcfile_merge3b (key int, value string) STORED AS ORC
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@orcfile_merge3b
 POSTHOOK: query: CREATE TABLE orcfile_merge3b (key int, value string) STORED AS ORC
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/tez/orc_merge4.q.out b/ql/src/test/results/clientpositive/tez/orc_merge4.q.out
index 178760b709..96c8089738 100644
--- a/ql/src/test/results/clientpositive/tez/orc_merge4.q.out
+++ b/ql/src/test/results/clientpositive/tez/orc_merge4.q.out
@@ -10,6 +10,7 @@ PREHOOK: query: CREATE TABLE orcfile_merge3a (key int, value string)
     PARTITIONED BY (ds string) STORED AS ORC
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@orcfile_merge3a
 POSTHOOK: query: CREATE TABLE orcfile_merge3a (key int, value string) 
     PARTITIONED BY (ds string) STORED AS ORC
 POSTHOOK: type: CREATETABLE
@@ -18,6 +19,7 @@ POSTHOOK: Output: default@orcfile_merge3a
 PREHOOK: query: CREATE TABLE orcfile_merge3b (key int, value string) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@orcfile_merge3b
 POSTHOOK: query: CREATE TABLE orcfile_merge3b (key int, value string) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/tez/ptf.q.out b/ql/src/test/results/clientpositive/tez/ptf.q.out
index 34d2ef0171..25ad0a905a 100644
--- a/ql/src/test/results/clientpositive/tez/ptf.q.out
+++ b/ql/src/test/results/clientpositive/tez/ptf.q.out
@@ -16,6 +16,7 @@ CREATE TABLE part(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part
 POSTHOOK: query: -- data setup
 CREATE TABLE part( 
     p_partkey INT,
@@ -826,6 +827,7 @@ dr INT,
 s DOUBLE)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part_4
 POSTHOOK: query: -- 17. testMultipleInserts2SWQsWithPTF
 CREATE TABLE part_4( 
 p_mfgr STRING, 
@@ -848,6 +850,7 @@ cud DOUBLE,
 fv1 INT)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part_5
 POSTHOOK: query: CREATE TABLE part_5( 
 p_mfgr STRING, 
 p_name STRING, 
diff --git a/ql/src/test/results/clientpositive/tez/sample1.q.out b/ql/src/test/results/clientpositive/tez/sample1.q.out
index 6f8dfe9460..157be04cb7 100644
--- a/ql/src/test/results/clientpositive/tez/sample1.q.out
+++ b/ql/src/test/results/clientpositive/tez/sample1.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key INT, value STRING, dt STRING, hr STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key INT, value STRING, dt STRING, hr STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/tez/scriptfile1.q.out b/ql/src/test/results/clientpositive/tez/scriptfile1.q.out
index 6bf2e23a7c..c8d120c461 100644
--- a/ql/src/test/results/clientpositive/tez/scriptfile1.q.out
+++ b/ql/src/test/results/clientpositive/tez/scriptfile1.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- EXCLUDE_OS_WINDOWS
 CREATE TABLE dest1(key INT, value STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: -- EXCLUDE_OS_WINDOWS
 CREATE TABLE dest1(key INT, value STRING)
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/tez/stats_counter_partitioned.q.out b/ql/src/test/results/clientpositive/tez/stats_counter_partitioned.q.out
index 8bdc2ec35f..ab1270c712 100644
--- a/ql/src/test/results/clientpositive/tez/stats_counter_partitioned.q.out
+++ b/ql/src/test/results/clientpositive/tez/stats_counter_partitioned.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- partitioned table analyze
 create table dummy (key string, value string) partitioned by (ds string, hr string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dummy
 POSTHOOK: query: -- partitioned table analyze 
 
 create table dummy (key string, value string) partitioned by (ds string, hr string)
@@ -140,6 +141,7 @@ PREHOOK: query: -- static partitioned table on insert
 create table dummy (key string, value string) partitioned by (ds string, hr string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dummy
 POSTHOOK: query: -- static partitioned table on insert
 
 create table dummy (key string, value string) partitioned by (ds string, hr string)
@@ -263,6 +265,7 @@ PREHOOK: query: -- dynamic partitioned table on insert
 create table dummy (key int) partitioned by (hr int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dummy
 POSTHOOK: query: -- dynamic partitioned table on insert
 
 create table dummy (key int) partitioned by (hr int)
@@ -272,6 +275,7 @@ POSTHOOK: Output: default@dummy
 PREHOOK: query: CREATE TABLE tbl(key int, value int) ROW FORMAT DELIMITED FIELDS TERMINATED BY '|'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tbl
 POSTHOOK: query: CREATE TABLE tbl(key int, value int) ROW FORMAT DELIMITED FIELDS TERMINATED BY '|'
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/tez/stats_noscan_1.q.out b/ql/src/test/results/clientpositive/tez/stats_noscan_1.q.out
index 690378a434..aa4952631d 100644
--- a/ql/src/test/results/clientpositive/tez/stats_noscan_1.q.out
+++ b/ql/src/test/results/clientpositive/tez/stats_noscan_1.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: -- test analyze table ... compute statistics noscan
 create table analyze_srcpart like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@analyze_srcpart
 POSTHOOK: query: -- test analyze table ... compute statistics noscan
 
 -- 1. test full spec
@@ -294,6 +295,7 @@ PREHOOK: query: -- 2. test partial spec
 create table analyze_srcpart_partial like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@analyze_srcpart_partial
 POSTHOOK: query: -- 2. test partial spec
 create table analyze_srcpart_partial like srcpart
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/tez/subquery_in.q.out b/ql/src/test/results/clientpositive/tez/subquery_in.q.out
index 238591087b..cffe86f18a 100644
--- a/ql/src/test/results/clientpositive/tez/subquery_in.q.out
+++ b/ql/src/test/results/clientpositive/tez/subquery_in.q.out
@@ -20,6 +20,7 @@ CREATE TABLE part(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part
 POSTHOOK: query: -- data setup
 CREATE TABLE part( 
     p_partkey INT,
@@ -67,6 +68,7 @@ ROW FORMAT DELIMITED
 FIELDS TERMINATED BY '|'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@lineitem
 POSTHOOK: query: CREATE TABLE lineitem (L_ORDERKEY      INT,
                                 L_PARTKEY       INT,
                                 L_SUPPKEY       INT,
diff --git a/ql/src/test/results/clientpositive/tez/temp_table.q.out b/ql/src/test/results/clientpositive/tez/temp_table.q.out
index ae6715fcae..eba40b5ae0 100644
--- a/ql/src/test/results/clientpositive/tez/temp_table.q.out
+++ b/ql/src/test/results/clientpositive/tez/temp_table.q.out
@@ -283,6 +283,7 @@ POSTHOOK: Input: default@foo
 PREHOOK: query: CREATE TEMPORARY TABLE baz LIKE foo
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@baz
 POSTHOOK: query: CREATE TEMPORARY TABLE baz LIKE foo
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -300,6 +301,7 @@ POSTHOOK: Lineage: baz.value SIMPLE [(foo)foo.FieldSchema(name:value, type:strin
 PREHOOK: query: CREATE TEMPORARY TABLE bay (key string, value string) STORED AS orc
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bay
 POSTHOOK: query: CREATE TEMPORARY TABLE bay (key string, value string) STORED AS orc
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -359,12 +361,16 @@ srcbucket2
 srcpart
 PREHOOK: query: CREATE DATABASE two
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:two
 POSTHOOK: query: CREATE DATABASE two
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:two
 PREHOOK: query: USE two
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:two
 POSTHOOK: query: USE two
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:two
 PREHOOK: query: SHOW TABLES
 PREHOOK: type: SHOWTABLES
 POSTHOOK: query: SHOW TABLES
@@ -383,8 +389,10 @@ POSTHOOK: type: SHOWTABLES
 foo
 PREHOOK: query: use default
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:default
 POSTHOOK: query: use default
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:default
 PREHOOK: query: DROP DATABASE two CASCADE
 PREHOOK: type: DROPDATABASE
 PREHOOK: Input: database:two
diff --git a/ql/src/test/results/clientpositive/tez/tez_dml.q.out b/ql/src/test/results/clientpositive/tez/tez_dml.q.out
index 42012a973a..625ce0e5c8 100644
--- a/ql/src/test/results/clientpositive/tez/tez_dml.q.out
+++ b/ql/src/test/results/clientpositive/tez/tez_dml.q.out
@@ -421,6 +421,7 @@ PREHOOK: query: -- dyn partitions
 CREATE TABLE tmp_src_part (c string) PARTITIONED BY (d int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmp_src_part
 POSTHOOK: query: -- dyn partitions
 CREATE TABLE tmp_src_part (c string) PARTITIONED BY (d int)
 POSTHOOK: type: CREATETABLE
@@ -837,6 +838,7 @@ PREHOOK: query: -- multi insert
 CREATE TABLE even (c int, d string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@even
 POSTHOOK: query: -- multi insert
 CREATE TABLE even (c int, d string)
 POSTHOOK: type: CREATETABLE
@@ -845,6 +847,7 @@ POSTHOOK: Output: default@even
 PREHOOK: query: CREATE TABLE odd (c int, d string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@odd
 POSTHOOK: query: CREATE TABLE odd (c int, d string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/tez/tez_fsstat.q.out b/ql/src/test/results/clientpositive/tez/tez_fsstat.q.out
index 5a09c30251..3fcf68c57a 100644
--- a/ql/src/test/results/clientpositive/tez/tez_fsstat.q.out
+++ b/ql/src/test/results/clientpositive/tez/tez_fsstat.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE tab_part (key int, value string) PARTITIONED BY(ds STRING) CLUSTERED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tab_part
 POSTHOOK: query: CREATE TABLE tab_part (key int, value string) PARTITIONED BY(ds STRING) CLUSTERED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@tab_part
 PREHOOK: query: CREATE TABLE t1 (key int, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t1
 POSTHOOK: query: CREATE TABLE t1 (key int, value string) partitioned by (ds string) CLUSTERED BY (key) INTO 4 BUCKETS STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/tez/tez_join_hash.q.out b/ql/src/test/results/clientpositive/tez/tez_join_hash.q.out
index f7ba73350f..410645bacf 100644
--- a/ql/src/test/results/clientpositive/tez/tez_join_hash.q.out
+++ b/ql/src/test/results/clientpositive/tez/tez_join_hash.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table orc_src (key string, value string) STORED AS ORC
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@orc_src
 POSTHOOK: query: create table orc_src (key string, value string) STORED AS ORC
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/tez/tez_schema_evolution.q.out b/ql/src/test/results/clientpositive/tez/tez_schema_evolution.q.out
index 86eb089ebd..6316268b03 100644
--- a/ql/src/test/results/clientpositive/tez/tez_schema_evolution.q.out
+++ b/ql/src/test/results/clientpositive/tez/tez_schema_evolution.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table test (key int, value string) partitioned by (p int) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test
 POSTHOOK: query: create table test (key int, value string) partitioned by (p int) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/tez/transform1.q.out b/ql/src/test/results/clientpositive/tez/transform1.q.out
index 31ff4074c8..ffe911c311 100644
--- a/ql/src/test/results/clientpositive/tez/transform1.q.out
+++ b/ql/src/test/results/clientpositive/tez/transform1.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table transform1_t1(a string, b string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@transform1_t1
 POSTHOOK: query: create table transform1_t1(a string, b string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -61,6 +62,7 @@ POSTHOOK: Input: default@transform1_t1
 PREHOOK: query: create table transform1_t2(col array<int>)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@transform1_t2
 POSTHOOK: query: create table transform1_t2(col array<int>)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/tez/union3.q.out b/ql/src/test/results/clientpositive/tez/union3.q.out
index e5f7d79c22..82167f87f7 100644
--- a/ql/src/test/results/clientpositive/tez/union3.q.out
+++ b/ql/src/test/results/clientpositive/tez/union3.q.out
@@ -208,6 +208,7 @@ STAGE PLANS:
 PREHOOK: query: CREATE TABLE union_out (id int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@union_out
 POSTHOOK: query: CREATE TABLE union_out (id int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/tez/union4.q.out b/ql/src/test/results/clientpositive/tez/union4.q.out
index cbb4927d02..a607410808 100644
--- a/ql/src/test/results/clientpositive/tez/union4.q.out
+++ b/ql/src/test/results/clientpositive/tez/union4.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: -- union case: both subqueries are map-reduce jobs on same input
 create table tmptable(key string, value int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmptable
 POSTHOOK: query: -- union case: both subqueries are map-reduce jobs on same input, followed by filesink
 
 
diff --git a/ql/src/test/results/clientpositive/tez/union6.q.out b/ql/src/test/results/clientpositive/tez/union6.q.out
index f7e4a8a5da..02df21c87a 100644
--- a/ql/src/test/results/clientpositive/tez/union6.q.out
+++ b/ql/src/test/results/clientpositive/tez/union6.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: -- union case: 1 subquery is a map-reduce job, different inputs
 create table tmptable(key string, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmptable
 POSTHOOK: query: -- union case: 1 subquery is a map-reduce job, different inputs for sub-queries, followed by filesink
 
 
diff --git a/ql/src/test/results/clientpositive/tez/vector_cast_constant.q.out b/ql/src/test/results/clientpositive/tez/vector_cast_constant.q.out
index 2a7c5efccb..c2592dd4c8 100644
--- a/ql/src/test/results/clientpositive/tez/vector_cast_constant.q.out
+++ b/ql/src/test/results/clientpositive/tez/vector_cast_constant.q.out
@@ -22,6 +22,7 @@ ROW FORMAT DELIMITED FIELDS TERMINATED BY '|'
 STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@over1k
 POSTHOOK: query: -- data setup
 CREATE TABLE over1k(t tinyint,
            si smallint,
@@ -61,6 +62,7 @@ PREHOOK: query: CREATE TABLE over1korc(t tinyint,
 STORED AS ORC
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@over1korc
 POSTHOOK: query: CREATE TABLE over1korc(t tinyint,
            si smallint,
            i int,
diff --git a/ql/src/test/results/clientpositive/tez/vector_data_types.q.out b/ql/src/test/results/clientpositive/tez/vector_data_types.q.out
index 4954825ec7..f577e136d4 100644
--- a/ql/src/test/results/clientpositive/tez/vector_data_types.q.out
+++ b/ql/src/test/results/clientpositive/tez/vector_data_types.q.out
@@ -22,6 +22,7 @@ ROW FORMAT DELIMITED FIELDS TERMINATED BY '|'
 STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@over1k
 POSTHOOK: query: -- data setup
 CREATE TABLE over1k(t tinyint,
            si smallint,
@@ -61,6 +62,7 @@ PREHOOK: query: CREATE TABLE over1korc(t tinyint,
 STORED AS ORC
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@over1korc
 POSTHOOK: query: CREATE TABLE over1korc(t tinyint,
            si smallint,
            i int,
diff --git a/ql/src/test/results/clientpositive/tez/vector_string_concat.q.out b/ql/src/test/results/clientpositive/tez/vector_string_concat.q.out
index 023fe9eb32..56e7e1085a 100644
--- a/ql/src/test/results/clientpositive/tez/vector_string_concat.q.out
+++ b/ql/src/test/results/clientpositive/tez/vector_string_concat.q.out
@@ -22,6 +22,7 @@ ROW FORMAT DELIMITED FIELDS TERMINATED BY '|'
 STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@over1k
 POSTHOOK: query: -- data setup
 CREATE TABLE over1k(t tinyint,
            si smallint,
@@ -61,6 +62,7 @@ PREHOOK: query: CREATE TABLE over1korc(t tinyint,
 STORED AS ORC
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@over1korc
 POSTHOOK: query: CREATE TABLE over1korc(t tinyint,
            si smallint,
            i int,
diff --git a/ql/src/test/results/clientpositive/tez/vectorization_part_project.q.out b/ql/src/test/results/clientpositive/tez/vectorization_part_project.q.out
index 28381b0840..8d28abdaae 100644
--- a/ql/src/test/results/clientpositive/tez/vectorization_part_project.q.out
+++ b/ql/src/test/results/clientpositive/tez/vectorization_part_project.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE alltypesorc_part(ctinyint tinyint, csmallint smallint, cint int, cbigint bigint, cfloat float, cdouble double, cstring1 string, cstring2 string, ctimestamp1 timestamp, ctimestamp2 timestamp, cboolean1 boolean, cboolean2 boolean) partitioned by (ds string) STORED AS ORC
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@alltypesorc_part
 POSTHOOK: query: CREATE TABLE alltypesorc_part(ctinyint tinyint, csmallint smallint, cint int, cbigint bigint, cfloat float, cdouble double, cstring1 string, cstring2 string, ctimestamp1 timestamp, ctimestamp2 timestamp, cboolean1 boolean, cboolean2 boolean) partitioned by (ds string) STORED AS ORC
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/tez/vectorized_ptf.q.out b/ql/src/test/results/clientpositive/tez/vectorized_ptf.q.out
index 9d29af9717..1e91e8c821 100644
--- a/ql/src/test/results/clientpositive/tez/vectorized_ptf.q.out
+++ b/ql/src/test/results/clientpositive/tez/vectorized_ptf.q.out
@@ -24,6 +24,7 @@ CREATE TABLE part_staging(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part_staging
 POSTHOOK: query: -- NOTE: This test is a copy of ptf.
 -- NOTE: We cannot vectorize "pure" table functions (e.g. NOOP) -- given their blackbox nature. So only queries without table functions and
 -- NOTE: with windowing will be vectorized.
@@ -64,6 +65,7 @@ PREHOOK: query: CREATE TABLE part(
 ) STORED AS ORC
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part
 POSTHOOK: query: CREATE TABLE part( 
     p_partkey INT,
     p_name STRING,
@@ -4921,6 +4923,7 @@ dr INT,
 s DOUBLE)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part_4
 POSTHOOK: query: -- 17. testMultipleInserts2SWQsWithPTF
 CREATE TABLE part_4( 
 p_mfgr STRING, 
@@ -4943,6 +4946,7 @@ cud DOUBLE,
 fv1 INT)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part_5
 POSTHOOK: query: CREATE TABLE part_5( 
 p_mfgr STRING, 
 p_name STRING, 
diff --git a/ql/src/test/results/clientpositive/tez/vectorized_timestamp_funcs.q.out b/ql/src/test/results/clientpositive/tez/vectorized_timestamp_funcs.q.out
index 99f4141c75..8b39f9ca2a 100644
--- a/ql/src/test/results/clientpositive/tez/vectorized_timestamp_funcs.q.out
+++ b/ql/src/test/results/clientpositive/tez/vectorized_timestamp_funcs.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- Test timestamp functions in vectorized mode to verify they ru
 CREATE TABLE alltypesorc_string(ctimestamp1 timestamp, stimestamp1 string) STORED AS ORC
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@alltypesorc_string
 POSTHOOK: query: -- Test timestamp functions in vectorized mode to verify they run correctly end-to-end.
 
 CREATE TABLE alltypesorc_string(ctimestamp1 timestamp, stimestamp1 string) STORED AS ORC
@@ -32,6 +33,7 @@ POSTHOOK: Lineage: alltypesorc_string.stimestamp1 EXPRESSION [(alltypesorc)allty
 PREHOOK: query: CREATE TABLE alltypesorc_wrong(stimestamp1 string) STORED AS ORC
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@alltypesorc_wrong
 POSTHOOK: query: CREATE TABLE alltypesorc_wrong(stimestamp1 string) STORED AS ORC
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/timestamp_1.q.out b/ql/src/test/results/clientpositive/timestamp_1.q.out
index fc4e727b72..d3ca5cfdf6 100644
--- a/ql/src/test/results/clientpositive/timestamp_1.q.out
+++ b/ql/src/test/results/clientpositive/timestamp_1.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table timestamp_1 (t timestamp)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@timestamp_1
 POSTHOOK: query: create table timestamp_1 (t timestamp)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/timestamp_2.q.out b/ql/src/test/results/clientpositive/timestamp_2.q.out
index 325a64fe60..f9bfb0937e 100644
--- a/ql/src/test/results/clientpositive/timestamp_2.q.out
+++ b/ql/src/test/results/clientpositive/timestamp_2.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table timestamp_2 (t timestamp)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@timestamp_2
 POSTHOOK: query: create table timestamp_2 (t timestamp)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/timestamp_3.q.out b/ql/src/test/results/clientpositive/timestamp_3.q.out
index a94ff469cc..0664abf658 100644
--- a/ql/src/test/results/clientpositive/timestamp_3.q.out
+++ b/ql/src/test/results/clientpositive/timestamp_3.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table timestamp_3 (t timestamp)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@timestamp_3
 POSTHOOK: query: create table timestamp_3 (t timestamp)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/timestamp_lazy.q.out b/ql/src/test/results/clientpositive/timestamp_lazy.q.out
index 6736c98d62..6ac8cbaede 100644
--- a/ql/src/test/results/clientpositive/timestamp_lazy.q.out
+++ b/ql/src/test/results/clientpositive/timestamp_lazy.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table timestamp_lazy (t timestamp, key string, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@timestamp_lazy
 POSTHOOK: query: create table timestamp_lazy (t timestamp, key string, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/timestamp_null.q.out b/ql/src/test/results/clientpositive/timestamp_null.q.out
index 0110d8032c..6243129ddf 100644
--- a/ql/src/test/results/clientpositive/timestamp_null.q.out
+++ b/ql/src/test/results/clientpositive/timestamp_null.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: CREATE TABLE timestamp_null (t1 TIMESTAMP)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@timestamp_null
 POSTHOOK: query: CREATE TABLE timestamp_null (t1 TIMESTAMP)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/timestamp_udf.q.out b/ql/src/test/results/clientpositive/timestamp_udf.q.out
index a27c6d54fe..904c894c8b 100644
--- a/ql/src/test/results/clientpositive/timestamp_udf.q.out
+++ b/ql/src/test/results/clientpositive/timestamp_udf.q.out
@@ -9,6 +9,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table timestamp_udf (t timestamp)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@timestamp_udf
 POSTHOOK: query: create table timestamp_udf (t timestamp)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -16,6 +17,7 @@ POSTHOOK: Output: default@timestamp_udf
 PREHOOK: query: create table timestamp_udf_string (t string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@timestamp_udf_string
 POSTHOOK: query: create table timestamp_udf_string (t string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/touch.q.out b/ql/src/test/results/clientpositive/touch.q.out
index 1d3c0964af..7ea38074c6 100644
--- a/ql/src/test/results/clientpositive/touch.q.out
+++ b/ql/src/test/results/clientpositive/touch.q.out
@@ -9,6 +9,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table tstsrc like src
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tstsrc
 POSTHOOK: query: create table tstsrc like src
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -26,6 +27,7 @@ POSTHOOK: Lineage: tstsrc.value SIMPLE [(src)src.FieldSchema(name:value, type:st
 PREHOOK: query: create table tstsrcpart like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tstsrcpart
 POSTHOOK: query: create table tstsrcpart like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/transform1.q.out b/ql/src/test/results/clientpositive/transform1.q.out
index 5f0e005c6a..a0386ef7ea 100644
--- a/ql/src/test/results/clientpositive/transform1.q.out
+++ b/ql/src/test/results/clientpositive/transform1.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table transform1_t1(a string, b string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@transform1_t1
 POSTHOOK: query: create table transform1_t1(a string, b string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -58,6 +59,7 @@ POSTHOOK: Input: default@transform1_t1
 PREHOOK: query: create table transform1_t2(col array<int>)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@transform1_t2
 POSTHOOK: query: create table transform1_t2(col array<int>)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/truncate_column.q.out b/ql/src/test/results/clientpositive/truncate_column.q.out
index 8db0d70e83..2d3e378ab8 100644
--- a/ql/src/test/results/clientpositive/truncate_column.q.out
+++ b/ql/src/test/results/clientpositive/truncate_column.q.out
@@ -4,6 +4,7 @@ CREATE TABLE test_tab (key STRING, value STRING)
 ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.columnar.ColumnarSerDe' STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_tab
 POSTHOOK: query: -- Tests truncating column(s) from a table, also tests that stats are updated
 
 CREATE TABLE test_tab (key STRING, value STRING) 
@@ -496,6 +497,7 @@ PREHOOK: query: -- Test truncating a partition
 CREATE TABLE test_tab_part (key STRING, value STRING) PARTITIONED BY (part STRING) STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_tab_part
 POSTHOOK: query: -- Test truncating a partition
 CREATE TABLE test_tab_part (key STRING, value STRING) PARTITIONED BY (part STRING) STORED AS RCFILE
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/truncate_column_buckets.q.out b/ql/src/test/results/clientpositive/truncate_column_buckets.q.out
index 48644853a1..7147c2231b 100644
--- a/ql/src/test/results/clientpositive/truncate_column_buckets.q.out
+++ b/ql/src/test/results/clientpositive/truncate_column_buckets.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- Tests truncating columns from a bucketed table, table should
 CREATE TABLE test_tab (key STRING, value STRING) CLUSTERED BY (key) INTO 2 BUCKETS STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_tab
 POSTHOOK: query: -- Tests truncating columns from a bucketed table, table should remain bucketed
 
 CREATE TABLE test_tab (key STRING, value STRING) CLUSTERED BY (key) INTO 2 BUCKETS STORED AS RCFILE
diff --git a/ql/src/test/results/clientpositive/truncate_column_list_bucket.q.out b/ql/src/test/results/clientpositive/truncate_column_list_bucket.q.out
index 2ffcb01615..fc4a30b680 100644
--- a/ql/src/test/results/clientpositive/truncate_column_list_bucket.q.out
+++ b/ql/src/test/results/clientpositive/truncate_column_list_bucket.q.out
@@ -5,6 +5,7 @@ PREHOOK: query: -- Tests truncating a column from a list bucketing table
 CREATE TABLE test_tab (key STRING, value STRING) PARTITIONED BY (part STRING) STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_tab
 POSTHOOK: query: -- Tests truncating a column from a list bucketing table
 
 -- INCLUDE_HADOOP_MAJOR_VERSIONS(0.23)
diff --git a/ql/src/test/results/clientpositive/truncate_column_merge.q.out b/ql/src/test/results/clientpositive/truncate_column_merge.q.out
index 4e28baa094..2693b907dc 100644
--- a/ql/src/test/results/clientpositive/truncate_column_merge.q.out
+++ b/ql/src/test/results/clientpositive/truncate_column_merge.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- Tests truncating a column from a table with multiple files, t
 CREATE TABLE test_tab (key STRING, value STRING) STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_tab
 POSTHOOK: query: -- Tests truncating a column from a table with multiple files, then merging those files
 
 CREATE TABLE test_tab (key STRING, value STRING) STORED AS RCFILE
diff --git a/ql/src/test/results/clientpositive/truncate_table.q.out b/ql/src/test/results/clientpositive/truncate_table.q.out
index 312a82f6ed..4d8f38cd86 100644
--- a/ql/src/test/results/clientpositive/truncate_table.q.out
+++ b/ql/src/test/results/clientpositive/truncate_table.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table src_truncate (key string, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_truncate
 POSTHOOK: query: create table src_truncate (key string, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -16,6 +17,7 @@ POSTHOOK: Output: default@src_truncate
 PREHOOK: query: create table srcpart_truncate (key string, value string) partitioned by (ds string, hr string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@srcpart_truncate
 POSTHOOK: query: create table srcpart_truncate (key string, value string) partitioned by (ds string, hr string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/udaf_context_ngrams.q.out b/ql/src/test/results/clientpositive/udaf_context_ngrams.q.out
index 32e9219f5e..91a37930b6 100644
--- a/ql/src/test/results/clientpositive/udaf_context_ngrams.q.out
+++ b/ql/src/test/results/clientpositive/udaf_context_ngrams.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE kafka (contents STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@kafka
 POSTHOOK: query: CREATE TABLE kafka (contents STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/udaf_corr.q.out b/ql/src/test/results/clientpositive/udaf_corr.q.out
index 0103da3997..1b468c4ffd 100644
--- a/ql/src/test/results/clientpositive/udaf_corr.q.out
+++ b/ql/src/test/results/clientpositive/udaf_corr.q.out
@@ -7,6 +7,7 @@ ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t'
 STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@covar_tab
 POSTHOOK: query: CREATE TABLE covar_tab (a INT, b INT, c INT)
 ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t'
 STORED AS TEXTFILE
diff --git a/ql/src/test/results/clientpositive/udaf_covar_pop.q.out b/ql/src/test/results/clientpositive/udaf_covar_pop.q.out
index e7a71b3f62..fa1d47e73d 100644
--- a/ql/src/test/results/clientpositive/udaf_covar_pop.q.out
+++ b/ql/src/test/results/clientpositive/udaf_covar_pop.q.out
@@ -7,6 +7,7 @@ ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t'
 STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@covar_tab
 POSTHOOK: query: CREATE TABLE covar_tab (a INT, b INT, c INT)
 ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t'
 STORED AS TEXTFILE
diff --git a/ql/src/test/results/clientpositive/udaf_covar_samp.q.out b/ql/src/test/results/clientpositive/udaf_covar_samp.q.out
index 1044a00c85..ff5b47ea70 100644
--- a/ql/src/test/results/clientpositive/udaf_covar_samp.q.out
+++ b/ql/src/test/results/clientpositive/udaf_covar_samp.q.out
@@ -7,6 +7,7 @@ ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t'
 STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@covar_tab
 POSTHOOK: query: CREATE TABLE covar_tab (a INT, b INT, c INT)
 ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t'
 STORED AS TEXTFILE
diff --git a/ql/src/test/results/clientpositive/udaf_ngrams.q.out b/ql/src/test/results/clientpositive/udaf_ngrams.q.out
index 43444e50cb..033f62234c 100644
--- a/ql/src/test/results/clientpositive/udaf_ngrams.q.out
+++ b/ql/src/test/results/clientpositive/udaf_ngrams.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE kafka (contents STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@kafka
 POSTHOOK: query: CREATE TABLE kafka (contents STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/udaf_percentile_approx_23.q.out b/ql/src/test/results/clientpositive/udaf_percentile_approx_23.q.out
index 94366fed40..b2c02816e9 100644
--- a/ql/src/test/results/clientpositive/udaf_percentile_approx_23.q.out
+++ b/ql/src/test/results/clientpositive/udaf_percentile_approx_23.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: -- INCLUDE_HADOOP_MAJOR_VERSIONS(0.23)
 CREATE TABLE bucket (key double, value string) CLUSTERED BY (key) SORTED BY (key DESC)  INTO 4 BUCKETS STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bucket
 POSTHOOK: query: -- INCLUDE_HADOOP_MAJOR_VERSIONS(0.23)
 -- 0.23 changed input order of data in reducer task, which affects result of percentile_approx
 
@@ -46,6 +47,7 @@ POSTHOOK: Output: default@bucket
 PREHOOK: query: create table t1 (result double)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t1
 POSTHOOK: query: create table t1 (result double)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -53,6 +55,7 @@ POSTHOOK: Output: default@t1
 PREHOOK: query: create table t2 (result double)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t2
 POSTHOOK: query: create table t2 (result double)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -60,6 +63,7 @@ POSTHOOK: Output: default@t2
 PREHOOK: query: create table t3 (result double)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t3
 POSTHOOK: query: create table t3 (result double)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -67,6 +71,7 @@ POSTHOOK: Output: default@t3
 PREHOOK: query: create table t4 (result double)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t4
 POSTHOOK: query: create table t4 (result double)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -74,6 +79,7 @@ POSTHOOK: Output: default@t4
 PREHOOK: query: create table t5 (result double)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t5
 POSTHOOK: query: create table t5 (result double)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -81,6 +87,7 @@ POSTHOOK: Output: default@t5
 PREHOOK: query: create table t6 (result double)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t6
 POSTHOOK: query: create table t6 (result double)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -88,6 +95,7 @@ POSTHOOK: Output: default@t6
 PREHOOK: query: create table t7 (result array<double>)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t7
 POSTHOOK: query: create table t7 (result array<double>)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -95,6 +103,7 @@ POSTHOOK: Output: default@t7
 PREHOOK: query: create table t8 (result array<double>)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t8
 POSTHOOK: query: create table t8 (result array<double>)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -102,6 +111,7 @@ POSTHOOK: Output: default@t8
 PREHOOK: query: create table t9 (result array<double>)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t9
 POSTHOOK: query: create table t9 (result array<double>)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -109,6 +119,7 @@ POSTHOOK: Output: default@t9
 PREHOOK: query: create table t10 (result array<double>)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t10
 POSTHOOK: query: create table t10 (result array<double>)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -116,6 +127,7 @@ POSTHOOK: Output: default@t10
 PREHOOK: query: create table t11 (result array<double>)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t11
 POSTHOOK: query: create table t11 (result array<double>)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -123,6 +135,7 @@ POSTHOOK: Output: default@t11
 PREHOOK: query: create table t12 (result array<double>)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t12
 POSTHOOK: query: create table t12 (result array<double>)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/udf1.q.out b/ql/src/test/results/clientpositive/udf1.q.out
index 2a8aad4ff6..10b10c8f80 100644
--- a/ql/src/test/results/clientpositive/udf1.q.out
+++ b/ql/src/test/results/clientpositive/udf1.q.out
@@ -5,6 +5,7 @@ PREHOOK: query: CREATE TABLE dest1(c1 STRING, c2 STRING, c3 STRING, c4 STRING,
   c18 STRING, c19 STRING, c20 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(c1 STRING, c2 STRING, c3 STRING, c4 STRING,
   c5 STRING, c6 STRING, c7 STRING, c8 STRING,
   c9 STRING, c10 STRING, c11 STRING, c12 STRING, c13 STRING,
diff --git a/ql/src/test/results/clientpositive/udf2.q.out b/ql/src/test/results/clientpositive/udf2.q.out
index 0d0a2a4aa7..d7a7bdadc8 100644
--- a/ql/src/test/results/clientpositive/udf2.q.out
+++ b/ql/src/test/results/clientpositive/udf2.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(c1 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(c1 STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/udf3.q.out b/ql/src/test/results/clientpositive/udf3.q.out
index 0fab218d48..6236118183 100644
--- a/ql/src/test/results/clientpositive/udf3.q.out
+++ b/ql/src/test/results/clientpositive/udf3.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(c1 STRING, c2 STRING, c3 STRING, c4 STRING, c5 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(c1 STRING, c2 STRING, c3 STRING, c4 STRING, c5 STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/udf4.q.out b/ql/src/test/results/clientpositive/udf4.q.out
index 81e54705a0..9ea92932cd 100644
--- a/ql/src/test/results/clientpositive/udf4.q.out
+++ b/ql/src/test/results/clientpositive/udf4.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(c1 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(c1 STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/udf5.q.out b/ql/src/test/results/clientpositive/udf5.q.out
index 7096275f1e..5e06b16017 100644
--- a/ql/src/test/results/clientpositive/udf5.q.out
+++ b/ql/src/test/results/clientpositive/udf5.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(c1 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(c1 STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/udf6.q.out b/ql/src/test/results/clientpositive/udf6.q.out
index a3ac65f6bb..922d6ed58a 100644
--- a/ql/src/test/results/clientpositive/udf6.q.out
+++ b/ql/src/test/results/clientpositive/udf6.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(c1 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(c1 STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/udf7.q.out b/ql/src/test/results/clientpositive/udf7.q.out
index c4eef14a84..05f2037caa 100644
--- a/ql/src/test/results/clientpositive/udf7.q.out
+++ b/ql/src/test/results/clientpositive/udf7.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(c1 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(c1 STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/udf8.q.out b/ql/src/test/results/clientpositive/udf8.q.out
index 5f83bfbca9..985933b534 100644
--- a/ql/src/test/results/clientpositive/udf8.q.out
+++ b/ql/src/test/results/clientpositive/udf8.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(c1 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(c1 STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/udf_10_trims.q.out b/ql/src/test/results/clientpositive/udf_10_trims.q.out
index 3ff61186e6..0d19c5640d 100644
--- a/ql/src/test/results/clientpositive/udf_10_trims.q.out
+++ b/ql/src/test/results/clientpositive/udf_10_trims.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(c1 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(c1 STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/udf_bitmap_and.q.out b/ql/src/test/results/clientpositive/udf_bitmap_and.q.out
index 523da7e8e8..8c9339894c 100644
--- a/ql/src/test/results/clientpositive/udf_bitmap_and.q.out
+++ b/ql/src/test/results/clientpositive/udf_bitmap_and.q.out
@@ -23,6 +23,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table bitmap_test (a array<bigint>, b array<bigint>)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bitmap_test
 POSTHOOK: query: create table bitmap_test (a array<bigint>, b array<bigint>)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/udf_bitmap_or.q.out b/ql/src/test/results/clientpositive/udf_bitmap_or.q.out
index c2a4d82fb6..43521da234 100644
--- a/ql/src/test/results/clientpositive/udf_bitmap_or.q.out
+++ b/ql/src/test/results/clientpositive/udf_bitmap_or.q.out
@@ -23,6 +23,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table bitmap_test (a array<bigint>, b array<bigint>)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@bitmap_test
 POSTHOOK: query: create table bitmap_test (a array<bigint>, b array<bigint>)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/udf_concat_insert1.q.out b/ql/src/test/results/clientpositive/udf_concat_insert1.q.out
index 7f22c52cb5..b74644b928 100644
--- a/ql/src/test/results/clientpositive/udf_concat_insert1.q.out
+++ b/ql/src/test/results/clientpositive/udf_concat_insert1.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key INT, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/udf_concat_insert2.q.out b/ql/src/test/results/clientpositive/udf_concat_insert2.q.out
index eb83b4c02e..f1b70fe40f 100644
--- a/ql/src/test/results/clientpositive/udf_concat_insert2.q.out
+++ b/ql/src/test/results/clientpositive/udf_concat_insert2.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE dest1(key STRING, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(key STRING, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/udf_concat_ws.q.out b/ql/src/test/results/clientpositive/udf_concat_ws.q.out
index 2a56de4556..ea2d70384f 100644
--- a/ql/src/test/results/clientpositive/udf_concat_ws.q.out
+++ b/ql/src/test/results/clientpositive/udf_concat_ws.q.out
@@ -14,6 +14,7 @@ Example:
 PREHOOK: query: CREATE TABLE dest1(c1 STRING, c2 STRING, c3 STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(c1 STRING, c2 STRING, c3 STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/udf_current_database.q.out b/ql/src/test/results/clientpositive/udf_current_database.q.out
index b4381e90ba..00a27a7d3e 100644
--- a/ql/src/test/results/clientpositive/udf_current_database.q.out
+++ b/ql/src/test/results/clientpositive/udf_current_database.q.out
@@ -50,12 +50,16 @@ POSTHOOK: Input: _dummy_database@_dummy_table
 default
 PREHOOK: query: create database xxx
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:xxx
 POSTHOOK: query: create database xxx
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:xxx
 PREHOOK: query: use xxx
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:xxx
 POSTHOOK: query: use xxx
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:xxx
 PREHOOK: query: explain
 select current_database()
 PREHOOK: type: QUERY
@@ -103,8 +107,10 @@ POSTHOOK: Input: _dummy_database@_dummy_table
 xxx
 PREHOOK: query: use default
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:default
 POSTHOOK: query: use default
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:default
 PREHOOK: query: explain
 select current_database()
 PREHOOK: type: QUERY
@@ -140,8 +146,10 @@ POSTHOOK: Input: _dummy_database@_dummy_table
 default
 PREHOOK: query: use xxx
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:xxx
 POSTHOOK: query: use xxx
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:xxx
 PREHOOK: query: explain
 select current_database()
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/udf_explode.q.out b/ql/src/test/results/clientpositive/udf_explode.q.out
index 59a75d9ecf..f1d42bbc50 100644
--- a/ql/src/test/results/clientpositive/udf_explode.q.out
+++ b/ql/src/test/results/clientpositive/udf_explode.q.out
@@ -701,6 +701,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table lazy_array_map (map_col map<int,string>, array_col array<string>)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@lazy_array_map
 POSTHOOK: query: create table lazy_array_map (map_col map<int,string>, array_col array<string>)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/udf_field.q.out b/ql/src/test/results/clientpositive/udf_field.q.out
index 4fc459546d..8786608640 100644
--- a/ql/src/test/results/clientpositive/udf_field.q.out
+++ b/ql/src/test/results/clientpositive/udf_field.q.out
@@ -71,6 +71,7 @@ POSTHOOK: Input: default@src
 PREHOOK: query: CREATE TABLE test_table(col1 STRING, col2 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table
 POSTHOOK: query: CREATE TABLE test_table(col1 STRING, col2 STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -118,6 +119,7 @@ POSTHOOK: Input: default@test_table
 PREHOOK: query: CREATE TABLE test_table1(col1 int, col2 string) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_table1
 POSTHOOK: query: CREATE TABLE test_table1(col1 int, col2 string) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/udf_format_number.q.out b/ql/src/test/results/clientpositive/udf_format_number.q.out
index 9cc08eaf4f..0888172312 100644
--- a/ql/src/test/results/clientpositive/udf_format_number.q.out
+++ b/ql/src/test/results/clientpositive/udf_format_number.q.out
@@ -1,7 +1,9 @@
 PREHOOK: query: use default
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:default
 POSTHOOK: query: use default
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:default
 PREHOOK: query: -- Test format_number() UDF
 
 DESCRIBE FUNCTION format_number
diff --git a/ql/src/test/results/clientpositive/udf_get_json_object.q.out b/ql/src/test/results/clientpositive/udf_get_json_object.q.out
index ec6be8364e..509fabef67 100644
--- a/ql/src/test/results/clientpositive/udf_get_json_object.q.out
+++ b/ql/src/test/results/clientpositive/udf_get_json_object.q.out
@@ -26,6 +26,7 @@ Syntax not supported that's worth noticing:
 PREHOOK: query: CREATE TABLE dest1(c1 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(c1 STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -154,6 +155,7 @@ PREHOOK: query: -- Verify that get_json_object can handle new lines in JSON valu
 CREATE TABLE dest2(c1 STRING) STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest2
 POSTHOOK: query: -- Verify that get_json_object can handle new lines in JSON values
 
 CREATE TABLE dest2(c1 STRING) STORED AS RCFILE
diff --git a/ql/src/test/results/clientpositive/udf_in_file.q.out b/ql/src/test/results/clientpositive/udf_in_file.q.out
index 8871b4ed4d..55648902cc 100644
--- a/ql/src/test/results/clientpositive/udf_in_file.q.out
+++ b/ql/src/test/results/clientpositive/udf_in_file.q.out
@@ -8,6 +8,7 @@ PREHOOK: query: CREATE TABLE value_src (str_val char(3), ch_val STRING, vch_val
        ROW FORMAT DELIMITED FIELDS TERMINATED BY ','
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@value_src
 POSTHOOK: query: CREATE TABLE value_src (str_val char(3), ch_val STRING, vch_val varchar(10),
                         str_val_neg char(3), ch_val_neg STRING, vch_val_neg varchar(10))
        ROW FORMAT DELIMITED FIELDS TERMINATED BY ','
diff --git a/ql/src/test/results/clientpositive/udf_length.q.out b/ql/src/test/results/clientpositive/udf_length.q.out
index d868e89aef..a0a77e6aef 100644
--- a/ql/src/test/results/clientpositive/udf_length.q.out
+++ b/ql/src/test/results/clientpositive/udf_length.q.out
@@ -14,6 +14,7 @@ Example:
 PREHOOK: query: CREATE TABLE dest1(len INT)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(len INT)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -158,6 +159,7 @@ PREHOOK: query: -- Test with non-ascii characters.
 CREATE TABLE dest1(name STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: -- Test with non-ascii characters. 
 CREATE TABLE dest1(name STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/udf_map_keys.q.out b/ql/src/test/results/clientpositive/udf_map_keys.q.out
index 4cb5a17886..69872da570 100644
--- a/ql/src/test/results/clientpositive/udf_map_keys.q.out
+++ b/ql/src/test/results/clientpositive/udf_map_keys.q.out
@@ -1,7 +1,9 @@
 PREHOOK: query: use default
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:default
 POSTHOOK: query: use default
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:default
 PREHOOK: query: -- Test map_keys() UDF
 
 DESCRIBE FUNCTION map_keys
diff --git a/ql/src/test/results/clientpositive/udf_map_values.q.out b/ql/src/test/results/clientpositive/udf_map_values.q.out
index 1f78b0ed87..87b126e997 100644
--- a/ql/src/test/results/clientpositive/udf_map_values.q.out
+++ b/ql/src/test/results/clientpositive/udf_map_values.q.out
@@ -1,7 +1,9 @@
 PREHOOK: query: use default
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:default
 POSTHOOK: query: use default
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:default
 PREHOOK: query: -- Test map_values() UDF
 
 DESCRIBE FUNCTION map_values
diff --git a/ql/src/test/results/clientpositive/udf_printf.q.out b/ql/src/test/results/clientpositive/udf_printf.q.out
index be097f8b57..0f4fd86bde 100644
--- a/ql/src/test/results/clientpositive/udf_printf.q.out
+++ b/ql/src/test/results/clientpositive/udf_printf.q.out
@@ -1,7 +1,9 @@
 PREHOOK: query: use default
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:default
 POSTHOOK: query: use default
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:default
 PREHOOK: query: -- Test printf() UDF
 
 DESCRIBE FUNCTION printf
@@ -79,6 +81,7 @@ PREHOOK: query: -- Test Timestamp
 create table timestamp_udf (t timestamp)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@timestamp_udf
 POSTHOOK: query: -- Test Timestamp
 create table timestamp_udf (t timestamp)
 POSTHOOK: type: CREATETABLE
@@ -121,6 +124,7 @@ FIELDS TERMINATED BY '9'
 STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@binay_udf
 POSTHOOK: query: -- Test Binary
 CREATE TABLE binay_udf(key binary, value int)
 ROW FORMAT DELIMITED
@@ -140,6 +144,7 @@ POSTHOOK: Output: default@binay_udf
 PREHOOK: query: create table dest1 (key binary, value int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: create table dest1 (key binary, value int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/udf_reverse.q.out b/ql/src/test/results/clientpositive/udf_reverse.q.out
index 1d9bf5113e..7baa369f72 100644
--- a/ql/src/test/results/clientpositive/udf_reverse.q.out
+++ b/ql/src/test/results/clientpositive/udf_reverse.q.out
@@ -14,6 +14,7 @@ Example:
 PREHOOK: query: CREATE TABLE dest1(len STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: CREATE TABLE dest1(len STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -160,6 +161,7 @@ PREHOOK: query: -- Test with non-ascii characters
 CREATE TABLE dest1(name STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: -- Test with non-ascii characters
 -- kv4.txt contains the text 0xE982B5E993AE, which should be reversed to
 -- 0xE993AEE982B5
diff --git a/ql/src/test/results/clientpositive/udf_round_2.q.out b/ql/src/test/results/clientpositive/udf_round_2.q.out
index aab4bc4839..b231a0fb1e 100644
--- a/ql/src/test/results/clientpositive/udf_round_2.q.out
+++ b/ql/src/test/results/clientpositive/udf_round_2.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: -- test for NaN (not-a-number)
 create table tstTbl1(n double)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tstTbl1
 POSTHOOK: query: -- test for NaN (not-a-number)
 create table tstTbl1(n double)
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/udf_sentences.q.out b/ql/src/test/results/clientpositive/udf_sentences.q.out
index 958b6fd136..14a009894e 100644
--- a/ql/src/test/results/clientpositive/udf_sentences.q.out
+++ b/ql/src/test/results/clientpositive/udf_sentences.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE sent_tmp (val array<string>)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@sent_tmp
 POSTHOOK: query: CREATE TABLE sent_tmp (val array<string>)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@sent_tmp
 PREHOOK: query: CREATE TABLE sent_tmp2 (val string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@sent_tmp2
 POSTHOOK: query: CREATE TABLE sent_tmp2 (val string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -111,6 +113,7 @@ POSTHOOK: Output: default@sent_tmp2
 PREHOOK: query: CREATE TABLE sent_tmp (val array<string>)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@sent_tmp
 POSTHOOK: query: CREATE TABLE sent_tmp (val array<string>)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -118,6 +121,7 @@ POSTHOOK: Output: default@sent_tmp
 PREHOOK: query: CREATE TABLE sent_tmp2 (val string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@sent_tmp2
 POSTHOOK: query: CREATE TABLE sent_tmp2 (val string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/udf_sort_array.q.out b/ql/src/test/results/clientpositive/udf_sort_array.q.out
index 9d93f26f28..3d408f172f 100644
--- a/ql/src/test/results/clientpositive/udf_sort_array.q.out
+++ b/ql/src/test/results/clientpositive/udf_sort_array.q.out
@@ -1,7 +1,9 @@
 PREHOOK: query: use default
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:default
 POSTHOOK: query: use default
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:default
 PREHOOK: query: -- Test sort_array() UDF
 
 DESCRIBE FUNCTION sort_array
@@ -99,6 +101,7 @@ CREATE TABLE dest1 (
 ) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: -- Test it against data in a table.
 CREATE TABLE dest1 (
 	tinyints ARRAY<TINYINT>,
diff --git a/ql/src/test/results/clientpositive/udf_to_unix_timestamp.q.out b/ql/src/test/results/clientpositive/udf_to_unix_timestamp.q.out
index 447ef87836..31f6ef4eef 100644
--- a/ql/src/test/results/clientpositive/udf_to_unix_timestamp.q.out
+++ b/ql/src/test/results/clientpositive/udf_to_unix_timestamp.q.out
@@ -12,6 +12,7 @@ Converts the specified time to number of seconds since 1970-01-01.
 PREHOOK: query: create table oneline(key int, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@oneline
 POSTHOOK: query: create table oneline(key int, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/udf_translate.q.out b/ql/src/test/results/clientpositive/udf_translate.q.out
index 9ab682f61a..96f04abed0 100644
--- a/ql/src/test/results/clientpositive/udf_translate.q.out
+++ b/ql/src/test/results/clientpositive/udf_translate.q.out
@@ -24,6 +24,7 @@ PREHOOK: query: -- Create some tables to serve some input data
 CREATE TABLE table_input(input STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table_input
 POSTHOOK: query: -- Create some tables to serve some input data
 CREATE TABLE table_input(input STRING)
 POSTHOOK: type: CREATETABLE
@@ -32,6 +33,7 @@ POSTHOOK: Output: default@table_input
 PREHOOK: query: CREATE TABLE table_translate(input_string STRING, from_string STRING, to_string STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@table_translate
 POSTHOOK: query: CREATE TABLE table_translate(input_string STRING, from_string STRING, to_string STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/udf_unix_timestamp.q.out b/ql/src/test/results/clientpositive/udf_unix_timestamp.q.out
index f21dba20be..e4ffa1a899 100644
--- a/ql/src/test/results/clientpositive/udf_unix_timestamp.q.out
+++ b/ql/src/test/results/clientpositive/udf_unix_timestamp.q.out
@@ -12,6 +12,7 @@ Converts the current or specified time to number of seconds since 1970-01-01.
 PREHOOK: query: create table oneline(key int, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@oneline
 POSTHOOK: query: create table oneline(key int, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/udf_using.q.out b/ql/src/test/results/clientpositive/udf_using.q.out
index 80d1dfa408..f20b7f55d5 100644
--- a/ql/src/test/results/clientpositive/udf_using.q.out
+++ b/ql/src/test/results/clientpositive/udf_using.q.out
@@ -9,6 +9,7 @@ POSTHOOK: Output: lookup
 PREHOOK: query: create table udf_using (c1 string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@udf_using
 POSTHOOK: query: create table udf_using (c1 string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/udtf_json_tuple.q.out b/ql/src/test/results/clientpositive/udtf_json_tuple.q.out
index 445446276d..bc58856ed0 100644
--- a/ql/src/test/results/clientpositive/udtf_json_tuple.q.out
+++ b/ql/src/test/results/clientpositive/udtf_json_tuple.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table json_t (key string, jstring string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@json_t
 POSTHOOK: query: create table json_t (key string, jstring string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -409,6 +410,7 @@ PREHOOK: query: -- Verify that json_tuple can handle new lines in JSON values
 CREATE TABLE dest1(c1 STRING) STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dest1
 POSTHOOK: query: -- Verify that json_tuple can handle new lines in JSON values
 
 CREATE TABLE dest1(c1 STRING) STORED AS RCFILE
diff --git a/ql/src/test/results/clientpositive/udtf_parse_url_tuple.q.out b/ql/src/test/results/clientpositive/udtf_parse_url_tuple.q.out
index 9a43d422fe..24f5eac1ab 100644
--- a/ql/src/test/results/clientpositive/udtf_parse_url_tuple.q.out
+++ b/ql/src/test/results/clientpositive/udtf_parse_url_tuple.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table url_t (key string, fullurl string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@url_t
 POSTHOOK: query: create table url_t (key string, fullurl string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/udtf_posexplode.q.out b/ql/src/test/results/clientpositive/udtf_posexplode.q.out
index 83a786f826..9fe73a8d75 100644
--- a/ql/src/test/results/clientpositive/udtf_posexplode.q.out
+++ b/ql/src/test/results/clientpositive/udtf_posexplode.q.out
@@ -6,6 +6,7 @@ deductions MAP<STRING, FLOAT>,
 address STRUCT<street:STRING, city:STRING, state:STRING, zip:INT>)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@employees
 POSTHOOK: query: CREATE TABLE employees (
 name STRING,
 salary FLOAT,
diff --git a/ql/src/test/results/clientpositive/unicode_notation.q.out b/ql/src/test/results/clientpositive/unicode_notation.q.out
index ba167414fa..5849705803 100644
--- a/ql/src/test/results/clientpositive/unicode_notation.q.out
+++ b/ql/src/test/results/clientpositive/unicode_notation.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- HIVE-4618 hive should accept unicode notation like \uxxxx
 CREATE  TABLE k1( a string)ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@k1
 POSTHOOK: query: -- HIVE-4618 hive should accept unicode notation like \uxxxx
 
 CREATE  TABLE k1( a string)ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001'
@@ -51,6 +52,7 @@ POSTHOOK: Output: default@k1
 PREHOOK: query: CREATE  TABLE k1( a string)ROW FORMAT DELIMITED FIELDS TERMINATED BY '\001'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@k1
 POSTHOOK: query: CREATE  TABLE k1( a string)ROW FORMAT DELIMITED FIELDS TERMINATED BY '\001'
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -97,6 +99,7 @@ POSTHOOK: Output: default@k1
 PREHOOK: query: CREATE  TABLE k1( a string)ROW FORMAT DELIMITED FIELDS TERMINATED BY '|'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@k1
 POSTHOOK: query: CREATE  TABLE k1( a string)ROW FORMAT DELIMITED FIELDS TERMINATED BY '|'
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/union10.q.out b/ql/src/test/results/clientpositive/union10.q.out
index b9880bd858..b837bf5582 100644
--- a/ql/src/test/results/clientpositive/union10.q.out
+++ b/ql/src/test/results/clientpositive/union10.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- union case: all subqueries are a map-reduce jobs, 3 way union
 create table tmptable(key string, value int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmptable
 POSTHOOK: query: -- union case: all subqueries are a map-reduce jobs, 3 way union, same input for all sub-queries, followed by filesink
 
 create table tmptable(key string, value int)
diff --git a/ql/src/test/results/clientpositive/union12.q.out b/ql/src/test/results/clientpositive/union12.q.out
index 5dd8e092b4..7b07dd7b3f 100644
--- a/ql/src/test/results/clientpositive/union12.q.out
+++ b/ql/src/test/results/clientpositive/union12.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- union case: all subqueries are a map-reduce jobs, 3 way union
 create table tmptable(key string, value int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmptable
 POSTHOOK: query: -- union case: all subqueries are a map-reduce jobs, 3 way union, different inputs for all sub-queries, followed by filesink
 
 create table tmptable(key string, value int)
diff --git a/ql/src/test/results/clientpositive/union17.q.out b/ql/src/test/results/clientpositive/union17.q.out
index 72de5e1e8e..0e83c3cf0e 100644
--- a/ql/src/test/results/clientpositive/union17.q.out
+++ b/ql/src/test/results/clientpositive/union17.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE DEST1(key STRING, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@DEST1
 POSTHOOK: query: CREATE TABLE DEST1(key STRING, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@DEST1
 PREHOOK: query: CREATE TABLE DEST2(key STRING, val1 STRING, val2 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@DEST2
 POSTHOOK: query: CREATE TABLE DEST2(key STRING, val1 STRING, val2 STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/union18.q.out b/ql/src/test/results/clientpositive/union18.q.out
index 84227e7bfa..ac50e78ff5 100644
--- a/ql/src/test/results/clientpositive/union18.q.out
+++ b/ql/src/test/results/clientpositive/union18.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE DEST1(key STRING, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@DEST1
 POSTHOOK: query: CREATE TABLE DEST1(key STRING, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@DEST1
 PREHOOK: query: CREATE TABLE DEST2(key STRING, val1 STRING, val2 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@DEST2
 POSTHOOK: query: CREATE TABLE DEST2(key STRING, val1 STRING, val2 STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/union19.q.out b/ql/src/test/results/clientpositive/union19.q.out
index 2ab2a4987c..83e582d844 100644
--- a/ql/src/test/results/clientpositive/union19.q.out
+++ b/ql/src/test/results/clientpositive/union19.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE DEST1(key STRING, value STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@DEST1
 POSTHOOK: query: CREATE TABLE DEST1(key STRING, value STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@DEST1
 PREHOOK: query: CREATE TABLE DEST2(key STRING, val1 STRING, val2 STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@DEST2
 POSTHOOK: query: CREATE TABLE DEST2(key STRING, val1 STRING, val2 STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/union22.q.out b/ql/src/test/results/clientpositive/union22.q.out
index 884c1068f7..9b5f88ccc9 100644
--- a/ql/src/test/results/clientpositive/union22.q.out
+++ b/ql/src/test/results/clientpositive/union22.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- SORT_QUERY_RESULTS
 create table dst_union22(k1 string, k2 string, k3 string, k4 string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dst_union22
 POSTHOOK: query: -- SORT_QUERY_RESULTS
 
 create table dst_union22(k1 string, k2 string, k3 string, k4 string) partitioned by (ds string)
@@ -12,6 +13,7 @@ POSTHOOK: Output: default@dst_union22
 PREHOOK: query: create table dst_union22_delta(k0 string, k1 string, k2 string, k3 string, k4 string, k5 string) partitioned by (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dst_union22_delta
 POSTHOOK: query: create table dst_union22_delta(k0 string, k1 string, k2 string, k3 string, k4 string, k5 string) partitioned by (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/union25.q.out b/ql/src/test/results/clientpositive/union25.q.out
index c97cf289b2..5be298e945 100644
--- a/ql/src/test/results/clientpositive/union25.q.out
+++ b/ql/src/test/results/clientpositive/union25.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table tmp_srcpart like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmp_srcpart
 POSTHOOK: query: create table tmp_srcpart like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/union28.q.out b/ql/src/test/results/clientpositive/union28.q.out
index dfaef31dea..ec2e52fdba 100644
--- a/ql/src/test/results/clientpositive/union28.q.out
+++ b/ql/src/test/results/clientpositive/union28.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table union_subq_union(key int, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@union_subq_union
 POSTHOOK: query: create table union_subq_union(key int, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/union29.q.out b/ql/src/test/results/clientpositive/union29.q.out
index bec69162d1..9a5992278c 100644
--- a/ql/src/test/results/clientpositive/union29.q.out
+++ b/ql/src/test/results/clientpositive/union29.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table union_subq_union(key int, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@union_subq_union
 POSTHOOK: query: create table union_subq_union(key int, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/union3.q.out b/ql/src/test/results/clientpositive/union3.q.out
index 2553f8e252..327fb07d6b 100644
--- a/ql/src/test/results/clientpositive/union3.q.out
+++ b/ql/src/test/results/clientpositive/union3.q.out
@@ -280,6 +280,7 @@ STAGE PLANS:
 PREHOOK: query: CREATE TABLE union_out (id int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@union_out
 POSTHOOK: query: CREATE TABLE union_out (id int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/union30.q.out b/ql/src/test/results/clientpositive/union30.q.out
index 11468d1953..a375eca0b0 100644
--- a/ql/src/test/results/clientpositive/union30.q.out
+++ b/ql/src/test/results/clientpositive/union30.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table union_subq_union(key int, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@union_subq_union
 POSTHOOK: query: create table union_subq_union(key int, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/union31.q.out b/ql/src/test/results/clientpositive/union31.q.out
index 65910718ff..97bb535bba 100644
--- a/ql/src/test/results/clientpositive/union31.q.out
+++ b/ql/src/test/results/clientpositive/union31.q.out
@@ -27,6 +27,7 @@ POSTHOOK: Output: default@t2
 PREHOOK: query: create table t3(key string, cnt int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t3
 POSTHOOK: query: create table t3(key string, cnt int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -34,6 +35,7 @@ POSTHOOK: Output: default@t3
 PREHOOK: query: create table t4(value string, cnt int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t4
 POSTHOOK: query: create table t4(value string, cnt int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -293,6 +295,7 @@ val_9	2
 PREHOOK: query: create table t5(c1 string, cnt int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t5
 POSTHOOK: query: create table t5(c1 string, cnt int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -300,6 +303,7 @@ POSTHOOK: Output: default@t5
 PREHOOK: query: create table t6(c1 string, cnt int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t6
 POSTHOOK: query: create table t6(c1 string, cnt int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -608,6 +612,7 @@ POSTHOOK: Output: default@t2
 PREHOOK: query: create table t7(c1 string, cnt int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t7
 POSTHOOK: query: create table t7(c1 string, cnt int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -615,6 +620,7 @@ POSTHOOK: Output: default@t7
 PREHOOK: query: create table t8(c1 string, cnt int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t8
 POSTHOOK: query: create table t8(c1 string, cnt int)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/union33.q.out b/ql/src/test/results/clientpositive/union33.q.out
index 95632dc2a0..2075b791ee 100644
--- a/ql/src/test/results/clientpositive/union33.q.out
+++ b/ql/src/test/results/clientpositive/union33.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: -- This tests that a union all with a map only subquery on one s
 CREATE TABLE test_src (key STRING, value STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_src
 POSTHOOK: query: -- This tests that a union all with a map only subquery on one side and a 
 -- subquery involving two map reduce jobs on the other runs correctly.
 
diff --git a/ql/src/test/results/clientpositive/union34.q.out b/ql/src/test/results/clientpositive/union34.q.out
index d5224afbc4..dc46ac7b6c 100644
--- a/ql/src/test/results/clientpositive/union34.q.out
+++ b/ql/src/test/results/clientpositive/union34.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table src10_1 (key string, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src10_1
 POSTHOOK: query: create table src10_1 (key string, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@src10_1
 PREHOOK: query: create table src10_2 (key string, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src10_2
 POSTHOOK: query: create table src10_2 (key string, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -15,6 +17,7 @@ POSTHOOK: Output: default@src10_2
 PREHOOK: query: create table src10_3 (key string, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src10_3
 POSTHOOK: query: create table src10_3 (key string, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -22,6 +25,7 @@ POSTHOOK: Output: default@src10_3
 PREHOOK: query: create table src10_4 (key string, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src10_4
 POSTHOOK: query: create table src10_4 (key string, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/union4.q.out b/ql/src/test/results/clientpositive/union4.q.out
index d722a0a605..5b25e33205 100644
--- a/ql/src/test/results/clientpositive/union4.q.out
+++ b/ql/src/test/results/clientpositive/union4.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: -- union case: both subqueries are map-reduce jobs on same input
 create table tmptable(key string, value int)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmptable
 POSTHOOK: query: -- union case: both subqueries are map-reduce jobs on same input, followed by filesink
 
 
diff --git a/ql/src/test/results/clientpositive/union6.q.out b/ql/src/test/results/clientpositive/union6.q.out
index 386e65bf10..bfb5785268 100644
--- a/ql/src/test/results/clientpositive/union6.q.out
+++ b/ql/src/test/results/clientpositive/union6.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: -- union case: 1 subquery is a map-reduce job, different inputs
 create table tmptable(key string, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tmptable
 POSTHOOK: query: -- union case: 1 subquery is a map-reduce job, different inputs for sub-queries, followed by filesink
 
 
diff --git a/ql/src/test/results/clientpositive/union_date.q.out b/ql/src/test/results/clientpositive/union_date.q.out
index b4494bf1a8..7ac5c1cf2e 100644
--- a/ql/src/test/results/clientpositive/union_date.q.out
+++ b/ql/src/test/results/clientpositive/union_date.q.out
@@ -19,6 +19,7 @@ PREHOOK: query: create table union_date_1 (
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@union_date_1
 POSTHOOK: query: create table union_date_1 (
   ORIGIN_CITY_NAME string,
   DEST_CITY_NAME string,
@@ -38,6 +39,7 @@ PREHOOK: query: create table union_date_2 (
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@union_date_2
 POSTHOOK: query: create table union_date_2 (
   ORIGIN_CITY_NAME string,
   DEST_CITY_NAME string,
diff --git a/ql/src/test/results/clientpositive/union_lateralview.q.out b/ql/src/test/results/clientpositive/union_lateralview.q.out
index ead5eb2a74..63da998b49 100644
--- a/ql/src/test/results/clientpositive/union_lateralview.q.out
+++ b/ql/src/test/results/clientpositive/union_lateralview.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table test_union_lateral_view(key int, arr_ele int, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@test_union_lateral_view
 POSTHOOK: query: create table test_union_lateral_view(key int, arr_ele int, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/union_remove_1.q.out b/ql/src/test/results/clientpositive/union_remove_1.q.out
index e749edbaf2..6e03d4eb4e 100644
--- a/ql/src/test/results/clientpositive/union_remove_1.q.out
+++ b/ql/src/test/results/clientpositive/union_remove_1.q.out
@@ -11,6 +11,7 @@ PREHOOK: query: -- This is to test the union->selectstar->filesink optimization
 create table inputTbl1(key string, val string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@inputTbl1
 POSTHOOK: query: -- This is to test the union->selectstar->filesink optimization
 -- Union of 2 map-reduce subqueries is performed followed by select star and a file sink
 -- There is no need to write the temporary results of the sub-queries, and then read them 
@@ -28,6 +29,7 @@ POSTHOOK: Output: default@inputTbl1
 PREHOOK: query: create table outputTbl1(key string, values bigint) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@outputTbl1
 POSTHOOK: query: create table outputTbl1(key string, values bigint) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/union_remove_10.q.out b/ql/src/test/results/clientpositive/union_remove_10.q.out
index b283fd74e3..74b9e68683 100644
--- a/ql/src/test/results/clientpositive/union_remove_10.q.out
+++ b/ql/src/test/results/clientpositive/union_remove_10.q.out
@@ -15,6 +15,7 @@ PREHOOK: query: -- This is to test the union->selectstar->filesink optimization
 create table inputTbl1(key string, val string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@inputTbl1
 POSTHOOK: query: -- This is to test the union->selectstar->filesink optimization
 -- Union of 2 subqueries is performed (one of which is a map-only query, and the
 -- other one contains a nested union where one of the sub-queries requires a map-reduce
@@ -36,6 +37,7 @@ POSTHOOK: Output: default@inputTbl1
 PREHOOK: query: create table outputTbl1(key string, values bigint) stored as rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@outputTbl1
 POSTHOOK: query: create table outputTbl1(key string, values bigint) stored as rcfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/union_remove_11.q.out b/ql/src/test/results/clientpositive/union_remove_11.q.out
index 1af95c1fc7..e0bd4989a6 100644
--- a/ql/src/test/results/clientpositive/union_remove_11.q.out
+++ b/ql/src/test/results/clientpositive/union_remove_11.q.out
@@ -15,6 +15,7 @@ PREHOOK: query: -- This is to test the union->selectstar->filesink optimization
 create table inputTbl1(key string, val string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@inputTbl1
 POSTHOOK: query: -- This is to test the union->selectstar->filesink optimization
 -- Union of 2 subqueries is performed (one of which is a map-only query, and the
 -- other one contains a nested union where also contains map only sub-queries),
@@ -36,6 +37,7 @@ POSTHOOK: Output: default@inputTbl1
 PREHOOK: query: create table outputTbl1(key string, values bigint) stored as rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@outputTbl1
 POSTHOOK: query: create table outputTbl1(key string, values bigint) stored as rcfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/union_remove_12.q.out b/ql/src/test/results/clientpositive/union_remove_12.q.out
index 7d405f48b5..ada4883223 100644
--- a/ql/src/test/results/clientpositive/union_remove_12.q.out
+++ b/ql/src/test/results/clientpositive/union_remove_12.q.out
@@ -14,6 +14,7 @@ PREHOOK: query: -- This is to test the union->selectstar->filesink optimization
 create table inputTbl1(key string, val string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@inputTbl1
 POSTHOOK: query: -- This is to test the union->selectstar->filesink optimization
 -- Union of 2 subqueries is performed (one of which is a map-only query, and the
 -- other one is a map-join query), followed by select star and a file sink.
@@ -34,6 +35,7 @@ POSTHOOK: Output: default@inputTbl1
 PREHOOK: query: create table outputTbl1(key string, values bigint) stored as rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@outputTbl1
 POSTHOOK: query: create table outputTbl1(key string, values bigint) stored as rcfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/union_remove_13.q.out b/ql/src/test/results/clientpositive/union_remove_13.q.out
index 27c67f93d9..a160843b8b 100644
--- a/ql/src/test/results/clientpositive/union_remove_13.q.out
+++ b/ql/src/test/results/clientpositive/union_remove_13.q.out
@@ -14,6 +14,7 @@ PREHOOK: query: -- This is to test the union->selectstar->filesink optimization
 create table inputTbl1(key string, val string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@inputTbl1
 POSTHOOK: query: -- This is to test the union->selectstar->filesink optimization
 -- Union of 2 subqueries is performed (one of which is a mapred query, and the
 -- other one is a map-join query), followed by select star and a file sink.
@@ -34,6 +35,7 @@ POSTHOOK: Output: default@inputTbl1
 PREHOOK: query: create table outputTbl1(key string, values bigint) stored as rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@outputTbl1
 POSTHOOK: query: create table outputTbl1(key string, values bigint) stored as rcfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/union_remove_14.q.out b/ql/src/test/results/clientpositive/union_remove_14.q.out
index b949e5761a..cbb7ae8384 100644
--- a/ql/src/test/results/clientpositive/union_remove_14.q.out
+++ b/ql/src/test/results/clientpositive/union_remove_14.q.out
@@ -15,6 +15,7 @@ PREHOOK: query: -- This is to test the union->selectstar->filesink optimization
 create table inputTbl1(key string, val string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@inputTbl1
 POSTHOOK: query: -- This is to test the union->selectstar->filesink optimization
 -- Union of 2 subqueries is performed (one of which is a map-only query, and the
 -- other one contains a join, which should be performed as a map-join query at runtime),
@@ -36,6 +37,7 @@ POSTHOOK: Output: default@inputTbl1
 PREHOOK: query: create table outputTbl1(key string, values bigint) stored as rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@outputTbl1
 POSTHOOK: query: create table outputTbl1(key string, values bigint) stored as rcfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/union_remove_15.q.out b/ql/src/test/results/clientpositive/union_remove_15.q.out
index 43397b83db..902400d718 100644
--- a/ql/src/test/results/clientpositive/union_remove_15.q.out
+++ b/ql/src/test/results/clientpositive/union_remove_15.q.out
@@ -14,6 +14,7 @@ PREHOOK: query: -- This is to test the union->selectstar->filesink optimization
 create table inputTbl1(key string, val string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@inputTbl1
 POSTHOOK: query: -- This is to test the union->selectstar->filesink optimization
 -- Union of 2 map-reduce subqueries is performed followed by select star and a file sink
 -- and the results are written to a table using dynamic partitions.
@@ -34,6 +35,7 @@ POSTHOOK: Output: default@inputTbl1
 PREHOOK: query: create table outputTbl1(key string, values bigint) partitioned by (ds string) stored as rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@outputTbl1
 POSTHOOK: query: create table outputTbl1(key string, values bigint) partitioned by (ds string) stored as rcfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/union_remove_16.q.out b/ql/src/test/results/clientpositive/union_remove_16.q.out
index 722d5d210c..721caa08cf 100644
--- a/ql/src/test/results/clientpositive/union_remove_16.q.out
+++ b/ql/src/test/results/clientpositive/union_remove_16.q.out
@@ -13,6 +13,7 @@ PREHOOK: query: -- This is to test the union->selectstar->filesink optimization
 create table inputTbl1(key string, val string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@inputTbl1
 POSTHOOK: query: -- This is to test the union->selectstar->filesink optimization
 -- Union of 2 map-reduce subqueries is performed followed by select star and a file sink
 -- and the results are written to a table using dynamic partitions.
@@ -32,6 +33,7 @@ POSTHOOK: Output: default@inputTbl1
 PREHOOK: query: create table outputTbl1(key string, values bigint) partitioned by (ds string) stored as rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@outputTbl1
 POSTHOOK: query: create table outputTbl1(key string, values bigint) partitioned by (ds string) stored as rcfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/union_remove_17.q.out b/ql/src/test/results/clientpositive/union_remove_17.q.out
index 52e7940ceb..593ed06369 100644
--- a/ql/src/test/results/clientpositive/union_remove_17.q.out
+++ b/ql/src/test/results/clientpositive/union_remove_17.q.out
@@ -11,6 +11,7 @@ PREHOOK: query: -- This is to test the union->selectstar->filesink optimization
 create table inputTbl1(key string, val string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@inputTbl1
 POSTHOOK: query: -- This is to test the union->selectstar->filesink optimization
 -- Union of 2 map-reduce subqueries is performed followed by select star and a file sink
 -- and the results are written to a table using dynamic partitions.
@@ -28,6 +29,7 @@ POSTHOOK: Output: default@inputTbl1
 PREHOOK: query: create table outputTbl1(key string, values bigint) partitioned by (ds string) stored as rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@outputTbl1
 POSTHOOK: query: create table outputTbl1(key string, values bigint) partitioned by (ds string) stored as rcfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/union_remove_18.q.out b/ql/src/test/results/clientpositive/union_remove_18.q.out
index e1a0771ab3..eed4394764 100644
--- a/ql/src/test/results/clientpositive/union_remove_18.q.out
+++ b/ql/src/test/results/clientpositive/union_remove_18.q.out
@@ -13,6 +13,7 @@ PREHOOK: query: -- This is to test the union->selectstar->filesink optimization
 create table inputTbl1(key string, ds string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@inputTbl1
 POSTHOOK: query: -- This is to test the union->selectstar->filesink optimization
 -- Union of 2 map-reduce subqueries is performed followed by select star and a file sink
 -- There is no need to write the temporary results of the sub-queries, and then read them 
@@ -32,6 +33,7 @@ POSTHOOK: Output: default@inputTbl1
 PREHOOK: query: create table outputTbl1(key string, values bigint) partitioned by (ds string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@outputTbl1
 POSTHOOK: query: create table outputTbl1(key string, values bigint) partitioned by (ds string) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/union_remove_19.q.out b/ql/src/test/results/clientpositive/union_remove_19.q.out
index 2ea5f98184..939687b728 100644
--- a/ql/src/test/results/clientpositive/union_remove_19.q.out
+++ b/ql/src/test/results/clientpositive/union_remove_19.q.out
@@ -11,6 +11,7 @@ PREHOOK: query: -- This is to test the union->selectstar->filesink optimization
 create table inputTbl1(key string, val string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@inputTbl1
 POSTHOOK: query: -- This is to test the union->selectstar->filesink optimization
 -- Union of 2 map-reduce subqueries is performed followed by select star and a file sink
 -- There is no need to write the temporary results of the sub-queries, and then read them 
@@ -28,6 +29,7 @@ POSTHOOK: Output: default@inputTbl1
 PREHOOK: query: create table outputTbl1(key string, values bigint) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@outputTbl1
 POSTHOOK: query: create table outputTbl1(key string, values bigint) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/union_remove_2.q.out b/ql/src/test/results/clientpositive/union_remove_2.q.out
index 6905c5b390..1efdce6f85 100644
--- a/ql/src/test/results/clientpositive/union_remove_2.q.out
+++ b/ql/src/test/results/clientpositive/union_remove_2.q.out
@@ -12,6 +12,7 @@ PREHOOK: query: -- This is to test the union->selectstar->filesink optimization
 create table inputTbl1(key string, val string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@inputTbl1
 POSTHOOK: query: -- This is to test the union->selectstar->filesink optimization
 -- Union of 3 subqueries is performed (exactly one of which requires a map-reduce job)
 -- followed by select star and a file sink.
@@ -30,6 +31,7 @@ POSTHOOK: Output: default@inputTbl1
 PREHOOK: query: create table outputTbl1(key string, values bigint) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@outputTbl1
 POSTHOOK: query: create table outputTbl1(key string, values bigint) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/union_remove_20.q.out b/ql/src/test/results/clientpositive/union_remove_20.q.out
index b340e18996..bc90c08f15 100644
--- a/ql/src/test/results/clientpositive/union_remove_20.q.out
+++ b/ql/src/test/results/clientpositive/union_remove_20.q.out
@@ -12,6 +12,7 @@ PREHOOK: query: -- This is to test the union->selectstar->filesink optimization
 create table inputTbl1(key string, val string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@inputTbl1
 POSTHOOK: query: -- This is to test the union->selectstar->filesink optimization
 -- Union of 2 map-reduce subqueries is performed followed by select and a file sink
 -- However, the order of the columns in the select list is different. So, union cannot
@@ -30,6 +31,7 @@ POSTHOOK: Output: default@inputTbl1
 PREHOOK: query: create table outputTbl1(values bigint, key string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@outputTbl1
 POSTHOOK: query: create table outputTbl1(values bigint, key string) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/union_remove_21.q.out b/ql/src/test/results/clientpositive/union_remove_21.q.out
index f56d63e5bc..5734786945 100644
--- a/ql/src/test/results/clientpositive/union_remove_21.q.out
+++ b/ql/src/test/results/clientpositive/union_remove_21.q.out
@@ -12,6 +12,7 @@ PREHOOK: query: -- This is to test the union->selectstar->filesink optimization
 create table inputTbl1(key string, val string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@inputTbl1
 POSTHOOK: query: -- This is to test the union->selectstar->filesink optimization
 -- Union of 2 map-reduce subqueries is performed followed by select and a file sink
 -- However, all the columns are not selected. So, union cannot
@@ -30,6 +31,7 @@ POSTHOOK: Output: default@inputTbl1
 PREHOOK: query: create table outputTbl1(key string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@outputTbl1
 POSTHOOK: query: create table outputTbl1(key string) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/union_remove_22.q.out b/ql/src/test/results/clientpositive/union_remove_22.q.out
index d6cdbe062c..b835523da3 100644
--- a/ql/src/test/results/clientpositive/union_remove_22.q.out
+++ b/ql/src/test/results/clientpositive/union_remove_22.q.out
@@ -11,6 +11,7 @@ PREHOOK: query: -- This is to test the union->selectstar->filesink optimization
 create table inputTbl1(key string, val string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@inputTbl1
 POSTHOOK: query: -- This is to test the union->selectstar->filesink optimization
 -- Union of 2 map-reduce subqueries is performed followed by select and a file sink
 -- However, some columns are repeated. So, union cannot be removed.
@@ -28,6 +29,7 @@ POSTHOOK: Output: default@inputTbl1
 PREHOOK: query: create table outputTbl1(key string, values bigint, values2 bigint) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@outputTbl1
 POSTHOOK: query: create table outputTbl1(key string, values bigint, values2 bigint) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/union_remove_23.q.out b/ql/src/test/results/clientpositive/union_remove_23.q.out
index b50773fcbb..dd82b4f19f 100644
--- a/ql/src/test/results/clientpositive/union_remove_23.q.out
+++ b/ql/src/test/results/clientpositive/union_remove_23.q.out
@@ -12,6 +12,7 @@ PREHOOK: query: -- This is to test the union->selectstar->filesink optimization
 create table inputTbl1(key string, val string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@inputTbl1
 POSTHOOK: query: -- This is to test the union->selectstar->filesink optimization
 -- Union of 2 map-reduce subqueries is performed followed by select star and a file sink
 -- There is no need to write the temporary results of the sub-queries, and then read them 
@@ -30,6 +31,7 @@ POSTHOOK: Output: default@inputTbl1
 PREHOOK: query: create table outputTbl1(key string, values bigint) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@outputTbl1
 POSTHOOK: query: create table outputTbl1(key string, values bigint) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/union_remove_24.q.out b/ql/src/test/results/clientpositive/union_remove_24.q.out
index 2a53c681cc..38a68cf663 100644
--- a/ql/src/test/results/clientpositive/union_remove_24.q.out
+++ b/ql/src/test/results/clientpositive/union_remove_24.q.out
@@ -10,6 +10,7 @@ PREHOOK: query: -- This is to test the union->selectstar->filesink optimization
 create table inputTbl1(key string, val string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@inputTbl1
 POSTHOOK: query: -- This is to test the union->selectstar->filesink optimization
 -- Union of 2 map-reduce subqueries is performed followed by select star and a file sink
 -- There is no need to write the temporary results of the sub-queries, and then read them 
@@ -26,6 +27,7 @@ POSTHOOK: Output: default@inputTbl1
 PREHOOK: query: create table outputTbl1(key double, values bigint) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@outputTbl1
 POSTHOOK: query: create table outputTbl1(key double, values bigint) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/union_remove_25.q.out b/ql/src/test/results/clientpositive/union_remove_25.q.out
index 7751a4cc9f..a522a4cf99 100644
--- a/ql/src/test/results/clientpositive/union_remove_25.q.out
+++ b/ql/src/test/results/clientpositive/union_remove_25.q.out
@@ -11,6 +11,7 @@ PREHOOK: query: -- This is to test the union->selectstar->filesink optimization
 create table inputTbl1(key string, val string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@inputTbl1
 POSTHOOK: query: -- This is to test the union->selectstar->filesink optimization
 -- Union of 2 map-reduce subqueries is performed followed by select star and a file sink
 -- There is no need to write the temporary results of the sub-queries, and then read them 
@@ -28,6 +29,7 @@ POSTHOOK: Output: default@inputTbl1
 PREHOOK: query: create table outputTbl1(key string, values bigint) partitioned by (ds string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@outputTbl1
 POSTHOOK: query: create table outputTbl1(key string, values bigint) partitioned by (ds string) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -35,6 +37,7 @@ POSTHOOK: Output: default@outputTbl1
 PREHOOK: query: create table outputTbl2(key string, values bigint) partitioned by (ds string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@outputTbl2
 POSTHOOK: query: create table outputTbl2(key string, values bigint) partitioned by (ds string) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -42,6 +45,7 @@ POSTHOOK: Output: default@outputTbl2
 PREHOOK: query: create table outputTbl3(key string, values bigint) partitioned by (ds string,hr string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@outputTbl3
 POSTHOOK: query: create table outputTbl3(key string, values bigint) partitioned by (ds string,hr string) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/union_remove_3.q.out b/ql/src/test/results/clientpositive/union_remove_3.q.out
index fce7354431..bda484b80b 100644
--- a/ql/src/test/results/clientpositive/union_remove_3.q.out
+++ b/ql/src/test/results/clientpositive/union_remove_3.q.out
@@ -12,6 +12,7 @@ PREHOOK: query: -- This is to test the union->remove->filesink optimization
 create table inputTbl1(key string, val string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@inputTbl1
 POSTHOOK: query: -- This is to test the union->remove->filesink optimization
 -- Union of 3 subqueries is performed (all of which are map-only queries)
 -- followed by select star and a file sink.
@@ -30,6 +31,7 @@ POSTHOOK: Output: default@inputTbl1
 PREHOOK: query: create table outputTbl1(key string, values bigint) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@outputTbl1
 POSTHOOK: query: create table outputTbl1(key string, values bigint) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/union_remove_4.q.out b/ql/src/test/results/clientpositive/union_remove_4.q.out
index 8ce76f0e13..f27f6b72fe 100644
--- a/ql/src/test/results/clientpositive/union_remove_4.q.out
+++ b/ql/src/test/results/clientpositive/union_remove_4.q.out
@@ -11,6 +11,7 @@ PREHOOK: query: -- This is to test the union->selectstar->filesink optimization
 create table inputTbl1(key string, val string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@inputTbl1
 POSTHOOK: query: -- This is to test the union->selectstar->filesink optimization
 -- Union of 2 map-reduce subqueries is performed followed by select star and a file sink
 -- There is no need to write the temporary results of the sub-queries, and then read them 
@@ -28,6 +29,7 @@ POSTHOOK: Output: default@inputTbl1
 PREHOOK: query: create table outputTbl1(key string, values bigint) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@outputTbl1
 POSTHOOK: query: create table outputTbl1(key string, values bigint) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/union_remove_5.q.out b/ql/src/test/results/clientpositive/union_remove_5.q.out
index e8d306c535..a6d7b3daf6 100644
--- a/ql/src/test/results/clientpositive/union_remove_5.q.out
+++ b/ql/src/test/results/clientpositive/union_remove_5.q.out
@@ -13,6 +13,7 @@ PREHOOK: query: -- This is to test the union->selectstar->filesink optimization
 create table inputTbl1(key string, val string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@inputTbl1
 POSTHOOK: query: -- This is to test the union->selectstar->filesink optimization
 -- Union of 3 subqueries is performed (exactly one of which requires a map-reduce job)
 -- followed by select star and a file sink.
@@ -32,6 +33,7 @@ POSTHOOK: Output: default@inputTbl1
 PREHOOK: query: create table outputTbl1(key string, values bigint) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@outputTbl1
 POSTHOOK: query: create table outputTbl1(key string, values bigint) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/union_remove_6.q.out b/ql/src/test/results/clientpositive/union_remove_6.q.out
index 89cef49093..a9d2e8b9d9 100644
--- a/ql/src/test/results/clientpositive/union_remove_6.q.out
+++ b/ql/src/test/results/clientpositive/union_remove_6.q.out
@@ -8,6 +8,7 @@ PREHOOK: query: -- This is to test the union->selectstar->filesink optimization
 create table inputTbl1(key string, val string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@inputTbl1
 POSTHOOK: query: -- This is to test the union->selectstar->filesink optimization
 -- Union of 2 subqueries is performed (all of which are mapred queries)
 -- followed by select star and a file sink in 2 output tables.
@@ -22,6 +23,7 @@ POSTHOOK: Output: default@inputTbl1
 PREHOOK: query: create table outputTbl1(key string, values bigint) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@outputTbl1
 POSTHOOK: query: create table outputTbl1(key string, values bigint) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -29,6 +31,7 @@ POSTHOOK: Output: default@outputTbl1
 PREHOOK: query: create table outputTbl2(key string, values bigint) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@outputTbl2
 POSTHOOK: query: create table outputTbl2(key string, values bigint) stored as textfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/union_remove_7.q.out b/ql/src/test/results/clientpositive/union_remove_7.q.out
index b978a17367..6a28b95d48 100644
--- a/ql/src/test/results/clientpositive/union_remove_7.q.out
+++ b/ql/src/test/results/clientpositive/union_remove_7.q.out
@@ -13,6 +13,7 @@ PREHOOK: query: -- This is to test the union->selectstar->filesink optimization
 create table inputTbl1(key string, val string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@inputTbl1
 POSTHOOK: query: -- This is to test the union->selectstar->filesink optimization
 -- Union of 2 map-reduce subqueries is performed followed by select star and a file sink
 -- There is no need to write the temporary results of the sub-queries, and then read them 
@@ -32,6 +33,7 @@ POSTHOOK: Output: default@inputTbl1
 PREHOOK: query: create table outputTbl1(key string, values bigint) stored as rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@outputTbl1
 POSTHOOK: query: create table outputTbl1(key string, values bigint) stored as rcfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/union_remove_8.q.out b/ql/src/test/results/clientpositive/union_remove_8.q.out
index 390bccaa56..a688cff4e3 100644
--- a/ql/src/test/results/clientpositive/union_remove_8.q.out
+++ b/ql/src/test/results/clientpositive/union_remove_8.q.out
@@ -14,6 +14,7 @@ PREHOOK: query: -- This is to test the union->selectstar->filesink optimization
 create table inputTbl1(key string, val string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@inputTbl1
 POSTHOOK: query: -- This is to test the union->selectstar->filesink optimization
 -- Union of 3 subqueries is performed (exactly one of which requires a map-reduce job)
 -- followed by select star and a file sink.
@@ -34,6 +35,7 @@ POSTHOOK: Output: default@inputTbl1
 PREHOOK: query: create table outputTbl1(key string, values bigint) stored as rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@outputTbl1
 POSTHOOK: query: create table outputTbl1(key string, values bigint) stored as rcfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/union_remove_9.q.out b/ql/src/test/results/clientpositive/union_remove_9.q.out
index 087b5f7158..5a9c5a2af9 100644
--- a/ql/src/test/results/clientpositive/union_remove_9.q.out
+++ b/ql/src/test/results/clientpositive/union_remove_9.q.out
@@ -13,6 +13,7 @@ PREHOOK: query: -- This is to test the union->selectstar->filesink optimization
 create table inputTbl1(key string, val string) stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@inputTbl1
 POSTHOOK: query: -- This is to test the union->selectstar->filesink optimization
 -- Union of 2 subqueries is performed (one of which contains a union and is map-only),
 -- and the other one is a map-reduce query followed by select star and a file sink.
@@ -32,6 +33,7 @@ POSTHOOK: Output: default@inputTbl1
 PREHOOK: query: create table outputTbl1(key string, values bigint) stored as rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@outputTbl1
 POSTHOOK: query: create table outputTbl1(key string, values bigint) stored as rcfile
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/union_view.q.out b/ql/src/test/results/clientpositive/union_view.q.out
index 31c19eef1c..5c32ad6b97 100644
--- a/ql/src/test/results/clientpositive/union_view.q.out
+++ b/ql/src/test/results/clientpositive/union_view.q.out
@@ -1,38 +1,47 @@
 PREHOOK: query: CREATE TABLE src_union_1 (key int, value string) PARTITIONED BY (ds string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_union_1
 POSTHOOK: query: CREATE TABLE src_union_1 (key int, value string) PARTITIONED BY (ds string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@src_union_1
 PREHOOK: query: CREATE INDEX src_union_1_key_idx ON TABLE src_union_1(key) AS 'COMPACT' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@src_union_1
 POSTHOOK: query: CREATE INDEX src_union_1_key_idx ON TABLE src_union_1(key) AS 'COMPACT' WITH DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@src_union_1
 POSTHOOK: Output: default@default__src_union_1_src_union_1_key_idx__
 PREHOOK: query: CREATE TABLE src_union_2 (key int, value string) PARTITIONED BY (ds string, part_1 string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_union_2
 POSTHOOK: query: CREATE TABLE src_union_2 (key int, value string) PARTITIONED BY (ds string, part_1 string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@src_union_2
 PREHOOK: query: CREATE INDEX src_union_2_key_idx ON TABLE src_union_2(key) AS 'COMPACT' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@src_union_2
 POSTHOOK: query: CREATE INDEX src_union_2_key_idx ON TABLE src_union_2(key) AS 'COMPACT' WITH DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@src_union_2
 POSTHOOK: Output: default@default__src_union_2_src_union_2_key_idx__
 PREHOOK: query: CREATE TABLE src_union_3(key int, value string) PARTITIONED BY (ds string, part_1 string, part_2 string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_union_3
 POSTHOOK: query: CREATE TABLE src_union_3(key int, value string) PARTITIONED BY (ds string, part_1 string, part_2 string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@src_union_3
 PREHOOK: query: CREATE INDEX src_union_3_key_idx ON TABLE src_union_3(key) AS 'COMPACT' WITH DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
+PREHOOK: Input: default@src_union_3
 POSTHOOK: query: CREATE INDEX src_union_3_key_idx ON TABLE src_union_3(key) AS 'COMPACT' WITH DEFERRED REBUILD
 POSTHOOK: type: CREATEINDEX
+POSTHOOK: Input: default@src_union_3
 POSTHOOK: Output: default@default__src_union_3_src_union_3_key_idx__
 STAGE DEPENDENCIES:
   Stage-3 is a root stage
diff --git a/ql/src/test/results/clientpositive/uniquejoin.q.out b/ql/src/test/results/clientpositive/uniquejoin.q.out
index 519b603d0c..b6d3553395 100644
--- a/ql/src/test/results/clientpositive/uniquejoin.q.out
+++ b/ql/src/test/results/clientpositive/uniquejoin.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE T1(key STRING, val STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T1
 POSTHOOK: query: CREATE TABLE T1(key STRING, val STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -8,6 +9,7 @@ POSTHOOK: Output: default@T1
 PREHOOK: query: CREATE TABLE T2(key STRING, val STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T2
 POSTHOOK: query: CREATE TABLE T2(key STRING, val STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -15,6 +17,7 @@ POSTHOOK: Output: default@T2
 PREHOOK: query: CREATE TABLE T3(key STRING, val STRING) STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@T3
 POSTHOOK: query: CREATE TABLE T3(key STRING, val STRING) STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/unset_table_view_property.q.out b/ql/src/test/results/clientpositive/unset_table_view_property.q.out
index d309fbcbff..8cf6686050 100644
--- a/ql/src/test/results/clientpositive/unset_table_view_property.q.out
+++ b/ql/src/test/results/clientpositive/unset_table_view_property.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE testTable(col1 INT, col2 INT)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@testTable
 POSTHOOK: query: CREATE TABLE testTable(col1 INT, col2 INT)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/updateAccessTime.q.out b/ql/src/test/results/clientpositive/updateAccessTime.q.out
index 02895564ef..08d697c5fd 100644
--- a/ql/src/test/results/clientpositive/updateAccessTime.q.out
+++ b/ql/src/test/results/clientpositive/updateAccessTime.q.out
@@ -53,6 +53,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table tstsrcpart like srcpart
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@tstsrcpart
 POSTHOOK: query: create table tstsrcpart like srcpart
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/varchar_1.q.out b/ql/src/test/results/clientpositive/varchar_1.q.out
index 9274c23785..8c9f59f1cc 100644
--- a/ql/src/test/results/clientpositive/varchar_1.q.out
+++ b/ql/src/test/results/clientpositive/varchar_1.q.out
@@ -9,6 +9,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table varchar1 (key varchar(10), value varchar(20))
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@varchar1
 POSTHOOK: query: create table varchar1 (key varchar(10), value varchar(20))
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -16,6 +17,7 @@ POSTHOOK: Output: default@varchar1
 PREHOOK: query: create table varchar1_1 (key string, value string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@varchar1_1
 POSTHOOK: query: create table varchar1_1 (key string, value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/varchar_2.q.out b/ql/src/test/results/clientpositive/varchar_2.q.out
index 577d5a38ba..db819c7229 100644
--- a/ql/src/test/results/clientpositive/varchar_2.q.out
+++ b/ql/src/test/results/clientpositive/varchar_2.q.out
@@ -8,6 +8,7 @@ PREHOOK: query: create table varchar_2 (
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@varchar_2
 POSTHOOK: query: create table varchar_2 (
   key varchar(10),
   value varchar(20)
diff --git a/ql/src/test/results/clientpositive/varchar_join1.q.out b/ql/src/test/results/clientpositive/varchar_join1.q.out
index 94084d8c1a..9736fb1daf 100644
--- a/ql/src/test/results/clientpositive/varchar_join1.q.out
+++ b/ql/src/test/results/clientpositive/varchar_join1.q.out
@@ -16,6 +16,7 @@ PREHOOK: query: create table  varchar_join1_vc1 (
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@varchar_join1_vc1
 POSTHOOK: query: create table  varchar_join1_vc1 (
   c1 int,
   c2 varchar(10)
@@ -29,6 +30,7 @@ PREHOOK: query: create table  varchar_join1_vc2 (
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@varchar_join1_vc2
 POSTHOOK: query: create table  varchar_join1_vc2 (
   c1 int,
   c2 varchar(20)
@@ -42,6 +44,7 @@ PREHOOK: query: create table  varchar_join1_str (
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@varchar_join1_str
 POSTHOOK: query: create table  varchar_join1_str (
   c1 int,
   c2 string
diff --git a/ql/src/test/results/clientpositive/varchar_nested_types.q.out b/ql/src/test/results/clientpositive/varchar_nested_types.q.out
index bd44039e34..55bd96702e 100644
--- a/ql/src/test/results/clientpositive/varchar_nested_types.q.out
+++ b/ql/src/test/results/clientpositive/varchar_nested_types.q.out
@@ -25,6 +25,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table varchar_nested_1 (key int, value varchar(20))
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@varchar_nested_1
 POSTHOOK: query: create table varchar_nested_1 (key int, value varchar(20))
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -45,6 +46,7 @@ PREHOOK: query: -- arrays
 create table varchar_nested_array (c1 array<varchar(20)>)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@varchar_nested_array
 POSTHOOK: query: -- arrays
 create table varchar_nested_array (c1 array<varchar(20)>)
 POSTHOOK: type: CREATETABLE
@@ -81,6 +83,7 @@ PREHOOK: query: -- maps
 create table varchar_nested_map (c1 map<int, varchar(20)>)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@varchar_nested_map
 POSTHOOK: query: -- maps
 create table varchar_nested_map (c1 map<int, varchar(20)>)
 POSTHOOK: type: CREATETABLE
@@ -117,6 +120,7 @@ PREHOOK: query: -- structs
 create table varchar_nested_struct (c1 struct<a:int, b:varchar(20), c:string>)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@varchar_nested_struct
 POSTHOOK: query: -- structs
 create table varchar_nested_struct (c1 struct<a:int, b:varchar(20), c:string>)
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/varchar_serde.q.out b/ql/src/test/results/clientpositive/varchar_serde.q.out
index 946a3ef4aa..5f3f2edef8 100644
--- a/ql/src/test/results/clientpositive/varchar_serde.q.out
+++ b/ql/src/test/results/clientpositive/varchar_serde.q.out
@@ -36,6 +36,7 @@ with serdeproperties (
 stored as textfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@varchar_serde_regex
 POSTHOOK: query: --
 -- RegexSerDe
 --
@@ -94,6 +95,7 @@ create table  varchar_serde_lb (
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@varchar_serde_lb
 POSTHOOK: query: --
 -- LazyBinary
 --
@@ -159,6 +161,7 @@ create table  varchar_serde_ls (
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@varchar_serde_ls
 POSTHOOK: query: --
 -- LazySimple
 --
@@ -224,6 +227,7 @@ create table  varchar_serde_c (
 ) stored as rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@varchar_serde_c
 POSTHOOK: query: --
 -- Columnar
 --
@@ -289,6 +293,7 @@ create table varchar_serde_lbc (
 ) stored as rcfile
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@varchar_serde_lbc
 POSTHOOK: query: --
 -- LazyBinaryColumnar
 --
@@ -354,6 +359,7 @@ create table varchar_serde_orc (
 ) stored as orc
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@varchar_serde_orc
 POSTHOOK: query: --
 -- ORC
 --
diff --git a/ql/src/test/results/clientpositive/varchar_udf1.q.out b/ql/src/test/results/clientpositive/varchar_udf1.q.out
index 0a35448405..842bd38cb5 100644
--- a/ql/src/test/results/clientpositive/varchar_udf1.q.out
+++ b/ql/src/test/results/clientpositive/varchar_udf1.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: create table varchar_udf_1 (c1 string, c2 string, c3 varchar(10), c4 varchar(20))
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@varchar_udf_1
 POSTHOOK: query: create table varchar_udf_1 (c1 string, c2 string, c3 varchar(10), c4 varchar(20))
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/varchar_union1.q.out b/ql/src/test/results/clientpositive/varchar_union1.q.out
index 4616827b5c..ac4e86c0c7 100644
--- a/ql/src/test/results/clientpositive/varchar_union1.q.out
+++ b/ql/src/test/results/clientpositive/varchar_union1.q.out
@@ -16,6 +16,7 @@ PREHOOK: query: create table  varchar_union1_vc1 (
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@varchar_union1_vc1
 POSTHOOK: query: create table  varchar_union1_vc1 (
   c1 int,
   c2 varchar(10)
@@ -29,6 +30,7 @@ PREHOOK: query: create table  varchar_union1_vc2 (
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@varchar_union1_vc2
 POSTHOOK: query: create table  varchar_union1_vc2 (
   c1 int,
   c2 varchar(20)
@@ -42,6 +44,7 @@ PREHOOK: query: create table  varchar_union1_str (
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@varchar_union1_str
 POSTHOOK: query: create table  varchar_union1_str (
   c1 int,
   c2 string
diff --git a/ql/src/test/results/clientpositive/vector_cast_constant.q.out b/ql/src/test/results/clientpositive/vector_cast_constant.q.out
index c8ff2787dd..6ea3b54f46 100644
--- a/ql/src/test/results/clientpositive/vector_cast_constant.q.out
+++ b/ql/src/test/results/clientpositive/vector_cast_constant.q.out
@@ -22,6 +22,7 @@ ROW FORMAT DELIMITED FIELDS TERMINATED BY '|'
 STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@over1k
 POSTHOOK: query: -- data setup
 CREATE TABLE over1k(t tinyint,
            si smallint,
@@ -61,6 +62,7 @@ PREHOOK: query: CREATE TABLE over1korc(t tinyint,
 STORED AS ORC
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@over1korc
 POSTHOOK: query: CREATE TABLE over1korc(t tinyint,
            si smallint,
            i int,
diff --git a/ql/src/test/results/clientpositive/vector_data_types.q.out b/ql/src/test/results/clientpositive/vector_data_types.q.out
index 007f4e8a78..a1183ad769 100644
--- a/ql/src/test/results/clientpositive/vector_data_types.q.out
+++ b/ql/src/test/results/clientpositive/vector_data_types.q.out
@@ -22,6 +22,7 @@ ROW FORMAT DELIMITED FIELDS TERMINATED BY '|'
 STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@over1k
 POSTHOOK: query: -- data setup
 CREATE TABLE over1k(t tinyint,
            si smallint,
@@ -61,6 +62,7 @@ PREHOOK: query: CREATE TABLE over1korc(t tinyint,
 STORED AS ORC
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@over1korc
 POSTHOOK: query: CREATE TABLE over1korc(t tinyint,
            si smallint,
            i int,
diff --git a/ql/src/test/results/clientpositive/vector_non_string_partition.q.out b/ql/src/test/results/clientpositive/vector_non_string_partition.q.out
index bbe0a57bb3..bf2e432f07 100644
--- a/ql/src/test/results/clientpositive/vector_non_string_partition.q.out
+++ b/ql/src/test/results/clientpositive/vector_non_string_partition.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE non_string_part(cint INT, cstring1 STRING, cdouble DOUBLE, ctimestamp1 TIMESTAMP) PARTITIONED BY (ctinyint tinyint) STORED AS ORC
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@non_string_part
 POSTHOOK: query: CREATE TABLE non_string_part(cint INT, cstring1 STRING, cdouble DOUBLE, ctimestamp1 TIMESTAMP) PARTITIONED BY (ctinyint tinyint) STORED AS ORC
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/vector_string_concat.q.out b/ql/src/test/results/clientpositive/vector_string_concat.q.out
index d3046a7bbf..f8e6cb4904 100644
--- a/ql/src/test/results/clientpositive/vector_string_concat.q.out
+++ b/ql/src/test/results/clientpositive/vector_string_concat.q.out
@@ -22,6 +22,7 @@ ROW FORMAT DELIMITED FIELDS TERMINATED BY '|'
 STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@over1k
 POSTHOOK: query: -- data setup
 CREATE TABLE over1k(t tinyint,
            si smallint,
@@ -61,6 +62,7 @@ PREHOOK: query: CREATE TABLE over1korc(t tinyint,
 STORED AS ORC
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@over1korc
 POSTHOOK: query: CREATE TABLE over1korc(t tinyint,
            si smallint,
            i int,
diff --git a/ql/src/test/results/clientpositive/vectorization_part.q.out b/ql/src/test/results/clientpositive/vectorization_part.q.out
index 7ed1858427..66facc9406 100644
--- a/ql/src/test/results/clientpositive/vectorization_part.q.out
+++ b/ql/src/test/results/clientpositive/vectorization_part.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE alltypesorc_part(ctinyint tinyint, csmallint smallint, cint int, cbigint bigint, cfloat float, cdouble double, cstring1 string, cstring2 string, ctimestamp1 timestamp, ctimestamp2 timestamp, cboolean1 boolean, cboolean2 boolean) partitioned by (ds string) STORED AS ORC
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@alltypesorc_part
 POSTHOOK: query: CREATE TABLE alltypesorc_part(ctinyint tinyint, csmallint smallint, cint int, cbigint bigint, cfloat float, cdouble double, cstring1 string, cstring2 string, ctimestamp1 timestamp, ctimestamp2 timestamp, cboolean1 boolean, cboolean2 boolean) partitioned by (ds string) STORED AS ORC
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/vectorization_part_project.q.out b/ql/src/test/results/clientpositive/vectorization_part_project.q.out
index 53917db42c..d2c2c3882c 100644
--- a/ql/src/test/results/clientpositive/vectorization_part_project.q.out
+++ b/ql/src/test/results/clientpositive/vectorization_part_project.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: CREATE TABLE alltypesorc_part(ctinyint tinyint, csmallint smallint, cint int, cbigint bigint, cfloat float, cdouble double, cstring1 string, cstring2 string, ctimestamp1 timestamp, ctimestamp2 timestamp, cboolean1 boolean, cboolean2 boolean) partitioned by (ds string) STORED AS ORC
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@alltypesorc_part
 POSTHOOK: query: CREATE TABLE alltypesorc_part(ctinyint tinyint, csmallint smallint, cint int, cbigint bigint, cfloat float, cdouble double, cstring1 string, cstring2 string, ctimestamp1 timestamp, ctimestamp2 timestamp, cboolean1 boolean, cboolean2 boolean) partitioned by (ds string) STORED AS ORC
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/vectorized_bucketmapjoin1.q.out b/ql/src/test/results/clientpositive/vectorized_bucketmapjoin1.q.out
index 33b5b3bee1..ea711e9bba 100644
--- a/ql/src/test/results/clientpositive/vectorized_bucketmapjoin1.q.out
+++ b/ql/src/test/results/clientpositive/vectorized_bucketmapjoin1.q.out
@@ -4,6 +4,7 @@ PREHOOK: query: create table vsmb_bucket_1(key int, value string)
   STORED AS ORC
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@vsmb_bucket_1
 POSTHOOK: query: create table vsmb_bucket_1(key int, value string) 
   CLUSTERED BY (key) 
   SORTED BY (key) INTO 1 BUCKETS 
@@ -17,6 +18,7 @@ PREHOOK: query: create table vsmb_bucket_2(key int, value string)
   STORED AS ORC
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@vsmb_bucket_2
 POSTHOOK: query: create table vsmb_bucket_2(key int, value string) 
   CLUSTERED BY (key) 
   SORTED BY (key) INTO 1 BUCKETS 
@@ -30,6 +32,7 @@ PREHOOK: query: create table vsmb_bucket_RC(key int, value string)
   STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@vsmb_bucket_RC
 POSTHOOK: query: create table vsmb_bucket_RC(key int, value string) 
   CLUSTERED BY (key) 
   SORTED BY (key) INTO 1 BUCKETS 
@@ -43,6 +46,7 @@ PREHOOK: query: create table vsmb_bucket_TXT(key int, value string)
   STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@vsmb_bucket_TXT
 POSTHOOK: query: create table vsmb_bucket_TXT(key int, value string) 
   CLUSTERED BY (key) 
   SORTED BY (key) INTO 1 BUCKETS 
diff --git a/ql/src/test/results/clientpositive/vectorized_context.q.out b/ql/src/test/results/clientpositive/vectorized_context.q.out
index af238b0341..dd54a5e47f 100644
--- a/ql/src/test/results/clientpositive/vectorized_context.q.out
+++ b/ql/src/test/results/clientpositive/vectorized_context.q.out
@@ -2,6 +2,7 @@ PREHOOK: query: create table store(s_store_sk int, s_city string)
 stored as orc
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@store
 POSTHOOK: query: create table store(s_store_sk int, s_city string)
 stored as orc
 POSTHOOK: type: CREATETABLE
@@ -29,6 +30,7 @@ PREHOOK: query: create table store_sales(ss_store_sk int, ss_hdemo_sk int, ss_ne
 stored as orc
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@store_sales
 POSTHOOK: query: create table store_sales(ss_store_sk int, ss_hdemo_sk int, ss_net_profit double)
 stored as orc
 POSTHOOK: type: CREATETABLE
@@ -57,6 +59,7 @@ PREHOOK: query: create table household_demographics(hd_demo_sk int)
 stored as orc
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@household_demographics
 POSTHOOK: query: create table household_demographics(hd_demo_sk int)
 stored as orc
 POSTHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/vectorized_date_funcs.q.out b/ql/src/test/results/clientpositive/vectorized_date_funcs.q.out
index c2800a5bb1..ef30a0c7fa 100644
--- a/ql/src/test/results/clientpositive/vectorized_date_funcs.q.out
+++ b/ql/src/test/results/clientpositive/vectorized_date_funcs.q.out
@@ -9,6 +9,7 @@ CREATE TABLE date_udf_flight (
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@date_udf_flight
 POSTHOOK: query: -- Test timestamp functions in vectorized mode to verify they run correctly end-to-end.
 
 CREATE TABLE date_udf_flight (
@@ -35,6 +36,7 @@ PREHOOK: query: CREATE TABLE date_udf_flight_orc (
 ) STORED AS ORC
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@date_udf_flight_orc
 POSTHOOK: query: CREATE TABLE date_udf_flight_orc (
   fl_date DATE,
   fl_time TIMESTAMP
diff --git a/ql/src/test/results/clientpositive/vectorized_distinct_gby.q.out b/ql/src/test/results/clientpositive/vectorized_distinct_gby.q.out
index af84d5e6c1..546665b823 100644
--- a/ql/src/test/results/clientpositive/vectorized_distinct_gby.q.out
+++ b/ql/src/test/results/clientpositive/vectorized_distinct_gby.q.out
@@ -1,6 +1,7 @@
 PREHOOK: query: create table dtest(a int, b int) clustered by (a) sorted by (a) into 1 buckets stored as orc
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@dtest
 POSTHOOK: query: create table dtest(a int, b int) clustered by (a) sorted by (a) into 1 buckets stored as orc
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/vectorized_parquet.q.out b/ql/src/test/results/clientpositive/vectorized_parquet.q.out
index 2b22814311..a81a9b3017 100644
--- a/ql/src/test/results/clientpositive/vectorized_parquet.q.out
+++ b/ql/src/test/results/clientpositive/vectorized_parquet.q.out
@@ -7,6 +7,7 @@ PREHOOK: query: create table if not exists alltypes_parquet (
   cstring1 string) stored as parquet
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@alltypes_parquet
 POSTHOOK: query: create table if not exists alltypes_parquet (
   cint int, 
   ctinyint tinyint, 
diff --git a/ql/src/test/results/clientpositive/vectorized_ptf.q.out b/ql/src/test/results/clientpositive/vectorized_ptf.q.out
index 35fb66340b..d847337963 100644
--- a/ql/src/test/results/clientpositive/vectorized_ptf.q.out
+++ b/ql/src/test/results/clientpositive/vectorized_ptf.q.out
@@ -24,6 +24,7 @@ CREATE TABLE part_staging(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part_staging
 POSTHOOK: query: -- NOTE: This test is a copy of ptf.
 -- NOTE: We cannot vectorize "pure" table functions (e.g. NOOP) -- given their blackbox nature. So only queries without table functions and
 -- NOTE: with windowing will be vectorized.
@@ -64,6 +65,7 @@ PREHOOK: query: CREATE TABLE part(
 ) STORED AS ORC
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part
 POSTHOOK: query: CREATE TABLE part( 
     p_partkey INT,
     p_name STRING,
@@ -5692,6 +5694,7 @@ dr INT,
 s DOUBLE)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part_4
 POSTHOOK: query: -- 17. testMultipleInserts2SWQsWithPTF
 CREATE TABLE part_4( 
 p_mfgr STRING, 
@@ -5714,6 +5717,7 @@ cud DOUBLE,
 fv1 INT)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part_5
 POSTHOOK: query: CREATE TABLE part_5( 
 p_mfgr STRING, 
 p_name STRING, 
diff --git a/ql/src/test/results/clientpositive/vectorized_rcfile_columnar.q.out b/ql/src/test/results/clientpositive/vectorized_rcfile_columnar.q.out
index d6fb0bb8ff..ee8959be94 100644
--- a/ql/src/test/results/clientpositive/vectorized_rcfile_columnar.q.out
+++ b/ql/src/test/results/clientpositive/vectorized_rcfile_columnar.q.out
@@ -9,6 +9,7 @@ STORED AS
   OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.RCFileOutputFormat'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@columnTable
 POSTHOOK: query: --This query must pass even when vectorized reader is not available for
 --RC files. The query must fall back to the non-vector mode and run successfully.
 
diff --git a/ql/src/test/results/clientpositive/vectorized_timestamp_funcs.q.out b/ql/src/test/results/clientpositive/vectorized_timestamp_funcs.q.out
index 08e3c49a14..89ea70dde5 100644
--- a/ql/src/test/results/clientpositive/vectorized_timestamp_funcs.q.out
+++ b/ql/src/test/results/clientpositive/vectorized_timestamp_funcs.q.out
@@ -3,6 +3,7 @@ PREHOOK: query: -- Test timestamp functions in vectorized mode to verify they ru
 CREATE TABLE alltypesorc_string(ctimestamp1 timestamp, stimestamp1 string) STORED AS ORC
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@alltypesorc_string
 POSTHOOK: query: -- Test timestamp functions in vectorized mode to verify they run correctly end-to-end.
 
 CREATE TABLE alltypesorc_string(ctimestamp1 timestamp, stimestamp1 string) STORED AS ORC
@@ -32,6 +33,7 @@ POSTHOOK: Lineage: alltypesorc_string.stimestamp1 EXPRESSION [(alltypesorc)allty
 PREHOOK: query: CREATE TABLE alltypesorc_wrong(stimestamp1 string) STORED AS ORC
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@alltypesorc_wrong
 POSTHOOK: query: CREATE TABLE alltypesorc_wrong(stimestamp1 string) STORED AS ORC
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/view.q.out b/ql/src/test/results/clientpositive/view.q.out
index c45301d303..0dce318b65 100644
--- a/ql/src/test/results/clientpositive/view.q.out
+++ b/ql/src/test/results/clientpositive/view.q.out
@@ -1,15 +1,20 @@
 PREHOOK: query: CREATE DATABASE db1
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:db1
 POSTHOOK: query: CREATE DATABASE db1
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:db1
 PREHOOK: query: USE db1
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:db1
 POSTHOOK: query: USE db1
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:db1
 PREHOOK: query: CREATE TABLE table1 (key STRING, value STRING)
 STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:db1
+PREHOOK: Output: db1@table1
 POSTHOOK: query: CREATE TABLE table1 (key STRING, value STRING)
 STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
@@ -29,6 +34,7 @@ PREHOOK: query: CREATE TABLE table2 (key STRING, value STRING)
 STORED AS TEXTFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:db1
+PREHOOK: Output: db1@table2
 POSTHOOK: query: CREATE TABLE table2 (key STRING, value STRING)
 STORED AS TEXTFILE
 POSTHOOK: type: CREATETABLE
@@ -122,12 +128,16 @@ POSTHOOK: Input: db1@table1
 POSTHOOK: Output: db1@v8
 PREHOOK: query: CREATE DATABASE db2
 PREHOOK: type: CREATEDATABASE
+PREHOOK: Output: database:db2
 POSTHOOK: query: CREATE DATABASE db2
 POSTHOOK: type: CREATEDATABASE
+POSTHOOK: Output: database:db2
 PREHOOK: query: USE db2
 PREHOOK: type: SWITCHDATABASE
+PREHOOK: Input: database:db2
 POSTHOOK: query: USE db2
 POSTHOOK: type: SWITCHDATABASE
+POSTHOOK: Input: database:db2
 PREHOOK: query: SELECT * FROM db1.v1
 PREHOOK: type: QUERY
 PREHOOK: Input: db1@table1
diff --git a/ql/src/test/results/clientpositive/view_cast.q.out b/ql/src/test/results/clientpositive/view_cast.q.out
index 37e33ff507..cf4a1f453a 100644
--- a/ql/src/test/results/clientpositive/view_cast.q.out
+++ b/ql/src/test/results/clientpositive/view_cast.q.out
@@ -5,6 +5,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: CREATE TABLE IF NOT EXISTS atab (ks_uid BIGINT, sr_uid STRING, sr_id STRING, tstamp STRING, m_id STRING, act STRING, at_sr_uid STRING, tstamp_type STRING, original_m_id STRING, original_tstamp STRING, registered_flag TINYINT, at_ks_uid BIGINT) PARTITIONED BY (dt STRING,nt STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@atab
 POSTHOOK: query: CREATE TABLE IF NOT EXISTS atab (ks_uid BIGINT, sr_uid STRING, sr_id STRING, tstamp STRING, m_id STRING, act STRING, at_sr_uid STRING, tstamp_type STRING, original_m_id STRING, original_tstamp STRING, registered_flag TINYINT, at_ks_uid BIGINT) PARTITIONED BY (dt STRING,nt STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -34,6 +35,7 @@ POSTHOOK: type: DROPTABLE
 PREHOOK: query: CREATE TABLE  mstab(ks_uid INT, csc INT) PARTITIONED BY (dt STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@mstab
 POSTHOOK: query: CREATE TABLE  mstab(ks_uid INT, csc INT) PARTITIONED BY (dt STRING)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/virtual_column.q.out b/ql/src/test/results/clientpositive/virtual_column.q.out
index 3dac11a138..e99a22a769 100644
--- a/ql/src/test/results/clientpositive/virtual_column.q.out
+++ b/ql/src/test/results/clientpositive/virtual_column.q.out
@@ -351,6 +351,7 @@ POSTHOOK: Input: default@src
 PREHOOK: query: CREATE TABLE src_index_test_rc (key int, value string) STORED AS RCFILE
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@src_index_test_rc
 POSTHOOK: query: CREATE TABLE src_index_test_rc (key int, value string) STORED AS RCFILE
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
@@ -373,15 +374,3 @@ POSTHOOK: query: select INPUT__FILE__NAME, key, BLOCK__OFFSET__INSIDE__FILE from
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src_index_test_rc
 #### A masked pattern was here ####
-PREHOOK: query: DROP TABLE src_index_test_rc
-PREHOOK: type: DROPTABLE
-PREHOOK: Input: default@src_index_test_rc
-PREHOOK: Output: default@src_index_test_rc
-POSTHOOK: query: DROP TABLE src_index_test_rc
-POSTHOOK: type: DROPTABLE
-POSTHOOK: Input: default@src_index_test_rc
-POSTHOOK: Output: default@src_index_test_rc
-PREHOOK: query: DROP INDEX src_index on src_index_test_rc
-PREHOOK: type: DROPINDEX
-POSTHOOK: query: DROP INDEX src_index on src_index_test_rc
-POSTHOOK: type: DROPINDEX
diff --git a/ql/src/test/results/clientpositive/windowing.q.out b/ql/src/test/results/clientpositive/windowing.q.out
index 104f4ca049..0a68483704 100644
--- a/ql/src/test/results/clientpositive/windowing.q.out
+++ b/ql/src/test/results/clientpositive/windowing.q.out
@@ -16,6 +16,7 @@ CREATE TABLE part(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part
 POSTHOOK: query: -- data setup
 CREATE TABLE part( 
     p_partkey INT,
@@ -1263,6 +1264,7 @@ dr INT,
 s DOUBLE)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part_1
 POSTHOOK: query: -- 25. testMultipleInserts3SWQs
 CREATE TABLE part_1( 
 p_mfgr STRING, 
@@ -1285,6 +1287,7 @@ s2 DOUBLE,
 fv1 INT)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part_2
 POSTHOOK: query: CREATE TABLE part_2( 
 p_mfgr STRING, 
 p_name STRING, 
@@ -1306,6 +1309,7 @@ ca INT,
 fv INT)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part_3
 POSTHOOK: query: CREATE TABLE part_3( 
 p_mfgr STRING, 
 p_name STRING, 
diff --git a/ql/src/test/results/clientpositive/windowing_adjust_rowcontainer_sz.q.out b/ql/src/test/results/clientpositive/windowing_adjust_rowcontainer_sz.q.out
index ff407d6448..fe51e13852 100644
--- a/ql/src/test/results/clientpositive/windowing_adjust_rowcontainer_sz.q.out
+++ b/ql/src/test/results/clientpositive/windowing_adjust_rowcontainer_sz.q.out
@@ -16,6 +16,7 @@ CREATE TABLE part(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part
 POSTHOOK: query: -- data setup
 CREATE TABLE part( 
     p_partkey INT,
diff --git a/ql/src/test/results/clientpositive/windowing_columnPruning.q.out b/ql/src/test/results/clientpositive/windowing_columnPruning.q.out
index 7535dd3675..e6e9879c4d 100644
--- a/ql/src/test/results/clientpositive/windowing_columnPruning.q.out
+++ b/ql/src/test/results/clientpositive/windowing_columnPruning.q.out
@@ -16,6 +16,7 @@ CREATE TABLE part(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part
 POSTHOOK: query: -- data setup
 CREATE TABLE part( 
     p_partkey INT,
diff --git a/ql/src/test/results/clientpositive/windowing_decimal.q.out b/ql/src/test/results/clientpositive/windowing_decimal.q.out
index 88d11af7a1..08dd6abd9a 100644
--- a/ql/src/test/results/clientpositive/windowing_decimal.q.out
+++ b/ql/src/test/results/clientpositive/windowing_decimal.q.out
@@ -16,6 +16,7 @@ CREATE TABLE part(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part
 POSTHOOK: query: -- data setup
 CREATE TABLE part( 
     p_partkey INT,
@@ -52,6 +53,7 @@ PREHOOK: query: create table part_dec(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part_dec
 POSTHOOK: query: create table part_dec(
     p_partkey INT,
     p_name STRING,
diff --git a/ql/src/test/results/clientpositive/windowing_expressions.q.out b/ql/src/test/results/clientpositive/windowing_expressions.q.out
index 9deb3c5dfe..ee9f6cab3d 100644
--- a/ql/src/test/results/clientpositive/windowing_expressions.q.out
+++ b/ql/src/test/results/clientpositive/windowing_expressions.q.out
@@ -16,6 +16,7 @@ CREATE TABLE part(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part
 POSTHOOK: query: -- data setup
 CREATE TABLE part( 
     p_partkey INT,
@@ -59,6 +60,7 @@ PREHOOK: query: create table over10k(
        fields terminated by '|'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@over10k
 POSTHOOK: query: create table over10k(
            t tinyint,
            si smallint,
@@ -672,6 +674,7 @@ PREHOOK: query: -- multi table insert test
 create table t1 (a1 int, b1 string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t1
 POSTHOOK: query: -- multi table insert test
 create table t1 (a1 int, b1 string)
 POSTHOOK: type: CREATETABLE
@@ -680,6 +683,7 @@ POSTHOOK: Output: default@t1
 PREHOOK: query: create table t2 (a1 int, b1 string)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@t2
 POSTHOOK: query: create table t2 (a1 int, b1 string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
diff --git a/ql/src/test/results/clientpositive/windowing_multipartitioning.q.out b/ql/src/test/results/clientpositive/windowing_multipartitioning.q.out
index c6827909cb..ef4867727e 100644
--- a/ql/src/test/results/clientpositive/windowing_multipartitioning.q.out
+++ b/ql/src/test/results/clientpositive/windowing_multipartitioning.q.out
@@ -18,6 +18,7 @@ PREHOOK: query: create table over10k(
        fields terminated by '|'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@over10k
 POSTHOOK: query: create table over10k(
            t tinyint,
            si smallint,
diff --git a/ql/src/test/results/clientpositive/windowing_navfn.q.out b/ql/src/test/results/clientpositive/windowing_navfn.q.out
index 95d79426ea..f2f2cb4d7b 100644
--- a/ql/src/test/results/clientpositive/windowing_navfn.q.out
+++ b/ql/src/test/results/clientpositive/windowing_navfn.q.out
@@ -18,6 +18,7 @@ PREHOOK: query: create table over10k(
        fields terminated by '|'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@over10k
 POSTHOOK: query: create table over10k(
            t tinyint,
            si smallint,
diff --git a/ql/src/test/results/clientpositive/windowing_ntile.q.out b/ql/src/test/results/clientpositive/windowing_ntile.q.out
index 8333629575..c29b0dfab2 100644
--- a/ql/src/test/results/clientpositive/windowing_ntile.q.out
+++ b/ql/src/test/results/clientpositive/windowing_ntile.q.out
@@ -18,6 +18,7 @@ PREHOOK: query: create table over10k(
        fields terminated by '|'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@over10k
 POSTHOOK: query: create table over10k(
            t tinyint,
            si smallint,
diff --git a/ql/src/test/results/clientpositive/windowing_rank.q.out b/ql/src/test/results/clientpositive/windowing_rank.q.out
index 9976fdb679..6a74a8ee90 100644
--- a/ql/src/test/results/clientpositive/windowing_rank.q.out
+++ b/ql/src/test/results/clientpositive/windowing_rank.q.out
@@ -18,6 +18,7 @@ PREHOOK: query: create table over10k(
        fields terminated by '|'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@over10k
 POSTHOOK: query: create table over10k(
            t tinyint,
            si smallint,
diff --git a/ql/src/test/results/clientpositive/windowing_streaming.q.out b/ql/src/test/results/clientpositive/windowing_streaming.q.out
index 6ff4042426..90ba45ab7d 100644
--- a/ql/src/test/results/clientpositive/windowing_streaming.q.out
+++ b/ql/src/test/results/clientpositive/windowing_streaming.q.out
@@ -16,6 +16,7 @@ CREATE TABLE part(
 )
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@part
 POSTHOOK: query: -- data setup
 CREATE TABLE part( 
     p_partkey INT,
@@ -59,6 +60,7 @@ PREHOOK: query: create table over10k(
        fields terminated by '|'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@over10k
 POSTHOOK: query: create table over10k(
            t tinyint,
            si smallint,
diff --git a/ql/src/test/results/clientpositive/windowing_udaf.q.out b/ql/src/test/results/clientpositive/windowing_udaf.q.out
index f109dd283e..9d50251d45 100644
--- a/ql/src/test/results/clientpositive/windowing_udaf.q.out
+++ b/ql/src/test/results/clientpositive/windowing_udaf.q.out
@@ -18,6 +18,7 @@ PREHOOK: query: create table over10k(
        fields terminated by '|'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@over10k
 POSTHOOK: query: create table over10k(
            t tinyint,
            si smallint,
diff --git a/ql/src/test/results/clientpositive/windowing_windowspec.q.out b/ql/src/test/results/clientpositive/windowing_windowspec.q.out
index 9d18c6717a..00af6b8cea 100644
--- a/ql/src/test/results/clientpositive/windowing_windowspec.q.out
+++ b/ql/src/test/results/clientpositive/windowing_windowspec.q.out
@@ -18,6 +18,7 @@ PREHOOK: query: create table over10k(
        fields terminated by '|'
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
+PREHOOK: Output: default@over10k
 POSTHOOK: query: create table over10k(
            t tinyint,
            si smallint,
