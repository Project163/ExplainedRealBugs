diff --git a/ql/src/java/org/apache/hadoop/hive/ql/txn/compactor/Worker.java b/ql/src/java/org/apache/hadoop/hive/ql/txn/compactor/Worker.java
index 02adc45f0c..1607e2a82c 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/txn/compactor/Worker.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/txn/compactor/Worker.java
@@ -281,10 +281,11 @@ public CompactionHeartbeater(CompactionTxn compactionTxn, String tableName, Hive
     }
     @Override
     public void run() {
+      IMetaStoreClient msc = null;
       try {
         // We need to create our own metastore client since the thrifts clients
         // are not thread safe.
-        IMetaStoreClient msc = HiveMetaStoreUtils.getHiveMetastoreClient(conf);
+        msc = HiveMetaStoreUtils.getHiveMetastoreClient(conf);
         LOG.debug("Heartbeating compaction transaction id {} for table: {}", compactionTxn, tableName);
         while(!stop.get()) {
           msc.heartbeat(compactionTxn.getTxnId(), 0);
@@ -292,6 +293,10 @@ public void run() {
         }
       } catch (Exception e) {
         LOG.error("Error while heartbeating txn {} in {}, error: ", compactionTxn, Thread.currentThread().getName(), e.getMessage());
+      } finally {
+        if (msc != null) {
+          msc.close();
+        }
       }
     }
 
