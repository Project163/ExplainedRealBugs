diff --git a/CHANGES.txt b/CHANGES.txt
index 53e0f0cc4d..1465703a17 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -143,6 +143,8 @@ Trunk - Unreleased
     HIVE-498. Fix null pointer exception in UDFRegExp when
     the expression string is empty. (Zheng Shao via athusoo)
 
+    HIVE-410: Heartbeating for streaming jobs should not depend on stdout
+
 Release 0.3.1 - Unreleased
 
   INCOMPATIBLE CHANGES
diff --git a/build-common.xml b/build-common.xml
index 52869eff5d..8b31609d70 100644
--- a/build-common.xml
+++ b/build-common.xml
@@ -242,7 +242,7 @@
   <target name="test"
   	depends="test-conditions,gen-test,compile-test,test-jar,test-init">
     <junit showoutput="${test.output}" printsummary="yes" haltonfailure="no"
-           fork="yes" maxmemory="256m" dir="${basedir}" timeout="${test.timeout}"
+           fork="yes" maxmemory="512m" dir="${basedir}" timeout="${test.timeout}"
            errorProperty="tests.failed" failureProperty="tests.failed" filtertrace="off">
       <!--
       <jvmarg value="-Xdebug"/>
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/ScriptOperator.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/ScriptOperator.java
index a8e68b3caf..0f00a07200 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/ScriptOperator.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/ScriptOperator.java
@@ -60,6 +60,10 @@ public static enum Counter {DESERIALIZE_ERRORS, SERIALIZE_ERRORS}
   transient Deserializer scriptOutputDeserializer;
   transient volatile Throwable scriptError = null;
 
+  /**
+   * Timer to send periodic reports back to the tracker.
+   */
+  transient Timer rpTimer;
   /**
    * addJobConfToEnvironment is shamelessly copied from hadoop streaming.
    */
@@ -214,6 +218,22 @@ public void initialize(Configuration hconf, Reporter reporter, ObjectInspector[]
                                    (HiveConf.getIntVar(hconf, HiveConf.ConfVars.SCRIPTERRORLIMIT)),
                                    "ErrorProcessor");
       errThread.start();
+      
+      /* Timer that reports every 5 minutes to the jobtracker. This ensures that even if
+         the user script is not returning rows for greater than that duration, a progress
+         report is sent to the tracker so that the tracker does not think that the job 
+         is dead.
+      */
+      Integer exp_interval = null;
+      int exp_int;
+      exp_interval = Integer.decode(hconf.get("mapred.tasktracker.expiry.interval"));
+      if (exp_interval != null)
+        exp_int = exp_interval.intValue() / 2;
+      else
+        exp_int = 300000;
+
+      rpTimer = new Timer(true);
+      rpTimer.scheduleAtFixedRate(new ReporterTask(reporter), 0, exp_interval);
 
     } catch (Exception e) {
       e.printStackTrace();
@@ -256,6 +276,7 @@ public void close(boolean abort) throws HiveException {
           new_abort = true;
         };
       } catch (IOException e) {
+        LOG.error("Got ioexception: " + e.getMessage());
         new_abort = true;
       } catch (InterruptedException e) { }
     }
@@ -443,4 +464,25 @@ public static String[] splitArgs(String args) {
   public String getName() {
     return "SCR";
   }
+  
+  class ReporterTask extends TimerTask {
+    
+    /**
+     * Reporter to report progress to the jobtracker.
+     */
+    private Reporter rp;
+    
+    /**
+     * Constructor.
+     */
+    public ReporterTask(Reporter rp) {
+      if (rp != null)
+        this.rp = rp;
+    }
+    
+    @Override
+    public void run() {
+      rp.progress();
+    }
+  }
 }
