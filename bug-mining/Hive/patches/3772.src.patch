diff --git a/beeline/src/java/org/apache/hive/beeline/BeeLine.java b/beeline/src/java/org/apache/hive/beeline/BeeLine.java
index 15196190b7..3cd2a8b830 100644
--- a/beeline/src/java/org/apache/hive/beeline/BeeLine.java
+++ b/beeline/src/java/org/apache/hive/beeline/BeeLine.java
@@ -844,7 +844,7 @@ public ConsoleReader getConsoleReader(InputStream inputStream) throws IOExceptio
     consoleReader.setExpandEvents(false);
 
     // setup history
-    ByteArrayOutputStream hist = null;
+    ByteArrayOutputStream hist = new ByteArrayOutputStream();
     if (new File(getOpts().getHistoryFile()).isFile()) {
       try {
         // save the current contents of the history buffer. This gets
@@ -852,13 +852,12 @@ public ConsoleReader getConsoleReader(InputStream inputStream) throws IOExceptio
         // input will clobber the history input, but setting the
         // input before the output will cause the previous commands
         // to not be saved to the buffer.
-        FileInputStream historyIn = new FileInputStream(getOpts().getHistoryFile());
-        hist = new ByteArrayOutputStream();
-        int n;
-        while ((n = historyIn.read()) != -1) {
-          hist.write(n);
+        try (FileInputStream historyIn = new FileInputStream(getOpts().getHistoryFile())) {
+          int n;
+          while ((n = historyIn.read()) != -1) {
+            hist.write(n);
+          }
         }
-        historyIn.close();
       } catch (Exception e) {
         handleException(e);
       }
diff --git a/beeline/src/java/org/apache/hive/beeline/BeeLineOpts.java b/beeline/src/java/org/apache/hive/beeline/BeeLineOpts.java
index a31c49c334..338839124d 100644
--- a/beeline/src/java/org/apache/hive/beeline/BeeLineOpts.java
+++ b/beeline/src/java/org/apache/hive/beeline/BeeLineOpts.java
@@ -154,9 +154,9 @@ public int complete(String buf, int pos, List cand) {
 
 
   public void save() throws IOException {
-    OutputStream out = new FileOutputStream(rcFile);
-    save(out);
-    out.close();
+    try (OutputStream out = new FileOutputStream(rcFile)) {
+      save(out);
+    }
   }
 
   public void save(OutputStream out) throws IOException {
@@ -208,9 +208,9 @@ public Properties toProperties()
 
 
   public void load() throws IOException {
-    InputStream in = new FileInputStream(rcFile);
-    load(in);
-    in.close();
+    try (InputStream in = new FileInputStream(rcFile)) {
+      load(in);
+    }
   }
 
 
diff --git a/beeline/src/java/org/apache/hive/beeline/HiveSchemaTool.java b/beeline/src/java/org/apache/hive/beeline/HiveSchemaTool.java
index 2477e5f059..d5d635a4ed 100644
--- a/beeline/src/java/org/apache/hive/beeline/HiveSchemaTool.java
+++ b/beeline/src/java/org/apache/hive/beeline/HiveSchemaTool.java
@@ -140,18 +140,24 @@ private String getMetaStoreSchemaVersion(Connection metastoreConn)
     } else {
       versionQuery = "select t.SCHEMA_VERSION from VERSION t";
     }
-    try {
-      Statement stmt = metastoreConn.createStatement();
-      ResultSet res = stmt.executeQuery(versionQuery);
+    try(Statement stmt = metastoreConn.createStatement();
+        ResultSet res = stmt.executeQuery(versionQuery)) {
       if (!res.next()) {
         throw new HiveMetaException("Didn't find version data in metastore");
       }
       String currentSchemaVersion = res.getString(1);
-      metastoreConn.close();
       return currentSchemaVersion;
     } catch (SQLException e) {
       throw new HiveMetaException("Failed to get schema version.", e);
     }
+    finally {
+      try {
+        metastoreConn.close();
+      } catch (SQLException e) {
+        System.err.println("Failed to close the metastore connection");
+        e.printStackTrace(System.err);
+      }
+    }
   }
 
   // test the connection metastore using the config property
diff --git a/jdbc/src/java/org/apache/hive/jdbc/HiveConnection.java b/jdbc/src/java/org/apache/hive/jdbc/HiveConnection.java
index 3b7e004694..a9dac0385e 100644
--- a/jdbc/src/java/org/apache/hive/jdbc/HiveConnection.java
+++ b/jdbc/src/java/org/apache/hive/jdbc/HiveConnection.java
@@ -959,15 +959,13 @@ public String getSchema() throws SQLException {
     if (isClosed) {
       throw new SQLException("Connection is closed");
     }
-    Statement stmt = createStatement();
-    ResultSet res = stmt.executeQuery("SELECT current_database()");
-    if (!res.next()) {
-      throw new SQLException("Failed to get schema information");
+    try (Statement stmt = createStatement();
+         ResultSet res = stmt.executeQuery("SELECT current_database()")) {
+      if (!res.next()) {
+        throw new SQLException("Failed to get schema information");
+      }
+      return res.getString(1);
     }
-    String schemaName = res.getString(1);
-    res.close();
-    stmt.close();
-    return schemaName;
   }
 
   /*
