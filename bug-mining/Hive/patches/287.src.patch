diff --git a/CHANGES.txt b/CHANGES.txt
index 80062fb4ba..e6cbb5b5d4 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -264,9 +264,11 @@ Trunk -  Unreleased
 
     HIVE-929. Use a new parameter to check whether to merge files or not
     (He Yongqiang via namit)
-    
+
     HIVE-980 mapjoin followed by union does not work (namit via He Yongqiang)
 
+    HIVE-940 restrict creation of partitions with empty keys (Prasad Chakka via namit)
+
 Release 0.4.0 -  Unreleased
 
   INCOMPATIBLE CHANGES
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/metadata/Hive.java b/ql/src/java/org/apache/hadoop/hive/ql/metadata/Hive.java
index ed932b19be..92c9e5bd62 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/metadata/Hive.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/metadata/Hive.java
@@ -576,6 +576,13 @@ public Partition createPartition(Table tbl, Map<String, String> partSpec,
 
     org.apache.hadoop.hive.metastore.api.Partition partition = null;
 
+    for (FieldSchema field : tbl.getPartCols()) {
+      String val = partSpec.get(field.getName());
+      if(val == null || val.length() == 0) {
+        throw new HiveException("add partition: Value for key " + field.getName() + " is null or empty");
+      }
+    }
+
     try {
       Partition tmpPart = new Partition(tbl, partSpec, location);
       partition = getMSC().add_partition(tmpPart.getTPartition());
@@ -604,7 +611,7 @@ public Partition getPartition(Table tbl, Map<String, String> partSpec, boolean f
     for (FieldSchema field : tbl.getPartCols()) {
       String val = partSpec.get(field.getName());
       if(val == null || val.length() == 0) {
-        throw new HiveException("Value for key " + field.getName() + " is null or empty");
+        throw new HiveException("get partition: Value for key " + field.getName() + " is null or empty");
       }
       pvals.add(val);
     }
diff --git a/ql/src/test/queries/clientnegative/addpart1.q b/ql/src/test/queries/clientnegative/addpart1.q
new file mode 100644
index 0000000000..68988fba73
--- /dev/null
+++ b/ql/src/test/queries/clientnegative/addpart1.q
@@ -0,0 +1,12 @@
+drop table addpart1;
+create table addpart1 (a int) partitioned by (b string, c string);
+
+alter table addpart1 add partition (b='f', c='s');
+
+show partitions addpart1;
+
+alter table addpart1 add partition (b='f', c='');
+
+show prtitions addpart1;
+
+drop table addpart1;
\ No newline at end of file
diff --git a/ql/src/test/results/clientnegative/addpart1.q.out b/ql/src/test/results/clientnegative/addpart1.q.out
new file mode 100644
index 0000000000..cd25be643c
--- /dev/null
+++ b/ql/src/test/results/clientnegative/addpart1.q.out
@@ -0,0 +1,23 @@
+PREHOOK: query: drop table addpart1
+PREHOOK: type: DROPTABLE
+POSTHOOK: query: drop table addpart1
+POSTHOOK: type: DROPTABLE
+PREHOOK: query: create table addpart1 (a int) partitioned by (b string, c string)
+PREHOOK: type: CREATETABLE
+POSTHOOK: query: create table addpart1 (a int) partitioned by (b string, c string)
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: default@addpart1
+PREHOOK: query: alter table addpart1 add partition (b='f', c='s')
+PREHOOK: type: ALTERTABLE_ADDPARTS
+POSTHOOK: query: alter table addpart1 add partition (b='f', c='s')
+POSTHOOK: type: ALTERTABLE_ADDPARTS
+POSTHOOK: Output: default@addpart1@b=f/c=s
+PREHOOK: query: show partitions addpart1
+PREHOOK: type: SHOWPARTITIONS
+POSTHOOK: query: show partitions addpart1
+POSTHOOK: type: SHOWPARTITIONS
+b=f/c=s
+PREHOOK: query: alter table addpart1 add partition (b='f', c='')
+PREHOOK: type: ALTERTABLE_ADDPARTS
+FAILED: Error in metadata: add partition: Value for key c is null or empty
+FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask
