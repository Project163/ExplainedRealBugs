diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/FunctionRegistry.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/FunctionRegistry.java
index c8a9765da7..d62a6b6c32 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/FunctionRegistry.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/FunctionRegistry.java
@@ -630,6 +630,28 @@ static void registerNumericType(String typeName, int level) {
     registerNumericType(Constants.STRING_TYPE_NAME, 7);
   }
 
+  /**
+   * Find a common class for union-all operator
+   */
+  public static TypeInfo getCommonClassForUnionAll(TypeInfo a, TypeInfo b) {
+    if (a.equals(b)) {
+      return a;
+    }
+    if (FunctionRegistry.implicitConvertable(a, b)) {
+      return b;
+    }
+    if (FunctionRegistry.implicitConvertable(b, a)) {
+      return a;
+    }
+    for (TypeInfo t : numericTypeList) {
+      if (FunctionRegistry.implicitConvertable(a, t)
+          && FunctionRegistry.implicitConvertable(b, t)) {
+        return t;
+      }
+    }
+    return null;
+  }
+
   /**
    * Find a common class that objects of both TypeInfo a and TypeInfo b can
    * convert to. This is used for comparing objects of type a and type b.
@@ -644,7 +666,6 @@ public static TypeInfo getCommonClassForComparison(TypeInfo a, TypeInfo b) {
     if (a.equals(b)) {
       return a;
     }
-
     for (TypeInfo t : numericTypeList) {
       if (FunctionRegistry.implicitConvertable(a, t)
           && FunctionRegistry.implicitConvertable(b, t)) {
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
index d4696b6838..f192919554 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
@@ -6264,7 +6264,7 @@ private Operator genUnionPlan(String unionalias, String leftalias,
             + ". Column positions should match for a UNION"));
       }
       //try widening coversion, otherwise fail union
-      TypeInfo commonTypeInfo = FunctionRegistry.getCommonClassForComparison(lInfo.getType(),
+      TypeInfo commonTypeInfo = FunctionRegistry.getCommonClassForUnionAll(lInfo.getType(),
           rInfo.getType());
       if (commonTypeInfo == null) {
         throw new SemanticException(generateErrorMessage(tabref,
@@ -6281,7 +6281,7 @@ private Operator genUnionPlan(String unionalias, String leftalias,
       String field = lEntry.getKey();
       ColumnInfo lInfo = lEntry.getValue();
       ColumnInfo rInfo = rightmap.get(field);
-      lInfo.setType(FunctionRegistry.getCommonClassForComparison(lInfo.getType(),
+      lInfo.setType(FunctionRegistry.getCommonClassForUnionAll(lInfo.getType(),
             rInfo.getType()));
       unionoutRR.put(unionalias, field, lInfo);
     }
diff --git a/ql/src/test/queries/clientpositive/union_null.q b/ql/src/test/queries/clientpositive/union_null.q
new file mode 100644
index 0000000000..70147070fe
--- /dev/null
+++ b/ql/src/test/queries/clientpositive/union_null.q
@@ -0,0 +1,2 @@
+-- HIVE-2901
+select x from (select value as x from src union all select NULL as x from src)a limit 10;
diff --git a/ql/src/test/results/clientpositive/union_null.q.out b/ql/src/test/results/clientpositive/union_null.q.out
new file mode 100644
index 0000000000..361f6b2352
--- /dev/null
+++ b/ql/src/test/results/clientpositive/union_null.q.out
@@ -0,0 +1,20 @@
+PREHOOK: query: -- HIVE-2901
+select x from (select value as x from src union all select NULL as x from src)a limit 10
+PREHOOK: type: QUERY
+PREHOOK: Input: default@src
+#### A masked pattern was here ####
+POSTHOOK: query: -- HIVE-2901
+select x from (select value as x from src union all select NULL as x from src)a limit 10
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@src
+#### A masked pattern was here ####
+val_238
+NULL
+val_86
+NULL
+val_311
+NULL
+val_27
+NULL
+val_165
+NULL
