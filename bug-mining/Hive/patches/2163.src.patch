diff --git a/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDAFMkCollectionEvaluator.java b/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDAFMkCollectionEvaluator.java
index 54a35aeb8f..bff4c4745d 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDAFMkCollectionEvaluator.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDAFMkCollectionEvaluator.java
@@ -137,8 +137,10 @@ public void merge(AggregationBuffer agg, Object partial)
       throws HiveException {
     MkArrayAggregationBuffer myagg = (MkArrayAggregationBuffer) agg;
     List<Object> partialResult = (ArrayList<Object>) internalMergeOI.getList(partial);
-    for(Object i : partialResult) {
-      putIntoCollection(i, myagg);
+    if (partialResult != null) {
+      for(Object i : partialResult) {
+        putIntoCollection(i, myagg);
+      }
     }
   }
 
