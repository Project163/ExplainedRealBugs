diff --git a/CHANGES.txt b/CHANGES.txt
index a2b1135970..8383da79f6 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -71,6 +71,8 @@ Trunk (unreleased changes)
 
   BUG FIXES
 
+    HIVE-161. Fixed xpath x.y when x is a null list. (zshao)
+
     HIVE-206. Fixed partition pruning check for uppercase table names.
     (Ashish Thusoo via zshao)
 
diff --git a/data/files/complex.seq b/data/files/complex.seq
index cc0d3fc7d2..3cf3966bad 100644
Binary files a/data/files/complex.seq and b/data/files/complex.seq differ
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/ExprNodeFieldEvaluator.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/ExprNodeFieldEvaluator.java
index 5eea3b1b33..44f7a0763a 100755
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/ExprNodeFieldEvaluator.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/ExprNodeFieldEvaluator.java
@@ -61,11 +61,15 @@ public void evaluate(Object row, ObjectInspector rowInspector,
     result.oi = resultObjectInspector;
     if (desc.getIsList()) {
       List<?> list = ((ListObjectInspector)leftInspectableObject.oi).getList(leftInspectableObject.o);
-      List<Object> r = new ArrayList<Object>(list.size());
-      for(int i=0; i<list.size(); i++) {
-        r.add(structObjectInspector.getStructFieldData(list.get(i), field));
+      if (list == null) {
+        result.o = null;
+      } else {
+        List<Object> r = new ArrayList<Object>(list.size());
+        for(int i=0; i<list.size(); i++) {
+          r.add(structObjectInspector.getStructFieldData(list.get(i), field));
+        }
+        result.o = r;
       }
-      result.o = r;
     } else {
       result.o = structObjectInspector.getStructFieldData(leftInspectableObject.o, field);
     }
diff --git a/ql/src/test/results/clientpositive/input17.q.out b/ql/src/test/results/clientpositive/input17.q.out
index 2e1f3cdf75..12f99e2489 100644
--- a/ql/src/test/results/clientpositive/input17.q.out
+++ b/ql/src/test/results/clientpositive/input17.q.out
@@ -76,13 +76,14 @@ STAGE PLANS:
                 name: dest1
 
 
--1103622755	{"myint":64,"mystring":"512"}
--1147582749	{"myint":1,"mystring":"1"}
--1220068486	{"myint":0,"mystring":"0"}
--1281615204	{"myint":36,"mystring":"216"}
--1587372270	{"myint":9,"mystring":"27"}
--1883609158	{"myint":81,"mystring":"729"}
--2091002568	{"myint":4,"mystring":"8"}
--240543261	{"myint":16,"mystring":"64"}
-1539139271	{"myint":49,"mystring":"343"}
-1914724542	{"myint":25,"mystring":"125"}
+NULL	{"myint":null,"mystring":null}
+-1461153966	{"myint":49,"mystring":"343"}
+-1952710705	{"myint":25,"mystring":"125"}
+-734328905	{"myint":16,"mystring":"64"}
+-751827636	{"myint":4,"mystring":"8"}
+1244525196	{"myint":36,"mystring":"216"}
+1638581586	{"myint":64,"mystring":"512"}
+1712634731	{"myint":0,"mystring":"0"}
+336964422	{"myint":81,"mystring":"729"}
+465985201	{"myint":1,"mystring":"1"}
+477111225	{"myint":9,"mystring":"27"}
diff --git a/ql/src/test/results/clientpositive/input5.q.out b/ql/src/test/results/clientpositive/input5.q.out
index 3ba463a9fa..24a417dd80 100644
--- a/ql/src/test/results/clientpositive/input5.q.out
+++ b/ql/src/test/results/clientpositive/input5.q.out
@@ -78,3 +78,4 @@ STAGE PLANS:
 [7,14,21]	[{"myint":49,"mystring":"343"}]
 [8,16,24]	[{"myint":64,"mystring":"512"}]
 [9,18,27]	[{"myint":81,"mystring":"729"}]
+null	null
diff --git a/ql/src/test/results/clientpositive/input_dynamicserde.q.out b/ql/src/test/results/clientpositive/input_dynamicserde.q.out
index 98fc2cb7d4..12d4e2bee3 100644
--- a/ql/src/test/results/clientpositive/input_dynamicserde.q.out
+++ b/ql/src/test/results/clientpositive/input_dynamicserde.q.out
@@ -53,23 +53,25 @@ STAGE PLANS:
                 name: dest1
 
 
-[0,0,0]	["0","0","0"]	{"key_0":"value_0"}	-1220068486	record_0
-[1,2,3]	["10","100","1000"]	{"key_1":"value_1"}	-1147582750	record_1
-[2,4,6]	["20","200","2000"]	{"key_2":"value_2"}	-2091002570	record_2
-[3,6,9]	["30","300","3000"]	{"key_3":"value_3"}	-1587372273	record_3
-[4,8,12]	["40","400","4000"]	{"key_4":"value_4"}	-240543265	record_4
-[5,10,15]	["50","500","5000"]	{"key_5":"value_5"}	1914724537	record_5
-[6,12,18]	["60","600","6000"]	{"key_6":"value_6"}	-1281615210	record_6
-[7,14,21]	["70","700","7000"]	{"key_7":"value_7"}	1539139264	record_7
-[8,16,24]	["80","800","8000"]	{"key_8":"value_8"}	-1103622763	record_8
-[9,18,27]	["90","900","9000"]	{"key_9":"value_9"}	-1883609167	record_9
-0	0	NULL	-1220068486	record_0
-1	10	NULL	-1147582750	record_1
-2	20	NULL	-2091002570	record_2
-3	30	NULL	-1587372273	record_3
-4	40	NULL	-240543265	record_4
-5	50	NULL	1914724537	record_5
-6	60	NULL	-1281615210	record_6
-7	70	NULL	1539139264	record_7
-8	80	NULL	-1103622763	record_8
-9	90	NULL	-1883609167	record_9
+[0,0,0]	["0","0","0"]	{"key_0":"value_0"}	1712634731	record_0
+[1,2,3]	["10","100","1000"]	{"key_1":"value_1"}	465985200	record_1
+[2,4,6]	["20","200","2000"]	{"key_2":"value_2"}	-751827638	record_2
+[3,6,9]	["30","300","3000"]	{"key_3":"value_3"}	477111222	record_3
+[4,8,12]	["40","400","4000"]	{"key_4":"value_4"}	-734328909	record_4
+[5,10,15]	["50","500","5000"]	{"key_5":"value_5"}	-1952710710	record_5
+[6,12,18]	["60","600","6000"]	{"key_6":"value_6"}	1244525190	record_6
+[7,14,21]	["70","700","7000"]	{"key_7":"value_7"}	-1461153973	record_7
+[8,16,24]	["80","800","8000"]	{"key_8":"value_8"}	1638581578	record_8
+[9,18,27]	["90","900","9000"]	{"key_9":"value_9"}	336964413	record_9
+null	null	null	0	NULL
+0	0	NULL	1712634731	record_0
+1	10	NULL	465985200	record_1
+2	20	NULL	-751827638	record_2
+3	30	NULL	477111222	record_3
+4	40	NULL	-734328909	record_4
+5	50	NULL	-1952710710	record_5
+6	60	NULL	1244525190	record_6
+7	70	NULL	-1461153973	record_7
+8	80	NULL	1638581578	record_8
+9	90	NULL	336964413	record_9
+NULL	NULL	NULL	0	NULL
diff --git a/ql/src/test/results/clientpositive/input_testxpath.q.out b/ql/src/test/results/clientpositive/input_testxpath.q.out
index 7458353abe..767a9ab7d1 100644
--- a/ql/src/test/results/clientpositive/input_testxpath.q.out
+++ b/ql/src/test/results/clientpositive/input_testxpath.q.out
@@ -55,3 +55,4 @@ STAGE PLANS:
 14	343	NULL
 16	512	NULL
 18	729	NULL
+NULL	NULL	NULL
diff --git a/ql/src/test/results/clientpositive/input_testxpath3.q.out b/ql/src/test/results/clientpositive/input_testxpath3.q.out
index 2f03e6ef85..75091f41aa 100644
--- a/ql/src/test/results/clientpositive/input_testxpath3.q.out
+++ b/ql/src/test/results/clientpositive/input_testxpath3.q.out
@@ -43,3 +43,4 @@ NULL	[36]
 NULL	[49]
 NULL	[64]
 value_9	[81]
+NULL	null
diff --git a/serde/src/test/org/apache/hadoop/hive/serde2/thrift_test/CreateSequenceFile.java b/serde/src/test/org/apache/hadoop/hive/serde2/thrift_test/CreateSequenceFile.java
index 7fb088e329..f55dafb862 100644
--- a/serde/src/test/org/apache/hadoop/hive/serde2/thrift_test/CreateSequenceFile.java
+++ b/serde/src/test/org/apache/hadoop/hive/serde2/thrift_test/CreateSequenceFile.java
@@ -98,7 +98,12 @@ public static void main(String[] args) throws Exception {
       Writable value = serde.serialize(complex);
       writer.append(key, value);
     }
-    
+
+    // Add an all-null record
+    Complex complex = new Complex(0, null, null, null, null, null);
+    Writable value = serde.serialize(complex);
+    writer.append(key, value);
+
     // Close files
     writer.close();
   }
