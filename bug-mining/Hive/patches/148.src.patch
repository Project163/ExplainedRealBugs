diff --git a/CHANGES.txt b/CHANGES.txt
index f8dffc3436..1420cb794a 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -129,6 +129,9 @@ Trunk - Unreleased
     HIVE-483. Fix incorect handling of comments in middle of a query
     (Namit Jain via athusoo)
 
+    HIVE-486. Fix concurrent modification exception in case of empty partitions
+    (Namit Jain via prasadc)
+
 Release 0.3.1 - Unreleased
 
   INCOMPATIBLE CHANGES
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/ExecDriver.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/ExecDriver.java
index a39d5f1e76..8ba1d6e166 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/ExecDriver.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/ExecDriver.java
@@ -659,6 +659,8 @@ private void addInputPaths(JobConf job, mapredWork work, String hiveScratchDir)
       FileInputFormat.addInputPaths(job, newPath.toString());
     }
     else {
+      List<String> emptyPaths = new ArrayList<String>();
+
       for (String onefile : work.getPathToAliases().keySet()) {
         LOG.info("Adding input file " + onefile);
         
@@ -672,29 +674,34 @@ private void addInputPaths(JobConf job, mapredWork work, String hiveScratchDir)
             emptyInput = false;
         }
         
-        if (emptyInput) {
-          Class<? extends HiveOutputFormat> outFileFormat = work.getPathToPartitionInfo().get(onefile).getTableDesc().getOutputFileFormatClass();
-          
-          String newFile = "file:" + hiveScratchDir + File.separator + (++numEmptyPaths);
-          Path newPath = new Path(newFile);
-          LOG.info("Changed input file to " + newPath.toString());
-          
-          // toggle the work
-          Map<String, ArrayList<String>> pathToAliases = work.getPathToAliases();
-          pathToAliases.put(newPath.toString(), pathToAliases.get(onefile));
-          pathToAliases.remove(onefile);
-          
-          Map<String,partitionDesc> pathToPartitionInfo = work.getPathToPartitionInfo();
-          pathToPartitionInfo.put(newPath.toString(), pathToPartitionInfo.get(onefile));
-          pathToPartitionInfo.remove(onefile);
-          
-          onefile = newPath.toString();
-          RecordWriter recWriter = outFileFormat.newInstance().getHiveRecordWriter(job, newPath, Text.class, false, new Properties(), null);
-          recWriter.close(false);
-        }
+        if (emptyInput)
+          emptyPaths.add(onefile);
+        else
+          FileInputFormat.addInputPaths(job, onefile);
+      }
+
+      for (String emptyFile : emptyPaths) {
+        Class<? extends HiveOutputFormat> outFileFormat = work.getPathToPartitionInfo().get(emptyFile).getTableDesc().getOutputFileFormatClass();
+        
+        String newFile = "file:" + hiveScratchDir + File.separator + (++numEmptyPaths);
+        Path newPath = new Path(newFile);
+        LOG.info("Changed input file to " + newPath.toString());
         
+        // toggle the work
+        Map<String, ArrayList<String>> pathToAliases = work.getPathToAliases();
+        pathToAliases.put(newPath.toString(), pathToAliases.get(emptyFile));
+        pathToAliases.remove(emptyFile);
+        
+        Map<String,partitionDesc> pathToPartitionInfo = work.getPathToPartitionInfo();
+        pathToPartitionInfo.put(newPath.toString(), pathToPartitionInfo.get(emptyFile));
+        pathToPartitionInfo.remove(emptyFile);
+        
+        String onefile = newPath.toString();
+        RecordWriter recWriter = outFileFormat.newInstance().getHiveRecordWriter(job, newPath, Text.class, false, new Properties(), null);
+        recWriter.close(false);
         FileInputFormat.addInputPaths(job, onefile);
-      }      
+      }
     }
+
   }
 }
diff --git a/ql/src/test/queries/clientpositive/input28.q b/ql/src/test/queries/clientpositive/input28.q
new file mode 100644
index 0000000000..da8a3ce850
--- /dev/null
+++ b/ql/src/test/queries/clientpositive/input28.q
@@ -0,0 +1,10 @@
+drop table tst;
+create table tst(a string, b string) partitioned by (d string);
+alter table tst add partition (d='2009-01-01');
+
+insert overwrite table tst partition(d='2009-01-01')
+select tst.a, src.value from tst join src ON (tst.a = src.key);
+
+select * from tst where tst.d='2009-01-01';
+
+drop table tst;
diff --git a/ql/src/test/results/clientpositive/input28.q.out b/ql/src/test/results/clientpositive/input28.q.out
new file mode 100644
index 0000000000..c19a38607d
--- /dev/null
+++ b/ql/src/test/results/clientpositive/input28.q.out
@@ -0,0 +1,12 @@
+query: drop table tst
+query: create table tst(a string, b string) partitioned by (d string)
+query: alter table tst add partition (d='2009-01-01')
+query: insert overwrite table tst partition(d='2009-01-01')
+select tst.a, src.value from tst join src ON (tst.a = src.key)
+Input: default/tst/d=2009-01-01
+Input: default/src
+Output: default/tst/d=2009-01-01
+query: select * from tst where tst.d='2009-01-01'
+Input: default/tst/d=2009-01-01
+Output: /data/users/njain/hive6/hive6/ql/../build/ql/tmp/29384498/467749736.10000
+query: drop table tst
