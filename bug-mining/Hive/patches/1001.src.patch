diff --git a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/MetadataOnlyOptimizer.java b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/MetadataOnlyOptimizer.java
index 7de3cb54d9..4ba9b7bd5c 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/MetadataOnlyOptimizer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/physical/MetadataOnlyOptimizer.java
@@ -232,9 +232,9 @@ private void processAlias(MapredWork work, String alias) {
       for (String path : paths) {
         PartitionDesc newPartition = changePartitionToMetadataOnly(work.getPathToPartitionInfo().get(
             path));
-        Path fakePath = new Path("file", null,
-            "/fake-path-metadata-only-query-" + newPartition.getTableName()
-                + newPartition.getPartSpec().toString());
+        Path fakePath = new Path(physicalContext.getContext().getMRTmpFileURI()
+            + newPartition.getTableName()
+            + newPartition.getPartSpec().toString());
         work.getPathToPartitionInfo().remove(path);
         work.getPathToPartitionInfo().put(fakePath.getName(), newPartition);
         ArrayList<String> aliases = work.getPathToAliases().remove(path);
diff --git a/ql/src/test/results/clientpositive/metadataonly1.q.out b/ql/src/test/results/clientpositive/metadataonly1.q.out
index aaf2454938..7ccabb65db 100644
--- a/ql/src/test/results/clientpositive/metadataonly1.q.out
+++ b/ql/src/test/results/clientpositive/metadataonly1.q.out
@@ -127,9 +127,9 @@ STAGE PLANS:
                         type: string
       Needs Tagging: false
       Path -> Alias:
-        fake-path-metadata-only-query-default.test1{ds=1} [test1]
+        -mr-10002default.test1{ds=1} [test1]
       Path -> Partition:
-        fake-path-metadata-only-query-default.test1{ds=1} 
+        -mr-10002default.test1{ds=1} 
           Partition
             base file name: ds=1
             input format: org.apache.hadoop.hive.ql.io.OneNullRowInputFormat
@@ -195,7 +195,7 @@ STAGE PLANS:
               GatherStats: false
               MultiFileSpray: false
       Truncated Path -> Alias:
-        fake-path-metadata-only-query-default.test1{ds=1} [test1]
+        -mr-10002default.test1{ds=1} [test1]
 
   Stage: Stage-0
     Fetch Operator
@@ -255,9 +255,9 @@ STAGE PLANS:
                         type: bigint
       Needs Tagging: false
       Path -> Alias:
-        fake-path-metadata-only-query-default.test1{ds=1} [test1]
+        -mr-10002default.test1{ds=1} [test1]
       Path -> Partition:
-        fake-path-metadata-only-query-default.test1{ds=1} 
+        -mr-10002default.test1{ds=1} 
           Partition
             base file name: ds=1
             input format: org.apache.hadoop.hive.ql.io.OneNullRowInputFormat
@@ -323,7 +323,7 @@ STAGE PLANS:
               GatherStats: false
               MultiFileSpray: false
       Truncated Path -> Alias:
-        fake-path-metadata-only-query-default.test1{ds=1} [test1]
+        -mr-10002default.test1{ds=1} [test1]
 
   Stage: Stage-0
     Fetch Operator
@@ -510,10 +510,10 @@ STAGE PLANS:
                         type: string
       Needs Tagging: false
       Path -> Alias:
-        fake-path-metadata-only-query-default.test1{ds=1} [b:test1]
-        fake-path-metadata-only-query-default.test1{ds=2} [b:test1]
+        -mr-10004default.test1{ds=1} [b:test1]
+        -mr-10005default.test1{ds=2} [b:test1]
       Path -> Partition:
-        fake-path-metadata-only-query-default.test1{ds=1} 
+        -mr-10004default.test1{ds=1} 
           Partition
             base file name: ds=1
             input format: org.apache.hadoop.hive.ql.io.OneNullRowInputFormat
@@ -549,7 +549,7 @@ STAGE PLANS:
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: default.test1
             name: default.test1
-        fake-path-metadata-only-query-default.test1{ds=2} 
+        -mr-10005default.test1{ds=2} 
           Partition
             base file name: ds=2
             input format: org.apache.hadoop.hive.ql.io.OneNullRowInputFormat
@@ -613,8 +613,8 @@ STAGE PLANS:
               GatherStats: false
               MultiFileSpray: false
       Truncated Path -> Alias:
-        fake-path-metadata-only-query-default.test1{ds=1} [b:test1]
-        fake-path-metadata-only-query-default.test1{ds=2} [b:test1]
+        -mr-10004default.test1{ds=1} [b:test1]
+        -mr-10005default.test1{ds=2} [b:test1]
 
   Stage: Stage-2
     Map Reduce
@@ -926,11 +926,11 @@ STAGE PLANS:
                         type: bigint
       Needs Tagging: false
       Path -> Alias:
-        fake-path-metadata-only-query-default.test2{ds=1, hr=1} [test2]
-        fake-path-metadata-only-query-default.test2{ds=1, hr=2} [test2]
-        fake-path-metadata-only-query-default.test2{ds=1, hr=3} [test2]
+        -mr-10002default.test2{ds=1, hr=1} [test2]
+        -mr-10003default.test2{ds=1, hr=2} [test2]
+        -mr-10004default.test2{ds=1, hr=3} [test2]
       Path -> Partition:
-        fake-path-metadata-only-query-default.test2{ds=1, hr=1} 
+        -mr-10002default.test2{ds=1, hr=1} 
           Partition
             base file name: hr=1
             input format: org.apache.hadoop.hive.ql.io.OneNullRowInputFormat
@@ -967,7 +967,7 @@ STAGE PLANS:
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: default.test2
             name: default.test2
-        fake-path-metadata-only-query-default.test2{ds=1, hr=2} 
+        -mr-10003default.test2{ds=1, hr=2} 
           Partition
             base file name: hr=2
             input format: org.apache.hadoop.hive.ql.io.OneNullRowInputFormat
@@ -1004,7 +1004,7 @@ STAGE PLANS:
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: default.test2
             name: default.test2
-        fake-path-metadata-only-query-default.test2{ds=1, hr=3} 
+        -mr-10004default.test2{ds=1, hr=3} 
           Partition
             base file name: hr=3
             input format: org.apache.hadoop.hive.ql.io.OneNullRowInputFormat
@@ -1076,9 +1076,9 @@ STAGE PLANS:
               GatherStats: false
               MultiFileSpray: false
       Truncated Path -> Alias:
-        fake-path-metadata-only-query-default.test2{ds=1, hr=1} [test2]
-        fake-path-metadata-only-query-default.test2{ds=1, hr=2} [test2]
-        fake-path-metadata-only-query-default.test2{ds=1, hr=3} [test2]
+        -mr-10002default.test2{ds=1, hr=1} [test2]
+        -mr-10003default.test2{ds=1, hr=2} [test2]
+        -mr-10004default.test2{ds=1, hr=3} [test2]
 
   Stage: Stage-0
     Fetch Operator
@@ -1354,10 +1354,10 @@ STAGE PLANS:
                         type: string
       Needs Tagging: false
       Path -> Alias:
-        fake-path-metadata-only-query-default.test1{ds=1} [test1]
-        fake-path-metadata-only-query-default.test1{ds=2} [test1]
+        -mr-10002default.test1{ds=1} [test1]
+        -mr-10003default.test1{ds=2} [test1]
       Path -> Partition:
-        fake-path-metadata-only-query-default.test1{ds=1} 
+        -mr-10002default.test1{ds=1} 
           Partition
             base file name: ds=1
             input format: org.apache.hadoop.hive.ql.io.OneNullRowInputFormat
@@ -1393,7 +1393,7 @@ STAGE PLANS:
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: default.test1
             name: default.test1
-        fake-path-metadata-only-query-default.test1{ds=2} 
+        -mr-10003default.test1{ds=2} 
           Partition
             base file name: ds=2
             input format: org.apache.hadoop.hive.ql.io.OneNullRowInputFormat
@@ -1459,8 +1459,8 @@ STAGE PLANS:
               GatherStats: false
               MultiFileSpray: false
       Truncated Path -> Alias:
-        fake-path-metadata-only-query-default.test1{ds=1} [test1]
-        fake-path-metadata-only-query-default.test1{ds=2} [test1]
+        -mr-10002default.test1{ds=1} [test1]
+        -mr-10003default.test1{ds=2} [test1]
 
   Stage: Stage-0
     Fetch Operator
