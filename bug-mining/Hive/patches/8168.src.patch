diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/CalcitePlanner.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/CalcitePlanner.java
index f96cd64ad7..dc88027f25 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/CalcitePlanner.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/CalcitePlanner.java
@@ -4859,7 +4859,7 @@ public RexNode apply(RelDataTypeField input) {
       }
 
       inputRR.setCheckForAmbiguity(false);
-      return new Pair<RelNode, RowResolver>(outputRel, null);
+      return new Pair<>(outputRel, outputRR);
     }
 
     Integer genRexNodeRegex(String colRegex, String tabAlias, ASTNode sel,
diff --git a/ql/src/test/queries/clientpositive/order_by_pos.q b/ql/src/test/queries/clientpositive/order_by_pos.q
index 4ba4a20ed1..80d6ac32ef 100644
--- a/ql/src/test/queries/clientpositive/order_by_pos.q
+++ b/ql/src/test/queries/clientpositive/order_by_pos.q
@@ -19,3 +19,5 @@ select * from (select a, count(a) from t_n3 group by a)subq order by 2, 1;
 select * from (select a,b, count(*) from t_n3 group by a, b)subq order by 3, 2 desc, 1;
 
 values(1+1, 2, 5.0, 'a'), (-12, 2, 5.0, 'a'), (100, 2, 5.0, 'a') order by 1 limit 2;
+
+select distinct a, b from t_n3 order by 2, 1;
diff --git a/ql/src/test/results/clientpositive/llap/order_by_pos.q.out b/ql/src/test/results/clientpositive/llap/order_by_pos.q.out
index 6ebb0abe55..a6e38bc7e7 100644
--- a/ql/src/test/results/clientpositive/llap/order_by_pos.q.out
+++ b/ql/src/test/results/clientpositive/llap/order_by_pos.q.out
@@ -139,3 +139,19 @@ POSTHOOK: Input: _dummy_database@_dummy_table
 #### A masked pattern was here ####
 -12	2	5	a
 2	2	5	a
+PREHOOK: query: select distinct a, b from t_n3 order by 2, 1
+PREHOOK: type: QUERY
+PREHOOK: Input: default@t_n3
+#### A masked pattern was here ####
+POSTHOOK: query: select distinct a, b from t_n3 order by 2, 1
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@t_n3
+#### A masked pattern was here ####
+20	-100
+1	2
+1	3
+2	4
+4	5
+3	7
+8	9
+-1000	100
