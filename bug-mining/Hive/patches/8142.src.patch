diff --git a/storage-api/src/java/org/apache/hive/common/util/TxnIdUtils.java b/storage-api/src/java/org/apache/hive/common/util/TxnIdUtils.java
index bd972d4d4e..7de7464d77 100644
--- a/storage-api/src/java/org/apache/hive/common/util/TxnIdUtils.java
+++ b/storage-api/src/java/org/apache/hive/common/util/TxnIdUtils.java
@@ -67,7 +67,7 @@ public static int compare(ValidWriteIdList a, ValidWriteIdList b) {
       }
     } else {
       if (b.getHighWatermark() != a.getInvalidWriteIds()[minLen] -1) {
-        return Long.signum(b.getHighWatermark() - (a.getInvalidWriteIds()[minLen] -1));
+        return Long.signum((a.getInvalidWriteIds()[minLen] - 1) - b.getHighWatermark());
       }
       if (allInvalidFrom(a.getInvalidWriteIds(), minLen, a.getHighWatermark())) {
         return 0;
diff --git a/storage-api/src/test/org/apache/hive/common/util/TestTxnIdUtils.java b/storage-api/src/test/org/apache/hive/common/util/TestTxnIdUtils.java
index ab5a472da9..1f646a3c1f 100644
--- a/storage-api/src/test/org/apache/hive/common/util/TestTxnIdUtils.java
+++ b/storage-api/src/test/org/apache/hive/common/util/TestTxnIdUtils.java
@@ -19,6 +19,7 @@
 
 import java.util.BitSet;
 
+import org.apache.hadoop.hive.common.ValidWriteIdList;
 import org.apache.hadoop.hive.common.ValidReaderWriteIdList;
 import org.junit.Test;
 import static org.junit.Assert.assertEquals;
@@ -190,5 +191,15 @@ public void testCompareWriteIds() throws Exception {
         new ValidReaderWriteIdList("default.table2", new long[] {8,10,11}, new BitSet(), 11)),
     -1);
 
+    ValidWriteIdList a =
+        new ValidReaderWriteIdList("default.test:1:1:1:");
+    ValidWriteIdList b =
+        new ValidReaderWriteIdList("default.test:1:9223372036854775807::");
+
+    // should return -1 since b is more recent
+    assertEquals(TxnIdUtils.compare(a, b), -1);
+
+    // should return 1 since b is more recent
+    assertEquals(TxnIdUtils.compare(b, a), 1);
   }
 }
