diff --git a/ql/src/test/org/apache/hadoop/hive/metastore/txn/TestCompactionTxnHandler.java b/ql/src/test/org/apache/hadoop/hive/metastore/txn/TestCompactionTxnHandler.java
index 46879b0dff..0de8ac6d60 100644
--- a/ql/src/test/org/apache/hadoop/hive/metastore/txn/TestCompactionTxnHandler.java
+++ b/ql/src/test/org/apache/hadoop/hive/metastore/txn/TestCompactionTxnHandler.java
@@ -398,6 +398,16 @@ public void testGetLatestCompactionWithIdFilter() throws Exception {
     assertEquals(partitionName, lci.getPartitionname());
     assertEquals(CompactionType.MINOR, lci.getType());
 
+    // response should contain the latest compaction
+    rqst.setLastCompactionId(1);
+    response = txnHandler.getLatestCommittedCompactionInfo(rqst);
+    assertNotNull(response);
+    assertEquals("Expecting a single record", 1, response.getCompactionsSize());
+    lci = response.getCompactions().get(0);
+    assertEquals("Expecting the second succeeded compaction record", 2, lci.getId());
+    assertEquals(partitionName, lci.getPartitionname());
+    assertEquals(CompactionType.MINOR, lci.getType());
+
     // response should only include compaction with id > 2
     rqst.setLastCompactionId(2);
     response = txnHandler.getLatestCommittedCompactionInfo(rqst);
diff --git a/standalone-metastore/metastore-server/src/main/java/org/apache/hadoop/hive/metastore/txn/TxnHandler.java b/standalone-metastore/metastore-server/src/main/java/org/apache/hadoop/hive/metastore/txn/TxnHandler.java
index bf61d08a68..7bcaf4a6ac 100644
--- a/standalone-metastore/metastore-server/src/main/java/org/apache/hadoop/hive/metastore/txn/TxnHandler.java
+++ b/standalone-metastore/metastore-server/src/main/java/org/apache/hadoop/hive/metastore/txn/TxnHandler.java
@@ -4024,12 +4024,14 @@ public GetLatestCommittedCompactionInfoResponse getLatestCommittedCompactionInfo
         }
         if (rqst.isSetLastCompactionId()) {
           sb.append(" AND \"CC_ID\" > ?");
-          params.add(String.valueOf(rqst.getLastCompactionId()));
         }
         sb.append(" ORDER BY \"CC_ID\" DESC");
 
         pst = sqlGenerator.prepareStmtWithParameters(dbConn, sb.toString(), params);
-        LOG.debug("Going to execute query <" + sb.toString() + ">");
+        if (rqst.isSetLastCompactionId()) {
+          pst.setLong(params.size() + 1, rqst.getLastCompactionId());
+        }
+        LOG.debug("Going to execute query <{}>", sb);
         rs = pst.executeQuery();
         Set<String> partitionSet = new HashSet<>();
         while (rs.next()) {
@@ -4049,7 +4051,7 @@ public GetLatestCommittedCompactionInfoResponse getLatestCommittedCompactionInfo
           }
         }
       } catch (SQLException e) {
-        LOG.error("Unable to execute query " + e.getMessage());
+        LOG.error("Unable to execute query", e);
         checkRetryable(e, "getLatestCommittedCompactionInfo");
       } finally {
         close(rs, pst, dbConn);
