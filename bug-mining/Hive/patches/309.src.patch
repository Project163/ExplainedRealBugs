diff --git a/CHANGES.txt b/CHANGES.txt
index 01ce5ac753..72369e1d69 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -366,6 +366,9 @@ Trunk -  Unreleased
     HIVE-979 selectNoStar is a part of explainPlan
     (Paul Yang via namit)
 
+    HIVE-1009 bug in union along with transform
+    (Ning Zhang via namit)
+
 Release 0.4.0 -  Unreleased
 
   INCOMPATIBLE CHANGES
diff --git a/contrib/src/test/results/clientpositive/serde_typedbytes.q.out b/contrib/src/test/results/clientpositive/serde_typedbytes.q.out
index 890a863b0e..967c27bfaf 100644
--- a/contrib/src/test/results/clientpositive/serde_typedbytes.q.out
+++ b/contrib/src/test/results/clientpositive/serde_typedbytes.q.out
@@ -58,9 +58,9 @@ STAGE PLANS:
                     output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                 Select Operator
                   expressions:
-                        expr: tkey
+                        expr: _col0
                         type: string
-                        expr: tvalue
+                        expr: _col1
                         type: string
                   outputColumnNames: _col0, _col1
                   Select Operator
@@ -85,10 +85,10 @@ STAGE PLANS:
           Move Operator
             files:
                 hdfs directory: true
-                destination: file:/data/users/njain/hive5/hive5/build/ql/tmp/1381406508/10000
+                destination: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/638596647/10000
           Map Reduce
             Alias -> Map Operator Tree:
-              file:/data/users/njain/hive5/hive5/build/ql/tmp/2145629671/10002 
+              file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/66739902/10002 
                   Reduce Output Operator
                     sort order: 
                     Map-reduce partition columns:
@@ -149,11 +149,11 @@ POSTHOOK: Output: default@dest1
 PREHOOK: query: SELECT dest1.* FROM dest1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@dest1
-PREHOOK: Output: file:/data/users/njain/hive5/hive5/build/ql/tmp/1901712227/10000
+PREHOOK: Output: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/934071985/10000
 POSTHOOK: query: SELECT dest1.* FROM dest1
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@dest1
-POSTHOOK: Output: file:/data/users/njain/hive5/hive5/build/ql/tmp/1901712227/10000
+POSTHOOK: Output: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/934071985/10000
 238	val_238
 86	val_86
 311	val_311
diff --git a/contrib/src/test/results/clientpositive/serde_typedbytes2.q.out b/contrib/src/test/results/clientpositive/serde_typedbytes2.q.out
index 5e7ef0b062..9b5b9d7dda 100644
--- a/contrib/src/test/results/clientpositive/serde_typedbytes2.q.out
+++ b/contrib/src/test/results/clientpositive/serde_typedbytes2.q.out
@@ -58,9 +58,9 @@ STAGE PLANS:
                     output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                 Select Operator
                   expressions:
-                        expr: tkey
+                        expr: _col0
                         type: smallint
-                        expr: tvalue
+                        expr: _col1
                         type: string
                   outputColumnNames: _col0, _col1
                   File Output Operator
@@ -78,10 +78,10 @@ STAGE PLANS:
           Move Operator
             files:
                 hdfs directory: true
-                destination: file:/data/users/njain/hive1/hive1/build/ql/tmp/1513901870/10000
+                destination: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/2098258409/10000
           Map Reduce
             Alias -> Map Operator Tree:
-              file:/data/users/njain/hive1/hive1/build/ql/tmp/1534939955/10002 
+              file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/2125173315/10002 
                   Reduce Output Operator
                     sort order: 
                     Map-reduce partition columns:
@@ -142,11 +142,11 @@ POSTHOOK: Output: default@dest1
 PREHOOK: query: SELECT dest1.* FROM dest1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@dest1
-PREHOOK: Output: file:/data/users/njain/hive1/hive1/build/ql/tmp/1744285312/10000
+PREHOOK: Output: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/800670373/10000
 POSTHOOK: query: SELECT dest1.* FROM dest1
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@dest1
-POSTHOOK: Output: file:/data/users/njain/hive1/hive1/build/ql/tmp/1744285312/10000
+POSTHOOK: Output: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/800670373/10000
 238	val_238
 86	val_86
 311	val_311
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
index 61ac1c459c..a8b903f7ef 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
@@ -1190,8 +1190,14 @@ else if (outCols.getType() == HiveParser.TOK_TABCOLLIST)
 
     // If column type is not specified, use a string
     if (!outputColNames && !outputColSchemas) {
-      outputCols.add(new ColumnInfo("key", TypeInfoFactory.stringTypeInfo, null, false));
-      outputCols.add(new ColumnInfo("value", TypeInfoFactory.stringTypeInfo, null, false));
+      String intName = getColumnInternalName(0);
+      ColumnInfo colInfo = new ColumnInfo(intName, TypeInfoFactory.stringTypeInfo, null, false);
+      colInfo.setAlias("key");
+      outputCols.add(colInfo);
+      intName = getColumnInternalName(1);
+      colInfo = new ColumnInfo(intName, TypeInfoFactory.stringTypeInfo, null, false);
+      colInfo.setAlias("value");
+      outputCols.add(colInfo);
       defaultOutputCols = true;
     }
     else {
@@ -1203,7 +1209,10 @@ else if (outCols.getType() == HiveParser.TOK_TABCOLLIST)
         for (int i=0; i < ccount; ++i) {
           String colAlias = unescapeIdentifier(((ASTNode)collist.getChild(i)).getText());
           failIfColAliasExists(colAliasNamesDuplicateCheck, colAlias);
-          outputCols.add(new ColumnInfo(colAlias, TypeInfoFactory.stringTypeInfo, null, false));
+          String intName = getColumnInternalName(i);
+          ColumnInfo colInfo = new ColumnInfo(intName, TypeInfoFactory.stringTypeInfo, null, false);
+          colInfo.setAlias(colAlias);
+          outputCols.add(colInfo);
         }
       }
       else {
@@ -1212,7 +1221,10 @@ else if (outCols.getType() == HiveParser.TOK_TABCOLLIST)
           assert child.getType() == HiveParser.TOK_TABCOL;
           String colAlias = unescapeIdentifier(((ASTNode)child.getChild(0)).getText());
           failIfColAliasExists(colAliasNamesDuplicateCheck, colAlias);
-          outputCols.add(new ColumnInfo(colAlias, TypeInfoUtils.getTypeInfoFromTypeString(getTypeStringFromAST((ASTNode)child.getChild(1))), null, false));
+          String intName = getColumnInternalName(i);
+          ColumnInfo colInfo = new ColumnInfo(intName, TypeInfoUtils.getTypeInfoFromTypeString(getTypeStringFromAST((ASTNode)child.getChild(1))), null, false);
+          colInfo.setAlias(colAlias);
+          outputCols.add(colInfo);
         }
       }
     }
@@ -1232,7 +1244,7 @@ else if (outCols.getType() == HiveParser.TOK_TABCOLLIST)
 
       out_rwsch.put(
         qb.getParseInfo().getAlias(),
-        outputCols.get(i).getInternalName(),
+        outputCols.get(i).getAlias(),
         outputCols.get(i));
     }
 
diff --git a/ql/src/test/results/clientpositive/input14.q.out b/ql/src/test/results/clientpositive/input14.q.out
index 7664e75e7f..5c292e3231 100644
--- a/ql/src/test/results/clientpositive/input14.q.out
+++ b/ql/src/test/results/clientpositive/input14.q.out
@@ -49,17 +49,17 @@ STAGE PLANS:
                     output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                 Reduce Output Operator
                   key expressions:
-                        expr: tkey
+                        expr: _col0
                         type: string
                   sort order: +
                   Map-reduce partition columns:
-                        expr: tkey
+                        expr: _col0
                         type: string
                   tag: -1
                   value expressions:
-                        expr: tkey
+                        expr: _col0
                         type: string
-                        expr: tvalue
+                        expr: _col1
                         type: string
       Reduce Operator Tree:
         Extract
@@ -124,11 +124,11 @@ POSTHOOK: Output: default@dest1
 PREHOOK: query: SELECT dest1.* FROM dest1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@dest1
-PREHOOK: Output: file:/data/users/njain/hive5/hive5/build/ql/tmp/272043780/10000
+PREHOOK: Output: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/1581739074/10000
 POSTHOOK: query: SELECT dest1.* FROM dest1
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@dest1
-POSTHOOK: Output: file:/data/users/njain/hive5/hive5/build/ql/tmp/272043780/10000
+POSTHOOK: Output: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/1581739074/10000
 0	val_0
 0	val_0
 0	val_0
diff --git a/ql/src/test/results/clientpositive/input14_limit.q.out b/ql/src/test/results/clientpositive/input14_limit.q.out
index d47177b842..bc1f171920 100644
--- a/ql/src/test/results/clientpositive/input14_limit.q.out
+++ b/ql/src/test/results/clientpositive/input14_limit.q.out
@@ -50,17 +50,17 @@ STAGE PLANS:
                     output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                 Reduce Output Operator
                   key expressions:
-                        expr: tkey
+                        expr: _col0
                         type: string
                   sort order: +
                   Map-reduce partition columns:
-                        expr: tkey
+                        expr: _col0
                         type: string
                   tag: -1
                   value expressions:
-                        expr: tkey
+                        expr: _col0
                         type: string
-                        expr: tvalue
+                        expr: _col1
                         type: string
       Reduce Operator Tree:
         Extract
@@ -75,7 +75,7 @@ STAGE PLANS:
   Stage: Stage-2
     Map Reduce
       Alias -> Map Operator Tree:
-        file:/data/users/njain/hive5/hive5/build/ql/tmp/1087885885/10002 
+        file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/275552824/10002 
             Reduce Output Operator
               key expressions:
                     expr: _col0
@@ -154,11 +154,11 @@ POSTHOOK: Output: default@dest1
 PREHOOK: query: SELECT dest1.* FROM dest1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@dest1
-PREHOOK: Output: file:/data/users/njain/hive5/hive5/build/ql/tmp/1130808860/10000
+PREHOOK: Output: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/679446797/10000
 POSTHOOK: query: SELECT dest1.* FROM dest1
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@dest1
-POSTHOOK: Output: file:/data/users/njain/hive5/hive5/build/ql/tmp/1130808860/10000
+POSTHOOK: Output: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/679446797/10000
 0	val_0
 0	val_0
 0	val_0
diff --git a/ql/src/test/results/clientpositive/input17.q.out b/ql/src/test/results/clientpositive/input17.q.out
index e76af52638..d8d1f3f3de 100644
--- a/ql/src/test/results/clientpositive/input17.q.out
+++ b/ql/src/test/results/clientpositive/input17.q.out
@@ -49,17 +49,17 @@ STAGE PLANS:
                     output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                 Reduce Output Operator
                   key expressions:
-                        expr: tkey
+                        expr: _col0
                         type: string
                   sort order: +
                   Map-reduce partition columns:
-                        expr: tkey
+                        expr: _col0
                         type: string
                   tag: -1
                   value expressions:
-                        expr: tkey
+                        expr: _col0
                         type: string
-                        expr: tvalue
+                        expr: _col1
                         type: string
       Reduce Operator Tree:
         Extract
@@ -120,11 +120,11 @@ POSTHOOK: Output: default@dest1
 PREHOOK: query: SELECT dest1.* FROM dest1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@dest1
-PREHOOK: Output: file:/data/users/njain/hive5/hive5/build/ql/tmp/622897498/10000
+PREHOOK: Output: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/1351757908/10000
 POSTHOOK: query: SELECT dest1.* FROM dest1
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@dest1
-POSTHOOK: Output: file:/data/users/njain/hive5/hive5/build/ql/tmp/622897498/10000
+POSTHOOK: Output: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/1351757908/10000
 NULL	null
 -1461153966	{"myint":49,"mystring":"343","underscore_int":7}
 -1952710705	{"myint":25,"mystring":"125","underscore_int":5}
diff --git a/ql/src/test/results/clientpositive/input18.q.out b/ql/src/test/results/clientpositive/input18.q.out
index cf9d2d2d92..d9b630bd01 100644
--- a/ql/src/test/results/clientpositive/input18.q.out
+++ b/ql/src/test/results/clientpositive/input18.q.out
@@ -53,17 +53,17 @@ STAGE PLANS:
                     output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                 Reduce Output Operator
                   key expressions:
-                        expr: key
+                        expr: _col0
                         type: string
                   sort order: +
                   Map-reduce partition columns:
-                        expr: key
+                        expr: _col0
                         type: string
                   tag: -1
                   value expressions:
-                        expr: key
+                        expr: _col0
                         type: string
-                        expr: value
+                        expr: _col1
                         type: string
       Reduce Operator Tree:
         Extract
@@ -128,11 +128,11 @@ POSTHOOK: Output: default@dest1
 PREHOOK: query: SELECT dest1.* FROM dest1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@dest1
-PREHOOK: Output: file:/data/users/njain/hive5/hive5/build/ql/tmp/1911474046/10000
+PREHOOK: Output: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/542338951/10000
 POSTHOOK: query: SELECT dest1.* FROM dest1
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@dest1
-POSTHOOK: Output: file:/data/users/njain/hive5/hive5/build/ql/tmp/1911474046/10000
+POSTHOOK: Output: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/542338951/10000
 0	val_0+3+7
 0	val_0+3+7
 0	val_0+3+7
diff --git a/ql/src/test/results/clientpositive/input20.q.out b/ql/src/test/results/clientpositive/input20.q.out
index 7c33ce3f36..7a43f56ea6 100644
--- a/ql/src/test/results/clientpositive/input20.q.out
+++ b/ql/src/test/results/clientpositive/input20.q.out
@@ -57,19 +57,19 @@ STAGE PLANS:
                     output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                 Reduce Output Operator
                   key expressions:
-                        expr: key
+                        expr: _col0
                         type: string
-                        expr: value
+                        expr: _col1
                         type: string
                   sort order: ++
                   Map-reduce partition columns:
-                        expr: key
+                        expr: _col0
                         type: string
                   tag: -1
                   value expressions:
-                        expr: key
+                        expr: _col0
                         type: string
-                        expr: value
+                        expr: _col1
                         type: string
       Reduce Operator Tree:
         Extract
@@ -87,9 +87,9 @@ STAGE PLANS:
                   output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
               Select Operator
                 expressions:
-                      expr: UDFToInteger(key)
+                      expr: UDFToInteger(_col0)
                       type: int
-                      expr: value
+                      expr: _col1
                       type: string
                 outputColumnNames: _col0, _col1
                 File Output Operator
@@ -143,11 +143,11 @@ POSTHOOK: Output: default@dest1
 PREHOOK: query: SELECT * FROM dest1 SORT BY key, value
 PREHOOK: type: QUERY
 PREHOOK: Input: default@dest1
-PREHOOK: Output: file:/data/users/njain/hive5/hive5/build/ql/tmp/1617315543/10000
+PREHOOK: Output: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/1591758903/10000
 POSTHOOK: query: SELECT * FROM dest1 SORT BY key, value
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@dest1
-POSTHOOK: Output: file:/data/users/njain/hive5/hive5/build/ql/tmp/1617315543/10000
+POSTHOOK: Output: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/1591758903/10000
 1	105_105
 1	10_10
 1	111_111
diff --git a/ql/src/test/results/clientpositive/input33.q.out b/ql/src/test/results/clientpositive/input33.q.out
index 321c7de4be..a398107ce7 100644
--- a/ql/src/test/results/clientpositive/input33.q.out
+++ b/ql/src/test/results/clientpositive/input33.q.out
@@ -57,19 +57,19 @@ STAGE PLANS:
                     output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                 Reduce Output Operator
                   key expressions:
-                        expr: key
+                        expr: _col0
                         type: string
-                        expr: value
+                        expr: _col1
                         type: string
                   sort order: ++
                   Map-reduce partition columns:
-                        expr: key
+                        expr: _col0
                         type: string
                   tag: -1
                   value expressions:
-                        expr: key
+                        expr: _col0
                         type: string
-                        expr: value
+                        expr: _col1
                         type: string
       Reduce Operator Tree:
         Extract
@@ -87,9 +87,9 @@ STAGE PLANS:
                   output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
               Select Operator
                 expressions:
-                      expr: UDFToInteger(key)
+                      expr: UDFToInteger(_col0)
                       type: int
-                      expr: value
+                      expr: _col1
                       type: string
                 outputColumnNames: _col0, _col1
                 File Output Operator
@@ -143,11 +143,11 @@ POSTHOOK: Output: default@dest1
 PREHOOK: query: SELECT * FROM dest1 SORT BY key, value
 PREHOOK: type: QUERY
 PREHOOK: Input: default@dest1
-PREHOOK: Output: file:/data/users/njain/hive5/hive5/build/ql/tmp/2057999513/10000
+PREHOOK: Output: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/643220558/10000
 POSTHOOK: query: SELECT * FROM dest1 SORT BY key, value
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@dest1
-POSTHOOK: Output: file:/data/users/njain/hive5/hive5/build/ql/tmp/2057999513/10000
+POSTHOOK: Output: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/643220558/10000
 1	105_105
 1	10_10
 1	111_111
diff --git a/ql/src/test/results/clientpositive/input34.q.out b/ql/src/test/results/clientpositive/input34.q.out
index d4ee6a231a..97798f5317 100644
--- a/ql/src/test/results/clientpositive/input34.q.out
+++ b/ql/src/test/results/clientpositive/input34.q.out
@@ -50,9 +50,9 @@ STAGE PLANS:
                     output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                 Select Operator
                   expressions:
-                        expr: tkey
+                        expr: _col0
                         type: string
-                        expr: tvalue
+                        expr: _col1
                         type: string
                   outputColumnNames: _col0, _col1
                   Select Operator
@@ -77,10 +77,10 @@ STAGE PLANS:
           Move Operator
             files:
                 hdfs directory: true
-                destination: file:/data/users/njain/hive5/hive5/build/ql/tmp/1855291816/10000
+                destination: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/893190347/10000
           Map Reduce
             Alias -> Map Operator Tree:
-              file:/data/users/njain/hive5/hive5/build/ql/tmp/555988603/10002 
+              file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/74467118/10002 
                   Reduce Output Operator
                     sort order: 
                     Map-reduce partition columns:
@@ -137,11 +137,11 @@ POSTHOOK: Output: default@dest1
 PREHOOK: query: SELECT dest1.* FROM dest1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@dest1
-PREHOOK: Output: file:/data/users/njain/hive5/hive5/build/ql/tmp/1579819069/10000
+PREHOOK: Output: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/286788495/10000
 POSTHOOK: query: SELECT dest1.* FROM dest1
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@dest1
-POSTHOOK: Output: file:/data/users/njain/hive5/hive5/build/ql/tmp/1579819069/10000
+POSTHOOK: Output: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/286788495/10000
 238	val_238
 86	val_86
 311	val_311
diff --git a/ql/src/test/results/clientpositive/input35.q.out b/ql/src/test/results/clientpositive/input35.q.out
index 605938ddee..7922dd7a92 100644
--- a/ql/src/test/results/clientpositive/input35.q.out
+++ b/ql/src/test/results/clientpositive/input35.q.out
@@ -50,9 +50,9 @@ STAGE PLANS:
                     output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                 Select Operator
                   expressions:
-                        expr: tkey
+                        expr: _col0
                         type: string
-                        expr: tvalue
+                        expr: _col1
                         type: string
                   outputColumnNames: _col0, _col1
                   Select Operator
@@ -77,10 +77,10 @@ STAGE PLANS:
           Move Operator
             files:
                 hdfs directory: true
-                destination: file:/data/users/njain/hive5/hive5/build/ql/tmp/544202760/10000
+                destination: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/1523139357/10000
           Map Reduce
             Alias -> Map Operator Tree:
-              file:/data/users/njain/hive5/hive5/build/ql/tmp/1946525886/10002 
+              file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/35901334/10002 
                   Reduce Output Operator
                     sort order: 
                     Map-reduce partition columns:
@@ -137,11 +137,11 @@ POSTHOOK: Output: default@dest1
 PREHOOK: query: SELECT dest1.* FROM dest1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@dest1
-PREHOOK: Output: file:/data/users/njain/hive5/hive5/build/ql/tmp/1946173238/10000
+PREHOOK: Output: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/953532655/10000
 POSTHOOK: query: SELECT dest1.* FROM dest1
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@dest1
-POSTHOOK: Output: file:/data/users/njain/hive5/hive5/build/ql/tmp/1946173238/10000
+POSTHOOK: Output: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/953532655/10000
 238	val_238
 86	val_86
 311	val_311
diff --git a/ql/src/test/results/clientpositive/input36.q.out b/ql/src/test/results/clientpositive/input36.q.out
index b346a4489a..f0cd08fe0c 100644
--- a/ql/src/test/results/clientpositive/input36.q.out
+++ b/ql/src/test/results/clientpositive/input36.q.out
@@ -50,9 +50,9 @@ STAGE PLANS:
                     output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                 Select Operator
                   expressions:
-                        expr: tkey
+                        expr: _col0
                         type: string
-                        expr: tvalue
+                        expr: _col1
                         type: string
                   outputColumnNames: _col0, _col1
                   Select Operator
@@ -77,10 +77,10 @@ STAGE PLANS:
           Move Operator
             files:
                 hdfs directory: true
-                destination: file:/data/users/njain/hive5/hive5/build/ql/tmp/36900074/10000
+                destination: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/1483995335/10000
           Map Reduce
             Alias -> Map Operator Tree:
-              file:/data/users/njain/hive5/hive5/build/ql/tmp/1853787286/10002 
+              file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/1402980606/10002 
                   Reduce Output Operator
                     sort order: 
                     Map-reduce partition columns:
@@ -137,11 +137,11 @@ POSTHOOK: Output: default@dest1
 PREHOOK: query: SELECT dest1.* FROM dest1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@dest1
-PREHOOK: Output: file:/data/users/njain/hive5/hive5/build/ql/tmp/1745072607/10000
+PREHOOK: Output: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/593456402/10000
 POSTHOOK: query: SELECT dest1.* FROM dest1
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@dest1
-POSTHOOK: Output: file:/data/users/njain/hive5/hive5/build/ql/tmp/1745072607/10000
+POSTHOOK: Output: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/593456402/10000
 NULL	NULL
 NULL	NULL
 NULL	NULL
diff --git a/ql/src/test/results/clientpositive/input38.q.out b/ql/src/test/results/clientpositive/input38.q.out
index 894a19cf04..4a00e31ccd 100644
--- a/ql/src/test/results/clientpositive/input38.q.out
+++ b/ql/src/test/results/clientpositive/input38.q.out
@@ -56,9 +56,9 @@ STAGE PLANS:
                     output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                 Select Operator
                   expressions:
-                        expr: key
+                        expr: _col0
                         type: string
-                        expr: value
+                        expr: _col1
                         type: string
                   outputColumnNames: _col0, _col1
                   File Output Operator
@@ -76,10 +76,10 @@ STAGE PLANS:
           Move Operator
             files:
                 hdfs directory: true
-                destination: file:/data/users/njain/hive5/hive5/build/ql/tmp/209905315/10000
+                destination: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/588338648/10000
           Map Reduce
             Alias -> Map Operator Tree:
-              file:/data/users/njain/hive5/hive5/build/ql/tmp/2069167411/10002 
+              file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/866246738/10002 
                   Reduce Output Operator
                     sort order: 
                     Map-reduce partition columns:
@@ -134,11 +134,11 @@ POSTHOOK: Output: default@dest1
 PREHOOK: query: SELECT dest1.* FROM dest1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@dest1
-PREHOOK: Output: file:/data/users/njain/hive5/hive5/build/ql/tmp/131517216/10000
+PREHOOK: Output: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/461093773/10000
 POSTHOOK: query: SELECT dest1.* FROM dest1
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@dest1
-POSTHOOK: Output: file:/data/users/njain/hive5/hive5/build/ql/tmp/131517216/10000
+POSTHOOK: Output: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/461093773/10000
 238	val_238	3	7
 86	val_86	3	7
 311	val_311	3	7
diff --git a/ql/src/test/results/clientpositive/input5.q.out b/ql/src/test/results/clientpositive/input5.q.out
index 001d69cb9e..3fbb89bf81 100644
--- a/ql/src/test/results/clientpositive/input5.q.out
+++ b/ql/src/test/results/clientpositive/input5.q.out
@@ -49,17 +49,17 @@ STAGE PLANS:
                     output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                 Reduce Output Operator
                   key expressions:
-                        expr: tkey
+                        expr: _col0
                         type: string
                   sort order: +
                   Map-reduce partition columns:
-                        expr: tkey
+                        expr: _col0
                         type: string
                   tag: -1
                   value expressions:
-                        expr: tkey
+                        expr: _col0
                         type: string
-                        expr: tvalue
+                        expr: _col1
                         type: string
       Reduce Operator Tree:
         Extract
@@ -113,11 +113,11 @@ POSTHOOK: Output: default@dest1
 PREHOOK: query: SELECT dest1.* FROM dest1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@dest1
-PREHOOK: Output: file:/data/users/njain/hive5/hive5/build/ql/tmp/532588189/10000
+PREHOOK: Output: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/1949552332/10000
 POSTHOOK: query: SELECT dest1.* FROM dest1
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@dest1
-POSTHOOK: Output: file:/data/users/njain/hive5/hive5/build/ql/tmp/532588189/10000
+POSTHOOK: Output: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/1949552332/10000
 [0,0,0]	[{"myint":0,"mystring":"0","underscore_int":0}]
 [1,2,3]	[{"myint":1,"mystring":"1","underscore_int":1}]
 [2,4,6]	[{"myint":4,"mystring":"8","underscore_int":2}]
diff --git a/ql/src/test/results/clientpositive/mapreduce1.q.out b/ql/src/test/results/clientpositive/mapreduce1.q.out
index e479cdfe2b..0e623873f7 100644
--- a/ql/src/test/results/clientpositive/mapreduce1.q.out
+++ b/ql/src/test/results/clientpositive/mapreduce1.q.out
@@ -51,25 +51,25 @@ STAGE PLANS:
                     output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                 Reduce Output Operator
                   key expressions:
-                        expr: ten
+                        expr: _col1
                         type: string
-                        expr: one
+                        expr: _col2
                         type: string
                   sort order: ++
                   Map-reduce partition columns:
-                        expr: tvalue
+                        expr: _col3
                         type: string
-                        expr: tkey
+                        expr: _col0
                         type: string
                   tag: -1
                   value expressions:
-                        expr: tkey
+                        expr: _col0
                         type: string
-                        expr: ten
+                        expr: _col1
                         type: string
-                        expr: one
+                        expr: _col2
                         type: string
-                        expr: tvalue
+                        expr: _col3
                         type: string
       Reduce Operator Tree:
         Extract
@@ -125,11 +125,11 @@ POSTHOOK: Output: default@dest1
 PREHOOK: query: SELECT dest1.* FROM dest1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@dest1
-PREHOOK: Output: file:/data/users/njain/hive5/hive5/build/ql/tmp/39861038/10000
+PREHOOK: Output: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/337545490/10000
 POSTHOOK: query: SELECT dest1.* FROM dest1
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@dest1
-POSTHOOK: Output: file:/data/users/njain/hive5/hive5/build/ql/tmp/39861038/10000
+POSTHOOK: Output: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/337545490/10000
 0	0	0	val_0
 0	0	0	val_0
 0	0	0	val_0
diff --git a/ql/src/test/results/clientpositive/mapreduce2.q.out b/ql/src/test/results/clientpositive/mapreduce2.q.out
index 26040ff737..211ef43310 100644
--- a/ql/src/test/results/clientpositive/mapreduce2.q.out
+++ b/ql/src/test/results/clientpositive/mapreduce2.q.out
@@ -50,19 +50,19 @@ STAGE PLANS:
                 Reduce Output Operator
                   sort order: 
                   Map-reduce partition columns:
-                        expr: tvalue
+                        expr: _col3
                         type: string
-                        expr: tkey
+                        expr: _col0
                         type: string
                   tag: -1
                   value expressions:
-                        expr: tkey
+                        expr: _col0
                         type: string
-                        expr: ten
+                        expr: _col1
                         type: string
-                        expr: one
+                        expr: _col2
                         type: string
-                        expr: tvalue
+                        expr: _col3
                         type: string
       Reduce Operator Tree:
         Extract
@@ -116,11 +116,11 @@ POSTHOOK: Output: default@dest1
 PREHOOK: query: SELECT * FROM (SELECT dest1.* FROM dest1 DISTRIBUTE BY key SORT BY key, ten, one, value) T
 PREHOOK: type: QUERY
 PREHOOK: Input: default@dest1
-PREHOOK: Output: file:/data/users/njain/hive5/hive5/build/ql/tmp/1870907070/10000
+PREHOOK: Output: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/1481559140/10000
 POSTHOOK: query: SELECT * FROM (SELECT dest1.* FROM dest1 DISTRIBUTE BY key SORT BY key, ten, one, value) T
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@dest1
-POSTHOOK: Output: file:/data/users/njain/hive5/hive5/build/ql/tmp/1870907070/10000
+POSTHOOK: Output: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/1481559140/10000
 0	0	0	val_0
 0	0	0	val_0
 0	0	0	val_0
diff --git a/ql/src/test/results/clientpositive/mapreduce3.q.out b/ql/src/test/results/clientpositive/mapreduce3.q.out
index 807143f2df..61f265a9f7 100644
--- a/ql/src/test/results/clientpositive/mapreduce3.q.out
+++ b/ql/src/test/results/clientpositive/mapreduce3.q.out
@@ -49,20 +49,20 @@ STAGE PLANS:
                     output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                 Reduce Output Operator
                   key expressions:
-                        expr: tvalue
+                        expr: _col3
                         type: string
-                        expr: tkey
+                        expr: _col0
                         type: string
                   sort order: ++
                   tag: -1
                   value expressions:
-                        expr: tkey
+                        expr: _col0
                         type: string
-                        expr: ten
+                        expr: _col1
                         type: string
-                        expr: one
+                        expr: _col2
                         type: string
-                        expr: tvalue
+                        expr: _col3
                         type: string
       Reduce Operator Tree:
         Extract
@@ -116,11 +116,11 @@ POSTHOOK: Output: default@dest1
 PREHOOK: query: SELECT dest1.* FROM dest1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@dest1
-PREHOOK: Output: file:/data/users/njain/hive5/hive5/build/ql/tmp/1933944424/10000
+PREHOOK: Output: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/1096120278/10000
 POSTHOOK: query: SELECT dest1.* FROM dest1
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@dest1
-POSTHOOK: Output: file:/data/users/njain/hive5/hive5/build/ql/tmp/1933944424/10000
+POSTHOOK: Output: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/1096120278/10000
 0	0	0	val_0
 0	0	0	val_0
 0	0	0	val_0
diff --git a/ql/src/test/results/clientpositive/mapreduce4.q.out b/ql/src/test/results/clientpositive/mapreduce4.q.out
index 73708d1bdd..18e84847a1 100644
--- a/ql/src/test/results/clientpositive/mapreduce4.q.out
+++ b/ql/src/test/results/clientpositive/mapreduce4.q.out
@@ -51,25 +51,25 @@ STAGE PLANS:
                     output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                 Reduce Output Operator
                   key expressions:
-                        expr: ten
+                        expr: _col1
                         type: string
-                        expr: one
+                        expr: _col2
                         type: string
                   sort order: -+
                   Map-reduce partition columns:
-                        expr: tvalue
+                        expr: _col3
                         type: string
-                        expr: tkey
+                        expr: _col0
                         type: string
                   tag: -1
                   value expressions:
-                        expr: tkey
+                        expr: _col0
                         type: string
-                        expr: ten
+                        expr: _col1
                         type: string
-                        expr: one
+                        expr: _col2
                         type: string
-                        expr: tvalue
+                        expr: _col3
                         type: string
       Reduce Operator Tree:
         Extract
@@ -125,11 +125,11 @@ POSTHOOK: Output: default@dest1
 PREHOOK: query: SELECT dest1.* FROM dest1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@dest1
-PREHOOK: Output: file:/data/users/njain/hive5/hive5/build/ql/tmp/664955225/10000
+PREHOOK: Output: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/2140604895/10000
 POSTHOOK: query: SELECT dest1.* FROM dest1
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@dest1
-POSTHOOK: Output: file:/data/users/njain/hive5/hive5/build/ql/tmp/664955225/10000
+POSTHOOK: Output: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/2140604895/10000
 90	9	0	val_90
 90	9	0	val_90
 90	9	0	val_90
diff --git a/ql/src/test/results/clientpositive/mapreduce7.q.out b/ql/src/test/results/clientpositive/mapreduce7.q.out
index 42d458c0b4..17bc10b4d0 100644
--- a/ql/src/test/results/clientpositive/mapreduce7.q.out
+++ b/ql/src/test/results/clientpositive/mapreduce7.q.out
@@ -53,24 +53,24 @@ STAGE PLANS:
                     output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                 Reduce Output Operator
                   key expressions:
-                        expr: tvalue
+                        expr: _col5
                         type: string
-                        expr: tkey
+                        expr: _col2
                         type: string
                   sort order: ++
                   tag: -1
                   value expressions:
-                        expr: k
+                        expr: _col0
                         type: string
-                        expr: v
+                        expr: _col1
                         type: string
-                        expr: tkey
+                        expr: _col2
                         type: string
-                        expr: ten
+                        expr: _col3
                         type: string
-                        expr: one
+                        expr: _col4
                         type: string
-                        expr: tvalue
+                        expr: _col5
                         type: string
       Reduce Operator Tree:
         Extract
@@ -128,11 +128,11 @@ POSTHOOK: Output: default@dest1
 PREHOOK: query: SELECT dest1.* FROM dest1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@dest1
-PREHOOK: Output: file:/data/users/njain/hive5/hive5/build/ql/tmp/950002812/10000
+PREHOOK: Output: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/933001468/10000
 POSTHOOK: query: SELECT dest1.* FROM dest1
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@dest1
-POSTHOOK: Output: file:/data/users/njain/hive5/hive5/build/ql/tmp/950002812/10000
+POSTHOOK: Output: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/933001468/10000
 0	val_0	0	0	0	val_0
 0	val_0	0	0	0	val_0
 0	val_0	0	0	0	val_0
diff --git a/ql/src/test/results/clientpositive/mapreduce8.q.out b/ql/src/test/results/clientpositive/mapreduce8.q.out
index 49d2709a4d..e76e8cf150 100644
--- a/ql/src/test/results/clientpositive/mapreduce8.q.out
+++ b/ql/src/test/results/clientpositive/mapreduce8.q.out
@@ -55,9 +55,9 @@ STAGE PLANS:
                     output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                 Reduce Output Operator
                   key expressions:
-                        expr: tvalue
+                        expr: _col5
                         type: string
-                        expr: tkey
+                        expr: _col2
                         type: string
                   sort order: ++
                   Map-reduce partition columns:
@@ -65,17 +65,17 @@ STAGE PLANS:
                         type: double
                   tag: -1
                   value expressions:
-                        expr: k
+                        expr: _col0
                         type: string
-                        expr: v
+                        expr: _col1
                         type: string
-                        expr: tkey
+                        expr: _col2
                         type: string
-                        expr: ten
+                        expr: _col3
                         type: string
-                        expr: one
+                        expr: _col4
                         type: string
-                        expr: tvalue
+                        expr: _col5
                         type: string
       Reduce Operator Tree:
         Extract
@@ -135,11 +135,11 @@ POSTHOOK: Output: default@dest1
 PREHOOK: query: SELECT dest1.* FROM dest1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@dest1
-PREHOOK: Output: file:/data/users/njain/hive5/hive5/build/ql/tmp/1419210118/10000
+PREHOOK: Output: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/1655540627/10000
 POSTHOOK: query: SELECT dest1.* FROM dest1
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@dest1
-POSTHOOK: Output: file:/data/users/njain/hive5/hive5/build/ql/tmp/1419210118/10000
+POSTHOOK: Output: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/1655540627/10000
 0	val_0	0	0	0	val_0
 0	val_0	0	0	0	val_0
 0	val_0	0	0	0	val_0
diff --git a/ql/src/test/results/clientpositive/ppd_transform.q.out b/ql/src/test/results/clientpositive/ppd_transform.q.out
index 305445aed4..b1848b9fc8 100644
--- a/ql/src/test/results/clientpositive/ppd_transform.q.out
+++ b/ql/src/test/results/clientpositive/ppd_transform.q.out
@@ -44,17 +44,17 @@ STAGE PLANS:
                     output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                 Reduce Output Operator
                   key expressions:
-                        expr: tkey
+                        expr: _col0
                         type: string
                   sort order: +
                   Map-reduce partition columns:
-                        expr: tkey
+                        expr: _col0
                         type: string
                   tag: -1
                   value expressions:
-                        expr: tkey
+                        expr: _col0
                         type: string
-                        expr: tvalue
+                        expr: _col1
                         type: string
       Reduce Operator Tree:
         Extract
@@ -90,7 +90,7 @@ PREHOOK: query: FROM (
 SELECT tmap.tkey, tmap.tvalue WHERE tmap.tkey < 100
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
-PREHOOK: Output: file:/data/users/njain/hive5/hive5/build/ql/tmp/932734239/10000
+PREHOOK: Output: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/275911490/10000
 POSTHOOK: query: FROM (
   FROM src
   SELECT TRANSFORM(src.key, src.value)
@@ -100,7 +100,7 @@ POSTHOOK: query: FROM (
 SELECT tmap.tkey, tmap.tvalue WHERE tmap.tkey < 100
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
-POSTHOOK: Output: file:/data/users/njain/hive5/hive5/build/ql/tmp/932734239/10000
+POSTHOOK: Output: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/275911490/10000
 0	val_0
 0	val_0
 0	val_0
diff --git a/ql/src/test/results/clientpositive/regexp_extract.q.out b/ql/src/test/results/clientpositive/regexp_extract.q.out
index 4a53d8e25a..ddc345d653 100644
--- a/ql/src/test/results/clientpositive/regexp_extract.q.out
+++ b/ql/src/test/results/clientpositive/regexp_extract.q.out
@@ -48,29 +48,29 @@ STAGE PLANS:
                     output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                     properties:
                       field.delim 9
-                      columns key,value
+                      columns _col0,_col1
                       serialization.format 9
                       columns.types string,string
                       serialization.last.column.takes.rest true
                 Reduce Output Operator
                   key expressions:
-                        expr: key
+                        expr: _col0
                         type: string
                   sort order: +
                   Map-reduce partition columns:
-                        expr: key
+                        expr: _col0
                         type: string
                   tag: -1
                   value expressions:
-                        expr: key
+                        expr: _col0
                         type: string
-                        expr: value
+                        expr: _col1
                         type: string
       Needs Tagging: false
       Path -> Alias:
-        file:/Users/heyongqiang/Documents/workspace/Hive-Test/build/ql/test/data/warehouse/src [tmap:src]
+        file:/data/users/nzhang/work/870/apache-hive/build/ql/test/data/warehouse/src [tmap:src]
       Path -> Partition:
-        file:/Users/heyongqiang/Documents/workspace/Hive-Test/build/ql/test/data/warehouse/src 
+        file:/data/users/nzhang/work/870/apache-hive/build/ql/test/data/warehouse/src 
           Partition
             input format: org.apache.hadoop.mapred.TextInputFormat
             output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -84,7 +84,8 @@ STAGE PLANS:
               serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               file.inputformat org.apache.hadoop.mapred.TextInputFormat
               file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-              location file:/Users/heyongqiang/Documents/workspace/Hive-Test/build/ql/test/data/warehouse/src
+              location file:/data/users/nzhang/work/870/apache-hive/build/ql/test/data/warehouse/src
+              transient_lastDdlTime 1261529841
             serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
           
               input format: org.apache.hadoop.mapred.TextInputFormat
@@ -99,8 +100,8 @@ STAGE PLANS:
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location file:/Users/heyongqiang/Documents/workspace/Hive-Test/build/ql/test/data/warehouse/src
-                transient_lastDdlTime 1258006656
+                location file:/data/users/nzhang/work/870/apache-hive/build/ql/test/data/warehouse/src
+                transient_lastDdlTime 1261529841
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: src
             name: src
@@ -121,7 +122,7 @@ STAGE PLANS:
               File Output Operator
                 compressed: false
                 GlobalTableId: 0
-                directory: file:/Users/heyongqiang/Documents/workspace/Hive-Test/build/ql/tmp/593477457/10001
+                directory: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/1967522222/10001
                 table:
                     input format: org.apache.hadoop.mapred.TextInputFormat
                     output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -144,7 +145,7 @@ PREHOOK: query: FROM (
 SELECT tmap.key, regexp_extract(tmap.value, 'val_(\\d+\\t\\d+)',1) WHERE tmap.key < 100
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
-PREHOOK: Output: file:/Users/heyongqiang/Documents/workspace/Hive-Test/build/ql/tmp/1880708499/10000
+PREHOOK: Output: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/1689304784/10000
 POSTHOOK: query: FROM (
   FROM src
   SELECT TRANSFORM(src.key, src.value, 1+2, 3+4)
@@ -154,7 +155,7 @@ POSTHOOK: query: FROM (
 SELECT tmap.key, regexp_extract(tmap.value, 'val_(\\d+\\t\\d+)',1) WHERE tmap.key < 100
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
-POSTHOOK: Output: file:/Users/heyongqiang/Documents/workspace/Hive-Test/build/ql/tmp/1880708499/10000
+POSTHOOK: Output: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/1689304784/10000
 0	0	3
 0	0	3
 0	0	3
@@ -289,29 +290,29 @@ STAGE PLANS:
                     output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                     properties:
                       field.delim 9
-                      columns key,value
+                      columns _col0,_col1
                       serialization.format 9
                       columns.types string,string
                       serialization.last.column.takes.rest true
                 Reduce Output Operator
                   key expressions:
-                        expr: key
+                        expr: _col0
                         type: string
                   sort order: +
                   Map-reduce partition columns:
-                        expr: key
+                        expr: _col0
                         type: string
                   tag: -1
                   value expressions:
-                        expr: key
+                        expr: _col0
                         type: string
-                        expr: value
+                        expr: _col1
                         type: string
       Needs Tagging: false
       Path -> Alias:
-        file:/Users/heyongqiang/Documents/workspace/Hive-Test/build/ql/test/data/warehouse/src [tmap:src]
+        file:/data/users/nzhang/work/870/apache-hive/build/ql/test/data/warehouse/src [tmap:src]
       Path -> Partition:
-        file:/Users/heyongqiang/Documents/workspace/Hive-Test/build/ql/test/data/warehouse/src 
+        file:/data/users/nzhang/work/870/apache-hive/build/ql/test/data/warehouse/src 
           Partition
             input format: org.apache.hadoop.mapred.TextInputFormat
             output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -325,7 +326,8 @@ STAGE PLANS:
               serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               file.inputformat org.apache.hadoop.mapred.TextInputFormat
               file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-              location file:/Users/heyongqiang/Documents/workspace/Hive-Test/build/ql/test/data/warehouse/src
+              location file:/data/users/nzhang/work/870/apache-hive/build/ql/test/data/warehouse/src
+              transient_lastDdlTime 1261529841
             serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
           
               input format: org.apache.hadoop.mapred.TextInputFormat
@@ -340,8 +342,8 @@ STAGE PLANS:
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location file:/Users/heyongqiang/Documents/workspace/Hive-Test/build/ql/test/data/warehouse/src
-                transient_lastDdlTime 1258006656
+                location file:/data/users/nzhang/work/870/apache-hive/build/ql/test/data/warehouse/src
+                transient_lastDdlTime 1261529841
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: src
             name: src
@@ -362,7 +364,7 @@ STAGE PLANS:
               File Output Operator
                 compressed: false
                 GlobalTableId: 0
-                directory: file:/Users/heyongqiang/Documents/workspace/Hive-Test/build/ql/tmp/1417051916/10001
+                directory: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/837479572/10001
                 table:
                     input format: org.apache.hadoop.mapred.TextInputFormat
                     output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -385,7 +387,7 @@ PREHOOK: query: FROM (
 SELECT tmap.key, regexp_extract(tmap.value, 'val_(\\d+\\t\\d+)') WHERE tmap.key < 100
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
-PREHOOK: Output: file:/Users/heyongqiang/Documents/workspace/Hive-Test/build/ql/tmp/1544735552/10000
+PREHOOK: Output: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/209947857/10000
 POSTHOOK: query: FROM (
   FROM src
   SELECT TRANSFORM(src.key, src.value, 1+2, 3+4)
@@ -395,7 +397,7 @@ POSTHOOK: query: FROM (
 SELECT tmap.key, regexp_extract(tmap.value, 'val_(\\d+\\t\\d+)') WHERE tmap.key < 100
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
-POSTHOOK: Output: file:/Users/heyongqiang/Documents/workspace/Hive-Test/build/ql/tmp/1544735552/10000
+POSTHOOK: Output: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/209947857/10000
 0	0	3
 0	0	3
 0	0	3
diff --git a/ql/src/test/results/clientpositive/transform_ppr1.q.out b/ql/src/test/results/clientpositive/transform_ppr1.q.out
index ce04e6f609..72c7974c14 100644
--- a/ql/src/test/results/clientpositive/transform_ppr1.q.out
+++ b/ql/src/test/results/clientpositive/transform_ppr1.q.out
@@ -46,33 +46,33 @@ STAGE PLANS:
                     output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                     properties:
                       field.delim 9
-                      columns ds,tkey,tvalue
+                      columns _col0,_col1,_col2
                       serialization.format 9
                       columns.types string,string,string
                 Reduce Output Operator
                   key expressions:
-                        expr: tkey
+                        expr: _col1
                         type: string
                   sort order: +
                   Map-reduce partition columns:
-                        expr: tkey
+                        expr: _col1
                         type: string
                   tag: -1
                   value expressions:
-                        expr: ds
+                        expr: _col0
                         type: string
-                        expr: tkey
+                        expr: _col1
                         type: string
-                        expr: tvalue
+                        expr: _col2
                         type: string
       Needs Tagging: false
       Path -> Alias:
-        file:/Users/heyongqiang/Documents/workspace/Hive-Test/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 [tmap:src]
-        file:/Users/heyongqiang/Documents/workspace/Hive-Test/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12 [tmap:src]
-        file:/Users/heyongqiang/Documents/workspace/Hive-Test/build/ql/test/data/warehouse/srcpart/ds=2008-04-09/hr=11 [tmap:src]
-        file:/Users/heyongqiang/Documents/workspace/Hive-Test/build/ql/test/data/warehouse/srcpart/ds=2008-04-09/hr=12 [tmap:src]
+        file:/data/users/nzhang/work/870/apache-hive/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 [tmap:src]
+        file:/data/users/nzhang/work/870/apache-hive/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12 [tmap:src]
+        file:/data/users/nzhang/work/870/apache-hive/build/ql/test/data/warehouse/srcpart/ds=2008-04-09/hr=11 [tmap:src]
+        file:/data/users/nzhang/work/870/apache-hive/build/ql/test/data/warehouse/srcpart/ds=2008-04-09/hr=12 [tmap:src]
       Path -> Partition:
-        file:/Users/heyongqiang/Documents/workspace/Hive-Test/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 
+        file:/data/users/nzhang/work/870/apache-hive/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 
           Partition
             input format: org.apache.hadoop.mapred.TextInputFormat
             output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -90,8 +90,8 @@ STAGE PLANS:
               serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               file.inputformat org.apache.hadoop.mapred.TextInputFormat
               file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-              location file:/Users/heyongqiang/Documents/workspace/Hive-Test/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11
-              transient_lastDdlTime 1258007151
+              location file:/data/users/nzhang/work/870/apache-hive/build/ql/test/data/warehouse/srcpart
+              transient_lastDdlTime 1261528545
             serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
           
               input format: org.apache.hadoop.mapred.TextInputFormat
@@ -107,12 +107,12 @@ STAGE PLANS:
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location file:/Users/heyongqiang/Documents/workspace/Hive-Test/build/ql/test/data/warehouse/srcpart
-                transient_lastDdlTime 1258007151
+                location file:/data/users/nzhang/work/870/apache-hive/build/ql/test/data/warehouse/srcpart
+                transient_lastDdlTime 1261528545
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: srcpart
             name: srcpart
-        file:/Users/heyongqiang/Documents/workspace/Hive-Test/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12 
+        file:/data/users/nzhang/work/870/apache-hive/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12 
           Partition
             input format: org.apache.hadoop.mapred.TextInputFormat
             output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -130,8 +130,8 @@ STAGE PLANS:
               serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               file.inputformat org.apache.hadoop.mapred.TextInputFormat
               file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-              location file:/Users/heyongqiang/Documents/workspace/Hive-Test/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12
-              transient_lastDdlTime 1258007151
+              location file:/data/users/nzhang/work/870/apache-hive/build/ql/test/data/warehouse/srcpart
+              transient_lastDdlTime 1261528545
             serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
           
               input format: org.apache.hadoop.mapred.TextInputFormat
@@ -147,12 +147,12 @@ STAGE PLANS:
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location file:/Users/heyongqiang/Documents/workspace/Hive-Test/build/ql/test/data/warehouse/srcpart
-                transient_lastDdlTime 1258007151
+                location file:/data/users/nzhang/work/870/apache-hive/build/ql/test/data/warehouse/srcpart
+                transient_lastDdlTime 1261528545
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: srcpart
             name: srcpart
-        file:/Users/heyongqiang/Documents/workspace/Hive-Test/build/ql/test/data/warehouse/srcpart/ds=2008-04-09/hr=11 
+        file:/data/users/nzhang/work/870/apache-hive/build/ql/test/data/warehouse/srcpart/ds=2008-04-09/hr=11 
           Partition
             input format: org.apache.hadoop.mapred.TextInputFormat
             output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -170,8 +170,8 @@ STAGE PLANS:
               serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               file.inputformat org.apache.hadoop.mapred.TextInputFormat
               file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-              location file:/Users/heyongqiang/Documents/workspace/Hive-Test/build/ql/test/data/warehouse/srcpart/ds=2008-04-09/hr=11
-              transient_lastDdlTime 1258007151
+              location file:/data/users/nzhang/work/870/apache-hive/build/ql/test/data/warehouse/srcpart
+              transient_lastDdlTime 1261528545
             serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
           
               input format: org.apache.hadoop.mapred.TextInputFormat
@@ -187,12 +187,12 @@ STAGE PLANS:
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location file:/Users/heyongqiang/Documents/workspace/Hive-Test/build/ql/test/data/warehouse/srcpart
-                transient_lastDdlTime 1258007151
+                location file:/data/users/nzhang/work/870/apache-hive/build/ql/test/data/warehouse/srcpart
+                transient_lastDdlTime 1261528545
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: srcpart
             name: srcpart
-        file:/Users/heyongqiang/Documents/workspace/Hive-Test/build/ql/test/data/warehouse/srcpart/ds=2008-04-09/hr=12 
+        file:/data/users/nzhang/work/870/apache-hive/build/ql/test/data/warehouse/srcpart/ds=2008-04-09/hr=12 
           Partition
             input format: org.apache.hadoop.mapred.TextInputFormat
             output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -210,8 +210,8 @@ STAGE PLANS:
               serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               file.inputformat org.apache.hadoop.mapred.TextInputFormat
               file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-              location file:/Users/heyongqiang/Documents/workspace/Hive-Test/build/ql/test/data/warehouse/srcpart/ds=2008-04-09/hr=12
-              transient_lastDdlTime 1258007151
+              location file:/data/users/nzhang/work/870/apache-hive/build/ql/test/data/warehouse/srcpart
+              transient_lastDdlTime 1261528545
             serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
           
               input format: org.apache.hadoop.mapred.TextInputFormat
@@ -227,8 +227,8 @@ STAGE PLANS:
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location file:/Users/heyongqiang/Documents/workspace/Hive-Test/build/ql/test/data/warehouse/srcpart
-                transient_lastDdlTime 1258007151
+                location file:/data/users/nzhang/work/870/apache-hive/build/ql/test/data/warehouse/srcpart
+                transient_lastDdlTime 1261528545
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: srcpart
             name: srcpart
@@ -249,7 +249,7 @@ STAGE PLANS:
               File Output Operator
                 compressed: false
                 GlobalTableId: 0
-                directory: file:/Users/heyongqiang/Documents/workspace/Hive-Test/build/ql/tmp/959108310/10001
+                directory: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/970775421/10001
                 table:
                     input format: org.apache.hadoop.mapred.TextInputFormat
                     output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -275,7 +275,7 @@ PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 PREHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
 PREHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
-PREHOOK: Output: file:/Users/heyongqiang/Documents/workspace/Hive-Test/build/ql/tmp/1392800649/10000
+PREHOOK: Output: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/1333096282/10000
 POSTHOOK: query: FROM (
   FROM srcpart src
   SELECT TRANSFORM(src.ds, src.key, src.value)
@@ -288,7 +288,7 @@ POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-09/hr=12
-POSTHOOK: Output: file:/Users/heyongqiang/Documents/workspace/Hive-Test/build/ql/tmp/1392800649/10000
+POSTHOOK: Output: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/1333096282/10000
 0	val_0
 0	val_0
 0	val_0
diff --git a/ql/src/test/results/clientpositive/transform_ppr2.q.out b/ql/src/test/results/clientpositive/transform_ppr2.q.out
index 8f17984ff9..97db488438 100644
--- a/ql/src/test/results/clientpositive/transform_ppr2.q.out
+++ b/ql/src/test/results/clientpositive/transform_ppr2.q.out
@@ -58,31 +58,31 @@ STAGE PLANS:
                         output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                         properties:
                           field.delim 9
-                          columns ds,tkey,tvalue
+                          columns _col0,_col1,_col2
                           serialization.format 9
                           columns.types string,string,string
                     Reduce Output Operator
                       key expressions:
-                            expr: tkey
+                            expr: _col1
                             type: string
                       sort order: +
                       Map-reduce partition columns:
-                            expr: tkey
+                            expr: _col1
                             type: string
                       tag: -1
                       value expressions:
-                            expr: ds
+                            expr: _col0
                             type: string
-                            expr: tkey
+                            expr: _col1
                             type: string
-                            expr: tvalue
+                            expr: _col2
                             type: string
       Needs Tagging: false
       Path -> Alias:
-        file:/Users/heyongqiang/Documents/workspace/Hive-Test/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 [tmap:src]
-        file:/Users/heyongqiang/Documents/workspace/Hive-Test/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12 [tmap:src]
+        file:/data/users/nzhang/work/870/apache-hive/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 [tmap:src]
+        file:/data/users/nzhang/work/870/apache-hive/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12 [tmap:src]
       Path -> Partition:
-        file:/Users/heyongqiang/Documents/workspace/Hive-Test/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 
+        file:/data/users/nzhang/work/870/apache-hive/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 
           Partition
             input format: org.apache.hadoop.mapred.TextInputFormat
             output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -100,8 +100,8 @@ STAGE PLANS:
               serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               file.inputformat org.apache.hadoop.mapred.TextInputFormat
               file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-              location file:/Users/heyongqiang/Documents/workspace/Hive-Test/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11
-              transient_lastDdlTime 1258007160
+              location file:/data/users/nzhang/work/870/apache-hive/build/ql/test/data/warehouse/srcpart
+              transient_lastDdlTime 1261528598
             serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
           
               input format: org.apache.hadoop.mapred.TextInputFormat
@@ -117,12 +117,12 @@ STAGE PLANS:
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location file:/Users/heyongqiang/Documents/workspace/Hive-Test/build/ql/test/data/warehouse/srcpart
-                transient_lastDdlTime 1258007160
+                location file:/data/users/nzhang/work/870/apache-hive/build/ql/test/data/warehouse/srcpart
+                transient_lastDdlTime 1261528598
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: srcpart
             name: srcpart
-        file:/Users/heyongqiang/Documents/workspace/Hive-Test/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12 
+        file:/data/users/nzhang/work/870/apache-hive/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12 
           Partition
             input format: org.apache.hadoop.mapred.TextInputFormat
             output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -140,8 +140,8 @@ STAGE PLANS:
               serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               file.inputformat org.apache.hadoop.mapred.TextInputFormat
               file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-              location file:/Users/heyongqiang/Documents/workspace/Hive-Test/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12
-              transient_lastDdlTime 1258007160
+              location file:/data/users/nzhang/work/870/apache-hive/build/ql/test/data/warehouse/srcpart
+              transient_lastDdlTime 1261528598
             serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
           
               input format: org.apache.hadoop.mapred.TextInputFormat
@@ -157,8 +157,8 @@ STAGE PLANS:
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location file:/Users/heyongqiang/Documents/workspace/Hive-Test/build/ql/test/data/warehouse/srcpart
-                transient_lastDdlTime 1258007160
+                location file:/data/users/nzhang/work/870/apache-hive/build/ql/test/data/warehouse/srcpart
+                transient_lastDdlTime 1261528598
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: srcpart
             name: srcpart
@@ -179,7 +179,7 @@ STAGE PLANS:
               File Output Operator
                 compressed: false
                 GlobalTableId: 0
-                directory: file:/Users/heyongqiang/Documents/workspace/Hive-Test/build/ql/tmp/702285141/10001
+                directory: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/1043205594/10001
                 table:
                     input format: org.apache.hadoop.mapred.TextInputFormat
                     output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -204,7 +204,7 @@ SELECT tmap.tkey, tmap.tvalue WHERE tmap.tkey < 100
 PREHOOK: type: QUERY
 PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
-PREHOOK: Output: file:/Users/heyongqiang/Documents/workspace/Hive-Test/build/ql/tmp/1466929820/10000
+PREHOOK: Output: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/974320187/10000
 POSTHOOK: query: FROM (
   FROM srcpart src
   SELECT TRANSFORM(src.ds, src.key, src.value)
@@ -216,7 +216,7 @@ SELECT tmap.tkey, tmap.tvalue WHERE tmap.tkey < 100
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
-POSTHOOK: Output: file:/Users/heyongqiang/Documents/workspace/Hive-Test/build/ql/tmp/1466929820/10000
+POSTHOOK: Output: file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/974320187/10000
 0	val_0
 0	val_0
 0	val_0
diff --git a/ql/src/test/results/compiler/plan/input20.q.xml b/ql/src/test/results/compiler/plan/input20.q.xml
index a28e47f0e5..61baa3776e 100644
--- a/ql/src/test/results/compiler/plan/input20.q.xml
+++ b/ql/src/test/results/compiler/plan/input20.q.xml
@@ -62,11 +62,11 @@
          </void> 
          <void method="put"> 
           <string>location</string> 
-          <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/src</string> 
+          <string>file:/data/users/nzhang/work/870/apache-hive/build/ql/test/data/warehouse/src</string> 
          </void> 
          <void method="put"> 
           <string>transient_lastDdlTime</string> 
-          <string>1259648300</string> 
+          <string>1261529233</string> 
          </void> 
         </object> 
        </void> 
@@ -115,10 +115,10 @@
                     <void property="columnExprMap"> 
                      <object class="java.util.HashMap"> 
                       <void method="put"> 
-                       <string>value</string> 
+                       <string>_col1</string> 
                        <object id="exprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
                         <void property="column"> 
-                         <string>value</string> 
+                         <string>_col1</string> 
                         </void> 
                         <void property="typeInfo"> 
                          <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
@@ -130,10 +130,10 @@
                        </object> 
                       </void> 
                       <void method="put"> 
-                       <string>key</string> 
+                       <string>_col0</string> 
                        <object id="exprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
                         <void property="column"> 
-                         <string>key</string> 
+                         <string>_col0</string> 
                         </void> 
                         <void property="typeInfo"> 
                          <object idref="PrimitiveTypeInfo0"/> 
@@ -149,7 +149,7 @@
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
                           <void property="column"> 
-                           <string>key</string> 
+                           <string>_col0</string> 
                           </void> 
                           <void property="typeInfo"> 
                            <object idref="PrimitiveTypeInfo0"/> 
@@ -212,7 +212,7 @@
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
                           <void property="column"> 
-                           <string>key</string> 
+                           <string>_col0</string> 
                           </void> 
                           <void property="typeInfo"> 
                            <object idref="PrimitiveTypeInfo0"/> 
@@ -294,9 +294,12 @@
                        <object id="Vector0" class="java.util.Vector"> 
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
+                          <void property="alias"> 
                            <string>key</string> 
                           </void> 
+                          <void property="internalName"> 
+                           <string>_col0</string> 
+                          </void> 
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
@@ -304,9 +307,12 @@
                         </void> 
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
+                          <void property="alias"> 
                            <string>value</string> 
                           </void> 
+                          <void property="internalName"> 
+                           <string>_col1</string> 
+                          </void> 
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
@@ -387,7 +393,7 @@
                       </void> 
                       <void method="put"> 
                        <string>columns</string> 
-                       <string>key,value</string> 
+                       <string>_col0,_col1</string> 
                       </void> 
                       <void method="put"> 
                        <string>serialization.format</string> 
@@ -699,7 +705,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/nzhang/work/870/apache-hive/build/ql/test/data/warehouse/src</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>tmap:src</string> 
@@ -711,7 +717,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/nzhang/work/870/apache-hive/build/ql/test/data/warehouse/src</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="deserializerClass"> 
          <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
@@ -771,7 +777,7 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/232274942/10001</string> 
+                     <string>file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/1420955821/10001</string> 
                     </void> 
                     <void property="tableInfo"> 
                      <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -788,7 +794,7 @@
                        <object class="java.util.Properties"> 
                         <void method="put"> 
                          <string>columns</string> 
-                         <string>key,value</string> 
+                         <string>_col0,_col1</string> 
                         </void> 
                         <void method="put"> 
                          <string>serialization.format</string> 
@@ -834,7 +840,7 @@
                       <void method="add"> 
                        <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                         <void property="internalName"> 
-                         <string>key</string> 
+                         <string>_col0</string> 
                         </void> 
                         <void property="type"> 
                          <object idref="PrimitiveTypeInfo0"/> 
@@ -844,7 +850,7 @@
                       <void method="add"> 
                        <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                         <void property="internalName"> 
-                         <string>value</string> 
+                         <string>_col1</string> 
                         </void> 
                         <void property="type"> 
                          <object idref="PrimitiveTypeInfo0"/> 
@@ -926,7 +932,7 @@
                     </void> 
                     <void method="put"> 
                      <string>columns</string> 
-                     <string>key,value</string> 
+                     <string>_col0,_col1</string> 
                     </void> 
                     <void method="put"> 
                      <string>serialization.format</string> 
@@ -975,7 +981,7 @@
                      <string>key</string> 
                     </void> 
                     <void property="internalName"> 
-                     <string>key</string> 
+                     <string>_col0</string> 
                     </void> 
                     <void property="type"> 
                      <object idref="PrimitiveTypeInfo0"/> 
@@ -988,7 +994,7 @@
                      <string>value</string> 
                     </void> 
                     <void property="internalName"> 
-                     <string>value</string> 
+                     <string>_col1</string> 
                     </void> 
                     <void property="type"> 
                      <object idref="PrimitiveTypeInfo0"/> 
diff --git a/ql/src/test/results/compiler/plan/input4.q.xml b/ql/src/test/results/compiler/plan/input4.q.xml
index 8390ab7fa6..112018e23c 100755
--- a/ql/src/test/results/compiler/plan/input4.q.xml
+++ b/ql/src/test/results/compiler/plan/input4.q.xml
@@ -26,7 +26,7 @@
            <boolean>true</boolean> 
           </void> 
           <void property="sourceDir"> 
-           <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1535400203/10000</string> 
+           <string>file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/2012024852/10000</string> 
           </void> 
           <void property="table"> 
            <object id="tableDesc0" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -79,11 +79,11 @@
               </void> 
               <void method="put"> 
                <string>location</string> 
-               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/dest1</string> 
+               <string>file:/data/users/nzhang/work/870/apache-hive/build/ql/test/data/warehouse/dest1</string> 
               </void> 
               <void method="put"> 
                <string>transient_lastDdlTime</string> 
-               <string>1259648305</string> 
+               <string>1261529239</string> 
               </void> 
              </object> 
             </void> 
@@ -93,7 +93,7 @@
            </object> 
           </void> 
           <void property="tmpDir"> 
-           <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1535400203/10001</string> 
+           <string>file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/2012024852/10001</string> 
           </void> 
          </object> 
         </void> 
@@ -164,11 +164,11 @@
          </void> 
          <void method="put"> 
           <string>location</string> 
-          <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/src</string> 
+          <string>file:/data/users/nzhang/work/870/apache-hive/build/ql/test/data/warehouse/src</string> 
          </void> 
          <void method="put"> 
           <string>transient_lastDdlTime</string> 
-          <string>1259648304</string> 
+          <string>1261529239</string> 
          </void> 
         </object> 
        </void> 
@@ -217,10 +217,10 @@
                     <void property="columnExprMap"> 
                      <object class="java.util.HashMap"> 
                       <void method="put"> 
-                       <string>tvalue</string> 
+                       <string>_col1</string> 
                        <object id="exprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
                         <void property="column"> 
-                         <string>tvalue</string> 
+                         <string>_col1</string> 
                         </void> 
                         <void property="typeInfo"> 
                          <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
@@ -232,10 +232,10 @@
                        </object> 
                       </void> 
                       <void method="put"> 
-                       <string>tkey</string> 
+                       <string>_col0</string> 
                        <object id="exprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
                         <void property="column"> 
-                         <string>tkey</string> 
+                         <string>_col0</string> 
                         </void> 
                         <void property="typeInfo"> 
                          <object idref="PrimitiveTypeInfo0"/> 
@@ -251,7 +251,7 @@
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
                           <void property="column"> 
-                           <string>tkey</string> 
+                           <string>_col0</string> 
                           </void> 
                           <void property="typeInfo"> 
                            <object idref="PrimitiveTypeInfo0"/> 
@@ -314,7 +314,7 @@
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
                           <void property="column"> 
-                           <string>tkey</string> 
+                           <string>_col0</string> 
                           </void> 
                           <void property="typeInfo"> 
                            <object idref="PrimitiveTypeInfo0"/> 
@@ -396,9 +396,12 @@
                        <object id="Vector0" class="java.util.Vector"> 
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
+                          <void property="alias"> 
                            <string>tkey</string> 
                           </void> 
+                          <void property="internalName"> 
+                           <string>_col0</string> 
+                          </void> 
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
@@ -406,9 +409,12 @@
                         </void> 
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
+                          <void property="alias"> 
                            <string>tvalue</string> 
                           </void> 
+                          <void property="internalName"> 
+                           <string>_col1</string> 
+                          </void> 
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
@@ -489,7 +495,7 @@
                       </void> 
                       <void method="put"> 
                        <string>columns</string> 
-                       <string>tkey,tvalue</string> 
+                       <string>_col0,_col1</string> 
                       </void> 
                       <void method="put"> 
                        <string>serialization.format</string> 
@@ -724,7 +730,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/nzhang/work/870/apache-hive/build/ql/test/data/warehouse/src</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>tmap:src</string> 
@@ -736,7 +742,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/nzhang/work/870/apache-hive/build/ql/test/data/warehouse/src</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="deserializerClass"> 
          <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
@@ -799,7 +805,7 @@
                      <int>1</int> 
                     </void> 
                     <void property="dirName"> 
-                     <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1535400203/10000</string> 
+                     <string>file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/2012024852/10000</string> 
                     </void> 
                     <void property="tableInfo"> 
                      <object idref="tableDesc0"/> 
diff --git a/ql/src/test/results/compiler/plan/input5.q.xml b/ql/src/test/results/compiler/plan/input5.q.xml
index 3b70909c99..1f84ef4a7a 100644
--- a/ql/src/test/results/compiler/plan/input5.q.xml
+++ b/ql/src/test/results/compiler/plan/input5.q.xml
@@ -26,7 +26,7 @@
            <boolean>true</boolean> 
           </void> 
           <void property="sourceDir"> 
-           <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/144127138/10000</string> 
+           <string>file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/1890559483/10000</string> 
           </void> 
           <void property="table"> 
            <object id="tableDesc0" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -79,11 +79,11 @@
               </void> 
               <void method="put"> 
                <string>location</string> 
-               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/dest1</string> 
+               <string>file:/data/users/nzhang/work/870/apache-hive/build/ql/test/data/warehouse/dest1</string> 
               </void> 
               <void method="put"> 
                <string>transient_lastDdlTime</string> 
-               <string>1259648307</string> 
+               <string>1261529242</string> 
               </void> 
              </object> 
             </void> 
@@ -93,7 +93,7 @@
            </object> 
           </void> 
           <void property="tmpDir"> 
-           <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/144127138/10001</string> 
+           <string>file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/1890559483/10001</string> 
           </void> 
          </object> 
         </void> 
@@ -168,11 +168,11 @@
          </void> 
          <void method="put"> 
           <string>location</string> 
-          <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/src_thrift</string> 
+          <string>file:/data/users/nzhang/work/870/apache-hive/build/ql/test/data/warehouse/src_thrift</string> 
          </void> 
          <void method="put"> 
           <string>transient_lastDdlTime</string> 
-          <string>1259648307</string> 
+          <string>1261529242</string> 
          </void> 
         </object> 
        </void> 
@@ -221,10 +221,10 @@
                     <void property="columnExprMap"> 
                      <object class="java.util.HashMap"> 
                       <void method="put"> 
-                       <string>tvalue</string> 
+                       <string>_col1</string> 
                        <object id="exprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
                         <void property="column"> 
-                         <string>tvalue</string> 
+                         <string>_col1</string> 
                         </void> 
                         <void property="typeInfo"> 
                          <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
@@ -236,10 +236,10 @@
                        </object> 
                       </void> 
                       <void method="put"> 
-                       <string>tkey</string> 
+                       <string>_col0</string> 
                        <object id="exprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
                         <void property="column"> 
-                         <string>tkey</string> 
+                         <string>_col0</string> 
                         </void> 
                         <void property="typeInfo"> 
                          <object idref="PrimitiveTypeInfo0"/> 
@@ -255,7 +255,7 @@
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
                           <void property="column"> 
-                           <string>tkey</string> 
+                           <string>_col0</string> 
                           </void> 
                           <void property="typeInfo"> 
                            <object idref="PrimitiveTypeInfo0"/> 
@@ -318,7 +318,7 @@
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
                           <void property="column"> 
-                           <string>tkey</string> 
+                           <string>_col0</string> 
                           </void> 
                           <void property="typeInfo"> 
                            <object idref="PrimitiveTypeInfo0"/> 
@@ -400,9 +400,12 @@
                        <object id="Vector0" class="java.util.Vector"> 
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
+                          <void property="alias"> 
                            <string>tkey</string> 
                           </void> 
+                          <void property="internalName"> 
+                           <string>_col0</string> 
+                          </void> 
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
@@ -410,9 +413,12 @@
                         </void> 
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
+                          <void property="alias"> 
                            <string>tvalue</string> 
                           </void> 
+                          <void property="internalName"> 
+                           <string>_col1</string> 
+                          </void> 
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
@@ -493,7 +499,7 @@
                       </void> 
                       <void method="put"> 
                        <string>columns</string> 
-                       <string>tkey,tvalue</string> 
+                       <string>_col0,_col1</string> 
                       </void> 
                       <void method="put"> 
                        <string>serialization.format</string> 
@@ -791,7 +797,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/src_thrift</string> 
+       <string>file:/data/users/nzhang/work/870/apache-hive/build/ql/test/data/warehouse/src_thrift</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>tmap:src_thrift</string> 
@@ -803,7 +809,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/src_thrift</string> 
+       <string>file:/data/users/nzhang/work/870/apache-hive/build/ql/test/data/warehouse/src_thrift</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="deserializerClass"> 
          <class>org.apache.hadoop.hive.serde2.thrift.ThriftDeserializer</class> 
@@ -862,7 +868,7 @@
                  <int>1</int> 
                 </void> 
                 <void property="dirName"> 
-                 <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/144127138/10000</string> 
+                 <string>file:/data/users/nzhang/work/870/apache-hive/build/ql/tmp/1890559483/10000</string> 
                 </void> 
                 <void property="tableInfo"> 
                  <object idref="tableDesc0"/> 
