diff --git a/CHANGES.txt b/CHANGES.txt
index c716d79713..dd2c0ab15e 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -142,6 +142,8 @@ Release 0.4.0 -  Unreleased
 
     HIVE-691. show documentation for functions. (Emil Ibrishimov via namit)
 
+    HIVE-748. Test for extracting urls. (Namit Jain via zshao)
+
   IMPROVEMENTS
     HIVE-389. Option to build without ivy (jssarma)
 
diff --git a/data/files/docurl.txt b/data/files/docurl.txt
new file mode 100644
index 0000000000..5862d78b4b
--- /dev/null
+++ b/data/files/docurl.txt
@@ -0,0 +1,8 @@
+bonework Chad bullfrog almighty blubberers cynodictis boilersmith cosmopolitical corrie autoincrements 
+casings choked colpohysterotomy comedist cradleman annexa agronomical archmockery Cocles adhaka 
+daekon <a href="http://4uzsbtwvdypfitqfqdjosynqp.html">link</a> anticrochet auricular cheeked Arbon alder-leaved 
+darlingness breamed company carbureted comediette condensery <a href="http://1uauniajqtunlsvadmxhlxvngxpqjuzbpzvdiwmzphmbaicduzkgxgtdeiunduosu.html">link</a> 
+daekon <a href="http://4uzsbtwvdypfitqfqdjosynqp.html">link</a> anticrochet auricular cheeked Arbon alder-leaved 
+darlingness breamed company carbureted comediette condensery <a href="http://1uauniajqtunlsvadmxhlxvngxpqjuzbpzvdiwmzphmbaicduzkgxgtdeiunduosu.html">link</a> 
+daekon <a href="http://4uzsbtwvdypfitqfqdjosynqp.html">link</a> anticrochet auricular cheeked Arbon alder-leaved darlingness breamed company carbureted comediette condensery <a href="http://1uauniajqtunlsvadmxhlxvngxpqjuzbpzvdiwmzphmbaicduzkgxgtdeiunduosu.html">link</a> 
+daekon <a href="http://4uzsbtwvdypfitqfqdjosynqp.html">link</a> anticrochet auricular cheeked Arbon alder-leaved darlingness breamed company carbureted comediette condensery <a href="http://1uauniajqtunlsvadmxhlxvngxpqjuzbpzvdiwmzphmbaicduzkgxgtdeiunduosu.html">link</a> 
diff --git a/ql/src/test/org/apache/hadoop/hive/scripts/extracturl.java b/ql/src/test/org/apache/hadoop/hive/scripts/extracturl.java
new file mode 100644
index 0000000000..9744de58fe
--- /dev/null
+++ b/ql/src/test/org/apache/hadoop/hive/scripts/extracturl.java
@@ -0,0 +1,50 @@
+/**
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.hadoop.hive.scripts;
+
+import java.io.*;
+
+import java.util.HashMap;
+import java.util.regex.Matcher;
+import java.util.regex.Pattern;
+
+public class extracturl {
+
+  protected static final Pattern pattern = Pattern.compile("<a href=\"http://([\\w\\d]+\\.html)\">link</a>", Pattern.CASE_INSENSITIVE);
+  static InputStreamReader converter = new InputStreamReader (System.in);
+  static BufferedReader   in = new BufferedReader (converter);
+
+  public static void main(String[] args) {
+    String input;
+    try {
+      while ((input = in.readLine()) != null) {
+        Matcher m = pattern.matcher(input);
+
+        while(m.find()) {
+          String url = input.substring(m.start(1), m.end(1));
+          System.out.println(url + "\t" + "1");
+        } 
+      }
+    }
+    catch (Exception e) {
+      e.printStackTrace();
+      System.exit(1);
+    }
+  } 
+}
diff --git a/ql/src/test/queries/clientpositive/input37.q b/ql/src/test/queries/clientpositive/input37.q
new file mode 100644
index 0000000000..639d4d6086
--- /dev/null
+++ b/ql/src/test/queries/clientpositive/input37.q
@@ -0,0 +1,16 @@
+create table documents(contents string) stored as textfile;
+
+LOAD DATA LOCAL INPATH '../data/files/docurl.txt' INTO TABLE documents;
+
+
+select url, count(1) 
+FROM
+(
+  FROM documents
+  MAP documents.contents
+  USING 'java -cp ../build/ql/test/classes org.apache.hadoop.hive.scripts.extracturl' AS (url, count)
+) subq
+group by url;
+
+
+DROP TABLE documents;
diff --git a/ql/src/test/results/clientpositive/input37.q.out b/ql/src/test/results/clientpositive/input37.q.out
new file mode 100644
index 0000000000..2bd3724eed
--- /dev/null
+++ b/ql/src/test/results/clientpositive/input37.q.out
@@ -0,0 +1,15 @@
+query: create table documents(contents string) stored as textfile
+query: LOAD DATA LOCAL INPATH '../data/files/docurl.txt' INTO TABLE documents
+query: select url, count(1) 
+FROM
+(
+  FROM documents
+  MAP documents.contents
+  USING 'java -cp ../build/ql/test/classes org.apache.hadoop.hive.scripts.extracturl' AS (url, count)
+) subq
+group by url
+Input: default/documents
+Output: file:/data/users/njain/hive_commit2/hive_commit2/build/ql/tmp/781025216/10000
+1uauniajqtunlsvadmxhlxvngxpqjuzbpzvdiwmzphmbaicduzkgxgtdeiunduosu.html	4
+4uzsbtwvdypfitqfqdjosynqp.html	4
+query: DROP TABLE documents
