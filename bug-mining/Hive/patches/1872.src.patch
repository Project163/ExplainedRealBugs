diff --git a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMapRedUtils.java b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMapRedUtils.java
index 41edc87aa1..45bd8a6979 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMapRedUtils.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMapRedUtils.java
@@ -421,28 +421,6 @@ public static void setTaskPlan(String alias_id,
     setTaskPlan(alias_id, topOp, task, local, opProcCtx, null);
   }
 
-  private static ReadEntity getParentViewInfo(String alias_id,
-      Map<String, ReadEntity> viewAliasToInput) {
-    String[] aliases = alias_id.split(":");
-
-    String currentAlias = null;
-    ReadEntity currentInput = null;
-    // Find the immediate parent possible.
-    // For eg: for a query like 'select * from V3', where V3 -> V2, V2 -> V1, V1 -> T
-    // -> implies depends on.
-    // T's parent would be V1
-    for (int pos = 0; pos < aliases.length; pos++) {
-      currentAlias = currentAlias == null ? aliases[pos] : currentAlias + ":" + aliases[pos];
-      ReadEntity input = viewAliasToInput.get(currentAlias);
-      if (input == null) {
-        return currentInput;
-      }
-      currentInput = input;
-    }
-
-    return currentInput;
-  }
-
   /**
    * set the current task in the mapredWork.
    *
@@ -572,7 +550,8 @@ public static void setMapWork(MapWork plan, ParseContext parseCtx, Set<ReadEntit
     // Track the dependencies for the view. Consider a query like: select * from V;
     // where V is a view of the form: select * from T
     // The dependencies should include V at depth 0, and T at depth 1 (inferred).
-    ReadEntity parentViewInfo = getParentViewInfo(alias_id, parseCtx.getViewAliasToInput());
+    Map<String, ReadEntity> viewToInput = parseCtx.getViewAliasToInput();
+    ReadEntity parentViewInfo = PlanUtils.getParentViewInfo(alias_id, viewToInput);
 
     // The table should also be considered a part of inputs, even if the table is a
     // partitioned table and whether any partition is selected or not
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/SimpleFetchOptimizer.java b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/SimpleFetchOptimizer.java
index 5e8dc418a6..7413d2ba62 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/SimpleFetchOptimizer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/SimpleFetchOptimizer.java
@@ -155,8 +155,9 @@ private FetchData checkTree(boolean aggressive, ParseContext pctx, String alias,
     if (table == null) {
       return null;
     }
+    ReadEntity parent = PlanUtils.getParentViewInfo(alias, pctx.getViewAliasToInput());
     if (!table.isPartitioned()) {
-      return checkOperators(new FetchData(table, splitSample), ts, aggressive, false);
+      return checkOperators(new FetchData(parent, table, splitSample), ts, aggressive, false);
     }
 
     boolean bypassFilter = false;
@@ -168,7 +169,7 @@ private FetchData checkTree(boolean aggressive, ParseContext pctx, String alias,
       PrunedPartitionList pruned = pctx.getPrunedPartitions(alias, ts);
       if (aggressive || !pruned.hasUnknownPartitions()) {
         bypassFilter &= !pruned.hasUnknownPartitions();
-        return checkOperators(new FetchData(table, pruned, splitSample), ts,
+        return checkOperators(new FetchData(parent, table, pruned, splitSample), ts,
             aggressive, bypassFilter);
       }
     }
@@ -205,6 +206,7 @@ private FetchData checkOperators(FetchData fetch, TableScanOperator ts, boolean
 
   private class FetchData {
 
+    private final ReadEntity parent;
     private final Table table;
     private final SplitSample splitSample;
     private final PrunedPartitionList partsList;
@@ -216,13 +218,16 @@ private class FetchData {
     // this is always non-null when conversion is completed
     private Operator<?> fileSink;
 
-    private FetchData(Table table, SplitSample splitSample) {
+    private FetchData(ReadEntity parent, Table table, SplitSample splitSample) {
+      this.parent = parent;
       this.table = table;
       this.partsList = null;
       this.splitSample = splitSample;
     }
 
-    private FetchData(Table table, PrunedPartitionList partsList, SplitSample splitSample) {
+    private FetchData(ReadEntity parent, Table table, PrunedPartitionList partsList,
+        SplitSample splitSample) {
+      this.parent = parent;
       this.table = table;
       this.partsList = partsList;
       this.splitSample = splitSample;
@@ -231,7 +236,7 @@ private FetchData(Table table, PrunedPartitionList partsList, SplitSample splitS
     private FetchWork convertToWork() throws HiveException {
       inputs.clear();
       if (!table.isPartitioned()) {
-        inputs.add(new ReadEntity(table));
+        inputs.add(new ReadEntity(table, parent));
         FetchWork work = new FetchWork(table.getPath(), Utilities.getTableDesc(table));
         PlanUtils.configureInputJobPropertiesForStorageHandler(work.getTblDesc());
         work.setSplitSample(splitSample);
@@ -241,12 +246,12 @@ private FetchWork convertToWork() throws HiveException {
       List<PartitionDesc> partP = new ArrayList<PartitionDesc>();
 
       for (Partition partition : partsList.getNotDeniedPartns()) {
-        inputs.add(new ReadEntity(partition));
+        inputs.add(new ReadEntity(partition, parent));
         listP.add(partition.getDataLocation());
         partP.add(Utilities.getPartitionDesc(partition));
       }
       Table sourceTable = partsList.getSourceTable();
-      inputs.add(new ReadEntity(sourceTable));
+      inputs.add(new ReadEntity(sourceTable, parent));
       TableDesc table = Utilities.getTableDesc(sourceTable);
       FetchWork work = new FetchWork(listP, partP, table);
       if (!work.getPartDesc().isEmpty()) {
@@ -261,7 +266,9 @@ private FetchWork convertToWork() throws HiveException {
     // single direct fetching, which means FS is not needed any more when conversion completed.
     // rows forwarded will be received by ListSinkOperator, which is replacing FS
     private ListSinkOperator completed(ParseContext pctx, FetchWork work) {
-      pctx.getSemanticInputs().addAll(inputs);
+      for (ReadEntity input : inputs) {
+        PlanUtils.addInput(pctx.getSemanticInputs(), input);
+      }
       return replaceFSwithLS(fileSink, work.getSerializationNullFormat());
     }
 
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
index 719b496303..59987e3ba3 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
@@ -8917,6 +8917,15 @@ public void analyzeInternal(ASTNode ast) throws SemanticException {
     resultSchema =
         convertRowSchemaToViewSchema(opParseCtx.get(sinkOp).getRowResolver());
 
+    ParseContext pCtx = new ParseContext(conf, qb, child, opToPartPruner,
+        opToPartList, topOps, topSelOps, opParseCtx, joinContext, smbMapJoinContext,
+        topToTable, topToTableProps, fsopToTable,
+        loadTableWork, loadFileWork, ctx, idToTableNameMap, destTableId, uCtx,
+        listMapJoinOpsNoReducer, groupOpToInputTables, prunedPartitions,
+        opToSamplePruner, globalLimitCtx, nameToSplitSample, inputs, rootTasks,
+        opToPartToSkewedPruner, viewAliasToInput,
+        reduceSinkOperatorsAddedByEnforceBucketingSorting, queryProperties);
+
     if (createVwDesc != null) {
       saveViewDefinition();
 
@@ -8930,18 +8939,15 @@ public void analyzeInternal(ASTNode ast) throws SemanticException {
       // skip the rest of this method.
       ctx.setResDir(null);
       ctx.setResFile(null);
+
+      try {
+        PlanUtils.addInputsForView(pCtx);
+      } catch (HiveException e) {
+        throw new SemanticException(e);
+      }
       return;
     }
 
-    ParseContext pCtx = new ParseContext(conf, qb, child, opToPartPruner,
-        opToPartList, topOps, topSelOps, opParseCtx, joinContext, smbMapJoinContext,
-        topToTable, topToTableProps, fsopToTable,
-        loadTableWork, loadFileWork, ctx, idToTableNameMap, destTableId, uCtx,
-        listMapJoinOpsNoReducer, groupOpToInputTables, prunedPartitions,
-        opToSamplePruner, globalLimitCtx, nameToSplitSample, inputs, rootTasks,
-        opToPartToSkewedPruner, viewAliasToInput,
-        reduceSinkOperatorsAddedByEnforceBucketingSorting, queryProperties);
-
     // Generate table access stats if required
     if (HiveConf.getBoolVar(this.conf, HiveConf.ConfVars.HIVE_STATS_COLLECT_TABLEKEYS) == true) {
       TableAccessAnalyzer tableAccessAnalyzer = new TableAccessAnalyzer(pCtx);
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/plan/HiveOperation.java b/ql/src/java/org/apache/hadoop/hive/ql/plan/HiveOperation.java
index e1a3dce303..93c89deb37 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/plan/HiveOperation.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/plan/HiveOperation.java
@@ -70,8 +70,8 @@ public enum HiveOperation {
   DROPFUNCTION("DROPFUNCTION", null, null),
   CREATEMACRO("CREATEMACRO", null, null),
   DROPMACRO("DROPMACRO", null, null),
-  CREATEVIEW("CREATEVIEW", null, null),
-  DROPVIEW("DROPVIEW", null, null),
+  CREATEVIEW("CREATEVIEW", new Privilege[]{Privilege.SELECT}, new Privilege[]{Privilege.CREATE}),
+  DROPVIEW("DROPVIEW", null, new Privilege[]{Privilege.DROP}),
   CREATEINDEX("CREATEINDEX", null, null),
   DROPINDEX("DROPINDEX", null, null),
   ALTERINDEX_REBUILD("ALTERINDEX_REBUILD", null, null),
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/plan/PlanUtils.java b/ql/src/java/org/apache/hadoop/hive/ql/plan/PlanUtils.java
index 817bb3af58..c2cb543284 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/plan/PlanUtils.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/plan/PlanUtils.java
@@ -36,7 +36,9 @@
 import org.apache.hadoop.hive.metastore.MetaStoreUtils;
 import org.apache.hadoop.hive.metastore.api.FieldSchema;
 import org.apache.hadoop.hive.ql.exec.ColumnInfo;
+import org.apache.hadoop.hive.ql.exec.Operator;
 import org.apache.hadoop.hive.ql.exec.RowSchema;
+import org.apache.hadoop.hive.ql.exec.TableScanOperator;
 import org.apache.hadoop.hive.ql.exec.Utilities;
 import org.apache.hadoop.hive.ql.hooks.ReadEntity;
 import org.apache.hadoop.hive.ql.io.HiveFileFormatUtils;
@@ -49,6 +51,8 @@
 import org.apache.hadoop.hive.ql.metadata.HiveException;
 import org.apache.hadoop.hive.ql.metadata.HiveStorageHandler;
 import org.apache.hadoop.hive.ql.metadata.HiveUtils;
+import org.apache.hadoop.hive.ql.metadata.Table;
+import org.apache.hadoop.hive.ql.parse.ParseContext;
 import org.apache.hadoop.hive.ql.parse.SemanticException;
 import org.apache.hadoop.hive.ql.parse.TypeCheckProcFactory;
 import org.apache.hadoop.hive.ql.session.SessionState;
@@ -938,4 +942,42 @@ public static void addExprToStringBuffer(ExprNodeDesc expr, StringBuffer sb) {
     sb.append(expr.getTypeString());
     sb.append(")");
   }
+
+  public static void addInputsForView(ParseContext parseCtx) throws HiveException {
+    Set<ReadEntity> inputs = parseCtx.getSemanticInputs();
+    for (Map.Entry<String, Operator<?>> entry : parseCtx.getTopOps().entrySet()) {
+      if (!(entry.getValue() instanceof TableScanOperator)) {
+        continue;
+      }
+      String alias = entry.getKey();
+      TableScanOperator topOp = (TableScanOperator) entry.getValue();
+      ReadEntity parentViewInfo = getParentViewInfo(alias, parseCtx.getViewAliasToInput());
+
+      // Adds tables only for create view (PPD filter can be appended by outer query)
+      Table table = parseCtx.getTopToTable().get(topOp);
+      PlanUtils.addInput(inputs, new ReadEntity(table, parentViewInfo));
+    }
+  }
+
+  public static ReadEntity getParentViewInfo(String alias_id,
+      Map<String, ReadEntity> viewAliasToInput) {
+    String[] aliases = alias_id.split(":");
+
+    String currentAlias = null;
+    ReadEntity currentInput = null;
+    // Find the immediate parent possible.
+    // For eg: for a query like 'select * from V3', where V3 -> V2, V2 -> V1, V1 -> T
+    // -> implies depends on.
+    // T's parent would be V1
+    for (int pos = 0; pos < aliases.length; pos++) {
+      currentAlias = currentAlias == null ? aliases[pos] : currentAlias + ":" + aliases[pos];
+      ReadEntity input = viewAliasToInput.get(currentAlias);
+      if (input == null) {
+        return currentInput;
+      }
+      currentInput = input;
+    }
+
+    return currentInput;
+  }
 }
diff --git a/ql/src/test/results/clientnegative/alter_view_as_select_with_partition.q.out b/ql/src/test/results/clientnegative/alter_view_as_select_with_partition.q.out
index 291d7fbb2e..ddc3496b7a 100644
--- a/ql/src/test/results/clientnegative/alter_view_as_select_with_partition.q.out
+++ b/ql/src/test/results/clientnegative/alter_view_as_select_with_partition.q.out
@@ -4,12 +4,14 @@ SELECT key, value
 FROM src
 WHERE key=86
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@src
 POSTHOOK: query: CREATE VIEW testViewPart PARTITIONED ON (value)
 AS
 SELECT key, value
 FROM src
 WHERE key=86
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@testViewPart
 PREHOOK: query: ALTER VIEW testViewPart 
 ADD PARTITION (value='val_86') PARTITION (value='val_xyz')
diff --git a/ql/src/test/results/clientnegative/alter_view_failure.q.out b/ql/src/test/results/clientnegative/alter_view_failure.q.out
index 4bda31e6b6..d52f72a434 100644
--- a/ql/src/test/results/clientnegative/alter_view_failure.q.out
+++ b/ql/src/test/results/clientnegative/alter_view_failure.q.out
@@ -4,7 +4,9 @@ POSTHOOK: query: DROP VIEW xxx3
 POSTHOOK: type: DROPVIEW
 PREHOOK: query: CREATE VIEW xxx3 AS SELECT * FROM src
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@src
 POSTHOOK: query: CREATE VIEW xxx3 AS SELECT * FROM src
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@xxx3
 FAILED: SemanticException [Error 10131]: To alter a view you need to use the ALTER VIEW command.
diff --git a/ql/src/test/results/clientnegative/alter_view_failure2.q.out b/ql/src/test/results/clientnegative/alter_view_failure2.q.out
index a27094a157..4e258748e5 100644
--- a/ql/src/test/results/clientnegative/alter_view_failure2.q.out
+++ b/ql/src/test/results/clientnegative/alter_view_failure2.q.out
@@ -7,10 +7,12 @@ PARTITIONED ON (value)
 AS 
 SELECT * FROM src
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@src
 POSTHOOK: query: CREATE VIEW xxx4 
 PARTITIONED ON (value)
 AS 
 SELECT * FROM src
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@xxx4
 FAILED: SemanticException [Error 10131]: To alter a view you need to use the ALTER VIEW command.
diff --git a/ql/src/test/results/clientnegative/alter_view_failure4.q.out b/ql/src/test/results/clientnegative/alter_view_failure4.q.out
index 662b43197e..bad15b2e29 100644
--- a/ql/src/test/results/clientnegative/alter_view_failure4.q.out
+++ b/ql/src/test/results/clientnegative/alter_view_failure4.q.out
@@ -7,10 +7,12 @@ PARTITIONED ON (value)
 AS 
 SELECT * FROM src
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@src
 POSTHOOK: query: CREATE VIEW xxx5
 PARTITIONED ON (value)
 AS 
 SELECT * FROM src
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@xxx5
 FAILED: SemanticException LOCATION clause illegal for view partition
diff --git a/ql/src/test/results/clientnegative/alter_view_failure5.q.out b/ql/src/test/results/clientnegative/alter_view_failure5.q.out
index c06428f2db..fdaa937b9f 100644
--- a/ql/src/test/results/clientnegative/alter_view_failure5.q.out
+++ b/ql/src/test/results/clientnegative/alter_view_failure5.q.out
@@ -7,10 +7,12 @@ PARTITIONED ON (value)
 AS 
 SELECT * FROM src
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@src
 POSTHOOK: query: CREATE VIEW xxx6
 PARTITIONED ON (value)
 AS 
 SELECT * FROM src
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@xxx6
 FAILED: SemanticException Partition spec {v=val_86} contains non-partition columns
diff --git a/ql/src/test/results/clientnegative/alter_view_failure6.q.out b/ql/src/test/results/clientnegative/alter_view_failure6.q.out
index 0274e0b4b4..cfbaca8503 100644
--- a/ql/src/test/results/clientnegative/alter_view_failure6.q.out
+++ b/ql/src/test/results/clientnegative/alter_view_failure6.q.out
@@ -7,11 +7,13 @@ PARTITIONED ON (key)
 AS 
 SELECT hr,key FROM srcpart
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: CREATE VIEW xxx7
 PARTITIONED ON (key)
 AS 
 SELECT hr,key FROM srcpart
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@srcpart
 POSTHOOK: Output: default@xxx7
 FAILED: SemanticException [Error 10041]: No partition predicate found for Alias "xxx7:srcpart" Table "srcpart"
 FAILED: SemanticException [Error 10056]: The query does not reference any valid partition. To run this query, set hive.mapred.mode=nonstrict
diff --git a/ql/src/test/results/clientnegative/alter_view_failure7.q.out b/ql/src/test/results/clientnegative/alter_view_failure7.q.out
index 5e1eea2181..63041728ee 100644
--- a/ql/src/test/results/clientnegative/alter_view_failure7.q.out
+++ b/ql/src/test/results/clientnegative/alter_view_failure7.q.out
@@ -7,10 +7,12 @@ PARTITIONED ON (ds,hr)
 AS 
 SELECT key,ds,hr FROM srcpart
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: CREATE VIEW xxx8
 PARTITIONED ON (ds,hr)
 AS 
 SELECT key,ds,hr FROM srcpart
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@srcpart
 POSTHOOK: Output: default@xxx8
 FAILED: SemanticException partition spec {ds=2011-01-01} doesn't contain all (2) partition columns
diff --git a/ql/src/test/results/clientnegative/alter_view_failure9.q.out b/ql/src/test/results/clientnegative/alter_view_failure9.q.out
index 6003d7dc13..398718b0b4 100644
--- a/ql/src/test/results/clientnegative/alter_view_failure9.q.out
+++ b/ql/src/test/results/clientnegative/alter_view_failure9.q.out
@@ -6,9 +6,11 @@ PREHOOK: query: CREATE VIEW xxx4
 AS 
 SELECT * FROM src
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@src
 POSTHOOK: query: CREATE VIEW xxx4 
 AS 
 SELECT * FROM src
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@xxx4
 FAILED: SemanticException [Error 10131]: To alter a view you need to use the ALTER VIEW command.
diff --git a/ql/src/test/results/clientnegative/analyze_view.q.out b/ql/src/test/results/clientnegative/analyze_view.q.out
index c32154300d..6ed1e18cc4 100644
--- a/ql/src/test/results/clientnegative/analyze_view.q.out
+++ b/ql/src/test/results/clientnegative/analyze_view.q.out
@@ -4,7 +4,9 @@ POSTHOOK: query: DROP VIEW av
 POSTHOOK: type: DROPVIEW
 PREHOOK: query: CREATE VIEW av AS SELECT * FROM src
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@src
 POSTHOOK: query: CREATE VIEW av AS SELECT * FROM src
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@av
 FAILED: SemanticException [Error 10091]: ANALYZE is not supported for views
diff --git a/ql/src/test/results/clientnegative/create_or_replace_view1.q.out b/ql/src/test/results/clientnegative/create_or_replace_view1.q.out
index 65b3ef7faa..8c5d100f09 100644
--- a/ql/src/test/results/clientnegative/create_or_replace_view1.q.out
+++ b/ql/src/test/results/clientnegative/create_or_replace_view1.q.out
@@ -8,8 +8,10 @@ drop view v
 POSTHOOK: type: DROPVIEW
 PREHOOK: query: create view v partitioned on (ds, hr) as select * from srcpart
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: create view v partitioned on (ds, hr) as select * from srcpart
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@srcpart
 POSTHOOK: Output: default@v
 PREHOOK: query: alter view v add partition (ds='1',hr='2')
 PREHOOK: type: ALTERTABLE_ADDPARTS
diff --git a/ql/src/test/results/clientnegative/create_or_replace_view2.q.out b/ql/src/test/results/clientnegative/create_or_replace_view2.q.out
index a26c8b362a..1c4430e246 100644
--- a/ql/src/test/results/clientnegative/create_or_replace_view2.q.out
+++ b/ql/src/test/results/clientnegative/create_or_replace_view2.q.out
@@ -8,8 +8,10 @@ drop view v
 POSTHOOK: type: DROPVIEW
 PREHOOK: query: create view v partitioned on (ds, hr) as select * from srcpart
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: create view v partitioned on (ds, hr) as select * from srcpart
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@srcpart
 POSTHOOK: Output: default@v
 PREHOOK: query: alter view v add partition (ds='1',hr='2')
 PREHOOK: type: ALTERTABLE_ADDPARTS
diff --git a/ql/src/test/results/clientnegative/create_or_replace_view4.q.out b/ql/src/test/results/clientnegative/create_or_replace_view4.q.out
index a1d158fe32..49ebe844d9 100644
--- a/ql/src/test/results/clientnegative/create_or_replace_view4.q.out
+++ b/ql/src/test/results/clientnegative/create_or_replace_view4.q.out
@@ -8,7 +8,9 @@ drop view v
 POSTHOOK: type: DROPVIEW
 PREHOOK: query: create view v partitioned on (ds, hr) as select * from srcpart
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: create view v partitioned on (ds, hr) as select * from srcpart
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@srcpart
 POSTHOOK: Output: default@v
 FAILED: SemanticException [Error 10092]: At least one non-partitioning column must be present in view
diff --git a/ql/src/test/results/clientnegative/create_or_replace_view5.q.out b/ql/src/test/results/clientnegative/create_or_replace_view5.q.out
index 03576fbfc4..ddac913475 100644
--- a/ql/src/test/results/clientnegative/create_or_replace_view5.q.out
+++ b/ql/src/test/results/clientnegative/create_or_replace_view5.q.out
@@ -8,7 +8,9 @@ drop view v
 POSTHOOK: type: DROPVIEW
 PREHOOK: query: create view v partitioned on (ds, hr) as select * from srcpart
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: create view v partitioned on (ds, hr) as select * from srcpart
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@srcpart
 POSTHOOK: Output: default@v
 FAILED: SemanticException Can't combine IF NOT EXISTS and OR REPLACE.
diff --git a/ql/src/test/results/clientnegative/create_or_replace_view6.q.out b/ql/src/test/results/clientnegative/create_or_replace_view6.q.out
index 447dc2f5e3..486dbb9834 100644
--- a/ql/src/test/results/clientnegative/create_or_replace_view6.q.out
+++ b/ql/src/test/results/clientnegative/create_or_replace_view6.q.out
@@ -8,7 +8,9 @@ drop view v
 POSTHOOK: type: DROPVIEW
 PREHOOK: query: create view v partitioned on (ds, hr) as select * from srcpart
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: create view v partitioned on (ds, hr) as select * from srcpart
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@srcpart
 POSTHOOK: Output: default@v
 FAILED: ParseException line 2:52 cannot recognize input near 'blah' '<EOF>' '<EOF>' in select clause
diff --git a/ql/src/test/results/clientnegative/create_or_replace_view7.q.out b/ql/src/test/results/clientnegative/create_or_replace_view7.q.out
index 0abfc3de77..22824803cd 100644
--- a/ql/src/test/results/clientnegative/create_or_replace_view7.q.out
+++ b/ql/src/test/results/clientnegative/create_or_replace_view7.q.out
@@ -8,22 +8,28 @@ drop view v
 POSTHOOK: type: DROPVIEW
 PREHOOK: query: create view v1 partitioned on (ds, hr) as select * from srcpart
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: create view v1 partitioned on (ds, hr) as select * from srcpart
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@srcpart
 POSTHOOK: Output: default@v1
 PREHOOK: query: create view v2 partitioned on (ds, hr) as select * from v1
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@srcpart
 PREHOOK: Input: default@v1
 POSTHOOK: query: create view v2 partitioned on (ds, hr) as select * from v1
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@srcpart
 POSTHOOK: Input: default@v1
 POSTHOOK: Output: default@v2
 PREHOOK: query: create view v3 partitioned on (ds, hr) as select * from v2
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@srcpart
 PREHOOK: Input: default@v1
 PREHOOK: Input: default@v2
 POSTHOOK: query: create view v3 partitioned on (ds, hr) as select * from v2
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@srcpart
 POSTHOOK: Input: default@v1
 POSTHOOK: Input: default@v2
 POSTHOOK: Output: default@v3
diff --git a/ql/src/test/results/clientnegative/create_or_replace_view8.q.out b/ql/src/test/results/clientnegative/create_or_replace_view8.q.out
index a46ce128cb..ea0310b835 100644
--- a/ql/src/test/results/clientnegative/create_or_replace_view8.q.out
+++ b/ql/src/test/results/clientnegative/create_or_replace_view8.q.out
@@ -8,7 +8,9 @@ drop view v
 POSTHOOK: type: DROPVIEW
 PREHOOK: query: create view v1 partitioned on (ds, hr) as select * from srcpart
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: create view v1 partitioned on (ds, hr) as select * from srcpart
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@srcpart
 POSTHOOK: Output: default@v1
 FAILED: SemanticException Recursive view default.v1 detected (cycle: default.v1 -> default.v1).
diff --git a/ql/src/test/results/clientnegative/create_view_failure1.q.out b/ql/src/test/results/clientnegative/create_view_failure1.q.out
index 75d83a5f5f..406a5dfc6f 100644
--- a/ql/src/test/results/clientnegative/create_view_failure1.q.out
+++ b/ql/src/test/results/clientnegative/create_view_failure1.q.out
@@ -11,4 +11,5 @@ POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: default@xxx12
 PREHOOK: query: CREATE VIEW xxx12 AS SELECT key FROM src
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@src
 FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask. AlreadyExistsException(message:Table xxx12 already exists)
diff --git a/ql/src/test/results/clientnegative/create_view_failure2.q.out b/ql/src/test/results/clientnegative/create_view_failure2.q.out
index e7bde22213..f7964a971a 100644
--- a/ql/src/test/results/clientnegative/create_view_failure2.q.out
+++ b/ql/src/test/results/clientnegative/create_view_failure2.q.out
@@ -5,9 +5,11 @@ POSTHOOK: type: DROPVIEW
 PREHOOK: query: -- views and tables share the same namespace
 CREATE VIEW xxx4 AS SELECT key FROM src
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@src
 POSTHOOK: query: -- views and tables share the same namespace
 CREATE VIEW xxx4 AS SELECT key FROM src
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@xxx4
 PREHOOK: query: CREATE TABLE xxx4(key int)
 PREHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientnegative/create_view_failure4.q.out b/ql/src/test/results/clientnegative/create_view_failure4.q.out
index 9b0fa961b6..339eb042d5 100644
--- a/ql/src/test/results/clientnegative/create_view_failure4.q.out
+++ b/ql/src/test/results/clientnegative/create_view_failure4.q.out
@@ -6,4 +6,5 @@ PREHOOK: query: -- duplicate column names are illegal
 CREATE VIEW xxx5(x,x) AS
 SELECT key,value FROM src
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@src
 FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask. org.apache.hadoop.hive.ql.metadata.HiveException: Duplicate column name x in the table definition.
diff --git a/ql/src/test/results/clientnegative/drop_table_failure2.q.out b/ql/src/test/results/clientnegative/drop_table_failure2.q.out
index 7681716ac5..adad9f431e 100644
--- a/ql/src/test/results/clientnegative/drop_table_failure2.q.out
+++ b/ql/src/test/results/clientnegative/drop_table_failure2.q.out
@@ -1,7 +1,9 @@
 PREHOOK: query: CREATE VIEW xxx6 AS SELECT key FROM src
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@src
 POSTHOOK: query: CREATE VIEW xxx6 AS SELECT key FROM src
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@xxx6
 PREHOOK: query: -- Can't use DROP TABLE on a view
 DROP TABLE xxx6
diff --git a/ql/src/test/results/clientnegative/insert_view_failure.q.out b/ql/src/test/results/clientnegative/insert_view_failure.q.out
index 0e43ee9e5d..05d0b75236 100644
--- a/ql/src/test/results/clientnegative/insert_view_failure.q.out
+++ b/ql/src/test/results/clientnegative/insert_view_failure.q.out
@@ -4,7 +4,9 @@ POSTHOOK: query: DROP VIEW xxx2
 POSTHOOK: type: DROPVIEW
 PREHOOK: query: CREATE VIEW xxx2 AS SELECT * FROM src
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@src
 POSTHOOK: query: CREATE VIEW xxx2 AS SELECT * FROM src
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@xxx2
 FAILED: SemanticException [Error 10090]: A view cannot be used as target table for LOAD or INSERT
diff --git a/ql/src/test/results/clientnegative/invalidate_view1.q.out b/ql/src/test/results/clientnegative/invalidate_view1.q.out
index c322777804..fdc60534ac 100644
--- a/ql/src/test/results/clientnegative/invalidate_view1.q.out
+++ b/ql/src/test/results/clientnegative/invalidate_view1.q.out
@@ -19,14 +19,18 @@ POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: default@xxx10
 PREHOOK: query: CREATE VIEW xxx9 AS SELECT * FROM xxx10
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@xxx10
 POSTHOOK: query: CREATE VIEW xxx9 AS SELECT * FROM xxx10
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@xxx10
 POSTHOOK: Output: default@xxx9
 PREHOOK: query: CREATE VIEW xxx8 AS SELECT * FROM xxx9 xxx
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@xxx10
 PREHOOK: Input: default@xxx9
 POSTHOOK: query: CREATE VIEW xxx8 AS SELECT * FROM xxx9 xxx
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@xxx10
 POSTHOOK: Input: default@xxx9
 POSTHOOK: Output: default@xxx8
 PREHOOK: query: ALTER TABLE xxx10 REPLACE COLUMNS (key int)
diff --git a/ql/src/test/results/clientnegative/load_view_failure.q.out b/ql/src/test/results/clientnegative/load_view_failure.q.out
index 68223f0368..d21c9bf09f 100644
--- a/ql/src/test/results/clientnegative/load_view_failure.q.out
+++ b/ql/src/test/results/clientnegative/load_view_failure.q.out
@@ -4,7 +4,9 @@ POSTHOOK: query: DROP VIEW xxx11
 POSTHOOK: type: DROPVIEW
 PREHOOK: query: CREATE VIEW xxx11 AS SELECT * FROM src
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@src
 POSTHOOK: query: CREATE VIEW xxx11 AS SELECT * FROM src
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@xxx11
 FAILED: SemanticException [Error 10090]: A view cannot be used as target table for LOAD or INSERT
diff --git a/ql/src/test/results/clientnegative/recursive_view.q.out b/ql/src/test/results/clientnegative/recursive_view.q.out
index 1171fa8baf..94b968b8d4 100644
--- a/ql/src/test/results/clientnegative/recursive_view.q.out
+++ b/ql/src/test/results/clientnegative/recursive_view.q.out
@@ -29,35 +29,43 @@ POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: default@t
 PREHOOK: query: create view r0 as select * from t
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@t
 POSTHOOK: query: create view r0 as select * from t
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@t
 POSTHOOK: Output: default@r0
 PREHOOK: query: create view r1 as select * from r0
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@r0
+PREHOOK: Input: default@t
 POSTHOOK: query: create view r1 as select * from r0
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@r0
+POSTHOOK: Input: default@t
 POSTHOOK: Output: default@r1
 PREHOOK: query: create view r2 as select * from r1
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@r0
 PREHOOK: Input: default@r1
+PREHOOK: Input: default@t
 POSTHOOK: query: create view r2 as select * from r1
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@r0
 POSTHOOK: Input: default@r1
+POSTHOOK: Input: default@t
 POSTHOOK: Output: default@r2
 PREHOOK: query: create view r3 as select * from r2
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@r0
 PREHOOK: Input: default@r1
 PREHOOK: Input: default@r2
+PREHOOK: Input: default@t
 POSTHOOK: query: create view r3 as select * from r2
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@r0
 POSTHOOK: Input: default@r1
 POSTHOOK: Input: default@r2
+POSTHOOK: Input: default@t
 POSTHOOK: Output: default@r3
 PREHOOK: query: drop view r0
 PREHOOK: type: DROPVIEW
diff --git a/ql/src/test/results/clientnegative/unset_view_property.q.out b/ql/src/test/results/clientnegative/unset_view_property.q.out
index 1e15b471d3..46860b3273 100644
--- a/ql/src/test/results/clientnegative/unset_view_property.q.out
+++ b/ql/src/test/results/clientnegative/unset_view_property.q.out
@@ -1,7 +1,9 @@
 PREHOOK: query: CREATE VIEW testView AS SELECT value FROM src WHERE key=86
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@src
 POSTHOOK: query: CREATE VIEW testView AS SELECT value FROM src WHERE key=86
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@testView
 PREHOOK: query: ALTER VIEW testView SET TBLPROPERTIES ('propA'='100', 'propB'='200')
 PREHOOK: type: ALTERVIEW_PROPERTIES
diff --git a/ql/src/test/results/clientpositive/alter_view_as_select.q.out b/ql/src/test/results/clientpositive/alter_view_as_select.q.out
index 41f95c137d..686ceb3d5c 100644
--- a/ql/src/test/results/clientpositive/alter_view_as_select.q.out
+++ b/ql/src/test/results/clientpositive/alter_view_as_select.q.out
@@ -4,8 +4,10 @@ POSTHOOK: query: DROP VIEW testView
 POSTHOOK: type: DROPVIEW
 PREHOOK: query: CREATE VIEW testView as SELECT * FROM srcpart
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: CREATE VIEW testView as SELECT * FROM srcpart
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@srcpart
 POSTHOOK: Output: default@testView
 PREHOOK: query: DESCRIBE FORMATTED testView
 PREHOOK: type: DESCTABLE
@@ -41,8 +43,10 @@ View Original Text: 	SELECT * FROM srcpart
 View Expanded Text: 	SELECT `srcpart`.`key`, `srcpart`.`value`, `srcpart`.`ds`, `srcpart`.`hr` FROM `default`.`srcpart`	 
 PREHOOK: query: ALTER VIEW testView AS SELECT value FROM src WHERE key=86
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@src
 POSTHOOK: query: ALTER VIEW testView AS SELECT value FROM src WHERE key=86
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@testview
 PREHOOK: query: DESCRIBE FORMATTED testView
 PREHOOK: type: DESCTABLE
@@ -79,12 +83,14 @@ WHERE key > 80 AND key < 100
 ORDER BY key, value
 LIMIT 10
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@src
 POSTHOOK: query: ALTER VIEW testView AS
 SELECT * FROM src
 WHERE key > 80 AND key < 100
 ORDER BY key, value
 LIMIT 10
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@testview
 PREHOOK: query: DESCRIBE FORMATTED testView
 PREHOOK: type: DESCTABLE
diff --git a/ql/src/test/results/clientpositive/alter_view_rename.q.out b/ql/src/test/results/clientpositive/alter_view_rename.q.out
index d6838f5432..1c664f4601 100644
--- a/ql/src/test/results/clientpositive/alter_view_rename.q.out
+++ b/ql/src/test/results/clientpositive/alter_view_rename.q.out
@@ -5,8 +5,10 @@ POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: default@invites
 PREHOOK: query: CREATE VIEW view1 as SELECT * FROM invites
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@invites
 POSTHOOK: query: CREATE VIEW view1 as SELECT * FROM invites
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@invites
 POSTHOOK: Output: default@view1
 PREHOOK: query: DESCRIBE EXTENDED view1
 PREHOOK: type: DESCTABLE
diff --git a/ql/src/test/results/clientpositive/authorization_8.q.out b/ql/src/test/results/clientpositive/authorization_8.q.out
index b66fabcc84..4eef13b6dc 100644
--- a/ql/src/test/results/clientpositive/authorization_8.q.out
+++ b/ql/src/test/results/clientpositive/authorization_8.q.out
@@ -9,8 +9,10 @@ POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: default@tbl_j5jbymsx8e
 PREHOOK: query: CREATE VIEW view_j5jbymsx8e_1 as SELECT * FROM tbl_j5jbymsx8e
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@tbl_j5jbymsx8e
 POSTHOOK: query: CREATE VIEW view_j5jbymsx8e_1 as SELECT * FROM tbl_j5jbymsx8e
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@tbl_j5jbymsx8e
 POSTHOOK: Output: default@view_j5jbymsx8e_1
 PREHOOK: query: DESCRIBE view_j5jbymsx8e_1
 PREHOOK: type: DESCTABLE
diff --git a/ql/src/test/results/clientpositive/authorization_view.q.out b/ql/src/test/results/clientpositive/authorization_view.q.out
index e74be93ade..23a1c0b90d 100644
--- a/ql/src/test/results/clientpositive/authorization_view.q.out
+++ b/ql/src/test/results/clientpositive/authorization_view.q.out
@@ -2,10 +2,12 @@ PREHOOK: query: -- SORT_BEFORE_DIFF
 
 create view src_autho_test as select * from src
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@src
 POSTHOOK: query: -- SORT_BEFORE_DIFF
 
 create view src_autho_test as select * from src
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@src_autho_test
 PREHOOK: query: --view grant to user
 
diff --git a/ql/src/test/results/clientpositive/create_big_view.q.out b/ql/src/test/results/clientpositive/create_big_view.q.out
index 20a4dc19b2..9efa517ef5 100644
--- a/ql/src/test/results/clientpositive/create_big_view.q.out
+++ b/ql/src/test/results/clientpositive/create_big_view.q.out
@@ -242,6 +242,7 @@ CREATE VIEW big_view AS SELECT
 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa'
 FROM src
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@src
 POSTHOOK: query: -- Define a view with long SQL text to test metastore and other limits.
 
 CREATE VIEW big_view AS SELECT 
@@ -482,6 +483,7 @@ CREATE VIEW big_view AS SELECT
 'aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa'
 FROM src
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@big_view
 PREHOOK: query: SELECT a FROM big_view
 LIMIT 1
diff --git a/ql/src/test/results/clientpositive/create_like_tbl_props.q.out b/ql/src/test/results/clientpositive/create_like_tbl_props.q.out
index 039fbe387d..318aea8ffb 100644
--- a/ql/src/test/results/clientpositive/create_like_tbl_props.q.out
+++ b/ql/src/test/results/clientpositive/create_like_tbl_props.q.out
@@ -160,10 +160,12 @@ PREHOOK: query: --Test that CREATE TALBE LIKE on a view can take explicit table
 
 CREATE VIEW test_view (key, value) AS SELECT * FROM src
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@src
 POSTHOOK: query: --Test that CREATE TALBE LIKE on a view can take explicit table properties
 
 CREATE VIEW test_view (key, value) AS SELECT * FROM src
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@test_view
 PREHOOK: query: CREATE TABLE test_table4 LIKE test_view TBLPROPERTIES('key'='value')
 PREHOOK: type: CREATETABLE
diff --git a/ql/src/test/results/clientpositive/create_like_view.q.out b/ql/src/test/results/clientpositive/create_like_view.q.out
index e0bacbcf6b..48d4992870 100644
--- a/ql/src/test/results/clientpositive/create_like_view.q.out
+++ b/ql/src/test/results/clientpositive/create_like_view.q.out
@@ -56,8 +56,10 @@ Storage Desc Params:
 	serialization.format	1                   
 PREHOOK: query: CREATE VIEW view1 AS SELECT * FROM table1
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@table1
 POSTHOOK: query: CREATE VIEW view1 AS SELECT * FROM table1
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@table1
 POSTHOOK: Output: default@view1
 PREHOOK: query: CREATE TABLE table2 LIKE view1
 PREHOOK: type: CREATETABLE
@@ -236,9 +238,11 @@ POSTHOOK: Lineage: table2.b SIMPLE [(src)src.FieldSchema(name:value, type:string
 PREHOOK: query: -- check partitions
 create view view1 partitioned on (ds, hr) as select * from srcpart
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: -- check partitions
 create view view1 partitioned on (ds, hr) as select * from srcpart
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@srcpart
 POSTHOOK: Output: default@view1
 POSTHOOK: Lineage: table1.a SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: table1.b SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/create_or_replace_view.q.out b/ql/src/test/results/clientpositive/create_or_replace_view.q.out
index bb9b66919c..fe54ab5a59 100644
--- a/ql/src/test/results/clientpositive/create_or_replace_view.q.out
+++ b/ql/src/test/results/clientpositive/create_or_replace_view.q.out
@@ -4,8 +4,10 @@ POSTHOOK: query: drop view v
 POSTHOOK: type: DROPVIEW
 PREHOOK: query: create view v as select * from srcpart
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: create view v as select * from srcpart
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@srcpart
 POSTHOOK: Output: default@v
 PREHOOK: query: describe formatted v
 PREHOOK: type: DESCTABLE
@@ -42,9 +44,11 @@ View Expanded Text: 	select `srcpart`.`key`, `srcpart`.`value`, `srcpart`.`ds`,
 PREHOOK: query: -- modifying definition of unpartitioned view
 create or replace view v partitioned on (ds, hr) as select * from srcpart
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: -- modifying definition of unpartitioned view
 create or replace view v partitioned on (ds, hr) as select * from srcpart
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@srcpart
 POSTHOOK: Output: default@v
 PREHOOK: query: alter view v add partition (ds='2008-04-08',hr='11')
 PREHOOK: type: ALTERTABLE_ADDPARTS
@@ -128,9 +132,11 @@ ds=2008-04-08/hr=12
 PREHOOK: query: -- altering partitioned view 1
 create or replace view v partitioned on (ds, hr) as select value, ds, hr from srcpart
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: -- altering partitioned view 1
 create or replace view v partitioned on (ds, hr) as select value, ds, hr from srcpart
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@srcpart
 POSTHOOK: Output: default@v
 PREHOOK: query: select * from v where value='val_409' and ds='2008-04-08' and hr='11'
 PREHOOK: type: QUERY
@@ -191,9 +197,11 @@ ds=2008-04-08/hr=12
 PREHOOK: query: -- altering partitioned view 2
 create or replace view v partitioned on (ds, hr) as select key, value, ds, hr from srcpart
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: -- altering partitioned view 2
 create or replace view v partitioned on (ds, hr) as select key, value, ds, hr from srcpart
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@srcpart
 POSTHOOK: Output: default@v
 PREHOOK: query: select * from v where value='val_409' and ds='2008-04-08' and hr='11'
 PREHOOK: type: QUERY
@@ -269,8 +277,10 @@ POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: default@srcpart_temp
 PREHOOK: query: create view v partitioned on (ds, hr) as select * from srcpart_temp
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@srcpart_temp
 POSTHOOK: query: create view v partitioned on (ds, hr) as select * from srcpart_temp
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@srcpart_temp
 POSTHOOK: Output: default@v
 PREHOOK: query: drop table srcpart_temp
 PREHOOK: type: DROPTABLE
@@ -283,9 +293,11 @@ POSTHOOK: Output: default@srcpart_temp
 PREHOOK: query: -- v is now invalid
 create or replace view v partitioned on (ds, hr) as select * from srcpart
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: -- v is now invalid
 create or replace view v partitioned on (ds, hr) as select * from srcpart
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@srcpart
 POSTHOOK: Output: default@v
 PREHOOK: query: describe formatted v
 PREHOOK: type: DESCTABLE
diff --git a/ql/src/test/results/clientpositive/create_view.q.out b/ql/src/test/results/clientpositive/create_view.q.out
index bcab77869f..29ed662ac2 100644
--- a/ql/src/test/results/clientpositive/create_view.q.out
+++ b/ql/src/test/results/clientpositive/create_view.q.out
@@ -85,22 +85,28 @@ POSTHOOK: Input: default@src
 86	val_86
 PREHOOK: query: CREATE VIEW view1 AS SELECT value FROM src WHERE key=86
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@src
 POSTHOOK: query: CREATE VIEW view1 AS SELECT value FROM src WHERE key=86
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@view1
 PREHOOK: query: CREATE VIEW view2 AS SELECT * FROM src
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@src
 POSTHOOK: query: CREATE VIEW view2 AS SELECT * FROM src
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@view2
 PREHOOK: query: CREATE VIEW view3(valoo) 
 TBLPROPERTIES ("fear" = "factor")
 AS SELECT upper(value) FROM src WHERE key=86
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@src
 POSTHOOK: query: CREATE VIEW view3(valoo) 
 TBLPROPERTIES ("fear" = "factor")
 AS SELECT upper(value) FROM src WHERE key=86
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@view3
 PREHOOK: query: SELECT * from view1
 PREHOOK: type: QUERY
@@ -431,8 +437,10 @@ POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:st
 86
 PREHOOK: query: CREATE VIEW view4 AS SELECT * FROM table1
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@table1
 POSTHOOK: query: CREATE VIEW view4 AS SELECT * FROM table1
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@table1
 POSTHOOK: Output: default@view4
 POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: SELECT * FROM view4
@@ -500,10 +508,12 @@ key                 	int                 	None
 PREHOOK: query: CREATE VIEW view5 AS SELECT v1.key as key1, v2.key as key2
 FROM view4 v1 join view4 v2
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@table1
 PREHOOK: Input: default@view4
 POSTHOOK: query: CREATE VIEW view5 AS SELECT v1.key as key1, v2.key as key2
 FROM view4 v1 join view4 v2
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@table1
 POSTHOOK: Input: default@view4
 POSTHOOK: Output: default@view5
 POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -533,11 +543,13 @@ PREHOOK: query: -- verify that column name and comment in DDL portion
 CREATE VIEW view6(valoo COMMENT 'I cannot spell') AS
 SELECT upper(value) as blarg FROM src WHERE key=86
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@src
 POSTHOOK: query: -- verify that column name and comment in DDL portion
 -- overrides column alias in SELECT
 CREATE VIEW view6(valoo COMMENT 'I cannot spell') AS
 SELECT upper(value) as blarg FROM src WHERE key=86
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@view6
 POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE view6
@@ -553,6 +565,7 @@ WHERE key > 80 AND key < 100
 ORDER BY key, value
 LIMIT 10
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@src
 POSTHOOK: query: -- verify that ORDER BY and LIMIT are both supported in view def
 CREATE VIEW view7 AS
 SELECT * FROM src
@@ -560,6 +573,7 @@ WHERE key > 80 AND key < 100
 ORDER BY key, value
 LIMIT 10
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@view7
 POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: SELECT * FROM view7
@@ -664,10 +678,12 @@ PREHOOK: query: CREATE VIEW view8(c) AS
 SELECT test_translate('abc', 'a', 'b')
 FROM table1
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@table1
 POSTHOOK: query: CREATE VIEW view8(c) AS
 SELECT test_translate('abc', 'a', 'b')
 FROM table1
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@table1
 POSTHOOK: Output: default@view8
 POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE EXTENDED view8
@@ -738,11 +754,13 @@ CREATE VIEW view9(m) AS
 SELECT test_max(length(value))
 FROM src
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@src
 POSTHOOK: query: -- disable map-side aggregation
 CREATE VIEW view9(m) AS
 SELECT test_max(length(value))
 FROM src
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@view9
 POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE EXTENDED view9
@@ -813,11 +831,13 @@ CREATE VIEW view9(m) AS
 SELECT test_max(length(value))
 FROM src
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@src
 POSTHOOK: query: -- enable map-side aggregation
 CREATE VIEW view9(m) AS
 SELECT test_max(length(value))
 FROM src
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@view9
 POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE EXTENDED view9
@@ -878,10 +898,12 @@ PREHOOK: query: -- test usage of a subselect within a view
 CREATE VIEW view10 AS
 SELECT slurp.* FROM (SELECT * FROM src WHERE key=86) slurp
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@src
 POSTHOOK: query: -- test usage of a subselect within a view
 CREATE VIEW view10 AS
 SELECT slurp.* FROM (SELECT * FROM src WHERE key=86) slurp
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@view10
 POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE EXTENDED view10
@@ -949,10 +971,12 @@ PREHOOK: query: CREATE VIEW view11 AS
 SELECT test_explode(array(1,2,3)) AS (boom)
 FROM table1
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@table1
 POSTHOOK: query: CREATE VIEW view11 AS
 SELECT test_explode(array(1,2,3)) AS (boom)
 FROM table1
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@table1
 POSTHOOK: Output: default@view11
 POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE EXTENDED view11
@@ -1015,10 +1039,12 @@ PREHOOK: query: -- test usage of LATERAL within a view
 CREATE VIEW view12 AS
 SELECT * FROM src LATERAL VIEW explode(array(1,2,3)) myTable AS myCol
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@src
 POSTHOOK: query: -- test usage of LATERAL within a view
 CREATE VIEW view12 AS
 SELECT * FROM src LATERAL VIEW explode(array(1,2,3)) myTable AS myCol
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@view12
 POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE EXTENDED view12
@@ -1098,11 +1124,13 @@ CREATE VIEW view13 AS
 SELECT s.key
 FROM srcbucket TABLESAMPLE (BUCKET 1 OUT OF 5 ON key) s
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@srcbucket
 POSTHOOK: query: -- test usage of TABLESAMPLE within a view
 CREATE VIEW view13 AS
 SELECT s.key
 FROM srcbucket TABLESAMPLE (BUCKET 1 OUT OF 5 ON key) s
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@srcbucket
 POSTHOOK: Output: default@view13
 POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE EXTENDED view13
@@ -1185,6 +1213,7 @@ JOIN
       select s4.key as key, s4.value as value from src s4 where s4.key < 10) unionsrc2
 ON (unionsrc1.key = unionsrc2.key)
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@src
 POSTHOOK: query: -- test usage of JOIN+UNION+AGG all within same view
 CREATE VIEW view14 AS
 SELECT unionsrc1.key as k1, unionsrc1.value as v1,
@@ -1198,6 +1227,7 @@ JOIN
       select s4.key as key, s4.value as value from src s4 where s4.key < 10) unionsrc2
 ON (unionsrc1.key = unionsrc2.key)
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@view14
 POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE EXTENDED view14
@@ -1322,12 +1352,14 @@ SELECT key,COUNT(value) AS value_count
 FROM src
 GROUP BY key
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@src
 POSTHOOK: query: -- test usage of GROUP BY within view
 CREATE VIEW view15 AS
 SELECT key,COUNT(value) AS value_count
 FROM src
 GROUP BY key
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@view15
 POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE EXTENDED view15
@@ -1408,11 +1440,13 @@ CREATE VIEW view16 AS
 SELECT DISTINCT value
 FROM src
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@src
 POSTHOOK: query: -- test usage of DISTINCT within view
 CREATE VIEW view16 AS
 SELECT DISTINCT value
 FROM src
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@view16
 POSTHOOK: Lineage: table1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 PREHOOK: query: DESCRIBE EXTENDED view16
diff --git a/ql/src/test/results/clientpositive/create_view_partitioned.q.out b/ql/src/test/results/clientpositive/create_view_partitioned.q.out
index 72adb188f2..f27d00f16f 100644
--- a/ql/src/test/results/clientpositive/create_view_partitioned.q.out
+++ b/ql/src/test/results/clientpositive/create_view_partitioned.q.out
@@ -19,6 +19,7 @@ SELECT key, value
 FROM src
 WHERE key=86
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@src
 POSTHOOK: query: -- test partitioned view definition
 -- (underlying table is not actually partitioned)
 CREATE VIEW vp1
@@ -28,6 +29,7 @@ SELECT key, value
 FROM src
 WHERE key=86
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@vp1
 PREHOOK: query: DESCRIBE EXTENDED vp1
 PREHOOK: type: DESCTABLE
@@ -228,12 +230,14 @@ CREATE VIEW vp2
 PARTITIONED ON (hr)
 AS SELECT * FROM srcpart WHERE key < 10
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: -- test a partitioned view on top of an underlying partitioned table,
 -- but with only a suffix of the partitioning columns
 CREATE VIEW vp2
 PARTITIONED ON (hr)
 AS SELECT * FROM srcpart WHERE key < 10
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@srcpart
 POSTHOOK: Output: default@vp2
 PREHOOK: query: DESCRIBE FORMATTED vp2
 PREHOOK: type: DESCTABLE
@@ -332,6 +336,7 @@ SELECT key, value
 FROM src
 WHERE key=86
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@src
 POSTHOOK: query: -- test a partitioned view where the PARTITIONED ON clause references
 -- an imposed column name
 CREATE VIEW vp3(k,v)
@@ -341,6 +346,7 @@ SELECT key, value
 FROM src
 WHERE key=86
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@vp3
 PREHOOK: query: DESCRIBE FORMATTED vp3
 PREHOOK: type: DESCTABLE
diff --git a/ql/src/test/results/clientpositive/create_view_translate.q.out b/ql/src/test/results/clientpositive/create_view_translate.q.out
index 7d8f9382cf..f7243ffee9 100644
--- a/ql/src/test/results/clientpositive/create_view_translate.q.out
+++ b/ql/src/test/results/clientpositive/create_view_translate.q.out
@@ -8,8 +8,10 @@ POSTHOOK: query: drop view if exists w
 POSTHOOK: type: DROPVIEW
 PREHOOK: query: create view v as select cast(key as string) from src
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@src
 POSTHOOK: query: create view v as select cast(key as string) from src
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@v
 PREHOOK: query: describe formatted v
 PREHOOK: type: DESCTABLE
@@ -44,10 +46,12 @@ PREHOOK: query: create view w as select key, value from (
   select key, value from src
 ) a
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@src
 POSTHOOK: query: create view w as select key, value from (
   select key, value from src
 ) a
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@w
 PREHOOK: query: describe formatted w
 PREHOOK: type: DESCTABLE
@@ -129,8 +133,10 @@ STAGE PLANS:
 
 PREHOOK: query: CREATE VIEW priceview AS SELECT items.id, items.info['price'] FROM items
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@items
 POSTHOOK: query: CREATE VIEW priceview AS SELECT items.id, items.info['price'] FROM items
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@items
 POSTHOOK: Output: default@priceview
 PREHOOK: query: select * from priceview
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/ctas_char.q.out b/ql/src/test/results/clientpositive/ctas_char.q.out
index 3a172b85d3..433a7edd8d 100644
--- a/ql/src/test/results/clientpositive/ctas_char.q.out
+++ b/ql/src/test/results/clientpositive/ctas_char.q.out
@@ -41,9 +41,11 @@ POSTHOOK: Lineage: ctas_char_1.value SIMPLE [(src)src.FieldSchema(name:value, ty
 PREHOOK: query: -- view with char column
 create view ctas_char_3 as select key, value from ctas_char_2
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@ctas_char_2
 POSTHOOK: query: -- view with char column
 create view ctas_char_3 as select key, value from ctas_char_2
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@ctas_char_2
 POSTHOOK: Output: default@ctas_char_3
 POSTHOOK: Lineage: ctas_char_1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: ctas_char_1.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/ctas_date.q.out b/ql/src/test/results/clientpositive/ctas_date.q.out
index c3404fe247..c7a26c9cf9 100644
--- a/ql/src/test/results/clientpositive/ctas_date.q.out
+++ b/ql/src/test/results/clientpositive/ctas_date.q.out
@@ -47,17 +47,21 @@ POSTHOOK: Lineage: ctas_date_1.value SIMPLE [(src)src.FieldSchema(name:value, ty
 PREHOOK: query: -- view with date column
 create view ctas_date_3 as select * from ctas_date_2 where dd > date '2000-01-01'
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@ctas_date_2
 POSTHOOK: query: -- view with date column
 create view ctas_date_3 as select * from ctas_date_2 where dd > date '2000-01-01'
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@ctas_date_2
 POSTHOOK: Output: default@ctas_date_3
 POSTHOOK: Lineage: ctas_date_1.dd SIMPLE []
 POSTHOOK: Lineage: ctas_date_1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: ctas_date_1.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: create view ctas_date_4 as select * from ctas_date_2 where dd < date '2000-01-01'
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@ctas_date_2
 POSTHOOK: query: create view ctas_date_4 as select * from ctas_date_2 where dd < date '2000-01-01'
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@ctas_date_2
 POSTHOOK: Output: default@ctas_date_4
 POSTHOOK: Lineage: ctas_date_1.dd SIMPLE []
 POSTHOOK: Lineage: ctas_date_1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/ctas_varchar.q.out b/ql/src/test/results/clientpositive/ctas_varchar.q.out
index a4a9c665ac..a11131d1aa 100644
--- a/ql/src/test/results/clientpositive/ctas_varchar.q.out
+++ b/ql/src/test/results/clientpositive/ctas_varchar.q.out
@@ -41,9 +41,11 @@ POSTHOOK: Lineage: ctas_varchar_1.value SIMPLE [(src)src.FieldSchema(name:value,
 PREHOOK: query: -- view with varchar column
 create view ctas_varchar_3 as select key, value from ctas_varchar_2
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@ctas_varchar_2
 POSTHOOK: query: -- view with varchar column
 create view ctas_varchar_3 as select key, value from ctas_varchar_2
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@ctas_varchar_2
 POSTHOOK: Output: default@ctas_varchar_3
 POSTHOOK: Lineage: ctas_varchar_1.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: ctas_varchar_1.value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/database_drop.q.out b/ql/src/test/results/clientpositive/database_drop.q.out
index 38279b85c1..86a21e469e 100644
--- a/ql/src/test/results/clientpositive/database_drop.q.out
+++ b/ql/src/test/results/clientpositive/database_drop.q.out
@@ -40,8 +40,10 @@ POSTHOOK: type: LOAD
 POSTHOOK: Output: db5@temp_tbl
 PREHOOK: query: CREATE VIEW temp_tbl_view AS SELECT * FROM temp_tbl
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: db5@temp_tbl
 POSTHOOK: query: CREATE VIEW temp_tbl_view AS SELECT * FROM temp_tbl
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: db5@temp_tbl
 POSTHOOK: Output: db5@temp_tbl_view
 PREHOOK: query: CREATE INDEX idx1 ON TABLE temp_tbl(id) AS 'COMPACT' with DEFERRED REBUILD
 PREHOOK: type: CREATEINDEX
@@ -80,8 +82,10 @@ POSTHOOK: Lineage: db5__temp_tbl_idx1__._offsets EXPRESSION [(temp_tbl)temp_tbl.
 POSTHOOK: Lineage: db5__temp_tbl_idx1__.id SIMPLE [(temp_tbl)temp_tbl.FieldSchema(name:id, type:int, comment:null), ]
 PREHOOK: query: CREATE VIEW temp_tbl2_view AS SELECT * FROM temp_tbl2
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: db5@temp_tbl2
 POSTHOOK: query: CREATE VIEW temp_tbl2_view AS SELECT * FROM temp_tbl2
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: db5@temp_tbl2
 POSTHOOK: Output: db5@temp_tbl2_view
 POSTHOOK: Lineage: db5__temp_tbl_idx1__._bucketname SIMPLE [(temp_tbl)temp_tbl.FieldSchema(name:INPUT__FILE__NAME, type:string, comment:), ]
 POSTHOOK: Lineage: db5__temp_tbl_idx1__._offsets EXPRESSION [(temp_tbl)temp_tbl.FieldSchema(name:BLOCK__OFFSET__INSIDE__FILE, type:bigint, comment:), ]
diff --git a/ql/src/test/results/clientpositive/describe_formatted_view_partitioned.q.out b/ql/src/test/results/clientpositive/describe_formatted_view_partitioned.q.out
index e384a4d893..6327bbf88d 100644
--- a/ql/src/test/results/clientpositive/describe_formatted_view_partitioned.q.out
+++ b/ql/src/test/results/clientpositive/describe_formatted_view_partitioned.q.out
@@ -9,6 +9,7 @@ SELECT key, value
 FROM src
 WHERE key=86
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@src
 POSTHOOK: query: CREATE VIEW view_partitioned
 PARTITIONED ON (value)
 AS
@@ -16,6 +17,7 @@ SELECT key, value
 FROM src
 WHERE key=86
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@view_partitioned
 PREHOOK: query: ALTER VIEW view_partitioned
 ADD PARTITION (value='val_86')
diff --git a/ql/src/test/results/clientpositive/describe_formatted_view_partitioned_json.q.out b/ql/src/test/results/clientpositive/describe_formatted_view_partitioned_json.q.out
index ba56c0b9c8..08075fe0be 100644
--- a/ql/src/test/results/clientpositive/describe_formatted_view_partitioned_json.q.out
+++ b/ql/src/test/results/clientpositive/describe_formatted_view_partitioned_json.q.out
@@ -9,6 +9,7 @@ SELECT key, value
 FROM src
 WHERE key=86
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@src
 POSTHOOK: query: CREATE VIEW view_partitioned
 PARTITIONED ON (value)
 AS
@@ -16,6 +17,7 @@ SELECT key, value
 FROM src
 WHERE key=86
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@view_partitioned
 PREHOOK: query: ALTER VIEW view_partitioned
 ADD PARTITION (value='val_86')
diff --git a/ql/src/test/results/clientpositive/explain_dependency.q.out b/ql/src/test/results/clientpositive/explain_dependency.q.out
index 2f272bbeca..8f2ab34df7 100644
--- a/ql/src/test/results/clientpositive/explain_dependency.q.out
+++ b/ql/src/test/results/clientpositive/explain_dependency.q.out
@@ -3,38 +3,50 @@ PREHOOK: query: -- This test is used for testing EXPLAIN DEPENDENCY command
 -- Create some views
 CREATE VIEW V1 AS SELECT key, value from src
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@src
 POSTHOOK: query: -- This test is used for testing EXPLAIN DEPENDENCY command
 
 -- Create some views
 CREATE VIEW V1 AS SELECT key, value from src
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@V1
 PREHOOK: query: CREATE VIEW V2 AS SELECT ds, key, value FROM srcpart WHERE ds IS NOT NULL
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: CREATE VIEW V2 AS SELECT ds, key, value FROM srcpart WHERE ds IS NOT NULL
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@srcpart
 POSTHOOK: Output: default@V2
 PREHOOK: query: CREATE VIEW V3 AS 
   SELECT src1.key, src2.value FROM V2 src1 
   JOIN src src2 ON src1.key = src2.key WHERE src1.ds IS NOT NULL
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@src
+PREHOOK: Input: default@srcpart
 PREHOOK: Input: default@v2
 POSTHOOK: query: CREATE VIEW V3 AS 
   SELECT src1.key, src2.value FROM V2 src1 
   JOIN src src2 ON src1.key = src2.key WHERE src1.ds IS NOT NULL
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@src
+POSTHOOK: Input: default@srcpart
 POSTHOOK: Input: default@v2
 POSTHOOK: Output: default@V3
 PREHOOK: query: CREATE VIEW V4 AS 
   SELECT src1.key, src2.value as value1, src3.value as value2 
   FROM V1 src1 JOIN V2 src2 on src1.key = src2.key JOIN src src3 ON src2.key = src3.key
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@src
+PREHOOK: Input: default@srcpart
 PREHOOK: Input: default@v1
 PREHOOK: Input: default@v2
 POSTHOOK: query: CREATE VIEW V4 AS 
   SELECT src1.key, src2.value as value1, src3.value as value2 
   FROM V1 src1 JOIN V2 src2 on src1.key = src2.key JOIN src src3 ON src2.key = src3.key
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@src
+POSTHOOK: Input: default@srcpart
 POSTHOOK: Input: default@v1
 POSTHOOK: Input: default@v2
 POSTHOOK: Output: default@V4
@@ -98,10 +110,12 @@ PREHOOK: query: -- The table should show up in the explain dependency even if no
 -- of the partitions are selected.
 CREATE VIEW V5 as SELECT * FROM srcpart where ds = '10'
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: -- The table should show up in the explain dependency even if none
 -- of the partitions are selected.
 CREATE VIEW V5 as SELECT * FROM srcpart where ds = '10'
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@srcpart
 POSTHOOK: Output: default@V5
 PREHOOK: query: EXPLAIN DEPENDENCY SELECT * FROM V5
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/explain_logical.q.out b/ql/src/test/results/clientpositive/explain_logical.q.out
index 63f20509d5..2092540c04 100644
--- a/ql/src/test/results/clientpositive/explain_logical.q.out
+++ b/ql/src/test/results/clientpositive/explain_logical.q.out
@@ -3,38 +3,50 @@ PREHOOK: query: -- This test is used for testing EXPLAIN LOGICAL command
 -- Create some views
 CREATE VIEW V1 AS SELECT key, value from src
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@src
 POSTHOOK: query: -- This test is used for testing EXPLAIN LOGICAL command
 
 -- Create some views
 CREATE VIEW V1 AS SELECT key, value from src
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@V1
 PREHOOK: query: CREATE VIEW V2 AS SELECT ds, key, value FROM srcpart WHERE ds IS NOT NULL
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: CREATE VIEW V2 AS SELECT ds, key, value FROM srcpart WHERE ds IS NOT NULL
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@srcpart
 POSTHOOK: Output: default@V2
 PREHOOK: query: CREATE VIEW V3 AS 
   SELECT src1.key, src2.value FROM V2 src1 
   JOIN src src2 ON src1.key = src2.key WHERE src1.ds IS NOT NULL
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@src
+PREHOOK: Input: default@srcpart
 PREHOOK: Input: default@v2
 POSTHOOK: query: CREATE VIEW V3 AS 
   SELECT src1.key, src2.value FROM V2 src1 
   JOIN src src2 ON src1.key = src2.key WHERE src1.ds IS NOT NULL
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@src
+POSTHOOK: Input: default@srcpart
 POSTHOOK: Input: default@v2
 POSTHOOK: Output: default@V3
 PREHOOK: query: CREATE VIEW V4 AS 
   SELECT src1.key, src2.value as value1, src3.value as value2 
   FROM V1 src1 JOIN V2 src2 on src1.key = src2.key JOIN src src3 ON src2.key = src3.key
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@src
+PREHOOK: Input: default@srcpart
 PREHOOK: Input: default@v1
 PREHOOK: Input: default@v2
 POSTHOOK: query: CREATE VIEW V4 AS 
   SELECT src1.key, src2.value as value1, src3.value as value2 
   FROM V1 src1 JOIN V2 src2 on src1.key = src2.key JOIN src src3 ON src2.key = src3.key
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@src
+POSTHOOK: Input: default@srcpart
 POSTHOOK: Input: default@v1
 POSTHOOK: Input: default@v2
 POSTHOOK: Output: default@V4
@@ -647,10 +659,12 @@ PREHOOK: query: -- The table should show up in the explain logical even if none
 -- of the partitions are selected.
 CREATE VIEW V5 as SELECT * FROM srcpart where ds = '10'
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@srcpart
 POSTHOOK: query: -- The table should show up in the explain logical even if none
 -- of the partitions are selected.
 CREATE VIEW V5 as SELECT * FROM srcpart where ds = '10'
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@srcpart
 POSTHOOK: Output: default@V5
 PREHOOK: query: EXPLAIN LOGICAL SELECT * FROM V5
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/join_view.q.out b/ql/src/test/results/clientpositive/join_view.q.out
index a9d07984c4..1ec6846eef 100644
--- a/ql/src/test/results/clientpositive/join_view.q.out
+++ b/ql/src/test/results/clientpositive/join_view.q.out
@@ -20,10 +20,14 @@ PREHOOK: query: -- test join views: see HIVE-1989
 
 create view v as select invites.bar, invites2.foo, invites2.ds from invites join invites2 on invites.ds=invites2.ds
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@invites
+PREHOOK: Input: default@invites2
 POSTHOOK: query: -- test join views: see HIVE-1989
 
 create view v as select invites.bar, invites2.foo, invites2.ds from invites join invites2 on invites.ds=invites2.ds
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@invites
+POSTHOOK: Input: default@invites2
 POSTHOOK: Output: default@v
 PREHOOK: query: explain select * from v where ds='2011-09-01'
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/lateral_view_noalias.q.out b/ql/src/test/results/clientpositive/lateral_view_noalias.q.out
index c8cd5f2201..60bb349f6f 100644
--- a/ql/src/test/results/clientpositive/lateral_view_noalias.q.out
+++ b/ql/src/test/results/clientpositive/lateral_view_noalias.q.out
@@ -125,9 +125,11 @@ key2	200
 PREHOOK: query: -- view
 create view lv_noalias as SELECT myTab.* from src LATERAL VIEW explode(map('key1', 100, 'key2', 200)) myTab limit 2
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@src
 POSTHOOK: query: -- view
 create view lv_noalias as SELECT myTab.* from src LATERAL VIEW explode(map('key1', 100, 'key2', 200)) myTab limit 2
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@lv_noalias
 PREHOOK: query: explain select * from lv_noalias a join lv_noalias b on a.key=b.key
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/ppd_union_view.q.out b/ql/src/test/results/clientpositive/ppd_union_view.q.out
index 4d319d5f3e..41172fdc29 100644
--- a/ql/src/test/results/clientpositive/ppd_union_view.q.out
+++ b/ql/src/test/results/clientpositive/ppd_union_view.q.out
@@ -145,6 +145,9 @@ on t1_old.keymap = t1_mapping.keymap and
    t1_old.ds = t1_mapping.ds
 ) subq
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@t1_mapping
+PREHOOK: Input: default@t1_new
+PREHOOK: Input: default@t1_old
 POSTHOOK: query: create view t1 partitioned on (ds) as
 select * from
 (
@@ -155,6 +158,9 @@ on t1_old.keymap = t1_mapping.keymap and
    t1_old.ds = t1_mapping.ds
 ) subq
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@t1_mapping
+POSTHOOK: Input: default@t1_new
+POSTHOOK: Input: default@t1_old
 POSTHOOK: Output: default@t1
 POSTHOOK: Lineage: t1_mapping PARTITION(ds=2011-10-13).key SIMPLE []
 POSTHOOK: Lineage: t1_mapping PARTITION(ds=2011-10-13).keymap SIMPLE []
diff --git a/ql/src/test/results/clientpositive/ptf.q.out b/ql/src/test/results/clientpositive/ptf.q.out
index d86b705e91..1932b93ee7 100644
--- a/ql/src/test/results/clientpositive/ptf.q.out
+++ b/ql/src/test/results/clientpositive/ptf.q.out
@@ -766,6 +766,7 @@ sum(p_retailprice) as s
 from part 
 group by p_mfgr, p_brand
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@part
 POSTHOOK: query: -- 16. testViewAsTableInputToPTF
 create view IF NOT EXISTS mfgr_price_view as 
 select p_mfgr, p_brand, 
@@ -773,6 +774,7 @@ sum(p_retailprice) as s
 from part 
 group by p_mfgr, p_brand
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@part
 POSTHOOK: Output: default@mfgr_price_view
 PREHOOK: query: select p_mfgr, p_brand, s, 
 sum(s) over w1  as s1
diff --git a/ql/src/test/results/clientpositive/quotedid_basic.q.out b/ql/src/test/results/clientpositive/quotedid_basic.q.out
index 28d10721c9..926b158424 100644
--- a/ql/src/test/results/clientpositive/quotedid_basic.q.out
+++ b/ql/src/test/results/clientpositive/quotedid_basic.q.out
@@ -340,11 +340,13 @@ create view v1 as
 select `x+1```, `y&y`
 from t4 where `x+1``` < '200'
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@t4
 POSTHOOK: query: -- view
 create view v1 as 
 select `x+1```, `y&y`
 from t4 where `x+1``` < '200'
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@t4
 POSTHOOK: Output: default@v1
 POSTHOOK: Lineage: t4.x+1` SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: t4.y&y SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/show_create_table_view.q.out b/ql/src/test/results/clientpositive/show_create_table_view.q.out
index 9f5309e1be..1ee4aa282f 100644
--- a/ql/src/test/results/clientpositive/show_create_table_view.q.out
+++ b/ql/src/test/results/clientpositive/show_create_table_view.q.out
@@ -2,10 +2,12 @@ PREHOOK: query: -- Test SHOW CREATE TABLE on a view name.
 
 CREATE VIEW tmp_copy_src AS SELECT * FROM src
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@src
 POSTHOOK: query: -- Test SHOW CREATE TABLE on a view name.
 
 CREATE VIEW tmp_copy_src AS SELECT * FROM src
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@tmp_copy_src
 PREHOOK: query: SHOW CREATE TABLE tmp_copy_src
 PREHOOK: type: SHOW_CREATETABLE
diff --git a/ql/src/test/results/clientpositive/subquery_exists.q.out b/ql/src/test/results/clientpositive/subquery_exists.q.out
index 426510756b..26b9cfaf34 100644
--- a/ql/src/test/results/clientpositive/subquery_exists.q.out
+++ b/ql/src/test/results/clientpositive/subquery_exists.q.out
@@ -123,6 +123,7 @@ where exists
   from src a 
   where b.value = a.value  and a.key = b.key and a.value > 'val_9')
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@src
 POSTHOOK: query: -- view test
 create view cv1 as 
 select * 
@@ -132,6 +133,7 @@ where exists
   from src a 
   where b.value = a.value  and a.key = b.key and a.value > 'val_9')
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@cv1
 PREHOOK: query: select * from cv1
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/subquery_exists_having.q.out b/ql/src/test/results/clientpositive/subquery_exists_having.q.out
index 12b0bf47c7..4243e727c2 100644
--- a/ql/src/test/results/clientpositive/subquery_exists_having.q.out
+++ b/ql/src/test/results/clientpositive/subquery_exists_having.q.out
@@ -159,6 +159,7 @@ having exists
   where a.key = b.key and a.value > 'val_9'
   )
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@src
 POSTHOOK: query: -- view test
 create view cv1 as 
 select b.key, count(*) as c
@@ -170,6 +171,7 @@ having exists
   where a.key = b.key and a.value > 'val_9'
   )
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@cv1
 PREHOOK: query: select * from cv1
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/subquery_notin.q.out b/ql/src/test/results/clientpositive/subquery_notin.q.out
index 673a704969..b2d687bcf9 100644
--- a/ql/src/test/results/clientpositive/subquery_notin.q.out
+++ b/ql/src/test/results/clientpositive/subquery_notin.q.out
@@ -1388,18 +1388,22 @@ PREHOOK: query: -- null check
 create view T1_v as 
 select key from src where key <'11'
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@src
 POSTHOOK: query: -- null check
 create view T1_v as 
 select key from src where key <'11'
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@T1_v
 PREHOOK: query: create view T2_v as 
 select case when key > '104' then null else key end as key from T1_v
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@src
 PREHOOK: Input: default@t1_v
 POSTHOOK: query: create view T2_v as 
 select case when key > '104' then null else key end as key from T1_v
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@src
 POSTHOOK: Input: default@t1_v
 POSTHOOK: Output: default@T2_v
 PREHOOK: query: explain
diff --git a/ql/src/test/results/clientpositive/subquery_views.q.out b/ql/src/test/results/clientpositive/subquery_views.q.out
index 37d29a7969..f5bc3e7d0a 100644
--- a/ql/src/test/results/clientpositive/subquery_views.q.out
+++ b/ql/src/test/results/clientpositive/subquery_views.q.out
@@ -7,6 +7,7 @@ where exists
   from src a 
   where b.value = a.value  and a.key = b.key and a.value > 'val_9')
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@src
 POSTHOOK: query: -- exists test
 create view cv1 as 
 select * 
@@ -16,6 +17,7 @@ where exists
   from src a 
   where b.value = a.value  and a.key = b.key and a.value > 'val_9')
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@cv1
 PREHOOK: query: select * 
 from cv1 where cv1.key in (select key from cv1 c where c.key > '95')
@@ -44,6 +46,7 @@ where b.key not in
   where b.value = a.value  and a.key = b.key and a.value > 'val_11'
   )
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@src
 POSTHOOK: query: -- not in test
 create view cv2 as 
 select * 
@@ -54,6 +57,7 @@ where b.key not in
   where b.value = a.value  and a.key = b.key and a.value > 'val_11'
   )
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@cv2
 PREHOOK: query: select * 
 from cv2 where cv2.key in (select key from cv2 c where c.key < '11')
@@ -86,6 +90,7 @@ where b.key in (select key from src where src.key > '8')
 group by key, value
 having count(*) in (select count(*) from src s1 where s1.key > '9' group by s1.key )
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@src
 POSTHOOK: query: -- in where + having
 create view cv3 as
 select key, value, count(*) 
@@ -94,6 +99,7 @@ where b.key in (select key from src where src.key > '8')
 group by key, value
 having count(*) in (select count(*) from src s1 where s1.key > '9' group by s1.key )
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@cv3
 PREHOOK: query: select * from cv3
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/union_top_level.q.out b/ql/src/test/results/clientpositive/union_top_level.q.out
index 0e2d67a14a..64352d47bb 100644
--- a/ql/src/test/results/clientpositive/union_top_level.q.out
+++ b/ql/src/test/results/clientpositive/union_top_level.q.out
@@ -1286,6 +1286,7 @@ select key, 1 as value from src where key % 3 == 1 limit 3
 union all
 select key, 2 as value from src where key % 3 == 2 limit 3
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@src
 POSTHOOK: query: create view union_top_view as
 select key, 0 as value from src where key % 3 == 0 limit 3
 union all
@@ -1293,6 +1294,7 @@ select key, 1 as value from src where key % 3 == 1 limit 3
 union all
 select key, 2 as value from src where key % 3 == 2 limit 3
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@union_top_view
 POSTHOOK: Lineage: union_top.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), (src)src.FieldSchema(name:key, type:string, comment:default), (src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: union_top.key EXPRESSION [(src)src.FieldSchema(name:key, type:string, comment:default), (src)src.FieldSchema(name:key, type:string, comment:default), (src)src.FieldSchema(name:key, type:string, comment:default), ]
diff --git a/ql/src/test/results/clientpositive/unset_table_view_property.q.out b/ql/src/test/results/clientpositive/unset_table_view_property.q.out
index 2aa1daec2d..f9c0b397e8 100644
--- a/ql/src/test/results/clientpositive/unset_table_view_property.q.out
+++ b/ql/src/test/results/clientpositive/unset_table_view_property.q.out
@@ -193,9 +193,11 @@ rawDataSize	-1
 PREHOOK: query: -- UNSET VIEW PROPERTIES
 CREATE VIEW testView AS SELECT value FROM src WHERE key=86
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@src
 POSTHOOK: query: -- UNSET VIEW PROPERTIES
 CREATE VIEW testView AS SELECT value FROM src WHERE key=86
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@testView
 PREHOOK: query: ALTER VIEW testView SET TBLPROPERTIES ('propA'='100', 'propB'='200')
 PREHOOK: type: ALTERVIEW_PROPERTIES
diff --git a/ql/src/test/results/clientpositive/view.q.out b/ql/src/test/results/clientpositive/view.q.out
index 288ae47748..6f477cd22c 100644
--- a/ql/src/test/results/clientpositive/view.q.out
+++ b/ql/src/test/results/clientpositive/view.q.out
@@ -39,58 +39,78 @@ POSTHOOK: Output: db1@table2
 PREHOOK: query: -- relative reference, no alias
 CREATE VIEW v1 AS SELECT * FROM table1
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: db1@table1
 POSTHOOK: query: -- relative reference, no alias
 CREATE VIEW v1 AS SELECT * FROM table1
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: db1@table1
 POSTHOOK: Output: db1@v1
 PREHOOK: query: -- relative reference, aliased
 CREATE VIEW v2 AS SELECT t1.* FROM table1 t1
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: db1@table1
 POSTHOOK: query: -- relative reference, aliased
 CREATE VIEW v2 AS SELECT t1.* FROM table1 t1
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: db1@table1
 POSTHOOK: Output: db1@v2
 PREHOOK: query: -- relative reference, multiple tables
 CREATE VIEW v3 AS SELECT t1.*, t2.key k FROM table1 t1 JOIN table2 t2 ON t1.key = t2.key
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: db1@table1
+PREHOOK: Input: db1@table2
 POSTHOOK: query: -- relative reference, multiple tables
 CREATE VIEW v3 AS SELECT t1.*, t2.key k FROM table1 t1 JOIN table2 t2 ON t1.key = t2.key
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: db1@table1
+POSTHOOK: Input: db1@table2
 POSTHOOK: Output: db1@v3
 PREHOOK: query: -- absolute reference, no alias
 CREATE VIEW v4 AS SELECT * FROM db1.table1
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: db1@table1
 POSTHOOK: query: -- absolute reference, no alias
 CREATE VIEW v4 AS SELECT * FROM db1.table1
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: db1@table1
 POSTHOOK: Output: db1@v4
 PREHOOK: query: -- absolute reference, aliased
 CREATE VIEW v5 AS SELECT t1.* FROM db1.table1 t1
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: db1@table1
 POSTHOOK: query: -- absolute reference, aliased
 CREATE VIEW v5 AS SELECT t1.* FROM db1.table1 t1
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: db1@table1
 POSTHOOK: Output: db1@v5
 PREHOOK: query: -- absolute reference, multiple tables
 CREATE VIEW v6 AS SELECT t1.*, t2.key k FROM db1.table1 t1 JOIN db1.table2 t2 ON t1.key = t2.key
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: db1@table1
+PREHOOK: Input: db1@table2
 POSTHOOK: query: -- absolute reference, multiple tables
 CREATE VIEW v6 AS SELECT t1.*, t2.key k FROM db1.table1 t1 JOIN db1.table2 t2 ON t1.key = t2.key
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: db1@table1
+POSTHOOK: Input: db1@table2
 POSTHOOK: Output: db1@v6
 PREHOOK: query: -- relative reference, explicit column
 CREATE VIEW v7 AS SELECT key from table1
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: db1@table1
 POSTHOOK: query: -- relative reference, explicit column
 CREATE VIEW v7 AS SELECT key from table1
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: db1@table1
 POSTHOOK: Output: db1@v7
 PREHOOK: query: -- absolute reference, explicit column
 CREATE VIEW v8 AS SELECT key from db1.table1
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: db1@table1
 POSTHOOK: query: -- absolute reference, explicit column
 CREATE VIEW v8 AS SELECT key from db1.table1
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: db1@table1
 POSTHOOK: Output: db1@v8
 PREHOOK: query: CREATE DATABASE db2
 PREHOOK: type: CREATEDATABASE
diff --git a/ql/src/test/results/clientpositive/view_cast.q.out b/ql/src/test/results/clientpositive/view_cast.q.out
index ed1e410154..f9788ce299 100644
--- a/ql/src/test/results/clientpositive/view_cast.q.out
+++ b/ql/src/test/results/clientpositive/view_cast.q.out
@@ -43,8 +43,10 @@ POSTHOOK: query: DROP VIEW IF EXISTS aa_view_tw
 POSTHOOK: type: DROPVIEW
 PREHOOK: query: CREATE VIEW aa_view_tw AS SELECT ks_uid, sr_id, act, at_ks_uid, at_sr_uid, from_unixtime(CAST(CAST( tstamp as BIGINT)/1000 AS BIGINT),'yyyyMMdd') AS act_date, from_unixtime(CAST(CAST( original_tstamp AS BIGINT)/1000 AS BIGINT),'yyyyMMdd') AS content_creation_date FROM atab WHERE dt='20130312' AND nt='tw' AND ks_uid != at_ks_uid
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@atab
 POSTHOOK: query: CREATE VIEW aa_view_tw AS SELECT ks_uid, sr_id, act, at_ks_uid, at_sr_uid, from_unixtime(CAST(CAST( tstamp as BIGINT)/1000 AS BIGINT),'yyyyMMdd') AS act_date, from_unixtime(CAST(CAST( original_tstamp AS BIGINT)/1000 AS BIGINT),'yyyyMMdd') AS content_creation_date FROM atab WHERE dt='20130312' AND nt='tw' AND ks_uid != at_ks_uid
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@atab
 POSTHOOK: Output: default@aa_view_tw
 PREHOOK: query: DROP VIEW IF EXISTS joined_aa_view_tw
 PREHOOK: type: DROPVIEW
@@ -53,9 +55,13 @@ POSTHOOK: type: DROPVIEW
 PREHOOK: query: CREATE VIEW joined_aa_view_tw AS SELECT aa.ks_uid, aa.sr_id, aa.act, at_sr_uid, aa.act_date, aa.at_ks_uid, aa.content_creation_date, coalesce( other.ksc, 10.0) AS at_ksc, coalesce( self.ksc , 10.0 ) AS self_ksc FROM aa_view_tw aa LEFT OUTER JOIN ( SELECT ks_uid, csc AS ksc FROM mstab WHERE dt='20130311' ) self ON ( CAST(aa.ks_uid AS BIGINT) = CAST(self.ks_uid AS BIGINT) ) LEFT OUTER JOIN ( SELECT ks_uid, csc AS ksc FROM mstab WHERE dt='20130311' ) other ON ( CAST(aa.at_ks_uid AS BIGINT) = CAST(other.ks_uid AS BIGINT) )
 PREHOOK: type: CREATEVIEW
 PREHOOK: Input: default@aa_view_tw
+PREHOOK: Input: default@atab
+PREHOOK: Input: default@mstab
 POSTHOOK: query: CREATE VIEW joined_aa_view_tw AS SELECT aa.ks_uid, aa.sr_id, aa.act, at_sr_uid, aa.act_date, aa.at_ks_uid, aa.content_creation_date, coalesce( other.ksc, 10.0) AS at_ksc, coalesce( self.ksc , 10.0 ) AS self_ksc FROM aa_view_tw aa LEFT OUTER JOIN ( SELECT ks_uid, csc AS ksc FROM mstab WHERE dt='20130311' ) self ON ( CAST(aa.ks_uid AS BIGINT) = CAST(self.ks_uid AS BIGINT) ) LEFT OUTER JOIN ( SELECT ks_uid, csc AS ksc FROM mstab WHERE dt='20130311' ) other ON ( CAST(aa.at_ks_uid AS BIGINT) = CAST(other.ks_uid AS BIGINT) )
 POSTHOOK: type: CREATEVIEW
 POSTHOOK: Input: default@aa_view_tw
+POSTHOOK: Input: default@atab
+POSTHOOK: Input: default@mstab
 POSTHOOK: Output: default@joined_aa_view_tw
 PREHOOK: query: SELECT * FROM joined_aa_view_tw
 PREHOOK: type: QUERY
diff --git a/ql/src/test/results/clientpositive/view_inputs.q.out b/ql/src/test/results/clientpositive/view_inputs.q.out
index 5ea7589c32..0df9a4c1dd 100644
--- a/ql/src/test/results/clientpositive/view_inputs.q.out
+++ b/ql/src/test/results/clientpositive/view_inputs.q.out
@@ -2,16 +2,20 @@ PREHOOK: query: -- Tests that selecting from a view and another view that select
 
 CREATE VIEW test_view1 AS SELECT * FROM src
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@src
 POSTHOOK: query: -- Tests that selecting from a view and another view that selects from that same view
 
 CREATE VIEW test_view1 AS SELECT * FROM src
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@src
 POSTHOOK: Output: default@test_view1
 PREHOOK: query: CREATE VIEW test_view2 AS SELECT * FROM test_view1
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@src
 PREHOOK: Input: default@test_view1
 POSTHOOK: query: CREATE VIEW test_view2 AS SELECT * FROM test_view1
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@src
 POSTHOOK: Input: default@test_view1
 POSTHOOK: Output: default@test_view2
 PREHOOK: query: SELECT COUNT(*) FROM test_view1 a JOIN test_view2 b ON a.key = b.key
diff --git a/ql/src/test/results/clientpositive/windowing.q.out b/ql/src/test/results/clientpositive/windowing.q.out
index bbd169f086..9934a72f09 100644
--- a/ql/src/test/results/clientpositive/windowing.q.out
+++ b/ql/src/test/results/clientpositive/windowing.q.out
@@ -1018,6 +1018,7 @@ round(sum(p_retailprice),2) as s
 from part 
 group by p_mfgr, p_brand
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@part
 POSTHOOK: query: -- 22. testViewAsTableInputWithWindowing
 create view IF NOT EXISTS mfgr_price_view as 
 select p_mfgr, p_brand, 
@@ -1025,6 +1026,7 @@ round(sum(p_retailprice),2) as s
 from part 
 group by p_mfgr, p_brand
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@part
 POSTHOOK: Output: default@mfgr_price_view
 PREHOOK: query: select * 
 from (
@@ -1105,6 +1107,7 @@ sum(p_retailprice) over w1  as s
 from part 
 window w1 as (distribute by p_mfgr sort by p_name rows between 2 preceding and current row)
 PREHOOK: type: CREATEVIEW
+PREHOOK: Input: default@part
 POSTHOOK: query: -- 23. testCreateViewWithWindowingQuery
 create view IF NOT EXISTS mfgr_brand_price_view as 
 select p_mfgr, p_brand, 
@@ -1112,6 +1115,7 @@ sum(p_retailprice) over w1  as s
 from part 
 window w1 as (distribute by p_mfgr sort by p_name rows between 2 preceding and current row)
 POSTHOOK: type: CREATEVIEW
+POSTHOOK: Input: default@part
 POSTHOOK: Output: default@mfgr_brand_price_view
 PREHOOK: query: select * from mfgr_brand_price_view
 PREHOOK: type: QUERY
