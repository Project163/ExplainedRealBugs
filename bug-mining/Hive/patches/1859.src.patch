diff --git a/ql/src/java/org/apache/hadoop/hive/ql/plan/PartitionDesc.java b/ql/src/java/org/apache/hadoop/hive/ql/plan/PartitionDesc.java
index fc65bb6893..43cef5c95d 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/plan/PartitionDesc.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/plan/PartitionDesc.java
@@ -18,6 +18,9 @@
 
 package org.apache.hadoop.hive.ql.plan;
 
+import com.google.common.collect.Interner;
+import com.google.common.collect.Interners;
+
 import java.io.Serializable;
 import java.util.Enumeration;
 import java.util.LinkedHashMap;
@@ -42,7 +45,17 @@
  */
 @Explain(displayName = "Partition")
 public class PartitionDesc implements Serializable, Cloneable {
-  private static final long serialVersionUID = 2L;
+
+  static {
+    TABLE_INTERNER = Interners.newWeakInterner();
+    STRING_INTERNER = Interners.newWeakInterner();
+    CLASS_INTERNER = Interners.newWeakInterner();
+  }
+
+  private static final Interner<TableDesc> TABLE_INTERNER;
+  private static final Interner<String> STRING_INTERNER;
+  private static final Interner<Class<?>> CLASS_INTERNER;
+
   private TableDesc tableDesc;
   private LinkedHashMap<String, String> partSpec;
   private Class<? extends InputFormat> inputFileFormatClass;
@@ -55,28 +68,28 @@ public void setBaseFileName(String baseFileName) {
     this.baseFileName = baseFileName;
   }
 
-  public PartitionDesc() {
+  public PartitionDesc() {    
   }
 
   public PartitionDesc(final TableDesc table, final LinkedHashMap<String, String> partSpec) {
-    this.tableDesc = table;
+    setTableDesc(table);
     this.partSpec = partSpec;
   }
 
   public PartitionDesc(final Partition part) throws HiveException {
-    tableDesc = Utilities.getTableDesc(part.getTable());
-    properties = part.getMetadataFromPartitionSchema();
+    setTableDesc(Utilities.getTableDesc(part.getTable()));
+    setProperties(part.getMetadataFromPartitionSchema());
     partSpec = part.getSpec();
-    inputFileFormatClass = part.getInputFormatClass();
-    outputFileFormatClass = part.getOutputFormatClass();
+    setInputFileFormatClass(part.getInputFormatClass());
+    setOutputFileFormatClass(part.getOutputFormatClass());
   }
 
   public PartitionDesc(final Partition part,final TableDesc tblDesc) throws HiveException {
-    tableDesc = tblDesc;
-    properties = part.getSchemaFromTableSchema(tblDesc.getProperties()); // each partition maintains a large properties
+    setTableDesc(tblDesc);
+    setProperties(part.getSchemaFromTableSchema(tblDesc.getProperties())); // each partition maintains a large properties
     partSpec = part.getSpec();
-    inputFileFormatClass = part.getInputFormatClass();
-    outputFileFormatClass = part.getOutputFormatClass();
+    setOutputFileFormatClass(part.getInputFormatClass());
+    setOutputFileFormatClass(part.getOutputFormatClass());
   }
 
   @Explain(displayName = "")
@@ -85,7 +98,7 @@ public TableDesc getTableDesc() {
   }
 
   public void setTableDesc(TableDesc tableDesc) {
-    this.tableDesc = tableDesc;
+    this.tableDesc = TABLE_INTERNER.intern(tableDesc);
   }
 
   @Explain(displayName = "partition values")
@@ -122,7 +135,11 @@ public Deserializer getDeserializer(Configuration conf) throws Exception {
 
   public void setInputFileFormatClass(
       final Class<? extends InputFormat> inputFileFormatClass) {
-    this.inputFileFormatClass = inputFileFormatClass;
+    if (inputFileFormatClass == null) {
+      this.inputFileFormatClass = null;
+    } else {
+      this.inputFileFormatClass = (Class<? extends InputFormat>) CLASS_INTERNER.intern(inputFileFormatClass);
+    }
   }
 
   public Class<? extends HiveOutputFormat> getOutputFileFormatClass() {
@@ -133,8 +150,14 @@ public Class<? extends HiveOutputFormat> getOutputFileFormatClass() {
   }
 
   public void setOutputFileFormatClass(final Class<?> outputFileFormatClass) {
-    this.outputFileFormatClass = HiveFileFormatUtils
-        .getOutputFormatSubstitute(outputFileFormatClass,false);
+    Class<? extends HiveOutputFormat> outputClass = outputFileFormatClass == null ? null :
+      HiveFileFormatUtils.getOutputFormatSubstitute(outputFileFormatClass,false);
+    if (outputClass != null) {
+      this.outputFileFormatClass = (Class<? extends HiveOutputFormat>) 
+        CLASS_INTERNER.intern(outputClass);
+    } else {
+      this.outputFileFormatClass = outputClass;
+    }
   }
 
   @Explain(displayName = "properties", normalExplain = false)
@@ -157,6 +180,14 @@ public Properties getOverlayedProperties(){
 
   public void setProperties(final Properties properties) {
     this.properties = properties;
+    for (Enumeration<?> keys =  properties.propertyNames(); keys.hasMoreElements();) {
+      String key = (String) keys.nextElement();
+      String oldValue = properties.getProperty(key);
+      if (oldValue != null) {
+        String value = STRING_INTERNER.intern(oldValue);
+        properties.setProperty(key, value);
+      }
+    }
   }
 
   /**
diff --git a/ql/src/test/results/compiler/plan/case_sensitivity.q.xml b/ql/src/test/results/compiler/plan/case_sensitivity.q.xml
index 6c36c1bdc5..02c3d0697d 100644
--- a/ql/src/test/results/compiler/plan/case_sensitivity.q.xml
+++ b/ql/src/test/results/compiler/plan/case_sensitivity.q.xml
@@ -555,7 +555,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+         <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
           <void property="inputFileFormatClass"> 
            <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
           </void> 
@@ -1292,86 +1292,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-          <void property="inputFileFormatClass"> 
-           <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-          </void> 
-          <void property="outputFileFormatClass"> 
-           <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-          </void> 
-          <void property="properties"> 
-           <object class="java.util.Properties"> 
-            <void method="put"> 
-             <string>name</string> 
-             <string>default.src_thrift</string> 
-            </void> 
-            <void method="put"> 
-             <string>numFiles</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns.types</string> 
-             <string></string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.ddl</string> 
-             <string>struct src_thrift { }</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns</string> 
-             <string></string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.format</string> 
-             <string>org.apache.thrift.protocol.TBinaryProtocol</string> 
-            </void> 
-            <void method="put"> 
-             <string>rawDataSize</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>numRows</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.class</string> 
-             <string>org.apache.hadoop.hive.serde2.thrift.test.Complex</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_count</string> 
-             <string>-1</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.lib</string> 
-             <string>org.apache.hadoop.hive.serde2.thrift.ThriftDeserializer</string> 
-            </void> 
-            <void method="put"> 
-             <string>COLUMN_STATS_ACCURATE</string> 
-             <string>true</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.inputformat</string> 
-             <string>org.apache.hadoop.mapred.SequenceFileInputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>totalSize</string> 
-             <string>1606</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.outputformat</string> 
-             <string>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>location</string> 
-             #### A masked pattern was here #### 
-            </void> 
-            <void method="put"> 
-             <string>transient_lastDdlTime</string> 
-             #### A masked pattern was here #### 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <object idref="TableDesc1"/> 
         </void> 
        </object> 
       </void> 
diff --git a/ql/src/test/results/compiler/plan/cast1.q.xml b/ql/src/test/results/compiler/plan/cast1.q.xml
index 42533b9532..8e254aa5d8 100644
--- a/ql/src/test/results/compiler/plan/cast1.q.xml
+++ b/ql/src/test/results/compiler/plan/cast1.q.xml
@@ -68,7 +68,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+         <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
           <void property="inputFileFormatClass"> 
            <class>org.apache.hadoop.mapred.TextInputFormat</class> 
           </void> 
@@ -1086,82 +1086,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-          <void property="inputFileFormatClass"> 
-           <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-          </void> 
-          <void property="outputFileFormatClass"> 
-           <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-          </void> 
-          <void property="properties"> 
-           <object class="java.util.Properties"> 
-            <void method="put"> 
-             <string>name</string> 
-             <string>default.src</string> 
-            </void> 
-            <void method="put"> 
-             <string>numFiles</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns.types</string> 
-             <string>string:string</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.ddl</string> 
-             <string>struct src { string key, string value}</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.format</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns</string> 
-             <string>key,value</string> 
-            </void> 
-            <void method="put"> 
-             <string>rawDataSize</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>numRows</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_count</string> 
-             <string>-1</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.lib</string> 
-             <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-            </void> 
-            <void method="put"> 
-             <string>COLUMN_STATS_ACCURATE</string> 
-             <string>true</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.inputformat</string> 
-             <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>totalSize</string> 
-             <string>5812</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.outputformat</string> 
-             <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>location</string> 
-             #### A masked pattern was here #### 
-            </void> 
-            <void method="put"> 
-             <string>transient_lastDdlTime</string> 
-             #### A masked pattern was here #### 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <object idref="TableDesc0"/> 
         </void> 
        </object> 
       </void> 
diff --git a/ql/src/test/results/compiler/plan/groupby1.q.xml b/ql/src/test/results/compiler/plan/groupby1.q.xml
index 8d7c821a98..e257d4b22d 100755
--- a/ql/src/test/results/compiler/plan/groupby1.q.xml
+++ b/ql/src/test/results/compiler/plan/groupby1.q.xml
@@ -212,7 +212,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+         <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
           <void property="inputFileFormatClass"> 
            <class>org.apache.hadoop.mapred.TextInputFormat</class> 
           </void> 
@@ -358,7 +358,7 @@
                     </object> 
                    </void> 
                    <void property="keySerializeInfo"> 
-                    <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                    <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                      <void property="inputFileFormatClass"> 
                       <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
                      </void> 
@@ -421,7 +421,7 @@
                     </object> 
                    </void> 
                    <void property="valueSerializeInfo"> 
-                    <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                    <object id="TableDesc3" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                      <void property="inputFileFormatClass"> 
                       <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
                      </void> 
@@ -1029,82 +1029,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-          <void property="inputFileFormatClass"> 
-           <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-          </void> 
-          <void property="outputFileFormatClass"> 
-           <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-          </void> 
-          <void property="properties"> 
-           <object class="java.util.Properties"> 
-            <void method="put"> 
-             <string>name</string> 
-             <string>default.src</string> 
-            </void> 
-            <void method="put"> 
-             <string>numFiles</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns.types</string> 
-             <string>string:string</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.ddl</string> 
-             <string>struct src { string key, string value}</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.format</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns</string> 
-             <string>key,value</string> 
-            </void> 
-            <void method="put"> 
-             <string>rawDataSize</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>numRows</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_count</string> 
-             <string>-1</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.lib</string> 
-             <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-            </void> 
-            <void method="put"> 
-             <string>COLUMN_STATS_ACCURATE</string> 
-             <string>true</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.inputformat</string> 
-             <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>totalSize</string> 
-             <string>5812</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.outputformat</string> 
-             <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>location</string> 
-             #### A masked pattern was here #### 
-            </void> 
-            <void method="put"> 
-             <string>transient_lastDdlTime</string> 
-             #### A masked pattern was here #### 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <object idref="TableDesc1"/> 
         </void> 
        </object> 
       </void> 
@@ -1116,7 +1041,7 @@
        <boolean>true</boolean> 
       </void> 
       <void property="keyDesc"> 
-       <object idref="TableDesc1"/> 
+       <object idref="TableDesc2"/> 
       </void> 
       <void property="numReduceTasks"> 
        <int>-1</int> 
@@ -1455,7 +1380,7 @@
       </void> 
       <void property="tagToValueDesc"> 
        <void method="add"> 
-        <object idref="TableDesc2"/> 
+        <object idref="TableDesc3"/> 
        </void> 
       </void> 
      </object> 
diff --git a/ql/src/test/results/compiler/plan/groupby2.q.xml b/ql/src/test/results/compiler/plan/groupby2.q.xml
index 0092870a2a..6041e9ec5a 100755
--- a/ql/src/test/results/compiler/plan/groupby2.q.xml
+++ b/ql/src/test/results/compiler/plan/groupby2.q.xml
@@ -68,7 +68,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+         <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
           <void property="inputFileFormatClass"> 
            <class>org.apache.hadoop.mapred.TextInputFormat</class> 
           </void> 
@@ -257,7 +257,7 @@
                     </object> 
                    </void> 
                    <void property="keySerializeInfo"> 
-                    <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                    <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                      <void property="inputFileFormatClass"> 
                       <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
                      </void> 
@@ -333,7 +333,7 @@
                     </object> 
                    </void> 
                    <void property="valueSerializeInfo"> 
-                    <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                    <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                      <void property="inputFileFormatClass"> 
                       <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
                      </void> 
@@ -1154,82 +1154,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-          <void property="inputFileFormatClass"> 
-           <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-          </void> 
-          <void property="outputFileFormatClass"> 
-           <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-          </void> 
-          <void property="properties"> 
-           <object class="java.util.Properties"> 
-            <void method="put"> 
-             <string>name</string> 
-             <string>default.src</string> 
-            </void> 
-            <void method="put"> 
-             <string>numFiles</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns.types</string> 
-             <string>string:string</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.ddl</string> 
-             <string>struct src { string key, string value}</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.format</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns</string> 
-             <string>key,value</string> 
-            </void> 
-            <void method="put"> 
-             <string>rawDataSize</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>numRows</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_count</string> 
-             <string>-1</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.lib</string> 
-             <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-            </void> 
-            <void method="put"> 
-             <string>COLUMN_STATS_ACCURATE</string> 
-             <string>true</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.inputformat</string> 
-             <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>totalSize</string> 
-             <string>5812</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.outputformat</string> 
-             <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>location</string> 
-             #### A masked pattern was here #### 
-            </void> 
-            <void method="put"> 
-             <string>transient_lastDdlTime</string> 
-             #### A masked pattern was here #### 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <object idref="TableDesc0"/> 
         </void> 
        </object> 
       </void> 
@@ -1238,7 +1163,7 @@
     <void property="reduceWork"> 
      <object class="org.apache.hadoop.hive.ql.plan.ReduceWork"> 
       <void property="keyDesc"> 
-       <object idref="TableDesc0"/> 
+       <object idref="TableDesc1"/> 
       </void> 
       <void property="numReduceTasks"> 
        <int>-1</int> 
@@ -1736,7 +1661,7 @@
       </void> 
       <void property="tagToValueDesc"> 
        <void method="add"> 
-        <object idref="TableDesc1"/> 
+        <object idref="TableDesc2"/> 
        </void> 
       </void> 
      </object> 
diff --git a/ql/src/test/results/compiler/plan/groupby3.q.xml b/ql/src/test/results/compiler/plan/groupby3.q.xml
index 514e453922..cc88d5c2aa 100644
--- a/ql/src/test/results/compiler/plan/groupby3.q.xml
+++ b/ql/src/test/results/compiler/plan/groupby3.q.xml
@@ -68,7 +68,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+         <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
           <void property="inputFileFormatClass"> 
            <class>org.apache.hadoop.mapred.TextInputFormat</class> 
           </void> 
@@ -303,7 +303,7 @@
                     </object> 
                    </void> 
                    <void property="keySerializeInfo"> 
-                    <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                    <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                      <void property="inputFileFormatClass"> 
                       <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
                      </void> 
@@ -387,7 +387,7 @@
                     </object> 
                    </void> 
                    <void property="valueSerializeInfo"> 
-                    <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                    <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                      <void property="inputFileFormatClass"> 
                       <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
                      </void> 
@@ -1369,82 +1369,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-          <void property="inputFileFormatClass"> 
-           <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-          </void> 
-          <void property="outputFileFormatClass"> 
-           <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-          </void> 
-          <void property="properties"> 
-           <object class="java.util.Properties"> 
-            <void method="put"> 
-             <string>name</string> 
-             <string>default.src</string> 
-            </void> 
-            <void method="put"> 
-             <string>numFiles</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns.types</string> 
-             <string>string:string</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.ddl</string> 
-             <string>struct src { string key, string value}</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.format</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns</string> 
-             <string>key,value</string> 
-            </void> 
-            <void method="put"> 
-             <string>rawDataSize</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>numRows</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_count</string> 
-             <string>-1</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.lib</string> 
-             <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-            </void> 
-            <void method="put"> 
-             <string>COLUMN_STATS_ACCURATE</string> 
-             <string>true</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.inputformat</string> 
-             <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>totalSize</string> 
-             <string>5812</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.outputformat</string> 
-             <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>location</string> 
-             #### A masked pattern was here #### 
-            </void> 
-            <void method="put"> 
-             <string>transient_lastDdlTime</string> 
-             #### A masked pattern was here #### 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <object idref="TableDesc0"/> 
         </void> 
        </object> 
       </void> 
@@ -1453,7 +1378,7 @@
     <void property="reduceWork"> 
      <object class="org.apache.hadoop.hive.ql.plan.ReduceWork"> 
       <void property="keyDesc"> 
-       <object idref="TableDesc0"/> 
+       <object idref="TableDesc1"/> 
       </void> 
       <void property="numReduceTasks"> 
        <int>1</int> 
@@ -2131,7 +2056,7 @@
       </void> 
       <void property="tagToValueDesc"> 
        <void method="add"> 
-        <object idref="TableDesc1"/> 
+        <object idref="TableDesc2"/> 
        </void> 
       </void> 
      </object> 
diff --git a/ql/src/test/results/compiler/plan/groupby4.q.xml b/ql/src/test/results/compiler/plan/groupby4.q.xml
index 80183973a9..cf7b100ffb 100644
--- a/ql/src/test/results/compiler/plan/groupby4.q.xml
+++ b/ql/src/test/results/compiler/plan/groupby4.q.xml
@@ -68,7 +68,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+         <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
           <void property="inputFileFormatClass"> 
            <class>org.apache.hadoop.mapred.TextInputFormat</class> 
           </void> 
@@ -196,7 +196,7 @@
                     </object> 
                    </void> 
                    <void property="keySerializeInfo"> 
-                    <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                    <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                      <void property="inputFileFormatClass"> 
                       <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
                      </void> 
@@ -251,7 +251,7 @@
                     <object class="java.util.ArrayList"/> 
                    </void> 
                    <void property="valueSerializeInfo"> 
-                    <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                    <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                      <void property="inputFileFormatClass"> 
                       <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
                      </void> 
@@ -776,82 +776,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-          <void property="inputFileFormatClass"> 
-           <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-          </void> 
-          <void property="outputFileFormatClass"> 
-           <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-          </void> 
-          <void property="properties"> 
-           <object class="java.util.Properties"> 
-            <void method="put"> 
-             <string>name</string> 
-             <string>default.src</string> 
-            </void> 
-            <void method="put"> 
-             <string>numFiles</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns.types</string> 
-             <string>string:string</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.ddl</string> 
-             <string>struct src { string key, string value}</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.format</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns</string> 
-             <string>key,value</string> 
-            </void> 
-            <void method="put"> 
-             <string>rawDataSize</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>numRows</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_count</string> 
-             <string>-1</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.lib</string> 
-             <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-            </void> 
-            <void method="put"> 
-             <string>COLUMN_STATS_ACCURATE</string> 
-             <string>true</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.inputformat</string> 
-             <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>totalSize</string> 
-             <string>5812</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.outputformat</string> 
-             <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>location</string> 
-             #### A masked pattern was here #### 
-            </void> 
-            <void method="put"> 
-             <string>transient_lastDdlTime</string> 
-             #### A masked pattern was here #### 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <object idref="TableDesc0"/> 
         </void> 
        </object> 
       </void> 
@@ -860,7 +785,7 @@
     <void property="reduceWork"> 
      <object class="org.apache.hadoop.hive.ql.plan.ReduceWork"> 
       <void property="keyDesc"> 
-       <object idref="TableDesc0"/> 
+       <object idref="TableDesc1"/> 
       </void> 
       <void property="numReduceTasks"> 
        <int>-1</int> 
@@ -1124,7 +1049,7 @@
       </void> 
       <void property="tagToValueDesc"> 
        <void method="add"> 
-        <object idref="TableDesc1"/> 
+        <object idref="TableDesc2"/> 
        </void> 
       </void> 
      </object> 
diff --git a/ql/src/test/results/compiler/plan/groupby5.q.xml b/ql/src/test/results/compiler/plan/groupby5.q.xml
index 7764306883..8f022b3fa0 100644
--- a/ql/src/test/results/compiler/plan/groupby5.q.xml
+++ b/ql/src/test/results/compiler/plan/groupby5.q.xml
@@ -68,7 +68,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+         <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
           <void property="inputFileFormatClass"> 
            <class>org.apache.hadoop.mapred.TextInputFormat</class> 
           </void> 
@@ -214,7 +214,7 @@
                     </object> 
                    </void> 
                    <void property="keySerializeInfo"> 
-                    <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                    <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                      <void property="inputFileFormatClass"> 
                       <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
                      </void> 
@@ -277,7 +277,7 @@
                     </object> 
                    </void> 
                    <void property="valueSerializeInfo"> 
-                    <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                    <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                      <void property="inputFileFormatClass"> 
                       <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
                      </void> 
@@ -882,82 +882,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-          <void property="inputFileFormatClass"> 
-           <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-          </void> 
-          <void property="outputFileFormatClass"> 
-           <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-          </void> 
-          <void property="properties"> 
-           <object class="java.util.Properties"> 
-            <void method="put"> 
-             <string>name</string> 
-             <string>default.src</string> 
-            </void> 
-            <void method="put"> 
-             <string>numFiles</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns.types</string> 
-             <string>string:string</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.ddl</string> 
-             <string>struct src { string key, string value}</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.format</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns</string> 
-             <string>key,value</string> 
-            </void> 
-            <void method="put"> 
-             <string>rawDataSize</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>numRows</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_count</string> 
-             <string>-1</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.lib</string> 
-             <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-            </void> 
-            <void method="put"> 
-             <string>COLUMN_STATS_ACCURATE</string> 
-             <string>true</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.inputformat</string> 
-             <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>totalSize</string> 
-             <string>5812</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.outputformat</string> 
-             <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>location</string> 
-             #### A masked pattern was here #### 
-            </void> 
-            <void method="put"> 
-             <string>transient_lastDdlTime</string> 
-             #### A masked pattern was here #### 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <object idref="TableDesc0"/> 
         </void> 
        </object> 
       </void> 
@@ -966,7 +891,7 @@
     <void property="reduceWork"> 
      <object class="org.apache.hadoop.hive.ql.plan.ReduceWork"> 
       <void property="keyDesc"> 
-       <object idref="TableDesc0"/> 
+       <object idref="TableDesc1"/> 
       </void> 
       <void property="numReduceTasks"> 
        <int>-1</int> 
@@ -1334,7 +1259,7 @@
       </void> 
       <void property="tagToValueDesc"> 
        <void method="add"> 
-        <object idref="TableDesc1"/> 
+        <object idref="TableDesc2"/> 
        </void> 
       </void> 
      </object> 
diff --git a/ql/src/test/results/compiler/plan/groupby6.q.xml b/ql/src/test/results/compiler/plan/groupby6.q.xml
index 39679abd99..ff372d3cc3 100644
--- a/ql/src/test/results/compiler/plan/groupby6.q.xml
+++ b/ql/src/test/results/compiler/plan/groupby6.q.xml
@@ -68,7 +68,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+         <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
           <void property="inputFileFormatClass"> 
            <class>org.apache.hadoop.mapred.TextInputFormat</class> 
           </void> 
@@ -196,7 +196,7 @@
                     </object> 
                    </void> 
                    <void property="keySerializeInfo"> 
-                    <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                    <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                      <void property="inputFileFormatClass"> 
                       <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
                      </void> 
@@ -251,7 +251,7 @@
                     <object class="java.util.ArrayList"/> 
                    </void> 
                    <void property="valueSerializeInfo"> 
-                    <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                    <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                      <void property="inputFileFormatClass"> 
                       <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
                      </void> 
@@ -776,82 +776,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-          <void property="inputFileFormatClass"> 
-           <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-          </void> 
-          <void property="outputFileFormatClass"> 
-           <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-          </void> 
-          <void property="properties"> 
-           <object class="java.util.Properties"> 
-            <void method="put"> 
-             <string>name</string> 
-             <string>default.src</string> 
-            </void> 
-            <void method="put"> 
-             <string>numFiles</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns.types</string> 
-             <string>string:string</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.ddl</string> 
-             <string>struct src { string key, string value}</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.format</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns</string> 
-             <string>key,value</string> 
-            </void> 
-            <void method="put"> 
-             <string>rawDataSize</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>numRows</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_count</string> 
-             <string>-1</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.lib</string> 
-             <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-            </void> 
-            <void method="put"> 
-             <string>COLUMN_STATS_ACCURATE</string> 
-             <string>true</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.inputformat</string> 
-             <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>totalSize</string> 
-             <string>5812</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.outputformat</string> 
-             <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>location</string> 
-             #### A masked pattern was here #### 
-            </void> 
-            <void method="put"> 
-             <string>transient_lastDdlTime</string> 
-             #### A masked pattern was here #### 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <object idref="TableDesc0"/> 
         </void> 
        </object> 
       </void> 
@@ -860,7 +785,7 @@
     <void property="reduceWork"> 
      <object class="org.apache.hadoop.hive.ql.plan.ReduceWork"> 
       <void property="keyDesc"> 
-       <object idref="TableDesc0"/> 
+       <object idref="TableDesc1"/> 
       </void> 
       <void property="numReduceTasks"> 
        <int>-1</int> 
@@ -1124,7 +1049,7 @@
       </void> 
       <void property="tagToValueDesc"> 
        <void method="add"> 
-        <object idref="TableDesc1"/> 
+        <object idref="TableDesc2"/> 
        </void> 
       </void> 
      </object> 
diff --git a/ql/src/test/results/compiler/plan/input1.q.xml b/ql/src/test/results/compiler/plan/input1.q.xml
index 4f93d5dcd7..4365afe275 100755
--- a/ql/src/test/results/compiler/plan/input1.q.xml
+++ b/ql/src/test/results/compiler/plan/input1.q.xml
@@ -319,7 +319,7 @@
                          </object> 
                         </void> 
                         <void property="tableDesc"> 
-                         <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                           <void property="inputFileFormatClass"> 
                            <class>org.apache.hadoop.mapred.TextInputFormat</class> 
                           </void> 
@@ -417,7 +417,62 @@
                    <boolean>true</boolean> 
                   </void> 
                   <void property="table"> 
-                   <object idref="TableDesc0"/> 
+                   <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                    <void property="inputFileFormatClass"> 
+                     <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                    </void> 
+                    <void property="outputFileFormatClass"> 
+                     <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                    </void> 
+                    <void property="properties"> 
+                     <object class="java.util.Properties"> 
+                      <void method="put"> 
+                       <string>name</string> 
+                       <string>default.dest1</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>columns.types</string> 
+                       <string>string:string</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>serialization.ddl</string> 
+                       <string>struct dest1 { string key, string value}</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>serialization.format</string> 
+                       <string>1</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>columns</string> 
+                       <string>key,value</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>bucket_count</string> 
+                       <string>-1</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>serialization.lib</string> 
+                       <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>file.inputformat</string> 
+                       <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>file.outputformat</string> 
+                       <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>location</string> 
+                       #### A masked pattern was here #### 
+                      </void> 
+                      <void method="put"> 
+                       <string>transient_lastDdlTime</string> 
+                       #### A masked pattern was here #### 
+                      </void> 
+                     </object> 
+                    </void> 
+                   </object> 
                   </void> 
                  </object> 
                 </void> 
@@ -551,7 +606,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+         <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
           <void property="inputFileFormatClass"> 
            <class>org.apache.hadoop.mapred.TextInputFormat</class> 
           </void> 
@@ -1091,82 +1146,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-          <void property="inputFileFormatClass"> 
-           <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-          </void> 
-          <void property="outputFileFormatClass"> 
-           <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-          </void> 
-          <void property="properties"> 
-           <object class="java.util.Properties"> 
-            <void method="put"> 
-             <string>name</string> 
-             <string>default.src</string> 
-            </void> 
-            <void method="put"> 
-             <string>numFiles</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns.types</string> 
-             <string>string:string</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.ddl</string> 
-             <string>struct src { string key, string value}</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.format</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns</string> 
-             <string>key,value</string> 
-            </void> 
-            <void method="put"> 
-             <string>rawDataSize</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>numRows</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_count</string> 
-             <string>-1</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.lib</string> 
-             <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-            </void> 
-            <void method="put"> 
-             <string>COLUMN_STATS_ACCURATE</string> 
-             <string>true</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.inputformat</string> 
-             <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>totalSize</string> 
-             <string>5812</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.outputformat</string> 
-             <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>location</string> 
-             #### A masked pattern was here #### 
-            </void> 
-            <void method="put"> 
-             <string>transient_lastDdlTime</string> 
-             #### A masked pattern was here #### 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <object idref="TableDesc1"/> 
         </void> 
        </object> 
       </void> 
diff --git a/ql/src/test/results/compiler/plan/input2.q.xml b/ql/src/test/results/compiler/plan/input2.q.xml
index 71e32cf9ec..5b17981e78 100755
--- a/ql/src/test/results/compiler/plan/input2.q.xml
+++ b/ql/src/test/results/compiler/plan/input2.q.xml
@@ -319,7 +319,7 @@
                          </object> 
                         </void> 
                         <void property="tableDesc"> 
-                         <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                           <void property="inputFileFormatClass"> 
                            <class>org.apache.hadoop.mapred.TextInputFormat</class> 
                           </void> 
@@ -417,7 +417,62 @@
                    <boolean>true</boolean> 
                   </void> 
                   <void property="table"> 
-                   <object idref="TableDesc0"/> 
+                   <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                    <void property="inputFileFormatClass"> 
+                     <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                    </void> 
+                    <void property="outputFileFormatClass"> 
+                     <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                    </void> 
+                    <void property="properties"> 
+                     <object class="java.util.Properties"> 
+                      <void method="put"> 
+                       <string>name</string> 
+                       <string>default.dest1</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>columns.types</string> 
+                       <string>string:string</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>serialization.ddl</string> 
+                       <string>struct dest1 { string key, string value}</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>serialization.format</string> 
+                       <string>1</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>columns</string> 
+                       <string>key,value</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>bucket_count</string> 
+                       <string>-1</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>serialization.lib</string> 
+                       <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>file.inputformat</string> 
+                       <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>file.outputformat</string> 
+                       <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>location</string> 
+                       #### A masked pattern was here #### 
+                      </void> 
+                      <void method="put"> 
+                       <string>transient_lastDdlTime</string> 
+                       #### A masked pattern was here #### 
+                      </void> 
+                     </object> 
+                    </void> 
+                   </object> 
                   </void> 
                  </object> 
                 </void> 
@@ -1514,7 +1569,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+         <object id="TableDesc3" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
           <void property="inputFileFormatClass"> 
            <class>org.apache.hadoop.mapred.TextInputFormat</class> 
           </void> 
@@ -2562,82 +2617,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-          <void property="inputFileFormatClass"> 
-           <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-          </void> 
-          <void property="outputFileFormatClass"> 
-           <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-          </void> 
-          <void property="properties"> 
-           <object class="java.util.Properties"> 
-            <void method="put"> 
-             <string>name</string> 
-             <string>default.src</string> 
-            </void> 
-            <void method="put"> 
-             <string>numFiles</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns.types</string> 
-             <string>string:string</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.ddl</string> 
-             <string>struct src { string key, string value}</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.format</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns</string> 
-             <string>key,value</string> 
-            </void> 
-            <void method="put"> 
-             <string>rawDataSize</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>numRows</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_count</string> 
-             <string>-1</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.lib</string> 
-             <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-            </void> 
-            <void method="put"> 
-             <string>COLUMN_STATS_ACCURATE</string> 
-             <string>true</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.inputformat</string> 
-             <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>totalSize</string> 
-             <string>5812</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.outputformat</string> 
-             <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>location</string> 
-             #### A masked pattern was here #### 
-            </void> 
-            <void method="put"> 
-             <string>transient_lastDdlTime</string> 
-             #### A masked pattern was here #### 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <object idref="TableDesc3"/> 
         </void> 
        </object> 
       </void> 
diff --git a/ql/src/test/results/compiler/plan/input20.q.xml b/ql/src/test/results/compiler/plan/input20.q.xml
index 398c606990..912e9e3f17 100644
--- a/ql/src/test/results/compiler/plan/input20.q.xml
+++ b/ql/src/test/results/compiler/plan/input20.q.xml
@@ -68,7 +68,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+         <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
           <void property="inputFileFormatClass"> 
            <class>org.apache.hadoop.mapred.TextInputFormat</class> 
           </void> 
@@ -211,7 +211,7 @@
                     </object> 
                    </void> 
                    <void property="keySerializeInfo"> 
-                    <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                    <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                      <void property="inputFileFormatClass"> 
                       <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
                      </void> 
@@ -291,7 +291,7 @@
                     </object> 
                    </void> 
                    <void property="valueSerializeInfo"> 
-                    <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                    <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                      <void property="inputFileFormatClass"> 
                       <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
                      </void> 
@@ -873,82 +873,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-          <void property="inputFileFormatClass"> 
-           <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-          </void> 
-          <void property="outputFileFormatClass"> 
-           <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-          </void> 
-          <void property="properties"> 
-           <object class="java.util.Properties"> 
-            <void method="put"> 
-             <string>name</string> 
-             <string>default.src</string> 
-            </void> 
-            <void method="put"> 
-             <string>numFiles</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns.types</string> 
-             <string>string:string</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.ddl</string> 
-             <string>struct src { string key, string value}</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.format</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns</string> 
-             <string>key,value</string> 
-            </void> 
-            <void method="put"> 
-             <string>rawDataSize</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>numRows</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_count</string> 
-             <string>-1</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.lib</string> 
-             <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-            </void> 
-            <void method="put"> 
-             <string>COLUMN_STATS_ACCURATE</string> 
-             <string>true</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.inputformat</string> 
-             <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>totalSize</string> 
-             <string>5812</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.outputformat</string> 
-             <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>location</string> 
-             #### A masked pattern was here #### 
-            </void> 
-            <void method="put"> 
-             <string>transient_lastDdlTime</string> 
-             #### A masked pattern was here #### 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <object idref="TableDesc0"/> 
         </void> 
        </object> 
       </void> 
@@ -957,7 +882,7 @@
     <void property="reduceWork"> 
      <object class="org.apache.hadoop.hive.ql.plan.ReduceWork"> 
       <void property="keyDesc"> 
-       <object idref="TableDesc0"/> 
+       <object idref="TableDesc1"/> 
       </void> 
       <void property="numReduceTasks"> 
        <int>-1</int> 
@@ -1418,7 +1343,7 @@
       </void> 
       <void property="tagToValueDesc"> 
        <void method="add"> 
-        <object idref="TableDesc1"/> 
+        <object idref="TableDesc2"/> 
        </void> 
       </void> 
      </object> 
diff --git a/ql/src/test/results/compiler/plan/input3.q.xml b/ql/src/test/results/compiler/plan/input3.q.xml
index 2a4031e0ee..4f2eafef1e 100755
--- a/ql/src/test/results/compiler/plan/input3.q.xml
+++ b/ql/src/test/results/compiler/plan/input3.q.xml
@@ -319,7 +319,7 @@
                          </object> 
                         </void> 
                         <void property="tableDesc"> 
-                         <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                           <void property="inputFileFormatClass"> 
                            <class>org.apache.hadoop.mapred.TextInputFormat</class> 
                           </void> 
@@ -417,7 +417,62 @@
                    <boolean>true</boolean> 
                   </void> 
                   <void property="table"> 
-                   <object idref="TableDesc0"/> 
+                   <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                    <void property="inputFileFormatClass"> 
+                     <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                    </void> 
+                    <void property="outputFileFormatClass"> 
+                     <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                    </void> 
+                    <void property="properties"> 
+                     <object class="java.util.Properties"> 
+                      <void method="put"> 
+                       <string>name</string> 
+                       <string>default.dest1</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>columns.types</string> 
+                       <string>string:string</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>serialization.ddl</string> 
+                       <string>struct dest1 { string key, string value}</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>serialization.format</string> 
+                       <string>1</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>columns</string> 
+                       <string>key,value</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>bucket_count</string> 
+                       <string>-1</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>serialization.lib</string> 
+                       <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>file.inputformat</string> 
+                       <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>file.outputformat</string> 
+                       <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>location</string> 
+                       #### A masked pattern was here #### 
+                      </void> 
+                      <void method="put"> 
+                       <string>transient_lastDdlTime</string> 
+                       #### A masked pattern was here #### 
+                      </void> 
+                     </object> 
+                    </void> 
+                   </object> 
                   </void> 
                  </object> 
                 </void> 
@@ -794,7 +849,7 @@
                          </object> 
                         </void> 
                         <void property="tableDesc"> 
-                         <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                           <void property="inputFileFormatClass"> 
                            <class>org.apache.hadoop.mapred.TextInputFormat</class> 
                           </void> 
@@ -892,7 +947,62 @@
                    <boolean>true</boolean> 
                   </void> 
                   <void property="table"> 
-                   <object idref="TableDesc1"/> 
+                   <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                    <void property="inputFileFormatClass"> 
+                     <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                    </void> 
+                    <void property="outputFileFormatClass"> 
+                     <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                    </void> 
+                    <void property="properties"> 
+                     <object class="java.util.Properties"> 
+                      <void method="put"> 
+                       <string>name</string> 
+                       <string>default.dest2</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>columns.types</string> 
+                       <string>string:string</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>serialization.ddl</string> 
+                       <string>struct dest2 { string key, string value}</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>serialization.format</string> 
+                       <string>1</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>columns</string> 
+                       <string>key,value</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>bucket_count</string> 
+                       <string>-1</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>serialization.lib</string> 
+                       <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>file.inputformat</string> 
+                       <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>file.outputformat</string> 
+                       <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>location</string> 
+                       #### A masked pattern was here #### 
+                      </void> 
+                      <void method="put"> 
+                       <string>transient_lastDdlTime</string> 
+                       #### A masked pattern was here #### 
+                      </void> 
+                     </object> 
+                    </void> 
+                   </object> 
                   </void> 
                  </object> 
                 </void> 
@@ -1273,7 +1383,7 @@
                          </object> 
                         </void> 
                         <void property="tableDesc"> 
-                         <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                           <void property="inputFileFormatClass"> 
                            <class>org.apache.hadoop.mapred.TextInputFormat</class> 
                           </void> 
@@ -1380,7 +1490,62 @@
                    <boolean>true</boolean> 
                   </void> 
                   <void property="table"> 
-                   <object idref="TableDesc2"/> 
+                   <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                    <void property="inputFileFormatClass"> 
+                     <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                    </void> 
+                    <void property="outputFileFormatClass"> 
+                     <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                    </void> 
+                    <void property="properties"> 
+                     <object class="java.util.Properties"> 
+                      <void method="put"> 
+                       <string>name</string> 
+                       <string>default.dest3</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>columns.types</string> 
+                       <string>string:string</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>serialization.ddl</string> 
+                       <string>struct dest3 { string key, string value}</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>serialization.format</string> 
+                       <string>1</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>columns</string> 
+                       <string>key,value</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>bucket_count</string> 
+                       <string>-1</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>serialization.lib</string> 
+                       <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>file.inputformat</string> 
+                       <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>file.outputformat</string> 
+                       <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>location</string> 
+                       #### A masked pattern was here #### 
+                      </void> 
+                      <void method="put"> 
+                       <string>transient_lastDdlTime</string> 
+                       #### A masked pattern was here #### 
+                      </void> 
+                     </object> 
+                    </void> 
+                   </object> 
                   </void> 
                  </object> 
                 </void> 
@@ -1854,7 +2019,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+         <object id="TableDesc4" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
           <void property="inputFileFormatClass"> 
            <class>org.apache.hadoop.mapred.TextInputFormat</class> 
           </void> 
@@ -3141,82 +3306,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-          <void property="inputFileFormatClass"> 
-           <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-          </void> 
-          <void property="outputFileFormatClass"> 
-           <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-          </void> 
-          <void property="properties"> 
-           <object class="java.util.Properties"> 
-            <void method="put"> 
-             <string>name</string> 
-             <string>default.src</string> 
-            </void> 
-            <void method="put"> 
-             <string>numFiles</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns.types</string> 
-             <string>string:string</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.ddl</string> 
-             <string>struct src { string key, string value}</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.format</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns</string> 
-             <string>key,value</string> 
-            </void> 
-            <void method="put"> 
-             <string>rawDataSize</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>numRows</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_count</string> 
-             <string>-1</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.lib</string> 
-             <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-            </void> 
-            <void method="put"> 
-             <string>COLUMN_STATS_ACCURATE</string> 
-             <string>true</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.inputformat</string> 
-             <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>totalSize</string> 
-             <string>5812</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.outputformat</string> 
-             <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>location</string> 
-             #### A masked pattern was here #### 
-            </void> 
-            <void method="put"> 
-             <string>transient_lastDdlTime</string> 
-             #### A masked pattern was here #### 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <object idref="TableDesc4"/> 
         </void> 
        </object> 
       </void> 
diff --git a/ql/src/test/results/compiler/plan/input4.q.xml b/ql/src/test/results/compiler/plan/input4.q.xml
index b0c9441dfe..47fe9ffe47 100755
--- a/ql/src/test/results/compiler/plan/input4.q.xml
+++ b/ql/src/test/results/compiler/plan/input4.q.xml
@@ -212,7 +212,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+         <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
           <void property="inputFileFormatClass"> 
            <class>org.apache.hadoop.mapred.TextInputFormat</class> 
           </void> 
@@ -358,7 +358,7 @@
                        </object> 
                       </void> 
                       <void property="keySerializeInfo"> 
-                       <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                       <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                         <void property="inputFileFormatClass"> 
                          <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
                         </void> 
@@ -438,7 +438,7 @@
                        </object> 
                       </void> 
                       <void property="valueSerializeInfo"> 
-                       <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                       <object id="TableDesc3" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                         <void property="inputFileFormatClass"> 
                          <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
                         </void> 
@@ -1026,82 +1026,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-          <void property="inputFileFormatClass"> 
-           <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-          </void> 
-          <void property="outputFileFormatClass"> 
-           <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-          </void> 
-          <void property="properties"> 
-           <object class="java.util.Properties"> 
-            <void method="put"> 
-             <string>name</string> 
-             <string>default.src</string> 
-            </void> 
-            <void method="put"> 
-             <string>numFiles</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns.types</string> 
-             <string>string:string</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.ddl</string> 
-             <string>struct src { string key, string value}</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.format</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns</string> 
-             <string>key,value</string> 
-            </void> 
-            <void method="put"> 
-             <string>rawDataSize</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>numRows</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_count</string> 
-             <string>-1</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.lib</string> 
-             <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-            </void> 
-            <void method="put"> 
-             <string>COLUMN_STATS_ACCURATE</string> 
-             <string>true</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.inputformat</string> 
-             <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>totalSize</string> 
-             <string>5812</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.outputformat</string> 
-             <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>location</string> 
-             #### A masked pattern was here #### 
-            </void> 
-            <void method="put"> 
-             <string>transient_lastDdlTime</string> 
-             #### A masked pattern was here #### 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <object idref="TableDesc1"/> 
         </void> 
        </object> 
       </void> 
@@ -1113,7 +1038,7 @@
        <boolean>true</boolean> 
       </void> 
       <void property="keyDesc"> 
-       <object idref="TableDesc1"/> 
+       <object idref="TableDesc2"/> 
       </void> 
       <void property="numReduceTasks"> 
        <int>-1</int> 
@@ -1389,7 +1314,7 @@
       </void> 
       <void property="tagToValueDesc"> 
        <void method="add"> 
-        <object idref="TableDesc2"/> 
+        <object idref="TableDesc3"/> 
        </void> 
       </void> 
      </object> 
diff --git a/ql/src/test/results/compiler/plan/input5.q.xml b/ql/src/test/results/compiler/plan/input5.q.xml
index 13fabfc63c..31b599c035 100644
--- a/ql/src/test/results/compiler/plan/input5.q.xml
+++ b/ql/src/test/results/compiler/plan/input5.q.xml
@@ -216,7 +216,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+         <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
           <void property="inputFileFormatClass"> 
            <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
           </void> 
@@ -363,7 +363,7 @@
                     </object> 
                    </void> 
                    <void property="keySerializeInfo"> 
-                    <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                    <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                      <void property="inputFileFormatClass"> 
                       <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
                      </void> 
@@ -443,7 +443,7 @@
                     </object> 
                    </void> 
                    <void property="valueSerializeInfo"> 
-                    <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                    <object id="TableDesc3" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                      <void property="inputFileFormatClass"> 
                       <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
                      </void> 
@@ -1092,86 +1092,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-          <void property="inputFileFormatClass"> 
-           <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-          </void> 
-          <void property="outputFileFormatClass"> 
-           <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-          </void> 
-          <void property="properties"> 
-           <object class="java.util.Properties"> 
-            <void method="put"> 
-             <string>name</string> 
-             <string>default.src_thrift</string> 
-            </void> 
-            <void method="put"> 
-             <string>numFiles</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns.types</string> 
-             <string></string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.ddl</string> 
-             <string>struct src_thrift { }</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns</string> 
-             <string></string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.format</string> 
-             <string>org.apache.thrift.protocol.TBinaryProtocol</string> 
-            </void> 
-            <void method="put"> 
-             <string>rawDataSize</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>numRows</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.class</string> 
-             <string>org.apache.hadoop.hive.serde2.thrift.test.Complex</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_count</string> 
-             <string>-1</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.lib</string> 
-             <string>org.apache.hadoop.hive.serde2.thrift.ThriftDeserializer</string> 
-            </void> 
-            <void method="put"> 
-             <string>COLUMN_STATS_ACCURATE</string> 
-             <string>true</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.inputformat</string> 
-             <string>org.apache.hadoop.mapred.SequenceFileInputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>totalSize</string> 
-             <string>1606</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.outputformat</string> 
-             <string>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>location</string> 
-             #### A masked pattern was here #### 
-            </void> 
-            <void method="put"> 
-             <string>transient_lastDdlTime</string> 
-             #### A masked pattern was here #### 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <object idref="TableDesc1"/> 
         </void> 
        </object> 
       </void> 
@@ -1183,7 +1104,7 @@
        <boolean>true</boolean> 
       </void> 
       <void property="keyDesc"> 
-       <object idref="TableDesc1"/> 
+       <object idref="TableDesc2"/> 
       </void> 
       <void property="numReduceTasks"> 
        <int>-1</int> 
@@ -1459,7 +1380,7 @@
       </void> 
       <void property="tagToValueDesc"> 
        <void method="add"> 
-        <object idref="TableDesc2"/> 
+        <object idref="TableDesc3"/> 
        </void> 
       </void> 
      </object> 
diff --git a/ql/src/test/results/compiler/plan/input6.q.xml b/ql/src/test/results/compiler/plan/input6.q.xml
index 6d3bb230ad..d27978c0de 100644
--- a/ql/src/test/results/compiler/plan/input6.q.xml
+++ b/ql/src/test/results/compiler/plan/input6.q.xml
@@ -319,7 +319,7 @@
                          </object> 
                         </void> 
                         <void property="tableDesc"> 
-                         <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                           <void property="inputFileFormatClass"> 
                            <class>org.apache.hadoop.mapred.TextInputFormat</class> 
                           </void> 
@@ -417,7 +417,62 @@
                    <boolean>true</boolean> 
                   </void> 
                   <void property="table"> 
-                   <object idref="TableDesc0"/> 
+                   <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                    <void property="inputFileFormatClass"> 
+                     <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                    </void> 
+                    <void property="outputFileFormatClass"> 
+                     <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                    </void> 
+                    <void property="properties"> 
+                     <object class="java.util.Properties"> 
+                      <void method="put"> 
+                       <string>name</string> 
+                       <string>default.dest1</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>columns.types</string> 
+                       <string>string:string</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>serialization.ddl</string> 
+                       <string>struct dest1 { string key, string value}</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>serialization.format</string> 
+                       <string>1</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>columns</string> 
+                       <string>key,value</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>bucket_count</string> 
+                       <string>-1</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>serialization.lib</string> 
+                       <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>file.inputformat</string> 
+                       <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>file.outputformat</string> 
+                       <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>location</string> 
+                       #### A masked pattern was here #### 
+                      </void> 
+                      <void method="put"> 
+                       <string>transient_lastDdlTime</string> 
+                       #### A masked pattern was here #### 
+                      </void> 
+                     </object> 
+                    </void> 
+                   </object> 
                   </void> 
                  </object> 
                 </void> 
@@ -551,7 +606,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+         <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
           <void property="inputFileFormatClass"> 
            <class>org.apache.hadoop.mapred.TextInputFormat</class> 
           </void> 
@@ -1077,82 +1132,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-          <void property="inputFileFormatClass"> 
-           <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-          </void> 
-          <void property="outputFileFormatClass"> 
-           <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-          </void> 
-          <void property="properties"> 
-           <object class="java.util.Properties"> 
-            <void method="put"> 
-             <string>name</string> 
-             <string>default.src1</string> 
-            </void> 
-            <void method="put"> 
-             <string>numFiles</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns.types</string> 
-             <string>string:string</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.ddl</string> 
-             <string>struct src1 { string key, string value}</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.format</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns</string> 
-             <string>key,value</string> 
-            </void> 
-            <void method="put"> 
-             <string>rawDataSize</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>numRows</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_count</string> 
-             <string>-1</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.lib</string> 
-             <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-            </void> 
-            <void method="put"> 
-             <string>COLUMN_STATS_ACCURATE</string> 
-             <string>true</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.inputformat</string> 
-             <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>totalSize</string> 
-             <string>216</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.outputformat</string> 
-             <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>location</string> 
-             #### A masked pattern was here #### 
-            </void> 
-            <void method="put"> 
-             <string>transient_lastDdlTime</string> 
-             #### A masked pattern was here #### 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <object idref="TableDesc1"/> 
         </void> 
        </object> 
       </void> 
diff --git a/ql/src/test/results/compiler/plan/input7.q.xml b/ql/src/test/results/compiler/plan/input7.q.xml
index dc84c87f52..0889df4677 100644
--- a/ql/src/test/results/compiler/plan/input7.q.xml
+++ b/ql/src/test/results/compiler/plan/input7.q.xml
@@ -319,7 +319,7 @@
                          </object> 
                         </void> 
                         <void property="tableDesc"> 
-                         <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                           <void property="inputFileFormatClass"> 
                            <class>org.apache.hadoop.mapred.TextInputFormat</class> 
                           </void> 
@@ -417,7 +417,62 @@
                    <boolean>true</boolean> 
                   </void> 
                   <void property="table"> 
-                   <object idref="TableDesc0"/> 
+                   <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                    <void property="inputFileFormatClass"> 
+                     <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                    </void> 
+                    <void property="outputFileFormatClass"> 
+                     <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                    </void> 
+                    <void property="properties"> 
+                     <object class="java.util.Properties"> 
+                      <void method="put"> 
+                       <string>name</string> 
+                       <string>default.dest1</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>columns.types</string> 
+                       <string>string:string</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>serialization.ddl</string> 
+                       <string>struct dest1 { string key, string value}</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>serialization.format</string> 
+                       <string>1</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>columns</string> 
+                       <string>key,value</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>bucket_count</string> 
+                       <string>-1</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>serialization.lib</string> 
+                       <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>file.inputformat</string> 
+                       <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>file.outputformat</string> 
+                       <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>location</string> 
+                       #### A masked pattern was here #### 
+                      </void> 
+                      <void method="put"> 
+                       <string>transient_lastDdlTime</string> 
+                       #### A masked pattern was here #### 
+                      </void> 
+                     </object> 
+                    </void> 
+                   </object> 
                   </void> 
                  </object> 
                 </void> 
@@ -551,7 +606,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+         <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
           <void property="inputFileFormatClass"> 
            <class>org.apache.hadoop.mapred.TextInputFormat</class> 
           </void> 
@@ -1003,82 +1058,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-          <void property="inputFileFormatClass"> 
-           <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-          </void> 
-          <void property="outputFileFormatClass"> 
-           <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-          </void> 
-          <void property="properties"> 
-           <object class="java.util.Properties"> 
-            <void method="put"> 
-             <string>name</string> 
-             <string>default.src1</string> 
-            </void> 
-            <void method="put"> 
-             <string>numFiles</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns.types</string> 
-             <string>string:string</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.ddl</string> 
-             <string>struct src1 { string key, string value}</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.format</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns</string> 
-             <string>key,value</string> 
-            </void> 
-            <void method="put"> 
-             <string>rawDataSize</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>numRows</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_count</string> 
-             <string>-1</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.lib</string> 
-             <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-            </void> 
-            <void method="put"> 
-             <string>COLUMN_STATS_ACCURATE</string> 
-             <string>true</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.inputformat</string> 
-             <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>totalSize</string> 
-             <string>216</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.outputformat</string> 
-             <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>location</string> 
-             #### A masked pattern was here #### 
-            </void> 
-            <void method="put"> 
-             <string>transient_lastDdlTime</string> 
-             #### A masked pattern was here #### 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <object idref="TableDesc1"/> 
         </void> 
        </object> 
       </void> 
diff --git a/ql/src/test/results/compiler/plan/input8.q.xml b/ql/src/test/results/compiler/plan/input8.q.xml
index 72ed1bf7f7..e2c9439573 100644
--- a/ql/src/test/results/compiler/plan/input8.q.xml
+++ b/ql/src/test/results/compiler/plan/input8.q.xml
@@ -68,7 +68,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+         <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
           <void property="inputFileFormatClass"> 
            <class>org.apache.hadoop.mapred.TextInputFormat</class> 
           </void> 
@@ -684,82 +684,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-          <void property="inputFileFormatClass"> 
-           <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-          </void> 
-          <void property="outputFileFormatClass"> 
-           <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-          </void> 
-          <void property="properties"> 
-           <object class="java.util.Properties"> 
-            <void method="put"> 
-             <string>name</string> 
-             <string>default.src1</string> 
-            </void> 
-            <void method="put"> 
-             <string>numFiles</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns.types</string> 
-             <string>string:string</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.ddl</string> 
-             <string>struct src1 { string key, string value}</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.format</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns</string> 
-             <string>key,value</string> 
-            </void> 
-            <void method="put"> 
-             <string>rawDataSize</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>numRows</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_count</string> 
-             <string>-1</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.lib</string> 
-             <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-            </void> 
-            <void method="put"> 
-             <string>COLUMN_STATS_ACCURATE</string> 
-             <string>true</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.inputformat</string> 
-             <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>totalSize</string> 
-             <string>216</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.outputformat</string> 
-             <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>location</string> 
-             #### A masked pattern was here #### 
-            </void> 
-            <void method="put"> 
-             <string>transient_lastDdlTime</string> 
-             #### A masked pattern was here #### 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <object idref="TableDesc0"/> 
         </void> 
        </object> 
       </void> 
diff --git a/ql/src/test/results/compiler/plan/input9.q.xml b/ql/src/test/results/compiler/plan/input9.q.xml
index deb5772db2..c4fcee8b34 100644
--- a/ql/src/test/results/compiler/plan/input9.q.xml
+++ b/ql/src/test/results/compiler/plan/input9.q.xml
@@ -319,7 +319,7 @@
                          </object> 
                         </void> 
                         <void property="tableDesc"> 
-                         <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                           <void property="inputFileFormatClass"> 
                            <class>org.apache.hadoop.mapred.TextInputFormat</class> 
                           </void> 
@@ -417,7 +417,62 @@
                    <boolean>true</boolean> 
                   </void> 
                   <void property="table"> 
-                   <object idref="TableDesc0"/> 
+                   <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                    <void property="inputFileFormatClass"> 
+                     <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                    </void> 
+                    <void property="outputFileFormatClass"> 
+                     <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                    </void> 
+                    <void property="properties"> 
+                     <object class="java.util.Properties"> 
+                      <void method="put"> 
+                       <string>name</string> 
+                       <string>default.dest1</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>columns.types</string> 
+                       <string>string:string</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>serialization.ddl</string> 
+                       <string>struct dest1 { string key, string value}</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>serialization.format</string> 
+                       <string>1</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>columns</string> 
+                       <string>key,value</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>bucket_count</string> 
+                       <string>-1</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>serialization.lib</string> 
+                       <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>file.inputformat</string> 
+                       <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>file.outputformat</string> 
+                       <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>location</string> 
+                       #### A masked pattern was here #### 
+                      </void> 
+                      <void method="put"> 
+                       <string>transient_lastDdlTime</string> 
+                       #### A masked pattern was here #### 
+                      </void> 
+                     </object> 
+                    </void> 
+                   </object> 
                   </void> 
                  </object> 
                 </void> 
@@ -551,7 +606,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+         <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
           <void property="inputFileFormatClass"> 
            <class>org.apache.hadoop.mapred.TextInputFormat</class> 
           </void> 
@@ -1056,82 +1111,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-          <void property="inputFileFormatClass"> 
-           <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-          </void> 
-          <void property="outputFileFormatClass"> 
-           <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-          </void> 
-          <void property="properties"> 
-           <object class="java.util.Properties"> 
-            <void method="put"> 
-             <string>name</string> 
-             <string>default.src1</string> 
-            </void> 
-            <void method="put"> 
-             <string>numFiles</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns.types</string> 
-             <string>string:string</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.ddl</string> 
-             <string>struct src1 { string key, string value}</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.format</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns</string> 
-             <string>key,value</string> 
-            </void> 
-            <void method="put"> 
-             <string>rawDataSize</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>numRows</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_count</string> 
-             <string>-1</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.lib</string> 
-             <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-            </void> 
-            <void method="put"> 
-             <string>COLUMN_STATS_ACCURATE</string> 
-             <string>true</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.inputformat</string> 
-             <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>totalSize</string> 
-             <string>216</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.outputformat</string> 
-             <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>location</string> 
-             #### A masked pattern was here #### 
-            </void> 
-            <void method="put"> 
-             <string>transient_lastDdlTime</string> 
-             #### A masked pattern was here #### 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <object idref="TableDesc1"/> 
         </void> 
        </object> 
       </void> 
diff --git a/ql/src/test/results/compiler/plan/input_part1.q.xml b/ql/src/test/results/compiler/plan/input_part1.q.xml
index a037257cd7..95075fe2bb 100644
--- a/ql/src/test/results/compiler/plan/input_part1.q.xml
+++ b/ql/src/test/results/compiler/plan/input_part1.q.xml
@@ -105,7 +105,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+         <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
           <void property="inputFileFormatClass"> 
            <class>org.apache.hadoop.mapred.TextInputFormat</class> 
           </void> 
@@ -863,66 +863,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-          <void property="inputFileFormatClass"> 
-           <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-          </void> 
-          <void property="outputFileFormatClass"> 
-           <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-          </void> 
-          <void property="properties"> 
-           <object class="java.util.Properties"> 
-            <void method="put"> 
-             <string>name</string> 
-             <string>default.srcpart</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns.types</string> 
-             <string>string:string</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.ddl</string> 
-             <string>struct srcpart { string key, string value}</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.format</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns</string> 
-             <string>key,value</string> 
-            </void> 
-            <void method="put"> 
-             <string>partition_columns</string> 
-             <string>ds/hr</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_count</string> 
-             <string>-1</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.lib</string> 
-             <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.inputformat</string> 
-             <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.outputformat</string> 
-             <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>location</string> 
-             #### A masked pattern was here #### 
-            </void> 
-            <void method="put"> 
-             <string>transient_lastDdlTime</string> 
-             #### A masked pattern was here #### 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <object idref="TableDesc0"/> 
         </void> 
        </object> 
       </void> 
diff --git a/ql/src/test/results/compiler/plan/input_testsequencefile.q.xml b/ql/src/test/results/compiler/plan/input_testsequencefile.q.xml
index 347e874339..9d35abe5a4 100644
--- a/ql/src/test/results/compiler/plan/input_testsequencefile.q.xml
+++ b/ql/src/test/results/compiler/plan/input_testsequencefile.q.xml
@@ -551,7 +551,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+         <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
           <void property="inputFileFormatClass"> 
            <class>org.apache.hadoop.mapred.TextInputFormat</class> 
           </void> 
@@ -1014,82 +1014,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-          <void property="inputFileFormatClass"> 
-           <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-          </void> 
-          <void property="outputFileFormatClass"> 
-           <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-          </void> 
-          <void property="properties"> 
-           <object class="java.util.Properties"> 
-            <void method="put"> 
-             <string>name</string> 
-             <string>default.src</string> 
-            </void> 
-            <void method="put"> 
-             <string>numFiles</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns.types</string> 
-             <string>string:string</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.ddl</string> 
-             <string>struct src { string key, string value}</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.format</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns</string> 
-             <string>key,value</string> 
-            </void> 
-            <void method="put"> 
-             <string>rawDataSize</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>numRows</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_count</string> 
-             <string>-1</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.lib</string> 
-             <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-            </void> 
-            <void method="put"> 
-             <string>COLUMN_STATS_ACCURATE</string> 
-             <string>true</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.inputformat</string> 
-             <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>totalSize</string> 
-             <string>5812</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.outputformat</string> 
-             <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>location</string> 
-             #### A masked pattern was here #### 
-            </void> 
-            <void method="put"> 
-             <string>transient_lastDdlTime</string> 
-             #### A masked pattern was here #### 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <object idref="TableDesc1"/> 
         </void> 
        </object> 
       </void> 
diff --git a/ql/src/test/results/compiler/plan/input_testxpath.q.xml b/ql/src/test/results/compiler/plan/input_testxpath.q.xml
index d85a3be104..37ddde35ff 100644
--- a/ql/src/test/results/compiler/plan/input_testxpath.q.xml
+++ b/ql/src/test/results/compiler/plan/input_testxpath.q.xml
@@ -72,7 +72,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+         <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
           <void property="inputFileFormatClass"> 
            <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
           </void> 
@@ -861,86 +861,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-          <void property="inputFileFormatClass"> 
-           <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-          </void> 
-          <void property="outputFileFormatClass"> 
-           <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-          </void> 
-          <void property="properties"> 
-           <object class="java.util.Properties"> 
-            <void method="put"> 
-             <string>name</string> 
-             <string>default.src_thrift</string> 
-            </void> 
-            <void method="put"> 
-             <string>numFiles</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns.types</string> 
-             <string></string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.ddl</string> 
-             <string>struct src_thrift { }</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns</string> 
-             <string></string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.format</string> 
-             <string>org.apache.thrift.protocol.TBinaryProtocol</string> 
-            </void> 
-            <void method="put"> 
-             <string>rawDataSize</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>numRows</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.class</string> 
-             <string>org.apache.hadoop.hive.serde2.thrift.test.Complex</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_count</string> 
-             <string>-1</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.lib</string> 
-             <string>org.apache.hadoop.hive.serde2.thrift.ThriftDeserializer</string> 
-            </void> 
-            <void method="put"> 
-             <string>COLUMN_STATS_ACCURATE</string> 
-             <string>true</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.inputformat</string> 
-             <string>org.apache.hadoop.mapred.SequenceFileInputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>totalSize</string> 
-             <string>1606</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.outputformat</string> 
-             <string>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>location</string> 
-             #### A masked pattern was here #### 
-            </void> 
-            <void method="put"> 
-             <string>transient_lastDdlTime</string> 
-             #### A masked pattern was here #### 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <object idref="TableDesc0"/> 
         </void> 
        </object> 
       </void> 
diff --git a/ql/src/test/results/compiler/plan/input_testxpath2.q.xml b/ql/src/test/results/compiler/plan/input_testxpath2.q.xml
index 74506594ef..125cbfa3d7 100644
--- a/ql/src/test/results/compiler/plan/input_testxpath2.q.xml
+++ b/ql/src/test/results/compiler/plan/input_testxpath2.q.xml
@@ -72,7 +72,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+         <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
           <void property="inputFileFormatClass"> 
            <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
           </void> 
@@ -939,86 +939,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-          <void property="inputFileFormatClass"> 
-           <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-          </void> 
-          <void property="outputFileFormatClass"> 
-           <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-          </void> 
-          <void property="properties"> 
-           <object class="java.util.Properties"> 
-            <void method="put"> 
-             <string>name</string> 
-             <string>default.src_thrift</string> 
-            </void> 
-            <void method="put"> 
-             <string>numFiles</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns.types</string> 
-             <string></string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.ddl</string> 
-             <string>struct src_thrift { }</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns</string> 
-             <string></string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.format</string> 
-             <string>org.apache.thrift.protocol.TBinaryProtocol</string> 
-            </void> 
-            <void method="put"> 
-             <string>rawDataSize</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>numRows</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.class</string> 
-             <string>org.apache.hadoop.hive.serde2.thrift.test.Complex</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_count</string> 
-             <string>-1</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.lib</string> 
-             <string>org.apache.hadoop.hive.serde2.thrift.ThriftDeserializer</string> 
-            </void> 
-            <void method="put"> 
-             <string>COLUMN_STATS_ACCURATE</string> 
-             <string>true</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.inputformat</string> 
-             <string>org.apache.hadoop.mapred.SequenceFileInputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>totalSize</string> 
-             <string>1606</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.outputformat</string> 
-             <string>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>location</string> 
-             #### A masked pattern was here #### 
-            </void> 
-            <void method="put"> 
-             <string>transient_lastDdlTime</string> 
-             #### A masked pattern was here #### 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <object idref="TableDesc0"/> 
         </void> 
        </object> 
       </void> 
diff --git a/ql/src/test/results/compiler/plan/join1.q.xml b/ql/src/test/results/compiler/plan/join1.q.xml
index dbb8ca9312..12b01ce037 100644
--- a/ql/src/test/results/compiler/plan/join1.q.xml
+++ b/ql/src/test/results/compiler/plan/join1.q.xml
@@ -212,7 +212,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+         <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
           <void property="inputFileFormatClass"> 
            <class>org.apache.hadoop.mapred.TextInputFormat</class> 
           </void> 
@@ -348,82 +348,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-          <void property="inputFileFormatClass"> 
-           <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-          </void> 
-          <void property="outputFileFormatClass"> 
-           <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-          </void> 
-          <void property="properties"> 
-           <object class="java.util.Properties"> 
-            <void method="put"> 
-             <string>name</string> 
-             <string>default.src</string> 
-            </void> 
-            <void method="put"> 
-             <string>numFiles</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns.types</string> 
-             <string>string:string</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.ddl</string> 
-             <string>struct src { string key, string value}</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.format</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns</string> 
-             <string>key,value</string> 
-            </void> 
-            <void method="put"> 
-             <string>rawDataSize</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>numRows</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_count</string> 
-             <string>-1</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.lib</string> 
-             <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-            </void> 
-            <void method="put"> 
-             <string>COLUMN_STATS_ACCURATE</string> 
-             <string>true</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.inputformat</string> 
-             <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>totalSize</string> 
-             <string>5812</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.outputformat</string> 
-             <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>location</string> 
-             #### A masked pattern was here #### 
-            </void> 
-            <void method="put"> 
-             <string>transient_lastDdlTime</string> 
-             #### A masked pattern was here #### 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <object idref="TableDesc1"/> 
         </void> 
        </object> 
       </void> 
@@ -557,7 +482,7 @@
               </object> 
              </void> 
              <void property="valueSerializeInfo"> 
-              <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+              <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                <void property="inputFileFormatClass"> 
                 <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
                </void> 
@@ -806,7 +731,7 @@
               </object> 
              </void> 
              <void property="keySerializeInfo"> 
-              <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+              <object id="TableDesc3" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                <void property="inputFileFormatClass"> 
                 <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
                </void> 
@@ -866,7 +791,7 @@
               </object> 
              </void> 
              <void property="valueSerializeInfo"> 
-              <object id="TableDesc3" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+              <object id="TableDesc4" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                <void property="inputFileFormatClass"> 
                 <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
                </void> 
@@ -1144,82 +1069,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-          <void property="inputFileFormatClass"> 
-           <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-          </void> 
-          <void property="outputFileFormatClass"> 
-           <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-          </void> 
-          <void property="properties"> 
-           <object class="java.util.Properties"> 
-            <void method="put"> 
-             <string>name</string> 
-             <string>default.src</string> 
-            </void> 
-            <void method="put"> 
-             <string>numFiles</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns.types</string> 
-             <string>string:string</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.ddl</string> 
-             <string>struct src { string key, string value}</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.format</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns</string> 
-             <string>key,value</string> 
-            </void> 
-            <void method="put"> 
-             <string>rawDataSize</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>numRows</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_count</string> 
-             <string>-1</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.lib</string> 
-             <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-            </void> 
-            <void method="put"> 
-             <string>COLUMN_STATS_ACCURATE</string> 
-             <string>true</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.inputformat</string> 
-             <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>totalSize</string> 
-             <string>5812</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.outputformat</string> 
-             <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>location</string> 
-             #### A masked pattern was here #### 
-            </void> 
-            <void method="put"> 
-             <string>transient_lastDdlTime</string> 
-             #### A masked pattern was here #### 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <object idref="TableDesc1"/> 
         </void> 
        </object> 
       </void> 
@@ -1231,7 +1081,7 @@
        <boolean>true</boolean> 
       </void> 
       <void property="keyDesc"> 
-       <object idref="TableDesc2"/> 
+       <object idref="TableDesc3"/> 
       </void> 
       <void property="needsTagging"> 
        <boolean>true</boolean> 
@@ -1660,10 +1510,10 @@
       </void> 
       <void property="tagToValueDesc"> 
        <void method="add"> 
-        <object idref="TableDesc3"/> 
+        <object idref="TableDesc4"/> 
        </void> 
        <void method="add"> 
-        <object idref="TableDesc1"/> 
+        <object idref="TableDesc2"/> 
        </void> 
       </void> 
      </object> 
diff --git a/ql/src/test/results/compiler/plan/join2.q.xml b/ql/src/test/results/compiler/plan/join2.q.xml
index d13890ec79..ed5bbb8241 100644
--- a/ql/src/test/results/compiler/plan/join2.q.xml
+++ b/ql/src/test/results/compiler/plan/join2.q.xml
@@ -223,7 +223,7 @@
              </object> 
             </void> 
             <void property="tableDesc"> 
-             <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+             <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
               <void property="inputFileFormatClass"> 
                <class>org.apache.hadoop.mapred.TextInputFormat</class> 
               </void> 
@@ -446,7 +446,7 @@
                   </object> 
                  </void> 
                  <void property="valueSerializeInfo"> 
-                  <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                  <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                    <void property="inputFileFormatClass"> 
                     <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
                    </void> 
@@ -648,7 +648,7 @@
                   </object> 
                  </void> 
                  <void property="keySerializeInfo"> 
-                  <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                  <object id="TableDesc3" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                    <void property="inputFileFormatClass"> 
                     <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
                    </void> 
@@ -711,7 +711,7 @@
                   </object> 
                  </void> 
                  <void property="valueSerializeInfo"> 
-                  <object id="TableDesc3" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                  <object id="TableDesc4" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                    <void property="inputFileFormatClass"> 
                     <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
                    </void> 
@@ -953,7 +953,7 @@
              </object> 
             </void> 
             <void property="tableDesc"> 
-             <object id="TableDesc4" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+             <object id="TableDesc5" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
               <void property="inputFileFormatClass"> 
                <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
               </void> 
@@ -1051,82 +1051,7 @@
              </object> 
             </void> 
             <void property="tableDesc"> 
-             <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-              <void property="inputFileFormatClass"> 
-               <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-              </void> 
-              <void property="outputFileFormatClass"> 
-               <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-              </void> 
-              <void property="properties"> 
-               <object class="java.util.Properties"> 
-                <void method="put"> 
-                 <string>name</string> 
-                 <string>default.src</string> 
-                </void> 
-                <void method="put"> 
-                 <string>numFiles</string> 
-                 <string>1</string> 
-                </void> 
-                <void method="put"> 
-                 <string>columns.types</string> 
-                 <string>string:string</string> 
-                </void> 
-                <void method="put"> 
-                 <string>serialization.ddl</string> 
-                 <string>struct src { string key, string value}</string> 
-                </void> 
-                <void method="put"> 
-                 <string>serialization.format</string> 
-                 <string>1</string> 
-                </void> 
-                <void method="put"> 
-                 <string>columns</string> 
-                 <string>key,value</string> 
-                </void> 
-                <void method="put"> 
-                 <string>rawDataSize</string> 
-                 <string>0</string> 
-                </void> 
-                <void method="put"> 
-                 <string>numRows</string> 
-                 <string>0</string> 
-                </void> 
-                <void method="put"> 
-                 <string>bucket_count</string> 
-                 <string>-1</string> 
-                </void> 
-                <void method="put"> 
-                 <string>serialization.lib</string> 
-                 <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                </void> 
-                <void method="put"> 
-                 <string>COLUMN_STATS_ACCURATE</string> 
-                 <string>true</string> 
-                </void> 
-                <void method="put"> 
-                 <string>file.inputformat</string> 
-                 <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-                </void> 
-                <void method="put"> 
-                 <string>totalSize</string> 
-                 <string>5812</string> 
-                </void> 
-                <void method="put"> 
-                 <string>file.outputformat</string> 
-                 <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-                </void> 
-                <void method="put"> 
-                 <string>location</string> 
-                 #### A masked pattern was here #### 
-                </void> 
-                <void method="put"> 
-                 <string>transient_lastDdlTime</string> 
-                 #### A masked pattern was here #### 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
+             <object idref="TableDesc1"/> 
             </void> 
            </object> 
           </void> 
@@ -1138,7 +1063,7 @@
            <boolean>true</boolean> 
           </void> 
           <void property="keyDesc"> 
-           <object idref="TableDesc2"/> 
+           <object idref="TableDesc3"/> 
           </void> 
           <void property="needsTagging"> 
            <boolean>true</boolean> 
@@ -1586,10 +1511,10 @@
           </void> 
           <void property="tagToValueDesc"> 
            <void method="add"> 
-            <object idref="TableDesc1"/> 
+            <object idref="TableDesc2"/> 
            </void> 
            <void method="add"> 
-            <object idref="TableDesc3"/> 
+            <object idref="TableDesc4"/> 
            </void> 
           </void> 
          </object> 
@@ -1664,82 +1589,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-          <void property="inputFileFormatClass"> 
-           <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-          </void> 
-          <void property="outputFileFormatClass"> 
-           <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-          </void> 
-          <void property="properties"> 
-           <object class="java.util.Properties"> 
-            <void method="put"> 
-             <string>name</string> 
-             <string>default.src</string> 
-            </void> 
-            <void method="put"> 
-             <string>numFiles</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns.types</string> 
-             <string>string:string</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.ddl</string> 
-             <string>struct src { string key, string value}</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.format</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns</string> 
-             <string>key,value</string> 
-            </void> 
-            <void method="put"> 
-             <string>rawDataSize</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>numRows</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_count</string> 
-             <string>-1</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.lib</string> 
-             <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-            </void> 
-            <void method="put"> 
-             <string>COLUMN_STATS_ACCURATE</string> 
-             <string>true</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.inputformat</string> 
-             <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>totalSize</string> 
-             <string>5812</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.outputformat</string> 
-             <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>location</string> 
-             #### A masked pattern was here #### 
-            </void> 
-            <void method="put"> 
-             <string>transient_lastDdlTime</string> 
-             #### A masked pattern was here #### 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <object idref="TableDesc1"/> 
         </void> 
        </object> 
       </void> 
@@ -1800,82 +1650,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-          <void property="inputFileFormatClass"> 
-           <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-          </void> 
-          <void property="outputFileFormatClass"> 
-           <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-          </void> 
-          <void property="properties"> 
-           <object class="java.util.Properties"> 
-            <void method="put"> 
-             <string>name</string> 
-             <string>default.src</string> 
-            </void> 
-            <void method="put"> 
-             <string>numFiles</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns.types</string> 
-             <string>string:string</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.ddl</string> 
-             <string>struct src { string key, string value}</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.format</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns</string> 
-             <string>key,value</string> 
-            </void> 
-            <void method="put"> 
-             <string>rawDataSize</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>numRows</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_count</string> 
-             <string>-1</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.lib</string> 
-             <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-            </void> 
-            <void method="put"> 
-             <string>COLUMN_STATS_ACCURATE</string> 
-             <string>true</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.inputformat</string> 
-             <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>totalSize</string> 
-             <string>5812</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.outputformat</string> 
-             <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>location</string> 
-             #### A masked pattern was here #### 
-            </void> 
-            <void method="put"> 
-             <string>transient_lastDdlTime</string> 
-             #### A masked pattern was here #### 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <object idref="TableDesc1"/> 
         </void> 
        </object> 
       </void> 
@@ -1991,7 +1766,7 @@
               </object> 
              </void> 
              <void property="valueSerializeInfo"> 
-              <object id="TableDesc5" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+              <object id="TableDesc6" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                <void property="inputFileFormatClass"> 
                 <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
                </void> 
@@ -2214,7 +1989,7 @@
               </object> 
              </void> 
              <void property="keySerializeInfo"> 
-              <object id="TableDesc6" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+              <object id="TableDesc7" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                <void property="inputFileFormatClass"> 
                 <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
                </void> 
@@ -2274,7 +2049,7 @@
               </object> 
              </void> 
              <void property="valueSerializeInfo"> 
-              <object id="TableDesc7" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+              <object id="TableDesc8" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                <void property="inputFileFormatClass"> 
                 <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
                </void> 
@@ -2549,82 +2324,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-          <void property="inputFileFormatClass"> 
-           <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-          </void> 
-          <void property="outputFileFormatClass"> 
-           <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-          </void> 
-          <void property="properties"> 
-           <object class="java.util.Properties"> 
-            <void method="put"> 
-             <string>name</string> 
-             <string>default.src</string> 
-            </void> 
-            <void method="put"> 
-             <string>numFiles</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns.types</string> 
-             <string>string:string</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.ddl</string> 
-             <string>struct src { string key, string value}</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.format</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns</string> 
-             <string>key,value</string> 
-            </void> 
-            <void method="put"> 
-             <string>rawDataSize</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>numRows</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_count</string> 
-             <string>-1</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.lib</string> 
-             <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-            </void> 
-            <void method="put"> 
-             <string>COLUMN_STATS_ACCURATE</string> 
-             <string>true</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.inputformat</string> 
-             <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>totalSize</string> 
-             <string>5812</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.outputformat</string> 
-             <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>location</string> 
-             #### A masked pattern was here #### 
-            </void> 
-            <void method="put"> 
-             <string>transient_lastDdlTime</string> 
-             #### A masked pattern was here #### 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <object idref="TableDesc1"/> 
         </void> 
        </object> 
       </void> 
@@ -2633,7 +2333,7 @@
     <void property="reduceWork"> 
      <object class="org.apache.hadoop.hive.ql.plan.ReduceWork"> 
       <void property="keyDesc"> 
-       <object idref="TableDesc6"/> 
+       <object idref="TableDesc7"/> 
       </void> 
       <void property="needsTagging"> 
        <boolean>true</boolean> 
@@ -2657,7 +2357,7 @@
               <int>1</int> 
              </void> 
              <void property="tableInfo"> 
-              <object idref="TableDesc4"/> 
+              <object idref="TableDesc5"/> 
              </void> 
              <void property="totalFiles"> 
               <int>1</int> 
@@ -2860,10 +2560,10 @@
       </void> 
       <void property="tagToValueDesc"> 
        <void method="add"> 
-        <object idref="TableDesc7"/> 
+        <object idref="TableDesc8"/> 
        </void> 
        <void method="add"> 
-        <object idref="TableDesc5"/> 
+        <object idref="TableDesc6"/> 
        </void> 
       </void> 
      </object> 
diff --git a/ql/src/test/results/compiler/plan/join3.q.xml b/ql/src/test/results/compiler/plan/join3.q.xml
index 81ce3e2b52..5437afafef 100644
--- a/ql/src/test/results/compiler/plan/join3.q.xml
+++ b/ql/src/test/results/compiler/plan/join3.q.xml
@@ -212,7 +212,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+         <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
           <void property="inputFileFormatClass"> 
            <class>org.apache.hadoop.mapred.TextInputFormat</class> 
           </void> 
@@ -348,82 +348,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-          <void property="inputFileFormatClass"> 
-           <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-          </void> 
-          <void property="outputFileFormatClass"> 
-           <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-          </void> 
-          <void property="properties"> 
-           <object class="java.util.Properties"> 
-            <void method="put"> 
-             <string>name</string> 
-             <string>default.src</string> 
-            </void> 
-            <void method="put"> 
-             <string>numFiles</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns.types</string> 
-             <string>string:string</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.ddl</string> 
-             <string>struct src { string key, string value}</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.format</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns</string> 
-             <string>key,value</string> 
-            </void> 
-            <void method="put"> 
-             <string>rawDataSize</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>numRows</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_count</string> 
-             <string>-1</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.lib</string> 
-             <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-            </void> 
-            <void method="put"> 
-             <string>COLUMN_STATS_ACCURATE</string> 
-             <string>true</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.inputformat</string> 
-             <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>totalSize</string> 
-             <string>5812</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.outputformat</string> 
-             <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>location</string> 
-             #### A masked pattern was here #### 
-            </void> 
-            <void method="put"> 
-             <string>transient_lastDdlTime</string> 
-             #### A masked pattern was here #### 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <object idref="TableDesc1"/> 
         </void> 
        </object> 
       </void> 
@@ -484,82 +409,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-          <void property="inputFileFormatClass"> 
-           <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-          </void> 
-          <void property="outputFileFormatClass"> 
-           <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-          </void> 
-          <void property="properties"> 
-           <object class="java.util.Properties"> 
-            <void method="put"> 
-             <string>name</string> 
-             <string>default.src</string> 
-            </void> 
-            <void method="put"> 
-             <string>numFiles</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns.types</string> 
-             <string>string:string</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.ddl</string> 
-             <string>struct src { string key, string value}</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.format</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns</string> 
-             <string>key,value</string> 
-            </void> 
-            <void method="put"> 
-             <string>rawDataSize</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>numRows</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_count</string> 
-             <string>-1</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.lib</string> 
-             <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-            </void> 
-            <void method="put"> 
-             <string>COLUMN_STATS_ACCURATE</string> 
-             <string>true</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.inputformat</string> 
-             <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>totalSize</string> 
-             <string>5812</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.outputformat</string> 
-             <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>location</string> 
-             #### A masked pattern was here #### 
-            </void> 
-            <void method="put"> 
-             <string>transient_lastDdlTime</string> 
-             #### A masked pattern was here #### 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <object idref="TableDesc1"/> 
         </void> 
        </object> 
       </void> 
@@ -671,7 +521,7 @@
               <object class="java.util.ArrayList"/> 
              </void> 
              <void property="valueSerializeInfo"> 
-              <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+              <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                <void property="inputFileFormatClass"> 
                 <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
                </void> 
@@ -975,7 +825,7 @@
               </object> 
              </void> 
              <void property="valueSerializeInfo"> 
-              <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+              <object id="TableDesc3" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                <void property="inputFileFormatClass"> 
                 <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
                </void> 
@@ -1220,7 +1070,7 @@
               </object> 
              </void> 
              <void property="keySerializeInfo"> 
-              <object id="TableDesc3" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+              <object id="TableDesc4" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                <void property="inputFileFormatClass"> 
                 <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
                </void> 
@@ -1280,7 +1130,7 @@
               </object> 
              </void> 
              <void property="valueSerializeInfo"> 
-              <object id="TableDesc4" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+              <object id="TableDesc5" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                <void property="inputFileFormatClass"> 
                 <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
                </void> 
@@ -1561,82 +1411,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-          <void property="inputFileFormatClass"> 
-           <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-          </void> 
-          <void property="outputFileFormatClass"> 
-           <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-          </void> 
-          <void property="properties"> 
-           <object class="java.util.Properties"> 
-            <void method="put"> 
-             <string>name</string> 
-             <string>default.src</string> 
-            </void> 
-            <void method="put"> 
-             <string>numFiles</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns.types</string> 
-             <string>string:string</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.ddl</string> 
-             <string>struct src { string key, string value}</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.format</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns</string> 
-             <string>key,value</string> 
-            </void> 
-            <void method="put"> 
-             <string>rawDataSize</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>numRows</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_count</string> 
-             <string>-1</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.lib</string> 
-             <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-            </void> 
-            <void method="put"> 
-             <string>COLUMN_STATS_ACCURATE</string> 
-             <string>true</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.inputformat</string> 
-             <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>totalSize</string> 
-             <string>5812</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.outputformat</string> 
-             <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>location</string> 
-             #### A masked pattern was here #### 
-            </void> 
-            <void method="put"> 
-             <string>transient_lastDdlTime</string> 
-             #### A masked pattern was here #### 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <object idref="TableDesc1"/> 
         </void> 
        </object> 
       </void> 
@@ -1648,7 +1423,7 @@
        <boolean>true</boolean> 
       </void> 
       <void property="keyDesc"> 
-       <object idref="TableDesc3"/> 
+       <object idref="TableDesc4"/> 
       </void> 
       <void property="needsTagging"> 
        <boolean>true</boolean> 
@@ -2122,13 +1897,13 @@
       </void> 
       <void property="tagToValueDesc"> 
        <void method="add"> 
-        <object idref="TableDesc4"/> 
+        <object idref="TableDesc5"/> 
        </void> 
        <void method="add"> 
-        <object idref="TableDesc1"/> 
+        <object idref="TableDesc2"/> 
        </void> 
        <void method="add"> 
-        <object idref="TableDesc2"/> 
+        <object idref="TableDesc3"/> 
        </void> 
       </void> 
      </object> 
diff --git a/ql/src/test/results/compiler/plan/join4.q.xml b/ql/src/test/results/compiler/plan/join4.q.xml
index 116f2ad4c7..aa69ada94c 100644
--- a/ql/src/test/results/compiler/plan/join4.q.xml
+++ b/ql/src/test/results/compiler/plan/join4.q.xml
@@ -68,7 +68,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+         <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
           <void property="inputFileFormatClass"> 
            <class>org.apache.hadoop.mapred.TextInputFormat</class> 
           </void> 
@@ -204,82 +204,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-          <void property="inputFileFormatClass"> 
-           <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-          </void> 
-          <void property="outputFileFormatClass"> 
-           <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-          </void> 
-          <void property="properties"> 
-           <object class="java.util.Properties"> 
-            <void method="put"> 
-             <string>name</string> 
-             <string>default.src</string> 
-            </void> 
-            <void method="put"> 
-             <string>numFiles</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns.types</string> 
-             <string>string:string</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.ddl</string> 
-             <string>struct src { string key, string value}</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.format</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns</string> 
-             <string>key,value</string> 
-            </void> 
-            <void method="put"> 
-             <string>rawDataSize</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>numRows</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_count</string> 
-             <string>-1</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.lib</string> 
-             <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-            </void> 
-            <void method="put"> 
-             <string>COLUMN_STATS_ACCURATE</string> 
-             <string>true</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.inputformat</string> 
-             <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>totalSize</string> 
-             <string>5812</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.outputformat</string> 
-             <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>location</string> 
-             #### A masked pattern was here #### 
-            </void> 
-            <void method="put"> 
-             <string>transient_lastDdlTime</string> 
-             #### A masked pattern was here #### 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <object idref="TableDesc0"/> 
         </void> 
        </object> 
       </void> 
@@ -413,7 +338,7 @@
                     </object> 
                    </void> 
                    <void property="valueSerializeInfo"> 
-                    <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                    <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                      <void property="inputFileFormatClass"> 
                       <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
                      </void> 
@@ -899,7 +824,7 @@
                     </object> 
                    </void> 
                    <void property="keySerializeInfo"> 
-                    <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                    <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                      <void property="inputFileFormatClass"> 
                       <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
                      </void> 
@@ -968,7 +893,7 @@
                     </object> 
                    </void> 
                    <void property="valueSerializeInfo"> 
-                    <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                    <object id="TableDesc3" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                      <void property="inputFileFormatClass"> 
                       <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
                      </void> 
@@ -1483,82 +1408,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-          <void property="inputFileFormatClass"> 
-           <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-          </void> 
-          <void property="outputFileFormatClass"> 
-           <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-          </void> 
-          <void property="properties"> 
-           <object class="java.util.Properties"> 
-            <void method="put"> 
-             <string>name</string> 
-             <string>default.src</string> 
-            </void> 
-            <void method="put"> 
-             <string>numFiles</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns.types</string> 
-             <string>string:string</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.ddl</string> 
-             <string>struct src { string key, string value}</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.format</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns</string> 
-             <string>key,value</string> 
-            </void> 
-            <void method="put"> 
-             <string>rawDataSize</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>numRows</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_count</string> 
-             <string>-1</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.lib</string> 
-             <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-            </void> 
-            <void method="put"> 
-             <string>COLUMN_STATS_ACCURATE</string> 
-             <string>true</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.inputformat</string> 
-             <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>totalSize</string> 
-             <string>5812</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.outputformat</string> 
-             <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>location</string> 
-             #### A masked pattern was here #### 
-            </void> 
-            <void method="put"> 
-             <string>transient_lastDdlTime</string> 
-             #### A masked pattern was here #### 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <object idref="TableDesc0"/> 
         </void> 
        </object> 
       </void> 
@@ -1567,7 +1417,7 @@
     <void property="reduceWork"> 
      <object class="org.apache.hadoop.hive.ql.plan.ReduceWork"> 
       <void property="keyDesc"> 
-       <object idref="TableDesc1"/> 
+       <object idref="TableDesc2"/> 
       </void> 
       <void property="needsTagging"> 
        <boolean>true</boolean> 
@@ -2199,10 +2049,10 @@
       </void> 
       <void property="tagToValueDesc"> 
        <void method="add"> 
-        <object idref="TableDesc0"/> 
+        <object idref="TableDesc1"/> 
        </void> 
        <void method="add"> 
-        <object idref="TableDesc2"/> 
+        <object idref="TableDesc3"/> 
        </void> 
       </void> 
      </object> 
diff --git a/ql/src/test/results/compiler/plan/join5.q.xml b/ql/src/test/results/compiler/plan/join5.q.xml
index 9dd4af5837..ef0c69d9f6 100644
--- a/ql/src/test/results/compiler/plan/join5.q.xml
+++ b/ql/src/test/results/compiler/plan/join5.q.xml
@@ -68,7 +68,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+         <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
           <void property="inputFileFormatClass"> 
            <class>org.apache.hadoop.mapred.TextInputFormat</class> 
           </void> 
@@ -204,82 +204,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-          <void property="inputFileFormatClass"> 
-           <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-          </void> 
-          <void property="outputFileFormatClass"> 
-           <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-          </void> 
-          <void property="properties"> 
-           <object class="java.util.Properties"> 
-            <void method="put"> 
-             <string>name</string> 
-             <string>default.src</string> 
-            </void> 
-            <void method="put"> 
-             <string>numFiles</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns.types</string> 
-             <string>string:string</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.ddl</string> 
-             <string>struct src { string key, string value}</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.format</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns</string> 
-             <string>key,value</string> 
-            </void> 
-            <void method="put"> 
-             <string>rawDataSize</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>numRows</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_count</string> 
-             <string>-1</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.lib</string> 
-             <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-            </void> 
-            <void method="put"> 
-             <string>COLUMN_STATS_ACCURATE</string> 
-             <string>true</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.inputformat</string> 
-             <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>totalSize</string> 
-             <string>5812</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.outputformat</string> 
-             <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>location</string> 
-             #### A masked pattern was here #### 
-            </void> 
-            <void method="put"> 
-             <string>transient_lastDdlTime</string> 
-             #### A masked pattern was here #### 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <object idref="TableDesc0"/> 
         </void> 
        </object> 
       </void> 
@@ -413,7 +338,7 @@
                     </object> 
                    </void> 
                    <void property="valueSerializeInfo"> 
-                    <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                    <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                      <void property="inputFileFormatClass"> 
                       <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
                      </void> 
@@ -899,7 +824,7 @@
                     </object> 
                    </void> 
                    <void property="keySerializeInfo"> 
-                    <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                    <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                      <void property="inputFileFormatClass"> 
                       <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
                      </void> 
@@ -968,7 +893,7 @@
                     </object> 
                    </void> 
                    <void property="valueSerializeInfo"> 
-                    <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                    <object id="TableDesc3" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                      <void property="inputFileFormatClass"> 
                       <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
                      </void> 
@@ -1483,82 +1408,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-          <void property="inputFileFormatClass"> 
-           <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-          </void> 
-          <void property="outputFileFormatClass"> 
-           <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-          </void> 
-          <void property="properties"> 
-           <object class="java.util.Properties"> 
-            <void method="put"> 
-             <string>name</string> 
-             <string>default.src</string> 
-            </void> 
-            <void method="put"> 
-             <string>numFiles</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns.types</string> 
-             <string>string:string</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.ddl</string> 
-             <string>struct src { string key, string value}</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.format</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns</string> 
-             <string>key,value</string> 
-            </void> 
-            <void method="put"> 
-             <string>rawDataSize</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>numRows</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_count</string> 
-             <string>-1</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.lib</string> 
-             <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-            </void> 
-            <void method="put"> 
-             <string>COLUMN_STATS_ACCURATE</string> 
-             <string>true</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.inputformat</string> 
-             <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>totalSize</string> 
-             <string>5812</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.outputformat</string> 
-             <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>location</string> 
-             #### A masked pattern was here #### 
-            </void> 
-            <void method="put"> 
-             <string>transient_lastDdlTime</string> 
-             #### A masked pattern was here #### 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <object idref="TableDesc0"/> 
         </void> 
        </object> 
       </void> 
@@ -1567,7 +1417,7 @@
     <void property="reduceWork"> 
      <object class="org.apache.hadoop.hive.ql.plan.ReduceWork"> 
       <void property="keyDesc"> 
-       <object idref="TableDesc1"/> 
+       <object idref="TableDesc2"/> 
       </void> 
       <void property="needsTagging"> 
        <boolean>true</boolean> 
@@ -2195,10 +2045,10 @@
       </void> 
       <void property="tagToValueDesc"> 
        <void method="add"> 
-        <object idref="TableDesc0"/> 
+        <object idref="TableDesc1"/> 
        </void> 
        <void method="add"> 
-        <object idref="TableDesc2"/> 
+        <object idref="TableDesc3"/> 
        </void> 
       </void> 
      </object> 
diff --git a/ql/src/test/results/compiler/plan/join6.q.xml b/ql/src/test/results/compiler/plan/join6.q.xml
index 7134e083ec..da528f5225 100644
--- a/ql/src/test/results/compiler/plan/join6.q.xml
+++ b/ql/src/test/results/compiler/plan/join6.q.xml
@@ -68,7 +68,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+         <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
           <void property="inputFileFormatClass"> 
            <class>org.apache.hadoop.mapred.TextInputFormat</class> 
           </void> 
@@ -204,82 +204,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-          <void property="inputFileFormatClass"> 
-           <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-          </void> 
-          <void property="outputFileFormatClass"> 
-           <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-          </void> 
-          <void property="properties"> 
-           <object class="java.util.Properties"> 
-            <void method="put"> 
-             <string>name</string> 
-             <string>default.src</string> 
-            </void> 
-            <void method="put"> 
-             <string>numFiles</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns.types</string> 
-             <string>string:string</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.ddl</string> 
-             <string>struct src { string key, string value}</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.format</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns</string> 
-             <string>key,value</string> 
-            </void> 
-            <void method="put"> 
-             <string>rawDataSize</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>numRows</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_count</string> 
-             <string>-1</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.lib</string> 
-             <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-            </void> 
-            <void method="put"> 
-             <string>COLUMN_STATS_ACCURATE</string> 
-             <string>true</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.inputformat</string> 
-             <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>totalSize</string> 
-             <string>5812</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.outputformat</string> 
-             <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>location</string> 
-             #### A masked pattern was here #### 
-            </void> 
-            <void method="put"> 
-             <string>transient_lastDdlTime</string> 
-             #### A masked pattern was here #### 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <object idref="TableDesc0"/> 
         </void> 
        </object> 
       </void> 
@@ -413,7 +338,7 @@
                     </object> 
                    </void> 
                    <void property="valueSerializeInfo"> 
-                    <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                    <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                      <void property="inputFileFormatClass"> 
                       <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
                      </void> 
@@ -899,7 +824,7 @@
                     </object> 
                    </void> 
                    <void property="keySerializeInfo"> 
-                    <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                    <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                      <void property="inputFileFormatClass"> 
                       <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
                      </void> 
@@ -968,7 +893,7 @@
                     </object> 
                    </void> 
                    <void property="valueSerializeInfo"> 
-                    <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                    <object id="TableDesc3" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                      <void property="inputFileFormatClass"> 
                       <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
                      </void> 
@@ -1483,82 +1408,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-          <void property="inputFileFormatClass"> 
-           <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-          </void> 
-          <void property="outputFileFormatClass"> 
-           <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-          </void> 
-          <void property="properties"> 
-           <object class="java.util.Properties"> 
-            <void method="put"> 
-             <string>name</string> 
-             <string>default.src</string> 
-            </void> 
-            <void method="put"> 
-             <string>numFiles</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns.types</string> 
-             <string>string:string</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.ddl</string> 
-             <string>struct src { string key, string value}</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.format</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns</string> 
-             <string>key,value</string> 
-            </void> 
-            <void method="put"> 
-             <string>rawDataSize</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>numRows</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_count</string> 
-             <string>-1</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.lib</string> 
-             <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-            </void> 
-            <void method="put"> 
-             <string>COLUMN_STATS_ACCURATE</string> 
-             <string>true</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.inputformat</string> 
-             <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>totalSize</string> 
-             <string>5812</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.outputformat</string> 
-             <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>location</string> 
-             #### A masked pattern was here #### 
-            </void> 
-            <void method="put"> 
-             <string>transient_lastDdlTime</string> 
-             #### A masked pattern was here #### 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <object idref="TableDesc0"/> 
         </void> 
        </object> 
       </void> 
@@ -1567,7 +1417,7 @@
     <void property="reduceWork"> 
      <object class="org.apache.hadoop.hive.ql.plan.ReduceWork"> 
       <void property="keyDesc"> 
-       <object idref="TableDesc1"/> 
+       <object idref="TableDesc2"/> 
       </void> 
       <void property="needsTagging"> 
        <boolean>true</boolean> 
@@ -2202,10 +2052,10 @@
       </void> 
       <void property="tagToValueDesc"> 
        <void method="add"> 
-        <object idref="TableDesc0"/> 
+        <object idref="TableDesc1"/> 
        </void> 
        <void method="add"> 
-        <object idref="TableDesc2"/> 
+        <object idref="TableDesc3"/> 
        </void> 
       </void> 
      </object> 
diff --git a/ql/src/test/results/compiler/plan/join7.q.xml b/ql/src/test/results/compiler/plan/join7.q.xml
index 9b7103ecb0..fcacc6d5a2 100644
--- a/ql/src/test/results/compiler/plan/join7.q.xml
+++ b/ql/src/test/results/compiler/plan/join7.q.xml
@@ -68,7 +68,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+         <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
           <void property="inputFileFormatClass"> 
            <class>org.apache.hadoop.mapred.TextInputFormat</class> 
           </void> 
@@ -204,82 +204,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-          <void property="inputFileFormatClass"> 
-           <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-          </void> 
-          <void property="outputFileFormatClass"> 
-           <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-          </void> 
-          <void property="properties"> 
-           <object class="java.util.Properties"> 
-            <void method="put"> 
-             <string>name</string> 
-             <string>default.src</string> 
-            </void> 
-            <void method="put"> 
-             <string>numFiles</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns.types</string> 
-             <string>string:string</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.ddl</string> 
-             <string>struct src { string key, string value}</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.format</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns</string> 
-             <string>key,value</string> 
-            </void> 
-            <void method="put"> 
-             <string>rawDataSize</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>numRows</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_count</string> 
-             <string>-1</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.lib</string> 
-             <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-            </void> 
-            <void method="put"> 
-             <string>COLUMN_STATS_ACCURATE</string> 
-             <string>true</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.inputformat</string> 
-             <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>totalSize</string> 
-             <string>5812</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.outputformat</string> 
-             <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>location</string> 
-             #### A masked pattern was here #### 
-            </void> 
-            <void method="put"> 
-             <string>transient_lastDdlTime</string> 
-             #### A masked pattern was here #### 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <object idref="TableDesc0"/> 
         </void> 
        </object> 
       </void> 
@@ -340,82 +265,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-          <void property="inputFileFormatClass"> 
-           <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-          </void> 
-          <void property="outputFileFormatClass"> 
-           <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-          </void> 
-          <void property="properties"> 
-           <object class="java.util.Properties"> 
-            <void method="put"> 
-             <string>name</string> 
-             <string>default.src</string> 
-            </void> 
-            <void method="put"> 
-             <string>numFiles</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns.types</string> 
-             <string>string:string</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.ddl</string> 
-             <string>struct src { string key, string value}</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.format</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns</string> 
-             <string>key,value</string> 
-            </void> 
-            <void method="put"> 
-             <string>rawDataSize</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>numRows</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_count</string> 
-             <string>-1</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.lib</string> 
-             <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-            </void> 
-            <void method="put"> 
-             <string>COLUMN_STATS_ACCURATE</string> 
-             <string>true</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.inputformat</string> 
-             <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>totalSize</string> 
-             <string>5812</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.outputformat</string> 
-             <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>location</string> 
-             #### A masked pattern was here #### 
-            </void> 
-            <void method="put"> 
-             <string>transient_lastDdlTime</string> 
-             #### A masked pattern was here #### 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <object idref="TableDesc0"/> 
         </void> 
        </object> 
       </void> 
@@ -549,7 +399,7 @@
                     </object> 
                    </void> 
                    <void property="valueSerializeInfo"> 
-                    <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                    <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                      <void property="inputFileFormatClass"> 
                       <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
                      </void> 
@@ -1104,7 +954,7 @@
                     </object> 
                    </void> 
                    <void property="valueSerializeInfo"> 
-                    <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                    <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                      <void property="inputFileFormatClass"> 
                       <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
                      </void> 
@@ -1578,7 +1428,7 @@
                     </object> 
                    </void> 
                    <void property="keySerializeInfo"> 
-                    <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                    <object id="TableDesc3" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                      <void property="inputFileFormatClass"> 
                       <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
                      </void> 
@@ -1647,7 +1497,7 @@
                     </object> 
                    </void> 
                    <void property="valueSerializeInfo"> 
-                    <object id="TableDesc3" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                    <object id="TableDesc4" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                      <void property="inputFileFormatClass"> 
                       <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
                      </void> 
@@ -2165,82 +2015,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-          <void property="inputFileFormatClass"> 
-           <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-          </void> 
-          <void property="outputFileFormatClass"> 
-           <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-          </void> 
-          <void property="properties"> 
-           <object class="java.util.Properties"> 
-            <void method="put"> 
-             <string>name</string> 
-             <string>default.src</string> 
-            </void> 
-            <void method="put"> 
-             <string>numFiles</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns.types</string> 
-             <string>string:string</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.ddl</string> 
-             <string>struct src { string key, string value}</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.format</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns</string> 
-             <string>key,value</string> 
-            </void> 
-            <void method="put"> 
-             <string>rawDataSize</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>numRows</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_count</string> 
-             <string>-1</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.lib</string> 
-             <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-            </void> 
-            <void method="put"> 
-             <string>COLUMN_STATS_ACCURATE</string> 
-             <string>true</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.inputformat</string> 
-             <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>totalSize</string> 
-             <string>5812</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.outputformat</string> 
-             <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>location</string> 
-             #### A masked pattern was here #### 
-            </void> 
-            <void method="put"> 
-             <string>transient_lastDdlTime</string> 
-             #### A masked pattern was here #### 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <object idref="TableDesc0"/> 
         </void> 
        </object> 
       </void> 
@@ -2249,7 +2024,7 @@
     <void property="reduceWork"> 
      <object class="org.apache.hadoop.hive.ql.plan.ReduceWork"> 
       <void property="keyDesc"> 
-       <object idref="TableDesc2"/> 
+       <object idref="TableDesc3"/> 
       </void> 
       <void property="needsTagging"> 
        <boolean>true</boolean> 
@@ -3110,13 +2885,13 @@
       </void> 
       <void property="tagToValueDesc"> 
        <void method="add"> 
-        <object idref="TableDesc0"/> 
+        <object idref="TableDesc1"/> 
        </void> 
        <void method="add"> 
-        <object idref="TableDesc1"/> 
+        <object idref="TableDesc2"/> 
        </void> 
        <void method="add"> 
-        <object idref="TableDesc3"/> 
+        <object idref="TableDesc4"/> 
        </void> 
       </void> 
      </object> 
diff --git a/ql/src/test/results/compiler/plan/join8.q.xml b/ql/src/test/results/compiler/plan/join8.q.xml
index 7e2834f86c..c7591a4e3f 100644
--- a/ql/src/test/results/compiler/plan/join8.q.xml
+++ b/ql/src/test/results/compiler/plan/join8.q.xml
@@ -68,7 +68,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+         <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
           <void property="inputFileFormatClass"> 
            <class>org.apache.hadoop.mapred.TextInputFormat</class> 
           </void> 
@@ -204,82 +204,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-          <void property="inputFileFormatClass"> 
-           <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-          </void> 
-          <void property="outputFileFormatClass"> 
-           <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-          </void> 
-          <void property="properties"> 
-           <object class="java.util.Properties"> 
-            <void method="put"> 
-             <string>name</string> 
-             <string>default.src</string> 
-            </void> 
-            <void method="put"> 
-             <string>numFiles</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns.types</string> 
-             <string>string:string</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.ddl</string> 
-             <string>struct src { string key, string value}</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.format</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns</string> 
-             <string>key,value</string> 
-            </void> 
-            <void method="put"> 
-             <string>rawDataSize</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>numRows</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_count</string> 
-             <string>-1</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.lib</string> 
-             <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-            </void> 
-            <void method="put"> 
-             <string>COLUMN_STATS_ACCURATE</string> 
-             <string>true</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.inputformat</string> 
-             <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>totalSize</string> 
-             <string>5812</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.outputformat</string> 
-             <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>location</string> 
-             #### A masked pattern was here #### 
-            </void> 
-            <void method="put"> 
-             <string>transient_lastDdlTime</string> 
-             #### A masked pattern was here #### 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <object idref="TableDesc0"/> 
         </void> 
        </object> 
       </void> 
@@ -413,7 +338,7 @@
                     </object> 
                    </void> 
                    <void property="valueSerializeInfo"> 
-                    <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                    <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                      <void property="inputFileFormatClass"> 
                       <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
                      </void> 
@@ -940,7 +865,7 @@
                     </object> 
                    </void> 
                    <void property="keySerializeInfo"> 
-                    <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                    <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                      <void property="inputFileFormatClass"> 
                       <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
                      </void> 
@@ -1009,7 +934,7 @@
                     </object> 
                    </void> 
                    <void property="valueSerializeInfo"> 
-                    <object id="TableDesc2" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                    <object id="TableDesc3" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                      <void property="inputFileFormatClass"> 
                       <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
                      </void> 
@@ -1565,82 +1490,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-          <void property="inputFileFormatClass"> 
-           <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-          </void> 
-          <void property="outputFileFormatClass"> 
-           <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-          </void> 
-          <void property="properties"> 
-           <object class="java.util.Properties"> 
-            <void method="put"> 
-             <string>name</string> 
-             <string>default.src</string> 
-            </void> 
-            <void method="put"> 
-             <string>numFiles</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns.types</string> 
-             <string>string:string</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.ddl</string> 
-             <string>struct src { string key, string value}</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.format</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns</string> 
-             <string>key,value</string> 
-            </void> 
-            <void method="put"> 
-             <string>rawDataSize</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>numRows</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_count</string> 
-             <string>-1</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.lib</string> 
-             <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-            </void> 
-            <void method="put"> 
-             <string>COLUMN_STATS_ACCURATE</string> 
-             <string>true</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.inputformat</string> 
-             <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>totalSize</string> 
-             <string>5812</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.outputformat</string> 
-             <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>location</string> 
-             #### A masked pattern was here #### 
-            </void> 
-            <void method="put"> 
-             <string>transient_lastDdlTime</string> 
-             #### A masked pattern was here #### 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <object idref="TableDesc0"/> 
         </void> 
        </object> 
       </void> 
@@ -1649,7 +1499,7 @@
     <void property="reduceWork"> 
      <object class="org.apache.hadoop.hive.ql.plan.ReduceWork"> 
       <void property="keyDesc"> 
-       <object idref="TableDesc1"/> 
+       <object idref="TableDesc2"/> 
       </void> 
       <void property="needsTagging"> 
        <boolean>true</boolean> 
@@ -2336,10 +2186,10 @@
       </void> 
       <void property="tagToValueDesc"> 
        <void method="add"> 
-        <object idref="TableDesc0"/> 
+        <object idref="TableDesc1"/> 
        </void> 
        <void method="add"> 
-        <object idref="TableDesc2"/> 
+        <object idref="TableDesc3"/> 
        </void> 
       </void> 
      </object> 
diff --git a/ql/src/test/results/compiler/plan/sample1.q.xml b/ql/src/test/results/compiler/plan/sample1.q.xml
index f6e34264ac..2021f69939 100644
--- a/ql/src/test/results/compiler/plan/sample1.q.xml
+++ b/ql/src/test/results/compiler/plan/sample1.q.xml
@@ -105,7 +105,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+         <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
           <void property="inputFileFormatClass"> 
            <class>org.apache.hadoop.mapred.TextInputFormat</class> 
           </void> 
@@ -952,66 +952,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-          <void property="inputFileFormatClass"> 
-           <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-          </void> 
-          <void property="outputFileFormatClass"> 
-           <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-          </void> 
-          <void property="properties"> 
-           <object class="java.util.Properties"> 
-            <void method="put"> 
-             <string>name</string> 
-             <string>default.srcpart</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns.types</string> 
-             <string>string:string</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.ddl</string> 
-             <string>struct srcpart { string key, string value}</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.format</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns</string> 
-             <string>key,value</string> 
-            </void> 
-            <void method="put"> 
-             <string>partition_columns</string> 
-             <string>ds/hr</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_count</string> 
-             <string>-1</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.lib</string> 
-             <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.inputformat</string> 
-             <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.outputformat</string> 
-             <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>location</string> 
-             #### A masked pattern was here #### 
-            </void> 
-            <void method="put"> 
-             <string>transient_lastDdlTime</string> 
-             #### A masked pattern was here #### 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <object idref="TableDesc0"/> 
         </void> 
        </object> 
       </void> 
diff --git a/ql/src/test/results/compiler/plan/sample2.q.xml b/ql/src/test/results/compiler/plan/sample2.q.xml
index 6bf5a0bafa..c8998f4221 100644
--- a/ql/src/test/results/compiler/plan/sample2.q.xml
+++ b/ql/src/test/results/compiler/plan/sample2.q.xml
@@ -319,7 +319,7 @@
                          </object> 
                         </void> 
                         <void property="tableDesc"> 
-                         <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                           <void property="inputFileFormatClass"> 
                            <class>org.apache.hadoop.mapred.TextInputFormat</class> 
                           </void> 
@@ -417,7 +417,62 @@
                    <boolean>true</boolean> 
                   </void> 
                   <void property="table"> 
-                   <object idref="TableDesc0"/> 
+                   <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                    <void property="inputFileFormatClass"> 
+                     <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                    </void> 
+                    <void property="outputFileFormatClass"> 
+                     <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                    </void> 
+                    <void property="properties"> 
+                     <object class="java.util.Properties"> 
+                      <void method="put"> 
+                       <string>name</string> 
+                       <string>default.dest1</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>columns.types</string> 
+                       <string>string:string</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>serialization.ddl</string> 
+                       <string>struct dest1 { string key, string value}</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>serialization.format</string> 
+                       <string>1</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>columns</string> 
+                       <string>key,value</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>bucket_count</string> 
+                       <string>-1</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>serialization.lib</string> 
+                       <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>file.inputformat</string> 
+                       <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>file.outputformat</string> 
+                       <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>location</string> 
+                       #### A masked pattern was here #### 
+                      </void> 
+                      <void method="put"> 
+                       <string>transient_lastDdlTime</string> 
+                       #### A masked pattern was here #### 
+                      </void> 
+                     </object> 
+                    </void> 
+                   </object> 
                   </void> 
                  </object> 
                 </void> 
@@ -555,7 +610,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+         <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
           <void property="inputFileFormatClass"> 
            <class>org.apache.hadoop.mapred.TextInputFormat</class> 
           </void> 
@@ -1184,86 +1239,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-          <void property="inputFileFormatClass"> 
-           <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-          </void> 
-          <void property="outputFileFormatClass"> 
-           <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-          </void> 
-          <void property="properties"> 
-           <object class="java.util.Properties"> 
-            <void method="put"> 
-             <string>name</string> 
-             <string>default.srcbucket</string> 
-            </void> 
-            <void method="put"> 
-             <string>numFiles</string> 
-             <string>2</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns.types</string> 
-             <string>int:string</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_field_name</string> 
-             <string>key</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.ddl</string> 
-             <string>struct srcbucket { i32 key, string value}</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns</string> 
-             <string>key,value</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.format</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>rawDataSize</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>numRows</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_count</string> 
-             <string>2</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.lib</string> 
-             <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-            </void> 
-            <void method="put"> 
-             <string>COLUMN_STATS_ACCURATE</string> 
-             <string>true</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.inputformat</string> 
-             <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>totalSize</string> 
-             <string>11603</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.outputformat</string> 
-             <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>location</string> 
-             #### A masked pattern was here #### 
-            </void> 
-            <void method="put"> 
-             <string>transient_lastDdlTime</string> 
-             #### A masked pattern was here #### 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <object idref="TableDesc1"/> 
         </void> 
        </object> 
       </void> 
diff --git a/ql/src/test/results/compiler/plan/sample3.q.xml b/ql/src/test/results/compiler/plan/sample3.q.xml
index 15c510a95d..f12a43bfc4 100644
--- a/ql/src/test/results/compiler/plan/sample3.q.xml
+++ b/ql/src/test/results/compiler/plan/sample3.q.xml
@@ -319,7 +319,7 @@
                          </object> 
                         </void> 
                         <void property="tableDesc"> 
-                         <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                           <void property="inputFileFormatClass"> 
                            <class>org.apache.hadoop.mapred.TextInputFormat</class> 
                           </void> 
@@ -417,7 +417,62 @@
                    <boolean>true</boolean> 
                   </void> 
                   <void property="table"> 
-                   <object idref="TableDesc0"/> 
+                   <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                    <void property="inputFileFormatClass"> 
+                     <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                    </void> 
+                    <void property="outputFileFormatClass"> 
+                     <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                    </void> 
+                    <void property="properties"> 
+                     <object class="java.util.Properties"> 
+                      <void method="put"> 
+                       <string>name</string> 
+                       <string>default.dest1</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>columns.types</string> 
+                       <string>string:string</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>serialization.ddl</string> 
+                       <string>struct dest1 { string key, string value}</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>serialization.format</string> 
+                       <string>1</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>columns</string> 
+                       <string>key,value</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>bucket_count</string> 
+                       <string>-1</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>serialization.lib</string> 
+                       <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>file.inputformat</string> 
+                       <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>file.outputformat</string> 
+                       <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>location</string> 
+                       #### A masked pattern was here #### 
+                      </void> 
+                      <void method="put"> 
+                       <string>transient_lastDdlTime</string> 
+                       #### A masked pattern was here #### 
+                      </void> 
+                     </object> 
+                    </void> 
+                   </object> 
                   </void> 
                  </object> 
                 </void> 
@@ -555,7 +610,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+         <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
           <void property="inputFileFormatClass"> 
            <class>org.apache.hadoop.mapred.TextInputFormat</class> 
           </void> 
@@ -1194,86 +1249,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-          <void property="inputFileFormatClass"> 
-           <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-          </void> 
-          <void property="outputFileFormatClass"> 
-           <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-          </void> 
-          <void property="properties"> 
-           <object class="java.util.Properties"> 
-            <void method="put"> 
-             <string>name</string> 
-             <string>default.srcbucket</string> 
-            </void> 
-            <void method="put"> 
-             <string>numFiles</string> 
-             <string>2</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns.types</string> 
-             <string>int:string</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_field_name</string> 
-             <string>key</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.ddl</string> 
-             <string>struct srcbucket { i32 key, string value}</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns</string> 
-             <string>key,value</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.format</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>rawDataSize</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>numRows</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_count</string> 
-             <string>2</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.lib</string> 
-             <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-            </void> 
-            <void method="put"> 
-             <string>COLUMN_STATS_ACCURATE</string> 
-             <string>true</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.inputformat</string> 
-             <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>totalSize</string> 
-             <string>11603</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.outputformat</string> 
-             <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>location</string> 
-             #### A masked pattern was here #### 
-            </void> 
-            <void method="put"> 
-             <string>transient_lastDdlTime</string> 
-             #### A masked pattern was here #### 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <object idref="TableDesc1"/> 
         </void> 
        </object> 
       </void> 
diff --git a/ql/src/test/results/compiler/plan/sample4.q.xml b/ql/src/test/results/compiler/plan/sample4.q.xml
index 6bf5a0bafa..c8998f4221 100644
--- a/ql/src/test/results/compiler/plan/sample4.q.xml
+++ b/ql/src/test/results/compiler/plan/sample4.q.xml
@@ -319,7 +319,7 @@
                          </object> 
                         </void> 
                         <void property="tableDesc"> 
-                         <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                           <void property="inputFileFormatClass"> 
                            <class>org.apache.hadoop.mapred.TextInputFormat</class> 
                           </void> 
@@ -417,7 +417,62 @@
                    <boolean>true</boolean> 
                   </void> 
                   <void property="table"> 
-                   <object idref="TableDesc0"/> 
+                   <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                    <void property="inputFileFormatClass"> 
+                     <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                    </void> 
+                    <void property="outputFileFormatClass"> 
+                     <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                    </void> 
+                    <void property="properties"> 
+                     <object class="java.util.Properties"> 
+                      <void method="put"> 
+                       <string>name</string> 
+                       <string>default.dest1</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>columns.types</string> 
+                       <string>string:string</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>serialization.ddl</string> 
+                       <string>struct dest1 { string key, string value}</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>serialization.format</string> 
+                       <string>1</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>columns</string> 
+                       <string>key,value</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>bucket_count</string> 
+                       <string>-1</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>serialization.lib</string> 
+                       <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>file.inputformat</string> 
+                       <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>file.outputformat</string> 
+                       <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>location</string> 
+                       #### A masked pattern was here #### 
+                      </void> 
+                      <void method="put"> 
+                       <string>transient_lastDdlTime</string> 
+                       #### A masked pattern was here #### 
+                      </void> 
+                     </object> 
+                    </void> 
+                   </object> 
                   </void> 
                  </object> 
                 </void> 
@@ -555,7 +610,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+         <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
           <void property="inputFileFormatClass"> 
            <class>org.apache.hadoop.mapred.TextInputFormat</class> 
           </void> 
@@ -1184,86 +1239,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-          <void property="inputFileFormatClass"> 
-           <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-          </void> 
-          <void property="outputFileFormatClass"> 
-           <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-          </void> 
-          <void property="properties"> 
-           <object class="java.util.Properties"> 
-            <void method="put"> 
-             <string>name</string> 
-             <string>default.srcbucket</string> 
-            </void> 
-            <void method="put"> 
-             <string>numFiles</string> 
-             <string>2</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns.types</string> 
-             <string>int:string</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_field_name</string> 
-             <string>key</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.ddl</string> 
-             <string>struct srcbucket { i32 key, string value}</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns</string> 
-             <string>key,value</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.format</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>rawDataSize</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>numRows</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_count</string> 
-             <string>2</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.lib</string> 
-             <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-            </void> 
-            <void method="put"> 
-             <string>COLUMN_STATS_ACCURATE</string> 
-             <string>true</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.inputformat</string> 
-             <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>totalSize</string> 
-             <string>11603</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.outputformat</string> 
-             <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>location</string> 
-             #### A masked pattern was here #### 
-            </void> 
-            <void method="put"> 
-             <string>transient_lastDdlTime</string> 
-             #### A masked pattern was here #### 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <object idref="TableDesc1"/> 
         </void> 
        </object> 
       </void> 
diff --git a/ql/src/test/results/compiler/plan/sample5.q.xml b/ql/src/test/results/compiler/plan/sample5.q.xml
index 2fee7ccd1b..aaee234966 100644
--- a/ql/src/test/results/compiler/plan/sample5.q.xml
+++ b/ql/src/test/results/compiler/plan/sample5.q.xml
@@ -319,7 +319,7 @@
                          </object> 
                         </void> 
                         <void property="tableDesc"> 
-                         <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                           <void property="inputFileFormatClass"> 
                            <class>org.apache.hadoop.mapred.TextInputFormat</class> 
                           </void> 
@@ -417,7 +417,62 @@
                    <boolean>true</boolean> 
                   </void> 
                   <void property="table"> 
-                   <object idref="TableDesc0"/> 
+                   <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                    <void property="inputFileFormatClass"> 
+                     <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                    </void> 
+                    <void property="outputFileFormatClass"> 
+                     <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                    </void> 
+                    <void property="properties"> 
+                     <object class="java.util.Properties"> 
+                      <void method="put"> 
+                       <string>name</string> 
+                       <string>default.dest1</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>columns.types</string> 
+                       <string>string:string</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>serialization.ddl</string> 
+                       <string>struct dest1 { string key, string value}</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>serialization.format</string> 
+                       <string>1</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>columns</string> 
+                       <string>key,value</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>bucket_count</string> 
+                       <string>-1</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>serialization.lib</string> 
+                       <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>file.inputformat</string> 
+                       <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>file.outputformat</string> 
+                       <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>location</string> 
+                       #### A masked pattern was here #### 
+                      </void> 
+                      <void method="put"> 
+                       <string>transient_lastDdlTime</string> 
+                       #### A masked pattern was here #### 
+                      </void> 
+                     </object> 
+                    </void> 
+                   </object> 
                   </void> 
                  </object> 
                 </void> 
@@ -555,7 +610,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+         <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
           <void property="inputFileFormatClass"> 
            <class>org.apache.hadoop.mapred.TextInputFormat</class> 
           </void> 
@@ -1181,86 +1236,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-          <void property="inputFileFormatClass"> 
-           <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-          </void> 
-          <void property="outputFileFormatClass"> 
-           <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-          </void> 
-          <void property="properties"> 
-           <object class="java.util.Properties"> 
-            <void method="put"> 
-             <string>name</string> 
-             <string>default.srcbucket</string> 
-            </void> 
-            <void method="put"> 
-             <string>numFiles</string> 
-             <string>2</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns.types</string> 
-             <string>int:string</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_field_name</string> 
-             <string>key</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.ddl</string> 
-             <string>struct srcbucket { i32 key, string value}</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns</string> 
-             <string>key,value</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.format</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>rawDataSize</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>numRows</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_count</string> 
-             <string>2</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.lib</string> 
-             <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-            </void> 
-            <void method="put"> 
-             <string>COLUMN_STATS_ACCURATE</string> 
-             <string>true</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.inputformat</string> 
-             <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>totalSize</string> 
-             <string>11603</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.outputformat</string> 
-             <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>location</string> 
-             #### A masked pattern was here #### 
-            </void> 
-            <void method="put"> 
-             <string>transient_lastDdlTime</string> 
-             #### A masked pattern was here #### 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <object idref="TableDesc1"/> 
         </void> 
        </object> 
       </void> 
diff --git a/ql/src/test/results/compiler/plan/sample6.q.xml b/ql/src/test/results/compiler/plan/sample6.q.xml
index 467b92662e..3dc8a84536 100644
--- a/ql/src/test/results/compiler/plan/sample6.q.xml
+++ b/ql/src/test/results/compiler/plan/sample6.q.xml
@@ -319,7 +319,7 @@
                          </object> 
                         </void> 
                         <void property="tableDesc"> 
-                         <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                           <void property="inputFileFormatClass"> 
                            <class>org.apache.hadoop.mapred.TextInputFormat</class> 
                           </void> 
@@ -417,7 +417,62 @@
                    <boolean>true</boolean> 
                   </void> 
                   <void property="table"> 
-                   <object idref="TableDesc0"/> 
+                   <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                    <void property="inputFileFormatClass"> 
+                     <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                    </void> 
+                    <void property="outputFileFormatClass"> 
+                     <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                    </void> 
+                    <void property="properties"> 
+                     <object class="java.util.Properties"> 
+                      <void method="put"> 
+                       <string>name</string> 
+                       <string>default.dest1</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>columns.types</string> 
+                       <string>string:string</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>serialization.ddl</string> 
+                       <string>struct dest1 { string key, string value}</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>serialization.format</string> 
+                       <string>1</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>columns</string> 
+                       <string>key,value</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>bucket_count</string> 
+                       <string>-1</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>serialization.lib</string> 
+                       <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>file.inputformat</string> 
+                       <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>file.outputformat</string> 
+                       <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>location</string> 
+                       #### A masked pattern was here #### 
+                      </void> 
+                      <void method="put"> 
+                       <string>transient_lastDdlTime</string> 
+                       #### A masked pattern was here #### 
+                      </void> 
+                     </object> 
+                    </void> 
+                   </object> 
                   </void> 
                  </object> 
                 </void> 
@@ -555,7 +610,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+         <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
           <void property="inputFileFormatClass"> 
            <class>org.apache.hadoop.mapred.TextInputFormat</class> 
           </void> 
@@ -1184,86 +1239,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-          <void property="inputFileFormatClass"> 
-           <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-          </void> 
-          <void property="outputFileFormatClass"> 
-           <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-          </void> 
-          <void property="properties"> 
-           <object class="java.util.Properties"> 
-            <void method="put"> 
-             <string>name</string> 
-             <string>default.srcbucket</string> 
-            </void> 
-            <void method="put"> 
-             <string>numFiles</string> 
-             <string>2</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns.types</string> 
-             <string>int:string</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_field_name</string> 
-             <string>key</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.ddl</string> 
-             <string>struct srcbucket { i32 key, string value}</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns</string> 
-             <string>key,value</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.format</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>rawDataSize</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>numRows</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_count</string> 
-             <string>2</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.lib</string> 
-             <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-            </void> 
-            <void method="put"> 
-             <string>COLUMN_STATS_ACCURATE</string> 
-             <string>true</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.inputformat</string> 
-             <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>totalSize</string> 
-             <string>11603</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.outputformat</string> 
-             <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>location</string> 
-             #### A masked pattern was here #### 
-            </void> 
-            <void method="put"> 
-             <string>transient_lastDdlTime</string> 
-             #### A masked pattern was here #### 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <object idref="TableDesc1"/> 
         </void> 
        </object> 
       </void> 
diff --git a/ql/src/test/results/compiler/plan/sample7.q.xml b/ql/src/test/results/compiler/plan/sample7.q.xml
index 71eb63de2c..9bfe9a8fa0 100644
--- a/ql/src/test/results/compiler/plan/sample7.q.xml
+++ b/ql/src/test/results/compiler/plan/sample7.q.xml
@@ -319,7 +319,7 @@
                          </object> 
                         </void> 
                         <void property="tableDesc"> 
-                         <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                           <void property="inputFileFormatClass"> 
                            <class>org.apache.hadoop.mapred.TextInputFormat</class> 
                           </void> 
@@ -417,7 +417,62 @@
                    <boolean>true</boolean> 
                   </void> 
                   <void property="table"> 
-                   <object idref="TableDesc0"/> 
+                   <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                    <void property="inputFileFormatClass"> 
+                     <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                    </void> 
+                    <void property="outputFileFormatClass"> 
+                     <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                    </void> 
+                    <void property="properties"> 
+                     <object class="java.util.Properties"> 
+                      <void method="put"> 
+                       <string>name</string> 
+                       <string>default.dest1</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>columns.types</string> 
+                       <string>string:string</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>serialization.ddl</string> 
+                       <string>struct dest1 { string key, string value}</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>serialization.format</string> 
+                       <string>1</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>columns</string> 
+                       <string>key,value</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>bucket_count</string> 
+                       <string>-1</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>serialization.lib</string> 
+                       <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>file.inputformat</string> 
+                       <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>file.outputformat</string> 
+                       <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+                      </void> 
+                      <void method="put"> 
+                       <string>location</string> 
+                       #### A masked pattern was here #### 
+                      </void> 
+                      <void method="put"> 
+                       <string>transient_lastDdlTime</string> 
+                       #### A masked pattern was here #### 
+                      </void> 
+                     </object> 
+                    </void> 
+                   </object> 
                   </void> 
                  </object> 
                 </void> 
@@ -555,7 +610,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+         <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
           <void property="inputFileFormatClass"> 
            <class>org.apache.hadoop.mapred.TextInputFormat</class> 
           </void> 
@@ -1229,86 +1284,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-          <void property="inputFileFormatClass"> 
-           <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-          </void> 
-          <void property="outputFileFormatClass"> 
-           <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-          </void> 
-          <void property="properties"> 
-           <object class="java.util.Properties"> 
-            <void method="put"> 
-             <string>name</string> 
-             <string>default.srcbucket</string> 
-            </void> 
-            <void method="put"> 
-             <string>numFiles</string> 
-             <string>2</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns.types</string> 
-             <string>int:string</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_field_name</string> 
-             <string>key</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.ddl</string> 
-             <string>struct srcbucket { i32 key, string value}</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns</string> 
-             <string>key,value</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.format</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>rawDataSize</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>numRows</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_count</string> 
-             <string>2</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.lib</string> 
-             <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-            </void> 
-            <void method="put"> 
-             <string>COLUMN_STATS_ACCURATE</string> 
-             <string>true</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.inputformat</string> 
-             <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>totalSize</string> 
-             <string>11603</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.outputformat</string> 
-             <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>location</string> 
-             #### A masked pattern was here #### 
-            </void> 
-            <void method="put"> 
-             <string>transient_lastDdlTime</string> 
-             #### A masked pattern was here #### 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <object idref="TableDesc1"/> 
         </void> 
        </object> 
       </void> 
diff --git a/ql/src/test/results/compiler/plan/subq.q.xml b/ql/src/test/results/compiler/plan/subq.q.xml
index 5005faef07..38366e6780 100644
--- a/ql/src/test/results/compiler/plan/subq.q.xml
+++ b/ql/src/test/results/compiler/plan/subq.q.xml
@@ -438,7 +438,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+         <object id="TableDesc1" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
           <void property="inputFileFormatClass"> 
            <class>org.apache.hadoop.mapred.TextInputFormat</class> 
           </void> 
@@ -975,82 +975,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-          <void property="inputFileFormatClass"> 
-           <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-          </void> 
-          <void property="outputFileFormatClass"> 
-           <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-          </void> 
-          <void property="properties"> 
-           <object class="java.util.Properties"> 
-            <void method="put"> 
-             <string>name</string> 
-             <string>default.src</string> 
-            </void> 
-            <void method="put"> 
-             <string>numFiles</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns.types</string> 
-             <string>string:string</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.ddl</string> 
-             <string>struct src { string key, string value}</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.format</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns</string> 
-             <string>key,value</string> 
-            </void> 
-            <void method="put"> 
-             <string>rawDataSize</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>numRows</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_count</string> 
-             <string>-1</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.lib</string> 
-             <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-            </void> 
-            <void method="put"> 
-             <string>COLUMN_STATS_ACCURATE</string> 
-             <string>true</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.inputformat</string> 
-             <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>totalSize</string> 
-             <string>5812</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.outputformat</string> 
-             <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>location</string> 
-             #### A masked pattern was here #### 
-            </void> 
-            <void method="put"> 
-             <string>transient_lastDdlTime</string> 
-             #### A masked pattern was here #### 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <object idref="TableDesc1"/> 
         </void> 
        </object> 
       </void> 
diff --git a/ql/src/test/results/compiler/plan/udf1.q.xml b/ql/src/test/results/compiler/plan/udf1.q.xml
index d433ccb7cc..ec0e2e11dd 100644
--- a/ql/src/test/results/compiler/plan/udf1.q.xml
+++ b/ql/src/test/results/compiler/plan/udf1.q.xml
@@ -68,7 +68,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+         <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
           <void property="inputFileFormatClass"> 
            <class>org.apache.hadoop.mapred.TextInputFormat</class> 
           </void> 
@@ -1995,82 +1995,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-          <void property="inputFileFormatClass"> 
-           <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-          </void> 
-          <void property="outputFileFormatClass"> 
-           <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-          </void> 
-          <void property="properties"> 
-           <object class="java.util.Properties"> 
-            <void method="put"> 
-             <string>name</string> 
-             <string>default.src</string> 
-            </void> 
-            <void method="put"> 
-             <string>numFiles</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns.types</string> 
-             <string>string:string</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.ddl</string> 
-             <string>struct src { string key, string value}</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.format</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns</string> 
-             <string>key,value</string> 
-            </void> 
-            <void method="put"> 
-             <string>rawDataSize</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>numRows</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_count</string> 
-             <string>-1</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.lib</string> 
-             <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-            </void> 
-            <void method="put"> 
-             <string>COLUMN_STATS_ACCURATE</string> 
-             <string>true</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.inputformat</string> 
-             <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>totalSize</string> 
-             <string>5812</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.outputformat</string> 
-             <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>location</string> 
-             #### A masked pattern was here #### 
-            </void> 
-            <void method="put"> 
-             <string>transient_lastDdlTime</string> 
-             #### A masked pattern was here #### 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <object idref="TableDesc0"/> 
         </void> 
        </object> 
       </void> 
diff --git a/ql/src/test/results/compiler/plan/udf4.q.xml b/ql/src/test/results/compiler/plan/udf4.q.xml
index 56acdd105c..207e5b0bd2 100644
--- a/ql/src/test/results/compiler/plan/udf4.q.xml
+++ b/ql/src/test/results/compiler/plan/udf4.q.xml
@@ -68,7 +68,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+         <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
           <void property="inputFileFormatClass"> 
            <class>org.apache.hadoop.mapred.TextInputFormat</class> 
           </void> 
@@ -1753,62 +1753,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-          <void property="inputFileFormatClass"> 
-           <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-          </void> 
-          <void property="outputFileFormatClass"> 
-           <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-          </void> 
-          <void property="properties"> 
-           <object class="java.util.Properties"> 
-            <void method="put"> 
-             <string>name</string> 
-             <string>default.dest1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns.types</string> 
-             <string>string:string</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.ddl</string> 
-             <string>struct dest1 { string key, string value}</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.format</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns</string> 
-             <string>key,value</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_count</string> 
-             <string>-1</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.lib</string> 
-             <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.inputformat</string> 
-             <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.outputformat</string> 
-             <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>location</string> 
-             #### A masked pattern was here #### 
-            </void> 
-            <void method="put"> 
-             <string>transient_lastDdlTime</string> 
-             #### A masked pattern was here #### 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <object idref="TableDesc0"/> 
         </void> 
        </object> 
       </void> 
diff --git a/ql/src/test/results/compiler/plan/udf6.q.xml b/ql/src/test/results/compiler/plan/udf6.q.xml
index a15cf9bc95..cea326e31c 100644
--- a/ql/src/test/results/compiler/plan/udf6.q.xml
+++ b/ql/src/test/results/compiler/plan/udf6.q.xml
@@ -68,7 +68,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+         <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
           <void property="inputFileFormatClass"> 
            <class>org.apache.hadoop.mapred.TextInputFormat</class> 
           </void> 
@@ -638,82 +638,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-          <void property="inputFileFormatClass"> 
-           <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-          </void> 
-          <void property="outputFileFormatClass"> 
-           <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-          </void> 
-          <void property="properties"> 
-           <object class="java.util.Properties"> 
-            <void method="put"> 
-             <string>name</string> 
-             <string>default.src</string> 
-            </void> 
-            <void method="put"> 
-             <string>numFiles</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns.types</string> 
-             <string>string:string</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.ddl</string> 
-             <string>struct src { string key, string value}</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.format</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns</string> 
-             <string>key,value</string> 
-            </void> 
-            <void method="put"> 
-             <string>rawDataSize</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>numRows</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_count</string> 
-             <string>-1</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.lib</string> 
-             <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-            </void> 
-            <void method="put"> 
-             <string>COLUMN_STATS_ACCURATE</string> 
-             <string>true</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.inputformat</string> 
-             <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>totalSize</string> 
-             <string>5812</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.outputformat</string> 
-             <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>location</string> 
-             #### A masked pattern was here #### 
-            </void> 
-            <void method="put"> 
-             <string>transient_lastDdlTime</string> 
-             #### A masked pattern was here #### 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <object idref="TableDesc0"/> 
         </void> 
        </object> 
       </void> 
diff --git a/ql/src/test/results/compiler/plan/udf_case.q.xml b/ql/src/test/results/compiler/plan/udf_case.q.xml
index cf7f3565b2..c155bb0848 100644
--- a/ql/src/test/results/compiler/plan/udf_case.q.xml
+++ b/ql/src/test/results/compiler/plan/udf_case.q.xml
@@ -68,7 +68,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+         <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
           <void property="inputFileFormatClass"> 
            <class>org.apache.hadoop.mapred.TextInputFormat</class> 
           </void> 
@@ -722,82 +722,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-          <void property="inputFileFormatClass"> 
-           <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-          </void> 
-          <void property="outputFileFormatClass"> 
-           <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-          </void> 
-          <void property="properties"> 
-           <object class="java.util.Properties"> 
-            <void method="put"> 
-             <string>name</string> 
-             <string>default.src</string> 
-            </void> 
-            <void method="put"> 
-             <string>numFiles</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns.types</string> 
-             <string>string:string</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.ddl</string> 
-             <string>struct src { string key, string value}</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.format</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns</string> 
-             <string>key,value</string> 
-            </void> 
-            <void method="put"> 
-             <string>rawDataSize</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>numRows</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_count</string> 
-             <string>-1</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.lib</string> 
-             <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-            </void> 
-            <void method="put"> 
-             <string>COLUMN_STATS_ACCURATE</string> 
-             <string>true</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.inputformat</string> 
-             <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>totalSize</string> 
-             <string>5812</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.outputformat</string> 
-             <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>location</string> 
-             #### A masked pattern was here #### 
-            </void> 
-            <void method="put"> 
-             <string>transient_lastDdlTime</string> 
-             #### A masked pattern was here #### 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <object idref="TableDesc0"/> 
         </void> 
        </object> 
       </void> 
diff --git a/ql/src/test/results/compiler/plan/udf_when.q.xml b/ql/src/test/results/compiler/plan/udf_when.q.xml
index 039d5484e4..0bc4b7f40d 100644
--- a/ql/src/test/results/compiler/plan/udf_when.q.xml
+++ b/ql/src/test/results/compiler/plan/udf_when.q.xml
@@ -68,7 +68,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+         <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
           <void property="inputFileFormatClass"> 
            <class>org.apache.hadoop.mapred.TextInputFormat</class> 
           </void> 
@@ -802,82 +802,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-          <void property="inputFileFormatClass"> 
-           <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-          </void> 
-          <void property="outputFileFormatClass"> 
-           <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-          </void> 
-          <void property="properties"> 
-           <object class="java.util.Properties"> 
-            <void method="put"> 
-             <string>name</string> 
-             <string>default.src</string> 
-            </void> 
-            <void method="put"> 
-             <string>numFiles</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns.types</string> 
-             <string>string:string</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.ddl</string> 
-             <string>struct src { string key, string value}</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.format</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns</string> 
-             <string>key,value</string> 
-            </void> 
-            <void method="put"> 
-             <string>rawDataSize</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>numRows</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_count</string> 
-             <string>-1</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.lib</string> 
-             <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-            </void> 
-            <void method="put"> 
-             <string>COLUMN_STATS_ACCURATE</string> 
-             <string>true</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.inputformat</string> 
-             <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>totalSize</string> 
-             <string>5812</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.outputformat</string> 
-             <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>location</string> 
-             #### A masked pattern was here #### 
-            </void> 
-            <void method="put"> 
-             <string>transient_lastDdlTime</string> 
-             #### A masked pattern was here #### 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <object idref="TableDesc0"/> 
         </void> 
        </object> 
       </void> 
diff --git a/ql/src/test/results/compiler/plan/union.q.xml b/ql/src/test/results/compiler/plan/union.q.xml
index 16a0171783..46351be43e 100644
--- a/ql/src/test/results/compiler/plan/union.q.xml
+++ b/ql/src/test/results/compiler/plan/union.q.xml
@@ -228,7 +228,7 @@
                          </object> 
                         </void> 
                         <void property="tableDesc"> 
-                         <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
                           <void property="inputFileFormatClass"> 
                            <class>org.apache.hadoop.mapred.TextInputFormat</class> 
                           </void> 
@@ -438,7 +438,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+         <object id="TableDesc0" class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
           <void property="inputFileFormatClass"> 
            <class>org.apache.hadoop.mapred.TextInputFormat</class> 
           </void> 
@@ -574,82 +574,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-          <void property="inputFileFormatClass"> 
-           <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-          </void> 
-          <void property="outputFileFormatClass"> 
-           <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-          </void> 
-          <void property="properties"> 
-           <object class="java.util.Properties"> 
-            <void method="put"> 
-             <string>name</string> 
-             <string>default.src</string> 
-            </void> 
-            <void method="put"> 
-             <string>numFiles</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns.types</string> 
-             <string>string:string</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.ddl</string> 
-             <string>struct src { string key, string value}</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.format</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns</string> 
-             <string>key,value</string> 
-            </void> 
-            <void method="put"> 
-             <string>rawDataSize</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>numRows</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_count</string> 
-             <string>-1</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.lib</string> 
-             <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-            </void> 
-            <void method="put"> 
-             <string>COLUMN_STATS_ACCURATE</string> 
-             <string>true</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.inputformat</string> 
-             <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>totalSize</string> 
-             <string>5812</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.outputformat</string> 
-             <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>location</string> 
-             #### A masked pattern was here #### 
-            </void> 
-            <void method="put"> 
-             <string>transient_lastDdlTime</string> 
-             #### A masked pattern was here #### 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <object idref="TableDesc0"/> 
         </void> 
        </object> 
       </void> 
@@ -693,7 +618,34 @@
                           <boolean>true</boolean> 
                          </void> 
                          <void property="tableInfo"> 
-                          <object idref="TableDesc0"/> 
+                          <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
+                           <void property="inputFileFormatClass"> 
+                            <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                           </void> 
+                           <void property="outputFileFormatClass"> 
+                            <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                           </void> 
+                           <void property="properties"> 
+                            <object class="java.util.Properties"> 
+                             <void method="put"> 
+                              <string>columns</string> 
+                              <string>_col0,_col1</string> 
+                             </void> 
+                             <void method="put"> 
+                              <string>serialization.lib</string> 
+                              <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                             </void> 
+                             <void method="put"> 
+                              <string>serialization.format</string> 
+                              <string>1</string> 
+                             </void> 
+                             <void method="put"> 
+                              <string>columns.types</string> 
+                              <string>string:string</string> 
+                             </void> 
+                            </object> 
+                           </void> 
+                          </object> 
                          </void> 
                          <void property="totalFiles"> 
                           <int>1</int> 
@@ -1587,82 +1539,7 @@
          </object> 
         </void> 
         <void property="tableDesc"> 
-         <object class="org.apache.hadoop.hive.ql.plan.TableDesc"> 
-          <void property="inputFileFormatClass"> 
-           <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-          </void> 
-          <void property="outputFileFormatClass"> 
-           <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-          </void> 
-          <void property="properties"> 
-           <object class="java.util.Properties"> 
-            <void method="put"> 
-             <string>name</string> 
-             <string>default.src</string> 
-            </void> 
-            <void method="put"> 
-             <string>numFiles</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns.types</string> 
-             <string>string:string</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.ddl</string> 
-             <string>struct src { string key, string value}</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.format</string> 
-             <string>1</string> 
-            </void> 
-            <void method="put"> 
-             <string>columns</string> 
-             <string>key,value</string> 
-            </void> 
-            <void method="put"> 
-             <string>rawDataSize</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>numRows</string> 
-             <string>0</string> 
-            </void> 
-            <void method="put"> 
-             <string>bucket_count</string> 
-             <string>-1</string> 
-            </void> 
-            <void method="put"> 
-             <string>serialization.lib</string> 
-             <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-            </void> 
-            <void method="put"> 
-             <string>COLUMN_STATS_ACCURATE</string> 
-             <string>true</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.inputformat</string> 
-             <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>totalSize</string> 
-             <string>5812</string> 
-            </void> 
-            <void method="put"> 
-             <string>file.outputformat</string> 
-             <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-            </void> 
-            <void method="put"> 
-             <string>location</string> 
-             #### A masked pattern was here #### 
-            </void> 
-            <void method="put"> 
-             <string>transient_lastDdlTime</string> 
-             #### A masked pattern was here #### 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
+         <object idref="TableDesc0"/> 
         </void> 
        </object> 
       </void> 
