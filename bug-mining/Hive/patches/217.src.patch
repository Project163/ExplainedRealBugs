diff --git a/CHANGES.txt b/CHANGES.txt
index 7f71647478..66e10327ad 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -435,6 +435,9 @@ Trunk - Unreleased
     HIVE-697. GroupByOperator's initialization calls GenericUDAF.newAggregation before GenericUDAF.init
     (Zheng Shao via namit)
 
+    HIVE-700. Fix test error by adding "DROP FUNCTION".
+    (Min Zhou and Namit Jain via zshao)
+
 Release 0.3.1 - Unreleased
 
   INCOMPATIBLE CHANGES
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/FunctionRegistry.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/FunctionRegistry.java
index 1e15f3f28a..8bb4de6f74 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/FunctionRegistry.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/FunctionRegistry.java
@@ -438,6 +438,10 @@ public static void registerUDAF(String functionName, Class<? extends UDAF> udafC
             new GenericUDAFBridge((UDAF)ReflectionUtils.newInstance(udafClass, null))));
   }
 
+  public static void unregisterUDF(String functionName) {
+    mFunctions.remove(functionName.toLowerCase());
+  }
+
   public static GenericUDAFResolver getGenericUDAFResolver(String functionName) {
     LOG.debug("Looking up GenericUDAF: " + functionName);
     FunctionInfo finfo = mFunctions.get(functionName.toLowerCase());
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/FunctionTask.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/FunctionTask.java
index a3a23d9672..2dbb602818 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/FunctionTask.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/FunctionTask.java
@@ -26,6 +26,7 @@
 import org.apache.hadoop.hive.common.JavaUtils;
 import org.apache.hadoop.hive.ql.plan.FunctionWork;
 import org.apache.hadoop.hive.ql.plan.createFunctionDesc;
+import org.apache.hadoop.hive.ql.plan.dropFunctionDesc;
 import org.apache.hadoop.hive.ql.udf.generic.GenericUDF;
 import org.apache.hadoop.util.StringUtils;
 import org.apache.hadoop.hive.ql.exec.FunctionInfo.OperatorType;
@@ -45,29 +46,43 @@ public void initialize(HiveConf conf) {
   public int execute() {
     createFunctionDesc createFunctionDesc = work.getCreateFunctionDesc();
     if (createFunctionDesc != null) {
-      try {
-        Class<?> udfClass = getUdfClass(createFunctionDesc);
-        if(UDF.class.isAssignableFrom(udfClass)) {
-          FunctionRegistry.registerUDF(createFunctionDesc.getFunctionName(), 
-                                       (Class<? extends UDF>) udfClass,
-                                       OperatorType.PREFIX, false);
-          return 0;
-        } else if(GenericUDF.class.isAssignableFrom(udfClass)) {
-          FunctionRegistry.registerGenericUDF(createFunctionDesc.getFunctionName(), 
-                                              (Class<? extends GenericUDF>) udfClass);
-          return 0;
-        } else if(UDAF.class.isAssignableFrom(udfClass)) {
-          FunctionRegistry.registerUDAF(createFunctionDesc.getFunctionName(),
-                                        (Class<? extends UDAF>) udfClass);
-          return 0;
-        } 
-        return 1;
+      return createFunction(createFunctionDesc);
+    }
+
+    dropFunctionDesc dropFunctionDesc = work.getDropFunctionDesc();
+    if (dropFunctionDesc != null) {
+      return dropFunction(dropFunctionDesc);
+    }
+    return 0;
+  }
+
+  private int createFunction(createFunctionDesc createFunctionDesc) {
+    try {
+      Class<?> udfClass = getUdfClass(createFunctionDesc);
+      if(UDF.class.isAssignableFrom(udfClass)) {
+        FunctionRegistry.registerUDF(createFunctionDesc.getFunctionName(), 
+                                     (Class<? extends UDF>) udfClass,
+                                     OperatorType.PREFIX, false);
+        return 0;
+      } else if(GenericUDF.class.isAssignableFrom(udfClass)) {
+        FunctionRegistry.registerGenericUDF(createFunctionDesc.getFunctionName(), 
+                                            (Class<? extends GenericUDF>) udfClass);
+        return 0;
+      } else if(UDAF.class.isAssignableFrom(udfClass)) {
+        FunctionRegistry.registerUDAF(createFunctionDesc.getFunctionName(),
+                                      (Class<? extends UDAF>) udfClass);
+        return 0;
+      } 
+      return 1;
 
-      } catch (ClassNotFoundException e) {
-        LOG.info("create function: " + StringUtils.stringifyException(e));
-        return 1;
-      }
+    } catch (ClassNotFoundException e) {
+      LOG.info("create function: " + StringUtils.stringifyException(e));
+      return 1;
     }
+  }
+
+  private int dropFunction(dropFunctionDesc dropFunctionDesc) {
+    FunctionRegistry.unregisterUDF(dropFunctionDesc.getFunctionName());
     return 0;
   }
 
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/FunctionSemanticAnalyzer.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/FunctionSemanticAnalyzer.java
index 5702e63027..6e28ee6f58 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/FunctionSemanticAnalyzer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/FunctionSemanticAnalyzer.java
@@ -25,6 +25,7 @@
 import org.apache.hadoop.hive.ql.exec.TaskFactory;
 import org.apache.hadoop.hive.ql.plan.FunctionWork;
 import org.apache.hadoop.hive.ql.plan.createFunctionDesc;
+import org.apache.hadoop.hive.ql.plan.dropFunctionDesc;
 
 public class FunctionSemanticAnalyzer extends BaseSemanticAnalyzer {
   private static final Log LOG =
@@ -35,10 +36,26 @@ public FunctionSemanticAnalyzer(HiveConf conf) throws SemanticException {
   }
   
   public void analyzeInternal(ASTNode ast) throws SemanticException {
+    if (ast.getToken().getType() == HiveParser.TOK_CREATEFUNCTION)
+      analyzeCreateFunction(ast);
+    if (ast.getToken().getType() == HiveParser.TOK_DROPFUNCTION)
+      analyzeDropFunction(ast);
+
+    LOG.info("analyze done");
+  }
+  
+  private void analyzeCreateFunction(ASTNode ast) 
+      throws SemanticException {
     String functionName = ast.getChild(0).getText();
     String className = unescapeSQLString(ast.getChild(1).getText());
     createFunctionDesc desc = new createFunctionDesc(functionName, className);
     rootTasks.add(TaskFactory.get(new FunctionWork(desc), conf));
-    LOG.info("analyze done");
+  }
+  
+  private void analyzeDropFunction(ASTNode ast) 
+      throws SemanticException {
+    String functionName = ast.getChild(0).getText();
+    dropFunctionDesc desc = new dropFunctionDesc(functionName);
+    rootTasks.add(TaskFactory.get(new FunctionWork(desc), conf));
   }
 }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/Hive.g b/ql/src/java/org/apache/hadoop/hive/ql/parse/Hive.g
index ac4bd86d1a..92c6e2b484 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/Hive.g
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/Hive.g
@@ -118,6 +118,7 @@ TOK_TABSORTCOLNAMEASC;
 TOK_TABSORTCOLNAMEDESC;
 TOK_CHARSETLITERAL;
 TOK_CREATEFUNCTION;
+TOK_DROPFUNCTION;
 TOK_EXPLAIN;
 TOK_TABLESERIALIZER;
 TOK_TABLEPROPERTIES;
@@ -188,6 +189,7 @@ ddlStatement
     | showStatement
     | metastoreCheck
     | createFunctionStatement
+    | dropFunctionStatement
     ;
 
 ifNotExists
@@ -321,6 +323,13 @@ createFunctionStatement
     -> ^(TOK_CREATEFUNCTION Identifier StringLiteral)
     ;
 
+dropFunctionStatement
+@init { msgs.push("drop temporary function statement"); }
+@after { msgs.pop(); }
+    : KW_DROP KW_TEMPORARY KW_FUNCTION Identifier
+    -> ^(TOK_DROPFUNCTION Identifier)
+    ;
+
 showStmtIdentifier
 @init { msgs.push("identifier for show statement"); }
 @after { msgs.pop(); }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzerFactory.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzerFactory.java
index 47d26084d4..d40728a97c 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzerFactory.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzerFactory.java
@@ -47,6 +47,7 @@ public static BaseSemanticAnalyzer get(HiveConf conf, ASTNode tree) throws Seman
       case HiveParser.TOK_SHOWPARTITIONS:
         return new DDLSemanticAnalyzer(conf);
       case HiveParser.TOK_CREATEFUNCTION: 
+      case HiveParser.TOK_DROPFUNCTION:
         return new FunctionSemanticAnalyzer(conf);
       default: return new SemanticAnalyzer(conf);
       }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/plan/FunctionWork.java b/ql/src/java/org/apache/hadoop/hive/ql/plan/FunctionWork.java
index f4b592e6ed..19fbd2cbd1 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/plan/FunctionWork.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/plan/FunctionWork.java
@@ -23,16 +23,28 @@
 public class FunctionWork implements Serializable {
   private static final long serialVersionUID = 1L;
   private createFunctionDesc  createFunctionDesc;
+  private dropFunctionDesc  dropFunctionDesc;
   
   public FunctionWork(createFunctionDesc createFunctionDesc) {
     this.createFunctionDesc = createFunctionDesc;
   }
 
+  public FunctionWork(dropFunctionDesc dropFunctionDesc) {
+    this.dropFunctionDesc = dropFunctionDesc;
+  }
+
   public createFunctionDesc getCreateFunctionDesc() {
     return createFunctionDesc;
   }
   public void setCreateFunctionDesc(createFunctionDesc createFunctionDesc) {
     this.createFunctionDesc = createFunctionDesc;
   }
+
+  public dropFunctionDesc getDropFunctionDesc() {
+    return dropFunctionDesc;
+  }
+  public void setDropFunctionDesc(dropFunctionDesc dropFunctionDesc) {
+    this.dropFunctionDesc = dropFunctionDesc;
+  }
   
 }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/plan/dropFunctionDesc.java b/ql/src/java/org/apache/hadoop/hive/ql/plan/dropFunctionDesc.java
new file mode 100644
index 0000000000..3af420d110
--- /dev/null
+++ b/ql/src/java/org/apache/hadoop/hive/ql/plan/dropFunctionDesc.java
@@ -0,0 +1,42 @@
+/**
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.hadoop.hive.ql.plan;
+
+import java.io.Serializable;
+
+@explain(displayName="Drop Function")
+public class dropFunctionDesc implements Serializable {
+  private static final long serialVersionUID = 1L;
+  
+  private String functionName;
+  
+  public dropFunctionDesc(String functionName) {
+    this.functionName = functionName;
+  }
+
+  @explain(displayName="name")
+  public String getFunctionName() {
+    return functionName;
+  }
+
+  public void setFunctionName(String functionName) {
+    this.functionName = functionName;
+  }
+  
+}
diff --git a/ql/src/test/queries/clientpositive/create_genericudf.q b/ql/src/test/queries/clientpositive/create_genericudf.q
index e95ff40411..4fedaab3df 100644
--- a/ql/src/test/queries/clientpositive/create_genericudf.q
+++ b/ql/src/test/queries/clientpositive/create_genericudf.q
@@ -17,3 +17,5 @@ SELECT
     test_translate('abc', 'a', 'ab');
 
 SELECT dest1.* FROM dest1 LIMIT 1;
+
+DROP TEMPORARY FUNCTION test_translate;
diff --git a/ql/src/test/queries/clientpositive/create_udaf.q b/ql/src/test/queries/clientpositive/create_udaf.q
index bd471ad230..52e71de4dd 100644
--- a/ql/src/test/queries/clientpositive/create_udaf.q
+++ b/ql/src/test/queries/clientpositive/create_udaf.q
@@ -8,3 +8,5 @@ CREATE TABLE dest1(col INT);
 FROM src INSERT OVERWRITE TABLE dest1 SELECT test_max(length(src.value));
 
 SELECT dest1.* FROM dest1;
+
+DROP TEMPORARY FUNCTION test_max;
diff --git a/ql/src/test/queries/clientpositive/drop_udf.q b/ql/src/test/queries/clientpositive/drop_udf.q
new file mode 100644
index 0000000000..8aaa66e3e6
--- /dev/null
+++ b/ql/src/test/queries/clientpositive/drop_udf.q
@@ -0,0 +1,6 @@
+CREATE TEMPORARY FUNCTION test_translate AS 'org.apache.hadoop.hive.ql.udf.generic.GenericUDFTestTranslate';
+
+EXPLAIN
+DROP TEMPORARY FUNCTION test_translate;
+
+DROP TEMPORARY FUNCTION test_translate;
diff --git a/ql/src/test/queries/clientpositive/udf_testlength.q b/ql/src/test/queries/clientpositive/udf_testlength.q
index f877df1145..322a061d64 100644
--- a/ql/src/test/queries/clientpositive/udf_testlength.q
+++ b/ql/src/test/queries/clientpositive/udf_testlength.q
@@ -8,3 +8,5 @@ CREATE TABLE dest1(len INT);
 FROM src INSERT OVERWRITE TABLE dest1 SELECT testlength(src.value);
 
 SELECT dest1.* FROM dest1;
+
+DROP TEMPORARY FUNCTION testlength;
diff --git a/ql/src/test/queries/clientpositive/udf_testlength2.q b/ql/src/test/queries/clientpositive/udf_testlength2.q
index 2a269177a8..6de270902f 100644
--- a/ql/src/test/queries/clientpositive/udf_testlength2.q
+++ b/ql/src/test/queries/clientpositive/udf_testlength2.q
@@ -8,3 +8,5 @@ CREATE TABLE dest1(len INT);
 FROM src INSERT OVERWRITE TABLE dest1 SELECT testlength2(src.value);
 
 SELECT dest1.* FROM dest1;
+
+DROP TEMPORARY FUNCTION testlength2;
diff --git a/ql/src/test/results/clientpositive/create_genericudf.q.out b/ql/src/test/results/clientpositive/create_genericudf.q.out
index fd3733f448..cca463d195 100644
--- a/ql/src/test/results/clientpositive/create_genericudf.q.out
+++ b/ql/src/test/results/clientpositive/create_genericudf.q.out
@@ -26,5 +26,6 @@ Input: default/src
 Output: default/dest1
 query: SELECT dest1.* FROM dest1 LIMIT 1
 Input: default/dest1
-Output: file:/home/zhoumin/hive-trunk/build/ql/tmp/997095758/10000
+Output: file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1518422046/10000
 bbc	bcc	NULL	NULL	NULL	bc	abc
+query: DROP TEMPORARY FUNCTION test_translate
diff --git a/ql/src/test/results/clientpositive/create_udaf.q.out b/ql/src/test/results/clientpositive/create_udaf.q.out
index 60f47346fc..e5da34e81c 100644
--- a/ql/src/test/results/clientpositive/create_udaf.q.out
+++ b/ql/src/test/results/clientpositive/create_udaf.q.out
@@ -17,5 +17,6 @@ Input: default/src
 Output: default/dest1
 query: SELECT dest1.* FROM dest1
 Input: default/dest1
-Output: file:/home/zhoumin/hive-trunk/build/ql/tmp/523260903/10000
+Output: file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/208230949/10000
 7
+query: DROP TEMPORARY FUNCTION test_max
diff --git a/ql/src/test/results/clientpositive/drop_udf.q.out b/ql/src/test/results/clientpositive/drop_udf.q.out
new file mode 100644
index 0000000000..d4109bed23
--- /dev/null
+++ b/ql/src/test/results/clientpositive/drop_udf.q.out
@@ -0,0 +1,14 @@
+query: CREATE TEMPORARY FUNCTION test_translate AS 'org.apache.hadoop.hive.ql.udf.generic.GenericUDFTestTranslate'
+query: EXPLAIN
+DROP TEMPORARY FUNCTION test_translate
+ABSTRACT SYNTAX TREE:
+  (TOK_DROPFUNCTION test_translate)
+
+STAGE DEPENDENCIES:
+  Stage-0 is a root stage
+
+STAGE PLANS:
+  Stage: Stage-0
+
+
+query: DROP TEMPORARY FUNCTION test_translate
diff --git a/ql/src/test/results/clientpositive/show_functions.q.out b/ql/src/test/results/clientpositive/show_functions.q.out
index 65aae69a6c..e2828342a6 100644
--- a/ql/src/test/results/clientpositive/show_functions.q.out
+++ b/ql/src/test/results/clientpositive/show_functions.q.out
@@ -93,8 +93,6 @@ string
 substr
 substring
 sum
-test_max
-test_translate
 tinyint
 to_date
 trim
@@ -130,7 +128,6 @@ reverse
 rlike
 size
 space
-test_translate
 to_date
 ucase
 query: SHOW FUNCTIONS 'log.*'
diff --git a/ql/src/test/results/clientpositive/udf_testlength.q.out b/ql/src/test/results/clientpositive/udf_testlength.q.out
index fd4a07ae6a..f61c7aa942 100644
--- a/ql/src/test/results/clientpositive/udf_testlength.q.out
+++ b/ql/src/test/results/clientpositive/udf_testlength.q.out
@@ -17,7 +17,7 @@ Input: default/src
 Output: default/dest1
 query: SELECT dest1.* FROM dest1
 Input: default/dest1
-Output: /data/users/athusoo/commits/hive_trunk_ws8/ql/../build/ql/tmp/282300809/1100710033.10000
+Output: file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/1256922669/10000
 7
 6
 7
@@ -518,3 +518,4 @@ Output: /data/users/athusoo/commits/hive_trunk_ws8/ql/../build/ql/tmp/282300809/
 7
 7
 6
+query: DROP TEMPORARY FUNCTION testlength
diff --git a/ql/src/test/results/clientpositive/udf_testlength2.q.out b/ql/src/test/results/clientpositive/udf_testlength2.q.out
index c995a362e1..c482a7dd1c 100644
--- a/ql/src/test/results/clientpositive/udf_testlength2.q.out
+++ b/ql/src/test/results/clientpositive/udf_testlength2.q.out
@@ -17,7 +17,7 @@ Input: default/src
 Output: default/dest1
 query: SELECT dest1.* FROM dest1
 Input: default/dest1
-Output: /data/users/athusoo/commits/hive_trunk_ws8/ql/../build/ql/tmp/738511694/1056230246.10000
+Output: file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/744584966/10000
 7
 6
 7
@@ -518,3 +518,4 @@ Output: /data/users/athusoo/commits/hive_trunk_ws8/ql/../build/ql/tmp/738511694/
 7
 7
 6
+query: DROP TEMPORARY FUNCTION testlength2
