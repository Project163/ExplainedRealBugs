diff --git a/CHANGES.txt b/CHANGES.txt
index 3ef9c0e452..45b15e9da0 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -284,6 +284,9 @@ Trunk -  Unreleased
     HIVE-944 Generate thrift files in queryplan
     (Paul Yang via namit)
 
+    HIVE-953 Fix test script_broken_pipe3.q
+    (Paul Yang via namit)
+
 Release 0.4.0 -  Unreleased
 
   INCOMPATIBLE CHANGES
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/ScriptOperator.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/ScriptOperator.java
index 161927d5df..b6feb93429 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/ScriptOperator.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/ScriptOperator.java
@@ -337,7 +337,7 @@ public void close(boolean abort) throws HiveException {
         }
         int exitVal = 0;
         if (scriptPid != null)
-          scriptPid.waitFor();
+          exitVal = scriptPid.waitFor();
         if (exitVal != 0) {
           LOG.error("Script failed with code " + exitVal);
           new_abort = true;
diff --git a/ql/src/test/queries/clientnegative/script_broken_pipe1.q b/ql/src/test/queries/clientnegative/script_broken_pipe1.q
index 0da0664f3d..0e9875b106 100644
--- a/ql/src/test/queries/clientnegative/script_broken_pipe1.q
+++ b/ql/src/test/queries/clientnegative/script_broken_pipe1.q
@@ -1,2 +1,3 @@
+set hive.exec.script.allow.partial.consumption = false;
 -- Tests exception in ScriptOperator.close() by passing to the operator a small amount of data
 SELECT TRANSFORM(*) USING 'true' AS a, b, c FROM (SELECT * FROM src LIMIT 1) tmp;
diff --git a/ql/src/test/queries/clientnegative/script_broken_pipe2.q b/ql/src/test/queries/clientnegative/script_broken_pipe2.q
index 9491bd32d2..1c3093c0e7 100644
--- a/ql/src/test/queries/clientnegative/script_broken_pipe2.q
+++ b/ql/src/test/queries/clientnegative/script_broken_pipe2.q
@@ -1,2 +1,3 @@
+set hive.exec.script.allow.partial.consumption = false;
 -- Tests exception in ScriptOperator.processOp() by passing extra data needed to fill pipe buffer
-SELECT TRANSFORM(key, value, key, value, key, value, key, value, key, value, key, value) USING 'head -n 1' as a,b,c,d FROM src;
+SELECT TRANSFORM(key, value, key, value, key, value, key, value, key, value, key, value, key, value, key, value, key, value, key, value, key, value, key, value) USING 'true' as a,b,c,d FROM src;
diff --git a/ql/src/test/queries/clientnegative/script_broken_pipe3.q b/ql/src/test/queries/clientnegative/script_broken_pipe3.q
index 58176af10d..bdffb1f6f2 100644
--- a/ql/src/test/queries/clientnegative/script_broken_pipe3.q
+++ b/ql/src/test/queries/clientnegative/script_broken_pipe3.q
@@ -1,2 +1,3 @@
+set hive.exec.script.allow.partial.consumption = true;
 -- Test to ensure that a script with a bad error code still fails even with partial consumption
 SELECT TRANSFORM(*) USING 'false' AS a, b, c FROM (SELECT * FROM src LIMIT 1) tmp;
diff --git a/ql/src/test/results/clientnegative/script_broken_pipe2.q.out b/ql/src/test/results/clientnegative/script_broken_pipe2.q.out
index 2ef066490a..afbaa44e47 100644
--- a/ql/src/test/results/clientnegative/script_broken_pipe2.q.out
+++ b/ql/src/test/results/clientnegative/script_broken_pipe2.q.out
@@ -1,6 +1,6 @@
 PREHOOK: query: -- Tests exception in ScriptOperator.processOp() by passing extra data needed to fill pipe buffer
-SELECT TRANSFORM(key, value, key, value, key, value, key, value, key, value, key, value) USING 'head -n 1' as a,b,c,d FROM src
+SELECT TRANSFORM(key, value, key, value, key, value, key, value, key, value, key, value, key, value, key, value, key, value, key, value, key, value, key, value) USING 'true' as a,b,c,d FROM src
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
-PREHOOK: Output: file:/data/users/pyang/trunk/VENDOR.hive/trunk/build/ql/tmp/588453066/10000
+PREHOOK: Output: file:/data/users/pyang/script/trunk/VENDOR.hive/trunk/build/ql/tmp/1650258494/10000
 FAILED: Execution Error, return code 2 from org.apache.hadoop.hive.ql.exec.MapRedTask
