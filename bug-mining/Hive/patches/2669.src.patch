diff --git a/itests/hive-unit/src/test/java/org/apache/hadoop/hive/ql/security/authorization/plugin/TestHiveAuthorizerCheckInvocation.java b/itests/hive-unit/src/test/java/org/apache/hadoop/hive/ql/security/authorization/plugin/TestHiveAuthorizerCheckInvocation.java
index 3c99068a9d..79cf58bf34 100644
--- a/itests/hive-unit/src/test/java/org/apache/hadoop/hive/ql/security/authorization/plugin/TestHiveAuthorizerCheckInvocation.java
+++ b/itests/hive-unit/src/test/java/org/apache/hadoop/hive/ql/security/authorization/plugin/TestHiveAuthorizerCheckInvocation.java
@@ -98,7 +98,7 @@ public static void beforeTest() throws Exception {
     runCmd("create database " + dbName);
     // Need a separate table for ACID testing since it has to be bucketed and it has to be Acid
     runCmd("create table " + acidTableName + " (i int, j int) clustered by (i) into 2 buckets " +
-        "stored as orc");
+        "stored as orc TBLPROPERTIES ('transactional'='true')");
   }
 
   private static void runCmd(String cmd) throws CommandNeedRetryException {
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/ErrorMsg.java b/ql/src/java/org/apache/hadoop/hive/ql/ErrorMsg.java
index eb9f4e3c07..31978fe3af 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/ErrorMsg.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/ErrorMsg.java
@@ -418,7 +418,9 @@ public enum ErrorMsg {
   VALUES_TABLE_CONSTRUCTOR_NOT_SUPPORTED(10296,
       "Values clause with table constructor not yet supported"),
   ACID_OP_ON_NONACID_TABLE(10297, "Attempt to do update or delete on table {0} that does not use " +
-      "an AcidOutputFormat", true),
+      "an AcidOutputFormat or is not bucketed", true),
+  ACID_NO_SORTED_BUCKETS(10298, "ACID insert, update, delete not supported on tables that are " +
+      "sorted, table {0}", true),
 
   //========================== 20000 range starts here ========================//
   SCRIPT_INIT_ERROR(20000, "Unable to initialize custom script."),
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/metadata/Hive.java b/ql/src/java/org/apache/hadoop/hive/ql/metadata/Hive.java
index 501a1bd679..0f7af9ac46 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/metadata/Hive.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/metadata/Hive.java
@@ -378,6 +378,27 @@ public void createTable(String tableName, List<String> columns,
       List<String> partCols, Class<? extends InputFormat> fileInputFormat,
       Class<?> fileOutputFormat, int bucketCount, List<String> bucketCols)
       throws HiveException {
+    createTable(tableName, columns, partCols, fileInputFormat, fileOutputFormat, bucketCount,
+        bucketCols, null);
+  }
+
+  /**
+   * Create a table metadata and the directory for the table data
+   * @param tableName table name
+   * @param columns list of fields of the table
+   * @param partCols partition keys of the table
+   * @param fileInputFormat Class of the input format of the table data file
+   * @param fileOutputFormat Class of the output format of the table data file
+   * @param bucketCount number of buckets that each partition (or the table itself) should be
+   *                    divided into
+   * @param bucketCols Bucket columns
+   * @param parameters Parameters for the table
+   * @throws HiveException
+   */
+  public void createTable(String tableName, List<String> columns, List<String> partCols,
+                          Class<? extends InputFormat> fileInputFormat,
+                          Class<?> fileOutputFormat, int bucketCount, List<String> bucketCols,
+                          Map<String, String> parameters) throws HiveException {
     if (columns == null) {
       throw new HiveException("columns not specified for table " + tableName);
     }
@@ -402,6 +423,9 @@ public void createTable(String tableName, List<String> columns,
     tbl.setSerializationLib(LazySimpleSerDe.class.getName());
     tbl.setNumBuckets(bucketCount);
     tbl.setBucketCols(bucketCols);
+    if (parameters != null) {
+      tbl.setParamters(parameters);
+    }
     createTable(tbl);
   }
 
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/metadata/Table.java b/ql/src/java/org/apache/hadoop/hive/ql/metadata/Table.java
index c2e033cbd9..2bbedd3530 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/metadata/Table.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/metadata/Table.java
@@ -385,6 +385,10 @@ public void setProperty(String name, String value) {
     tTable.getParameters().put(name, value);
   }
 
+  public void setParamters(Map<String, String> params) {
+    tTable.setParameters(params);
+  }
+
   public String getProperty(String name) {
     return tTable.getParameters().get(name);
   }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/QBMetaData.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/QBMetaData.java
index 66faf1db29..0c973cef14 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/QBMetaData.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/QBMetaData.java
@@ -104,10 +104,18 @@ public Table getDestTableForAlias(String alias) {
     return nameToDestTable.get(alias.toLowerCase());
   }
 
+  public Map<String, Table> getNameToDestTable() {
+    return nameToDestTable;
+  }
+
   public Partition getDestPartitionForAlias(String alias) {
     return nameToDestPartition.get(alias.toLowerCase());
   }
 
+  public Map<String, Partition> getNameToDestPartition() {
+    return nameToDestPartition;
+  }
+
   public String getDestFileForAlias(String alias) {
     return nameToDestFile.get(alias.toLowerCase());
   }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
index a64318fad4..935887c51f 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
@@ -41,6 +41,7 @@
 import java.util.regex.Pattern;
 import java.util.regex.PatternSyntaxException;
 
+import com.google.common.annotations.VisibleForTesting;
 import net.hydromatic.optiq.SchemaPlus;
 import net.hydromatic.optiq.tools.Frameworks;
 
@@ -68,6 +69,7 @@
 import org.apache.hadoop.hive.metastore.api.FieldSchema;
 import org.apache.hadoop.hive.metastore.api.MetaException;
 import org.apache.hadoop.hive.metastore.api.Order;
+import org.apache.hadoop.hive.metastore.api.hive_metastoreConstants;
 import org.apache.hadoop.hive.ql.ErrorMsg;
 import org.apache.hadoop.hive.ql.QueryProperties;
 import org.apache.hadoop.hive.ql.exec.AbstractMapJoinOperator;
@@ -309,6 +311,9 @@ public class SemanticAnalyzer extends BaseSemanticAnalyzer {
 
   private static final String VALUES_TMP_TABLE_NAME_PREFIX = "Values__Tmp__Table__";
 
+  @VisibleForTesting
+  static final String ACID_TABLE_PROPERTY = "transactional";
+
   private HashMap<TableScanOperator, ExprNodeDesc> opToPartPruner;
   private HashMap<TableScanOperator, PrunedPartitionList> opToPartList;
   private HashMap<String, Operator<? extends OperatorDesc>> topOps;
@@ -5896,6 +5901,7 @@ private Operator genFileSinkPlan(String dest, QB qb, Operator input)
     Integer dest_type = qbm.getDestTypeForAlias(dest);
 
     Table dest_tab = null; // destination table if any
+    boolean destTableIsAcid = false; // should the destination table be written to using ACID
     Partition dest_part = null;// destination partition if any
     Path queryTmpdir = null; // the intermediate destination directory
     Path dest_path = null; // the final destination directory
@@ -5912,6 +5918,7 @@ private Operator genFileSinkPlan(String dest, QB qb, Operator input)
     case QBMetaData.DEST_TABLE: {
 
       dest_tab = qbm.getDestTableForAlias(dest);
+      destTableIsAcid = isAcidTable(dest_tab);
 
       // Is the user trying to insert into a external tables
       if ((!conf.getBoolVar(HiveConf.ConfVars.HIVE_INSERT_INTO_EXTERNAL_TABLES)) &&
@@ -6007,9 +6014,10 @@ private Operator genFileSinkPlan(String dest, QB qb, Operator input)
       // Create the work for moving the table
       // NOTE: specify Dynamic partitions in dest_tab for WriteEntity
       if (!isNonNativeTable) {
-        AcidUtils.Operation acidOp = getAcidType(table_desc.getOutputFileFormatClass());
-        if (acidOp != AcidUtils.Operation.NOT_ACID) {
-          checkAcidConstraints(qb, table_desc);
+        AcidUtils.Operation acidOp = AcidUtils.Operation.NOT_ACID;
+        if (destTableIsAcid) {
+          acidOp = getAcidType(table_desc.getOutputFileFormatClass());
+          checkAcidConstraints(qb, table_desc, dest_tab);
         }
         ltd = new LoadTableDesc(queryTmpdir,table_desc, dpCtx, acidOp);
         ltd.setReplace(!qb.getParseInfo().isInsertIntoTable(dest_tab.getDbName(),
@@ -6067,6 +6075,7 @@ private Operator genFileSinkPlan(String dest, QB qb, Operator input)
 
       dest_part = qbm.getDestPartitionForAlias(dest);
       dest_tab = dest_part.getTable();
+      destTableIsAcid = isAcidTable(dest_tab);
       if ((!conf.getBoolVar(HiveConf.ConfVars.HIVE_INSERT_INTO_EXTERNAL_TABLES)) &&
           dest_tab.getTableType().equals(TableType.EXTERNAL_TABLE)) {
         throw new SemanticException(
@@ -6114,9 +6123,10 @@ private Operator genFileSinkPlan(String dest, QB qb, Operator input)
       lbCtx = constructListBucketingCtx(dest_part.getSkewedColNames(),
           dest_part.getSkewedColValues(), dest_part.getSkewedColValueLocationMaps(),
           dest_part.isStoredAsSubDirectories(), conf);
-      AcidUtils.Operation acidOp = getAcidType(table_desc.getOutputFileFormatClass());
-      if (acidOp != AcidUtils.Operation.NOT_ACID) {
-        checkAcidConstraints(qb, table_desc);
+      AcidUtils.Operation acidOp = AcidUtils.Operation.NOT_ACID;
+      if (destTableIsAcid) {
+        acidOp = getAcidType(table_desc.getOutputFileFormatClass());
+        checkAcidConstraints(qb, table_desc, dest_tab);
       }
       ltd = new LoadTableDesc(queryTmpdir, table_desc, dest_part.getSpec(), acidOp);
       ltd.setReplace(!qb.getParseInfo().isInsertIntoTable(dest_tab.getDbName(),
@@ -6271,9 +6281,7 @@ private Operator genFileSinkPlan(String dest, QB qb, Operator input)
     ArrayList<ColumnInfo> vecCol = new ArrayList<ColumnInfo>();
 
     if (updating() || deleting()) {
-      vecCol.add(new ColumnInfo(VirtualColumn.ROWID.getName(),
-          //TypeInfoUtils.getTypeInfoFromObjectInspector(VirtualColumn.ROWID.getObjectInspector()),
-          VirtualColumn.ROWID.getTypeInfo(),
+      vecCol.add(new ColumnInfo(VirtualColumn.ROWID.getName(), VirtualColumn.ROWID.getTypeInfo(),
           "", true));
     } else {
       try {
@@ -6302,8 +6310,7 @@ private Operator genFileSinkPlan(String dest, QB qb, Operator input)
         conf.getBoolVar(HiveConf.ConfVars.HIVEENFORCESORTING))));
 
     // If this table is working with ACID semantics, turn off merging
-    boolean acidTable = isAcidTable(dest_tab);
-    canBeMerged &= !acidTable;
+    canBeMerged &= !destTableIsAcid;
 
     FileSinkDesc fileSinkDesc = new FileSinkDesc(
       queryTmpdir,
@@ -6319,7 +6326,7 @@ private Operator genFileSinkPlan(String dest, QB qb, Operator input)
 
     // If this is an insert, update, or delete on an ACID table then mark that so the
     // FileSinkOperator knows how to properly write to it.
-    if (acidTable) {
+    if (destTableIsAcid) {
       AcidUtils.Operation wt = updating() ? AcidUtils.Operation.UPDATE :
           (deleting() ? AcidUtils.Operation.DELETE : AcidUtils.Operation.INSERT);
       fileSinkDesc.setWriteType(wt);
@@ -6380,9 +6387,12 @@ private Operator genFileSinkPlan(String dest, QB qb, Operator input)
   // * no insert overwrites
   // * no use of vectorization
   // * turns off reduce deduplication optimization, as that sometimes breaks acid
+  // * Check that the table is bucketed
+  // * Check that the table is not sorted
   // This method assumes you have already decided that this is an Acid write.  Don't call it if
   // that isn't true.
-  private void checkAcidConstraints(QB qb, TableDesc tableDesc) throws SemanticException {
+  private void checkAcidConstraints(QB qb, TableDesc tableDesc,
+                                    Table table) throws SemanticException {
     String tableName = tableDesc.getTableName();
     if (!qb.getParseInfo().isInsertIntoTable(tableName)) {
       LOG.debug("Couldn't find table " + tableName + " in insertIntoTable");
@@ -6396,6 +6406,16 @@ private void checkAcidConstraints(QB qb, TableDesc tableDesc) throws SemanticExc
     conf.setBoolVar(ConfVars.HIVEOPTREDUCEDEDUPLICATION, false);
     conf.setBoolVar(ConfVars.HIVE_HADOOP_SUPPORTS_SUBDIRECTORIES, true);
     conf.set(AcidUtils.CONF_ACID_KEY, "true");
+
+    if (table.getNumBuckets() < 1) {
+      throw new SemanticException(ErrorMsg.ACID_OP_ON_NONACID_TABLE, table.getTableName());
+    }
+    if (table.getSortCols() != null && table.getSortCols().size() > 0) {
+      throw new SemanticException(ErrorMsg.ACID_NO_SORTED_BUCKETS, table.getTableName());
+    }
+
+
+
   }
 
   /**
@@ -12131,9 +12151,9 @@ else return (ltd.getReplace() ? WriteEntity.WriteType.INSERT_OVERWRITE :
   // Even if the table is of Acid type, if we aren't working with an Acid compliant TxnManager
   // then return false.
   private boolean isAcidTable(Table tab) {
-    if (tab == null || tab.getOutputFormatClass() == null) return false;
+    if (tab == null) return false;
     if (!SessionState.get().getTxnMgr().supportsAcid()) return false;
-    return isAcidOutputFormat(tab.getOutputFormatClass());
+    return tab.getProperty(ACID_TABLE_PROPERTY) != null;
   }
 
   private boolean isAcidOutputFormat(Class<? extends HiveOutputFormat> of) {
diff --git a/ql/src/test/org/apache/hadoop/hive/ql/parse/TestUpdateDeleteSemanticAnalyzer.java b/ql/src/test/org/apache/hadoop/hive/ql/parse/TestUpdateDeleteSemanticAnalyzer.java
index 301b531bb2..01e3635cb7 100644
--- a/ql/src/test/org/apache/hadoop/hive/ql/parse/TestUpdateDeleteSemanticAnalyzer.java
+++ b/ql/src/test/org/apache/hadoop/hive/ql/parse/TestUpdateDeleteSemanticAnalyzer.java
@@ -266,9 +266,12 @@ private ReturnInfo parseAndAnalyze(String query, String testName)
 
     // I have to create the tables here (rather than in setup()) because I need the Hive
     // connection, which is conviently created by the semantic analyzer.
-    db.createTable("T", Arrays.asList("a", "b"), null, OrcInputFormat.class, OrcOutputFormat.class);
+    Map<String, String> params = new HashMap<String, String>(1);
+    params.put(SemanticAnalyzer.ACID_TABLE_PROPERTY, "true");
+    db.createTable("T", Arrays.asList("a", "b"), null, OrcInputFormat.class,
+        OrcOutputFormat.class, 2, Arrays.asList("a"), params);
     db.createTable("U", Arrays.asList("a", "b"), Arrays.asList("ds"), OrcInputFormat.class,
-        OrcOutputFormat.class);
+        OrcOutputFormat.class, 2, Arrays.asList("a"), params);
     Table u = db.getTable("U");
     Map<String, String> partVals = new HashMap<String, String>(2);
     partVals.put("ds", "yesterday");
diff --git a/ql/src/test/queries/clientnegative/acid_overwrite.q b/ql/src/test/queries/clientnegative/acid_overwrite.q
index 5515fc41f1..2e57a3c3b8 100644
--- a/ql/src/test/queries/clientnegative/acid_overwrite.q
+++ b/ql/src/test/queries/clientnegative/acid_overwrite.q
@@ -2,7 +2,7 @@ set hive.support.concurrency=true;
 set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DbTxnManager;
 set hive.enforce.bucketing=true;
 
-create table acid_uanp(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc;
+create table acid_uanp(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true');
 
 insert into table acid_uanp select cint, cast(cstring1 as varchar(128)) from alltypesorc where cint < 0 order by cint limit 10;
 insert overwrite table acid_uanp select cint, cast(cstring1 as varchar(128)) from alltypesorc;
diff --git a/ql/src/test/queries/clientnegative/authorization_delete_nodeletepriv.q b/ql/src/test/queries/clientnegative/authorization_delete_nodeletepriv.q
index 31a3297e04..f2de3066cf 100644
--- a/ql/src/test/queries/clientnegative/authorization_delete_nodeletepriv.q
+++ b/ql/src/test/queries/clientnegative/authorization_delete_nodeletepriv.q
@@ -9,7 +9,7 @@ set hive.enforce.bucketing=true;
 
 
 -- check update without update priv
-create table auth_nodel(i int) clustered by (i) into 2 buckets stored as orc;;
+create table auth_nodel(i int) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true');
 
 set user.name=user1;
 delete from auth_nodel where i > 0;
diff --git a/ql/src/test/queries/clientnegative/authorization_update_noupdatepriv.q b/ql/src/test/queries/clientnegative/authorization_update_noupdatepriv.q
index 5310dbe930..70655271fc 100644
--- a/ql/src/test/queries/clientnegative/authorization_update_noupdatepriv.q
+++ b/ql/src/test/queries/clientnegative/authorization_update_noupdatepriv.q
@@ -9,7 +9,7 @@ set hive.enforce.bucketing=true;
 
 
 -- check update without update priv
-create table auth_noupd(i int) clustered by (i) into 2 buckets stored as orc;;
+create table auth_noupd(i int) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true');
 
 set user.name=user1;
 update auth_noupd set i = 0 where i > 0;
diff --git a/ql/src/test/queries/clientnegative/delete_not_bucketed.q b/ql/src/test/queries/clientnegative/delete_not_bucketed.q
new file mode 100644
index 0000000000..80dffead7e
--- /dev/null
+++ b/ql/src/test/queries/clientnegative/delete_not_bucketed.q
@@ -0,0 +1,7 @@
+set hive.support.concurrency=true;
+set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DbTxnManager;
+set hive.enforce.bucketing=true;
+
+create table acid_notbucketed(a int, b varchar(128)) stored as orc TBLPROPERTIES ('transactional'='true');
+
+delete from acid_notbucketed where a = 3;
diff --git a/ql/src/test/queries/clientnegative/delete_sorted.q b/ql/src/test/queries/clientnegative/delete_sorted.q
new file mode 100644
index 0000000000..fd8d579e9f
--- /dev/null
+++ b/ql/src/test/queries/clientnegative/delete_sorted.q
@@ -0,0 +1,7 @@
+set hive.support.concurrency=true;
+set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DbTxnManager;
+set hive.enforce.bucketing=true;
+
+create table acid_insertsort(a int, b varchar(128)) partitioned by (ds string) clustered by (a) sorted by (b) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true');
+
+delete from acid_insertsort where a = 3;
diff --git a/ql/src/test/queries/clientnegative/insert_sorted.q b/ql/src/test/queries/clientnegative/insert_sorted.q
new file mode 100644
index 0000000000..18c942a1f6
--- /dev/null
+++ b/ql/src/test/queries/clientnegative/insert_sorted.q
@@ -0,0 +1,7 @@
+set hive.support.concurrency=true;
+set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DbTxnManager;
+set hive.enforce.bucketing=true;
+
+create table acid_insertsort(a int, b varchar(128)) clustered by (a) sorted by (b) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true');
+
+insert into table acid_insertsort select cint, cast(cstring1 as varchar(128)) from alltypesorc where cint is not null order by cint limit 10;
diff --git a/ql/src/test/queries/clientnegative/insert_values_sorted.q b/ql/src/test/queries/clientnegative/insert_values_sorted.q
new file mode 100644
index 0000000000..260e2fb066
--- /dev/null
+++ b/ql/src/test/queries/clientnegative/insert_values_sorted.q
@@ -0,0 +1,7 @@
+set hive.support.concurrency=true;
+set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DbTxnManager;
+set hive.enforce.bucketing=true;
+
+create table acid_insertsort(a int, b varchar(128)) clustered by (a) sorted by (b) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true');
+
+insert into table acid_insertsort values (1, 'abc'),(2, 'def');
diff --git a/ql/src/test/queries/clientnegative/update_not_bucketed.q b/ql/src/test/queries/clientnegative/update_not_bucketed.q
new file mode 100644
index 0000000000..8512fa714c
--- /dev/null
+++ b/ql/src/test/queries/clientnegative/update_not_bucketed.q
@@ -0,0 +1,7 @@
+set hive.support.concurrency=true;
+set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DbTxnManager;
+set hive.enforce.bucketing=true;
+
+create table acid_notbucketed(a int, b varchar(128)) partitioned by (ds string) stored as orc TBLPROPERTIES ('transactional'='true');
+
+update acid_notbucketed set b = 'fred' where a = 3;
diff --git a/ql/src/test/queries/clientnegative/update_partition_col.q b/ql/src/test/queries/clientnegative/update_partition_col.q
index 929cc5930d..e9c60ccb95 100644
--- a/ql/src/test/queries/clientnegative/update_partition_col.q
+++ b/ql/src/test/queries/clientnegative/update_partition_col.q
@@ -2,6 +2,6 @@ set hive.support.concurrency=true;
 set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DbTxnManager;
 set hive.enforce.bucketing=true;
 
-create table foo(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc;
+create table foo(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true');
 
 update foo set ds = 'fred';
diff --git a/ql/src/test/queries/clientnegative/update_sorted.q b/ql/src/test/queries/clientnegative/update_sorted.q
new file mode 100644
index 0000000000..917c3b5619
--- /dev/null
+++ b/ql/src/test/queries/clientnegative/update_sorted.q
@@ -0,0 +1,7 @@
+set hive.support.concurrency=true;
+set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DbTxnManager;
+set hive.enforce.bucketing=true;
+
+create table acid_insertsort(a int, b varchar(128)) clustered by (a) sorted by (b) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true');
+
+update acid_insertsort set b = 'fred' where b = 'bob';
diff --git a/ql/src/test/queries/clientpositive/acid_vectorization.q b/ql/src/test/queries/clientpositive/acid_vectorization.q
index a1bf9719f5..3f386c97af 100644
--- a/ql/src/test/queries/clientpositive/acid_vectorization.q
+++ b/ql/src/test/queries/clientpositive/acid_vectorization.q
@@ -4,7 +4,7 @@ set hive.enforce.bucketing=true;
 set hive.exec.dynamic.partition.mode=nonstrict;
 set hive.vectorized.execution.enabled=true;
 
-CREATE TABLE acid_vectorized(a INT, b STRING) CLUSTERED BY(a) INTO 2 BUCKETS STORED AS ORC;
+CREATE TABLE acid_vectorized(a INT, b STRING) CLUSTERED BY(a) INTO 2 BUCKETS STORED AS ORC TBLPROPERTIES ('transactional'='true');
 insert into table acid_vectorized select cint, cstring1 from alltypesorc where cint is not null order by cint limit 10;
 set hive.vectorized.execution.enabled=true;
 insert into table acid_vectorized values (1, 'bar');
diff --git a/ql/src/test/queries/clientpositive/authorization_delete.q b/ql/src/test/queries/clientpositive/authorization_delete.q
index 973fb8e42d..d96e6ab06a 100644
--- a/ql/src/test/queries/clientpositive/authorization_delete.q
+++ b/ql/src/test/queries/clientpositive/authorization_delete.q
@@ -9,7 +9,7 @@ set hive.enforce.bucketing=true;
 set user.name=user1;
 -- current user has been set (comment line before the set cmd is resulting in parse error!!)
 
-CREATE TABLE t_auth_del(i int) clustered by (i) into 2 buckets stored as orc;
+CREATE TABLE t_auth_del(i int) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true');
 
 -- grant update privilege to another user
 GRANT DELETE ON t_auth_del TO USER userWIns;
diff --git a/ql/src/test/queries/clientpositive/authorization_delete_own_table.q b/ql/src/test/queries/clientpositive/authorization_delete_own_table.q
index 8b4c89e9a9..7abdc1259e 100644
--- a/ql/src/test/queries/clientpositive/authorization_delete_own_table.q
+++ b/ql/src/test/queries/clientpositive/authorization_delete_own_table.q
@@ -9,7 +9,7 @@ set hive.enforce.bucketing=true;
 
 
 set user.name=user1;
-create table auth_noupd(i int) clustered by (i) into 2 buckets stored as orc;;
+create table auth_noupd(i int) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true');
 delete from auth_noupd where i > 0;
 
 set user.name=hive_admin_user;
diff --git a/ql/src/test/queries/clientpositive/authorization_update.q b/ql/src/test/queries/clientpositive/authorization_update.q
index fd9f670409..3601e67f25 100644
--- a/ql/src/test/queries/clientpositive/authorization_update.q
+++ b/ql/src/test/queries/clientpositive/authorization_update.q
@@ -9,7 +9,7 @@ set hive.enforce.bucketing=true;
 set user.name=user1;
 -- current user has been set (comment line before the set cmd is resulting in parse error!!)
 
-CREATE TABLE t_auth_up(i int) clustered by (i) into 2 buckets stored as orc;
+CREATE TABLE t_auth_up(i int) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true');
 
 CREATE TABLE t_select(i int);
 GRANT ALL ON TABLE t_select TO ROLE public;
diff --git a/ql/src/test/queries/clientpositive/authorization_update_own_table.q b/ql/src/test/queries/clientpositive/authorization_update_own_table.q
index 489117b8dd..18a643cada 100644
--- a/ql/src/test/queries/clientpositive/authorization_update_own_table.q
+++ b/ql/src/test/queries/clientpositive/authorization_update_own_table.q
@@ -9,7 +9,7 @@ set hive.enforce.bucketing=true;
 
 
 set user.name=user1;
-create table auth_noupd(i int) clustered by (i) into 2 buckets stored as orc;;
+create table auth_noupd(i int) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true');
 update auth_noupd set i = 0 where i > 0;
 
 set user.name=hive_admin_user;
diff --git a/ql/src/test/queries/clientpositive/delete_all_non_partitioned.q b/ql/src/test/queries/clientpositive/delete_all_non_partitioned.q
index f15391b5ab..9110dccb4d 100644
--- a/ql/src/test/queries/clientpositive/delete_all_non_partitioned.q
+++ b/ql/src/test/queries/clientpositive/delete_all_non_partitioned.q
@@ -2,7 +2,7 @@ set hive.support.concurrency=true;
 set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DbTxnManager;
 set hive.enforce.bucketing=true;
 
-create table acid_danp(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc;
+create table acid_danp(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true');
 
 insert into table acid_danp select cint, cast(cstring1 as varchar(128)) from alltypesorc where cint < 0 order by cint limit 10;
 
diff --git a/ql/src/test/queries/clientpositive/delete_all_partitioned.q b/ql/src/test/queries/clientpositive/delete_all_partitioned.q
index 9ae6a54cb8..f082b6d82f 100644
--- a/ql/src/test/queries/clientpositive/delete_all_partitioned.q
+++ b/ql/src/test/queries/clientpositive/delete_all_partitioned.q
@@ -2,7 +2,7 @@ set hive.support.concurrency=true;
 set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DbTxnManager;
 set hive.enforce.bucketing=true;
 
-create table acid_dap(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc;
+create table acid_dap(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true');
 
 insert into table acid_dap partition (ds='today') select cint, cast(cstring1 as varchar(128)) from alltypesorc where cint is not null and cint < 0 order by cint limit 10;
 insert into table acid_dap partition (ds='tomorrow') select cint, cast(cstring1 as varchar(128)) from alltypesorc where cint is not null and cint > 1000 order by cint limit 10;
diff --git a/ql/src/test/queries/clientpositive/delete_orig_table.q b/ql/src/test/queries/clientpositive/delete_orig_table.q
index d859eaeacc..fd23f4b65e 100644
--- a/ql/src/test/queries/clientpositive/delete_orig_table.q
+++ b/ql/src/test/queries/clientpositive/delete_orig_table.q
@@ -17,7 +17,7 @@ create table acid_dot(
     ctimestamp1 TIMESTAMP,
     ctimestamp2 TIMESTAMP,
     cboolean1 BOOLEAN,
-    cboolean2 BOOLEAN) clustered by (cint) into 1 buckets stored as orc location '${system:test.tmp.dir}/delete_orig_table';
+    cboolean2 BOOLEAN) clustered by (cint) into 1 buckets stored as orc location '${system:test.tmp.dir}/delete_orig_table' TBLPROPERTIES ('transactional'='true');
 
 select count(*) from acid_dot;
 
diff --git a/ql/src/test/queries/clientpositive/delete_tmp_table.q b/ql/src/test/queries/clientpositive/delete_tmp_table.q
index 6f5a73d1f8..eb6c09526c 100644
--- a/ql/src/test/queries/clientpositive/delete_tmp_table.q
+++ b/ql/src/test/queries/clientpositive/delete_tmp_table.q
@@ -2,7 +2,7 @@ set hive.support.concurrency=true;
 set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DbTxnManager;
 set hive.enforce.bucketing=true;
 
-create temporary table acid_dtt(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc;
+create temporary table acid_dtt(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true');
 
 insert into table acid_dtt select cint, cast(cstring1 as varchar(128)) from alltypesorc where cint is not null order by cint limit 10;
 
diff --git a/ql/src/test/queries/clientpositive/delete_where_no_match.q b/ql/src/test/queries/clientpositive/delete_where_no_match.q
index 16a383903d..8ed979d2eb 100644
--- a/ql/src/test/queries/clientpositive/delete_where_no_match.q
+++ b/ql/src/test/queries/clientpositive/delete_where_no_match.q
@@ -2,7 +2,7 @@ set hive.support.concurrency=true;
 set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DbTxnManager;
 set hive.enforce.bucketing=true;
 
-create table acid_dwnm(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc;
+create table acid_dwnm(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true');
 
 insert into table acid_dwnm select cint, cast(cstring1 as varchar(128)) from alltypesorc where cint is not null order by cint limit 10;
 
diff --git a/ql/src/test/queries/clientpositive/delete_where_non_partitioned.q b/ql/src/test/queries/clientpositive/delete_where_non_partitioned.q
index b703768822..dac53757f7 100644
--- a/ql/src/test/queries/clientpositive/delete_where_non_partitioned.q
+++ b/ql/src/test/queries/clientpositive/delete_where_non_partitioned.q
@@ -2,7 +2,7 @@ set hive.support.concurrency=true;
 set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DbTxnManager;
 set hive.enforce.bucketing=true;
 
-create table acid_dwnp(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc;
+create table acid_dwnp(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true');
 
 insert into table acid_dwnp select cint, cast(cstring1 as varchar(128)) from alltypesorc where cint is not null order by cint limit 10;
 
diff --git a/ql/src/test/queries/clientpositive/delete_where_partitioned.q b/ql/src/test/queries/clientpositive/delete_where_partitioned.q
index 5959c3c9f4..f84f26a0ed 100644
--- a/ql/src/test/queries/clientpositive/delete_where_partitioned.q
+++ b/ql/src/test/queries/clientpositive/delete_where_partitioned.q
@@ -2,7 +2,7 @@ set hive.support.concurrency=true;
 set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DbTxnManager;
 set hive.enforce.bucketing=true;
 
-create table acid_dwp(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc;
+create table acid_dwp(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true');
 
 insert into table acid_dwp partition (ds='today') select cint, cast(cstring1 as varchar(128)) from alltypesorc where cint is not null and cint < 0 order by cint limit 10;
 insert into table acid_dwp partition (ds='tomorrow') select cint, cast(cstring1 as varchar(128)) from alltypesorc where cint is not null and cint > -10000000 order by cint limit 10;
diff --git a/ql/src/test/queries/clientpositive/delete_whole_partition.q b/ql/src/test/queries/clientpositive/delete_whole_partition.q
index 14440903a7..8228a321cf 100644
--- a/ql/src/test/queries/clientpositive/delete_whole_partition.q
+++ b/ql/src/test/queries/clientpositive/delete_whole_partition.q
@@ -2,7 +2,7 @@ set hive.support.concurrency=true;
 set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DbTxnManager;
 set hive.enforce.bucketing=true;
 
-create table acid_dwhp(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc;
+create table acid_dwhp(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true');
 
 insert into table acid_dwhp partition (ds='today') select cint, cast(cstring1 as varchar(128)) from alltypesorc where cint is not null and cint < 0 order by cint limit 10;
 insert into table acid_dwhp partition (ds='tomorrow') select cint, cast(cstring1 as varchar(128)) from alltypesorc where cint is not null and cint > -10000000 order by cint limit 10;
diff --git a/ql/src/test/queries/clientpositive/insert_acid_dynamic_partition.q b/ql/src/test/queries/clientpositive/insert_acid_dynamic_partition.q
new file mode 100644
index 0000000000..c5445896ee
--- /dev/null
+++ b/ql/src/test/queries/clientpositive/insert_acid_dynamic_partition.q
@@ -0,0 +1,10 @@
+set hive.support.concurrency=true;
+set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DbTxnManager;
+set hive.enforce.bucketing=true;
+set hive.exec.dynamic.partition.mode=nonstrict;
+
+create table acid_dynamic(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true');
+
+insert into table acid_dynamic partition (ds) select cint, cast(cstring1 as varchar(128)), cstring2 from alltypesorc where cint is not null and cint < 0 order by cint limit 5;
+
+select * from acid_dynamic order by a,b;
diff --git a/ql/src/test/queries/clientpositive/insert_acid_not_bucketed.q b/ql/src/test/queries/clientpositive/insert_acid_not_bucketed.q
new file mode 100644
index 0000000000..a29b1e7f72
--- /dev/null
+++ b/ql/src/test/queries/clientpositive/insert_acid_not_bucketed.q
@@ -0,0 +1,9 @@
+set hive.support.concurrency=true;
+set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DbTxnManager;
+set hive.enforce.bucketing=true;
+
+create table acid_notbucketed(a int, b varchar(128)) stored as orc;
+
+insert into table acid_notbucketed select cint, cast(cstring1 as varchar(128)) from alltypesorc where cint is not null order by cint limit 10;
+
+select * from acid_notbucketed;
diff --git a/ql/src/test/queries/clientpositive/insert_orig_table.q b/ql/src/test/queries/clientpositive/insert_orig_table.q
index e1114d5115..c38bd5a5ca 100644
--- a/ql/src/test/queries/clientpositive/insert_orig_table.q
+++ b/ql/src/test/queries/clientpositive/insert_orig_table.q
@@ -14,7 +14,7 @@ create table acid_iot(
     ctimestamp1 TIMESTAMP,
     ctimestamp2 TIMESTAMP,
     cboolean1 BOOLEAN,
-    cboolean2 BOOLEAN) clustered by (cint) into 1 buckets stored as orc;
+    cboolean2 BOOLEAN) clustered by (cint) into 1 buckets stored as orc TBLPROPERTIES ('transactional'='true');
 
 LOAD DATA LOCAL INPATH "../../data/files/alltypesorc" into table acid_iot;
 
diff --git a/ql/src/test/queries/clientpositive/insert_update_delete.q b/ql/src/test/queries/clientpositive/insert_update_delete.q
index a3ef18137a..8dbb77c219 100644
--- a/ql/src/test/queries/clientpositive/insert_update_delete.q
+++ b/ql/src/test/queries/clientpositive/insert_update_delete.q
@@ -2,7 +2,7 @@ set hive.support.concurrency=true;
 set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DbTxnManager;
 set hive.enforce.bucketing=true;
 
-create table acid_iud(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc;
+create table acid_iud(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true');
 
 insert into table acid_iud select cint, cast(cstring1 as varchar(128)) from alltypesorc where cint < 0 order by cint limit 10;
 
diff --git a/ql/src/test/queries/clientpositive/insert_values_acid_not_bucketed.q b/ql/src/test/queries/clientpositive/insert_values_acid_not_bucketed.q
new file mode 100644
index 0000000000..fc0cb1048a
--- /dev/null
+++ b/ql/src/test/queries/clientpositive/insert_values_acid_not_bucketed.q
@@ -0,0 +1,9 @@
+set hive.support.concurrency=true;
+set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DbTxnManager;
+set hive.enforce.bucketing=true;
+
+create table acid_notbucketed(a int, b varchar(128)) stored as orc;
+
+insert into table acid_notbucketed values (1, 'abc'), (2, 'def');
+
+select * from acid_notbucketed;
diff --git a/ql/src/test/queries/clientpositive/insert_values_dynamic_partitioned.q b/ql/src/test/queries/clientpositive/insert_values_dynamic_partitioned.q
index bea67a480a..71e0e73f1f 100644
--- a/ql/src/test/queries/clientpositive/insert_values_dynamic_partitioned.q
+++ b/ql/src/test/queries/clientpositive/insert_values_dynamic_partitioned.q
@@ -5,7 +5,7 @@ set hive.enforce.bucketing=true;
 
 create table ivdp(i int,
                  de decimal(5,2),
-                 vc varchar(128)) partitioned by (ds string) clustered by (i) into 2 buckets stored as orc;
+                 vc varchar(128)) partitioned by (ds string) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true');
 
 insert into table ivdp partition (ds) values 
     (1, 109.23, 'and everywhere that mary went', 'today'),
diff --git a/ql/src/test/queries/clientpositive/insert_values_non_partitioned.q b/ql/src/test/queries/clientpositive/insert_values_non_partitioned.q
index f69100c939..d0e7b0f68c 100644
--- a/ql/src/test/queries/clientpositive/insert_values_non_partitioned.q
+++ b/ql/src/test/queries/clientpositive/insert_values_non_partitioned.q
@@ -14,7 +14,7 @@ create table acid_ivnp(ti tinyint,
                  b boolean,
                  s string,
                  vc varchar(128),
-                 ch char(12)) clustered by (i) into 2 buckets stored as orc;
+                 ch char(12)) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true');
 
 insert into table acid_ivnp values 
     (1, 257, 65537, 4294967297, 3.14, 3.141592654, 109.23, '2014-08-25 17:21:30.0', '2014-08-25', true, 'mary had a little lamb', 'ring around the rosie', 'red'),
diff --git a/ql/src/test/queries/clientpositive/insert_values_orig_table.q b/ql/src/test/queries/clientpositive/insert_values_orig_table.q
index 703ed817a5..8fef549767 100644
--- a/ql/src/test/queries/clientpositive/insert_values_orig_table.q
+++ b/ql/src/test/queries/clientpositive/insert_values_orig_table.q
@@ -14,7 +14,7 @@ create table acid_ivot(
     ctimestamp1 TIMESTAMP,
     ctimestamp2 TIMESTAMP,
     cboolean1 BOOLEAN,
-    cboolean2 BOOLEAN) clustered by (cint) into 1 buckets stored as orc;
+    cboolean2 BOOLEAN) clustered by (cint) into 1 buckets stored as orc TBLPROPERTIES ('transactional'='true');
 
 LOAD DATA LOCAL INPATH "../../data/files/alltypesorc" into table acid_ivot;
 
diff --git a/ql/src/test/queries/clientpositive/insert_values_partitioned.q b/ql/src/test/queries/clientpositive/insert_values_partitioned.q
index 70bd03b888..c8223f75b9 100644
--- a/ql/src/test/queries/clientpositive/insert_values_partitioned.q
+++ b/ql/src/test/queries/clientpositive/insert_values_partitioned.q
@@ -13,7 +13,7 @@ create table acid_ivp(ti tinyint,
                  dt date,
                  s string,
                  vc varchar(128),
-                 ch char(12)) partitioned by (ds string) clustered by (i) into 2 buckets stored as orc;
+                 ch char(12)) partitioned by (ds string) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true');
 
 insert into table acid_ivp partition (ds='today') values 
     (1, 257, 65537, 4294967297, 3.14, 3.141592654, 109.23, '2014-08-25 17:21:30.0', '2014-08-25', 'mary had a little lamb', 'ring around the rosie', 'red'),
diff --git a/ql/src/test/queries/clientpositive/insert_values_tmp_table.q b/ql/src/test/queries/clientpositive/insert_values_tmp_table.q
index a7afa739df..4e4c39ef73 100644
--- a/ql/src/test/queries/clientpositive/insert_values_tmp_table.q
+++ b/ql/src/test/queries/clientpositive/insert_values_tmp_table.q
@@ -2,7 +2,7 @@ set hive.support.concurrency=true;
 set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DbTxnManager;
 set hive.enforce.bucketing=true;
 
-create temporary table acid_ivtt(i int, de decimal(5,2), vc varchar(128)) clustered by (vc) into 2 buckets stored as orc;
+create temporary table acid_ivtt(i int, de decimal(5,2), vc varchar(128)) clustered by (vc) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true');
 
 insert into table acid_ivtt values 
     (1, 109.23, 'mary had a little lamb'),
diff --git a/ql/src/test/queries/clientpositive/update_after_multiple_inserts.q b/ql/src/test/queries/clientpositive/update_after_multiple_inserts.q
index b440cf33f2..6ef209fbe7 100644
--- a/ql/src/test/queries/clientpositive/update_after_multiple_inserts.q
+++ b/ql/src/test/queries/clientpositive/update_after_multiple_inserts.q
@@ -5,7 +5,7 @@ set hive.enforce.bucketing=true;
 
 create table acid_uami(i int,
                  de decimal(5,2),
-                 vc varchar(128)) clustered by (i) into 2 buckets stored as orc;
+                 vc varchar(128)) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true');
 
 insert into table acid_uami values 
     (1, 109.23, 'mary had a little lamb'),
diff --git a/ql/src/test/queries/clientpositive/update_all_non_partitioned.q b/ql/src/test/queries/clientpositive/update_all_non_partitioned.q
index 7c427df4ef..3c01825302 100644
--- a/ql/src/test/queries/clientpositive/update_all_non_partitioned.q
+++ b/ql/src/test/queries/clientpositive/update_all_non_partitioned.q
@@ -2,7 +2,7 @@ set hive.support.concurrency=true;
 set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DbTxnManager;
 set hive.enforce.bucketing=true;
 
-create table acid_uanp(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc;
+create table acid_uanp(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true');
 
 insert into table acid_uanp select cint, cast(cstring1 as varchar(128)) from alltypesorc where cint < 0 order by cint limit 10;
 
diff --git a/ql/src/test/queries/clientpositive/update_all_partitioned.q b/ql/src/test/queries/clientpositive/update_all_partitioned.q
index 80d40c1374..b4079854d9 100644
--- a/ql/src/test/queries/clientpositive/update_all_partitioned.q
+++ b/ql/src/test/queries/clientpositive/update_all_partitioned.q
@@ -2,7 +2,7 @@ set hive.support.concurrency=true;
 set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DbTxnManager;
 set hive.enforce.bucketing=true;
 
-create table acid_uap(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc;
+create table acid_uap(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true');
 
 insert into table acid_uap partition (ds='today') select cint, cast(cstring1 as varchar(128)) from alltypesorc where cint is not null and cint < 0 order by cint limit 10;
 insert into table acid_uap partition (ds='tomorrow') select cint, cast(cstring1 as varchar(128)) from alltypesorc where cint is not null and cint > 10 order by cint limit 10;
diff --git a/ql/src/test/queries/clientpositive/update_all_types.q b/ql/src/test/queries/clientpositive/update_all_types.q
index 8ed74f0612..14ffc59e0b 100644
--- a/ql/src/test/queries/clientpositive/update_all_types.q
+++ b/ql/src/test/queries/clientpositive/update_all_types.q
@@ -14,7 +14,7 @@ create table acid_uat(ti tinyint,
                  s string,
                  vc varchar(128),
                  ch char(36),
-                 b boolean) clustered by (i) into 2 buckets stored as orc;
+                 b boolean) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true');
 
 insert into table acid_uat
     select ctinyint,
diff --git a/ql/src/test/queries/clientpositive/update_orig_table.q b/ql/src/test/queries/clientpositive/update_orig_table.q
index 61622d9645..27b4a95074 100644
--- a/ql/src/test/queries/clientpositive/update_orig_table.q
+++ b/ql/src/test/queries/clientpositive/update_orig_table.q
@@ -17,7 +17,7 @@ create table acid_uot(
     ctimestamp1 TIMESTAMP,
     ctimestamp2 TIMESTAMP,
     cboolean1 BOOLEAN,
-    cboolean2 BOOLEAN) clustered by (cint) into 1 buckets stored as orc location '${system:test.tmp.dir}/update_orig_table';
+    cboolean2 BOOLEAN) clustered by (cint) into 1 buckets stored as orc location '${system:test.tmp.dir}/update_orig_table' TBLPROPERTIES ('transactional'='true');
 
 update acid_uot set cstring1 = 'fred' where cint < -1070551679;
 
diff --git a/ql/src/test/queries/clientpositive/update_tmp_table.q b/ql/src/test/queries/clientpositive/update_tmp_table.q
index 5fbad2cf4b..281357f377 100644
--- a/ql/src/test/queries/clientpositive/update_tmp_table.q
+++ b/ql/src/test/queries/clientpositive/update_tmp_table.q
@@ -2,7 +2,7 @@ set hive.support.concurrency=true;
 set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DbTxnManager;
 set hive.enforce.bucketing=true;
 
-create table acid_utt(a int, b varchar(128)) clustered by (b) into 2 buckets stored as orc;
+create table acid_utt(a int, b varchar(128)) clustered by (b) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true');
 
 insert into table acid_utt select cint, cast(cstring1 as varchar(128)) from alltypesorc where cint is not null order by cint limit 10;
 
diff --git a/ql/src/test/queries/clientpositive/update_two_cols.q b/ql/src/test/queries/clientpositive/update_two_cols.q
index 716df7dc59..b1972e5651 100644
--- a/ql/src/test/queries/clientpositive/update_two_cols.q
+++ b/ql/src/test/queries/clientpositive/update_two_cols.q
@@ -2,7 +2,7 @@ set hive.support.concurrency=true;
 set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DbTxnManager;
 set hive.enforce.bucketing=true;
 
-create table acid_utc(a int, b varchar(128), c float) clustered by (a) into 2 buckets stored as orc;
+create table acid_utc(a int, b varchar(128), c float) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true');
 
 insert into table acid_utc select cint, cast(cstring1 as varchar(128)), cfloat from alltypesorc where cint < 0 order by cint limit 10;
 
diff --git a/ql/src/test/queries/clientpositive/update_where_no_match.q b/ql/src/test/queries/clientpositive/update_where_no_match.q
index d3252de1d3..d5788620a1 100644
--- a/ql/src/test/queries/clientpositive/update_where_no_match.q
+++ b/ql/src/test/queries/clientpositive/update_where_no_match.q
@@ -2,7 +2,7 @@ set hive.support.concurrency=true;
 set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DbTxnManager;
 set hive.enforce.bucketing=true;
 
-create table acid_wnm(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc;
+create table acid_wnm(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true');
 
 insert into table acid_wnm select cint, cast(cstring1 as varchar(128)) from alltypesorc where cint is not null order by cint limit 10;
 
diff --git a/ql/src/test/queries/clientpositive/update_where_non_partitioned.q b/ql/src/test/queries/clientpositive/update_where_non_partitioned.q
index e52d9e818d..06c688ffc7 100644
--- a/ql/src/test/queries/clientpositive/update_where_non_partitioned.q
+++ b/ql/src/test/queries/clientpositive/update_where_non_partitioned.q
@@ -2,7 +2,7 @@ set hive.support.concurrency=true;
 set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DbTxnManager;
 set hive.enforce.bucketing=true;
 
-create table acid_uwnp(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc;
+create table acid_uwnp(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true');
 
 insert into table acid_uwnp select cint, cast(cstring1 as varchar(128)) from alltypesorc where cint is not null order by cint limit 10;
 
diff --git a/ql/src/test/queries/clientpositive/update_where_partitioned.q b/ql/src/test/queries/clientpositive/update_where_partitioned.q
index d84da5b85e..858cebbb70 100644
--- a/ql/src/test/queries/clientpositive/update_where_partitioned.q
+++ b/ql/src/test/queries/clientpositive/update_where_partitioned.q
@@ -2,7 +2,7 @@ set hive.support.concurrency=true;
 set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DbTxnManager;
 set hive.enforce.bucketing=true;
 
-create table acid_uwp(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc;
+create table acid_uwp(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true');
 
 insert into table acid_uwp partition (ds='today') select cint, cast(cstring1 as varchar(128)) from alltypesorc where cint is not null and cint < 0 order by cint limit 10;
 insert into table acid_uwp partition (ds='tomorrow') select cint, cast(cstring1 as varchar(128)) from alltypesorc where cint is not null and cint > 100 order by cint limit 10;
diff --git a/ql/src/test/results/clientnegative/acid_overwrite.q.out b/ql/src/test/results/clientnegative/acid_overwrite.q.out
index f28e0a452d..0940106af0 100644
--- a/ql/src/test/results/clientnegative/acid_overwrite.q.out
+++ b/ql/src/test/results/clientnegative/acid_overwrite.q.out
@@ -1,8 +1,8 @@
-PREHOOK: query: create table acid_uanp(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc
+PREHOOK: query: create table acid_uanp(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@acid_uanp
-POSTHOOK: query: create table acid_uanp(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc
+POSTHOOK: query: create table acid_uanp(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@acid_uanp
diff --git a/ql/src/test/results/clientnegative/authorization_delete_nodeletepriv.q.out b/ql/src/test/results/clientnegative/authorization_delete_nodeletepriv.q.out
index 00fb3f7933..2fc358a172 100644
--- a/ql/src/test/results/clientnegative/authorization_delete_nodeletepriv.q.out
+++ b/ql/src/test/results/clientnegative/authorization_delete_nodeletepriv.q.out
@@ -1,10 +1,10 @@
 PREHOOK: query: -- check update without update priv
-create table auth_nodel(i int) clustered by (i) into 2 buckets stored as orc
+create table auth_nodel(i int) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@auth_nodel
 POSTHOOK: query: -- check update without update priv
-create table auth_nodel(i int) clustered by (i) into 2 buckets stored as orc
+create table auth_nodel(i int) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@auth_nodel
diff --git a/ql/src/test/results/clientnegative/authorization_update_noupdatepriv.q.out b/ql/src/test/results/clientnegative/authorization_update_noupdatepriv.q.out
index e4b3c5e28a..c39c6d7b8b 100644
--- a/ql/src/test/results/clientnegative/authorization_update_noupdatepriv.q.out
+++ b/ql/src/test/results/clientnegative/authorization_update_noupdatepriv.q.out
@@ -1,10 +1,10 @@
 PREHOOK: query: -- check update without update priv
-create table auth_noupd(i int) clustered by (i) into 2 buckets stored as orc
+create table auth_noupd(i int) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@auth_noupd
 POSTHOOK: query: -- check update without update priv
-create table auth_noupd(i int) clustered by (i) into 2 buckets stored as orc
+create table auth_noupd(i int) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@auth_noupd
diff --git a/ql/src/test/results/clientnegative/delete_non_acid_table.q.out b/ql/src/test/results/clientnegative/delete_non_acid_table.q.out
index c1e54a848f..a9b884aaf8 100644
--- a/ql/src/test/results/clientnegative/delete_non_acid_table.q.out
+++ b/ql/src/test/results/clientnegative/delete_non_acid_table.q.out
@@ -34,4 +34,4 @@ POSTHOOK: Input: default@not_an_acid_table2
 -1070883071	0ruyd6Y50JpdGRf6HqD
 -1070551679	iUR3Q
 -1069736047	k17Am8uPHWk02cEf1jet
-FAILED: SemanticException [Error 10297]: Attempt to do update or delete on table default.not_an_acid_table2 that does not use an AcidOutputFormat
+FAILED: SemanticException [Error 10297]: Attempt to do update or delete on table default.not_an_acid_table2 that does not use an AcidOutputFormat or is not bucketed
diff --git a/ql/src/test/results/clientnegative/delete_not_bucketed.q.out b/ql/src/test/results/clientnegative/delete_not_bucketed.q.out
new file mode 100644
index 0000000000..d0ba68029a
--- /dev/null
+++ b/ql/src/test/results/clientnegative/delete_not_bucketed.q.out
@@ -0,0 +1,9 @@
+PREHOOK: query: create table acid_notbucketed(a int, b varchar(128)) stored as orc TBLPROPERTIES ('transactional'='true')
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@acid_notbucketed
+POSTHOOK: query: create table acid_notbucketed(a int, b varchar(128)) stored as orc TBLPROPERTIES ('transactional'='true')
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@acid_notbucketed
+FAILED: SemanticException [Error 10297]: Attempt to do update or delete on table acid_notbucketed that does not use an AcidOutputFormat or is not bucketed
diff --git a/ql/src/test/results/clientnegative/delete_sorted.q.out b/ql/src/test/results/clientnegative/delete_sorted.q.out
new file mode 100644
index 0000000000..0d248d0175
--- /dev/null
+++ b/ql/src/test/results/clientnegative/delete_sorted.q.out
@@ -0,0 +1,9 @@
+PREHOOK: query: create table acid_insertsort(a int, b varchar(128)) partitioned by (ds string) clustered by (a) sorted by (b) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@acid_insertsort
+POSTHOOK: query: create table acid_insertsort(a int, b varchar(128)) partitioned by (ds string) clustered by (a) sorted by (b) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@acid_insertsort
+FAILED: SemanticException [Error 10298]: ACID insert, update, delete not supported on tables that are sorted, table acid_insertsort
diff --git a/ql/src/test/results/clientnegative/insert_sorted.q.out b/ql/src/test/results/clientnegative/insert_sorted.q.out
new file mode 100644
index 0000000000..50dd5ebbe1
--- /dev/null
+++ b/ql/src/test/results/clientnegative/insert_sorted.q.out
@@ -0,0 +1,9 @@
+PREHOOK: query: create table acid_insertsort(a int, b varchar(128)) clustered by (a) sorted by (b) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@acid_insertsort
+POSTHOOK: query: create table acid_insertsort(a int, b varchar(128)) clustered by (a) sorted by (b) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@acid_insertsort
+FAILED: SemanticException [Error 10298]: ACID insert, update, delete not supported on tables that are sorted, table acid_insertsort
diff --git a/ql/src/test/results/clientnegative/insert_values_sorted.q.out b/ql/src/test/results/clientnegative/insert_values_sorted.q.out
new file mode 100644
index 0000000000..50dd5ebbe1
--- /dev/null
+++ b/ql/src/test/results/clientnegative/insert_values_sorted.q.out
@@ -0,0 +1,9 @@
+PREHOOK: query: create table acid_insertsort(a int, b varchar(128)) clustered by (a) sorted by (b) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@acid_insertsort
+POSTHOOK: query: create table acid_insertsort(a int, b varchar(128)) clustered by (a) sorted by (b) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@acid_insertsort
+FAILED: SemanticException [Error 10298]: ACID insert, update, delete not supported on tables that are sorted, table acid_insertsort
diff --git a/ql/src/test/results/clientnegative/update_non_acid_table.q.out b/ql/src/test/results/clientnegative/update_non_acid_table.q.out
index 4bf61db0cb..381b0db4f4 100644
--- a/ql/src/test/results/clientnegative/update_non_acid_table.q.out
+++ b/ql/src/test/results/clientnegative/update_non_acid_table.q.out
@@ -34,4 +34,4 @@ POSTHOOK: Input: default@not_an_acid_table
 -1070883071	0ruyd6Y50JpdGRf6HqD
 -1070551679	iUR3Q
 -1069736047	k17Am8uPHWk02cEf1jet
-FAILED: SemanticException [Error 10297]: Attempt to do update or delete on table default.not_an_acid_table that does not use an AcidOutputFormat
+FAILED: SemanticException [Error 10297]: Attempt to do update or delete on table default.not_an_acid_table that does not use an AcidOutputFormat or is not bucketed
diff --git a/ql/src/test/results/clientnegative/update_not_bucketed.q.out b/ql/src/test/results/clientnegative/update_not_bucketed.q.out
new file mode 100644
index 0000000000..8ebf41dc2f
--- /dev/null
+++ b/ql/src/test/results/clientnegative/update_not_bucketed.q.out
@@ -0,0 +1,9 @@
+PREHOOK: query: create table acid_notbucketed(a int, b varchar(128)) partitioned by (ds string) stored as orc TBLPROPERTIES ('transactional'='true')
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@acid_notbucketed
+POSTHOOK: query: create table acid_notbucketed(a int, b varchar(128)) partitioned by (ds string) stored as orc TBLPROPERTIES ('transactional'='true')
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@acid_notbucketed
+FAILED: SemanticException [Error 10297]: Attempt to do update or delete on table acid_notbucketed that does not use an AcidOutputFormat or is not bucketed
diff --git a/ql/src/test/results/clientnegative/update_partition_col.q.out b/ql/src/test/results/clientnegative/update_partition_col.q.out
index 003b53f386..81c50140b7 100644
--- a/ql/src/test/results/clientnegative/update_partition_col.q.out
+++ b/ql/src/test/results/clientnegative/update_partition_col.q.out
@@ -1,8 +1,8 @@
-PREHOOK: query: create table foo(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc
+PREHOOK: query: create table foo(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@foo
-POSTHOOK: query: create table foo(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc
+POSTHOOK: query: create table foo(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@foo
diff --git a/ql/src/test/results/clientnegative/update_sorted.q.out b/ql/src/test/results/clientnegative/update_sorted.q.out
new file mode 100644
index 0000000000..50dd5ebbe1
--- /dev/null
+++ b/ql/src/test/results/clientnegative/update_sorted.q.out
@@ -0,0 +1,9 @@
+PREHOOK: query: create table acid_insertsort(a int, b varchar(128)) clustered by (a) sorted by (b) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@acid_insertsort
+POSTHOOK: query: create table acid_insertsort(a int, b varchar(128)) clustered by (a) sorted by (b) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@acid_insertsort
+FAILED: SemanticException [Error 10298]: ACID insert, update, delete not supported on tables that are sorted, table acid_insertsort
diff --git a/ql/src/test/results/clientpositive/acid_vectorization.q.out b/ql/src/test/results/clientpositive/acid_vectorization.q.out
index 4a9d19f552..18dada595a 100644
--- a/ql/src/test/results/clientpositive/acid_vectorization.q.out
+++ b/ql/src/test/results/clientpositive/acid_vectorization.q.out
@@ -1,8 +1,8 @@
-PREHOOK: query: CREATE TABLE acid_vectorized(a INT, b STRING) CLUSTERED BY(a) INTO 2 BUCKETS STORED AS ORC
+PREHOOK: query: CREATE TABLE acid_vectorized(a INT, b STRING) CLUSTERED BY(a) INTO 2 BUCKETS STORED AS ORC TBLPROPERTIES ('transactional'='true')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@acid_vectorized
-POSTHOOK: query: CREATE TABLE acid_vectorized(a INT, b STRING) CLUSTERED BY(a) INTO 2 BUCKETS STORED AS ORC
+POSTHOOK: query: CREATE TABLE acid_vectorized(a INT, b STRING) CLUSTERED BY(a) INTO 2 BUCKETS STORED AS ORC TBLPROPERTIES ('transactional'='true')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@acid_vectorized
diff --git a/ql/src/test/results/clientpositive/authorization_delete.q.out b/ql/src/test/results/clientpositive/authorization_delete.q.out
index 9aa460042d..260b9a4ef8 100644
--- a/ql/src/test/results/clientpositive/authorization_delete.q.out
+++ b/ql/src/test/results/clientpositive/authorization_delete.q.out
@@ -1,12 +1,12 @@
 PREHOOK: query: -- current user has been set (comment line before the set cmd is resulting in parse error!!)
 
-CREATE TABLE t_auth_del(i int) clustered by (i) into 2 buckets stored as orc
+CREATE TABLE t_auth_del(i int) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@t_auth_del
 POSTHOOK: query: -- current user has been set (comment line before the set cmd is resulting in parse error!!)
 
-CREATE TABLE t_auth_del(i int) clustered by (i) into 2 buckets stored as orc
+CREATE TABLE t_auth_del(i int) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@t_auth_del
diff --git a/ql/src/test/results/clientpositive/authorization_delete_own_table.q.out b/ql/src/test/results/clientpositive/authorization_delete_own_table.q.out
index 1e0f9c85a6..24833ed09c 100644
--- a/ql/src/test/results/clientpositive/authorization_delete_own_table.q.out
+++ b/ql/src/test/results/clientpositive/authorization_delete_own_table.q.out
@@ -1,8 +1,8 @@
-PREHOOK: query: create table auth_noupd(i int) clustered by (i) into 2 buckets stored as orc
+PREHOOK: query: create table auth_noupd(i int) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@auth_noupd
-POSTHOOK: query: create table auth_noupd(i int) clustered by (i) into 2 buckets stored as orc
+POSTHOOK: query: create table auth_noupd(i int) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@auth_noupd
diff --git a/ql/src/test/results/clientpositive/authorization_update.q.out b/ql/src/test/results/clientpositive/authorization_update.q.out
index 019d363e2b..ef65b33135 100644
--- a/ql/src/test/results/clientpositive/authorization_update.q.out
+++ b/ql/src/test/results/clientpositive/authorization_update.q.out
@@ -1,12 +1,12 @@
 PREHOOK: query: -- current user has been set (comment line before the set cmd is resulting in parse error!!)
 
-CREATE TABLE t_auth_up(i int) clustered by (i) into 2 buckets stored as orc
+CREATE TABLE t_auth_up(i int) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@t_auth_up
 POSTHOOK: query: -- current user has been set (comment line before the set cmd is resulting in parse error!!)
 
-CREATE TABLE t_auth_up(i int) clustered by (i) into 2 buckets stored as orc
+CREATE TABLE t_auth_up(i int) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@t_auth_up
diff --git a/ql/src/test/results/clientpositive/authorization_update_own_table.q.out b/ql/src/test/results/clientpositive/authorization_update_own_table.q.out
index cbf8f5757f..e4b5f0be0d 100644
--- a/ql/src/test/results/clientpositive/authorization_update_own_table.q.out
+++ b/ql/src/test/results/clientpositive/authorization_update_own_table.q.out
@@ -1,8 +1,8 @@
-PREHOOK: query: create table auth_noupd(i int) clustered by (i) into 2 buckets stored as orc
+PREHOOK: query: create table auth_noupd(i int) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@auth_noupd
-POSTHOOK: query: create table auth_noupd(i int) clustered by (i) into 2 buckets stored as orc
+POSTHOOK: query: create table auth_noupd(i int) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@auth_noupd
diff --git a/ql/src/test/results/clientpositive/delete_all_non_partitioned.q.out b/ql/src/test/results/clientpositive/delete_all_non_partitioned.q.out
index 0d428cab98..38ce075ff8 100644
--- a/ql/src/test/results/clientpositive/delete_all_non_partitioned.q.out
+++ b/ql/src/test/results/clientpositive/delete_all_non_partitioned.q.out
@@ -1,8 +1,8 @@
-PREHOOK: query: create table acid_danp(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc
+PREHOOK: query: create table acid_danp(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@acid_danp
-POSTHOOK: query: create table acid_danp(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc
+POSTHOOK: query: create table acid_danp(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@acid_danp
diff --git a/ql/src/test/results/clientpositive/delete_all_partitioned.q.out b/ql/src/test/results/clientpositive/delete_all_partitioned.q.out
index 4486323105..90f8753687 100644
--- a/ql/src/test/results/clientpositive/delete_all_partitioned.q.out
+++ b/ql/src/test/results/clientpositive/delete_all_partitioned.q.out
@@ -1,8 +1,8 @@
-PREHOOK: query: create table acid_dap(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc
+PREHOOK: query: create table acid_dap(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@acid_dap
-POSTHOOK: query: create table acid_dap(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc
+POSTHOOK: query: create table acid_dap(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@acid_dap
diff --git a/ql/src/test/results/clientpositive/delete_tmp_table.q.out b/ql/src/test/results/clientpositive/delete_tmp_table.q.out
index ca568b38ff..4dc73448f0 100644
--- a/ql/src/test/results/clientpositive/delete_tmp_table.q.out
+++ b/ql/src/test/results/clientpositive/delete_tmp_table.q.out
@@ -1,8 +1,8 @@
-PREHOOK: query: create temporary table acid_dtt(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc
+PREHOOK: query: create temporary table acid_dtt(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@acid_dtt
-POSTHOOK: query: create temporary table acid_dtt(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc
+POSTHOOK: query: create temporary table acid_dtt(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@acid_dtt
diff --git a/ql/src/test/results/clientpositive/delete_where_no_match.q.out b/ql/src/test/results/clientpositive/delete_where_no_match.q.out
index 1450ee6da4..cb2adc60ba 100644
--- a/ql/src/test/results/clientpositive/delete_where_no_match.q.out
+++ b/ql/src/test/results/clientpositive/delete_where_no_match.q.out
@@ -1,8 +1,8 @@
-PREHOOK: query: create table acid_dwnm(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc
+PREHOOK: query: create table acid_dwnm(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@acid_dwnm
-POSTHOOK: query: create table acid_dwnm(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc
+POSTHOOK: query: create table acid_dwnm(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@acid_dwnm
diff --git a/ql/src/test/results/clientpositive/delete_where_non_partitioned.q.out b/ql/src/test/results/clientpositive/delete_where_non_partitioned.q.out
index d465e8eed0..1bdb1e630c 100644
--- a/ql/src/test/results/clientpositive/delete_where_non_partitioned.q.out
+++ b/ql/src/test/results/clientpositive/delete_where_non_partitioned.q.out
@@ -1,8 +1,8 @@
-PREHOOK: query: create table acid_dwnp(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc
+PREHOOK: query: create table acid_dwnp(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@acid_dwnp
-POSTHOOK: query: create table acid_dwnp(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc
+POSTHOOK: query: create table acid_dwnp(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@acid_dwnp
diff --git a/ql/src/test/results/clientpositive/delete_where_partitioned.q.out b/ql/src/test/results/clientpositive/delete_where_partitioned.q.out
index 9f8581b4f8..fc2e369876 100644
--- a/ql/src/test/results/clientpositive/delete_where_partitioned.q.out
+++ b/ql/src/test/results/clientpositive/delete_where_partitioned.q.out
@@ -1,8 +1,8 @@
-PREHOOK: query: create table acid_dwp(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc
+PREHOOK: query: create table acid_dwp(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@acid_dwp
-POSTHOOK: query: create table acid_dwp(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc
+POSTHOOK: query: create table acid_dwp(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@acid_dwp
diff --git a/ql/src/test/results/clientpositive/delete_whole_partition.q.out b/ql/src/test/results/clientpositive/delete_whole_partition.q.out
index a2408ebe43..043daf4d2b 100644
--- a/ql/src/test/results/clientpositive/delete_whole_partition.q.out
+++ b/ql/src/test/results/clientpositive/delete_whole_partition.q.out
@@ -1,8 +1,8 @@
-PREHOOK: query: create table acid_dwhp(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc
+PREHOOK: query: create table acid_dwhp(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@acid_dwhp
-POSTHOOK: query: create table acid_dwhp(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc
+POSTHOOK: query: create table acid_dwhp(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@acid_dwhp
diff --git a/ql/src/test/results/clientpositive/insert_acid_dynamic_partition.q.out b/ql/src/test/results/clientpositive/insert_acid_dynamic_partition.q.out
new file mode 100644
index 0000000000..07eedf3a36
--- /dev/null
+++ b/ql/src/test/results/clientpositive/insert_acid_dynamic_partition.q.out
@@ -0,0 +1,48 @@
+PREHOOK: query: create table acid_dynamic(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@acid_dynamic
+POSTHOOK: query: create table acid_dynamic(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@acid_dynamic
+PREHOOK: query: insert into table acid_dynamic partition (ds) select cint, cast(cstring1 as varchar(128)), cstring2 from alltypesorc where cint is not null and cint < 0 order by cint limit 5
+PREHOOK: type: QUERY
+PREHOOK: Input: default@alltypesorc
+PREHOOK: Output: default@acid_dynamic
+POSTHOOK: query: insert into table acid_dynamic partition (ds) select cint, cast(cstring1 as varchar(128)), cstring2 from alltypesorc where cint is not null and cint < 0 order by cint limit 5
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@alltypesorc
+POSTHOOK: Output: default@acid_dynamic@ds=4KWs6gw7lv2WYd66P
+POSTHOOK: Output: default@acid_dynamic@ds=4hA4KQj2vD3fI6gX82220d
+POSTHOOK: Output: default@acid_dynamic@ds=KbaDXiN85adbHRx58v
+POSTHOOK: Output: default@acid_dynamic@ds=P76636jJ6qM17d7DIy
+POSTHOOK: Lineage: acid_dynamic PARTITION(ds=4KWs6gw7lv2WYd66P).a SIMPLE [(alltypesorc)alltypesorc.FieldSchema(name:cint, type:int, comment:null), ]
+POSTHOOK: Lineage: acid_dynamic PARTITION(ds=4KWs6gw7lv2WYd66P).b EXPRESSION [(alltypesorc)alltypesorc.FieldSchema(name:cstring1, type:string, comment:null), ]
+POSTHOOK: Lineage: acid_dynamic PARTITION(ds=4hA4KQj2vD3fI6gX82220d).a SIMPLE [(alltypesorc)alltypesorc.FieldSchema(name:cint, type:int, comment:null), ]
+POSTHOOK: Lineage: acid_dynamic PARTITION(ds=4hA4KQj2vD3fI6gX82220d).b EXPRESSION [(alltypesorc)alltypesorc.FieldSchema(name:cstring1, type:string, comment:null), ]
+POSTHOOK: Lineage: acid_dynamic PARTITION(ds=KbaDXiN85adbHRx58v).a SIMPLE [(alltypesorc)alltypesorc.FieldSchema(name:cint, type:int, comment:null), ]
+POSTHOOK: Lineage: acid_dynamic PARTITION(ds=KbaDXiN85adbHRx58v).b EXPRESSION [(alltypesorc)alltypesorc.FieldSchema(name:cstring1, type:string, comment:null), ]
+POSTHOOK: Lineage: acid_dynamic PARTITION(ds=P76636jJ6qM17d7DIy).a SIMPLE [(alltypesorc)alltypesorc.FieldSchema(name:cint, type:int, comment:null), ]
+POSTHOOK: Lineage: acid_dynamic PARTITION(ds=P76636jJ6qM17d7DIy).b EXPRESSION [(alltypesorc)alltypesorc.FieldSchema(name:cstring1, type:string, comment:null), ]
+PREHOOK: query: select * from acid_dynamic order by a,b
+PREHOOK: type: QUERY
+PREHOOK: Input: default@acid_dynamic
+PREHOOK: Input: default@acid_dynamic@ds=4KWs6gw7lv2WYd66P
+PREHOOK: Input: default@acid_dynamic@ds=4hA4KQj2vD3fI6gX82220d
+PREHOOK: Input: default@acid_dynamic@ds=KbaDXiN85adbHRx58v
+PREHOOK: Input: default@acid_dynamic@ds=P76636jJ6qM17d7DIy
+#### A masked pattern was here ####
+POSTHOOK: query: select * from acid_dynamic order by a,b
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@acid_dynamic
+POSTHOOK: Input: default@acid_dynamic@ds=4KWs6gw7lv2WYd66P
+POSTHOOK: Input: default@acid_dynamic@ds=4hA4KQj2vD3fI6gX82220d
+POSTHOOK: Input: default@acid_dynamic@ds=KbaDXiN85adbHRx58v
+POSTHOOK: Input: default@acid_dynamic@ds=P76636jJ6qM17d7DIy
+#### A masked pattern was here ####
+-1073279343	oj1YrV5Wa	P76636jJ6qM17d7DIy
+-1073051226	A34p7oRr2WvUJNf	4hA4KQj2vD3fI6gX82220d
+-1072910839	0iqrc5	KbaDXiN85adbHRx58v
+-1072081801	dPkN74F7	4KWs6gw7lv2WYd66P
+-1072076362	2uLyD28144vklju213J1mr	4KWs6gw7lv2WYd66P
diff --git a/ql/src/test/results/clientpositive/insert_acid_not_bucketed.q.out b/ql/src/test/results/clientpositive/insert_acid_not_bucketed.q.out
new file mode 100644
index 0000000000..985ae402fc
--- /dev/null
+++ b/ql/src/test/results/clientpositive/insert_acid_not_bucketed.q.out
@@ -0,0 +1,36 @@
+PREHOOK: query: create table acid_notbucketed(a int, b varchar(128)) stored as orc
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@acid_notbucketed
+POSTHOOK: query: create table acid_notbucketed(a int, b varchar(128)) stored as orc
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@acid_notbucketed
+PREHOOK: query: insert into table acid_notbucketed select cint, cast(cstring1 as varchar(128)) from alltypesorc where cint is not null order by cint limit 10
+PREHOOK: type: QUERY
+PREHOOK: Input: default@alltypesorc
+PREHOOK: Output: default@acid_notbucketed
+POSTHOOK: query: insert into table acid_notbucketed select cint, cast(cstring1 as varchar(128)) from alltypesorc where cint is not null order by cint limit 10
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@alltypesorc
+POSTHOOK: Output: default@acid_notbucketed
+POSTHOOK: Lineage: acid_notbucketed.a SIMPLE [(alltypesorc)alltypesorc.FieldSchema(name:cint, type:int, comment:null), ]
+POSTHOOK: Lineage: acid_notbucketed.b EXPRESSION [(alltypesorc)alltypesorc.FieldSchema(name:cstring1, type:string, comment:null), ]
+PREHOOK: query: select * from acid_notbucketed
+PREHOOK: type: QUERY
+PREHOOK: Input: default@acid_notbucketed
+#### A masked pattern was here ####
+POSTHOOK: query: select * from acid_notbucketed
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@acid_notbucketed
+#### A masked pattern was here ####
+-1073279343	oj1YrV5Wa
+-1073051226	A34p7oRr2WvUJNf
+-1072910839	0iqrc5
+-1072081801	dPkN74F7
+-1072076362	2uLyD28144vklju213J1mr
+-1071480828	aw724t8c5558x2xneC624
+-1071363017	Anj0oF
+-1070883071	0ruyd6Y50JpdGRf6HqD
+-1070551679	iUR3Q
+-1069736047	k17Am8uPHWk02cEf1jet
diff --git a/ql/src/test/results/clientpositive/insert_orig_table.q.out b/ql/src/test/results/clientpositive/insert_orig_table.q.out
index 97a284bda8..5eea74da88 100644
--- a/ql/src/test/results/clientpositive/insert_orig_table.q.out
+++ b/ql/src/test/results/clientpositive/insert_orig_table.q.out
@@ -10,7 +10,7 @@ PREHOOK: query: create table acid_iot(
     ctimestamp1 TIMESTAMP,
     ctimestamp2 TIMESTAMP,
     cboolean1 BOOLEAN,
-    cboolean2 BOOLEAN) clustered by (cint) into 1 buckets stored as orc
+    cboolean2 BOOLEAN) clustered by (cint) into 1 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@acid_iot
@@ -26,7 +26,7 @@ POSTHOOK: query: create table acid_iot(
     ctimestamp1 TIMESTAMP,
     ctimestamp2 TIMESTAMP,
     cboolean1 BOOLEAN,
-    cboolean2 BOOLEAN) clustered by (cint) into 1 buckets stored as orc
+    cboolean2 BOOLEAN) clustered by (cint) into 1 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@acid_iot
diff --git a/ql/src/test/results/clientpositive/insert_update_delete.q.out b/ql/src/test/results/clientpositive/insert_update_delete.q.out
index e9f9984caf..9a3cf4b5c2 100644
--- a/ql/src/test/results/clientpositive/insert_update_delete.q.out
+++ b/ql/src/test/results/clientpositive/insert_update_delete.q.out
@@ -1,8 +1,8 @@
-PREHOOK: query: create table acid_iud(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc
+PREHOOK: query: create table acid_iud(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@acid_iud
-POSTHOOK: query: create table acid_iud(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc
+POSTHOOK: query: create table acid_iud(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@acid_iud
diff --git a/ql/src/test/results/clientpositive/insert_values_acid_not_bucketed.q.out b/ql/src/test/results/clientpositive/insert_values_acid_not_bucketed.q.out
new file mode 100644
index 0000000000..4f8ddfac43
--- /dev/null
+++ b/ql/src/test/results/clientpositive/insert_values_acid_not_bucketed.q.out
@@ -0,0 +1,28 @@
+PREHOOK: query: create table acid_notbucketed(a int, b varchar(128)) stored as orc
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@acid_notbucketed
+POSTHOOK: query: create table acid_notbucketed(a int, b varchar(128)) stored as orc
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@acid_notbucketed
+PREHOOK: query: insert into table acid_notbucketed values (1, 'abc'), (2, 'def')
+PREHOOK: type: QUERY
+PREHOOK: Input: default@values__tmp__table__1
+PREHOOK: Output: default@acid_notbucketed
+POSTHOOK: query: insert into table acid_notbucketed values (1, 'abc'), (2, 'def')
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@values__tmp__table__1
+POSTHOOK: Output: default@acid_notbucketed
+POSTHOOK: Lineage: acid_notbucketed.a EXPRESSION [(values__tmp__table__1)values__tmp__table__1.FieldSchema(name:tmp_values_col1, type:string, comment:), ]
+POSTHOOK: Lineage: acid_notbucketed.b EXPRESSION [(values__tmp__table__1)values__tmp__table__1.FieldSchema(name:tmp_values_col2, type:string, comment:), ]
+PREHOOK: query: select * from acid_notbucketed
+PREHOOK: type: QUERY
+PREHOOK: Input: default@acid_notbucketed
+#### A masked pattern was here ####
+POSTHOOK: query: select * from acid_notbucketed
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@acid_notbucketed
+#### A masked pattern was here ####
+1	abc
+2	def
diff --git a/ql/src/test/results/clientpositive/insert_values_dynamic_partitioned.q.out b/ql/src/test/results/clientpositive/insert_values_dynamic_partitioned.q.out
index daea0594e4..773feb47e1 100644
--- a/ql/src/test/results/clientpositive/insert_values_dynamic_partitioned.q.out
+++ b/ql/src/test/results/clientpositive/insert_values_dynamic_partitioned.q.out
@@ -1,12 +1,12 @@
 PREHOOK: query: create table ivdp(i int,
                  de decimal(5,2),
-                 vc varchar(128)) partitioned by (ds string) clustered by (i) into 2 buckets stored as orc
+                 vc varchar(128)) partitioned by (ds string) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@ivdp
 POSTHOOK: query: create table ivdp(i int,
                  de decimal(5,2),
-                 vc varchar(128)) partitioned by (ds string) clustered by (i) into 2 buckets stored as orc
+                 vc varchar(128)) partitioned by (ds string) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@ivdp
diff --git a/ql/src/test/results/clientpositive/insert_values_non_partitioned.q.out b/ql/src/test/results/clientpositive/insert_values_non_partitioned.q.out
index ff041b8c56..5b1c3cc8ae 100644
--- a/ql/src/test/results/clientpositive/insert_values_non_partitioned.q.out
+++ b/ql/src/test/results/clientpositive/insert_values_non_partitioned.q.out
@@ -10,7 +10,7 @@ PREHOOK: query: create table acid_ivnp(ti tinyint,
                  b boolean,
                  s string,
                  vc varchar(128),
-                 ch char(12)) clustered by (i) into 2 buckets stored as orc
+                 ch char(12)) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@acid_ivnp
@@ -26,7 +26,7 @@ POSTHOOK: query: create table acid_ivnp(ti tinyint,
                  b boolean,
                  s string,
                  vc varchar(128),
-                 ch char(12)) clustered by (i) into 2 buckets stored as orc
+                 ch char(12)) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@acid_ivnp
diff --git a/ql/src/test/results/clientpositive/insert_values_orig_table.q.out b/ql/src/test/results/clientpositive/insert_values_orig_table.q.out
index 69220ec8e8..684cd1b3df 100644
--- a/ql/src/test/results/clientpositive/insert_values_orig_table.q.out
+++ b/ql/src/test/results/clientpositive/insert_values_orig_table.q.out
@@ -10,7 +10,7 @@ PREHOOK: query: create table acid_ivot(
     ctimestamp1 TIMESTAMP,
     ctimestamp2 TIMESTAMP,
     cboolean1 BOOLEAN,
-    cboolean2 BOOLEAN) clustered by (cint) into 1 buckets stored as orc
+    cboolean2 BOOLEAN) clustered by (cint) into 1 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@acid_ivot
@@ -26,7 +26,7 @@ POSTHOOK: query: create table acid_ivot(
     ctimestamp1 TIMESTAMP,
     ctimestamp2 TIMESTAMP,
     cboolean1 BOOLEAN,
-    cboolean2 BOOLEAN) clustered by (cint) into 1 buckets stored as orc
+    cboolean2 BOOLEAN) clustered by (cint) into 1 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@acid_ivot
diff --git a/ql/src/test/results/clientpositive/insert_values_partitioned.q.out b/ql/src/test/results/clientpositive/insert_values_partitioned.q.out
index 9fb89ffc7e..6681992022 100644
--- a/ql/src/test/results/clientpositive/insert_values_partitioned.q.out
+++ b/ql/src/test/results/clientpositive/insert_values_partitioned.q.out
@@ -9,7 +9,7 @@ PREHOOK: query: create table acid_ivp(ti tinyint,
                  dt date,
                  s string,
                  vc varchar(128),
-                 ch char(12)) partitioned by (ds string) clustered by (i) into 2 buckets stored as orc
+                 ch char(12)) partitioned by (ds string) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@acid_ivp
@@ -24,7 +24,7 @@ POSTHOOK: query: create table acid_ivp(ti tinyint,
                  dt date,
                  s string,
                  vc varchar(128),
-                 ch char(12)) partitioned by (ds string) clustered by (i) into 2 buckets stored as orc
+                 ch char(12)) partitioned by (ds string) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@acid_ivp
diff --git a/ql/src/test/results/clientpositive/insert_values_tmp_table.q.out b/ql/src/test/results/clientpositive/insert_values_tmp_table.q.out
index a424c18c37..170b4a74fb 100644
--- a/ql/src/test/results/clientpositive/insert_values_tmp_table.q.out
+++ b/ql/src/test/results/clientpositive/insert_values_tmp_table.q.out
@@ -1,8 +1,8 @@
-PREHOOK: query: create temporary table acid_ivtt(i int, de decimal(5,2), vc varchar(128)) clustered by (vc) into 2 buckets stored as orc
+PREHOOK: query: create temporary table acid_ivtt(i int, de decimal(5,2), vc varchar(128)) clustered by (vc) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@acid_ivtt
-POSTHOOK: query: create temporary table acid_ivtt(i int, de decimal(5,2), vc varchar(128)) clustered by (vc) into 2 buckets stored as orc
+POSTHOOK: query: create temporary table acid_ivtt(i int, de decimal(5,2), vc varchar(128)) clustered by (vc) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@acid_ivtt
diff --git a/ql/src/test/results/clientpositive/tez/delete_all_non_partitioned.q.out b/ql/src/test/results/clientpositive/tez/delete_all_non_partitioned.q.out
index 0d428cab98..38ce075ff8 100644
--- a/ql/src/test/results/clientpositive/tez/delete_all_non_partitioned.q.out
+++ b/ql/src/test/results/clientpositive/tez/delete_all_non_partitioned.q.out
@@ -1,8 +1,8 @@
-PREHOOK: query: create table acid_danp(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc
+PREHOOK: query: create table acid_danp(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@acid_danp
-POSTHOOK: query: create table acid_danp(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc
+POSTHOOK: query: create table acid_danp(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@acid_danp
diff --git a/ql/src/test/results/clientpositive/tez/delete_all_partitioned.q.out b/ql/src/test/results/clientpositive/tez/delete_all_partitioned.q.out
index 4486323105..90f8753687 100644
--- a/ql/src/test/results/clientpositive/tez/delete_all_partitioned.q.out
+++ b/ql/src/test/results/clientpositive/tez/delete_all_partitioned.q.out
@@ -1,8 +1,8 @@
-PREHOOK: query: create table acid_dap(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc
+PREHOOK: query: create table acid_dap(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@acid_dap
-POSTHOOK: query: create table acid_dap(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc
+POSTHOOK: query: create table acid_dap(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@acid_dap
diff --git a/ql/src/test/results/clientpositive/tez/delete_tmp_table.q.out b/ql/src/test/results/clientpositive/tez/delete_tmp_table.q.out
index ca568b38ff..4dc73448f0 100644
--- a/ql/src/test/results/clientpositive/tez/delete_tmp_table.q.out
+++ b/ql/src/test/results/clientpositive/tez/delete_tmp_table.q.out
@@ -1,8 +1,8 @@
-PREHOOK: query: create temporary table acid_dtt(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc
+PREHOOK: query: create temporary table acid_dtt(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@acid_dtt
-POSTHOOK: query: create temporary table acid_dtt(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc
+POSTHOOK: query: create temporary table acid_dtt(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@acid_dtt
diff --git a/ql/src/test/results/clientpositive/tez/delete_where_no_match.q.out b/ql/src/test/results/clientpositive/tez/delete_where_no_match.q.out
index 1450ee6da4..cb2adc60ba 100644
--- a/ql/src/test/results/clientpositive/tez/delete_where_no_match.q.out
+++ b/ql/src/test/results/clientpositive/tez/delete_where_no_match.q.out
@@ -1,8 +1,8 @@
-PREHOOK: query: create table acid_dwnm(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc
+PREHOOK: query: create table acid_dwnm(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@acid_dwnm
-POSTHOOK: query: create table acid_dwnm(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc
+POSTHOOK: query: create table acid_dwnm(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@acid_dwnm
diff --git a/ql/src/test/results/clientpositive/tez/delete_where_non_partitioned.q.out b/ql/src/test/results/clientpositive/tez/delete_where_non_partitioned.q.out
index d465e8eed0..1bdb1e630c 100644
--- a/ql/src/test/results/clientpositive/tez/delete_where_non_partitioned.q.out
+++ b/ql/src/test/results/clientpositive/tez/delete_where_non_partitioned.q.out
@@ -1,8 +1,8 @@
-PREHOOK: query: create table acid_dwnp(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc
+PREHOOK: query: create table acid_dwnp(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@acid_dwnp
-POSTHOOK: query: create table acid_dwnp(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc
+POSTHOOK: query: create table acid_dwnp(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@acid_dwnp
diff --git a/ql/src/test/results/clientpositive/tez/delete_where_partitioned.q.out b/ql/src/test/results/clientpositive/tez/delete_where_partitioned.q.out
index 9f8581b4f8..fc2e369876 100644
--- a/ql/src/test/results/clientpositive/tez/delete_where_partitioned.q.out
+++ b/ql/src/test/results/clientpositive/tez/delete_where_partitioned.q.out
@@ -1,8 +1,8 @@
-PREHOOK: query: create table acid_dwp(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc
+PREHOOK: query: create table acid_dwp(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@acid_dwp
-POSTHOOK: query: create table acid_dwp(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc
+POSTHOOK: query: create table acid_dwp(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@acid_dwp
diff --git a/ql/src/test/results/clientpositive/tez/delete_whole_partition.q.out b/ql/src/test/results/clientpositive/tez/delete_whole_partition.q.out
index a2408ebe43..043daf4d2b 100644
--- a/ql/src/test/results/clientpositive/tez/delete_whole_partition.q.out
+++ b/ql/src/test/results/clientpositive/tez/delete_whole_partition.q.out
@@ -1,8 +1,8 @@
-PREHOOK: query: create table acid_dwhp(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc
+PREHOOK: query: create table acid_dwhp(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@acid_dwhp
-POSTHOOK: query: create table acid_dwhp(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc
+POSTHOOK: query: create table acid_dwhp(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@acid_dwhp
diff --git a/ql/src/test/results/clientpositive/tez/insert_acid_dynamic_partition.q.out b/ql/src/test/results/clientpositive/tez/insert_acid_dynamic_partition.q.out
new file mode 100644
index 0000000000..07eedf3a36
--- /dev/null
+++ b/ql/src/test/results/clientpositive/tez/insert_acid_dynamic_partition.q.out
@@ -0,0 +1,48 @@
+PREHOOK: query: create table acid_dynamic(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@acid_dynamic
+POSTHOOK: query: create table acid_dynamic(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@acid_dynamic
+PREHOOK: query: insert into table acid_dynamic partition (ds) select cint, cast(cstring1 as varchar(128)), cstring2 from alltypesorc where cint is not null and cint < 0 order by cint limit 5
+PREHOOK: type: QUERY
+PREHOOK: Input: default@alltypesorc
+PREHOOK: Output: default@acid_dynamic
+POSTHOOK: query: insert into table acid_dynamic partition (ds) select cint, cast(cstring1 as varchar(128)), cstring2 from alltypesorc where cint is not null and cint < 0 order by cint limit 5
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@alltypesorc
+POSTHOOK: Output: default@acid_dynamic@ds=4KWs6gw7lv2WYd66P
+POSTHOOK: Output: default@acid_dynamic@ds=4hA4KQj2vD3fI6gX82220d
+POSTHOOK: Output: default@acid_dynamic@ds=KbaDXiN85adbHRx58v
+POSTHOOK: Output: default@acid_dynamic@ds=P76636jJ6qM17d7DIy
+POSTHOOK: Lineage: acid_dynamic PARTITION(ds=4KWs6gw7lv2WYd66P).a SIMPLE [(alltypesorc)alltypesorc.FieldSchema(name:cint, type:int, comment:null), ]
+POSTHOOK: Lineage: acid_dynamic PARTITION(ds=4KWs6gw7lv2WYd66P).b EXPRESSION [(alltypesorc)alltypesorc.FieldSchema(name:cstring1, type:string, comment:null), ]
+POSTHOOK: Lineage: acid_dynamic PARTITION(ds=4hA4KQj2vD3fI6gX82220d).a SIMPLE [(alltypesorc)alltypesorc.FieldSchema(name:cint, type:int, comment:null), ]
+POSTHOOK: Lineage: acid_dynamic PARTITION(ds=4hA4KQj2vD3fI6gX82220d).b EXPRESSION [(alltypesorc)alltypesorc.FieldSchema(name:cstring1, type:string, comment:null), ]
+POSTHOOK: Lineage: acid_dynamic PARTITION(ds=KbaDXiN85adbHRx58v).a SIMPLE [(alltypesorc)alltypesorc.FieldSchema(name:cint, type:int, comment:null), ]
+POSTHOOK: Lineage: acid_dynamic PARTITION(ds=KbaDXiN85adbHRx58v).b EXPRESSION [(alltypesorc)alltypesorc.FieldSchema(name:cstring1, type:string, comment:null), ]
+POSTHOOK: Lineage: acid_dynamic PARTITION(ds=P76636jJ6qM17d7DIy).a SIMPLE [(alltypesorc)alltypesorc.FieldSchema(name:cint, type:int, comment:null), ]
+POSTHOOK: Lineage: acid_dynamic PARTITION(ds=P76636jJ6qM17d7DIy).b EXPRESSION [(alltypesorc)alltypesorc.FieldSchema(name:cstring1, type:string, comment:null), ]
+PREHOOK: query: select * from acid_dynamic order by a,b
+PREHOOK: type: QUERY
+PREHOOK: Input: default@acid_dynamic
+PREHOOK: Input: default@acid_dynamic@ds=4KWs6gw7lv2WYd66P
+PREHOOK: Input: default@acid_dynamic@ds=4hA4KQj2vD3fI6gX82220d
+PREHOOK: Input: default@acid_dynamic@ds=KbaDXiN85adbHRx58v
+PREHOOK: Input: default@acid_dynamic@ds=P76636jJ6qM17d7DIy
+#### A masked pattern was here ####
+POSTHOOK: query: select * from acid_dynamic order by a,b
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@acid_dynamic
+POSTHOOK: Input: default@acid_dynamic@ds=4KWs6gw7lv2WYd66P
+POSTHOOK: Input: default@acid_dynamic@ds=4hA4KQj2vD3fI6gX82220d
+POSTHOOK: Input: default@acid_dynamic@ds=KbaDXiN85adbHRx58v
+POSTHOOK: Input: default@acid_dynamic@ds=P76636jJ6qM17d7DIy
+#### A masked pattern was here ####
+-1073279343	oj1YrV5Wa	P76636jJ6qM17d7DIy
+-1073051226	A34p7oRr2WvUJNf	4hA4KQj2vD3fI6gX82220d
+-1072910839	0iqrc5	KbaDXiN85adbHRx58v
+-1072081801	dPkN74F7	4KWs6gw7lv2WYd66P
+-1072076362	2uLyD28144vklju213J1mr	4KWs6gw7lv2WYd66P
diff --git a/ql/src/test/results/clientpositive/tez/insert_acid_not_bucketed.q.out b/ql/src/test/results/clientpositive/tez/insert_acid_not_bucketed.q.out
new file mode 100644
index 0000000000..985ae402fc
--- /dev/null
+++ b/ql/src/test/results/clientpositive/tez/insert_acid_not_bucketed.q.out
@@ -0,0 +1,36 @@
+PREHOOK: query: create table acid_notbucketed(a int, b varchar(128)) stored as orc
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@acid_notbucketed
+POSTHOOK: query: create table acid_notbucketed(a int, b varchar(128)) stored as orc
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@acid_notbucketed
+PREHOOK: query: insert into table acid_notbucketed select cint, cast(cstring1 as varchar(128)) from alltypesorc where cint is not null order by cint limit 10
+PREHOOK: type: QUERY
+PREHOOK: Input: default@alltypesorc
+PREHOOK: Output: default@acid_notbucketed
+POSTHOOK: query: insert into table acid_notbucketed select cint, cast(cstring1 as varchar(128)) from alltypesorc where cint is not null order by cint limit 10
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@alltypesorc
+POSTHOOK: Output: default@acid_notbucketed
+POSTHOOK: Lineage: acid_notbucketed.a SIMPLE [(alltypesorc)alltypesorc.FieldSchema(name:cint, type:int, comment:null), ]
+POSTHOOK: Lineage: acid_notbucketed.b EXPRESSION [(alltypesorc)alltypesorc.FieldSchema(name:cstring1, type:string, comment:null), ]
+PREHOOK: query: select * from acid_notbucketed
+PREHOOK: type: QUERY
+PREHOOK: Input: default@acid_notbucketed
+#### A masked pattern was here ####
+POSTHOOK: query: select * from acid_notbucketed
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@acid_notbucketed
+#### A masked pattern was here ####
+-1073279343	oj1YrV5Wa
+-1073051226	A34p7oRr2WvUJNf
+-1072910839	0iqrc5
+-1072081801	dPkN74F7
+-1072076362	2uLyD28144vklju213J1mr
+-1071480828	aw724t8c5558x2xneC624
+-1071363017	Anj0oF
+-1070883071	0ruyd6Y50JpdGRf6HqD
+-1070551679	iUR3Q
+-1069736047	k17Am8uPHWk02cEf1jet
diff --git a/ql/src/test/results/clientpositive/tez/insert_orig_table.q.out b/ql/src/test/results/clientpositive/tez/insert_orig_table.q.out
index 97a284bda8..5eea74da88 100644
--- a/ql/src/test/results/clientpositive/tez/insert_orig_table.q.out
+++ b/ql/src/test/results/clientpositive/tez/insert_orig_table.q.out
@@ -10,7 +10,7 @@ PREHOOK: query: create table acid_iot(
     ctimestamp1 TIMESTAMP,
     ctimestamp2 TIMESTAMP,
     cboolean1 BOOLEAN,
-    cboolean2 BOOLEAN) clustered by (cint) into 1 buckets stored as orc
+    cboolean2 BOOLEAN) clustered by (cint) into 1 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@acid_iot
@@ -26,7 +26,7 @@ POSTHOOK: query: create table acid_iot(
     ctimestamp1 TIMESTAMP,
     ctimestamp2 TIMESTAMP,
     cboolean1 BOOLEAN,
-    cboolean2 BOOLEAN) clustered by (cint) into 1 buckets stored as orc
+    cboolean2 BOOLEAN) clustered by (cint) into 1 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@acid_iot
diff --git a/ql/src/test/results/clientpositive/tez/insert_update_delete.q.out b/ql/src/test/results/clientpositive/tez/insert_update_delete.q.out
index e9f9984caf..9a3cf4b5c2 100644
--- a/ql/src/test/results/clientpositive/tez/insert_update_delete.q.out
+++ b/ql/src/test/results/clientpositive/tez/insert_update_delete.q.out
@@ -1,8 +1,8 @@
-PREHOOK: query: create table acid_iud(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc
+PREHOOK: query: create table acid_iud(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@acid_iud
-POSTHOOK: query: create table acid_iud(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc
+POSTHOOK: query: create table acid_iud(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@acid_iud
diff --git a/ql/src/test/results/clientpositive/tez/insert_values_acid_not_bucketed.q.out b/ql/src/test/results/clientpositive/tez/insert_values_acid_not_bucketed.q.out
new file mode 100644
index 0000000000..4f8ddfac43
--- /dev/null
+++ b/ql/src/test/results/clientpositive/tez/insert_values_acid_not_bucketed.q.out
@@ -0,0 +1,28 @@
+PREHOOK: query: create table acid_notbucketed(a int, b varchar(128)) stored as orc
+PREHOOK: type: CREATETABLE
+PREHOOK: Output: database:default
+PREHOOK: Output: default@acid_notbucketed
+POSTHOOK: query: create table acid_notbucketed(a int, b varchar(128)) stored as orc
+POSTHOOK: type: CREATETABLE
+POSTHOOK: Output: database:default
+POSTHOOK: Output: default@acid_notbucketed
+PREHOOK: query: insert into table acid_notbucketed values (1, 'abc'), (2, 'def')
+PREHOOK: type: QUERY
+PREHOOK: Input: default@values__tmp__table__1
+PREHOOK: Output: default@acid_notbucketed
+POSTHOOK: query: insert into table acid_notbucketed values (1, 'abc'), (2, 'def')
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@values__tmp__table__1
+POSTHOOK: Output: default@acid_notbucketed
+POSTHOOK: Lineage: acid_notbucketed.a EXPRESSION [(values__tmp__table__1)values__tmp__table__1.FieldSchema(name:tmp_values_col1, type:string, comment:), ]
+POSTHOOK: Lineage: acid_notbucketed.b EXPRESSION [(values__tmp__table__1)values__tmp__table__1.FieldSchema(name:tmp_values_col2, type:string, comment:), ]
+PREHOOK: query: select * from acid_notbucketed
+PREHOOK: type: QUERY
+PREHOOK: Input: default@acid_notbucketed
+#### A masked pattern was here ####
+POSTHOOK: query: select * from acid_notbucketed
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@acid_notbucketed
+#### A masked pattern was here ####
+1	abc
+2	def
diff --git a/ql/src/test/results/clientpositive/tez/insert_values_dynamic_partitioned.q.out b/ql/src/test/results/clientpositive/tez/insert_values_dynamic_partitioned.q.out
index daea0594e4..773feb47e1 100644
--- a/ql/src/test/results/clientpositive/tez/insert_values_dynamic_partitioned.q.out
+++ b/ql/src/test/results/clientpositive/tez/insert_values_dynamic_partitioned.q.out
@@ -1,12 +1,12 @@
 PREHOOK: query: create table ivdp(i int,
                  de decimal(5,2),
-                 vc varchar(128)) partitioned by (ds string) clustered by (i) into 2 buckets stored as orc
+                 vc varchar(128)) partitioned by (ds string) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@ivdp
 POSTHOOK: query: create table ivdp(i int,
                  de decimal(5,2),
-                 vc varchar(128)) partitioned by (ds string) clustered by (i) into 2 buckets stored as orc
+                 vc varchar(128)) partitioned by (ds string) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@ivdp
diff --git a/ql/src/test/results/clientpositive/tez/insert_values_non_partitioned.q.out b/ql/src/test/results/clientpositive/tez/insert_values_non_partitioned.q.out
index ff041b8c56..5b1c3cc8ae 100644
--- a/ql/src/test/results/clientpositive/tez/insert_values_non_partitioned.q.out
+++ b/ql/src/test/results/clientpositive/tez/insert_values_non_partitioned.q.out
@@ -10,7 +10,7 @@ PREHOOK: query: create table acid_ivnp(ti tinyint,
                  b boolean,
                  s string,
                  vc varchar(128),
-                 ch char(12)) clustered by (i) into 2 buckets stored as orc
+                 ch char(12)) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@acid_ivnp
@@ -26,7 +26,7 @@ POSTHOOK: query: create table acid_ivnp(ti tinyint,
                  b boolean,
                  s string,
                  vc varchar(128),
-                 ch char(12)) clustered by (i) into 2 buckets stored as orc
+                 ch char(12)) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@acid_ivnp
diff --git a/ql/src/test/results/clientpositive/tez/insert_values_orig_table.q.out b/ql/src/test/results/clientpositive/tez/insert_values_orig_table.q.out
index 69220ec8e8..684cd1b3df 100644
--- a/ql/src/test/results/clientpositive/tez/insert_values_orig_table.q.out
+++ b/ql/src/test/results/clientpositive/tez/insert_values_orig_table.q.out
@@ -10,7 +10,7 @@ PREHOOK: query: create table acid_ivot(
     ctimestamp1 TIMESTAMP,
     ctimestamp2 TIMESTAMP,
     cboolean1 BOOLEAN,
-    cboolean2 BOOLEAN) clustered by (cint) into 1 buckets stored as orc
+    cboolean2 BOOLEAN) clustered by (cint) into 1 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@acid_ivot
@@ -26,7 +26,7 @@ POSTHOOK: query: create table acid_ivot(
     ctimestamp1 TIMESTAMP,
     ctimestamp2 TIMESTAMP,
     cboolean1 BOOLEAN,
-    cboolean2 BOOLEAN) clustered by (cint) into 1 buckets stored as orc
+    cboolean2 BOOLEAN) clustered by (cint) into 1 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@acid_ivot
diff --git a/ql/src/test/results/clientpositive/tez/insert_values_partitioned.q.out b/ql/src/test/results/clientpositive/tez/insert_values_partitioned.q.out
index 9fb89ffc7e..6681992022 100644
--- a/ql/src/test/results/clientpositive/tez/insert_values_partitioned.q.out
+++ b/ql/src/test/results/clientpositive/tez/insert_values_partitioned.q.out
@@ -9,7 +9,7 @@ PREHOOK: query: create table acid_ivp(ti tinyint,
                  dt date,
                  s string,
                  vc varchar(128),
-                 ch char(12)) partitioned by (ds string) clustered by (i) into 2 buckets stored as orc
+                 ch char(12)) partitioned by (ds string) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@acid_ivp
@@ -24,7 +24,7 @@ POSTHOOK: query: create table acid_ivp(ti tinyint,
                  dt date,
                  s string,
                  vc varchar(128),
-                 ch char(12)) partitioned by (ds string) clustered by (i) into 2 buckets stored as orc
+                 ch char(12)) partitioned by (ds string) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@acid_ivp
diff --git a/ql/src/test/results/clientpositive/tez/insert_values_tmp_table.q.out b/ql/src/test/results/clientpositive/tez/insert_values_tmp_table.q.out
index a424c18c37..170b4a74fb 100644
--- a/ql/src/test/results/clientpositive/tez/insert_values_tmp_table.q.out
+++ b/ql/src/test/results/clientpositive/tez/insert_values_tmp_table.q.out
@@ -1,8 +1,8 @@
-PREHOOK: query: create temporary table acid_ivtt(i int, de decimal(5,2), vc varchar(128)) clustered by (vc) into 2 buckets stored as orc
+PREHOOK: query: create temporary table acid_ivtt(i int, de decimal(5,2), vc varchar(128)) clustered by (vc) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@acid_ivtt
-POSTHOOK: query: create temporary table acid_ivtt(i int, de decimal(5,2), vc varchar(128)) clustered by (vc) into 2 buckets stored as orc
+POSTHOOK: query: create temporary table acid_ivtt(i int, de decimal(5,2), vc varchar(128)) clustered by (vc) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@acid_ivtt
diff --git a/ql/src/test/results/clientpositive/tez/update_after_multiple_inserts.q.out b/ql/src/test/results/clientpositive/tez/update_after_multiple_inserts.q.out
index cb8e319b4a..a2ad3afe1e 100644
--- a/ql/src/test/results/clientpositive/tez/update_after_multiple_inserts.q.out
+++ b/ql/src/test/results/clientpositive/tez/update_after_multiple_inserts.q.out
@@ -1,12 +1,12 @@
 PREHOOK: query: create table acid_uami(i int,
                  de decimal(5,2),
-                 vc varchar(128)) clustered by (i) into 2 buckets stored as orc
+                 vc varchar(128)) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@acid_uami
 POSTHOOK: query: create table acid_uami(i int,
                  de decimal(5,2),
-                 vc varchar(128)) clustered by (i) into 2 buckets stored as orc
+                 vc varchar(128)) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@acid_uami
diff --git a/ql/src/test/results/clientpositive/tez/update_all_non_partitioned.q.out b/ql/src/test/results/clientpositive/tez/update_all_non_partitioned.q.out
index fde6d8d9b4..39dd71bd6f 100644
--- a/ql/src/test/results/clientpositive/tez/update_all_non_partitioned.q.out
+++ b/ql/src/test/results/clientpositive/tez/update_all_non_partitioned.q.out
@@ -1,8 +1,8 @@
-PREHOOK: query: create table acid_uanp(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc
+PREHOOK: query: create table acid_uanp(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@acid_uanp
-POSTHOOK: query: create table acid_uanp(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc
+POSTHOOK: query: create table acid_uanp(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@acid_uanp
diff --git a/ql/src/test/results/clientpositive/tez/update_all_partitioned.q.out b/ql/src/test/results/clientpositive/tez/update_all_partitioned.q.out
index 3fae6a90c4..286e2ed527 100644
--- a/ql/src/test/results/clientpositive/tez/update_all_partitioned.q.out
+++ b/ql/src/test/results/clientpositive/tez/update_all_partitioned.q.out
@@ -1,8 +1,8 @@
-PREHOOK: query: create table acid_uap(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc
+PREHOOK: query: create table acid_uap(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@acid_uap
-POSTHOOK: query: create table acid_uap(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc
+POSTHOOK: query: create table acid_uap(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@acid_uap
diff --git a/ql/src/test/results/clientpositive/tez/update_all_types.q.out b/ql/src/test/results/clientpositive/tez/update_all_types.q.out
index c09293c50f..f1353d068a 100644
--- a/ql/src/test/results/clientpositive/tez/update_all_types.q.out
+++ b/ql/src/test/results/clientpositive/tez/update_all_types.q.out
@@ -10,7 +10,7 @@ PREHOOK: query: create table acid_uat(ti tinyint,
                  s string,
                  vc varchar(128),
                  ch char(36),
-                 b boolean) clustered by (i) into 2 buckets stored as orc
+                 b boolean) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@acid_uat
@@ -26,7 +26,7 @@ POSTHOOK: query: create table acid_uat(ti tinyint,
                  s string,
                  vc varchar(128),
                  ch char(36),
-                 b boolean) clustered by (i) into 2 buckets stored as orc
+                 b boolean) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@acid_uat
diff --git a/ql/src/test/results/clientpositive/tez/update_tmp_table.q.out b/ql/src/test/results/clientpositive/tez/update_tmp_table.q.out
index 8180f06613..3c86a0c0d1 100644
--- a/ql/src/test/results/clientpositive/tez/update_tmp_table.q.out
+++ b/ql/src/test/results/clientpositive/tez/update_tmp_table.q.out
@@ -1,8 +1,8 @@
-PREHOOK: query: create table acid_utt(a int, b varchar(128)) clustered by (b) into 2 buckets stored as orc
+PREHOOK: query: create table acid_utt(a int, b varchar(128)) clustered by (b) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@acid_utt
-POSTHOOK: query: create table acid_utt(a int, b varchar(128)) clustered by (b) into 2 buckets stored as orc
+POSTHOOK: query: create table acid_utt(a int, b varchar(128)) clustered by (b) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@acid_utt
diff --git a/ql/src/test/results/clientpositive/tez/update_two_cols.q.out b/ql/src/test/results/clientpositive/tez/update_two_cols.q.out
index 553608fd1d..5132c0ca0a 100644
--- a/ql/src/test/results/clientpositive/tez/update_two_cols.q.out
+++ b/ql/src/test/results/clientpositive/tez/update_two_cols.q.out
@@ -1,8 +1,8 @@
-PREHOOK: query: create table acid_utc(a int, b varchar(128), c float) clustered by (a) into 2 buckets stored as orc
+PREHOOK: query: create table acid_utc(a int, b varchar(128), c float) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@acid_utc
-POSTHOOK: query: create table acid_utc(a int, b varchar(128), c float) clustered by (a) into 2 buckets stored as orc
+POSTHOOK: query: create table acid_utc(a int, b varchar(128), c float) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@acid_utc
diff --git a/ql/src/test/results/clientpositive/tez/update_where_no_match.q.out b/ql/src/test/results/clientpositive/tez/update_where_no_match.q.out
index afef267694..c88899edfe 100644
--- a/ql/src/test/results/clientpositive/tez/update_where_no_match.q.out
+++ b/ql/src/test/results/clientpositive/tez/update_where_no_match.q.out
@@ -1,8 +1,8 @@
-PREHOOK: query: create table acid_wnm(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc
+PREHOOK: query: create table acid_wnm(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@acid_wnm
-POSTHOOK: query: create table acid_wnm(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc
+POSTHOOK: query: create table acid_wnm(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@acid_wnm
diff --git a/ql/src/test/results/clientpositive/tez/update_where_non_partitioned.q.out b/ql/src/test/results/clientpositive/tez/update_where_non_partitioned.q.out
index 5c79379636..9c79235b01 100644
--- a/ql/src/test/results/clientpositive/tez/update_where_non_partitioned.q.out
+++ b/ql/src/test/results/clientpositive/tez/update_where_non_partitioned.q.out
@@ -1,8 +1,8 @@
-PREHOOK: query: create table acid_uwnp(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc
+PREHOOK: query: create table acid_uwnp(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@acid_uwnp
-POSTHOOK: query: create table acid_uwnp(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc
+POSTHOOK: query: create table acid_uwnp(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@acid_uwnp
diff --git a/ql/src/test/results/clientpositive/tez/update_where_partitioned.q.out b/ql/src/test/results/clientpositive/tez/update_where_partitioned.q.out
index b83c52a370..fef0dc08f0 100644
--- a/ql/src/test/results/clientpositive/tez/update_where_partitioned.q.out
+++ b/ql/src/test/results/clientpositive/tez/update_where_partitioned.q.out
@@ -1,8 +1,8 @@
-PREHOOK: query: create table acid_uwp(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc
+PREHOOK: query: create table acid_uwp(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@acid_uwp
-POSTHOOK: query: create table acid_uwp(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc
+POSTHOOK: query: create table acid_uwp(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@acid_uwp
diff --git a/ql/src/test/results/clientpositive/update_after_multiple_inserts.q.out b/ql/src/test/results/clientpositive/update_after_multiple_inserts.q.out
index cb8e319b4a..a2ad3afe1e 100644
--- a/ql/src/test/results/clientpositive/update_after_multiple_inserts.q.out
+++ b/ql/src/test/results/clientpositive/update_after_multiple_inserts.q.out
@@ -1,12 +1,12 @@
 PREHOOK: query: create table acid_uami(i int,
                  de decimal(5,2),
-                 vc varchar(128)) clustered by (i) into 2 buckets stored as orc
+                 vc varchar(128)) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@acid_uami
 POSTHOOK: query: create table acid_uami(i int,
                  de decimal(5,2),
-                 vc varchar(128)) clustered by (i) into 2 buckets stored as orc
+                 vc varchar(128)) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@acid_uami
diff --git a/ql/src/test/results/clientpositive/update_all_non_partitioned.q.out b/ql/src/test/results/clientpositive/update_all_non_partitioned.q.out
index fde6d8d9b4..39dd71bd6f 100644
--- a/ql/src/test/results/clientpositive/update_all_non_partitioned.q.out
+++ b/ql/src/test/results/clientpositive/update_all_non_partitioned.q.out
@@ -1,8 +1,8 @@
-PREHOOK: query: create table acid_uanp(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc
+PREHOOK: query: create table acid_uanp(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@acid_uanp
-POSTHOOK: query: create table acid_uanp(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc
+POSTHOOK: query: create table acid_uanp(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@acid_uanp
diff --git a/ql/src/test/results/clientpositive/update_all_partitioned.q.out b/ql/src/test/results/clientpositive/update_all_partitioned.q.out
index 3fae6a90c4..286e2ed527 100644
--- a/ql/src/test/results/clientpositive/update_all_partitioned.q.out
+++ b/ql/src/test/results/clientpositive/update_all_partitioned.q.out
@@ -1,8 +1,8 @@
-PREHOOK: query: create table acid_uap(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc
+PREHOOK: query: create table acid_uap(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@acid_uap
-POSTHOOK: query: create table acid_uap(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc
+POSTHOOK: query: create table acid_uap(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@acid_uap
diff --git a/ql/src/test/results/clientpositive/update_all_types.q.out b/ql/src/test/results/clientpositive/update_all_types.q.out
index c09293c50f..f1353d068a 100644
--- a/ql/src/test/results/clientpositive/update_all_types.q.out
+++ b/ql/src/test/results/clientpositive/update_all_types.q.out
@@ -10,7 +10,7 @@ PREHOOK: query: create table acid_uat(ti tinyint,
                  s string,
                  vc varchar(128),
                  ch char(36),
-                 b boolean) clustered by (i) into 2 buckets stored as orc
+                 b boolean) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@acid_uat
@@ -26,7 +26,7 @@ POSTHOOK: query: create table acid_uat(ti tinyint,
                  s string,
                  vc varchar(128),
                  ch char(36),
-                 b boolean) clustered by (i) into 2 buckets stored as orc
+                 b boolean) clustered by (i) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@acid_uat
diff --git a/ql/src/test/results/clientpositive/update_tmp_table.q.out b/ql/src/test/results/clientpositive/update_tmp_table.q.out
index 8180f06613..3c86a0c0d1 100644
--- a/ql/src/test/results/clientpositive/update_tmp_table.q.out
+++ b/ql/src/test/results/clientpositive/update_tmp_table.q.out
@@ -1,8 +1,8 @@
-PREHOOK: query: create table acid_utt(a int, b varchar(128)) clustered by (b) into 2 buckets stored as orc
+PREHOOK: query: create table acid_utt(a int, b varchar(128)) clustered by (b) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@acid_utt
-POSTHOOK: query: create table acid_utt(a int, b varchar(128)) clustered by (b) into 2 buckets stored as orc
+POSTHOOK: query: create table acid_utt(a int, b varchar(128)) clustered by (b) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@acid_utt
diff --git a/ql/src/test/results/clientpositive/update_two_cols.q.out b/ql/src/test/results/clientpositive/update_two_cols.q.out
index 553608fd1d..5132c0ca0a 100644
--- a/ql/src/test/results/clientpositive/update_two_cols.q.out
+++ b/ql/src/test/results/clientpositive/update_two_cols.q.out
@@ -1,8 +1,8 @@
-PREHOOK: query: create table acid_utc(a int, b varchar(128), c float) clustered by (a) into 2 buckets stored as orc
+PREHOOK: query: create table acid_utc(a int, b varchar(128), c float) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@acid_utc
-POSTHOOK: query: create table acid_utc(a int, b varchar(128), c float) clustered by (a) into 2 buckets stored as orc
+POSTHOOK: query: create table acid_utc(a int, b varchar(128), c float) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@acid_utc
diff --git a/ql/src/test/results/clientpositive/update_where_no_match.q.out b/ql/src/test/results/clientpositive/update_where_no_match.q.out
index afef267694..c88899edfe 100644
--- a/ql/src/test/results/clientpositive/update_where_no_match.q.out
+++ b/ql/src/test/results/clientpositive/update_where_no_match.q.out
@@ -1,8 +1,8 @@
-PREHOOK: query: create table acid_wnm(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc
+PREHOOK: query: create table acid_wnm(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@acid_wnm
-POSTHOOK: query: create table acid_wnm(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc
+POSTHOOK: query: create table acid_wnm(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@acid_wnm
diff --git a/ql/src/test/results/clientpositive/update_where_non_partitioned.q.out b/ql/src/test/results/clientpositive/update_where_non_partitioned.q.out
index 5c79379636..9c79235b01 100644
--- a/ql/src/test/results/clientpositive/update_where_non_partitioned.q.out
+++ b/ql/src/test/results/clientpositive/update_where_non_partitioned.q.out
@@ -1,8 +1,8 @@
-PREHOOK: query: create table acid_uwnp(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc
+PREHOOK: query: create table acid_uwnp(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@acid_uwnp
-POSTHOOK: query: create table acid_uwnp(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc
+POSTHOOK: query: create table acid_uwnp(a int, b varchar(128)) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@acid_uwnp
diff --git a/ql/src/test/results/clientpositive/update_where_partitioned.q.out b/ql/src/test/results/clientpositive/update_where_partitioned.q.out
index b83c52a370..fef0dc08f0 100644
--- a/ql/src/test/results/clientpositive/update_where_partitioned.q.out
+++ b/ql/src/test/results/clientpositive/update_where_partitioned.q.out
@@ -1,8 +1,8 @@
-PREHOOK: query: create table acid_uwp(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc
+PREHOOK: query: create table acid_uwp(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@acid_uwp
-POSTHOOK: query: create table acid_uwp(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc
+POSTHOOK: query: create table acid_uwp(a int, b varchar(128)) partitioned by (ds string) clustered by (a) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@acid_uwp
