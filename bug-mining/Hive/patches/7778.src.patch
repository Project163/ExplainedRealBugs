diff --git a/ql/src/java/org/apache/hadoop/hive/ql/Executor.java b/ql/src/java/org/apache/hadoop/hive/ql/Executor.java
index 3aba618780..ce47d179ef 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/Executor.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/Executor.java
@@ -274,6 +274,10 @@ private void handleFinished() throws Exception {
     TaskResult result = taskRun.getTaskResult();
 
     int exitVal = result.getExitVal();
+    SessionState.get().getHiveHistory().setTaskProperty(driverContext.getQueryId(), task.getId(),
+        Keys.TASK_RET_CODE, String.valueOf(exitVal));
+    SessionState.get().getHiveHistory().endTask(driverContext.getQueryId(), task);
+
     DriverUtils.checkInterrupted(driverState, driverContext, "when checking the execution result.", hookContext,
         SessionState.getPerfLogger());
 
@@ -284,10 +288,6 @@ private void handleFinished() throws Exception {
 
     taskQueue.finished(taskRun);
 
-    SessionState.get().getHiveHistory().setTaskProperty(driverContext.getQueryId(), task.getId(),
-        Keys.TASK_RET_CODE, String.valueOf(exitVal));
-    SessionState.get().getHiveHistory().endTask(driverContext.getQueryId(), task);
-
     if (task.getChildTasks() != null) {
       for (Task<?> child : task.getChildTasks()) {
         if (TaskQueue.isLaunchable(child)) {
