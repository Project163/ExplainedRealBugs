diff --git a/CHANGES.txt b/CHANGES.txt
index 81ee1032cd..f1bb9501fb 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -321,6 +321,9 @@ Trunk -  Unreleased
     HIVE-1678 Bug in mapjoin followed by another mapjoin
     (Amareshwari Sriramadasu via namit)
 
+    HIVE-1691 Validate partition spec in analyze
+    (Ning Zhang via namit)
+
   TESTS
 
     HIVE-1464. improve  test query performance
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/Utilities.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/Utilities.java
index 9ee73ea542..95e8ea0bf6 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/Utilities.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/Utilities.java
@@ -1549,4 +1549,19 @@ public static void setColumnNameList(JobConf jobConf, Operator op) {
       Constants.LIST_COLUMNS,
       columnNamesString);
   }
+
+  public static void validatePartSpec(Table tbl, Map<String, String> partSpec)
+      throws SemanticException {
+
+    List<FieldSchema> parts = tbl.getPartitionKeys();
+    Set<String> partCols = new HashSet<String>(parts.size());
+    for (FieldSchema col: parts) {
+      partCols.add(col.getName());
+    }
+    for (String col: partSpec.keySet()) {
+      if (!partCols.contains(col)) {
+        throw new SemanticException(ErrorMsg.NONEXISTPARTCOL.getMsg(col));
+      }
+    }
+  }
 }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/BaseSemanticAnalyzer.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/BaseSemanticAnalyzer.java
index 596b4c68d5..8fd2cabb48 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/BaseSemanticAnalyzer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/BaseSemanticAnalyzer.java
@@ -38,6 +38,7 @@
 import org.apache.hadoop.hive.ql.Context;
 import org.apache.hadoop.hive.ql.exec.FetchTask;
 import org.apache.hadoop.hive.ql.exec.Task;
+import org.apache.hadoop.hive.ql.exec.Utilities;
 import org.apache.hadoop.hive.ql.hooks.LineageInfo;
 import org.apache.hadoop.hive.ql.hooks.ReadEntity;
 import org.apache.hadoop.hive.ql.hooks.WriteEntity;
@@ -577,6 +578,7 @@ public tableSpec(Hive db, HiveConf conf, ASTNode ast)
         throw new SemanticException(ErrorMsg.GENERIC_ERROR.getMsg(ast
             .getChild(childIndex), e.getMessage()), e);
       }
+
       // get partition metadata if partition specified
       if (ast.getChildCount() == 2) {
         childIndex = 1;
@@ -586,13 +588,17 @@ public tableSpec(Hive db, HiveConf conf, ASTNode ast)
         for (int i = 0; i < partspec.getChildCount(); ++i) {
           ASTNode partspec_val = (ASTNode) partspec.getChild(i);
           String val = null;
+          String colName = unescapeIdentifier(partspec_val.getChild(0).getText().toLowerCase());
           if (partspec_val.getChildCount() < 2) { // DP in the form of T partition (ds, hr)
             ++numDynParts;
           } else { // in the form of T partition (ds="2010-03-03")
             val = stripQuotes(partspec_val.getChild(1).getText());
           }
-          partSpec.put(unescapeIdentifier(partspec_val.getChild(0).getText().toLowerCase()), val);
+          partSpec.put(colName, val);
         }
+
+        Utilities.validatePartSpec(tableHandle, partSpec);
+
         // check if the partition spec is valid
         if (numDynParts > 0) {
           List<FieldSchema> parts = tableHandle.getPartitionKeys();
@@ -671,5 +677,4 @@ protected HashMap<String, String> extractPartitionSpecs(Tree partspec)
     }
     return partSpec;
   }
-
 }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/ErrorMsg.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/ErrorMsg.java
index 9680e4b411..22473ac095 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/ErrorMsg.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/ErrorMsg.java
@@ -145,7 +145,7 @@ public enum ErrorMsg {
   DYNAMIC_PARTITION_MERGE("Dynamic partition does not support merging mapfiles/mapredfiles yet."
       + "Please set hive.merge.mapfiles and hive.merge.mapredfiles to false or use static "
       +	"partitions"),
-  NONEXISTPARTCOL("Partition column in the partition specification does not exist"),
+  NONEXISTPARTCOL("Non-Partition column appears in the partition specification: "),
   UNSUPPORTED_TYPE("DATE, DATETIME, and TIMESTAMP types aren't supported yet. Please use "
       + "STRING instead."),
   CREATE_NON_NATIVE_AS("CREATE TABLE AS SELECT cannot be used for a non-native table"),
@@ -323,15 +323,15 @@ private static void renderPosition(StringBuilder sb, ASTNode tree) {
     sb.append(getCharPositionInLine(tree));
   }
 
-  String getMsg(Tree tree) {
+  public String getMsg(Tree tree) {
     return getMsg((ASTNode) tree);
   }
 
-  String getMsg(ASTNode tree, String reason) {
+  public String getMsg(ASTNode tree, String reason) {
     return getMsg(tree) + ": " + reason;
   }
 
-  String getMsg(Tree tree, String reason) {
+  public String getMsg(Tree tree, String reason) {
     return getMsg((ASTNode) tree, reason);
   }
 
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
index 630d24d0ce..ca29f9e405 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
@@ -3379,7 +3379,7 @@ private Operator genFileSinkPlan(String dest, QB qb, Operator input)
         }
         dpCtx = qbm.getDPCtx(dest);
         if (dpCtx == null) {
-          validatePartSpec(dest_tab, partSpec);
+          // validatePartSpec(dest_tab, partSpec);
           dpCtx = new DynamicPartitionCtx(dest_tab, partSpec,
               conf.getVar(HiveConf.ConfVars.DEFAULTPARTITIONNAME),
               conf.getIntVar(HiveConf.ConfVars.DYNAMICPARTITIONMAXPARTSPERNODE));
@@ -3678,19 +3678,6 @@ private Operator genFileSinkPlan(String dest, QB qb, Operator input)
     return output;
   }
 
-  private void validatePartSpec(Table tbl, Map<String, String> partSpec)
-      throws SemanticException {
-    List<FieldSchema> parts = tbl.getPartitionKeys();
-    Set<String> partCols = new HashSet<String>(parts.size());
-    for (FieldSchema col: parts) {
-      partCols.add(col.getName());
-    }
-    for (String col: partSpec.keySet()) {
-      if (!partCols.contains(col)) {
-        throw new SemanticException(ErrorMsg.NONEXISTPARTCOL.getMsg());
-      }
-    }
-  }
 
   /**
    * Generate the conversion SelectOperator that converts the columns into the
diff --git a/ql/src/test/queries/clientnegative/analyze.q b/ql/src/test/queries/clientnegative/analyze.q
new file mode 100644
index 0000000000..874f5bfc14
--- /dev/null
+++ b/ql/src/test/queries/clientnegative/analyze.q
@@ -0,0 +1 @@
+analyze table srcpart compute statistics;
diff --git a/ql/src/test/queries/clientnegative/analyze1.q b/ql/src/test/queries/clientnegative/analyze1.q
new file mode 100644
index 0000000000..057a1a0b48
--- /dev/null
+++ b/ql/src/test/queries/clientnegative/analyze1.q
@@ -0,0 +1 @@
+analyze table srcpart partition (key) compute statistics;
diff --git a/ql/src/test/results/clientnegative/analyze.q.out b/ql/src/test/results/clientnegative/analyze.q.out
new file mode 100644
index 0000000000..05a5c8f751
--- /dev/null
+++ b/ql/src/test/results/clientnegative/analyze.q.out
@@ -0,0 +1 @@
+FAILED: Error in semantic analysis: Table is partitioned and partition specification is needed
diff --git a/ql/src/test/results/clientnegative/analyze1.q.out b/ql/src/test/results/clientnegative/analyze1.q.out
new file mode 100644
index 0000000000..ede6e150cb
--- /dev/null
+++ b/ql/src/test/results/clientnegative/analyze1.q.out
@@ -0,0 +1 @@
+FAILED: Error in semantic analysis: Non-Partition column appears in the partition specification:  key
diff --git a/ql/src/test/results/clientnegative/dyn_part1.q.out b/ql/src/test/results/clientnegative/dyn_part1.q.out
index 21e46ad5e9..6011a593fa 100644
--- a/ql/src/test/results/clientnegative/dyn_part1.q.out
+++ b/ql/src/test/results/clientnegative/dyn_part1.q.out
@@ -3,4 +3,4 @@ PREHOOK: type: CREATETABLE
 POSTHOOK: query: create table dynamic_partition (key string) partitioned by (value string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: default@dynamic_partition
-FAILED: Error in semantic analysis: Partition column in the partition specification does not exist
+FAILED: Error in semantic analysis: Non-Partition column appears in the partition specification:  hr
