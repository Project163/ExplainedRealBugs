diff --git a/metastore/scripts/upgrade/derby/011-HIVE-3649.derby.sql b/metastore/scripts/upgrade/derby/011-HIVE-3649.derby.sql
index 3a56fb0d75..384e93dc17 100644
--- a/metastore/scripts/upgrade/derby/011-HIVE-3649.derby.sql
+++ b/metastore/scripts/upgrade/derby/011-HIVE-3649.derby.sql
@@ -1 +1,10 @@
-ALTER TABLE "SDS" ADD  "IS_STOREDASSUBDIRECTORIES" CHAR(1) NOT NULL;
+-- Add new not null column into SDS table in three steps
+
+-- Step 1: Add the column allowing null
+ALTER TABLE "SDS" ADD "IS_STOREDASSUBDIRECTORIES" CHAR(1);
+
+ -- Step 2: Replace the null with default value (false)
+UPDATE "SDS" SET "IS_STOREDASSUBDIRECTORIES" = 'N';
+
+-- Step 3: Alter the column to disallow null values
+ALTER TABLE "SDS" ALTER COLUMN "IS_STOREDASSUBDIRECTORIES" NOT NULL;
