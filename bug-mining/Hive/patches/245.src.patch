diff --git a/CHANGES.txt b/CHANGES.txt
index 87a443ea44..8edbc7ee8e 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -303,6 +303,9 @@ Release 0.4.0 -  Unreleased
     HIVE-737. Support having hadoop jars in HADOOP_HOME/build for running
     hive cli. (Johan Oskarsson via athusoo)
 
+    HIVE-750. New partitionpruner does not work with test mode.
+    (Namit Jain via zshao)
+
   OPTIMIZATIONS
 
     HIVE-279. Predicate Pushdown support (Prasad Chakka via athusoo).
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/ppd/OpProcFactory.java b/ql/src/java/org/apache/hadoop/hive/ql/ppd/OpProcFactory.java
index 4a20ed0535..952c6c52e1 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/ppd/OpProcFactory.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/ppd/OpProcFactory.java
@@ -93,59 +93,10 @@ public Object process(Node nd, Stack<Node> stack, NodeProcessorCtx procCtx,
         Object... nodeOutputs) throws SemanticException {
       LOG.info("Processing for " +  nd.getName() + "(" + ((Operator)nd).getIdentifier() + ")");
       OpWalkerInfo owi = (OpWalkerInfo)procCtx;
-      RowResolver inputRR = owi.getRowResolver(nd);
       TableScanOperator tsOp = (TableScanOperator)nd;
       mergeWithChildrenPred(tsOp, owi, null, null, false);
       ExprWalkerInfo pushDownPreds = owi.getPrunedPreds(tsOp);
-
-      if (pushDownPreds == null 
-          || pushDownPreds.getFinalCandidates() == null 
-          || pushDownPreds.getFinalCandidates().size() == 0) {
-        return null;
-      }
-      
-      // combine all predicates into a single expression
-      List<exprNodeDesc> preds = null;
-      exprNodeDesc condn = null; 
-      Iterator<List<exprNodeDesc>> iterator = pushDownPreds.getFinalCandidates().values().iterator();
-      while (iterator.hasNext()) {
-        preds = iterator.next();
-        int i = 0;
-        if(condn == null) {
-          condn = preds.get(0);
-          i++;
-        }
-        for(; i < preds.size(); i++) {
-          List<exprNodeDesc> children = new ArrayList<exprNodeDesc>(2);
-          children.add(condn);
-          children.add((exprNodeDesc) preds.get(i));
-          condn = new exprNodeGenericFuncDesc(
-              TypeInfoFactory.booleanTypeInfo,
-              FunctionRegistry.getGenericUDFForAnd(),
-              children
-              );
-        }
-      }
-      if(condn == null)
-        return null;
-      // add new filter op
-      List<Operator<? extends Serializable>> originalChilren = tsOp.getChildOperators();
-      tsOp.setChildOperators(null);
-      Operator<filterDesc> output = 
-        OperatorFactory.getAndMakeChild(new filterDesc(condn, false),
-                              new RowSchema(inputRR.getColumnInfos()), 
-                              tsOp);
-      output.setChildOperators(originalChilren);
-      for (Operator<? extends Serializable> ch : originalChilren) {
-        List<Operator<? extends Serializable>> parentOperators = ch.getParentOperators();
-        int pos = parentOperators.indexOf(tsOp);
-        assert pos != -1;
-        parentOperators.remove(pos);
-        parentOperators.add(pos, output); // add the new op as the old
-      }
-      OpParseContext ctx = new OpParseContext(inputRR);
-      owi.put(output, ctx);
-      return output;
+      return createFilter(tsOp, pushDownPreds, owi);
     }
 
   }
@@ -163,10 +114,13 @@ public Object process(Node nd, Stack<Node> stack, NodeProcessorCtx procCtx,
       OpWalkerInfo owi = (OpWalkerInfo)procCtx;
       Operator<? extends Serializable> op = (Operator<? extends Serializable>) nd;
       exprNodeDesc predicate = (((FilterOperator)nd).getConf()).getPredicate();
-      // get pushdown predicates for this operato's predicate
+      // get pushdown predicates for this operator's predicate
       ExprWalkerInfo ewi = ExprWalkerProcFactory.extractPushdownPreds(owi, op, predicate);
       if (!ewi.isDeterministic()) {
         /* predicate is not deterministic */
+        if (op.getChildren() != null && op.getChildren().size() == 1)
+          createFilter(op, owi.getPrunedPreds((Operator<? extends Serializable>)(op.getChildren().get(0))), owi);
+
         return null;
       }
 
@@ -332,6 +286,62 @@ protected void mergeWithChildrenPred(Node nd, OpWalkerInfo owi, ExprWalkerInfo e
     }
   }
 
+  protected static Object createFilter(Operator op, ExprWalkerInfo pushDownPreds, OpWalkerInfo owi) {
+    if (pushDownPreds == null 
+        || pushDownPreds.getFinalCandidates() == null 
+        || pushDownPreds.getFinalCandidates().size() == 0) {
+      return null;
+    }
+      
+    RowResolver inputRR = owi.getRowResolver(op);
+
+    // combine all predicates into a single expression
+    List<exprNodeDesc> preds = null;
+    exprNodeDesc condn = null; 
+    Iterator<List<exprNodeDesc>> iterator = pushDownPreds.getFinalCandidates().values().iterator();
+    while (iterator.hasNext()) {
+      preds = iterator.next();
+      int i = 0;
+      if (condn == null) {
+        condn = preds.get(0);
+        i++;
+      }
+
+      for(; i < preds.size(); i++) {
+        List<exprNodeDesc> children = new ArrayList<exprNodeDesc>(2);
+        children.add(condn);
+        children.add((exprNodeDesc) preds.get(i));
+        condn = new exprNodeGenericFuncDesc(
+                                            TypeInfoFactory.booleanTypeInfo,
+                                            FunctionRegistry.getGenericUDFForAnd(),
+                                            children
+                                            );
+      }
+    }
+
+    if(condn == null)
+      return null;
+
+    // add new filter op
+    List<Operator<? extends Serializable>> originalChilren = op.getChildOperators();
+    op.setChildOperators(null);
+    Operator<filterDesc> output = 
+      OperatorFactory.getAndMakeChild(new filterDesc(condn, false),
+                                      new RowSchema(inputRR.getColumnInfos()), 
+                                      op);
+    output.setChildOperators(originalChilren);
+    for (Operator<? extends Serializable> ch : originalChilren) {
+      List<Operator<? extends Serializable>> parentOperators = ch.getParentOperators();
+      int pos = parentOperators.indexOf(op);
+      assert pos != -1;
+      parentOperators.remove(pos);
+      parentOperators.add(pos, output); // add the new op as the old
+    }
+    OpParseContext ctx = new OpParseContext(inputRR);
+    owi.put(output, ctx);
+    return output;
+  }
+  
   public static NodeProcessor getFilterProc() {
     return new FilterPPD();
   }
diff --git a/ql/src/test/queries/clientpositive/input39.q b/ql/src/test/queries/clientpositive/input39.q
new file mode 100644
index 0000000000..1744ffef96
--- /dev/null
+++ b/ql/src/test/queries/clientpositive/input39.q
@@ -0,0 +1,27 @@
+drop table t1;
+drop table t2;
+
+create table t1(key string, value string) partitioned by (ds string);
+create table t2(key string, value string) partitioned by (ds string);
+
+insert overwrite table t1 partition (ds='1')
+select key, value from src;
+
+insert overwrite table t1 partition (ds='2')
+select key, value from src;
+
+insert overwrite table t2 partition (ds='1')
+select key, value from src;
+
+set hive.test.mode=true;
+set hive.mapred.mode=strict;
+
+explain
+select count(1) from t1 join t2 on t1.key=t2.key where t1.ds='1' and t2.ds='1';
+
+select count(1) from t1 join t2 on t1.key=t2.key where t1.ds='1' and t2.ds='1';
+
+set hive.test.mode=false;
+
+drop table t1;
+drop table t2;
diff --git a/ql/src/test/results/clientpositive/input39.q.out b/ql/src/test/results/clientpositive/input39.q.out
new file mode 100644
index 0000000000..7140c53087
--- /dev/null
+++ b/ql/src/test/results/clientpositive/input39.q.out
@@ -0,0 +1,141 @@
+query: drop table t1
+query: drop table t2
+query: create table t1(key string, value string) partitioned by (ds string)
+query: create table t2(key string, value string) partitioned by (ds string)
+query: insert overwrite table t1 partition (ds='1')
+select key, value from src
+Input: default/src
+Output: default/t1/ds=1
+query: insert overwrite table t1 partition (ds='2')
+select key, value from src
+Input: default/src
+Output: default/t1/ds=2
+query: insert overwrite table t2 partition (ds='1')
+select key, value from src
+Input: default/src
+Output: default/t2/ds=1
+query: explain
+select count(1) from t1 join t2 on t1.key=t2.key where t1.ds='1' and t2.ds='1'
+ABSTRACT SYNTAX TREE:
+  (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_TABREF t1) (TOK_TABREF t2) (= (. (TOK_TABLE_OR_COL t1) key) (. (TOK_TABLE_OR_COL t2) key)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_FUNCTION count 1))) (TOK_WHERE (and (= (. (TOK_TABLE_OR_COL t1) ds) '1') (= (. (TOK_TABLE_OR_COL t2) ds) '1')))))
+
+STAGE DEPENDENCIES:
+  Stage-1 is a root stage
+  Stage-2 depends on stages: Stage-1
+  Stage-0 is a root stage
+
+STAGE PLANS:
+  Stage: Stage-1
+    Map Reduce
+      Alias -> Map Operator Tree:
+        t2 
+          TableScan
+            alias: t2
+            Filter Operator
+              predicate:
+                  expr: (((hash(rand(460476415)) & 2147483647) % 32) = 0)
+                  type: boolean
+              Filter Operator
+                predicate:
+                    expr: (ds = '1')
+                    type: boolean
+                Reduce Output Operator
+                  key expressions:
+                        expr: key
+                        type: string
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: key
+                        type: string
+                  tag: 1
+                  value expressions:
+                        expr: ds
+                        type: string
+        t1 
+          TableScan
+            alias: t1
+            Filter Operator
+              predicate:
+                  expr: (((hash(rand(460476415)) & 2147483647) % 32) = 0)
+                  type: boolean
+              Filter Operator
+                predicate:
+                    expr: (ds = '1')
+                    type: boolean
+                Reduce Output Operator
+                  key expressions:
+                        expr: key
+                        type: string
+                  sort order: +
+                  Map-reduce partition columns:
+                        expr: key
+                        type: string
+                  tag: 0
+                  value expressions:
+                        expr: ds
+                        type: string
+      Reduce Operator Tree:
+        Join Operator
+          condition map:
+               Inner Join 0 to 1
+          condition expressions:
+            0 {VALUE._col2}
+            1 {VALUE._col2}
+          outputColumnNames: _col2, _col5
+          Filter Operator
+            predicate:
+                expr: ((_col2 = '1') and (_col5 = '1'))
+                type: boolean
+            Select Operator
+              Group By Operator
+                aggregations:
+                      expr: count(1)
+                mode: hash
+                outputColumnNames: _col0
+                File Output Operator
+                  compressed: false
+                  GlobalTableId: 0
+                  table:
+                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
+                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
+
+  Stage: Stage-2
+    Map Reduce
+      Alias -> Map Operator Tree:
+        file:/data/users/njain/hive4/hive4/build/ql/tmp/159384890/10002 
+            Reduce Output Operator
+              sort order: 
+              tag: -1
+              value expressions:
+                    expr: _col0
+                    type: bigint
+      Reduce Operator Tree:
+        Group By Operator
+          aggregations:
+                expr: count(VALUE._col0)
+          mode: mergepartial
+          outputColumnNames: _col0
+          Select Operator
+            expressions:
+                  expr: _col0
+                  type: bigint
+            outputColumnNames: _col0
+            File Output Operator
+              compressed: false
+              GlobalTableId: 0
+              table:
+                  input format: org.apache.hadoop.mapred.TextInputFormat
+                  output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+
+  Stage: Stage-0
+    Fetch Operator
+      limit: -1
+
+
+query: select count(1) from t1 join t2 on t1.key=t2.key where t1.ds='1' and t2.ds='1'
+Input: default/t2/ds=1
+Input: default/t1/ds=1
+Output: file:/data/users/njain/hive4/hive4/build/ql/tmp/104820129/10000
+18
+query: drop table t1
+query: drop table t2
diff --git a/ql/src/test/results/clientpositive/sample1.q.out b/ql/src/test/results/clientpositive/sample1.q.out
index 5eab933093..6067d39f46 100644
--- a/ql/src/test/results/clientpositive/sample1.q.out
+++ b/ql/src/test/results/clientpositive/sample1.q.out
@@ -29,53 +29,58 @@ STAGE PLANS:
                 predicate:
                     expr: ((ds = '2008-04-08') and (hr = '11'))
                     type: boolean
-                Select Operator
-                  expressions:
-                        expr: key
-                        type: string
-                        expr: value
-                        type: string
-                        expr: ds
-                        type: string
-                        expr: hr
-                        type: string
-                  outputColumnNames: _col0, _col1, _col2, _col3
+                Filter Operator
+                  isSamplingPred: false
+                  predicate:
+                      expr: ((ds = '2008-04-08') and (hr = '11'))
+                      type: boolean
                   Select Operator
                     expressions:
-                          expr: UDFToInteger(_col0)
-                          type: int
-                          expr: _col1
+                          expr: key
                           type: string
-                          expr: _col2
+                          expr: value
                           type: string
-                          expr: _col3
+                          expr: ds
+                          type: string
+                          expr: hr
                           type: string
                     outputColumnNames: _col0, _col1, _col2, _col3
-                    File Output Operator
-                      compressed: false
-                      GlobalTableId: 1
-                      directory: file:/data/users/athusoo/commits/hive_trunk_ws1/build/ql/tmp/212207906/10002
-                      table:
-                          input format: org.apache.hadoop.mapred.TextInputFormat
-                          output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                          properties:
-                            name dest1
-                            columns.types int:string:string:string
-                            serialization.ddl struct dest1 { i32 key, string value, string dt, string hr}
-                            serialization.format 1
-                            columns key,value,dt,hr
-                            bucket_count -1
-                            serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                            file.inputformat org.apache.hadoop.mapred.TextInputFormat
-                            file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                            location file:/data/users/athusoo/commits/hive_trunk_ws1/build/ql/test/data/warehouse/dest1
-                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                          name: dest1
+                    Select Operator
+                      expressions:
+                            expr: UDFToInteger(_col0)
+                            type: int
+                            expr: _col1
+                            type: string
+                            expr: _col2
+                            type: string
+                            expr: _col3
+                            type: string
+                      outputColumnNames: _col0, _col1, _col2, _col3
+                      File Output Operator
+                        compressed: false
+                        GlobalTableId: 1
+                        directory: file:/data/users/njain/hive4/hive4/build/ql/tmp/1917947212/10002
+                        table:
+                            input format: org.apache.hadoop.mapred.TextInputFormat
+                            output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                            properties:
+                              name dest1
+                              columns.types int:string:string:string
+                              serialization.ddl struct dest1 { i32 key, string value, string dt, string hr}
+                              serialization.format 1
+                              columns key,value,dt,hr
+                              bucket_count -1
+                              serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                              file.inputformat org.apache.hadoop.mapred.TextInputFormat
+                              file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                              location file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/dest1
+                            serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+                            name: dest1
       Needs Tagging: false
       Path -> Alias:
-        file:/data/users/athusoo/commits/hive_trunk_ws1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 
+        file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 [s]
       Path -> Partition:
-        file:/data/users/athusoo/commits/hive_trunk_ws1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 
+        file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 
           Partition
             partition values:
               ds 2008-04-08
@@ -94,7 +99,7 @@ STAGE PLANS:
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location file:/data/users/athusoo/commits/hive_trunk_ws1/build/ql/test/data/warehouse/srcpart
+                location file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/srcpart
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: srcpart
 
@@ -104,11 +109,11 @@ STAGE PLANS:
           Move Operator
             files:
                 hdfs directory: true
-                source: file:/data/users/athusoo/commits/hive_trunk_ws1/build/ql/tmp/212207906/10002
-                destination: file:/data/users/athusoo/commits/hive_trunk_ws1/build/ql/tmp/1104113199/10000
+                source: file:/data/users/njain/hive4/hive4/build/ql/tmp/1917947212/10002
+                destination: file:/data/users/njain/hive4/hive4/build/ql/tmp/425720684/10000
           Map Reduce
             Alias -> Map Operator Tree:
-              file:/data/users/athusoo/commits/hive_trunk_ws1/build/ql/tmp/212207906/10002 
+              file:/data/users/njain/hive4/hive4/build/ql/tmp/1917947212/10002 
                   Reduce Output Operator
                     sort order: 
                     Map-reduce partition columns:
@@ -126,9 +131,9 @@ STAGE PLANS:
                           type: string
             Needs Tagging: false
             Path -> Alias:
-              file:/data/users/athusoo/commits/hive_trunk_ws1/build/ql/tmp/212207906/10002 
+              file:/data/users/njain/hive4/hive4/build/ql/tmp/1917947212/10002 [file:/data/users/njain/hive4/hive4/build/ql/tmp/1917947212/10002]
             Path -> Partition:
-              file:/data/users/athusoo/commits/hive_trunk_ws1/build/ql/tmp/212207906/10002 
+              file:/data/users/njain/hive4/hive4/build/ql/tmp/1917947212/10002 
                 Partition
                 
                     input format: org.apache.hadoop.mapred.TextInputFormat
@@ -143,7 +148,7 @@ STAGE PLANS:
                       serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       file.inputformat org.apache.hadoop.mapred.TextInputFormat
                       file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                      location file:/data/users/athusoo/commits/hive_trunk_ws1/build/ql/test/data/warehouse/dest1
+                      location file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/dest1
                     serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                     name: dest1
             Reduce Operator Tree:
@@ -151,7 +156,7 @@ STAGE PLANS:
                 File Output Operator
                   compressed: false
                   GlobalTableId: 0
-                  directory: file:/data/users/athusoo/commits/hive_trunk_ws1/build/ql/tmp/1104113199/10000
+                  directory: file:/data/users/njain/hive4/hive4/build/ql/tmp/425720684/10000
                   table:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -164,7 +169,7 @@ STAGE PLANS:
                         bucket_count -1
                         serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                         file.inputformat org.apache.hadoop.mapred.TextInputFormat
-                        location file:/data/users/athusoo/commits/hive_trunk_ws1/build/ql/test/data/warehouse/dest1
+                        location file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/dest1
                         file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
                       serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                       name: dest1
@@ -173,7 +178,7 @@ STAGE PLANS:
     Move Operator
       tables:
           replace: true
-          source: file:/data/users/athusoo/commits/hive_trunk_ws1/build/ql/tmp/1104113199/10000
+          source: file:/data/users/njain/hive4/hive4/build/ql/tmp/425720684/10000
           table:
               input format: org.apache.hadoop.mapred.TextInputFormat
               output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -187,10 +192,10 @@ STAGE PLANS:
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location file:/data/users/athusoo/commits/hive_trunk_ws1/build/ql/test/data/warehouse/dest1
+                location file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/dest1
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: dest1
-          tmp directory: file:/data/users/athusoo/commits/hive_trunk_ws1/build/ql/tmp/1104113199/10001
+          tmp directory: file:/data/users/njain/hive4/hive4/build/ql/tmp/425720684/10001
 
 
 query: INSERT OVERWRITE TABLE dest1 SELECT s.*
@@ -200,7 +205,7 @@ Input: default/srcpart/ds=2008-04-08/hr=11
 Output: default/dest1
 query: SELECT dest1.* FROM dest1
 Input: default/dest1
-Output: file:/data/users/athusoo/commits/hive_trunk_ws1/build/ql/tmp/128296418/10000
+Output: file:/data/users/njain/hive4/hive4/build/ql/tmp/1412070589/10000
 238	val_238	2008-04-08	11
 86	val_86	2008-04-08	11
 311	val_311	2008-04-08	11
@@ -703,5 +708,5 @@ Output: file:/data/users/athusoo/commits/hive_trunk_ws1/build/ql/tmp/128296418/1
 97	val_97	2008-04-08	11
 query: select count(1) from srcbucket
 Input: default/srcbucket
-Output: file:/data/users/athusoo/commits/hive_trunk_ws1/build/ql/tmp/822380674/10000
+Output: file:/data/users/njain/hive4/hive4/build/ql/tmp/984906761/10000
 1000
diff --git a/ql/src/test/results/compiler/plan/sample1.q.xml b/ql/src/test/results/compiler/plan/sample1.q.xml
index 0569ee9e65..95b713c095 100644
--- a/ql/src/test/results/compiler/plan/sample1.q.xml
+++ b/ql/src/test/results/compiler/plan/sample1.q.xml
@@ -77,7 +77,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/srcpart</string> 
+            <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/srcpart</string> 
            </void> 
           </object> 
          </void> 
@@ -105,40 +105,123 @@
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+                   <object id="FilterOperator2" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
                     <void property="childOperators"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                        <void property="conf"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
-                          <void property="dirName"> 
-                           <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/384076544/10001</string> 
-                          </void> 
-                          <void property="tableInfo"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
-                            <void property="deserializerClass"> 
-                             <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
-                            </void> 
-                            <void property="inputFileFormatClass"> 
-                             <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-                            </void> 
-                            <void property="outputFileFormatClass"> 
-                             <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-                            </void> 
-                            <void property="properties"> 
-                             <object class="java.util.Properties"> 
-                              <void method="put"> 
-                               <string>columns</string> 
-                               <string>_col0,_col1,_col2,_col3</string> 
+                       <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+                        <void property="childOperators"> 
+                         <object class="java.util.ArrayList"> 
+                          <void method="add"> 
+                           <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                            <void property="conf"> 
+                             <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
+                              <void property="dirName"> 
+                               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/1901117107/10001</string> 
+                              </void> 
+                              <void property="tableInfo"> 
+                               <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
+                                <void property="deserializerClass"> 
+                                 <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
+                                </void> 
+                                <void property="inputFileFormatClass"> 
+                                 <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                                </void> 
+                                <void property="outputFileFormatClass"> 
+                                 <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                                </void> 
+                                <void property="properties"> 
+                                 <object class="java.util.Properties"> 
+                                  <void method="put"> 
+                                   <string>columns</string> 
+                                   <string>_col0,_col1,_col2,_col3</string> 
+                                  </void> 
+                                  <void method="put"> 
+                                   <string>serialization.format</string> 
+                                   <string>1</string> 
+                                  </void> 
+                                  <void method="put"> 
+                                   <string>columns.types</string> 
+                                   <string>string:string:string:string</string> 
+                                  </void> 
+                                 </object> 
+                                </void> 
+                               </object> 
+                              </void> 
+                             </object> 
+                            </void> 
+                            <void property="counterNames"> 
+                             <object class="java.util.ArrayList"> 
+                              <void method="add"> 
+                               <string>CNTR_NAME_FS_588_NUM_INPUT_ROWS</string> 
                               </void> 
-                              <void method="put"> 
-                               <string>serialization.format</string> 
-                               <string>1</string> 
+                              <void method="add"> 
+                               <string>CNTR_NAME_FS_588_NUM_OUTPUT_ROWS</string> 
                               </void> 
-                              <void method="put"> 
-                               <string>columns.types</string> 
-                               <string>string:string:string:string</string> 
+                              <void method="add"> 
+                               <string>CNTR_NAME_FS_588_TIME_TAKEN</string> 
+                              </void> 
+                             </object> 
+                            </void> 
+                            <void property="operatorId"> 
+                             <string>FS_588</string> 
+                            </void> 
+                            <void property="parentOperators"> 
+                             <object class="java.util.ArrayList"> 
+                              <void method="add"> 
+                               <object idref="SelectOperator0"/> 
+                              </void> 
+                             </object> 
+                            </void> 
+                            <void property="schema"> 
+                             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                              <void property="signature"> 
+                               <object class="java.util.Vector"> 
+                                <void method="add"> 
+                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                  <void property="internalName"> 
+                                   <string>_col0</string> 
+                                  </void> 
+                                  <void property="type"> 
+                                   <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                                    <void property="typeName"> 
+                                     <string>string</string> 
+                                    </void> 
+                                   </object> 
+                                  </void> 
+                                 </object> 
+                                </void> 
+                                <void method="add"> 
+                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                  <void property="internalName"> 
+                                   <string>_col1</string> 
+                                  </void> 
+                                  <void property="type"> 
+                                   <object idref="PrimitiveTypeInfo0"/> 
+                                  </void> 
+                                 </object> 
+                                </void> 
+                                <void method="add"> 
+                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                  <void property="internalName"> 
+                                   <string>_col2</string> 
+                                  </void> 
+                                  <void property="type"> 
+                                   <object idref="PrimitiveTypeInfo0"/> 
+                                  </void> 
+                                 </object> 
+                                </void> 
+                                <void method="add"> 
+                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                  <void property="internalName"> 
+                                   <string>_col3</string> 
+                                  </void> 
+                                  <void property="type"> 
+                                   <object idref="PrimitiveTypeInfo0"/> 
+                                  </void> 
+                                 </object> 
+                                </void> 
+                               </object> 
                               </void> 
                              </object> 
                             </void> 
@@ -146,26 +229,125 @@
                           </void> 
                          </object> 
                         </void> 
+                        <void property="columnExprMap"> 
+                         <object class="java.util.HashMap"> 
+                          <void method="put"> 
+                           <string>_col3</string> 
+                           <object id="exprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                            <void property="column"> 
+                             <string>hr</string> 
+                            </void> 
+                            <void property="tabAlias"> 
+                             <string>s</string> 
+                            </void> 
+                            <void property="typeInfo"> 
+                             <object idref="PrimitiveTypeInfo0"/> 
+                            </void> 
+                           </object> 
+                          </void> 
+                          <void method="put"> 
+                           <string>_col2</string> 
+                           <object id="exprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                            <void property="column"> 
+                             <string>ds</string> 
+                            </void> 
+                            <void property="tabAlias"> 
+                             <string>s</string> 
+                            </void> 
+                            <void property="typeInfo"> 
+                             <object idref="PrimitiveTypeInfo0"/> 
+                            </void> 
+                           </object> 
+                          </void> 
+                          <void method="put"> 
+                           <string>_col1</string> 
+                           <object id="exprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                            <void property="column"> 
+                             <string>value</string> 
+                            </void> 
+                            <void property="tabAlias"> 
+                             <string>s</string> 
+                            </void> 
+                            <void property="typeInfo"> 
+                             <object idref="PrimitiveTypeInfo0"/> 
+                            </void> 
+                           </object> 
+                          </void> 
+                          <void method="put"> 
+                           <string>_col0</string> 
+                           <object id="exprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                            <void property="column"> 
+                             <string>key</string> 
+                            </void> 
+                            <void property="tabAlias"> 
+                             <string>s</string> 
+                            </void> 
+                            <void property="typeInfo"> 
+                             <object idref="PrimitiveTypeInfo0"/> 
+                            </void> 
+                           </object> 
+                          </void> 
+                         </object> 
+                        </void> 
+                        <void property="conf"> 
+                         <object class="org.apache.hadoop.hive.ql.plan.selectDesc"> 
+                          <void property="colList"> 
+                           <object class="java.util.ArrayList"> 
+                            <void method="add"> 
+                             <object idref="exprNodeColumnDesc3"/> 
+                            </void> 
+                            <void method="add"> 
+                             <object idref="exprNodeColumnDesc2"/> 
+                            </void> 
+                            <void method="add"> 
+                             <object idref="exprNodeColumnDesc1"/> 
+                            </void> 
+                            <void method="add"> 
+                             <object idref="exprNodeColumnDesc0"/> 
+                            </void> 
+                           </object> 
+                          </void> 
+                          <void property="outputColumnNames"> 
+                           <object class="java.util.ArrayList"> 
+                            <void method="add"> 
+                             <string>_col0</string> 
+                            </void> 
+                            <void method="add"> 
+                             <string>_col1</string> 
+                            </void> 
+                            <void method="add"> 
+                             <string>_col2</string> 
+                            </void> 
+                            <void method="add"> 
+                             <string>_col3</string> 
+                            </void> 
+                           </object> 
+                          </void> 
+                          <void property="selectStar"> 
+                           <boolean>true</boolean> 
+                          </void> 
+                         </object> 
+                        </void> 
                         <void property="counterNames"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <string>CNTR_NAME_FS_588_NUM_INPUT_ROWS</string> 
+                           <string>CNTR_NAME_SEL_587_NUM_INPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_FS_588_NUM_OUTPUT_ROWS</string> 
+                           <string>CNTR_NAME_SEL_587_NUM_OUTPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_FS_588_TIME_TAKEN</string> 
+                           <string>CNTR_NAME_SEL_587_TIME_TAKEN</string> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="operatorId"> 
-                         <string>FS_588</string> 
+                         <string>SEL_587</string> 
                         </void> 
                         <void property="parentOperators"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <object idref="SelectOperator0"/> 
+                           <object idref="FilterOperator2"/> 
                           </void> 
                          </object> 
                         </void> 
@@ -179,11 +361,7 @@
                                <string>_col0</string> 
                               </void> 
                               <void property="type"> 
-                               <object id="PrimitiveTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                                <void property="typeName"> 
-                                 <string>string</string> 
-                                </void> 
-                               </object> 
+                               <object idref="PrimitiveTypeInfo0"/> 
                               </void> 
                              </object> 
                             </void> 
@@ -225,120 +403,147 @@
                       </void> 
                      </object> 
                     </void> 
-                    <void property="columnExprMap"> 
-                     <object class="java.util.HashMap"> 
-                      <void method="put"> 
-                       <string>_col3</string> 
-                       <object id="exprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>hr</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>s</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="put"> 
-                       <string>_col2</string> 
-                       <object id="exprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>ds</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>s</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="put"> 
-                       <string>_col1</string> 
-                       <object id="exprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>value</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>s</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="put"> 
-                       <string>_col0</string> 
-                       <object id="exprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="tabAlias"> 
-                         <string>s</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
                     <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.selectDesc"> 
-                      <void property="colList"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object idref="exprNodeColumnDesc3"/> 
-                        </void> 
-                        <void method="add"> 
-                         <object idref="exprNodeColumnDesc2"/> 
-                        </void> 
-                        <void method="add"> 
-                         <object idref="exprNodeColumnDesc1"/> 
-                        </void> 
-                        <void method="add"> 
-                         <object idref="exprNodeColumnDesc0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="outputColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>_col0</string> 
-                        </void> 
-                        <void method="add"> 
-                         <string>_col1</string> 
+                     <object class="org.apache.hadoop.hive.ql.plan.filterDesc"> 
+                      <void property="predicate"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeGenericFuncDesc"> 
+                        <void property="childExprs"> 
+                         <object class="java.util.ArrayList"> 
+                          <void method="add"> 
+                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeGenericFuncDesc"> 
+                            <void property="childExprs"> 
+                             <object class="java.util.ArrayList"> 
+                              <void method="add"> 
+                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                                <void property="column"> 
+                                 <string>ds</string> 
+                                </void> 
+                                <void property="tabAlias"> 
+                                 <string>s</string> 
+                                </void> 
+                                <void property="typeInfo"> 
+                                 <object idref="PrimitiveTypeInfo0"/> 
+                                </void> 
+                               </object> 
+                              </void> 
+                              <void method="add"> 
+                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
+                                <void property="typeInfo"> 
+                                 <object idref="PrimitiveTypeInfo0"/> 
+                                </void> 
+                                <void property="value"> 
+                                 <string>2008-04-08</string> 
+                                </void> 
+                               </object> 
+                              </void> 
+                             </object> 
+                            </void> 
+                            <void property="genericUDF"> 
+                             <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                              <void property="operator"> 
+                               <boolean>true</boolean> 
+                              </void> 
+                              <void property="udfClass"> 
+                               <class>org.apache.hadoop.hive.ql.udf.UDFOPEqual</class> 
+                              </void> 
+                              <void property="udfName"> 
+                               <string>=</string> 
+                              </void> 
+                             </object> 
+                            </void> 
+                            <void property="typeInfo"> 
+                             <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                              <void property="typeName"> 
+                               <string>boolean</string> 
+                              </void> 
+                             </object> 
+                            </void> 
+                           </object> 
+                          </void> 
+                          <void method="add"> 
+                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeGenericFuncDesc"> 
+                            <void property="childExprs"> 
+                             <object class="java.util.ArrayList"> 
+                              <void method="add"> 
+                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                                <void property="column"> 
+                                 <string>hr</string> 
+                                </void> 
+                                <void property="tabAlias"> 
+                                 <string>s</string> 
+                                </void> 
+                                <void property="typeInfo"> 
+                                 <object idref="PrimitiveTypeInfo0"/> 
+                                </void> 
+                               </object> 
+                              </void> 
+                              <void method="add"> 
+                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
+                                <void property="typeInfo"> 
+                                 <object idref="PrimitiveTypeInfo0"/> 
+                                </void> 
+                                <void property="value"> 
+                                 <string>11</string> 
+                                </void> 
+                               </object> 
+                              </void> 
+                             </object> 
+                            </void> 
+                            <void property="genericUDF"> 
+                             <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                              <void property="operator"> 
+                               <boolean>true</boolean> 
+                              </void> 
+                              <void property="udfClass"> 
+                               <class>org.apache.hadoop.hive.ql.udf.UDFOPEqual</class> 
+                              </void> 
+                              <void property="udfName"> 
+                               <string>=</string> 
+                              </void> 
+                             </object> 
+                            </void> 
+                            <void property="typeInfo"> 
+                             <object idref="PrimitiveTypeInfo1"/> 
+                            </void> 
+                           </object> 
+                          </void> 
+                         </object> 
                         </void> 
-                        <void method="add"> 
-                         <string>_col2</string> 
+                        <void property="genericUDF"> 
+                         <object class="org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge"> 
+                          <void property="operator"> 
+                           <boolean>true</boolean> 
+                          </void> 
+                          <void property="udfClass"> 
+                           <class>org.apache.hadoop.hive.ql.udf.UDFOPAnd</class> 
+                          </void> 
+                          <void property="udfName"> 
+                           <string>and</string> 
+                          </void> 
+                         </object> 
                         </void> 
-                        <void method="add"> 
-                         <string>_col3</string> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
                        </object> 
                       </void> 
-                      <void property="selectStar"> 
-                       <boolean>true</boolean> 
-                      </void> 
                      </object> 
                     </void> 
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_587_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_FIL_586_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_587_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_FIL_586_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_587_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_FIL_586_TIME_TAKEN</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>SEL_587</string> 
+                     <string>FIL_586</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
@@ -350,11 +555,11 @@
                     <void property="schema"> 
                      <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
                       <void property="signature"> 
-                       <object class="java.util.Vector"> 
+                       <object id="Vector0" class="java.util.Vector"> 
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                           <void property="internalName"> 
-                           <string>_col0</string> 
+                           <string>key</string> 
                           </void> 
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
@@ -364,7 +569,7 @@
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                           <void property="internalName"> 
-                           <string>_col1</string> 
+                           <string>value</string> 
                           </void> 
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
@@ -374,7 +579,7 @@
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                           <void property="internalName"> 
-                           <string>_col2</string> 
+                           <string>ds</string> 
                           </void> 
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
@@ -384,7 +589,7 @@
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                           <void property="internalName"> 
-                           <string>_col3</string> 
+                           <string>hr</string> 
                           </void> 
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
@@ -448,11 +653,7 @@
                          </object> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>boolean</string> 
-                          </void> 
-                         </object> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
                        </object> 
                       </void> 
@@ -528,18 +729,18 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_586_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_FIL_589_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_586_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_FIL_589_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_586_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_FIL_589_TIME_TAKEN</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>FIL_586</string> 
+                 <string>FIL_589</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -551,48 +752,7 @@
                 <void property="schema"> 
                  <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
                   <void property="signature"> 
-                   <object id="Vector0" class="java.util.Vector"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>key</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>value</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>ds</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>hr</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
+                   <object idref="Vector0"/> 
                   </void> 
                  </object> 
                 </void> 
@@ -831,7 +991,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11</string> 
+       <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>s</string> 
@@ -843,7 +1003,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11</string> 
+       <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/sample2.q.xml b/ql/src/test/results/compiler/plan/sample2.q.xml
index 9acafa6d64..f713be78cd 100644
--- a/ql/src/test/results/compiler/plan/sample2.q.xml
+++ b/ql/src/test/results/compiler/plan/sample2.q.xml
@@ -30,7 +30,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1164084646/10000</string> 
+               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/1191919557/10000</string> 
               </void> 
               <void property="table"> 
                <object id="tableDesc0" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -83,7 +83,7 @@
                   </void> 
                   <void method="put"> 
                    <string>location</string> 
-                   <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/dest1</string> 
+                   <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/dest1</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -93,7 +93,7 @@
                </object> 
               </void> 
               <void property="tmpDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1164084646/10001</string> 
+               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/1191919557/10001</string> 
               </void> 
              </object> 
             </void> 
@@ -121,10 +121,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1002712615/10002</string> 
+               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/167250082/10002</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1164084646/10000</string> 
+               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/1191919557/10000</string> 
               </void> 
              </object> 
             </void> 
@@ -142,7 +142,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1002712615/10002</string> 
+               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/167250082/10002</string> 
                <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -297,18 +297,18 @@
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_600_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_RS_602_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_600_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_RS_602_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_600_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_RS_602_TIME_TAKEN</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>RS_600</string> 
+                     <string>RS_602</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
@@ -352,18 +352,18 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_TS_599_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_TS_601_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_TS_599_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_TS_601_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_TS_599_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_TS_601_TIME_TAKEN</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>TS_599</string> 
+                 <string>TS_601</string> 
                 </void> 
                 <void property="schema"> 
                  <object idref="RowSchema0"/> 
@@ -381,10 +381,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1002712615/10002</string> 
+               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/167250082/10002</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1002712615/10002</string> 
+                 <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/167250082/10002</string> 
                 </void> 
                </object> 
               </void> 
@@ -393,7 +393,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1002712615/10002</string> 
+               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/167250082/10002</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object idref="tableDesc0"/> 
@@ -411,7 +411,7 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1164084646/10000</string> 
+                     <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/1191919557/10000</string> 
                     </void> 
                     <void property="tableInfo"> 
                      <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -460,7 +460,7 @@
                         </void> 
                         <void method="put"> 
                          <string>location</string> 
-                         <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/dest1</string> 
+                         <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/dest1</string> 
                         </void> 
                         <void method="put"> 
                          <string>file.outputformat</string> 
@@ -478,18 +478,18 @@
                   <void property="counterNames"> 
                    <object class="java.util.ArrayList"> 
                     <void method="add"> 
-                     <string>CNTR_NAME_FS_602_NUM_INPUT_ROWS</string> 
+                     <string>CNTR_NAME_FS_604_NUM_INPUT_ROWS</string> 
                     </void> 
                     <void method="add"> 
-                     <string>CNTR_NAME_FS_602_NUM_OUTPUT_ROWS</string> 
+                     <string>CNTR_NAME_FS_604_NUM_OUTPUT_ROWS</string> 
                     </void> 
                     <void method="add"> 
-                     <string>CNTR_NAME_FS_602_TIME_TAKEN</string> 
+                     <string>CNTR_NAME_FS_604_TIME_TAKEN</string> 
                     </void> 
                    </object> 
                   </void> 
                   <void property="operatorId"> 
-                   <string>FS_602</string> 
+                   <string>FS_604</string> 
                   </void> 
                   <void property="parentOperators"> 
                    <object class="java.util.ArrayList"> 
@@ -525,18 +525,18 @@
               <void property="counterNames"> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>CNTR_NAME_OP_601_NUM_INPUT_ROWS</string> 
+                 <string>CNTR_NAME_OP_603_NUM_INPUT_ROWS</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_OP_601_NUM_OUTPUT_ROWS</string> 
+                 <string>CNTR_NAME_OP_603_NUM_OUTPUT_ROWS</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_OP_601_TIME_TAKEN</string> 
+                 <string>CNTR_NAME_OP_603_TIME_TAKEN</string> 
                 </void> 
                </object> 
               </void> 
               <void property="operatorId"> 
-               <string>OP_601</string> 
+               <string>OP_603</string> 
               </void> 
               <void property="schema"> 
                <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -598,7 +598,7 @@
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
         <void property="dir"> 
-         <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1002712615/10002</string> 
+         <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/167250082/10002</string> 
         </void> 
         <void property="listTasks"> 
          <object idref="ArrayList0"/> 
@@ -690,7 +690,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/srcbucket</string> 
+            <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/srcbucket</string> 
            </void> 
           </object> 
          </void> 
@@ -729,7 +729,7 @@
                            <int>1</int> 
                           </void> 
                           <void property="dirName"> 
-                           <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1002712615/10002</string> 
+                           <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/167250082/10002</string> 
                           </void> 
                           <void property="tableInfo"> 
                            <object idref="tableDesc0"/> 
@@ -739,18 +739,18 @@
                         <void property="counterNames"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <string>CNTR_NAME_FS_597_NUM_INPUT_ROWS</string> 
+                           <string>CNTR_NAME_FS_599_NUM_INPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_FS_597_NUM_OUTPUT_ROWS</string> 
+                           <string>CNTR_NAME_FS_599_NUM_OUTPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_FS_597_TIME_TAKEN</string> 
+                           <string>CNTR_NAME_FS_599_TIME_TAKEN</string> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="operatorId"> 
-                         <string>FS_597</string> 
+                         <string>FS_599</string> 
                         </void> 
                         <void property="parentOperators"> 
                          <object class="java.util.ArrayList"> 
@@ -828,18 +828,18 @@
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_596_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_SEL_598_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_596_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_SEL_598_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_596_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_SEL_598_TIME_TAKEN</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>SEL_596</string> 
+                     <string>SEL_598</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
@@ -1023,18 +1023,18 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_595_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_FIL_597_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_595_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_FIL_597_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_595_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_FIL_597_TIME_TAKEN</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>FIL_595</string> 
+                 <string>FIL_597</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -1183,18 +1183,18 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_598_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_600_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_598_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_600_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_598_TIME_TAKEN</string> 
+               <string>CNTR_NAME_FIL_600_TIME_TAKEN</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>FIL_598</string> 
+             <string>FIL_600</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -1245,13 +1245,13 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_594_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_596_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_594_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_596_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_594_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_596_TIME_TAKEN</string> 
           </void> 
          </object> 
         </void> 
@@ -1266,7 +1266,7 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_594</string> 
+         <string>TS_596</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -1282,7 +1282,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt</string> 
+       <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>s</string> 
@@ -1294,7 +1294,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt</string> 
+       <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/sample3.q.xml b/ql/src/test/results/compiler/plan/sample3.q.xml
index 4238ea3b16..8466b537fd 100644
--- a/ql/src/test/results/compiler/plan/sample3.q.xml
+++ b/ql/src/test/results/compiler/plan/sample3.q.xml
@@ -30,7 +30,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/734209432/10000</string> 
+               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/791897465/10000</string> 
               </void> 
               <void property="table"> 
                <object id="tableDesc0" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -83,7 +83,7 @@
                   </void> 
                   <void method="put"> 
                    <string>location</string> 
-                   <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/dest1</string> 
+                   <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/dest1</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -93,7 +93,7 @@
                </object> 
               </void> 
               <void property="tmpDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/734209432/10001</string> 
+               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/791897465/10001</string> 
               </void> 
              </object> 
             </void> 
@@ -121,10 +121,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1063043777/10002</string> 
+               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/1975254855/10002</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/734209432/10000</string> 
+               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/791897465/10000</string> 
               </void> 
              </object> 
             </void> 
@@ -142,7 +142,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1063043777/10002</string> 
+               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/1975254855/10002</string> 
                <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -297,18 +297,18 @@
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_618_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_RS_620_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_618_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_RS_620_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_618_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_RS_620_TIME_TAKEN</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>RS_618</string> 
+                     <string>RS_620</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
@@ -352,18 +352,18 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_TS_617_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_TS_619_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_TS_617_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_TS_619_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_TS_617_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_TS_619_TIME_TAKEN</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>TS_617</string> 
+                 <string>TS_619</string> 
                 </void> 
                 <void property="schema"> 
                  <object idref="RowSchema0"/> 
@@ -381,10 +381,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1063043777/10002</string> 
+               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/1975254855/10002</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1063043777/10002</string> 
+                 <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/1975254855/10002</string> 
                 </void> 
                </object> 
               </void> 
@@ -393,7 +393,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1063043777/10002</string> 
+               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/1975254855/10002</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object idref="tableDesc0"/> 
@@ -411,7 +411,7 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/734209432/10000</string> 
+                     <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/791897465/10000</string> 
                     </void> 
                     <void property="tableInfo"> 
                      <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -460,7 +460,7 @@
                         </void> 
                         <void method="put"> 
                          <string>location</string> 
-                         <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/dest1</string> 
+                         <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/dest1</string> 
                         </void> 
                         <void method="put"> 
                          <string>file.outputformat</string> 
@@ -478,18 +478,18 @@
                   <void property="counterNames"> 
                    <object class="java.util.ArrayList"> 
                     <void method="add"> 
-                     <string>CNTR_NAME_FS_620_NUM_INPUT_ROWS</string> 
+                     <string>CNTR_NAME_FS_622_NUM_INPUT_ROWS</string> 
                     </void> 
                     <void method="add"> 
-                     <string>CNTR_NAME_FS_620_NUM_OUTPUT_ROWS</string> 
+                     <string>CNTR_NAME_FS_622_NUM_OUTPUT_ROWS</string> 
                     </void> 
                     <void method="add"> 
-                     <string>CNTR_NAME_FS_620_TIME_TAKEN</string> 
+                     <string>CNTR_NAME_FS_622_TIME_TAKEN</string> 
                     </void> 
                    </object> 
                   </void> 
                   <void property="operatorId"> 
-                   <string>FS_620</string> 
+                   <string>FS_622</string> 
                   </void> 
                   <void property="parentOperators"> 
                    <object class="java.util.ArrayList"> 
@@ -525,18 +525,18 @@
               <void property="counterNames"> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>CNTR_NAME_OP_619_NUM_INPUT_ROWS</string> 
+                 <string>CNTR_NAME_OP_621_NUM_INPUT_ROWS</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_OP_619_NUM_OUTPUT_ROWS</string> 
+                 <string>CNTR_NAME_OP_621_NUM_OUTPUT_ROWS</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_OP_619_TIME_TAKEN</string> 
+                 <string>CNTR_NAME_OP_621_TIME_TAKEN</string> 
                 </void> 
                </object> 
               </void> 
               <void property="operatorId"> 
-               <string>OP_619</string> 
+               <string>OP_621</string> 
               </void> 
               <void property="schema"> 
                <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -598,7 +598,7 @@
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
         <void property="dir"> 
-         <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1063043777/10002</string> 
+         <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/1975254855/10002</string> 
         </void> 
         <void property="listTasks"> 
          <object idref="ArrayList0"/> 
@@ -690,7 +690,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/srcbucket</string> 
+            <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/srcbucket</string> 
            </void> 
           </object> 
          </void> 
@@ -729,7 +729,7 @@
                            <int>1</int> 
                           </void> 
                           <void property="dirName"> 
-                           <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1063043777/10002</string> 
+                           <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/1975254855/10002</string> 
                           </void> 
                           <void property="tableInfo"> 
                            <object idref="tableDesc0"/> 
@@ -739,18 +739,18 @@
                         <void property="counterNames"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <string>CNTR_NAME_FS_615_NUM_INPUT_ROWS</string> 
+                           <string>CNTR_NAME_FS_617_NUM_INPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_FS_615_NUM_OUTPUT_ROWS</string> 
+                           <string>CNTR_NAME_FS_617_NUM_OUTPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_FS_615_TIME_TAKEN</string> 
+                           <string>CNTR_NAME_FS_617_TIME_TAKEN</string> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="operatorId"> 
-                         <string>FS_615</string> 
+                         <string>FS_617</string> 
                         </void> 
                         <void property="parentOperators"> 
                          <object class="java.util.ArrayList"> 
@@ -828,18 +828,18 @@
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_614_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_SEL_616_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_614_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_SEL_616_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_614_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_SEL_616_TIME_TAKEN</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>SEL_614</string> 
+                     <string>SEL_616</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
@@ -1036,18 +1036,18 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_613_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_FIL_615_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_613_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_FIL_615_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_613_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_FIL_615_TIME_TAKEN</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>FIL_613</string> 
+                 <string>FIL_615</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -1209,18 +1209,18 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_616_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_618_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_616_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_618_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_616_TIME_TAKEN</string> 
+               <string>CNTR_NAME_FIL_618_TIME_TAKEN</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>FIL_616</string> 
+             <string>FIL_618</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -1271,13 +1271,13 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_612_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_614_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_612_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_614_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_612_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_614_TIME_TAKEN</string> 
           </void> 
          </object> 
         </void> 
@@ -1292,7 +1292,7 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_612</string> 
+         <string>TS_614</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -1308,7 +1308,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/srcbucket</string> 
+       <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/srcbucket</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>s</string> 
@@ -1320,7 +1320,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/srcbucket</string> 
+       <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/srcbucket</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/sample4.q.xml b/ql/src/test/results/compiler/plan/sample4.q.xml
index 92784acd21..16bf605f17 100644
--- a/ql/src/test/results/compiler/plan/sample4.q.xml
+++ b/ql/src/test/results/compiler/plan/sample4.q.xml
@@ -30,7 +30,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/292664478/10000</string> 
+               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/695466623/10000</string> 
               </void> 
               <void property="table"> 
                <object id="tableDesc0" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -83,7 +83,7 @@
                   </void> 
                   <void method="put"> 
                    <string>location</string> 
-                   <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/dest1</string> 
+                   <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/dest1</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -93,7 +93,7 @@
                </object> 
               </void> 
               <void property="tmpDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/292664478/10001</string> 
+               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/695466623/10001</string> 
               </void> 
              </object> 
             </void> 
@@ -121,10 +121,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/161655150/10002</string> 
+               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/220902403/10002</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/292664478/10000</string> 
+               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/695466623/10000</string> 
               </void> 
              </object> 
             </void> 
@@ -142,7 +142,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/161655150/10002</string> 
+               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/220902403/10002</string> 
                <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -297,18 +297,18 @@
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_636_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_RS_638_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_636_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_RS_638_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_636_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_RS_638_TIME_TAKEN</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>RS_636</string> 
+                     <string>RS_638</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
@@ -352,18 +352,18 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_TS_635_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_TS_637_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_TS_635_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_TS_637_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_TS_635_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_TS_637_TIME_TAKEN</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>TS_635</string> 
+                 <string>TS_637</string> 
                 </void> 
                 <void property="schema"> 
                  <object idref="RowSchema0"/> 
@@ -381,10 +381,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/161655150/10002</string> 
+               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/220902403/10002</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/161655150/10002</string> 
+                 <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/220902403/10002</string> 
                 </void> 
                </object> 
               </void> 
@@ -393,7 +393,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/161655150/10002</string> 
+               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/220902403/10002</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object idref="tableDesc0"/> 
@@ -411,7 +411,7 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/292664478/10000</string> 
+                     <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/695466623/10000</string> 
                     </void> 
                     <void property="tableInfo"> 
                      <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -460,7 +460,7 @@
                         </void> 
                         <void method="put"> 
                          <string>location</string> 
-                         <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/dest1</string> 
+                         <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/dest1</string> 
                         </void> 
                         <void method="put"> 
                          <string>file.outputformat</string> 
@@ -478,18 +478,18 @@
                   <void property="counterNames"> 
                    <object class="java.util.ArrayList"> 
                     <void method="add"> 
-                     <string>CNTR_NAME_FS_638_NUM_INPUT_ROWS</string> 
+                     <string>CNTR_NAME_FS_640_NUM_INPUT_ROWS</string> 
                     </void> 
                     <void method="add"> 
-                     <string>CNTR_NAME_FS_638_NUM_OUTPUT_ROWS</string> 
+                     <string>CNTR_NAME_FS_640_NUM_OUTPUT_ROWS</string> 
                     </void> 
                     <void method="add"> 
-                     <string>CNTR_NAME_FS_638_TIME_TAKEN</string> 
+                     <string>CNTR_NAME_FS_640_TIME_TAKEN</string> 
                     </void> 
                    </object> 
                   </void> 
                   <void property="operatorId"> 
-                   <string>FS_638</string> 
+                   <string>FS_640</string> 
                   </void> 
                   <void property="parentOperators"> 
                    <object class="java.util.ArrayList"> 
@@ -525,18 +525,18 @@
               <void property="counterNames"> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>CNTR_NAME_OP_637_NUM_INPUT_ROWS</string> 
+                 <string>CNTR_NAME_OP_639_NUM_INPUT_ROWS</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_OP_637_NUM_OUTPUT_ROWS</string> 
+                 <string>CNTR_NAME_OP_639_NUM_OUTPUT_ROWS</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_OP_637_TIME_TAKEN</string> 
+                 <string>CNTR_NAME_OP_639_TIME_TAKEN</string> 
                 </void> 
                </object> 
               </void> 
               <void property="operatorId"> 
-               <string>OP_637</string> 
+               <string>OP_639</string> 
               </void> 
               <void property="schema"> 
                <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -598,7 +598,7 @@
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
         <void property="dir"> 
-         <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/161655150/10002</string> 
+         <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/220902403/10002</string> 
         </void> 
         <void property="listTasks"> 
          <object idref="ArrayList0"/> 
@@ -690,7 +690,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/srcbucket</string> 
+            <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/srcbucket</string> 
            </void> 
           </object> 
          </void> 
@@ -729,7 +729,7 @@
                            <int>1</int> 
                           </void> 
                           <void property="dirName"> 
-                           <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/161655150/10002</string> 
+                           <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/220902403/10002</string> 
                           </void> 
                           <void property="tableInfo"> 
                            <object idref="tableDesc0"/> 
@@ -739,18 +739,18 @@
                         <void property="counterNames"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <string>CNTR_NAME_FS_633_NUM_INPUT_ROWS</string> 
+                           <string>CNTR_NAME_FS_635_NUM_INPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_FS_633_NUM_OUTPUT_ROWS</string> 
+                           <string>CNTR_NAME_FS_635_NUM_OUTPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_FS_633_TIME_TAKEN</string> 
+                           <string>CNTR_NAME_FS_635_TIME_TAKEN</string> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="operatorId"> 
-                         <string>FS_633</string> 
+                         <string>FS_635</string> 
                         </void> 
                         <void property="parentOperators"> 
                          <object class="java.util.ArrayList"> 
@@ -828,18 +828,18 @@
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_632_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_SEL_634_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_632_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_SEL_634_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_632_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_SEL_634_TIME_TAKEN</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>SEL_632</string> 
+                     <string>SEL_634</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
@@ -1023,18 +1023,18 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_631_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_FIL_633_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_631_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_FIL_633_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_631_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_FIL_633_TIME_TAKEN</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>FIL_631</string> 
+                 <string>FIL_633</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -1183,18 +1183,18 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_634_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_636_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_634_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_636_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_634_TIME_TAKEN</string> 
+               <string>CNTR_NAME_FIL_636_TIME_TAKEN</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>FIL_634</string> 
+             <string>FIL_636</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -1245,13 +1245,13 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_630_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_632_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_630_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_632_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_630_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_632_TIME_TAKEN</string> 
           </void> 
          </object> 
         </void> 
@@ -1266,7 +1266,7 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_630</string> 
+         <string>TS_632</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -1282,7 +1282,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt</string> 
+       <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>s</string> 
@@ -1294,7 +1294,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt</string> 
+       <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/sample5.q.xml b/ql/src/test/results/compiler/plan/sample5.q.xml
index 67c513363e..49a3a2f339 100644
--- a/ql/src/test/results/compiler/plan/sample5.q.xml
+++ b/ql/src/test/results/compiler/plan/sample5.q.xml
@@ -30,7 +30,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/2006715948/10000</string> 
+               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/917848549/10000</string> 
               </void> 
               <void property="table"> 
                <object id="tableDesc0" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -83,7 +83,7 @@
                   </void> 
                   <void method="put"> 
                    <string>location</string> 
-                   <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/dest1</string> 
+                   <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/dest1</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -93,7 +93,7 @@
                </object> 
               </void> 
               <void property="tmpDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/2006715948/10001</string> 
+               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/917848549/10001</string> 
               </void> 
              </object> 
             </void> 
@@ -121,10 +121,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1315180991/10002</string> 
+               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/14505375/10002</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/2006715948/10000</string> 
+               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/917848549/10000</string> 
               </void> 
              </object> 
             </void> 
@@ -142,7 +142,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1315180991/10002</string> 
+               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/14505375/10002</string> 
                <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -297,18 +297,18 @@
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_654_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_RS_656_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_654_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_RS_656_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_654_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_RS_656_TIME_TAKEN</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>RS_654</string> 
+                     <string>RS_656</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
@@ -352,18 +352,18 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_TS_653_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_TS_655_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_TS_653_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_TS_655_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_TS_653_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_TS_655_TIME_TAKEN</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>TS_653</string> 
+                 <string>TS_655</string> 
                 </void> 
                 <void property="schema"> 
                  <object idref="RowSchema0"/> 
@@ -381,10 +381,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1315180991/10002</string> 
+               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/14505375/10002</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1315180991/10002</string> 
+                 <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/14505375/10002</string> 
                 </void> 
                </object> 
               </void> 
@@ -393,7 +393,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1315180991/10002</string> 
+               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/14505375/10002</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object idref="tableDesc0"/> 
@@ -411,7 +411,7 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/2006715948/10000</string> 
+                     <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/917848549/10000</string> 
                     </void> 
                     <void property="tableInfo"> 
                      <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -460,7 +460,7 @@
                         </void> 
                         <void method="put"> 
                          <string>location</string> 
-                         <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/dest1</string> 
+                         <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/dest1</string> 
                         </void> 
                         <void method="put"> 
                          <string>file.outputformat</string> 
@@ -478,18 +478,18 @@
                   <void property="counterNames"> 
                    <object class="java.util.ArrayList"> 
                     <void method="add"> 
-                     <string>CNTR_NAME_FS_656_NUM_INPUT_ROWS</string> 
+                     <string>CNTR_NAME_FS_658_NUM_INPUT_ROWS</string> 
                     </void> 
                     <void method="add"> 
-                     <string>CNTR_NAME_FS_656_NUM_OUTPUT_ROWS</string> 
+                     <string>CNTR_NAME_FS_658_NUM_OUTPUT_ROWS</string> 
                     </void> 
                     <void method="add"> 
-                     <string>CNTR_NAME_FS_656_TIME_TAKEN</string> 
+                     <string>CNTR_NAME_FS_658_TIME_TAKEN</string> 
                     </void> 
                    </object> 
                   </void> 
                   <void property="operatorId"> 
-                   <string>FS_656</string> 
+                   <string>FS_658</string> 
                   </void> 
                   <void property="parentOperators"> 
                    <object class="java.util.ArrayList"> 
@@ -525,18 +525,18 @@
               <void property="counterNames"> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>CNTR_NAME_OP_655_NUM_INPUT_ROWS</string> 
+                 <string>CNTR_NAME_OP_657_NUM_INPUT_ROWS</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_OP_655_NUM_OUTPUT_ROWS</string> 
+                 <string>CNTR_NAME_OP_657_NUM_OUTPUT_ROWS</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_OP_655_TIME_TAKEN</string> 
+                 <string>CNTR_NAME_OP_657_TIME_TAKEN</string> 
                 </void> 
                </object> 
               </void> 
               <void property="operatorId"> 
-               <string>OP_655</string> 
+               <string>OP_657</string> 
               </void> 
               <void property="schema"> 
                <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -598,7 +598,7 @@
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
         <void property="dir"> 
-         <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1315180991/10002</string> 
+         <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/14505375/10002</string> 
         </void> 
         <void property="listTasks"> 
          <object idref="ArrayList0"/> 
@@ -690,7 +690,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/srcbucket</string> 
+            <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/srcbucket</string> 
            </void> 
           </object> 
          </void> 
@@ -729,7 +729,7 @@
                            <int>1</int> 
                           </void> 
                           <void property="dirName"> 
-                           <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1315180991/10002</string> 
+                           <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/14505375/10002</string> 
                           </void> 
                           <void property="tableInfo"> 
                            <object idref="tableDesc0"/> 
@@ -739,18 +739,18 @@
                         <void property="counterNames"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <string>CNTR_NAME_FS_651_NUM_INPUT_ROWS</string> 
+                           <string>CNTR_NAME_FS_653_NUM_INPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_FS_651_NUM_OUTPUT_ROWS</string> 
+                           <string>CNTR_NAME_FS_653_NUM_OUTPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_FS_651_TIME_TAKEN</string> 
+                           <string>CNTR_NAME_FS_653_TIME_TAKEN</string> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="operatorId"> 
-                         <string>FS_651</string> 
+                         <string>FS_653</string> 
                         </void> 
                         <void property="parentOperators"> 
                          <object class="java.util.ArrayList"> 
@@ -828,18 +828,18 @@
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_650_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_SEL_652_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_650_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_SEL_652_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_650_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_SEL_652_TIME_TAKEN</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>SEL_650</string> 
+                     <string>SEL_652</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
@@ -1023,18 +1023,18 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_649_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_FIL_651_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_649_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_FIL_651_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_649_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_FIL_651_TIME_TAKEN</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>FIL_649</string> 
+                 <string>FIL_651</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -1183,18 +1183,18 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_652_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_654_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_652_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_654_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_652_TIME_TAKEN</string> 
+               <string>CNTR_NAME_FIL_654_TIME_TAKEN</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>FIL_652</string> 
+             <string>FIL_654</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -1245,13 +1245,13 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_648_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_650_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_648_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_650_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_648_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_650_TIME_TAKEN</string> 
           </void> 
          </object> 
         </void> 
@@ -1266,7 +1266,7 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_648</string> 
+         <string>TS_650</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -1282,7 +1282,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/srcbucket</string> 
+       <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/srcbucket</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>s</string> 
@@ -1294,7 +1294,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/srcbucket</string> 
+       <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/srcbucket</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/sample6.q.xml b/ql/src/test/results/compiler/plan/sample6.q.xml
index e6fb572581..c3bbf4a8b7 100644
--- a/ql/src/test/results/compiler/plan/sample6.q.xml
+++ b/ql/src/test/results/compiler/plan/sample6.q.xml
@@ -30,7 +30,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1884959109/10000</string> 
+               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/683410141/10000</string> 
               </void> 
               <void property="table"> 
                <object id="tableDesc0" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -83,7 +83,7 @@
                   </void> 
                   <void method="put"> 
                    <string>location</string> 
-                   <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/dest1</string> 
+                   <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/dest1</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -93,7 +93,7 @@
                </object> 
               </void> 
               <void property="tmpDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1884959109/10001</string> 
+               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/683410141/10001</string> 
               </void> 
              </object> 
             </void> 
@@ -121,10 +121,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/2123224197/10002</string> 
+               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/882760644/10002</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1884959109/10000</string> 
+               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/683410141/10000</string> 
               </void> 
              </object> 
             </void> 
@@ -142,7 +142,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/2123224197/10002</string> 
+               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/882760644/10002</string> 
                <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -297,18 +297,18 @@
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_672_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_RS_674_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_672_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_RS_674_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_672_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_RS_674_TIME_TAKEN</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>RS_672</string> 
+                     <string>RS_674</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
@@ -352,18 +352,18 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_TS_671_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_TS_673_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_TS_671_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_TS_673_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_TS_671_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_TS_673_TIME_TAKEN</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>TS_671</string> 
+                 <string>TS_673</string> 
                 </void> 
                 <void property="schema"> 
                  <object idref="RowSchema0"/> 
@@ -381,10 +381,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/2123224197/10002</string> 
+               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/882760644/10002</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/2123224197/10002</string> 
+                 <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/882760644/10002</string> 
                 </void> 
                </object> 
               </void> 
@@ -393,7 +393,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/2123224197/10002</string> 
+               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/882760644/10002</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object idref="tableDesc0"/> 
@@ -411,7 +411,7 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1884959109/10000</string> 
+                     <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/683410141/10000</string> 
                     </void> 
                     <void property="tableInfo"> 
                      <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -460,7 +460,7 @@
                         </void> 
                         <void method="put"> 
                          <string>location</string> 
-                         <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/dest1</string> 
+                         <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/dest1</string> 
                         </void> 
                         <void method="put"> 
                          <string>file.outputformat</string> 
@@ -478,18 +478,18 @@
                   <void property="counterNames"> 
                    <object class="java.util.ArrayList"> 
                     <void method="add"> 
-                     <string>CNTR_NAME_FS_674_NUM_INPUT_ROWS</string> 
+                     <string>CNTR_NAME_FS_676_NUM_INPUT_ROWS</string> 
                     </void> 
                     <void method="add"> 
-                     <string>CNTR_NAME_FS_674_NUM_OUTPUT_ROWS</string> 
+                     <string>CNTR_NAME_FS_676_NUM_OUTPUT_ROWS</string> 
                     </void> 
                     <void method="add"> 
-                     <string>CNTR_NAME_FS_674_TIME_TAKEN</string> 
+                     <string>CNTR_NAME_FS_676_TIME_TAKEN</string> 
                     </void> 
                    </object> 
                   </void> 
                   <void property="operatorId"> 
-                   <string>FS_674</string> 
+                   <string>FS_676</string> 
                   </void> 
                   <void property="parentOperators"> 
                    <object class="java.util.ArrayList"> 
@@ -525,18 +525,18 @@
               <void property="counterNames"> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>CNTR_NAME_OP_673_NUM_INPUT_ROWS</string> 
+                 <string>CNTR_NAME_OP_675_NUM_INPUT_ROWS</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_OP_673_NUM_OUTPUT_ROWS</string> 
+                 <string>CNTR_NAME_OP_675_NUM_OUTPUT_ROWS</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_OP_673_TIME_TAKEN</string> 
+                 <string>CNTR_NAME_OP_675_TIME_TAKEN</string> 
                 </void> 
                </object> 
               </void> 
               <void property="operatorId"> 
-               <string>OP_673</string> 
+               <string>OP_675</string> 
               </void> 
               <void property="schema"> 
                <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -598,7 +598,7 @@
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
         <void property="dir"> 
-         <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/2123224197/10002</string> 
+         <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/882760644/10002</string> 
         </void> 
         <void property="listTasks"> 
          <object idref="ArrayList0"/> 
@@ -690,7 +690,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/srcbucket</string> 
+            <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/srcbucket</string> 
            </void> 
           </object> 
          </void> 
@@ -729,7 +729,7 @@
                            <int>1</int> 
                           </void> 
                           <void property="dirName"> 
-                           <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/2123224197/10002</string> 
+                           <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/882760644/10002</string> 
                           </void> 
                           <void property="tableInfo"> 
                            <object idref="tableDesc0"/> 
@@ -739,18 +739,18 @@
                         <void property="counterNames"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <string>CNTR_NAME_FS_669_NUM_INPUT_ROWS</string> 
+                           <string>CNTR_NAME_FS_671_NUM_INPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_FS_669_NUM_OUTPUT_ROWS</string> 
+                           <string>CNTR_NAME_FS_671_NUM_OUTPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_FS_669_TIME_TAKEN</string> 
+                           <string>CNTR_NAME_FS_671_TIME_TAKEN</string> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="operatorId"> 
-                         <string>FS_669</string> 
+                         <string>FS_671</string> 
                         </void> 
                         <void property="parentOperators"> 
                          <object class="java.util.ArrayList"> 
@@ -828,18 +828,18 @@
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_668_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_SEL_670_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_668_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_SEL_670_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_668_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_SEL_670_TIME_TAKEN</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>SEL_668</string> 
+                     <string>SEL_670</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
@@ -1023,18 +1023,18 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_667_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_FIL_669_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_667_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_FIL_669_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_667_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_FIL_669_TIME_TAKEN</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>FIL_667</string> 
+                 <string>FIL_669</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -1183,18 +1183,18 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_670_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_672_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_670_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_672_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_670_TIME_TAKEN</string> 
+               <string>CNTR_NAME_FIL_672_TIME_TAKEN</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>FIL_670</string> 
+             <string>FIL_672</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -1245,13 +1245,13 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_666_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_668_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_666_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_668_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_666_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_668_TIME_TAKEN</string> 
           </void> 
          </object> 
         </void> 
@@ -1266,7 +1266,7 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_666</string> 
+         <string>TS_668</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -1282,7 +1282,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt</string> 
+       <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>s</string> 
@@ -1294,7 +1294,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt</string> 
+       <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/sample7.q.xml b/ql/src/test/results/compiler/plan/sample7.q.xml
index 3a77e723e5..bcd7dc73f3 100644
--- a/ql/src/test/results/compiler/plan/sample7.q.xml
+++ b/ql/src/test/results/compiler/plan/sample7.q.xml
@@ -30,7 +30,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1973457055/10000</string> 
+               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/784372020/10000</string> 
               </void> 
               <void property="table"> 
                <object id="tableDesc0" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -83,7 +83,7 @@
                   </void> 
                   <void method="put"> 
                    <string>location</string> 
-                   <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/dest1</string> 
+                   <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/dest1</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -93,7 +93,7 @@
                </object> 
               </void> 
               <void property="tmpDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1973457055/10001</string> 
+               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/784372020/10001</string> 
               </void> 
              </object> 
             </void> 
@@ -121,10 +121,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/152918267/10002</string> 
+               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/1981208075/10002</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1973457055/10000</string> 
+               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/784372020/10000</string> 
               </void> 
              </object> 
             </void> 
@@ -142,7 +142,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/152918267/10002</string> 
+               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/1981208075/10002</string> 
                <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -297,18 +297,18 @@
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_691_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_RS_693_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_691_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_RS_693_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_691_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_RS_693_TIME_TAKEN</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>RS_691</string> 
+                     <string>RS_693</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
@@ -352,18 +352,18 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_TS_690_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_TS_692_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_TS_690_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_TS_692_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_TS_690_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_TS_692_TIME_TAKEN</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>TS_690</string> 
+                 <string>TS_692</string> 
                 </void> 
                 <void property="schema"> 
                  <object idref="RowSchema0"/> 
@@ -381,10 +381,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/152918267/10002</string> 
+               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/1981208075/10002</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/152918267/10002</string> 
+                 <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/1981208075/10002</string> 
                 </void> 
                </object> 
               </void> 
@@ -393,7 +393,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/152918267/10002</string> 
+               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/1981208075/10002</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object idref="tableDesc0"/> 
@@ -411,7 +411,7 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1973457055/10000</string> 
+                     <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/784372020/10000</string> 
                     </void> 
                     <void property="tableInfo"> 
                      <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -460,7 +460,7 @@
                         </void> 
                         <void method="put"> 
                          <string>location</string> 
-                         <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/dest1</string> 
+                         <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/dest1</string> 
                         </void> 
                         <void method="put"> 
                          <string>file.outputformat</string> 
@@ -478,18 +478,18 @@
                   <void property="counterNames"> 
                    <object class="java.util.ArrayList"> 
                     <void method="add"> 
-                     <string>CNTR_NAME_FS_693_NUM_INPUT_ROWS</string> 
+                     <string>CNTR_NAME_FS_695_NUM_INPUT_ROWS</string> 
                     </void> 
                     <void method="add"> 
-                     <string>CNTR_NAME_FS_693_NUM_OUTPUT_ROWS</string> 
+                     <string>CNTR_NAME_FS_695_NUM_OUTPUT_ROWS</string> 
                     </void> 
                     <void method="add"> 
-                     <string>CNTR_NAME_FS_693_TIME_TAKEN</string> 
+                     <string>CNTR_NAME_FS_695_TIME_TAKEN</string> 
                     </void> 
                    </object> 
                   </void> 
                   <void property="operatorId"> 
-                   <string>FS_693</string> 
+                   <string>FS_695</string> 
                   </void> 
                   <void property="parentOperators"> 
                    <object class="java.util.ArrayList"> 
@@ -525,18 +525,18 @@
               <void property="counterNames"> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>CNTR_NAME_OP_692_NUM_INPUT_ROWS</string> 
+                 <string>CNTR_NAME_OP_694_NUM_INPUT_ROWS</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_OP_692_NUM_OUTPUT_ROWS</string> 
+                 <string>CNTR_NAME_OP_694_NUM_OUTPUT_ROWS</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_OP_692_TIME_TAKEN</string> 
+                 <string>CNTR_NAME_OP_694_TIME_TAKEN</string> 
                 </void> 
                </object> 
               </void> 
               <void property="operatorId"> 
-               <string>OP_692</string> 
+               <string>OP_694</string> 
               </void> 
               <void property="schema"> 
                <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -598,7 +598,7 @@
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
         <void property="dir"> 
-         <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/152918267/10002</string> 
+         <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/1981208075/10002</string> 
         </void> 
         <void property="listTasks"> 
          <object idref="ArrayList0"/> 
@@ -690,7 +690,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/srcbucket</string> 
+            <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/srcbucket</string> 
            </void> 
           </object> 
          </void> 
@@ -733,7 +733,7 @@
                                <int>1</int> 
                               </void> 
                               <void property="dirName"> 
-                               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/152918267/10002</string> 
+                               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/1981208075/10002</string> 
                               </void> 
                               <void property="tableInfo"> 
                                <object idref="tableDesc0"/> 
@@ -743,18 +743,18 @@
                             <void property="counterNames"> 
                              <object class="java.util.ArrayList"> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_688_NUM_INPUT_ROWS</string> 
+                               <string>CNTR_NAME_FS_690_NUM_INPUT_ROWS</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_688_NUM_OUTPUT_ROWS</string> 
+                               <string>CNTR_NAME_FS_690_NUM_OUTPUT_ROWS</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_688_TIME_TAKEN</string> 
+                               <string>CNTR_NAME_FS_690_TIME_TAKEN</string> 
                               </void> 
                              </object> 
                             </void> 
                             <void property="operatorId"> 
-                             <string>FS_688</string> 
+                             <string>FS_690</string> 
                             </void> 
                             <void property="parentOperators"> 
                              <object class="java.util.ArrayList"> 
@@ -832,18 +832,18 @@
                         <void property="counterNames"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <string>CNTR_NAME_SEL_687_NUM_INPUT_ROWS</string> 
+                           <string>CNTR_NAME_SEL_689_NUM_INPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_SEL_687_NUM_OUTPUT_ROWS</string> 
+                           <string>CNTR_NAME_SEL_689_NUM_OUTPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_SEL_687_TIME_TAKEN</string> 
+                           <string>CNTR_NAME_SEL_689_TIME_TAKEN</string> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="operatorId"> 
-                         <string>SEL_687</string> 
+                         <string>SEL_689</string> 
                         </void> 
                         <void property="parentOperators"> 
                          <object class="java.util.ArrayList"> 
@@ -942,18 +942,18 @@
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_FIL_686_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_FIL_688_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_FIL_686_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_FIL_688_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_FIL_686_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_FIL_688_TIME_TAKEN</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>FIL_686</string> 
+                     <string>FIL_688</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
@@ -1133,18 +1133,18 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_685_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_FIL_687_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_685_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_FIL_687_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_685_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_FIL_687_TIME_TAKEN</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>FIL_685</string> 
+                 <string>FIL_687</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -1364,18 +1364,18 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_689_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_691_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_689_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_691_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_689_TIME_TAKEN</string> 
+               <string>CNTR_NAME_FIL_691_TIME_TAKEN</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>FIL_689</string> 
+             <string>FIL_691</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -1405,13 +1405,13 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_684_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_686_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_684_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_686_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_684_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_686_TIME_TAKEN</string> 
           </void> 
          </object> 
         </void> 
@@ -1426,7 +1426,7 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_684</string> 
+         <string>TS_686</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -1442,7 +1442,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt</string> 
+       <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>s</string> 
@@ -1454,7 +1454,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt</string> 
+       <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/srcbucket/srcbucket0.txt</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/subq.q.xml b/ql/src/test/results/compiler/plan/subq.q.xml
index 8cdbaa8b73..01bf1cef04 100644
--- a/ql/src/test/results/compiler/plan/subq.q.xml
+++ b/ql/src/test/results/compiler/plan/subq.q.xml
@@ -33,7 +33,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1850561142/10000</string> 
+               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/1624300708/10000</string> 
               </void> 
               <void property="targetDir"> 
                <string>../build/ql/test/data/warehouse/union.out</string> 
@@ -64,10 +64,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1504317643/10001</string> 
+               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/1489100751/10001</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1850561142/10000</string> 
+               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/1624300708/10000</string> 
               </void> 
              </object> 
             </void> 
@@ -85,7 +85,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1504317643/10001</string> 
+               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/1489100751/10001</string> 
                <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -240,18 +240,18 @@
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_711_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_RS_713_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_711_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_RS_713_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_711_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_RS_713_TIME_TAKEN</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>RS_711</string> 
+                     <string>RS_713</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
@@ -295,18 +295,18 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_TS_710_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_TS_712_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_TS_710_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_TS_712_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_TS_710_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_TS_712_TIME_TAKEN</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>TS_710</string> 
+                 <string>TS_712</string> 
                 </void> 
                 <void property="schema"> 
                  <object idref="RowSchema0"/> 
@@ -324,10 +324,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1504317643/10001</string> 
+               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/1489100751/10001</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1504317643/10001</string> 
+                 <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/1489100751/10001</string> 
                 </void> 
                </object> 
               </void> 
@@ -336,7 +336,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1504317643/10001</string> 
+               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/1489100751/10001</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object id="tableDesc2" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -380,7 +380,7 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1850561142/10000</string> 
+                     <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/1624300708/10000</string> 
                     </void> 
                     <void property="tableInfo"> 
                      <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -416,18 +416,18 @@
                   <void property="counterNames"> 
                    <object class="java.util.ArrayList"> 
                     <void method="add"> 
-                     <string>CNTR_NAME_FS_713_NUM_INPUT_ROWS</string> 
+                     <string>CNTR_NAME_FS_715_NUM_INPUT_ROWS</string> 
                     </void> 
                     <void method="add"> 
-                     <string>CNTR_NAME_FS_713_NUM_OUTPUT_ROWS</string> 
+                     <string>CNTR_NAME_FS_715_NUM_OUTPUT_ROWS</string> 
                     </void> 
                     <void method="add"> 
-                     <string>CNTR_NAME_FS_713_TIME_TAKEN</string> 
+                     <string>CNTR_NAME_FS_715_TIME_TAKEN</string> 
                     </void> 
                    </object> 
                   </void> 
                   <void property="operatorId"> 
-                   <string>FS_713</string> 
+                   <string>FS_715</string> 
                   </void> 
                   <void property="parentOperators"> 
                    <object class="java.util.ArrayList"> 
@@ -463,18 +463,18 @@
               <void property="counterNames"> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>CNTR_NAME_OP_712_NUM_INPUT_ROWS</string> 
+                 <string>CNTR_NAME_OP_714_NUM_INPUT_ROWS</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_OP_712_NUM_OUTPUT_ROWS</string> 
+                 <string>CNTR_NAME_OP_714_NUM_OUTPUT_ROWS</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_OP_712_TIME_TAKEN</string> 
+                 <string>CNTR_NAME_OP_714_TIME_TAKEN</string> 
                 </void> 
                </object> 
               </void> 
               <void property="operatorId"> 
-               <string>OP_712</string> 
+               <string>OP_714</string> 
               </void> 
               <void property="schema"> 
                <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -532,7 +532,7 @@
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
         <void property="dir"> 
-         <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1504317643/10001</string> 
+         <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/1489100751/10001</string> 
         </void> 
         <void property="listTasks"> 
          <object idref="ArrayList0"/> 
@@ -620,7 +620,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/src</string> 
+            <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/src</string> 
            </void> 
           </object> 
          </void> 
@@ -663,7 +663,7 @@
                                <int>1</int> 
                               </void> 
                               <void property="dirName"> 
-                               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1504317643/10001</string> 
+                               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/1489100751/10001</string> 
                               </void> 
                               <void property="tableInfo"> 
                                <object idref="tableDesc2"/> 
@@ -673,18 +673,18 @@
                             <void property="counterNames"> 
                              <object class="java.util.ArrayList"> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_708_NUM_INPUT_ROWS</string> 
+                               <string>CNTR_NAME_FS_710_NUM_INPUT_ROWS</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_708_NUM_OUTPUT_ROWS</string> 
+                               <string>CNTR_NAME_FS_710_NUM_OUTPUT_ROWS</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_FS_708_TIME_TAKEN</string> 
+                               <string>CNTR_NAME_FS_710_TIME_TAKEN</string> 
                               </void> 
                              </object> 
                             </void> 
                             <void property="operatorId"> 
-                             <string>FS_708</string> 
+                             <string>FS_710</string> 
                             </void> 
                             <void property="parentOperators"> 
                              <object class="java.util.ArrayList"> 
@@ -762,18 +762,18 @@
                         <void property="counterNames"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <string>CNTR_NAME_SEL_707_NUM_INPUT_ROWS</string> 
+                           <string>CNTR_NAME_SEL_709_NUM_INPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_SEL_707_NUM_OUTPUT_ROWS</string> 
+                           <string>CNTR_NAME_SEL_709_NUM_OUTPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_SEL_707_TIME_TAKEN</string> 
+                           <string>CNTR_NAME_SEL_709_TIME_TAKEN</string> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="operatorId"> 
-                         <string>SEL_707</string> 
+                         <string>SEL_709</string> 
                         </void> 
                         <void property="parentOperators"> 
                          <object class="java.util.ArrayList"> 
@@ -876,18 +876,18 @@
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_706_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_SEL_708_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_706_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_SEL_708_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_706_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_SEL_708_TIME_TAKEN</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>SEL_706</string> 
+                     <string>SEL_708</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
@@ -990,18 +990,18 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_705_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_FIL_707_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_705_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_FIL_707_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_705_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_FIL_707_TIME_TAKEN</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>FIL_705</string> 
+                 <string>FIL_707</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -1096,18 +1096,18 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_709_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_711_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_709_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_711_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_709_TIME_TAKEN</string> 
+               <string>CNTR_NAME_FIL_711_TIME_TAKEN</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>FIL_709</string> 
+             <string>FIL_711</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -1137,13 +1137,13 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_704_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_706_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_704_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_706_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_704_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_706_TIME_TAKEN</string> 
           </void> 
          </object> 
         </void> 
@@ -1158,7 +1158,7 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_704</string> 
+         <string>TS_706</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -1174,7 +1174,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/src</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>unioninput:src</string> 
@@ -1186,7 +1186,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/src</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/udf1.q.xml b/ql/src/test/results/compiler/plan/udf1.q.xml
index 0389d7f410..5991d387d5 100644
--- a/ql/src/test/results/compiler/plan/udf1.q.xml
+++ b/ql/src/test/results/compiler/plan/udf1.q.xml
@@ -64,7 +64,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/src</string> 
+            <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/src</string> 
            </void> 
           </object> 
          </void> 
@@ -100,7 +100,7 @@
                         <void property="conf"> 
                          <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                           <void property="dirName"> 
-                           <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/605962077/10001</string> 
+                           <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/1903343068/10001</string> 
                           </void> 
                           <void property="tableInfo"> 
                            <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -136,18 +136,18 @@
                         <void property="counterNames"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <string>CNTR_NAME_FS_727_NUM_INPUT_ROWS</string> 
+                           <string>CNTR_NAME_FS_729_NUM_INPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_FS_727_NUM_OUTPUT_ROWS</string> 
+                           <string>CNTR_NAME_FS_729_NUM_OUTPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_FS_727_TIME_TAKEN</string> 
+                           <string>CNTR_NAME_FS_729_TIME_TAKEN</string> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="operatorId"> 
-                         <string>FS_727</string> 
+                         <string>FS_729</string> 
                         </void> 
                         <void property="parentOperators"> 
                          <object class="java.util.ArrayList"> 
@@ -1260,18 +1260,18 @@
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_726_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_SEL_728_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_726_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_SEL_728_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_726_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_SEL_728_TIME_TAKEN</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>SEL_726</string> 
+                     <string>SEL_728</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
@@ -1520,18 +1520,18 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_725_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_FIL_727_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_725_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_FIL_727_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_725_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_FIL_727_TIME_TAKEN</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>FIL_725</string> 
+                 <string>FIL_727</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -1626,18 +1626,18 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_728_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_730_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_728_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_730_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_728_TIME_TAKEN</string> 
+               <string>CNTR_NAME_FIL_730_TIME_TAKEN</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>FIL_728</string> 
+             <string>FIL_730</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -1667,13 +1667,13 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_724_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_726_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_724_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_726_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_724_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_726_TIME_TAKEN</string> 
           </void> 
          </object> 
         </void> 
@@ -1685,7 +1685,7 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_724</string> 
+         <string>TS_726</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -1701,7 +1701,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/src</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>src</string> 
@@ -1713,7 +1713,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/src</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/udf4.q.xml b/ql/src/test/results/compiler/plan/udf4.q.xml
index ab78c14882..a48aaa9b1d 100644
--- a/ql/src/test/results/compiler/plan/udf4.q.xml
+++ b/ql/src/test/results/compiler/plan/udf4.q.xml
@@ -64,7 +64,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/dest1</string> 
+            <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/dest1</string> 
            </void> 
           </object> 
          </void> 
@@ -92,7 +92,7 @@
                 <void property="conf"> 
                  <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                   <void property="dirName"> 
-                   <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1900414590/10001</string> 
+                   <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/981463087/10001</string> 
                   </void> 
                   <void property="tableInfo"> 
                    <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -128,18 +128,18 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FS_736_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_FS_738_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FS_736_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_FS_738_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FS_736_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_FS_738_TIME_TAKEN</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>FS_736</string> 
+                 <string>FS_738</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -1234,18 +1234,18 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_735_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_SEL_737_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_735_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_SEL_737_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_735_TIME_TAKEN</string> 
+               <string>CNTR_NAME_SEL_737_TIME_TAKEN</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>SEL_735</string> 
+             <string>SEL_737</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -1466,13 +1466,13 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_734_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_736_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_734_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_736_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_734_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_736_TIME_TAKEN</string> 
           </void> 
          </object> 
         </void> 
@@ -1480,7 +1480,7 @@
          <object class="java.util.ArrayList"/> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_734</string> 
+         <string>TS_736</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -1521,7 +1521,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/dest1</string> 
+       <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/dest1</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>dest1</string> 
@@ -1533,7 +1533,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/dest1</string> 
+       <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/dest1</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/udf6.q.xml b/ql/src/test/results/compiler/plan/udf6.q.xml
index 87e228336b..8b54a12af8 100644
--- a/ql/src/test/results/compiler/plan/udf6.q.xml
+++ b/ql/src/test/results/compiler/plan/udf6.q.xml
@@ -64,7 +64,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/src</string> 
+            <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/src</string> 
            </void> 
           </object> 
          </void> 
@@ -92,7 +92,7 @@
                 <void property="conf"> 
                  <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                   <void property="dirName"> 
-                   <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/2103119937/10001</string> 
+                   <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/948218645/10001</string> 
                   </void> 
                   <void property="tableInfo"> 
                    <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -128,18 +128,18 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FS_742_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_FS_744_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FS_742_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_FS_744_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FS_742_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_FS_744_TIME_TAKEN</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>FS_742</string> 
+                 <string>FS_744</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -310,18 +310,18 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_741_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_SEL_743_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_741_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_SEL_743_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_741_TIME_TAKEN</string> 
+               <string>CNTR_NAME_SEL_743_TIME_TAKEN</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>SEL_741</string> 
+             <string>SEL_743</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -372,13 +372,13 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_740_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_742_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_740_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_742_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_740_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_742_TIME_TAKEN</string> 
           </void> 
          </object> 
         </void> 
@@ -386,7 +386,7 @@
          <object class="java.util.ArrayList"/> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_740</string> 
+         <string>TS_742</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -423,7 +423,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/src</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>src</string> 
@@ -435,7 +435,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/src</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/udf_case.q.xml b/ql/src/test/results/compiler/plan/udf_case.q.xml
index 68cb8cbbb1..6de3f3f45f 100644
--- a/ql/src/test/results/compiler/plan/udf_case.q.xml
+++ b/ql/src/test/results/compiler/plan/udf_case.q.xml
@@ -64,7 +64,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/src</string> 
+            <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/src</string> 
            </void> 
           </object> 
          </void> 
@@ -96,7 +96,7 @@
                     <void property="conf"> 
                      <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                       <void property="dirName"> 
-                       <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/5173108/10001</string> 
+                       <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/2019530918/10001</string> 
                       </void> 
                       <void property="tableInfo"> 
                        <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -132,18 +132,18 @@
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_FS_749_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_FS_751_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_FS_749_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_FS_751_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_FS_749_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_FS_751_TIME_TAKEN</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>FS_749</string> 
+                     <string>FS_751</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
@@ -198,18 +198,18 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_LIM_748_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_LIM_750_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_LIM_748_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_LIM_750_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_LIM_748_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_LIM_750_TIME_TAKEN</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>LIM_748</string> 
+                 <string>LIM_750</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -421,18 +421,18 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_747_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_SEL_749_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_747_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_SEL_749_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_747_TIME_TAKEN</string> 
+               <string>CNTR_NAME_SEL_749_TIME_TAKEN</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>SEL_747</string> 
+             <string>SEL_749</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -462,13 +462,13 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_746_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_748_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_746_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_748_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_746_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_748_TIME_TAKEN</string> 
           </void> 
          </object> 
         </void> 
@@ -476,7 +476,7 @@
          <object class="java.util.ArrayList"/> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_746</string> 
+         <string>TS_748</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -517,7 +517,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/src</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>src</string> 
@@ -529,7 +529,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/src</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/udf_when.q.xml b/ql/src/test/results/compiler/plan/udf_when.q.xml
index 661ef30c38..1e58feb41c 100644
--- a/ql/src/test/results/compiler/plan/udf_when.q.xml
+++ b/ql/src/test/results/compiler/plan/udf_when.q.xml
@@ -64,7 +64,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/src</string> 
+            <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/src</string> 
            </void> 
           </object> 
          </void> 
@@ -96,7 +96,7 @@
                     <void property="conf"> 
                      <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                       <void property="dirName"> 
-                       <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/473275175/10001</string> 
+                       <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/365879746/10001</string> 
                       </void> 
                       <void property="tableInfo"> 
                        <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -132,18 +132,18 @@
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_FS_757_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_FS_759_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_FS_757_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_FS_759_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_FS_757_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_FS_759_TIME_TAKEN</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>FS_757</string> 
+                     <string>FS_759</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
@@ -198,18 +198,18 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_LIM_756_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_LIM_758_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_LIM_756_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_LIM_758_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_LIM_756_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_LIM_758_TIME_TAKEN</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>LIM_756</string> 
+                 <string>LIM_758</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -541,18 +541,18 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_755_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_SEL_757_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_755_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_SEL_757_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_SEL_755_TIME_TAKEN</string> 
+               <string>CNTR_NAME_SEL_757_TIME_TAKEN</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>SEL_755</string> 
+             <string>SEL_757</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -582,13 +582,13 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_754_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_756_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_754_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_756_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_754_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_756_TIME_TAKEN</string> 
           </void> 
          </object> 
         </void> 
@@ -596,7 +596,7 @@
          <object class="java.util.ArrayList"/> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_754</string> 
+         <string>TS_756</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -637,7 +637,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/src</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>src</string> 
@@ -649,7 +649,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/src</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/union.q.xml b/ql/src/test/results/compiler/plan/union.q.xml
index 8a27ec73c8..b77b35a299 100644
--- a/ql/src/test/results/compiler/plan/union.q.xml
+++ b/ql/src/test/results/compiler/plan/union.q.xml
@@ -33,7 +33,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1807415890/10000</string> 
+               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/1942527160/10000</string> 
               </void> 
               <void property="targetDir"> 
                <string>../build/ql/test/data/warehouse/union.out</string> 
@@ -64,10 +64,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/19546513/10001</string> 
+               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/887100238/10001</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1807415890/10000</string> 
+               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/1942527160/10000</string> 
               </void> 
              </object> 
             </void> 
@@ -85,7 +85,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/19546513/10001</string> 
+               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/887100238/10001</string> 
                <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -240,18 +240,18 @@
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_774_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_RS_776_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_774_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_RS_776_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_RS_774_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_RS_776_TIME_TAKEN</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>RS_774</string> 
+                     <string>RS_776</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
@@ -295,18 +295,18 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_TS_773_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_TS_775_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_TS_773_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_TS_775_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_TS_773_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_TS_775_TIME_TAKEN</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>TS_773</string> 
+                 <string>TS_775</string> 
                 </void> 
                 <void property="schema"> 
                  <object idref="RowSchema0"/> 
@@ -324,10 +324,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/19546513/10001</string> 
+               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/887100238/10001</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/19546513/10001</string> 
+                 <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/887100238/10001</string> 
                 </void> 
                </object> 
               </void> 
@@ -336,7 +336,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/19546513/10001</string> 
+               <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/887100238/10001</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object id="tableDesc2" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -380,7 +380,7 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1807415890/10000</string> 
+                     <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/1942527160/10000</string> 
                     </void> 
                     <void property="tableInfo"> 
                      <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -416,18 +416,18 @@
                   <void property="counterNames"> 
                    <object class="java.util.ArrayList"> 
                     <void method="add"> 
-                     <string>CNTR_NAME_FS_776_NUM_INPUT_ROWS</string> 
+                     <string>CNTR_NAME_FS_778_NUM_INPUT_ROWS</string> 
                     </void> 
                     <void method="add"> 
-                     <string>CNTR_NAME_FS_776_NUM_OUTPUT_ROWS</string> 
+                     <string>CNTR_NAME_FS_778_NUM_OUTPUT_ROWS</string> 
                     </void> 
                     <void method="add"> 
-                     <string>CNTR_NAME_FS_776_TIME_TAKEN</string> 
+                     <string>CNTR_NAME_FS_778_TIME_TAKEN</string> 
                     </void> 
                    </object> 
                   </void> 
                   <void property="operatorId"> 
-                   <string>FS_776</string> 
+                   <string>FS_778</string> 
                   </void> 
                   <void property="parentOperators"> 
                    <object class="java.util.ArrayList"> 
@@ -463,18 +463,18 @@
               <void property="counterNames"> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>CNTR_NAME_OP_775_NUM_INPUT_ROWS</string> 
+                 <string>CNTR_NAME_OP_777_NUM_INPUT_ROWS</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_OP_775_NUM_OUTPUT_ROWS</string> 
+                 <string>CNTR_NAME_OP_777_NUM_OUTPUT_ROWS</string> 
                 </void> 
                 <void method="add"> 
-                 <string>CNTR_NAME_OP_775_TIME_TAKEN</string> 
+                 <string>CNTR_NAME_OP_777_TIME_TAKEN</string> 
                 </void> 
                </object> 
               </void> 
               <void property="operatorId"> 
-               <string>OP_775</string> 
+               <string>OP_777</string> 
               </void> 
               <void property="schema"> 
                <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -532,7 +532,7 @@
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
         <void property="dir"> 
-         <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/19546513/10001</string> 
+         <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/887100238/10001</string> 
         </void> 
         <void property="listTasks"> 
          <object idref="ArrayList0"/> 
@@ -620,7 +620,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/src</string> 
+            <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/src</string> 
            </void> 
           </object> 
          </void> 
@@ -688,7 +688,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/src</string> 
+            <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/src</string> 
            </void> 
           </object> 
          </void> 
@@ -735,7 +735,7 @@
                                    <int>1</int> 
                                   </void> 
                                   <void property="dirName"> 
-                                   <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/19546513/10001</string> 
+                                   <string>file:/data/users/njain/hive4/hive4/build/ql/tmp/887100238/10001</string> 
                                   </void> 
                                   <void property="tableInfo"> 
                                    <object idref="tableDesc2"/> 
@@ -745,18 +745,18 @@
                                 <void property="counterNames"> 
                                  <object class="java.util.ArrayList"> 
                                   <void method="add"> 
-                                   <string>CNTR_NAME_FS_770_NUM_INPUT_ROWS</string> 
+                                   <string>CNTR_NAME_FS_772_NUM_INPUT_ROWS</string> 
                                   </void> 
                                   <void method="add"> 
-                                   <string>CNTR_NAME_FS_770_NUM_OUTPUT_ROWS</string> 
+                                   <string>CNTR_NAME_FS_772_NUM_OUTPUT_ROWS</string> 
                                   </void> 
                                   <void method="add"> 
-                                   <string>CNTR_NAME_FS_770_TIME_TAKEN</string> 
+                                   <string>CNTR_NAME_FS_772_TIME_TAKEN</string> 
                                   </void> 
                                  </object> 
                                 </void> 
                                 <void property="operatorId"> 
-                                 <string>FS_770</string> 
+                                 <string>FS_772</string> 
                                 </void> 
                                 <void property="parentOperators"> 
                                  <object class="java.util.ArrayList"> 
@@ -834,18 +834,18 @@
                             <void property="counterNames"> 
                              <object class="java.util.ArrayList"> 
                               <void method="add"> 
-                               <string>CNTR_NAME_SEL_769_NUM_INPUT_ROWS</string> 
+                               <string>CNTR_NAME_SEL_771_NUM_INPUT_ROWS</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_SEL_769_NUM_OUTPUT_ROWS</string> 
+                               <string>CNTR_NAME_SEL_771_NUM_OUTPUT_ROWS</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_SEL_769_TIME_TAKEN</string> 
+                               <string>CNTR_NAME_SEL_771_TIME_TAKEN</string> 
                               </void> 
                              </object> 
                             </void> 
                             <void property="operatorId"> 
-                             <string>SEL_769</string> 
+                             <string>SEL_771</string> 
                             </void> 
                             <void property="parentOperators"> 
                              <object class="java.util.ArrayList"> 
@@ -892,18 +892,18 @@
                         <void property="counterNames"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <string>CNTR_NAME_UNION_768_NUM_INPUT_ROWS</string> 
+                           <string>CNTR_NAME_UNION_770_NUM_INPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_UNION_768_NUM_OUTPUT_ROWS</string> 
+                           <string>CNTR_NAME_UNION_770_NUM_OUTPUT_ROWS</string> 
                           </void> 
                           <void method="add"> 
-                           <string>CNTR_NAME_UNION_768_TIME_TAKEN</string> 
+                           <string>CNTR_NAME_UNION_770_TIME_TAKEN</string> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="operatorId"> 
-                         <string>UNION_768</string> 
+                         <string>UNION_770</string> 
                         </void> 
                         <void property="parentOperators"> 
                          <object class="java.util.ArrayList"> 
@@ -981,18 +981,18 @@
                             <void property="counterNames"> 
                              <object class="java.util.ArrayList"> 
                               <void method="add"> 
-                               <string>CNTR_NAME_SEL_767_NUM_INPUT_ROWS</string> 
+                               <string>CNTR_NAME_SEL_769_NUM_INPUT_ROWS</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_SEL_767_NUM_OUTPUT_ROWS</string> 
+                               <string>CNTR_NAME_SEL_769_NUM_OUTPUT_ROWS</string> 
                               </void> 
                               <void method="add"> 
-                               <string>CNTR_NAME_SEL_767_TIME_TAKEN</string> 
+                               <string>CNTR_NAME_SEL_769_TIME_TAKEN</string> 
                               </void> 
                              </object> 
                             </void> 
                             <void property="operatorId"> 
-                             <string>SEL_767</string> 
+                             <string>SEL_769</string> 
                             </void> 
                             <void property="parentOperators"> 
                              <object class="java.util.ArrayList"> 
@@ -1067,18 +1067,18 @@
                                 <void property="counterNames"> 
                                  <object class="java.util.ArrayList"> 
                                   <void method="add"> 
-                                   <string>CNTR_NAME_FIL_766_NUM_INPUT_ROWS</string> 
+                                   <string>CNTR_NAME_FIL_768_NUM_INPUT_ROWS</string> 
                                   </void> 
                                   <void method="add"> 
-                                   <string>CNTR_NAME_FIL_766_NUM_OUTPUT_ROWS</string> 
+                                   <string>CNTR_NAME_FIL_768_NUM_OUTPUT_ROWS</string> 
                                   </void> 
                                   <void method="add"> 
-                                   <string>CNTR_NAME_FIL_766_TIME_TAKEN</string> 
+                                   <string>CNTR_NAME_FIL_768_TIME_TAKEN</string> 
                                   </void> 
                                  </object> 
                                 </void> 
                                 <void property="operatorId"> 
-                                 <string>FIL_766</string> 
+                                 <string>FIL_768</string> 
                                 </void> 
                                 <void property="parentOperators"> 
                                  <object class="java.util.ArrayList"> 
@@ -1145,18 +1145,18 @@
                                     <void property="counterNames"> 
                                      <object class="java.util.ArrayList"> 
                                       <void method="add"> 
-                                       <string>CNTR_NAME_FIL_772_NUM_INPUT_ROWS</string> 
+                                       <string>CNTR_NAME_FIL_774_NUM_INPUT_ROWS</string> 
                                       </void> 
                                       <void method="add"> 
-                                       <string>CNTR_NAME_FIL_772_NUM_OUTPUT_ROWS</string> 
+                                       <string>CNTR_NAME_FIL_774_NUM_OUTPUT_ROWS</string> 
                                       </void> 
                                       <void method="add"> 
-                                       <string>CNTR_NAME_FIL_772_TIME_TAKEN</string> 
+                                       <string>CNTR_NAME_FIL_774_TIME_TAKEN</string> 
                                       </void> 
                                      </object> 
                                     </void> 
                                     <void property="operatorId"> 
-                                     <string>FIL_772</string> 
+                                     <string>FIL_774</string> 
                                     </void> 
                                     <void property="parentOperators"> 
                                      <object class="java.util.ArrayList"> 
@@ -1179,13 +1179,13 @@
                                         <void property="counterNames"> 
                                          <object class="java.util.ArrayList"> 
                                           <void method="add"> 
-                                           <string>CNTR_NAME_TS_765_NUM_INPUT_ROWS</string> 
+                                           <string>CNTR_NAME_TS_767_NUM_INPUT_ROWS</string> 
                                           </void> 
                                           <void method="add"> 
-                                           <string>CNTR_NAME_TS_765_NUM_OUTPUT_ROWS</string> 
+                                           <string>CNTR_NAME_TS_767_NUM_OUTPUT_ROWS</string> 
                                           </void> 
                                           <void method="add"> 
-                                           <string>CNTR_NAME_TS_765_TIME_TAKEN</string> 
+                                           <string>CNTR_NAME_TS_767_TIME_TAKEN</string> 
                                           </void> 
                                          </object> 
                                         </void> 
@@ -1200,7 +1200,7 @@
                                          </object> 
                                         </void> 
                                         <void property="operatorId"> 
-                                         <string>TS_765</string> 
+                                         <string>TS_767</string> 
                                         </void> 
                                         <void property="schema"> 
                                          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -1379,18 +1379,18 @@
                     <void property="counterNames"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_764_NUM_INPUT_ROWS</string> 
+                       <string>CNTR_NAME_SEL_766_NUM_INPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_764_NUM_OUTPUT_ROWS</string> 
+                       <string>CNTR_NAME_SEL_766_NUM_OUTPUT_ROWS</string> 
                       </void> 
                       <void method="add"> 
-                       <string>CNTR_NAME_SEL_764_TIME_TAKEN</string> 
+                       <string>CNTR_NAME_SEL_766_TIME_TAKEN</string> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="operatorId"> 
-                     <string>SEL_764</string> 
+                     <string>SEL_766</string> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
@@ -1471,18 +1471,18 @@
                 <void property="counterNames"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_763_NUM_INPUT_ROWS</string> 
+                   <string>CNTR_NAME_FIL_765_NUM_INPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_763_NUM_OUTPUT_ROWS</string> 
+                   <string>CNTR_NAME_FIL_765_NUM_OUTPUT_ROWS</string> 
                   </void> 
                   <void method="add"> 
-                   <string>CNTR_NAME_FIL_763_TIME_TAKEN</string> 
+                   <string>CNTR_NAME_FIL_765_TIME_TAKEN</string> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="operatorId"> 
-                 <string>FIL_763</string> 
+                 <string>FIL_765</string> 
                 </void> 
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -1577,18 +1577,18 @@
             <void property="counterNames"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_771_NUM_INPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_773_NUM_INPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_771_NUM_OUTPUT_ROWS</string> 
+               <string>CNTR_NAME_FIL_773_NUM_OUTPUT_ROWS</string> 
               </void> 
               <void method="add"> 
-               <string>CNTR_NAME_FIL_771_TIME_TAKEN</string> 
+               <string>CNTR_NAME_FIL_773_TIME_TAKEN</string> 
               </void> 
              </object> 
             </void> 
             <void property="operatorId"> 
-             <string>FIL_771</string> 
+             <string>FIL_773</string> 
             </void> 
             <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
@@ -1618,13 +1618,13 @@
         <void property="counterNames"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_762_NUM_INPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_764_NUM_INPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_762_NUM_OUTPUT_ROWS</string> 
+           <string>CNTR_NAME_TS_764_NUM_OUTPUT_ROWS</string> 
           </void> 
           <void method="add"> 
-           <string>CNTR_NAME_TS_762_TIME_TAKEN</string> 
+           <string>CNTR_NAME_TS_764_TIME_TAKEN</string> 
           </void> 
          </object> 
         </void> 
@@ -1639,7 +1639,7 @@
          </object> 
         </void> 
         <void property="operatorId"> 
-         <string>TS_762</string> 
+         <string>TS_764</string> 
         </void> 
         <void property="schema"> 
          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
@@ -1659,7 +1659,7 @@
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/src</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>null-subquery1:unioninput-subquery1:src</string> 
@@ -1674,7 +1674,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive4/hive4/build/ql/test/data/warehouse/src</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
