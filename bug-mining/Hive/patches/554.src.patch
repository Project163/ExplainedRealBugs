diff --git a/CHANGES.txt b/CHANGES.txt
index 49edffdcd1..23376282a6 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -783,6 +783,9 @@ Trunk -  Unreleased
     HIVE-1942. change the value of hive.input.format to CombineHiveInputFormat for tests
     (namit via He Yongqiang)
 
+    HIVE-1952. fix some outputs and make some tests deterministic
+    (namit via He Yongqiang)
+
   TASKS
 
     HIVE-1526. Hive should depend on a release version of Thrift
diff --git a/ql/src/test/queries/clientpositive/input_part7.q b/ql/src/test/queries/clientpositive/input_part7.q
index 3b979c1d76..10f9336adc 100644
--- a/ql/src/test/queries/clientpositive/input_part7.q
+++ b/ql/src/test/queries/clientpositive/input_part7.q
@@ -1,14 +1,14 @@
-EXPLAIN EXTENDED 
+EXPLAIN EXTENDED
 SELECT * FROM (
   SELECT X.* FROM SRCPART X WHERE X.ds = '2008-04-08' and X.key < 100
   UNION ALL
   SELECT Y.* FROM SRCPART Y WHERE Y.ds = '2008-04-08' and Y.key < 100
 ) A
-SORT BY A.key;
+SORT BY A.key, A.value, A.ds, A.hr;
 
 SELECT * FROM (
   SELECT X.* FROM SRCPART X WHERE X.ds = '2008-04-08' and X.key < 100
   UNION ALL
   SELECT Y.* FROM SRCPART Y WHERE Y.ds = '2008-04-08' and Y.key < 100
 ) A
-SORT BY A.key;
+SORT BY A.key, A.value, A.ds, A.hr;
diff --git a/ql/src/test/queries/clientpositive/partition_vs_table_metadata.q b/ql/src/test/queries/clientpositive/partition_vs_table_metadata.q
index bbfe483a8e..9f493e561f 100644
--- a/ql/src/test/queries/clientpositive/partition_vs_table_metadata.q
+++ b/ql/src/test/queries/clientpositive/partition_vs_table_metadata.q
@@ -9,5 +9,5 @@ alter table partition_vs_table add columns (newcol string);
 insert overwrite table partition_vs_table partition(ds='101') select key, value, key from src;
 
 select key, value, newcol from partition_vs_table
-order by key;
+order by key, value, newcol;
 
diff --git a/ql/src/test/queries/clientpositive/union_ppr.q b/ql/src/test/queries/clientpositive/union_ppr.q
index 4cf4f99220..27d2c262de 100644
--- a/ql/src/test/queries/clientpositive/union_ppr.q
+++ b/ql/src/test/queries/clientpositive/union_ppr.q
@@ -1,11 +1,11 @@
-EXPLAIN EXTENDED 
+EXPLAIN EXTENDED
 SELECT * FROM (
   SELECT X.* FROM SRCPART X WHERE X.key < 100
   UNION ALL
   SELECT Y.* FROM SRCPART Y WHERE Y.key < 100
 ) A
 WHERE A.ds = '2008-04-08'
-SORT BY A.key;
+SORT BY A.key, A.value, A.ds, A.hr;
 
 SELECT * FROM (
   SELECT X.* FROM SRCPART X WHERE X.key < 100
@@ -13,4 +13,4 @@ SELECT * FROM (
   SELECT Y.* FROM SRCPART Y WHERE Y.key < 100
 ) A
 WHERE A.ds = '2008-04-08'
-SORT BY A.key;
+SORT BY A.key, A.value, A.ds, A.hr;
diff --git a/ql/src/test/results/clientpositive/bucketmapjoin4.q.out b/ql/src/test/results/clientpositive/bucketmapjoin4.q.out
index f93c4b1d49..d0bc691860 100644
--- a/ql/src/test/results/clientpositive/bucketmapjoin4.q.out
+++ b/ql/src/test/results/clientpositive/bucketmapjoin4.q.out
@@ -68,16 +68,16 @@ PREHOOK: type: CREATETABLE
 POSTHOOK: query: create table bucketmapjoin_tmp_result (key string , value1 string, value2 string)
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: default@bucketmapjoin_tmp_result
-PREHOOK: query: explain extended 
-insert overwrite table bucketmapjoin_tmp_result 
-select /*+mapjoin(b)*/ a.key, a.value, b.value 
-from srcbucket_mapjoin a join srcbucket_mapjoin b 
+PREHOOK: query: explain extended
+insert overwrite table bucketmapjoin_tmp_result
+select /*+mapjoin(b)*/ a.key, a.value, b.value
+from srcbucket_mapjoin a join srcbucket_mapjoin b
 on a.key=b.key
 PREHOOK: type: QUERY
-POSTHOOK: query: explain extended 
-insert overwrite table bucketmapjoin_tmp_result 
-select /*+mapjoin(b)*/ a.key, a.value, b.value 
-from srcbucket_mapjoin a join srcbucket_mapjoin b 
+POSTHOOK: query: explain extended
+insert overwrite table bucketmapjoin_tmp_result
+select /*+mapjoin(b)*/ a.key, a.value, b.value
+from srcbucket_mapjoin a join srcbucket_mapjoin b
 on a.key=b.key
 POSTHOOK: type: QUERY
 ABSTRACT SYNTAX TREE:
@@ -117,10 +117,10 @@ STAGE PLANS:
           Alias Bucket Base File Name Mapping:
             b {srcbucket20.txt=[srcbucket20.txt], srcbucket21.txt=[srcbucket21.txt]}
           Alias Bucket File Name Mapping:
-            b {pfile:/data/users/liyintang/hive-1754/build/ql/test/data/warehouse/srcbucket_mapjoin/srcbucket20.txt=[pfile:/data/users/liyintang/hive-1754/build/ql/test/data/warehouse/srcbucket_mapjoin/srcbucket20.txt], pfile:/data/users/liyintang/hive-1754/build/ql/test/data/warehouse/srcbucket_mapjoin/srcbucket21.txt=[pfile:/data/users/liyintang/hive-1754/build/ql/test/data/warehouse/srcbucket_mapjoin/srcbucket21.txt]}
+            b {pfile:/data/users/njain/hive_commit1/build/ql/test/data/warehouse/srcbucket_mapjoin/srcbucket20.txt=[pfile:/data/users/njain/hive_commit1/build/ql/test/data/warehouse/srcbucket_mapjoin/srcbucket20.txt], pfile:/data/users/njain/hive_commit1/build/ql/test/data/warehouse/srcbucket_mapjoin/srcbucket21.txt=[pfile:/data/users/njain/hive_commit1/build/ql/test/data/warehouse/srcbucket_mapjoin/srcbucket21.txt]}
           Alias Bucket Output File Name Mapping:
-            pfile:/data/users/liyintang/hive-1754/build/ql/test/data/warehouse/srcbucket_mapjoin/srcbucket20.txt 0
-            pfile:/data/users/liyintang/hive-1754/build/ql/test/data/warehouse/srcbucket_mapjoin/srcbucket21.txt 1
+            pfile:/data/users/njain/hive_commit1/build/ql/test/data/warehouse/srcbucket_mapjoin/srcbucket20.txt 0
+            pfile:/data/users/njain/hive_commit1/build/ql/test/data/warehouse/srcbucket_mapjoin/srcbucket21.txt 1
 
   Stage: Stage-1
     Map Reduce
@@ -162,9 +162,9 @@ STAGE PLANS:
                   File Output Operator
                     compressed: false
                     GlobalTableId: 1
-                    directory: pfile:/data/users/liyintang/hive-1754/build/ql/scratchdir/hive_2010-11-04_11-22-40_615_6683611377161445328/-ext-10002
+                    directory: pfile:/data/users/njain/hive_commit1/build/ql/scratchdir/hive_2011-02-03_10-39-37_892_6043894210590111647/-ext-10002
                     NumFilesPerFileSink: 1
-                    Stats Publishing Key Prefix: pfile:/data/users/liyintang/hive-1754/build/ql/scratchdir/hive_2010-11-04_11-22-40_615_6683611377161445328/-ext-10000/
+                    Stats Publishing Key Prefix: pfile:/data/users/njain/hive_commit1/build/ql/scratchdir/hive_2011-02-03_10-39-37_892_6043894210590111647/-ext-10000/
                     table:
                         input format: org.apache.hadoop.mapred.TextInputFormat
                         output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -174,12 +174,12 @@ STAGE PLANS:
                           columns.types string:string:string
                           file.inputformat org.apache.hadoop.mapred.TextInputFormat
                           file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                          location pfile:/data/users/liyintang/hive-1754/build/ql/test/data/warehouse/bucketmapjoin_tmp_result
+                          location pfile:/data/users/njain/hive_commit1/build/ql/test/data/warehouse/bucketmapjoin_tmp_result
                           name bucketmapjoin_tmp_result
                           serialization.ddl struct bucketmapjoin_tmp_result { string key, string value1, string value2}
                           serialization.format 1
                           serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                          transient_lastDdlTime 1288894960
+                          transient_lastDdlTime 1296758377
                         serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                         name: bucketmapjoin_tmp_result
                     TotalFiles: 1
@@ -189,9 +189,9 @@ STAGE PLANS:
         Map Reduce Local Work
       Needs Tagging: false
       Path -> Alias:
-        pfile:/data/users/liyintang/hive-1754/build/ql/test/data/warehouse/srcbucket_mapjoin [a]
+        pfile:/data/users/njain/hive_commit1/build/ql/test/data/warehouse/srcbucket_mapjoin [a]
       Path -> Partition:
-        pfile:/data/users/liyintang/hive-1754/build/ql/test/data/warehouse/srcbucket_mapjoin 
+        pfile:/data/users/njain/hive_commit1/build/ql/test/data/warehouse/srcbucket_mapjoin 
           Partition
             base file name: srcbucket_mapjoin
             input format: org.apache.hadoop.mapred.TextInputFormat
@@ -203,12 +203,12 @@ STAGE PLANS:
               columns.types int:string
               file.inputformat org.apache.hadoop.mapred.TextInputFormat
               file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-              location pfile:/data/users/liyintang/hive-1754/build/ql/test/data/warehouse/srcbucket_mapjoin
+              location pfile:/data/users/njain/hive_commit1/build/ql/test/data/warehouse/srcbucket_mapjoin
               name srcbucket_mapjoin
               serialization.ddl struct srcbucket_mapjoin { i32 key, string value}
               serialization.format 1
               serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-              transient_lastDdlTime 1288894953
+              transient_lastDdlTime 1296758374
             serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
           
               input format: org.apache.hadoop.mapred.TextInputFormat
@@ -220,12 +220,12 @@ STAGE PLANS:
                 columns.types int:string
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location pfile:/data/users/liyintang/hive-1754/build/ql/test/data/warehouse/srcbucket_mapjoin
+                location pfile:/data/users/njain/hive_commit1/build/ql/test/data/warehouse/srcbucket_mapjoin
                 name srcbucket_mapjoin
                 serialization.ddl struct srcbucket_mapjoin { i32 key, string value}
                 serialization.format 1
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                transient_lastDdlTime 1288894953
+                transient_lastDdlTime 1296758374
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: srcbucket_mapjoin
             name: srcbucket_mapjoin
@@ -237,14 +237,14 @@ STAGE PLANS:
     Move Operator
       files:
           hdfs directory: true
-          source: pfile:/data/users/liyintang/hive-1754/build/ql/scratchdir/hive_2010-11-04_11-22-40_615_6683611377161445328/-ext-10002
-          destination: pfile:/data/users/liyintang/hive-1754/build/ql/scratchdir/hive_2010-11-04_11-22-40_615_6683611377161445328/-ext-10000
+          source: pfile:/data/users/njain/hive_commit1/build/ql/scratchdir/hive_2011-02-03_10-39-37_892_6043894210590111647/-ext-10002
+          destination: pfile:/data/users/njain/hive_commit1/build/ql/scratchdir/hive_2011-02-03_10-39-37_892_6043894210590111647/-ext-10000
 
   Stage: Stage-0
     Move Operator
       tables:
           replace: true
-          source: pfile:/data/users/liyintang/hive-1754/build/ql/scratchdir/hive_2010-11-04_11-22-40_615_6683611377161445328/-ext-10000
+          source: pfile:/data/users/njain/hive_commit1/build/ql/scratchdir/hive_2011-02-03_10-39-37_892_6043894210590111647/-ext-10000
           table:
               input format: org.apache.hadoop.mapred.TextInputFormat
               output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -254,28 +254,28 @@ STAGE PLANS:
                 columns.types string:string:string
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location pfile:/data/users/liyintang/hive-1754/build/ql/test/data/warehouse/bucketmapjoin_tmp_result
+                location pfile:/data/users/njain/hive_commit1/build/ql/test/data/warehouse/bucketmapjoin_tmp_result
                 name bucketmapjoin_tmp_result
                 serialization.ddl struct bucketmapjoin_tmp_result { string key, string value1, string value2}
                 serialization.format 1
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                transient_lastDdlTime 1288894960
+                transient_lastDdlTime 1296758377
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: bucketmapjoin_tmp_result
-          tmp directory: pfile:/data/users/liyintang/hive-1754/build/ql/scratchdir/hive_2010-11-04_11-22-40_615_6683611377161445328/-ext-10001
+          tmp directory: pfile:/data/users/njain/hive_commit1/build/ql/scratchdir/hive_2011-02-03_10-39-37_892_6043894210590111647/-ext-10001
 
   Stage: Stage-2
     Stats-Aggr Operator
-      Stats Aggregation Key Prefix: pfile:/data/users/liyintang/hive-1754/build/ql/scratchdir/hive_2010-11-04_11-22-40_615_6683611377161445328/-ext-10000/
+      Stats Aggregation Key Prefix: pfile:/data/users/njain/hive_commit1/build/ql/scratchdir/hive_2011-02-03_10-39-37_892_6043894210590111647/-ext-10000/
 
   Stage: Stage-3
     Map Reduce
       Alias -> Map Operator Tree:
-        pfile:/data/users/liyintang/hive-1754/build/ql/scratchdir/hive_2010-11-04_11-22-40_615_6683611377161445328/-ext-10002 
+        pfile:/data/users/njain/hive_commit1/build/ql/scratchdir/hive_2011-02-03_10-39-37_892_6043894210590111647/-ext-10002 
             File Output Operator
               compressed: false
               GlobalTableId: 0
-              directory: pfile:/data/users/liyintang/hive-1754/build/ql/scratchdir/hive_2010-11-04_11-22-40_615_6683611377161445328/-ext-10000
+              directory: pfile:/data/users/njain/hive_commit1/build/ql/scratchdir/hive_2011-02-03_10-39-37_892_6043894210590111647/-ext-10000
               NumFilesPerFileSink: 1
               table:
                   input format: org.apache.hadoop.mapred.TextInputFormat
@@ -286,12 +286,12 @@ STAGE PLANS:
                     columns.types string:string:string
                     file.inputformat org.apache.hadoop.mapred.TextInputFormat
                     file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                    location pfile:/data/users/liyintang/hive-1754/build/ql/test/data/warehouse/bucketmapjoin_tmp_result
+                    location pfile:/data/users/njain/hive_commit1/build/ql/test/data/warehouse/bucketmapjoin_tmp_result
                     name bucketmapjoin_tmp_result
                     serialization.ddl struct bucketmapjoin_tmp_result { string key, string value1, string value2}
                     serialization.format 1
                     serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                    transient_lastDdlTime 1288894960
+                    transient_lastDdlTime 1296758377
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   name: bucketmapjoin_tmp_result
               TotalFiles: 1
@@ -299,9 +299,9 @@ STAGE PLANS:
               MultiFileSpray: false
       Needs Tagging: false
       Path -> Alias:
-        pfile:/data/users/liyintang/hive-1754/build/ql/scratchdir/hive_2010-11-04_11-22-40_615_6683611377161445328/-ext-10002 [pfile:/data/users/liyintang/hive-1754/build/ql/scratchdir/hive_2010-11-04_11-22-40_615_6683611377161445328/-ext-10002]
+        pfile:/data/users/njain/hive_commit1/build/ql/scratchdir/hive_2011-02-03_10-39-37_892_6043894210590111647/-ext-10002 [pfile:/data/users/njain/hive_commit1/build/ql/scratchdir/hive_2011-02-03_10-39-37_892_6043894210590111647/-ext-10002]
       Path -> Partition:
-        pfile:/data/users/liyintang/hive-1754/build/ql/scratchdir/hive_2010-11-04_11-22-40_615_6683611377161445328/-ext-10002 
+        pfile:/data/users/njain/hive_commit1/build/ql/scratchdir/hive_2011-02-03_10-39-37_892_6043894210590111647/-ext-10002 
           Partition
             base file name: -ext-10002
             input format: org.apache.hadoop.mapred.TextInputFormat
@@ -312,12 +312,12 @@ STAGE PLANS:
               columns.types string:string:string
               file.inputformat org.apache.hadoop.mapred.TextInputFormat
               file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-              location pfile:/data/users/liyintang/hive-1754/build/ql/test/data/warehouse/bucketmapjoin_tmp_result
+              location pfile:/data/users/njain/hive_commit1/build/ql/test/data/warehouse/bucketmapjoin_tmp_result
               name bucketmapjoin_tmp_result
               serialization.ddl struct bucketmapjoin_tmp_result { string key, string value1, string value2}
               serialization.format 1
               serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-              transient_lastDdlTime 1288894960
+              transient_lastDdlTime 1296758377
             serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
           
               input format: org.apache.hadoop.mapred.TextInputFormat
@@ -328,27 +328,27 @@ STAGE PLANS:
                 columns.types string:string:string
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location pfile:/data/users/liyintang/hive-1754/build/ql/test/data/warehouse/bucketmapjoin_tmp_result
+                location pfile:/data/users/njain/hive_commit1/build/ql/test/data/warehouse/bucketmapjoin_tmp_result
                 name bucketmapjoin_tmp_result
                 serialization.ddl struct bucketmapjoin_tmp_result { string key, string value1, string value2}
                 serialization.format 1
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                transient_lastDdlTime 1288894960
+                transient_lastDdlTime 1296758377
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: bucketmapjoin_tmp_result
             name: bucketmapjoin_tmp_result
 
 
 PREHOOK: query: insert overwrite table bucketmapjoin_tmp_result
-select /*+mapjoin(b)*/ a.key, a.value, b.value 
-from srcbucket_mapjoin a join srcbucket_mapjoin b 
+select /*+mapjoin(b)*/ a.key, a.value, b.value
+from srcbucket_mapjoin a join srcbucket_mapjoin b
 on a.key=b.key
 PREHOOK: type: QUERY
 PREHOOK: Input: default@srcbucket_mapjoin
 PREHOOK: Output: default@bucketmapjoin_tmp_result
 POSTHOOK: query: insert overwrite table bucketmapjoin_tmp_result
-select /*+mapjoin(b)*/ a.key, a.value, b.value 
-from srcbucket_mapjoin a join srcbucket_mapjoin b 
+select /*+mapjoin(b)*/ a.key, a.value, b.value
+from srcbucket_mapjoin a join srcbucket_mapjoin b
 on a.key=b.key
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcbucket_mapjoin
@@ -359,11 +359,11 @@ POSTHOOK: Lineage: bucketmapjoin_tmp_result.value2 SIMPLE [(srcbucket_mapjoin)b.
 PREHOOK: query: select count(1) from bucketmapjoin_tmp_result
 PREHOOK: type: QUERY
 PREHOOK: Input: default@bucketmapjoin_tmp_result
-PREHOOK: Output: file:/tmp/liyintang/hive_2010-11-04_11-22-55_207_7676433402628717113/-mr-10000
+PREHOOK: Output: file:/tmp/njain/hive_2011-02-03_10-39-48_581_8752071715056059159/-mr-10000
 POSTHOOK: query: select count(1) from bucketmapjoin_tmp_result
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@bucketmapjoin_tmp_result
-POSTHOOK: Output: file:/tmp/liyintang/hive_2010-11-04_11-22-55_207_7676433402628717113/-mr-10000
+POSTHOOK: Output: file:/tmp/njain/hive_2011-02-03_10-39-48_581_8752071715056059159/-mr-10000
 POSTHOOK: Lineage: bucketmapjoin_tmp_result.key SIMPLE [(srcbucket_mapjoin)a.FieldSchema(name:key, type:int, comment:null), ]
 POSTHOOK: Lineage: bucketmapjoin_tmp_result.value1 SIMPLE [(srcbucket_mapjoin)a.FieldSchema(name:value, type:string, comment:null), ]
 POSTHOOK: Lineage: bucketmapjoin_tmp_result.value2 SIMPLE [(srcbucket_mapjoin)b.FieldSchema(name:value, type:string, comment:null), ]
@@ -384,16 +384,16 @@ POSTHOOK: Lineage: bucketmapjoin_hash_result_1.value2 EXPRESSION [(bucketmapjoin
 POSTHOOK: Lineage: bucketmapjoin_tmp_result.key SIMPLE [(srcbucket_mapjoin)a.FieldSchema(name:key, type:int, comment:null), ]
 POSTHOOK: Lineage: bucketmapjoin_tmp_result.value1 SIMPLE [(srcbucket_mapjoin)a.FieldSchema(name:value, type:string, comment:null), ]
 POSTHOOK: Lineage: bucketmapjoin_tmp_result.value2 SIMPLE [(srcbucket_mapjoin)b.FieldSchema(name:value, type:string, comment:null), ]
-PREHOOK: query: insert overwrite table bucketmapjoin_tmp_result 
-select /*+mapjoin(b)*/ a.key, a.value, b.value 
-from srcbucket_mapjoin a join srcbucket_mapjoin b 
+PREHOOK: query: insert overwrite table bucketmapjoin_tmp_result
+select /*+mapjoin(b)*/ a.key, a.value, b.value
+from srcbucket_mapjoin a join srcbucket_mapjoin b
 on a.key=b.key
 PREHOOK: type: QUERY
 PREHOOK: Input: default@srcbucket_mapjoin
 PREHOOK: Output: default@bucketmapjoin_tmp_result
-POSTHOOK: query: insert overwrite table bucketmapjoin_tmp_result 
-select /*+mapjoin(b)*/ a.key, a.value, b.value 
-from srcbucket_mapjoin a join srcbucket_mapjoin b 
+POSTHOOK: query: insert overwrite table bucketmapjoin_tmp_result
+select /*+mapjoin(b)*/ a.key, a.value, b.value
+from srcbucket_mapjoin a join srcbucket_mapjoin b
 on a.key=b.key
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcbucket_mapjoin
@@ -410,11 +410,11 @@ POSTHOOK: Lineage: bucketmapjoin_tmp_result.value2 SIMPLE [(srcbucket_mapjoin)b.
 PREHOOK: query: select count(1) from bucketmapjoin_tmp_result
 PREHOOK: type: QUERY
 PREHOOK: Input: default@bucketmapjoin_tmp_result
-PREHOOK: Output: file:/tmp/liyintang/hive_2010-11-04_11-23-19_849_7262162116822440/-mr-10000
+PREHOOK: Output: file:/tmp/njain/hive_2011-02-03_10-40-03_632_6447279372975019708/-mr-10000
 POSTHOOK: query: select count(1) from bucketmapjoin_tmp_result
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@bucketmapjoin_tmp_result
-POSTHOOK: Output: file:/tmp/liyintang/hive_2010-11-04_11-23-19_849_7262162116822440/-mr-10000
+POSTHOOK: Output: file:/tmp/njain/hive_2011-02-03_10-40-03_632_6447279372975019708/-mr-10000
 POSTHOOK: Lineage: bucketmapjoin_hash_result_1.key EXPRESSION [(bucketmapjoin_tmp_result)bucketmapjoin_tmp_result.FieldSchema(name:key, type:string, comment:null), ]
 POSTHOOK: Lineage: bucketmapjoin_hash_result_1.value1 EXPRESSION [(bucketmapjoin_tmp_result)bucketmapjoin_tmp_result.FieldSchema(name:value1, type:string, comment:null), ]
 POSTHOOK: Lineage: bucketmapjoin_hash_result_1.value2 EXPRESSION [(bucketmapjoin_tmp_result)bucketmapjoin_tmp_result.FieldSchema(name:value2, type:string, comment:null), ]
@@ -453,14 +453,14 @@ on a.key = b.key
 PREHOOK: type: QUERY
 PREHOOK: Input: default@bucketmapjoin_hash_result_1
 PREHOOK: Input: default@bucketmapjoin_hash_result_2
-PREHOOK: Output: file:/tmp/liyintang/hive_2010-11-04_11-23-30_833_1363058298477291982/-mr-10000
+PREHOOK: Output: file:/tmp/njain/hive_2011-02-03_10-40-10_514_4277378777837780536/-mr-10000
 POSTHOOK: query: select a.key-b.key, a.value1-b.value1, a.value2-b.value2
 from bucketmapjoin_hash_result_1 a left outer join bucketmapjoin_hash_result_2 b
 on a.key = b.key
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@bucketmapjoin_hash_result_1
 POSTHOOK: Input: default@bucketmapjoin_hash_result_2
-POSTHOOK: Output: file:/tmp/liyintang/hive_2010-11-04_11-23-30_833_1363058298477291982/-mr-10000
+POSTHOOK: Output: file:/tmp/njain/hive_2011-02-03_10-40-10_514_4277378777837780536/-mr-10000
 POSTHOOK: Lineage: bucketmapjoin_hash_result_1.key EXPRESSION [(bucketmapjoin_tmp_result)bucketmapjoin_tmp_result.FieldSchema(name:key, type:string, comment:null), ]
 POSTHOOK: Lineage: bucketmapjoin_hash_result_1.value1 EXPRESSION [(bucketmapjoin_tmp_result)bucketmapjoin_tmp_result.FieldSchema(name:value1, type:string, comment:null), ]
 POSTHOOK: Lineage: bucketmapjoin_hash_result_1.value2 EXPRESSION [(bucketmapjoin_tmp_result)bucketmapjoin_tmp_result.FieldSchema(name:value2, type:string, comment:null), ]
@@ -475,15 +475,15 @@ POSTHOOK: Lineage: bucketmapjoin_tmp_result.value2 SIMPLE [(srcbucket_mapjoin)b.
 POSTHOOK: Lineage: bucketmapjoin_tmp_result.value2 SIMPLE [(srcbucket_mapjoin)b.FieldSchema(name:value, type:string, comment:null), ]
 0	0	0
 PREHOOK: query: explain extended
-insert overwrite table bucketmapjoin_tmp_result 
-select /*+mapjoin(a)*/ a.key, a.value, b.value 
-from srcbucket_mapjoin a join srcbucket_mapjoin b 
+insert overwrite table bucketmapjoin_tmp_result
+select /*+mapjoin(a)*/ a.key, a.value, b.value
+from srcbucket_mapjoin a join srcbucket_mapjoin b
 on a.key=b.key
 PREHOOK: type: QUERY
 POSTHOOK: query: explain extended
-insert overwrite table bucketmapjoin_tmp_result 
-select /*+mapjoin(a)*/ a.key, a.value, b.value 
-from srcbucket_mapjoin a join srcbucket_mapjoin b 
+insert overwrite table bucketmapjoin_tmp_result
+select /*+mapjoin(a)*/ a.key, a.value, b.value
+from srcbucket_mapjoin a join srcbucket_mapjoin b
 on a.key=b.key
 POSTHOOK: type: QUERY
 POSTHOOK: Lineage: bucketmapjoin_hash_result_1.key EXPRESSION [(bucketmapjoin_tmp_result)bucketmapjoin_tmp_result.FieldSchema(name:key, type:string, comment:null), ]
@@ -535,10 +535,10 @@ STAGE PLANS:
           Alias Bucket Base File Name Mapping:
             a {srcbucket20.txt=[srcbucket20.txt], srcbucket21.txt=[srcbucket21.txt]}
           Alias Bucket File Name Mapping:
-            a {pfile:/data/users/liyintang/hive-1754/build/ql/test/data/warehouse/srcbucket_mapjoin/srcbucket20.txt=[pfile:/data/users/liyintang/hive-1754/build/ql/test/data/warehouse/srcbucket_mapjoin/srcbucket20.txt], pfile:/data/users/liyintang/hive-1754/build/ql/test/data/warehouse/srcbucket_mapjoin/srcbucket21.txt=[pfile:/data/users/liyintang/hive-1754/build/ql/test/data/warehouse/srcbucket_mapjoin/srcbucket21.txt]}
+            a {pfile:/data/users/njain/hive_commit1/build/ql/test/data/warehouse/srcbucket_mapjoin/srcbucket20.txt=[pfile:/data/users/njain/hive_commit1/build/ql/test/data/warehouse/srcbucket_mapjoin/srcbucket20.txt], pfile:/data/users/njain/hive_commit1/build/ql/test/data/warehouse/srcbucket_mapjoin/srcbucket21.txt=[pfile:/data/users/njain/hive_commit1/build/ql/test/data/warehouse/srcbucket_mapjoin/srcbucket21.txt]}
           Alias Bucket Output File Name Mapping:
-            pfile:/data/users/liyintang/hive-1754/build/ql/test/data/warehouse/srcbucket_mapjoin/srcbucket20.txt 0
-            pfile:/data/users/liyintang/hive-1754/build/ql/test/data/warehouse/srcbucket_mapjoin/srcbucket21.txt 1
+            pfile:/data/users/njain/hive_commit1/build/ql/test/data/warehouse/srcbucket_mapjoin/srcbucket20.txt 0
+            pfile:/data/users/njain/hive_commit1/build/ql/test/data/warehouse/srcbucket_mapjoin/srcbucket21.txt 1
 
   Stage: Stage-1
     Map Reduce
@@ -580,9 +580,9 @@ STAGE PLANS:
                   File Output Operator
                     compressed: false
                     GlobalTableId: 1
-                    directory: pfile:/data/users/liyintang/hive-1754/build/ql/scratchdir/hive_2010-11-04_11-23-36_325_7813368709164240016/-ext-10002
+                    directory: pfile:/data/users/njain/hive_commit1/build/ql/scratchdir/hive_2011-02-03_10-40-13_672_8524397052406932420/-ext-10002
                     NumFilesPerFileSink: 1
-                    Stats Publishing Key Prefix: pfile:/data/users/liyintang/hive-1754/build/ql/scratchdir/hive_2010-11-04_11-23-36_325_7813368709164240016/-ext-10000/
+                    Stats Publishing Key Prefix: pfile:/data/users/njain/hive_commit1/build/ql/scratchdir/hive_2011-02-03_10-40-13_672_8524397052406932420/-ext-10000/
                     table:
                         input format: org.apache.hadoop.mapred.TextInputFormat
                         output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -592,7 +592,7 @@ STAGE PLANS:
                           columns.types string:string:string
                           file.inputformat org.apache.hadoop.mapred.TextInputFormat
                           file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                          location pfile:/data/users/liyintang/hive-1754/build/ql/test/data/warehouse/bucketmapjoin_tmp_result
+                          location pfile:/data/users/njain/hive_commit1/build/ql/test/data/warehouse/bucketmapjoin_tmp_result
                           name bucketmapjoin_tmp_result
                           numFiles 1
                           numPartitions 0
@@ -601,7 +601,7 @@ STAGE PLANS:
                           serialization.format 1
                           serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                           totalSize 8983
-                          transient_lastDdlTime 1288894999
+                          transient_lastDdlTime 1296758403
                         serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                         name: bucketmapjoin_tmp_result
                     TotalFiles: 1
@@ -611,9 +611,9 @@ STAGE PLANS:
         Map Reduce Local Work
       Needs Tagging: false
       Path -> Alias:
-        pfile:/data/users/liyintang/hive-1754/build/ql/test/data/warehouse/srcbucket_mapjoin [b]
+        pfile:/data/users/njain/hive_commit1/build/ql/test/data/warehouse/srcbucket_mapjoin [b]
       Path -> Partition:
-        pfile:/data/users/liyintang/hive-1754/build/ql/test/data/warehouse/srcbucket_mapjoin 
+        pfile:/data/users/njain/hive_commit1/build/ql/test/data/warehouse/srcbucket_mapjoin 
           Partition
             base file name: srcbucket_mapjoin
             input format: org.apache.hadoop.mapred.TextInputFormat
@@ -625,12 +625,12 @@ STAGE PLANS:
               columns.types int:string
               file.inputformat org.apache.hadoop.mapred.TextInputFormat
               file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-              location pfile:/data/users/liyintang/hive-1754/build/ql/test/data/warehouse/srcbucket_mapjoin
+              location pfile:/data/users/njain/hive_commit1/build/ql/test/data/warehouse/srcbucket_mapjoin
               name srcbucket_mapjoin
               serialization.ddl struct srcbucket_mapjoin { i32 key, string value}
               serialization.format 1
               serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-              transient_lastDdlTime 1288894953
+              transient_lastDdlTime 1296758374
             serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
           
               input format: org.apache.hadoop.mapred.TextInputFormat
@@ -642,12 +642,12 @@ STAGE PLANS:
                 columns.types int:string
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location pfile:/data/users/liyintang/hive-1754/build/ql/test/data/warehouse/srcbucket_mapjoin
+                location pfile:/data/users/njain/hive_commit1/build/ql/test/data/warehouse/srcbucket_mapjoin
                 name srcbucket_mapjoin
                 serialization.ddl struct srcbucket_mapjoin { i32 key, string value}
                 serialization.format 1
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                transient_lastDdlTime 1288894953
+                transient_lastDdlTime 1296758374
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: srcbucket_mapjoin
             name: srcbucket_mapjoin
@@ -659,14 +659,14 @@ STAGE PLANS:
     Move Operator
       files:
           hdfs directory: true
-          source: pfile:/data/users/liyintang/hive-1754/build/ql/scratchdir/hive_2010-11-04_11-23-36_325_7813368709164240016/-ext-10002
-          destination: pfile:/data/users/liyintang/hive-1754/build/ql/scratchdir/hive_2010-11-04_11-23-36_325_7813368709164240016/-ext-10000
+          source: pfile:/data/users/njain/hive_commit1/build/ql/scratchdir/hive_2011-02-03_10-40-13_672_8524397052406932420/-ext-10002
+          destination: pfile:/data/users/njain/hive_commit1/build/ql/scratchdir/hive_2011-02-03_10-40-13_672_8524397052406932420/-ext-10000
 
   Stage: Stage-0
     Move Operator
       tables:
           replace: true
-          source: pfile:/data/users/liyintang/hive-1754/build/ql/scratchdir/hive_2010-11-04_11-23-36_325_7813368709164240016/-ext-10000
+          source: pfile:/data/users/njain/hive_commit1/build/ql/scratchdir/hive_2011-02-03_10-40-13_672_8524397052406932420/-ext-10000
           table:
               input format: org.apache.hadoop.mapred.TextInputFormat
               output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -676,7 +676,7 @@ STAGE PLANS:
                 columns.types string:string:string
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location pfile:/data/users/liyintang/hive-1754/build/ql/test/data/warehouse/bucketmapjoin_tmp_result
+                location pfile:/data/users/njain/hive_commit1/build/ql/test/data/warehouse/bucketmapjoin_tmp_result
                 name bucketmapjoin_tmp_result
                 numFiles 1
                 numPartitions 0
@@ -685,23 +685,23 @@ STAGE PLANS:
                 serialization.format 1
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 totalSize 8983
-                transient_lastDdlTime 1288894999
+                transient_lastDdlTime 1296758403
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: bucketmapjoin_tmp_result
-          tmp directory: pfile:/data/users/liyintang/hive-1754/build/ql/scratchdir/hive_2010-11-04_11-23-36_325_7813368709164240016/-ext-10001
+          tmp directory: pfile:/data/users/njain/hive_commit1/build/ql/scratchdir/hive_2011-02-03_10-40-13_672_8524397052406932420/-ext-10001
 
   Stage: Stage-2
     Stats-Aggr Operator
-      Stats Aggregation Key Prefix: pfile:/data/users/liyintang/hive-1754/build/ql/scratchdir/hive_2010-11-04_11-23-36_325_7813368709164240016/-ext-10000/
+      Stats Aggregation Key Prefix: pfile:/data/users/njain/hive_commit1/build/ql/scratchdir/hive_2011-02-03_10-40-13_672_8524397052406932420/-ext-10000/
 
   Stage: Stage-3
     Map Reduce
       Alias -> Map Operator Tree:
-        pfile:/data/users/liyintang/hive-1754/build/ql/scratchdir/hive_2010-11-04_11-23-36_325_7813368709164240016/-ext-10002 
+        pfile:/data/users/njain/hive_commit1/build/ql/scratchdir/hive_2011-02-03_10-40-13_672_8524397052406932420/-ext-10002 
             File Output Operator
               compressed: false
               GlobalTableId: 0
-              directory: pfile:/data/users/liyintang/hive-1754/build/ql/scratchdir/hive_2010-11-04_11-23-36_325_7813368709164240016/-ext-10000
+              directory: pfile:/data/users/njain/hive_commit1/build/ql/scratchdir/hive_2011-02-03_10-40-13_672_8524397052406932420/-ext-10000
               NumFilesPerFileSink: 1
               table:
                   input format: org.apache.hadoop.mapred.TextInputFormat
@@ -712,7 +712,7 @@ STAGE PLANS:
                     columns.types string:string:string
                     file.inputformat org.apache.hadoop.mapred.TextInputFormat
                     file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                    location pfile:/data/users/liyintang/hive-1754/build/ql/test/data/warehouse/bucketmapjoin_tmp_result
+                    location pfile:/data/users/njain/hive_commit1/build/ql/test/data/warehouse/bucketmapjoin_tmp_result
                     name bucketmapjoin_tmp_result
                     numFiles 1
                     numPartitions 0
@@ -721,7 +721,7 @@ STAGE PLANS:
                     serialization.format 1
                     serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                     totalSize 8983
-                    transient_lastDdlTime 1288894999
+                    transient_lastDdlTime 1296758403
                   serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                   name: bucketmapjoin_tmp_result
               TotalFiles: 1
@@ -729,9 +729,9 @@ STAGE PLANS:
               MultiFileSpray: false
       Needs Tagging: false
       Path -> Alias:
-        pfile:/data/users/liyintang/hive-1754/build/ql/scratchdir/hive_2010-11-04_11-23-36_325_7813368709164240016/-ext-10002 [pfile:/data/users/liyintang/hive-1754/build/ql/scratchdir/hive_2010-11-04_11-23-36_325_7813368709164240016/-ext-10002]
+        pfile:/data/users/njain/hive_commit1/build/ql/scratchdir/hive_2011-02-03_10-40-13_672_8524397052406932420/-ext-10002 [pfile:/data/users/njain/hive_commit1/build/ql/scratchdir/hive_2011-02-03_10-40-13_672_8524397052406932420/-ext-10002]
       Path -> Partition:
-        pfile:/data/users/liyintang/hive-1754/build/ql/scratchdir/hive_2010-11-04_11-23-36_325_7813368709164240016/-ext-10002 
+        pfile:/data/users/njain/hive_commit1/build/ql/scratchdir/hive_2011-02-03_10-40-13_672_8524397052406932420/-ext-10002 
           Partition
             base file name: -ext-10002
             input format: org.apache.hadoop.mapred.TextInputFormat
@@ -742,7 +742,7 @@ STAGE PLANS:
               columns.types string:string:string
               file.inputformat org.apache.hadoop.mapred.TextInputFormat
               file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-              location pfile:/data/users/liyintang/hive-1754/build/ql/test/data/warehouse/bucketmapjoin_tmp_result
+              location pfile:/data/users/njain/hive_commit1/build/ql/test/data/warehouse/bucketmapjoin_tmp_result
               name bucketmapjoin_tmp_result
               numFiles 1
               numPartitions 0
@@ -751,7 +751,7 @@ STAGE PLANS:
               serialization.format 1
               serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               totalSize 8983
-              transient_lastDdlTime 1288894999
+              transient_lastDdlTime 1296758403
             serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
           
               input format: org.apache.hadoop.mapred.TextInputFormat
@@ -762,7 +762,7 @@ STAGE PLANS:
                 columns.types string:string:string
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location pfile:/data/users/liyintang/hive-1754/build/ql/test/data/warehouse/bucketmapjoin_tmp_result
+                location pfile:/data/users/njain/hive_commit1/build/ql/test/data/warehouse/bucketmapjoin_tmp_result
                 name bucketmapjoin_tmp_result
                 numFiles 1
                 numPartitions 0
@@ -771,22 +771,22 @@ STAGE PLANS:
                 serialization.format 1
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
                 totalSize 8983
-                transient_lastDdlTime 1288894999
+                transient_lastDdlTime 1296758403
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: bucketmapjoin_tmp_result
             name: bucketmapjoin_tmp_result
 
 
-PREHOOK: query: insert overwrite table bucketmapjoin_tmp_result 
-select /*+mapjoin(a)*/ a.key, a.value, b.value 
-from srcbucket_mapjoin a join srcbucket_mapjoin b 
+PREHOOK: query: insert overwrite table bucketmapjoin_tmp_result
+select /*+mapjoin(a)*/ a.key, a.value, b.value
+from srcbucket_mapjoin a join srcbucket_mapjoin b
 on a.key=b.key
 PREHOOK: type: QUERY
 PREHOOK: Input: default@srcbucket_mapjoin
 PREHOOK: Output: default@bucketmapjoin_tmp_result
-POSTHOOK: query: insert overwrite table bucketmapjoin_tmp_result 
-select /*+mapjoin(a)*/ a.key, a.value, b.value 
-from srcbucket_mapjoin a join srcbucket_mapjoin b 
+POSTHOOK: query: insert overwrite table bucketmapjoin_tmp_result
+select /*+mapjoin(a)*/ a.key, a.value, b.value
+from srcbucket_mapjoin a join srcbucket_mapjoin b
 on a.key=b.key
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcbucket_mapjoin
@@ -809,11 +809,11 @@ POSTHOOK: Lineage: bucketmapjoin_tmp_result.value2 SIMPLE [(srcbucket_mapjoin)b.
 PREHOOK: query: select count(1) from bucketmapjoin_tmp_result
 PREHOOK: type: QUERY
 PREHOOK: Input: default@bucketmapjoin_tmp_result
-PREHOOK: Output: file:/tmp/liyintang/hive_2010-11-04_11-23-51_993_4668218591132162022/-mr-10000
+PREHOOK: Output: file:/tmp/njain/hive_2011-02-03_10-40-22_377_5727516753399224026/-mr-10000
 POSTHOOK: query: select count(1) from bucketmapjoin_tmp_result
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@bucketmapjoin_tmp_result
-POSTHOOK: Output: file:/tmp/liyintang/hive_2010-11-04_11-23-51_993_4668218591132162022/-mr-10000
+POSTHOOK: Output: file:/tmp/njain/hive_2011-02-03_10-40-22_377_5727516753399224026/-mr-10000
 POSTHOOK: Lineage: bucketmapjoin_hash_result_1.key EXPRESSION [(bucketmapjoin_tmp_result)bucketmapjoin_tmp_result.FieldSchema(name:key, type:string, comment:null), ]
 POSTHOOK: Lineage: bucketmapjoin_hash_result_1.value1 EXPRESSION [(bucketmapjoin_tmp_result)bucketmapjoin_tmp_result.FieldSchema(name:value1, type:string, comment:null), ]
 POSTHOOK: Lineage: bucketmapjoin_hash_result_1.value2 EXPRESSION [(bucketmapjoin_tmp_result)bucketmapjoin_tmp_result.FieldSchema(name:value2, type:string, comment:null), ]
@@ -858,16 +858,16 @@ POSTHOOK: Lineage: bucketmapjoin_tmp_result.value1 SIMPLE [(srcbucket_mapjoin)a.
 POSTHOOK: Lineage: bucketmapjoin_tmp_result.value2 SIMPLE [(srcbucket_mapjoin)b.FieldSchema(name:value, type:string, comment:null), ]
 POSTHOOK: Lineage: bucketmapjoin_tmp_result.value2 SIMPLE [(srcbucket_mapjoin)b.FieldSchema(name:value, type:string, comment:null), ]
 POSTHOOK: Lineage: bucketmapjoin_tmp_result.value2 SIMPLE [(srcbucket_mapjoin)b.FieldSchema(name:value, type:string, comment:null), ]
-PREHOOK: query: insert overwrite table bucketmapjoin_tmp_result 
-select /*+mapjoin(a)*/ a.key, a.value, b.value 
-from srcbucket_mapjoin a join srcbucket_mapjoin b 
+PREHOOK: query: insert overwrite table bucketmapjoin_tmp_result
+select /*+mapjoin(a)*/ a.key, a.value, b.value
+from srcbucket_mapjoin a join srcbucket_mapjoin b
 on a.key=b.key
 PREHOOK: type: QUERY
 PREHOOK: Input: default@srcbucket_mapjoin
 PREHOOK: Output: default@bucketmapjoin_tmp_result
-POSTHOOK: query: insert overwrite table bucketmapjoin_tmp_result 
-select /*+mapjoin(a)*/ a.key, a.value, b.value 
-from srcbucket_mapjoin a join srcbucket_mapjoin b 
+POSTHOOK: query: insert overwrite table bucketmapjoin_tmp_result
+select /*+mapjoin(a)*/ a.key, a.value, b.value
+from srcbucket_mapjoin a join srcbucket_mapjoin b
 on a.key=b.key
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcbucket_mapjoin
@@ -896,11 +896,11 @@ POSTHOOK: Lineage: bucketmapjoin_tmp_result.value2 SIMPLE [(srcbucket_mapjoin)b.
 PREHOOK: query: select count(1) from bucketmapjoin_tmp_result
 PREHOOK: type: QUERY
 PREHOOK: Input: default@bucketmapjoin_tmp_result
-PREHOOK: Output: file:/tmp/liyintang/hive_2010-11-04_11-24-23_108_4512355766611583689/-mr-10000
+PREHOOK: Output: file:/tmp/njain/hive_2011-02-03_10-40-37_249_1616452678927934445/-mr-10000
 POSTHOOK: query: select count(1) from bucketmapjoin_tmp_result
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@bucketmapjoin_tmp_result
-POSTHOOK: Output: file:/tmp/liyintang/hive_2010-11-04_11-24-23_108_4512355766611583689/-mr-10000
+POSTHOOK: Output: file:/tmp/njain/hive_2011-02-03_10-40-37_249_1616452678927934445/-mr-10000
 POSTHOOK: Lineage: bucketmapjoin_hash_result_1.key EXPRESSION [(bucketmapjoin_tmp_result)bucketmapjoin_tmp_result.FieldSchema(name:key, type:string, comment:null), ]
 POSTHOOK: Lineage: bucketmapjoin_hash_result_1.key EXPRESSION [(bucketmapjoin_tmp_result)bucketmapjoin_tmp_result.FieldSchema(name:key, type:string, comment:null), ]
 POSTHOOK: Lineage: bucketmapjoin_hash_result_1.value1 EXPRESSION [(bucketmapjoin_tmp_result)bucketmapjoin_tmp_result.FieldSchema(name:value1, type:string, comment:null), ]
@@ -963,14 +963,14 @@ on a.key = b.key
 PREHOOK: type: QUERY
 PREHOOK: Input: default@bucketmapjoin_hash_result_1
 PREHOOK: Input: default@bucketmapjoin_hash_result_2
-PREHOOK: Output: file:/tmp/liyintang/hive_2010-11-04_11-24-35_316_1675503630341751532/-mr-10000
+PREHOOK: Output: file:/tmp/njain/hive_2011-02-03_10-40-44_035_1613079877808759652/-mr-10000
 POSTHOOK: query: select a.key-b.key, a.value1-b.value1, a.value2-b.value2
 from bucketmapjoin_hash_result_1 a left outer join bucketmapjoin_hash_result_2 b
 on a.key = b.key
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@bucketmapjoin_hash_result_1
 POSTHOOK: Input: default@bucketmapjoin_hash_result_2
-POSTHOOK: Output: file:/tmp/liyintang/hive_2010-11-04_11-24-35_316_1675503630341751532/-mr-10000
+POSTHOOK: Output: file:/tmp/njain/hive_2011-02-03_10-40-44_035_1613079877808759652/-mr-10000
 POSTHOOK: Lineage: bucketmapjoin_hash_result_1.key EXPRESSION [(bucketmapjoin_tmp_result)bucketmapjoin_tmp_result.FieldSchema(name:key, type:string, comment:null), ]
 POSTHOOK: Lineage: bucketmapjoin_hash_result_1.key EXPRESSION [(bucketmapjoin_tmp_result)bucketmapjoin_tmp_result.FieldSchema(name:key, type:string, comment:null), ]
 POSTHOOK: Lineage: bucketmapjoin_hash_result_1.value1 EXPRESSION [(bucketmapjoin_tmp_result)bucketmapjoin_tmp_result.FieldSchema(name:value1, type:string, comment:null), ]
diff --git a/ql/src/test/results/clientpositive/input_part7.q.out b/ql/src/test/results/clientpositive/input_part7.q.out
index 21c10bb569..3c6a0f2f57 100644
--- a/ql/src/test/results/clientpositive/input_part7.q.out
+++ b/ql/src/test/results/clientpositive/input_part7.q.out
@@ -1,21 +1,21 @@
-PREHOOK: query: EXPLAIN EXTENDED 
+PREHOOK: query: EXPLAIN EXTENDED
 SELECT * FROM (
   SELECT X.* FROM SRCPART X WHERE X.ds = '2008-04-08' and X.key < 100
   UNION ALL
   SELECT Y.* FROM SRCPART Y WHERE Y.ds = '2008-04-08' and Y.key < 100
 ) A
-SORT BY A.key
+SORT BY A.key, A.value, A.ds, A.hr
 PREHOOK: type: QUERY
-POSTHOOK: query: EXPLAIN EXTENDED 
+POSTHOOK: query: EXPLAIN EXTENDED
 SELECT * FROM (
   SELECT X.* FROM SRCPART X WHERE X.ds = '2008-04-08' and X.key < 100
   UNION ALL
   SELECT Y.* FROM SRCPART Y WHERE Y.ds = '2008-04-08' and Y.key < 100
 ) A
-SORT BY A.key
+SORT BY A.key, A.value, A.ds, A.hr
 POSTHOOK: type: QUERY
 ABSTRACT SYNTAX TREE:
-  (TOK_QUERY (TOK_FROM (TOK_SUBQUERY (TOK_UNION (TOK_QUERY (TOK_FROM (TOK_TABREF SRCPART X)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_ALLCOLREF X))) (TOK_WHERE (and (= (. (TOK_TABLE_OR_COL X) ds) '2008-04-08') (< (. (TOK_TABLE_OR_COL X) key) 100))))) (TOK_QUERY (TOK_FROM (TOK_TABREF SRCPART Y)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_ALLCOLREF Y))) (TOK_WHERE (and (= (. (TOK_TABLE_OR_COL Y) ds) '2008-04-08') (< (. (TOK_TABLE_OR_COL Y) key) 100)))))) A)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR TOK_ALLCOLREF)) (TOK_SORTBY (TOK_TABSORTCOLNAMEASC (. (TOK_TABLE_OR_COL A) key)))))
+  (TOK_QUERY (TOK_FROM (TOK_SUBQUERY (TOK_UNION (TOK_QUERY (TOK_FROM (TOK_TABREF SRCPART X)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_ALLCOLREF X))) (TOK_WHERE (and (= (. (TOK_TABLE_OR_COL X) ds) '2008-04-08') (< (. (TOK_TABLE_OR_COL X) key) 100))))) (TOK_QUERY (TOK_FROM (TOK_TABREF SRCPART Y)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_ALLCOLREF Y))) (TOK_WHERE (and (= (. (TOK_TABLE_OR_COL Y) ds) '2008-04-08') (< (. (TOK_TABLE_OR_COL Y) key) 100)))))) A)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR TOK_ALLCOLREF)) (TOK_SORTBY (TOK_TABSORTCOLNAMEASC (. (TOK_TABLE_OR_COL A) key)) (TOK_TABSORTCOLNAMEASC (. (TOK_TABLE_OR_COL A) value)) (TOK_TABSORTCOLNAMEASC (. (TOK_TABLE_OR_COL A) ds)) (TOK_TABSORTCOLNAMEASC (. (TOK_TABLE_OR_COL A) hr)))))
 
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
@@ -66,7 +66,13 @@ STAGE PLANS:
                         key expressions:
                               expr: _col0
                               type: string
-                        sort order: +
+                              expr: _col1
+                              type: string
+                              expr: _col2
+                              type: string
+                              expr: _col3
+                              type: string
+                        sort order: ++++
                         tag: -1
                         value expressions:
                               expr: _col0
@@ -118,7 +124,13 @@ STAGE PLANS:
                         key expressions:
                               expr: _col0
                               type: string
-                        sort order: +
+                              expr: _col1
+                              type: string
+                              expr: _col2
+                              type: string
+                              expr: _col3
+                              type: string
+                        sort order: ++++
                         tag: -1
                         value expressions:
                               expr: _col0
@@ -131,10 +143,10 @@ STAGE PLANS:
                               type: string
       Needs Tagging: false
       Path -> Alias:
-        pfile:/data/users/sdong/www/hive-trunk/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 [null-subquery1:a-subquery1:x, null-subquery2:a-subquery2:y]
-        pfile:/data/users/sdong/www/hive-trunk/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12 [null-subquery1:a-subquery1:x, null-subquery2:a-subquery2:y]
+        pfile:/data/users/njain/hive_commit1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 [null-subquery1:a-subquery1:x, null-subquery2:a-subquery2:y]
+        pfile:/data/users/njain/hive_commit1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12 [null-subquery1:a-subquery1:x, null-subquery2:a-subquery2:y]
       Path -> Partition:
-        pfile:/data/users/sdong/www/hive-trunk/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 
+        pfile:/data/users/njain/hive_commit1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 
           Partition
             base file name: hr=11
             input format: org.apache.hadoop.mapred.TextInputFormat
@@ -148,13 +160,13 @@ STAGE PLANS:
               columns.types string:string
               file.inputformat org.apache.hadoop.mapred.TextInputFormat
               file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-              location pfile:/data/users/sdong/www/hive-trunk/build/ql/test/data/warehouse/srcpart
+              location pfile:/data/users/njain/hive_commit1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11
               name srcpart
               partition_columns ds/hr
               serialization.ddl struct srcpart { string key, string value}
               serialization.format 1
               serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-              transient_lastDdlTime 1288389287
+              transient_lastDdlTime 1296760001
             serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
           
               input format: org.apache.hadoop.mapred.TextInputFormat
@@ -165,17 +177,17 @@ STAGE PLANS:
                 columns.types string:string
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location pfile:/data/users/sdong/www/hive-trunk/build/ql/test/data/warehouse/srcpart
+                location pfile:/data/users/njain/hive_commit1/build/ql/test/data/warehouse/srcpart
                 name srcpart
                 partition_columns ds/hr
                 serialization.ddl struct srcpart { string key, string value}
                 serialization.format 1
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                transient_lastDdlTime 1288389287
+                transient_lastDdlTime 1296760001
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: srcpart
             name: srcpart
-        pfile:/data/users/sdong/www/hive-trunk/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12 
+        pfile:/data/users/njain/hive_commit1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12 
           Partition
             base file name: hr=12
             input format: org.apache.hadoop.mapred.TextInputFormat
@@ -189,13 +201,13 @@ STAGE PLANS:
               columns.types string:string
               file.inputformat org.apache.hadoop.mapred.TextInputFormat
               file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-              location pfile:/data/users/sdong/www/hive-trunk/build/ql/test/data/warehouse/srcpart
+              location pfile:/data/users/njain/hive_commit1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12
               name srcpart
               partition_columns ds/hr
               serialization.ddl struct srcpart { string key, string value}
               serialization.format 1
               serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-              transient_lastDdlTime 1288389287
+              transient_lastDdlTime 1296760001
             serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
           
               input format: org.apache.hadoop.mapred.TextInputFormat
@@ -206,13 +218,13 @@ STAGE PLANS:
                 columns.types string:string
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location pfile:/data/users/sdong/www/hive-trunk/build/ql/test/data/warehouse/srcpart
+                location pfile:/data/users/njain/hive_commit1/build/ql/test/data/warehouse/srcpart
                 name srcpart
                 partition_columns ds/hr
                 serialization.ddl struct srcpart { string key, string value}
                 serialization.format 1
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                transient_lastDdlTime 1288389287
+                transient_lastDdlTime 1296760001
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: srcpart
             name: srcpart
@@ -221,9 +233,9 @@ STAGE PLANS:
           File Output Operator
             compressed: false
             GlobalTableId: 0
-            directory: file:/tmp/sdong/hive_2010-10-29_15-34-09_209_7181704230582070311/-ext-10001
+            directory: file:/tmp/njain/hive_2011-02-03_11-06-52_255_8150535869499892719/-ext-10001
             NumFilesPerFileSink: 1
-            Stats Publishing Key Prefix: file:/tmp/sdong/hive_2010-10-29_15-34-09_209_7181704230582070311/-ext-10001/
+            Stats Publishing Key Prefix: file:/tmp/njain/hive_2011-02-03_11-06-52_255_8150535869499892719/-ext-10001/
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -245,21 +257,21 @@ PREHOOK: query: SELECT * FROM (
   UNION ALL
   SELECT Y.* FROM SRCPART Y WHERE Y.ds = '2008-04-08' and Y.key < 100
 ) A
-SORT BY A.key
+SORT BY A.key, A.value, A.ds, A.hr
 PREHOOK: type: QUERY
 PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
-PREHOOK: Output: file:/tmp/sdong/hive_2010-10-29_15-34-09_364_978163510203107296/-mr-10000
+PREHOOK: Output: file:/tmp/njain/hive_2011-02-03_11-06-52_647_4598400577694048071/-mr-10000
 POSTHOOK: query: SELECT * FROM (
   SELECT X.* FROM SRCPART X WHERE X.ds = '2008-04-08' and X.key < 100
   UNION ALL
   SELECT Y.* FROM SRCPART Y WHERE Y.ds = '2008-04-08' and Y.key < 100
 ) A
-SORT BY A.key
+SORT BY A.key, A.value, A.ds, A.hr
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
-POSTHOOK: Output: file:/tmp/sdong/hive_2010-10-29_15-34-09_364_978163510203107296/-mr-10000
+POSTHOOK: Output: file:/tmp/njain/hive_2011-02-03_11-06-52_647_4598400577694048071/-mr-10000
 0	val_0	2008-04-08	11
 0	val_0	2008-04-08	11
 0	val_0	2008-04-08	11
@@ -272,22 +284,22 @@ POSTHOOK: Output: file:/tmp/sdong/hive_2010-10-29_15-34-09_364_97816351020310729
 0	val_0	2008-04-08	12
 0	val_0	2008-04-08	12
 0	val_0	2008-04-08	12
-10	val_10	2008-04-08	12
-10	val_10	2008-04-08	12
 10	val_10	2008-04-08	11
 10	val_10	2008-04-08	11
+10	val_10	2008-04-08	12
+10	val_10	2008-04-08	12
 11	val_11	2008-04-08	11
 11	val_11	2008-04-08	11
 11	val_11	2008-04-08	12
 11	val_11	2008-04-08	12
-12	val_12	2008-04-08	12
-12	val_12	2008-04-08	12
-12	val_12	2008-04-08	12
-12	val_12	2008-04-08	12
 12	val_12	2008-04-08	11
 12	val_12	2008-04-08	11
 12	val_12	2008-04-08	11
 12	val_12	2008-04-08	11
+12	val_12	2008-04-08	12
+12	val_12	2008-04-08	12
+12	val_12	2008-04-08	12
+12	val_12	2008-04-08	12
 15	val_15	2008-04-08	11
 15	val_15	2008-04-08	11
 15	val_15	2008-04-08	11
@@ -296,10 +308,10 @@ POSTHOOK: Output: file:/tmp/sdong/hive_2010-10-29_15-34-09_364_97816351020310729
 15	val_15	2008-04-08	12
 15	val_15	2008-04-08	12
 15	val_15	2008-04-08	12
-17	val_17	2008-04-08	12
-17	val_17	2008-04-08	12
 17	val_17	2008-04-08	11
 17	val_17	2008-04-08	11
+17	val_17	2008-04-08	12
+17	val_17	2008-04-08	12
 18	val_18	2008-04-08	11
 18	val_18	2008-04-08	11
 18	val_18	2008-04-08	11
@@ -308,18 +320,18 @@ POSTHOOK: Output: file:/tmp/sdong/hive_2010-10-29_15-34-09_364_97816351020310729
 18	val_18	2008-04-08	12
 18	val_18	2008-04-08	12
 18	val_18	2008-04-08	12
-19	val_19	2008-04-08	12
-19	val_19	2008-04-08	12
 19	val_19	2008-04-08	11
 19	val_19	2008-04-08	11
+19	val_19	2008-04-08	12
+19	val_19	2008-04-08	12
 2	val_2	2008-04-08	11
 2	val_2	2008-04-08	11
 2	val_2	2008-04-08	12
 2	val_2	2008-04-08	12
-20	val_20	2008-04-08	12
-20	val_20	2008-04-08	12
 20	val_20	2008-04-08	11
 20	val_20	2008-04-08	11
+20	val_20	2008-04-08	12
+20	val_20	2008-04-08	12
 24	val_24	2008-04-08	11
 24	val_24	2008-04-08	11
 24	val_24	2008-04-08	11
@@ -328,46 +340,46 @@ POSTHOOK: Output: file:/tmp/sdong/hive_2010-10-29_15-34-09_364_97816351020310729
 24	val_24	2008-04-08	12
 24	val_24	2008-04-08	12
 24	val_24	2008-04-08	12
-26	val_26	2008-04-08	12
-26	val_26	2008-04-08	12
-26	val_26	2008-04-08	12
-26	val_26	2008-04-08	12
 26	val_26	2008-04-08	11
 26	val_26	2008-04-08	11
 26	val_26	2008-04-08	11
 26	val_26	2008-04-08	11
+26	val_26	2008-04-08	12
+26	val_26	2008-04-08	12
+26	val_26	2008-04-08	12
+26	val_26	2008-04-08	12
 27	val_27	2008-04-08	11
 27	val_27	2008-04-08	11
 27	val_27	2008-04-08	12
 27	val_27	2008-04-08	12
-28	val_28	2008-04-08	12
-28	val_28	2008-04-08	12
 28	val_28	2008-04-08	11
 28	val_28	2008-04-08	11
+28	val_28	2008-04-08	12
+28	val_28	2008-04-08	12
 30	val_30	2008-04-08	11
 30	val_30	2008-04-08	11
 30	val_30	2008-04-08	12
 30	val_30	2008-04-08	12
-33	val_33	2008-04-08	12
-33	val_33	2008-04-08	12
 33	val_33	2008-04-08	11
 33	val_33	2008-04-08	11
+33	val_33	2008-04-08	12
+33	val_33	2008-04-08	12
 34	val_34	2008-04-08	11
 34	val_34	2008-04-08	11
 34	val_34	2008-04-08	12
 34	val_34	2008-04-08	12
-35	val_35	2008-04-08	12
-35	val_35	2008-04-08	12
-35	val_35	2008-04-08	12
-35	val_35	2008-04-08	12
-35	val_35	2008-04-08	12
-35	val_35	2008-04-08	12
 35	val_35	2008-04-08	11
 35	val_35	2008-04-08	11
 35	val_35	2008-04-08	11
 35	val_35	2008-04-08	11
 35	val_35	2008-04-08	11
 35	val_35	2008-04-08	11
+35	val_35	2008-04-08	12
+35	val_35	2008-04-08	12
+35	val_35	2008-04-08	12
+35	val_35	2008-04-08	12
+35	val_35	2008-04-08	12
+35	val_35	2008-04-08	12
 37	val_37	2008-04-08	11
 37	val_37	2008-04-08	11
 37	val_37	2008-04-08	11
@@ -376,46 +388,46 @@ POSTHOOK: Output: file:/tmp/sdong/hive_2010-10-29_15-34-09_364_97816351020310729
 37	val_37	2008-04-08	12
 37	val_37	2008-04-08	12
 37	val_37	2008-04-08	12
-4	val_4	2008-04-08	12
-4	val_4	2008-04-08	12
 4	val_4	2008-04-08	11
 4	val_4	2008-04-08	11
+4	val_4	2008-04-08	12
+4	val_4	2008-04-08	12
 41	val_41	2008-04-08	11
 41	val_41	2008-04-08	11
 41	val_41	2008-04-08	12
 41	val_41	2008-04-08	12
-42	val_42	2008-04-08	12
-42	val_42	2008-04-08	12
-42	val_42	2008-04-08	12
-42	val_42	2008-04-08	12
 42	val_42	2008-04-08	11
 42	val_42	2008-04-08	11
 42	val_42	2008-04-08	11
 42	val_42	2008-04-08	11
+42	val_42	2008-04-08	12
+42	val_42	2008-04-08	12
+42	val_42	2008-04-08	12
+42	val_42	2008-04-08	12
 43	val_43	2008-04-08	11
 43	val_43	2008-04-08	11
 43	val_43	2008-04-08	12
 43	val_43	2008-04-08	12
-44	val_44	2008-04-08	12
-44	val_44	2008-04-08	12
 44	val_44	2008-04-08	11
 44	val_44	2008-04-08	11
+44	val_44	2008-04-08	12
+44	val_44	2008-04-08	12
 47	val_47	2008-04-08	11
 47	val_47	2008-04-08	11
 47	val_47	2008-04-08	12
 47	val_47	2008-04-08	12
-5	val_5	2008-04-08	12
-5	val_5	2008-04-08	12
-5	val_5	2008-04-08	12
-5	val_5	2008-04-08	12
-5	val_5	2008-04-08	12
-5	val_5	2008-04-08	12
 5	val_5	2008-04-08	11
 5	val_5	2008-04-08	11
 5	val_5	2008-04-08	11
 5	val_5	2008-04-08	11
 5	val_5	2008-04-08	11
 5	val_5	2008-04-08	11
+5	val_5	2008-04-08	12
+5	val_5	2008-04-08	12
+5	val_5	2008-04-08	12
+5	val_5	2008-04-08	12
+5	val_5	2008-04-08	12
+5	val_5	2008-04-08	12
 51	val_51	2008-04-08	11
 51	val_51	2008-04-08	11
 51	val_51	2008-04-08	11
@@ -424,18 +436,18 @@ POSTHOOK: Output: file:/tmp/sdong/hive_2010-10-29_15-34-09_364_97816351020310729
 51	val_51	2008-04-08	12
 51	val_51	2008-04-08	12
 51	val_51	2008-04-08	12
-53	val_53	2008-04-08	12
-53	val_53	2008-04-08	12
 53	val_53	2008-04-08	11
 53	val_53	2008-04-08	11
+53	val_53	2008-04-08	12
+53	val_53	2008-04-08	12
 54	val_54	2008-04-08	11
 54	val_54	2008-04-08	11
 54	val_54	2008-04-08	12
 54	val_54	2008-04-08	12
-57	val_57	2008-04-08	12
-57	val_57	2008-04-08	12
 57	val_57	2008-04-08	11
 57	val_57	2008-04-08	11
+57	val_57	2008-04-08	12
+57	val_57	2008-04-08	12
 58	val_58	2008-04-08	11
 58	val_58	2008-04-08	11
 58	val_58	2008-04-08	11
@@ -444,18 +456,18 @@ POSTHOOK: Output: file:/tmp/sdong/hive_2010-10-29_15-34-09_364_97816351020310729
 58	val_58	2008-04-08	12
 58	val_58	2008-04-08	12
 58	val_58	2008-04-08	12
-64	val_64	2008-04-08	12
-64	val_64	2008-04-08	12
 64	val_64	2008-04-08	11
 64	val_64	2008-04-08	11
+64	val_64	2008-04-08	12
+64	val_64	2008-04-08	12
 65	val_65	2008-04-08	11
 65	val_65	2008-04-08	11
 65	val_65	2008-04-08	12
 65	val_65	2008-04-08	12
-66	val_66	2008-04-08	12
-66	val_66	2008-04-08	12
 66	val_66	2008-04-08	11
 66	val_66	2008-04-08	11
+66	val_66	2008-04-08	12
+66	val_66	2008-04-08	12
 67	val_67	2008-04-08	11
 67	val_67	2008-04-08	11
 67	val_67	2008-04-08	11
@@ -464,10 +476,10 @@ POSTHOOK: Output: file:/tmp/sdong/hive_2010-10-29_15-34-09_364_97816351020310729
 67	val_67	2008-04-08	12
 67	val_67	2008-04-08	12
 67	val_67	2008-04-08	12
-69	val_69	2008-04-08	12
-69	val_69	2008-04-08	12
 69	val_69	2008-04-08	11
 69	val_69	2008-04-08	11
+69	val_69	2008-04-08	12
+69	val_69	2008-04-08	12
 70	val_70	2008-04-08	11
 70	val_70	2008-04-08	11
 70	val_70	2008-04-08	11
@@ -480,54 +492,54 @@ POSTHOOK: Output: file:/tmp/sdong/hive_2010-10-29_15-34-09_364_97816351020310729
 70	val_70	2008-04-08	12
 70	val_70	2008-04-08	12
 70	val_70	2008-04-08	12
-72	val_72	2008-04-08	12
-72	val_72	2008-04-08	12
-72	val_72	2008-04-08	12
-72	val_72	2008-04-08	12
 72	val_72	2008-04-08	11
 72	val_72	2008-04-08	11
 72	val_72	2008-04-08	11
 72	val_72	2008-04-08	11
+72	val_72	2008-04-08	12
+72	val_72	2008-04-08	12
+72	val_72	2008-04-08	12
+72	val_72	2008-04-08	12
 74	val_74	2008-04-08	11
 74	val_74	2008-04-08	11
 74	val_74	2008-04-08	12
 74	val_74	2008-04-08	12
-76	val_76	2008-04-08	12
-76	val_76	2008-04-08	12
-76	val_76	2008-04-08	12
-76	val_76	2008-04-08	12
 76	val_76	2008-04-08	11
 76	val_76	2008-04-08	11
 76	val_76	2008-04-08	11
 76	val_76	2008-04-08	11
+76	val_76	2008-04-08	12
+76	val_76	2008-04-08	12
+76	val_76	2008-04-08	12
+76	val_76	2008-04-08	12
 77	val_77	2008-04-08	11
 77	val_77	2008-04-08	11
 77	val_77	2008-04-08	12
 77	val_77	2008-04-08	12
-78	val_78	2008-04-08	12
-78	val_78	2008-04-08	12
 78	val_78	2008-04-08	11
 78	val_78	2008-04-08	11
+78	val_78	2008-04-08	12
+78	val_78	2008-04-08	12
 8	val_8	2008-04-08	11
 8	val_8	2008-04-08	11
 8	val_8	2008-04-08	12
 8	val_8	2008-04-08	12
-80	val_80	2008-04-08	12
-80	val_80	2008-04-08	12
 80	val_80	2008-04-08	11
 80	val_80	2008-04-08	11
+80	val_80	2008-04-08	12
+80	val_80	2008-04-08	12
 82	val_82	2008-04-08	11
 82	val_82	2008-04-08	11
 82	val_82	2008-04-08	12
 82	val_82	2008-04-08	12
-83	val_83	2008-04-08	12
-83	val_83	2008-04-08	12
-83	val_83	2008-04-08	12
-83	val_83	2008-04-08	12
 83	val_83	2008-04-08	11
 83	val_83	2008-04-08	11
 83	val_83	2008-04-08	11
 83	val_83	2008-04-08	11
+83	val_83	2008-04-08	12
+83	val_83	2008-04-08	12
+83	val_83	2008-04-08	12
+83	val_83	2008-04-08	12
 84	val_84	2008-04-08	11
 84	val_84	2008-04-08	11
 84	val_84	2008-04-08	11
@@ -536,58 +548,58 @@ POSTHOOK: Output: file:/tmp/sdong/hive_2010-10-29_15-34-09_364_97816351020310729
 84	val_84	2008-04-08	12
 84	val_84	2008-04-08	12
 84	val_84	2008-04-08	12
-85	val_85	2008-04-08	12
-85	val_85	2008-04-08	12
 85	val_85	2008-04-08	11
 85	val_85	2008-04-08	11
+85	val_85	2008-04-08	12
+85	val_85	2008-04-08	12
 86	val_86	2008-04-08	11
 86	val_86	2008-04-08	11
 86	val_86	2008-04-08	12
 86	val_86	2008-04-08	12
-87	val_87	2008-04-08	12
-87	val_87	2008-04-08	12
 87	val_87	2008-04-08	11
 87	val_87	2008-04-08	11
+87	val_87	2008-04-08	12
+87	val_87	2008-04-08	12
 9	val_9	2008-04-08	11
 9	val_9	2008-04-08	11
 9	val_9	2008-04-08	12
 9	val_9	2008-04-08	12
-90	val_90	2008-04-08	12
-90	val_90	2008-04-08	12
-90	val_90	2008-04-08	12
-90	val_90	2008-04-08	12
-90	val_90	2008-04-08	12
-90	val_90	2008-04-08	12
 90	val_90	2008-04-08	11
 90	val_90	2008-04-08	11
 90	val_90	2008-04-08	11
 90	val_90	2008-04-08	11
 90	val_90	2008-04-08	11
 90	val_90	2008-04-08	11
+90	val_90	2008-04-08	12
+90	val_90	2008-04-08	12
+90	val_90	2008-04-08	12
+90	val_90	2008-04-08	12
+90	val_90	2008-04-08	12
+90	val_90	2008-04-08	12
 92	val_92	2008-04-08	11
 92	val_92	2008-04-08	11
 92	val_92	2008-04-08	12
 92	val_92	2008-04-08	12
-95	val_95	2008-04-08	12
-95	val_95	2008-04-08	12
-95	val_95	2008-04-08	12
-95	val_95	2008-04-08	12
 95	val_95	2008-04-08	11
 95	val_95	2008-04-08	11
 95	val_95	2008-04-08	11
 95	val_95	2008-04-08	11
+95	val_95	2008-04-08	12
+95	val_95	2008-04-08	12
+95	val_95	2008-04-08	12
+95	val_95	2008-04-08	12
 96	val_96	2008-04-08	11
 96	val_96	2008-04-08	11
 96	val_96	2008-04-08	12
 96	val_96	2008-04-08	12
-97	val_97	2008-04-08	12
-97	val_97	2008-04-08	12
-97	val_97	2008-04-08	12
-97	val_97	2008-04-08	12
 97	val_97	2008-04-08	11
 97	val_97	2008-04-08	11
 97	val_97	2008-04-08	11
 97	val_97	2008-04-08	11
+97	val_97	2008-04-08	12
+97	val_97	2008-04-08	12
+97	val_97	2008-04-08	12
+97	val_97	2008-04-08	12
 98	val_98	2008-04-08	11
 98	val_98	2008-04-08	11
 98	val_98	2008-04-08	11
diff --git a/ql/src/test/results/clientpositive/partition_vs_table_metadata.q.out b/ql/src/test/results/clientpositive/partition_vs_table_metadata.q.out
index d159ab1c05..1ba620cb55 100644
--- a/ql/src/test/results/clientpositive/partition_vs_table_metadata.q.out
+++ b/ql/src/test/results/clientpositive/partition_vs_table_metadata.q.out
@@ -37,17 +37,17 @@ POSTHOOK: Lineage: partition_vs_table PARTITION(ds=101).key SIMPLE [(src)src.Fie
 POSTHOOK: Lineage: partition_vs_table PARTITION(ds=101).newcol SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: partition_vs_table PARTITION(ds=101).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 PREHOOK: query: select key, value, newcol from partition_vs_table
-order by key
+order by key, value, newcol
 PREHOOK: type: QUERY
 PREHOOK: Input: default@partition_vs_table@ds=100
 PREHOOK: Input: default@partition_vs_table@ds=101
-PREHOOK: Output: file:/tmp/njain/hive_2010-08-17_00-28-35_949_706393903088310087/-mr-10000
+PREHOOK: Output: file:/tmp/njain/hive_2011-02-03_11-07-06_731_7368058619549828473/-mr-10000
 POSTHOOK: query: select key, value, newcol from partition_vs_table
-order by key
+order by key, value, newcol
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@partition_vs_table@ds=100
 POSTHOOK: Input: default@partition_vs_table@ds=101
-POSTHOOK: Output: file:/tmp/njain/hive_2010-08-17_00-28-35_949_706393903088310087/-mr-10000
+POSTHOOK: Output: file:/tmp/njain/hive_2011-02-03_11-07-06_731_7368058619549828473/-mr-10000
 POSTHOOK: Lineage: partition_vs_table PARTITION(ds=100).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
 POSTHOOK: Lineage: partition_vs_table PARTITION(ds=100).value SIMPLE [(src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: partition_vs_table PARTITION(ds=101).key SIMPLE [(src)src.FieldSchema(name:key, type:string, comment:default), ]
@@ -59,82 +59,82 @@ POSTHOOK: Lineage: partition_vs_table PARTITION(ds=101).value SIMPLE [(src)src.F
 0	val_0	0
 0	val_0	0
 0	val_0	0
-10	val_10	10
 10	val_10	NULL
+10	val_10	10
 100	val_100	NULL
 100	val_100	NULL
 100	val_100	100
 100	val_100	100
-103	val_103	103
-103	val_103	103
 103	val_103	NULL
 103	val_103	NULL
+103	val_103	103
+103	val_103	103
 104	val_104	NULL
 104	val_104	NULL
 104	val_104	104
 104	val_104	104
-105	val_105	105
 105	val_105	NULL
+105	val_105	105
 11	val_11	NULL
 11	val_11	11
-111	val_111	111
 111	val_111	NULL
+111	val_111	111
 113	val_113	NULL
 113	val_113	NULL
 113	val_113	113
 113	val_113	113
-114	val_114	114
 114	val_114	NULL
+114	val_114	114
 116	val_116	NULL
 116	val_116	116
-118	val_118	118
-118	val_118	118
 118	val_118	NULL
 118	val_118	NULL
+118	val_118	118
+118	val_118	118
 119	val_119	NULL
 119	val_119	NULL
 119	val_119	NULL
 119	val_119	119
 119	val_119	119
 119	val_119	119
-12	val_12	12
-12	val_12	12
 12	val_12	NULL
 12	val_12	NULL
+12	val_12	12
+12	val_12	12
 120	val_120	NULL
 120	val_120	NULL
 120	val_120	120
 120	val_120	120
-125	val_125	125
-125	val_125	125
 125	val_125	NULL
 125	val_125	NULL
+125	val_125	125
+125	val_125	125
 126	val_126	NULL
 126	val_126	126
-128	val_128	128
-128	val_128	128
-128	val_128	128
 128	val_128	NULL
 128	val_128	NULL
 128	val_128	NULL
+128	val_128	128
+128	val_128	128
+128	val_128	128
 129	val_129	NULL
 129	val_129	NULL
 129	val_129	129
 129	val_129	129
-131	val_131	131
 131	val_131	NULL
+131	val_131	131
 133	val_133	NULL
 133	val_133	133
-134	val_134	134
-134	val_134	134
 134	val_134	NULL
 134	val_134	NULL
+134	val_134	134
+134	val_134	134
 136	val_136	NULL
 136	val_136	136
-137	val_137	137
-137	val_137	137
 137	val_137	NULL
 137	val_137	NULL
+137	val_137	137
+137	val_137	137
 138	val_138	NULL
 138	val_138	NULL
 138	val_138	NULL
@@ -143,320 +143,320 @@ POSTHOOK: Lineage: partition_vs_table PARTITION(ds=101).value SIMPLE [(src)src.F
 138	val_138	138
 138	val_138	138
 138	val_138	138
-143	val_143	143
 143	val_143	NULL
+143	val_143	143
 145	val_145	NULL
 145	val_145	145
-146	val_146	146
-146	val_146	146
 146	val_146	NULL
 146	val_146	NULL
+146	val_146	146
+146	val_146	146
 149	val_149	NULL
 149	val_149	NULL
 149	val_149	149
 149	val_149	149
-15	val_15	15
-15	val_15	15
 15	val_15	NULL
 15	val_15	NULL
+15	val_15	15
+15	val_15	15
 150	val_150	NULL
 150	val_150	150
-152	val_152	152
-152	val_152	152
 152	val_152	NULL
 152	val_152	NULL
+152	val_152	152
+152	val_152	152
 153	val_153	NULL
 153	val_153	153
-155	val_155	155
 155	val_155	NULL
+155	val_155	155
 156	val_156	NULL
 156	val_156	156
-157	val_157	157
 157	val_157	NULL
+157	val_157	157
 158	val_158	NULL
 158	val_158	158
-160	val_160	160
 160	val_160	NULL
+160	val_160	160
 162	val_162	NULL
 162	val_162	162
-163	val_163	163
 163	val_163	NULL
+163	val_163	163
 164	val_164	NULL
 164	val_164	NULL
 164	val_164	164
 164	val_164	164
-165	val_165	165
-165	val_165	165
 165	val_165	NULL
 165	val_165	NULL
+165	val_165	165
+165	val_165	165
 166	val_166	NULL
 166	val_166	166
-167	val_167	167
-167	val_167	167
-167	val_167	167
 167	val_167	NULL
 167	val_167	NULL
 167	val_167	NULL
+167	val_167	167
+167	val_167	167
+167	val_167	167
 168	val_168	NULL
 168	val_168	168
-169	val_169	169
-169	val_169	169
-169	val_169	169
-169	val_169	169
 169	val_169	NULL
 169	val_169	NULL
 169	val_169	NULL
 169	val_169	NULL
+169	val_169	169
+169	val_169	169
+169	val_169	169
+169	val_169	169
 17	val_17	NULL
 17	val_17	17
-170	val_170	170
 170	val_170	NULL
+170	val_170	170
 172	val_172	NULL
 172	val_172	NULL
 172	val_172	172
 172	val_172	172
-174	val_174	174
-174	val_174	174
 174	val_174	NULL
 174	val_174	NULL
+174	val_174	174
+174	val_174	174
 175	val_175	NULL
 175	val_175	NULL
 175	val_175	175
 175	val_175	175
-176	val_176	176
-176	val_176	176
 176	val_176	NULL
 176	val_176	NULL
+176	val_176	176
+176	val_176	176
 177	val_177	NULL
 177	val_177	177
-178	val_178	178
 178	val_178	NULL
+178	val_178	178
 179	val_179	NULL
 179	val_179	NULL
 179	val_179	179
 179	val_179	179
-18	val_18	18
-18	val_18	18
 18	val_18	NULL
 18	val_18	NULL
+18	val_18	18
+18	val_18	18
 180	val_180	NULL
 180	val_180	180
-181	val_181	181
 181	val_181	NULL
+181	val_181	181
 183	val_183	NULL
 183	val_183	183
-186	val_186	186
 186	val_186	NULL
+186	val_186	186
 187	val_187	NULL
 187	val_187	NULL
 187	val_187	NULL
 187	val_187	187
 187	val_187	187
 187	val_187	187
-189	val_189	189
 189	val_189	NULL
+189	val_189	189
 19	val_19	NULL
 19	val_19	19
-190	val_190	190
 190	val_190	NULL
+190	val_190	190
 191	val_191	NULL
 191	val_191	NULL
 191	val_191	191
 191	val_191	191
-192	val_192	192
 192	val_192	NULL
+192	val_192	192
 193	val_193	NULL
 193	val_193	NULL
 193	val_193	NULL
 193	val_193	193
 193	val_193	193
 193	val_193	193
-194	val_194	194
 194	val_194	NULL
+194	val_194	194
 195	val_195	NULL
 195	val_195	NULL
 195	val_195	195
 195	val_195	195
-196	val_196	196
 196	val_196	NULL
+196	val_196	196
 197	val_197	NULL
 197	val_197	NULL
 197	val_197	197
 197	val_197	197
-199	val_199	199
-199	val_199	199
-199	val_199	199
 199	val_199	NULL
 199	val_199	NULL
 199	val_199	NULL
+199	val_199	199
+199	val_199	199
+199	val_199	199
 2	val_2	NULL
 2	val_2	2
-20	val_20	20
 20	val_20	NULL
+20	val_20	20
 200	val_200	NULL
 200	val_200	NULL
 200	val_200	200
 200	val_200	200
-201	val_201	201
 201	val_201	NULL
+201	val_201	201
 202	val_202	NULL
 202	val_202	202
-203	val_203	203
-203	val_203	203
 203	val_203	NULL
 203	val_203	NULL
+203	val_203	203
+203	val_203	203
 205	val_205	NULL
 205	val_205	NULL
 205	val_205	205
 205	val_205	205
-207	val_207	207
-207	val_207	207
 207	val_207	NULL
 207	val_207	NULL
+207	val_207	207
+207	val_207	207
 208	val_208	NULL
 208	val_208	NULL
 208	val_208	NULL
 208	val_208	208
 208	val_208	208
 208	val_208	208
-209	val_209	209
-209	val_209	209
 209	val_209	NULL
 209	val_209	NULL
+209	val_209	209
+209	val_209	209
 213	val_213	NULL
 213	val_213	NULL
 213	val_213	213
 213	val_213	213
-214	val_214	214
 214	val_214	NULL
+214	val_214	214
 216	val_216	NULL
 216	val_216	NULL
 216	val_216	216
 216	val_216	216
-217	val_217	217
-217	val_217	217
 217	val_217	NULL
 217	val_217	NULL
+217	val_217	217
+217	val_217	217
 218	val_218	NULL
 218	val_218	218
-219	val_219	219
-219	val_219	219
 219	val_219	NULL
 219	val_219	NULL
+219	val_219	219
+219	val_219	219
 221	val_221	NULL
 221	val_221	NULL
 221	val_221	221
 221	val_221	221
-222	val_222	222
 222	val_222	NULL
+222	val_222	222
 223	val_223	NULL
 223	val_223	NULL
 223	val_223	223
 223	val_223	223
-224	val_224	224
-224	val_224	224
 224	val_224	NULL
 224	val_224	NULL
+224	val_224	224
+224	val_224	224
 226	val_226	NULL
 226	val_226	226
-228	val_228	228
 228	val_228	NULL
+228	val_228	228
 229	val_229	NULL
 229	val_229	NULL
 229	val_229	229
 229	val_229	229
-230	val_230	230
-230	val_230	230
-230	val_230	230
-230	val_230	230
-230	val_230	230
 230	val_230	NULL
 230	val_230	NULL
 230	val_230	NULL
 230	val_230	NULL
 230	val_230	NULL
+230	val_230	230
+230	val_230	230
+230	val_230	230
+230	val_230	230
+230	val_230	230
 233	val_233	NULL
 233	val_233	NULL
 233	val_233	233
 233	val_233	233
-235	val_235	235
 235	val_235	NULL
+235	val_235	235
 237	val_237	NULL
 237	val_237	NULL
 237	val_237	237
 237	val_237	237
-238	val_238	238
-238	val_238	238
 238	val_238	NULL
 238	val_238	NULL
+238	val_238	238
+238	val_238	238
 239	val_239	NULL
 239	val_239	NULL
 239	val_239	239
 239	val_239	239
-24	val_24	24
-24	val_24	24
 24	val_24	NULL
 24	val_24	NULL
+24	val_24	24
+24	val_24	24
 241	val_241	NULL
 241	val_241	241
-242	val_242	242
-242	val_242	242
 242	val_242	NULL
 242	val_242	NULL
+242	val_242	242
+242	val_242	242
 244	val_244	NULL
 244	val_244	244
-247	val_247	247
 247	val_247	NULL
+247	val_247	247
 248	val_248	NULL
 248	val_248	248
-249	val_249	249
 249	val_249	NULL
+249	val_249	249
 252	val_252	NULL
 252	val_252	252
-255	val_255	255
-255	val_255	255
 255	val_255	NULL
 255	val_255	NULL
+255	val_255	255
+255	val_255	255
 256	val_256	NULL
 256	val_256	NULL
 256	val_256	256
 256	val_256	256
-257	val_257	257
 257	val_257	NULL
+257	val_257	257
 258	val_258	NULL
 258	val_258	258
-26	val_26	26
-26	val_26	26
 26	val_26	NULL
 26	val_26	NULL
+26	val_26	26
+26	val_26	26
 260	val_260	NULL
 260	val_260	260
-262	val_262	262
 262	val_262	NULL
+262	val_262	262
 263	val_263	NULL
 263	val_263	263
-265	val_265	265
-265	val_265	265
 265	val_265	NULL
 265	val_265	NULL
+265	val_265	265
+265	val_265	265
 266	val_266	NULL
 266	val_266	266
-27	val_27	27
 27	val_27	NULL
+27	val_27	27
 272	val_272	NULL
 272	val_272	NULL
 272	val_272	272
 272	val_272	272
-273	val_273	273
-273	val_273	273
-273	val_273	273
 273	val_273	NULL
 273	val_273	NULL
 273	val_273	NULL
+273	val_273	273
+273	val_273	273
+273	val_273	273
 274	val_274	NULL
 274	val_274	274
-275	val_275	275
 275	val_275	NULL
+275	val_275	275
 277	val_277	NULL
 277	val_277	NULL
 277	val_277	NULL
@@ -465,150 +465,150 @@ POSTHOOK: Lineage: partition_vs_table PARTITION(ds=101).value SIMPLE [(src)src.F
 277	val_277	277
 277	val_277	277
 277	val_277	277
-278	val_278	278
-278	val_278	278
 278	val_278	NULL
 278	val_278	NULL
+278	val_278	278
+278	val_278	278
 28	val_28	NULL
 28	val_28	28
-280	val_280	280
-280	val_280	280
 280	val_280	NULL
 280	val_280	NULL
+280	val_280	280
+280	val_280	280
 281	val_281	NULL
 281	val_281	NULL
 281	val_281	281
 281	val_281	281
-282	val_282	282
-282	val_282	282
 282	val_282	NULL
 282	val_282	NULL
+282	val_282	282
+282	val_282	282
 283	val_283	NULL
 283	val_283	283
-284	val_284	284
 284	val_284	NULL
+284	val_284	284
 285	val_285	NULL
 285	val_285	285
-286	val_286	286
 286	val_286	NULL
+286	val_286	286
 287	val_287	NULL
 287	val_287	287
-288	val_288	288
-288	val_288	288
 288	val_288	NULL
 288	val_288	NULL
+288	val_288	288
+288	val_288	288
 289	val_289	NULL
 289	val_289	289
-291	val_291	291
 291	val_291	NULL
+291	val_291	291
 292	val_292	NULL
 292	val_292	292
-296	val_296	296
 296	val_296	NULL
+296	val_296	296
 298	val_298	NULL
 298	val_298	NULL
 298	val_298	NULL
 298	val_298	298
 298	val_298	298
 298	val_298	298
-30	val_30	30
 30	val_30	NULL
+30	val_30	30
 302	val_302	NULL
 302	val_302	302
-305	val_305	305
 305	val_305	NULL
+305	val_305	305
 306	val_306	NULL
 306	val_306	306
-307	val_307	307
-307	val_307	307
 307	val_307	NULL
 307	val_307	NULL
+307	val_307	307
+307	val_307	307
 308	val_308	NULL
 308	val_308	308
-309	val_309	309
-309	val_309	309
 309	val_309	NULL
 309	val_309	NULL
+309	val_309	309
+309	val_309	309
 310	val_310	NULL
 310	val_310	310
-311	val_311	311
-311	val_311	311
-311	val_311	311
 311	val_311	NULL
 311	val_311	NULL
 311	val_311	NULL
+311	val_311	311
+311	val_311	311
+311	val_311	311
 315	val_315	NULL
 315	val_315	315
-316	val_316	316
-316	val_316	316
-316	val_316	316
 316	val_316	NULL
 316	val_316	NULL
 316	val_316	NULL
+316	val_316	316
+316	val_316	316
+316	val_316	316
 317	val_317	NULL
 317	val_317	NULL
 317	val_317	317
 317	val_317	317
-318	val_318	318
-318	val_318	318
-318	val_318	318
 318	val_318	NULL
 318	val_318	NULL
 318	val_318	NULL
+318	val_318	318
+318	val_318	318
+318	val_318	318
+321	val_321	NULL
 321	val_321	NULL
-321	val_321	NULL
 321	val_321	321
 321	val_321	321
-322	val_322	322
-322	val_322	322
 322	val_322	NULL
 322	val_322	NULL
+322	val_322	322
+322	val_322	322
 323	val_323	NULL
 323	val_323	323
-325	val_325	325
-325	val_325	325
 325	val_325	NULL
 325	val_325	NULL
+325	val_325	325
+325	val_325	325
 327	val_327	NULL
 327	val_327	NULL
 327	val_327	NULL
 327	val_327	327
 327	val_327	327
 327	val_327	327
-33	val_33	33
 33	val_33	NULL
+33	val_33	33
 331	val_331	NULL
 331	val_331	NULL
 331	val_331	331
 331	val_331	331
-332	val_332	332
 332	val_332	NULL
+332	val_332	332
 333	val_333	NULL
 333	val_333	NULL
 333	val_333	333
 333	val_333	333
-335	val_335	335
 335	val_335	NULL
+335	val_335	335
 336	val_336	NULL
 336	val_336	336
-338	val_338	338
 338	val_338	NULL
+338	val_338	338
 339	val_339	NULL
 339	val_339	339
-34	val_34	34
 34	val_34	NULL
+34	val_34	34
 341	val_341	NULL
 341	val_341	341
-342	val_342	342
-342	val_342	342
 342	val_342	NULL
 342	val_342	NULL
+342	val_342	342
+342	val_342	342
 344	val_344	NULL
 344	val_344	NULL
 344	val_344	344
 344	val_344	344
-345	val_345	345
 345	val_345	NULL
+345	val_345	345
 348	val_348	NULL
 348	val_348	NULL
 348	val_348	NULL
@@ -619,268 +619,268 @@ POSTHOOK: Lineage: partition_vs_table PARTITION(ds=101).value SIMPLE [(src)src.F
 348	val_348	348
 348	val_348	348
 348	val_348	348
-35	val_35	35
-35	val_35	35
-35	val_35	35
 35	val_35	NULL
 35	val_35	NULL
 35	val_35	NULL
+35	val_35	35
+35	val_35	35
+35	val_35	35
 351	val_351	NULL
 351	val_351	351
-353	val_353	353
-353	val_353	353
 353	val_353	NULL
 353	val_353	NULL
+353	val_353	353
+353	val_353	353
 356	val_356	NULL
 356	val_356	356
-360	val_360	360
 360	val_360	NULL
+360	val_360	360
 362	val_362	NULL
 362	val_362	362
-364	val_364	364
 364	val_364	NULL
+364	val_364	364
 365	val_365	NULL
 365	val_365	365
-366	val_366	366
 366	val_366	NULL
+366	val_366	366
 367	val_367	NULL
 367	val_367	NULL
 367	val_367	367
 367	val_367	367
-368	val_368	368
 368	val_368	NULL
+368	val_368	368
 369	val_369	NULL
 369	val_369	NULL
 369	val_369	NULL
 369	val_369	369
 369	val_369	369
 369	val_369	369
-37	val_37	37
-37	val_37	37
 37	val_37	NULL
 37	val_37	NULL
+37	val_37	37
+37	val_37	37
 373	val_373	NULL
 373	val_373	373
-374	val_374	374
 374	val_374	NULL
+374	val_374	374
 375	val_375	NULL
 375	val_375	375
-377	val_377	377
 377	val_377	NULL
+377	val_377	377
 378	val_378	NULL
 378	val_378	378
-379	val_379	379
 379	val_379	NULL
+379	val_379	379
 382	val_382	NULL
 382	val_382	NULL
 382	val_382	382
 382	val_382	382
-384	val_384	384
-384	val_384	384
-384	val_384	384
 384	val_384	NULL
 384	val_384	NULL
 384	val_384	NULL
+384	val_384	384
+384	val_384	384
+384	val_384	384
 386	val_386	NULL
 386	val_386	386
-389	val_389	389
 389	val_389	NULL
+389	val_389	389
 392	val_392	NULL
 392	val_392	392
-393	val_393	393
 393	val_393	NULL
+393	val_393	393
 394	val_394	NULL
 394	val_394	394
-395	val_395	395
-395	val_395	395
 395	val_395	NULL
 395	val_395	NULL
+395	val_395	395
+395	val_395	395
 396	val_396	NULL
 396	val_396	NULL
 396	val_396	NULL
 396	val_396	396
 396	val_396	396
 396	val_396	396
-397	val_397	397
-397	val_397	397
 397	val_397	NULL
 397	val_397	NULL
+397	val_397	397
+397	val_397	397
 399	val_399	NULL
 399	val_399	NULL
 399	val_399	399
 399	val_399	399
-4	val_4	4
 4	val_4	NULL
+4	val_4	4
 400	val_400	NULL
 400	val_400	400
-401	val_401	401
-401	val_401	401
-401	val_401	401
-401	val_401	401
-401	val_401	401
 401	val_401	NULL
 401	val_401	NULL
 401	val_401	NULL
 401	val_401	NULL
 401	val_401	NULL
+401	val_401	401
+401	val_401	401
+401	val_401	401
+401	val_401	401
+401	val_401	401
 402	val_402	NULL
 402	val_402	402
-403	val_403	403
-403	val_403	403
-403	val_403	403
 403	val_403	NULL
 403	val_403	NULL
 403	val_403	NULL
+403	val_403	403
+403	val_403	403
+403	val_403	403
 404	val_404	NULL
 404	val_404	NULL
 404	val_404	404
 404	val_404	404
-406	val_406	406
-406	val_406	406
-406	val_406	406
-406	val_406	406
 406	val_406	NULL
 406	val_406	NULL
 406	val_406	NULL
 406	val_406	NULL
+406	val_406	406
+406	val_406	406
+406	val_406	406
+406	val_406	406
 407	val_407	NULL
 407	val_407	407
-409	val_409	409
-409	val_409	409
-409	val_409	409
 409	val_409	NULL
 409	val_409	NULL
 409	val_409	NULL
+409	val_409	409
+409	val_409	409
+409	val_409	409
 41	val_41	NULL
 41	val_41	41
-411	val_411	411
 411	val_411	NULL
+411	val_411	411
 413	val_413	NULL
 413	val_413	NULL
 413	val_413	413
 413	val_413	413
-414	val_414	414
-414	val_414	414
 414	val_414	NULL
 414	val_414	NULL
+414	val_414	414
+414	val_414	414
 417	val_417	NULL
 417	val_417	NULL
 417	val_417	NULL
 417	val_417	417
 417	val_417	417
 417	val_417	417
-418	val_418	418
 418	val_418	NULL
+418	val_418	418
 419	val_419	NULL
 419	val_419	419
-42	val_42	42
-42	val_42	42
 42	val_42	NULL
 42	val_42	NULL
+42	val_42	42
+42	val_42	42
 421	val_421	NULL
 421	val_421	421
-424	val_424	424
-424	val_424	424
 424	val_424	NULL
 424	val_424	NULL
+424	val_424	424
+424	val_424	424
 427	val_427	NULL
 427	val_427	427
-429	val_429	429
-429	val_429	429
 429	val_429	NULL
 429	val_429	NULL
+429	val_429	429
+429	val_429	429
 43	val_43	NULL
 43	val_43	43
-430	val_430	430
-430	val_430	430
-430	val_430	430
 430	val_430	NULL
 430	val_430	NULL
 430	val_430	NULL
+430	val_430	430
+430	val_430	430
+430	val_430	430
 431	val_431	NULL
 431	val_431	NULL
 431	val_431	NULL
 431	val_431	431
 431	val_431	431
 431	val_431	431
-432	val_432	432
 432	val_432	NULL
+432	val_432	432
 435	val_435	NULL
 435	val_435	435
-436	val_436	436
 436	val_436	NULL
+436	val_436	436
 437	val_437	NULL
 437	val_437	437
-438	val_438	438
-438	val_438	438
-438	val_438	438
 438	val_438	NULL
 438	val_438	NULL
 438	val_438	NULL
+438	val_438	438
+438	val_438	438
+438	val_438	438
 439	val_439	NULL
 439	val_439	NULL
 439	val_439	439
 439	val_439	439
-44	val_44	44
 44	val_44	NULL
+44	val_44	44
 443	val_443	NULL
 443	val_443	443
-444	val_444	444
 444	val_444	NULL
+444	val_444	444
 446	val_446	NULL
 446	val_446	446
-448	val_448	448
 448	val_448	NULL
+448	val_448	448
 449	val_449	NULL
 449	val_449	449
-452	val_452	452
 452	val_452	NULL
+452	val_452	452
 453	val_453	NULL
 453	val_453	453
-454	val_454	454
-454	val_454	454
-454	val_454	454
 454	val_454	NULL
 454	val_454	NULL
 454	val_454	NULL
+454	val_454	454
+454	val_454	454
+454	val_454	454
 455	val_455	NULL
 455	val_455	455
-457	val_457	457
 457	val_457	NULL
+457	val_457	457
 458	val_458	NULL
 458	val_458	NULL
 458	val_458	458
 458	val_458	458
-459	val_459	459
-459	val_459	459
 459	val_459	NULL
 459	val_459	NULL
+459	val_459	459
+459	val_459	459
 460	val_460	NULL
 460	val_460	460
-462	val_462	462
-462	val_462	462
 462	val_462	NULL
 462	val_462	NULL
+462	val_462	462
+462	val_462	462
 463	val_463	NULL
 463	val_463	NULL
 463	val_463	463
 463	val_463	463
-466	val_466	466
-466	val_466	466
-466	val_466	466
 466	val_466	NULL
 466	val_466	NULL
 466	val_466	NULL
+466	val_466	466
+466	val_466	466
+466	val_466	466
 467	val_467	NULL
 467	val_467	467
-468	val_468	468
-468	val_468	468
-468	val_468	468
-468	val_468	468
 468	val_468	NULL
 468	val_468	NULL
 468	val_468	NULL
 468	val_468	NULL
+468	val_468	468
+468	val_468	468
+468	val_468	468
+468	val_468	468
 469	val_469	NULL
 469	val_469	NULL
 469	val_469	NULL
@@ -891,164 +891,164 @@ POSTHOOK: Lineage: partition_vs_table PARTITION(ds=101).value SIMPLE [(src)src.F
 469	val_469	469
 469	val_469	469
 469	val_469	469
-47	val_47	47
 47	val_47	NULL
+47	val_47	47
 470	val_470	NULL
 470	val_470	470
-472	val_472	472
 472	val_472	NULL
+472	val_472	472
 475	val_475	NULL
 475	val_475	475
-477	val_477	477
 477	val_477	NULL
+477	val_477	477
 478	val_478	NULL
 478	val_478	NULL
 478	val_478	478
 478	val_478	478
-479	val_479	479
 479	val_479	NULL
+479	val_479	479
 480	val_480	NULL
 480	val_480	NULL
 480	val_480	NULL
 480	val_480	480
 480	val_480	480
 480	val_480	480
-481	val_481	481
 481	val_481	NULL
+481	val_481	481
 482	val_482	NULL
 482	val_482	482
-483	val_483	483
 483	val_483	NULL
+483	val_483	483
 484	val_484	NULL
 484	val_484	484
-485	val_485	485
 485	val_485	NULL
+485	val_485	485
 487	val_487	NULL
 487	val_487	487
-489	val_489	489
-489	val_489	489
-489	val_489	489
-489	val_489	489
 489	val_489	NULL
 489	val_489	NULL
 489	val_489	NULL
 489	val_489	NULL
+489	val_489	489
+489	val_489	489
+489	val_489	489
+489	val_489	489
 490	val_490	NULL
 490	val_490	490
-491	val_491	491
 491	val_491	NULL
+491	val_491	491
 492	val_492	NULL
 492	val_492	NULL
 492	val_492	492
 492	val_492	492
-493	val_493	493
 493	val_493	NULL
+493	val_493	493
 494	val_494	NULL
 494	val_494	494
-495	val_495	495
 495	val_495	NULL
+495	val_495	495
 496	val_496	NULL
 496	val_496	496
-497	val_497	497
 497	val_497	NULL
+497	val_497	497
 498	val_498	NULL
 498	val_498	NULL
 498	val_498	NULL
 498	val_498	498
 498	val_498	498
 498	val_498	498
-5	val_5	5
-5	val_5	5
-5	val_5	5
 5	val_5	NULL
 5	val_5	NULL
 5	val_5	NULL
+5	val_5	5
+5	val_5	5
+5	val_5	5
 51	val_51	NULL
 51	val_51	NULL
 51	val_51	51
 51	val_51	51
-53	val_53	53
 53	val_53	NULL
+53	val_53	53
 54	val_54	NULL
 54	val_54	54
-57	val_57	57
 57	val_57	NULL
+57	val_57	57
 58	val_58	NULL
 58	val_58	NULL
 58	val_58	58
 58	val_58	58
-64	val_64	64
 64	val_64	NULL
+64	val_64	64
 65	val_65	NULL
 65	val_65	65
-66	val_66	66
 66	val_66	NULL
+66	val_66	66
 67	val_67	NULL
 67	val_67	NULL
 67	val_67	67
 67	val_67	67
-69	val_69	69
 69	val_69	NULL
+69	val_69	69
 70	val_70	NULL
 70	val_70	NULL
 70	val_70	NULL
 70	val_70	70
 70	val_70	70
 70	val_70	70
-72	val_72	72
-72	val_72	72
 72	val_72	NULL
 72	val_72	NULL
+72	val_72	72
+72	val_72	72
 74	val_74	NULL
 74	val_74	74
-76	val_76	76
-76	val_76	76
 76	val_76	NULL
 76	val_76	NULL
+76	val_76	76
+76	val_76	76
 77	val_77	NULL
 77	val_77	77
-78	val_78	78
 78	val_78	NULL
+78	val_78	78
 8	val_8	NULL
 8	val_8	8
-80	val_80	80
 80	val_80	NULL
+80	val_80	80
 82	val_82	NULL
 82	val_82	82
-83	val_83	83
-83	val_83	83
 83	val_83	NULL
 83	val_83	NULL
+83	val_83	83
+83	val_83	83
 84	val_84	NULL
 84	val_84	NULL
 84	val_84	84
 84	val_84	84
-85	val_85	85
 85	val_85	NULL
+85	val_85	85
 86	val_86	NULL
 86	val_86	86
-87	val_87	87
 87	val_87	NULL
+87	val_87	87
 9	val_9	NULL
 9	val_9	9
-90	val_90	90
-90	val_90	90
-90	val_90	90
 90	val_90	NULL
 90	val_90	NULL
 90	val_90	NULL
+90	val_90	90
+90	val_90	90
+90	val_90	90
 92	val_92	NULL
 92	val_92	92
-95	val_95	95
-95	val_95	95
 95	val_95	NULL
 95	val_95	NULL
+95	val_95	95
+95	val_95	95
 96	val_96	NULL
 96	val_96	96
-97	val_97	97
-97	val_97	97
 97	val_97	NULL
 97	val_97	NULL
+97	val_97	97
+97	val_97	97
 98	val_98	NULL
 98	val_98	NULL
 98	val_98	98
diff --git a/ql/src/test/results/clientpositive/scriptfile1.q.out b/ql/src/test/results/clientpositive/scriptfile1.q.out
index deb8c1c667..9d4f6eea78 100644
--- a/ql/src/test/results/clientpositive/scriptfile1.q.out
+++ b/ql/src/test/results/clientpositive/scriptfile1.q.out
@@ -6,8 +6,8 @@ POSTHOOK: Output: default@dest1
 PREHOOK: query: FROM (
   FROM src
   SELECT TRANSFORM(src.key, src.value)
-         USING 'testgrep' AS (tkey, tvalue) 
-  CLUSTER BY tkey 
+         USING 'testgrep' AS (tkey, tvalue)
+  CLUSTER BY tkey
 ) tmap
 INSERT OVERWRITE TABLE dest1 SELECT tmap.tkey, tmap.tvalue
 PREHOOK: type: QUERY
@@ -16,8 +16,8 @@ PREHOOK: Output: default@dest1
 POSTHOOK: query: FROM (
   FROM src
   SELECT TRANSFORM(src.key, src.value)
-         USING 'testgrep' AS (tkey, tvalue) 
-  CLUSTER BY tkey 
+         USING 'testgrep' AS (tkey, tvalue)
+  CLUSTER BY tkey
 ) tmap
 INSERT OVERWRITE TABLE dest1 SELECT tmap.tkey, tmap.tvalue
 POSTHOOK: type: QUERY
@@ -28,11 +28,11 @@ POSTHOOK: Lineage: dest1.value SCRIPT [(src)src.FieldSchema(name:key, type:strin
 PREHOOK: query: SELECT dest1.* FROM dest1
 PREHOOK: type: QUERY
 PREHOOK: Input: default@dest1
-PREHOOK: Output: file:/data/users/athusoo/apache_workspaces/hive_trunk_ws1/.ptest_1/build/ql/scratchdir/hive_2010-04-05_18-28-41_094_5935665083865257548/10000
+PREHOOK: Output: hdfs://localhost.localdomain:39190/data/users/njain/hive_commit1/build/ql/scratchdir/hive_2011-02-03_10-52-59_555_6132352806731305883/-mr-10000
 POSTHOOK: query: SELECT dest1.* FROM dest1
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@dest1
-POSTHOOK: Output: file:/data/users/athusoo/apache_workspaces/hive_trunk_ws1/.ptest_1/build/ql/scratchdir/hive_2010-04-05_18-28-41_094_5935665083865257548/10000
+POSTHOOK: Output: hdfs://localhost.localdomain:39190/data/users/njain/hive_commit1/build/ql/scratchdir/hive_2011-02-03_10-52-59_555_6132352806731305883/-mr-10000
 POSTHOOK: Lineage: dest1.key SCRIPT [(src)src.FieldSchema(name:key, type:string, comment:default), (src)src.FieldSchema(name:value, type:string, comment:default), ]
 POSTHOOK: Lineage: dest1.value SCRIPT [(src)src.FieldSchema(name:key, type:string, comment:default), (src)src.FieldSchema(name:value, type:string, comment:default), ]
 10	val_10
diff --git a/ql/src/test/results/clientpositive/union_ppr.q.out b/ql/src/test/results/clientpositive/union_ppr.q.out
index 5d28ba9961..53934e52c1 100644
--- a/ql/src/test/results/clientpositive/union_ppr.q.out
+++ b/ql/src/test/results/clientpositive/union_ppr.q.out
@@ -1,23 +1,23 @@
-PREHOOK: query: EXPLAIN EXTENDED 
+PREHOOK: query: EXPLAIN EXTENDED
 SELECT * FROM (
   SELECT X.* FROM SRCPART X WHERE X.key < 100
   UNION ALL
   SELECT Y.* FROM SRCPART Y WHERE Y.key < 100
 ) A
 WHERE A.ds = '2008-04-08'
-SORT BY A.key
+SORT BY A.key, A.value, A.ds, A.hr
 PREHOOK: type: QUERY
-POSTHOOK: query: EXPLAIN EXTENDED 
+POSTHOOK: query: EXPLAIN EXTENDED
 SELECT * FROM (
   SELECT X.* FROM SRCPART X WHERE X.key < 100
   UNION ALL
   SELECT Y.* FROM SRCPART Y WHERE Y.key < 100
 ) A
 WHERE A.ds = '2008-04-08'
-SORT BY A.key
+SORT BY A.key, A.value, A.ds, A.hr
 POSTHOOK: type: QUERY
 ABSTRACT SYNTAX TREE:
-  (TOK_QUERY (TOK_FROM (TOK_SUBQUERY (TOK_UNION (TOK_QUERY (TOK_FROM (TOK_TABREF SRCPART X)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_ALLCOLREF X))) (TOK_WHERE (< (. (TOK_TABLE_OR_COL X) key) 100)))) (TOK_QUERY (TOK_FROM (TOK_TABREF SRCPART Y)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_ALLCOLREF Y))) (TOK_WHERE (< (. (TOK_TABLE_OR_COL Y) key) 100))))) A)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR TOK_ALLCOLREF)) (TOK_WHERE (= (. (TOK_TABLE_OR_COL A) ds) '2008-04-08')) (TOK_SORTBY (TOK_TABSORTCOLNAMEASC (. (TOK_TABLE_OR_COL A) key)))))
+  (TOK_QUERY (TOK_FROM (TOK_SUBQUERY (TOK_UNION (TOK_QUERY (TOK_FROM (TOK_TABREF SRCPART X)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_ALLCOLREF X))) (TOK_WHERE (< (. (TOK_TABLE_OR_COL X) key) 100)))) (TOK_QUERY (TOK_FROM (TOK_TABREF SRCPART Y)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_ALLCOLREF Y))) (TOK_WHERE (< (. (TOK_TABLE_OR_COL Y) key) 100))))) A)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR TOK_ALLCOLREF)) (TOK_WHERE (= (. (TOK_TABLE_OR_COL A) ds) '2008-04-08')) (TOK_SORTBY (TOK_TABSORTCOLNAMEASC (. (TOK_TABLE_OR_COL A) key)) (TOK_TABSORTCOLNAMEASC (. (TOK_TABLE_OR_COL A) value)) (TOK_TABSORTCOLNAMEASC (. (TOK_TABLE_OR_COL A) ds)) (TOK_TABSORTCOLNAMEASC (. (TOK_TABLE_OR_COL A) hr)))))
 
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
@@ -73,7 +73,13 @@ STAGE PLANS:
                           key expressions:
                                 expr: _col0
                                 type: string
-                          sort order: +
+                                expr: _col1
+                                type: string
+                                expr: _col2
+                                type: string
+                                expr: _col3
+                                type: string
+                          sort order: ++++
                           tag: -1
                           value expressions:
                                 expr: _col0
@@ -130,7 +136,13 @@ STAGE PLANS:
                           key expressions:
                                 expr: _col0
                                 type: string
-                          sort order: +
+                                expr: _col1
+                                type: string
+                                expr: _col2
+                                type: string
+                                expr: _col3
+                                type: string
+                          sort order: ++++
                           tag: -1
                           value expressions:
                                 expr: _col0
@@ -143,10 +155,10 @@ STAGE PLANS:
                                 type: string
       Needs Tagging: false
       Path -> Alias:
-        pfile:/data/users/sdong/www/hive-trunk/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 [null-subquery1:a-subquery1:x, null-subquery2:a-subquery2:y]
-        pfile:/data/users/sdong/www/hive-trunk/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12 [null-subquery1:a-subquery1:x, null-subquery2:a-subquery2:y]
+        pfile:/data/users/njain/hive_commit1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 [null-subquery1:a-subquery1:x, null-subquery2:a-subquery2:y]
+        pfile:/data/users/njain/hive_commit1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12 [null-subquery1:a-subquery1:x, null-subquery2:a-subquery2:y]
       Path -> Partition:
-        pfile:/data/users/sdong/www/hive-trunk/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 
+        pfile:/data/users/njain/hive_commit1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11 
           Partition
             base file name: hr=11
             input format: org.apache.hadoop.mapred.TextInputFormat
@@ -160,13 +172,13 @@ STAGE PLANS:
               columns.types string:string
               file.inputformat org.apache.hadoop.mapred.TextInputFormat
               file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-              location pfile:/data/users/sdong/www/hive-trunk/build/ql/test/data/warehouse/srcpart
+              location pfile:/data/users/njain/hive_commit1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=11
               name srcpart
               partition_columns ds/hr
               serialization.ddl struct srcpart { string key, string value}
               serialization.format 1
               serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-              transient_lastDdlTime 1288389287
+              transient_lastDdlTime 1296761475
             serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
           
               input format: org.apache.hadoop.mapred.TextInputFormat
@@ -177,17 +189,17 @@ STAGE PLANS:
                 columns.types string:string
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location pfile:/data/users/sdong/www/hive-trunk/build/ql/test/data/warehouse/srcpart
+                location pfile:/data/users/njain/hive_commit1/build/ql/test/data/warehouse/srcpart
                 name srcpart
                 partition_columns ds/hr
                 serialization.ddl struct srcpart { string key, string value}
                 serialization.format 1
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                transient_lastDdlTime 1288389287
+                transient_lastDdlTime 1296761475
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: srcpart
             name: srcpart
-        pfile:/data/users/sdong/www/hive-trunk/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12 
+        pfile:/data/users/njain/hive_commit1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12 
           Partition
             base file name: hr=12
             input format: org.apache.hadoop.mapred.TextInputFormat
@@ -201,13 +213,13 @@ STAGE PLANS:
               columns.types string:string
               file.inputformat org.apache.hadoop.mapred.TextInputFormat
               file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-              location pfile:/data/users/sdong/www/hive-trunk/build/ql/test/data/warehouse/srcpart
+              location pfile:/data/users/njain/hive_commit1/build/ql/test/data/warehouse/srcpart/ds=2008-04-08/hr=12
               name srcpart
               partition_columns ds/hr
               serialization.ddl struct srcpart { string key, string value}
               serialization.format 1
               serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-              transient_lastDdlTime 1288389287
+              transient_lastDdlTime 1296761475
             serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
           
               input format: org.apache.hadoop.mapred.TextInputFormat
@@ -218,13 +230,13 @@ STAGE PLANS:
                 columns.types string:string
                 file.inputformat org.apache.hadoop.mapred.TextInputFormat
                 file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
-                location pfile:/data/users/sdong/www/hive-trunk/build/ql/test/data/warehouse/srcpart
+                location pfile:/data/users/njain/hive_commit1/build/ql/test/data/warehouse/srcpart
                 name srcpart
                 partition_columns ds/hr
                 serialization.ddl struct srcpart { string key, string value}
                 serialization.format 1
                 serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
-                transient_lastDdlTime 1288389287
+                transient_lastDdlTime 1296761475
               serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
               name: srcpart
             name: srcpart
@@ -233,9 +245,9 @@ STAGE PLANS:
           File Output Operator
             compressed: false
             GlobalTableId: 0
-            directory: file:/tmp/sdong/hive_2010-10-29_17-15-51_547_6672522666077201263/-ext-10001
+            directory: file:/tmp/njain/hive_2011-02-03_11-31-24_107_7646141366411001923/-ext-10001
             NumFilesPerFileSink: 1
-            Stats Publishing Key Prefix: file:/tmp/sdong/hive_2010-10-29_17-15-51_547_6672522666077201263/-ext-10001/
+            Stats Publishing Key Prefix: file:/tmp/njain/hive_2011-02-03_11-31-24_107_7646141366411001923/-ext-10001/
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -258,22 +270,22 @@ PREHOOK: query: SELECT * FROM (
   SELECT Y.* FROM SRCPART Y WHERE Y.key < 100
 ) A
 WHERE A.ds = '2008-04-08'
-SORT BY A.key
+SORT BY A.key, A.value, A.ds, A.hr
 PREHOOK: type: QUERY
 PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 PREHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
-PREHOOK: Output: file:/tmp/sdong/hive_2010-10-29_17-15-51_705_3706644793504858475/-mr-10000
+PREHOOK: Output: file:/tmp/njain/hive_2011-02-03_11-31-24_506_7808326810869045824/-mr-10000
 POSTHOOK: query: SELECT * FROM (
   SELECT X.* FROM SRCPART X WHERE X.key < 100
   UNION ALL
   SELECT Y.* FROM SRCPART Y WHERE Y.key < 100
 ) A
 WHERE A.ds = '2008-04-08'
-SORT BY A.key
+SORT BY A.key, A.value, A.ds, A.hr
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=11
 POSTHOOK: Input: default@srcpart@ds=2008-04-08/hr=12
-POSTHOOK: Output: file:/tmp/sdong/hive_2010-10-29_17-15-51_705_3706644793504858475/-mr-10000
+POSTHOOK: Output: file:/tmp/njain/hive_2011-02-03_11-31-24_506_7808326810869045824/-mr-10000
 0	val_0	2008-04-08	11
 0	val_0	2008-04-08	11
 0	val_0	2008-04-08	11
@@ -286,22 +298,22 @@ POSTHOOK: Output: file:/tmp/sdong/hive_2010-10-29_17-15-51_705_37066447935048584
 0	val_0	2008-04-08	12
 0	val_0	2008-04-08	12
 0	val_0	2008-04-08	12
-10	val_10	2008-04-08	12
-10	val_10	2008-04-08	12
 10	val_10	2008-04-08	11
 10	val_10	2008-04-08	11
+10	val_10	2008-04-08	12
+10	val_10	2008-04-08	12
 11	val_11	2008-04-08	11
 11	val_11	2008-04-08	11
 11	val_11	2008-04-08	12
 11	val_11	2008-04-08	12
-12	val_12	2008-04-08	12
-12	val_12	2008-04-08	12
-12	val_12	2008-04-08	12
-12	val_12	2008-04-08	12
 12	val_12	2008-04-08	11
 12	val_12	2008-04-08	11
 12	val_12	2008-04-08	11
 12	val_12	2008-04-08	11
+12	val_12	2008-04-08	12
+12	val_12	2008-04-08	12
+12	val_12	2008-04-08	12
+12	val_12	2008-04-08	12
 15	val_15	2008-04-08	11
 15	val_15	2008-04-08	11
 15	val_15	2008-04-08	11
@@ -310,10 +322,10 @@ POSTHOOK: Output: file:/tmp/sdong/hive_2010-10-29_17-15-51_705_37066447935048584
 15	val_15	2008-04-08	12
 15	val_15	2008-04-08	12
 15	val_15	2008-04-08	12
-17	val_17	2008-04-08	12
-17	val_17	2008-04-08	12
 17	val_17	2008-04-08	11
 17	val_17	2008-04-08	11
+17	val_17	2008-04-08	12
+17	val_17	2008-04-08	12
 18	val_18	2008-04-08	11
 18	val_18	2008-04-08	11
 18	val_18	2008-04-08	11
@@ -322,18 +334,18 @@ POSTHOOK: Output: file:/tmp/sdong/hive_2010-10-29_17-15-51_705_37066447935048584
 18	val_18	2008-04-08	12
 18	val_18	2008-04-08	12
 18	val_18	2008-04-08	12
-19	val_19	2008-04-08	12
-19	val_19	2008-04-08	12
 19	val_19	2008-04-08	11
 19	val_19	2008-04-08	11
+19	val_19	2008-04-08	12
+19	val_19	2008-04-08	12
 2	val_2	2008-04-08	11
 2	val_2	2008-04-08	11
 2	val_2	2008-04-08	12
 2	val_2	2008-04-08	12
-20	val_20	2008-04-08	12
-20	val_20	2008-04-08	12
 20	val_20	2008-04-08	11
 20	val_20	2008-04-08	11
+20	val_20	2008-04-08	12
+20	val_20	2008-04-08	12
 24	val_24	2008-04-08	11
 24	val_24	2008-04-08	11
 24	val_24	2008-04-08	11
@@ -342,46 +354,46 @@ POSTHOOK: Output: file:/tmp/sdong/hive_2010-10-29_17-15-51_705_37066447935048584
 24	val_24	2008-04-08	12
 24	val_24	2008-04-08	12
 24	val_24	2008-04-08	12
-26	val_26	2008-04-08	12
-26	val_26	2008-04-08	12
-26	val_26	2008-04-08	12
-26	val_26	2008-04-08	12
 26	val_26	2008-04-08	11
 26	val_26	2008-04-08	11
 26	val_26	2008-04-08	11
 26	val_26	2008-04-08	11
+26	val_26	2008-04-08	12
+26	val_26	2008-04-08	12
+26	val_26	2008-04-08	12
+26	val_26	2008-04-08	12
 27	val_27	2008-04-08	11
 27	val_27	2008-04-08	11
 27	val_27	2008-04-08	12
 27	val_27	2008-04-08	12
-28	val_28	2008-04-08	12
-28	val_28	2008-04-08	12
 28	val_28	2008-04-08	11
 28	val_28	2008-04-08	11
+28	val_28	2008-04-08	12
+28	val_28	2008-04-08	12
 30	val_30	2008-04-08	11
 30	val_30	2008-04-08	11
 30	val_30	2008-04-08	12
 30	val_30	2008-04-08	12
-33	val_33	2008-04-08	12
-33	val_33	2008-04-08	12
 33	val_33	2008-04-08	11
 33	val_33	2008-04-08	11
+33	val_33	2008-04-08	12
+33	val_33	2008-04-08	12
 34	val_34	2008-04-08	11
 34	val_34	2008-04-08	11
 34	val_34	2008-04-08	12
 34	val_34	2008-04-08	12
-35	val_35	2008-04-08	12
-35	val_35	2008-04-08	12
-35	val_35	2008-04-08	12
-35	val_35	2008-04-08	12
-35	val_35	2008-04-08	12
-35	val_35	2008-04-08	12
 35	val_35	2008-04-08	11
 35	val_35	2008-04-08	11
 35	val_35	2008-04-08	11
 35	val_35	2008-04-08	11
 35	val_35	2008-04-08	11
 35	val_35	2008-04-08	11
+35	val_35	2008-04-08	12
+35	val_35	2008-04-08	12
+35	val_35	2008-04-08	12
+35	val_35	2008-04-08	12
+35	val_35	2008-04-08	12
+35	val_35	2008-04-08	12
 37	val_37	2008-04-08	11
 37	val_37	2008-04-08	11
 37	val_37	2008-04-08	11
@@ -390,46 +402,46 @@ POSTHOOK: Output: file:/tmp/sdong/hive_2010-10-29_17-15-51_705_37066447935048584
 37	val_37	2008-04-08	12
 37	val_37	2008-04-08	12
 37	val_37	2008-04-08	12
-4	val_4	2008-04-08	12
-4	val_4	2008-04-08	12
 4	val_4	2008-04-08	11
 4	val_4	2008-04-08	11
+4	val_4	2008-04-08	12
+4	val_4	2008-04-08	12
 41	val_41	2008-04-08	11
 41	val_41	2008-04-08	11
 41	val_41	2008-04-08	12
 41	val_41	2008-04-08	12
-42	val_42	2008-04-08	12
-42	val_42	2008-04-08	12
-42	val_42	2008-04-08	12
-42	val_42	2008-04-08	12
 42	val_42	2008-04-08	11
 42	val_42	2008-04-08	11
 42	val_42	2008-04-08	11
 42	val_42	2008-04-08	11
+42	val_42	2008-04-08	12
+42	val_42	2008-04-08	12
+42	val_42	2008-04-08	12
+42	val_42	2008-04-08	12
 43	val_43	2008-04-08	11
 43	val_43	2008-04-08	11
 43	val_43	2008-04-08	12
 43	val_43	2008-04-08	12
-44	val_44	2008-04-08	12
-44	val_44	2008-04-08	12
 44	val_44	2008-04-08	11
 44	val_44	2008-04-08	11
+44	val_44	2008-04-08	12
+44	val_44	2008-04-08	12
 47	val_47	2008-04-08	11
 47	val_47	2008-04-08	11
 47	val_47	2008-04-08	12
 47	val_47	2008-04-08	12
-5	val_5	2008-04-08	12
-5	val_5	2008-04-08	12
-5	val_5	2008-04-08	12
-5	val_5	2008-04-08	12
-5	val_5	2008-04-08	12
-5	val_5	2008-04-08	12
 5	val_5	2008-04-08	11
 5	val_5	2008-04-08	11
 5	val_5	2008-04-08	11
 5	val_5	2008-04-08	11
 5	val_5	2008-04-08	11
 5	val_5	2008-04-08	11
+5	val_5	2008-04-08	12
+5	val_5	2008-04-08	12
+5	val_5	2008-04-08	12
+5	val_5	2008-04-08	12
+5	val_5	2008-04-08	12
+5	val_5	2008-04-08	12
 51	val_51	2008-04-08	11
 51	val_51	2008-04-08	11
 51	val_51	2008-04-08	11
@@ -438,18 +450,18 @@ POSTHOOK: Output: file:/tmp/sdong/hive_2010-10-29_17-15-51_705_37066447935048584
 51	val_51	2008-04-08	12
 51	val_51	2008-04-08	12
 51	val_51	2008-04-08	12
-53	val_53	2008-04-08	12
-53	val_53	2008-04-08	12
 53	val_53	2008-04-08	11
 53	val_53	2008-04-08	11
+53	val_53	2008-04-08	12
+53	val_53	2008-04-08	12
 54	val_54	2008-04-08	11
 54	val_54	2008-04-08	11
 54	val_54	2008-04-08	12
 54	val_54	2008-04-08	12
-57	val_57	2008-04-08	12
-57	val_57	2008-04-08	12
 57	val_57	2008-04-08	11
 57	val_57	2008-04-08	11
+57	val_57	2008-04-08	12
+57	val_57	2008-04-08	12
 58	val_58	2008-04-08	11
 58	val_58	2008-04-08	11
 58	val_58	2008-04-08	11
@@ -458,18 +470,18 @@ POSTHOOK: Output: file:/tmp/sdong/hive_2010-10-29_17-15-51_705_37066447935048584
 58	val_58	2008-04-08	12
 58	val_58	2008-04-08	12
 58	val_58	2008-04-08	12
-64	val_64	2008-04-08	12
-64	val_64	2008-04-08	12
 64	val_64	2008-04-08	11
 64	val_64	2008-04-08	11
+64	val_64	2008-04-08	12
+64	val_64	2008-04-08	12
 65	val_65	2008-04-08	11
 65	val_65	2008-04-08	11
 65	val_65	2008-04-08	12
 65	val_65	2008-04-08	12
-66	val_66	2008-04-08	12
-66	val_66	2008-04-08	12
 66	val_66	2008-04-08	11
 66	val_66	2008-04-08	11
+66	val_66	2008-04-08	12
+66	val_66	2008-04-08	12
 67	val_67	2008-04-08	11
 67	val_67	2008-04-08	11
 67	val_67	2008-04-08	11
@@ -478,10 +490,10 @@ POSTHOOK: Output: file:/tmp/sdong/hive_2010-10-29_17-15-51_705_37066447935048584
 67	val_67	2008-04-08	12
 67	val_67	2008-04-08	12
 67	val_67	2008-04-08	12
-69	val_69	2008-04-08	12
-69	val_69	2008-04-08	12
 69	val_69	2008-04-08	11
 69	val_69	2008-04-08	11
+69	val_69	2008-04-08	12
+69	val_69	2008-04-08	12
 70	val_70	2008-04-08	11
 70	val_70	2008-04-08	11
 70	val_70	2008-04-08	11
@@ -494,54 +506,54 @@ POSTHOOK: Output: file:/tmp/sdong/hive_2010-10-29_17-15-51_705_37066447935048584
 70	val_70	2008-04-08	12
 70	val_70	2008-04-08	12
 70	val_70	2008-04-08	12
-72	val_72	2008-04-08	12
-72	val_72	2008-04-08	12
-72	val_72	2008-04-08	12
-72	val_72	2008-04-08	12
 72	val_72	2008-04-08	11
 72	val_72	2008-04-08	11
 72	val_72	2008-04-08	11
 72	val_72	2008-04-08	11
+72	val_72	2008-04-08	12
+72	val_72	2008-04-08	12
+72	val_72	2008-04-08	12
+72	val_72	2008-04-08	12
 74	val_74	2008-04-08	11
 74	val_74	2008-04-08	11
 74	val_74	2008-04-08	12
 74	val_74	2008-04-08	12
-76	val_76	2008-04-08	12
-76	val_76	2008-04-08	12
-76	val_76	2008-04-08	12
-76	val_76	2008-04-08	12
 76	val_76	2008-04-08	11
 76	val_76	2008-04-08	11
 76	val_76	2008-04-08	11
 76	val_76	2008-04-08	11
+76	val_76	2008-04-08	12
+76	val_76	2008-04-08	12
+76	val_76	2008-04-08	12
+76	val_76	2008-04-08	12
 77	val_77	2008-04-08	11
 77	val_77	2008-04-08	11
 77	val_77	2008-04-08	12
 77	val_77	2008-04-08	12
-78	val_78	2008-04-08	12
-78	val_78	2008-04-08	12
 78	val_78	2008-04-08	11
 78	val_78	2008-04-08	11
+78	val_78	2008-04-08	12
+78	val_78	2008-04-08	12
 8	val_8	2008-04-08	11
 8	val_8	2008-04-08	11
 8	val_8	2008-04-08	12
 8	val_8	2008-04-08	12
-80	val_80	2008-04-08	12
-80	val_80	2008-04-08	12
 80	val_80	2008-04-08	11
 80	val_80	2008-04-08	11
+80	val_80	2008-04-08	12
+80	val_80	2008-04-08	12
 82	val_82	2008-04-08	11
 82	val_82	2008-04-08	11
 82	val_82	2008-04-08	12
 82	val_82	2008-04-08	12
-83	val_83	2008-04-08	12
-83	val_83	2008-04-08	12
-83	val_83	2008-04-08	12
-83	val_83	2008-04-08	12
 83	val_83	2008-04-08	11
 83	val_83	2008-04-08	11
 83	val_83	2008-04-08	11
 83	val_83	2008-04-08	11
+83	val_83	2008-04-08	12
+83	val_83	2008-04-08	12
+83	val_83	2008-04-08	12
+83	val_83	2008-04-08	12
 84	val_84	2008-04-08	11
 84	val_84	2008-04-08	11
 84	val_84	2008-04-08	11
@@ -550,58 +562,58 @@ POSTHOOK: Output: file:/tmp/sdong/hive_2010-10-29_17-15-51_705_37066447935048584
 84	val_84	2008-04-08	12
 84	val_84	2008-04-08	12
 84	val_84	2008-04-08	12
-85	val_85	2008-04-08	12
-85	val_85	2008-04-08	12
 85	val_85	2008-04-08	11
 85	val_85	2008-04-08	11
+85	val_85	2008-04-08	12
+85	val_85	2008-04-08	12
 86	val_86	2008-04-08	11
 86	val_86	2008-04-08	11
 86	val_86	2008-04-08	12
 86	val_86	2008-04-08	12
-87	val_87	2008-04-08	12
-87	val_87	2008-04-08	12
 87	val_87	2008-04-08	11
 87	val_87	2008-04-08	11
+87	val_87	2008-04-08	12
+87	val_87	2008-04-08	12
 9	val_9	2008-04-08	11
 9	val_9	2008-04-08	11
 9	val_9	2008-04-08	12
 9	val_9	2008-04-08	12
-90	val_90	2008-04-08	12
-90	val_90	2008-04-08	12
-90	val_90	2008-04-08	12
-90	val_90	2008-04-08	12
-90	val_90	2008-04-08	12
-90	val_90	2008-04-08	12
 90	val_90	2008-04-08	11
 90	val_90	2008-04-08	11
 90	val_90	2008-04-08	11
 90	val_90	2008-04-08	11
 90	val_90	2008-04-08	11
 90	val_90	2008-04-08	11
+90	val_90	2008-04-08	12
+90	val_90	2008-04-08	12
+90	val_90	2008-04-08	12
+90	val_90	2008-04-08	12
+90	val_90	2008-04-08	12
+90	val_90	2008-04-08	12
 92	val_92	2008-04-08	11
 92	val_92	2008-04-08	11
 92	val_92	2008-04-08	12
 92	val_92	2008-04-08	12
-95	val_95	2008-04-08	12
-95	val_95	2008-04-08	12
-95	val_95	2008-04-08	12
-95	val_95	2008-04-08	12
 95	val_95	2008-04-08	11
 95	val_95	2008-04-08	11
 95	val_95	2008-04-08	11
 95	val_95	2008-04-08	11
+95	val_95	2008-04-08	12
+95	val_95	2008-04-08	12
+95	val_95	2008-04-08	12
+95	val_95	2008-04-08	12
 96	val_96	2008-04-08	11
 96	val_96	2008-04-08	11
 96	val_96	2008-04-08	12
 96	val_96	2008-04-08	12
-97	val_97	2008-04-08	12
-97	val_97	2008-04-08	12
-97	val_97	2008-04-08	12
-97	val_97	2008-04-08	12
 97	val_97	2008-04-08	11
 97	val_97	2008-04-08	11
 97	val_97	2008-04-08	11
 97	val_97	2008-04-08	11
+97	val_97	2008-04-08	12
+97	val_97	2008-04-08	12
+97	val_97	2008-04-08	12
+97	val_97	2008-04-08	12
 98	val_98	2008-04-08	11
 98	val_98	2008-04-08	11
 98	val_98	2008-04-08	11
