diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/PTFOperator.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/PTFOperator.java
index 4d314b77ab..6103340b0a 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/PTFOperator.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/PTFOperator.java
@@ -55,7 +55,7 @@ public class PTFOperator extends Operator<PTFDesc> implements Serializable {
 	transient KeyWrapperFactory keyWrapperFactory;
 	protected transient KeyWrapper currentKeys;
 	protected transient KeyWrapper newKeys;
-	transient HiveConf hiveConf;
+	transient Configuration hiveConf;
 
 
 	/*
@@ -66,14 +66,13 @@ public class PTFOperator extends Operator<PTFDesc> implements Serializable {
 	 */
 	@Override
 	protected void initializeOp(Configuration jobConf) throws HiveException {
-		hiveConf = new HiveConf(jobConf, PTFOperator.class);
-		// if the parent is ExtractOperator, this invocation is from reduce-side
+		hiveConf = jobConf;
+    // if the parent is ExtractOperator, this invocation is from reduce-side
 		Operator<? extends OperatorDesc> parentOp = getParentOperators().get(0);
 		isMapOperator = conf.isMapSide();
 
 		reconstructQueryDef(hiveConf);
-    inputPart = createFirstPartitionForChain(
-        inputObjInspectors[0], hiveConf, isMapOperator);
+    inputPart = createFirstPartitionForChain(inputObjInspectors[0], isMapOperator);
 
 		if (isMapOperator) {
 			PartitionedTableFunctionDef tDef = conf.getStartOfChain();
@@ -147,7 +146,7 @@ public void processOp(Object row, int tag) throws HiveException
 	 * @param hiveConf
 	 * @throws HiveException
 	 */
-	protected void reconstructQueryDef(HiveConf hiveConf) throws HiveException {
+	protected void reconstructQueryDef(Configuration hiveConf) throws HiveException {
 
 	  PTFDeserializer dS =
 	      new PTFDeserializer(conf, (StructObjectInspector)inputObjInspectors[0], hiveConf);
@@ -191,11 +190,11 @@ protected void processInputPartition() throws HiveException {
 
 	protected void processMapFunction() throws HiveException {
 	  PartitionedTableFunctionDef tDef = conf.getStartOfChain();
-    
-    Iterator<Object> pItr = tDef.getTFunction().canIterateOutput() ? 
+
+    Iterator<Object> pItr = tDef.getTFunction().canIterateOutput() ?
         tDef.getTFunction().transformRawInputIterator(inputPart.iterator()) :
           tDef.getTFunction().transformRawInput(inputPart).iterator();
-    
+
     while (pItr.hasNext()) {
       Object oRow = pItr.next();
       forward(oRow, outputObjInspector);
@@ -280,9 +279,8 @@ private Iterator<Object> executeChain(PTFPartition part)
    * @throws HiveException
    */
   public PTFPartition createFirstPartitionForChain(ObjectInspector oi,
-      HiveConf hiveConf, boolean isMapSide) throws HiveException {
+    boolean isMapSide) throws HiveException {
     PartitionedTableFunctionDef tabDef = conf.getStartOfChain();
-    TableFunctionEvaluator tEval = tabDef.getTFunction();
 
     PTFPartition part = null;
     SerDe serde = isMapSide ? tabDef.getInput().getOutputShape().getSerde() :
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/PTFPartition.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/PTFPartition.java
index 3c717d6740..b5adb11e3b 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/PTFPartition.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/PTFPartition.java
@@ -24,6 +24,7 @@
 
 import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
+import org.apache.hadoop.conf.Configuration;
 import org.apache.hadoop.hive.conf.HiveConf;
 import org.apache.hadoop.hive.conf.HiveConf.ConfVars;
 import org.apache.hadoop.hive.ql.exec.persistence.PTFRowContainer;
@@ -46,7 +47,7 @@ public class PTFPartition {
   StructObjectInspector outputOI;
   private final PTFRowContainer<List<Object>> elems;
 
-  protected PTFPartition(HiveConf cfg,
+  protected PTFPartition(Configuration cfg,
       SerDe serDe, StructObjectInspector inputOI,
       StructObjectInspector outputOI)
       throws HiveException {
@@ -130,11 +131,13 @@ class PItr implements PTFPartitionIterator<Object> {
       createTimeSz = PTFPartition.this.size();
     }
 
+    @Override
     public boolean hasNext() {
       checkForComodification();
       return idx < end;
     }
 
+    @Override
     public Object next() {
       checkForComodification();
       try {
@@ -144,6 +147,7 @@ public Object next() {
       }
     }
 
+    @Override
     public void remove() {
       throw new UnsupportedOperationException();
     }
@@ -222,7 +226,7 @@ public static interface PTFPartitionIterator<T> extends Iterator<T> {
     void reset() throws HiveException;
   }
 
-  public static PTFPartition create(HiveConf cfg,
+  public static PTFPartition create(Configuration cfg,
       SerDe serDe,
       StructObjectInspector inputOI,
       StructObjectInspector outputOI)
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/plan/PTFDesc.java b/ql/src/java/org/apache/hadoop/hive/ql/plan/PTFDesc.java
index 95f38b6317..3ac3245476 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/plan/PTFDesc.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/plan/PTFDesc.java
@@ -21,6 +21,7 @@
 
 import org.apache.commons.logging.Log;
 import org.apache.commons.logging.LogFactory;
+import org.apache.hadoop.conf.Configuration;
 import org.apache.hadoop.hive.conf.HiveConf;
 import org.apache.hadoop.hive.ql.exec.PTFUtils;
 import org.apache.hadoop.hive.ql.parse.LeadLagInfo;
@@ -42,7 +43,7 @@ public class PTFDesc extends AbstractOperatorDesc {
    */
   boolean isMapSide = false;
 
-  transient HiveConf cfg;
+  transient Configuration cfg;
 
   static{
     PTFUtils.makeTransient(PTFDesc.class, "llInfo");
@@ -81,11 +82,11 @@ public void setMapSide(boolean isMapSide) {
     this.isMapSide = isMapSide;
   }
 
-  public HiveConf getCfg() {
+  public Configuration getCfg() {
     return cfg;
   }
 
-  public void setCfg(HiveConf cfg) {
+  public void setCfg(Configuration cfg) {
     this.cfg = cfg;
   }
 
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/plan/PTFDeserializer.java b/ql/src/java/org/apache/hadoop/hive/ql/plan/PTFDeserializer.java
index 217db4e2a2..f75bec582f 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/plan/PTFDeserializer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/plan/PTFDeserializer.java
@@ -26,6 +26,7 @@
 import java.util.Map;
 import java.util.Properties;
 
+import org.apache.hadoop.conf.Configuration;
 import org.apache.hadoop.hive.conf.HiveConf;
 import org.apache.hadoop.hive.ql.exec.ExprNodeEvaluator;
 import org.apache.hadoop.hive.ql.exec.PTFPartition;
@@ -64,10 +65,10 @@ public class PTFDeserializer {
 
   PTFDesc ptfDesc;
   StructObjectInspector inputOI;
-  HiveConf hConf;
+  Configuration hConf;
   LeadLagInfo llInfo;
 
-  public PTFDeserializer(PTFDesc ptfDesc, StructObjectInspector inputOI, HiveConf hConf) {
+  public PTFDeserializer(PTFDesc ptfDesc, StructObjectInspector inputOI, Configuration hConf) {
     super();
     this.ptfDesc = ptfDesc;
     ptfDesc.setCfg(hConf);
@@ -288,7 +289,7 @@ private TableFunctionResolver constructResolver(String className) throws HiveExc
       @SuppressWarnings("unchecked")
       Class<? extends TableFunctionResolver> rCls = (Class<? extends TableFunctionResolver>)
           Class.forName(className);
-      return (TableFunctionResolver) ReflectionUtils.newInstance(rCls, null);
+      return ReflectionUtils.newInstance(rCls, null);
     } catch (Exception e) {
       throw new HiveException(e);
     }
