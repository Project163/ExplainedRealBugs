diff --git a/itests/hive-unit/src/test/java/org/apache/hadoop/hive/metastore/TestHiveMetaStore.java b/itests/hive-unit/src/test/java/org/apache/hadoop/hive/metastore/TestHiveMetaStore.java
index 6cdebcbcea..1b012381cb 100644
--- a/itests/hive-unit/src/test/java/org/apache/hadoop/hive/metastore/TestHiveMetaStore.java
+++ b/itests/hive-unit/src/test/java/org/apache/hadoop/hive/metastore/TestHiveMetaStore.java
@@ -37,6 +37,7 @@
 import org.apache.hadoop.fs.FileSystem;
 import org.apache.hadoop.fs.Path;
 import org.apache.hadoop.fs.permission.FsPermission;
+import org.apache.hadoop.hive.common.FileUtils;
 import org.apache.hadoop.hive.conf.HiveConf;
 import org.apache.hadoop.hive.metastore.api.AlreadyExistsException;
 import org.apache.hadoop.hive.metastore.api.ColumnStatistics;
@@ -258,10 +259,10 @@ public static void partitionTester(HiveMetaStoreClient client, HiveConf hiveConf
       }
       assertTrue("Partitions are not same", part.equals(part_get));
 
-      String partName = "ds=2008-07-01 14%3A13%3A12/hr=14";
-      String part2Name = "ds=2008-07-01 14%3A13%3A12/hr=15";
-      String part3Name ="ds=2008-07-02 14%3A13%3A12/hr=15";
-      String part4Name ="ds=2008-07-03 14%3A13%3A12/hr=151";
+      String partName = "ds=" + FileUtils.escapePathName("2008-07-01 14:13:12") + "/hr=14";
+      String part2Name = "ds=" + FileUtils.escapePathName("2008-07-01 14:13:12") + "/hr=15";
+      String part3Name = "ds=" + FileUtils.escapePathName("2008-07-02 14:13:12") + "/hr=15";
+      String part4Name = "ds=" + FileUtils.escapePathName("2008-07-03 14:13:12") + "/hr=151";
 
       part_get = client.getPartition(dbName, tblName, partName);
       assertTrue("Partitions are not the same", part.equals(part_get));
diff --git a/itests/hive-unit/src/test/java/org/apache/hadoop/hive/metastore/TestMetastoreVersion.java b/itests/hive-unit/src/test/java/org/apache/hadoop/hive/metastore/TestMetastoreVersion.java
index 6206c5c38a..1a4a382f86 100644
--- a/itests/hive-unit/src/test/java/org/apache/hadoop/hive/metastore/TestMetastoreVersion.java
+++ b/itests/hive-unit/src/test/java/org/apache/hadoop/hive/metastore/TestMetastoreVersion.java
@@ -61,7 +61,7 @@ protected void setUp() throws Exception {
   protected void tearDown() throws Exception {
     File metaStoreDir = new File(testMetastoreDB);
     if (metaStoreDir.exists()) {
-      FileUtils.deleteDirectory(metaStoreDir);
+      FileUtils.forceDeleteOnExit(metaStoreDir);
     }
   }
 
diff --git a/itests/hive-unit/src/test/java/org/apache/hive/beeline/TestSchemaTool.java b/itests/hive-unit/src/test/java/org/apache/hive/beeline/TestSchemaTool.java
index 71c7756cac..749fb9e86b 100644
--- a/itests/hive-unit/src/test/java/org/apache/hive/beeline/TestSchemaTool.java
+++ b/itests/hive-unit/src/test/java/org/apache/hive/beeline/TestSchemaTool.java
@@ -56,7 +56,7 @@ protected void setUp() throws Exception {
   protected void tearDown() throws Exception {
     File metaStoreDir = new File(testMetastoreDB);
     if (metaStoreDir.exists()) {
-      FileUtils.deleteDirectory(metaStoreDir);
+      FileUtils.forceDeleteOnExit(metaStoreDir);
     }
   }
 
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/io/orc/FileDump.java b/ql/src/java/org/apache/hadoop/hive/ql/io/orc/FileDump.java
index 7a3f508e81..5d5b760f5f 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/io/orc/FileDump.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/io/orc/FileDump.java
@@ -82,6 +82,7 @@ public static void main(String[] args) throws Exception {
           System.out.println(buf);
         }
       }
+      rows.close();
     }
   }
 }
diff --git a/ql/src/test/org/apache/hadoop/hive/ql/io/TestRCFile.java b/ql/src/test/org/apache/hadoop/hive/ql/io/TestRCFile.java
index a5d9ef67c0..9d8009b310 100644
--- a/ql/src/test/org/apache/hadoop/hive/ql/io/TestRCFile.java
+++ b/ql/src/test/org/apache/hadoop/hive/ql/io/TestRCFile.java
@@ -719,6 +719,7 @@ private void writeThenReadByRecordReader(int intervalRecordCount,
       while (rr.next(key, value)) {
         readCount++;
       }
+      rr.close();
       System.out.println("The " + i + "th split read "
           + (readCount - previousReadCount));
     }
