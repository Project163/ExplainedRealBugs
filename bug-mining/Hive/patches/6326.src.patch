diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/Registry.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/Registry.java
index 09009764cd..6f8a8f5504 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/Registry.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/Registry.java
@@ -348,7 +348,14 @@ private void addToCurrentFunctions(String functionName, FunctionInfo functionInf
   }
 
   public WindowFunctionInfo getWindowFunctionInfo(String functionName) throws SemanticException {
+    // First try without qualifiers - would resolve builtin/temp functions
     FunctionInfo info = getFunctionInfo(WINDOW_FUNC_PREFIX + functionName);
+    // Try qualifying with current db name for permanent functions
+    if (info == null) {
+      String qualifiedName = FunctionUtils.qualifyFunctionName(
+              functionName, SessionState.get().getCurrentDatabase().toLowerCase());
+      info = getFunctionInfo(WINDOW_FUNC_PREFIX + qualifiedName);
+    }
     if (info instanceof WindowFunctionInfo) {
       return (WindowFunctionInfo) info;
     }
