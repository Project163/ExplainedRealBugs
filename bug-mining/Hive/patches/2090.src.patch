diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzerFactory.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzerFactory.java
index e7d0359fb8..f6b70d8398 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzerFactory.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzerFactory.java
@@ -133,7 +133,7 @@ public final class SemanticAnalyzerFactory {
     tablePartitionCommandType.put(HiveParser.TOK_ALTERTABLE_RENAMEPART,
         new HiveOperation[] {null, HiveOperation.ALTERTABLE_RENAMEPART});
     tablePartitionCommandType.put(HiveParser.TOK_COMPACT,
-        new HiveOperation[] {null, HiveOperation.ALTERTABLE_COMPACT});
+        new HiveOperation[] {HiveOperation.ALTERTABLE_COMPACT, HiveOperation.ALTERTABLE_COMPACT});
     tablePartitionCommandType.put(HiveParser.TOK_ALTERTBLPART_SKEWED_LOCATION,
         new HiveOperation[] {HiveOperation.ALTERTBLPART_SKEWED_LOCATION,
             HiveOperation.ALTERTBLPART_SKEWED_LOCATION });
diff --git a/ql/src/test/results/clientpositive/dbtxnmgr_compact1.q.out b/ql/src/test/results/clientpositive/dbtxnmgr_compact1.q.out
index 0c9c2b1e13..a59a3e6dcc 100644
--- a/ql/src/test/results/clientpositive/dbtxnmgr_compact1.q.out
+++ b/ql/src/test/results/clientpositive/dbtxnmgr_compact1.q.out
@@ -6,13 +6,13 @@ POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@T1
 PREHOOK: query: alter table T1 compact 'major'
-PREHOOK: type: null
+PREHOOK: type: ALTERTABLE_COMPACT
 POSTHOOK: query: alter table T1 compact 'major'
-POSTHOOK: type: null
+POSTHOOK: type: ALTERTABLE_COMPACT
 PREHOOK: query: alter table T1 compact 'minor'
-PREHOOK: type: null
+PREHOOK: type: ALTERTABLE_COMPACT
 POSTHOOK: query: alter table T1 compact 'minor'
-POSTHOOK: type: null
+POSTHOOK: type: ALTERTABLE_COMPACT
 PREHOOK: query: drop table T1
 PREHOOK: type: DROPTABLE
 PREHOOK: Input: default@t1
diff --git a/ql/src/test/results/clientpositive/dbtxnmgr_compact3.q.out b/ql/src/test/results/clientpositive/dbtxnmgr_compact3.q.out
index b279dcd2a6..09acb95336 100644
--- a/ql/src/test/results/clientpositive/dbtxnmgr_compact3.q.out
+++ b/ql/src/test/results/clientpositive/dbtxnmgr_compact3.q.out
@@ -14,13 +14,13 @@ POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: D1@T1
 POSTHOOK: Output: database:d1
 PREHOOK: query: alter table T1 compact 'major'
-PREHOOK: type: null
+PREHOOK: type: ALTERTABLE_COMPACT
 POSTHOOK: query: alter table T1 compact 'major'
-POSTHOOK: type: null
+POSTHOOK: type: ALTERTABLE_COMPACT
 PREHOOK: query: alter table T1 compact 'minor'
-PREHOOK: type: null
+PREHOOK: type: ALTERTABLE_COMPACT
 POSTHOOK: query: alter table T1 compact 'minor'
-POSTHOOK: type: null
+POSTHOOK: type: ALTERTABLE_COMPACT
 PREHOOK: query: drop table T1
 PREHOOK: type: DROPTABLE
 PREHOOK: Input: d1@t1
