diff --git a/CHANGES.txt b/CHANGES.txt
index d0cac475ba..f8deee3d68 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -347,6 +347,8 @@ Trunk - Unreleased
 
     HIVE-626. Fix Column Pruner column order bug. (Yongqiang He via zshao)
 
+    HIVE-632. Make conditional task serializable. (Namit Jain via zshao)
+
 Release 0.3.1 - Unreleased
 
   INCOMPATIBLE CHANGES
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/ConditionalTask.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/ConditionalTask.java
index cb93dbc9b7..97188339f9 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/ConditionalTask.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/ConditionalTask.java
@@ -55,7 +55,7 @@ public boolean hasReduce() {
   }
   
   public void initialize (HiveConf conf) {
-    resTask = listTasks.get(resolver.getTaskId(resolverCtx));
+    resTask = listTasks.get(resolver.getTaskId(conf, resolverCtx));
     resTask.initialize(conf);
   }
   
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRFileSink1.java b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRFileSink1.java
index c37b05f82a..697102dcc7 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRFileSink1.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/GenMRFileSink1.java
@@ -175,7 +175,7 @@ private void createMergeJob(FileSinkOperator fsOp, GenMRProcContext ctx, String
     cndTsk.setListTasks(listTasks);
     
     cndTsk.setResolver(new ConditionalResolverMergeFiles());
-    cndTsk.setResolverCtx(new ConditionalResolverMergeFilesCtx(ctx, listTasks, fsOp.getConf().getDirName()));
+    cndTsk.setResolverCtx(new ConditionalResolverMergeFilesCtx(listTasks, fsOp.getConf().getDirName()));
     
     currTask.addDependentTask(cndTsk);
     
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/plan/ConditionalResolver.java b/ql/src/java/org/apache/hadoop/hive/ql/plan/ConditionalResolver.java
index 8b7e89d738..11cd966db8 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/plan/ConditionalResolver.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/plan/ConditionalResolver.java
@@ -18,6 +18,8 @@
 
 package org.apache.hadoop.hive.ql.plan;
 
+import org.apache.hadoop.hive.conf.HiveConf;
+
 /**
  * Conditional task resolution interface. This is invoked at run time to get the task to invoke. 
  * Developers can plug in their own resolvers
@@ -28,5 +30,5 @@ public interface ConditionalResolver {
 	 * @param pctx opaque context
 	 * @return position of the task
 	 */
-	public int getTaskId(Object ctx);
+	public int getTaskId(HiveConf conf, Object ctx);
 }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/plan/ConditionalResolverMergeFiles.java b/ql/src/java/org/apache/hadoop/hive/ql/plan/ConditionalResolverMergeFiles.java
index f43b153cc3..49e5936fa9 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/plan/ConditionalResolverMergeFiles.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/plan/ConditionalResolverMergeFiles.java
@@ -24,31 +24,31 @@
 
 import org.apache.hadoop.fs.FileStatus;
 import org.apache.hadoop.fs.FileSystem;
-import org.apache.hadoop.fs.FsShell;
 import org.apache.hadoop.fs.Path;
 import org.apache.hadoop.hive.conf.HiveConf;
 import org.apache.hadoop.hive.ql.exec.Task;
-import org.apache.hadoop.hive.ql.optimizer.GenMRProcContext;
 
 /**
  * Conditional task resolution interface. This is invoked at run time to get the task to invoke. 
  * Developers can plug in their own resolvers
  */
-public class ConditionalResolverMergeFiles implements ConditionalResolver {
-
-  public static class ConditionalResolverMergeFilesCtx {
-    private GenMRProcContext ctx;
+public class ConditionalResolverMergeFiles implements ConditionalResolver, Serializable {
+  private static final long serialVersionUID = 1L;
+  public ConditionalResolverMergeFiles() {  
+  }
+  
+  public static class ConditionalResolverMergeFilesCtx implements Serializable {
+    private static final long serialVersionUID = 1L;
     List<Task<? extends Serializable>> listTasks;
     private String dir;
-
-    public ConditionalResolverMergeFilesCtx() {  
+    
+    public ConditionalResolverMergeFilesCtx() {      
     }
     
     /**
      * @param dir
      */
-    public ConditionalResolverMergeFilesCtx(GenMRProcContext ctx, List<Task<? extends Serializable>> listTasks, String dir) {
-      this.ctx = ctx;
+    public ConditionalResolverMergeFilesCtx(List<Task<? extends Serializable>> listTasks, String dir) {
       this.listTasks = listTasks;
       this.dir = dir;
     }
@@ -66,21 +66,7 @@ public String getDir() {
     public void setDir(String dir) {
       this.dir = dir;
     }
-
-    /**
-     * @return the ctx
-     */
-    public GenMRProcContext getCtx() {
-      return ctx;
-    }
-
-    /**
-     * @param ctx the ctx to set
-     */
-    public void setCtx(GenMRProcContext ctx) {
-      this.ctx = ctx;
-    }
-
+    
     /**
      * @return the listTasks
      */
@@ -96,14 +82,12 @@ public void setListTasks(List<Task<? extends Serializable>> listTasks) {
     }
   }
   
-	public int getTaskId(Object objCtx) {
+	public int getTaskId(HiveConf conf, Object objCtx) {
     ConditionalResolverMergeFilesCtx ctx = (ConditionalResolverMergeFilesCtx)objCtx;
     String dirName = ctx.getDir();
-    GenMRProcContext opProcCtx = ctx.getCtx();
     
     // check if a map-reduce job is needed to merge the files
     // If the current size is smaller than the target, merge
-    HiveConf conf = opProcCtx.getConf();
     long trgtSize = conf.getLongVar(HiveConf.ConfVars.HIVEMERGEMAPFILESSIZE);
     
     try {
diff --git a/ql/src/test/results/compiler/plan/case_sensitivity.q.xml b/ql/src/test/results/compiler/plan/case_sensitivity.q.xml
index 6d7a94a6e2..88ce3030f1 100644
--- a/ql/src/test/results/compiler/plan/case_sensitivity.q.xml
+++ b/ql/src/test/results/compiler/plan/case_sensitivity.q.xml
@@ -8,7 +8,7 @@
       <void property="childTasks"> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
-         <object id="MoveTask0" class="org.apache.hadoop.hive.ql.exec.MoveTask"> 
+         <object class="org.apache.hadoop.hive.ql.exec.MoveTask"> 
           <void property="id"> 
            <string>Stage-1</string> 
           </void> 
@@ -22,7 +22,7 @@
           <void property="work"> 
            <object class="org.apache.hadoop.hive.ql.plan.moveWork"> 
             <void property="loadTableWork"> 
-             <object id="loadTableDesc0" class="org.apache.hadoop.hive.ql.plan.loadTableDesc"> 
+             <object class="org.apache.hadoop.hive.ql.plan.loadTableDesc"> 
               <void property="partitionSpec"> 
                <object class="java.util.HashMap"/> 
               </void> 
@@ -30,7 +30,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/31102222/10000</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1072947222/10000</string> 
               </void> 
               <void property="table"> 
                <object id="tableDesc0" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -83,7 +83,7 @@
                   </void> 
                   <void method="put"> 
                    <string>location</string> 
-                   <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/dest1</string> 
+                   <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/dest1</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -93,7 +93,7 @@
                </object> 
               </void> 
               <void property="tmpDir"> 
-               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/31102222/10001</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1072947222/10001</string> 
               </void> 
              </object> 
             </void> 
@@ -121,10 +121,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/389289410/10002</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1995185936/10002</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/31102222/10000</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1072947222/10000</string> 
               </void> 
              </object> 
             </void> 
@@ -142,7 +142,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/389289410/10002</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1995185936/10002</string> 
                <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -338,10 +338,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/389289410/10002</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1995185936/10002</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/389289410/10002</string> 
+                 <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1995185936/10002</string> 
                 </void> 
                </object> 
               </void> 
@@ -350,7 +350,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/389289410/10002</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1995185936/10002</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object idref="tableDesc0"/> 
@@ -368,7 +368,7 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/31102222/10000</string> 
+                     <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1072947222/10000</string> 
                     </void> 
                     <void property="tableInfo"> 
                      <object idref="tableDesc0"/> 
@@ -462,277 +462,229 @@
       </void> 
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
-        <void property="ctx"> 
-         <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext"> 
-          <void property="conf"> 
-           <object id="HiveConf0" class="org.apache.hadoop.hive.conf.HiveConf"> 
-            <void property="auxJars"> 
-             <string>file:///data/users/njain/hive_commit1/hive_commit1/build/ql/test/test-udfs.jar</string> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="currAliasId"> 
-           <string>src_thrift</string> 
+        <void property="dir"> 
+         <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1995185936/10002</string> 
+        </void> 
+        <void property="listTasks"> 
+         <object idref="ArrayList0"/> 
+        </void> 
+       </object> 
+      </void> 
+      <void property="work"> 
+       <object class="org.apache.hadoop.hive.ql.plan.ConditionalWork"> 
+        <void property="listWorks"> 
+         <object class="java.util.ArrayList"> 
+          <void method="add"> 
+           <object idref="moveWork0"/> 
           </void> 
-          <void property="currTask"> 
-           <object idref="MapRedTask0"/> 
+          <void method="add"> 
+           <object idref="mapredWork0"/> 
           </void> 
-          <void property="currTopOp"> 
-           <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
+         </object> 
+        </void> 
+       </object> 
+      </void> 
+     </object> 
+    </void> 
+   </object> 
+  </void> 
+  <void property="id"> 
+   <string>Stage-2</string> 
+  </void> 
+  <void property="work"> 
+   <object class="org.apache.hadoop.hive.ql.plan.mapredWork"> 
+    <void property="aliasToPartnInfo"> 
+     <void method="put"> 
+      <string>src_thrift</string> 
+      <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
+       <void property="partSpec"> 
+        <object id="LinkedHashMap0" class="java.util.LinkedHashMap"/> 
+       </void> 
+       <void property="tableDesc"> 
+        <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
+         <void property="deserializerClass"> 
+          <class>org.apache.hadoop.hive.serde2.ThriftDeserializer</class> 
+         </void> 
+         <void property="inputFileFormatClass"> 
+          <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+         </void> 
+         <void property="outputFileFormatClass"> 
+          <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+         </void> 
+         <void property="properties"> 
+          <object id="Properties0" class="java.util.Properties"> 
+           <void method="put"> 
+            <string>name</string> 
+            <string>src_thrift</string> 
+           </void> 
+           <void method="put"> 
+            <string>columns.types</string> 
+            <string></string> 
+           </void> 
+           <void method="put"> 
+            <string>serialization.ddl</string> 
+            <string>struct src_thrift { }</string> 
+           </void> 
+           <void method="put"> 
+            <string>columns</string> 
+            <string></string> 
+           </void> 
+           <void method="put"> 
+            <string>serialization.format</string> 
+            <string>org.apache.thrift.protocol.TBinaryProtocol</string> 
+           </void> 
+           <void method="put"> 
+            <string>serialization.class</string> 
+            <string>org.apache.hadoop.hive.serde2.thrift.test.Complex</string> 
+           </void> 
+           <void method="put"> 
+            <string>bucket_count</string> 
+            <string>-1</string> 
+           </void> 
+           <void method="put"> 
+            <string>serialization.lib</string> 
+            <string>org.apache.hadoop.hive.serde2.ThriftDeserializer</string> 
+           </void> 
+           <void method="put"> 
+            <string>file.inputformat</string> 
+            <string>org.apache.hadoop.mapred.SequenceFileInputFormat</string> 
+           </void> 
+           <void method="put"> 
+            <string>file.outputformat</string> 
+            <string>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</string> 
+           </void> 
+           <void method="put"> 
+            <string>location</string> 
+            <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/src_thrift</string> 
+           </void> 
+          </object> 
+         </void> 
+         <void property="serdeClassName"> 
+          <string>org.apache.hadoop.hive.serde2.ThriftDeserializer</string> 
+         </void> 
+        </object> 
+       </void> 
+      </object> 
+     </void> 
+    </void> 
+    <void property="aliasToWork"> 
+     <object class="java.util.LinkedHashMap"> 
+      <void method="put"> 
+       <string>src_thrift</string> 
+       <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
+        <void property="childOperators"> 
+         <object class="java.util.ArrayList"> 
+          <void method="add"> 
+           <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
             <void property="childOperators"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+               <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+                   <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
                     <void property="childOperators"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                        <void property="childOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object id="FileSinkOperator0" class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                            <void property="conf"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
-                              <void property="destTableId"> 
-                               <int>1</int> 
-                              </void> 
-                              <void property="dirName"> 
-                               <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/389289410/10002</string> 
-                              </void> 
-                              <void property="tableInfo"> 
-                               <object idref="tableDesc0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="parentOperators"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object idref="SelectOperator0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="schema"> 
-                             <object idref="RowSchema0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="columnExprMap"> 
-                         <object class="java.util.HashMap"> 
-                          <void method="put"> 
-                           <string>_col1</string> 
-                           <object id="exprNodeFieldDesc0" class="org.apache.hadoop.hive.ql.plan.exprNodeFieldDesc"> 
-                            <void property="desc"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.exprNodeGenericFuncDesc"> 
-                              <void property="childExprs"> 
-                               <object class="java.util.ArrayList"> 
-                                <void method="add"> 
-                                 <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                                  <void property="column"> 
-                                   <string>lintstring</string> 
-                                  </void> 
-                                  <void property="typeInfo"> 
-                                   <object id="ListTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.ListTypeInfo"> 
-                                    <void property="listElementTypeInfo"> 
-                                     <object id="StructTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.StructTypeInfo"/> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void method="add"> 
-                                 <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
-                                  <void property="typeInfo"> 
-                                   <object idref="PrimitiveTypeInfo1"/> 
-                                  </void> 
-                                  <void property="value"> 
-                                   <int>0</int> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void property="genericUDFClass"> 
-                               <class>org.apache.hadoop.hive.ql.udf.generic.GenericUDFIndex</class> 
-                              </void> 
-                              <void property="typeInfo"> 
-                               <object idref="StructTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="fieldName"> 
-                             <string>MYSTRING</string> 
-                            </void> 
-                            <void property="isList"> 
-                             <boolean>false</boolean> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="put"> 
-                           <string>_col0</string> 
-                           <object id="exprNodeGenericFuncDesc0" class="org.apache.hadoop.hive.ql.plan.exprNodeGenericFuncDesc"> 
-                            <void property="childExprs"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                                <void property="column"> 
-                                 <string>lint</string> 
-                                </void> 
-                                <void property="typeInfo"> 
-                                 <object id="ListTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.ListTypeInfo"> 
-                                  <void property="listElementTypeInfo"> 
-                                   <object idref="PrimitiveTypeInfo1"/> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
-                                <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo1"/> 
-                                </void> 
-                                <void property="value"> 
-                                 <int>1</int> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="genericUDFClass"> 
-                             <class>org.apache.hadoop.hive.ql.udf.generic.GenericUDFIndex</class> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
+                       <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
                         <void property="conf"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.selectDesc"> 
-                          <void property="colList"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object idref="exprNodeGenericFuncDesc0"/> 
-                            </void> 
-                            <void method="add"> 
-                             <object idref="exprNodeFieldDesc0"/> 
-                            </void> 
-                           </object> 
+                         <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
+                          <void property="destTableId"> 
+                           <int>1</int> 
                           </void> 
-                          <void property="outputColumnNames"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <string>_col0</string> 
-                            </void> 
-                            <void method="add"> 
-                             <string>_col1</string> 
-                            </void> 
-                           </object> 
+                          <void property="dirName"> 
+                           <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1995185936/10002</string> 
+                          </void> 
+                          <void property="tableInfo"> 
+                           <object idref="tableDesc0"/> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="parentOperators"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <object idref="FilterOperator1"/> 
+                           <object idref="SelectOperator0"/> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="schema"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                          <void property="signature"> 
-                           <object class="java.util.Vector"> 
+                         <object idref="RowSchema0"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="columnExprMap"> 
+                     <object class="java.util.HashMap"> 
+                      <void method="put"> 
+                       <string>_col1</string> 
+                       <object id="exprNodeFieldDesc0" class="org.apache.hadoop.hive.ql.plan.exprNodeFieldDesc"> 
+                        <void property="desc"> 
+                         <object class="org.apache.hadoop.hive.ql.plan.exprNodeGenericFuncDesc"> 
+                          <void property="childExprs"> 
+                           <object class="java.util.ArrayList"> 
                             <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>_col0</string> 
+                             <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                              <void property="column"> 
+                               <string>lintstring</string> 
                               </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo1"/> 
+                              <void property="typeInfo"> 
+                               <object id="ListTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.ListTypeInfo"> 
+                                <void property="listElementTypeInfo"> 
+                                 <object id="StructTypeInfo0" class="org.apache.hadoop.hive.serde2.typeinfo.StructTypeInfo"/> 
+                                </void> 
+                               </object> 
                               </void> 
                              </object> 
                             </void> 
                             <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>_col1</string> 
+                             <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
+                              <void property="typeInfo"> 
+                               <object idref="PrimitiveTypeInfo1"/> 
                               </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
+                              <void property="value"> 
+                               <int>0</int> 
                               </void> 
                              </object> 
                             </void> 
                            </object> 
                           </void> 
+                          <void property="genericUDFClass"> 
+                           <class>org.apache.hadoop.hive.ql.udf.generic.GenericUDFIndex</class> 
+                          </void> 
+                          <void property="typeInfo"> 
+                           <object idref="StructTypeInfo0"/> 
+                          </void> 
                          </object> 
                         </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.filterDesc"> 
-                      <void property="predicate"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                        <void property="UDFClass"> 
-                         <class>org.apache.hadoop.hive.ql.udf.UDFOPGreaterThan</class> 
+                        <void property="fieldName"> 
+                         <string>MYSTRING</string> 
                         </void> 
-                        <void property="UDFMethod"> 
-                         <object id="Method0" class="org.apache.hadoop.hive.ql.udf.UDFOPGreaterThan" method="getMethod"> 
-                          <string>evaluate</string> 
-                          <array class="java.lang.Class" length="2"> 
-                           <void index="0"> 
-                            <class>org.apache.hadoop.io.IntWritable</class> 
-                           </void> 
-                           <void index="1"> 
-                            <class>org.apache.hadoop.io.IntWritable</class> 
-                           </void> 
-                          </array> 
-                         </object> 
+                        <void property="isList"> 
+                         <boolean>false</boolean> 
+                        </void> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo0"/> 
                         </void> 
+                       </object> 
+                      </void> 
+                      <void method="put"> 
+                       <string>_col0</string> 
+                       <object id="exprNodeGenericFuncDesc0" class="org.apache.hadoop.hive.ql.plan.exprNodeGenericFuncDesc"> 
                         <void property="childExprs"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeGenericFuncDesc"> 
-                            <void property="childExprs"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                                <void property="column"> 
-                                 <string>lint</string> 
-                                </void> 
-                                <void property="typeInfo"> 
-                                 <object idref="ListTypeInfo1"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
-                                <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo1"/> 
-                                </void> 
-                                <void property="value"> 
-                                 <int>0</int> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="genericUDFClass"> 
-                             <class>org.apache.hadoop.hive.ql.udf.generic.GenericUDFIndex</class> 
+                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                            <void property="column"> 
+                             <string>lint</string> 
                             </void> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
+                             <object id="ListTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.ListTypeInfo"> 
+                              <void property="listElementTypeInfo"> 
+                               <object idref="PrimitiveTypeInfo1"/> 
+                              </void> 
+                             </object> 
                             </void> 
                            </object> 
                           </void> 
@@ -742,18 +694,41 @@
                              <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                             <void property="value"> 
-                             <int>0</int> 
+                             <int>1</int> 
                             </void> 
                            </object> 
                           </void> 
                          </object> 
                         </void> 
+                        <void property="genericUDFClass"> 
+                         <class>org.apache.hadoop.hive.ql.udf.generic.GenericUDFIndex</class> 
+                        </void> 
                         <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>boolean</string> 
-                          </void> 
-                         </object> 
+                         <object idref="PrimitiveTypeInfo1"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="conf"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.selectDesc"> 
+                      <void property="colList"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <object idref="exprNodeGenericFuncDesc0"/> 
+                        </void> 
+                        <void method="add"> 
+                         <object idref="exprNodeFieldDesc0"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="outputColumnNames"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <string>_col0</string> 
+                        </void> 
+                        <void method="add"> 
+                         <string>_col1</string> 
                         </void> 
                        </object> 
                       </void> 
@@ -762,18 +737,18 @@
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object idref="FilterOperator0"/> 
+                       <object idref="FilterOperator1"/> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="schema"> 
                      <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
                       <void property="signature"> 
-                       <object id="Vector0" class="java.util.Vector"> 
+                       <object class="java.util.Vector"> 
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                           <void property="internalName"> 
-                           <string>aint</string> 
+                           <string>_col0</string> 
                           </void> 
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo1"/> 
@@ -783,64 +758,13 @@
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                           <void property="internalName"> 
-                           <string>astring</string> 
+                           <string>_col1</string> 
                           </void> 
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
                          </object> 
                         </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>lint</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="ListTypeInfo1"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>lstring</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object class="org.apache.hadoop.hive.serde2.typeinfo.ListTypeInfo"> 
-                            <void property="listElementTypeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>lintstring</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="ListTypeInfo0"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>mstringstring</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object class="org.apache.hadoop.hive.serde2.typeinfo.MapTypeInfo"> 
-                            <void property="mapKeyTypeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                            <void property="mapValueTypeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
                        </object> 
                       </void> 
                      </object> 
@@ -857,7 +781,17 @@
                      <class>org.apache.hadoop.hive.ql.udf.UDFOPGreaterThan</class> 
                     </void> 
                     <void property="UDFMethod"> 
-                     <object idref="Method0"/> 
+                     <object id="Method0" class="org.apache.hadoop.hive.ql.udf.UDFOPGreaterThan" method="getMethod"> 
+                      <string>evaluate</string> 
+                      <array class="java.lang.Class" length="2"> 
+                       <void index="0"> 
+                        <class>org.apache.hadoop.io.IntWritable</class> 
+                       </void> 
+                       <void index="1"> 
+                        <class>org.apache.hadoop.io.IntWritable</class> 
+                       </void> 
+                      </array> 
+                     </object> 
                     </void> 
                     <void property="childExprs"> 
                      <object class="java.util.ArrayList"> 
@@ -908,7 +842,11 @@
                      </object> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                     <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                      <void property="typeName"> 
+                       <string>boolean</string> 
+                      </void> 
+                     </object> 
                     </void> 
                    </object> 
                   </void> 
@@ -917,14 +855,86 @@
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object idref="TableScanOperator1"/> 
+                   <object idref="FilterOperator0"/> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="schema"> 
                  <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
                   <void property="signature"> 
-                   <object idref="Vector0"/> 
+                   <object id="Vector0" class="java.util.Vector"> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="internalName"> 
+                       <string>aint</string> 
+                      </void> 
+                      <void property="type"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="internalName"> 
+                       <string>astring</string> 
+                      </void> 
+                      <void property="type"> 
+                       <object idref="PrimitiveTypeInfo0"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="internalName"> 
+                       <string>lint</string> 
+                      </void> 
+                      <void property="type"> 
+                       <object idref="ListTypeInfo1"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="internalName"> 
+                       <string>lstring</string> 
+                      </void> 
+                      <void property="type"> 
+                       <object class="org.apache.hadoop.hive.serde2.typeinfo.ListTypeInfo"> 
+                        <void property="listElementTypeInfo"> 
+                         <object idref="PrimitiveTypeInfo0"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="internalName"> 
+                       <string>lintstring</string> 
+                      </void> 
+                      <void property="type"> 
+                       <object idref="ListTypeInfo0"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="internalName"> 
+                       <string>mstringstring</string> 
+                      </void> 
+                      <void property="type"> 
+                       <object class="org.apache.hadoop.hive.serde2.typeinfo.MapTypeInfo"> 
+                        <void property="mapKeyTypeInfo"> 
+                         <object idref="PrimitiveTypeInfo0"/> 
+                        </void> 
+                        <void property="mapValueTypeInfo"> 
+                         <object idref="PrimitiveTypeInfo0"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                   </object> 
                   </void> 
                  </object> 
                 </void> 
@@ -932,226 +942,103 @@
               </void> 
              </object> 
             </void> 
-            <void property="neededColumnIDs"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <int>2</int> 
-              </void> 
-              <void method="add"> 
-               <int>4</int> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object idref="Vector0"/> 
-              </void> 
-             </object> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="mapCurrCtx"> 
-           <object class="java.util.LinkedHashMap"> 
-            <void method="put"> 
-             <object idref="TableScanOperator1"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-            <void method="put"> 
-             <object idref="FilterOperator0"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-            <void method="put"> 
-             <object idref="FilterOperator1"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-            <void method="put"> 
-             <object idref="SelectOperator0"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="mvTask"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="MoveTask0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="opTaskMap"> 
-           <object class="java.util.HashMap"> 
-            <void method="put"> 
-             <null/> 
-             <object idref="MapRedTask0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="parseCtx"> 
-           <object class="org.apache.hadoop.hive.ql.parse.ParseContext"> 
-            <void property="QB"> 
-             <object class="org.apache.hadoop.hive.ql.parse.QB"/> 
-            </void> 
-            <void property="UCtx"> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.unionproc.UnionProcContext"/> 
-            </void> 
-            <void property="aliasToPruner"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>src_thrift</string> 
-               <object class="org.apache.hadoop.hive.ql.parse.PartitionPruner"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="aliasToSamplePruner"> 
-             <object class="java.util.HashMap"/> 
-            </void> 
             <void property="conf"> 
-             <object idref="HiveConf0"/> 
-            </void> 
-            <void property="context"> 
-             <object class="org.apache.hadoop.hive.ql.Context"/> 
-            </void> 
-            <void property="destTableId"> 
-             <int>2</int> 
-            </void> 
-            <void property="idToTableNameMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>1</string> 
-               <string>dest1</string> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="joinContext"> 
-             <object class="java.util.HashMap"/> 
-            </void> 
-            <void property="listMapJoinOpsNoReducer"> 
-             <object class="java.util.ArrayList"/> 
-            </void> 
-            <void property="loadFileWork"> 
-             <object class="java.util.ArrayList"/> 
-            </void> 
-            <void property="loadTableWork"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="loadTableDesc0"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="opParseCtx"> 
-             <object class="java.util.LinkedHashMap"> 
-              <void method="put"> 
-               <object idref="TableScanOperator1"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object id="RowResolver0" class="org.apache.hadoop.hive.ql.parse.RowResolver"/> 
+             <object class="org.apache.hadoop.hive.ql.plan.filterDesc"> 
+              <void property="predicate"> 
+               <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                <void property="UDFClass"> 
+                 <class>org.apache.hadoop.hive.ql.udf.UDFOPGreaterThan</class> 
                 </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="FilterOperator1"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object idref="RowResolver0"/> 
+                <void property="UDFMethod"> 
+                 <object idref="Method0"/> 
                 </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="SelectOperator0"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object id="RowResolver1" class="org.apache.hadoop.hive.ql.parse.RowResolver"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="FileSinkOperator0"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object idref="RowResolver1"/> 
+                <void property="childExprs"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeGenericFuncDesc"> 
+                    <void property="childExprs"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                        <void property="column"> 
+                         <string>lint</string> 
+                        </void> 
+                        <void property="typeInfo"> 
+                         <object idref="ListTypeInfo1"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
+                        </void> 
+                        <void property="value"> 
+                         <int>0</int> 
+                        </void> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="genericUDFClass"> 
+                     <class>org.apache.hadoop.hive.ql.udf.generic.GenericUDFIndex</class> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo1"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo1"/> 
+                    </void> 
+                    <void property="value"> 
+                     <int>0</int> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
                 </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="FilterOperator0"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object idref="RowResolver0"/> 
+                <void property="typeInfo"> 
+                 <object idref="PrimitiveTypeInfo2"/> 
                 </void> 
                </object> 
               </void> 
              </object> 
             </void> 
-            <void property="parseTree"> 
-             <object class="org.apache.hadoop.hive.ql.parse.ASTNode"> 
-              <void property="tokenStartIndex"> 
-               <int>0</int> 
-              </void> 
-              <void property="tokenStopIndex"> 
-               <int>42</int> 
+            <void property="parentOperators"> 
+             <object class="java.util.ArrayList"> 
+              <void method="add"> 
+               <object idref="TableScanOperator1"/> 
               </void> 
              </object> 
             </void> 
-            <void property="topOps"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>src_thrift</string> 
-               <object idref="TableScanOperator1"/> 
+            <void property="schema"> 
+             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+              <void property="signature"> 
+               <object idref="Vector0"/> 
               </void> 
              </object> 
             </void> 
-            <void property="topSelOps"> 
-             <object class="java.util.HashMap"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="rootOps"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="TableScanOperator1"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="rootTasks"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="MapRedTask0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="seenFileSinkOps"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="FileSinkOperator0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="seenOps"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="TableScanOperator1"/> 
-            </void> 
            </object> 
           </void> 
          </object> 
         </void> 
-        <void property="dir"> 
-         <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/tmp/389289410/10002</string> 
-        </void> 
-        <void property="listTasks"> 
-         <object idref="ArrayList0"/> 
-        </void> 
-       </object> 
-      </void> 
-      <void property="work"> 
-       <object class="org.apache.hadoop.hive.ql.plan.ConditionalWork"> 
-        <void property="listWorks"> 
+        <void property="neededColumnIDs"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <object idref="moveWork0"/> 
+           <int>2</int> 
           </void> 
           <void method="add"> 
-           <object idref="mapredWork0"/> 
+           <int>4</int> 
+          </void> 
+         </object> 
+        </void> 
+        <void property="schema"> 
+         <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+          <void property="signature"> 
+           <object idref="Vector0"/> 
           </void> 
          </object> 
         </void> 
@@ -1159,99 +1046,10 @@
       </void> 
      </object> 
     </void> 
-   </object> 
-  </void> 
-  <void property="id"> 
-   <string>Stage-2</string> 
-  </void> 
-  <void property="work"> 
-   <object class="org.apache.hadoop.hive.ql.plan.mapredWork"> 
-    <void property="aliasToPartnInfo"> 
-     <void method="put"> 
-      <string>src_thrift</string> 
-      <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
-       <void property="partSpec"> 
-        <object id="LinkedHashMap0" class="java.util.LinkedHashMap"/> 
-       </void> 
-       <void property="tableDesc"> 
-        <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
-         <void property="deserializerClass"> 
-          <class>org.apache.hadoop.hive.serde2.ThriftDeserializer</class> 
-         </void> 
-         <void property="inputFileFormatClass"> 
-          <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-         </void> 
-         <void property="outputFileFormatClass"> 
-          <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-         </void> 
-         <void property="properties"> 
-          <object id="Properties0" class="java.util.Properties"> 
-           <void method="put"> 
-            <string>name</string> 
-            <string>src_thrift</string> 
-           </void> 
-           <void method="put"> 
-            <string>columns.types</string> 
-            <string></string> 
-           </void> 
-           <void method="put"> 
-            <string>serialization.ddl</string> 
-            <string>struct src_thrift { }</string> 
-           </void> 
-           <void method="put"> 
-            <string>columns</string> 
-            <string></string> 
-           </void> 
-           <void method="put"> 
-            <string>serialization.format</string> 
-            <string>org.apache.thrift.protocol.TBinaryProtocol</string> 
-           </void> 
-           <void method="put"> 
-            <string>serialization.class</string> 
-            <string>org.apache.hadoop.hive.serde2.thrift.test.Complex</string> 
-           </void> 
-           <void method="put"> 
-            <string>bucket_count</string> 
-            <string>-1</string> 
-           </void> 
-           <void method="put"> 
-            <string>serialization.lib</string> 
-            <string>org.apache.hadoop.hive.serde2.ThriftDeserializer</string> 
-           </void> 
-           <void method="put"> 
-            <string>file.inputformat</string> 
-            <string>org.apache.hadoop.mapred.SequenceFileInputFormat</string> 
-           </void> 
-           <void method="put"> 
-            <string>file.outputformat</string> 
-            <string>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</string> 
-           </void> 
-           <void method="put"> 
-            <string>location</string> 
-            <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/src_thrift</string> 
-           </void> 
-          </object> 
-         </void> 
-         <void property="serdeClassName"> 
-          <string>org.apache.hadoop.hive.serde2.ThriftDeserializer</string> 
-         </void> 
-        </object> 
-       </void> 
-      </object> 
-     </void> 
-    </void> 
-    <void property="aliasToWork"> 
-     <object class="java.util.LinkedHashMap"> 
-      <void method="put"> 
-       <string>src_thrift</string> 
-       <object idref="TableScanOperator1"/> 
-      </void> 
-     </object> 
-    </void> 
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/src_thrift</string> 
+       <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/src_thrift</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>src_thrift</string> 
@@ -1263,7 +1061,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive_commit1/hive_commit1/build/ql/test/data/warehouse/src_thrift</string> 
+       <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/src_thrift</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/input1.q.xml b/ql/src/test/results/compiler/plan/input1.q.xml
index af611dbf2b..f113e6621e 100755
--- a/ql/src/test/results/compiler/plan/input1.q.xml
+++ b/ql/src/test/results/compiler/plan/input1.q.xml
@@ -8,7 +8,7 @@
       <void property="childTasks"> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
-         <object id="MoveTask0" class="org.apache.hadoop.hive.ql.exec.MoveTask"> 
+         <object class="org.apache.hadoop.hive.ql.exec.MoveTask"> 
           <void property="id"> 
            <string>Stage-1</string> 
           </void> 
@@ -22,7 +22,7 @@
           <void property="work"> 
            <object class="org.apache.hadoop.hive.ql.plan.moveWork"> 
             <void property="loadTableWork"> 
-             <object id="loadTableDesc0" class="org.apache.hadoop.hive.ql.plan.loadTableDesc"> 
+             <object class="org.apache.hadoop.hive.ql.plan.loadTableDesc"> 
               <void property="partitionSpec"> 
                <object class="java.util.HashMap"/> 
               </void> 
@@ -30,7 +30,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/310172006/10000</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1854133725/10000</string> 
               </void> 
               <void property="table"> 
                <object id="tableDesc0" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -83,7 +83,7 @@
                   </void> 
                   <void method="put"> 
                    <string>location</string> 
-                   <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/dest1</string> 
+                   <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/dest1</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -93,7 +93,7 @@
                </object> 
               </void> 
               <void property="tmpDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/310172006/10001</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1854133725/10001</string> 
               </void> 
              </object> 
             </void> 
@@ -121,10 +121,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/272093383/10002</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1870093221/10002</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/310172006/10000</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1854133725/10000</string> 
               </void> 
              </object> 
             </void> 
@@ -142,7 +142,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/272093383/10002</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1870093221/10002</string> 
                <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -338,10 +338,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/272093383/10002</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1870093221/10002</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/272093383/10002</string> 
+                 <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1870093221/10002</string> 
                 </void> 
                </object> 
               </void> 
@@ -350,7 +350,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/272093383/10002</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1870093221/10002</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object idref="tableDesc0"/> 
@@ -368,7 +368,7 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/310172006/10000</string> 
+                     <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1854133725/10000</string> 
                     </void> 
                     <void property="tableInfo"> 
                      <object idref="tableDesc0"/> 
@@ -458,257 +458,200 @@
       </void> 
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
-        <void property="ctx"> 
-         <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext"> 
-          <void property="conf"> 
-           <object id="HiveConf0" class="org.apache.hadoop.hive.conf.HiveConf"> 
-            <void property="auxJars"> 
-             <string>file:///data/users/njain/hive3/hive3/build/ql/test/test-udfs.jar</string> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="currAliasId"> 
-           <string>src</string> 
+        <void property="dir"> 
+         <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1870093221/10002</string> 
+        </void> 
+        <void property="listTasks"> 
+         <object idref="ArrayList0"/> 
+        </void> 
+       </object> 
+      </void> 
+      <void property="work"> 
+       <object class="org.apache.hadoop.hive.ql.plan.ConditionalWork"> 
+        <void property="listWorks"> 
+         <object class="java.util.ArrayList"> 
+          <void method="add"> 
+           <object idref="moveWork0"/> 
           </void> 
-          <void property="currTask"> 
-           <object idref="MapRedTask0"/> 
+          <void method="add"> 
+           <object idref="mapredWork0"/> 
           </void> 
-          <void property="currTopOp"> 
-           <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
+         </object> 
+        </void> 
+       </object> 
+      </void> 
+     </object> 
+    </void> 
+   </object> 
+  </void> 
+  <void property="id"> 
+   <string>Stage-2</string> 
+  </void> 
+  <void property="work"> 
+   <object class="org.apache.hadoop.hive.ql.plan.mapredWork"> 
+    <void property="aliasToPartnInfo"> 
+     <void method="put"> 
+      <string>src</string> 
+      <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
+       <void property="partSpec"> 
+        <object id="LinkedHashMap0" class="java.util.LinkedHashMap"/> 
+       </void> 
+       <void property="tableDesc"> 
+        <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
+         <void property="deserializerClass"> 
+          <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
+         </void> 
+         <void property="inputFileFormatClass"> 
+          <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+         </void> 
+         <void property="outputFileFormatClass"> 
+          <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+         </void> 
+         <void property="properties"> 
+          <object id="Properties0" class="java.util.Properties"> 
+           <void method="put"> 
+            <string>name</string> 
+            <string>src</string> 
+           </void> 
+           <void method="put"> 
+            <string>columns.types</string> 
+            <string>string:string</string> 
+           </void> 
+           <void method="put"> 
+            <string>serialization.ddl</string> 
+            <string>struct src { string key, string value}</string> 
+           </void> 
+           <void method="put"> 
+            <string>serialization.format</string> 
+            <string>1</string> 
+           </void> 
+           <void method="put"> 
+            <string>columns</string> 
+            <string>key,value</string> 
+           </void> 
+           <void method="put"> 
+            <string>bucket_count</string> 
+            <string>-1</string> 
+           </void> 
+           <void method="put"> 
+            <string>serialization.lib</string> 
+            <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+           </void> 
+           <void method="put"> 
+            <string>file.inputformat</string> 
+            <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+           </void> 
+           <void method="put"> 
+            <string>file.outputformat</string> 
+            <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+           </void> 
+           <void method="put"> 
+            <string>location</string> 
+            <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/src</string> 
+           </void> 
+          </object> 
+         </void> 
+         <void property="serdeClassName"> 
+          <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+         </void> 
+        </object> 
+       </void> 
+      </object> 
+     </void> 
+    </void> 
+    <void property="aliasToWork"> 
+     <object class="java.util.LinkedHashMap"> 
+      <void method="put"> 
+       <string>src</string> 
+       <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
+        <void property="childOperators"> 
+         <object class="java.util.ArrayList"> 
+          <void method="add"> 
+           <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
             <void property="childOperators"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+               <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+                   <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
                     <void property="childOperators"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                        <void property="childOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object id="FileSinkOperator0" class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                            <void property="conf"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
-                              <void property="destTableId"> 
-                               <int>1</int> 
-                              </void> 
-                              <void property="dirName"> 
-                               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/272093383/10002</string> 
-                              </void> 
-                              <void property="tableInfo"> 
-                               <object idref="tableDesc0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="parentOperators"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object idref="SelectOperator0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="schema"> 
-                             <object idref="RowSchema0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="columnExprMap"> 
-                         <object class="java.util.HashMap"> 
-                          <void method="put"> 
-                           <string>_col1</string> 
-                           <object id="exprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>value</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="put"> 
-                           <string>_col0</string> 
-                           <object id="exprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>key</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
+                       <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
                         <void property="conf"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.selectDesc"> 
-                          <void property="colList"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object idref="exprNodeColumnDesc1"/> 
-                            </void> 
-                            <void method="add"> 
-                             <object idref="exprNodeColumnDesc0"/> 
-                            </void> 
-                           </object> 
+                         <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
+                          <void property="destTableId"> 
+                           <int>1</int> 
                           </void> 
-                          <void property="outputColumnNames"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <string>_col0</string> 
-                            </void> 
-                            <void method="add"> 
-                             <string>_col1</string> 
-                            </void> 
-                           </object> 
+                          <void property="dirName"> 
+                           <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1870093221/10002</string> 
+                          </void> 
+                          <void property="tableInfo"> 
+                           <object idref="tableDesc0"/> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="parentOperators"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <object idref="FilterOperator1"/> 
+                           <object idref="SelectOperator0"/> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="schema"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                          <void property="signature"> 
-                           <object class="java.util.Vector"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>_col0</string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo1"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>_col1</string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo1"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
+                         <object idref="RowSchema0"/> 
                         </void> 
                        </object> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.filterDesc"> 
-                      <void property="predicate"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                        <void property="UDFClass"> 
-                         <class>org.apache.hadoop.hive.ql.udf.UDFOPLessThan</class> 
+                    <void property="columnExprMap"> 
+                     <object class="java.util.HashMap"> 
+                      <void method="put"> 
+                       <string>_col1</string> 
+                       <object id="exprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                        <void property="column"> 
+                         <string>value</string> 
                         </void> 
-                        <void property="UDFMethod"> 
-                         <object id="Method0" class="org.apache.hadoop.hive.ql.udf.UDFOPLessThan" method="getMethod"> 
-                          <string>evaluate</string> 
-                          <array class="java.lang.Class" length="2"> 
-                           <void index="0"> 
-                            <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
-                           </void> 
-                           <void index="1"> 
-                            <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
-                           </void> 
-                          </array> 
-                         </object> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                            <void property="UDFClass"> 
-                             <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
-                            </void> 
-                            <void property="UDFMethod"> 
-                             <object id="Method1" class="org.apache.hadoop.hive.ql.udf.UDFToDouble" method="getMethod"> 
-                              <string>evaluate</string> 
-                              <array class="java.lang.Class" length="1"> 
-                               <void index="0"> 
-                                <class>org.apache.hadoop.io.Text</class> 
-                               </void> 
-                              </array> 
-                             </object> 
-                            </void> 
-                            <void property="childExprs"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                                <void property="column"> 
-                                 <string>key</string> 
-                                </void> 
-                                <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo1"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                            <void property="UDFClass"> 
-                             <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
-                            </void> 
-                            <void property="UDFMethod"> 
-                             <object id="Method2" class="org.apache.hadoop.hive.ql.udf.UDFToDouble" method="getMethod"> 
-                              <string>evaluate</string> 
-                              <array class="java.lang.Class" length="1"> 
-                               <void index="0"> 
-                                <class>org.apache.hadoop.io.IntWritable</class> 
-                               </void> 
-                              </array> 
-                             </object> 
-                            </void> 
-                            <void property="childExprs"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
-                                <void property="typeInfo"> 
-                                 <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                                  <void property="typeName"> 
-                                   <string>int</string> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void property="value"> 
-                                 <int>100</int> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
+                       </object> 
+                      </void> 
+                      <void method="put"> 
+                       <string>_col0</string> 
+                       <object id="exprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                        <void property="column"> 
+                         <string>key</string> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo3" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>boolean</string> 
-                          </void> 
-                         </object> 
+                         <object idref="PrimitiveTypeInfo1"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="conf"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.selectDesc"> 
+                      <void property="colList"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <object idref="exprNodeColumnDesc1"/> 
+                        </void> 
+                        <void method="add"> 
+                         <object idref="exprNodeColumnDesc0"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="outputColumnNames"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <string>_col0</string> 
+                        </void> 
+                        <void method="add"> 
+                         <string>_col1</string> 
                         </void> 
                        </object> 
                       </void> 
@@ -717,18 +660,18 @@
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object idref="FilterOperator0"/> 
+                       <object idref="FilterOperator1"/> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="schema"> 
                      <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
                       <void property="signature"> 
-                       <object id="Vector0" class="java.util.Vector"> 
+                       <object class="java.util.Vector"> 
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                           <void property="internalName"> 
-                           <string>key</string> 
+                           <string>_col0</string> 
                           </void> 
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo1"/> 
@@ -738,7 +681,7 @@
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                           <void property="internalName"> 
-                           <string>value</string> 
+                           <string>_col1</string> 
                           </void> 
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo1"/> 
@@ -761,7 +704,17 @@
                      <class>org.apache.hadoop.hive.ql.udf.UDFOPLessThan</class> 
                     </void> 
                     <void property="UDFMethod"> 
-                     <object idref="Method0"/> 
+                     <object id="Method0" class="org.apache.hadoop.hive.ql.udf.UDFOPLessThan" method="getMethod"> 
+                      <string>evaluate</string> 
+                      <array class="java.lang.Class" length="2"> 
+                       <void index="0"> 
+                        <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
+                       </void> 
+                       <void index="1"> 
+                        <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
+                       </void> 
+                      </array> 
+                     </object> 
                     </void> 
                     <void property="childExprs"> 
                      <object class="java.util.ArrayList"> 
@@ -771,7 +724,14 @@
                          <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
                         </void> 
                         <void property="UDFMethod"> 
-                         <object idref="Method1"/> 
+                         <object id="Method1" class="org.apache.hadoop.hive.ql.udf.UDFToDouble" method="getMethod"> 
+                          <string>evaluate</string> 
+                          <array class="java.lang.Class" length="1"> 
+                           <void index="0"> 
+                            <class>org.apache.hadoop.io.Text</class> 
+                           </void> 
+                          </array> 
+                         </object> 
                         </void> 
                         <void property="childExprs"> 
                          <object class="java.util.ArrayList"> 
@@ -798,14 +758,25 @@
                          <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
                         </void> 
                         <void property="UDFMethod"> 
-                         <object idref="Method2"/> 
+                         <object id="Method2" class="org.apache.hadoop.hive.ql.udf.UDFToDouble" method="getMethod"> 
+                          <string>evaluate</string> 
+                          <array class="java.lang.Class" length="1"> 
+                           <void index="0"> 
+                            <class>org.apache.hadoop.io.IntWritable</class> 
+                           </void> 
+                          </array> 
+                         </object> 
                         </void> 
                         <void property="childExprs"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo2"/> 
+                             <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                              <void property="typeName"> 
+                               <string>int</string> 
+                              </void> 
+                             </object> 
                             </void> 
                             <void property="value"> 
                              <int>100</int> 
@@ -822,7 +793,11 @@
                      </object> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo3"/> 
+                     <object id="PrimitiveTypeInfo3" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                      <void property="typeName"> 
+                       <string>boolean</string> 
+                      </void> 
+                     </object> 
                     </void> 
                    </object> 
                   </void> 
@@ -831,14 +806,35 @@
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object idref="TableScanOperator1"/> 
+                   <object idref="FilterOperator0"/> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="schema"> 
                  <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
                   <void property="signature"> 
-                   <object idref="Vector0"/> 
+                   <object id="Vector0" class="java.util.Vector"> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="internalName"> 
+                       <string>key</string> 
+                      </void> 
+                      <void property="type"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="internalName"> 
+                       <string>value</string> 
+                      </void> 
+                      <void property="type"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                   </object> 
                   </void> 
                  </object> 
                 </void> 
@@ -846,226 +842,113 @@
               </void> 
              </object> 
             </void> 
-            <void property="neededColumnIDs"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <int>0</int> 
-              </void> 
-              <void method="add"> 
-               <int>1</int> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object idref="Vector0"/> 
-              </void> 
-             </object> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="mapCurrCtx"> 
-           <object class="java.util.LinkedHashMap"> 
-            <void method="put"> 
-             <object idref="TableScanOperator1"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-            <void method="put"> 
-             <object idref="FilterOperator0"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-            <void method="put"> 
-             <object idref="FilterOperator1"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-            <void method="put"> 
-             <object idref="SelectOperator0"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="mvTask"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="MoveTask0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="opTaskMap"> 
-           <object class="java.util.HashMap"> 
-            <void method="put"> 
-             <null/> 
-             <object idref="MapRedTask0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="parseCtx"> 
-           <object class="org.apache.hadoop.hive.ql.parse.ParseContext"> 
-            <void property="QB"> 
-             <object class="org.apache.hadoop.hive.ql.parse.QB"/> 
-            </void> 
-            <void property="UCtx"> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.unionproc.UnionProcContext"/> 
-            </void> 
-            <void property="aliasToPruner"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>src</string> 
-               <object class="org.apache.hadoop.hive.ql.parse.PartitionPruner"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="aliasToSamplePruner"> 
-             <object class="java.util.HashMap"/> 
-            </void> 
             <void property="conf"> 
-             <object idref="HiveConf0"/> 
-            </void> 
-            <void property="context"> 
-             <object class="org.apache.hadoop.hive.ql.Context"/> 
-            </void> 
-            <void property="destTableId"> 
-             <int>2</int> 
-            </void> 
-            <void property="idToTableNameMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>1</string> 
-               <string>dest1</string> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="joinContext"> 
-             <object class="java.util.HashMap"/> 
-            </void> 
-            <void property="listMapJoinOpsNoReducer"> 
-             <object class="java.util.ArrayList"/> 
-            </void> 
-            <void property="loadFileWork"> 
-             <object class="java.util.ArrayList"/> 
-            </void> 
-            <void property="loadTableWork"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="loadTableDesc0"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="opParseCtx"> 
-             <object class="java.util.LinkedHashMap"> 
-              <void method="put"> 
-               <object idref="TableScanOperator1"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object id="RowResolver0" class="org.apache.hadoop.hive.ql.parse.RowResolver"/> 
+             <object class="org.apache.hadoop.hive.ql.plan.filterDesc"> 
+              <void property="predicate"> 
+               <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                <void property="UDFClass"> 
+                 <class>org.apache.hadoop.hive.ql.udf.UDFOPLessThan</class> 
                 </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="FilterOperator1"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object idref="RowResolver0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="SelectOperator0"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object id="RowResolver1" class="org.apache.hadoop.hive.ql.parse.RowResolver"/> 
+                <void property="UDFMethod"> 
+                 <object idref="Method0"/> 
                 </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="FileSinkOperator0"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object idref="RowResolver1"/> 
+                <void property="childExprs"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                    <void property="UDFClass"> 
+                     <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
+                    </void> 
+                    <void property="UDFMethod"> 
+                     <object idref="Method1"/> 
+                    </void> 
+                    <void property="childExprs"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                        <void property="column"> 
+                         <string>key</string> 
+                        </void> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                    <void property="UDFClass"> 
+                     <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
+                    </void> 
+                    <void property="UDFMethod"> 
+                     <object idref="Method2"/> 
+                    </void> 
+                    <void property="childExprs"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo2"/> 
+                        </void> 
+                        <void property="value"> 
+                         <int>100</int> 
+                        </void> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
                 </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="FilterOperator0"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object idref="RowResolver0"/> 
+                <void property="typeInfo"> 
+                 <object idref="PrimitiveTypeInfo3"/> 
                 </void> 
                </object> 
               </void> 
              </object> 
             </void> 
-            <void property="parseTree"> 
-             <object class="org.apache.hadoop.hive.ql.parse.ASTNode"> 
-              <void property="tokenStartIndex"> 
-               <int>0</int> 
-              </void> 
-              <void property="tokenStopIndex"> 
-               <int>31</int> 
+            <void property="parentOperators"> 
+             <object class="java.util.ArrayList"> 
+              <void method="add"> 
+               <object idref="TableScanOperator1"/> 
               </void> 
              </object> 
             </void> 
-            <void property="topOps"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>src</string> 
-               <object idref="TableScanOperator1"/> 
+            <void property="schema"> 
+             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+              <void property="signature"> 
+               <object idref="Vector0"/> 
               </void> 
              </object> 
             </void> 
-            <void property="topSelOps"> 
-             <object class="java.util.HashMap"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="rootOps"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="TableScanOperator1"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="rootTasks"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="MapRedTask0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="seenFileSinkOps"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="FileSinkOperator0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="seenOps"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="TableScanOperator1"/> 
-            </void> 
            </object> 
           </void> 
          </object> 
         </void> 
-        <void property="dir"> 
-         <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/272093383/10002</string> 
-        </void> 
-        <void property="listTasks"> 
-         <object idref="ArrayList0"/> 
-        </void> 
-       </object> 
-      </void> 
-      <void property="work"> 
-       <object class="org.apache.hadoop.hive.ql.plan.ConditionalWork"> 
-        <void property="listWorks"> 
+        <void property="neededColumnIDs"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <object idref="moveWork0"/> 
+           <int>0</int> 
           </void> 
           <void method="add"> 
-           <object idref="mapredWork0"/> 
+           <int>1</int> 
+          </void> 
+         </object> 
+        </void> 
+        <void property="schema"> 
+         <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+          <void property="signature"> 
+           <object idref="Vector0"/> 
           </void> 
          </object> 
         </void> 
@@ -1073,95 +956,10 @@
       </void> 
      </object> 
     </void> 
-   </object> 
-  </void> 
-  <void property="id"> 
-   <string>Stage-2</string> 
-  </void> 
-  <void property="work"> 
-   <object class="org.apache.hadoop.hive.ql.plan.mapredWork"> 
-    <void property="aliasToPartnInfo"> 
-     <void method="put"> 
-      <string>src</string> 
-      <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
-       <void property="partSpec"> 
-        <object id="LinkedHashMap0" class="java.util.LinkedHashMap"/> 
-       </void> 
-       <void property="tableDesc"> 
-        <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
-         <void property="deserializerClass"> 
-          <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
-         </void> 
-         <void property="inputFileFormatClass"> 
-          <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-         </void> 
-         <void property="outputFileFormatClass"> 
-          <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-         </void> 
-         <void property="properties"> 
-          <object id="Properties0" class="java.util.Properties"> 
-           <void method="put"> 
-            <string>name</string> 
-            <string>src</string> 
-           </void> 
-           <void method="put"> 
-            <string>columns.types</string> 
-            <string>string:string</string> 
-           </void> 
-           <void method="put"> 
-            <string>serialization.ddl</string> 
-            <string>struct src { string key, string value}</string> 
-           </void> 
-           <void method="put"> 
-            <string>serialization.format</string> 
-            <string>1</string> 
-           </void> 
-           <void method="put"> 
-            <string>columns</string> 
-            <string>key,value</string> 
-           </void> 
-           <void method="put"> 
-            <string>bucket_count</string> 
-            <string>-1</string> 
-           </void> 
-           <void method="put"> 
-            <string>serialization.lib</string> 
-            <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-           </void> 
-           <void method="put"> 
-            <string>file.inputformat</string> 
-            <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-           </void> 
-           <void method="put"> 
-            <string>file.outputformat</string> 
-            <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-           </void> 
-           <void method="put"> 
-            <string>location</string> 
-            <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/src</string> 
-           </void> 
-          </object> 
-         </void> 
-         <void property="serdeClassName"> 
-          <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-         </void> 
-        </object> 
-       </void> 
-      </object> 
-     </void> 
-    </void> 
-    <void property="aliasToWork"> 
-     <object class="java.util.LinkedHashMap"> 
-      <void method="put"> 
-       <string>src</string> 
-       <object idref="TableScanOperator1"/> 
-      </void> 
-     </object> 
-    </void> 
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/src</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>src</string> 
@@ -1173,7 +971,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/src</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/input2.q.xml b/ql/src/test/results/compiler/plan/input2.q.xml
index 67dbc33f71..f772b686c4 100755
--- a/ql/src/test/results/compiler/plan/input2.q.xml
+++ b/ql/src/test/results/compiler/plan/input2.q.xml
@@ -8,7 +8,7 @@
       <void property="childTasks"> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
-         <object id="MoveTask0" class="org.apache.hadoop.hive.ql.exec.MoveTask"> 
+         <object class="org.apache.hadoop.hive.ql.exec.MoveTask"> 
           <void property="id"> 
            <string>Stage-1</string> 
           </void> 
@@ -22,7 +22,7 @@
           <void property="work"> 
            <object class="org.apache.hadoop.hive.ql.plan.moveWork"> 
             <void property="loadTableWork"> 
-             <object id="loadTableDesc0" class="org.apache.hadoop.hive.ql.plan.loadTableDesc"> 
+             <object class="org.apache.hadoop.hive.ql.plan.loadTableDesc"> 
               <void property="partitionSpec"> 
                <object class="java.util.HashMap"/> 
               </void> 
@@ -30,7 +30,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/2129120497/10000</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/253227834/10000</string> 
               </void> 
               <void property="table"> 
                <object id="tableDesc0" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -83,7 +83,7 @@
                   </void> 
                   <void method="put"> 
                    <string>location</string> 
-                   <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/dest1</string> 
+                   <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/dest1</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -93,7 +93,7 @@
                </object> 
               </void> 
               <void property="tmpDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/2129120497/10001</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/253227834/10001</string> 
               </void> 
              </object> 
             </void> 
@@ -121,10 +121,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/584470898/10006</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/53957225/10006</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/2129120497/10000</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/253227834/10000</string> 
               </void> 
              </object> 
             </void> 
@@ -142,7 +142,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/584470898/10006</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/53957225/10006</string> 
                <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -338,10 +338,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/584470898/10006</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/53957225/10006</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/584470898/10006</string> 
+                 <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/53957225/10006</string> 
                 </void> 
                </object> 
               </void> 
@@ -350,7 +350,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/584470898/10006</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/53957225/10006</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object idref="tableDesc0"/> 
@@ -368,7 +368,7 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/2129120497/10000</string> 
+                     <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/253227834/10000</string> 
                     </void> 
                     <void property="tableInfo"> 
                      <object idref="tableDesc0"/> 
@@ -458,410 +458,295 @@
       </void> 
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
-        <void property="ctx"> 
-         <object id="GenMRProcContext0" class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext"> 
-          <void property="conf"> 
-           <object id="HiveConf0" class="org.apache.hadoop.hive.conf.HiveConf"> 
-            <void property="auxJars"> 
-             <string>file:///data/users/njain/hive3/hive3/build/ql/test/test-udfs.jar</string> 
+        <void property="dir"> 
+         <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/53957225/10006</string> 
+        </void> 
+        <void property="listTasks"> 
+         <object idref="ArrayList0"/> 
+        </void> 
+       </object> 
+      </void> 
+      <void property="work"> 
+       <object class="org.apache.hadoop.hive.ql.plan.ConditionalWork"> 
+        <void property="listWorks"> 
+         <object class="java.util.ArrayList"> 
+          <void method="add"> 
+           <object idref="moveWork0"/> 
+          </void> 
+          <void method="add"> 
+           <object idref="mapredWork0"/> 
+          </void> 
+         </object> 
+        </void> 
+       </object> 
+      </void> 
+     </object> 
+    </void> 
+    <void method="add"> 
+     <object id="ConditionalTask1" class="org.apache.hadoop.hive.ql.exec.ConditionalTask"> 
+      <void property="childTasks"> 
+       <object class="java.util.ArrayList"> 
+        <void method="add"> 
+         <object class="org.apache.hadoop.hive.ql.exec.MoveTask"> 
+          <void property="id"> 
+           <string>Stage-2</string> 
+          </void> 
+          <void property="parentTasks"> 
+           <object class="java.util.ArrayList"> 
+            <void method="add"> 
+             <object idref="ConditionalTask1"/> 
             </void> 
            </object> 
           </void> 
-          <void property="currAliasId"> 
-           <string>src</string> 
+          <void property="work"> 
+           <object class="org.apache.hadoop.hive.ql.plan.moveWork"> 
+            <void property="loadTableWork"> 
+             <object class="org.apache.hadoop.hive.ql.plan.loadTableDesc"> 
+              <void property="partitionSpec"> 
+               <object class="java.util.HashMap"/> 
+              </void> 
+              <void property="replace"> 
+               <boolean>true</boolean> 
+              </void> 
+              <void property="sourceDir"> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/253227834/10002</string> 
+              </void> 
+              <void property="table"> 
+               <object id="tableDesc3" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
+                <void property="deserializerClass"> 
+                 <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
+                </void> 
+                <void property="inputFileFormatClass"> 
+                 <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                </void> 
+                <void property="outputFileFormatClass"> 
+                 <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                </void> 
+                <void property="properties"> 
+                 <object class="java.util.Properties"> 
+                  <void method="put"> 
+                   <string>name</string> 
+                   <string>dest2</string> 
+                  </void> 
+                  <void method="put"> 
+                   <string>columns.types</string> 
+                   <string>string:string</string> 
+                  </void> 
+                  <void method="put"> 
+                   <string>serialization.ddl</string> 
+                   <string>struct dest2 { string key, string value}</string> 
+                  </void> 
+                  <void method="put"> 
+                   <string>serialization.format</string> 
+                   <string>1</string> 
+                  </void> 
+                  <void method="put"> 
+                   <string>columns</string> 
+                   <string>key,value</string> 
+                  </void> 
+                  <void method="put"> 
+                   <string>bucket_count</string> 
+                   <string>-1</string> 
+                  </void> 
+                  <void method="put"> 
+                   <string>serialization.lib</string> 
+                   <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                  </void> 
+                  <void method="put"> 
+                   <string>file.inputformat</string> 
+                   <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+                  </void> 
+                  <void method="put"> 
+                   <string>file.outputformat</string> 
+                   <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+                  </void> 
+                  <void method="put"> 
+                   <string>location</string> 
+                   <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/dest2</string> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="serdeClassName"> 
+                 <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                </void> 
+               </object> 
+              </void> 
+              <void property="tmpDir"> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/253227834/10003</string> 
+              </void> 
+             </object> 
+            </void> 
+           </object> 
           </void> 
-          <void property="currTask"> 
-           <object idref="MapRedTask0"/> 
+         </object> 
+        </void> 
+       </object> 
+      </void> 
+      <void property="id"> 
+       <string>Stage-10</string> 
+      </void> 
+      <void property="listTasks"> 
+       <object id="ArrayList1" class="java.util.ArrayList"> 
+        <void method="add"> 
+         <object class="org.apache.hadoop.hive.ql.exec.MoveTask"> 
+          <void property="id"> 
+           <string>Stage-9</string> 
           </void> 
-          <void property="currTopOp"> 
-           <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+          <void property="work"> 
+           <object id="moveWork1" class="org.apache.hadoop.hive.ql.plan.moveWork"> 
+            <void property="loadFileWork"> 
+             <object class="org.apache.hadoop.hive.ql.plan.loadFileDesc"> 
+              <void property="isDfsDir"> 
+               <boolean>true</boolean> 
+              </void> 
+              <void property="sourceDir"> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/53957225/10007</string> 
+              </void> 
+              <void property="targetDir"> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/253227834/10002</string> 
+              </void> 
+             </object> 
+            </void> 
+           </object> 
+          </void> 
+         </object> 
+        </void> 
+        <void method="add"> 
+         <object class="org.apache.hadoop.hive.ql.exec.MapRedTask"> 
+          <void property="id"> 
+           <string>Stage-8</string> 
+          </void> 
+          <void property="work"> 
+           <object id="mapredWork1" class="org.apache.hadoop.hive.ql.plan.mapredWork"> 
+            <void property="aliasToWork"> 
+             <object class="java.util.LinkedHashMap"> 
+              <void method="put"> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/53957225/10007</string> 
+               <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                    <void property="childOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object id="FileSinkOperator0" class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                        <void property="conf"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
-                          <void property="destTableId"> 
-                           <int>1</int> 
-                          </void> 
-                          <void property="dirName"> 
-                           <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/584470898/10006</string> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
+                    <void property="conf"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.reduceSinkDesc"> 
+                      <void property="keyCols"> 
+                       <object class="java.util.ArrayList"/> 
+                      </void> 
+                      <void property="keySerializeInfo"> 
+                       <object id="tableDesc4" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
+                        <void property="deserializerClass"> 
+                         <class>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</class> 
+                        </void> 
+                        <void property="inputFileFormatClass"> 
+                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                        </void> 
+                        <void property="outputFileFormatClass"> 
+                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                        </void> 
+                        <void property="properties"> 
+                         <object class="java.util.Properties"> 
+                          <void method="put"> 
+                           <string>columns</string> 
+                           <string></string> 
                           </void> 
-                          <void property="tableInfo"> 
-                           <object idref="tableDesc0"/> 
+                          <void method="put"> 
+                           <string>serialization.sort.order</string> 
+                           <string></string> 
                           </void> 
-                         </object> 
-                        </void> 
-                        <void property="parentOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object idref="SelectOperator0"/> 
+                          <void method="put"> 
+                           <string>columns.types</string> 
+                           <string></string> 
                           </void> 
                          </object> 
                         </void> 
-                        <void property="schema"> 
-                         <object idref="RowSchema0"/> 
-                        </void> 
                        </object> 
                       </void> 
-                     </object> 
-                    </void> 
-                    <void property="columnExprMap"> 
-                     <object class="java.util.HashMap"> 
-                      <void method="put"> 
-                       <string>_col1</string> 
-                       <object id="exprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>value</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                       </object> 
+                      <void property="numReducers"> 
+                       <int>-1</int> 
                       </void> 
-                      <void method="put"> 
-                       <string>_col0</string> 
-                       <object id="exprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                       </object> 
+                      <void property="outputKeyColumnNames"> 
+                       <object class="java.util.ArrayList"/> 
                       </void> 
-                     </object> 
-                    </void> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.selectDesc"> 
-                      <void property="colList"> 
+                      <void property="outputValueColumnNames"> 
                        <object class="java.util.ArrayList"> 
                         <void method="add"> 
-                         <object idref="exprNodeColumnDesc1"/> 
+                         <string>_col0</string> 
                         </void> 
                         <void method="add"> 
-                         <object idref="exprNodeColumnDesc0"/> 
+                         <string>_col1</string> 
                         </void> 
                        </object> 
                       </void> 
-                      <void property="outputColumnNames"> 
+                      <void property="partitionCols"> 
                        <object class="java.util.ArrayList"> 
                         <void method="add"> 
-                         <string>_col0</string> 
-                        </void> 
-                        <void method="add"> 
-                         <string>_col1</string> 
+                         <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                          <void property="UDFClass"> 
+                           <class>org.apache.hadoop.hive.ql.udf.UDFRand</class> 
+                          </void> 
+                          <void property="UDFMethod"> 
+                           <object class="org.apache.hadoop.hive.ql.udf.UDFRand" method="getMethod"> 
+                            <string>evaluate</string> 
+                            <array class="java.lang.Class" length="0"/> 
+                           </object> 
+                          </void> 
+                          <void property="childExprs"> 
+                           <object class="java.util.ArrayList"/> 
+                          </void> 
+                          <void property="typeInfo"> 
+                           <object idref="PrimitiveTypeInfo0"/> 
+                          </void> 
+                         </object> 
                         </void> 
                        </object> 
                       </void> 
-                      <void property="selectStar"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="FilterOperator0"/> 
+                      <void property="tag"> 
+                       <int>-1</int> 
                       </void> 
-                     </object> 
-                    </void> 
-                    <void property="schema"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                      <void property="signature"> 
-                       <object class="java.util.Vector"> 
+                      <void property="valueCols"> 
+                       <object class="java.util.ArrayList"> 
                         <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col0</string> 
+                         <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                          <void property="column"> 
+                           <string>key</string> 
                           </void> 
-                          <void property="type"> 
+                          <void property="typeInfo"> 
                            <object idref="PrimitiveTypeInfo1"/> 
                           </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col1</string> 
+                         <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                          <void property="column"> 
+                           <string>value</string> 
                           </void> 
-                          <void property="type"> 
+                          <void property="typeInfo"> 
                            <object idref="PrimitiveTypeInfo1"/> 
                           </void> 
                          </object> 
                         </void> 
                        </object> 
                       </void> 
-                     </object> 
-                    </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.filterDesc"> 
-                  <void property="predicate"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                    <void property="UDFClass"> 
-                     <class>org.apache.hadoop.hive.ql.udf.UDFOPLessThan</class> 
-                    </void> 
-                    <void property="UDFMethod"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.UDFOPLessThan" method="getMethod"> 
-                      <string>evaluate</string> 
-                      <array class="java.lang.Class" length="2"> 
-                       <void index="0"> 
-                        <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
-                       </void> 
-                       <void index="1"> 
-                        <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
-                       </void> 
-                      </array> 
-                     </object> 
-                    </void> 
-                    <void property="childExprs"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                        <void property="UDFClass"> 
-                         <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
-                        </void> 
-                        <void property="UDFMethod"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.UDFToDouble" method="getMethod"> 
-                          <string>evaluate</string> 
-                          <array class="java.lang.Class" length="1"> 
-                           <void index="0"> 
-                            <class>org.apache.hadoop.io.Text</class> 
-                           </void> 
-                          </array> 
-                         </object> 
-                        </void> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>key</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                        <void property="UDFClass"> 
-                         <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
-                        </void> 
-                        <void property="UDFMethod"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.UDFToDouble" method="getMethod"> 
-                          <string>evaluate</string> 
-                          <array class="java.lang.Class" length="1"> 
-                           <void index="0"> 
-                            <class>org.apache.hadoop.io.IntWritable</class> 
-                           </void> 
-                          </array> 
-                         </object> 
-                        </void> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                              <void property="typeName"> 
-                               <string>int</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="value"> 
-                             <int>100</int> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
+                      <void property="valueSerializeInfo"> 
+                       <object id="tableDesc5" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
+                        <void property="deserializerClass"> 
+                         <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
                         </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
+                        <void property="inputFileFormatClass"> 
+                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
                         </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object id="PrimitiveTypeInfo3" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                      <void property="typeName"> 
-                       <string>boolean</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="parentOperators"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object idref="TableScanOperator1"/> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object id="Vector0" class="java.util.Vector"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>key</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo1"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>value</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo1"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="add"> 
-               <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
-                <void property="childOperators"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                    <void property="childOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object id="FileSinkOperator1" class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                        <void property="conf"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
-                          <void property="destTableId"> 
-                           <int>2</int> 
-                          </void> 
-                          <void property="dirName"> 
-                           <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/584470898/10007</string> 
-                          </void> 
-                          <void property="tableInfo"> 
-                           <object id="tableDesc3" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
-                            <void property="deserializerClass"> 
-                             <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
-                            </void> 
-                            <void property="inputFileFormatClass"> 
-                             <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-                            </void> 
-                            <void property="outputFileFormatClass"> 
-                             <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-                            </void> 
-                            <void property="properties"> 
-                             <object class="java.util.Properties"> 
-                              <void method="put"> 
-                               <string>name</string> 
-                               <string>dest2</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>columns.types</string> 
-                               <string>string:string</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>serialization.ddl</string> 
-                               <string>struct dest2 { string key, string value}</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>serialization.format</string> 
-                               <string>1</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>columns</string> 
-                               <string>key,value</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>bucket_count</string> 
-                               <string>-1</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>serialization.lib</string> 
-                               <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>file.inputformat</string> 
-                               <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>file.outputformat</string> 
-                               <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>location</string> 
-                               <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/dest2</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="serdeClassName"> 
-                             <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
+                        <void property="outputFileFormatClass"> 
+                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
                         </void> 
-                        <void property="parentOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object idref="SelectOperator1"/> 
+                        <void property="properties"> 
+                         <object class="java.util.Properties"> 
+                          <void method="put"> 
+                           <string>columns</string> 
+                           <string>_col0,_col1</string> 
                           </void> 
-                         </object> 
-                        </void> 
-                        <void property="schema"> 
-                         <object id="RowSchema1" class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                          <void property="signature"> 
-                           <object class="java.util.Vector"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>key</string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo1"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>value</string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo1"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
+                          <void method="put"> 
+                           <string>columns.types</string> 
+                           <string>string,string</string> 
                           </void> 
                          </object> 
                         </void> 
@@ -869,71 +754,21 @@
                       </void> 
                      </object> 
                     </void> 
-                    <void property="columnExprMap"> 
-                     <object class="java.util.HashMap"> 
-                      <void method="put"> 
-                       <string>_col1</string> 
-                       <object id="exprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>value</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="put"> 
-                       <string>_col0</string> 
-                       <object id="exprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.selectDesc"> 
-                      <void property="colList"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object idref="exprNodeColumnDesc3"/> 
-                        </void> 
-                        <void method="add"> 
-                         <object idref="exprNodeColumnDesc2"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="outputColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>_col0</string> 
-                        </void> 
-                        <void method="add"> 
-                         <string>_col1</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object idref="FilterOperator1"/> 
+                       <object idref="TableScanOperator1"/> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="schema"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                     <object id="RowSchema1" class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
                       <void property="signature"> 
                        <object class="java.util.Vector"> 
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                           <void property="internalName"> 
-                           <string>_col0</string> 
+                           <string>key</string> 
                           </void> 
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo1"/> 
@@ -943,7 +778,7 @@
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                           <void property="internalName"> 
-                           <string>_col1</string> 
+                           <string>value</string> 
                           </void> 
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo1"/> 
@@ -958,22 +793,1169 @@
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.filterDesc"> 
-                  <void property="predicate"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                    <void property="UDFClass"> 
-                     <class>org.apache.hadoop.hive.ql.udf.UDFOPAnd</class> 
+                <void property="schema"> 
+                 <object idref="RowSchema1"/> 
+                </void> 
+               </object> 
+              </void> 
+             </object> 
+            </void> 
+            <void property="keyDesc"> 
+             <object idref="tableDesc4"/> 
+            </void> 
+            <void property="numReduceTasks"> 
+             <int>-1</int> 
+            </void> 
+            <void property="pathToAliases"> 
+             <object class="java.util.LinkedHashMap"> 
+              <void method="put"> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/53957225/10007</string> 
+               <object class="java.util.ArrayList"> 
+                <void method="add"> 
+                 <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/53957225/10007</string> 
+                </void> 
+               </object> 
+              </void> 
+             </object> 
+            </void> 
+            <void property="pathToPartitionInfo"> 
+             <object class="java.util.LinkedHashMap"> 
+              <void method="put"> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/53957225/10007</string> 
+               <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
+                <void property="tableDesc"> 
+                 <object idref="tableDesc3"/> 
+                </void> 
+               </object> 
+              </void> 
+             </object> 
+            </void> 
+            <void property="reducer"> 
+             <object id="ExtractOperator1" class="org.apache.hadoop.hive.ql.exec.ExtractOperator"> 
+              <void property="childOperators"> 
+               <object class="java.util.ArrayList"> 
+                <void method="add"> 
+                 <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                  <void property="conf"> 
+                   <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
+                    <void property="dirName"> 
+                     <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/253227834/10002</string> 
                     </void> 
-                    <void property="UDFMethod"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.UDFOPAnd" method="getMethod"> 
-                      <string>evaluate</string> 
+                    <void property="tableInfo"> 
+                     <object idref="tableDesc3"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void property="parentOperators"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object idref="ExtractOperator1"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void property="schema"> 
+                   <object idref="RowSchema1"/> 
+                  </void> 
+                 </object> 
+                </void> 
+               </object> 
+              </void> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.extractDesc"> 
+                <void property="col"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>VALUE</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo1"/> 
+                  </void> 
+                 </object> 
+                </void> 
+               </object> 
+              </void> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
+                 <object class="java.util.Vector"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>0</string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo1"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>1</string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo1"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+               </object> 
+              </void> 
+             </object> 
+            </void> 
+            <void property="tagToValueDesc"> 
+             <object class="java.util.ArrayList"> 
+              <void method="add"> 
+               <object idref="tableDesc5"/> 
+              </void> 
+             </object> 
+            </void> 
+           </object> 
+          </void> 
+         </object> 
+        </void> 
+       </object> 
+      </void> 
+      <void property="parentTasks"> 
+       <object class="java.util.ArrayList"> 
+        <void method="add"> 
+         <object idref="MapRedTask0"/> 
+        </void> 
+       </object> 
+      </void> 
+      <void property="resolver"> 
+       <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles"/> 
+      </void> 
+      <void property="resolverCtx"> 
+       <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
+        <void property="dir"> 
+         <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/53957225/10007</string> 
+        </void> 
+        <void property="listTasks"> 
+         <object idref="ArrayList1"/> 
+        </void> 
+       </object> 
+      </void> 
+      <void property="work"> 
+       <object class="org.apache.hadoop.hive.ql.plan.ConditionalWork"> 
+        <void property="listWorks"> 
+         <object class="java.util.ArrayList"> 
+          <void method="add"> 
+           <object idref="moveWork1"/> 
+          </void> 
+          <void method="add"> 
+           <object idref="mapredWork1"/> 
+          </void> 
+         </object> 
+        </void> 
+       </object> 
+      </void> 
+     </object> 
+    </void> 
+    <void method="add"> 
+     <object id="ConditionalTask2" class="org.apache.hadoop.hive.ql.exec.ConditionalTask"> 
+      <void property="childTasks"> 
+       <object class="java.util.ArrayList"> 
+        <void method="add"> 
+         <object class="org.apache.hadoop.hive.ql.exec.MoveTask"> 
+          <void property="id"> 
+           <string>Stage-3</string> 
+          </void> 
+          <void property="parentTasks"> 
+           <object class="java.util.ArrayList"> 
+            <void method="add"> 
+             <object idref="ConditionalTask2"/> 
+            </void> 
+           </object> 
+          </void> 
+          <void property="work"> 
+           <object class="org.apache.hadoop.hive.ql.plan.moveWork"> 
+            <void property="loadTableWork"> 
+             <object class="org.apache.hadoop.hive.ql.plan.loadTableDesc"> 
+              <void property="partitionSpec"> 
+               <object class="java.util.LinkedHashMap"> 
+                <void method="put"> 
+                 <string>ds</string> 
+                 <string>2008-04-08</string> 
+                </void> 
+                <void method="put"> 
+                 <string>hr</string> 
+                 <string>12</string> 
+                </void> 
+               </object> 
+              </void> 
+              <void property="replace"> 
+               <boolean>true</boolean> 
+              </void> 
+              <void property="sourceDir"> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/253227834/10004</string> 
+              </void> 
+              <void property="table"> 
+               <object id="tableDesc6" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
+                <void property="deserializerClass"> 
+                 <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
+                </void> 
+                <void property="inputFileFormatClass"> 
+                 <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                </void> 
+                <void property="outputFileFormatClass"> 
+                 <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                </void> 
+                <void property="properties"> 
+                 <object class="java.util.Properties"> 
+                  <void method="put"> 
+                   <string>name</string> 
+                   <string>dest3</string> 
+                  </void> 
+                  <void method="put"> 
+                   <string>columns.types</string> 
+                   <string>string:string</string> 
+                  </void> 
+                  <void method="put"> 
+                   <string>serialization.ddl</string> 
+                   <string>struct dest3 { string key, string value}</string> 
+                  </void> 
+                  <void method="put"> 
+                   <string>serialization.format</string> 
+                   <string>1</string> 
+                  </void> 
+                  <void method="put"> 
+                   <string>columns</string> 
+                   <string>key,value</string> 
+                  </void> 
+                  <void method="put"> 
+                   <string>partition_columns</string> 
+                   <string>ds/hr</string> 
+                  </void> 
+                  <void method="put"> 
+                   <string>bucket_count</string> 
+                   <string>-1</string> 
+                  </void> 
+                  <void method="put"> 
+                   <string>serialization.lib</string> 
+                   <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                  </void> 
+                  <void method="put"> 
+                   <string>file.inputformat</string> 
+                   <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+                  </void> 
+                  <void method="put"> 
+                   <string>file.outputformat</string> 
+                   <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+                  </void> 
+                  <void method="put"> 
+                   <string>location</string> 
+                   <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/dest3</string> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="serdeClassName"> 
+                 <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                </void> 
+               </object> 
+              </void> 
+              <void property="tmpDir"> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/253227834/10005</string> 
+              </void> 
+             </object> 
+            </void> 
+           </object> 
+          </void> 
+         </object> 
+        </void> 
+       </object> 
+      </void> 
+      <void property="id"> 
+       <string>Stage-13</string> 
+      </void> 
+      <void property="listTasks"> 
+       <object id="ArrayList2" class="java.util.ArrayList"> 
+        <void method="add"> 
+         <object class="org.apache.hadoop.hive.ql.exec.MoveTask"> 
+          <void property="id"> 
+           <string>Stage-12</string> 
+          </void> 
+          <void property="work"> 
+           <object id="moveWork2" class="org.apache.hadoop.hive.ql.plan.moveWork"> 
+            <void property="loadFileWork"> 
+             <object class="org.apache.hadoop.hive.ql.plan.loadFileDesc"> 
+              <void property="isDfsDir"> 
+               <boolean>true</boolean> 
+              </void> 
+              <void property="sourceDir"> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/53957225/10008</string> 
+              </void> 
+              <void property="targetDir"> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/253227834/10004</string> 
+              </void> 
+             </object> 
+            </void> 
+           </object> 
+          </void> 
+         </object> 
+        </void> 
+        <void method="add"> 
+         <object class="org.apache.hadoop.hive.ql.exec.MapRedTask"> 
+          <void property="id"> 
+           <string>Stage-11</string> 
+          </void> 
+          <void property="work"> 
+           <object id="mapredWork2" class="org.apache.hadoop.hive.ql.plan.mapredWork"> 
+            <void property="aliasToWork"> 
+             <object class="java.util.LinkedHashMap"> 
+              <void method="put"> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/53957225/10008</string> 
+               <object id="TableScanOperator2" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
+                <void property="childOperators"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
+                    <void property="conf"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.reduceSinkDesc"> 
+                      <void property="keyCols"> 
+                       <object class="java.util.ArrayList"/> 
+                      </void> 
+                      <void property="keySerializeInfo"> 
+                       <object id="tableDesc7" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
+                        <void property="deserializerClass"> 
+                         <class>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</class> 
+                        </void> 
+                        <void property="inputFileFormatClass"> 
+                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                        </void> 
+                        <void property="outputFileFormatClass"> 
+                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                        </void> 
+                        <void property="properties"> 
+                         <object class="java.util.Properties"> 
+                          <void method="put"> 
+                           <string>columns</string> 
+                           <string></string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>serialization.sort.order</string> 
+                           <string></string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>columns.types</string> 
+                           <string></string> 
+                          </void> 
+                         </object> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="numReducers"> 
+                       <int>-1</int> 
+                      </void> 
+                      <void property="outputKeyColumnNames"> 
+                       <object class="java.util.ArrayList"/> 
+                      </void> 
+                      <void property="outputValueColumnNames"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <string>_col0</string> 
+                        </void> 
+                        <void method="add"> 
+                         <string>_col1</string> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="partitionCols"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                          <void property="UDFClass"> 
+                           <class>org.apache.hadoop.hive.ql.udf.UDFRand</class> 
+                          </void> 
+                          <void property="UDFMethod"> 
+                           <object class="org.apache.hadoop.hive.ql.udf.UDFRand" method="getMethod"> 
+                            <string>evaluate</string> 
+                            <array class="java.lang.Class" length="0"/> 
+                           </object> 
+                          </void> 
+                          <void property="childExprs"> 
+                           <object class="java.util.ArrayList"/> 
+                          </void> 
+                          <void property="typeInfo"> 
+                           <object idref="PrimitiveTypeInfo0"/> 
+                          </void> 
+                         </object> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="tag"> 
+                       <int>-1</int> 
+                      </void> 
+                      <void property="valueCols"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                          <void property="column"> 
+                           <string>key</string> 
+                          </void> 
+                          <void property="typeInfo"> 
+                           <object idref="PrimitiveTypeInfo1"/> 
+                          </void> 
+                         </object> 
+                        </void> 
+                        <void method="add"> 
+                         <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                          <void property="column"> 
+                           <string>value</string> 
+                          </void> 
+                          <void property="typeInfo"> 
+                           <object idref="PrimitiveTypeInfo1"/> 
+                          </void> 
+                         </object> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="valueSerializeInfo"> 
+                       <object id="tableDesc8" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
+                        <void property="deserializerClass"> 
+                         <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
+                        </void> 
+                        <void property="inputFileFormatClass"> 
+                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                        </void> 
+                        <void property="outputFileFormatClass"> 
+                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                        </void> 
+                        <void property="properties"> 
+                         <object class="java.util.Properties"> 
+                          <void method="put"> 
+                           <string>columns</string> 
+                           <string>_col0,_col1</string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>columns.types</string> 
+                           <string>string,string</string> 
+                          </void> 
+                         </object> 
+                        </void> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="parentOperators"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object idref="TableScanOperator2"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="schema"> 
+                     <object id="RowSchema2" class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                      <void property="signature"> 
+                       <object class="java.util.Vector"> 
+                        <void method="add"> 
+                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                          <void property="internalName"> 
+                           <string>key</string> 
+                          </void> 
+                          <void property="type"> 
+                           <object idref="PrimitiveTypeInfo1"/> 
+                          </void> 
+                         </object> 
+                        </void> 
+                        <void method="add"> 
+                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                          <void property="internalName"> 
+                           <string>value</string> 
+                          </void> 
+                          <void property="type"> 
+                           <object idref="PrimitiveTypeInfo1"/> 
+                          </void> 
+                         </object> 
+                        </void> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="schema"> 
+                 <object idref="RowSchema2"/> 
+                </void> 
+               </object> 
+              </void> 
+             </object> 
+            </void> 
+            <void property="keyDesc"> 
+             <object idref="tableDesc7"/> 
+            </void> 
+            <void property="numReduceTasks"> 
+             <int>-1</int> 
+            </void> 
+            <void property="pathToAliases"> 
+             <object class="java.util.LinkedHashMap"> 
+              <void method="put"> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/53957225/10008</string> 
+               <object class="java.util.ArrayList"> 
+                <void method="add"> 
+                 <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/53957225/10008</string> 
+                </void> 
+               </object> 
+              </void> 
+             </object> 
+            </void> 
+            <void property="pathToPartitionInfo"> 
+             <object class="java.util.LinkedHashMap"> 
+              <void method="put"> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/53957225/10008</string> 
+               <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
+                <void property="tableDesc"> 
+                 <object idref="tableDesc6"/> 
+                </void> 
+               </object> 
+              </void> 
+             </object> 
+            </void> 
+            <void property="reducer"> 
+             <object id="ExtractOperator2" class="org.apache.hadoop.hive.ql.exec.ExtractOperator"> 
+              <void property="childOperators"> 
+               <object class="java.util.ArrayList"> 
+                <void method="add"> 
+                 <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                  <void property="conf"> 
+                   <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
+                    <void property="dirName"> 
+                     <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/253227834/10004</string> 
+                    </void> 
+                    <void property="tableInfo"> 
+                     <object idref="tableDesc6"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void property="parentOperators"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object idref="ExtractOperator2"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void property="schema"> 
+                   <object idref="RowSchema2"/> 
+                  </void> 
+                 </object> 
+                </void> 
+               </object> 
+              </void> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.extractDesc"> 
+                <void property="col"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>VALUE</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo1"/> 
+                  </void> 
+                 </object> 
+                </void> 
+               </object> 
+              </void> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
+                 <object class="java.util.Vector"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>0</string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo1"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>1</string> 
+                    </void> 
+                    <void property="type"> 
+                     <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                      <void property="typeName"> 
+                       <string>int</string> 
+                      </void> 
+                     </object> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+               </object> 
+              </void> 
+             </object> 
+            </void> 
+            <void property="tagToValueDesc"> 
+             <object class="java.util.ArrayList"> 
+              <void method="add"> 
+               <object idref="tableDesc8"/> 
+              </void> 
+             </object> 
+            </void> 
+           </object> 
+          </void> 
+         </object> 
+        </void> 
+       </object> 
+      </void> 
+      <void property="parentTasks"> 
+       <object class="java.util.ArrayList"> 
+        <void method="add"> 
+         <object idref="MapRedTask0"/> 
+        </void> 
+       </object> 
+      </void> 
+      <void property="resolver"> 
+       <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles"/> 
+      </void> 
+      <void property="resolverCtx"> 
+       <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
+        <void property="dir"> 
+         <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/53957225/10008</string> 
+        </void> 
+        <void property="listTasks"> 
+         <object idref="ArrayList2"/> 
+        </void> 
+       </object> 
+      </void> 
+      <void property="work"> 
+       <object class="org.apache.hadoop.hive.ql.plan.ConditionalWork"> 
+        <void property="listWorks"> 
+         <object class="java.util.ArrayList"> 
+          <void method="add"> 
+           <object idref="moveWork2"/> 
+          </void> 
+          <void method="add"> 
+           <object idref="mapredWork2"/> 
+          </void> 
+         </object> 
+        </void> 
+       </object> 
+      </void> 
+     </object> 
+    </void> 
+   </object> 
+  </void> 
+  <void property="id"> 
+   <string>Stage-4</string> 
+  </void> 
+  <void property="work"> 
+   <object class="org.apache.hadoop.hive.ql.plan.mapredWork"> 
+    <void property="aliasToPartnInfo"> 
+     <void method="put"> 
+      <string>src</string> 
+      <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
+       <void property="partSpec"> 
+        <object id="LinkedHashMap0" class="java.util.LinkedHashMap"/> 
+       </void> 
+       <void property="tableDesc"> 
+        <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
+         <void property="deserializerClass"> 
+          <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
+         </void> 
+         <void property="inputFileFormatClass"> 
+          <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+         </void> 
+         <void property="outputFileFormatClass"> 
+          <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+         </void> 
+         <void property="properties"> 
+          <object id="Properties0" class="java.util.Properties"> 
+           <void method="put"> 
+            <string>name</string> 
+            <string>src</string> 
+           </void> 
+           <void method="put"> 
+            <string>columns.types</string> 
+            <string>string:string</string> 
+           </void> 
+           <void method="put"> 
+            <string>serialization.ddl</string> 
+            <string>struct src { string key, string value}</string> 
+           </void> 
+           <void method="put"> 
+            <string>serialization.format</string> 
+            <string>1</string> 
+           </void> 
+           <void method="put"> 
+            <string>columns</string> 
+            <string>key,value</string> 
+           </void> 
+           <void method="put"> 
+            <string>bucket_count</string> 
+            <string>-1</string> 
+           </void> 
+           <void method="put"> 
+            <string>serialization.lib</string> 
+            <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+           </void> 
+           <void method="put"> 
+            <string>file.inputformat</string> 
+            <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+           </void> 
+           <void method="put"> 
+            <string>file.outputformat</string> 
+            <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+           </void> 
+           <void method="put"> 
+            <string>location</string> 
+            <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/src</string> 
+           </void> 
+          </object> 
+         </void> 
+         <void property="serdeClassName"> 
+          <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+         </void> 
+        </object> 
+       </void> 
+      </object> 
+     </void> 
+    </void> 
+    <void property="aliasToWork"> 
+     <object class="java.util.LinkedHashMap"> 
+      <void method="put"> 
+       <string>src</string> 
+       <object id="TableScanOperator3" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
+        <void property="childOperators"> 
+         <object class="java.util.ArrayList"> 
+          <void method="add"> 
+           <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+            <void property="childOperators"> 
+             <object class="java.util.ArrayList"> 
+              <void method="add"> 
+               <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+                <void property="childOperators"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                    <void property="conf"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
+                      <void property="destTableId"> 
+                       <int>1</int> 
+                      </void> 
+                      <void property="dirName"> 
+                       <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/53957225/10006</string> 
+                      </void> 
+                      <void property="tableInfo"> 
+                       <object idref="tableDesc0"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="parentOperators"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object idref="SelectOperator0"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="schema"> 
+                     <object idref="RowSchema0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="columnExprMap"> 
+                 <object class="java.util.HashMap"> 
+                  <void method="put"> 
+                   <string>_col1</string> 
+                   <object id="exprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>value</string> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo1"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="put"> 
+                   <string>_col0</string> 
+                   <object id="exprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>key</string> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo1"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="conf"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.selectDesc"> 
+                  <void property="colList"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object idref="exprNodeColumnDesc1"/> 
+                    </void> 
+                    <void method="add"> 
+                     <object idref="exprNodeColumnDesc0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void property="outputColumnNames"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <string>_col0</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col1</string> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void property="selectStar"> 
+                   <boolean>true</boolean> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="parentOperators"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object idref="FilterOperator0"/> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="schema"> 
+                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                  <void property="signature"> 
+                   <object class="java.util.Vector"> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="internalName"> 
+                       <string>_col0</string> 
+                      </void> 
+                      <void property="type"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="internalName"> 
+                       <string>_col1</string> 
+                      </void> 
+                      <void property="type"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+               </object> 
+              </void> 
+             </object> 
+            </void> 
+            <void property="conf"> 
+             <object class="org.apache.hadoop.hive.ql.plan.filterDesc"> 
+              <void property="predicate"> 
+               <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                <void property="UDFClass"> 
+                 <class>org.apache.hadoop.hive.ql.udf.UDFOPLessThan</class> 
+                </void> 
+                <void property="UDFMethod"> 
+                 <object class="org.apache.hadoop.hive.ql.udf.UDFOPLessThan" method="getMethod"> 
+                  <string>evaluate</string> 
+                  <array class="java.lang.Class" length="2"> 
+                   <void index="0"> 
+                    <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
+                   </void> 
+                   <void index="1"> 
+                    <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
+                   </void> 
+                  </array> 
+                 </object> 
+                </void> 
+                <void property="childExprs"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                    <void property="UDFClass"> 
+                     <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
+                    </void> 
+                    <void property="UDFMethod"> 
+                     <object class="org.apache.hadoop.hive.ql.udf.UDFToDouble" method="getMethod"> 
+                      <string>evaluate</string> 
+                      <array class="java.lang.Class" length="1"> 
+                       <void index="0"> 
+                        <class>org.apache.hadoop.io.Text</class> 
+                       </void> 
+                      </array> 
+                     </object> 
+                    </void> 
+                    <void property="childExprs"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                        <void property="column"> 
+                         <string>key</string> 
+                        </void> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                    <void property="UDFClass"> 
+                     <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
+                    </void> 
+                    <void property="UDFMethod"> 
+                     <object class="org.apache.hadoop.hive.ql.udf.UDFToDouble" method="getMethod"> 
+                      <string>evaluate</string> 
+                      <array class="java.lang.Class" length="1"> 
+                       <void index="0"> 
+                        <class>org.apache.hadoop.io.IntWritable</class> 
+                       </void> 
+                      </array> 
+                     </object> 
+                    </void> 
+                    <void property="childExprs"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo2"/> 
+                        </void> 
+                        <void property="value"> 
+                         <int>100</int> 
+                        </void> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="typeInfo"> 
+                 <object id="PrimitiveTypeInfo3" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                  <void property="typeName"> 
+                   <string>boolean</string> 
+                  </void> 
+                 </object> 
+                </void> 
+               </object> 
+              </void> 
+             </object> 
+            </void> 
+            <void property="parentOperators"> 
+             <object class="java.util.ArrayList"> 
+              <void method="add"> 
+               <object idref="TableScanOperator3"/> 
+              </void> 
+             </object> 
+            </void> 
+            <void property="schema"> 
+             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+              <void property="signature"> 
+               <object id="Vector0" class="java.util.Vector"> 
+                <void method="add"> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>key</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo1"/> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void method="add"> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>value</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo1"/> 
+                  </void> 
+                 </object> 
+                </void> 
+               </object> 
+              </void> 
+             </object> 
+            </void> 
+           </object> 
+          </void> 
+          <void method="add"> 
+           <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+            <void property="childOperators"> 
+             <object class="java.util.ArrayList"> 
+              <void method="add"> 
+               <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+                <void property="childOperators"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                    <void property="conf"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
+                      <void property="destTableId"> 
+                       <int>2</int> 
+                      </void> 
+                      <void property="dirName"> 
+                       <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/53957225/10007</string> 
+                      </void> 
+                      <void property="tableInfo"> 
+                       <object idref="tableDesc3"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="parentOperators"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object idref="SelectOperator1"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="schema"> 
+                     <object idref="RowSchema1"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="columnExprMap"> 
+                 <object class="java.util.HashMap"> 
+                  <void method="put"> 
+                   <string>_col1</string> 
+                   <object id="exprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>value</string> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo1"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="put"> 
+                   <string>_col0</string> 
+                   <object id="exprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>key</string> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo1"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="conf"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.selectDesc"> 
+                  <void property="colList"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object idref="exprNodeColumnDesc3"/> 
+                    </void> 
+                    <void method="add"> 
+                     <object idref="exprNodeColumnDesc2"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void property="outputColumnNames"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <string>_col0</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col1</string> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="parentOperators"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object idref="FilterOperator1"/> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="schema"> 
+                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                  <void property="signature"> 
+                   <object class="java.util.Vector"> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="internalName"> 
+                       <string>_col0</string> 
+                      </void> 
+                      <void property="type"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="internalName"> 
+                       <string>_col1</string> 
+                      </void> 
+                      <void property="type"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+               </object> 
+              </void> 
+             </object> 
+            </void> 
+            <void property="conf"> 
+             <object class="org.apache.hadoop.hive.ql.plan.filterDesc"> 
+              <void property="predicate"> 
+               <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                <void property="UDFClass"> 
+                 <class>org.apache.hadoop.hive.ql.udf.UDFOPAnd</class> 
+                </void> 
+                <void property="UDFMethod"> 
+                 <object class="org.apache.hadoop.hive.ql.udf.UDFOPAnd" method="getMethod"> 
+                  <string>evaluate</string> 
+                  <array class="java.lang.Class" length="2"> 
+                   <void index="0"> 
+                    <class>org.apache.hadoop.io.BooleanWritable</class> 
+                   </void> 
+                   <void index="1"> 
+                    <class>org.apache.hadoop.io.BooleanWritable</class> 
+                   </void> 
+                  </array> 
+                 </object> 
+                </void> 
+                <void property="childExprs"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                    <void property="UDFClass"> 
+                     <class>org.apache.hadoop.hive.ql.udf.UDFOPEqualOrGreaterThan</class> 
+                    </void> 
+                    <void property="UDFMethod"> 
+                     <object class="org.apache.hadoop.hive.ql.udf.UDFOPEqualOrGreaterThan" method="getMethod"> 
+                      <string>evaluate</string> 
                       <array class="java.lang.Class" length="2"> 
                        <void index="0"> 
-                        <class>org.apache.hadoop.io.BooleanWritable</class> 
+                        <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
                        </void> 
                        <void index="1"> 
-                        <class>org.apache.hadoop.io.BooleanWritable</class> 
+                        <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
                        </void> 
                       </array> 
                      </object> 
@@ -983,17 +1965,14 @@
                       <void method="add"> 
                        <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
                         <void property="UDFClass"> 
-                         <class>org.apache.hadoop.hive.ql.udf.UDFOPEqualOrGreaterThan</class> 
+                         <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
                         </void> 
                         <void property="UDFMethod"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.UDFOPEqualOrGreaterThan" method="getMethod"> 
+                         <object class="org.apache.hadoop.hive.ql.udf.UDFToDouble" method="getMethod"> 
                           <string>evaluate</string> 
-                          <array class="java.lang.Class" length="2"> 
+                          <array class="java.lang.Class" length="1"> 
                            <void index="0"> 
-                            <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
-                           </void> 
-                           <void index="1"> 
-                            <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
+                            <class>org.apache.hadoop.io.Text</class> 
                            </void> 
                           </array> 
                          </object> 
@@ -1001,94 +1980,33 @@
                         <void property="childExprs"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                            <void property="UDFClass"> 
-                             <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
-                            </void> 
-                            <void property="UDFMethod"> 
-                             <object class="org.apache.hadoop.hive.ql.udf.UDFToDouble" method="getMethod"> 
-                              <string>evaluate</string> 
-                              <array class="java.lang.Class" length="1"> 
-                               <void index="0"> 
-                                <class>org.apache.hadoop.io.Text</class> 
-                               </void> 
-                              </array> 
-                             </object> 
-                            </void> 
-                            <void property="childExprs"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                                <void property="column"> 
-                                 <string>key</string> 
-                                </void> 
-                                <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo1"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                            <void property="UDFClass"> 
-                             <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
-                            </void> 
-                            <void property="UDFMethod"> 
-                             <object class="org.apache.hadoop.hive.ql.udf.UDFToDouble" method="getMethod"> 
-                              <string>evaluate</string> 
-                              <array class="java.lang.Class" length="1"> 
-                               <void index="0"> 
-                                <class>org.apache.hadoop.io.IntWritable</class> 
-                               </void> 
-                              </array> 
-                             </object> 
-                            </void> 
-                            <void property="childExprs"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
-                                <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo2"/> 
-                                </void> 
-                                <void property="value"> 
-                                 <int>100</int> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
+                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                            <void property="column"> 
+                             <string>key</string> 
                             </void> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                            </object> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo3"/> 
+                         <object idref="PrimitiveTypeInfo0"/> 
                         </void> 
                        </object> 
                       </void> 
                       <void method="add"> 
                        <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
                         <void property="UDFClass"> 
-                         <class>org.apache.hadoop.hive.ql.udf.UDFOPLessThan</class> 
+                         <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
                         </void> 
                         <void property="UDFMethod"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.UDFOPLessThan" method="getMethod"> 
+                         <object class="org.apache.hadoop.hive.ql.udf.UDFToDouble" method="getMethod"> 
                           <string>evaluate</string> 
-                          <array class="java.lang.Class" length="2"> 
+                          <array class="java.lang.Class" length="1"> 
                            <void index="0"> 
-                            <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
-                           </void> 
-                           <void index="1"> 
-                            <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
+                            <class>org.apache.hadoop.io.IntWritable</class> 
                            </void> 
                           </array> 
                          </object> 
@@ -1096,326 +2014,36 @@
                         <void property="childExprs"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                            <void property="UDFClass"> 
-                             <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
-                            </void> 
-                            <void property="UDFMethod"> 
-                             <object class="org.apache.hadoop.hive.ql.udf.UDFToDouble" method="getMethod"> 
-                              <string>evaluate</string> 
-                              <array class="java.lang.Class" length="1"> 
-                               <void index="0"> 
-                                <class>org.apache.hadoop.io.Text</class> 
-                               </void> 
-                              </array> 
-                             </object> 
-                            </void> 
-                            <void property="childExprs"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                                <void property="column"> 
-                                 <string>key</string> 
-                                </void> 
-                                <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo1"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                            <void property="UDFClass"> 
-                             <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
-                            </void> 
-                            <void property="UDFMethod"> 
-                             <object class="org.apache.hadoop.hive.ql.udf.UDFToDouble" method="getMethod"> 
-                              <string>evaluate</string> 
-                              <array class="java.lang.Class" length="1"> 
-                               <void index="0"> 
-                                <class>org.apache.hadoop.io.IntWritable</class> 
-                               </void> 
-                              </array> 
-                             </object> 
-                            </void> 
-                            <void property="childExprs"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
-                                <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo2"/> 
-                                </void> 
-                                <void property="value"> 
-                                 <int>200</int> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
+                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo3"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo3"/> 
-                    </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="parentOperators"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object idref="TableScanOperator1"/> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object idref="Vector0"/> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="add"> 
-               <object id="FilterOperator2" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
-                <void property="childOperators"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object id="SelectOperator2" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                    <void property="childOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object id="FileSinkOperator2" class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                        <void property="conf"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
-                          <void property="destTableId"> 
-                           <int>3</int> 
-                          </void> 
-                          <void property="dirName"> 
-                           <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/584470898/10008</string> 
-                          </void> 
-                          <void property="tableInfo"> 
-                           <object id="tableDesc4" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
-                            <void property="deserializerClass"> 
-                             <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
-                            </void> 
-                            <void property="inputFileFormatClass"> 
-                             <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-                            </void> 
-                            <void property="outputFileFormatClass"> 
-                             <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-                            </void> 
-                            <void property="properties"> 
-                             <object class="java.util.Properties"> 
-                              <void method="put"> 
-                               <string>name</string> 
-                               <string>dest3</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>columns.types</string> 
-                               <string>string:string</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>serialization.ddl</string> 
-                               <string>struct dest3 { string key, string value}</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>serialization.format</string> 
-                               <string>1</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>columns</string> 
-                               <string>key,value</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>partition_columns</string> 
-                               <string>ds/hr</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>bucket_count</string> 
-                               <string>-1</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>serialization.lib</string> 
-                               <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>file.inputformat</string> 
-                               <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>file.outputformat</string> 
-                               <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>location</string> 
-                               <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/dest3</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="serdeClassName"> 
-                             <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="parentOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object idref="SelectOperator2"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="schema"> 
-                         <object id="RowSchema2" class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                          <void property="signature"> 
-                           <object class="java.util.Vector"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>key</string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo1"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>value</string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo1"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="columnExprMap"> 
-                     <object class="java.util.HashMap"> 
-                      <void method="put"> 
-                       <string>_col1</string> 
-                       <object id="exprNodeConstantDesc0" class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo2"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>2</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="put"> 
-                       <string>_col0</string> 
-                       <object id="exprNodeColumnDesc4" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.selectDesc"> 
-                      <void property="colList"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object idref="exprNodeColumnDesc4"/> 
-                        </void> 
-                        <void method="add"> 
-                         <object idref="exprNodeConstantDesc0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="outputColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>_col0</string> 
-                        </void> 
-                        <void method="add"> 
-                         <string>_col1</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="FilterOperator2"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="schema"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                      <void property="signature"> 
-                       <object class="java.util.Vector"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col0</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo1"/> 
+                             <object idref="PrimitiveTypeInfo2"/> 
+                            </void> 
+                            <void property="value"> 
+                             <int>100</int> 
+                            </void> 
+                           </object> 
                           </void> 
                          </object> 
                         </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col1</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo2"/> 
-                          </void> 
-                         </object> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo0"/> 
                         </void> 
                        </object> 
                       </void> 
                      </object> 
                     </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo3"/> 
+                    </void> 
                    </object> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.filterDesc"> 
-                  <void property="predicate"> 
+                  <void method="add"> 
                    <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
                     <void property="UDFClass"> 
-                     <class>org.apache.hadoop.hive.ql.udf.UDFOPEqualOrGreaterThan</class> 
+                     <class>org.apache.hadoop.hive.ql.udf.UDFOPLessThan</class> 
                     </void> 
                     <void property="UDFMethod"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.UDFOPEqualOrGreaterThan" method="getMethod"> 
+                     <object class="org.apache.hadoop.hive.ql.udf.UDFOPLessThan" method="getMethod"> 
                       <string>evaluate</string> 
                       <array class="java.lang.Class" length="2"> 
                        <void index="0"> 
@@ -1506,31 +2134,17 @@
                   </void> 
                  </object> 
                 </void> 
-                <void property="parentOperators"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object idref="TableScanOperator1"/> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object idref="Vector0"/> 
-                  </void> 
-                 </object> 
+                <void property="typeInfo"> 
+                 <object idref="PrimitiveTypeInfo3"/> 
                 </void> 
                </object> 
               </void> 
              </object> 
             </void> 
-            <void property="neededColumnIDs"> 
+            <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <int>0</int> 
-              </void> 
-              <void method="add"> 
-               <int>1</int> 
+               <object idref="TableScanOperator3"/> 
               </void> 
              </object> 
             </void> 
@@ -1543,428 +2157,125 @@
             </void> 
            </object> 
           </void> 
-          <void property="mapCurrCtx"> 
-           <object class="java.util.LinkedHashMap"> 
-            <void method="put"> 
-             <object idref="TableScanOperator1"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-            <void method="put"> 
-             <object idref="FilterOperator0"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-            <void method="put"> 
-             <object idref="SelectOperator0"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-            <void method="put"> 
-             <object idref="FilterOperator1"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-            <void method="put"> 
-             <object idref="SelectOperator1"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-            <void method="put"> 
-             <object idref="FilterOperator2"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-            <void method="put"> 
-             <object idref="SelectOperator2"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="mvTask"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="MoveTask0"/> 
-            </void> 
-            <void method="add"> 
-             <object id="MoveTask1" class="org.apache.hadoop.hive.ql.exec.MoveTask"> 
-              <void property="id"> 
-               <string>Stage-2</string> 
-              </void> 
-              <void property="parentTasks"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object id="ConditionalTask1" class="org.apache.hadoop.hive.ql.exec.ConditionalTask"> 
-                  <void property="childTasks"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="MoveTask1"/> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void property="id"> 
-                   <string>Stage-10</string> 
-                  </void> 
-                  <void property="listTasks"> 
-                   <object id="ArrayList1" class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.MoveTask"> 
-                      <void property="id"> 
-                       <string>Stage-9</string> 
-                      </void> 
-                      <void property="work"> 
-                       <object id="moveWork1" class="org.apache.hadoop.hive.ql.plan.moveWork"> 
-                        <void property="loadFileWork"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.loadFileDesc"> 
-                          <void property="isDfsDir"> 
-                           <boolean>true</boolean> 
-                          </void> 
-                          <void property="sourceDir"> 
-                           <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/584470898/10007</string> 
-                          </void> 
-                          <void property="targetDir"> 
-                           <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/2129120497/10002</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
+          <void method="add"> 
+           <object id="FilterOperator2" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+            <void property="childOperators"> 
+             <object class="java.util.ArrayList"> 
+              <void method="add"> 
+               <object id="SelectOperator2" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+                <void property="childOperators"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                    <void property="conf"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
+                      <void property="destTableId"> 
+                       <int>3</int> 
+                      </void> 
+                      <void property="dirName"> 
+                       <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/53957225/10008</string> 
+                      </void> 
+                      <void property="tableInfo"> 
+                       <object idref="tableDesc6"/> 
                       </void> 
                      </object> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.MapRedTask"> 
-                      <void property="id"> 
-                       <string>Stage-8</string> 
-                      </void> 
-                      <void property="work"> 
-                       <object id="mapredWork1" class="org.apache.hadoop.hive.ql.plan.mapredWork"> 
-                        <void property="aliasToWork"> 
-                         <object class="java.util.LinkedHashMap"> 
-                          <void method="put"> 
-                           <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/584470898/10007</string> 
-                           <object id="TableScanOperator2" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
-                            <void property="childOperators"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
-                                <void property="conf"> 
-                                 <object class="org.apache.hadoop.hive.ql.plan.reduceSinkDesc"> 
-                                  <void property="keyCols"> 
-                                   <object class="java.util.ArrayList"/> 
-                                  </void> 
-                                  <void property="keySerializeInfo"> 
-                                   <object id="tableDesc5" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
-                                    <void property="deserializerClass"> 
-                                     <class>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</class> 
-                                    </void> 
-                                    <void property="inputFileFormatClass"> 
-                                     <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                                    </void> 
-                                    <void property="outputFileFormatClass"> 
-                                     <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                                    </void> 
-                                    <void property="properties"> 
-                                     <object class="java.util.Properties"> 
-                                      <void method="put"> 
-                                       <string>columns</string> 
-                                       <string></string> 
-                                      </void> 
-                                      <void method="put"> 
-                                       <string>serialization.sort.order</string> 
-                                       <string></string> 
-                                      </void> 
-                                      <void method="put"> 
-                                       <string>columns.types</string> 
-                                       <string></string> 
-                                      </void> 
-                                     </object> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                  <void property="numReducers"> 
-                                   <int>-1</int> 
-                                  </void> 
-                                  <void property="outputKeyColumnNames"> 
-                                   <object class="java.util.ArrayList"/> 
-                                  </void> 
-                                  <void property="outputValueColumnNames"> 
-                                   <object class="java.util.ArrayList"> 
-                                    <void method="add"> 
-                                     <string>_col0</string> 
-                                    </void> 
-                                    <void method="add"> 
-                                     <string>_col1</string> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                  <void property="partitionCols"> 
-                                   <object class="java.util.ArrayList"> 
-                                    <void method="add"> 
-                                     <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                                      <void property="UDFClass"> 
-                                       <class>org.apache.hadoop.hive.ql.udf.UDFRand</class> 
-                                      </void> 
-                                      <void property="UDFMethod"> 
-                                       <object class="org.apache.hadoop.hive.ql.udf.UDFRand" method="getMethod"> 
-                                        <string>evaluate</string> 
-                                        <array class="java.lang.Class" length="0"/> 
-                                       </object> 
-                                      </void> 
-                                      <void property="childExprs"> 
-                                       <object class="java.util.ArrayList"/> 
-                                      </void> 
-                                      <void property="typeInfo"> 
-                                       <object idref="PrimitiveTypeInfo0"/> 
-                                      </void> 
-                                     </object> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                  <void property="tag"> 
-                                   <int>-1</int> 
-                                  </void> 
-                                  <void property="valueCols"> 
-                                   <object class="java.util.ArrayList"> 
-                                    <void method="add"> 
-                                     <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                                      <void property="column"> 
-                                       <string>key</string> 
-                                      </void> 
-                                      <void property="typeInfo"> 
-                                       <object idref="PrimitiveTypeInfo1"/> 
-                                      </void> 
-                                     </object> 
-                                    </void> 
-                                    <void method="add"> 
-                                     <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                                      <void property="column"> 
-                                       <string>value</string> 
-                                      </void> 
-                                      <void property="typeInfo"> 
-                                       <object idref="PrimitiveTypeInfo1"/> 
-                                      </void> 
-                                     </object> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                  <void property="valueSerializeInfo"> 
-                                   <object id="tableDesc6" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
-                                    <void property="deserializerClass"> 
-                                     <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
-                                    </void> 
-                                    <void property="inputFileFormatClass"> 
-                                     <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                                    </void> 
-                                    <void property="outputFileFormatClass"> 
-                                     <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                                    </void> 
-                                    <void property="properties"> 
-                                     <object class="java.util.Properties"> 
-                                      <void method="put"> 
-                                       <string>columns</string> 
-                                       <string>_col0,_col1</string> 
-                                      </void> 
-                                      <void method="put"> 
-                                       <string>columns.types</string> 
-                                       <string>string,string</string> 
-                                      </void> 
-                                     </object> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void property="parentOperators"> 
-                                 <object class="java.util.ArrayList"> 
-                                  <void method="add"> 
-                                   <object idref="TableScanOperator2"/> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void property="schema"> 
-                                 <object idref="RowSchema1"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="schema"> 
-                             <object idref="RowSchema1"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="keyDesc"> 
-                         <object idref="tableDesc5"/> 
-                        </void> 
-                        <void property="numReduceTasks"> 
-                         <int>-1</int> 
-                        </void> 
-                        <void property="pathToAliases"> 
-                         <object class="java.util.LinkedHashMap"> 
-                          <void method="put"> 
-                           <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/584470898/10007</string> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/584470898/10007</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="pathToPartitionInfo"> 
-                         <object class="java.util.LinkedHashMap"> 
-                          <void method="put"> 
-                           <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/584470898/10007</string> 
-                           <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
-                            <void property="tableDesc"> 
-                             <object idref="tableDesc3"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="reducer"> 
-                         <object id="ExtractOperator1" class="org.apache.hadoop.hive.ql.exec.ExtractOperator"> 
-                          <void property="childOperators"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                              <void property="conf"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
-                                <void property="dirName"> 
-                                 <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/2129120497/10002</string> 
-                                </void> 
-                                <void property="tableInfo"> 
-                                 <object idref="tableDesc3"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void property="parentOperators"> 
-                               <object class="java.util.ArrayList"> 
-                                <void method="add"> 
-                                 <object idref="ExtractOperator1"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void property="schema"> 
-                               <object idref="RowSchema1"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="conf"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.extractDesc"> 
-                            <void property="col"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                              <void property="column"> 
-                               <string>VALUE</string> 
-                              </void> 
-                              <void property="typeInfo"> 
-                               <object idref="PrimitiveTypeInfo1"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="schema"> 
-                           <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                            <void property="signature"> 
-                             <object class="java.util.Vector"> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                <void property="internalName"> 
-                                 <string>0</string> 
-                                </void> 
-                                <void property="type"> 
-                                 <object idref="PrimitiveTypeInfo1"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                <void property="internalName"> 
-                                 <string>1</string> 
-                                </void> 
-                                <void property="type"> 
-                                 <object idref="PrimitiveTypeInfo1"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="tagToValueDesc"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object idref="tableDesc6"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
+                    <void property="parentOperators"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object idref="SelectOperator2"/> 
                       </void> 
                      </object> 
                     </void> 
+                    <void property="schema"> 
+                     <object idref="RowSchema2"/> 
+                    </void> 
                    </object> 
                   </void> 
-                  <void property="parentTasks"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="MapRedTask0"/> 
+                 </object> 
+                </void> 
+                <void property="columnExprMap"> 
+                 <object class="java.util.HashMap"> 
+                  <void method="put"> 
+                   <string>_col1</string> 
+                   <object id="exprNodeConstantDesc0" class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo2"/> 
+                    </void> 
+                    <void property="value"> 
+                     <int>2</int> 
                     </void> 
                    </object> 
                   </void> 
-                  <void property="resolver"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles"/> 
-                  </void> 
-                  <void property="resolverCtx"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
-                    <void property="ctx"> 
-                     <object idref="GenMRProcContext0"/> 
+                  <void method="put"> 
+                   <string>_col0</string> 
+                   <object id="exprNodeColumnDesc4" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>key</string> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo1"/> 
                     </void> 
-                    <void property="dir"> 
-                     <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/584470898/10007</string> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="conf"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.selectDesc"> 
+                  <void property="colList"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object idref="exprNodeColumnDesc4"/> 
                     </void> 
-                    <void property="listTasks"> 
-                     <object idref="ArrayList1"/> 
+                    <void method="add"> 
+                     <object idref="exprNodeConstantDesc0"/> 
                     </void> 
                    </object> 
                   </void> 
-                  <void property="work"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ConditionalWork"> 
-                    <void property="listWorks"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="moveWork1"/> 
-                      </void> 
-                      <void method="add"> 
-                       <object idref="mapredWork1"/> 
-                      </void> 
-                     </object> 
+                  <void property="outputColumnNames"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <string>_col0</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col1</string> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-               </object> 
-              </void> 
-              <void property="work"> 
-               <object class="org.apache.hadoop.hive.ql.plan.moveWork"> 
-                <void property="loadTableWork"> 
-                 <object id="loadTableDesc1" class="org.apache.hadoop.hive.ql.plan.loadTableDesc"> 
-                  <void property="partitionSpec"> 
-                   <object class="java.util.HashMap"/> 
-                  </void> 
-                  <void property="replace"> 
-                   <boolean>true</boolean> 
-                  </void> 
-                  <void property="sourceDir"> 
-                   <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/2129120497/10002</string> 
-                  </void> 
-                  <void property="table"> 
-                   <object idref="tableDesc3"/> 
+                <void property="parentOperators"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object idref="FilterOperator2"/> 
                   </void> 
-                  <void property="tmpDir"> 
-                   <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/2129120497/10003</string> 
+                 </object> 
+                </void> 
+                <void property="schema"> 
+                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                  <void property="signature"> 
+                   <object class="java.util.Vector"> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="internalName"> 
+                       <string>_col0</string> 
+                      </void> 
+                      <void property="type"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="internalName"> 
+                       <string>_col1</string> 
+                      </void> 
+                      <void property="type"> 
+                       <object idref="PrimitiveTypeInfo2"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                   </object> 
                   </void> 
                  </object> 
                 </void> 
@@ -1972,643 +2283,137 @@
               </void> 
              </object> 
             </void> 
-            <void method="add"> 
-             <object id="MoveTask2" class="org.apache.hadoop.hive.ql.exec.MoveTask"> 
-              <void property="id"> 
-               <string>Stage-3</string> 
-              </void> 
-              <void property="parentTasks"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object id="ConditionalTask2" class="org.apache.hadoop.hive.ql.exec.ConditionalTask"> 
-                  <void property="childTasks"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="MoveTask2"/> 
+            <void property="conf"> 
+             <object class="org.apache.hadoop.hive.ql.plan.filterDesc"> 
+              <void property="predicate"> 
+               <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                <void property="UDFClass"> 
+                 <class>org.apache.hadoop.hive.ql.udf.UDFOPEqualOrGreaterThan</class> 
+                </void> 
+                <void property="UDFMethod"> 
+                 <object class="org.apache.hadoop.hive.ql.udf.UDFOPEqualOrGreaterThan" method="getMethod"> 
+                  <string>evaluate</string> 
+                  <array class="java.lang.Class" length="2"> 
+                   <void index="0"> 
+                    <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
+                   </void> 
+                   <void index="1"> 
+                    <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
+                   </void> 
+                  </array> 
+                 </object> 
+                </void> 
+                <void property="childExprs"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                    <void property="UDFClass"> 
+                     <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
                     </void> 
-                   </object> 
-                  </void> 
-                  <void property="id"> 
-                   <string>Stage-13</string> 
-                  </void> 
-                  <void property="listTasks"> 
-                   <object id="ArrayList2" class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.MoveTask"> 
-                      <void property="id"> 
-                       <string>Stage-12</string> 
-                      </void> 
-                      <void property="work"> 
-                       <object id="moveWork2" class="org.apache.hadoop.hive.ql.plan.moveWork"> 
-                        <void property="loadFileWork"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.loadFileDesc"> 
-                          <void property="isDfsDir"> 
-                           <boolean>true</boolean> 
-                          </void> 
-                          <void property="sourceDir"> 
-                           <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/584470898/10008</string> 
-                          </void> 
-                          <void property="targetDir"> 
-                           <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/2129120497/10004</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
+                    <void property="UDFMethod"> 
+                     <object class="org.apache.hadoop.hive.ql.udf.UDFToDouble" method="getMethod"> 
+                      <string>evaluate</string> 
+                      <array class="java.lang.Class" length="1"> 
+                       <void index="0"> 
+                        <class>org.apache.hadoop.io.Text</class> 
+                       </void> 
+                      </array> 
                      </object> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.MapRedTask"> 
-                      <void property="id"> 
-                       <string>Stage-11</string> 
-                      </void> 
-                      <void property="work"> 
-                       <object id="mapredWork2" class="org.apache.hadoop.hive.ql.plan.mapredWork"> 
-                        <void property="aliasToWork"> 
-                         <object class="java.util.LinkedHashMap"> 
-                          <void method="put"> 
-                           <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/584470898/10008</string> 
-                           <object id="TableScanOperator3" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
-                            <void property="childOperators"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
-                                <void property="conf"> 
-                                 <object class="org.apache.hadoop.hive.ql.plan.reduceSinkDesc"> 
-                                  <void property="keyCols"> 
-                                   <object class="java.util.ArrayList"/> 
-                                  </void> 
-                                  <void property="keySerializeInfo"> 
-                                   <object id="tableDesc7" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
-                                    <void property="deserializerClass"> 
-                                     <class>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</class> 
-                                    </void> 
-                                    <void property="inputFileFormatClass"> 
-                                     <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                                    </void> 
-                                    <void property="outputFileFormatClass"> 
-                                     <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                                    </void> 
-                                    <void property="properties"> 
-                                     <object class="java.util.Properties"> 
-                                      <void method="put"> 
-                                       <string>columns</string> 
-                                       <string></string> 
-                                      </void> 
-                                      <void method="put"> 
-                                       <string>serialization.sort.order</string> 
-                                       <string></string> 
-                                      </void> 
-                                      <void method="put"> 
-                                       <string>columns.types</string> 
-                                       <string></string> 
-                                      </void> 
-                                     </object> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                  <void property="numReducers"> 
-                                   <int>-1</int> 
-                                  </void> 
-                                  <void property="outputKeyColumnNames"> 
-                                   <object class="java.util.ArrayList"/> 
-                                  </void> 
-                                  <void property="outputValueColumnNames"> 
-                                   <object class="java.util.ArrayList"> 
-                                    <void method="add"> 
-                                     <string>_col0</string> 
-                                    </void> 
-                                    <void method="add"> 
-                                     <string>_col1</string> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                  <void property="partitionCols"> 
-                                   <object class="java.util.ArrayList"> 
-                                    <void method="add"> 
-                                     <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                                      <void property="UDFClass"> 
-                                       <class>org.apache.hadoop.hive.ql.udf.UDFRand</class> 
-                                      </void> 
-                                      <void property="UDFMethod"> 
-                                       <object class="org.apache.hadoop.hive.ql.udf.UDFRand" method="getMethod"> 
-                                        <string>evaluate</string> 
-                                        <array class="java.lang.Class" length="0"/> 
-                                       </object> 
-                                      </void> 
-                                      <void property="childExprs"> 
-                                       <object class="java.util.ArrayList"/> 
-                                      </void> 
-                                      <void property="typeInfo"> 
-                                       <object idref="PrimitiveTypeInfo0"/> 
-                                      </void> 
-                                     </object> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                  <void property="tag"> 
-                                   <int>-1</int> 
-                                  </void> 
-                                  <void property="valueCols"> 
-                                   <object class="java.util.ArrayList"> 
-                                    <void method="add"> 
-                                     <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                                      <void property="column"> 
-                                       <string>key</string> 
-                                      </void> 
-                                      <void property="typeInfo"> 
-                                       <object idref="PrimitiveTypeInfo1"/> 
-                                      </void> 
-                                     </object> 
-                                    </void> 
-                                    <void method="add"> 
-                                     <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                                      <void property="column"> 
-                                       <string>value</string> 
-                                      </void> 
-                                      <void property="typeInfo"> 
-                                       <object idref="PrimitiveTypeInfo1"/> 
-                                      </void> 
-                                     </object> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                  <void property="valueSerializeInfo"> 
-                                   <object id="tableDesc8" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
-                                    <void property="deserializerClass"> 
-                                     <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
-                                    </void> 
-                                    <void property="inputFileFormatClass"> 
-                                     <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                                    </void> 
-                                    <void property="outputFileFormatClass"> 
-                                     <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                                    </void> 
-                                    <void property="properties"> 
-                                     <object class="java.util.Properties"> 
-                                      <void method="put"> 
-                                       <string>columns</string> 
-                                       <string>_col0,_col1</string> 
-                                      </void> 
-                                      <void method="put"> 
-                                       <string>columns.types</string> 
-                                       <string>string,string</string> 
-                                      </void> 
-                                     </object> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void property="parentOperators"> 
-                                 <object class="java.util.ArrayList"> 
-                                  <void method="add"> 
-                                   <object idref="TableScanOperator3"/> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void property="schema"> 
-                                 <object idref="RowSchema2"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="schema"> 
-                             <object idref="RowSchema2"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="keyDesc"> 
-                         <object idref="tableDesc7"/> 
-                        </void> 
-                        <void property="numReduceTasks"> 
-                         <int>-1</int> 
-                        </void> 
-                        <void property="pathToAliases"> 
-                         <object class="java.util.LinkedHashMap"> 
-                          <void method="put"> 
-                           <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/584470898/10008</string> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/584470898/10008</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="pathToPartitionInfo"> 
-                         <object class="java.util.LinkedHashMap"> 
-                          <void method="put"> 
-                           <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/584470898/10008</string> 
-                           <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
-                            <void property="tableDesc"> 
-                             <object idref="tableDesc4"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="reducer"> 
-                         <object id="ExtractOperator2" class="org.apache.hadoop.hive.ql.exec.ExtractOperator"> 
-                          <void property="childOperators"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                              <void property="conf"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
-                                <void property="dirName"> 
-                                 <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/2129120497/10004</string> 
-                                </void> 
-                                <void property="tableInfo"> 
-                                 <object idref="tableDesc4"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void property="parentOperators"> 
-                               <object class="java.util.ArrayList"> 
-                                <void method="add"> 
-                                 <object idref="ExtractOperator2"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void property="schema"> 
-                               <object idref="RowSchema2"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="conf"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.extractDesc"> 
-                            <void property="col"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                              <void property="column"> 
-                               <string>VALUE</string> 
-                              </void> 
-                              <void property="typeInfo"> 
-                               <object idref="PrimitiveTypeInfo1"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="schema"> 
-                           <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                            <void property="signature"> 
-                             <object class="java.util.Vector"> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                <void property="internalName"> 
-                                 <string>0</string> 
-                                </void> 
-                                <void property="type"> 
-                                 <object idref="PrimitiveTypeInfo1"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                <void property="internalName"> 
-                                 <string>1</string> 
-                                </void> 
-                                <void property="type"> 
-                                 <object idref="PrimitiveTypeInfo2"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="tagToValueDesc"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object idref="tableDesc8"/> 
-                          </void> 
-                         </object> 
+                    <void property="childExprs"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                        <void property="column"> 
+                         <string>key</string> 
+                        </void> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
                        </object> 
                       </void> 
                      </object> 
                     </void> 
-                   </object> 
-                  </void> 
-                  <void property="parentTasks"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="MapRedTask0"/> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
                    </object> 
                   </void> 
-                  <void property="resolver"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles"/> 
-                  </void> 
-                  <void property="resolverCtx"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
-                    <void property="ctx"> 
-                     <object idref="GenMRProcContext0"/> 
-                    </void> 
-                    <void property="dir"> 
-                     <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/584470898/10008</string> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                    <void property="UDFClass"> 
+                     <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
                     </void> 
-                    <void property="listTasks"> 
-                     <object idref="ArrayList2"/> 
+                    <void property="UDFMethod"> 
+                     <object class="org.apache.hadoop.hive.ql.udf.UDFToDouble" method="getMethod"> 
+                      <string>evaluate</string> 
+                      <array class="java.lang.Class" length="1"> 
+                       <void index="0"> 
+                        <class>org.apache.hadoop.io.IntWritable</class> 
+                       </void> 
+                      </array> 
+                     </object> 
                     </void> 
-                   </object> 
-                  </void> 
-                  <void property="work"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ConditionalWork"> 
-                    <void property="listWorks"> 
+                    <void property="childExprs"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object idref="moveWork2"/> 
-                      </void> 
-                      <void method="add"> 
-                       <object idref="mapredWork2"/> 
+                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo2"/> 
+                        </void> 
+                        <void property="value"> 
+                         <int>200</int> 
+                        </void> 
+                       </object> 
                       </void> 
                      </object> 
                     </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-              <void property="work"> 
-               <object class="org.apache.hadoop.hive.ql.plan.moveWork"> 
-                <void property="loadTableWork"> 
-                 <object id="loadTableDesc2" class="org.apache.hadoop.hive.ql.plan.loadTableDesc"> 
-                  <void property="partitionSpec"> 
-                   <object class="java.util.LinkedHashMap"> 
-                    <void method="put"> 
-                     <string>ds</string> 
-                     <string>2008-04-08</string> 
-                    </void> 
-                    <void method="put"> 
-                     <string>hr</string> 
-                     <string>12</string> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
                    </object> 
                   </void> 
-                  <void property="replace"> 
-                   <boolean>true</boolean> 
-                  </void> 
-                  <void property="sourceDir"> 
-                   <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/2129120497/10004</string> 
-                  </void> 
-                  <void property="table"> 
-                   <object idref="tableDesc4"/> 
-                  </void> 
-                  <void property="tmpDir"> 
-                   <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/2129120497/10005</string> 
-                  </void> 
                  </object> 
                 </void> 
+                <void property="typeInfo"> 
+                 <object idref="PrimitiveTypeInfo3"/> 
+                </void> 
                </object> 
               </void> 
              </object> 
             </void> 
-           </object> 
-          </void> 
-          <void property="opTaskMap"> 
-           <object class="java.util.HashMap"> 
-            <void method="put"> 
-             <null/> 
-             <object idref="MapRedTask0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="parseCtx"> 
-           <object class="org.apache.hadoop.hive.ql.parse.ParseContext"> 
-            <void property="QB"> 
-             <object class="org.apache.hadoop.hive.ql.parse.QB"/> 
-            </void> 
-            <void property="UCtx"> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.unionproc.UnionProcContext"/> 
-            </void> 
-            <void property="aliasToPruner"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>src</string> 
-               <object class="org.apache.hadoop.hive.ql.parse.PartitionPruner"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="aliasToSamplePruner"> 
-             <object class="java.util.HashMap"/> 
-            </void> 
-            <void property="conf"> 
-             <object idref="HiveConf0"/> 
-            </void> 
-            <void property="context"> 
-             <object class="org.apache.hadoop.hive.ql.Context"/> 
-            </void> 
-            <void property="destTableId"> 
-             <int>4</int> 
-            </void> 
-            <void property="idToTableNameMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>3</string> 
-               <string>dest3</string> 
-              </void> 
-              <void method="put"> 
-               <string>2</string> 
-               <string>dest2</string> 
-              </void> 
-              <void method="put"> 
-               <string>1</string> 
-               <string>dest1</string> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="joinContext"> 
-             <object class="java.util.HashMap"/> 
-            </void> 
-            <void property="listMapJoinOpsNoReducer"> 
-             <object class="java.util.ArrayList"/> 
-            </void> 
-            <void property="loadFileWork"> 
-             <object class="java.util.ArrayList"/> 
-            </void> 
-            <void property="loadTableWork"> 
+            <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <object idref="loadTableDesc0"/> 
-              </void> 
-              <void method="add"> 
-               <object idref="loadTableDesc1"/> 
-              </void> 
-              <void method="add"> 
-               <object idref="loadTableDesc2"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="opParseCtx"> 
-             <object class="java.util.LinkedHashMap"> 
-              <void method="put"> 
-               <object idref="TableScanOperator1"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object id="RowResolver0" class="org.apache.hadoop.hive.ql.parse.RowResolver"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="FilterOperator0"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object idref="RowResolver0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="SelectOperator0"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object id="RowResolver1" class="org.apache.hadoop.hive.ql.parse.RowResolver"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="FileSinkOperator0"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object idref="RowResolver1"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="FilterOperator1"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object idref="RowResolver0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="SelectOperator1"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object id="RowResolver2" class="org.apache.hadoop.hive.ql.parse.RowResolver"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="FileSinkOperator1"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object idref="RowResolver2"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="FilterOperator2"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object idref="RowResolver0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="SelectOperator2"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object id="RowResolver3" class="org.apache.hadoop.hive.ql.parse.RowResolver"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="FileSinkOperator2"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object idref="RowResolver3"/> 
-                </void> 
-               </object> 
+               <object idref="TableScanOperator3"/> 
               </void> 
              </object> 
             </void> 
-            <void property="parseTree"> 
-             <object class="org.apache.hadoop.hive.ql.parse.ASTNode"> 
-              <void property="tokenStartIndex"> 
-               <int>0</int> 
-              </void> 
-              <void property="tokenStopIndex"> 
-               <int>104</int> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="topOps"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>src</string> 
-               <object idref="TableScanOperator1"/> 
+            <void property="schema"> 
+             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+              <void property="signature"> 
+               <object idref="Vector0"/> 
               </void> 
              </object> 
             </void> 
-            <void property="topSelOps"> 
-             <object class="java.util.HashMap"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="rootOps"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="TableScanOperator1"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="rootTasks"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="MapRedTask0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="seenFileSinkOps"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="FileSinkOperator0"/> 
-            </void> 
-            <void method="add"> 
-             <object idref="FileSinkOperator1"/> 
-            </void> 
-            <void method="add"> 
-             <object idref="FileSinkOperator2"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="seenOps"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="TableScanOperator1"/> 
-            </void> 
            </object> 
           </void> 
          </object> 
         </void> 
-        <void property="dir"> 
-         <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/584470898/10006</string> 
-        </void> 
-        <void property="listTasks"> 
-         <object idref="ArrayList0"/> 
-        </void> 
-       </object> 
-      </void> 
-      <void property="work"> 
-       <object class="org.apache.hadoop.hive.ql.plan.ConditionalWork"> 
-        <void property="listWorks"> 
+        <void property="neededColumnIDs"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <object idref="moveWork0"/> 
+           <int>0</int> 
           </void> 
           <void method="add"> 
-           <object idref="mapredWork0"/> 
+           <int>1</int> 
+          </void> 
+         </object> 
+        </void> 
+        <void property="schema"> 
+         <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+          <void property="signature"> 
+           <object idref="Vector0"/> 
           </void> 
          </object> 
         </void> 
@@ -2616,101 +2421,10 @@
       </void> 
      </object> 
     </void> 
-    <void method="add"> 
-     <object idref="ConditionalTask1"/> 
-    </void> 
-    <void method="add"> 
-     <object idref="ConditionalTask2"/> 
-    </void> 
-   </object> 
-  </void> 
-  <void property="id"> 
-   <string>Stage-4</string> 
-  </void> 
-  <void property="work"> 
-   <object class="org.apache.hadoop.hive.ql.plan.mapredWork"> 
-    <void property="aliasToPartnInfo"> 
-     <void method="put"> 
-      <string>src</string> 
-      <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
-       <void property="partSpec"> 
-        <object id="LinkedHashMap0" class="java.util.LinkedHashMap"/> 
-       </void> 
-       <void property="tableDesc"> 
-        <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
-         <void property="deserializerClass"> 
-          <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
-         </void> 
-         <void property="inputFileFormatClass"> 
-          <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-         </void> 
-         <void property="outputFileFormatClass"> 
-          <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-         </void> 
-         <void property="properties"> 
-          <object id="Properties0" class="java.util.Properties"> 
-           <void method="put"> 
-            <string>name</string> 
-            <string>src</string> 
-           </void> 
-           <void method="put"> 
-            <string>columns.types</string> 
-            <string>string:string</string> 
-           </void> 
-           <void method="put"> 
-            <string>serialization.ddl</string> 
-            <string>struct src { string key, string value}</string> 
-           </void> 
-           <void method="put"> 
-            <string>serialization.format</string> 
-            <string>1</string> 
-           </void> 
-           <void method="put"> 
-            <string>columns</string> 
-            <string>key,value</string> 
-           </void> 
-           <void method="put"> 
-            <string>bucket_count</string> 
-            <string>-1</string> 
-           </void> 
-           <void method="put"> 
-            <string>serialization.lib</string> 
-            <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-           </void> 
-           <void method="put"> 
-            <string>file.inputformat</string> 
-            <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-           </void> 
-           <void method="put"> 
-            <string>file.outputformat</string> 
-            <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-           </void> 
-           <void method="put"> 
-            <string>location</string> 
-            <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/src</string> 
-           </void> 
-          </object> 
-         </void> 
-         <void property="serdeClassName"> 
-          <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-         </void> 
-        </object> 
-       </void> 
-      </object> 
-     </void> 
-    </void> 
-    <void property="aliasToWork"> 
-     <object class="java.util.LinkedHashMap"> 
-      <void method="put"> 
-       <string>src</string> 
-       <object idref="TableScanOperator1"/> 
-      </void> 
-     </object> 
-    </void> 
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/src</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>src</string> 
@@ -2722,7 +2436,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/src</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/input3.q.xml b/ql/src/test/results/compiler/plan/input3.q.xml
index 9e30cb0b83..dcf455f34d 100755
--- a/ql/src/test/results/compiler/plan/input3.q.xml
+++ b/ql/src/test/results/compiler/plan/input3.q.xml
@@ -8,7 +8,7 @@
       <void property="childTasks"> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
-         <object id="MoveTask0" class="org.apache.hadoop.hive.ql.exec.MoveTask"> 
+         <object class="org.apache.hadoop.hive.ql.exec.MoveTask"> 
           <void property="id"> 
            <string>Stage-1</string> 
           </void> 
@@ -22,7 +22,7 @@
           <void property="work"> 
            <object class="org.apache.hadoop.hive.ql.plan.moveWork"> 
             <void property="loadTableWork"> 
-             <object id="loadTableDesc0" class="org.apache.hadoop.hive.ql.plan.loadTableDesc"> 
+             <object class="org.apache.hadoop.hive.ql.plan.loadTableDesc"> 
               <void property="partitionSpec"> 
                <object class="java.util.HashMap"/> 
               </void> 
@@ -30,7 +30,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1877897368/10000</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/861187745/10000</string> 
               </void> 
               <void property="table"> 
                <object id="tableDesc0" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -83,7 +83,7 @@
                   </void> 
                   <void method="put"> 
                    <string>location</string> 
-                   <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/dest1</string> 
+                   <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/dest1</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -93,7 +93,7 @@
                </object> 
               </void> 
               <void property="tmpDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1877897368/10001</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/861187745/10001</string> 
               </void> 
              </object> 
             </void> 
@@ -121,10 +121,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1177730582/10007</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/382472104/10007</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1877897368/10000</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/861187745/10000</string> 
               </void> 
              </object> 
             </void> 
@@ -142,7 +142,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1177730582/10007</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/382472104/10007</string> 
                <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -338,10 +338,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1177730582/10007</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/382472104/10007</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1177730582/10007</string> 
+                 <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/382472104/10007</string> 
                 </void> 
                </object> 
               </void> 
@@ -350,7 +350,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1177730582/10007</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/382472104/10007</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object idref="tableDesc0"/> 
@@ -368,7 +368,7 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1877897368/10000</string> 
+                     <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/861187745/10000</string> 
                     </void> 
                     <void property="tableInfo"> 
                      <object idref="tableDesc0"/> 
@@ -458,410 +458,295 @@
       </void> 
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
-        <void property="ctx"> 
-         <object id="GenMRProcContext0" class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext"> 
-          <void property="conf"> 
-           <object id="HiveConf0" class="org.apache.hadoop.hive.conf.HiveConf"> 
-            <void property="auxJars"> 
-             <string>file:///data/users/njain/hive3/hive3/build/ql/test/test-udfs.jar</string> 
+        <void property="dir"> 
+         <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/382472104/10007</string> 
+        </void> 
+        <void property="listTasks"> 
+         <object idref="ArrayList0"/> 
+        </void> 
+       </object> 
+      </void> 
+      <void property="work"> 
+       <object class="org.apache.hadoop.hive.ql.plan.ConditionalWork"> 
+        <void property="listWorks"> 
+         <object class="java.util.ArrayList"> 
+          <void method="add"> 
+           <object idref="moveWork0"/> 
+          </void> 
+          <void method="add"> 
+           <object idref="mapredWork0"/> 
+          </void> 
+         </object> 
+        </void> 
+       </object> 
+      </void> 
+     </object> 
+    </void> 
+    <void method="add"> 
+     <object id="ConditionalTask1" class="org.apache.hadoop.hive.ql.exec.ConditionalTask"> 
+      <void property="childTasks"> 
+       <object class="java.util.ArrayList"> 
+        <void method="add"> 
+         <object class="org.apache.hadoop.hive.ql.exec.MoveTask"> 
+          <void property="id"> 
+           <string>Stage-2</string> 
+          </void> 
+          <void property="parentTasks"> 
+           <object class="java.util.ArrayList"> 
+            <void method="add"> 
+             <object idref="ConditionalTask1"/> 
             </void> 
            </object> 
           </void> 
-          <void property="currAliasId"> 
-           <string>src</string> 
+          <void property="work"> 
+           <object class="org.apache.hadoop.hive.ql.plan.moveWork"> 
+            <void property="loadTableWork"> 
+             <object class="org.apache.hadoop.hive.ql.plan.loadTableDesc"> 
+              <void property="partitionSpec"> 
+               <object class="java.util.HashMap"/> 
+              </void> 
+              <void property="replace"> 
+               <boolean>true</boolean> 
+              </void> 
+              <void property="sourceDir"> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/861187745/10002</string> 
+              </void> 
+              <void property="table"> 
+               <object id="tableDesc3" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
+                <void property="deserializerClass"> 
+                 <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
+                </void> 
+                <void property="inputFileFormatClass"> 
+                 <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                </void> 
+                <void property="outputFileFormatClass"> 
+                 <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                </void> 
+                <void property="properties"> 
+                 <object class="java.util.Properties"> 
+                  <void method="put"> 
+                   <string>name</string> 
+                   <string>dest2</string> 
+                  </void> 
+                  <void method="put"> 
+                   <string>columns.types</string> 
+                   <string>string:string</string> 
+                  </void> 
+                  <void method="put"> 
+                   <string>serialization.ddl</string> 
+                   <string>struct dest2 { string key, string value}</string> 
+                  </void> 
+                  <void method="put"> 
+                   <string>serialization.format</string> 
+                   <string>1</string> 
+                  </void> 
+                  <void method="put"> 
+                   <string>columns</string> 
+                   <string>key,value</string> 
+                  </void> 
+                  <void method="put"> 
+                   <string>bucket_count</string> 
+                   <string>-1</string> 
+                  </void> 
+                  <void method="put"> 
+                   <string>serialization.lib</string> 
+                   <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                  </void> 
+                  <void method="put"> 
+                   <string>file.inputformat</string> 
+                   <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+                  </void> 
+                  <void method="put"> 
+                   <string>file.outputformat</string> 
+                   <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+                  </void> 
+                  <void method="put"> 
+                   <string>location</string> 
+                   <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/dest2</string> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="serdeClassName"> 
+                 <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                </void> 
+               </object> 
+              </void> 
+              <void property="tmpDir"> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/861187745/10003</string> 
+              </void> 
+             </object> 
+            </void> 
+           </object> 
           </void> 
-          <void property="currTask"> 
-           <object idref="MapRedTask0"/> 
+         </object> 
+        </void> 
+       </object> 
+      </void> 
+      <void property="id"> 
+       <string>Stage-11</string> 
+      </void> 
+      <void property="listTasks"> 
+       <object id="ArrayList1" class="java.util.ArrayList"> 
+        <void method="add"> 
+         <object class="org.apache.hadoop.hive.ql.exec.MoveTask"> 
+          <void property="id"> 
+           <string>Stage-10</string> 
           </void> 
-          <void property="currTopOp"> 
-           <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+          <void property="work"> 
+           <object id="moveWork1" class="org.apache.hadoop.hive.ql.plan.moveWork"> 
+            <void property="loadFileWork"> 
+             <object class="org.apache.hadoop.hive.ql.plan.loadFileDesc"> 
+              <void property="isDfsDir"> 
+               <boolean>true</boolean> 
+              </void> 
+              <void property="sourceDir"> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/382472104/10008</string> 
+              </void> 
+              <void property="targetDir"> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/861187745/10002</string> 
+              </void> 
+             </object> 
+            </void> 
+           </object> 
+          </void> 
+         </object> 
+        </void> 
+        <void method="add"> 
+         <object class="org.apache.hadoop.hive.ql.exec.MapRedTask"> 
+          <void property="id"> 
+           <string>Stage-9</string> 
+          </void> 
+          <void property="work"> 
+           <object id="mapredWork1" class="org.apache.hadoop.hive.ql.plan.mapredWork"> 
+            <void property="aliasToWork"> 
+             <object class="java.util.LinkedHashMap"> 
+              <void method="put"> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/382472104/10008</string> 
+               <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                    <void property="childOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object id="FileSinkOperator0" class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                        <void property="conf"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
-                          <void property="destTableId"> 
-                           <int>1</int> 
-                          </void> 
-                          <void property="dirName"> 
-                           <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1177730582/10007</string> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
+                    <void property="conf"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.reduceSinkDesc"> 
+                      <void property="keyCols"> 
+                       <object class="java.util.ArrayList"/> 
+                      </void> 
+                      <void property="keySerializeInfo"> 
+                       <object id="tableDesc4" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
+                        <void property="deserializerClass"> 
+                         <class>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</class> 
+                        </void> 
+                        <void property="inputFileFormatClass"> 
+                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                        </void> 
+                        <void property="outputFileFormatClass"> 
+                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                        </void> 
+                        <void property="properties"> 
+                         <object class="java.util.Properties"> 
+                          <void method="put"> 
+                           <string>columns</string> 
+                           <string></string> 
                           </void> 
-                          <void property="tableInfo"> 
-                           <object idref="tableDesc0"/> 
+                          <void method="put"> 
+                           <string>serialization.sort.order</string> 
+                           <string></string> 
                           </void> 
-                         </object> 
-                        </void> 
-                        <void property="parentOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object idref="SelectOperator0"/> 
+                          <void method="put"> 
+                           <string>columns.types</string> 
+                           <string></string> 
                           </void> 
                          </object> 
                         </void> 
-                        <void property="schema"> 
-                         <object idref="RowSchema0"/> 
-                        </void> 
                        </object> 
                       </void> 
-                     </object> 
-                    </void> 
-                    <void property="columnExprMap"> 
-                     <object class="java.util.HashMap"> 
-                      <void method="put"> 
-                       <string>_col1</string> 
-                       <object id="exprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>value</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                       </object> 
+                      <void property="numReducers"> 
+                       <int>-1</int> 
                       </void> 
-                      <void method="put"> 
-                       <string>_col0</string> 
-                       <object id="exprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                       </object> 
+                      <void property="outputKeyColumnNames"> 
+                       <object class="java.util.ArrayList"/> 
                       </void> 
-                     </object> 
-                    </void> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.selectDesc"> 
-                      <void property="colList"> 
+                      <void property="outputValueColumnNames"> 
                        <object class="java.util.ArrayList"> 
                         <void method="add"> 
-                         <object idref="exprNodeColumnDesc1"/> 
+                         <string>_col0</string> 
                         </void> 
                         <void method="add"> 
-                         <object idref="exprNodeColumnDesc0"/> 
+                         <string>_col1</string> 
                         </void> 
                        </object> 
                       </void> 
-                      <void property="outputColumnNames"> 
+                      <void property="partitionCols"> 
                        <object class="java.util.ArrayList"> 
                         <void method="add"> 
-                         <string>_col0</string> 
-                        </void> 
-                        <void method="add"> 
-                         <string>_col1</string> 
+                         <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                          <void property="UDFClass"> 
+                           <class>org.apache.hadoop.hive.ql.udf.UDFRand</class> 
+                          </void> 
+                          <void property="UDFMethod"> 
+                           <object class="org.apache.hadoop.hive.ql.udf.UDFRand" method="getMethod"> 
+                            <string>evaluate</string> 
+                            <array class="java.lang.Class" length="0"/> 
+                           </object> 
+                          </void> 
+                          <void property="childExprs"> 
+                           <object class="java.util.ArrayList"/> 
+                          </void> 
+                          <void property="typeInfo"> 
+                           <object idref="PrimitiveTypeInfo0"/> 
+                          </void> 
+                         </object> 
                         </void> 
                        </object> 
                       </void> 
-                      <void property="selectStar"> 
-                       <boolean>true</boolean> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="FilterOperator0"/> 
+                      <void property="tag"> 
+                       <int>-1</int> 
                       </void> 
-                     </object> 
-                    </void> 
-                    <void property="schema"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                      <void property="signature"> 
-                       <object class="java.util.Vector"> 
+                      <void property="valueCols"> 
+                       <object class="java.util.ArrayList"> 
                         <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col0</string> 
+                         <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                          <void property="column"> 
+                           <string>key</string> 
                           </void> 
-                          <void property="type"> 
+                          <void property="typeInfo"> 
                            <object idref="PrimitiveTypeInfo1"/> 
                           </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col1</string> 
+                         <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                          <void property="column"> 
+                           <string>value</string> 
                           </void> 
-                          <void property="type"> 
+                          <void property="typeInfo"> 
                            <object idref="PrimitiveTypeInfo1"/> 
                           </void> 
                          </object> 
                         </void> 
                        </object> 
                       </void> 
-                     </object> 
-                    </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.filterDesc"> 
-                  <void property="predicate"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                    <void property="UDFClass"> 
-                     <class>org.apache.hadoop.hive.ql.udf.UDFOPLessThan</class> 
-                    </void> 
-                    <void property="UDFMethod"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.UDFOPLessThan" method="getMethod"> 
-                      <string>evaluate</string> 
-                      <array class="java.lang.Class" length="2"> 
-                       <void index="0"> 
-                        <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
-                       </void> 
-                       <void index="1"> 
-                        <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
-                       </void> 
-                      </array> 
-                     </object> 
-                    </void> 
-                    <void property="childExprs"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                        <void property="UDFClass"> 
-                         <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
-                        </void> 
-                        <void property="UDFMethod"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.UDFToDouble" method="getMethod"> 
-                          <string>evaluate</string> 
-                          <array class="java.lang.Class" length="1"> 
-                           <void index="0"> 
-                            <class>org.apache.hadoop.io.Text</class> 
-                           </void> 
-                          </array> 
-                         </object> 
-                        </void> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>key</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                        <void property="UDFClass"> 
-                         <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
-                        </void> 
-                        <void property="UDFMethod"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.UDFToDouble" method="getMethod"> 
-                          <string>evaluate</string> 
-                          <array class="java.lang.Class" length="1"> 
-                           <void index="0"> 
-                            <class>org.apache.hadoop.io.IntWritable</class> 
-                           </void> 
-                          </array> 
-                         </object> 
-                        </void> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                              <void property="typeName"> 
-                               <string>int</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="value"> 
-                             <int>100</int> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
+                      <void property="valueSerializeInfo"> 
+                       <object id="tableDesc5" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
+                        <void property="deserializerClass"> 
+                         <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
                         </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo0"/> 
+                        <void property="inputFileFormatClass"> 
+                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
                         </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object id="PrimitiveTypeInfo3" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                      <void property="typeName"> 
-                       <string>boolean</string> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="parentOperators"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object idref="TableScanOperator1"/> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object id="Vector0" class="java.util.Vector"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>key</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo1"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>value</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo1"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="add"> 
-               <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
-                <void property="childOperators"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                    <void property="childOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object id="FileSinkOperator1" class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                        <void property="conf"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
-                          <void property="destTableId"> 
-                           <int>2</int> 
-                          </void> 
-                          <void property="dirName"> 
-                           <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1177730582/10008</string> 
-                          </void> 
-                          <void property="tableInfo"> 
-                           <object id="tableDesc3" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
-                            <void property="deserializerClass"> 
-                             <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
-                            </void> 
-                            <void property="inputFileFormatClass"> 
-                             <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-                            </void> 
-                            <void property="outputFileFormatClass"> 
-                             <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-                            </void> 
-                            <void property="properties"> 
-                             <object class="java.util.Properties"> 
-                              <void method="put"> 
-                               <string>name</string> 
-                               <string>dest2</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>columns.types</string> 
-                               <string>string:string</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>serialization.ddl</string> 
-                               <string>struct dest2 { string key, string value}</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>serialization.format</string> 
-                               <string>1</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>columns</string> 
-                               <string>key,value</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>bucket_count</string> 
-                               <string>-1</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>serialization.lib</string> 
-                               <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>file.inputformat</string> 
-                               <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>file.outputformat</string> 
-                               <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>location</string> 
-                               <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/dest2</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="serdeClassName"> 
-                             <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
+                        <void property="outputFileFormatClass"> 
+                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
                         </void> 
-                        <void property="parentOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object idref="SelectOperator1"/> 
+                        <void property="properties"> 
+                         <object class="java.util.Properties"> 
+                          <void method="put"> 
+                           <string>columns</string> 
+                           <string>_col0,_col1</string> 
                           </void> 
-                         </object> 
-                        </void> 
-                        <void property="schema"> 
-                         <object id="RowSchema1" class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                          <void property="signature"> 
-                           <object class="java.util.Vector"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>key</string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo1"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>value</string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo1"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
+                          <void method="put"> 
+                           <string>columns.types</string> 
+                           <string>string,string</string> 
                           </void> 
                          </object> 
                         </void> 
@@ -869,71 +754,21 @@
                       </void> 
                      </object> 
                     </void> 
-                    <void property="columnExprMap"> 
-                     <object class="java.util.HashMap"> 
-                      <void method="put"> 
-                       <string>_col1</string> 
-                       <object id="exprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>value</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="put"> 
-                       <string>_col0</string> 
-                       <object id="exprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>key</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.selectDesc"> 
-                      <void property="colList"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object idref="exprNodeColumnDesc3"/> 
-                        </void> 
-                        <void method="add"> 
-                         <object idref="exprNodeColumnDesc2"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="outputColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>_col0</string> 
-                        </void> 
-                        <void method="add"> 
-                         <string>_col1</string> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object idref="FilterOperator1"/> 
+                       <object idref="TableScanOperator1"/> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="schema"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                     <object id="RowSchema1" class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
                       <void property="signature"> 
                        <object class="java.util.Vector"> 
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                           <void property="internalName"> 
-                           <string>_col0</string> 
+                           <string>key</string> 
                           </void> 
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo1"/> 
@@ -943,7 +778,7 @@
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                           <void property="internalName"> 
-                           <string>_col1</string> 
+                           <string>value</string> 
                           </void> 
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo1"/> 
@@ -958,22 +793,1307 @@
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.filterDesc"> 
-                  <void property="predicate"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                    <void property="UDFClass"> 
-                     <class>org.apache.hadoop.hive.ql.udf.UDFOPAnd</class> 
+                <void property="schema"> 
+                 <object idref="RowSchema1"/> 
+                </void> 
+               </object> 
+              </void> 
+             </object> 
+            </void> 
+            <void property="keyDesc"> 
+             <object idref="tableDesc4"/> 
+            </void> 
+            <void property="numReduceTasks"> 
+             <int>-1</int> 
+            </void> 
+            <void property="pathToAliases"> 
+             <object class="java.util.LinkedHashMap"> 
+              <void method="put"> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/382472104/10008</string> 
+               <object class="java.util.ArrayList"> 
+                <void method="add"> 
+                 <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/382472104/10008</string> 
+                </void> 
+               </object> 
+              </void> 
+             </object> 
+            </void> 
+            <void property="pathToPartitionInfo"> 
+             <object class="java.util.LinkedHashMap"> 
+              <void method="put"> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/382472104/10008</string> 
+               <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
+                <void property="tableDesc"> 
+                 <object idref="tableDesc3"/> 
+                </void> 
+               </object> 
+              </void> 
+             </object> 
+            </void> 
+            <void property="reducer"> 
+             <object id="ExtractOperator1" class="org.apache.hadoop.hive.ql.exec.ExtractOperator"> 
+              <void property="childOperators"> 
+               <object class="java.util.ArrayList"> 
+                <void method="add"> 
+                 <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                  <void property="conf"> 
+                   <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
+                    <void property="dirName"> 
+                     <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/861187745/10002</string> 
                     </void> 
-                    <void property="UDFMethod"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.UDFOPAnd" method="getMethod"> 
-                      <string>evaluate</string> 
-                      <array class="java.lang.Class" length="2"> 
+                    <void property="tableInfo"> 
+                     <object idref="tableDesc3"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void property="parentOperators"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object idref="ExtractOperator1"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void property="schema"> 
+                   <object idref="RowSchema1"/> 
+                  </void> 
+                 </object> 
+                </void> 
+               </object> 
+              </void> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.extractDesc"> 
+                <void property="col"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>VALUE</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo1"/> 
+                  </void> 
+                 </object> 
+                </void> 
+               </object> 
+              </void> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
+                 <object class="java.util.Vector"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>0</string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo1"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>1</string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo1"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+               </object> 
+              </void> 
+             </object> 
+            </void> 
+            <void property="tagToValueDesc"> 
+             <object class="java.util.ArrayList"> 
+              <void method="add"> 
+               <object idref="tableDesc5"/> 
+              </void> 
+             </object> 
+            </void> 
+           </object> 
+          </void> 
+         </object> 
+        </void> 
+       </object> 
+      </void> 
+      <void property="parentTasks"> 
+       <object class="java.util.ArrayList"> 
+        <void method="add"> 
+         <object idref="MapRedTask0"/> 
+        </void> 
+       </object> 
+      </void> 
+      <void property="resolver"> 
+       <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles"/> 
+      </void> 
+      <void property="resolverCtx"> 
+       <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
+        <void property="dir"> 
+         <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/382472104/10008</string> 
+        </void> 
+        <void property="listTasks"> 
+         <object idref="ArrayList1"/> 
+        </void> 
+       </object> 
+      </void> 
+      <void property="work"> 
+       <object class="org.apache.hadoop.hive.ql.plan.ConditionalWork"> 
+        <void property="listWorks"> 
+         <object class="java.util.ArrayList"> 
+          <void method="add"> 
+           <object idref="moveWork1"/> 
+          </void> 
+          <void method="add"> 
+           <object idref="mapredWork1"/> 
+          </void> 
+         </object> 
+        </void> 
+       </object> 
+      </void> 
+     </object> 
+    </void> 
+    <void method="add"> 
+     <object id="ConditionalTask2" class="org.apache.hadoop.hive.ql.exec.ConditionalTask"> 
+      <void property="childTasks"> 
+       <object class="java.util.ArrayList"> 
+        <void method="add"> 
+         <object class="org.apache.hadoop.hive.ql.exec.MoveTask"> 
+          <void property="id"> 
+           <string>Stage-3</string> 
+          </void> 
+          <void property="parentTasks"> 
+           <object class="java.util.ArrayList"> 
+            <void method="add"> 
+             <object idref="ConditionalTask2"/> 
+            </void> 
+           </object> 
+          </void> 
+          <void property="work"> 
+           <object class="org.apache.hadoop.hive.ql.plan.moveWork"> 
+            <void property="loadTableWork"> 
+             <object class="org.apache.hadoop.hive.ql.plan.loadTableDesc"> 
+              <void property="partitionSpec"> 
+               <object class="java.util.LinkedHashMap"> 
+                <void method="put"> 
+                 <string>ds</string> 
+                 <string>2008-04-08</string> 
+                </void> 
+                <void method="put"> 
+                 <string>hr</string> 
+                 <string>12</string> 
+                </void> 
+               </object> 
+              </void> 
+              <void property="replace"> 
+               <boolean>true</boolean> 
+              </void> 
+              <void property="sourceDir"> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/861187745/10004</string> 
+              </void> 
+              <void property="table"> 
+               <object id="tableDesc6" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
+                <void property="deserializerClass"> 
+                 <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
+                </void> 
+                <void property="inputFileFormatClass"> 
+                 <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                </void> 
+                <void property="outputFileFormatClass"> 
+                 <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                </void> 
+                <void property="properties"> 
+                 <object class="java.util.Properties"> 
+                  <void method="put"> 
+                   <string>name</string> 
+                   <string>dest3</string> 
+                  </void> 
+                  <void method="put"> 
+                   <string>columns.types</string> 
+                   <string>string:string</string> 
+                  </void> 
+                  <void method="put"> 
+                   <string>serialization.ddl</string> 
+                   <string>struct dest3 { string key, string value}</string> 
+                  </void> 
+                  <void method="put"> 
+                   <string>serialization.format</string> 
+                   <string>1</string> 
+                  </void> 
+                  <void method="put"> 
+                   <string>columns</string> 
+                   <string>key,value</string> 
+                  </void> 
+                  <void method="put"> 
+                   <string>partition_columns</string> 
+                   <string>ds/hr</string> 
+                  </void> 
+                  <void method="put"> 
+                   <string>bucket_count</string> 
+                   <string>-1</string> 
+                  </void> 
+                  <void method="put"> 
+                   <string>serialization.lib</string> 
+                   <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                  </void> 
+                  <void method="put"> 
+                   <string>file.inputformat</string> 
+                   <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+                  </void> 
+                  <void method="put"> 
+                   <string>file.outputformat</string> 
+                   <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+                  </void> 
+                  <void method="put"> 
+                   <string>location</string> 
+                   <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/dest3</string> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="serdeClassName"> 
+                 <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+                </void> 
+               </object> 
+              </void> 
+              <void property="tmpDir"> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/861187745/10005</string> 
+              </void> 
+             </object> 
+            </void> 
+           </object> 
+          </void> 
+         </object> 
+        </void> 
+       </object> 
+      </void> 
+      <void property="id"> 
+       <string>Stage-14</string> 
+      </void> 
+      <void property="listTasks"> 
+       <object id="ArrayList2" class="java.util.ArrayList"> 
+        <void method="add"> 
+         <object class="org.apache.hadoop.hive.ql.exec.MoveTask"> 
+          <void property="id"> 
+           <string>Stage-13</string> 
+          </void> 
+          <void property="work"> 
+           <object id="moveWork2" class="org.apache.hadoop.hive.ql.plan.moveWork"> 
+            <void property="loadFileWork"> 
+             <object class="org.apache.hadoop.hive.ql.plan.loadFileDesc"> 
+              <void property="isDfsDir"> 
+               <boolean>true</boolean> 
+              </void> 
+              <void property="sourceDir"> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/382472104/10009</string> 
+              </void> 
+              <void property="targetDir"> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/861187745/10004</string> 
+              </void> 
+             </object> 
+            </void> 
+           </object> 
+          </void> 
+         </object> 
+        </void> 
+        <void method="add"> 
+         <object class="org.apache.hadoop.hive.ql.exec.MapRedTask"> 
+          <void property="id"> 
+           <string>Stage-12</string> 
+          </void> 
+          <void property="work"> 
+           <object id="mapredWork2" class="org.apache.hadoop.hive.ql.plan.mapredWork"> 
+            <void property="aliasToWork"> 
+             <object class="java.util.LinkedHashMap"> 
+              <void method="put"> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/382472104/10009</string> 
+               <object id="TableScanOperator2" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
+                <void property="childOperators"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
+                    <void property="conf"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.reduceSinkDesc"> 
+                      <void property="keyCols"> 
+                       <object class="java.util.ArrayList"/> 
+                      </void> 
+                      <void property="keySerializeInfo"> 
+                       <object id="tableDesc7" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
+                        <void property="deserializerClass"> 
+                         <class>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</class> 
+                        </void> 
+                        <void property="inputFileFormatClass"> 
+                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                        </void> 
+                        <void property="outputFileFormatClass"> 
+                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                        </void> 
+                        <void property="properties"> 
+                         <object class="java.util.Properties"> 
+                          <void method="put"> 
+                           <string>columns</string> 
+                           <string></string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>serialization.sort.order</string> 
+                           <string></string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>columns.types</string> 
+                           <string></string> 
+                          </void> 
+                         </object> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="numReducers"> 
+                       <int>-1</int> 
+                      </void> 
+                      <void property="outputKeyColumnNames"> 
+                       <object class="java.util.ArrayList"/> 
+                      </void> 
+                      <void property="outputValueColumnNames"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <string>_col0</string> 
+                        </void> 
+                        <void method="add"> 
+                         <string>_col1</string> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="partitionCols"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                          <void property="UDFClass"> 
+                           <class>org.apache.hadoop.hive.ql.udf.UDFRand</class> 
+                          </void> 
+                          <void property="UDFMethod"> 
+                           <object class="org.apache.hadoop.hive.ql.udf.UDFRand" method="getMethod"> 
+                            <string>evaluate</string> 
+                            <array class="java.lang.Class" length="0"/> 
+                           </object> 
+                          </void> 
+                          <void property="childExprs"> 
+                           <object class="java.util.ArrayList"/> 
+                          </void> 
+                          <void property="typeInfo"> 
+                           <object idref="PrimitiveTypeInfo0"/> 
+                          </void> 
+                         </object> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="tag"> 
+                       <int>-1</int> 
+                      </void> 
+                      <void property="valueCols"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                          <void property="column"> 
+                           <string>key</string> 
+                          </void> 
+                          <void property="typeInfo"> 
+                           <object idref="PrimitiveTypeInfo1"/> 
+                          </void> 
+                         </object> 
+                        </void> 
+                        <void method="add"> 
+                         <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                          <void property="column"> 
+                           <string>value</string> 
+                          </void> 
+                          <void property="typeInfo"> 
+                           <object idref="PrimitiveTypeInfo1"/> 
+                          </void> 
+                         </object> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="valueSerializeInfo"> 
+                       <object id="tableDesc8" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
+                        <void property="deserializerClass"> 
+                         <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
+                        </void> 
+                        <void property="inputFileFormatClass"> 
+                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                        </void> 
+                        <void property="outputFileFormatClass"> 
+                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                        </void> 
+                        <void property="properties"> 
+                         <object class="java.util.Properties"> 
+                          <void method="put"> 
+                           <string>columns</string> 
+                           <string>_col0,_col1</string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>columns.types</string> 
+                           <string>string,string</string> 
+                          </void> 
+                         </object> 
+                        </void> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="parentOperators"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object idref="TableScanOperator2"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="schema"> 
+                     <object id="RowSchema2" class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                      <void property="signature"> 
+                       <object class="java.util.Vector"> 
+                        <void method="add"> 
+                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                          <void property="internalName"> 
+                           <string>key</string> 
+                          </void> 
+                          <void property="type"> 
+                           <object idref="PrimitiveTypeInfo1"/> 
+                          </void> 
+                         </object> 
+                        </void> 
+                        <void method="add"> 
+                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                          <void property="internalName"> 
+                           <string>value</string> 
+                          </void> 
+                          <void property="type"> 
+                           <object idref="PrimitiveTypeInfo1"/> 
+                          </void> 
+                         </object> 
+                        </void> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="schema"> 
+                 <object idref="RowSchema2"/> 
+                </void> 
+               </object> 
+              </void> 
+             </object> 
+            </void> 
+            <void property="keyDesc"> 
+             <object idref="tableDesc7"/> 
+            </void> 
+            <void property="numReduceTasks"> 
+             <int>-1</int> 
+            </void> 
+            <void property="pathToAliases"> 
+             <object class="java.util.LinkedHashMap"> 
+              <void method="put"> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/382472104/10009</string> 
+               <object class="java.util.ArrayList"> 
+                <void method="add"> 
+                 <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/382472104/10009</string> 
+                </void> 
+               </object> 
+              </void> 
+             </object> 
+            </void> 
+            <void property="pathToPartitionInfo"> 
+             <object class="java.util.LinkedHashMap"> 
+              <void method="put"> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/382472104/10009</string> 
+               <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
+                <void property="tableDesc"> 
+                 <object idref="tableDesc6"/> 
+                </void> 
+               </object> 
+              </void> 
+             </object> 
+            </void> 
+            <void property="reducer"> 
+             <object id="ExtractOperator2" class="org.apache.hadoop.hive.ql.exec.ExtractOperator"> 
+              <void property="childOperators"> 
+               <object class="java.util.ArrayList"> 
+                <void method="add"> 
+                 <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                  <void property="conf"> 
+                   <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
+                    <void property="dirName"> 
+                     <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/861187745/10004</string> 
+                    </void> 
+                    <void property="tableInfo"> 
+                     <object idref="tableDesc6"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void property="parentOperators"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object idref="ExtractOperator2"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void property="schema"> 
+                   <object idref="RowSchema2"/> 
+                  </void> 
+                 </object> 
+                </void> 
+               </object> 
+              </void> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.extractDesc"> 
+                <void property="col"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>VALUE</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo1"/> 
+                  </void> 
+                 </object> 
+                </void> 
+               </object> 
+              </void> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
+                 <object class="java.util.Vector"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>0</string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo1"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>1</string> 
+                    </void> 
+                    <void property="type"> 
+                     <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                      <void property="typeName"> 
+                       <string>int</string> 
+                      </void> 
+                     </object> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+               </object> 
+              </void> 
+             </object> 
+            </void> 
+            <void property="tagToValueDesc"> 
+             <object class="java.util.ArrayList"> 
+              <void method="add"> 
+               <object idref="tableDesc8"/> 
+              </void> 
+             </object> 
+            </void> 
+           </object> 
+          </void> 
+         </object> 
+        </void> 
+       </object> 
+      </void> 
+      <void property="parentTasks"> 
+       <object class="java.util.ArrayList"> 
+        <void method="add"> 
+         <object idref="MapRedTask0"/> 
+        </void> 
+       </object> 
+      </void> 
+      <void property="resolver"> 
+       <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles"/> 
+      </void> 
+      <void property="resolverCtx"> 
+       <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
+        <void property="dir"> 
+         <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/382472104/10009</string> 
+        </void> 
+        <void property="listTasks"> 
+         <object idref="ArrayList2"/> 
+        </void> 
+       </object> 
+      </void> 
+      <void property="work"> 
+       <object class="org.apache.hadoop.hive.ql.plan.ConditionalWork"> 
+        <void property="listWorks"> 
+         <object class="java.util.ArrayList"> 
+          <void method="add"> 
+           <object idref="moveWork2"/> 
+          </void> 
+          <void method="add"> 
+           <object idref="mapredWork2"/> 
+          </void> 
+         </object> 
+        </void> 
+       </object> 
+      </void> 
+     </object> 
+    </void> 
+    <void method="add"> 
+     <object id="ConditionalTask3" class="org.apache.hadoop.hive.ql.exec.ConditionalTask"> 
+      <void property="childTasks"> 
+       <object class="java.util.ArrayList"> 
+        <void method="add"> 
+         <object class="org.apache.hadoop.hive.ql.exec.MoveTask"> 
+          <void property="id"> 
+           <string>Stage-4</string> 
+          </void> 
+          <void property="parentTasks"> 
+           <object class="java.util.ArrayList"> 
+            <void method="add"> 
+             <object idref="ConditionalTask3"/> 
+            </void> 
+           </object> 
+          </void> 
+          <void property="work"> 
+           <object class="org.apache.hadoop.hive.ql.plan.moveWork"> 
+            <void property="loadFileWork"> 
+             <object class="org.apache.hadoop.hive.ql.plan.loadFileDesc"> 
+              <void property="columnTypes"> 
+               <string>string</string> 
+              </void> 
+              <void property="columns"> 
+               <string>src.value</string> 
+              </void> 
+              <void property="isDfsDir"> 
+               <boolean>true</boolean> 
+              </void> 
+              <void property="sourceDir"> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/861187745/10006</string> 
+              </void> 
+              <void property="targetDir"> 
+               <string>../../../../build/contrib/hive/ql/test/data/warehouse/dest4.out</string> 
+              </void> 
+             </object> 
+            </void> 
+           </object> 
+          </void> 
+         </object> 
+        </void> 
+       </object> 
+      </void> 
+      <void property="id"> 
+       <string>Stage-17</string> 
+      </void> 
+      <void property="listTasks"> 
+       <object id="ArrayList3" class="java.util.ArrayList"> 
+        <void method="add"> 
+         <object class="org.apache.hadoop.hive.ql.exec.MoveTask"> 
+          <void property="id"> 
+           <string>Stage-16</string> 
+          </void> 
+          <void property="work"> 
+           <object id="moveWork3" class="org.apache.hadoop.hive.ql.plan.moveWork"> 
+            <void property="loadFileWork"> 
+             <object class="org.apache.hadoop.hive.ql.plan.loadFileDesc"> 
+              <void property="isDfsDir"> 
+               <boolean>true</boolean> 
+              </void> 
+              <void property="sourceDir"> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/382472104/10010</string> 
+              </void> 
+              <void property="targetDir"> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/861187745/10006</string> 
+              </void> 
+             </object> 
+            </void> 
+           </object> 
+          </void> 
+         </object> 
+        </void> 
+        <void method="add"> 
+         <object class="org.apache.hadoop.hive.ql.exec.MapRedTask"> 
+          <void property="id"> 
+           <string>Stage-15</string> 
+          </void> 
+          <void property="work"> 
+           <object id="mapredWork3" class="org.apache.hadoop.hive.ql.plan.mapredWork"> 
+            <void property="aliasToWork"> 
+             <object class="java.util.LinkedHashMap"> 
+              <void method="put"> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/382472104/10010</string> 
+               <object id="TableScanOperator3" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
+                <void property="childOperators"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
+                    <void property="conf"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.reduceSinkDesc"> 
+                      <void property="keyCols"> 
+                       <object class="java.util.ArrayList"/> 
+                      </void> 
+                      <void property="keySerializeInfo"> 
+                       <object id="tableDesc9" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
+                        <void property="deserializerClass"> 
+                         <class>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</class> 
+                        </void> 
+                        <void property="inputFileFormatClass"> 
+                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                        </void> 
+                        <void property="outputFileFormatClass"> 
+                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                        </void> 
+                        <void property="properties"> 
+                         <object class="java.util.Properties"> 
+                          <void method="put"> 
+                           <string>columns</string> 
+                           <string></string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>serialization.sort.order</string> 
+                           <string></string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>columns.types</string> 
+                           <string></string> 
+                          </void> 
+                         </object> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="numReducers"> 
+                       <int>-1</int> 
+                      </void> 
+                      <void property="outputKeyColumnNames"> 
+                       <object class="java.util.ArrayList"/> 
+                      </void> 
+                      <void property="outputValueColumnNames"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <string>_col0</string> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="partitionCols"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                          <void property="UDFClass"> 
+                           <class>org.apache.hadoop.hive.ql.udf.UDFRand</class> 
+                          </void> 
+                          <void property="UDFMethod"> 
+                           <object class="org.apache.hadoop.hive.ql.udf.UDFRand" method="getMethod"> 
+                            <string>evaluate</string> 
+                            <array class="java.lang.Class" length="0"/> 
+                           </object> 
+                          </void> 
+                          <void property="childExprs"> 
+                           <object class="java.util.ArrayList"/> 
+                          </void> 
+                          <void property="typeInfo"> 
+                           <object idref="PrimitiveTypeInfo0"/> 
+                          </void> 
+                         </object> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="tag"> 
+                       <int>-1</int> 
+                      </void> 
+                      <void property="valueCols"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                          <void property="column"> 
+                           <string>src.value</string> 
+                          </void> 
+                          <void property="typeInfo"> 
+                           <object idref="PrimitiveTypeInfo1"/> 
+                          </void> 
+                         </object> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="valueSerializeInfo"> 
+                       <object id="tableDesc10" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
+                        <void property="deserializerClass"> 
+                         <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
+                        </void> 
+                        <void property="inputFileFormatClass"> 
+                         <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
+                        </void> 
+                        <void property="outputFileFormatClass"> 
+                         <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
+                        </void> 
+                        <void property="properties"> 
+                         <object class="java.util.Properties"> 
+                          <void method="put"> 
+                           <string>columns</string> 
+                           <string>_col0</string> 
+                          </void> 
+                          <void method="put"> 
+                           <string>columns.types</string> 
+                           <string>string</string> 
+                          </void> 
+                         </object> 
+                        </void> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="parentOperators"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object idref="TableScanOperator3"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="schema"> 
+                     <object id="RowSchema3" class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                      <void property="signature"> 
+                       <object class="java.util.Vector"> 
+                        <void method="add"> 
+                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                          <void property="internalName"> 
+                           <string>src.value</string> 
+                          </void> 
+                          <void property="type"> 
+                           <object idref="PrimitiveTypeInfo1"/> 
+                          </void> 
+                         </object> 
+                        </void> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="schema"> 
+                 <object idref="RowSchema3"/> 
+                </void> 
+               </object> 
+              </void> 
+             </object> 
+            </void> 
+            <void property="keyDesc"> 
+             <object idref="tableDesc9"/> 
+            </void> 
+            <void property="numReduceTasks"> 
+             <int>-1</int> 
+            </void> 
+            <void property="pathToAliases"> 
+             <object class="java.util.LinkedHashMap"> 
+              <void method="put"> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/382472104/10010</string> 
+               <object class="java.util.ArrayList"> 
+                <void method="add"> 
+                 <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/382472104/10010</string> 
+                </void> 
+               </object> 
+              </void> 
+             </object> 
+            </void> 
+            <void property="pathToPartitionInfo"> 
+             <object class="java.util.LinkedHashMap"> 
+              <void method="put"> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/382472104/10010</string> 
+               <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
+                <void property="tableDesc"> 
+                 <object id="tableDesc11" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
+                  <void property="deserializerClass"> 
+                   <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
+                  </void> 
+                  <void property="inputFileFormatClass"> 
+                   <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+                  </void> 
+                  <void property="outputFileFormatClass"> 
+                   <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+                  </void> 
+                  <void property="properties"> 
+                   <object class="java.util.Properties"> 
+                    <void method="put"> 
+                     <string>columns</string> 
+                     <string>src.value</string> 
+                    </void> 
+                    <void method="put"> 
+                     <string>serialization.format</string> 
+                     <string>1</string> 
+                    </void> 
+                    <void method="put"> 
+                     <string>columns.types</string> 
+                     <string>string</string> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+               </object> 
+              </void> 
+             </object> 
+            </void> 
+            <void property="reducer"> 
+             <object id="ExtractOperator3" class="org.apache.hadoop.hive.ql.exec.ExtractOperator"> 
+              <void property="childOperators"> 
+               <object class="java.util.ArrayList"> 
+                <void method="add"> 
+                 <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                  <void property="conf"> 
+                   <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
+                    <void property="dirName"> 
+                     <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/861187745/10006</string> 
+                    </void> 
+                    <void property="tableInfo"> 
+                     <object idref="tableDesc11"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void property="parentOperators"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object idref="ExtractOperator3"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void property="schema"> 
+                   <object idref="RowSchema3"/> 
+                  </void> 
+                 </object> 
+                </void> 
+               </object> 
+              </void> 
+              <void property="conf"> 
+               <object class="org.apache.hadoop.hive.ql.plan.extractDesc"> 
+                <void property="col"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                  <void property="column"> 
+                   <string>VALUE</string> 
+                  </void> 
+                  <void property="typeInfo"> 
+                   <object idref="PrimitiveTypeInfo1"/> 
+                  </void> 
+                 </object> 
+                </void> 
+               </object> 
+              </void> 
+              <void property="schema"> 
+               <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                <void property="signature"> 
+                 <object class="java.util.Vector"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                    <void property="internalName"> 
+                     <string>0</string> 
+                    </void> 
+                    <void property="type"> 
+                     <object idref="PrimitiveTypeInfo1"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+               </object> 
+              </void> 
+             </object> 
+            </void> 
+            <void property="tagToValueDesc"> 
+             <object class="java.util.ArrayList"> 
+              <void method="add"> 
+               <object idref="tableDesc10"/> 
+              </void> 
+             </object> 
+            </void> 
+           </object> 
+          </void> 
+         </object> 
+        </void> 
+       </object> 
+      </void> 
+      <void property="parentTasks"> 
+       <object class="java.util.ArrayList"> 
+        <void method="add"> 
+         <object idref="MapRedTask0"/> 
+        </void> 
+       </object> 
+      </void> 
+      <void property="resolver"> 
+       <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles"/> 
+      </void> 
+      <void property="resolverCtx"> 
+       <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
+        <void property="dir"> 
+         <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/382472104/10010</string> 
+        </void> 
+        <void property="listTasks"> 
+         <object idref="ArrayList3"/> 
+        </void> 
+       </object> 
+      </void> 
+      <void property="work"> 
+       <object class="org.apache.hadoop.hive.ql.plan.ConditionalWork"> 
+        <void property="listWorks"> 
+         <object class="java.util.ArrayList"> 
+          <void method="add"> 
+           <object idref="moveWork3"/> 
+          </void> 
+          <void method="add"> 
+           <object idref="mapredWork3"/> 
+          </void> 
+         </object> 
+        </void> 
+       </object> 
+      </void> 
+     </object> 
+    </void> 
+   </object> 
+  </void> 
+  <void property="id"> 
+   <string>Stage-5</string> 
+  </void> 
+  <void property="work"> 
+   <object class="org.apache.hadoop.hive.ql.plan.mapredWork"> 
+    <void property="aliasToPartnInfo"> 
+     <void method="put"> 
+      <string>src</string> 
+      <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
+       <void property="partSpec"> 
+        <object id="LinkedHashMap0" class="java.util.LinkedHashMap"/> 
+       </void> 
+       <void property="tableDesc"> 
+        <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
+         <void property="deserializerClass"> 
+          <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
+         </void> 
+         <void property="inputFileFormatClass"> 
+          <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+         </void> 
+         <void property="outputFileFormatClass"> 
+          <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+         </void> 
+         <void property="properties"> 
+          <object id="Properties0" class="java.util.Properties"> 
+           <void method="put"> 
+            <string>name</string> 
+            <string>src</string> 
+           </void> 
+           <void method="put"> 
+            <string>columns.types</string> 
+            <string>string:string</string> 
+           </void> 
+           <void method="put"> 
+            <string>serialization.ddl</string> 
+            <string>struct src { string key, string value}</string> 
+           </void> 
+           <void method="put"> 
+            <string>serialization.format</string> 
+            <string>1</string> 
+           </void> 
+           <void method="put"> 
+            <string>columns</string> 
+            <string>key,value</string> 
+           </void> 
+           <void method="put"> 
+            <string>bucket_count</string> 
+            <string>-1</string> 
+           </void> 
+           <void method="put"> 
+            <string>serialization.lib</string> 
+            <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+           </void> 
+           <void method="put"> 
+            <string>file.inputformat</string> 
+            <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+           </void> 
+           <void method="put"> 
+            <string>file.outputformat</string> 
+            <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+           </void> 
+           <void method="put"> 
+            <string>location</string> 
+            <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/src</string> 
+           </void> 
+          </object> 
+         </void> 
+         <void property="serdeClassName"> 
+          <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+         </void> 
+        </object> 
+       </void> 
+      </object> 
+     </void> 
+    </void> 
+    <void property="aliasToWork"> 
+     <object class="java.util.LinkedHashMap"> 
+      <void method="put"> 
+       <string>src</string> 
+       <object id="TableScanOperator4" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
+        <void property="childOperators"> 
+         <object class="java.util.ArrayList"> 
+          <void method="add"> 
+           <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+            <void property="childOperators"> 
+             <object class="java.util.ArrayList"> 
+              <void method="add"> 
+               <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+                <void property="childOperators"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                    <void property="conf"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
+                      <void property="destTableId"> 
+                       <int>1</int> 
+                      </void> 
+                      <void property="dirName"> 
+                       <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/382472104/10007</string> 
+                      </void> 
+                      <void property="tableInfo"> 
+                       <object idref="tableDesc0"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="parentOperators"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object idref="SelectOperator0"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="schema"> 
+                     <object idref="RowSchema0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="columnExprMap"> 
+                 <object class="java.util.HashMap"> 
+                  <void method="put"> 
+                   <string>_col1</string> 
+                   <object id="exprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>value</string> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo1"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="put"> 
+                   <string>_col0</string> 
+                   <object id="exprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>key</string> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo1"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="conf"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.selectDesc"> 
+                  <void property="colList"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object idref="exprNodeColumnDesc1"/> 
+                    </void> 
+                    <void method="add"> 
+                     <object idref="exprNodeColumnDesc0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void property="outputColumnNames"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <string>_col0</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col1</string> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void property="selectStar"> 
+                   <boolean>true</boolean> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="parentOperators"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object idref="FilterOperator0"/> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="schema"> 
+                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                  <void property="signature"> 
+                   <object class="java.util.Vector"> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="internalName"> 
+                       <string>_col0</string> 
+                      </void> 
+                      <void property="type"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="internalName"> 
+                       <string>_col1</string> 
+                      </void> 
+                      <void property="type"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+               </object> 
+              </void> 
+             </object> 
+            </void> 
+            <void property="conf"> 
+             <object class="org.apache.hadoop.hive.ql.plan.filterDesc"> 
+              <void property="predicate"> 
+               <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                <void property="UDFClass"> 
+                 <class>org.apache.hadoop.hive.ql.udf.UDFOPLessThan</class> 
+                </void> 
+                <void property="UDFMethod"> 
+                 <object class="org.apache.hadoop.hive.ql.udf.UDFOPLessThan" method="getMethod"> 
+                  <string>evaluate</string> 
+                  <array class="java.lang.Class" length="2"> 
+                   <void index="0"> 
+                    <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
+                   </void> 
+                   <void index="1"> 
+                    <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
+                   </void> 
+                  </array> 
+                 </object> 
+                </void> 
+                <void property="childExprs"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                    <void property="UDFClass"> 
+                     <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
+                    </void> 
+                    <void property="UDFMethod"> 
+                     <object class="org.apache.hadoop.hive.ql.udf.UDFToDouble" method="getMethod"> 
+                      <string>evaluate</string> 
+                      <array class="java.lang.Class" length="1"> 
                        <void index="0"> 
-                        <class>org.apache.hadoop.io.BooleanWritable</class> 
-                       </void> 
-                       <void index="1"> 
-                        <class>org.apache.hadoop.io.BooleanWritable</class> 
+                        <class>org.apache.hadoop.io.Text</class> 
                        </void> 
                       </array> 
                      </object> 
@@ -981,199 +2101,188 @@
                     <void property="childExprs"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                        <void property="UDFClass"> 
-                         <class>org.apache.hadoop.hive.ql.udf.UDFOPEqualOrGreaterThan</class> 
-                        </void> 
-                        <void property="UDFMethod"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.UDFOPEqualOrGreaterThan" method="getMethod"> 
-                          <string>evaluate</string> 
-                          <array class="java.lang.Class" length="2"> 
-                           <void index="0"> 
-                            <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
-                           </void> 
-                           <void index="1"> 
-                            <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
-                           </void> 
-                          </array> 
-                         </object> 
-                        </void> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                            <void property="UDFClass"> 
-                             <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
-                            </void> 
-                            <void property="UDFMethod"> 
-                             <object class="org.apache.hadoop.hive.ql.udf.UDFToDouble" method="getMethod"> 
-                              <string>evaluate</string> 
-                              <array class="java.lang.Class" length="1"> 
-                               <void index="0"> 
-                                <class>org.apache.hadoop.io.Text</class> 
-                               </void> 
-                              </array> 
-                             </object> 
-                            </void> 
-                            <void property="childExprs"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                                <void property="column"> 
-                                 <string>key</string> 
-                                </void> 
-                                <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo1"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                            <void property="UDFClass"> 
-                             <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
-                            </void> 
-                            <void property="UDFMethod"> 
-                             <object class="org.apache.hadoop.hive.ql.udf.UDFToDouble" method="getMethod"> 
-                              <string>evaluate</string> 
-                              <array class="java.lang.Class" length="1"> 
-                               <void index="0"> 
-                                <class>org.apache.hadoop.io.IntWritable</class> 
-                               </void> 
-                              </array> 
-                             </object> 
-                            </void> 
-                            <void property="childExprs"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
-                                <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo2"/> 
-                                </void> 
-                                <void property="value"> 
-                                 <int>100</int> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
+                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                        <void property="column"> 
+                         <string>key</string> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo3"/> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
                        </object> 
                       </void> 
+                     </object> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                    <void property="UDFClass"> 
+                     <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
+                    </void> 
+                    <void property="UDFMethod"> 
+                     <object class="org.apache.hadoop.hive.ql.udf.UDFToDouble" method="getMethod"> 
+                      <string>evaluate</string> 
+                      <array class="java.lang.Class" length="1"> 
+                       <void index="0"> 
+                        <class>org.apache.hadoop.io.IntWritable</class> 
+                       </void> 
+                      </array> 
+                     </object> 
+                    </void> 
+                    <void property="childExprs"> 
+                     <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                        <void property="UDFClass"> 
-                         <class>org.apache.hadoop.hive.ql.udf.UDFOPLessThan</class> 
-                        </void> 
-                        <void property="UDFMethod"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.UDFOPLessThan" method="getMethod"> 
-                          <string>evaluate</string> 
-                          <array class="java.lang.Class" length="2"> 
-                           <void index="0"> 
-                            <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
-                           </void> 
-                           <void index="1"> 
-                            <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
-                           </void> 
-                          </array> 
-                         </object> 
-                        </void> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                            <void property="UDFClass"> 
-                             <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
-                            </void> 
-                            <void property="UDFMethod"> 
-                             <object class="org.apache.hadoop.hive.ql.udf.UDFToDouble" method="getMethod"> 
-                              <string>evaluate</string> 
-                              <array class="java.lang.Class" length="1"> 
-                               <void index="0"> 
-                                <class>org.apache.hadoop.io.Text</class> 
-                               </void> 
-                              </array> 
-                             </object> 
-                            </void> 
-                            <void property="childExprs"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                                <void property="column"> 
-                                 <string>key</string> 
-                                </void> 
-                                <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo1"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                            <void property="UDFClass"> 
-                             <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
-                            </void> 
-                            <void property="UDFMethod"> 
-                             <object class="org.apache.hadoop.hive.ql.udf.UDFToDouble" method="getMethod"> 
-                              <string>evaluate</string> 
-                              <array class="java.lang.Class" length="1"> 
-                               <void index="0"> 
-                                <class>org.apache.hadoop.io.IntWritable</class> 
-                               </void> 
-                              </array> 
-                             </object> 
-                            </void> 
-                            <void property="childExprs"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
-                                <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo2"/> 
-                                </void> 
-                                <void property="value"> 
-                                 <int>200</int> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
+                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo3"/> 
+                         <object idref="PrimitiveTypeInfo2"/> 
+                        </void> 
+                        <void property="value"> 
+                         <int>100</int> 
                         </void> 
                        </object> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo3"/> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="typeInfo"> 
+                 <object id="PrimitiveTypeInfo3" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                  <void property="typeName"> 
+                   <string>boolean</string> 
+                  </void> 
+                 </object> 
+                </void> 
+               </object> 
+              </void> 
+             </object> 
+            </void> 
+            <void property="parentOperators"> 
+             <object class="java.util.ArrayList"> 
+              <void method="add"> 
+               <object idref="TableScanOperator4"/> 
+              </void> 
+             </object> 
+            </void> 
+            <void property="schema"> 
+             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+              <void property="signature"> 
+               <object id="Vector0" class="java.util.Vector"> 
+                <void method="add"> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>key</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo1"/> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void method="add"> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>value</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo1"/> 
+                  </void> 
+                 </object> 
+                </void> 
+               </object> 
+              </void> 
+             </object> 
+            </void> 
+           </object> 
+          </void> 
+          <void method="add"> 
+           <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+            <void property="childOperators"> 
+             <object class="java.util.ArrayList"> 
+              <void method="add"> 
+               <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+                <void property="childOperators"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                    <void property="conf"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
+                      <void property="destTableId"> 
+                       <int>2</int> 
+                      </void> 
+                      <void property="dirName"> 
+                       <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/382472104/10008</string> 
+                      </void> 
+                      <void property="tableInfo"> 
+                       <object idref="tableDesc3"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="parentOperators"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object idref="SelectOperator1"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="schema"> 
+                     <object idref="RowSchema1"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="columnExprMap"> 
+                 <object class="java.util.HashMap"> 
+                  <void method="put"> 
+                   <string>_col1</string> 
+                   <object id="exprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>value</string> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo1"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="put"> 
+                   <string>_col0</string> 
+                   <object id="exprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>key</string> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo1"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="conf"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.selectDesc"> 
+                  <void property="colList"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object idref="exprNodeColumnDesc3"/> 
+                    </void> 
+                    <void method="add"> 
+                     <object idref="exprNodeColumnDesc2"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void property="outputColumnNames"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <string>_col0</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col1</string> 
                     </void> 
                    </object> 
                   </void> 
@@ -1182,247 +2291,173 @@
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object idref="TableScanOperator1"/> 
+                   <object idref="FilterOperator1"/> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="schema"> 
                  <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
                   <void property="signature"> 
-                   <object idref="Vector0"/> 
+                   <object class="java.util.Vector"> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="internalName"> 
+                       <string>_col0</string> 
+                      </void> 
+                      <void property="type"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="internalName"> 
+                       <string>_col1</string> 
+                      </void> 
+                      <void property="type"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                   </object> 
                   </void> 
                  </object> 
                 </void> 
                </object> 
               </void> 
-              <void method="add"> 
-               <object id="FilterOperator2" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
-                <void property="childOperators"> 
+             </object> 
+            </void> 
+            <void property="conf"> 
+             <object class="org.apache.hadoop.hive.ql.plan.filterDesc"> 
+              <void property="predicate"> 
+               <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                <void property="UDFClass"> 
+                 <class>org.apache.hadoop.hive.ql.udf.UDFOPAnd</class> 
+                </void> 
+                <void property="UDFMethod"> 
+                 <object class="org.apache.hadoop.hive.ql.udf.UDFOPAnd" method="getMethod"> 
+                  <string>evaluate</string> 
+                  <array class="java.lang.Class" length="2"> 
+                   <void index="0"> 
+                    <class>org.apache.hadoop.io.BooleanWritable</class> 
+                   </void> 
+                   <void index="1"> 
+                    <class>org.apache.hadoop.io.BooleanWritable</class> 
+                   </void> 
+                  </array> 
+                 </object> 
+                </void> 
+                <void property="childExprs"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object id="SelectOperator2" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                    <void property="childOperators"> 
+                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                    <void property="UDFClass"> 
+                     <class>org.apache.hadoop.hive.ql.udf.UDFOPEqualOrGreaterThan</class> 
+                    </void> 
+                    <void property="UDFMethod"> 
+                     <object class="org.apache.hadoop.hive.ql.udf.UDFOPEqualOrGreaterThan" method="getMethod"> 
+                      <string>evaluate</string> 
+                      <array class="java.lang.Class" length="2"> 
+                       <void index="0"> 
+                        <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
+                       </void> 
+                       <void index="1"> 
+                        <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
+                       </void> 
+                      </array> 
+                     </object> 
+                    </void> 
+                    <void property="childExprs"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object id="FileSinkOperator2" class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                        <void property="conf"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
-                          <void property="destTableId"> 
-                           <int>3</int> 
-                          </void> 
-                          <void property="dirName"> 
-                           <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1177730582/10009</string> 
-                          </void> 
-                          <void property="tableInfo"> 
-                           <object id="tableDesc4" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
-                            <void property="deserializerClass"> 
-                             <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
-                            </void> 
-                            <void property="inputFileFormatClass"> 
-                             <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-                            </void> 
-                            <void property="outputFileFormatClass"> 
-                             <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-                            </void> 
-                            <void property="properties"> 
-                             <object class="java.util.Properties"> 
-                              <void method="put"> 
-                               <string>name</string> 
-                               <string>dest3</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>columns.types</string> 
-                               <string>string:string</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>serialization.ddl</string> 
-                               <string>struct dest3 { string key, string value}</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>serialization.format</string> 
-                               <string>1</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>columns</string> 
-                               <string>key,value</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>partition_columns</string> 
-                               <string>ds/hr</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>bucket_count</string> 
-                               <string>-1</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>serialization.lib</string> 
-                               <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>file.inputformat</string> 
-                               <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>file.outputformat</string> 
-                               <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>location</string> 
-                               <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/dest3</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="serdeClassName"> 
-                             <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-                            </void> 
-                           </object> 
-                          </void> 
+                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                        <void property="UDFClass"> 
+                         <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
+                        </void> 
+                        <void property="UDFMethod"> 
+                         <object class="org.apache.hadoop.hive.ql.udf.UDFToDouble" method="getMethod"> 
+                          <string>evaluate</string> 
+                          <array class="java.lang.Class" length="1"> 
+                           <void index="0"> 
+                            <class>org.apache.hadoop.io.Text</class> 
+                           </void> 
+                          </array> 
                          </object> 
                         </void> 
-                        <void property="parentOperators"> 
+                        <void property="childExprs"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <object idref="SelectOperator2"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="schema"> 
-                         <object id="RowSchema2" class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                          <void property="signature"> 
-                           <object class="java.util.Vector"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>key</string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo1"/> 
-                              </void> 
-                             </object> 
+                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                            <void property="column"> 
+                             <string>key</string> 
                             </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>value</string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo1"/> 
-                              </void> 
-                             </object> 
+                            <void property="typeInfo"> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                            </object> 
                           </void> 
                          </object> 
                         </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="columnExprMap"> 
-                     <object class="java.util.HashMap"> 
-                      <void method="put"> 
-                       <string>_col1</string> 
-                       <object id="exprNodeConstantDesc0" class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo2"/> 
-                        </void> 
-                        <void property="value"> 
-                         <int>2</int> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void method="put"> 
-                       <string>_col0</string> 
-                       <object id="exprNodeColumnDesc4" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>key</string> 
-                        </void> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.selectDesc"> 
-                      <void property="colList"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object idref="exprNodeColumnDesc4"/> 
-                        </void> 
-                        <void method="add"> 
-                         <object idref="exprNodeConstantDesc0"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                      <void property="outputColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>_col0</string> 
-                        </void> 
-                        <void method="add"> 
-                         <string>_col1</string> 
+                         <object idref="PrimitiveTypeInfo0"/> 
                         </void> 
                        </object> 
                       </void> 
-                     </object> 
-                    </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object idref="FilterOperator2"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="schema"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                      <void property="signature"> 
-                       <object class="java.util.Vector"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col0</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo1"/> 
-                          </void> 
+                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                        <void property="UDFClass"> 
+                         <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
+                        </void> 
+                        <void property="UDFMethod"> 
+                         <object class="org.apache.hadoop.hive.ql.udf.UDFToDouble" method="getMethod"> 
+                          <string>evaluate</string> 
+                          <array class="java.lang.Class" length="1"> 
+                           <void index="0"> 
+                            <class>org.apache.hadoop.io.IntWritable</class> 
+                           </void> 
+                          </array> 
                          </object> 
                         </void> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col1</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo2"/> 
+                        <void property="childExprs"> 
+                         <object class="java.util.ArrayList"> 
+                          <void method="add"> 
+                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
+                            <void property="typeInfo"> 
+                             <object idref="PrimitiveTypeInfo2"/> 
+                            </void> 
+                            <void property="value"> 
+                             <int>100</int> 
+                            </void> 
+                           </object> 
                           </void> 
                          </object> 
                         </void> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo0"/> 
+                        </void> 
                        </object> 
                       </void> 
                      </object> 
                     </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo3"/> 
+                    </void> 
                    </object> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.filterDesc"> 
-                  <void property="predicate"> 
+                  <void method="add"> 
                    <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
                     <void property="UDFClass"> 
-                     <class>org.apache.hadoop.hive.ql.udf.UDFOPAnd</class> 
+                     <class>org.apache.hadoop.hive.ql.udf.UDFOPLessThan</class> 
                     </void> 
                     <void property="UDFMethod"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.UDFOPAnd" method="getMethod"> 
+                     <object class="org.apache.hadoop.hive.ql.udf.UDFOPLessThan" method="getMethod"> 
                       <string>evaluate</string> 
                       <array class="java.lang.Class" length="2"> 
                        <void index="0"> 
-                        <class>org.apache.hadoop.io.BooleanWritable</class> 
+                        <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
                        </void> 
                        <void index="1"> 
-                        <class>org.apache.hadoop.io.BooleanWritable</class> 
+                        <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
                        </void> 
                       </array> 
                      </object> 
@@ -1432,17 +2467,14 @@
                       <void method="add"> 
                        <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
                         <void property="UDFClass"> 
-                         <class>org.apache.hadoop.hive.ql.udf.UDFOPEqualOrGreaterThan</class> 
+                         <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
                         </void> 
                         <void property="UDFMethod"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.UDFOPEqualOrGreaterThan" method="getMethod"> 
+                         <object class="org.apache.hadoop.hive.ql.udf.UDFToDouble" method="getMethod"> 
                           <string>evaluate</string> 
-                          <array class="java.lang.Class" length="2"> 
+                          <array class="java.lang.Class" length="1"> 
                            <void index="0"> 
-                            <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
-                           </void> 
-                           <void index="1"> 
-                            <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
+                            <class>org.apache.hadoop.io.Text</class> 
                            </void> 
                           </array> 
                          </object> 
@@ -1450,94 +2482,33 @@
                         <void property="childExprs"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                            <void property="UDFClass"> 
-                             <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
-                            </void> 
-                            <void property="UDFMethod"> 
-                             <object class="org.apache.hadoop.hive.ql.udf.UDFToDouble" method="getMethod"> 
-                              <string>evaluate</string> 
-                              <array class="java.lang.Class" length="1"> 
-                               <void index="0"> 
-                                <class>org.apache.hadoop.io.Text</class> 
-                               </void> 
-                              </array> 
-                             </object> 
-                            </void> 
-                            <void property="childExprs"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                                <void property="column"> 
-                                 <string>key</string> 
-                                </void> 
-                                <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo1"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                            <void property="UDFClass"> 
-                             <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
-                            </void> 
-                            <void property="UDFMethod"> 
-                             <object class="org.apache.hadoop.hive.ql.udf.UDFToDouble" method="getMethod"> 
-                              <string>evaluate</string> 
-                              <array class="java.lang.Class" length="1"> 
-                               <void index="0"> 
-                                <class>org.apache.hadoop.io.IntWritable</class> 
-                               </void> 
-                              </array> 
-                             </object> 
-                            </void> 
-                            <void property="childExprs"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
-                                <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo2"/> 
-                                </void> 
-                                <void property="value"> 
-                                 <int>200</int> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
+                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                            <void property="column"> 
+                             <string>key</string> 
                             </void> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                            </object> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo3"/> 
+                         <object idref="PrimitiveTypeInfo0"/> 
                         </void> 
                        </object> 
                       </void> 
                       <void method="add"> 
                        <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
                         <void property="UDFClass"> 
-                         <class>org.apache.hadoop.hive.ql.udf.UDFOPLessThan</class> 
+                         <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
                         </void> 
                         <void property="UDFMethod"> 
-                         <object class="org.apache.hadoop.hive.ql.udf.UDFOPLessThan" method="getMethod"> 
+                         <object class="org.apache.hadoop.hive.ql.udf.UDFToDouble" method="getMethod"> 
                           <string>evaluate</string> 
-                          <array class="java.lang.Class" length="2"> 
+                          <array class="java.lang.Class" length="1"> 
                            <void index="0"> 
-                            <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
-                           </void> 
-                           <void index="1"> 
-                            <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
+                            <class>org.apache.hadoop.io.IntWritable</class> 
                            </void> 
                           </array> 
                          </object> 
@@ -1545,77 +2516,19 @@
                         <void property="childExprs"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                            <void property="UDFClass"> 
-                             <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
-                            </void> 
-                            <void property="UDFMethod"> 
-                             <object class="org.apache.hadoop.hive.ql.udf.UDFToDouble" method="getMethod"> 
-                              <string>evaluate</string> 
-                              <array class="java.lang.Class" length="1"> 
-                               <void index="0"> 
-                                <class>org.apache.hadoop.io.Text</class> 
-                               </void> 
-                              </array> 
-                             </object> 
-                            </void> 
-                            <void property="childExprs"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                                <void property="column"> 
-                                 <string>key</string> 
-                                </void> 
-                                <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo1"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
+                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                            <void property="UDFClass"> 
-                             <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
-                            </void> 
-                            <void property="UDFMethod"> 
-                             <object class="org.apache.hadoop.hive.ql.udf.UDFToDouble" method="getMethod"> 
-                              <string>evaluate</string> 
-                              <array class="java.lang.Class" length="1"> 
-                               <void index="0"> 
-                                <class>org.apache.hadoop.io.IntWritable</class> 
-                               </void> 
-                              </array> 
-                             </object> 
-                            </void> 
-                            <void property="childExprs"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
-                                <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo2"/> 
-                                </void> 
-                                <void property="value"> 
-                                 <int>300</int> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
+                             <object idref="PrimitiveTypeInfo2"/> 
                             </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
+                            <void property="value"> 
+                             <int>200</int> 
                             </void> 
                            </object> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo3"/> 
+                         <object idref="PrimitiveTypeInfo0"/> 
                         </void> 
                        </object> 
                       </void> 
@@ -1628,155 +2541,144 @@
                   </void> 
                  </object> 
                 </void> 
-                <void property="parentOperators"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object idref="TableScanOperator1"/> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object idref="Vector0"/> 
-                  </void> 
-                 </object> 
+                <void property="typeInfo"> 
+                 <object idref="PrimitiveTypeInfo3"/> 
                 </void> 
                </object> 
               </void> 
+             </object> 
+            </void> 
+            <void property="parentOperators"> 
+             <object class="java.util.ArrayList"> 
+              <void method="add"> 
+               <object idref="TableScanOperator4"/> 
+              </void> 
+             </object> 
+            </void> 
+            <void property="schema"> 
+             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+              <void property="signature"> 
+               <object idref="Vector0"/> 
+              </void> 
+             </object> 
+            </void> 
+           </object> 
+          </void> 
+          <void method="add"> 
+           <object id="FilterOperator2" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+            <void property="childOperators"> 
+             <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <object id="FilterOperator3" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+               <object id="SelectOperator2" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object id="SelectOperator3" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                    <void property="childOperators"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                    <void property="conf"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
+                      <void property="destTableId"> 
+                       <int>3</int> 
+                      </void> 
+                      <void property="dirName"> 
+                       <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/382472104/10009</string> 
+                      </void> 
+                      <void property="tableInfo"> 
+                       <object idref="tableDesc6"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object id="FileSinkOperator3" class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                        <void property="conf"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
-                          <void property="destTableId"> 
-                           <int>4</int> 
-                          </void> 
-                          <void property="dirName"> 
-                           <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1177730582/10010</string> 
-                          </void> 
-                          <void property="tableInfo"> 
-                           <object id="tableDesc5" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
-                            <void property="deserializerClass"> 
-                             <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
-                            </void> 
-                            <void property="inputFileFormatClass"> 
-                             <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-                            </void> 
-                            <void property="outputFileFormatClass"> 
-                             <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-                            </void> 
-                            <void property="properties"> 
-                             <object class="java.util.Properties"> 
-                              <void method="put"> 
-                               <string>columns</string> 
-                               <string>src.value</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>serialization.format</string> 
-                               <string>1</string> 
-                              </void> 
-                              <void method="put"> 
-                               <string>columns.types</string> 
-                               <string>string</string> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="parentOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object idref="SelectOperator3"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="schema"> 
-                         <object id="RowSchema3" class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                          <void property="signature"> 
-                           <object class="java.util.Vector"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>src.value</string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo1"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
+                       <object idref="SelectOperator2"/> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="columnExprMap"> 
-                     <object class="java.util.HashMap"> 
-                      <void method="put"> 
-                       <string>_col0</string> 
-                       <object id="exprNodeColumnDesc5" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                        <void property="column"> 
-                         <string>value</string> 
-                        </void> 
-                        <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo1"/> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
+                    <void property="schema"> 
+                     <object idref="RowSchema2"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="columnExprMap"> 
+                 <object class="java.util.HashMap"> 
+                  <void method="put"> 
+                   <string>_col1</string> 
+                   <object id="exprNodeConstantDesc0" class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo2"/> 
+                    </void> 
+                    <void property="value"> 
+                     <int>2</int> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="put"> 
+                   <string>_col0</string> 
+                   <object id="exprNodeColumnDesc4" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>key</string> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo1"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="conf"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.selectDesc"> 
+                  <void property="colList"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <object idref="exprNodeColumnDesc4"/> 
+                    </void> 
+                    <void method="add"> 
+                     <object idref="exprNodeConstantDesc0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void property="outputColumnNames"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <string>_col0</string> 
+                    </void> 
+                    <void method="add"> 
+                     <string>_col1</string> 
                     </void> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.selectDesc"> 
-                      <void property="colList"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <object idref="exprNodeColumnDesc5"/> 
-                        </void> 
-                       </object> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="parentOperators"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object idref="FilterOperator2"/> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="schema"> 
+                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                  <void property="signature"> 
+                   <object class="java.util.Vector"> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="internalName"> 
+                       <string>_col0</string> 
                       </void> 
-                      <void property="outputColumnNames"> 
-                       <object class="java.util.ArrayList"> 
-                        <void method="add"> 
-                         <string>_col0</string> 
-                        </void> 
-                       </object> 
+                      <void property="type"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="FilterOperator3"/> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="internalName"> 
+                       <string>_col1</string> 
                       </void> 
-                     </object> 
-                    </void> 
-                    <void property="schema"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                      <void property="signature"> 
-                       <object class="java.util.Vector"> 
-                        <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>_col0</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo1"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
+                      <void property="type"> 
+                       <object idref="PrimitiveTypeInfo2"/> 
                       </void> 
                      </object> 
                     </void> 
@@ -1784,9 +2686,33 @@
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.filterDesc"> 
-                  <void property="predicate"> 
+               </object> 
+              </void> 
+             </object> 
+            </void> 
+            <void property="conf"> 
+             <object class="org.apache.hadoop.hive.ql.plan.filterDesc"> 
+              <void property="predicate"> 
+               <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                <void property="UDFClass"> 
+                 <class>org.apache.hadoop.hive.ql.udf.UDFOPAnd</class> 
+                </void> 
+                <void property="UDFMethod"> 
+                 <object class="org.apache.hadoop.hive.ql.udf.UDFOPAnd" method="getMethod"> 
+                  <string>evaluate</string> 
+                  <array class="java.lang.Class" length="2"> 
+                   <void index="0"> 
+                    <class>org.apache.hadoop.io.BooleanWritable</class> 
+                   </void> 
+                   <void index="1"> 
+                    <class>org.apache.hadoop.io.BooleanWritable</class> 
+                   </void> 
+                  </array> 
+                 </object> 
+                </void> 
+                <void property="childExprs"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
                    <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
                     <void property="UDFClass"> 
                      <class>org.apache.hadoop.hive.ql.udf.UDFOPEqualOrGreaterThan</class> 
@@ -1863,7 +2789,7 @@
                              <object idref="PrimitiveTypeInfo2"/> 
                             </void> 
                             <void property="value"> 
-                             <int>300</int> 
+                             <int>200</int> 
                             </void> 
                            </object> 
                           </void> 
@@ -1881,1523 +2807,356 @@
                     </void> 
                    </object> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="parentOperators"> 
-                 <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object idref="TableScanOperator1"/> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object idref="Vector0"/> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="neededColumnIDs"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <int>0</int> 
-              </void> 
-              <void method="add"> 
-               <int>1</int> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object idref="Vector0"/> 
-              </void> 
-             </object> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="mapCurrCtx"> 
-           <object class="java.util.LinkedHashMap"> 
-            <void method="put"> 
-             <object idref="TableScanOperator1"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-            <void method="put"> 
-             <object idref="FilterOperator0"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-            <void method="put"> 
-             <object idref="SelectOperator0"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-            <void method="put"> 
-             <object idref="FilterOperator1"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-            <void method="put"> 
-             <object idref="SelectOperator1"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-            <void method="put"> 
-             <object idref="FilterOperator2"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-            <void method="put"> 
-             <object idref="SelectOperator2"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-            <void method="put"> 
-             <object idref="FilterOperator3"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-            <void method="put"> 
-             <object idref="SelectOperator3"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="mvTask"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="MoveTask0"/> 
-            </void> 
-            <void method="add"> 
-             <object id="MoveTask1" class="org.apache.hadoop.hive.ql.exec.MoveTask"> 
-              <void property="id"> 
-               <string>Stage-2</string> 
-              </void> 
-              <void property="parentTasks"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object id="ConditionalTask1" class="org.apache.hadoop.hive.ql.exec.ConditionalTask"> 
-                  <void property="childTasks"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="MoveTask1"/> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void property="id"> 
-                   <string>Stage-11</string> 
-                  </void> 
-                  <void property="listTasks"> 
-                   <object id="ArrayList1" class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.MoveTask"> 
-                      <void property="id"> 
-                       <string>Stage-10</string> 
-                      </void> 
-                      <void property="work"> 
-                       <object id="moveWork1" class="org.apache.hadoop.hive.ql.plan.moveWork"> 
-                        <void property="loadFileWork"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.loadFileDesc"> 
-                          <void property="isDfsDir"> 
-                           <boolean>true</boolean> 
-                          </void> 
-                          <void property="sourceDir"> 
-                           <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1177730582/10008</string> 
-                          </void> 
-                          <void property="targetDir"> 
-                           <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1877897368/10002</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.MapRedTask"> 
-                      <void property="id"> 
-                       <string>Stage-9</string> 
-                      </void> 
-                      <void property="work"> 
-                       <object id="mapredWork1" class="org.apache.hadoop.hive.ql.plan.mapredWork"> 
-                        <void property="aliasToWork"> 
-                         <object class="java.util.LinkedHashMap"> 
-                          <void method="put"> 
-                           <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1177730582/10008</string> 
-                           <object id="TableScanOperator2" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
-                            <void property="childOperators"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
-                                <void property="conf"> 
-                                 <object class="org.apache.hadoop.hive.ql.plan.reduceSinkDesc"> 
-                                  <void property="keyCols"> 
-                                   <object class="java.util.ArrayList"/> 
-                                  </void> 
-                                  <void property="keySerializeInfo"> 
-                                   <object id="tableDesc6" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
-                                    <void property="deserializerClass"> 
-                                     <class>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</class> 
-                                    </void> 
-                                    <void property="inputFileFormatClass"> 
-                                     <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                                    </void> 
-                                    <void property="outputFileFormatClass"> 
-                                     <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                                    </void> 
-                                    <void property="properties"> 
-                                     <object class="java.util.Properties"> 
-                                      <void method="put"> 
-                                       <string>columns</string> 
-                                       <string></string> 
-                                      </void> 
-                                      <void method="put"> 
-                                       <string>serialization.sort.order</string> 
-                                       <string></string> 
-                                      </void> 
-                                      <void method="put"> 
-                                       <string>columns.types</string> 
-                                       <string></string> 
-                                      </void> 
-                                     </object> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                  <void property="numReducers"> 
-                                   <int>-1</int> 
-                                  </void> 
-                                  <void property="outputKeyColumnNames"> 
-                                   <object class="java.util.ArrayList"/> 
-                                  </void> 
-                                  <void property="outputValueColumnNames"> 
-                                   <object class="java.util.ArrayList"> 
-                                    <void method="add"> 
-                                     <string>_col0</string> 
-                                    </void> 
-                                    <void method="add"> 
-                                     <string>_col1</string> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                  <void property="partitionCols"> 
-                                   <object class="java.util.ArrayList"> 
-                                    <void method="add"> 
-                                     <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                                      <void property="UDFClass"> 
-                                       <class>org.apache.hadoop.hive.ql.udf.UDFRand</class> 
-                                      </void> 
-                                      <void property="UDFMethod"> 
-                                       <object class="org.apache.hadoop.hive.ql.udf.UDFRand" method="getMethod"> 
-                                        <string>evaluate</string> 
-                                        <array class="java.lang.Class" length="0"/> 
-                                       </object> 
-                                      </void> 
-                                      <void property="childExprs"> 
-                                       <object class="java.util.ArrayList"/> 
-                                      </void> 
-                                      <void property="typeInfo"> 
-                                       <object idref="PrimitiveTypeInfo0"/> 
-                                      </void> 
-                                     </object> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                  <void property="tag"> 
-                                   <int>-1</int> 
-                                  </void> 
-                                  <void property="valueCols"> 
-                                   <object class="java.util.ArrayList"> 
-                                    <void method="add"> 
-                                     <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                                      <void property="column"> 
-                                       <string>key</string> 
-                                      </void> 
-                                      <void property="typeInfo"> 
-                                       <object idref="PrimitiveTypeInfo1"/> 
-                                      </void> 
-                                     </object> 
-                                    </void> 
-                                    <void method="add"> 
-                                     <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                                      <void property="column"> 
-                                       <string>value</string> 
-                                      </void> 
-                                      <void property="typeInfo"> 
-                                       <object idref="PrimitiveTypeInfo1"/> 
-                                      </void> 
-                                     </object> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                  <void property="valueSerializeInfo"> 
-                                   <object id="tableDesc7" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
-                                    <void property="deserializerClass"> 
-                                     <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
-                                    </void> 
-                                    <void property="inputFileFormatClass"> 
-                                     <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                                    </void> 
-                                    <void property="outputFileFormatClass"> 
-                                     <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                                    </void> 
-                                    <void property="properties"> 
-                                     <object class="java.util.Properties"> 
-                                      <void method="put"> 
-                                       <string>columns</string> 
-                                       <string>_col0,_col1</string> 
-                                      </void> 
-                                      <void method="put"> 
-                                       <string>columns.types</string> 
-                                       <string>string,string</string> 
-                                      </void> 
-                                     </object> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void property="parentOperators"> 
-                                 <object class="java.util.ArrayList"> 
-                                  <void method="add"> 
-                                   <object idref="TableScanOperator2"/> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void property="schema"> 
-                                 <object idref="RowSchema1"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="schema"> 
-                             <object idref="RowSchema1"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="keyDesc"> 
-                         <object idref="tableDesc6"/> 
-                        </void> 
-                        <void property="numReduceTasks"> 
-                         <int>-1</int> 
-                        </void> 
-                        <void property="pathToAliases"> 
-                         <object class="java.util.LinkedHashMap"> 
-                          <void method="put"> 
-                           <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1177730582/10008</string> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1177730582/10008</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="pathToPartitionInfo"> 
-                         <object class="java.util.LinkedHashMap"> 
-                          <void method="put"> 
-                           <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1177730582/10008</string> 
-                           <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
-                            <void property="tableDesc"> 
-                             <object idref="tableDesc3"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="reducer"> 
-                         <object id="ExtractOperator1" class="org.apache.hadoop.hive.ql.exec.ExtractOperator"> 
-                          <void property="childOperators"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                              <void property="conf"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
-                                <void property="dirName"> 
-                                 <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1877897368/10002</string> 
-                                </void> 
-                                <void property="tableInfo"> 
-                                 <object idref="tableDesc3"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void property="parentOperators"> 
-                               <object class="java.util.ArrayList"> 
-                                <void method="add"> 
-                                 <object idref="ExtractOperator1"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void property="schema"> 
-                               <object idref="RowSchema1"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="conf"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.extractDesc"> 
-                            <void property="col"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                              <void property="column"> 
-                               <string>VALUE</string> 
-                              </void> 
-                              <void property="typeInfo"> 
-                               <object idref="PrimitiveTypeInfo1"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="schema"> 
-                           <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                            <void property="signature"> 
-                             <object class="java.util.Vector"> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                <void property="internalName"> 
-                                 <string>0</string> 
-                                </void> 
-                                <void property="type"> 
-                                 <object idref="PrimitiveTypeInfo1"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                <void property="internalName"> 
-                                 <string>1</string> 
-                                </void> 
-                                <void property="type"> 
-                                 <object idref="PrimitiveTypeInfo1"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="tagToValueDesc"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object idref="tableDesc7"/> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void property="parentTasks"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="MapRedTask0"/> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void property="resolver"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles"/> 
-                  </void> 
-                  <void property="resolverCtx"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
-                    <void property="ctx"> 
-                     <object idref="GenMRProcContext0"/> 
-                    </void> 
-                    <void property="dir"> 
-                     <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1177730582/10008</string> 
-                    </void> 
-                    <void property="listTasks"> 
-                     <object idref="ArrayList1"/> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void property="work"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ConditionalWork"> 
-                    <void property="listWorks"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="moveWork1"/> 
-                      </void> 
-                      <void method="add"> 
-                       <object idref="mapredWork1"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-              <void property="work"> 
-               <object class="org.apache.hadoop.hive.ql.plan.moveWork"> 
-                <void property="loadTableWork"> 
-                 <object id="loadTableDesc1" class="org.apache.hadoop.hive.ql.plan.loadTableDesc"> 
-                  <void property="partitionSpec"> 
-                   <object class="java.util.HashMap"/> 
-                  </void> 
-                  <void property="replace"> 
-                   <boolean>true</boolean> 
-                  </void> 
-                  <void property="sourceDir"> 
-                   <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1877897368/10002</string> 
-                  </void> 
-                  <void property="table"> 
-                   <object idref="tableDesc3"/> 
-                  </void> 
-                  <void property="tmpDir"> 
-                   <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1877897368/10003</string> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void method="add"> 
-             <object id="MoveTask2" class="org.apache.hadoop.hive.ql.exec.MoveTask"> 
-              <void property="id"> 
-               <string>Stage-3</string> 
-              </void> 
-              <void property="parentTasks"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object id="ConditionalTask2" class="org.apache.hadoop.hive.ql.exec.ConditionalTask"> 
-                  <void property="childTasks"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="MoveTask2"/> 
+                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                    <void property="UDFClass"> 
+                     <class>org.apache.hadoop.hive.ql.udf.UDFOPLessThan</class> 
                     </void> 
-                   </object> 
-                  </void> 
-                  <void property="id"> 
-                   <string>Stage-14</string> 
-                  </void> 
-                  <void property="listTasks"> 
-                   <object id="ArrayList2" class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.MoveTask"> 
-                      <void property="id"> 
-                       <string>Stage-13</string> 
-                      </void> 
-                      <void property="work"> 
-                       <object id="moveWork2" class="org.apache.hadoop.hive.ql.plan.moveWork"> 
-                        <void property="loadFileWork"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.loadFileDesc"> 
-                          <void property="isDfsDir"> 
-                           <boolean>true</boolean> 
-                          </void> 
-                          <void property="sourceDir"> 
-                           <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1177730582/10009</string> 
-                          </void> 
-                          <void property="targetDir"> 
-                           <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1877897368/10004</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
-                      </void> 
+                    <void property="UDFMethod"> 
+                     <object class="org.apache.hadoop.hive.ql.udf.UDFOPLessThan" method="getMethod"> 
+                      <string>evaluate</string> 
+                      <array class="java.lang.Class" length="2"> 
+                       <void index="0"> 
+                        <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
+                       </void> 
+                       <void index="1"> 
+                        <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
+                       </void> 
+                      </array> 
                      </object> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.MapRedTask"> 
-                      <void property="id"> 
-                       <string>Stage-12</string> 
-                      </void> 
-                      <void property="work"> 
-                       <object id="mapredWork2" class="org.apache.hadoop.hive.ql.plan.mapredWork"> 
-                        <void property="aliasToWork"> 
-                         <object class="java.util.LinkedHashMap"> 
-                          <void method="put"> 
-                           <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1177730582/10009</string> 
-                           <object id="TableScanOperator3" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
-                            <void property="childOperators"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
-                                <void property="conf"> 
-                                 <object class="org.apache.hadoop.hive.ql.plan.reduceSinkDesc"> 
-                                  <void property="keyCols"> 
-                                   <object class="java.util.ArrayList"/> 
-                                  </void> 
-                                  <void property="keySerializeInfo"> 
-                                   <object id="tableDesc8" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
-                                    <void property="deserializerClass"> 
-                                     <class>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</class> 
-                                    </void> 
-                                    <void property="inputFileFormatClass"> 
-                                     <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                                    </void> 
-                                    <void property="outputFileFormatClass"> 
-                                     <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                                    </void> 
-                                    <void property="properties"> 
-                                     <object class="java.util.Properties"> 
-                                      <void method="put"> 
-                                       <string>columns</string> 
-                                       <string></string> 
-                                      </void> 
-                                      <void method="put"> 
-                                       <string>serialization.sort.order</string> 
-                                       <string></string> 
-                                      </void> 
-                                      <void method="put"> 
-                                       <string>columns.types</string> 
-                                       <string></string> 
-                                      </void> 
-                                     </object> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                  <void property="numReducers"> 
-                                   <int>-1</int> 
-                                  </void> 
-                                  <void property="outputKeyColumnNames"> 
-                                   <object class="java.util.ArrayList"/> 
-                                  </void> 
-                                  <void property="outputValueColumnNames"> 
-                                   <object class="java.util.ArrayList"> 
-                                    <void method="add"> 
-                                     <string>_col0</string> 
-                                    </void> 
-                                    <void method="add"> 
-                                     <string>_col1</string> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                  <void property="partitionCols"> 
-                                   <object class="java.util.ArrayList"> 
-                                    <void method="add"> 
-                                     <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                                      <void property="UDFClass"> 
-                                       <class>org.apache.hadoop.hive.ql.udf.UDFRand</class> 
-                                      </void> 
-                                      <void property="UDFMethod"> 
-                                       <object class="org.apache.hadoop.hive.ql.udf.UDFRand" method="getMethod"> 
-                                        <string>evaluate</string> 
-                                        <array class="java.lang.Class" length="0"/> 
-                                       </object> 
-                                      </void> 
-                                      <void property="childExprs"> 
-                                       <object class="java.util.ArrayList"/> 
-                                      </void> 
-                                      <void property="typeInfo"> 
-                                       <object idref="PrimitiveTypeInfo0"/> 
-                                      </void> 
-                                     </object> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                  <void property="tag"> 
-                                   <int>-1</int> 
-                                  </void> 
-                                  <void property="valueCols"> 
-                                   <object class="java.util.ArrayList"> 
-                                    <void method="add"> 
-                                     <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                                      <void property="column"> 
-                                       <string>key</string> 
-                                      </void> 
-                                      <void property="typeInfo"> 
-                                       <object idref="PrimitiveTypeInfo1"/> 
-                                      </void> 
-                                     </object> 
-                                    </void> 
-                                    <void method="add"> 
-                                     <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                                      <void property="column"> 
-                                       <string>value</string> 
-                                      </void> 
-                                      <void property="typeInfo"> 
-                                       <object idref="PrimitiveTypeInfo1"/> 
-                                      </void> 
-                                     </object> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                  <void property="valueSerializeInfo"> 
-                                   <object id="tableDesc9" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
-                                    <void property="deserializerClass"> 
-                                     <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
-                                    </void> 
-                                    <void property="inputFileFormatClass"> 
-                                     <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                                    </void> 
-                                    <void property="outputFileFormatClass"> 
-                                     <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                                    </void> 
-                                    <void property="properties"> 
-                                     <object class="java.util.Properties"> 
-                                      <void method="put"> 
-                                       <string>columns</string> 
-                                       <string>_col0,_col1</string> 
-                                      </void> 
-                                      <void method="put"> 
-                                       <string>columns.types</string> 
-                                       <string>string,string</string> 
-                                      </void> 
-                                     </object> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void property="parentOperators"> 
-                                 <object class="java.util.ArrayList"> 
-                                  <void method="add"> 
-                                   <object idref="TableScanOperator3"/> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void property="schema"> 
-                                 <object idref="RowSchema2"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
+                    <void property="childExprs"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                        <void property="UDFClass"> 
+                         <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
+                        </void> 
+                        <void property="UDFMethod"> 
+                         <object class="org.apache.hadoop.hive.ql.udf.UDFToDouble" method="getMethod"> 
+                          <string>evaluate</string> 
+                          <array class="java.lang.Class" length="1"> 
+                           <void index="0"> 
+                            <class>org.apache.hadoop.io.Text</class> 
+                           </void> 
+                          </array> 
+                         </object> 
+                        </void> 
+                        <void property="childExprs"> 
+                         <object class="java.util.ArrayList"> 
+                          <void method="add"> 
+                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                            <void property="column"> 
+                             <string>key</string> 
                             </void> 
-                            <void property="schema"> 
-                             <object idref="RowSchema2"/> 
+                            <void property="typeInfo"> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                            </object> 
                           </void> 
                          </object> 
                         </void> 
-                        <void property="keyDesc"> 
-                         <object idref="tableDesc8"/> 
-                        </void> 
-                        <void property="numReduceTasks"> 
-                         <int>-1</int> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo0"/> 
                         </void> 
-                        <void property="pathToAliases"> 
-                         <object class="java.util.LinkedHashMap"> 
-                          <void method="put"> 
-                           <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1177730582/10009</string> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1177730582/10009</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
+                       </object> 
+                      </void> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                        <void property="UDFClass"> 
+                         <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
                         </void> 
-                        <void property="pathToPartitionInfo"> 
-                         <object class="java.util.LinkedHashMap"> 
-                          <void method="put"> 
-                           <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1177730582/10009</string> 
-                           <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
-                            <void property="tableDesc"> 
-                             <object idref="tableDesc4"/> 
-                            </void> 
-                           </object> 
-                          </void> 
+                        <void property="UDFMethod"> 
+                         <object class="org.apache.hadoop.hive.ql.udf.UDFToDouble" method="getMethod"> 
+                          <string>evaluate</string> 
+                          <array class="java.lang.Class" length="1"> 
+                           <void index="0"> 
+                            <class>org.apache.hadoop.io.IntWritable</class> 
+                           </void> 
+                          </array> 
                          </object> 
                         </void> 
-                        <void property="reducer"> 
-                         <object id="ExtractOperator2" class="org.apache.hadoop.hive.ql.exec.ExtractOperator"> 
-                          <void property="childOperators"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                              <void property="conf"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
-                                <void property="dirName"> 
-                                 <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1877897368/10004</string> 
-                                </void> 
-                                <void property="tableInfo"> 
-                                 <object idref="tableDesc4"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void property="parentOperators"> 
-                               <object class="java.util.ArrayList"> 
-                                <void method="add"> 
-                                 <object idref="ExtractOperator2"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void property="schema"> 
-                               <object idref="RowSchema2"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="conf"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.extractDesc"> 
-                            <void property="col"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                              <void property="column"> 
-                               <string>VALUE</string> 
-                              </void> 
-                              <void property="typeInfo"> 
-                               <object idref="PrimitiveTypeInfo1"/> 
-                              </void> 
-                             </object> 
+                        <void property="childExprs"> 
+                         <object class="java.util.ArrayList"> 
+                          <void method="add"> 
+                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
+                            <void property="typeInfo"> 
+                             <object idref="PrimitiveTypeInfo2"/> 
                             </void> 
-                           </object> 
-                          </void> 
-                          <void property="schema"> 
-                           <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                            <void property="signature"> 
-                             <object class="java.util.Vector"> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                <void property="internalName"> 
-                                 <string>0</string> 
-                                </void> 
-                                <void property="type"> 
-                                 <object idref="PrimitiveTypeInfo1"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                <void property="internalName"> 
-                                 <string>1</string> 
-                                </void> 
-                                <void property="type"> 
-                                 <object idref="PrimitiveTypeInfo2"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
+                            <void property="value"> 
+                             <int>300</int> 
                             </void> 
                            </object> 
                           </void> 
                          </object> 
                         </void> 
-                        <void property="tagToValueDesc"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object idref="tableDesc9"/> 
-                          </void> 
-                         </object> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo0"/> 
                         </void> 
                        </object> 
                       </void> 
                      </object> 
                     </void> 
-                   </object> 
-                  </void> 
-                  <void property="parentTasks"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="MapRedTask0"/> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo3"/> 
                     </void> 
                    </object> 
                   </void> 
-                  <void property="resolver"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles"/> 
-                  </void> 
-                  <void property="resolverCtx"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
-                    <void property="ctx"> 
-                     <object idref="GenMRProcContext0"/> 
-                    </void> 
-                    <void property="dir"> 
-                     <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1177730582/10009</string> 
-                    </void> 
-                    <void property="listTasks"> 
-                     <object idref="ArrayList2"/> 
+                 </object> 
+                </void> 
+                <void property="typeInfo"> 
+                 <object idref="PrimitiveTypeInfo3"/> 
+                </void> 
+               </object> 
+              </void> 
+             </object> 
+            </void> 
+            <void property="parentOperators"> 
+             <object class="java.util.ArrayList"> 
+              <void method="add"> 
+               <object idref="TableScanOperator4"/> 
+              </void> 
+             </object> 
+            </void> 
+            <void property="schema"> 
+             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+              <void property="signature"> 
+               <object idref="Vector0"/> 
+              </void> 
+             </object> 
+            </void> 
+           </object> 
+          </void> 
+          <void method="add"> 
+           <object id="FilterOperator3" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+            <void property="childOperators"> 
+             <object class="java.util.ArrayList"> 
+              <void method="add"> 
+               <object id="SelectOperator3" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+                <void property="childOperators"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                    <void property="conf"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
+                      <void property="destTableId"> 
+                       <int>4</int> 
+                      </void> 
+                      <void property="dirName"> 
+                       <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/382472104/10010</string> 
+                      </void> 
+                      <void property="tableInfo"> 
+                       <object idref="tableDesc11"/> 
+                      </void> 
+                     </object> 
                     </void> 
-                   </object> 
-                  </void> 
-                  <void property="work"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ConditionalWork"> 
-                    <void property="listWorks"> 
+                    <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object idref="moveWork2"/> 
-                      </void> 
-                      <void method="add"> 
-                       <object idref="mapredWork2"/> 
+                       <object idref="SelectOperator3"/> 
                       </void> 
                      </object> 
                     </void> 
+                    <void property="schema"> 
+                     <object idref="RowSchema3"/> 
+                    </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-               </object> 
-              </void> 
-              <void property="work"> 
-               <object class="org.apache.hadoop.hive.ql.plan.moveWork"> 
-                <void property="loadTableWork"> 
-                 <object id="loadTableDesc2" class="org.apache.hadoop.hive.ql.plan.loadTableDesc"> 
-                  <void property="partitionSpec"> 
-                   <object class="java.util.LinkedHashMap"> 
-                    <void method="put"> 
-                     <string>ds</string> 
-                     <string>2008-04-08</string> 
+                <void property="columnExprMap"> 
+                 <object class="java.util.HashMap"> 
+                  <void method="put"> 
+                   <string>_col0</string> 
+                   <object id="exprNodeColumnDesc5" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>value</string> 
                     </void> 
-                    <void method="put"> 
-                     <string>hr</string> 
-                     <string>12</string> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo1"/> 
                     </void> 
                    </object> 
                   </void> 
-                  <void property="replace"> 
-                   <boolean>true</boolean> 
-                  </void> 
-                  <void property="sourceDir"> 
-                   <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1877897368/10004</string> 
-                  </void> 
-                  <void property="table"> 
-                   <object idref="tableDesc4"/> 
-                  </void> 
-                  <void property="tmpDir"> 
-                   <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1877897368/10005</string> 
-                  </void> 
                  </object> 
                 </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void method="add"> 
-             <object id="MoveTask3" class="org.apache.hadoop.hive.ql.exec.MoveTask"> 
-              <void property="id"> 
-               <string>Stage-4</string> 
-              </void> 
-              <void property="parentTasks"> 
-               <object class="java.util.ArrayList"> 
-                <void method="add"> 
-                 <object id="ConditionalTask3" class="org.apache.hadoop.hive.ql.exec.ConditionalTask"> 
-                  <void property="childTasks"> 
+                <void property="conf"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.selectDesc"> 
+                  <void property="colList"> 
                    <object class="java.util.ArrayList"> 
                     <void method="add"> 
-                     <object idref="MoveTask3"/> 
+                     <object idref="exprNodeColumnDesc5"/> 
                     </void> 
                    </object> 
                   </void> 
-                  <void property="id"> 
-                   <string>Stage-17</string> 
+                  <void property="outputColumnNames"> 
+                   <object class="java.util.ArrayList"> 
+                    <void method="add"> 
+                     <string>_col0</string> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="parentOperators"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object idref="FilterOperator3"/> 
                   </void> 
-                  <void property="listTasks"> 
-                   <object id="ArrayList3" class="java.util.ArrayList"> 
+                 </object> 
+                </void> 
+                <void property="schema"> 
+                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                  <void property="signature"> 
+                   <object class="java.util.Vector"> 
                     <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.MoveTask"> 
-                      <void property="id"> 
-                       <string>Stage-16</string> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="internalName"> 
+                       <string>_col0</string> 
                       </void> 
-                      <void property="work"> 
-                       <object id="moveWork3" class="org.apache.hadoop.hive.ql.plan.moveWork"> 
-                        <void property="loadFileWork"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.loadFileDesc"> 
-                          <void property="isDfsDir"> 
-                           <boolean>true</boolean> 
-                          </void> 
-                          <void property="sourceDir"> 
-                           <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1177730582/10010</string> 
-                          </void> 
-                          <void property="targetDir"> 
-                           <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1877897368/10006</string> 
-                          </void> 
-                         </object> 
-                        </void> 
-                       </object> 
+                      <void property="type"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
                       </void> 
                      </object> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.MapRedTask"> 
-                      <void property="id"> 
-                       <string>Stage-15</string> 
-                      </void> 
-                      <void property="work"> 
-                       <object id="mapredWork3" class="org.apache.hadoop.hive.ql.plan.mapredWork"> 
-                        <void property="aliasToWork"> 
-                         <object class="java.util.LinkedHashMap"> 
-                          <void method="put"> 
-                           <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1177730582/10010</string> 
-                           <object id="TableScanOperator4" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
-                            <void property="childOperators"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.exec.ReduceSinkOperator"> 
-                                <void property="conf"> 
-                                 <object class="org.apache.hadoop.hive.ql.plan.reduceSinkDesc"> 
-                                  <void property="keyCols"> 
-                                   <object class="java.util.ArrayList"/> 
-                                  </void> 
-                                  <void property="keySerializeInfo"> 
-                                   <object id="tableDesc10" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
-                                    <void property="deserializerClass"> 
-                                     <class>org.apache.hadoop.hive.serde2.binarysortable.BinarySortableSerDe</class> 
-                                    </void> 
-                                    <void property="inputFileFormatClass"> 
-                                     <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                                    </void> 
-                                    <void property="outputFileFormatClass"> 
-                                     <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                                    </void> 
-                                    <void property="properties"> 
-                                     <object class="java.util.Properties"> 
-                                      <void method="put"> 
-                                       <string>columns</string> 
-                                       <string></string> 
-                                      </void> 
-                                      <void method="put"> 
-                                       <string>serialization.sort.order</string> 
-                                       <string></string> 
-                                      </void> 
-                                      <void method="put"> 
-                                       <string>columns.types</string> 
-                                       <string></string> 
-                                      </void> 
-                                     </object> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                  <void property="numReducers"> 
-                                   <int>-1</int> 
-                                  </void> 
-                                  <void property="outputKeyColumnNames"> 
-                                   <object class="java.util.ArrayList"/> 
-                                  </void> 
-                                  <void property="outputValueColumnNames"> 
-                                   <object class="java.util.ArrayList"> 
-                                    <void method="add"> 
-                                     <string>_col0</string> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                  <void property="partitionCols"> 
-                                   <object class="java.util.ArrayList"> 
-                                    <void method="add"> 
-                                     <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                                      <void property="UDFClass"> 
-                                       <class>org.apache.hadoop.hive.ql.udf.UDFRand</class> 
-                                      </void> 
-                                      <void property="UDFMethod"> 
-                                       <object class="org.apache.hadoop.hive.ql.udf.UDFRand" method="getMethod"> 
-                                        <string>evaluate</string> 
-                                        <array class="java.lang.Class" length="0"/> 
-                                       </object> 
-                                      </void> 
-                                      <void property="childExprs"> 
-                                       <object class="java.util.ArrayList"/> 
-                                      </void> 
-                                      <void property="typeInfo"> 
-                                       <object idref="PrimitiveTypeInfo0"/> 
-                                      </void> 
-                                     </object> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                  <void property="tag"> 
-                                   <int>-1</int> 
-                                  </void> 
-                                  <void property="valueCols"> 
-                                   <object class="java.util.ArrayList"> 
-                                    <void method="add"> 
-                                     <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                                      <void property="column"> 
-                                       <string>src.value</string> 
-                                      </void> 
-                                      <void property="typeInfo"> 
-                                       <object idref="PrimitiveTypeInfo1"/> 
-                                      </void> 
-                                     </object> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                  <void property="valueSerializeInfo"> 
-                                   <object id="tableDesc11" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
-                                    <void property="deserializerClass"> 
-                                     <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
-                                    </void> 
-                                    <void property="inputFileFormatClass"> 
-                                     <class>org.apache.hadoop.mapred.SequenceFileInputFormat</class> 
-                                    </void> 
-                                    <void property="outputFileFormatClass"> 
-                                     <class>org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat</class> 
-                                    </void> 
-                                    <void property="properties"> 
-                                     <object class="java.util.Properties"> 
-                                      <void method="put"> 
-                                       <string>columns</string> 
-                                       <string>_col0</string> 
-                                      </void> 
-                                      <void method="put"> 
-                                       <string>columns.types</string> 
-                                       <string>string</string> 
-                                      </void> 
-                                     </object> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void property="parentOperators"> 
-                                 <object class="java.util.ArrayList"> 
-                                  <void method="add"> 
-                                   <object idref="TableScanOperator4"/> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void property="schema"> 
-                                 <object idref="RowSchema3"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="schema"> 
-                             <object idref="RowSchema3"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="keyDesc"> 
-                         <object idref="tableDesc10"/> 
-                        </void> 
-                        <void property="numReduceTasks"> 
-                         <int>-1</int> 
-                        </void> 
-                        <void property="pathToAliases"> 
-                         <object class="java.util.LinkedHashMap"> 
-                          <void method="put"> 
-                           <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1177730582/10010</string> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1177730582/10010</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="pathToPartitionInfo"> 
-                         <object class="java.util.LinkedHashMap"> 
-                          <void method="put"> 
-                           <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1177730582/10010</string> 
-                           <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
-                            <void property="tableDesc"> 
-                             <object idref="tableDesc5"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="reducer"> 
-                         <object id="ExtractOperator3" class="org.apache.hadoop.hive.ql.exec.ExtractOperator"> 
-                          <void property="childOperators"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                              <void property="conf"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
-                                <void property="dirName"> 
-                                 <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1877897368/10006</string> 
-                                </void> 
-                                <void property="tableInfo"> 
-                                 <object idref="tableDesc5"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void property="parentOperators"> 
-                               <object class="java.util.ArrayList"> 
-                                <void method="add"> 
-                                 <object idref="ExtractOperator3"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void property="schema"> 
-                               <object idref="RowSchema3"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="conf"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.extractDesc"> 
-                            <void property="col"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                              <void property="column"> 
-                               <string>VALUE</string> 
-                              </void> 
-                              <void property="typeInfo"> 
-                               <object idref="PrimitiveTypeInfo1"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="schema"> 
-                           <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                            <void property="signature"> 
-                             <object class="java.util.Vector"> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                <void property="internalName"> 
-                                 <string>0</string> 
-                                </void> 
-                                <void property="type"> 
-                                 <object idref="PrimitiveTypeInfo1"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+               </object> 
+              </void> 
+             </object> 
+            </void> 
+            <void property="conf"> 
+             <object class="org.apache.hadoop.hive.ql.plan.filterDesc"> 
+              <void property="predicate"> 
+               <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                <void property="UDFClass"> 
+                 <class>org.apache.hadoop.hive.ql.udf.UDFOPEqualOrGreaterThan</class> 
+                </void> 
+                <void property="UDFMethod"> 
+                 <object class="org.apache.hadoop.hive.ql.udf.UDFOPEqualOrGreaterThan" method="getMethod"> 
+                  <string>evaluate</string> 
+                  <array class="java.lang.Class" length="2"> 
+                   <void index="0"> 
+                    <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
+                   </void> 
+                   <void index="1"> 
+                    <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
+                   </void> 
+                  </array> 
+                 </object> 
+                </void> 
+                <void property="childExprs"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                    <void property="UDFClass"> 
+                     <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
+                    </void> 
+                    <void property="UDFMethod"> 
+                     <object class="org.apache.hadoop.hive.ql.udf.UDFToDouble" method="getMethod"> 
+                      <string>evaluate</string> 
+                      <array class="java.lang.Class" length="1"> 
+                       <void index="0"> 
+                        <class>org.apache.hadoop.io.Text</class> 
+                       </void> 
+                      </array> 
+                     </object> 
+                    </void> 
+                    <void property="childExprs"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                        <void property="column"> 
+                         <string>key</string> 
                         </void> 
-                        <void property="tagToValueDesc"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object idref="tableDesc11"/> 
-                          </void> 
-                         </object> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
                        </object> 
                       </void> 
                      </object> 
                     </void> 
-                   </object> 
-                  </void> 
-                  <void property="parentTasks"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="MapRedTask0"/> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
                     </void> 
                    </object> 
                   </void> 
-                  <void property="resolver"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles"/> 
-                  </void> 
-                  <void property="resolverCtx"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
-                    <void property="ctx"> 
-                     <object idref="GenMRProcContext0"/> 
-                    </void> 
-                    <void property="dir"> 
-                     <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1177730582/10010</string> 
-                    </void> 
-                    <void property="listTasks"> 
-                     <object idref="ArrayList3"/> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                    <void property="UDFClass"> 
+                     <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
                     </void> 
-                   </object> 
-                  </void> 
-                  <void property="work"> 
-                   <object class="org.apache.hadoop.hive.ql.plan.ConditionalWork"> 
-                    <void property="listWorks"> 
+                    <void property="UDFMethod"> 
+                     <object class="org.apache.hadoop.hive.ql.udf.UDFToDouble" method="getMethod"> 
+                      <string>evaluate</string> 
+                      <array class="java.lang.Class" length="1"> 
+                       <void index="0"> 
+                        <class>org.apache.hadoop.io.IntWritable</class> 
+                       </void> 
+                      </array> 
+                     </object> 
+                    </void> 
+                    <void property="childExprs"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object idref="moveWork3"/> 
-                      </void> 
-                      <void method="add"> 
-                       <object idref="mapredWork3"/> 
+                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo2"/> 
+                        </void> 
+                        <void property="value"> 
+                         <int>300</int> 
+                        </void> 
+                       </object> 
                       </void> 
                      </object> 
                     </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
-               </object> 
-              </void> 
-              <void property="work"> 
-               <object class="org.apache.hadoop.hive.ql.plan.moveWork"> 
-                <void property="loadFileWork"> 
-                 <object id="loadFileDesc0" class="org.apache.hadoop.hive.ql.plan.loadFileDesc"> 
-                  <void property="columnTypes"> 
-                   <string>string</string> 
-                  </void> 
-                  <void property="columns"> 
-                   <string>src.value</string> 
-                  </void> 
-                  <void property="isDfsDir"> 
-                   <boolean>true</boolean> 
-                  </void> 
-                  <void property="sourceDir"> 
-                   <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1877897368/10006</string> 
-                  </void> 
-                  <void property="targetDir"> 
-                   <string>../../../../build/contrib/hive/ql/test/data/warehouse/dest4.out</string> 
-                  </void> 
-                 </object> 
+                <void property="typeInfo"> 
+                 <object idref="PrimitiveTypeInfo3"/> 
                 </void> 
                </object> 
               </void> 
              </object> 
             </void> 
-           </object> 
-          </void> 
-          <void property="opTaskMap"> 
-           <object class="java.util.HashMap"> 
-            <void method="put"> 
-             <null/> 
-             <object idref="MapRedTask0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="parseCtx"> 
-           <object class="org.apache.hadoop.hive.ql.parse.ParseContext"> 
-            <void property="QB"> 
-             <object class="org.apache.hadoop.hive.ql.parse.QB"/> 
-            </void> 
-            <void property="UCtx"> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.unionproc.UnionProcContext"/> 
-            </void> 
-            <void property="aliasToPruner"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>src</string> 
-               <object class="org.apache.hadoop.hive.ql.parse.PartitionPruner"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="aliasToSamplePruner"> 
-             <object class="java.util.HashMap"/> 
-            </void> 
-            <void property="conf"> 
-             <object idref="HiveConf0"/> 
-            </void> 
-            <void property="context"> 
-             <object class="org.apache.hadoop.hive.ql.Context"/> 
-            </void> 
-            <void property="destTableId"> 
-             <int>5</int> 
-            </void> 
-            <void property="idToTableNameMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>3</string> 
-               <string>dest3</string> 
-              </void> 
-              <void method="put"> 
-               <string>2</string> 
-               <string>dest2</string> 
-              </void> 
-              <void method="put"> 
-               <string>1</string> 
-               <string>dest1</string> 
-              </void> 
-              <void method="put"> 
-               <string>4</string> 
-               <string>../../../../build/contrib/hive/ql/test/data/warehouse/dest4.out</string> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="joinContext"> 
-             <object class="java.util.HashMap"/> 
-            </void> 
-            <void property="listMapJoinOpsNoReducer"> 
-             <object class="java.util.ArrayList"/> 
-            </void> 
-            <void property="loadFileWork"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="loadFileDesc0"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="loadTableWork"> 
+            <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <object idref="loadTableDesc0"/> 
-              </void> 
-              <void method="add"> 
-               <object idref="loadTableDesc1"/> 
-              </void> 
-              <void method="add"> 
-               <object idref="loadTableDesc2"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="opParseCtx"> 
-             <object class="java.util.LinkedHashMap"> 
-              <void method="put"> 
-               <object idref="TableScanOperator1"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object id="RowResolver0" class="org.apache.hadoop.hive.ql.parse.RowResolver"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="FilterOperator0"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object idref="RowResolver0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="SelectOperator0"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object id="RowResolver1" class="org.apache.hadoop.hive.ql.parse.RowResolver"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="FileSinkOperator0"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object idref="RowResolver1"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="FilterOperator1"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object idref="RowResolver0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="SelectOperator1"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object id="RowResolver2" class="org.apache.hadoop.hive.ql.parse.RowResolver"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="FileSinkOperator1"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object idref="RowResolver2"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="FilterOperator2"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object idref="RowResolver0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="SelectOperator2"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object id="RowResolver3" class="org.apache.hadoop.hive.ql.parse.RowResolver"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="FileSinkOperator2"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object idref="RowResolver3"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="FilterOperator3"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object idref="RowResolver0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="SelectOperator3"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object id="RowResolver4" class="org.apache.hadoop.hive.ql.parse.RowResolver"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="FileSinkOperator3"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object idref="RowResolver4"/> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="parseTree"> 
-             <object class="org.apache.hadoop.hive.ql.parse.ASTNode"> 
-              <void property="tokenStartIndex"> 
-               <int>0</int> 
-              </void> 
-              <void property="tokenStopIndex"> 
-               <int>138</int> 
+               <object idref="TableScanOperator4"/> 
               </void> 
              </object> 
             </void> 
-            <void property="topOps"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>src</string> 
-               <object idref="TableScanOperator1"/> 
+            <void property="schema"> 
+             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+              <void property="signature"> 
+               <object idref="Vector0"/> 
               </void> 
              </object> 
             </void> 
-            <void property="topSelOps"> 
-             <object class="java.util.HashMap"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="rootOps"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="TableScanOperator1"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="rootTasks"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="MapRedTask0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="seenFileSinkOps"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="FileSinkOperator0"/> 
-            </void> 
-            <void method="add"> 
-             <object idref="FileSinkOperator1"/> 
-            </void> 
-            <void method="add"> 
-             <object idref="FileSinkOperator2"/> 
-            </void> 
-            <void method="add"> 
-             <object idref="FileSinkOperator3"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="seenOps"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="TableScanOperator1"/> 
-            </void> 
            </object> 
           </void> 
          </object> 
         </void> 
-        <void property="dir"> 
-         <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1177730582/10007</string> 
-        </void> 
-        <void property="listTasks"> 
-         <object idref="ArrayList0"/> 
-        </void> 
-       </object> 
-      </void> 
-      <void property="work"> 
-       <object class="org.apache.hadoop.hive.ql.plan.ConditionalWork"> 
-        <void property="listWorks"> 
+        <void property="neededColumnIDs"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <object idref="moveWork0"/> 
+           <int>0</int> 
           </void> 
           <void method="add"> 
-           <object idref="mapredWork0"/> 
+           <int>1</int> 
+          </void> 
+         </object> 
+        </void> 
+        <void property="schema"> 
+         <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+          <void property="signature"> 
+           <object idref="Vector0"/> 
           </void> 
          </object> 
         </void> 
@@ -3405,104 +3164,10 @@
       </void> 
      </object> 
     </void> 
-    <void method="add"> 
-     <object idref="ConditionalTask1"/> 
-    </void> 
-    <void method="add"> 
-     <object idref="ConditionalTask2"/> 
-    </void> 
-    <void method="add"> 
-     <object idref="ConditionalTask3"/> 
-    </void> 
-   </object> 
-  </void> 
-  <void property="id"> 
-   <string>Stage-5</string> 
-  </void> 
-  <void property="work"> 
-   <object class="org.apache.hadoop.hive.ql.plan.mapredWork"> 
-    <void property="aliasToPartnInfo"> 
-     <void method="put"> 
-      <string>src</string> 
-      <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
-       <void property="partSpec"> 
-        <object id="LinkedHashMap0" class="java.util.LinkedHashMap"/> 
-       </void> 
-       <void property="tableDesc"> 
-        <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
-         <void property="deserializerClass"> 
-          <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
-         </void> 
-         <void property="inputFileFormatClass"> 
-          <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-         </void> 
-         <void property="outputFileFormatClass"> 
-          <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-         </void> 
-         <void property="properties"> 
-          <object id="Properties0" class="java.util.Properties"> 
-           <void method="put"> 
-            <string>name</string> 
-            <string>src</string> 
-           </void> 
-           <void method="put"> 
-            <string>columns.types</string> 
-            <string>string:string</string> 
-           </void> 
-           <void method="put"> 
-            <string>serialization.ddl</string> 
-            <string>struct src { string key, string value}</string> 
-           </void> 
-           <void method="put"> 
-            <string>serialization.format</string> 
-            <string>1</string> 
-           </void> 
-           <void method="put"> 
-            <string>columns</string> 
-            <string>key,value</string> 
-           </void> 
-           <void method="put"> 
-            <string>bucket_count</string> 
-            <string>-1</string> 
-           </void> 
-           <void method="put"> 
-            <string>serialization.lib</string> 
-            <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-           </void> 
-           <void method="put"> 
-            <string>file.inputformat</string> 
-            <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-           </void> 
-           <void method="put"> 
-            <string>file.outputformat</string> 
-            <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-           </void> 
-           <void method="put"> 
-            <string>location</string> 
-            <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/src</string> 
-           </void> 
-          </object> 
-         </void> 
-         <void property="serdeClassName"> 
-          <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-         </void> 
-        </object> 
-       </void> 
-      </object> 
-     </void> 
-    </void> 
-    <void property="aliasToWork"> 
-     <object class="java.util.LinkedHashMap"> 
-      <void method="put"> 
-       <string>src</string> 
-       <object idref="TableScanOperator1"/> 
-      </void> 
-     </object> 
-    </void> 
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/src</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>src</string> 
@@ -3514,7 +3179,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/src</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/input6.q.xml b/ql/src/test/results/compiler/plan/input6.q.xml
index d858d4d586..7c110decec 100644
--- a/ql/src/test/results/compiler/plan/input6.q.xml
+++ b/ql/src/test/results/compiler/plan/input6.q.xml
@@ -8,7 +8,7 @@
       <void property="childTasks"> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
-         <object id="MoveTask0" class="org.apache.hadoop.hive.ql.exec.MoveTask"> 
+         <object class="org.apache.hadoop.hive.ql.exec.MoveTask"> 
           <void property="id"> 
            <string>Stage-1</string> 
           </void> 
@@ -22,7 +22,7 @@
           <void property="work"> 
            <object class="org.apache.hadoop.hive.ql.plan.moveWork"> 
             <void property="loadTableWork"> 
-             <object id="loadTableDesc0" class="org.apache.hadoop.hive.ql.plan.loadTableDesc"> 
+             <object class="org.apache.hadoop.hive.ql.plan.loadTableDesc"> 
               <void property="partitionSpec"> 
                <object class="java.util.HashMap"/> 
               </void> 
@@ -30,7 +30,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1168488327/10000</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1225271552/10000</string> 
               </void> 
               <void property="table"> 
                <object id="tableDesc0" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -83,7 +83,7 @@
                   </void> 
                   <void method="put"> 
                    <string>location</string> 
-                   <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/dest1</string> 
+                   <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/dest1</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -93,7 +93,7 @@
                </object> 
               </void> 
               <void property="tmpDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1168488327/10001</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1225271552/10001</string> 
               </void> 
              </object> 
             </void> 
@@ -121,10 +121,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/2002326395/10002</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/2014539459/10002</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1168488327/10000</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1225271552/10000</string> 
               </void> 
              </object> 
             </void> 
@@ -142,7 +142,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/2002326395/10002</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/2014539459/10002</string> 
                <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -338,10 +338,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/2002326395/10002</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/2014539459/10002</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/2002326395/10002</string> 
+                 <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/2014539459/10002</string> 
                 </void> 
                </object> 
               </void> 
@@ -350,7 +350,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/2002326395/10002</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/2014539459/10002</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object idref="tableDesc0"/> 
@@ -368,7 +368,7 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1168488327/10000</string> 
+                     <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1225271552/10000</string> 
                     </void> 
                     <void property="tableInfo"> 
                      <object idref="tableDesc0"/> 
@@ -458,182 +458,200 @@
       </void> 
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
-        <void property="ctx"> 
-         <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext"> 
-          <void property="conf"> 
-           <object id="HiveConf0" class="org.apache.hadoop.hive.conf.HiveConf"> 
-            <void property="auxJars"> 
-             <string>file:///data/users/njain/hive3/hive3/build/ql/test/test-udfs.jar</string> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="currAliasId"> 
-           <string>src1</string> 
+        <void property="dir"> 
+         <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/2014539459/10002</string> 
+        </void> 
+        <void property="listTasks"> 
+         <object idref="ArrayList0"/> 
+        </void> 
+       </object> 
+      </void> 
+      <void property="work"> 
+       <object class="org.apache.hadoop.hive.ql.plan.ConditionalWork"> 
+        <void property="listWorks"> 
+         <object class="java.util.ArrayList"> 
+          <void method="add"> 
+           <object idref="moveWork0"/> 
           </void> 
-          <void property="currTask"> 
-           <object idref="MapRedTask0"/> 
+          <void method="add"> 
+           <object idref="mapredWork0"/> 
           </void> 
-          <void property="currTopOp"> 
-           <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
+         </object> 
+        </void> 
+       </object> 
+      </void> 
+     </object> 
+    </void> 
+   </object> 
+  </void> 
+  <void property="id"> 
+   <string>Stage-2</string> 
+  </void> 
+  <void property="work"> 
+   <object class="org.apache.hadoop.hive.ql.plan.mapredWork"> 
+    <void property="aliasToPartnInfo"> 
+     <void method="put"> 
+      <string>src1</string> 
+      <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
+       <void property="partSpec"> 
+        <object id="LinkedHashMap0" class="java.util.LinkedHashMap"/> 
+       </void> 
+       <void property="tableDesc"> 
+        <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
+         <void property="deserializerClass"> 
+          <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
+         </void> 
+         <void property="inputFileFormatClass"> 
+          <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+         </void> 
+         <void property="outputFileFormatClass"> 
+          <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+         </void> 
+         <void property="properties"> 
+          <object id="Properties0" class="java.util.Properties"> 
+           <void method="put"> 
+            <string>name</string> 
+            <string>src1</string> 
+           </void> 
+           <void method="put"> 
+            <string>columns.types</string> 
+            <string>string:string</string> 
+           </void> 
+           <void method="put"> 
+            <string>serialization.ddl</string> 
+            <string>struct src1 { string key, string value}</string> 
+           </void> 
+           <void method="put"> 
+            <string>serialization.format</string> 
+            <string>1</string> 
+           </void> 
+           <void method="put"> 
+            <string>columns</string> 
+            <string>key,value</string> 
+           </void> 
+           <void method="put"> 
+            <string>bucket_count</string> 
+            <string>-1</string> 
+           </void> 
+           <void method="put"> 
+            <string>serialization.lib</string> 
+            <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+           </void> 
+           <void method="put"> 
+            <string>file.inputformat</string> 
+            <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+           </void> 
+           <void method="put"> 
+            <string>file.outputformat</string> 
+            <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+           </void> 
+           <void method="put"> 
+            <string>location</string> 
+            <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/src1</string> 
+           </void> 
+          </object> 
+         </void> 
+         <void property="serdeClassName"> 
+          <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+         </void> 
+        </object> 
+       </void> 
+      </object> 
+     </void> 
+    </void> 
+    <void property="aliasToWork"> 
+     <object class="java.util.LinkedHashMap"> 
+      <void method="put"> 
+       <string>src1</string> 
+       <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
+        <void property="childOperators"> 
+         <object class="java.util.ArrayList"> 
+          <void method="add"> 
+           <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
             <void property="childOperators"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+               <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+                   <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
                     <void property="childOperators"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                        <void property="childOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object id="FileSinkOperator0" class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                            <void property="conf"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
-                              <void property="destTableId"> 
-                               <int>1</int> 
-                              </void> 
-                              <void property="dirName"> 
-                               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/2002326395/10002</string> 
-                              </void> 
-                              <void property="tableInfo"> 
-                               <object idref="tableDesc0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="parentOperators"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object idref="SelectOperator0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="schema"> 
-                             <object idref="RowSchema0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="columnExprMap"> 
-                         <object class="java.util.HashMap"> 
-                          <void method="put"> 
-                           <string>_col1</string> 
-                           <object id="exprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>value</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="put"> 
-                           <string>_col0</string> 
-                           <object id="exprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>key</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
+                       <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
                         <void property="conf"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.selectDesc"> 
-                          <void property="colList"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object idref="exprNodeColumnDesc1"/> 
-                            </void> 
-                            <void method="add"> 
-                             <object idref="exprNodeColumnDesc0"/> 
-                            </void> 
-                           </object> 
+                         <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
+                          <void property="destTableId"> 
+                           <int>1</int> 
                           </void> 
-                          <void property="outputColumnNames"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <string>_col0</string> 
-                            </void> 
-                            <void method="add"> 
-                             <string>_col1</string> 
-                            </void> 
-                           </object> 
+                          <void property="dirName"> 
+                           <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/2014539459/10002</string> 
+                          </void> 
+                          <void property="tableInfo"> 
+                           <object idref="tableDesc0"/> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="parentOperators"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <object idref="FilterOperator1"/> 
+                           <object idref="SelectOperator0"/> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="schema"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                          <void property="signature"> 
-                           <object class="java.util.Vector"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>_col0</string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>_col1</string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
+                         <object idref="RowSchema0"/> 
                         </void> 
                        </object> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.filterDesc"> 
-                      <void property="predicate"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeGenericFuncDesc"> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>key</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
+                    <void property="columnExprMap"> 
+                     <object class="java.util.HashMap"> 
+                      <void method="put"> 
+                       <string>_col1</string> 
+                       <object id="exprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                        <void property="column"> 
+                         <string>value</string> 
+                        </void> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo0"/> 
                         </void> 
-                        <void property="genericUDFClass"> 
-                         <class>org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPNull</class> 
+                       </object> 
+                      </void> 
+                      <void method="put"> 
+                       <string>_col0</string> 
+                       <object id="exprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                        <void property="column"> 
+                         <string>key</string> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>boolean</string> 
-                          </void> 
-                         </object> 
+                         <object idref="PrimitiveTypeInfo0"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="conf"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.selectDesc"> 
+                      <void property="colList"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <object idref="exprNodeColumnDesc1"/> 
+                        </void> 
+                        <void method="add"> 
+                         <object idref="exprNodeColumnDesc0"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="outputColumnNames"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <string>_col0</string> 
+                        </void> 
+                        <void method="add"> 
+                         <string>_col1</string> 
                         </void> 
                        </object> 
                       </void> 
@@ -642,18 +660,18 @@
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object idref="FilterOperator0"/> 
+                       <object idref="FilterOperator1"/> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="schema"> 
                      <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
                       <void property="signature"> 
-                       <object id="Vector0" class="java.util.Vector"> 
+                       <object class="java.util.Vector"> 
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                           <void property="internalName"> 
-                           <string>key</string> 
+                           <string>_col0</string> 
                           </void> 
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
@@ -663,7 +681,7 @@
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                           <void property="internalName"> 
-                           <string>value</string> 
+                           <string>_col1</string> 
                           </void> 
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo0"/> 
@@ -700,7 +718,11 @@
                      <class>org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPNull</class> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo1"/> 
+                     <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                      <void property="typeName"> 
+                       <string>boolean</string> 
+                      </void> 
+                     </object> 
                     </void> 
                    </object> 
                   </void> 
@@ -709,14 +731,35 @@
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object idref="TableScanOperator1"/> 
+                   <object idref="FilterOperator0"/> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="schema"> 
                  <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
                   <void property="signature"> 
-                   <object idref="Vector0"/> 
+                   <object id="Vector0" class="java.util.Vector"> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="internalName"> 
+                       <string>key</string> 
+                      </void> 
+                      <void property="type"> 
+                       <object idref="PrimitiveTypeInfo0"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="internalName"> 
+                       <string>value</string> 
+                      </void> 
+                      <void property="type"> 
+                       <object idref="PrimitiveTypeInfo0"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                   </object> 
                   </void> 
                  </object> 
                 </void> 
@@ -724,226 +767,66 @@
               </void> 
              </object> 
             </void> 
-            <void property="neededColumnIDs"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <int>0</int> 
-              </void> 
-              <void method="add"> 
-               <int>1</int> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object idref="Vector0"/> 
-              </void> 
-             </object> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="mapCurrCtx"> 
-           <object class="java.util.LinkedHashMap"> 
-            <void method="put"> 
-             <object idref="TableScanOperator1"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-            <void method="put"> 
-             <object idref="FilterOperator0"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-            <void method="put"> 
-             <object idref="FilterOperator1"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-            <void method="put"> 
-             <object idref="SelectOperator0"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="mvTask"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="MoveTask0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="opTaskMap"> 
-           <object class="java.util.HashMap"> 
-            <void method="put"> 
-             <null/> 
-             <object idref="MapRedTask0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="parseCtx"> 
-           <object class="org.apache.hadoop.hive.ql.parse.ParseContext"> 
-            <void property="QB"> 
-             <object class="org.apache.hadoop.hive.ql.parse.QB"/> 
-            </void> 
-            <void property="UCtx"> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.unionproc.UnionProcContext"/> 
-            </void> 
-            <void property="aliasToPruner"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>src1</string> 
-               <object class="org.apache.hadoop.hive.ql.parse.PartitionPruner"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="aliasToSamplePruner"> 
-             <object class="java.util.HashMap"/> 
-            </void> 
             <void property="conf"> 
-             <object idref="HiveConf0"/> 
-            </void> 
-            <void property="context"> 
-             <object class="org.apache.hadoop.hive.ql.Context"/> 
-            </void> 
-            <void property="destTableId"> 
-             <int>2</int> 
-            </void> 
-            <void property="idToTableNameMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>1</string> 
-               <string>dest1</string> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="joinContext"> 
-             <object class="java.util.HashMap"/> 
-            </void> 
-            <void property="listMapJoinOpsNoReducer"> 
-             <object class="java.util.ArrayList"/> 
-            </void> 
-            <void property="loadFileWork"> 
-             <object class="java.util.ArrayList"/> 
-            </void> 
-            <void property="loadTableWork"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="loadTableDesc0"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="opParseCtx"> 
-             <object class="java.util.LinkedHashMap"> 
-              <void method="put"> 
-               <object idref="TableScanOperator1"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object id="RowResolver0" class="org.apache.hadoop.hive.ql.parse.RowResolver"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="FilterOperator1"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object idref="RowResolver0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="SelectOperator0"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object id="RowResolver1" class="org.apache.hadoop.hive.ql.parse.RowResolver"/> 
+             <object class="org.apache.hadoop.hive.ql.plan.filterDesc"> 
+              <void property="predicate"> 
+               <object class="org.apache.hadoop.hive.ql.plan.exprNodeGenericFuncDesc"> 
+                <void property="childExprs"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                    <void property="column"> 
+                     <string>key</string> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
                 </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="FileSinkOperator0"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object idref="RowResolver1"/> 
+                <void property="genericUDFClass"> 
+                 <class>org.apache.hadoop.hive.ql.udf.generic.GenericUDFOPNull</class> 
                 </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="FilterOperator0"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object idref="RowResolver0"/> 
+                <void property="typeInfo"> 
+                 <object idref="PrimitiveTypeInfo1"/> 
                 </void> 
                </object> 
               </void> 
              </object> 
             </void> 
-            <void property="parseTree"> 
-             <object class="org.apache.hadoop.hive.ql.parse.ASTNode"> 
-              <void property="tokenStartIndex"> 
-               <int>0</int> 
-              </void> 
-              <void property="tokenStopIndex"> 
-               <int>31</int> 
+            <void property="parentOperators"> 
+             <object class="java.util.ArrayList"> 
+              <void method="add"> 
+               <object idref="TableScanOperator1"/> 
               </void> 
              </object> 
             </void> 
-            <void property="topOps"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>src1</string> 
-               <object idref="TableScanOperator1"/> 
+            <void property="schema"> 
+             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+              <void property="signature"> 
+               <object idref="Vector0"/> 
               </void> 
              </object> 
             </void> 
-            <void property="topSelOps"> 
-             <object class="java.util.HashMap"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="rootOps"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="TableScanOperator1"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="rootTasks"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="MapRedTask0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="seenFileSinkOps"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="FileSinkOperator0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="seenOps"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="TableScanOperator1"/> 
-            </void> 
            </object> 
           </void> 
          </object> 
         </void> 
-        <void property="dir"> 
-         <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/2002326395/10002</string> 
-        </void> 
-        <void property="listTasks"> 
-         <object idref="ArrayList0"/> 
-        </void> 
-       </object> 
-      </void> 
-      <void property="work"> 
-       <object class="org.apache.hadoop.hive.ql.plan.ConditionalWork"> 
-        <void property="listWorks"> 
+        <void property="neededColumnIDs"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <object idref="moveWork0"/> 
+           <int>0</int> 
           </void> 
           <void method="add"> 
-           <object idref="mapredWork0"/> 
+           <int>1</int> 
+          </void> 
+         </object> 
+        </void> 
+        <void property="schema"> 
+         <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+          <void property="signature"> 
+           <object idref="Vector0"/> 
           </void> 
          </object> 
         </void> 
@@ -951,95 +834,10 @@
       </void> 
      </object> 
     </void> 
-   </object> 
-  </void> 
-  <void property="id"> 
-   <string>Stage-2</string> 
-  </void> 
-  <void property="work"> 
-   <object class="org.apache.hadoop.hive.ql.plan.mapredWork"> 
-    <void property="aliasToPartnInfo"> 
-     <void method="put"> 
-      <string>src1</string> 
-      <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
-       <void property="partSpec"> 
-        <object id="LinkedHashMap0" class="java.util.LinkedHashMap"/> 
-       </void> 
-       <void property="tableDesc"> 
-        <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
-         <void property="deserializerClass"> 
-          <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
-         </void> 
-         <void property="inputFileFormatClass"> 
-          <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-         </void> 
-         <void property="outputFileFormatClass"> 
-          <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-         </void> 
-         <void property="properties"> 
-          <object id="Properties0" class="java.util.Properties"> 
-           <void method="put"> 
-            <string>name</string> 
-            <string>src1</string> 
-           </void> 
-           <void method="put"> 
-            <string>columns.types</string> 
-            <string>string:string</string> 
-           </void> 
-           <void method="put"> 
-            <string>serialization.ddl</string> 
-            <string>struct src1 { string key, string value}</string> 
-           </void> 
-           <void method="put"> 
-            <string>serialization.format</string> 
-            <string>1</string> 
-           </void> 
-           <void method="put"> 
-            <string>columns</string> 
-            <string>key,value</string> 
-           </void> 
-           <void method="put"> 
-            <string>bucket_count</string> 
-            <string>-1</string> 
-           </void> 
-           <void method="put"> 
-            <string>serialization.lib</string> 
-            <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-           </void> 
-           <void method="put"> 
-            <string>file.inputformat</string> 
-            <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-           </void> 
-           <void method="put"> 
-            <string>file.outputformat</string> 
-            <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-           </void> 
-           <void method="put"> 
-            <string>location</string> 
-            <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/src1</string> 
-           </void> 
-          </object> 
-         </void> 
-         <void property="serdeClassName"> 
-          <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-         </void> 
-        </object> 
-       </void> 
-      </object> 
-     </void> 
-    </void> 
-    <void property="aliasToWork"> 
-     <object class="java.util.LinkedHashMap"> 
-      <void method="put"> 
-       <string>src1</string> 
-       <object idref="TableScanOperator1"/> 
-      </void> 
-     </object> 
-    </void> 
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/src1</string> 
+       <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/src1</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>src1</string> 
@@ -1051,7 +849,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/src1</string> 
+       <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/src1</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/input7.q.xml b/ql/src/test/results/compiler/plan/input7.q.xml
index d9711031df..e26f11de36 100644
--- a/ql/src/test/results/compiler/plan/input7.q.xml
+++ b/ql/src/test/results/compiler/plan/input7.q.xml
@@ -8,7 +8,7 @@
       <void property="childTasks"> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
-         <object id="MoveTask0" class="org.apache.hadoop.hive.ql.exec.MoveTask"> 
+         <object class="org.apache.hadoop.hive.ql.exec.MoveTask"> 
           <void property="id"> 
            <string>Stage-1</string> 
           </void> 
@@ -22,7 +22,7 @@
           <void property="work"> 
            <object class="org.apache.hadoop.hive.ql.plan.moveWork"> 
             <void property="loadTableWork"> 
-             <object id="loadTableDesc0" class="org.apache.hadoop.hive.ql.plan.loadTableDesc"> 
+             <object class="org.apache.hadoop.hive.ql.plan.loadTableDesc"> 
               <void property="partitionSpec"> 
                <object class="java.util.HashMap"/> 
               </void> 
@@ -30,7 +30,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/980582697/10000</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/340166762/10000</string> 
               </void> 
               <void property="table"> 
                <object id="tableDesc0" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -83,7 +83,7 @@
                   </void> 
                   <void method="put"> 
                    <string>location</string> 
-                   <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/dest1</string> 
+                   <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/dest1</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -93,7 +93,7 @@
                </object> 
               </void> 
               <void property="tmpDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/980582697/10001</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/340166762/10001</string> 
               </void> 
              </object> 
             </void> 
@@ -121,10 +121,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/760684574/10002</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1749379908/10002</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/980582697/10000</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/340166762/10000</string> 
               </void> 
              </object> 
             </void> 
@@ -142,7 +142,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/760684574/10002</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1749379908/10002</string> 
                <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -338,10 +338,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/760684574/10002</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1749379908/10002</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/760684574/10002</string> 
+                 <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1749379908/10002</string> 
                 </void> 
                </object> 
               </void> 
@@ -350,7 +350,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/760684574/10002</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1749379908/10002</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object idref="tableDesc0"/> 
@@ -368,7 +368,7 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/980582697/10000</string> 
+                     <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/340166762/10000</string> 
                     </void> 
                     <void property="tableInfo"> 
                      <object idref="tableDesc0"/> 
@@ -462,343 +462,8 @@
       </void> 
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
-        <void property="ctx"> 
-         <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext"> 
-          <void property="conf"> 
-           <object id="HiveConf0" class="org.apache.hadoop.hive.conf.HiveConf"> 
-            <void property="auxJars"> 
-             <string>file:///data/users/njain/hive3/hive3/build/ql/test/test-udfs.jar</string> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="currAliasId"> 
-           <string>src1</string> 
-          </void> 
-          <void property="currTask"> 
-           <object idref="MapRedTask0"/> 
-          </void> 
-          <void property="currTopOp"> 
-           <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                <void property="childOperators"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object id="FileSinkOperator0" class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
-                      <void property="destTableId"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="dirName"> 
-                       <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/760684574/10002</string> 
-                      </void> 
-                      <void property="tableInfo"> 
-                       <object idref="tableDesc0"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="SelectOperator0"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="schema"> 
-                     <object idref="RowSchema0"/> 
-                    </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="columnExprMap"> 
-                 <object class="java.util.HashMap"> 
-                  <void method="put"> 
-                   <string>_col1</string> 
-                   <object id="exprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>key</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void method="put"> 
-                   <string>_col0</string> 
-                   <object id="exprNodeConstantDesc0" class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.selectDesc"> 
-                  <void property="colList"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="exprNodeConstantDesc0"/> 
-                    </void> 
-                    <void method="add"> 
-                     <object idref="exprNodeColumnDesc0"/> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void property="outputColumnNames"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <string>_col0</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col1</string> 
-                    </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="parentOperators"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object idref="TableScanOperator1"/> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.Vector"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo1"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="neededColumnIDs"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <int>0</int> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.Vector"> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>key</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>value</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="mapCurrCtx"> 
-           <object class="java.util.LinkedHashMap"> 
-            <void method="put"> 
-             <object idref="TableScanOperator1"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-            <void method="put"> 
-             <object idref="SelectOperator0"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="mvTask"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="MoveTask0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="opTaskMap"> 
-           <object class="java.util.HashMap"> 
-            <void method="put"> 
-             <null/> 
-             <object idref="MapRedTask0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="parseCtx"> 
-           <object class="org.apache.hadoop.hive.ql.parse.ParseContext"> 
-            <void property="QB"> 
-             <object class="org.apache.hadoop.hive.ql.parse.QB"/> 
-            </void> 
-            <void property="UCtx"> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.unionproc.UnionProcContext"/> 
-            </void> 
-            <void property="aliasToPruner"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>src1</string> 
-               <object class="org.apache.hadoop.hive.ql.parse.PartitionPruner"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="aliasToSamplePruner"> 
-             <object class="java.util.HashMap"/> 
-            </void> 
-            <void property="conf"> 
-             <object idref="HiveConf0"/> 
-            </void> 
-            <void property="context"> 
-             <object class="org.apache.hadoop.hive.ql.Context"/> 
-            </void> 
-            <void property="destTableId"> 
-             <int>2</int> 
-            </void> 
-            <void property="idToTableNameMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>1</string> 
-               <string>dest1</string> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="joinContext"> 
-             <object class="java.util.HashMap"/> 
-            </void> 
-            <void property="listMapJoinOpsNoReducer"> 
-             <object class="java.util.ArrayList"/> 
-            </void> 
-            <void property="loadFileWork"> 
-             <object class="java.util.ArrayList"/> 
-            </void> 
-            <void property="loadTableWork"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="loadTableDesc0"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="opParseCtx"> 
-             <object class="java.util.LinkedHashMap"> 
-              <void method="put"> 
-               <object idref="TableScanOperator1"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object class="org.apache.hadoop.hive.ql.parse.RowResolver"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="SelectOperator0"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object id="RowResolver0" class="org.apache.hadoop.hive.ql.parse.RowResolver"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="FileSinkOperator0"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object idref="RowResolver0"/> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="parseTree"> 
-             <object class="org.apache.hadoop.hive.ql.parse.ASTNode"> 
-              <void property="tokenStartIndex"> 
-               <int>0</int> 
-              </void> 
-              <void property="tokenStopIndex"> 
-               <int>19</int> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="topOps"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>src1</string> 
-               <object idref="TableScanOperator1"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="topSelOps"> 
-             <object class="java.util.HashMap"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="rootOps"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="TableScanOperator1"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="rootTasks"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="MapRedTask0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="seenFileSinkOps"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="FileSinkOperator0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="seenOps"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="TableScanOperator1"/> 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
-        </void> 
         <void property="dir"> 
-         <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/760684574/10002</string> 
+         <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1749379908/10002</string> 
         </void> 
         <void property="listTasks"> 
          <object idref="ArrayList0"/> 
@@ -886,7 +551,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/src1</string> 
+            <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/src1</string> 
            </void> 
           </object> 
          </void> 
@@ -902,14 +567,171 @@
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
        <string>src1</string> 
-       <object idref="TableScanOperator1"/> 
+       <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
+        <void property="childOperators"> 
+         <object class="java.util.ArrayList"> 
+          <void method="add"> 
+           <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+            <void property="childOperators"> 
+             <object class="java.util.ArrayList"> 
+              <void method="add"> 
+               <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                <void property="conf"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
+                  <void property="destTableId"> 
+                   <int>1</int> 
+                  </void> 
+                  <void property="dirName"> 
+                   <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1749379908/10002</string> 
+                  </void> 
+                  <void property="tableInfo"> 
+                   <object idref="tableDesc0"/> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="parentOperators"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object idref="SelectOperator0"/> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="schema"> 
+                 <object idref="RowSchema0"/> 
+                </void> 
+               </object> 
+              </void> 
+             </object> 
+            </void> 
+            <void property="columnExprMap"> 
+             <object class="java.util.HashMap"> 
+              <void method="put"> 
+               <string>_col1</string> 
+               <object id="exprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                <void property="column"> 
+                 <string>key</string> 
+                </void> 
+                <void property="typeInfo"> 
+                 <object idref="PrimitiveTypeInfo0"/> 
+                </void> 
+               </object> 
+              </void> 
+              <void method="put"> 
+               <string>_col0</string> 
+               <object id="exprNodeConstantDesc0" class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
+                <void property="typeInfo"> 
+                 <object idref="PrimitiveTypeInfo0"/> 
+                </void> 
+               </object> 
+              </void> 
+             </object> 
+            </void> 
+            <void property="conf"> 
+             <object class="org.apache.hadoop.hive.ql.plan.selectDesc"> 
+              <void property="colList"> 
+               <object class="java.util.ArrayList"> 
+                <void method="add"> 
+                 <object idref="exprNodeConstantDesc0"/> 
+                </void> 
+                <void method="add"> 
+                 <object idref="exprNodeColumnDesc0"/> 
+                </void> 
+               </object> 
+              </void> 
+              <void property="outputColumnNames"> 
+               <object class="java.util.ArrayList"> 
+                <void method="add"> 
+                 <string>_col0</string> 
+                </void> 
+                <void method="add"> 
+                 <string>_col1</string> 
+                </void> 
+               </object> 
+              </void> 
+             </object> 
+            </void> 
+            <void property="parentOperators"> 
+             <object class="java.util.ArrayList"> 
+              <void method="add"> 
+               <object idref="TableScanOperator1"/> 
+              </void> 
+             </object> 
+            </void> 
+            <void property="schema"> 
+             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+              <void property="signature"> 
+               <object class="java.util.Vector"> 
+                <void method="add"> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>_col0</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo1"/> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void method="add"> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>_col1</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
+                </void> 
+               </object> 
+              </void> 
+             </object> 
+            </void> 
+           </object> 
+          </void> 
+         </object> 
+        </void> 
+        <void property="neededColumnIDs"> 
+         <object class="java.util.ArrayList"> 
+          <void method="add"> 
+           <int>0</int> 
+          </void> 
+         </object> 
+        </void> 
+        <void property="schema"> 
+         <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+          <void property="signature"> 
+           <object class="java.util.Vector"> 
+            <void method="add"> 
+             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+              <void property="internalName"> 
+               <string>key</string> 
+              </void> 
+              <void property="type"> 
+               <object idref="PrimitiveTypeInfo0"/> 
+              </void> 
+             </object> 
+            </void> 
+            <void method="add"> 
+             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+              <void property="internalName"> 
+               <string>value</string> 
+              </void> 
+              <void property="type"> 
+               <object idref="PrimitiveTypeInfo0"/> 
+              </void> 
+             </object> 
+            </void> 
+           </object> 
+          </void> 
+         </object> 
+        </void> 
+       </object> 
       </void> 
      </object> 
     </void> 
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/src1</string> 
+       <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/src1</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>src1</string> 
@@ -921,7 +743,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/src1</string> 
+       <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/src1</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/input9.q.xml b/ql/src/test/results/compiler/plan/input9.q.xml
index b2a8e4702e..082b142dfc 100644
--- a/ql/src/test/results/compiler/plan/input9.q.xml
+++ b/ql/src/test/results/compiler/plan/input9.q.xml
@@ -8,7 +8,7 @@
       <void property="childTasks"> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
-         <object id="MoveTask0" class="org.apache.hadoop.hive.ql.exec.MoveTask"> 
+         <object class="org.apache.hadoop.hive.ql.exec.MoveTask"> 
           <void property="id"> 
            <string>Stage-1</string> 
           </void> 
@@ -22,7 +22,7 @@
           <void property="work"> 
            <object class="org.apache.hadoop.hive.ql.plan.moveWork"> 
             <void property="loadTableWork"> 
-             <object id="loadTableDesc0" class="org.apache.hadoop.hive.ql.plan.loadTableDesc"> 
+             <object class="org.apache.hadoop.hive.ql.plan.loadTableDesc"> 
               <void property="partitionSpec"> 
                <object class="java.util.HashMap"/> 
               </void> 
@@ -30,7 +30,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/329905479/10000</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/513907470/10000</string> 
               </void> 
               <void property="table"> 
                <object id="tableDesc0" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -83,7 +83,7 @@
                   </void> 
                   <void method="put"> 
                    <string>location</string> 
-                   <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/dest1</string> 
+                   <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/dest1</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -93,7 +93,7 @@
                </object> 
               </void> 
               <void property="tmpDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/329905479/10001</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/513907470/10001</string> 
               </void> 
              </object> 
             </void> 
@@ -121,10 +121,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1660203383/10002</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1185353534/10002</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/329905479/10000</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/513907470/10000</string> 
               </void> 
              </object> 
             </void> 
@@ -142,7 +142,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1660203383/10002</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1185353534/10002</string> 
                <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -338,10 +338,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1660203383/10002</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1185353534/10002</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1660203383/10002</string> 
+                 <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1185353534/10002</string> 
                 </void> 
                </object> 
               </void> 
@@ -350,7 +350,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1660203383/10002</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1185353534/10002</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object idref="tableDesc0"/> 
@@ -368,7 +368,7 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/329905479/10000</string> 
+                     <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/513907470/10000</string> 
                     </void> 
                     <void property="tableInfo"> 
                      <object idref="tableDesc0"/> 
@@ -462,196 +462,197 @@
       </void> 
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
-        <void property="ctx"> 
-         <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext"> 
-          <void property="conf"> 
-           <object id="HiveConf0" class="org.apache.hadoop.hive.conf.HiveConf"> 
-            <void property="auxJars"> 
-             <string>file:///data/users/njain/hive3/hive3/build/ql/test/test-udfs.jar</string> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="currAliasId"> 
-           <string>src1</string> 
+        <void property="dir"> 
+         <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1185353534/10002</string> 
+        </void> 
+        <void property="listTasks"> 
+         <object idref="ArrayList0"/> 
+        </void> 
+       </object> 
+      </void> 
+      <void property="work"> 
+       <object class="org.apache.hadoop.hive.ql.plan.ConditionalWork"> 
+        <void property="listWorks"> 
+         <object class="java.util.ArrayList"> 
+          <void method="add"> 
+           <object idref="moveWork0"/> 
           </void> 
-          <void property="currTask"> 
-           <object idref="MapRedTask0"/> 
+          <void method="add"> 
+           <object idref="mapredWork0"/> 
           </void> 
-          <void property="currTopOp"> 
-           <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
+         </object> 
+        </void> 
+       </object> 
+      </void> 
+     </object> 
+    </void> 
+   </object> 
+  </void> 
+  <void property="id"> 
+   <string>Stage-2</string> 
+  </void> 
+  <void property="work"> 
+   <object class="org.apache.hadoop.hive.ql.plan.mapredWork"> 
+    <void property="aliasToPartnInfo"> 
+     <void method="put"> 
+      <string>src1</string> 
+      <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
+       <void property="partSpec"> 
+        <object id="LinkedHashMap0" class="java.util.LinkedHashMap"/> 
+       </void> 
+       <void property="tableDesc"> 
+        <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
+         <void property="deserializerClass"> 
+          <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
+         </void> 
+         <void property="inputFileFormatClass"> 
+          <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+         </void> 
+         <void property="outputFileFormatClass"> 
+          <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+         </void> 
+         <void property="properties"> 
+          <object id="Properties0" class="java.util.Properties"> 
+           <void method="put"> 
+            <string>name</string> 
+            <string>src1</string> 
+           </void> 
+           <void method="put"> 
+            <string>columns.types</string> 
+            <string>string:string</string> 
+           </void> 
+           <void method="put"> 
+            <string>serialization.ddl</string> 
+            <string>struct src1 { string key, string value}</string> 
+           </void> 
+           <void method="put"> 
+            <string>serialization.format</string> 
+            <string>1</string> 
+           </void> 
+           <void method="put"> 
+            <string>columns</string> 
+            <string>key,value</string> 
+           </void> 
+           <void method="put"> 
+            <string>bucket_count</string> 
+            <string>-1</string> 
+           </void> 
+           <void method="put"> 
+            <string>serialization.lib</string> 
+            <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+           </void> 
+           <void method="put"> 
+            <string>file.inputformat</string> 
+            <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+           </void> 
+           <void method="put"> 
+            <string>file.outputformat</string> 
+            <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+           </void> 
+           <void method="put"> 
+            <string>location</string> 
+            <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/src1</string> 
+           </void> 
+          </object> 
+         </void> 
+         <void property="serdeClassName"> 
+          <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+         </void> 
+        </object> 
+       </void> 
+      </object> 
+     </void> 
+    </void> 
+    <void property="aliasToWork"> 
+     <object class="java.util.LinkedHashMap"> 
+      <void method="put"> 
+       <string>src1</string> 
+       <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
+        <void property="childOperators"> 
+         <object class="java.util.ArrayList"> 
+          <void method="add"> 
+           <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
             <void property="childOperators"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+               <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+                   <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
                     <void property="childOperators"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                        <void property="childOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object id="FileSinkOperator0" class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                            <void property="conf"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
-                              <void property="destTableId"> 
-                               <int>1</int> 
-                              </void> 
-                              <void property="dirName"> 
-                               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1660203383/10002</string> 
-                              </void> 
-                              <void property="tableInfo"> 
-                               <object idref="tableDesc0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="parentOperators"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object idref="SelectOperator0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="schema"> 
-                             <object idref="RowSchema0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="columnExprMap"> 
-                         <object class="java.util.HashMap"> 
-                          <void method="put"> 
-                           <string>_col1</string> 
-                           <object id="exprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>key</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="put"> 
-                           <string>_col0</string> 
-                           <object id="exprNodeConstantDesc0" class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
+                       <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
                         <void property="conf"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.selectDesc"> 
-                          <void property="colList"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object idref="exprNodeConstantDesc0"/> 
-                            </void> 
-                            <void method="add"> 
-                             <object idref="exprNodeColumnDesc0"/> 
-                            </void> 
-                           </object> 
+                         <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
+                          <void property="destTableId"> 
+                           <int>1</int> 
                           </void> 
-                          <void property="outputColumnNames"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <string>_col0</string> 
-                            </void> 
-                            <void method="add"> 
-                             <string>_col1</string> 
-                            </void> 
-                           </object> 
+                          <void property="dirName"> 
+                           <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1185353534/10002</string> 
+                          </void> 
+                          <void property="tableInfo"> 
+                           <object idref="tableDesc0"/> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="parentOperators"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <object idref="FilterOperator1"/> 
+                           <object idref="SelectOperator0"/> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="schema"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                          <void property="signature"> 
-                           <object class="java.util.Vector"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>_col0</string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo2"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>_col1</string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo1"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
+                         <object idref="RowSchema0"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="columnExprMap"> 
+                     <object class="java.util.HashMap"> 
+                      <void method="put"> 
+                       <string>_col1</string> 
+                       <object id="exprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                        <void property="column"> 
+                         <string>key</string> 
+                        </void> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void method="put"> 
+                       <string>_col0</string> 
+                       <object id="exprNodeConstantDesc0" class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
                        </object> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.filterDesc"> 
-                      <void property="predicate"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                        <void property="UDFClass"> 
-                         <class>org.apache.hadoop.hive.ql.udf.UDFOPEqual</class> 
+                     <object class="org.apache.hadoop.hive.ql.plan.selectDesc"> 
+                      <void property="colList"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <object idref="exprNodeConstantDesc0"/> 
                         </void> 
-                        <void property="UDFMethod"> 
-                         <object id="Method0" class="org.apache.hadoop.hive.ql.udf.UDFOPEqual" method="getMethod"> 
-                          <string>evaluate</string> 
-                          <array class="java.lang.Class" length="2"> 
-                           <void index="0"> 
-                            <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
-                           </void> 
-                           <void index="1"> 
-                            <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
-                           </void> 
-                          </array> 
-                         </object> 
+                        <void method="add"> 
+                         <object idref="exprNodeColumnDesc0"/> 
                         </void> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
+                       </object> 
+                      </void> 
+                      <void property="outputColumnNames"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <string>_col0</string> 
                         </void> 
-                        <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo3" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>boolean</string> 
-                          </void> 
-                         </object> 
+                        <void method="add"> 
+                         <string>_col1</string> 
                         </void> 
                        </object> 
                       </void> 
@@ -660,28 +661,28 @@
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object idref="FilterOperator0"/> 
+                       <object idref="FilterOperator1"/> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="schema"> 
                      <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
                       <void property="signature"> 
-                       <object id="Vector0" class="java.util.Vector"> 
+                       <object class="java.util.Vector"> 
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                           <void property="internalName"> 
-                           <string>key</string> 
+                           <string>_col0</string> 
                           </void> 
                           <void property="type"> 
-                           <object idref="PrimitiveTypeInfo1"/> 
+                           <object idref="PrimitiveTypeInfo2"/> 
                           </void> 
                          </object> 
                         </void> 
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                           <void property="internalName"> 
-                           <string>value</string> 
+                           <string>_col1</string> 
                           </void> 
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo1"/> 
@@ -704,7 +705,17 @@
                      <class>org.apache.hadoop.hive.ql.udf.UDFOPEqual</class> 
                     </void> 
                     <void property="UDFMethod"> 
-                     <object idref="Method0"/> 
+                     <object id="Method0" class="org.apache.hadoop.hive.ql.udf.UDFOPEqual" method="getMethod"> 
+                      <string>evaluate</string> 
+                      <array class="java.lang.Class" length="2"> 
+                       <void index="0"> 
+                        <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
+                       </void> 
+                       <void index="1"> 
+                        <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
+                       </void> 
+                      </array> 
+                     </object> 
                     </void> 
                     <void property="childExprs"> 
                      <object class="java.util.ArrayList"> 
@@ -725,7 +736,11 @@
                      </object> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo3"/> 
+                     <object id="PrimitiveTypeInfo3" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                      <void property="typeName"> 
+                       <string>boolean</string> 
+                      </void> 
+                     </object> 
                     </void> 
                    </object> 
                   </void> 
@@ -734,14 +749,35 @@
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object idref="TableScanOperator1"/> 
+                   <object idref="FilterOperator0"/> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="schema"> 
                  <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
                   <void property="signature"> 
-                   <object idref="Vector0"/> 
+                   <object id="Vector0" class="java.util.Vector"> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="internalName"> 
+                       <string>key</string> 
+                      </void> 
+                      <void property="type"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="internalName"> 
+                       <string>value</string> 
+                      </void> 
+                      <void property="type"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                   </object> 
                   </void> 
                  </object> 
                 </void> 
@@ -749,223 +785,70 @@
               </void> 
              </object> 
             </void> 
-            <void property="neededColumnIDs"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <int>0</int> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object idref="Vector0"/> 
-              </void> 
-             </object> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="mapCurrCtx"> 
-           <object class="java.util.LinkedHashMap"> 
-            <void method="put"> 
-             <object idref="TableScanOperator1"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-            <void method="put"> 
-             <object idref="FilterOperator0"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-            <void method="put"> 
-             <object idref="FilterOperator1"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-            <void method="put"> 
-             <object idref="SelectOperator0"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="mvTask"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="MoveTask0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="opTaskMap"> 
-           <object class="java.util.HashMap"> 
-            <void method="put"> 
-             <null/> 
-             <object idref="MapRedTask0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="parseCtx"> 
-           <object class="org.apache.hadoop.hive.ql.parse.ParseContext"> 
-            <void property="QB"> 
-             <object class="org.apache.hadoop.hive.ql.parse.QB"/> 
-            </void> 
-            <void property="UCtx"> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.unionproc.UnionProcContext"/> 
-            </void> 
-            <void property="aliasToPruner"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>src1</string> 
-               <object class="org.apache.hadoop.hive.ql.parse.PartitionPruner"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="aliasToSamplePruner"> 
-             <object class="java.util.HashMap"/> 
-            </void> 
             <void property="conf"> 
-             <object idref="HiveConf0"/> 
-            </void> 
-            <void property="context"> 
-             <object class="org.apache.hadoop.hive.ql.Context"/> 
-            </void> 
-            <void property="destTableId"> 
-             <int>2</int> 
-            </void> 
-            <void property="idToTableNameMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>1</string> 
-               <string>dest1</string> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="joinContext"> 
-             <object class="java.util.HashMap"/> 
-            </void> 
-            <void property="listMapJoinOpsNoReducer"> 
-             <object class="java.util.ArrayList"/> 
-            </void> 
-            <void property="loadFileWork"> 
-             <object class="java.util.ArrayList"/> 
-            </void> 
-            <void property="loadTableWork"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="loadTableDesc0"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="opParseCtx"> 
-             <object class="java.util.LinkedHashMap"> 
-              <void method="put"> 
-               <object idref="TableScanOperator1"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object id="RowResolver0" class="org.apache.hadoop.hive.ql.parse.RowResolver"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="FilterOperator1"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object idref="RowResolver0"/> 
+             <object class="org.apache.hadoop.hive.ql.plan.filterDesc"> 
+              <void property="predicate"> 
+               <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                <void property="UDFClass"> 
+                 <class>org.apache.hadoop.hive.ql.udf.UDFOPEqual</class> 
                 </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="SelectOperator0"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object id="RowResolver1" class="org.apache.hadoop.hive.ql.parse.RowResolver"/> 
+                <void property="UDFMethod"> 
+                 <object idref="Method0"/> 
                 </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="FileSinkOperator0"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object idref="RowResolver1"/> 
+                <void property="childExprs"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
                 </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="FilterOperator0"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object idref="RowResolver0"/> 
+                <void property="typeInfo"> 
+                 <object idref="PrimitiveTypeInfo3"/> 
                 </void> 
                </object> 
               </void> 
              </object> 
             </void> 
-            <void property="parseTree"> 
-             <object class="org.apache.hadoop.hive.ql.parse.ASTNode"> 
-              <void property="tokenStartIndex"> 
-               <int>0</int> 
-              </void> 
-              <void property="tokenStopIndex"> 
-               <int>27</int> 
+            <void property="parentOperators"> 
+             <object class="java.util.ArrayList"> 
+              <void method="add"> 
+               <object idref="TableScanOperator1"/> 
               </void> 
              </object> 
             </void> 
-            <void property="topOps"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>src1</string> 
-               <object idref="TableScanOperator1"/> 
+            <void property="schema"> 
+             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+              <void property="signature"> 
+               <object idref="Vector0"/> 
               </void> 
              </object> 
             </void> 
-            <void property="topSelOps"> 
-             <object class="java.util.HashMap"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="rootOps"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="TableScanOperator1"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="rootTasks"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="MapRedTask0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="seenFileSinkOps"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="FileSinkOperator0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="seenOps"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="TableScanOperator1"/> 
-            </void> 
            </object> 
           </void> 
          </object> 
         </void> 
-        <void property="dir"> 
-         <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1660203383/10002</string> 
-        </void> 
-        <void property="listTasks"> 
-         <object idref="ArrayList0"/> 
-        </void> 
-       </object> 
-      </void> 
-      <void property="work"> 
-       <object class="org.apache.hadoop.hive.ql.plan.ConditionalWork"> 
-        <void property="listWorks"> 
+        <void property="neededColumnIDs"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <object idref="moveWork0"/> 
+           <int>0</int> 
           </void> 
-          <void method="add"> 
-           <object idref="mapredWork0"/> 
+         </object> 
+        </void> 
+        <void property="schema"> 
+         <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+          <void property="signature"> 
+           <object idref="Vector0"/> 
           </void> 
          </object> 
         </void> 
@@ -973,95 +856,10 @@
       </void> 
      </object> 
     </void> 
-   </object> 
-  </void> 
-  <void property="id"> 
-   <string>Stage-2</string> 
-  </void> 
-  <void property="work"> 
-   <object class="org.apache.hadoop.hive.ql.plan.mapredWork"> 
-    <void property="aliasToPartnInfo"> 
-     <void method="put"> 
-      <string>src1</string> 
-      <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
-       <void property="partSpec"> 
-        <object id="LinkedHashMap0" class="java.util.LinkedHashMap"/> 
-       </void> 
-       <void property="tableDesc"> 
-        <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
-         <void property="deserializerClass"> 
-          <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
-         </void> 
-         <void property="inputFileFormatClass"> 
-          <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-         </void> 
-         <void property="outputFileFormatClass"> 
-          <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-         </void> 
-         <void property="properties"> 
-          <object id="Properties0" class="java.util.Properties"> 
-           <void method="put"> 
-            <string>name</string> 
-            <string>src1</string> 
-           </void> 
-           <void method="put"> 
-            <string>columns.types</string> 
-            <string>string:string</string> 
-           </void> 
-           <void method="put"> 
-            <string>serialization.ddl</string> 
-            <string>struct src1 { string key, string value}</string> 
-           </void> 
-           <void method="put"> 
-            <string>serialization.format</string> 
-            <string>1</string> 
-           </void> 
-           <void method="put"> 
-            <string>columns</string> 
-            <string>key,value</string> 
-           </void> 
-           <void method="put"> 
-            <string>bucket_count</string> 
-            <string>-1</string> 
-           </void> 
-           <void method="put"> 
-            <string>serialization.lib</string> 
-            <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-           </void> 
-           <void method="put"> 
-            <string>file.inputformat</string> 
-            <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-           </void> 
-           <void method="put"> 
-            <string>file.outputformat</string> 
-            <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-           </void> 
-           <void method="put"> 
-            <string>location</string> 
-            <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/src1</string> 
-           </void> 
-          </object> 
-         </void> 
-         <void property="serdeClassName"> 
-          <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-         </void> 
-        </object> 
-       </void> 
-      </object> 
-     </void> 
-    </void> 
-    <void property="aliasToWork"> 
-     <object class="java.util.LinkedHashMap"> 
-      <void method="put"> 
-       <string>src1</string> 
-       <object idref="TableScanOperator1"/> 
-      </void> 
-     </object> 
-    </void> 
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/src1</string> 
+       <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/src1</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>src1</string> 
@@ -1073,7 +871,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/src1</string> 
+       <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/src1</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/input_testsequencefile.q.xml b/ql/src/test/results/compiler/plan/input_testsequencefile.q.xml
index 3b5a0dbf81..258e6f1507 100644
--- a/ql/src/test/results/compiler/plan/input_testsequencefile.q.xml
+++ b/ql/src/test/results/compiler/plan/input_testsequencefile.q.xml
@@ -8,7 +8,7 @@
       <void property="childTasks"> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
-         <object id="MoveTask0" class="org.apache.hadoop.hive.ql.exec.MoveTask"> 
+         <object class="org.apache.hadoop.hive.ql.exec.MoveTask"> 
           <void property="id"> 
            <string>Stage-1</string> 
           </void> 
@@ -22,7 +22,7 @@
           <void property="work"> 
            <object class="org.apache.hadoop.hive.ql.plan.moveWork"> 
             <void property="loadTableWork"> 
-             <object id="loadTableDesc0" class="org.apache.hadoop.hive.ql.plan.loadTableDesc"> 
+             <object class="org.apache.hadoop.hive.ql.plan.loadTableDesc"> 
               <void property="partitionSpec"> 
                <object class="java.util.HashMap"/> 
               </void> 
@@ -30,7 +30,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1404043825/10000</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1327463869/10000</string> 
               </void> 
               <void property="table"> 
                <object id="tableDesc0" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -83,7 +83,7 @@
                   </void> 
                   <void method="put"> 
                    <string>location</string> 
-                   <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/dest4_sequencefile</string> 
+                   <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/dest4_sequencefile</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -93,7 +93,7 @@
                </object> 
               </void> 
               <void property="tmpDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1404043825/10001</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1327463869/10001</string> 
               </void> 
              </object> 
             </void> 
@@ -121,10 +121,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/155650378/10002</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/749310906/10002</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1404043825/10000</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1327463869/10000</string> 
               </void> 
              </object> 
             </void> 
@@ -142,7 +142,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/155650378/10002</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/749310906/10002</string> 
                <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -338,10 +338,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/155650378/10002</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/749310906/10002</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/155650378/10002</string> 
+                 <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/749310906/10002</string> 
                 </void> 
                </object> 
               </void> 
@@ -350,7 +350,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/155650378/10002</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/749310906/10002</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object idref="tableDesc0"/> 
@@ -368,7 +368,7 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1404043825/10000</string> 
+                     <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1327463869/10000</string> 
                     </void> 
                     <void property="tableInfo"> 
                      <object idref="tableDesc0"/> 
@@ -458,349 +458,8 @@
       </void> 
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
-        <void property="ctx"> 
-         <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext"> 
-          <void property="conf"> 
-           <object id="HiveConf0" class="org.apache.hadoop.hive.conf.HiveConf"> 
-            <void property="auxJars"> 
-             <string>file:///data/users/njain/hive3/hive3/build/ql/test/test-udfs.jar</string> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="currAliasId"> 
-           <string>src</string> 
-          </void> 
-          <void property="currTask"> 
-           <object idref="MapRedTask0"/> 
-          </void> 
-          <void property="currTopOp"> 
-           <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                <void property="childOperators"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object id="FileSinkOperator0" class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
-                      <void property="destTableId"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="dirName"> 
-                       <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/155650378/10002</string> 
-                      </void> 
-                      <void property="tableInfo"> 
-                       <object idref="tableDesc0"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="SelectOperator0"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="schema"> 
-                     <object idref="RowSchema0"/> 
-                    </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="columnExprMap"> 
-                 <object class="java.util.HashMap"> 
-                  <void method="put"> 
-                   <string>_col1</string> 
-                   <object id="exprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>value</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void method="put"> 
-                   <string>_col0</string> 
-                   <object id="exprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>key</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.selectDesc"> 
-                  <void property="colList"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="exprNodeColumnDesc1"/> 
-                    </void> 
-                    <void method="add"> 
-                     <object idref="exprNodeColumnDesc0"/> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void property="outputColumnNames"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <string>_col0</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col1</string> 
-                    </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="parentOperators"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object idref="TableScanOperator1"/> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.Vector"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="neededColumnIDs"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <int>0</int> 
-              </void> 
-              <void method="add"> 
-               <int>1</int> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.Vector"> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>key</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>value</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="mapCurrCtx"> 
-           <object class="java.util.LinkedHashMap"> 
-            <void method="put"> 
-             <object idref="TableScanOperator1"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-            <void method="put"> 
-             <object idref="SelectOperator0"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="mvTask"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="MoveTask0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="opTaskMap"> 
-           <object class="java.util.HashMap"> 
-            <void method="put"> 
-             <null/> 
-             <object idref="MapRedTask0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="parseCtx"> 
-           <object class="org.apache.hadoop.hive.ql.parse.ParseContext"> 
-            <void property="QB"> 
-             <object class="org.apache.hadoop.hive.ql.parse.QB"/> 
-            </void> 
-            <void property="UCtx"> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.unionproc.UnionProcContext"/> 
-            </void> 
-            <void property="aliasToPruner"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>src</string> 
-               <object class="org.apache.hadoop.hive.ql.parse.PartitionPruner"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="aliasToSamplePruner"> 
-             <object class="java.util.HashMap"/> 
-            </void> 
-            <void property="conf"> 
-             <object idref="HiveConf0"/> 
-            </void> 
-            <void property="context"> 
-             <object class="org.apache.hadoop.hive.ql.Context"/> 
-            </void> 
-            <void property="destTableId"> 
-             <int>2</int> 
-            </void> 
-            <void property="idToTableNameMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>1</string> 
-               <string>dest4_sequencefile</string> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="joinContext"> 
-             <object class="java.util.HashMap"/> 
-            </void> 
-            <void property="listMapJoinOpsNoReducer"> 
-             <object class="java.util.ArrayList"/> 
-            </void> 
-            <void property="loadFileWork"> 
-             <object class="java.util.ArrayList"/> 
-            </void> 
-            <void property="loadTableWork"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="loadTableDesc0"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="opParseCtx"> 
-             <object class="java.util.LinkedHashMap"> 
-              <void method="put"> 
-               <object idref="TableScanOperator1"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object class="org.apache.hadoop.hive.ql.parse.RowResolver"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="SelectOperator0"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object id="RowResolver0" class="org.apache.hadoop.hive.ql.parse.RowResolver"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="FileSinkOperator0"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object idref="RowResolver0"/> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="parseTree"> 
-             <object class="org.apache.hadoop.hive.ql.parse.ASTNode"> 
-              <void property="tokenStartIndex"> 
-               <int>0</int> 
-              </void> 
-              <void property="tokenStopIndex"> 
-               <int>21</int> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="topOps"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>src</string> 
-               <object idref="TableScanOperator1"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="topSelOps"> 
-             <object class="java.util.HashMap"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="rootOps"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="TableScanOperator1"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="rootTasks"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="MapRedTask0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="seenFileSinkOps"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="FileSinkOperator0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="seenOps"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="TableScanOperator1"/> 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
-        </void> 
         <void property="dir"> 
-         <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/155650378/10002</string> 
+         <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/749310906/10002</string> 
         </void> 
         <void property="listTasks"> 
          <object idref="ArrayList0"/> 
@@ -888,7 +547,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/src</string> 
+            <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/src</string> 
            </void> 
           </object> 
          </void> 
@@ -904,14 +563,177 @@
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
        <string>src</string> 
-       <object idref="TableScanOperator1"/> 
+       <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
+        <void property="childOperators"> 
+         <object class="java.util.ArrayList"> 
+          <void method="add"> 
+           <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+            <void property="childOperators"> 
+             <object class="java.util.ArrayList"> 
+              <void method="add"> 
+               <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                <void property="conf"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
+                  <void property="destTableId"> 
+                   <int>1</int> 
+                  </void> 
+                  <void property="dirName"> 
+                   <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/749310906/10002</string> 
+                  </void> 
+                  <void property="tableInfo"> 
+                   <object idref="tableDesc0"/> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="parentOperators"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object idref="SelectOperator0"/> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="schema"> 
+                 <object idref="RowSchema0"/> 
+                </void> 
+               </object> 
+              </void> 
+             </object> 
+            </void> 
+            <void property="columnExprMap"> 
+             <object class="java.util.HashMap"> 
+              <void method="put"> 
+               <string>_col1</string> 
+               <object id="exprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                <void property="column"> 
+                 <string>value</string> 
+                </void> 
+                <void property="typeInfo"> 
+                 <object idref="PrimitiveTypeInfo0"/> 
+                </void> 
+               </object> 
+              </void> 
+              <void method="put"> 
+               <string>_col0</string> 
+               <object id="exprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                <void property="column"> 
+                 <string>key</string> 
+                </void> 
+                <void property="typeInfo"> 
+                 <object idref="PrimitiveTypeInfo0"/> 
+                </void> 
+               </object> 
+              </void> 
+             </object> 
+            </void> 
+            <void property="conf"> 
+             <object class="org.apache.hadoop.hive.ql.plan.selectDesc"> 
+              <void property="colList"> 
+               <object class="java.util.ArrayList"> 
+                <void method="add"> 
+                 <object idref="exprNodeColumnDesc1"/> 
+                </void> 
+                <void method="add"> 
+                 <object idref="exprNodeColumnDesc0"/> 
+                </void> 
+               </object> 
+              </void> 
+              <void property="outputColumnNames"> 
+               <object class="java.util.ArrayList"> 
+                <void method="add"> 
+                 <string>_col0</string> 
+                </void> 
+                <void method="add"> 
+                 <string>_col1</string> 
+                </void> 
+               </object> 
+              </void> 
+             </object> 
+            </void> 
+            <void property="parentOperators"> 
+             <object class="java.util.ArrayList"> 
+              <void method="add"> 
+               <object idref="TableScanOperator1"/> 
+              </void> 
+             </object> 
+            </void> 
+            <void property="schema"> 
+             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+              <void property="signature"> 
+               <object class="java.util.Vector"> 
+                <void method="add"> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>_col0</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void method="add"> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>_col1</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
+                </void> 
+               </object> 
+              </void> 
+             </object> 
+            </void> 
+           </object> 
+          </void> 
+         </object> 
+        </void> 
+        <void property="neededColumnIDs"> 
+         <object class="java.util.ArrayList"> 
+          <void method="add"> 
+           <int>0</int> 
+          </void> 
+          <void method="add"> 
+           <int>1</int> 
+          </void> 
+         </object> 
+        </void> 
+        <void property="schema"> 
+         <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+          <void property="signature"> 
+           <object class="java.util.Vector"> 
+            <void method="add"> 
+             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+              <void property="internalName"> 
+               <string>key</string> 
+              </void> 
+              <void property="type"> 
+               <object idref="PrimitiveTypeInfo0"/> 
+              </void> 
+             </object> 
+            </void> 
+            <void method="add"> 
+             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+              <void property="internalName"> 
+               <string>value</string> 
+              </void> 
+              <void property="type"> 
+               <object idref="PrimitiveTypeInfo0"/> 
+              </void> 
+             </object> 
+            </void> 
+           </object> 
+          </void> 
+         </object> 
+        </void> 
+       </object> 
       </void> 
      </object> 
     </void> 
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/src</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>src</string> 
@@ -923,7 +745,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/src</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/sample2.q.xml b/ql/src/test/results/compiler/plan/sample2.q.xml
index d65499d17d..0b81dcc8f6 100644
--- a/ql/src/test/results/compiler/plan/sample2.q.xml
+++ b/ql/src/test/results/compiler/plan/sample2.q.xml
@@ -8,7 +8,7 @@
       <void property="childTasks"> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
-         <object id="MoveTask0" class="org.apache.hadoop.hive.ql.exec.MoveTask"> 
+         <object class="org.apache.hadoop.hive.ql.exec.MoveTask"> 
           <void property="id"> 
            <string>Stage-1</string> 
           </void> 
@@ -22,7 +22,7 @@
           <void property="work"> 
            <object class="org.apache.hadoop.hive.ql.plan.moveWork"> 
             <void property="loadTableWork"> 
-             <object id="loadTableDesc0" class="org.apache.hadoop.hive.ql.plan.loadTableDesc"> 
+             <object class="org.apache.hadoop.hive.ql.plan.loadTableDesc"> 
               <void property="partitionSpec"> 
                <object class="java.util.HashMap"/> 
               </void> 
@@ -30,7 +30,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1575025695/10000</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/2080715857/10000</string> 
               </void> 
               <void property="table"> 
                <object id="tableDesc0" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -83,7 +83,7 @@
                   </void> 
                   <void method="put"> 
                    <string>location</string> 
-                   <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/dest1</string> 
+                   <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/dest1</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -93,7 +93,7 @@
                </object> 
               </void> 
               <void property="tmpDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1575025695/10001</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/2080715857/10001</string> 
               </void> 
              </object> 
             </void> 
@@ -121,10 +121,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1722747814/10002</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1948687541/10002</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1575025695/10000</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/2080715857/10000</string> 
               </void> 
              </object> 
             </void> 
@@ -142,7 +142,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1722747814/10002</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1948687541/10002</string> 
                <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -338,10 +338,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1722747814/10002</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1948687541/10002</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1722747814/10002</string> 
+                 <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1948687541/10002</string> 
                 </void> 
                </object> 
               </void> 
@@ -350,7 +350,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1722747814/10002</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1948687541/10002</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object idref="tableDesc0"/> 
@@ -368,7 +368,7 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1575025695/10000</string> 
+                     <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/2080715857/10000</string> 
                     </void> 
                     <void property="tableInfo"> 
                      <object idref="tableDesc0"/> 
@@ -458,352 +458,8 @@
       </void> 
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
-        <void property="ctx"> 
-         <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext"> 
-          <void property="conf"> 
-           <object id="HiveConf0" class="org.apache.hadoop.hive.conf.HiveConf"> 
-            <void property="auxJars"> 
-             <string>file:///data/users/njain/hive3/hive3/build/ql/test/test-udfs.jar</string> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="currAliasId"> 
-           <string>s</string> 
-          </void> 
-          <void property="currTask"> 
-           <object idref="MapRedTask0"/> 
-          </void> 
-          <void property="currTopOp"> 
-           <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                <void property="childOperators"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object id="FileSinkOperator0" class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
-                      <void property="destTableId"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="dirName"> 
-                       <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1722747814/10002</string> 
-                      </void> 
-                      <void property="tableInfo"> 
-                       <object idref="tableDesc0"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="SelectOperator0"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="schema"> 
-                     <object idref="RowSchema0"/> 
-                    </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="columnExprMap"> 
-                 <object class="java.util.HashMap"> 
-                  <void method="put"> 
-                   <string>_col1</string> 
-                   <object id="exprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>value</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void method="put"> 
-                   <string>_col0</string> 
-                   <object id="exprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>key</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.selectDesc"> 
-                  <void property="colList"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="exprNodeColumnDesc1"/> 
-                    </void> 
-                    <void method="add"> 
-                     <object idref="exprNodeColumnDesc0"/> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void property="outputColumnNames"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <string>_col0</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col1</string> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void property="selectStar"> 
-                   <boolean>true</boolean> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="parentOperators"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object idref="TableScanOperator1"/> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.Vector"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="neededColumnIDs"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <int>0</int> 
-              </void> 
-              <void method="add"> 
-               <int>1</int> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.Vector"> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>key</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>value</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="mapCurrCtx"> 
-           <object class="java.util.LinkedHashMap"> 
-            <void method="put"> 
-             <object idref="TableScanOperator1"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-            <void method="put"> 
-             <object idref="SelectOperator0"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="mvTask"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="MoveTask0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="opTaskMap"> 
-           <object class="java.util.HashMap"> 
-            <void method="put"> 
-             <null/> 
-             <object idref="MapRedTask0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="parseCtx"> 
-           <object class="org.apache.hadoop.hive.ql.parse.ParseContext"> 
-            <void property="QB"> 
-             <object class="org.apache.hadoop.hive.ql.parse.QB"/> 
-            </void> 
-            <void property="UCtx"> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.unionproc.UnionProcContext"/> 
-            </void> 
-            <void property="aliasToPruner"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>s</string> 
-               <object class="org.apache.hadoop.hive.ql.parse.PartitionPruner"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="aliasToSamplePruner"> 
-             <object class="java.util.HashMap"/> 
-            </void> 
-            <void property="conf"> 
-             <object idref="HiveConf0"/> 
-            </void> 
-            <void property="context"> 
-             <object class="org.apache.hadoop.hive.ql.Context"/> 
-            </void> 
-            <void property="destTableId"> 
-             <int>2</int> 
-            </void> 
-            <void property="idToTableNameMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>1</string> 
-               <string>dest1</string> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="joinContext"> 
-             <object class="java.util.HashMap"/> 
-            </void> 
-            <void property="listMapJoinOpsNoReducer"> 
-             <object class="java.util.ArrayList"/> 
-            </void> 
-            <void property="loadFileWork"> 
-             <object class="java.util.ArrayList"/> 
-            </void> 
-            <void property="loadTableWork"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="loadTableDesc0"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="opParseCtx"> 
-             <object class="java.util.LinkedHashMap"> 
-              <void method="put"> 
-               <object idref="TableScanOperator1"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object class="org.apache.hadoop.hive.ql.parse.RowResolver"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="SelectOperator0"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object id="RowResolver0" class="org.apache.hadoop.hive.ql.parse.RowResolver"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="FileSinkOperator0"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object idref="RowResolver0"/> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="parseTree"> 
-             <object class="org.apache.hadoop.hive.ql.parse.ASTNode"> 
-              <void property="tokenStartIndex"> 
-               <int>4</int> 
-              </void> 
-              <void property="tokenStopIndex"> 
-               <int>37</int> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="topOps"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>s</string> 
-               <object idref="TableScanOperator1"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="topSelOps"> 
-             <object class="java.util.HashMap"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="rootOps"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="TableScanOperator1"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="rootTasks"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="MapRedTask0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="seenFileSinkOps"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="FileSinkOperator0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="seenOps"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="TableScanOperator1"/> 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
-        </void> 
         <void property="dir"> 
-         <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1722747814/10002</string> 
+         <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1948687541/10002</string> 
         </void> 
         <void property="listTasks"> 
          <object idref="ArrayList0"/> 
@@ -895,7 +551,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/srcbucket</string> 
+            <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/srcbucket</string> 
            </void> 
           </object> 
          </void> 
@@ -911,14 +567,180 @@
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
        <string>s</string> 
-       <object idref="TableScanOperator1"/> 
+       <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
+        <void property="childOperators"> 
+         <object class="java.util.ArrayList"> 
+          <void method="add"> 
+           <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+            <void property="childOperators"> 
+             <object class="java.util.ArrayList"> 
+              <void method="add"> 
+               <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                <void property="conf"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
+                  <void property="destTableId"> 
+                   <int>1</int> 
+                  </void> 
+                  <void property="dirName"> 
+                   <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1948687541/10002</string> 
+                  </void> 
+                  <void property="tableInfo"> 
+                   <object idref="tableDesc0"/> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="parentOperators"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object idref="SelectOperator0"/> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="schema"> 
+                 <object idref="RowSchema0"/> 
+                </void> 
+               </object> 
+              </void> 
+             </object> 
+            </void> 
+            <void property="columnExprMap"> 
+             <object class="java.util.HashMap"> 
+              <void method="put"> 
+               <string>_col1</string> 
+               <object id="exprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                <void property="column"> 
+                 <string>value</string> 
+                </void> 
+                <void property="typeInfo"> 
+                 <object idref="PrimitiveTypeInfo0"/> 
+                </void> 
+               </object> 
+              </void> 
+              <void method="put"> 
+               <string>_col0</string> 
+               <object id="exprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                <void property="column"> 
+                 <string>key</string> 
+                </void> 
+                <void property="typeInfo"> 
+                 <object idref="PrimitiveTypeInfo0"/> 
+                </void> 
+               </object> 
+              </void> 
+             </object> 
+            </void> 
+            <void property="conf"> 
+             <object class="org.apache.hadoop.hive.ql.plan.selectDesc"> 
+              <void property="colList"> 
+               <object class="java.util.ArrayList"> 
+                <void method="add"> 
+                 <object idref="exprNodeColumnDesc1"/> 
+                </void> 
+                <void method="add"> 
+                 <object idref="exprNodeColumnDesc0"/> 
+                </void> 
+               </object> 
+              </void> 
+              <void property="outputColumnNames"> 
+               <object class="java.util.ArrayList"> 
+                <void method="add"> 
+                 <string>_col0</string> 
+                </void> 
+                <void method="add"> 
+                 <string>_col1</string> 
+                </void> 
+               </object> 
+              </void> 
+              <void property="selectStar"> 
+               <boolean>true</boolean> 
+              </void> 
+             </object> 
+            </void> 
+            <void property="parentOperators"> 
+             <object class="java.util.ArrayList"> 
+              <void method="add"> 
+               <object idref="TableScanOperator1"/> 
+              </void> 
+             </object> 
+            </void> 
+            <void property="schema"> 
+             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+              <void property="signature"> 
+               <object class="java.util.Vector"> 
+                <void method="add"> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>_col0</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void method="add"> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>_col1</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
+                </void> 
+               </object> 
+              </void> 
+             </object> 
+            </void> 
+           </object> 
+          </void> 
+         </object> 
+        </void> 
+        <void property="neededColumnIDs"> 
+         <object class="java.util.ArrayList"> 
+          <void method="add"> 
+           <int>0</int> 
+          </void> 
+          <void method="add"> 
+           <int>1</int> 
+          </void> 
+         </object> 
+        </void> 
+        <void property="schema"> 
+         <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+          <void property="signature"> 
+           <object class="java.util.Vector"> 
+            <void method="add"> 
+             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+              <void property="internalName"> 
+               <string>key</string> 
+              </void> 
+              <void property="type"> 
+               <object idref="PrimitiveTypeInfo0"/> 
+              </void> 
+             </object> 
+            </void> 
+            <void method="add"> 
+             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+              <void property="internalName"> 
+               <string>value</string> 
+              </void> 
+              <void property="type"> 
+               <object idref="PrimitiveTypeInfo0"/> 
+              </void> 
+             </object> 
+            </void> 
+           </object> 
+          </void> 
+         </object> 
+        </void> 
+       </object> 
       </void> 
      </object> 
     </void> 
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/srcbucket/kv1.txt</string> 
+       <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/srcbucket/kv1.txt</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>s</string> 
@@ -930,7 +752,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/srcbucket/kv1.txt</string> 
+       <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/srcbucket/kv1.txt</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/sample3.q.xml b/ql/src/test/results/compiler/plan/sample3.q.xml
index 853966e569..20f028d6f3 100644
--- a/ql/src/test/results/compiler/plan/sample3.q.xml
+++ b/ql/src/test/results/compiler/plan/sample3.q.xml
@@ -8,7 +8,7 @@
       <void property="childTasks"> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
-         <object id="MoveTask0" class="org.apache.hadoop.hive.ql.exec.MoveTask"> 
+         <object class="org.apache.hadoop.hive.ql.exec.MoveTask"> 
           <void property="id"> 
            <string>Stage-1</string> 
           </void> 
@@ -22,7 +22,7 @@
           <void property="work"> 
            <object class="org.apache.hadoop.hive.ql.plan.moveWork"> 
             <void property="loadTableWork"> 
-             <object id="loadTableDesc0" class="org.apache.hadoop.hive.ql.plan.loadTableDesc"> 
+             <object class="org.apache.hadoop.hive.ql.plan.loadTableDesc"> 
               <void property="partitionSpec"> 
                <object class="java.util.HashMap"/> 
               </void> 
@@ -30,7 +30,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1873063073/10000</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/2063028892/10000</string> 
               </void> 
               <void property="table"> 
                <object id="tableDesc0" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -83,7 +83,7 @@
                   </void> 
                   <void method="put"> 
                    <string>location</string> 
-                   <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/dest1</string> 
+                   <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/dest1</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -93,7 +93,7 @@
                </object> 
               </void> 
               <void property="tmpDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1873063073/10001</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/2063028892/10001</string> 
               </void> 
              </object> 
             </void> 
@@ -121,10 +121,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1022758072/10002</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/862492203/10002</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1873063073/10000</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/2063028892/10000</string> 
               </void> 
              </object> 
             </void> 
@@ -142,7 +142,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1022758072/10002</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/862492203/10002</string> 
                <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -338,10 +338,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1022758072/10002</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/862492203/10002</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1022758072/10002</string> 
+                 <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/862492203/10002</string> 
                 </void> 
                </object> 
               </void> 
@@ -350,7 +350,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1022758072/10002</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/862492203/10002</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object idref="tableDesc0"/> 
@@ -368,7 +368,7 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1873063073/10000</string> 
+                     <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/2063028892/10000</string> 
                     </void> 
                     <void property="tableInfo"> 
                      <object idref="tableDesc0"/> 
@@ -458,151 +458,240 @@
       </void> 
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
-        <void property="ctx"> 
-         <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext"> 
-          <void property="conf"> 
-           <object id="HiveConf0" class="org.apache.hadoop.hive.conf.HiveConf"> 
-            <void property="auxJars"> 
-             <string>file:///data/users/njain/hive3/hive3/build/ql/test/test-udfs.jar</string> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="currAliasId"> 
-           <string>s</string> 
+        <void property="dir"> 
+         <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/862492203/10002</string> 
+        </void> 
+        <void property="listTasks"> 
+         <object idref="ArrayList0"/> 
+        </void> 
+       </object> 
+      </void> 
+      <void property="work"> 
+       <object class="org.apache.hadoop.hive.ql.plan.ConditionalWork"> 
+        <void property="listWorks"> 
+         <object class="java.util.ArrayList"> 
+          <void method="add"> 
+           <object idref="moveWork0"/> 
           </void> 
-          <void property="currTask"> 
-           <object idref="MapRedTask0"/> 
+          <void method="add"> 
+           <object idref="mapredWork0"/> 
           </void> 
-          <void property="currTopOp"> 
-           <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
+         </object> 
+        </void> 
+       </object> 
+      </void> 
+     </object> 
+    </void> 
+   </object> 
+  </void> 
+  <void property="id"> 
+   <string>Stage-2</string> 
+  </void> 
+  <void property="work"> 
+   <object class="org.apache.hadoop.hive.ql.plan.mapredWork"> 
+    <void property="aliasToPartnInfo"> 
+     <void method="put"> 
+      <string>s</string> 
+      <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
+       <void property="partSpec"> 
+        <object id="LinkedHashMap0" class="java.util.LinkedHashMap"/> 
+       </void> 
+       <void property="tableDesc"> 
+        <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
+         <void property="deserializerClass"> 
+          <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
+         </void> 
+         <void property="inputFileFormatClass"> 
+          <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+         </void> 
+         <void property="outputFileFormatClass"> 
+          <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+         </void> 
+         <void property="properties"> 
+          <object id="Properties0" class="java.util.Properties"> 
+           <void method="put"> 
+            <string>name</string> 
+            <string>srcbucket</string> 
+           </void> 
+           <void method="put"> 
+            <string>columns.types</string> 
+            <string>string:string</string> 
+           </void> 
+           <void method="put"> 
+            <string>bucket_field_name</string> 
+            <string>key</string> 
+           </void> 
+           <void method="put"> 
+            <string>serialization.ddl</string> 
+            <string>struct srcbucket { string key, string value}</string> 
+           </void> 
+           <void method="put"> 
+            <string>columns</string> 
+            <string>key,value</string> 
+           </void> 
+           <void method="put"> 
+            <string>serialization.format</string> 
+            <string>1</string> 
+           </void> 
+           <void method="put"> 
+            <string>bucket_count</string> 
+            <string>2</string> 
+           </void> 
+           <void method="put"> 
+            <string>serialization.lib</string> 
+            <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+           </void> 
+           <void method="put"> 
+            <string>file.inputformat</string> 
+            <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+           </void> 
+           <void method="put"> 
+            <string>file.outputformat</string> 
+            <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+           </void> 
+           <void method="put"> 
+            <string>location</string> 
+            <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/srcbucket</string> 
+           </void> 
+          </object> 
+         </void> 
+         <void property="serdeClassName"> 
+          <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+         </void> 
+        </object> 
+       </void> 
+      </object> 
+     </void> 
+    </void> 
+    <void property="aliasToWork"> 
+     <object class="java.util.LinkedHashMap"> 
+      <void method="put"> 
+       <string>s</string> 
+       <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
+        <void property="childOperators"> 
+         <object class="java.util.ArrayList"> 
+          <void method="add"> 
+           <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
             <void property="childOperators"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+               <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+                   <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
                     <void property="childOperators"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                        <void property="childOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object id="FileSinkOperator0" class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                            <void property="conf"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
-                              <void property="destTableId"> 
-                               <int>1</int> 
-                              </void> 
-                              <void property="dirName"> 
-                               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1022758072/10002</string> 
-                              </void> 
-                              <void property="tableInfo"> 
-                               <object idref="tableDesc0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="parentOperators"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object idref="SelectOperator0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="schema"> 
-                             <object idref="RowSchema0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="columnExprMap"> 
-                         <object class="java.util.HashMap"> 
-                          <void method="put"> 
-                           <string>_col1</string> 
-                           <object id="exprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>value</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="put"> 
-                           <string>_col0</string> 
-                           <object id="exprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>key</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
+                       <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
                         <void property="conf"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.selectDesc"> 
-                          <void property="colList"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object idref="exprNodeColumnDesc1"/> 
-                            </void> 
-                            <void method="add"> 
-                             <object idref="exprNodeColumnDesc0"/> 
-                            </void> 
-                           </object> 
+                         <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
+                          <void property="destTableId"> 
+                           <int>1</int> 
                           </void> 
-                          <void property="outputColumnNames"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <string>_col0</string> 
-                            </void> 
-                            <void method="add"> 
-                             <string>_col1</string> 
-                            </void> 
-                           </object> 
+                          <void property="dirName"> 
+                           <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/862492203/10002</string> 
                           </void> 
-                          <void property="selectStar"> 
-                           <boolean>true</boolean> 
+                          <void property="tableInfo"> 
+                           <object idref="tableDesc0"/> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="parentOperators"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <object idref="FilterOperator1"/> 
+                           <object idref="SelectOperator0"/> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="schema"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                          <void property="signature"> 
-                           <object class="java.util.Vector"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>_col0</string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>_col1</string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
+                         <object idref="RowSchema0"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="columnExprMap"> 
+                     <object class="java.util.HashMap"> 
+                      <void method="put"> 
+                       <string>_col1</string> 
+                       <object id="exprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                        <void property="column"> 
+                         <string>value</string> 
+                        </void> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo0"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void method="put"> 
+                       <string>_col0</string> 
+                       <object id="exprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                        <void property="column"> 
+                         <string>key</string> 
+                        </void> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo0"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="conf"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.selectDesc"> 
+                      <void property="colList"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <object idref="exprNodeColumnDesc1"/> 
+                        </void> 
+                        <void method="add"> 
+                         <object idref="exprNodeColumnDesc0"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="outputColumnNames"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <string>_col0</string> 
+                        </void> 
+                        <void method="add"> 
+                         <string>_col1</string> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="selectStar"> 
+                       <boolean>true</boolean> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="parentOperators"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object idref="FilterOperator1"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="schema"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                      <void property="signature"> 
+                       <object class="java.util.Vector"> 
+                        <void method="add"> 
+                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                          <void property="internalName"> 
+                           <string>_col0</string> 
+                          </void> 
+                          <void property="type"> 
+                           <object idref="PrimitiveTypeInfo0"/> 
+                          </void> 
+                         </object> 
+                        </void> 
+                        <void method="add"> 
+                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                          <void property="internalName"> 
+                           <string>_col1</string> 
+                          </void> 
+                          <void property="type"> 
+                           <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
                          </object> 
                         </void> 
@@ -610,15 +699,39 @@
                       </void> 
                      </object> 
                     </void> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.filterDesc"> 
-                      <void property="predicate"> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="conf"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.filterDesc"> 
+                  <void property="predicate"> 
+                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                    <void property="UDFClass"> 
+                     <class>org.apache.hadoop.hive.ql.udf.UDFOPEqual</class> 
+                    </void> 
+                    <void property="UDFMethod"> 
+                     <object id="Method0" class="org.apache.hadoop.hive.ql.udf.UDFOPEqual" method="getMethod"> 
+                      <string>evaluate</string> 
+                      <array class="java.lang.Class" length="2"> 
+                       <void index="0"> 
+                        <class>org.apache.hadoop.io.IntWritable</class> 
+                       </void> 
+                       <void index="1"> 
+                        <class>org.apache.hadoop.io.IntWritable</class> 
+                       </void> 
+                      </array> 
+                     </object> 
+                    </void> 
+                    <void property="childExprs"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
                        <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
                         <void property="UDFClass"> 
-                         <class>org.apache.hadoop.hive.ql.udf.UDFOPEqual</class> 
+                         <class>org.apache.hadoop.hive.ql.udf.UDFOPMod</class> 
                         </void> 
                         <void property="UDFMethod"> 
-                         <object id="Method0" class="org.apache.hadoop.hive.ql.udf.UDFOPEqual" method="getMethod"> 
+                         <object id="Method1" class="org.apache.hadoop.hive.ql.udf.UDFOPMod" method="getMethod"> 
                           <string>evaluate</string> 
                           <array class="java.lang.Class" length="2"> 
                            <void index="0"> 
@@ -635,10 +748,10 @@
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
                             <void property="UDFClass"> 
-                             <class>org.apache.hadoop.hive.ql.udf.UDFOPMod</class> 
+                             <class>org.apache.hadoop.hive.ql.udf.UDFOPBitAnd</class> 
                             </void> 
                             <void property="UDFMethod"> 
-                             <object id="Method1" class="org.apache.hadoop.hive.ql.udf.UDFOPMod" method="getMethod"> 
+                             <object id="Method2" class="org.apache.hadoop.hive.ql.udf.UDFOPBitAnd" method="getMethod"> 
                               <string>evaluate</string> 
                               <array class="java.lang.Class" length="2"> 
                                <void index="0"> 
@@ -653,77 +766,40 @@
                             <void property="childExprs"> 
                              <object class="java.util.ArrayList"> 
                               <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                                <void property="UDFClass"> 
-                                 <class>org.apache.hadoop.hive.ql.udf.UDFOPBitAnd</class> 
-                                </void> 
-                                <void property="UDFMethod"> 
-                                 <object id="Method2" class="org.apache.hadoop.hive.ql.udf.UDFOPBitAnd" method="getMethod"> 
-                                  <string>evaluate</string> 
-                                  <array class="java.lang.Class" length="2"> 
-                                   <void index="0"> 
-                                    <class>org.apache.hadoop.io.IntWritable</class> 
-                                   </void> 
-                                   <void index="1"> 
-                                    <class>org.apache.hadoop.io.IntWritable</class> 
-                                   </void> 
-                                  </array> 
-                                 </object> 
-                                </void> 
+                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeGenericFuncDesc"> 
                                 <void property="childExprs"> 
                                  <object class="java.util.ArrayList"> 
                                   <void method="add"> 
-                                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeGenericFuncDesc"> 
-                                    <void property="childExprs"> 
-                                     <object class="java.util.ArrayList"> 
-                                      <void method="add"> 
-                                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                                        <void property="column"> 
-                                         <string>key</string> 
-                                        </void> 
-                                        <void property="typeInfo"> 
-                                         <object idref="PrimitiveTypeInfo0"/> 
-                                        </void> 
-                                       </object> 
-                                      </void> 
-                                      <void method="add"> 
-                                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                                        <void property="column"> 
-                                         <string>value</string> 
-                                        </void> 
-                                        <void property="typeInfo"> 
-                                         <object idref="PrimitiveTypeInfo0"/> 
-                                        </void> 
-                                       </object> 
-                                      </void> 
-                                     </object> 
-                                    </void> 
-                                    <void property="genericUDFClass"> 
-                                     <class>org.apache.hadoop.hive.ql.udf.generic.GenericUDFHash</class> 
+                                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                                    <void property="column"> 
+                                     <string>key</string> 
                                     </void> 
                                     <void property="typeInfo"> 
-                                     <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                                      <void property="typeName"> 
-                                       <string>int</string> 
-                                      </void> 
-                                     </object> 
+                                     <object idref="PrimitiveTypeInfo0"/> 
                                     </void> 
                                    </object> 
                                   </void> 
                                   <void method="add"> 
-                                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
+                                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                                    <void property="column"> 
+                                     <string>value</string> 
+                                    </void> 
                                     <void property="typeInfo"> 
-                                     <object idref="PrimitiveTypeInfo1"/> 
-                                    </void> 
-                                    <void property="value"> 
-                                     <int>2147483647</int> 
+                                     <object idref="PrimitiveTypeInfo0"/> 
                                     </void> 
                                    </object> 
                                   </void> 
                                  </object> 
                                 </void> 
+                                <void property="genericUDFClass"> 
+                                 <class>org.apache.hadoop.hive.ql.udf.generic.GenericUDFHash</class> 
+                                </void> 
                                 <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo1"/> 
+                                 <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                                  <void property="typeName"> 
+                                   <string>int</string> 
+                                  </void> 
+                                 </object> 
                                 </void> 
                                </object> 
                               </void> 
@@ -733,7 +809,7 @@
                                  <object idref="PrimitiveTypeInfo1"/> 
                                 </void> 
                                 <void property="value"> 
-                                 <int>2</int> 
+                                 <int>2147483647</int> 
                                 </void> 
                                </object> 
                               </void> 
@@ -750,27 +826,33 @@
                              <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                             <void property="value"> 
-                             <int>0</int> 
+                             <int>2</int> 
                             </void> 
                            </object> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>boolean</string> 
-                          </void> 
-                         </object> 
+                         <object idref="PrimitiveTypeInfo1"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
+                        </void> 
+                        <void property="value"> 
+                         <int>0</int> 
                         </void> 
                        </object> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="FilterOperator0"/> 
+                    <void property="typeInfo"> 
+                     <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                      <void property="typeName"> 
+                       <string>boolean</string> 
                       </void> 
                      </object> 
                     </void> 
@@ -778,84 +860,78 @@
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.filterDesc"> 
-                  <void property="predicate"> 
+                <void property="parentOperators"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object idref="FilterOperator0"/> 
+                  </void> 
+                 </object> 
+                </void> 
+               </object> 
+              </void> 
+             </object> 
+            </void> 
+            <void property="conf"> 
+             <object class="org.apache.hadoop.hive.ql.plan.filterDesc"> 
+              <void property="predicate"> 
+               <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                <void property="UDFClass"> 
+                 <class>org.apache.hadoop.hive.ql.udf.UDFOPEqual</class> 
+                </void> 
+                <void property="UDFMethod"> 
+                 <object idref="Method0"/> 
+                </void> 
+                <void property="childExprs"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
                    <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
                     <void property="UDFClass"> 
-                     <class>org.apache.hadoop.hive.ql.udf.UDFOPEqual</class> 
+                     <class>org.apache.hadoop.hive.ql.udf.UDFOPMod</class> 
                     </void> 
                     <void property="UDFMethod"> 
-                     <object idref="Method0"/> 
+                     <object idref="Method1"/> 
                     </void> 
                     <void property="childExprs"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
                        <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
                         <void property="UDFClass"> 
-                         <class>org.apache.hadoop.hive.ql.udf.UDFOPMod</class> 
+                         <class>org.apache.hadoop.hive.ql.udf.UDFOPBitAnd</class> 
                         </void> 
                         <void property="UDFMethod"> 
-                         <object idref="Method1"/> 
+                         <object idref="Method2"/> 
                         </void> 
                         <void property="childExprs"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                            <void property="UDFClass"> 
-                             <class>org.apache.hadoop.hive.ql.udf.UDFOPBitAnd</class> 
-                            </void> 
-                            <void property="UDFMethod"> 
-                             <object idref="Method2"/> 
-                            </void> 
+                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeGenericFuncDesc"> 
                             <void property="childExprs"> 
                              <object class="java.util.ArrayList"> 
                               <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeGenericFuncDesc"> 
-                                <void property="childExprs"> 
-                                 <object class="java.util.ArrayList"> 
-                                  <void method="add"> 
-                                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                                    <void property="column"> 
-                                     <string>key</string> 
-                                    </void> 
-                                    <void property="typeInfo"> 
-                                     <object idref="PrimitiveTypeInfo0"/> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                  <void method="add"> 
-                                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                                    <void property="column"> 
-                                     <string>value</string> 
-                                    </void> 
-                                    <void property="typeInfo"> 
-                                     <object idref="PrimitiveTypeInfo0"/> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void property="genericUDFClass"> 
-                                 <class>org.apache.hadoop.hive.ql.udf.generic.GenericUDFHash</class> 
+                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                                <void property="column"> 
+                                 <string>key</string> 
                                 </void> 
                                 <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo1"/> 
+                                 <object idref="PrimitiveTypeInfo0"/> 
                                 </void> 
                                </object> 
                               </void> 
                               <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
-                                <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo1"/> 
+                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                                <void property="column"> 
+                                 <string>value</string> 
                                 </void> 
-                                <void property="value"> 
-                                 <int>2147483647</int> 
+                                <void property="typeInfo"> 
+                                 <object idref="PrimitiveTypeInfo0"/> 
                                 </void> 
                                </object> 
                               </void> 
                              </object> 
                             </void> 
+                            <void property="genericUDFClass"> 
+                             <class>org.apache.hadoop.hive.ql.udf.generic.GenericUDFHash</class> 
+                            </void> 
                             <void property="typeInfo"> 
                              <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
@@ -867,7 +943,7 @@
                              <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                             <void property="value"> 
-                             <int>2</int> 
+                             <int>2147483647</int> 
                             </void> 
                            </object> 
                           </void> 
@@ -884,278 +960,89 @@
                          <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
                         <void property="value"> 
-                         <int>0</int> 
+                         <int>2</int> 
                         </void> 
                        </object> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                     <object idref="PrimitiveTypeInfo1"/> 
                     </void> 
                    </object> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="parentOperators"> 
-                 <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object idref="TableScanOperator1"/> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object id="Vector0" class="java.util.Vector"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>key</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                     </object> 
+                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo1"/> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>value</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                     </object> 
+                    <void property="value"> 
+                     <int>0</int> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
+                <void property="typeInfo"> 
+                 <object idref="PrimitiveTypeInfo2"/> 
+                </void> 
                </object> 
               </void> 
              </object> 
             </void> 
-            <void property="neededColumnIDs"> 
+            <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <int>0</int> 
-              </void> 
-              <void method="add"> 
-               <int>1</int> 
+               <object idref="TableScanOperator1"/> 
               </void> 
              </object> 
             </void> 
             <void property="schema"> 
              <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
               <void property="signature"> 
-               <object idref="Vector0"/> 
-              </void> 
-             </object> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="mapCurrCtx"> 
-           <object class="java.util.LinkedHashMap"> 
-            <void method="put"> 
-             <object idref="TableScanOperator1"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-            <void method="put"> 
-             <object idref="FilterOperator0"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-            <void method="put"> 
-             <object idref="FilterOperator1"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-            <void method="put"> 
-             <object idref="SelectOperator0"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="mvTask"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="MoveTask0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="opTaskMap"> 
-           <object class="java.util.HashMap"> 
-            <void method="put"> 
-             <null/> 
-             <object idref="MapRedTask0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="parseCtx"> 
-           <object class="org.apache.hadoop.hive.ql.parse.ParseContext"> 
-            <void property="QB"> 
-             <object class="org.apache.hadoop.hive.ql.parse.QB"/> 
-            </void> 
-            <void property="UCtx"> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.unionproc.UnionProcContext"/> 
-            </void> 
-            <void property="aliasToPruner"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>s</string> 
-               <object class="org.apache.hadoop.hive.ql.parse.PartitionPruner"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="aliasToSamplePruner"> 
-             <object class="java.util.HashMap"/> 
-            </void> 
-            <void property="conf"> 
-             <object idref="HiveConf0"/> 
-            </void> 
-            <void property="context"> 
-             <object class="org.apache.hadoop.hive.ql.Context"/> 
-            </void> 
-            <void property="destTableId"> 
-             <int>2</int> 
-            </void> 
-            <void property="idToTableNameMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>1</string> 
-               <string>dest1</string> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="joinContext"> 
-             <object class="java.util.HashMap"/> 
-            </void> 
-            <void property="listMapJoinOpsNoReducer"> 
-             <object class="java.util.ArrayList"/> 
-            </void> 
-            <void property="loadFileWork"> 
-             <object class="java.util.ArrayList"/> 
-            </void> 
-            <void property="loadTableWork"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="loadTableDesc0"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="opParseCtx"> 
-             <object class="java.util.LinkedHashMap"> 
-              <void method="put"> 
-               <object idref="TableScanOperator1"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object id="RowResolver0" class="org.apache.hadoop.hive.ql.parse.RowResolver"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="FilterOperator1"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object idref="RowResolver0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="SelectOperator0"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object id="RowResolver1" class="org.apache.hadoop.hive.ql.parse.RowResolver"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="FileSinkOperator0"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object idref="RowResolver1"/> 
+               <object id="Vector0" class="java.util.Vector"> 
+                <void method="add"> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>key</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
                 </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="FilterOperator0"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object idref="RowResolver0"/> 
+                <void method="add"> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>value</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
                 </void> 
                </object> 
               </void> 
              </object> 
             </void> 
-            <void property="parseTree"> 
-             <object class="org.apache.hadoop.hive.ql.parse.ASTNode"> 
-              <void property="tokenStartIndex"> 
-               <int>4</int> 
-              </void> 
-              <void property="tokenStopIndex"> 
-               <int>45</int> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="topOps"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>s</string> 
-               <object idref="TableScanOperator1"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="topSelOps"> 
-             <object class="java.util.HashMap"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="rootOps"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="TableScanOperator1"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="rootTasks"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="MapRedTask0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="seenFileSinkOps"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="FileSinkOperator0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="seenOps"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="TableScanOperator1"/> 
-            </void> 
            </object> 
           </void> 
          </object> 
         </void> 
-        <void property="dir"> 
-         <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1022758072/10002</string> 
-        </void> 
-        <void property="listTasks"> 
-         <object idref="ArrayList0"/> 
-        </void> 
-       </object> 
-      </void> 
-      <void property="work"> 
-       <object class="org.apache.hadoop.hive.ql.plan.ConditionalWork"> 
-        <void property="listWorks"> 
+        <void property="neededColumnIDs"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <object idref="moveWork0"/> 
+           <int>0</int> 
           </void> 
           <void method="add"> 
-           <object idref="mapredWork0"/> 
+           <int>1</int> 
+          </void> 
+         </object> 
+        </void> 
+        <void property="schema"> 
+         <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+          <void property="signature"> 
+           <object idref="Vector0"/> 
           </void> 
          </object> 
         </void> 
@@ -1163,99 +1050,10 @@
       </void> 
      </object> 
     </void> 
-   </object> 
-  </void> 
-  <void property="id"> 
-   <string>Stage-2</string> 
-  </void> 
-  <void property="work"> 
-   <object class="org.apache.hadoop.hive.ql.plan.mapredWork"> 
-    <void property="aliasToPartnInfo"> 
-     <void method="put"> 
-      <string>s</string> 
-      <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
-       <void property="partSpec"> 
-        <object id="LinkedHashMap0" class="java.util.LinkedHashMap"/> 
-       </void> 
-       <void property="tableDesc"> 
-        <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
-         <void property="deserializerClass"> 
-          <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
-         </void> 
-         <void property="inputFileFormatClass"> 
-          <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-         </void> 
-         <void property="outputFileFormatClass"> 
-          <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-         </void> 
-         <void property="properties"> 
-          <object id="Properties0" class="java.util.Properties"> 
-           <void method="put"> 
-            <string>name</string> 
-            <string>srcbucket</string> 
-           </void> 
-           <void method="put"> 
-            <string>columns.types</string> 
-            <string>string:string</string> 
-           </void> 
-           <void method="put"> 
-            <string>bucket_field_name</string> 
-            <string>key</string> 
-           </void> 
-           <void method="put"> 
-            <string>serialization.ddl</string> 
-            <string>struct srcbucket { string key, string value}</string> 
-           </void> 
-           <void method="put"> 
-            <string>columns</string> 
-            <string>key,value</string> 
-           </void> 
-           <void method="put"> 
-            <string>serialization.format</string> 
-            <string>1</string> 
-           </void> 
-           <void method="put"> 
-            <string>bucket_count</string> 
-            <string>2</string> 
-           </void> 
-           <void method="put"> 
-            <string>serialization.lib</string> 
-            <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-           </void> 
-           <void method="put"> 
-            <string>file.inputformat</string> 
-            <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-           </void> 
-           <void method="put"> 
-            <string>file.outputformat</string> 
-            <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-           </void> 
-           <void method="put"> 
-            <string>location</string> 
-            <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/srcbucket</string> 
-           </void> 
-          </object> 
-         </void> 
-         <void property="serdeClassName"> 
-          <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-         </void> 
-        </object> 
-       </void> 
-      </object> 
-     </void> 
-    </void> 
-    <void property="aliasToWork"> 
-     <object class="java.util.LinkedHashMap"> 
-      <void method="put"> 
-       <string>s</string> 
-       <object idref="TableScanOperator1"/> 
-      </void> 
-     </object> 
-    </void> 
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/srcbucket</string> 
+       <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/srcbucket</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>s</string> 
@@ -1267,7 +1065,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/srcbucket</string> 
+       <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/srcbucket</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/sample4.q.xml b/ql/src/test/results/compiler/plan/sample4.q.xml
index e679d6a4a2..949bead276 100644
--- a/ql/src/test/results/compiler/plan/sample4.q.xml
+++ b/ql/src/test/results/compiler/plan/sample4.q.xml
@@ -8,7 +8,7 @@
       <void property="childTasks"> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
-         <object id="MoveTask0" class="org.apache.hadoop.hive.ql.exec.MoveTask"> 
+         <object class="org.apache.hadoop.hive.ql.exec.MoveTask"> 
           <void property="id"> 
            <string>Stage-1</string> 
           </void> 
@@ -22,7 +22,7 @@
           <void property="work"> 
            <object class="org.apache.hadoop.hive.ql.plan.moveWork"> 
             <void property="loadTableWork"> 
-             <object id="loadTableDesc0" class="org.apache.hadoop.hive.ql.plan.loadTableDesc"> 
+             <object class="org.apache.hadoop.hive.ql.plan.loadTableDesc"> 
               <void property="partitionSpec"> 
                <object class="java.util.HashMap"/> 
               </void> 
@@ -30,7 +30,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1367310051/10000</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/715833845/10000</string> 
               </void> 
               <void property="table"> 
                <object id="tableDesc0" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -83,7 +83,7 @@
                   </void> 
                   <void method="put"> 
                    <string>location</string> 
-                   <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/dest1</string> 
+                   <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/dest1</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -93,7 +93,7 @@
                </object> 
               </void> 
               <void property="tmpDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1367310051/10001</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/715833845/10001</string> 
               </void> 
              </object> 
             </void> 
@@ -121,10 +121,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/719067674/10002</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1637989797/10002</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1367310051/10000</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/715833845/10000</string> 
               </void> 
              </object> 
             </void> 
@@ -142,7 +142,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/719067674/10002</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1637989797/10002</string> 
                <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -338,10 +338,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/719067674/10002</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1637989797/10002</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/719067674/10002</string> 
+                 <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1637989797/10002</string> 
                 </void> 
                </object> 
               </void> 
@@ -350,7 +350,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/719067674/10002</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1637989797/10002</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object idref="tableDesc0"/> 
@@ -368,7 +368,7 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1367310051/10000</string> 
+                     <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/715833845/10000</string> 
                     </void> 
                     <void property="tableInfo"> 
                      <object idref="tableDesc0"/> 
@@ -458,352 +458,8 @@
       </void> 
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
-        <void property="ctx"> 
-         <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext"> 
-          <void property="conf"> 
-           <object id="HiveConf0" class="org.apache.hadoop.hive.conf.HiveConf"> 
-            <void property="auxJars"> 
-             <string>file:///data/users/njain/hive3/hive3/build/ql/test/test-udfs.jar</string> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="currAliasId"> 
-           <string>s</string> 
-          </void> 
-          <void property="currTask"> 
-           <object idref="MapRedTask0"/> 
-          </void> 
-          <void property="currTopOp"> 
-           <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
-            <void property="childOperators"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                <void property="childOperators"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object id="FileSinkOperator0" class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
-                      <void property="destTableId"> 
-                       <int>1</int> 
-                      </void> 
-                      <void property="dirName"> 
-                       <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/719067674/10002</string> 
-                      </void> 
-                      <void property="tableInfo"> 
-                       <object idref="tableDesc0"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="SelectOperator0"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void property="schema"> 
-                     <object idref="RowSchema0"/> 
-                    </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="columnExprMap"> 
-                 <object class="java.util.HashMap"> 
-                  <void method="put"> 
-                   <string>_col1</string> 
-                   <object id="exprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>value</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void method="put"> 
-                   <string>_col0</string> 
-                   <object id="exprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                    <void property="column"> 
-                     <string>key</string> 
-                    </void> 
-                    <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo0"/> 
-                    </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.selectDesc"> 
-                  <void property="colList"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <object idref="exprNodeColumnDesc1"/> 
-                    </void> 
-                    <void method="add"> 
-                     <object idref="exprNodeColumnDesc0"/> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void property="outputColumnNames"> 
-                   <object class="java.util.ArrayList"> 
-                    <void method="add"> 
-                     <string>_col0</string> 
-                    </void> 
-                    <void method="add"> 
-                     <string>_col1</string> 
-                    </void> 
-                   </object> 
-                  </void> 
-                  <void property="selectStar"> 
-                   <boolean>true</boolean> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="parentOperators"> 
-                 <object class="java.util.ArrayList"> 
-                  <void method="add"> 
-                   <object idref="TableScanOperator1"/> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object class="java.util.Vector"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col0</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>_col1</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                     </object> 
-                    </void> 
-                   </object> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="neededColumnIDs"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <int>0</int> 
-              </void> 
-              <void method="add"> 
-               <int>1</int> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object class="java.util.Vector"> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>key</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void method="add"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                  <void property="internalName"> 
-                   <string>value</string> 
-                  </void> 
-                  <void property="type"> 
-                   <object idref="PrimitiveTypeInfo0"/> 
-                  </void> 
-                 </object> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="mapCurrCtx"> 
-           <object class="java.util.LinkedHashMap"> 
-            <void method="put"> 
-             <object idref="TableScanOperator1"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-            <void method="put"> 
-             <object idref="SelectOperator0"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="mvTask"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="MoveTask0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="opTaskMap"> 
-           <object class="java.util.HashMap"> 
-            <void method="put"> 
-             <null/> 
-             <object idref="MapRedTask0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="parseCtx"> 
-           <object class="org.apache.hadoop.hive.ql.parse.ParseContext"> 
-            <void property="QB"> 
-             <object class="org.apache.hadoop.hive.ql.parse.QB"/> 
-            </void> 
-            <void property="UCtx"> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.unionproc.UnionProcContext"/> 
-            </void> 
-            <void property="aliasToPruner"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>s</string> 
-               <object class="org.apache.hadoop.hive.ql.parse.PartitionPruner"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="aliasToSamplePruner"> 
-             <object class="java.util.HashMap"/> 
-            </void> 
-            <void property="conf"> 
-             <object idref="HiveConf0"/> 
-            </void> 
-            <void property="context"> 
-             <object class="org.apache.hadoop.hive.ql.Context"/> 
-            </void> 
-            <void property="destTableId"> 
-             <int>2</int> 
-            </void> 
-            <void property="idToTableNameMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>1</string> 
-               <string>dest1</string> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="joinContext"> 
-             <object class="java.util.HashMap"/> 
-            </void> 
-            <void property="listMapJoinOpsNoReducer"> 
-             <object class="java.util.ArrayList"/> 
-            </void> 
-            <void property="loadFileWork"> 
-             <object class="java.util.ArrayList"/> 
-            </void> 
-            <void property="loadTableWork"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="loadTableDesc0"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="opParseCtx"> 
-             <object class="java.util.LinkedHashMap"> 
-              <void method="put"> 
-               <object idref="TableScanOperator1"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object class="org.apache.hadoop.hive.ql.parse.RowResolver"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="SelectOperator0"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object id="RowResolver0" class="org.apache.hadoop.hive.ql.parse.RowResolver"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="FileSinkOperator0"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object idref="RowResolver0"/> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="parseTree"> 
-             <object class="org.apache.hadoop.hive.ql.parse.ASTNode"> 
-              <void property="tokenStartIndex"> 
-               <int>4</int> 
-              </void> 
-              <void property="tokenStopIndex"> 
-               <int>40</int> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="topOps"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>s</string> 
-               <object idref="TableScanOperator1"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="topSelOps"> 
-             <object class="java.util.HashMap"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="rootOps"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="TableScanOperator1"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="rootTasks"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="MapRedTask0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="seenFileSinkOps"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="FileSinkOperator0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="seenOps"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="TableScanOperator1"/> 
-            </void> 
-           </object> 
-          </void> 
-         </object> 
-        </void> 
         <void property="dir"> 
-         <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/719067674/10002</string> 
+         <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1637989797/10002</string> 
         </void> 
         <void property="listTasks"> 
          <object idref="ArrayList0"/> 
@@ -895,7 +551,7 @@
            </void> 
            <void method="put"> 
             <string>location</string> 
-            <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/srcbucket</string> 
+            <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/srcbucket</string> 
            </void> 
           </object> 
          </void> 
@@ -911,14 +567,180 @@
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
        <string>s</string> 
-       <object idref="TableScanOperator1"/> 
+       <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
+        <void property="childOperators"> 
+         <object class="java.util.ArrayList"> 
+          <void method="add"> 
+           <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+            <void property="childOperators"> 
+             <object class="java.util.ArrayList"> 
+              <void method="add"> 
+               <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
+                <void property="conf"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
+                  <void property="destTableId"> 
+                   <int>1</int> 
+                  </void> 
+                  <void property="dirName"> 
+                   <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1637989797/10002</string> 
+                  </void> 
+                  <void property="tableInfo"> 
+                   <object idref="tableDesc0"/> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="parentOperators"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object idref="SelectOperator0"/> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="schema"> 
+                 <object idref="RowSchema0"/> 
+                </void> 
+               </object> 
+              </void> 
+             </object> 
+            </void> 
+            <void property="columnExprMap"> 
+             <object class="java.util.HashMap"> 
+              <void method="put"> 
+               <string>_col1</string> 
+               <object id="exprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                <void property="column"> 
+                 <string>value</string> 
+                </void> 
+                <void property="typeInfo"> 
+                 <object idref="PrimitiveTypeInfo0"/> 
+                </void> 
+               </object> 
+              </void> 
+              <void method="put"> 
+               <string>_col0</string> 
+               <object id="exprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                <void property="column"> 
+                 <string>key</string> 
+                </void> 
+                <void property="typeInfo"> 
+                 <object idref="PrimitiveTypeInfo0"/> 
+                </void> 
+               </object> 
+              </void> 
+             </object> 
+            </void> 
+            <void property="conf"> 
+             <object class="org.apache.hadoop.hive.ql.plan.selectDesc"> 
+              <void property="colList"> 
+               <object class="java.util.ArrayList"> 
+                <void method="add"> 
+                 <object idref="exprNodeColumnDesc1"/> 
+                </void> 
+                <void method="add"> 
+                 <object idref="exprNodeColumnDesc0"/> 
+                </void> 
+               </object> 
+              </void> 
+              <void property="outputColumnNames"> 
+               <object class="java.util.ArrayList"> 
+                <void method="add"> 
+                 <string>_col0</string> 
+                </void> 
+                <void method="add"> 
+                 <string>_col1</string> 
+                </void> 
+               </object> 
+              </void> 
+              <void property="selectStar"> 
+               <boolean>true</boolean> 
+              </void> 
+             </object> 
+            </void> 
+            <void property="parentOperators"> 
+             <object class="java.util.ArrayList"> 
+              <void method="add"> 
+               <object idref="TableScanOperator1"/> 
+              </void> 
+             </object> 
+            </void> 
+            <void property="schema"> 
+             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+              <void property="signature"> 
+               <object class="java.util.Vector"> 
+                <void method="add"> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>_col0</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void method="add"> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>_col1</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
+                </void> 
+               </object> 
+              </void> 
+             </object> 
+            </void> 
+           </object> 
+          </void> 
+         </object> 
+        </void> 
+        <void property="neededColumnIDs"> 
+         <object class="java.util.ArrayList"> 
+          <void method="add"> 
+           <int>0</int> 
+          </void> 
+          <void method="add"> 
+           <int>1</int> 
+          </void> 
+         </object> 
+        </void> 
+        <void property="schema"> 
+         <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+          <void property="signature"> 
+           <object class="java.util.Vector"> 
+            <void method="add"> 
+             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+              <void property="internalName"> 
+               <string>key</string> 
+              </void> 
+              <void property="type"> 
+               <object idref="PrimitiveTypeInfo0"/> 
+              </void> 
+             </object> 
+            </void> 
+            <void method="add"> 
+             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+              <void property="internalName"> 
+               <string>value</string> 
+              </void> 
+              <void property="type"> 
+               <object idref="PrimitiveTypeInfo0"/> 
+              </void> 
+             </object> 
+            </void> 
+           </object> 
+          </void> 
+         </object> 
+        </void> 
+       </object> 
       </void> 
      </object> 
     </void> 
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/srcbucket/kv1.txt</string> 
+       <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/srcbucket/kv1.txt</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>s</string> 
@@ -930,7 +752,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/srcbucket/kv1.txt</string> 
+       <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/srcbucket/kv1.txt</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/sample5.q.xml b/ql/src/test/results/compiler/plan/sample5.q.xml
index fc52b4b89d..6b6ab6b161 100644
--- a/ql/src/test/results/compiler/plan/sample5.q.xml
+++ b/ql/src/test/results/compiler/plan/sample5.q.xml
@@ -8,7 +8,7 @@
       <void property="childTasks"> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
-         <object id="MoveTask0" class="org.apache.hadoop.hive.ql.exec.MoveTask"> 
+         <object class="org.apache.hadoop.hive.ql.exec.MoveTask"> 
           <void property="id"> 
            <string>Stage-1</string> 
           </void> 
@@ -22,7 +22,7 @@
           <void property="work"> 
            <object class="org.apache.hadoop.hive.ql.plan.moveWork"> 
             <void property="loadTableWork"> 
-             <object id="loadTableDesc0" class="org.apache.hadoop.hive.ql.plan.loadTableDesc"> 
+             <object class="org.apache.hadoop.hive.ql.plan.loadTableDesc"> 
               <void property="partitionSpec"> 
                <object class="java.util.HashMap"/> 
               </void> 
@@ -30,7 +30,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1254817774/10000</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/2012161637/10000</string> 
               </void> 
               <void property="table"> 
                <object id="tableDesc0" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -83,7 +83,7 @@
                   </void> 
                   <void method="put"> 
                    <string>location</string> 
-                   <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/dest1</string> 
+                   <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/dest1</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -93,7 +93,7 @@
                </object> 
               </void> 
               <void property="tmpDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1254817774/10001</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/2012161637/10001</string> 
               </void> 
              </object> 
             </void> 
@@ -121,10 +121,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1287964503/10002</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/133008936/10002</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1254817774/10000</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/2012161637/10000</string> 
               </void> 
              </object> 
             </void> 
@@ -142,7 +142,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1287964503/10002</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/133008936/10002</string> 
                <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -338,10 +338,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1287964503/10002</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/133008936/10002</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1287964503/10002</string> 
+                 <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/133008936/10002</string> 
                 </void> 
                </object> 
               </void> 
@@ -350,7 +350,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1287964503/10002</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/133008936/10002</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object idref="tableDesc0"/> 
@@ -368,7 +368,7 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1254817774/10000</string> 
+                     <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/2012161637/10000</string> 
                     </void> 
                     <void property="tableInfo"> 
                      <object idref="tableDesc0"/> 
@@ -458,151 +458,240 @@
       </void> 
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
-        <void property="ctx"> 
-         <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext"> 
-          <void property="conf"> 
-           <object id="HiveConf0" class="org.apache.hadoop.hive.conf.HiveConf"> 
-            <void property="auxJars"> 
-             <string>file:///data/users/njain/hive3/hive3/build/ql/test/test-udfs.jar</string> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="currAliasId"> 
-           <string>s</string> 
+        <void property="dir"> 
+         <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/133008936/10002</string> 
+        </void> 
+        <void property="listTasks"> 
+         <object idref="ArrayList0"/> 
+        </void> 
+       </object> 
+      </void> 
+      <void property="work"> 
+       <object class="org.apache.hadoop.hive.ql.plan.ConditionalWork"> 
+        <void property="listWorks"> 
+         <object class="java.util.ArrayList"> 
+          <void method="add"> 
+           <object idref="moveWork0"/> 
           </void> 
-          <void property="currTask"> 
-           <object idref="MapRedTask0"/> 
+          <void method="add"> 
+           <object idref="mapredWork0"/> 
           </void> 
-          <void property="currTopOp"> 
-           <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
+         </object> 
+        </void> 
+       </object> 
+      </void> 
+     </object> 
+    </void> 
+   </object> 
+  </void> 
+  <void property="id"> 
+   <string>Stage-2</string> 
+  </void> 
+  <void property="work"> 
+   <object class="org.apache.hadoop.hive.ql.plan.mapredWork"> 
+    <void property="aliasToPartnInfo"> 
+     <void method="put"> 
+      <string>s</string> 
+      <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
+       <void property="partSpec"> 
+        <object id="LinkedHashMap0" class="java.util.LinkedHashMap"/> 
+       </void> 
+       <void property="tableDesc"> 
+        <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
+         <void property="deserializerClass"> 
+          <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
+         </void> 
+         <void property="inputFileFormatClass"> 
+          <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+         </void> 
+         <void property="outputFileFormatClass"> 
+          <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+         </void> 
+         <void property="properties"> 
+          <object id="Properties0" class="java.util.Properties"> 
+           <void method="put"> 
+            <string>name</string> 
+            <string>srcbucket</string> 
+           </void> 
+           <void method="put"> 
+            <string>columns.types</string> 
+            <string>string:string</string> 
+           </void> 
+           <void method="put"> 
+            <string>bucket_field_name</string> 
+            <string>key</string> 
+           </void> 
+           <void method="put"> 
+            <string>serialization.ddl</string> 
+            <string>struct srcbucket { string key, string value}</string> 
+           </void> 
+           <void method="put"> 
+            <string>columns</string> 
+            <string>key,value</string> 
+           </void> 
+           <void method="put"> 
+            <string>serialization.format</string> 
+            <string>1</string> 
+           </void> 
+           <void method="put"> 
+            <string>bucket_count</string> 
+            <string>2</string> 
+           </void> 
+           <void method="put"> 
+            <string>serialization.lib</string> 
+            <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+           </void> 
+           <void method="put"> 
+            <string>file.inputformat</string> 
+            <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+           </void> 
+           <void method="put"> 
+            <string>file.outputformat</string> 
+            <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+           </void> 
+           <void method="put"> 
+            <string>location</string> 
+            <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/srcbucket</string> 
+           </void> 
+          </object> 
+         </void> 
+         <void property="serdeClassName"> 
+          <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+         </void> 
+        </object> 
+       </void> 
+      </object> 
+     </void> 
+    </void> 
+    <void property="aliasToWork"> 
+     <object class="java.util.LinkedHashMap"> 
+      <void method="put"> 
+       <string>s</string> 
+       <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
+        <void property="childOperators"> 
+         <object class="java.util.ArrayList"> 
+          <void method="add"> 
+           <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
             <void property="childOperators"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+               <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+                   <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
                     <void property="childOperators"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                        <void property="childOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object id="FileSinkOperator0" class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                            <void property="conf"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
-                              <void property="destTableId"> 
-                               <int>1</int> 
-                              </void> 
-                              <void property="dirName"> 
-                               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1287964503/10002</string> 
-                              </void> 
-                              <void property="tableInfo"> 
-                               <object idref="tableDesc0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="parentOperators"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object idref="SelectOperator0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="schema"> 
-                             <object idref="RowSchema0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="columnExprMap"> 
-                         <object class="java.util.HashMap"> 
-                          <void method="put"> 
-                           <string>_col1</string> 
-                           <object id="exprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>value</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="put"> 
-                           <string>_col0</string> 
-                           <object id="exprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>key</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
+                       <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
                         <void property="conf"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.selectDesc"> 
-                          <void property="colList"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object idref="exprNodeColumnDesc1"/> 
-                            </void> 
-                            <void method="add"> 
-                             <object idref="exprNodeColumnDesc0"/> 
-                            </void> 
-                           </object> 
+                         <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
+                          <void property="destTableId"> 
+                           <int>1</int> 
                           </void> 
-                          <void property="outputColumnNames"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <string>_col0</string> 
-                            </void> 
-                            <void method="add"> 
-                             <string>_col1</string> 
-                            </void> 
-                           </object> 
+                          <void property="dirName"> 
+                           <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/133008936/10002</string> 
                           </void> 
-                          <void property="selectStar"> 
-                           <boolean>true</boolean> 
+                          <void property="tableInfo"> 
+                           <object idref="tableDesc0"/> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="parentOperators"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <object idref="FilterOperator1"/> 
+                           <object idref="SelectOperator0"/> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="schema"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                          <void property="signature"> 
-                           <object class="java.util.Vector"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>_col0</string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>_col1</string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
+                         <object idref="RowSchema0"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="columnExprMap"> 
+                     <object class="java.util.HashMap"> 
+                      <void method="put"> 
+                       <string>_col1</string> 
+                       <object id="exprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                        <void property="column"> 
+                         <string>value</string> 
+                        </void> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo0"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void method="put"> 
+                       <string>_col0</string> 
+                       <object id="exprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                        <void property="column"> 
+                         <string>key</string> 
+                        </void> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo0"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="conf"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.selectDesc"> 
+                      <void property="colList"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <object idref="exprNodeColumnDesc1"/> 
+                        </void> 
+                        <void method="add"> 
+                         <object idref="exprNodeColumnDesc0"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="outputColumnNames"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <string>_col0</string> 
+                        </void> 
+                        <void method="add"> 
+                         <string>_col1</string> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="selectStar"> 
+                       <boolean>true</boolean> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="parentOperators"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object idref="FilterOperator1"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="schema"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                      <void property="signature"> 
+                       <object class="java.util.Vector"> 
+                        <void method="add"> 
+                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                          <void property="internalName"> 
+                           <string>_col0</string> 
+                          </void> 
+                          <void property="type"> 
+                           <object idref="PrimitiveTypeInfo0"/> 
+                          </void> 
+                         </object> 
+                        </void> 
+                        <void method="add"> 
+                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                          <void property="internalName"> 
+                           <string>_col1</string> 
+                          </void> 
+                          <void property="type"> 
+                           <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
                          </object> 
                         </void> 
@@ -610,15 +699,39 @@
                       </void> 
                      </object> 
                     </void> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.filterDesc"> 
-                      <void property="predicate"> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="conf"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.filterDesc"> 
+                  <void property="predicate"> 
+                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                    <void property="UDFClass"> 
+                     <class>org.apache.hadoop.hive.ql.udf.UDFOPEqual</class> 
+                    </void> 
+                    <void property="UDFMethod"> 
+                     <object id="Method0" class="org.apache.hadoop.hive.ql.udf.UDFOPEqual" method="getMethod"> 
+                      <string>evaluate</string> 
+                      <array class="java.lang.Class" length="2"> 
+                       <void index="0"> 
+                        <class>org.apache.hadoop.io.IntWritable</class> 
+                       </void> 
+                       <void index="1"> 
+                        <class>org.apache.hadoop.io.IntWritable</class> 
+                       </void> 
+                      </array> 
+                     </object> 
+                    </void> 
+                    <void property="childExprs"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
                        <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
                         <void property="UDFClass"> 
-                         <class>org.apache.hadoop.hive.ql.udf.UDFOPEqual</class> 
+                         <class>org.apache.hadoop.hive.ql.udf.UDFOPMod</class> 
                         </void> 
                         <void property="UDFMethod"> 
-                         <object id="Method0" class="org.apache.hadoop.hive.ql.udf.UDFOPEqual" method="getMethod"> 
+                         <object id="Method1" class="org.apache.hadoop.hive.ql.udf.UDFOPMod" method="getMethod"> 
                           <string>evaluate</string> 
                           <array class="java.lang.Class" length="2"> 
                            <void index="0"> 
@@ -635,10 +748,10 @@
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
                             <void property="UDFClass"> 
-                             <class>org.apache.hadoop.hive.ql.udf.UDFOPMod</class> 
+                             <class>org.apache.hadoop.hive.ql.udf.UDFOPBitAnd</class> 
                             </void> 
                             <void property="UDFMethod"> 
-                             <object id="Method1" class="org.apache.hadoop.hive.ql.udf.UDFOPMod" method="getMethod"> 
+                             <object id="Method2" class="org.apache.hadoop.hive.ql.udf.UDFOPBitAnd" method="getMethod"> 
                               <string>evaluate</string> 
                               <array class="java.lang.Class" length="2"> 
                                <void index="0"> 
@@ -653,67 +766,30 @@
                             <void property="childExprs"> 
                              <object class="java.util.ArrayList"> 
                               <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                                <void property="UDFClass"> 
-                                 <class>org.apache.hadoop.hive.ql.udf.UDFOPBitAnd</class> 
-                                </void> 
-                                <void property="UDFMethod"> 
-                                 <object id="Method2" class="org.apache.hadoop.hive.ql.udf.UDFOPBitAnd" method="getMethod"> 
-                                  <string>evaluate</string> 
-                                  <array class="java.lang.Class" length="2"> 
-                                   <void index="0"> 
-                                    <class>org.apache.hadoop.io.IntWritable</class> 
-                                   </void> 
-                                   <void index="1"> 
-                                    <class>org.apache.hadoop.io.IntWritable</class> 
-                                   </void> 
-                                  </array> 
-                                 </object> 
-                                </void> 
+                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeGenericFuncDesc"> 
                                 <void property="childExprs"> 
                                  <object class="java.util.ArrayList"> 
                                   <void method="add"> 
-                                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeGenericFuncDesc"> 
-                                    <void property="childExprs"> 
-                                     <object class="java.util.ArrayList"> 
-                                      <void method="add"> 
-                                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                                        <void property="column"> 
-                                         <string>key</string> 
-                                        </void> 
-                                        <void property="typeInfo"> 
-                                         <object idref="PrimitiveTypeInfo0"/> 
-                                        </void> 
-                                       </object> 
-                                      </void> 
-                                     </object> 
-                                    </void> 
-                                    <void property="genericUDFClass"> 
-                                     <class>org.apache.hadoop.hive.ql.udf.generic.GenericUDFHash</class> 
+                                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                                    <void property="column"> 
+                                     <string>key</string> 
                                     </void> 
                                     <void property="typeInfo"> 
-                                     <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                                      <void property="typeName"> 
-                                       <string>int</string> 
-                                      </void> 
-                                     </object> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                  <void method="add"> 
-                                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
-                                    <void property="typeInfo"> 
-                                     <object idref="PrimitiveTypeInfo1"/> 
-                                    </void> 
-                                    <void property="value"> 
-                                     <int>2147483647</int> 
+                                     <object idref="PrimitiveTypeInfo0"/> 
                                     </void> 
                                    </object> 
                                   </void> 
                                  </object> 
                                 </void> 
+                                <void property="genericUDFClass"> 
+                                 <class>org.apache.hadoop.hive.ql.udf.generic.GenericUDFHash</class> 
+                                </void> 
                                 <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo1"/> 
+                                 <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                                  <void property="typeName"> 
+                                   <string>int</string> 
+                                  </void> 
+                                 </object> 
                                 </void> 
                                </object> 
                               </void> 
@@ -723,7 +799,7 @@
                                  <object idref="PrimitiveTypeInfo1"/> 
                                 </void> 
                                 <void property="value"> 
-                                 <int>5</int> 
+                                 <int>2147483647</int> 
                                 </void> 
                                </object> 
                               </void> 
@@ -740,27 +816,33 @@
                              <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                             <void property="value"> 
-                             <int>0</int> 
+                             <int>5</int> 
                             </void> 
                            </object> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>boolean</string> 
-                          </void> 
-                         </object> 
+                         <object idref="PrimitiveTypeInfo1"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
+                        </void> 
+                        <void property="value"> 
+                         <int>0</int> 
                         </void> 
                        </object> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="FilterOperator0"/> 
+                    <void property="typeInfo"> 
+                     <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                      <void property="typeName"> 
+                       <string>boolean</string> 
                       </void> 
                      </object> 
                     </void> 
@@ -768,74 +850,68 @@
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.filterDesc"> 
-                  <void property="predicate"> 
+                <void property="parentOperators"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object idref="FilterOperator0"/> 
+                  </void> 
+                 </object> 
+                </void> 
+               </object> 
+              </void> 
+             </object> 
+            </void> 
+            <void property="conf"> 
+             <object class="org.apache.hadoop.hive.ql.plan.filterDesc"> 
+              <void property="predicate"> 
+               <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                <void property="UDFClass"> 
+                 <class>org.apache.hadoop.hive.ql.udf.UDFOPEqual</class> 
+                </void> 
+                <void property="UDFMethod"> 
+                 <object idref="Method0"/> 
+                </void> 
+                <void property="childExprs"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
                    <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
                     <void property="UDFClass"> 
-                     <class>org.apache.hadoop.hive.ql.udf.UDFOPEqual</class> 
+                     <class>org.apache.hadoop.hive.ql.udf.UDFOPMod</class> 
                     </void> 
                     <void property="UDFMethod"> 
-                     <object idref="Method0"/> 
+                     <object idref="Method1"/> 
                     </void> 
                     <void property="childExprs"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
                        <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
                         <void property="UDFClass"> 
-                         <class>org.apache.hadoop.hive.ql.udf.UDFOPMod</class> 
+                         <class>org.apache.hadoop.hive.ql.udf.UDFOPBitAnd</class> 
                         </void> 
                         <void property="UDFMethod"> 
-                         <object idref="Method1"/> 
+                         <object idref="Method2"/> 
                         </void> 
                         <void property="childExprs"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                            <void property="UDFClass"> 
-                             <class>org.apache.hadoop.hive.ql.udf.UDFOPBitAnd</class> 
-                            </void> 
-                            <void property="UDFMethod"> 
-                             <object idref="Method2"/> 
-                            </void> 
+                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeGenericFuncDesc"> 
                             <void property="childExprs"> 
                              <object class="java.util.ArrayList"> 
                               <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeGenericFuncDesc"> 
-                                <void property="childExprs"> 
-                                 <object class="java.util.ArrayList"> 
-                                  <void method="add"> 
-                                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                                    <void property="column"> 
-                                     <string>key</string> 
-                                    </void> 
-                                    <void property="typeInfo"> 
-                                     <object idref="PrimitiveTypeInfo0"/> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void property="genericUDFClass"> 
-                                 <class>org.apache.hadoop.hive.ql.udf.generic.GenericUDFHash</class> 
+                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                                <void property="column"> 
+                                 <string>key</string> 
                                 </void> 
                                 <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo1"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
-                                <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo1"/> 
-                                </void> 
-                                <void property="value"> 
-                                 <int>2147483647</int> 
+                                 <object idref="PrimitiveTypeInfo0"/> 
                                 </void> 
                                </object> 
                               </void> 
                              </object> 
                             </void> 
+                            <void property="genericUDFClass"> 
+                             <class>org.apache.hadoop.hive.ql.udf.generic.GenericUDFHash</class> 
+                            </void> 
                             <void property="typeInfo"> 
                              <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
@@ -847,7 +923,7 @@
                              <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                             <void property="value"> 
-                             <int>5</int> 
+                             <int>2147483647</int> 
                             </void> 
                            </object> 
                           </void> 
@@ -864,278 +940,89 @@
                          <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
                         <void property="value"> 
-                         <int>0</int> 
+                         <int>5</int> 
                         </void> 
                        </object> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                     <object idref="PrimitiveTypeInfo1"/> 
                     </void> 
                    </object> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="parentOperators"> 
-                 <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object idref="TableScanOperator1"/> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object id="Vector0" class="java.util.Vector"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>key</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                     </object> 
+                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo1"/> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>value</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                     </object> 
+                    <void property="value"> 
+                     <int>0</int> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
+                <void property="typeInfo"> 
+                 <object idref="PrimitiveTypeInfo2"/> 
+                </void> 
                </object> 
               </void> 
              </object> 
             </void> 
-            <void property="neededColumnIDs"> 
+            <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <int>0</int> 
-              </void> 
-              <void method="add"> 
-               <int>1</int> 
+               <object idref="TableScanOperator1"/> 
               </void> 
              </object> 
             </void> 
             <void property="schema"> 
              <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
               <void property="signature"> 
-               <object idref="Vector0"/> 
-              </void> 
-             </object> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="mapCurrCtx"> 
-           <object class="java.util.LinkedHashMap"> 
-            <void method="put"> 
-             <object idref="TableScanOperator1"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-            <void method="put"> 
-             <object idref="FilterOperator0"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-            <void method="put"> 
-             <object idref="FilterOperator1"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-            <void method="put"> 
-             <object idref="SelectOperator0"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="mvTask"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="MoveTask0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="opTaskMap"> 
-           <object class="java.util.HashMap"> 
-            <void method="put"> 
-             <null/> 
-             <object idref="MapRedTask0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="parseCtx"> 
-           <object class="org.apache.hadoop.hive.ql.parse.ParseContext"> 
-            <void property="QB"> 
-             <object class="org.apache.hadoop.hive.ql.parse.QB"/> 
-            </void> 
-            <void property="UCtx"> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.unionproc.UnionProcContext"/> 
-            </void> 
-            <void property="aliasToPruner"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>s</string> 
-               <object class="org.apache.hadoop.hive.ql.parse.PartitionPruner"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="aliasToSamplePruner"> 
-             <object class="java.util.HashMap"/> 
-            </void> 
-            <void property="conf"> 
-             <object idref="HiveConf0"/> 
-            </void> 
-            <void property="context"> 
-             <object class="org.apache.hadoop.hive.ql.Context"/> 
-            </void> 
-            <void property="destTableId"> 
-             <int>2</int> 
-            </void> 
-            <void property="idToTableNameMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>1</string> 
-               <string>dest1</string> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="joinContext"> 
-             <object class="java.util.HashMap"/> 
-            </void> 
-            <void property="listMapJoinOpsNoReducer"> 
-             <object class="java.util.ArrayList"/> 
-            </void> 
-            <void property="loadFileWork"> 
-             <object class="java.util.ArrayList"/> 
-            </void> 
-            <void property="loadTableWork"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="loadTableDesc0"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="opParseCtx"> 
-             <object class="java.util.LinkedHashMap"> 
-              <void method="put"> 
-               <object idref="TableScanOperator1"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object id="RowResolver0" class="org.apache.hadoop.hive.ql.parse.RowResolver"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="FilterOperator1"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object idref="RowResolver0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="SelectOperator0"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object id="RowResolver1" class="org.apache.hadoop.hive.ql.parse.RowResolver"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="FileSinkOperator0"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object idref="RowResolver1"/> 
+               <object id="Vector0" class="java.util.Vector"> 
+                <void method="add"> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>key</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
                 </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="FilterOperator0"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object idref="RowResolver0"/> 
+                <void method="add"> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>value</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
                 </void> 
                </object> 
               </void> 
              </object> 
             </void> 
-            <void property="parseTree"> 
-             <object class="org.apache.hadoop.hive.ql.parse.ASTNode"> 
-              <void property="tokenStartIndex"> 
-               <int>2</int> 
-              </void> 
-              <void property="tokenStopIndex"> 
-               <int>40</int> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="topOps"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>s</string> 
-               <object idref="TableScanOperator1"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="topSelOps"> 
-             <object class="java.util.HashMap"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="rootOps"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="TableScanOperator1"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="rootTasks"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="MapRedTask0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="seenFileSinkOps"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="FileSinkOperator0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="seenOps"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="TableScanOperator1"/> 
-            </void> 
            </object> 
           </void> 
          </object> 
         </void> 
-        <void property="dir"> 
-         <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1287964503/10002</string> 
-        </void> 
-        <void property="listTasks"> 
-         <object idref="ArrayList0"/> 
-        </void> 
-       </object> 
-      </void> 
-      <void property="work"> 
-       <object class="org.apache.hadoop.hive.ql.plan.ConditionalWork"> 
-        <void property="listWorks"> 
+        <void property="neededColumnIDs"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <object idref="moveWork0"/> 
+           <int>0</int> 
           </void> 
           <void method="add"> 
-           <object idref="mapredWork0"/> 
+           <int>1</int> 
+          </void> 
+         </object> 
+        </void> 
+        <void property="schema"> 
+         <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+          <void property="signature"> 
+           <object idref="Vector0"/> 
           </void> 
          </object> 
         </void> 
@@ -1143,99 +1030,10 @@
       </void> 
      </object> 
     </void> 
-   </object> 
-  </void> 
-  <void property="id"> 
-   <string>Stage-2</string> 
-  </void> 
-  <void property="work"> 
-   <object class="org.apache.hadoop.hive.ql.plan.mapredWork"> 
-    <void property="aliasToPartnInfo"> 
-     <void method="put"> 
-      <string>s</string> 
-      <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
-       <void property="partSpec"> 
-        <object id="LinkedHashMap0" class="java.util.LinkedHashMap"/> 
-       </void> 
-       <void property="tableDesc"> 
-        <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
-         <void property="deserializerClass"> 
-          <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
-         </void> 
-         <void property="inputFileFormatClass"> 
-          <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-         </void> 
-         <void property="outputFileFormatClass"> 
-          <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-         </void> 
-         <void property="properties"> 
-          <object id="Properties0" class="java.util.Properties"> 
-           <void method="put"> 
-            <string>name</string> 
-            <string>srcbucket</string> 
-           </void> 
-           <void method="put"> 
-            <string>columns.types</string> 
-            <string>string:string</string> 
-           </void> 
-           <void method="put"> 
-            <string>bucket_field_name</string> 
-            <string>key</string> 
-           </void> 
-           <void method="put"> 
-            <string>serialization.ddl</string> 
-            <string>struct srcbucket { string key, string value}</string> 
-           </void> 
-           <void method="put"> 
-            <string>columns</string> 
-            <string>key,value</string> 
-           </void> 
-           <void method="put"> 
-            <string>serialization.format</string> 
-            <string>1</string> 
-           </void> 
-           <void method="put"> 
-            <string>bucket_count</string> 
-            <string>2</string> 
-           </void> 
-           <void method="put"> 
-            <string>serialization.lib</string> 
-            <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-           </void> 
-           <void method="put"> 
-            <string>file.inputformat</string> 
-            <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-           </void> 
-           <void method="put"> 
-            <string>file.outputformat</string> 
-            <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-           </void> 
-           <void method="put"> 
-            <string>location</string> 
-            <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/srcbucket</string> 
-           </void> 
-          </object> 
-         </void> 
-         <void property="serdeClassName"> 
-          <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-         </void> 
-        </object> 
-       </void> 
-      </object> 
-     </void> 
-    </void> 
-    <void property="aliasToWork"> 
-     <object class="java.util.LinkedHashMap"> 
-      <void method="put"> 
-       <string>s</string> 
-       <object idref="TableScanOperator1"/> 
-      </void> 
-     </object> 
-    </void> 
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/srcbucket</string> 
+       <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/srcbucket</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>s</string> 
@@ -1247,7 +1045,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/srcbucket</string> 
+       <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/srcbucket</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/sample6.q.xml b/ql/src/test/results/compiler/plan/sample6.q.xml
index c7831bf004..a263421048 100644
--- a/ql/src/test/results/compiler/plan/sample6.q.xml
+++ b/ql/src/test/results/compiler/plan/sample6.q.xml
@@ -8,7 +8,7 @@
       <void property="childTasks"> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
-         <object id="MoveTask0" class="org.apache.hadoop.hive.ql.exec.MoveTask"> 
+         <object class="org.apache.hadoop.hive.ql.exec.MoveTask"> 
           <void property="id"> 
            <string>Stage-1</string> 
           </void> 
@@ -22,7 +22,7 @@
           <void property="work"> 
            <object class="org.apache.hadoop.hive.ql.plan.moveWork"> 
             <void property="loadTableWork"> 
-             <object id="loadTableDesc0" class="org.apache.hadoop.hive.ql.plan.loadTableDesc"> 
+             <object class="org.apache.hadoop.hive.ql.plan.loadTableDesc"> 
               <void property="partitionSpec"> 
                <object class="java.util.HashMap"/> 
               </void> 
@@ -30,7 +30,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1109531104/10000</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1479775560/10000</string> 
               </void> 
               <void property="table"> 
                <object id="tableDesc0" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -83,7 +83,7 @@
                   </void> 
                   <void method="put"> 
                    <string>location</string> 
-                   <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/dest1</string> 
+                   <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/dest1</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -93,7 +93,7 @@
                </object> 
               </void> 
               <void property="tmpDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1109531104/10001</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1479775560/10001</string> 
               </void> 
              </object> 
             </void> 
@@ -121,10 +121,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1795931819/10002</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1018113504/10002</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1109531104/10000</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1479775560/10000</string> 
               </void> 
              </object> 
             </void> 
@@ -142,7 +142,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1795931819/10002</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1018113504/10002</string> 
                <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -338,10 +338,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1795931819/10002</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1018113504/10002</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1795931819/10002</string> 
+                 <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1018113504/10002</string> 
                 </void> 
                </object> 
               </void> 
@@ -350,7 +350,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1795931819/10002</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1018113504/10002</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object idref="tableDesc0"/> 
@@ -368,7 +368,7 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1109531104/10000</string> 
+                     <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1479775560/10000</string> 
                     </void> 
                     <void property="tableInfo"> 
                      <object idref="tableDesc0"/> 
@@ -458,151 +458,240 @@
       </void> 
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
-        <void property="ctx"> 
-         <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext"> 
-          <void property="conf"> 
-           <object id="HiveConf0" class="org.apache.hadoop.hive.conf.HiveConf"> 
-            <void property="auxJars"> 
-             <string>file:///data/users/njain/hive3/hive3/build/ql/test/test-udfs.jar</string> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="currAliasId"> 
-           <string>s</string> 
+        <void property="dir"> 
+         <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1018113504/10002</string> 
+        </void> 
+        <void property="listTasks"> 
+         <object idref="ArrayList0"/> 
+        </void> 
+       </object> 
+      </void> 
+      <void property="work"> 
+       <object class="org.apache.hadoop.hive.ql.plan.ConditionalWork"> 
+        <void property="listWorks"> 
+         <object class="java.util.ArrayList"> 
+          <void method="add"> 
+           <object idref="moveWork0"/> 
           </void> 
-          <void property="currTask"> 
-           <object idref="MapRedTask0"/> 
+          <void method="add"> 
+           <object idref="mapredWork0"/> 
           </void> 
-          <void property="currTopOp"> 
-           <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
+         </object> 
+        </void> 
+       </object> 
+      </void> 
+     </object> 
+    </void> 
+   </object> 
+  </void> 
+  <void property="id"> 
+   <string>Stage-2</string> 
+  </void> 
+  <void property="work"> 
+   <object class="org.apache.hadoop.hive.ql.plan.mapredWork"> 
+    <void property="aliasToPartnInfo"> 
+     <void method="put"> 
+      <string>s</string> 
+      <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
+       <void property="partSpec"> 
+        <object id="LinkedHashMap0" class="java.util.LinkedHashMap"/> 
+       </void> 
+       <void property="tableDesc"> 
+        <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
+         <void property="deserializerClass"> 
+          <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
+         </void> 
+         <void property="inputFileFormatClass"> 
+          <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+         </void> 
+         <void property="outputFileFormatClass"> 
+          <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+         </void> 
+         <void property="properties"> 
+          <object id="Properties0" class="java.util.Properties"> 
+           <void method="put"> 
+            <string>name</string> 
+            <string>srcbucket</string> 
+           </void> 
+           <void method="put"> 
+            <string>columns.types</string> 
+            <string>string:string</string> 
+           </void> 
+           <void method="put"> 
+            <string>bucket_field_name</string> 
+            <string>key</string> 
+           </void> 
+           <void method="put"> 
+            <string>serialization.ddl</string> 
+            <string>struct srcbucket { string key, string value}</string> 
+           </void> 
+           <void method="put"> 
+            <string>columns</string> 
+            <string>key,value</string> 
+           </void> 
+           <void method="put"> 
+            <string>serialization.format</string> 
+            <string>1</string> 
+           </void> 
+           <void method="put"> 
+            <string>bucket_count</string> 
+            <string>2</string> 
+           </void> 
+           <void method="put"> 
+            <string>serialization.lib</string> 
+            <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+           </void> 
+           <void method="put"> 
+            <string>file.inputformat</string> 
+            <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+           </void> 
+           <void method="put"> 
+            <string>file.outputformat</string> 
+            <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+           </void> 
+           <void method="put"> 
+            <string>location</string> 
+            <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/srcbucket</string> 
+           </void> 
+          </object> 
+         </void> 
+         <void property="serdeClassName"> 
+          <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+         </void> 
+        </object> 
+       </void> 
+      </object> 
+     </void> 
+    </void> 
+    <void property="aliasToWork"> 
+     <object class="java.util.LinkedHashMap"> 
+      <void method="put"> 
+       <string>s</string> 
+       <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
+        <void property="childOperators"> 
+         <object class="java.util.ArrayList"> 
+          <void method="add"> 
+           <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
             <void property="childOperators"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+               <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+                   <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
                     <void property="childOperators"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                        <void property="childOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object id="FileSinkOperator0" class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                            <void property="conf"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
-                              <void property="destTableId"> 
-                               <int>1</int> 
-                              </void> 
-                              <void property="dirName"> 
-                               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1795931819/10002</string> 
-                              </void> 
-                              <void property="tableInfo"> 
-                               <object idref="tableDesc0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="parentOperators"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object idref="SelectOperator0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="schema"> 
-                             <object idref="RowSchema0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="columnExprMap"> 
-                         <object class="java.util.HashMap"> 
-                          <void method="put"> 
-                           <string>_col1</string> 
-                           <object id="exprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>value</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="put"> 
-                           <string>_col0</string> 
-                           <object id="exprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>key</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
+                       <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
                         <void property="conf"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.selectDesc"> 
-                          <void property="colList"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object idref="exprNodeColumnDesc1"/> 
-                            </void> 
-                            <void method="add"> 
-                             <object idref="exprNodeColumnDesc0"/> 
-                            </void> 
-                           </object> 
+                         <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
+                          <void property="destTableId"> 
+                           <int>1</int> 
                           </void> 
-                          <void property="outputColumnNames"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <string>_col0</string> 
-                            </void> 
-                            <void method="add"> 
-                             <string>_col1</string> 
-                            </void> 
-                           </object> 
+                          <void property="dirName"> 
+                           <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1018113504/10002</string> 
                           </void> 
-                          <void property="selectStar"> 
-                           <boolean>true</boolean> 
+                          <void property="tableInfo"> 
+                           <object idref="tableDesc0"/> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="parentOperators"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <object idref="FilterOperator1"/> 
+                           <object idref="SelectOperator0"/> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="schema"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                          <void property="signature"> 
-                           <object class="java.util.Vector"> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>_col0</string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                              <void property="internalName"> 
-                               <string>_col1</string> 
-                              </void> 
-                              <void property="type"> 
-                               <object idref="PrimitiveTypeInfo0"/> 
-                              </void> 
-                             </object> 
-                            </void> 
-                           </object> 
+                         <object idref="RowSchema0"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="columnExprMap"> 
+                     <object class="java.util.HashMap"> 
+                      <void method="put"> 
+                       <string>_col1</string> 
+                       <object id="exprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                        <void property="column"> 
+                         <string>value</string> 
+                        </void> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo0"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void method="put"> 
+                       <string>_col0</string> 
+                       <object id="exprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                        <void property="column"> 
+                         <string>key</string> 
+                        </void> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo0"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="conf"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.selectDesc"> 
+                      <void property="colList"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <object idref="exprNodeColumnDesc1"/> 
+                        </void> 
+                        <void method="add"> 
+                         <object idref="exprNodeColumnDesc0"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="outputColumnNames"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <string>_col0</string> 
+                        </void> 
+                        <void method="add"> 
+                         <string>_col1</string> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="selectStar"> 
+                       <boolean>true</boolean> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="parentOperators"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object idref="FilterOperator1"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="schema"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                      <void property="signature"> 
+                       <object class="java.util.Vector"> 
+                        <void method="add"> 
+                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                          <void property="internalName"> 
+                           <string>_col0</string> 
+                          </void> 
+                          <void property="type"> 
+                           <object idref="PrimitiveTypeInfo0"/> 
+                          </void> 
+                         </object> 
+                        </void> 
+                        <void method="add"> 
+                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                          <void property="internalName"> 
+                           <string>_col1</string> 
+                          </void> 
+                          <void property="type"> 
+                           <object idref="PrimitiveTypeInfo0"/> 
                           </void> 
                          </object> 
                         </void> 
@@ -610,15 +699,39 @@
                       </void> 
                      </object> 
                     </void> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.filterDesc"> 
-                      <void property="predicate"> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="conf"> 
+                 <object class="org.apache.hadoop.hive.ql.plan.filterDesc"> 
+                  <void property="predicate"> 
+                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                    <void property="UDFClass"> 
+                     <class>org.apache.hadoop.hive.ql.udf.UDFOPEqual</class> 
+                    </void> 
+                    <void property="UDFMethod"> 
+                     <object id="Method0" class="org.apache.hadoop.hive.ql.udf.UDFOPEqual" method="getMethod"> 
+                      <string>evaluate</string> 
+                      <array class="java.lang.Class" length="2"> 
+                       <void index="0"> 
+                        <class>org.apache.hadoop.io.IntWritable</class> 
+                       </void> 
+                       <void index="1"> 
+                        <class>org.apache.hadoop.io.IntWritable</class> 
+                       </void> 
+                      </array> 
+                     </object> 
+                    </void> 
+                    <void property="childExprs"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
                        <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
                         <void property="UDFClass"> 
-                         <class>org.apache.hadoop.hive.ql.udf.UDFOPEqual</class> 
+                         <class>org.apache.hadoop.hive.ql.udf.UDFOPMod</class> 
                         </void> 
                         <void property="UDFMethod"> 
-                         <object id="Method0" class="org.apache.hadoop.hive.ql.udf.UDFOPEqual" method="getMethod"> 
+                         <object id="Method1" class="org.apache.hadoop.hive.ql.udf.UDFOPMod" method="getMethod"> 
                           <string>evaluate</string> 
                           <array class="java.lang.Class" length="2"> 
                            <void index="0"> 
@@ -635,10 +748,10 @@
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
                             <void property="UDFClass"> 
-                             <class>org.apache.hadoop.hive.ql.udf.UDFOPMod</class> 
+                             <class>org.apache.hadoop.hive.ql.udf.UDFOPBitAnd</class> 
                             </void> 
                             <void property="UDFMethod"> 
-                             <object id="Method1" class="org.apache.hadoop.hive.ql.udf.UDFOPMod" method="getMethod"> 
+                             <object id="Method2" class="org.apache.hadoop.hive.ql.udf.UDFOPBitAnd" method="getMethod"> 
                               <string>evaluate</string> 
                               <array class="java.lang.Class" length="2"> 
                                <void index="0"> 
@@ -653,67 +766,30 @@
                             <void property="childExprs"> 
                              <object class="java.util.ArrayList"> 
                               <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                                <void property="UDFClass"> 
-                                 <class>org.apache.hadoop.hive.ql.udf.UDFOPBitAnd</class> 
-                                </void> 
-                                <void property="UDFMethod"> 
-                                 <object id="Method2" class="org.apache.hadoop.hive.ql.udf.UDFOPBitAnd" method="getMethod"> 
-                                  <string>evaluate</string> 
-                                  <array class="java.lang.Class" length="2"> 
-                                   <void index="0"> 
-                                    <class>org.apache.hadoop.io.IntWritable</class> 
-                                   </void> 
-                                   <void index="1"> 
-                                    <class>org.apache.hadoop.io.IntWritable</class> 
-                                   </void> 
-                                  </array> 
-                                 </object> 
-                                </void> 
+                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeGenericFuncDesc"> 
                                 <void property="childExprs"> 
                                  <object class="java.util.ArrayList"> 
                                   <void method="add"> 
-                                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeGenericFuncDesc"> 
-                                    <void property="childExprs"> 
-                                     <object class="java.util.ArrayList"> 
-                                      <void method="add"> 
-                                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                                        <void property="column"> 
-                                         <string>key</string> 
-                                        </void> 
-                                        <void property="typeInfo"> 
-                                         <object idref="PrimitiveTypeInfo0"/> 
-                                        </void> 
-                                       </object> 
-                                      </void> 
-                                     </object> 
-                                    </void> 
-                                    <void property="genericUDFClass"> 
-                                     <class>org.apache.hadoop.hive.ql.udf.generic.GenericUDFHash</class> 
+                                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                                    <void property="column"> 
+                                     <string>key</string> 
                                     </void> 
                                     <void property="typeInfo"> 
-                                     <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                                      <void property="typeName"> 
-                                       <string>int</string> 
-                                      </void> 
-                                     </object> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                  <void method="add"> 
-                                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
-                                    <void property="typeInfo"> 
-                                     <object idref="PrimitiveTypeInfo1"/> 
-                                    </void> 
-                                    <void property="value"> 
-                                     <int>2147483647</int> 
+                                     <object idref="PrimitiveTypeInfo0"/> 
                                     </void> 
                                    </object> 
                                   </void> 
                                  </object> 
                                 </void> 
+                                <void property="genericUDFClass"> 
+                                 <class>org.apache.hadoop.hive.ql.udf.generic.GenericUDFHash</class> 
+                                </void> 
                                 <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo1"/> 
+                                 <object id="PrimitiveTypeInfo1" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                                  <void property="typeName"> 
+                                   <string>int</string> 
+                                  </void> 
+                                 </object> 
                                 </void> 
                                </object> 
                               </void> 
@@ -723,7 +799,7 @@
                                  <object idref="PrimitiveTypeInfo1"/> 
                                 </void> 
                                 <void property="value"> 
-                                 <int>4</int> 
+                                 <int>2147483647</int> 
                                 </void> 
                                </object> 
                               </void> 
@@ -740,27 +816,33 @@
                              <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                             <void property="value"> 
-                             <int>0</int> 
+                             <int>4</int> 
                             </void> 
                            </object> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>boolean</string> 
-                          </void> 
-                         </object> 
+                         <object idref="PrimitiveTypeInfo1"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
+                        </void> 
+                        <void property="value"> 
+                         <int>0</int> 
                         </void> 
                        </object> 
                       </void> 
                      </object> 
                     </void> 
-                    <void property="parentOperators"> 
-                     <object class="java.util.ArrayList"> 
-                      <void method="add"> 
-                       <object idref="FilterOperator0"/> 
+                    <void property="typeInfo"> 
+                     <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                      <void property="typeName"> 
+                       <string>boolean</string> 
                       </void> 
                      </object> 
                     </void> 
@@ -768,74 +850,68 @@
                   </void> 
                  </object> 
                 </void> 
-                <void property="conf"> 
-                 <object class="org.apache.hadoop.hive.ql.plan.filterDesc"> 
-                  <void property="predicate"> 
+                <void property="parentOperators"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object idref="FilterOperator0"/> 
+                  </void> 
+                 </object> 
+                </void> 
+               </object> 
+              </void> 
+             </object> 
+            </void> 
+            <void property="conf"> 
+             <object class="org.apache.hadoop.hive.ql.plan.filterDesc"> 
+              <void property="predicate"> 
+               <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                <void property="UDFClass"> 
+                 <class>org.apache.hadoop.hive.ql.udf.UDFOPEqual</class> 
+                </void> 
+                <void property="UDFMethod"> 
+                 <object idref="Method0"/> 
+                </void> 
+                <void property="childExprs"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
                    <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
                     <void property="UDFClass"> 
-                     <class>org.apache.hadoop.hive.ql.udf.UDFOPEqual</class> 
+                     <class>org.apache.hadoop.hive.ql.udf.UDFOPMod</class> 
                     </void> 
                     <void property="UDFMethod"> 
-                     <object idref="Method0"/> 
+                     <object idref="Method1"/> 
                     </void> 
                     <void property="childExprs"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
                        <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
                         <void property="UDFClass"> 
-                         <class>org.apache.hadoop.hive.ql.udf.UDFOPMod</class> 
+                         <class>org.apache.hadoop.hive.ql.udf.UDFOPBitAnd</class> 
                         </void> 
                         <void property="UDFMethod"> 
-                         <object idref="Method1"/> 
+                         <object idref="Method2"/> 
                         </void> 
                         <void property="childExprs"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                            <void property="UDFClass"> 
-                             <class>org.apache.hadoop.hive.ql.udf.UDFOPBitAnd</class> 
-                            </void> 
-                            <void property="UDFMethod"> 
-                             <object idref="Method2"/> 
-                            </void> 
+                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeGenericFuncDesc"> 
                             <void property="childExprs"> 
                              <object class="java.util.ArrayList"> 
                               <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeGenericFuncDesc"> 
-                                <void property="childExprs"> 
-                                 <object class="java.util.ArrayList"> 
-                                  <void method="add"> 
-                                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                                    <void property="column"> 
-                                     <string>key</string> 
-                                    </void> 
-                                    <void property="typeInfo"> 
-                                     <object idref="PrimitiveTypeInfo0"/> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void property="genericUDFClass"> 
-                                 <class>org.apache.hadoop.hive.ql.udf.generic.GenericUDFHash</class> 
+                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                                <void property="column"> 
+                                 <string>key</string> 
                                 </void> 
                                 <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo1"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
-                                <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo1"/> 
-                                </void> 
-                                <void property="value"> 
-                                 <int>2147483647</int> 
+                                 <object idref="PrimitiveTypeInfo0"/> 
                                 </void> 
                                </object> 
                               </void> 
                              </object> 
                             </void> 
+                            <void property="genericUDFClass"> 
+                             <class>org.apache.hadoop.hive.ql.udf.generic.GenericUDFHash</class> 
+                            </void> 
                             <void property="typeInfo"> 
                              <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
@@ -847,7 +923,7 @@
                              <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
                             <void property="value"> 
-                             <int>4</int> 
+                             <int>2147483647</int> 
                             </void> 
                            </object> 
                           </void> 
@@ -864,278 +940,89 @@
                          <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
                         <void property="value"> 
-                         <int>0</int> 
+                         <int>4</int> 
                         </void> 
                        </object> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo2"/> 
+                     <object idref="PrimitiveTypeInfo1"/> 
                     </void> 
                    </object> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="parentOperators"> 
-                 <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object idref="TableScanOperator1"/> 
-                  </void> 
-                 </object> 
-                </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object id="Vector0" class="java.util.Vector"> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>key</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                     </object> 
+                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo1"/> 
                     </void> 
-                    <void method="add"> 
-                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                      <void property="internalName"> 
-                       <string>value</string> 
-                      </void> 
-                      <void property="type"> 
-                       <object idref="PrimitiveTypeInfo0"/> 
-                      </void> 
-                     </object> 
+                    <void property="value"> 
+                     <int>0</int> 
                     </void> 
                    </object> 
                   </void> 
                  </object> 
                 </void> 
+                <void property="typeInfo"> 
+                 <object idref="PrimitiveTypeInfo2"/> 
+                </void> 
                </object> 
               </void> 
              </object> 
             </void> 
-            <void property="neededColumnIDs"> 
+            <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <int>0</int> 
-              </void> 
-              <void method="add"> 
-               <int>1</int> 
+               <object idref="TableScanOperator1"/> 
               </void> 
              </object> 
             </void> 
             <void property="schema"> 
              <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
               <void property="signature"> 
-               <object idref="Vector0"/> 
-              </void> 
-             </object> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="mapCurrCtx"> 
-           <object class="java.util.LinkedHashMap"> 
-            <void method="put"> 
-             <object idref="TableScanOperator1"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-            <void method="put"> 
-             <object idref="FilterOperator0"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-            <void method="put"> 
-             <object idref="FilterOperator1"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-            <void method="put"> 
-             <object idref="SelectOperator0"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="mvTask"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="MoveTask0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="opTaskMap"> 
-           <object class="java.util.HashMap"> 
-            <void method="put"> 
-             <null/> 
-             <object idref="MapRedTask0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="parseCtx"> 
-           <object class="org.apache.hadoop.hive.ql.parse.ParseContext"> 
-            <void property="QB"> 
-             <object class="org.apache.hadoop.hive.ql.parse.QB"/> 
-            </void> 
-            <void property="UCtx"> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.unionproc.UnionProcContext"/> 
-            </void> 
-            <void property="aliasToPruner"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>s</string> 
-               <object class="org.apache.hadoop.hive.ql.parse.PartitionPruner"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="aliasToSamplePruner"> 
-             <object class="java.util.HashMap"/> 
-            </void> 
-            <void property="conf"> 
-             <object idref="HiveConf0"/> 
-            </void> 
-            <void property="context"> 
-             <object class="org.apache.hadoop.hive.ql.Context"/> 
-            </void> 
-            <void property="destTableId"> 
-             <int>2</int> 
-            </void> 
-            <void property="idToTableNameMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>1</string> 
-               <string>dest1</string> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="joinContext"> 
-             <object class="java.util.HashMap"/> 
-            </void> 
-            <void property="listMapJoinOpsNoReducer"> 
-             <object class="java.util.ArrayList"/> 
-            </void> 
-            <void property="loadFileWork"> 
-             <object class="java.util.ArrayList"/> 
-            </void> 
-            <void property="loadTableWork"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="loadTableDesc0"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="opParseCtx"> 
-             <object class="java.util.LinkedHashMap"> 
-              <void method="put"> 
-               <object idref="TableScanOperator1"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object id="RowResolver0" class="org.apache.hadoop.hive.ql.parse.RowResolver"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="FilterOperator1"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object idref="RowResolver0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="SelectOperator0"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object id="RowResolver1" class="org.apache.hadoop.hive.ql.parse.RowResolver"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="FileSinkOperator0"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object idref="RowResolver1"/> 
+               <object id="Vector0" class="java.util.Vector"> 
+                <void method="add"> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>key</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
                 </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="FilterOperator0"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object idref="RowResolver0"/> 
+                <void method="add"> 
+                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                  <void property="internalName"> 
+                   <string>value</string> 
+                  </void> 
+                  <void property="type"> 
+                   <object idref="PrimitiveTypeInfo0"/> 
+                  </void> 
+                 </object> 
                 </void> 
                </object> 
               </void> 
              </object> 
             </void> 
-            <void property="parseTree"> 
-             <object class="org.apache.hadoop.hive.ql.parse.ASTNode"> 
-              <void property="tokenStartIndex"> 
-               <int>2</int> 
-              </void> 
-              <void property="tokenStopIndex"> 
-               <int>39</int> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="topOps"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>s</string> 
-               <object idref="TableScanOperator1"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="topSelOps"> 
-             <object class="java.util.HashMap"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="rootOps"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="TableScanOperator1"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="rootTasks"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="MapRedTask0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="seenFileSinkOps"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="FileSinkOperator0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="seenOps"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="TableScanOperator1"/> 
-            </void> 
            </object> 
           </void> 
          </object> 
         </void> 
-        <void property="dir"> 
-         <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1795931819/10002</string> 
-        </void> 
-        <void property="listTasks"> 
-         <object idref="ArrayList0"/> 
-        </void> 
-       </object> 
-      </void> 
-      <void property="work"> 
-       <object class="org.apache.hadoop.hive.ql.plan.ConditionalWork"> 
-        <void property="listWorks"> 
+        <void property="neededColumnIDs"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <object idref="moveWork0"/> 
+           <int>0</int> 
           </void> 
           <void method="add"> 
-           <object idref="mapredWork0"/> 
+           <int>1</int> 
+          </void> 
+         </object> 
+        </void> 
+        <void property="schema"> 
+         <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+          <void property="signature"> 
+           <object idref="Vector0"/> 
           </void> 
          </object> 
         </void> 
@@ -1143,99 +1030,10 @@
       </void> 
      </object> 
     </void> 
-   </object> 
-  </void> 
-  <void property="id"> 
-   <string>Stage-2</string> 
-  </void> 
-  <void property="work"> 
-   <object class="org.apache.hadoop.hive.ql.plan.mapredWork"> 
-    <void property="aliasToPartnInfo"> 
-     <void method="put"> 
-      <string>s</string> 
-      <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
-       <void property="partSpec"> 
-        <object id="LinkedHashMap0" class="java.util.LinkedHashMap"/> 
-       </void> 
-       <void property="tableDesc"> 
-        <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
-         <void property="deserializerClass"> 
-          <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
-         </void> 
-         <void property="inputFileFormatClass"> 
-          <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-         </void> 
-         <void property="outputFileFormatClass"> 
-          <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-         </void> 
-         <void property="properties"> 
-          <object id="Properties0" class="java.util.Properties"> 
-           <void method="put"> 
-            <string>name</string> 
-            <string>srcbucket</string> 
-           </void> 
-           <void method="put"> 
-            <string>columns.types</string> 
-            <string>string:string</string> 
-           </void> 
-           <void method="put"> 
-            <string>bucket_field_name</string> 
-            <string>key</string> 
-           </void> 
-           <void method="put"> 
-            <string>serialization.ddl</string> 
-            <string>struct srcbucket { string key, string value}</string> 
-           </void> 
-           <void method="put"> 
-            <string>columns</string> 
-            <string>key,value</string> 
-           </void> 
-           <void method="put"> 
-            <string>serialization.format</string> 
-            <string>1</string> 
-           </void> 
-           <void method="put"> 
-            <string>bucket_count</string> 
-            <string>2</string> 
-           </void> 
-           <void method="put"> 
-            <string>serialization.lib</string> 
-            <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-           </void> 
-           <void method="put"> 
-            <string>file.inputformat</string> 
-            <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-           </void> 
-           <void method="put"> 
-            <string>file.outputformat</string> 
-            <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-           </void> 
-           <void method="put"> 
-            <string>location</string> 
-            <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/srcbucket</string> 
-           </void> 
-          </object> 
-         </void> 
-         <void property="serdeClassName"> 
-          <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-         </void> 
-        </object> 
-       </void> 
-      </object> 
-     </void> 
-    </void> 
-    <void property="aliasToWork"> 
-     <object class="java.util.LinkedHashMap"> 
-      <void method="put"> 
-       <string>s</string> 
-       <object idref="TableScanOperator1"/> 
-      </void> 
-     </object> 
-    </void> 
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/srcbucket/kv1.txt</string> 
+       <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/srcbucket/kv1.txt</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>s</string> 
@@ -1247,7 +1045,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/srcbucket/kv1.txt</string> 
+       <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/srcbucket/kv1.txt</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/sample7.q.xml b/ql/src/test/results/compiler/plan/sample7.q.xml
index e533b67e79..f9491950e6 100644
--- a/ql/src/test/results/compiler/plan/sample7.q.xml
+++ b/ql/src/test/results/compiler/plan/sample7.q.xml
@@ -8,7 +8,7 @@
       <void property="childTasks"> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
-         <object id="MoveTask0" class="org.apache.hadoop.hive.ql.exec.MoveTask"> 
+         <object class="org.apache.hadoop.hive.ql.exec.MoveTask"> 
           <void property="id"> 
            <string>Stage-1</string> 
           </void> 
@@ -22,7 +22,7 @@
           <void property="work"> 
            <object class="org.apache.hadoop.hive.ql.plan.moveWork"> 
             <void property="loadTableWork"> 
-             <object id="loadTableDesc0" class="org.apache.hadoop.hive.ql.plan.loadTableDesc"> 
+             <object class="org.apache.hadoop.hive.ql.plan.loadTableDesc"> 
               <void property="partitionSpec"> 
                <object class="java.util.HashMap"/> 
               </void> 
@@ -30,7 +30,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/775167165/10000</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1687914780/10000</string> 
               </void> 
               <void property="table"> 
                <object id="tableDesc0" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -83,7 +83,7 @@
                   </void> 
                   <void method="put"> 
                    <string>location</string> 
-                   <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/dest1</string> 
+                   <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/dest1</string> 
                   </void> 
                  </object> 
                 </void> 
@@ -93,7 +93,7 @@
                </object> 
               </void> 
               <void property="tmpDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/775167165/10001</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1687914780/10001</string> 
               </void> 
              </object> 
             </void> 
@@ -121,10 +121,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1816861190/10002</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/386350957/10002</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/775167165/10000</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1687914780/10000</string> 
               </void> 
              </object> 
             </void> 
@@ -142,7 +142,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1816861190/10002</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/386350957/10002</string> 
                <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -338,10 +338,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1816861190/10002</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/386350957/10002</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1816861190/10002</string> 
+                 <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/386350957/10002</string> 
                 </void> 
                </object> 
               </void> 
@@ -350,7 +350,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1816861190/10002</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/386350957/10002</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object idref="tableDesc0"/> 
@@ -368,7 +368,7 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/775167165/10000</string> 
+                     <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1687914780/10000</string> 
                     </void> 
                     <void property="tableInfo"> 
                      <object idref="tableDesc0"/> 
@@ -458,284 +458,231 @@
       </void> 
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
-        <void property="ctx"> 
-         <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext"> 
-          <void property="conf"> 
-           <object id="HiveConf0" class="org.apache.hadoop.hive.conf.HiveConf"> 
-            <void property="auxJars"> 
-             <string>file:///data/users/njain/hive3/hive3/build/ql/test/test-udfs.jar</string> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="currAliasId"> 
-           <string>s</string> 
+        <void property="dir"> 
+         <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/386350957/10002</string> 
+        </void> 
+        <void property="listTasks"> 
+         <object idref="ArrayList0"/> 
+        </void> 
+       </object> 
+      </void> 
+      <void property="work"> 
+       <object class="org.apache.hadoop.hive.ql.plan.ConditionalWork"> 
+        <void property="listWorks"> 
+         <object class="java.util.ArrayList"> 
+          <void method="add"> 
+           <object idref="moveWork0"/> 
           </void> 
-          <void property="currTask"> 
-           <object idref="MapRedTask0"/> 
+          <void method="add"> 
+           <object idref="mapredWork0"/> 
           </void> 
-          <void property="currTopOp"> 
-           <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
+         </object> 
+        </void> 
+       </object> 
+      </void> 
+     </object> 
+    </void> 
+   </object> 
+  </void> 
+  <void property="id"> 
+   <string>Stage-2</string> 
+  </void> 
+  <void property="work"> 
+   <object class="org.apache.hadoop.hive.ql.plan.mapredWork"> 
+    <void property="aliasToPartnInfo"> 
+     <void method="put"> 
+      <string>s</string> 
+      <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
+       <void property="partSpec"> 
+        <object id="LinkedHashMap0" class="java.util.LinkedHashMap"/> 
+       </void> 
+       <void property="tableDesc"> 
+        <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
+         <void property="deserializerClass"> 
+          <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
+         </void> 
+         <void property="inputFileFormatClass"> 
+          <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+         </void> 
+         <void property="outputFileFormatClass"> 
+          <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+         </void> 
+         <void property="properties"> 
+          <object id="Properties0" class="java.util.Properties"> 
+           <void method="put"> 
+            <string>name</string> 
+            <string>srcbucket</string> 
+           </void> 
+           <void method="put"> 
+            <string>columns.types</string> 
+            <string>string:string</string> 
+           </void> 
+           <void method="put"> 
+            <string>bucket_field_name</string> 
+            <string>key</string> 
+           </void> 
+           <void method="put"> 
+            <string>serialization.ddl</string> 
+            <string>struct srcbucket { string key, string value}</string> 
+           </void> 
+           <void method="put"> 
+            <string>columns</string> 
+            <string>key,value</string> 
+           </void> 
+           <void method="put"> 
+            <string>serialization.format</string> 
+            <string>1</string> 
+           </void> 
+           <void method="put"> 
+            <string>bucket_count</string> 
+            <string>2</string> 
+           </void> 
+           <void method="put"> 
+            <string>serialization.lib</string> 
+            <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+           </void> 
+           <void method="put"> 
+            <string>file.inputformat</string> 
+            <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+           </void> 
+           <void method="put"> 
+            <string>file.outputformat</string> 
+            <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+           </void> 
+           <void method="put"> 
+            <string>location</string> 
+            <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/srcbucket</string> 
+           </void> 
+          </object> 
+         </void> 
+         <void property="serdeClassName"> 
+          <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+         </void> 
+        </object> 
+       </void> 
+      </object> 
+     </void> 
+    </void> 
+    <void property="aliasToWork"> 
+     <object class="java.util.LinkedHashMap"> 
+      <void method="put"> 
+       <string>s</string> 
+       <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
+        <void property="childOperators"> 
+         <object class="java.util.ArrayList"> 
+          <void method="add"> 
+           <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
             <void property="childOperators"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+               <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+                   <object id="FilterOperator2" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
                     <void property="childOperators"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object id="FilterOperator2" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+                       <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
                         <void property="childOperators"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                            <void property="childOperators"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object id="FileSinkOperator0" class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                                <void property="conf"> 
-                                 <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
-                                  <void property="destTableId"> 
-                                   <int>1</int> 
-                                  </void> 
-                                  <void property="dirName"> 
-                                   <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1816861190/10002</string> 
-                                  </void> 
-                                  <void property="tableInfo"> 
-                                   <object idref="tableDesc0"/> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void property="parentOperators"> 
-                                 <object class="java.util.ArrayList"> 
-                                  <void method="add"> 
-                                   <object idref="SelectOperator0"/> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void property="schema"> 
-                                 <object idref="RowSchema0"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="columnExprMap"> 
-                             <object class="java.util.HashMap"> 
-                              <void method="put"> 
-                               <string>_col1</string> 
-                               <object id="exprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                                <void property="column"> 
-                                 <string>value</string> 
-                                </void> 
-                                <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo1"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void method="put"> 
-                               <string>_col0</string> 
-                               <object id="exprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                                <void property="column"> 
-                                 <string>key</string> 
-                                </void> 
-                                <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo1"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
+                           <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
                             <void property="conf"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.selectDesc"> 
-                              <void property="colList"> 
-                               <object class="java.util.ArrayList"> 
-                                <void method="add"> 
-                                 <object idref="exprNodeColumnDesc1"/> 
-                                </void> 
-                                <void method="add"> 
-                                 <object idref="exprNodeColumnDesc0"/> 
-                                </void> 
-                               </object> 
+                             <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
+                              <void property="destTableId"> 
+                               <int>1</int> 
                               </void> 
-                              <void property="outputColumnNames"> 
-                               <object class="java.util.ArrayList"> 
-                                <void method="add"> 
-                                 <string>_col0</string> 
-                                </void> 
-                                <void method="add"> 
-                                 <string>_col1</string> 
-                                </void> 
-                               </object> 
+                              <void property="dirName"> 
+                               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/386350957/10002</string> 
                               </void> 
-                              <void property="selectStar"> 
-                               <boolean>true</boolean> 
+                              <void property="tableInfo"> 
+                               <object idref="tableDesc0"/> 
                               </void> 
                              </object> 
                             </void> 
                             <void property="parentOperators"> 
                              <object class="java.util.ArrayList"> 
                               <void method="add"> 
-                               <object idref="FilterOperator2"/> 
+                               <object idref="SelectOperator0"/> 
                               </void> 
                              </object> 
                             </void> 
                             <void property="schema"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                              <void property="signature"> 
-                               <object class="java.util.Vector"> 
-                                <void method="add"> 
-                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                  <void property="internalName"> 
-                                   <string>_col0</string> 
-                                  </void> 
-                                  <void property="type"> 
-                                   <object idref="PrimitiveTypeInfo1"/> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void method="add"> 
-                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                  <void property="internalName"> 
-                                   <string>_col1</string> 
-                                  </void> 
-                                  <void property="type"> 
-                                   <object idref="PrimitiveTypeInfo1"/> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
+                             <object idref="RowSchema0"/> 
                             </void> 
                            </object> 
                           </void> 
                          </object> 
                         </void> 
-                        <void property="conf"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.filterDesc"> 
-                          <void property="predicate"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                            <void property="UDFClass"> 
-                             <class>org.apache.hadoop.hive.ql.udf.UDFOPGreaterThan</class> 
+                        <void property="columnExprMap"> 
+                         <object class="java.util.HashMap"> 
+                          <void method="put"> 
+                           <string>_col1</string> 
+                           <object id="exprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                            <void property="column"> 
+                             <string>value</string> 
                             </void> 
-                            <void property="UDFMethod"> 
-                             <object id="Method0" class="org.apache.hadoop.hive.ql.udf.UDFOPGreaterThan" method="getMethod"> 
-                              <string>evaluate</string> 
-                              <array class="java.lang.Class" length="2"> 
-                               <void index="0"> 
-                                <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
-                               </void> 
-                               <void index="1"> 
-                                <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
-                               </void> 
-                              </array> 
-                             </object> 
+                            <void property="typeInfo"> 
+                             <object idref="PrimitiveTypeInfo1"/> 
                             </void> 
-                            <void property="childExprs"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                                <void property="UDFClass"> 
-                                 <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
-                                </void> 
-                                <void property="UDFMethod"> 
-                                 <object id="Method1" class="org.apache.hadoop.hive.ql.udf.UDFToDouble" method="getMethod"> 
-                                  <string>evaluate</string> 
-                                  <array class="java.lang.Class" length="1"> 
-                                   <void index="0"> 
-                                    <class>org.apache.hadoop.io.Text</class> 
-                                   </void> 
-                                  </array> 
-                                 </object> 
-                                </void> 
-                                <void property="childExprs"> 
-                                 <object class="java.util.ArrayList"> 
-                                  <void method="add"> 
-                                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                                    <void property="column"> 
-                                     <string>key</string> 
-                                    </void> 
-                                    <void property="typeInfo"> 
-                                     <object idref="PrimitiveTypeInfo1"/> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo0"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                                <void property="UDFClass"> 
-                                 <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
-                                </void> 
-                                <void property="UDFMethod"> 
-                                 <object id="Method2" class="org.apache.hadoop.hive.ql.udf.UDFToDouble" method="getMethod"> 
-                                  <string>evaluate</string> 
-                                  <array class="java.lang.Class" length="1"> 
-                                   <void index="0"> 
-                                    <class>org.apache.hadoop.io.IntWritable</class> 
-                                   </void> 
-                                  </array> 
-                                 </object> 
-                                </void> 
-                                <void property="childExprs"> 
-                                 <object class="java.util.ArrayList"> 
-                                  <void method="add"> 
-                                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
-                                    <void property="typeInfo"> 
-                                     <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                                      <void property="typeName"> 
-                                       <string>int</string> 
-                                      </void> 
-                                     </object> 
-                                    </void> 
-                                    <void property="value"> 
-                                     <int>100</int> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo0"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
+                           </object> 
+                          </void> 
+                          <void method="put"> 
+                           <string>_col0</string> 
+                           <object id="exprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                            <void property="column"> 
+                             <string>key</string> 
                             </void> 
                             <void property="typeInfo"> 
-                             <object id="PrimitiveTypeInfo3" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                              <void property="typeName"> 
-                               <string>boolean</string> 
-                              </void> 
-                             </object> 
+                             <object idref="PrimitiveTypeInfo1"/> 
+                            </void> 
+                           </object> 
+                          </void> 
+                         </object> 
+                        </void> 
+                        <void property="conf"> 
+                         <object class="org.apache.hadoop.hive.ql.plan.selectDesc"> 
+                          <void property="colList"> 
+                           <object class="java.util.ArrayList"> 
+                            <void method="add"> 
+                             <object idref="exprNodeColumnDesc1"/> 
+                            </void> 
+                            <void method="add"> 
+                             <object idref="exprNodeColumnDesc0"/> 
+                            </void> 
+                           </object> 
+                          </void> 
+                          <void property="outputColumnNames"> 
+                           <object class="java.util.ArrayList"> 
+                            <void method="add"> 
+                             <string>_col0</string> 
+                            </void> 
+                            <void method="add"> 
+                             <string>_col1</string> 
                             </void> 
                            </object> 
                           </void> 
+                          <void property="selectStar"> 
+                           <boolean>true</boolean> 
+                          </void> 
                          </object> 
                         </void> 
                         <void property="parentOperators"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <object idref="FilterOperator1"/> 
+                           <object idref="FilterOperator2"/> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="schema"> 
                          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
                           <void property="signature"> 
-                           <object id="Vector0" class="java.util.Vector"> 
+                           <object class="java.util.Vector"> 
                             <void method="add"> 
                              <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                               <void property="internalName"> 
-                               <string>key</string> 
+                               <string>_col0</string> 
                               </void> 
                               <void property="type"> 
                                <object idref="PrimitiveTypeInfo1"/> 
@@ -745,7 +692,7 @@
                             <void method="add"> 
                              <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                               <void property="internalName"> 
-                               <string>value</string> 
+                               <string>_col1</string> 
                               </void> 
                               <void property="type"> 
                                <object idref="PrimitiveTypeInfo1"/> 
@@ -765,17 +712,17 @@
                       <void property="predicate"> 
                        <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
                         <void property="UDFClass"> 
-                         <class>org.apache.hadoop.hive.ql.udf.UDFOPEqual</class> 
+                         <class>org.apache.hadoop.hive.ql.udf.UDFOPGreaterThan</class> 
                         </void> 
                         <void property="UDFMethod"> 
-                         <object id="Method3" class="org.apache.hadoop.hive.ql.udf.UDFOPEqual" method="getMethod"> 
+                         <object id="Method0" class="org.apache.hadoop.hive.ql.udf.UDFOPGreaterThan" method="getMethod"> 
                           <string>evaluate</string> 
                           <array class="java.lang.Class" length="2"> 
                            <void index="0"> 
-                            <class>org.apache.hadoop.io.IntWritable</class> 
+                            <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
                            </void> 
                            <void index="1"> 
-                            <class>org.apache.hadoop.io.IntWritable</class> 
+                            <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
                            </void> 
                           </array> 
                          </object> 
@@ -785,17 +732,14 @@
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
                             <void property="UDFClass"> 
-                             <class>org.apache.hadoop.hive.ql.udf.UDFOPMod</class> 
+                             <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
                             </void> 
                             <void property="UDFMethod"> 
-                             <object id="Method4" class="org.apache.hadoop.hive.ql.udf.UDFOPMod" method="getMethod"> 
+                             <object id="Method1" class="org.apache.hadoop.hive.ql.udf.UDFToDouble" method="getMethod"> 
                               <string>evaluate</string> 
-                              <array class="java.lang.Class" length="2"> 
+                              <array class="java.lang.Class" length="1"> 
                                <void index="0"> 
-                                <class>org.apache.hadoop.io.IntWritable</class> 
-                               </void> 
-                               <void index="1"> 
-                                <class>org.apache.hadoop.io.IntWritable</class> 
+                                <class>org.apache.hadoop.io.Text</class> 
                                </void> 
                               </array> 
                              </object> 
@@ -803,97 +747,68 @@
                             <void property="childExprs"> 
                              <object class="java.util.ArrayList"> 
                               <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                                <void property="UDFClass"> 
-                                 <class>org.apache.hadoop.hive.ql.udf.UDFOPBitAnd</class> 
-                                </void> 
-                                <void property="UDFMethod"> 
-                                 <object id="Method5" class="org.apache.hadoop.hive.ql.udf.UDFOPBitAnd" method="getMethod"> 
-                                  <string>evaluate</string> 
-                                  <array class="java.lang.Class" length="2"> 
-                                   <void index="0"> 
-                                    <class>org.apache.hadoop.io.IntWritable</class> 
-                                   </void> 
-                                   <void index="1"> 
-                                    <class>org.apache.hadoop.io.IntWritable</class> 
-                                   </void> 
-                                  </array> 
-                                 </object> 
-                                </void> 
-                                <void property="childExprs"> 
-                                 <object class="java.util.ArrayList"> 
-                                  <void method="add"> 
-                                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeGenericFuncDesc"> 
-                                    <void property="childExprs"> 
-                                     <object class="java.util.ArrayList"> 
-                                      <void method="add"> 
-                                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                                        <void property="column"> 
-                                         <string>key</string> 
-                                        </void> 
-                                        <void property="typeInfo"> 
-                                         <object idref="PrimitiveTypeInfo1"/> 
-                                        </void> 
-                                       </object> 
-                                      </void> 
-                                     </object> 
-                                    </void> 
-                                    <void property="genericUDFClass"> 
-                                     <class>org.apache.hadoop.hive.ql.udf.generic.GenericUDFHash</class> 
-                                    </void> 
-                                    <void property="typeInfo"> 
-                                     <object idref="PrimitiveTypeInfo2"/> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                  <void method="add"> 
-                                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
-                                    <void property="typeInfo"> 
-                                     <object idref="PrimitiveTypeInfo2"/> 
-                                    </void> 
-                                    <void property="value"> 
-                                     <int>2147483647</int> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                 </object> 
+                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                                <void property="column"> 
+                                 <string>key</string> 
                                 </void> 
                                 <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo2"/> 
+                                 <object idref="PrimitiveTypeInfo1"/> 
                                 </void> 
                                </object> 
                               </void> 
+                             </object> 
+                            </void> 
+                            <void property="typeInfo"> 
+                             <object idref="PrimitiveTypeInfo0"/> 
+                            </void> 
+                           </object> 
+                          </void> 
+                          <void method="add"> 
+                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                            <void property="UDFClass"> 
+                             <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
+                            </void> 
+                            <void property="UDFMethod"> 
+                             <object id="Method2" class="org.apache.hadoop.hive.ql.udf.UDFToDouble" method="getMethod"> 
+                              <string>evaluate</string> 
+                              <array class="java.lang.Class" length="1"> 
+                               <void index="0"> 
+                                <class>org.apache.hadoop.io.IntWritable</class> 
+                               </void> 
+                              </array> 
+                             </object> 
+                            </void> 
+                            <void property="childExprs"> 
+                             <object class="java.util.ArrayList"> 
                               <void method="add"> 
                                <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                                 <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo2"/> 
+                                 <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                                  <void property="typeName"> 
+                                   <string>int</string> 
+                                  </void> 
+                                 </object> 
                                 </void> 
                                 <void property="value"> 
-                                 <int>4</int> 
+                                 <int>100</int> 
                                 </void> 
                                </object> 
                               </void> 
                              </object> 
                             </void> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo2"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo2"/> 
-                            </void> 
-                            <void property="value"> 
-                             <int>0</int> 
+                             <object idref="PrimitiveTypeInfo0"/> 
                             </void> 
                            </object> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo3"/> 
+                         <object id="PrimitiveTypeInfo3" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                          <void property="typeName"> 
+                           <string>boolean</string> 
+                          </void> 
+                         </object> 
                         </void> 
                        </object> 
                       </void> 
@@ -902,7 +817,35 @@
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object idref="FilterOperator0"/> 
+                       <object idref="FilterOperator1"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="schema"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                      <void property="signature"> 
+                       <object id="Vector0" class="java.util.Vector"> 
+                        <void method="add"> 
+                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                          <void property="internalName"> 
+                           <string>key</string> 
+                          </void> 
+                          <void property="type"> 
+                           <object idref="PrimitiveTypeInfo1"/> 
+                          </void> 
+                         </object> 
+                        </void> 
+                        <void method="add"> 
+                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                          <void property="internalName"> 
+                           <string>value</string> 
+                          </void> 
+                          <void property="type"> 
+                           <object idref="PrimitiveTypeInfo1"/> 
+                          </void> 
+                         </object> 
+                        </void> 
+                       </object> 
                       </void> 
                      </object> 
                     </void> 
@@ -915,17 +858,17 @@
                   <void property="predicate"> 
                    <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
                     <void property="UDFClass"> 
-                     <class>org.apache.hadoop.hive.ql.udf.UDFOPAnd</class> 
+                     <class>org.apache.hadoop.hive.ql.udf.UDFOPEqual</class> 
                     </void> 
                     <void property="UDFMethod"> 
-                     <object class="org.apache.hadoop.hive.ql.udf.UDFOPAnd" method="getMethod"> 
+                     <object id="Method3" class="org.apache.hadoop.hive.ql.udf.UDFOPEqual" method="getMethod"> 
                       <string>evaluate</string> 
                       <array class="java.lang.Class" length="2"> 
                        <void index="0"> 
-                        <class>org.apache.hadoop.io.BooleanWritable</class> 
+                        <class>org.apache.hadoop.io.IntWritable</class> 
                        </void> 
                        <void index="1"> 
-                        <class>org.apache.hadoop.io.BooleanWritable</class> 
+                        <class>org.apache.hadoop.io.IntWritable</class> 
                        </void> 
                       </array> 
                      </object> 
@@ -935,69 +878,62 @@
                       <void method="add"> 
                        <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
                         <void property="UDFClass"> 
-                         <class>org.apache.hadoop.hive.ql.udf.UDFOPEqual</class> 
+                         <class>org.apache.hadoop.hive.ql.udf.UDFOPMod</class> 
                         </void> 
                         <void property="UDFMethod"> 
-                         <object idref="Method3"/> 
+                         <object id="Method4" class="org.apache.hadoop.hive.ql.udf.UDFOPMod" method="getMethod"> 
+                          <string>evaluate</string> 
+                          <array class="java.lang.Class" length="2"> 
+                           <void index="0"> 
+                            <class>org.apache.hadoop.io.IntWritable</class> 
+                           </void> 
+                           <void index="1"> 
+                            <class>org.apache.hadoop.io.IntWritable</class> 
+                           </void> 
+                          </array> 
+                         </object> 
                         </void> 
                         <void property="childExprs"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
                             <void property="UDFClass"> 
-                             <class>org.apache.hadoop.hive.ql.udf.UDFOPMod</class> 
+                             <class>org.apache.hadoop.hive.ql.udf.UDFOPBitAnd</class> 
                             </void> 
                             <void property="UDFMethod"> 
-                             <object idref="Method4"/> 
+                             <object id="Method5" class="org.apache.hadoop.hive.ql.udf.UDFOPBitAnd" method="getMethod"> 
+                              <string>evaluate</string> 
+                              <array class="java.lang.Class" length="2"> 
+                               <void index="0"> 
+                                <class>org.apache.hadoop.io.IntWritable</class> 
+                               </void> 
+                               <void index="1"> 
+                                <class>org.apache.hadoop.io.IntWritable</class> 
+                               </void> 
+                              </array> 
+                             </object> 
                             </void> 
                             <void property="childExprs"> 
                              <object class="java.util.ArrayList"> 
                               <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                                <void property="UDFClass"> 
-                                 <class>org.apache.hadoop.hive.ql.udf.UDFOPBitAnd</class> 
-                                </void> 
-                                <void property="UDFMethod"> 
-                                 <object idref="Method5"/> 
-                                </void> 
+                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeGenericFuncDesc"> 
                                 <void property="childExprs"> 
                                  <object class="java.util.ArrayList"> 
                                   <void method="add"> 
-                                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeGenericFuncDesc"> 
-                                    <void property="childExprs"> 
-                                     <object class="java.util.ArrayList"> 
-                                      <void method="add"> 
-                                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                                        <void property="column"> 
-                                         <string>key</string> 
-                                        </void> 
-                                        <void property="typeInfo"> 
-                                         <object idref="PrimitiveTypeInfo1"/> 
-                                        </void> 
-                                       </object> 
-                                      </void> 
-                                     </object> 
-                                    </void> 
-                                    <void property="genericUDFClass"> 
-                                     <class>org.apache.hadoop.hive.ql.udf.generic.GenericUDFHash</class> 
+                                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                                    <void property="column"> 
+                                     <string>key</string> 
                                     </void> 
                                     <void property="typeInfo"> 
-                                     <object idref="PrimitiveTypeInfo2"/> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                  <void method="add"> 
-                                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
-                                    <void property="typeInfo"> 
-                                     <object idref="PrimitiveTypeInfo2"/> 
-                                    </void> 
-                                    <void property="value"> 
-                                     <int>2147483647</int> 
+                                     <object idref="PrimitiveTypeInfo1"/> 
                                     </void> 
                                    </object> 
                                   </void> 
                                  </object> 
                                 </void> 
+                                <void property="genericUDFClass"> 
+                                 <class>org.apache.hadoop.hive.ql.udf.generic.GenericUDFHash</class> 
+                                </void> 
                                 <void property="typeInfo"> 
                                  <object idref="PrimitiveTypeInfo2"/> 
                                 </void> 
@@ -1009,7 +945,7 @@
                                  <object idref="PrimitiveTypeInfo2"/> 
                                 </void> 
                                 <void property="value"> 
-                                 <int>4</int> 
+                                 <int>2147483647</int> 
                                 </void> 
                                </object> 
                               </void> 
@@ -1026,85 +962,164 @@
                              <object idref="PrimitiveTypeInfo2"/> 
                             </void> 
                             <void property="value"> 
-                             <int>0</int> 
+                             <int>4</int> 
                             </void> 
                            </object> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo3"/> 
+                         <object idref="PrimitiveTypeInfo2"/> 
                         </void> 
                        </object> 
                       </void> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo2"/> 
+                        </void> 
+                        <void property="value"> 
+                         <int>0</int> 
+                        </void> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo3"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
+                </void> 
+                <void property="parentOperators"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object idref="FilterOperator0"/> 
+                  </void> 
+                 </object> 
+                </void> 
+               </object> 
+              </void> 
+             </object> 
+            </void> 
+            <void property="conf"> 
+             <object class="org.apache.hadoop.hive.ql.plan.filterDesc"> 
+              <void property="predicate"> 
+               <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                <void property="UDFClass"> 
+                 <class>org.apache.hadoop.hive.ql.udf.UDFOPAnd</class> 
+                </void> 
+                <void property="UDFMethod"> 
+                 <object class="org.apache.hadoop.hive.ql.udf.UDFOPAnd" method="getMethod"> 
+                  <string>evaluate</string> 
+                  <array class="java.lang.Class" length="2"> 
+                   <void index="0"> 
+                    <class>org.apache.hadoop.io.BooleanWritable</class> 
+                   </void> 
+                   <void index="1"> 
+                    <class>org.apache.hadoop.io.BooleanWritable</class> 
+                   </void> 
+                  </array> 
+                 </object> 
+                </void> 
+                <void property="childExprs"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                    <void property="UDFClass"> 
+                     <class>org.apache.hadoop.hive.ql.udf.UDFOPEqual</class> 
+                    </void> 
+                    <void property="UDFMethod"> 
+                     <object idref="Method3"/> 
+                    </void> 
+                    <void property="childExprs"> 
+                     <object class="java.util.ArrayList"> 
                       <void method="add"> 
                        <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
                         <void property="UDFClass"> 
-                         <class>org.apache.hadoop.hive.ql.udf.UDFOPGreaterThan</class> 
+                         <class>org.apache.hadoop.hive.ql.udf.UDFOPMod</class> 
                         </void> 
                         <void property="UDFMethod"> 
-                         <object idref="Method0"/> 
+                         <object idref="Method4"/> 
                         </void> 
                         <void property="childExprs"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
                             <void property="UDFClass"> 
-                             <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
+                             <class>org.apache.hadoop.hive.ql.udf.UDFOPBitAnd</class> 
                             </void> 
                             <void property="UDFMethod"> 
-                             <object idref="Method1"/> 
+                             <object idref="Method5"/> 
                             </void> 
                             <void property="childExprs"> 
                              <object class="java.util.ArrayList"> 
                               <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                                <void property="column"> 
-                                 <string>key</string> 
+                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeGenericFuncDesc"> 
+                                <void property="childExprs"> 
+                                 <object class="java.util.ArrayList"> 
+                                  <void method="add"> 
+                                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                                    <void property="column"> 
+                                     <string>key</string> 
+                                    </void> 
+                                    <void property="typeInfo"> 
+                                     <object idref="PrimitiveTypeInfo1"/> 
+                                    </void> 
+                                   </object> 
+                                  </void> 
+                                 </object> 
+                                </void> 
+                                <void property="genericUDFClass"> 
+                                 <class>org.apache.hadoop.hive.ql.udf.generic.GenericUDFHash</class> 
                                 </void> 
                                 <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo1"/> 
+                                 <object idref="PrimitiveTypeInfo2"/> 
                                 </void> 
                                </object> 
                               </void> 
-                             </object> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                            <void property="UDFClass"> 
-                             <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
-                            </void> 
-                            <void property="UDFMethod"> 
-                             <object idref="Method2"/> 
-                            </void> 
-                            <void property="childExprs"> 
-                             <object class="java.util.ArrayList"> 
                               <void method="add"> 
                                <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                                 <void property="typeInfo"> 
                                  <object idref="PrimitiveTypeInfo2"/> 
                                 </void> 
                                 <void property="value"> 
-                                 <int>100</int> 
+                                 <int>2147483647</int> 
                                 </void> 
                                </object> 
                               </void> 
                              </object> 
                             </void> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
+                             <object idref="PrimitiveTypeInfo2"/> 
+                            </void> 
+                           </object> 
+                          </void> 
+                          <void method="add"> 
+                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
+                            <void property="typeInfo"> 
+                             <object idref="PrimitiveTypeInfo2"/> 
+                            </void> 
+                            <void property="value"> 
+                             <int>4</int> 
                             </void> 
                            </object> 
                           </void> 
                          </object> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo3"/> 
+                         <object idref="PrimitiveTypeInfo2"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo2"/> 
+                        </void> 
+                        <void property="value"> 
+                         <int>0</int> 
                         </void> 
                        </object> 
                       </void> 
@@ -1115,33 +1130,90 @@
                     </void> 
                    </object> 
                   </void> 
-                 </object> 
-                </void> 
-                <void property="parentOperators"> 
-                 <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object idref="TableScanOperator1"/> 
+                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                    <void property="UDFClass"> 
+                     <class>org.apache.hadoop.hive.ql.udf.UDFOPGreaterThan</class> 
+                    </void> 
+                    <void property="UDFMethod"> 
+                     <object idref="Method0"/> 
+                    </void> 
+                    <void property="childExprs"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                        <void property="UDFClass"> 
+                         <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
+                        </void> 
+                        <void property="UDFMethod"> 
+                         <object idref="Method1"/> 
+                        </void> 
+                        <void property="childExprs"> 
+                         <object class="java.util.ArrayList"> 
+                          <void method="add"> 
+                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                            <void property="column"> 
+                             <string>key</string> 
+                            </void> 
+                            <void property="typeInfo"> 
+                             <object idref="PrimitiveTypeInfo1"/> 
+                            </void> 
+                           </object> 
+                          </void> 
+                         </object> 
+                        </void> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo0"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                        <void property="UDFClass"> 
+                         <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
+                        </void> 
+                        <void property="UDFMethod"> 
+                         <object idref="Method2"/> 
+                        </void> 
+                        <void property="childExprs"> 
+                         <object class="java.util.ArrayList"> 
+                          <void method="add"> 
+                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
+                            <void property="typeInfo"> 
+                             <object idref="PrimitiveTypeInfo2"/> 
+                            </void> 
+                            <void property="value"> 
+                             <int>100</int> 
+                            </void> 
+                           </object> 
+                          </void> 
+                         </object> 
+                        </void> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo0"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo3"/> 
+                    </void> 
+                   </object> 
                   </void> 
                  </object> 
                 </void> 
-                <void property="schema"> 
-                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                  <void property="signature"> 
-                   <object idref="Vector0"/> 
-                  </void> 
-                 </object> 
+                <void property="typeInfo"> 
+                 <object idref="PrimitiveTypeInfo3"/> 
                 </void> 
                </object> 
               </void> 
              </object> 
             </void> 
-            <void property="neededColumnIDs"> 
+            <void property="parentOperators"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <int>0</int> 
-              </void> 
-              <void method="add"> 
-               <int>1</int> 
+               <object idref="TableScanOperator1"/> 
               </void> 
              </object> 
             </void> 
@@ -1154,219 +1226,22 @@
             </void> 
            </object> 
           </void> 
-          <void property="mapCurrCtx"> 
-           <object class="java.util.LinkedHashMap"> 
-            <void method="put"> 
-             <object idref="TableScanOperator1"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-            <void method="put"> 
-             <object idref="FilterOperator0"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-            <void method="put"> 
-             <object idref="FilterOperator1"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-            <void method="put"> 
-             <object idref="FilterOperator2"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-            <void method="put"> 
-             <object idref="SelectOperator0"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="mvTask"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="MoveTask0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="opTaskMap"> 
-           <object class="java.util.HashMap"> 
-            <void method="put"> 
-             <null/> 
-             <object idref="MapRedTask0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="parseCtx"> 
-           <object class="org.apache.hadoop.hive.ql.parse.ParseContext"> 
-            <void property="QB"> 
-             <object class="org.apache.hadoop.hive.ql.parse.QB"/> 
-            </void> 
-            <void property="UCtx"> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.unionproc.UnionProcContext"/> 
-            </void> 
-            <void property="aliasToPruner"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>s</string> 
-               <object class="org.apache.hadoop.hive.ql.parse.PartitionPruner"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="aliasToSamplePruner"> 
-             <object class="java.util.HashMap"/> 
-            </void> 
-            <void property="conf"> 
-             <object idref="HiveConf0"/> 
-            </void> 
-            <void property="context"> 
-             <object class="org.apache.hadoop.hive.ql.Context"/> 
-            </void> 
-            <void property="destTableId"> 
-             <int>2</int> 
-            </void> 
-            <void property="idToTableNameMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>1</string> 
-               <string>dest1</string> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="joinContext"> 
-             <object class="java.util.HashMap"/> 
-            </void> 
-            <void property="listMapJoinOpsNoReducer"> 
-             <object class="java.util.ArrayList"/> 
-            </void> 
-            <void property="loadFileWork"> 
-             <object class="java.util.ArrayList"/> 
-            </void> 
-            <void property="loadTableWork"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="loadTableDesc0"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="opParseCtx"> 
-             <object class="java.util.LinkedHashMap"> 
-              <void method="put"> 
-               <object idref="TableScanOperator1"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object id="RowResolver0" class="org.apache.hadoop.hive.ql.parse.RowResolver"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="FilterOperator1"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object idref="RowResolver0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="FilterOperator2"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object idref="RowResolver0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="SelectOperator0"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object id="RowResolver1" class="org.apache.hadoop.hive.ql.parse.RowResolver"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="FileSinkOperator0"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object idref="RowResolver1"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="FilterOperator0"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object idref="RowResolver0"/> 
-                </void> 
-               </object> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="parseTree"> 
-             <object class="org.apache.hadoop.hive.ql.parse.ASTNode"> 
-              <void property="tokenStartIndex"> 
-               <int>2</int> 
-              </void> 
-              <void property="tokenStopIndex"> 
-               <int>49</int> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="topOps"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>s</string> 
-               <object idref="TableScanOperator1"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="topSelOps"> 
-             <object class="java.util.HashMap"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="rootOps"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="TableScanOperator1"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="rootTasks"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="MapRedTask0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="seenFileSinkOps"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="FileSinkOperator0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="seenOps"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="TableScanOperator1"/> 
-            </void> 
-           </object> 
-          </void> 
          </object> 
         </void> 
-        <void property="dir"> 
-         <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1816861190/10002</string> 
-        </void> 
-        <void property="listTasks"> 
-         <object idref="ArrayList0"/> 
-        </void> 
-       </object> 
-      </void> 
-      <void property="work"> 
-       <object class="org.apache.hadoop.hive.ql.plan.ConditionalWork"> 
-        <void property="listWorks"> 
+        <void property="neededColumnIDs"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <object idref="moveWork0"/> 
+           <int>0</int> 
           </void> 
           <void method="add"> 
-           <object idref="mapredWork0"/> 
+           <int>1</int> 
+          </void> 
+         </object> 
+        </void> 
+        <void property="schema"> 
+         <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+          <void property="signature"> 
+           <object idref="Vector0"/> 
           </void> 
          </object> 
         </void> 
@@ -1374,99 +1249,10 @@
       </void> 
      </object> 
     </void> 
-   </object> 
-  </void> 
-  <void property="id"> 
-   <string>Stage-2</string> 
-  </void> 
-  <void property="work"> 
-   <object class="org.apache.hadoop.hive.ql.plan.mapredWork"> 
-    <void property="aliasToPartnInfo"> 
-     <void method="put"> 
-      <string>s</string> 
-      <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
-       <void property="partSpec"> 
-        <object id="LinkedHashMap0" class="java.util.LinkedHashMap"/> 
-       </void> 
-       <void property="tableDesc"> 
-        <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
-         <void property="deserializerClass"> 
-          <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
-         </void> 
-         <void property="inputFileFormatClass"> 
-          <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-         </void> 
-         <void property="outputFileFormatClass"> 
-          <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-         </void> 
-         <void property="properties"> 
-          <object id="Properties0" class="java.util.Properties"> 
-           <void method="put"> 
-            <string>name</string> 
-            <string>srcbucket</string> 
-           </void> 
-           <void method="put"> 
-            <string>columns.types</string> 
-            <string>string:string</string> 
-           </void> 
-           <void method="put"> 
-            <string>bucket_field_name</string> 
-            <string>key</string> 
-           </void> 
-           <void method="put"> 
-            <string>serialization.ddl</string> 
-            <string>struct srcbucket { string key, string value}</string> 
-           </void> 
-           <void method="put"> 
-            <string>columns</string> 
-            <string>key,value</string> 
-           </void> 
-           <void method="put"> 
-            <string>serialization.format</string> 
-            <string>1</string> 
-           </void> 
-           <void method="put"> 
-            <string>bucket_count</string> 
-            <string>2</string> 
-           </void> 
-           <void method="put"> 
-            <string>serialization.lib</string> 
-            <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-           </void> 
-           <void method="put"> 
-            <string>file.inputformat</string> 
-            <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-           </void> 
-           <void method="put"> 
-            <string>file.outputformat</string> 
-            <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-           </void> 
-           <void method="put"> 
-            <string>location</string> 
-            <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/srcbucket</string> 
-           </void> 
-          </object> 
-         </void> 
-         <void property="serdeClassName"> 
-          <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-         </void> 
-        </object> 
-       </void> 
-      </object> 
-     </void> 
-    </void> 
-    <void property="aliasToWork"> 
-     <object class="java.util.LinkedHashMap"> 
-      <void method="put"> 
-       <string>s</string> 
-       <object idref="TableScanOperator1"/> 
-      </void> 
-     </object> 
-    </void> 
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/srcbucket/kv1.txt</string> 
+       <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/srcbucket/kv1.txt</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>s</string> 
@@ -1478,7 +1264,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/srcbucket/kv1.txt</string> 
+       <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/srcbucket/kv1.txt</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/subq.q.xml b/ql/src/test/results/compiler/plan/subq.q.xml
index 58e3c245e4..61900ac782 100644
--- a/ql/src/test/results/compiler/plan/subq.q.xml
+++ b/ql/src/test/results/compiler/plan/subq.q.xml
@@ -8,7 +8,7 @@
       <void property="childTasks"> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
-         <object id="MoveTask0" class="org.apache.hadoop.hive.ql.exec.MoveTask"> 
+         <object class="org.apache.hadoop.hive.ql.exec.MoveTask"> 
           <void property="id"> 
            <string>Stage-1</string> 
           </void> 
@@ -22,7 +22,7 @@
           <void property="work"> 
            <object class="org.apache.hadoop.hive.ql.plan.moveWork"> 
             <void property="loadFileWork"> 
-             <object id="loadFileDesc0" class="org.apache.hadoop.hive.ql.plan.loadFileDesc"> 
+             <object class="org.apache.hadoop.hive.ql.plan.loadFileDesc"> 
               <void property="columnTypes"> 
                <string>string:string</string> 
               </void> 
@@ -33,7 +33,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1983887204/10000</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1054025475/10000</string> 
               </void> 
               <void property="targetDir"> 
                <string>../build/ql/test/data/warehouse/union.out</string> 
@@ -64,10 +64,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1141082271/10001</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/47100551/10001</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1983887204/10000</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1054025475/10000</string> 
               </void> 
              </object> 
             </void> 
@@ -85,7 +85,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1141082271/10001</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/47100551/10001</string> 
                <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -281,10 +281,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1141082271/10001</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/47100551/10001</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1141082271/10001</string> 
+                 <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/47100551/10001</string> 
                 </void> 
                </object> 
               </void> 
@@ -293,7 +293,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1141082271/10001</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/47100551/10001</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object id="tableDesc2" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -337,7 +337,7 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1983887204/10000</string> 
+                     <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1054025475/10000</string> 
                     </void> 
                     <void property="tableInfo"> 
                      <object idref="tableDesc2"/> 
@@ -427,157 +427,154 @@
       </void> 
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
-        <void property="ctx"> 
-         <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext"> 
-          <void property="conf"> 
-           <object id="HiveConf0" class="org.apache.hadoop.hive.conf.HiveConf"> 
-            <void property="auxJars"> 
-             <string>file:///data/users/njain/hive3/hive3/build/ql/test/test-udfs.jar</string> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="currAliasId"> 
-           <string>unioninput:src</string> 
+        <void property="dir"> 
+         <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/47100551/10001</string> 
+        </void> 
+        <void property="listTasks"> 
+         <object idref="ArrayList0"/> 
+        </void> 
+       </object> 
+      </void> 
+      <void property="work"> 
+       <object class="org.apache.hadoop.hive.ql.plan.ConditionalWork"> 
+        <void property="listWorks"> 
+         <object class="java.util.ArrayList"> 
+          <void method="add"> 
+           <object idref="moveWork0"/> 
           </void> 
-          <void property="currTask"> 
-           <object idref="MapRedTask0"/> 
+          <void method="add"> 
+           <object idref="mapredWork0"/> 
           </void> 
-          <void property="currTopOp"> 
-           <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
+         </object> 
+        </void> 
+       </object> 
+      </void> 
+     </object> 
+    </void> 
+   </object> 
+  </void> 
+  <void property="id"> 
+   <string>Stage-2</string> 
+  </void> 
+  <void property="work"> 
+   <object class="org.apache.hadoop.hive.ql.plan.mapredWork"> 
+    <void property="aliasToPartnInfo"> 
+     <void method="put"> 
+      <string>unioninput:src</string> 
+      <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
+       <void property="partSpec"> 
+        <object id="LinkedHashMap0" class="java.util.LinkedHashMap"/> 
+       </void> 
+       <void property="tableDesc"> 
+        <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
+         <void property="deserializerClass"> 
+          <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
+         </void> 
+         <void property="inputFileFormatClass"> 
+          <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+         </void> 
+         <void property="outputFileFormatClass"> 
+          <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+         </void> 
+         <void property="properties"> 
+          <object id="Properties0" class="java.util.Properties"> 
+           <void method="put"> 
+            <string>name</string> 
+            <string>src</string> 
+           </void> 
+           <void method="put"> 
+            <string>columns.types</string> 
+            <string>string:string</string> 
+           </void> 
+           <void method="put"> 
+            <string>serialization.ddl</string> 
+            <string>struct src { string key, string value}</string> 
+           </void> 
+           <void method="put"> 
+            <string>serialization.format</string> 
+            <string>1</string> 
+           </void> 
+           <void method="put"> 
+            <string>columns</string> 
+            <string>key,value</string> 
+           </void> 
+           <void method="put"> 
+            <string>bucket_count</string> 
+            <string>-1</string> 
+           </void> 
+           <void method="put"> 
+            <string>serialization.lib</string> 
+            <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+           </void> 
+           <void method="put"> 
+            <string>file.inputformat</string> 
+            <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+           </void> 
+           <void method="put"> 
+            <string>file.outputformat</string> 
+            <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+           </void> 
+           <void method="put"> 
+            <string>location</string> 
+            <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/src</string> 
+           </void> 
+          </object> 
+         </void> 
+         <void property="serdeClassName"> 
+          <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+         </void> 
+        </object> 
+       </void> 
+      </object> 
+     </void> 
+    </void> 
+    <void property="aliasToWork"> 
+     <object class="java.util.LinkedHashMap"> 
+      <void method="put"> 
+       <string>unioninput:src</string> 
+       <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
+        <void property="childOperators"> 
+         <object class="java.util.ArrayList"> 
+          <void method="add"> 
+           <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
             <void property="childOperators"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+               <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+                   <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
                     <void property="childOperators"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+                       <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
                         <void property="childOperators"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                            <void property="childOperators"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object id="FileSinkOperator0" class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                                <void property="conf"> 
-                                 <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
-                                  <void property="destTableId"> 
-                                   <int>1</int> 
-                                  </void> 
-                                  <void property="dirName"> 
-                                   <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1141082271/10001</string> 
-                                  </void> 
-                                  <void property="tableInfo"> 
-                                   <object idref="tableDesc2"/> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void property="parentOperators"> 
-                                 <object class="java.util.ArrayList"> 
-                                  <void method="add"> 
-                                   <object idref="SelectOperator1"/> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void property="schema"> 
-                                 <object idref="RowSchema0"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="columnExprMap"> 
-                             <object class="java.util.HashMap"> 
-                              <void method="put"> 
-                               <string>_col1</string> 
-                               <object id="exprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                                <void property="column"> 
-                                 <string>_col1</string> 
-                                </void> 
-                                <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo1"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                              <void method="put"> 
-                               <string>_col0</string> 
-                               <object id="exprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                                <void property="column"> 
-                                 <string>_col0</string> 
-                                </void> 
-                                <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo1"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
+                           <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
                             <void property="conf"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.selectDesc"> 
-                              <void property="colList"> 
-                               <object class="java.util.ArrayList"> 
-                                <void method="add"> 
-                                 <object idref="exprNodeColumnDesc1"/> 
-                                </void> 
-                                <void method="add"> 
-                                 <object idref="exprNodeColumnDesc0"/> 
-                                </void> 
-                               </object> 
+                             <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
+                              <void property="destTableId"> 
+                               <int>1</int> 
                               </void> 
-                              <void property="outputColumnNames"> 
-                               <object class="java.util.ArrayList"> 
-                                <void method="add"> 
-                                 <string>_col0</string> 
-                                </void> 
-                                <void method="add"> 
-                                 <string>_col1</string> 
-                                </void> 
-                               </object> 
+                              <void property="dirName"> 
+                               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/47100551/10001</string> 
                               </void> 
-                              <void property="selectStar"> 
-                               <boolean>true</boolean> 
+                              <void property="tableInfo"> 
+                               <object idref="tableDesc2"/> 
                               </void> 
                              </object> 
                             </void> 
                             <void property="parentOperators"> 
                              <object class="java.util.ArrayList"> 
                               <void method="add"> 
-                               <object idref="SelectOperator0"/> 
+                               <object idref="SelectOperator1"/> 
                               </void> 
                              </object> 
                             </void> 
                             <void property="schema"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                              <void property="signature"> 
-                               <object class="java.util.Vector"> 
-                                <void method="add"> 
-                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                  <void property="internalName"> 
-                                   <string>_col0</string> 
-                                  </void> 
-                                  <void property="type"> 
-                                   <object idref="PrimitiveTypeInfo1"/> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void method="add"> 
-                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                  <void property="internalName"> 
-                                   <string>_col1</string> 
-                                  </void> 
-                                  <void property="type"> 
-                                   <object idref="PrimitiveTypeInfo1"/> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
+                             <object idref="RowSchema0"/> 
                             </void> 
                            </object> 
                           </void> 
@@ -587,9 +584,9 @@
                          <object class="java.util.HashMap"> 
                           <void method="put"> 
                            <string>_col1</string> 
-                           <object id="exprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                           <object id="exprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
                             <void property="column"> 
-                             <string>value</string> 
+                             <string>_col1</string> 
                             </void> 
                             <void property="typeInfo"> 
                              <object idref="PrimitiveTypeInfo1"/> 
@@ -598,9 +595,9 @@
                           </void> 
                           <void method="put"> 
                            <string>_col0</string> 
-                           <object id="exprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                           <object id="exprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
                             <void property="column"> 
-                             <string>key</string> 
+                             <string>_col0</string> 
                             </void> 
                             <void property="typeInfo"> 
                              <object idref="PrimitiveTypeInfo1"/> 
@@ -614,10 +611,10 @@
                           <void property="colList"> 
                            <object class="java.util.ArrayList"> 
                             <void method="add"> 
-                             <object idref="exprNodeColumnDesc3"/> 
+                             <object idref="exprNodeColumnDesc1"/> 
                             </void> 
                             <void method="add"> 
-                             <object idref="exprNodeColumnDesc2"/> 
+                             <object idref="exprNodeColumnDesc0"/> 
                             </void> 
                            </object> 
                           </void> 
@@ -639,7 +636,7 @@
                         <void property="parentOperators"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <object idref="FilterOperator1"/> 
+                           <object idref="SelectOperator0"/> 
                           </void> 
                          </object> 
                         </void> 
@@ -675,128 +672,74 @@
                       </void> 
                      </object> 
                     </void> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.filterDesc"> 
-                      <void property="predicate"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                        <void property="UDFClass"> 
-                         <class>org.apache.hadoop.hive.ql.udf.UDFOPLessThan</class> 
+                    <void property="columnExprMap"> 
+                     <object class="java.util.HashMap"> 
+                      <void method="put"> 
+                       <string>_col1</string> 
+                       <object id="exprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                        <void property="column"> 
+                         <string>value</string> 
                         </void> 
-                        <void property="UDFMethod"> 
-                         <object id="Method0" class="org.apache.hadoop.hive.ql.udf.UDFOPLessThan" method="getMethod"> 
-                          <string>evaluate</string> 
-                          <array class="java.lang.Class" length="2"> 
-                           <void index="0"> 
-                            <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
-                           </void> 
-                           <void index="1"> 
-                            <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
-                           </void> 
-                          </array> 
-                         </object> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                            <void property="UDFClass"> 
-                             <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
-                            </void> 
-                            <void property="UDFMethod"> 
-                             <object id="Method1" class="org.apache.hadoop.hive.ql.udf.UDFToDouble" method="getMethod"> 
-                              <string>evaluate</string> 
-                              <array class="java.lang.Class" length="1"> 
-                               <void index="0"> 
-                                <class>org.apache.hadoop.io.Text</class> 
-                               </void> 
-                              </array> 
-                             </object> 
-                            </void> 
-                            <void property="childExprs"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                                <void property="column"> 
-                                 <string>key</string> 
-                                </void> 
-                                <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo1"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                            <void property="UDFClass"> 
-                             <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
-                            </void> 
-                            <void property="UDFMethod"> 
-                             <object id="Method2" class="org.apache.hadoop.hive.ql.udf.UDFToDouble" method="getMethod"> 
-                              <string>evaluate</string> 
-                              <array class="java.lang.Class" length="1"> 
-                               <void index="0"> 
-                                <class>org.apache.hadoop.io.IntWritable</class> 
-                               </void> 
-                              </array> 
-                             </object> 
-                            </void> 
-                            <void property="childExprs"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
-                                <void property="typeInfo"> 
-                                 <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                                  <void property="typeName"> 
-                                   <string>int</string> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void property="value"> 
-                                 <int>100</int> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
+                       </object> 
+                      </void> 
+                      <void method="put"> 
+                       <string>_col0</string> 
+                       <object id="exprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                        <void property="column"> 
+                         <string>key</string> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object id="PrimitiveTypeInfo3" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                          <void property="typeName"> 
-                           <string>boolean</string> 
-                          </void> 
-                         </object> 
+                         <object idref="PrimitiveTypeInfo1"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="conf"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.selectDesc"> 
+                      <void property="colList"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <object idref="exprNodeColumnDesc3"/> 
+                        </void> 
+                        <void method="add"> 
+                         <object idref="exprNodeColumnDesc2"/> 
                         </void> 
                        </object> 
                       </void> 
+                      <void property="outputColumnNames"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <string>_col0</string> 
+                        </void> 
+                        <void method="add"> 
+                         <string>_col1</string> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="selectStar"> 
+                       <boolean>true</boolean> 
+                      </void> 
                      </object> 
                     </void> 
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object idref="FilterOperator0"/> 
+                       <object idref="FilterOperator1"/> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="schema"> 
                      <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
                       <void property="signature"> 
-                       <object id="Vector0" class="java.util.Vector"> 
+                       <object class="java.util.Vector"> 
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                           <void property="internalName"> 
-                           <string>key</string> 
+                           <string>_col0</string> 
                           </void> 
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo1"/> 
@@ -806,7 +749,7 @@
                         <void method="add"> 
                          <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                           <void property="internalName"> 
-                           <string>value</string> 
+                           <string>_col1</string> 
                           </void> 
                           <void property="type"> 
                            <object idref="PrimitiveTypeInfo1"/> 
@@ -829,7 +772,17 @@
                      <class>org.apache.hadoop.hive.ql.udf.UDFOPLessThan</class> 
                     </void> 
                     <void property="UDFMethod"> 
-                     <object idref="Method0"/> 
+                     <object id="Method0" class="org.apache.hadoop.hive.ql.udf.UDFOPLessThan" method="getMethod"> 
+                      <string>evaluate</string> 
+                      <array class="java.lang.Class" length="2"> 
+                       <void index="0"> 
+                        <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
+                       </void> 
+                       <void index="1"> 
+                        <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
+                       </void> 
+                      </array> 
+                     </object> 
                     </void> 
                     <void property="childExprs"> 
                      <object class="java.util.ArrayList"> 
@@ -839,7 +792,14 @@
                          <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
                         </void> 
                         <void property="UDFMethod"> 
-                         <object idref="Method1"/> 
+                         <object id="Method1" class="org.apache.hadoop.hive.ql.udf.UDFToDouble" method="getMethod"> 
+                          <string>evaluate</string> 
+                          <array class="java.lang.Class" length="1"> 
+                           <void index="0"> 
+                            <class>org.apache.hadoop.io.Text</class> 
+                           </void> 
+                          </array> 
+                         </object> 
                         </void> 
                         <void property="childExprs"> 
                          <object class="java.util.ArrayList"> 
@@ -866,14 +826,25 @@
                          <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
                         </void> 
                         <void property="UDFMethod"> 
-                         <object idref="Method2"/> 
+                         <object id="Method2" class="org.apache.hadoop.hive.ql.udf.UDFToDouble" method="getMethod"> 
+                          <string>evaluate</string> 
+                          <array class="java.lang.Class" length="1"> 
+                           <void index="0"> 
+                            <class>org.apache.hadoop.io.IntWritable</class> 
+                           </void> 
+                          </array> 
+                         </object> 
                         </void> 
                         <void property="childExprs"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
                            <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                             <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo2"/> 
+                             <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                              <void property="typeName"> 
+                               <string>int</string> 
+                              </void> 
+                             </object> 
                             </void> 
                             <void property="value"> 
                              <int>100</int> 
@@ -890,7 +861,11 @@
                      </object> 
                     </void> 
                     <void property="typeInfo"> 
-                     <object idref="PrimitiveTypeInfo3"/> 
+                     <object id="PrimitiveTypeInfo3" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                      <void property="typeName"> 
+                       <string>boolean</string> 
+                      </void> 
+                     </object> 
                     </void> 
                    </object> 
                   </void> 
@@ -899,14 +874,35 @@
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object idref="TableScanOperator1"/> 
+                   <object idref="FilterOperator0"/> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="schema"> 
                  <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
                   <void property="signature"> 
-                   <object idref="Vector0"/> 
+                   <object id="Vector0" class="java.util.Vector"> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="internalName"> 
+                       <string>key</string> 
+                      </void> 
+                      <void property="type"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="internalName"> 
+                       <string>value</string> 
+                      </void> 
+                      <void property="type"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                   </object> 
                   </void> 
                  </object> 
                 </void> 
@@ -914,238 +910,113 @@
               </void> 
              </object> 
             </void> 
-            <void property="neededColumnIDs"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <int>0</int> 
-              </void> 
-              <void method="add"> 
-               <int>1</int> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object idref="Vector0"/> 
-              </void> 
-             </object> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="mapCurrCtx"> 
-           <object class="java.util.LinkedHashMap"> 
-            <void method="put"> 
-             <object idref="TableScanOperator1"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-            <void method="put"> 
-             <object idref="FilterOperator0"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-            <void method="put"> 
-             <object idref="FilterOperator1"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-            <void method="put"> 
-             <object idref="SelectOperator0"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-            <void method="put"> 
-             <object idref="SelectOperator1"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="mvTask"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="MoveTask0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="opTaskMap"> 
-           <object class="java.util.HashMap"> 
-            <void method="put"> 
-             <null/> 
-             <object idref="MapRedTask0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="parseCtx"> 
-           <object class="org.apache.hadoop.hive.ql.parse.ParseContext"> 
-            <void property="QB"> 
-             <object class="org.apache.hadoop.hive.ql.parse.QB"/> 
-            </void> 
-            <void property="UCtx"> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.unionproc.UnionProcContext"/> 
-            </void> 
-            <void property="aliasToPruner"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>unioninput:src</string> 
-               <object class="org.apache.hadoop.hive.ql.parse.PartitionPruner"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="aliasToSamplePruner"> 
-             <object class="java.util.HashMap"/> 
-            </void> 
             <void property="conf"> 
-             <object idref="HiveConf0"/> 
-            </void> 
-            <void property="context"> 
-             <object class="org.apache.hadoop.hive.ql.Context"/> 
-            </void> 
-            <void property="destTableId"> 
-             <int>2</int> 
-            </void> 
-            <void property="idToTableNameMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>1</string> 
-               <string>../build/ql/test/data/warehouse/union.out</string> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="joinContext"> 
-             <object class="java.util.HashMap"/> 
-            </void> 
-            <void property="listMapJoinOpsNoReducer"> 
-             <object class="java.util.ArrayList"/> 
-            </void> 
-            <void property="loadFileWork"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="loadFileDesc0"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="loadTableWork"> 
-             <object class="java.util.ArrayList"/> 
-            </void> 
-            <void property="opParseCtx"> 
-             <object class="java.util.LinkedHashMap"> 
-              <void method="put"> 
-               <object idref="TableScanOperator1"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object id="RowResolver0" class="org.apache.hadoop.hive.ql.parse.RowResolver"/> 
+             <object class="org.apache.hadoop.hive.ql.plan.filterDesc"> 
+              <void property="predicate"> 
+               <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                <void property="UDFClass"> 
+                 <class>org.apache.hadoop.hive.ql.udf.UDFOPLessThan</class> 
                 </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="FilterOperator1"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object idref="RowResolver0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="SelectOperator0"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object class="org.apache.hadoop.hive.ql.parse.RowResolver"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="SelectOperator1"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object id="RowResolver1" class="org.apache.hadoop.hive.ql.parse.RowResolver"/> 
+                <void property="UDFMethod"> 
+                 <object idref="Method0"/> 
                 </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="FileSinkOperator0"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object idref="RowResolver1"/> 
+                <void property="childExprs"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                    <void property="UDFClass"> 
+                     <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
+                    </void> 
+                    <void property="UDFMethod"> 
+                     <object idref="Method1"/> 
+                    </void> 
+                    <void property="childExprs"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                        <void property="column"> 
+                         <string>key</string> 
+                        </void> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                    <void property="UDFClass"> 
+                     <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
+                    </void> 
+                    <void property="UDFMethod"> 
+                     <object idref="Method2"/> 
+                    </void> 
+                    <void property="childExprs"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo2"/> 
+                        </void> 
+                        <void property="value"> 
+                         <int>100</int> 
+                        </void> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
                 </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="FilterOperator0"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object idref="RowResolver0"/> 
+                <void property="typeInfo"> 
+                 <object idref="PrimitiveTypeInfo3"/> 
                 </void> 
                </object> 
               </void> 
              </object> 
             </void> 
-            <void property="parseTree"> 
-             <object class="org.apache.hadoop.hive.ql.parse.ASTNode"> 
-              <void property="tokenStartIndex"> 
-               <int>0</int> 
-              </void> 
-              <void property="tokenStopIndex"> 
-               <int>42</int> 
+            <void property="parentOperators"> 
+             <object class="java.util.ArrayList"> 
+              <void method="add"> 
+               <object idref="TableScanOperator1"/> 
               </void> 
              </object> 
             </void> 
-            <void property="topOps"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>unioninput:src</string> 
-               <object idref="TableScanOperator1"/> 
+            <void property="schema"> 
+             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+              <void property="signature"> 
+               <object idref="Vector0"/> 
               </void> 
              </object> 
             </void> 
-            <void property="topSelOps"> 
-             <object class="java.util.HashMap"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="rootOps"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="TableScanOperator1"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="rootTasks"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="MapRedTask0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="seenFileSinkOps"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="FileSinkOperator0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="seenOps"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="TableScanOperator1"/> 
-            </void> 
            </object> 
           </void> 
          </object> 
         </void> 
-        <void property="dir"> 
-         <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1141082271/10001</string> 
-        </void> 
-        <void property="listTasks"> 
-         <object idref="ArrayList0"/> 
-        </void> 
-       </object> 
-      </void> 
-      <void property="work"> 
-       <object class="org.apache.hadoop.hive.ql.plan.ConditionalWork"> 
-        <void property="listWorks"> 
+        <void property="neededColumnIDs"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <object idref="moveWork0"/> 
+           <int>0</int> 
           </void> 
           <void method="add"> 
-           <object idref="mapredWork0"/> 
+           <int>1</int> 
+          </void> 
+         </object> 
+        </void> 
+        <void property="schema"> 
+         <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+          <void property="signature"> 
+           <object idref="Vector0"/> 
           </void> 
          </object> 
         </void> 
@@ -1153,95 +1024,10 @@
       </void> 
      </object> 
     </void> 
-   </object> 
-  </void> 
-  <void property="id"> 
-   <string>Stage-2</string> 
-  </void> 
-  <void property="work"> 
-   <object class="org.apache.hadoop.hive.ql.plan.mapredWork"> 
-    <void property="aliasToPartnInfo"> 
-     <void method="put"> 
-      <string>unioninput:src</string> 
-      <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
-       <void property="partSpec"> 
-        <object id="LinkedHashMap0" class="java.util.LinkedHashMap"/> 
-       </void> 
-       <void property="tableDesc"> 
-        <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
-         <void property="deserializerClass"> 
-          <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
-         </void> 
-         <void property="inputFileFormatClass"> 
-          <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-         </void> 
-         <void property="outputFileFormatClass"> 
-          <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-         </void> 
-         <void property="properties"> 
-          <object id="Properties0" class="java.util.Properties"> 
-           <void method="put"> 
-            <string>name</string> 
-            <string>src</string> 
-           </void> 
-           <void method="put"> 
-            <string>columns.types</string> 
-            <string>string:string</string> 
-           </void> 
-           <void method="put"> 
-            <string>serialization.ddl</string> 
-            <string>struct src { string key, string value}</string> 
-           </void> 
-           <void method="put"> 
-            <string>serialization.format</string> 
-            <string>1</string> 
-           </void> 
-           <void method="put"> 
-            <string>columns</string> 
-            <string>key,value</string> 
-           </void> 
-           <void method="put"> 
-            <string>bucket_count</string> 
-            <string>-1</string> 
-           </void> 
-           <void method="put"> 
-            <string>serialization.lib</string> 
-            <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-           </void> 
-           <void method="put"> 
-            <string>file.inputformat</string> 
-            <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-           </void> 
-           <void method="put"> 
-            <string>file.outputformat</string> 
-            <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-           </void> 
-           <void method="put"> 
-            <string>location</string> 
-            <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/src</string> 
-           </void> 
-          </object> 
-         </void> 
-         <void property="serdeClassName"> 
-          <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-         </void> 
-        </object> 
-       </void> 
-      </object> 
-     </void> 
-    </void> 
-    <void property="aliasToWork"> 
-     <object class="java.util.LinkedHashMap"> 
-      <void method="put"> 
-       <string>unioninput:src</string> 
-       <object idref="TableScanOperator1"/> 
-      </void> 
-     </object> 
-    </void> 
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/src</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>unioninput:src</string> 
@@ -1253,7 +1039,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/src</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
diff --git a/ql/src/test/results/compiler/plan/union.q.xml b/ql/src/test/results/compiler/plan/union.q.xml
index f6955476a2..fb8e70a4cb 100644
--- a/ql/src/test/results/compiler/plan/union.q.xml
+++ b/ql/src/test/results/compiler/plan/union.q.xml
@@ -8,7 +8,7 @@
       <void property="childTasks"> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
-         <object id="MoveTask0" class="org.apache.hadoop.hive.ql.exec.MoveTask"> 
+         <object class="org.apache.hadoop.hive.ql.exec.MoveTask"> 
           <void property="id"> 
            <string>Stage-1</string> 
           </void> 
@@ -22,7 +22,7 @@
           <void property="work"> 
            <object class="org.apache.hadoop.hive.ql.plan.moveWork"> 
             <void property="loadFileWork"> 
-             <object id="loadFileDesc0" class="org.apache.hadoop.hive.ql.plan.loadFileDesc"> 
+             <object class="org.apache.hadoop.hive.ql.plan.loadFileDesc"> 
               <void property="columnTypes"> 
                <string>string:string</string> 
               </void> 
@@ -33,7 +33,7 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1417788791/10000</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1148004648/10000</string> 
               </void> 
               <void property="targetDir"> 
                <string>../build/ql/test/data/warehouse/union.out</string> 
@@ -64,10 +64,10 @@
                <boolean>true</boolean> 
               </void> 
               <void property="sourceDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/350041570/10001</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/898800323/10001</string> 
               </void> 
               <void property="targetDir"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1417788791/10000</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1148004648/10000</string> 
               </void> 
              </object> 
             </void> 
@@ -85,7 +85,7 @@
             <void property="aliasToWork"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/350041570/10001</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/898800323/10001</string> 
                <object id="TableScanOperator0" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
@@ -281,10 +281,10 @@
             <void property="pathToAliases"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/350041570/10001</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/898800323/10001</string> 
                <object class="java.util.ArrayList"> 
                 <void method="add"> 
-                 <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/350041570/10001</string> 
+                 <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/898800323/10001</string> 
                 </void> 
                </object> 
               </void> 
@@ -293,7 +293,7 @@
             <void property="pathToPartitionInfo"> 
              <object class="java.util.LinkedHashMap"> 
               <void method="put"> 
-               <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/350041570/10001</string> 
+               <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/898800323/10001</string> 
                <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
                 <void property="tableDesc"> 
                  <object id="tableDesc2" class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
@@ -337,7 +337,7 @@
                   <void property="conf"> 
                    <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                     <void property="dirName"> 
-                     <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/1417788791/10000</string> 
+                     <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/1148004648/10000</string> 
                     </void> 
                     <void property="tableInfo"> 
                      <object idref="tableDesc2"/> 
@@ -427,245 +427,506 @@
       </void> 
       <void property="resolverCtx"> 
        <object class="org.apache.hadoop.hive.ql.plan.ConditionalResolverMergeFiles$ConditionalResolverMergeFilesCtx"> 
-        <void property="ctx"> 
-         <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext"> 
-          <void property="conf"> 
-           <object id="HiveConf0" class="org.apache.hadoop.hive.conf.HiveConf"> 
-            <void property="auxJars"> 
-             <string>file:///data/users/njain/hive3/hive3/build/ql/test/test-udfs.jar</string> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="currAliasId"> 
-           <string>null-subquery2:unioninput-subquery2:src</string> 
+        <void property="dir"> 
+         <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/898800323/10001</string> 
+        </void> 
+        <void property="listTasks"> 
+         <object idref="ArrayList0"/> 
+        </void> 
+       </object> 
+      </void> 
+      <void property="work"> 
+       <object class="org.apache.hadoop.hive.ql.plan.ConditionalWork"> 
+        <void property="listWorks"> 
+         <object class="java.util.ArrayList"> 
+          <void method="add"> 
+           <object idref="moveWork0"/> 
           </void> 
-          <void property="currTask"> 
-           <object class="org.apache.hadoop.hive.ql.exec.MapRedTask"> 
-            <void property="id"> 
-             <string>Stage-6</string> 
-            </void> 
-            <void property="work"> 
-             <object class="org.apache.hadoop.hive.ql.plan.mapredWork"> 
-              <void property="aliasToWork"> 
-               <object class="java.util.LinkedHashMap"/> 
-              </void> 
-              <void property="pathToAliases"> 
-               <object class="java.util.LinkedHashMap"/> 
-              </void> 
-              <void property="pathToPartitionInfo"> 
-               <object class="java.util.LinkedHashMap"/> 
-              </void> 
-              <void property="tagToValueDesc"> 
-               <object class="java.util.ArrayList"/> 
-              </void> 
-             </object> 
-            </void> 
-           </object> 
+          <void method="add"> 
+           <object idref="mapredWork0"/> 
           </void> 
-          <void property="currTopOp"> 
-           <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
+         </object> 
+        </void> 
+       </object> 
+      </void> 
+     </object> 
+    </void> 
+   </object> 
+  </void> 
+  <void property="id"> 
+   <string>Stage-2</string> 
+  </void> 
+  <void property="work"> 
+   <object class="org.apache.hadoop.hive.ql.plan.mapredWork"> 
+    <void property="aliasToPartnInfo"> 
+     <void method="put"> 
+      <string>null-subquery1:unioninput-subquery1:src</string> 
+      <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
+       <void property="partSpec"> 
+        <object class="java.util.LinkedHashMap"/> 
+       </void> 
+       <void property="tableDesc"> 
+        <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
+         <void property="deserializerClass"> 
+          <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
+         </void> 
+         <void property="inputFileFormatClass"> 
+          <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+         </void> 
+         <void property="outputFileFormatClass"> 
+          <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+         </void> 
+         <void property="properties"> 
+          <object class="java.util.Properties"> 
+           <void method="put"> 
+            <string>name</string> 
+            <string>src</string> 
+           </void> 
+           <void method="put"> 
+            <string>columns.types</string> 
+            <string>string:string</string> 
+           </void> 
+           <void method="put"> 
+            <string>serialization.ddl</string> 
+            <string>struct src { string key, string value}</string> 
+           </void> 
+           <void method="put"> 
+            <string>serialization.format</string> 
+            <string>1</string> 
+           </void> 
+           <void method="put"> 
+            <string>columns</string> 
+            <string>key,value</string> 
+           </void> 
+           <void method="put"> 
+            <string>bucket_count</string> 
+            <string>-1</string> 
+           </void> 
+           <void method="put"> 
+            <string>serialization.lib</string> 
+            <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+           </void> 
+           <void method="put"> 
+            <string>file.inputformat</string> 
+            <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+           </void> 
+           <void method="put"> 
+            <string>file.outputformat</string> 
+            <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+           </void> 
+           <void method="put"> 
+            <string>location</string> 
+            <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/src</string> 
+           </void> 
+          </object> 
+         </void> 
+         <void property="serdeClassName"> 
+          <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+         </void> 
+        </object> 
+       </void> 
+      </object> 
+     </void> 
+     <void method="put"> 
+      <string>null-subquery2:unioninput-subquery2:src</string> 
+      <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
+       <void property="partSpec"> 
+        <object id="LinkedHashMap0" class="java.util.LinkedHashMap"/> 
+       </void> 
+       <void property="tableDesc"> 
+        <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
+         <void property="deserializerClass"> 
+          <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
+         </void> 
+         <void property="inputFileFormatClass"> 
+          <class>org.apache.hadoop.mapred.TextInputFormat</class> 
+         </void> 
+         <void property="outputFileFormatClass"> 
+          <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
+         </void> 
+         <void property="properties"> 
+          <object id="Properties0" class="java.util.Properties"> 
+           <void method="put"> 
+            <string>name</string> 
+            <string>src</string> 
+           </void> 
+           <void method="put"> 
+            <string>columns.types</string> 
+            <string>string:string</string> 
+           </void> 
+           <void method="put"> 
+            <string>serialization.ddl</string> 
+            <string>struct src { string key, string value}</string> 
+           </void> 
+           <void method="put"> 
+            <string>serialization.format</string> 
+            <string>1</string> 
+           </void> 
+           <void method="put"> 
+            <string>columns</string> 
+            <string>key,value</string> 
+           </void> 
+           <void method="put"> 
+            <string>bucket_count</string> 
+            <string>-1</string> 
+           </void> 
+           <void method="put"> 
+            <string>serialization.lib</string> 
+            <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+           </void> 
+           <void method="put"> 
+            <string>file.inputformat</string> 
+            <string>org.apache.hadoop.mapred.TextInputFormat</string> 
+           </void> 
+           <void method="put"> 
+            <string>file.outputformat</string> 
+            <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
+           </void> 
+           <void method="put"> 
+            <string>location</string> 
+            <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/src</string> 
+           </void> 
+          </object> 
+         </void> 
+         <void property="serdeClassName"> 
+          <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
+         </void> 
+        </object> 
+       </void> 
+      </object> 
+     </void> 
+    </void> 
+    <void property="aliasToWork"> 
+     <object class="java.util.LinkedHashMap"> 
+      <void method="put"> 
+       <string>null-subquery1:unioninput-subquery1:src</string> 
+       <object id="TableScanOperator1" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
+        <void property="childOperators"> 
+         <object class="java.util.ArrayList"> 
+          <void method="add"> 
+           <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
             <void property="childOperators"> 
              <object class="java.util.ArrayList"> 
               <void method="add"> 
-               <object id="FilterOperator0" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+               <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
                 <void property="childOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object id="FilterOperator1" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+                   <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
                     <void property="childOperators"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object id="SelectOperator0" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+                       <object id="UnionOperator0" class="org.apache.hadoop.hive.ql.exec.UnionOperator"> 
                         <void property="childOperators"> 
                          <object class="java.util.ArrayList"> 
                           <void method="add"> 
-                           <object id="UnionOperator0" class="org.apache.hadoop.hive.ql.exec.UnionOperator"> 
+                           <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
                             <void property="childOperators"> 
                              <object class="java.util.ArrayList"> 
                               <void method="add"> 
-                               <object id="SelectOperator1" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                                <void property="childOperators"> 
-                                 <object class="java.util.ArrayList"> 
-                                  <void method="add"> 
-                                   <object id="FileSinkOperator0" class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
-                                    <void property="conf"> 
-                                     <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
-                                      <void property="destTableId"> 
-                                       <int>1</int> 
-                                      </void> 
-                                      <void property="dirName"> 
-                                       <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/350041570/10001</string> 
-                                      </void> 
-                                      <void property="tableInfo"> 
-                                       <object idref="tableDesc2"/> 
-                                      </void> 
-                                     </object> 
-                                    </void> 
-                                    <void property="parentOperators"> 
-                                     <object class="java.util.ArrayList"> 
-                                      <void method="add"> 
-                                       <object idref="SelectOperator1"/> 
-                                      </void> 
-                                     </object> 
-                                    </void> 
-                                    <void property="schema"> 
-                                     <object idref="RowSchema0"/> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                 </object> 
-                                </void> 
-                                <void property="columnExprMap"> 
-                                 <object class="java.util.HashMap"> 
-                                  <void method="put"> 
-                                   <string>_col1</string> 
-                                   <object id="exprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                                    <void property="column"> 
-                                     <string>_col1</string> 
-                                    </void> 
-                                    <void property="typeInfo"> 
-                                     <object idref="PrimitiveTypeInfo1"/> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>_col0</string> 
-                                   <object id="exprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                                    <void property="column"> 
-                                     <string>_col0</string> 
-                                    </void> 
-                                    <void property="typeInfo"> 
-                                     <object idref="PrimitiveTypeInfo1"/> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                 </object> 
-                                </void> 
+                               <object class="org.apache.hadoop.hive.ql.exec.FileSinkOperator"> 
                                 <void property="conf"> 
-                                 <object class="org.apache.hadoop.hive.ql.plan.selectDesc"> 
-                                  <void property="colList"> 
-                                   <object class="java.util.ArrayList"> 
-                                    <void method="add"> 
-                                     <object idref="exprNodeColumnDesc1"/> 
-                                    </void> 
-                                    <void method="add"> 
-                                     <object idref="exprNodeColumnDesc0"/> 
-                                    </void> 
-                                   </object> 
+                                 <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
+                                  <void property="destTableId"> 
+                                   <int>1</int> 
                                   </void> 
-                                  <void property="outputColumnNames"> 
-                                   <object class="java.util.ArrayList"> 
-                                    <void method="add"> 
-                                     <string>_col0</string> 
-                                    </void> 
-                                    <void method="add"> 
-                                     <string>_col1</string> 
-                                    </void> 
-                                   </object> 
+                                  <void property="dirName"> 
+                                   <string>file:/data/users/njain/hive5/hive5/build/ql/tmp/898800323/10001</string> 
                                   </void> 
-                                  <void property="selectStar"> 
-                                   <boolean>true</boolean> 
+                                  <void property="tableInfo"> 
+                                   <object idref="tableDesc2"/> 
                                   </void> 
                                  </object> 
                                 </void> 
                                 <void property="parentOperators"> 
                                  <object class="java.util.ArrayList"> 
                                   <void method="add"> 
-                                   <object idref="UnionOperator0"/> 
+                                   <object idref="SelectOperator1"/> 
                                   </void> 
                                  </object> 
                                 </void> 
                                 <void property="schema"> 
-                                 <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                                  <void property="signature"> 
-                                   <object class="java.util.Vector"> 
-                                    <void method="add"> 
-                                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                      <void property="internalName"> 
-                                       <string>_col0</string> 
-                                      </void> 
-                                      <void property="type"> 
-                                       <object idref="PrimitiveTypeInfo1"/> 
-                                      </void> 
-                                     </object> 
-                                    </void> 
-                                    <void method="add"> 
-                                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                      <void property="internalName"> 
-                                       <string>_col1</string> 
-                                      </void> 
-                                      <void property="type"> 
-                                       <object idref="PrimitiveTypeInfo1"/> 
-                                      </void> 
-                                     </object> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                 </object> 
+                                 <object idref="RowSchema0"/> 
                                 </void> 
                                </object> 
                               </void> 
                              </object> 
                             </void> 
-                            <void property="conf"> 
-                             <object class="org.apache.hadoop.hive.ql.plan.unionDesc"/> 
-                            </void> 
-                            <void property="parentOperators"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object id="SelectOperator2" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
-                                <void property="childOperators"> 
-                                 <object class="java.util.ArrayList"> 
-                                  <void method="add"> 
-                                   <object idref="UnionOperator0"/> 
-                                  </void> 
-                                 </object> 
+                            <void property="columnExprMap"> 
+                             <object class="java.util.HashMap"> 
+                              <void method="put"> 
+                               <string>_col1</string> 
+                               <object id="exprNodeColumnDesc0" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                                <void property="column"> 
+                                 <string>_col1</string> 
                                 </void> 
-                                <void property="columnExprMap"> 
-                                 <object class="java.util.HashMap"> 
-                                  <void method="put"> 
-                                   <string>_col1</string> 
-                                   <object id="exprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                                    <void property="column"> 
-                                     <string>value</string> 
-                                    </void> 
-                                    <void property="typeInfo"> 
-                                     <object idref="PrimitiveTypeInfo1"/> 
-                                    </void> 
-                                   </object> 
-                                  </void> 
-                                  <void method="put"> 
-                                   <string>_col0</string> 
-                                   <object id="exprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                                    <void property="column"> 
-                                     <string>key</string> 
-                                    </void> 
-                                    <void property="typeInfo"> 
-                                     <object idref="PrimitiveTypeInfo1"/> 
-                                    </void> 
-                                   </object> 
+                                <void property="typeInfo"> 
+                                 <object idref="PrimitiveTypeInfo1"/> 
+                                </void> 
+                               </object> 
+                              </void> 
+                              <void method="put"> 
+                               <string>_col0</string> 
+                               <object id="exprNodeColumnDesc1" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                                <void property="column"> 
+                                 <string>_col0</string> 
+                                </void> 
+                                <void property="typeInfo"> 
+                                 <object idref="PrimitiveTypeInfo1"/> 
+                                </void> 
+                               </object> 
+                              </void> 
+                             </object> 
+                            </void> 
+                            <void property="conf"> 
+                             <object class="org.apache.hadoop.hive.ql.plan.selectDesc"> 
+                              <void property="colList"> 
+                               <object class="java.util.ArrayList"> 
+                                <void method="add"> 
+                                 <object idref="exprNodeColumnDesc1"/> 
+                                </void> 
+                                <void method="add"> 
+                                 <object idref="exprNodeColumnDesc0"/> 
+                                </void> 
+                               </object> 
+                              </void> 
+                              <void property="outputColumnNames"> 
+                               <object class="java.util.ArrayList"> 
+                                <void method="add"> 
+                                 <string>_col0</string> 
+                                </void> 
+                                <void method="add"> 
+                                 <string>_col1</string> 
+                                </void> 
+                               </object> 
+                              </void> 
+                              <void property="selectStar"> 
+                               <boolean>true</boolean> 
+                              </void> 
+                             </object> 
+                            </void> 
+                            <void property="parentOperators"> 
+                             <object class="java.util.ArrayList"> 
+                              <void method="add"> 
+                               <object idref="UnionOperator0"/> 
+                              </void> 
+                             </object> 
+                            </void> 
+                            <void property="schema"> 
+                             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                              <void property="signature"> 
+                               <object class="java.util.Vector"> 
+                                <void method="add"> 
+                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                  <void property="internalName"> 
+                                   <string>_col0</string> 
+                                  </void> 
+                                  <void property="type"> 
+                                   <object idref="PrimitiveTypeInfo1"/> 
+                                  </void> 
+                                 </object> 
+                                </void> 
+                                <void method="add"> 
+                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                  <void property="internalName"> 
+                                   <string>_col1</string> 
+                                  </void> 
+                                  <void property="type"> 
+                                   <object idref="PrimitiveTypeInfo1"/> 
+                                  </void> 
+                                 </object> 
+                                </void> 
+                               </object> 
+                              </void> 
+                             </object> 
+                            </void> 
+                           </object> 
+                          </void> 
+                         </object> 
+                        </void> 
+                        <void property="conf"> 
+                         <object class="org.apache.hadoop.hive.ql.plan.unionDesc"/> 
+                        </void> 
+                        <void property="parentOperators"> 
+                         <object class="java.util.ArrayList"> 
+                          <void method="add"> 
+                           <object idref="SelectOperator0"/> 
+                          </void> 
+                          <void method="add"> 
+                           <object id="SelectOperator2" class="org.apache.hadoop.hive.ql.exec.SelectOperator"> 
+                            <void property="childOperators"> 
+                             <object class="java.util.ArrayList"> 
+                              <void method="add"> 
+                               <object idref="UnionOperator0"/> 
+                              </void> 
+                             </object> 
+                            </void> 
+                            <void property="columnExprMap"> 
+                             <object class="java.util.HashMap"> 
+                              <void method="put"> 
+                               <string>_col1</string> 
+                               <object id="exprNodeColumnDesc2" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                                <void property="column"> 
+                                 <string>value</string> 
+                                </void> 
+                                <void property="typeInfo"> 
+                                 <object idref="PrimitiveTypeInfo1"/> 
+                                </void> 
+                               </object> 
+                              </void> 
+                              <void method="put"> 
+                               <string>_col0</string> 
+                               <object id="exprNodeColumnDesc3" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                                <void property="column"> 
+                                 <string>key</string> 
+                                </void> 
+                                <void property="typeInfo"> 
+                                 <object idref="PrimitiveTypeInfo1"/> 
+                                </void> 
+                               </object> 
+                              </void> 
+                             </object> 
+                            </void> 
+                            <void property="conf"> 
+                             <object class="org.apache.hadoop.hive.ql.plan.selectDesc"> 
+                              <void property="colList"> 
+                               <object class="java.util.ArrayList"> 
+                                <void method="add"> 
+                                 <object idref="exprNodeColumnDesc3"/> 
+                                </void> 
+                                <void method="add"> 
+                                 <object idref="exprNodeColumnDesc2"/> 
+                                </void> 
+                               </object> 
+                              </void> 
+                              <void property="outputColumnNames"> 
+                               <object class="java.util.ArrayList"> 
+                                <void method="add"> 
+                                 <string>_col0</string> 
+                                </void> 
+                                <void method="add"> 
+                                 <string>_col1</string> 
+                                </void> 
+                               </object> 
+                              </void> 
+                              <void property="selectStar"> 
+                               <boolean>true</boolean> 
+                              </void> 
+                             </object> 
+                            </void> 
+                            <void property="parentOperators"> 
+                             <object class="java.util.ArrayList"> 
+                              <void method="add"> 
+                               <object id="FilterOperator2" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+                                <void property="childOperators"> 
+                                 <object class="java.util.ArrayList"> 
+                                  <void method="add"> 
+                                   <object idref="SelectOperator2"/> 
                                   </void> 
                                  </object> 
                                 </void> 
                                 <void property="conf"> 
-                                 <object class="org.apache.hadoop.hive.ql.plan.selectDesc"> 
-                                  <void property="colList"> 
-                                   <object class="java.util.ArrayList"> 
-                                    <void method="add"> 
-                                     <object idref="exprNodeColumnDesc3"/> 
+                                 <object class="org.apache.hadoop.hive.ql.plan.filterDesc"> 
+                                  <void property="predicate"> 
+                                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                                    <void property="UDFClass"> 
+                                     <class>org.apache.hadoop.hive.ql.udf.UDFOPGreaterThan</class> 
                                     </void> 
-                                    <void method="add"> 
-                                     <object idref="exprNodeColumnDesc2"/> 
+                                    <void property="UDFMethod"> 
+                                     <object id="Method0" class="org.apache.hadoop.hive.ql.udf.UDFOPGreaterThan" method="getMethod"> 
+                                      <string>evaluate</string> 
+                                      <array class="java.lang.Class" length="2"> 
+                                       <void index="0"> 
+                                        <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
+                                       </void> 
+                                       <void index="1"> 
+                                        <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
+                                       </void> 
+                                      </array> 
+                                     </object> 
                                     </void> 
-                                   </object> 
-                                  </void> 
-                                  <void property="outputColumnNames"> 
-                                   <object class="java.util.ArrayList"> 
-                                    <void method="add"> 
-                                     <string>_col0</string> 
+                                    <void property="childExprs"> 
+                                     <object class="java.util.ArrayList"> 
+                                      <void method="add"> 
+                                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                                        <void property="UDFClass"> 
+                                         <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
+                                        </void> 
+                                        <void property="UDFMethod"> 
+                                         <object id="Method1" class="org.apache.hadoop.hive.ql.udf.UDFToDouble" method="getMethod"> 
+                                          <string>evaluate</string> 
+                                          <array class="java.lang.Class" length="1"> 
+                                           <void index="0"> 
+                                            <class>org.apache.hadoop.io.Text</class> 
+                                           </void> 
+                                          </array> 
+                                         </object> 
+                                        </void> 
+                                        <void property="childExprs"> 
+                                         <object class="java.util.ArrayList"> 
+                                          <void method="add"> 
+                                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                                            <void property="column"> 
+                                             <string>key</string> 
+                                            </void> 
+                                            <void property="typeInfo"> 
+                                             <object idref="PrimitiveTypeInfo1"/> 
+                                            </void> 
+                                           </object> 
+                                          </void> 
+                                         </object> 
+                                        </void> 
+                                        <void property="typeInfo"> 
+                                         <object idref="PrimitiveTypeInfo0"/> 
+                                        </void> 
+                                       </object> 
+                                      </void> 
+                                      <void method="add"> 
+                                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                                        <void property="UDFClass"> 
+                                         <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
+                                        </void> 
+                                        <void property="UDFMethod"> 
+                                         <object id="Method2" class="org.apache.hadoop.hive.ql.udf.UDFToDouble" method="getMethod"> 
+                                          <string>evaluate</string> 
+                                          <array class="java.lang.Class" length="1"> 
+                                           <void index="0"> 
+                                            <class>org.apache.hadoop.io.IntWritable</class> 
+                                           </void> 
+                                          </array> 
+                                         </object> 
+                                        </void> 
+                                        <void property="childExprs"> 
+                                         <object class="java.util.ArrayList"> 
+                                          <void method="add"> 
+                                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
+                                            <void property="typeInfo"> 
+                                             <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                                              <void property="typeName"> 
+                                               <string>int</string> 
+                                              </void> 
+                                             </object> 
+                                            </void> 
+                                            <void property="value"> 
+                                             <int>100</int> 
+                                            </void> 
+                                           </object> 
+                                          </void> 
+                                         </object> 
+                                        </void> 
+                                        <void property="typeInfo"> 
+                                         <object idref="PrimitiveTypeInfo0"/> 
+                                        </void> 
+                                       </object> 
+                                      </void> 
+                                     </object> 
                                     </void> 
-                                    <void method="add"> 
-                                     <string>_col1</string> 
+                                    <void property="typeInfo"> 
+                                     <object id="PrimitiveTypeInfo3" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
+                                      <void property="typeName"> 
+                                       <string>boolean</string> 
+                                      </void> 
+                                     </object> 
                                     </void> 
                                    </object> 
                                   </void> 
@@ -674,11 +935,11 @@
                                 <void property="parentOperators"> 
                                  <object class="java.util.ArrayList"> 
                                   <void method="add"> 
-                                   <object id="FilterOperator2" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+                                   <object id="FilterOperator3" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
                                     <void property="childOperators"> 
                                      <object class="java.util.ArrayList"> 
                                       <void method="add"> 
-                                       <object idref="SelectOperator2"/> 
+                                       <object idref="FilterOperator2"/> 
                                       </void> 
                                      </object> 
                                     </void> 
@@ -687,20 +948,10 @@
                                       <void property="predicate"> 
                                        <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
                                         <void property="UDFClass"> 
-                                         <class>org.apache.hadoop.hive.ql.udf.UDFOPLessThan</class> 
+                                         <class>org.apache.hadoop.hive.ql.udf.UDFOPGreaterThan</class> 
                                         </void> 
                                         <void property="UDFMethod"> 
-                                         <object id="Method0" class="org.apache.hadoop.hive.ql.udf.UDFOPLessThan" method="getMethod"> 
-                                          <string>evaluate</string> 
-                                          <array class="java.lang.Class" length="2"> 
-                                           <void index="0"> 
-                                            <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
-                                           </void> 
-                                           <void index="1"> 
-                                            <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
-                                           </void> 
-                                          </array> 
-                                         </object> 
+                                         <object idref="Method0"/> 
                                         </void> 
                                         <void property="childExprs"> 
                                          <object class="java.util.ArrayList"> 
@@ -710,14 +961,7 @@
                                              <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
                                             </void> 
                                             <void property="UDFMethod"> 
-                                             <object id="Method1" class="org.apache.hadoop.hive.ql.udf.UDFToDouble" method="getMethod"> 
-                                              <string>evaluate</string> 
-                                              <array class="java.lang.Class" length="1"> 
-                                               <void index="0"> 
-                                                <class>org.apache.hadoop.io.Text</class> 
-                                               </void> 
-                                              </array> 
-                                             </object> 
+                                             <object idref="Method1"/> 
                                             </void> 
                                             <void property="childExprs"> 
                                              <object class="java.util.ArrayList"> 
@@ -744,25 +988,14 @@
                                              <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
                                             </void> 
                                             <void property="UDFMethod"> 
-                                             <object id="Method2" class="org.apache.hadoop.hive.ql.udf.UDFToDouble" method="getMethod"> 
-                                              <string>evaluate</string> 
-                                              <array class="java.lang.Class" length="1"> 
-                                               <void index="0"> 
-                                                <class>org.apache.hadoop.io.IntWritable</class> 
-                                               </void> 
-                                              </array> 
-                                             </object> 
+                                             <object idref="Method2"/> 
                                             </void> 
                                             <void property="childExprs"> 
                                              <object class="java.util.ArrayList"> 
                                               <void method="add"> 
                                                <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
                                                 <void property="typeInfo"> 
-                                                 <object id="PrimitiveTypeInfo2" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                                                  <void property="typeName"> 
-                                                   <string>int</string> 
-                                                  </void> 
-                                                 </object> 
+                                                 <object idref="PrimitiveTypeInfo2"/> 
                                                 </void> 
                                                 <void property="value"> 
                                                  <int>100</int> 
@@ -779,11 +1012,7 @@
                                          </object> 
                                         </void> 
                                         <void property="typeInfo"> 
-                                         <object id="PrimitiveTypeInfo3" class="org.apache.hadoop.hive.serde2.typeinfo.PrimitiveTypeInfo"> 
-                                          <void property="typeName"> 
-                                           <string>boolean</string> 
-                                          </void> 
-                                         </object> 
+                                         <object idref="PrimitiveTypeInfo3"/> 
                                         </void> 
                                        </object> 
                                       </void> 
@@ -792,135 +1021,45 @@
                                     <void property="parentOperators"> 
                                      <object class="java.util.ArrayList"> 
                                       <void method="add"> 
-                                       <object id="FilterOperator3" class="org.apache.hadoop.hive.ql.exec.FilterOperator"> 
+                                       <object id="TableScanOperator2" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
                                         <void property="childOperators"> 
                                          <object class="java.util.ArrayList"> 
                                           <void method="add"> 
-                                           <object idref="FilterOperator2"/> 
+                                           <object idref="FilterOperator3"/> 
                                           </void> 
                                          </object> 
                                         </void> 
-                                        <void property="conf"> 
-                                         <object class="org.apache.hadoop.hive.ql.plan.filterDesc"> 
-                                          <void property="predicate"> 
-                                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                                            <void property="UDFClass"> 
-                                             <class>org.apache.hadoop.hive.ql.udf.UDFOPLessThan</class> 
-                                            </void> 
-                                            <void property="UDFMethod"> 
-                                             <object idref="Method0"/> 
-                                            </void> 
-                                            <void property="childExprs"> 
-                                             <object class="java.util.ArrayList"> 
-                                              <void method="add"> 
-                                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                                                <void property="UDFClass"> 
-                                                 <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
-                                                </void> 
-                                                <void property="UDFMethod"> 
-                                                 <object idref="Method1"/> 
-                                                </void> 
-                                                <void property="childExprs"> 
-                                                 <object class="java.util.ArrayList"> 
-                                                  <void method="add"> 
-                                                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                                                    <void property="column"> 
-                                                     <string>key</string> 
-                                                    </void> 
-                                                    <void property="typeInfo"> 
-                                                     <object idref="PrimitiveTypeInfo1"/> 
-                                                    </void> 
-                                                   </object> 
-                                                  </void> 
-                                                 </object> 
-                                                </void> 
-                                                <void property="typeInfo"> 
-                                                 <object idref="PrimitiveTypeInfo0"/> 
-                                                </void> 
-                                               </object> 
-                                              </void> 
-                                              <void method="add"> 
-                                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                                                <void property="UDFClass"> 
-                                                 <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
-                                                </void> 
-                                                <void property="UDFMethod"> 
-                                                 <object idref="Method2"/> 
-                                                </void> 
-                                                <void property="childExprs"> 
-                                                 <object class="java.util.ArrayList"> 
-                                                  <void method="add"> 
-                                                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
-                                                    <void property="typeInfo"> 
-                                                     <object idref="PrimitiveTypeInfo2"/> 
-                                                    </void> 
-                                                    <void property="value"> 
-                                                     <int>100</int> 
-                                                    </void> 
-                                                   </object> 
-                                                  </void> 
-                                                 </object> 
-                                                </void> 
-                                                <void property="typeInfo"> 
-                                                 <object idref="PrimitiveTypeInfo0"/> 
-                                                </void> 
-                                               </object> 
-                                              </void> 
-                                             </object> 
-                                            </void> 
-                                            <void property="typeInfo"> 
-                                             <object idref="PrimitiveTypeInfo3"/> 
-                                            </void> 
-                                           </object> 
+                                        <void property="neededColumnIDs"> 
+                                         <object class="java.util.ArrayList"> 
+                                          <void method="add"> 
+                                           <int>0</int> 
+                                          </void> 
+                                          <void method="add"> 
+                                           <int>1</int> 
                                           </void> 
                                          </object> 
                                         </void> 
-                                        <void property="parentOperators"> 
-                                         <object class="java.util.ArrayList"> 
-                                          <void method="add"> 
-                                           <object id="TableScanOperator2" class="org.apache.hadoop.hive.ql.exec.TableScanOperator"> 
-                                            <void property="childOperators"> 
-                                             <object class="java.util.ArrayList"> 
-                                              <void method="add"> 
-                                               <object idref="FilterOperator3"/> 
-                                              </void> 
-                                             </object> 
-                                            </void> 
-                                            <void property="neededColumnIDs"> 
-                                             <object class="java.util.ArrayList"> 
-                                              <void method="add"> 
-                                               <int>0</int> 
+                                        <void property="schema"> 
+                                         <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+                                          <void property="signature"> 
+                                           <object id="Vector0" class="java.util.Vector"> 
+                                            <void method="add"> 
+                                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                              <void property="internalName"> 
+                                               <string>key</string> 
                                               </void> 
-                                              <void method="add"> 
-                                               <int>1</int> 
+                                              <void property="type"> 
+                                               <object idref="PrimitiveTypeInfo1"/> 
                                               </void> 
                                              </object> 
                                             </void> 
-                                            <void property="schema"> 
-                                             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                                              <void property="signature"> 
-                                               <object id="Vector0" class="java.util.Vector"> 
-                                                <void method="add"> 
-                                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                                  <void property="internalName"> 
-                                                   <string>key</string> 
-                                                  </void> 
-                                                  <void property="type"> 
-                                                   <object idref="PrimitiveTypeInfo1"/> 
-                                                  </void> 
-                                                 </object> 
-                                                </void> 
-                                                <void method="add"> 
-                                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                                  <void property="internalName"> 
-                                                   <string>value</string> 
-                                                  </void> 
-                                                  <void property="type"> 
-                                                   <object idref="PrimitiveTypeInfo1"/> 
-                                                  </void> 
-                                                 </object> 
-                                                </void> 
-                                               </object> 
+                                            <void method="add"> 
+                                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                              <void property="internalName"> 
+                                               <string>value</string> 
+                                              </void> 
+                                              <void property="type"> 
+                                               <object idref="PrimitiveTypeInfo1"/> 
                                               </void> 
                                              </object> 
                                             </void> 
@@ -928,13 +1067,6 @@
                                           </void> 
                                          </object> 
                                         </void> 
-                                        <void property="schema"> 
-                                         <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-                                          <void property="signature"> 
-                                           <object idref="Vector0"/> 
-                                          </void> 
-                                         </object> 
-                                        </void> 
                                        </object> 
                                       </void> 
                                      </object> 
@@ -953,36 +1085,12 @@
                                 <void property="schema"> 
                                  <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
                                   <void property="signature"> 
-                                   <object class="java.util.Vector"> 
-                                    <void method="add"> 
-                                     <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                      <void property="internalName"> 
-                                       <string>_col0</string> 
-                                      </void> 
-                                      <void property="type"> 
-                                       <object idref="PrimitiveTypeInfo1"/> 
-                                      </void> 
-                                     </object> 
-                                    </void> 
-                                    <void method="add"> 
-                                     <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                                      <void property="internalName"> 
-                                       <string>_col1</string> 
-                                      </void> 
-                                      <void property="type"> 
-                                       <object idref="PrimitiveTypeInfo1"/> 
-                                      </void> 
-                                     </object> 
-                                    </void> 
-                                   </object> 
+                                   <object idref="Vector0"/> 
                                   </void> 
                                  </object> 
                                 </void> 
                                </object> 
                               </void> 
-                              <void method="add"> 
-                               <object idref="SelectOperator0"/> 
-                              </void> 
                              </object> 
                             </void> 
                             <void property="schema"> 
@@ -990,10 +1098,24 @@
                               <void property="signature"> 
                                <object class="java.util.Vector"> 
                                 <void method="add"> 
-                                 <object idref="ColumnInfo0"/> 
-                                </void> 
+                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                  <void property="internalName"> 
+                                   <string>_col0</string> 
+                                  </void> 
+                                  <void property="type"> 
+                                   <object idref="PrimitiveTypeInfo1"/> 
+                                  </void> 
+                                 </object> 
+                                </void> 
                                 <void method="add"> 
-                                 <object idref="ColumnInfo1"/> 
+                                 <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                                  <void property="internalName"> 
+                                   <string>_col1</string> 
+                                  </void> 
+                                  <void property="type"> 
+                                   <object idref="PrimitiveTypeInfo1"/> 
+                                  </void> 
+                                 </object> 
                                 </void> 
                                </object> 
                               </void> 
@@ -1003,72 +1125,12 @@
                           </void> 
                          </object> 
                         </void> 
-                        <void property="columnExprMap"> 
-                         <object class="java.util.HashMap"> 
-                          <void method="put"> 
-                           <string>_col1</string> 
-                           <object id="exprNodeColumnDesc4" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>value</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="put"> 
-                           <string>_col0</string> 
-                           <object id="exprNodeColumnDesc5" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                            <void property="column"> 
-                             <string>key</string> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo1"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="conf"> 
-                         <object class="org.apache.hadoop.hive.ql.plan.selectDesc"> 
-                          <void property="colList"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <object idref="exprNodeColumnDesc5"/> 
-                            </void> 
-                            <void method="add"> 
-                             <object idref="exprNodeColumnDesc4"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="outputColumnNames"> 
-                           <object class="java.util.ArrayList"> 
-                            <void method="add"> 
-                             <string>_col0</string> 
-                            </void> 
-                            <void method="add"> 
-                             <string>_col1</string> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void property="selectStar"> 
-                           <boolean>true</boolean> 
-                          </void> 
-                         </object> 
-                        </void> 
-                        <void property="parentOperators"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object idref="FilterOperator1"/> 
-                          </void> 
-                         </object> 
-                        </void> 
                         <void property="schema"> 
                          <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
                           <void property="signature"> 
                            <object class="java.util.Vector"> 
                             <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                             <object id="ColumnInfo0" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                               <void property="internalName"> 
                                <string>_col0</string> 
                               </void> 
@@ -1078,7 +1140,7 @@
                              </object> 
                             </void> 
                             <void method="add"> 
-                             <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                             <object id="ColumnInfo1" class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
                               <void property="internalName"> 
                                <string>_col1</string> 
                               </void> 
@@ -1095,100 +1157,51 @@
                       </void> 
                      </object> 
                     </void> 
-                    <void property="conf"> 
-                     <object class="org.apache.hadoop.hive.ql.plan.filterDesc"> 
-                      <void property="predicate"> 
-                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                        <void property="UDFClass"> 
-                         <class>org.apache.hadoop.hive.ql.udf.UDFOPGreaterThan</class> 
+                    <void property="columnExprMap"> 
+                     <object class="java.util.HashMap"> 
+                      <void method="put"> 
+                       <string>_col1</string> 
+                       <object id="exprNodeColumnDesc4" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                        <void property="column"> 
+                         <string>value</string> 
                         </void> 
-                        <void property="UDFMethod"> 
-                         <object id="Method3" class="org.apache.hadoop.hive.ql.udf.UDFOPGreaterThan" method="getMethod"> 
-                          <string>evaluate</string> 
-                          <array class="java.lang.Class" length="2"> 
-                           <void index="0"> 
-                            <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
-                           </void> 
-                           <void index="1"> 
-                            <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
-                           </void> 
-                          </array> 
-                         </object> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
                         </void> 
-                        <void property="childExprs"> 
-                         <object class="java.util.ArrayList"> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                            <void property="UDFClass"> 
-                             <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
-                            </void> 
-                            <void property="UDFMethod"> 
-                             <object id="Method4" class="org.apache.hadoop.hive.ql.udf.UDFToDouble" method="getMethod"> 
-                              <string>evaluate</string> 
-                              <array class="java.lang.Class" length="1"> 
-                               <void index="0"> 
-                                <class>org.apache.hadoop.io.Text</class> 
-                               </void> 
-                              </array> 
-                             </object> 
-                            </void> 
-                            <void property="childExprs"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
-                                <void property="column"> 
-                                 <string>key</string> 
-                                </void> 
-                                <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo1"/> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                          <void method="add"> 
-                           <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
-                            <void property="UDFClass"> 
-                             <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
-                            </void> 
-                            <void property="UDFMethod"> 
-                             <object id="Method5" class="org.apache.hadoop.hive.ql.udf.UDFToDouble" method="getMethod"> 
-                              <string>evaluate</string> 
-                              <array class="java.lang.Class" length="1"> 
-                               <void index="0"> 
-                                <class>org.apache.hadoop.io.IntWritable</class> 
-                               </void> 
-                              </array> 
-                             </object> 
-                            </void> 
-                            <void property="childExprs"> 
-                             <object class="java.util.ArrayList"> 
-                              <void method="add"> 
-                               <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
-                                <void property="typeInfo"> 
-                                 <object idref="PrimitiveTypeInfo2"/> 
-                                </void> 
-                                <void property="value"> 
-                                 <int>100</int> 
-                                </void> 
-                               </object> 
-                              </void> 
-                             </object> 
-                            </void> 
-                            <void property="typeInfo"> 
-                             <object idref="PrimitiveTypeInfo0"/> 
-                            </void> 
-                           </object> 
-                          </void> 
-                         </object> 
+                       </object> 
+                      </void> 
+                      <void method="put"> 
+                       <string>_col0</string> 
+                       <object id="exprNodeColumnDesc5" class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                        <void property="column"> 
+                         <string>key</string> 
                         </void> 
                         <void property="typeInfo"> 
-                         <object idref="PrimitiveTypeInfo3"/> 
+                         <object idref="PrimitiveTypeInfo1"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="conf"> 
+                     <object class="org.apache.hadoop.hive.ql.plan.selectDesc"> 
+                      <void property="colList"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <object idref="exprNodeColumnDesc5"/> 
+                        </void> 
+                        <void method="add"> 
+                         <object idref="exprNodeColumnDesc4"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                      <void property="outputColumnNames"> 
+                       <object class="java.util.ArrayList"> 
+                        <void method="add"> 
+                         <string>_col0</string> 
+                        </void> 
+                        <void method="add"> 
+                         <string>_col1</string> 
                         </void> 
                        </object> 
                       </void> 
@@ -1197,33 +1210,19 @@
                     <void property="parentOperators"> 
                      <object class="java.util.ArrayList"> 
                       <void method="add"> 
-                       <object idref="FilterOperator0"/> 
+                       <object idref="FilterOperator1"/> 
                       </void> 
                      </object> 
                     </void> 
                     <void property="schema"> 
                      <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
                       <void property="signature"> 
-                       <object id="Vector1" class="java.util.Vector"> 
+                       <object class="java.util.Vector"> 
                         <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>key</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo1"/> 
-                          </void> 
-                         </object> 
+                         <object idref="ColumnInfo0"/> 
                         </void> 
                         <void method="add"> 
-                         <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
-                          <void property="internalName"> 
-                           <string>value</string> 
-                          </void> 
-                          <void property="type"> 
-                           <object idref="PrimitiveTypeInfo1"/> 
-                          </void> 
-                         </object> 
+                         <object idref="ColumnInfo1"/> 
                         </void> 
                        </object> 
                       </void> 
@@ -1238,10 +1237,20 @@
                   <void property="predicate"> 
                    <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
                     <void property="UDFClass"> 
-                     <class>org.apache.hadoop.hive.ql.udf.UDFOPGreaterThan</class> 
+                     <class>org.apache.hadoop.hive.ql.udf.UDFOPLessThan</class> 
                     </void> 
                     <void property="UDFMethod"> 
-                     <object idref="Method3"/> 
+                     <object id="Method3" class="org.apache.hadoop.hive.ql.udf.UDFOPLessThan" method="getMethod"> 
+                      <string>evaluate</string> 
+                      <array class="java.lang.Class" length="2"> 
+                       <void index="0"> 
+                        <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
+                       </void> 
+                       <void index="1"> 
+                        <class>org.apache.hadoop.hive.serde2.io.DoubleWritable</class> 
+                       </void> 
+                      </array> 
+                     </object> 
                     </void> 
                     <void property="childExprs"> 
                      <object class="java.util.ArrayList"> 
@@ -1251,7 +1260,14 @@
                          <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
                         </void> 
                         <void property="UDFMethod"> 
-                         <object idref="Method4"/> 
+                         <object id="Method4" class="org.apache.hadoop.hive.ql.udf.UDFToDouble" method="getMethod"> 
+                          <string>evaluate</string> 
+                          <array class="java.lang.Class" length="1"> 
+                           <void index="0"> 
+                            <class>org.apache.hadoop.io.Text</class> 
+                           </void> 
+                          </array> 
+                         </object> 
                         </void> 
                         <void property="childExprs"> 
                          <object class="java.util.ArrayList"> 
@@ -1278,7 +1294,14 @@
                          <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
                         </void> 
                         <void property="UDFMethod"> 
-                         <object idref="Method5"/> 
+                         <object id="Method5" class="org.apache.hadoop.hive.ql.udf.UDFToDouble" method="getMethod"> 
+                          <string>evaluate</string> 
+                          <array class="java.lang.Class" length="1"> 
+                           <void index="0"> 
+                            <class>org.apache.hadoop.io.IntWritable</class> 
+                           </void> 
+                          </array> 
+                         </object> 
                         </void> 
                         <void property="childExprs"> 
                          <object class="java.util.ArrayList"> 
@@ -1311,14 +1334,35 @@
                 <void property="parentOperators"> 
                  <object class="java.util.ArrayList"> 
                   <void method="add"> 
-                   <object idref="TableScanOperator1"/> 
+                   <object idref="FilterOperator0"/> 
                   </void> 
                  </object> 
                 </void> 
                 <void property="schema"> 
                  <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
                   <void property="signature"> 
-                   <object idref="Vector1"/> 
+                   <object id="Vector1" class="java.util.Vector"> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="internalName"> 
+                       <string>key</string> 
+                      </void> 
+                      <void property="type"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void method="add"> 
+                     <object class="org.apache.hadoop.hive.ql.exec.ColumnInfo"> 
+                      <void property="internalName"> 
+                       <string>value</string> 
+                      </void> 
+                      <void property="type"> 
+                       <object idref="PrimitiveTypeInfo1"/> 
+                      </void> 
+                     </object> 
+                    </void> 
+                   </object> 
                   </void> 
                  </object> 
                 </void> 
@@ -1326,480 +1370,128 @@
               </void> 
              </object> 
             </void> 
-            <void property="neededColumnIDs"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <int>0</int> 
-              </void> 
-              <void method="add"> 
-               <int>1</int> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="schema"> 
-             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
-              <void property="signature"> 
-               <object idref="Vector1"/> 
-              </void> 
-             </object> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="mapCurrCtx"> 
-           <object class="java.util.LinkedHashMap"> 
-            <void method="put"> 
-             <object idref="TableScanOperator2"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-            <void method="put"> 
-             <object idref="FilterOperator3"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-            <void method="put"> 
-             <object idref="FilterOperator2"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-            <void method="put"> 
-             <object idref="SelectOperator2"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-            <void method="put"> 
-             <object idref="UnionOperator0"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-            <void method="put"> 
-             <object idref="SelectOperator1"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-            <void method="put"> 
-             <object idref="TableScanOperator1"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-            <void method="put"> 
-             <object idref="FilterOperator0"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-            <void method="put"> 
-             <object idref="FilterOperator1"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-            <void method="put"> 
-             <object idref="SelectOperator0"/> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.GenMRProcContext$GenMapRedCtx"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="mvTask"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="MoveTask0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="opTaskMap"> 
-           <object class="java.util.HashMap"> 
-            <void method="put"> 
-             <null/> 
-             <object idref="MapRedTask0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="parseCtx"> 
-           <object class="org.apache.hadoop.hive.ql.parse.ParseContext"> 
-            <void property="QB"> 
-             <object class="org.apache.hadoop.hive.ql.parse.QB"/> 
-            </void> 
-            <void property="UCtx"> 
-             <object class="org.apache.hadoop.hive.ql.optimizer.unionproc.UnionProcContext"/> 
-            </void> 
-            <void property="aliasToPruner"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>null-subquery1:unioninput-subquery1:src</string> 
-               <object class="org.apache.hadoop.hive.ql.parse.PartitionPruner"/> 
-              </void> 
-              <void method="put"> 
-               <string>null-subquery2:unioninput-subquery2:src</string> 
-               <object class="org.apache.hadoop.hive.ql.parse.PartitionPruner"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="aliasToSamplePruner"> 
-             <object class="java.util.HashMap"/> 
-            </void> 
             <void property="conf"> 
-             <object idref="HiveConf0"/> 
-            </void> 
-            <void property="context"> 
-             <object class="org.apache.hadoop.hive.ql.Context"/> 
-            </void> 
-            <void property="destTableId"> 
-             <int>2</int> 
-            </void> 
-            <void property="idToTableNameMap"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>1</string> 
-               <string>../build/ql/test/data/warehouse/union.out</string> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="joinContext"> 
-             <object class="java.util.HashMap"/> 
-            </void> 
-            <void property="listMapJoinOpsNoReducer"> 
-             <object class="java.util.ArrayList"/> 
-            </void> 
-            <void property="loadFileWork"> 
-             <object class="java.util.ArrayList"> 
-              <void method="add"> 
-               <object idref="loadFileDesc0"/> 
-              </void> 
-             </object> 
-            </void> 
-            <void property="loadTableWork"> 
-             <object class="java.util.ArrayList"/> 
-            </void> 
-            <void property="opParseCtx"> 
-             <object class="java.util.LinkedHashMap"> 
-              <void method="put"> 
-               <object idref="TableScanOperator2"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object id="RowResolver0" class="org.apache.hadoop.hive.ql.parse.RowResolver"/> 
+             <object class="org.apache.hadoop.hive.ql.plan.filterDesc"> 
+              <void property="predicate"> 
+               <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                <void property="UDFClass"> 
+                 <class>org.apache.hadoop.hive.ql.udf.UDFOPLessThan</class> 
                 </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="FilterOperator2"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object idref="RowResolver0"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="SelectOperator2"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object class="org.apache.hadoop.hive.ql.parse.RowResolver"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="TableScanOperator1"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object id="RowResolver1" class="org.apache.hadoop.hive.ql.parse.RowResolver"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="FilterOperator1"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object idref="RowResolver1"/> 
+                <void property="UDFMethod"> 
+                 <object idref="Method3"/> 
                 </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="SelectOperator0"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object class="org.apache.hadoop.hive.ql.parse.RowResolver"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="UnionOperator0"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object class="org.apache.hadoop.hive.ql.parse.RowResolver"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="SelectOperator1"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object id="RowResolver2" class="org.apache.hadoop.hive.ql.parse.RowResolver"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="FileSinkOperator0"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object idref="RowResolver2"/> 
-                </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="FilterOperator3"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object idref="RowResolver0"/> 
+                <void property="childExprs"> 
+                 <object class="java.util.ArrayList"> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                    <void property="UDFClass"> 
+                     <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
+                    </void> 
+                    <void property="UDFMethod"> 
+                     <object idref="Method4"/> 
+                    </void> 
+                    <void property="childExprs"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeColumnDesc"> 
+                        <void property="column"> 
+                         <string>key</string> 
+                        </void> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo1"/> 
+                        </void> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                  <void method="add"> 
+                   <object class="org.apache.hadoop.hive.ql.plan.exprNodeFuncDesc"> 
+                    <void property="UDFClass"> 
+                     <class>org.apache.hadoop.hive.ql.udf.UDFToDouble</class> 
+                    </void> 
+                    <void property="UDFMethod"> 
+                     <object idref="Method5"/> 
+                    </void> 
+                    <void property="childExprs"> 
+                     <object class="java.util.ArrayList"> 
+                      <void method="add"> 
+                       <object class="org.apache.hadoop.hive.ql.plan.exprNodeConstantDesc"> 
+                        <void property="typeInfo"> 
+                         <object idref="PrimitiveTypeInfo2"/> 
+                        </void> 
+                        <void property="value"> 
+                         <int>100</int> 
+                        </void> 
+                       </object> 
+                      </void> 
+                     </object> 
+                    </void> 
+                    <void property="typeInfo"> 
+                     <object idref="PrimitiveTypeInfo0"/> 
+                    </void> 
+                   </object> 
+                  </void> 
+                 </object> 
                 </void> 
-               </object> 
-              </void> 
-              <void method="put"> 
-               <object idref="FilterOperator0"/> 
-               <object class="org.apache.hadoop.hive.ql.parse.OpParseContext"> 
-                <void property="RR"> 
-                 <object idref="RowResolver1"/> 
+                <void property="typeInfo"> 
+                 <object idref="PrimitiveTypeInfo3"/> 
                 </void> 
                </object> 
               </void> 
              </object> 
             </void> 
-            <void property="parseTree"> 
-             <object class="org.apache.hadoop.hive.ql.parse.ASTNode"> 
-              <void property="tokenStartIndex"> 
-               <int>0</int> 
-              </void> 
-              <void property="tokenStopIndex"> 
-               <int>75</int> 
+            <void property="parentOperators"> 
+             <object class="java.util.ArrayList"> 
+              <void method="add"> 
+               <object idref="TableScanOperator1"/> 
               </void> 
              </object> 
             </void> 
-            <void property="topOps"> 
-             <object class="java.util.HashMap"> 
-              <void method="put"> 
-               <string>null-subquery1:unioninput-subquery1:src</string> 
-               <object idref="TableScanOperator2"/> 
-              </void> 
-              <void method="put"> 
-               <string>null-subquery2:unioninput-subquery2:src</string> 
-               <object idref="TableScanOperator1"/> 
+            <void property="schema"> 
+             <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+              <void property="signature"> 
+               <object idref="Vector1"/> 
               </void> 
              </object> 
             </void> 
-            <void property="topSelOps"> 
-             <object class="java.util.HashMap"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="rootOps"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="TableScanOperator2"/> 
-            </void> 
-            <void method="add"> 
-             <object idref="TableScanOperator1"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="rootTasks"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="MapRedTask0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="seenFileSinkOps"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="FileSinkOperator0"/> 
-            </void> 
-           </object> 
-          </void> 
-          <void property="seenOps"> 
-           <object class="java.util.ArrayList"> 
-            <void method="add"> 
-             <object idref="TableScanOperator2"/> 
-            </void> 
-            <void method="add"> 
-             <object idref="TableScanOperator1"/> 
-            </void> 
            </object> 
           </void> 
          </object> 
         </void> 
-        <void property="dir"> 
-         <string>file:/data/users/njain/hive3/hive3/build/ql/tmp/350041570/10001</string> 
-        </void> 
-        <void property="listTasks"> 
-         <object idref="ArrayList0"/> 
-        </void> 
-       </object> 
-      </void> 
-      <void property="work"> 
-       <object class="org.apache.hadoop.hive.ql.plan.ConditionalWork"> 
-        <void property="listWorks"> 
+        <void property="neededColumnIDs"> 
          <object class="java.util.ArrayList"> 
           <void method="add"> 
-           <object idref="moveWork0"/> 
+           <int>0</int> 
           </void> 
           <void method="add"> 
-           <object idref="mapredWork0"/> 
+           <int>1</int> 
+          </void> 
+         </object> 
+        </void> 
+        <void property="schema"> 
+         <object class="org.apache.hadoop.hive.ql.exec.RowSchema"> 
+          <void property="signature"> 
+           <object idref="Vector1"/> 
           </void> 
          </object> 
         </void> 
        </object> 
       </void> 
-     </object> 
-    </void> 
-   </object> 
-  </void> 
-  <void property="id"> 
-   <string>Stage-2</string> 
-  </void> 
-  <void property="work"> 
-   <object class="org.apache.hadoop.hive.ql.plan.mapredWork"> 
-    <void property="aliasToPartnInfo"> 
-     <void method="put"> 
-      <string>null-subquery1:unioninput-subquery1:src</string> 
-      <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
-       <void property="partSpec"> 
-        <object class="java.util.LinkedHashMap"/> 
-       </void> 
-       <void property="tableDesc"> 
-        <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
-         <void property="deserializerClass"> 
-          <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
-         </void> 
-         <void property="inputFileFormatClass"> 
-          <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-         </void> 
-         <void property="outputFileFormatClass"> 
-          <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-         </void> 
-         <void property="properties"> 
-          <object class="java.util.Properties"> 
-           <void method="put"> 
-            <string>name</string> 
-            <string>src</string> 
-           </void> 
-           <void method="put"> 
-            <string>columns.types</string> 
-            <string>string:string</string> 
-           </void> 
-           <void method="put"> 
-            <string>serialization.ddl</string> 
-            <string>struct src { string key, string value}</string> 
-           </void> 
-           <void method="put"> 
-            <string>serialization.format</string> 
-            <string>1</string> 
-           </void> 
-           <void method="put"> 
-            <string>columns</string> 
-            <string>key,value</string> 
-           </void> 
-           <void method="put"> 
-            <string>bucket_count</string> 
-            <string>-1</string> 
-           </void> 
-           <void method="put"> 
-            <string>serialization.lib</string> 
-            <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-           </void> 
-           <void method="put"> 
-            <string>file.inputformat</string> 
-            <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-           </void> 
-           <void method="put"> 
-            <string>file.outputformat</string> 
-            <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-           </void> 
-           <void method="put"> 
-            <string>location</string> 
-            <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/src</string> 
-           </void> 
-          </object> 
-         </void> 
-         <void property="serdeClassName"> 
-          <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-         </void> 
-        </object> 
-       </void> 
-      </object> 
-     </void> 
-     <void method="put"> 
-      <string>null-subquery2:unioninput-subquery2:src</string> 
-      <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
-       <void property="partSpec"> 
-        <object id="LinkedHashMap0" class="java.util.LinkedHashMap"/> 
-       </void> 
-       <void property="tableDesc"> 
-        <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
-         <void property="deserializerClass"> 
-          <class>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</class> 
-         </void> 
-         <void property="inputFileFormatClass"> 
-          <class>org.apache.hadoop.mapred.TextInputFormat</class> 
-         </void> 
-         <void property="outputFileFormatClass"> 
-          <class>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</class> 
-         </void> 
-         <void property="properties"> 
-          <object id="Properties0" class="java.util.Properties"> 
-           <void method="put"> 
-            <string>name</string> 
-            <string>src</string> 
-           </void> 
-           <void method="put"> 
-            <string>columns.types</string> 
-            <string>string:string</string> 
-           </void> 
-           <void method="put"> 
-            <string>serialization.ddl</string> 
-            <string>struct src { string key, string value}</string> 
-           </void> 
-           <void method="put"> 
-            <string>serialization.format</string> 
-            <string>1</string> 
-           </void> 
-           <void method="put"> 
-            <string>columns</string> 
-            <string>key,value</string> 
-           </void> 
-           <void method="put"> 
-            <string>bucket_count</string> 
-            <string>-1</string> 
-           </void> 
-           <void method="put"> 
-            <string>serialization.lib</string> 
-            <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-           </void> 
-           <void method="put"> 
-            <string>file.inputformat</string> 
-            <string>org.apache.hadoop.mapred.TextInputFormat</string> 
-           </void> 
-           <void method="put"> 
-            <string>file.outputformat</string> 
-            <string>org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat</string> 
-           </void> 
-           <void method="put"> 
-            <string>location</string> 
-            <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/src</string> 
-           </void> 
-          </object> 
-         </void> 
-         <void property="serdeClassName"> 
-          <string>org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe</string> 
-         </void> 
-        </object> 
-       </void> 
-      </object> 
-     </void> 
-    </void> 
-    <void property="aliasToWork"> 
-     <object class="java.util.LinkedHashMap"> 
-      <void method="put"> 
-       <string>null-subquery1:unioninput-subquery1:src</string> 
-       <object idref="TableScanOperator2"/> 
-      </void> 
       <void method="put"> 
        <string>null-subquery2:unioninput-subquery2:src</string> 
-       <object idref="TableScanOperator1"/> 
+       <object idref="TableScanOperator2"/> 
       </void> 
      </object> 
     </void> 
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/src</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>null-subquery1:unioninput-subquery1:src</string> 
@@ -1814,7 +1506,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/njain/hive3/hive3/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive5/hive5/build/ql/test/data/warehouse/src</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object idref="LinkedHashMap0"/> 
