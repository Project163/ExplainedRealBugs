diff --git a/CHANGES.txt b/CHANGES.txt
index bf9cad497d..d15578376e 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -682,6 +682,8 @@ Release 0.4.0 -  Unreleased
     HIVE-718. Fix Loading data inpath into a new partition.
     (Namit Jain via zshao)
 
+    HIVE-864. Fix map-join memory-leak. (Namit Jain via zshao)
+
 Release 0.3.1 - Unreleased
 
   INCOMPATIBLE CHANGES
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/util/jdbm/recman/PhysicalRowIdManager.java b/ql/src/java/org/apache/hadoop/hive/ql/util/jdbm/recman/PhysicalRowIdManager.java
index 357d59695e..3c5d573dda 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/util/jdbm/recman/PhysicalRowIdManager.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/util/jdbm/recman/PhysicalRowIdManager.java
@@ -138,7 +138,7 @@ void delete( Location rowid )
      *  Retrieves a record.
      */
     byte[] fetch( Location rowid )
-        throws IOException 
+        throws IOException
     {
         // fetch the record header
         PageCursor curs = new PageCursor( pageman, rowid.getBlock() );
@@ -190,7 +190,7 @@ private Location alloc( int size )
     {
         Location retval = freeman.get( size );
         if ( retval == null ) {
-            retval = allocNew( 2*size, pageman.getLast( Magic.USED_PAGE ) );
+            retval = allocNew( size, pageman.getLast( Magic.USED_PAGE ) );
         }
         return retval;
     }
@@ -337,7 +337,7 @@ private void write(Location rowid, byte[] data, int start, int length )
             if ( leftToWrite < toCopy ) {
                 toCopy = leftToWrite;
             }
-            System.arraycopy( data, offsetInBuffer, block.getData(), 
+            System.arraycopy( data, offsetInBuffer, block.getData(),
                               dataOffset, toCopy );
 
             // Go to the next block
