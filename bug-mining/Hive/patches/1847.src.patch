diff --git a/hbase-handler/src/test/queries/positive/hbase_queries.q b/hbase-handler/src/test/queries/positive/hbase_queries.q
index 0457566a05..9ea9b1a561 100644
--- a/hbase-handler/src/test/queries/positive/hbase_queries.q
+++ b/hbase-handler/src/test/queries/positive/hbase_queries.q
@@ -37,7 +37,7 @@ ORDER BY key, value LIMIT 20;
 EXPLAIN 
 SELECT Y.*
 FROM 
-(SELECT hbase_table_1.* FROM hbase_table_1 WHERE hbase_table_1.key > 100) x
+(SELECT hbase_table_1.* FROM hbase_table_1 WHERE 100 < hbase_table_1.key) x
 JOIN 
 (SELECT hbase_table_2.* FROM hbase_table_2 WHERE hbase_table_2.key < 120) Y
 ON (x.key = Y.key)
@@ -45,7 +45,7 @@ ORDER BY key, value;
 
 SELECT Y.*
 FROM 
-(SELECT hbase_table_1.* FROM hbase_table_1 WHERE hbase_table_1.key > 100) x
+(SELECT hbase_table_1.* FROM hbase_table_1 WHERE 100 < hbase_table_1.key) x
 JOIN 
 (SELECT hbase_table_2.* FROM hbase_table_2 WHERE hbase_table_2.key < 120) Y
 ON (x.key = Y.key)
diff --git a/hbase-handler/src/test/results/positive/hbase_queries.q.out b/hbase-handler/src/test/results/positive/hbase_queries.q.out
index 9f7905e761..2768755eca 100644
--- a/hbase-handler/src/test/results/positive/hbase_queries.q.out
+++ b/hbase-handler/src/test/results/positive/hbase_queries.q.out
@@ -262,7 +262,7 @@ POSTHOOK: Input: default@src
 PREHOOK: query: EXPLAIN 
 SELECT Y.*
 FROM 
-(SELECT hbase_table_1.* FROM hbase_table_1 WHERE hbase_table_1.key > 100) x
+(SELECT hbase_table_1.* FROM hbase_table_1 WHERE 100 < hbase_table_1.key) x
 JOIN 
 (SELECT hbase_table_2.* FROM hbase_table_2 WHERE hbase_table_2.key < 120) Y
 ON (x.key = Y.key)
@@ -271,14 +271,14 @@ PREHOOK: type: QUERY
 POSTHOOK: query: EXPLAIN 
 SELECT Y.*
 FROM 
-(SELECT hbase_table_1.* FROM hbase_table_1 WHERE hbase_table_1.key > 100) x
+(SELECT hbase_table_1.* FROM hbase_table_1 WHERE 100 < hbase_table_1.key) x
 JOIN 
 (SELECT hbase_table_2.* FROM hbase_table_2 WHERE hbase_table_2.key < 120) Y
 ON (x.key = Y.key)
 ORDER BY key, value
 POSTHOOK: type: QUERY
 ABSTRACT SYNTAX TREE:
-  (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME hbase_table_1))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_ALLCOLREF (TOK_TABNAME hbase_table_1)))) (TOK_WHERE (> (. (TOK_TABLE_OR_COL hbase_table_1) key) 100)))) x) (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME hbase_table_2))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_ALLCOLREF (TOK_TABNAME hbase_table_2)))) (TOK_WHERE (< (. (TOK_TABLE_OR_COL hbase_table_2) key) 120)))) Y) (= (. (TOK_TABLE_OR_COL x) key) (. (TOK_TABLE_OR_COL Y) key)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_ALLCOLREF (TOK_TABNAME Y)))) (TOK_ORDERBY (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL key)) (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL value)))))
+  (TOK_QUERY (TOK_FROM (TOK_JOIN (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME hbase_table_1))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_ALLCOLREF (TOK_TABNAME hbase_table_1)))) (TOK_WHERE (< 100 (. (TOK_TABLE_OR_COL hbase_table_1) key))))) x) (TOK_SUBQUERY (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME hbase_table_2))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_ALLCOLREF (TOK_TABNAME hbase_table_2)))) (TOK_WHERE (< (. (TOK_TABLE_OR_COL hbase_table_2) key) 120)))) Y) (= (. (TOK_TABLE_OR_COL x) key) (. (TOK_TABLE_OR_COL Y) key)))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_ALLCOLREF (TOK_TABNAME Y)))) (TOK_ORDERBY (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL key)) (TOK_TABSORTCOLNAMEASC (TOK_TABLE_OR_COL value)))))
 
 STAGE DEPENDENCIES:
   Stage-1 is a root stage
@@ -294,7 +294,7 @@ STAGE PLANS:
             alias: hbase_table_1
             Filter Operator
               predicate:
-                  expr: (key > 100)
+                  expr: (100 < key)
                   type: boolean
               Select Operator
                 expressions:
@@ -396,7 +396,7 @@ STAGE PLANS:
 
 PREHOOK: query: SELECT Y.*
 FROM 
-(SELECT hbase_table_1.* FROM hbase_table_1 WHERE hbase_table_1.key > 100) x
+(SELECT hbase_table_1.* FROM hbase_table_1 WHERE 100 < hbase_table_1.key) x
 JOIN 
 (SELECT hbase_table_2.* FROM hbase_table_2 WHERE hbase_table_2.key < 120) Y
 ON (x.key = Y.key)
@@ -407,7 +407,7 @@ PREHOOK: Input: default@hbase_table_2
 #### A masked pattern was here ####
 POSTHOOK: query: SELECT Y.*
 FROM 
-(SELECT hbase_table_1.* FROM hbase_table_1 WHERE hbase_table_1.key > 100) x
+(SELECT hbase_table_1.* FROM hbase_table_1 WHERE 100 < hbase_table_1.key) x
 JOIN 
 (SELECT hbase_table_2.* FROM hbase_table_2 WHERE hbase_table_2.key < 120) Y
 ON (x.key = Y.key)
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/index/IndexPredicateAnalyzer.java b/ql/src/java/org/apache/hadoop/hive/ql/index/IndexPredicateAnalyzer.java
index e66c22c0b8..d39ee2e5e6 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/index/IndexPredicateAnalyzer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/index/IndexPredicateAnalyzer.java
@@ -26,12 +26,7 @@
 import java.util.Set;
 import java.util.Stack;
 
-import org.apache.commons.logging.Log;
-import org.apache.commons.logging.LogFactory;
-import org.apache.hadoop.hive.ql.exec.ExprNodeEvaluator;
-import org.apache.hadoop.hive.ql.exec.ExprNodeEvaluatorFactory;
 import org.apache.hadoop.hive.ql.exec.FunctionRegistry;
-import org.apache.hadoop.hive.ql.exec.UDF;
 import org.apache.hadoop.hive.ql.lib.DefaultGraphWalker;
 import org.apache.hadoop.hive.ql.lib.DefaultRuleDispatcher;
 import org.apache.hadoop.hive.ql.lib.Dispatcher;
@@ -44,13 +39,12 @@
 import org.apache.hadoop.hive.ql.plan.ExprNodeColumnDesc;
 import org.apache.hadoop.hive.ql.plan.ExprNodeConstantDesc;
 import org.apache.hadoop.hive.ql.plan.ExprNodeDesc;
+import org.apache.hadoop.hive.ql.plan.ExprNodeDescUtils;
 import org.apache.hadoop.hive.ql.plan.ExprNodeGenericFuncDesc;
 import org.apache.hadoop.hive.ql.udf.generic.GenericUDF;
 import org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge;
-import org.apache.hadoop.hive.serde2.objectinspector.ObjectInspector;
-import org.apache.hadoop.hive.serde2.objectinspector.ObjectInspectorUtils;
 import org.apache.hadoop.hive.serde2.typeinfo.TypeInfoFactory;
-import org.apache.hadoop.util.ReflectionUtils;
+import org.apache.hadoop.hive.ql.udf.generic.GenericUDFBaseCompare;
 
 /**
  * IndexPredicateAnalyzer decomposes predicates, separating the parts
@@ -59,15 +53,14 @@
  * comparing a column reference with a constant value.  It is assumed
  * that all column aliases encountered refer to the same table.
  */
-public class IndexPredicateAnalyzer
-{
-  private static final Log LOG = LogFactory.getLog(IndexPredicateAnalyzer.class.getName());
-  private final Set<String> udfNames;
+public class IndexPredicateAnalyzer {
 
-  private Set<String> allowedColumnNames;
+  private final Set<String> udfNames;
+  private final Set<String> allowedColumnNames;
 
   public IndexPredicateAnalyzer() {
     udfNames = new HashSet<String>();
+    allowedColumnNames = new HashSet<String>();
   }
 
   /**
@@ -88,7 +81,7 @@ public void addComparisonOp(String udfName) {
    * column names are allowed.)
    */
   public void clearAllowedColumnNames() {
-    allowedColumnNames = new HashSet<String>();
+    allowedColumnNames.clear();
   }
 
   /**
@@ -97,9 +90,6 @@ public void clearAllowedColumnNames() {
    * @param columnName name of column to be allowed
    */
   public void allowColumnName(String columnName) {
-    if (allowedColumnNames == null) {
-      clearAllowedColumnNames();
-    }
     allowedColumnNames.add(columnName);
   }
 
@@ -159,7 +149,6 @@ private ExprNodeDesc analyzeExpr(
     List<IndexSearchCondition> searchConditions,
     Object... nodeOutputs) {
 
-    expr = (ExprNodeGenericFuncDesc) expr;
     if (FunctionRegistry.isOpAnd(expr)) {
       assert(nodeOutputs.length == 2);
       ExprNodeDesc residual1 = (ExprNodeDesc) nodeOutputs[0];
@@ -179,40 +168,31 @@ private ExprNodeDesc analyzeExpr(
         residuals);
     }
 
-    String udfName;
-    if (expr.getGenericUDF() instanceof GenericUDFBridge) {
-      GenericUDFBridge func = (GenericUDFBridge) expr.getGenericUDF();
-      udfName = func.getUdfName();
-    } else {
-      udfName = expr.getGenericUDF().getClass().getName();
+    GenericUDF genericUDF = expr.getGenericUDF();
+    if (!(genericUDF instanceof GenericUDFBaseCompare)) {
+      return expr;
     }
-    if (!udfNames.contains(udfName)) {
+    ExprNodeDesc expr1 = (ExprNodeDesc) nodeOutputs[0];
+    ExprNodeDesc expr2 = (ExprNodeDesc) nodeOutputs[1];
+    ExprNodeDesc[] extracted = ExprNodeDescUtils.extractComparePair(expr1, expr2);
+    if (extracted == null) {
       return expr;
     }
-
-    ExprNodeDesc child1 = extractConstant((ExprNodeDesc) nodeOutputs[0]);
-    ExprNodeDesc child2 = extractConstant((ExprNodeDesc) nodeOutputs[1]);
-    ExprNodeColumnDesc columnDesc = null;
-    ExprNodeConstantDesc constantDesc = null;
-    if ((child1 instanceof ExprNodeColumnDesc)
-      && (child2 instanceof ExprNodeConstantDesc)) {
-      // COL <op> CONSTANT
-      columnDesc = (ExprNodeColumnDesc) child1;
-      constantDesc = (ExprNodeConstantDesc) child2;
-    } else if ((child2 instanceof ExprNodeColumnDesc)
-      && (child1 instanceof ExprNodeConstantDesc)) {
-      // CONSTANT <op> COL
-      columnDesc = (ExprNodeColumnDesc) child2;
-      constantDesc = (ExprNodeConstantDesc) child1;
+    if (extracted.length > 2) {
+      genericUDF = genericUDF.flip();
     }
-    if (columnDesc == null) {
+
+    String udfName = genericUDF.getUdfName();
+    if (!udfNames.contains(genericUDF.getUdfName())) {
       return expr;
     }
-    if (allowedColumnNames != null) {
-      if (!allowedColumnNames.contains(columnDesc.getColumn())) {
-        return expr;
-      }
+
+    ExprNodeColumnDesc columnDesc = (ExprNodeColumnDesc) extracted[0];
+    ExprNodeConstantDesc constantDesc = (ExprNodeConstantDesc) extracted[1];
+    if (!allowedColumnNames.contains(columnDesc.getColumn())) {
+      return expr;
     }
+
     searchConditions.add(
       new IndexSearchCondition(
         columnDesc,
@@ -225,55 +205,6 @@ private ExprNodeDesc analyzeExpr(
     return null;
   }
 
-  private ExprNodeDesc extractConstant(ExprNodeDesc expr) {
-    if (!(expr instanceof ExprNodeGenericFuncDesc)) {
-      return expr;
-    }
-    ExprNodeConstantDesc folded = foldConstant(((ExprNodeGenericFuncDesc) expr));
-    return folded == null ? expr : folded;
-  }
-
-  private ExprNodeConstantDesc foldConstant(ExprNodeGenericFuncDesc func) {
-    GenericUDF udf = func.getGenericUDF();
-    if (!FunctionRegistry.isDeterministic(udf) || FunctionRegistry.isStateful(udf)) {
-      return null;
-    }
-    try {
-      // If the UDF depends on any external resources, we can't fold because the
-      // resources may not be available at compile time.
-      if (udf instanceof GenericUDFBridge) {
-        UDF internal = ReflectionUtils.newInstance(((GenericUDFBridge) udf).getUdfClass(), null);
-        if (internal.getRequiredFiles() != null || internal.getRequiredJars() != null) {
-          return null;
-        }
-      } else {
-        if (udf.getRequiredFiles() != null || udf.getRequiredJars() != null) {
-          return null;
-        }
-      }
-
-      for (ExprNodeDesc child : func.getChildren()) {
-        if (child instanceof ExprNodeConstantDesc) {
-          continue;
-        } else if (child instanceof ExprNodeGenericFuncDesc) {
-          if (foldConstant((ExprNodeGenericFuncDesc) child) != null) {
-            continue;
-          }
-        }
-        return null;
-      }
-      ExprNodeEvaluator evaluator = ExprNodeEvaluatorFactory.get(func);
-      ObjectInspector output = evaluator.initialize(null);
-
-      Object constant = evaluator.evaluate(null);
-      Object java = ObjectInspectorUtils.copyToStandardJavaObject(constant, output);
-
-      return new ExprNodeConstantDesc(java);
-    } catch (Exception e) {
-      return null;
-    }
-  }
-
   /**
    * Translates search conditions back to ExprNodeDesc form (as
    * a left-deep conjunction).
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/plan/ExprNodeDescUtils.java b/ql/src/java/org/apache/hadoop/hive/ql/plan/ExprNodeDescUtils.java
index 96c8d892d1..e50026b27f 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/plan/ExprNodeDescUtils.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/plan/ExprNodeDescUtils.java
@@ -22,10 +22,18 @@
 import java.util.List;
 import java.util.Map;
 
+import org.apache.hadoop.hive.ql.exec.ExprNodeEvaluator;
+import org.apache.hadoop.hive.ql.exec.ExprNodeEvaluatorFactory;
 import org.apache.hadoop.hive.ql.exec.FunctionRegistry;
 import org.apache.hadoop.hive.ql.exec.Operator;
 import org.apache.hadoop.hive.ql.parse.SemanticException;
+import org.apache.hadoop.hive.ql.exec.UDF;
+import org.apache.hadoop.hive.ql.udf.generic.GenericUDF;
+import org.apache.hadoop.hive.ql.udf.generic.GenericUDFBridge;
+import org.apache.hadoop.hive.serde2.objectinspector.ObjectInspector;
+import org.apache.hadoop.hive.serde2.objectinspector.ObjectInspectorUtils;
 import org.apache.hadoop.hive.serde2.typeinfo.TypeInfoFactory;
+import org.apache.hadoop.util.ReflectionUtils;
 
 public class ExprNodeDescUtils {
 
@@ -244,4 +252,70 @@ public static Operator<?> getSingleParent(Operator<?> current, Operator<?> termi
     }
     throw new SemanticException("Met multiple parent operators");
   }
+
+  public static ExprNodeDesc[] extractComparePair(ExprNodeDesc expr1, ExprNodeDesc expr2) {
+    expr1 = extractConstant(expr1);
+    expr2 = extractConstant(expr2);
+    if (expr1 instanceof ExprNodeColumnDesc && expr2 instanceof ExprNodeConstantDesc) {
+      return new ExprNodeDesc[] {expr1, expr2};
+    }
+    if (expr1 instanceof ExprNodeConstantDesc && expr2 instanceof ExprNodeColumnDesc) {
+      return new ExprNodeDesc[] {expr2, expr1, null}; // add null as a marker (inverted order)
+    }
+    // todo: constant op constant
+    return null;
+  }
+
+  // from IndexPredicateAnalyzer
+  private static ExprNodeDesc extractConstant(ExprNodeDesc expr) {
+    if (!(expr instanceof ExprNodeGenericFuncDesc)) {
+      return expr;
+    }
+    ExprNodeConstantDesc folded = foldConstant(((ExprNodeGenericFuncDesc) expr));
+    return folded == null ? expr : folded;
+  }
+
+  private static ExprNodeConstantDesc foldConstant(ExprNodeGenericFuncDesc func) {
+    GenericUDF udf = func.getGenericUDF();
+    if (!FunctionRegistry.isDeterministic(udf) || FunctionRegistry.isStateful(udf)) {
+      return null;
+    }
+    try {
+      // If the UDF depends on any external resources, we can't fold because the
+      // resources may not be available at compile time.
+      if (udf instanceof GenericUDFBridge) {
+        UDF internal = ReflectionUtils.newInstance(((GenericUDFBridge) udf).getUdfClass(), null);
+        if (internal.getRequiredFiles() != null || internal.getRequiredJars() != null) {
+          return null;
+        }
+      } else {
+        if (udf.getRequiredFiles() != null || udf.getRequiredJars() != null) {
+          return null;
+        }
+      }
+
+      if (func.getChildren() != null) {
+        for (ExprNodeDesc child : func.getChildren()) {
+          if (child instanceof ExprNodeConstantDesc) {
+            continue;
+          }
+          if (child instanceof ExprNodeGenericFuncDesc) {
+            if (foldConstant((ExprNodeGenericFuncDesc) child) != null) {
+              continue;
+            }
+          }
+          return null;
+        }
+      }
+      ExprNodeEvaluator evaluator = ExprNodeEvaluatorFactory.get(func);
+      ObjectInspector output = evaluator.initialize(null);
+
+      Object constant = evaluator.evaluate(null);
+      Object java = ObjectInspectorUtils.copyToStandardJavaObject(constant, output);
+
+      return new ExprNodeConstantDesc(java);
+    } catch (Exception e) {
+      return null;
+    }
+  }
 }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDF.java b/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDF.java
index 3d1f55e8e6..1813b640fc 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDF.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDF.java
@@ -187,4 +187,15 @@ public abstract Object evaluate(DeferredObject[] arguments)
    */
   public void close() throws IOException {
   }
+
+  /**
+   * Some functions are affected by appearing order of arguments (comparisons, for example)
+   */
+  public GenericUDF flip() {
+    return this;
+  }
+
+  public String getUdfName() {
+    return getClass().getName();
+  }
 }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFBridge.java b/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFBridge.java
index 8206eddd0d..404a5fb79d 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFBridge.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFBridge.java
@@ -87,7 +87,7 @@ public class GenericUDFBridge extends GenericUDF implements Serializable {
    *
    * @param udfName
    *          The name of the corresponding udf.
-   * @param isOperator
+   * @param isOperator true for operators
    * @param udfClassName java class name of UDF
    */
   public GenericUDFBridge(String udfName, boolean isOperator,
@@ -105,6 +105,7 @@ public void setUdfName(String udfName) {
     this.udfName = udfName;
   }
 
+  @Override
   public String getUdfName() {
     return udfName;
   }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFOPEqualOrGreaterThan.java b/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFOPEqualOrGreaterThan.java
index 4083f5f400..edb1bf8a4f 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFOPEqualOrGreaterThan.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFOPEqualOrGreaterThan.java
@@ -52,7 +52,6 @@
 import org.apache.hadoop.hive.ql.exec.vector.expressions.gen.StringScalarGreaterEqualStringColumn;
 import org.apache.hadoop.hive.ql.metadata.HiveException;
 import org.apache.hadoop.hive.serde2.objectinspector.ObjectInspectorUtils;
-import org.apache.hadoop.hive.shims.ShimLoader;
 import org.apache.hadoop.io.Text;
 
 /**
@@ -139,4 +138,9 @@ public Object evaluate(DeferredObject[] arguments) throws HiveException {
     return result;
   }
 
+  @Override
+  public GenericUDF flip() {
+    return new GenericUDFOPEqualOrLessThan();
+  }
+
 }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFOPEqualOrLessThan.java b/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFOPEqualOrLessThan.java
index 5b98bc3d63..06d9647e9b 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFOPEqualOrLessThan.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFOPEqualOrLessThan.java
@@ -52,7 +52,6 @@
 import org.apache.hadoop.hive.ql.exec.vector.expressions.gen.StringScalarLessEqualStringColumn;
 import org.apache.hadoop.hive.ql.metadata.HiveException;
 import org.apache.hadoop.hive.serde2.objectinspector.ObjectInspectorUtils;
-import org.apache.hadoop.hive.shims.ShimLoader;
 import org.apache.hadoop.io.Text;
 
 /**
@@ -139,5 +138,10 @@ public Object evaluate(DeferredObject[] arguments) throws HiveException {
     return result;
   }
 
+  @Override
+  public GenericUDF flip() {
+    return new GenericUDFOPEqualOrGreaterThan();
+  }
+
 }
 
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFOPGreaterThan.java b/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFOPGreaterThan.java
index 2a9f4e26a0..28bce884a9 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFOPGreaterThan.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFOPGreaterThan.java
@@ -52,7 +52,6 @@
 import org.apache.hadoop.hive.ql.exec.vector.expressions.gen.StringScalarGreaterStringColumn;
 import org.apache.hadoop.hive.ql.metadata.HiveException;
 import org.apache.hadoop.hive.serde2.objectinspector.ObjectInspectorUtils;
-import org.apache.hadoop.hive.shims.ShimLoader;
 import org.apache.hadoop.io.Text;
 
 /**
@@ -139,5 +138,10 @@ public Object evaluate(DeferredObject[] arguments) throws HiveException {
     return result;
   }
 
+  @Override
+  public GenericUDF flip() {
+    return new GenericUDFOPLessThan();
+  }
+
 }
 
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFOPLessThan.java b/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFOPLessThan.java
index 3232ad16fe..9258b437ab 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFOPLessThan.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFOPLessThan.java
@@ -23,7 +23,6 @@
 import org.apache.hadoop.hive.ql.exec.vector.expressions.gen.*;
 import org.apache.hadoop.hive.ql.metadata.HiveException;
 import org.apache.hadoop.hive.serde2.objectinspector.ObjectInspectorUtils;
-import org.apache.hadoop.hive.shims.ShimLoader;
 import org.apache.hadoop.io.Text;
 
 /**
@@ -110,4 +109,9 @@ public Object evaluate(DeferredObject[] arguments) throws HiveException {
     return result;
   }
 
+  @Override
+  public GenericUDF flip() {
+    return new GenericUDFOPGreaterThan();
+  }
+
 }
