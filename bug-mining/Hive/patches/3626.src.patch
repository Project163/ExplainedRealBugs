diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/SparkHashTableSinkOperator.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/SparkHashTableSinkOperator.java
index 94144a2b39..7c67fd2a94 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/SparkHashTableSinkOperator.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/SparkHashTableSinkOperator.java
@@ -141,10 +141,10 @@ protected void flushToFile(MapJoinPersistableTableContainer tableContainer,
       } catch (FileExistsException e) {
         // No problem, use a new name
       }
-      // TODO find out numOfPartitions for the big table
-      int numOfPartitions = replication;
-      replication = (short) Math.max(MIN_REPLICATION, numOfPartitions);
     }
+    // TODO find out numOfPartitions for the big table
+    int numOfPartitions = replication;
+    replication = (short) Math.max(MIN_REPLICATION, numOfPartitions);
     htsOperator.console.printInfo(Utilities.now() + "\tDump the side-table for tag: " + tag
       + " with group count: " + tableContainer.size() + " into file: " + path);
     // get the hashtable file and path
