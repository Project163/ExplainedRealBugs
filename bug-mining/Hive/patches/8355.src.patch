diff --git a/standalone-metastore/metastore-server/src/main/java/org/apache/hadoop/hive/metastore/HiveMetaStoreChecker.java b/standalone-metastore/metastore-server/src/main/java/org/apache/hadoop/hive/metastore/HiveMetaStoreChecker.java
index 5644cd8e0c..88d761dc80 100644
--- a/standalone-metastore/metastore-server/src/main/java/org/apache/hadoop/hive/metastore/HiveMetaStoreChecker.java
+++ b/standalone-metastore/metastore-server/src/main/java/org/apache/hadoop/hive/metastore/HiveMetaStoreChecker.java
@@ -28,7 +28,6 @@
 import static org.apache.hadoop.hive.metastore.utils.MetaStoreServerUtils.getPartCols;
 import static org.apache.hadoop.hive.metastore.utils.MetaStoreServerUtils.getPartitionListByFilterExp;
 import static org.apache.hadoop.hive.metastore.utils.MetaStoreServerUtils.getPartitionName;
-import static org.apache.hadoop.hive.metastore.utils.MetaStoreServerUtils.getPartitionSpec;
 import static org.apache.hadoop.hive.metastore.utils.MetaStoreServerUtils.getPartitionColtoTypeMap;
 import static org.apache.hadoop.hive.metastore.utils.MetaStoreServerUtils.getPath;
 import static org.apache.hadoop.hive.metastore.utils.MetaStoreServerUtils.isPartitioned;
@@ -57,6 +56,7 @@
 import org.apache.hadoop.fs.FileSystem;
 import org.apache.hadoop.fs.Path;
 import org.apache.hadoop.fs.PathFilter;
+import org.apache.hadoop.fs.RemoteIterator;
 import org.apache.hadoop.hive.metastore.api.FieldSchema;
 import org.apache.hadoop.hive.metastore.api.MetaException;
 import org.apache.hadoop.hive.metastore.api.MetastoreException;
@@ -67,6 +67,7 @@
 import org.apache.hadoop.hive.metastore.conf.MetastoreConf;
 import org.apache.hadoop.hive.metastore.txn.TxnUtils;
 import org.apache.hadoop.hive.metastore.utils.FileUtils;
+import org.apache.hadoop.util.functional.RemoteIterators;
 import org.apache.thrift.TException;
 import org.slf4j.Logger;
 import org.slf4j.LoggerFactory;
@@ -585,10 +586,16 @@ private Path processPathDepthInfo(final PathDepthInfo pd)
       if (currentDepth == partColNames.size()) {
         return currentPath;
       }
-      FileStatus[] fileStatuses = fs.listStatus(currentPath, FileUtils.HIDDEN_FILES_PATH_FILTER);
+      List<FileStatus> fileStatuses = new ArrayList<>();
+      RemoteIterator<FileStatus> fileIterator =
+          RemoteIterators.filteringRemoteIterator(fs.listStatusIterator(currentPath),
+            fileStatus -> HIDDEN_FILES_PATH_FILTER.accept(fileStatus.getPath()));
+      while (fileIterator.hasNext()) {
+        fileStatuses.add(fileIterator.next());
+      }
       // found no files under a sub-directory under table base path; it is possible that the table
       // is empty and hence there are no partition sub-directories created under base path
-      if (fileStatuses.length == 0 && currentDepth > 0) {
+      if (fileStatuses.size() == 0 && currentDepth > 0) {
         // since maxDepth is not yet reached, we are missing partition
         // columns in currentPath
         logOrThrowExceptionWithMsg(
diff --git a/standalone-metastore/metastore-server/src/test/java/org/apache/hadoop/hive/metastore/TestMsckCheckPartitions.java b/standalone-metastore/metastore-server/src/test/java/org/apache/hadoop/hive/metastore/TestMsckCheckPartitions.java
index fdfc582603..5487bd7f0f 100644
--- a/standalone-metastore/metastore-server/src/test/java/org/apache/hadoop/hive/metastore/TestMsckCheckPartitions.java
+++ b/standalone-metastore/metastore-server/src/test/java/org/apache/hadoop/hive/metastore/TestMsckCheckPartitions.java
@@ -22,11 +22,10 @@
 import org.apache.hadoop.fs.FileStatus;
 import org.apache.hadoop.fs.LocalFileSystem;
 import org.apache.hadoop.fs.Path;
-import org.apache.hadoop.fs.PathFilter;
+import org.apache.hadoop.fs.RemoteIterator;
 import org.apache.hadoop.hive.metastore.annotation.MetastoreUnitTest;
 import org.apache.hadoop.hive.metastore.api.MetastoreException;
 import org.apache.hadoop.hive.metastore.conf.MetastoreConf;
-import org.apache.hadoop.hive.metastore.utils.FileUtils;
 import org.junit.Assert;
 import org.junit.Test;
 import org.junit.experimental.categories.Category;
@@ -79,28 +78,27 @@ public void testNumberOfListStatusCalls() throws IOException, MetastoreException
 
     //level 1 listing
     FileStatus[] allCountries = getMockFileStatus(countryUS, countryIND);
-    when(mockFs.listStatus(tableLocation, FileUtils.HIDDEN_FILES_PATH_FILTER))
-        .thenReturn(allCountries);
+    mockListStatusIterator(mockFs, tableLocation, allCountries);
 
     //level 2 listing
     FileStatus[] filesInUS = getMockFileStatus(cityPA, citySF);
-    when(mockFs.listStatus(countryUS, FileUtils.HIDDEN_FILES_PATH_FILTER)).thenReturn(filesInUS);
+    mockListStatusIterator(mockFs, countryUS, filesInUS);
 
     FileStatus[] filesInInd = getMockFileStatus(cityBOM, cityDEL);
-    when(mockFs.listStatus(countryIND, FileUtils.HIDDEN_FILES_PATH_FILTER)).thenReturn(filesInInd);
+    mockListStatusIterator(mockFs, countryIND, filesInInd);
 
     //level 3 listing
     FileStatus[] paFiles = getMockFileStatus(paData);
-    when(mockFs.listStatus(cityPA, FileUtils.HIDDEN_FILES_PATH_FILTER)).thenReturn(paFiles);
+    mockListStatusIterator(mockFs, cityPA, paFiles);
 
     FileStatus[] sfFiles = getMockFileStatus(sfData);
-    when(mockFs.listStatus(citySF, FileUtils.HIDDEN_FILES_PATH_FILTER)).thenReturn(sfFiles);
+    mockListStatusIterator(mockFs, citySF, sfFiles);
 
     FileStatus[] bomFiles = getMockFileStatus(bomData);
-    when(mockFs.listStatus(cityBOM, FileUtils.HIDDEN_FILES_PATH_FILTER)).thenReturn(bomFiles);
+    mockListStatusIterator(mockFs, cityBOM, bomFiles);
 
     FileStatus[] delFiles = getMockFileStatus(delData);
-    when(mockFs.listStatus(cityDEL, FileUtils.HIDDEN_FILES_PATH_FILTER)).thenReturn(delFiles);
+    mockListStatusIterator(mockFs, cityDEL, delFiles);
 
     HiveMetaStoreChecker checker = new HiveMetaStoreChecker(Mockito.mock(IMetaStoreClient.class),
         MetastoreConf.newMetastoreConf());
@@ -112,10 +110,26 @@ public void testNumberOfListStatusCalls() throws IOException, MetastoreException
     // must be equal
     // to (numDirsAtLevel1) + (numDirsAtLevel2) + ... + (numDirAtLeveln-1)
     // in this case it should 1 (table level) + 2 (US, IND)
-    verify(mockFs, times(3)).listStatus(any(Path.class), any(PathFilter.class));
+    verify(mockFs, times(3)).listStatusIterator(any(Path.class));
     Assert.assertEquals("msck should have found 4 unknown partitions", 4, result.size());
   }
 
+  private void mockListStatusIterator(LocalFileSystem mockFs, Path location,
+      FileStatus[] fileStatuses) throws IOException {
+    when(mockFs.listStatusIterator(location)).thenReturn(
+      new RemoteIterator<FileStatus>() {
+        private int i = 0;
+        @Override
+        public boolean hasNext() throws IOException {
+          return this.i < fileStatuses.length;
+        }
+        @Override
+        public FileStatus next() throws IOException {
+          return fileStatuses[this.i++];
+        }
+      });
+  }
+
   private FileStatus[] getMockFileStatus(Path... paths) throws IOException {
     FileStatus[] result = new FileStatus[paths.length];
     int i = 0;
