diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/ScriptOperator.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/ScriptOperator.java
index aec5fca6ab..aa5d0bf11a 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/ScriptOperator.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/ScriptOperator.java
@@ -574,11 +574,18 @@ public void run() {
           if (in != null) {
             in.close();
           }
-          proc.close();
         } catch (Exception e) {
           LOG.warn(name + ": error in closing ..");
           LOG.warn(StringUtils.stringifyException(e));
         }
+        try
+        {
+          if (null != proc) {
+            proc.close();
+          }
+        }catch (Exception e) {
+          LOG.warn(": error in closing .."+StringUtils.stringifyException(e));
+        }
       }
     }
   }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/Utilities.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/Utilities.java
index c0dacc1525..aa0a05fe6b 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/Utilities.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/Utilities.java
@@ -386,14 +386,20 @@ public static ExprNodeDesc deserializeExpression(String s, Configuration conf) {
    * Serialize a single Task.
    */
   public static void serializeTasks(Task<? extends Serializable> t, OutputStream out) {
-    XMLEncoder e = new XMLEncoder(out);
-    // workaround for java 1.5
-    e.setPersistenceDelegate(ExpressionTypes.class, new EnumDelegate());
-    e.setPersistenceDelegate(GroupByDesc.Mode.class, new EnumDelegate());
-    e.setPersistenceDelegate(Operator.ProgressCounter.class, new EnumDelegate());
-
-    e.writeObject(t);
-    e.close();
+    XMLEncoder e = null;
+    try {
+      e = new XMLEncoder(out);
+      // workaround for java 1.5
+      e.setPersistenceDelegate(ExpressionTypes.class, new EnumDelegate());
+      e.setPersistenceDelegate(GroupByDesc.Mode.class, new EnumDelegate());
+      e.setPersistenceDelegate(Operator.ProgressCounter.class, new EnumDelegate());
+
+      e.writeObject(t);
+    }finally {
+      if(null != e){
+        e.close();
+      }
+    }
   }
 
   public static class CollectionPersistenceDelegate extends DefaultPersistenceDelegate {
