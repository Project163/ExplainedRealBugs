diff --git a/ql/src/java/org/apache/hadoop/hive/llap/LlapOutputFormat.java b/ql/src/java/org/apache/hadoop/hive/llap/LlapOutputFormat.java
index beb0e2b26d..5452c38863 100644
--- a/ql/src/java/org/apache/hadoop/hive/llap/LlapOutputFormat.java
+++ b/ql/src/java/org/apache/hadoop/hive/llap/LlapOutputFormat.java
@@ -31,11 +31,12 @@
 import org.apache.hadoop.security.token.TokenIdentifier;
 import org.apache.hadoop.util.Progressable;
 import org.apache.hadoop.hive.llap.io.api.LlapProxy;
+import org.apache.hadoop.hive.ql.io.StreamingOutputFormat;
 
 import com.google.common.base.Preconditions;
 
 public class LlapOutputFormat<K extends Writable, V extends Writable>
-  implements OutputFormat<K, V> {
+  implements OutputFormat<K, V>, StreamingOutputFormat {
 
   public static final String LLAP_OF_ID_KEY = "llap.of.id";
 
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/FileSinkOperator.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/FileSinkOperator.java
index 1f958858b5..e154d1333c 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/FileSinkOperator.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/FileSinkOperator.java
@@ -49,6 +49,7 @@
 import org.apache.hadoop.hive.ql.io.HivePartitioner;
 import org.apache.hadoop.hive.ql.io.RecordUpdater;
 import org.apache.hadoop.hive.ql.io.StatsProvidingRecordWriter;
+import org.apache.hadoop.hive.ql.io.StreamingOutputFormat;
 import org.apache.hadoop.hive.ql.metadata.HiveException;
 import org.apache.hadoop.hive.ql.metadata.HiveFatalException;
 import org.apache.hadoop.hive.ql.plan.DynamicPartitionCtx;
@@ -146,7 +147,7 @@ public class FSPaths implements Cloneable {
     Path taskOutputTempPath;
     Path[] outPaths;
     Path[] finalPaths;
-    RecordWriter[] outWriters;
+    RecordWriter[] outWriters; // TODO# this
     RecordUpdater[] updaters;
     Stat stat;
     int acidLastBucket = -1;
@@ -183,14 +184,6 @@ public Path getFinalPath(String taskId, Path tmpPath, String extension) {
       }
     }
 
-    public void setOutWriters(RecordWriter[] out) {
-      outWriters = out;
-    }
-
-    public RecordWriter[] getOutWriters() {
-      return outWriters;
-    }
-
     public void closeWriters(boolean abort) throws HiveException {
       for (int idx = 0; idx < outWriters.length; idx++) {
         if (outWriters[idx] != null) {
@@ -1012,8 +1005,16 @@ public void closeOp(boolean abort) throws HiveException {
     row_count.set(numRows);
     LOG.info(toString() + ": records written - " + numRows);
 
-    if (!bDynParts && !filesCreated && !"tez".equalsIgnoreCase(hconf.get(ConfVars.HIVE_EXECUTION_ENGINE.varname))) {
-      createBucketFiles(fsp);
+    if (!bDynParts && !filesCreated) {
+      boolean skipFiles = "tez".equalsIgnoreCase(
+          HiveConf.getVar(hconf, ConfVars.HIVE_EXECUTION_ENGINE));
+      if (skipFiles) {
+        Class<?> clazz = conf.getTableInfo().getOutputFileFormatClass();
+        skipFiles = !StreamingOutputFormat.class.isAssignableFrom(clazz);
+      }
+      if (!skipFiles) {
+        createBucketFiles(fsp);
+      }
     }
 
     lastProgressReport = System.currentTimeMillis();
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/io/StreamingOutputFormat.java b/ql/src/java/org/apache/hadoop/hive/ql/io/StreamingOutputFormat.java
new file mode 100644
index 0000000000..bdc80cc26d
--- /dev/null
+++ b/ql/src/java/org/apache/hadoop/hive/ql/io/StreamingOutputFormat.java
@@ -0,0 +1,25 @@
+/**
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.apache.hadoop.hive.ql.io;
+
+/**
+ * Marker interface for streaming output formats. For now, this is used to out out of the
+ * optimizations that do not output empty results to avoid empty files.
+ */
+public interface StreamingOutputFormat {
+}
