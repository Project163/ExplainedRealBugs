diff --git a/ql/src/test/results/clientnegative/udf_assert_true.q.out b/ql/src/test/results/clientnegative/udf_assert_true.q.out
index 819d723c1a..6b99d4427b 100644
--- a/ql/src/test/results/clientnegative/udf_assert_true.q.out
+++ b/ql/src/test/results/clientnegative/udf_assert_true.q.out
@@ -21,10 +21,10 @@ STAGE PLANS:
             Lateral View Forward
               Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: COMPLETE
               Select Operator
-                Statistics: Num rows: 500 Data size: 0 Basic stats: PARTIAL Column stats: COMPLETE
+                Statistics: Num rows: 500 Data size: 172000 Basic stats: COMPLETE Column stats: COMPLETE
                 Lateral View Join Operator
                   outputColumnNames: _col5
-                  Statistics: Num rows: 1000 Data size: 24000 Basic stats: COMPLETE Column stats: COMPLETE
+                  Statistics: Num rows: 1000 Data size: 196000 Basic stats: COMPLETE Column stats: COMPLETE
                   Select Operator
                     expressions: assert_true((_col5 > 0)) (type: void)
                     outputColumnNames: _col0
@@ -48,7 +48,7 @@ STAGE PLANS:
                   function name: explode
                   Lateral View Join Operator
                     outputColumnNames: _col5
-                    Statistics: Num rows: 1000 Data size: 24000 Basic stats: COMPLETE Column stats: COMPLETE
+                    Statistics: Num rows: 1000 Data size: 196000 Basic stats: COMPLETE Column stats: COMPLETE
                     Select Operator
                       expressions: assert_true((_col5 > 0)) (type: void)
                       outputColumnNames: _col0
@@ -98,10 +98,10 @@ STAGE PLANS:
             Lateral View Forward
               Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: COMPLETE
               Select Operator
-                Statistics: Num rows: 500 Data size: 0 Basic stats: PARTIAL Column stats: COMPLETE
+                Statistics: Num rows: 500 Data size: 172000 Basic stats: COMPLETE Column stats: COMPLETE
                 Lateral View Join Operator
                   outputColumnNames: _col5
-                  Statistics: Num rows: 1000 Data size: 24000 Basic stats: COMPLETE Column stats: COMPLETE
+                  Statistics: Num rows: 1000 Data size: 196000 Basic stats: COMPLETE Column stats: COMPLETE
                   Select Operator
                     expressions: assert_true((_col5 < 2)) (type: void)
                     outputColumnNames: _col0
@@ -125,7 +125,7 @@ STAGE PLANS:
                   function name: explode
                   Lateral View Join Operator
                     outputColumnNames: _col5
-                    Statistics: Num rows: 1000 Data size: 24000 Basic stats: COMPLETE Column stats: COMPLETE
+                    Statistics: Num rows: 1000 Data size: 196000 Basic stats: COMPLETE Column stats: COMPLETE
                     Select Operator
                       expressions: assert_true((_col5 < 2)) (type: void)
                       outputColumnNames: _col0
diff --git a/ql/src/test/results/clientnegative/udf_assert_true2.q.out b/ql/src/test/results/clientnegative/udf_assert_true2.q.out
index 9760d0d97a..6ea38e334f 100644
--- a/ql/src/test/results/clientnegative/udf_assert_true2.q.out
+++ b/ql/src/test/results/clientnegative/udf_assert_true2.q.out
@@ -16,10 +16,10 @@ STAGE PLANS:
             Lateral View Forward
               Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: COMPLETE
               Select Operator
-                Statistics: Num rows: 500 Data size: 0 Basic stats: PARTIAL Column stats: COMPLETE
+                Statistics: Num rows: 500 Data size: 172000 Basic stats: COMPLETE Column stats: COMPLETE
                 Lateral View Join Operator
                   outputColumnNames: _col5
-                  Statistics: Num rows: 1000 Data size: 24000 Basic stats: COMPLETE Column stats: COMPLETE
+                  Statistics: Num rows: 1000 Data size: 196000 Basic stats: COMPLETE Column stats: COMPLETE
                   Select Operator
                     expressions: (1 + assert_true((_col5 < 2))) (type: double)
                     outputColumnNames: _col0
@@ -43,7 +43,7 @@ STAGE PLANS:
                   function name: explode
                   Lateral View Join Operator
                     outputColumnNames: _col5
-                    Statistics: Num rows: 1000 Data size: 24000 Basic stats: COMPLETE Column stats: COMPLETE
+                    Statistics: Num rows: 1000 Data size: 196000 Basic stats: COMPLETE Column stats: COMPLETE
                     Select Operator
                       expressions: (1 + assert_true((_col5 < 2))) (type: double)
                       outputColumnNames: _col0
diff --git a/ql/src/test/results/clientpositive/annotate_stats_groupby.q.out b/ql/src/test/results/clientpositive/annotate_stats_groupby.q.out
index b9be798f2d..82cc0da2de 100644
--- a/ql/src/test/results/clientpositive/annotate_stats_groupby.q.out
+++ b/ql/src/test/results/clientpositive/annotate_stats_groupby.q.out
@@ -378,11 +378,11 @@ STAGE PLANS:
           keys: KEY._col0 (type: string), KEY._col1 (type: int), KEY._col2 (type: string)
           mode: mergepartial
           outputColumnNames: _col0, _col1
-          Statistics: Num rows: 32 Data size: 2880 Basic stats: COMPLETE Column stats: COMPLETE
+          Statistics: Num rows: 32 Data size: 5600 Basic stats: COMPLETE Column stats: COMPLETE
           pruneGroupingSetId: true
           File Output Operator
             compressed: false
-            Statistics: Num rows: 32 Data size: 2880 Basic stats: COMPLETE Column stats: COMPLETE
+            Statistics: Num rows: 32 Data size: 5600 Basic stats: COMPLETE Column stats: COMPLETE
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -432,11 +432,11 @@ STAGE PLANS:
           keys: KEY._col0 (type: string), KEY._col1 (type: int), KEY._col2 (type: string)
           mode: mergepartial
           outputColumnNames: _col0, _col1
-          Statistics: Num rows: 24 Data size: 2160 Basic stats: COMPLETE Column stats: COMPLETE
+          Statistics: Num rows: 24 Data size: 4200 Basic stats: COMPLETE Column stats: COMPLETE
           pruneGroupingSetId: true
           File Output Operator
             compressed: false
-            Statistics: Num rows: 24 Data size: 2160 Basic stats: COMPLETE Column stats: COMPLETE
+            Statistics: Num rows: 24 Data size: 4200 Basic stats: COMPLETE Column stats: COMPLETE
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -486,11 +486,11 @@ STAGE PLANS:
           keys: KEY._col0 (type: string), KEY._col1 (type: int), KEY._col2 (type: string)
           mode: mergepartial
           outputColumnNames: _col0, _col1
-          Statistics: Num rows: 8 Data size: 720 Basic stats: COMPLETE Column stats: COMPLETE
+          Statistics: Num rows: 8 Data size: 1400 Basic stats: COMPLETE Column stats: COMPLETE
           pruneGroupingSetId: true
           File Output Operator
             compressed: false
-            Statistics: Num rows: 8 Data size: 720 Basic stats: COMPLETE Column stats: COMPLETE
+            Statistics: Num rows: 8 Data size: 1400 Basic stats: COMPLETE Column stats: COMPLETE
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -540,11 +540,11 @@ STAGE PLANS:
           keys: KEY._col0 (type: string), KEY._col1 (type: int), KEY._col2 (type: string)
           mode: mergepartial
           outputColumnNames: _col0, _col1
-          Statistics: Num rows: 16 Data size: 1440 Basic stats: COMPLETE Column stats: COMPLETE
+          Statistics: Num rows: 16 Data size: 2800 Basic stats: COMPLETE Column stats: COMPLETE
           pruneGroupingSetId: true
           File Output Operator
             compressed: false
-            Statistics: Num rows: 16 Data size: 1440 Basic stats: COMPLETE Column stats: COMPLETE
+            Statistics: Num rows: 16 Data size: 2800 Basic stats: COMPLETE Column stats: COMPLETE
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -594,11 +594,11 @@ STAGE PLANS:
           keys: KEY._col0 (type: string), KEY._col1 (type: int), KEY._col2 (type: string)
           mode: mergepartial
           outputColumnNames: _col0, _col1
-          Statistics: Num rows: 24 Data size: 2160 Basic stats: COMPLETE Column stats: COMPLETE
+          Statistics: Num rows: 24 Data size: 4200 Basic stats: COMPLETE Column stats: COMPLETE
           pruneGroupingSetId: true
           File Output Operator
             compressed: false
-            Statistics: Num rows: 24 Data size: 2160 Basic stats: COMPLETE Column stats: COMPLETE
+            Statistics: Num rows: 24 Data size: 4200 Basic stats: COMPLETE Column stats: COMPLETE
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -648,11 +648,11 @@ STAGE PLANS:
           keys: KEY._col0 (type: string), KEY._col1 (type: int), KEY._col2 (type: string)
           mode: mergepartial
           outputColumnNames: _col0, _col1
-          Statistics: Num rows: 32 Data size: 2880 Basic stats: COMPLETE Column stats: COMPLETE
+          Statistics: Num rows: 32 Data size: 5600 Basic stats: COMPLETE Column stats: COMPLETE
           pruneGroupingSetId: true
           File Output Operator
             compressed: false
-            Statistics: Num rows: 32 Data size: 2880 Basic stats: COMPLETE Column stats: COMPLETE
+            Statistics: Num rows: 32 Data size: 5600 Basic stats: COMPLETE Column stats: COMPLETE
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -759,11 +759,11 @@ STAGE PLANS:
           keys: KEY._col0 (type: string), KEY._col1 (type: int), KEY._col2 (type: string)
           mode: mergepartial
           outputColumnNames: _col0, _col1
-          Statistics: Num rows: 16 Data size: 1440 Basic stats: COMPLETE Column stats: COMPLETE
+          Statistics: Num rows: 16 Data size: 2800 Basic stats: COMPLETE Column stats: COMPLETE
           pruneGroupingSetId: true
           File Output Operator
             compressed: false
-            Statistics: Num rows: 16 Data size: 1440 Basic stats: COMPLETE Column stats: COMPLETE
+            Statistics: Num rows: 16 Data size: 2800 Basic stats: COMPLETE Column stats: COMPLETE
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/annotate_stats_groupby2.q.out b/ql/src/test/results/clientpositive/annotate_stats_groupby2.q.out
index c4293c05b8..2cb1e84672 100644
--- a/ql/src/test/results/clientpositive/annotate_stats_groupby2.q.out
+++ b/ql/src/test/results/clientpositive/annotate_stats_groupby2.q.out
@@ -327,11 +327,11 @@ STAGE PLANS:
           keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: string)
           mode: mergepartial
           outputColumnNames: _col0, _col1
-          Statistics: Num rows: 8 Data size: 1384 Basic stats: COMPLETE Column stats: COMPLETE
+          Statistics: Num rows: 8 Data size: 2064 Basic stats: COMPLETE Column stats: COMPLETE
           pruneGroupingSetId: true
           File Output Operator
             compressed: false
-            Statistics: Num rows: 8 Data size: 1384 Basic stats: COMPLETE Column stats: COMPLETE
+            Statistics: Num rows: 8 Data size: 2064 Basic stats: COMPLETE Column stats: COMPLETE
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -434,11 +434,11 @@ STAGE PLANS:
           keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: string)
           mode: mergepartial
           outputColumnNames: _col0, _col1
-          Statistics: Num rows: 8 Data size: 1384 Basic stats: COMPLETE Column stats: COMPLETE
+          Statistics: Num rows: 8 Data size: 2064 Basic stats: COMPLETE Column stats: COMPLETE
           pruneGroupingSetId: true
           File Output Operator
             compressed: false
-            Statistics: Num rows: 8 Data size: 1384 Basic stats: COMPLETE Column stats: COMPLETE
+            Statistics: Num rows: 8 Data size: 2064 Basic stats: COMPLETE Column stats: COMPLETE
             table:
                 input format: org.apache.hadoop.mapred.TextInputFormat
                 output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/annotate_stats_join_pkfk.q.out b/ql/src/test/results/clientpositive/annotate_stats_join_pkfk.q.out
index dd707080b7..c864c04240 100644
--- a/ql/src/test/results/clientpositive/annotate_stats_join_pkfk.q.out
+++ b/ql/src/test/results/clientpositive/annotate_stats_join_pkfk.q.out
@@ -419,12 +419,12 @@ STAGE PLANS:
               Select Operator
                 expressions: ss_store_sk (type: int)
                 outputColumnNames: _col0
-                Statistics: Num rows: 321 Data size: 1236 Basic stats: COMPLETE Column stats: COMPLETE
+                Statistics: Num rows: 321 Data size: 2460 Basic stats: COMPLETE Column stats: COMPLETE
                 Reduce Output Operator
                   key expressions: _col0 (type: int)
                   sort order: +
                   Map-reduce partition columns: _col0 (type: int)
-                  Statistics: Num rows: 321 Data size: 1236 Basic stats: COMPLETE Column stats: COMPLETE
+                  Statistics: Num rows: 321 Data size: 2460 Basic stats: COMPLETE Column stats: COMPLETE
           TableScan
             alias: s
             Statistics: Num rows: 12 Data size: 3143 Basic stats: COMPLETE Column stats: PARTIAL
@@ -503,12 +503,12 @@ STAGE PLANS:
               Select Operator
                 expressions: s_store_sk (type: int)
                 outputColumnNames: _col0
-                Statistics: Num rows: 4 Data size: 16 Basic stats: COMPLETE Column stats: COMPLETE
+                Statistics: Num rows: 4 Data size: 32 Basic stats: COMPLETE Column stats: COMPLETE
                 Reduce Output Operator
                   key expressions: _col0 (type: int)
                   sort order: +
                   Map-reduce partition columns: _col0 (type: int)
-                  Statistics: Num rows: 4 Data size: 16 Basic stats: COMPLETE Column stats: COMPLETE
+                  Statistics: Num rows: 4 Data size: 32 Basic stats: COMPLETE Column stats: COMPLETE
       Reduce Operator Tree:
         Join Operator
           condition map:
@@ -557,12 +557,12 @@ STAGE PLANS:
               Select Operator
                 expressions: ss_store_sk (type: int)
                 outputColumnNames: _col0
-                Statistics: Num rows: 321 Data size: 1236 Basic stats: COMPLETE Column stats: COMPLETE
+                Statistics: Num rows: 321 Data size: 2460 Basic stats: COMPLETE Column stats: COMPLETE
                 Reduce Output Operator
                   key expressions: _col0 (type: int)
                   sort order: +
                   Map-reduce partition columns: _col0 (type: int)
-                  Statistics: Num rows: 321 Data size: 1236 Basic stats: COMPLETE Column stats: COMPLETE
+                  Statistics: Num rows: 321 Data size: 2460 Basic stats: COMPLETE Column stats: COMPLETE
           TableScan
             alias: s
             Statistics: Num rows: 12 Data size: 3143 Basic stats: COMPLETE Column stats: COMPLETE
@@ -813,12 +813,12 @@ STAGE PLANS:
               Select Operator
                 expressions: s_store_sk (type: int)
                 outputColumnNames: _col0
-                Statistics: Num rows: 4 Data size: 16 Basic stats: COMPLETE Column stats: COMPLETE
+                Statistics: Num rows: 4 Data size: 32 Basic stats: COMPLETE Column stats: COMPLETE
                 Reduce Output Operator
                   key expressions: _col0 (type: int)
                   sort order: +
                   Map-reduce partition columns: _col0 (type: int)
-                  Statistics: Num rows: 4 Data size: 16 Basic stats: COMPLETE Column stats: COMPLETE
+                  Statistics: Num rows: 4 Data size: 32 Basic stats: COMPLETE Column stats: COMPLETE
           TableScan
             alias: s
             Statistics: Num rows: 12 Data size: 3143 Basic stats: COMPLETE Column stats: COMPLETE
@@ -884,12 +884,12 @@ STAGE PLANS:
               Select Operator
                 expressions: ss_store_sk (type: int)
                 outputColumnNames: _col0
-                Statistics: Num rows: 321 Data size: 1236 Basic stats: COMPLETE Column stats: COMPLETE
+                Statistics: Num rows: 321 Data size: 2460 Basic stats: COMPLETE Column stats: COMPLETE
                 Reduce Output Operator
                   key expressions: _col0 (type: int)
                   sort order: +
                   Map-reduce partition columns: _col0 (type: int)
-                  Statistics: Num rows: 321 Data size: 1236 Basic stats: COMPLETE Column stats: COMPLETE
+                  Statistics: Num rows: 321 Data size: 2460 Basic stats: COMPLETE Column stats: COMPLETE
           TableScan
             alias: s
             Statistics: Num rows: 12 Data size: 3143 Basic stats: COMPLETE Column stats: COMPLETE
diff --git a/ql/src/test/results/clientpositive/spark/ql_rewrite_gbtoidx.q.out b/ql/src/test/results/clientpositive/spark/ql_rewrite_gbtoidx.q.out
index 9d0b3c95da..883dce656a 100644
--- a/ql/src/test/results/clientpositive/spark/ql_rewrite_gbtoidx.q.out
+++ b/ql/src/test/results/clientpositive/spark/ql_rewrite_gbtoidx.q.out
@@ -87,7 +87,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 2)
+        Reducer 2 <- Map 1 (GROUP, 4)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -258,29 +258,29 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 2)
+        Reducer 2 <- Map 1 (GROUP, 4)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
             Map Operator Tree:
                 TableScan
                   alias: default__lineitem_ix_lineitem_ix_lshipdate_idx__
-                  Statistics: Num rows: 95 Data size: 12665 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 95 Data size: 8960 Basic stats: COMPLETE Column stats: NONE
                   Select Operator
                     expressions: l_shipdate (type: string), _count_of_l_shipdate (type: bigint)
                     outputColumnNames: l_shipdate, _count_of_l_shipdate
-                    Statistics: Num rows: 95 Data size: 12665 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 95 Data size: 8960 Basic stats: COMPLETE Column stats: NONE
                     Group By Operator
                       aggregations: sum(_count_of_l_shipdate)
                       keys: l_shipdate (type: string)
                       mode: hash
                       outputColumnNames: _col0, _col1
-                      Statistics: Num rows: 95 Data size: 12665 Basic stats: COMPLETE Column stats: NONE
+                      Statistics: Num rows: 95 Data size: 8960 Basic stats: COMPLETE Column stats: NONE
                       Reduce Output Operator
                         key expressions: _col0 (type: string)
                         sort order: +
                         Map-reduce partition columns: _col0 (type: string)
-                        Statistics: Num rows: 95 Data size: 12665 Basic stats: COMPLETE Column stats: NONE
+                        Statistics: Num rows: 95 Data size: 8960 Basic stats: COMPLETE Column stats: NONE
                         value expressions: _col1 (type: bigint)
         Reducer 2 
             Reduce Operator Tree:
@@ -289,10 +289,10 @@ STAGE PLANS:
                 keys: KEY._col0 (type: string)
                 mode: mergepartial
                 outputColumnNames: _col0, _col1
-                Statistics: Num rows: 47 Data size: 6265 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 47 Data size: 4432 Basic stats: COMPLETE Column stats: NONE
                 File Output Operator
                   compressed: false
-                  Statistics: Num rows: 47 Data size: 6265 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 47 Data size: 4432 Basic stats: COMPLETE Column stats: NONE
                   table:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -437,7 +437,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 2)
+        Reducer 2 <- Map 1 (GROUP, 4)
         Reducer 3 <- Reducer 2 (SORT, 1)
 #### A masked pattern was here ####
       Vertices:
@@ -578,7 +578,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 2)
+        Reducer 2 <- Map 1 (GROUP, 4)
         Reducer 3 <- Reducer 2 (SORT, 1)
 #### A masked pattern was here ####
       Vertices:
@@ -586,22 +586,22 @@ STAGE PLANS:
             Map Operator Tree:
                 TableScan
                   alias: default__lineitem_ix_lineitem_ix_lshipdate_idx__
-                  Statistics: Num rows: 95 Data size: 12665 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 95 Data size: 8960 Basic stats: COMPLETE Column stats: NONE
                   Select Operator
                     expressions: l_shipdate (type: string), _count_of_l_shipdate (type: bigint)
                     outputColumnNames: l_shipdate, _count_of_l_shipdate
-                    Statistics: Num rows: 95 Data size: 12665 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 95 Data size: 8960 Basic stats: COMPLETE Column stats: NONE
                     Group By Operator
                       aggregations: sum(_count_of_l_shipdate)
                       keys: year(l_shipdate) (type: int), month(l_shipdate) (type: int)
                       mode: hash
                       outputColumnNames: _col0, _col1, _col2
-                      Statistics: Num rows: 95 Data size: 12665 Basic stats: COMPLETE Column stats: NONE
+                      Statistics: Num rows: 95 Data size: 8960 Basic stats: COMPLETE Column stats: NONE
                       Reduce Output Operator
                         key expressions: _col0 (type: int), _col1 (type: int)
                         sort order: ++
                         Map-reduce partition columns: _col0 (type: int), _col1 (type: int)
-                        Statistics: Num rows: 95 Data size: 12665 Basic stats: COMPLETE Column stats: NONE
+                        Statistics: Num rows: 95 Data size: 8960 Basic stats: COMPLETE Column stats: NONE
                         value expressions: _col2 (type: bigint)
         Reducer 2 
             Reduce Operator Tree:
@@ -610,21 +610,21 @@ STAGE PLANS:
                 keys: KEY._col0 (type: int), KEY._col1 (type: int)
                 mode: mergepartial
                 outputColumnNames: _col0, _col1, _col2
-                Statistics: Num rows: 47 Data size: 6265 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 47 Data size: 4432 Basic stats: COMPLETE Column stats: NONE
                 Reduce Output Operator
                   key expressions: _col0 (type: int), _col1 (type: int)
                   sort order: ++
-                  Statistics: Num rows: 47 Data size: 6265 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 47 Data size: 4432 Basic stats: COMPLETE Column stats: NONE
                   value expressions: _col2 (type: bigint)
         Reducer 3 
             Reduce Operator Tree:
               Select Operator
                 expressions: KEY.reducesinkkey0 (type: int), KEY.reducesinkkey1 (type: int), VALUE._col0 (type: bigint)
                 outputColumnNames: _col0, _col1, _col2
-                Statistics: Num rows: 47 Data size: 6265 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 47 Data size: 4432 Basic stats: COMPLETE Column stats: NONE
                 File Output Operator
                   compressed: false
-                  Statistics: Num rows: 47 Data size: 6265 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 47 Data size: 4432 Basic stats: COMPLETE Column stats: NONE
                   table:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -747,64 +747,64 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 2)
-        Reducer 5 <- Map 4 (GROUP, 2)
-        Reducer 3 <- Reducer 2 (PARTITION-LEVEL SORT, 2), Reducer 5 (PARTITION-LEVEL SORT, 2)
+        Reducer 2 <- Map 1 (GROUP, 4)
+        Reducer 5 <- Map 4 (GROUP, 4)
+        Reducer 3 <- Reducer 2 (PARTITION-LEVEL SORT, 4), Reducer 5 (PARTITION-LEVEL SORT, 4)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
             Map Operator Tree:
                 TableScan
                   alias: lastyear:default__lineitem_ix_lineitem_ix_lshipdate_idx__
-                  Statistics: Num rows: 95 Data size: 12665 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 95 Data size: 8960 Basic stats: COMPLETE Column stats: NONE
                   Filter Operator
                     predicate: (year(l_shipdate) = 1997) (type: boolean)
-                    Statistics: Num rows: 47 Data size: 6265 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 47 Data size: 4432 Basic stats: COMPLETE Column stats: NONE
                     Select Operator
                       expressions: l_shipdate (type: string), _count_of_l_shipdate (type: bigint)
                       outputColumnNames: l_shipdate, _count_of_l_shipdate
-                      Statistics: Num rows: 47 Data size: 6265 Basic stats: COMPLETE Column stats: NONE
+                      Statistics: Num rows: 47 Data size: 4432 Basic stats: COMPLETE Column stats: NONE
                       Group By Operator
                         aggregations: sum(_count_of_l_shipdate)
                         keys: year(l_shipdate) (type: int), month(l_shipdate) (type: int)
                         mode: hash
                         outputColumnNames: _col0, _col1, _col2
-                        Statistics: Num rows: 47 Data size: 6265 Basic stats: COMPLETE Column stats: NONE
+                        Statistics: Num rows: 47 Data size: 4432 Basic stats: COMPLETE Column stats: NONE
                         Filter Operator
                           predicate: _col1 is not null (type: boolean)
-                          Statistics: Num rows: 24 Data size: 3199 Basic stats: COMPLETE Column stats: NONE
+                          Statistics: Num rows: 24 Data size: 2263 Basic stats: COMPLETE Column stats: NONE
                           Reduce Output Operator
                             key expressions: _col0 (type: int), _col1 (type: int)
                             sort order: ++
                             Map-reduce partition columns: _col0 (type: int), _col1 (type: int)
-                            Statistics: Num rows: 24 Data size: 3199 Basic stats: COMPLETE Column stats: NONE
+                            Statistics: Num rows: 24 Data size: 2263 Basic stats: COMPLETE Column stats: NONE
                             value expressions: _col2 (type: bigint)
         Map 4 
             Map Operator Tree:
                 TableScan
                   alias: thisyear:default__lineitem_ix_lineitem_ix_lshipdate_idx__
-                  Statistics: Num rows: 95 Data size: 12665 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 95 Data size: 8960 Basic stats: COMPLETE Column stats: NONE
                   Filter Operator
                     predicate: (year(l_shipdate) = 1998) (type: boolean)
-                    Statistics: Num rows: 47 Data size: 6265 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 47 Data size: 4432 Basic stats: COMPLETE Column stats: NONE
                     Select Operator
                       expressions: l_shipdate (type: string), _count_of_l_shipdate (type: bigint)
                       outputColumnNames: l_shipdate, _count_of_l_shipdate
-                      Statistics: Num rows: 47 Data size: 6265 Basic stats: COMPLETE Column stats: NONE
+                      Statistics: Num rows: 47 Data size: 4432 Basic stats: COMPLETE Column stats: NONE
                       Group By Operator
                         aggregations: sum(_count_of_l_shipdate)
                         keys: year(l_shipdate) (type: int), month(l_shipdate) (type: int)
                         mode: hash
                         outputColumnNames: _col0, _col1, _col2
-                        Statistics: Num rows: 47 Data size: 6265 Basic stats: COMPLETE Column stats: NONE
+                        Statistics: Num rows: 47 Data size: 4432 Basic stats: COMPLETE Column stats: NONE
                         Filter Operator
                           predicate: _col1 is not null (type: boolean)
-                          Statistics: Num rows: 24 Data size: 3199 Basic stats: COMPLETE Column stats: NONE
+                          Statistics: Num rows: 24 Data size: 2263 Basic stats: COMPLETE Column stats: NONE
                           Reduce Output Operator
                             key expressions: _col0 (type: int), _col1 (type: int)
                             sort order: ++
                             Map-reduce partition columns: _col0 (type: int), _col1 (type: int)
-                            Statistics: Num rows: 24 Data size: 3199 Basic stats: COMPLETE Column stats: NONE
+                            Statistics: Num rows: 24 Data size: 2263 Basic stats: COMPLETE Column stats: NONE
                             value expressions: _col2 (type: bigint)
         Reducer 2 
             Reduce Operator Tree:
@@ -813,16 +813,16 @@ STAGE PLANS:
                 keys: KEY._col0 (type: int), KEY._col1 (type: int)
                 mode: mergepartial
                 outputColumnNames: _col0, _col1, _col2
-                Statistics: Num rows: 12 Data size: 1599 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 12 Data size: 1131 Basic stats: COMPLETE Column stats: NONE
                 Select Operator
                   expressions: _col1 (type: int), _col2 (type: bigint)
                   outputColumnNames: _col1, _col2
-                  Statistics: Num rows: 12 Data size: 1599 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 12 Data size: 1131 Basic stats: COMPLETE Column stats: NONE
                   Reduce Output Operator
                     key expressions: _col1 (type: int)
                     sort order: +
                     Map-reduce partition columns: _col1 (type: int)
-                    Statistics: Num rows: 12 Data size: 1599 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 12 Data size: 1131 Basic stats: COMPLETE Column stats: NONE
                     value expressions: _col2 (type: bigint)
         Reducer 3 
             Reduce Operator Tree:
@@ -833,14 +833,14 @@ STAGE PLANS:
                   0 _col1 (type: int)
                   1 _col1 (type: int)
                 outputColumnNames: _col1, _col2, _col4, _col5
-                Statistics: Num rows: 13 Data size: 1758 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 13 Data size: 1244 Basic stats: COMPLETE Column stats: NONE
                 Select Operator
                   expressions: _col1 (type: int), _col4 (type: int), ((_col5 - _col2) / _col2) (type: double)
                   outputColumnNames: _col0, _col1, _col2
-                  Statistics: Num rows: 13 Data size: 1758 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 13 Data size: 1244 Basic stats: COMPLETE Column stats: NONE
                   File Output Operator
                     compressed: false
-                    Statistics: Num rows: 13 Data size: 1758 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 13 Data size: 1244 Basic stats: COMPLETE Column stats: NONE
                     table:
                         input format: org.apache.hadoop.mapred.TextInputFormat
                         output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -852,16 +852,16 @@ STAGE PLANS:
                 keys: KEY._col0 (type: int), KEY._col1 (type: int)
                 mode: mergepartial
                 outputColumnNames: _col0, _col1, _col2
-                Statistics: Num rows: 12 Data size: 1599 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 12 Data size: 1131 Basic stats: COMPLETE Column stats: NONE
                 Select Operator
                   expressions: _col1 (type: int), _col2 (type: bigint)
                   outputColumnNames: _col1, _col2
-                  Statistics: Num rows: 12 Data size: 1599 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 12 Data size: 1131 Basic stats: COMPLETE Column stats: NONE
                   Reduce Output Operator
                     key expressions: _col1 (type: int)
                     sort order: +
                     Map-reduce partition columns: _col1 (type: int)
-                    Statistics: Num rows: 12 Data size: 1599 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 12 Data size: 1131 Basic stats: COMPLETE Column stats: NONE
                     value expressions: _col2 (type: bigint)
 
   Stage: Stage-0
@@ -890,7 +890,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 3 <- Map 2 (GROUP, 2)
+        Reducer 3 <- Map 2 (GROUP, 4)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -904,7 +904,7 @@ STAGE PLANS:
                     Statistics: Num rows: 116 Data size: 12099 Basic stats: COMPLETE Column stats: NONE
                     File Output Operator
                       compressed: false
-                      Statistics: Num rows: 163 Data size: 18364 Basic stats: COMPLETE Column stats: NONE
+                      Statistics: Num rows: 163 Data size: 16531 Basic stats: COMPLETE Column stats: NONE
                       table:
                           input format: org.apache.hadoop.mapred.TextInputFormat
                           output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -913,22 +913,22 @@ STAGE PLANS:
             Map Operator Tree:
                 TableScan
                   alias: null-subquery1:dummy-subquery1:default__lineitem_ix_lineitem_ix_lshipdate_idx__
-                  Statistics: Num rows: 95 Data size: 12665 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 95 Data size: 8960 Basic stats: COMPLETE Column stats: NONE
                   Select Operator
                     expressions: l_shipdate (type: string), _count_of_l_shipdate (type: bigint)
                     outputColumnNames: l_shipdate, _count_of_l_shipdate
-                    Statistics: Num rows: 95 Data size: 12665 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 95 Data size: 8960 Basic stats: COMPLETE Column stats: NONE
                     Group By Operator
                       aggregations: sum(_count_of_l_shipdate)
                       keys: l_shipdate (type: string)
                       mode: hash
                       outputColumnNames: _col0, _col1
-                      Statistics: Num rows: 95 Data size: 12665 Basic stats: COMPLETE Column stats: NONE
+                      Statistics: Num rows: 95 Data size: 8960 Basic stats: COMPLETE Column stats: NONE
                       Reduce Output Operator
                         key expressions: _col0 (type: string)
                         sort order: +
                         Map-reduce partition columns: _col0 (type: string)
-                        Statistics: Num rows: 95 Data size: 12665 Basic stats: COMPLETE Column stats: NONE
+                        Statistics: Num rows: 95 Data size: 8960 Basic stats: COMPLETE Column stats: NONE
                         value expressions: _col1 (type: bigint)
         Reducer 3 
             Reduce Operator Tree:
@@ -937,10 +937,10 @@ STAGE PLANS:
                 keys: KEY._col0 (type: string)
                 mode: mergepartial
                 outputColumnNames: _col0, _col1
-                Statistics: Num rows: 47 Data size: 6265 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 47 Data size: 4432 Basic stats: COMPLETE Column stats: NONE
                 File Output Operator
                   compressed: false
-                  Statistics: Num rows: 163 Data size: 18364 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 163 Data size: 16531 Basic stats: COMPLETE Column stats: NONE
                   table:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -991,7 +991,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 2)
+        Reducer 2 <- Map 1 (GROUP, 4)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -1052,7 +1052,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 2)
+        Reducer 2 <- Map 1 (GROUP, 4)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -1216,7 +1216,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 2)
+        Reducer 2 <- Map 1 (GROUP, 4)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -1271,7 +1271,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 2)
+        Reducer 2 <- Map 1 (GROUP, 4)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -1330,7 +1330,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 2)
+        Reducer 2 <- Map 1 (GROUP, 4)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -1388,7 +1388,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 2)
+        Reducer 2 <- Map 1 (GROUP, 4)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -1446,7 +1446,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 2)
+        Reducer 2 <- Map 1 (GROUP, 4)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -1505,7 +1505,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 2)
+        Reducer 2 <- Map 1 (GROUP, 4)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -1564,7 +1564,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 2)
+        Reducer 2 <- Map 1 (GROUP, 4)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -1622,7 +1622,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 2)
+        Reducer 2 <- Map 1 (GROUP, 4)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -1677,7 +1677,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 2)
+        Reducer 2 <- Map 1 (GROUP, 4)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -1732,7 +1732,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 2)
+        Reducer 2 <- Map 1 (GROUP, 4)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -1787,7 +1787,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 2)
+        Reducer 2 <- Map 1 (GROUP, 4)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -1842,7 +1842,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 2)
+        Reducer 2 <- Map 1 (GROUP, 4)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -1900,7 +1900,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 2)
+        Reducer 2 <- Map 1 (GROUP, 4)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -1958,7 +1958,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 2)
+        Reducer 2 <- Map 1 (GROUP, 4)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -2012,7 +2012,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 2)
+        Reducer 2 <- Map 1 (GROUP, 4)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -2066,7 +2066,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 2)
+        Reducer 2 <- Map 1 (GROUP, 4)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -2121,7 +2121,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 2)
+        Reducer 2 <- Map 1 (GROUP, 4)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -2268,7 +2268,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 2)
+        Reducer 2 <- Map 1 (GROUP, 4)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -2367,7 +2367,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 2)
+        Reducer 2 <- Map 1 (GROUP, 4)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -2477,7 +2477,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 2)
+        Reducer 2 <- Map 1 (GROUP, 4)
         Reducer 3 <- Reducer 2 (SORT, 1)
 #### A masked pattern was here ####
       Vertices:
@@ -2561,7 +2561,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 2)
+        Reducer 2 <- Map 1 (GROUP, 4)
         Reducer 3 <- Reducer 2 (SORT, 1)
 #### A masked pattern was here ####
       Vertices:
@@ -2569,22 +2569,22 @@ STAGE PLANS:
             Map Operator Tree:
                 TableScan
                   alias: default__tbl_tbl_key_idx__
-                  Statistics: Num rows: 6 Data size: 664 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 6 Data size: 430 Basic stats: COMPLETE Column stats: NONE
                   Select Operator
                     expressions: key (type: int), _count_of_key (type: bigint)
                     outputColumnNames: key, _count_of_key
-                    Statistics: Num rows: 6 Data size: 664 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 6 Data size: 430 Basic stats: COMPLETE Column stats: NONE
                     Group By Operator
                       aggregations: sum(_count_of_key)
                       keys: key (type: int)
                       mode: hash
                       outputColumnNames: _col0, _col1
-                      Statistics: Num rows: 6 Data size: 664 Basic stats: COMPLETE Column stats: NONE
+                      Statistics: Num rows: 6 Data size: 430 Basic stats: COMPLETE Column stats: NONE
                       Reduce Output Operator
                         key expressions: _col0 (type: int)
                         sort order: +
                         Map-reduce partition columns: _col0 (type: int)
-                        Statistics: Num rows: 6 Data size: 664 Basic stats: COMPLETE Column stats: NONE
+                        Statistics: Num rows: 6 Data size: 430 Basic stats: COMPLETE Column stats: NONE
                         value expressions: _col1 (type: bigint)
         Reducer 2 
             Reduce Operator Tree:
@@ -2593,21 +2593,21 @@ STAGE PLANS:
                 keys: KEY._col0 (type: int)
                 mode: mergepartial
                 outputColumnNames: _col0, _col1
-                Statistics: Num rows: 3 Data size: 332 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 3 Data size: 215 Basic stats: COMPLETE Column stats: NONE
                 Reduce Output Operator
                   key expressions: _col0 (type: int)
                   sort order: +
-                  Statistics: Num rows: 3 Data size: 332 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 3 Data size: 215 Basic stats: COMPLETE Column stats: NONE
                   value expressions: _col1 (type: bigint)
         Reducer 3 
             Reduce Operator Tree:
               Select Operator
                 expressions: KEY.reducesinkkey0 (type: int), VALUE._col0 (type: bigint)
                 outputColumnNames: _col0, _col1
-                Statistics: Num rows: 3 Data size: 332 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 3 Data size: 215 Basic stats: COMPLETE Column stats: NONE
                 File Output Operator
                   compressed: false
-                  Statistics: Num rows: 3 Data size: 332 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 3 Data size: 215 Basic stats: COMPLETE Column stats: NONE
                   table:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/spark/ql_rewrite_gbtoidx_cbo_1.q.out b/ql/src/test/results/clientpositive/spark/ql_rewrite_gbtoidx_cbo_1.q.out
index cf214b9ec8..02e24c3db8 100644
--- a/ql/src/test/results/clientpositive/spark/ql_rewrite_gbtoidx_cbo_1.q.out
+++ b/ql/src/test/results/clientpositive/spark/ql_rewrite_gbtoidx_cbo_1.q.out
@@ -87,7 +87,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 2)
+        Reducer 2 <- Map 1 (GROUP, 4)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -258,29 +258,29 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 2)
+        Reducer 2 <- Map 1 (GROUP, 4)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
             Map Operator Tree:
                 TableScan
                   alias: $hdt$_0:default__lineitem_ix_lineitem_ix_lshipdate_idx__
-                  Statistics: Num rows: 95 Data size: 12665 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 95 Data size: 8960 Basic stats: COMPLETE Column stats: NONE
                   Select Operator
                     expressions: l_shipdate (type: string), _count_of_l_shipdate (type: bigint)
                     outputColumnNames: _col0, _count_of_l_shipdate
-                    Statistics: Num rows: 95 Data size: 12665 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 95 Data size: 8960 Basic stats: COMPLETE Column stats: NONE
                     Group By Operator
                       aggregations: sum(_count_of_l_shipdate)
                       keys: _col0 (type: string)
                       mode: hash
                       outputColumnNames: _col0, _col1
-                      Statistics: Num rows: 95 Data size: 12665 Basic stats: COMPLETE Column stats: NONE
+                      Statistics: Num rows: 95 Data size: 8960 Basic stats: COMPLETE Column stats: NONE
                       Reduce Output Operator
                         key expressions: _col0 (type: string)
                         sort order: +
                         Map-reduce partition columns: _col0 (type: string)
-                        Statistics: Num rows: 95 Data size: 12665 Basic stats: COMPLETE Column stats: NONE
+                        Statistics: Num rows: 95 Data size: 8960 Basic stats: COMPLETE Column stats: NONE
                         value expressions: _col1 (type: bigint)
         Reducer 2 
             Reduce Operator Tree:
@@ -289,10 +289,10 @@ STAGE PLANS:
                 keys: KEY._col0 (type: string)
                 mode: mergepartial
                 outputColumnNames: _col0, _col1
-                Statistics: Num rows: 47 Data size: 6265 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 47 Data size: 4432 Basic stats: COMPLETE Column stats: NONE
                 File Output Operator
                   compressed: false
-                  Statistics: Num rows: 47 Data size: 6265 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 47 Data size: 4432 Basic stats: COMPLETE Column stats: NONE
                   table:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -437,7 +437,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 2)
+        Reducer 2 <- Map 1 (GROUP, 4)
         Reducer 3 <- Reducer 2 (SORT, 1)
 #### A masked pattern was here ####
       Vertices:
@@ -578,7 +578,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 2)
+        Reducer 2 <- Map 1 (GROUP, 4)
         Reducer 3 <- Reducer 2 (SORT, 1)
 #### A masked pattern was here ####
       Vertices:
@@ -586,22 +586,22 @@ STAGE PLANS:
             Map Operator Tree:
                 TableScan
                   alias: $hdt$_0:default__lineitem_ix_lineitem_ix_lshipdate_idx__
-                  Statistics: Num rows: 95 Data size: 12665 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 95 Data size: 8960 Basic stats: COMPLETE Column stats: NONE
                   Select Operator
                     expressions: year(l_shipdate) (type: int), month(l_shipdate) (type: int), l_shipdate (type: string), _count_of_l_shipdate (type: bigint)
                     outputColumnNames: _col0, _col1, _col2, _count_of_l_shipdate
-                    Statistics: Num rows: 95 Data size: 12665 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 95 Data size: 8960 Basic stats: COMPLETE Column stats: NONE
                     Group By Operator
                       aggregations: sum(_count_of_l_shipdate)
                       keys: _col0 (type: int), _col1 (type: int)
                       mode: hash
                       outputColumnNames: _col0, _col1, _col2
-                      Statistics: Num rows: 95 Data size: 12665 Basic stats: COMPLETE Column stats: NONE
+                      Statistics: Num rows: 95 Data size: 8960 Basic stats: COMPLETE Column stats: NONE
                       Reduce Output Operator
                         key expressions: _col0 (type: int), _col1 (type: int)
                         sort order: ++
                         Map-reduce partition columns: _col0 (type: int), _col1 (type: int)
-                        Statistics: Num rows: 95 Data size: 12665 Basic stats: COMPLETE Column stats: NONE
+                        Statistics: Num rows: 95 Data size: 8960 Basic stats: COMPLETE Column stats: NONE
                         value expressions: _col2 (type: bigint)
         Reducer 2 
             Reduce Operator Tree:
@@ -610,21 +610,21 @@ STAGE PLANS:
                 keys: KEY._col0 (type: int), KEY._col1 (type: int)
                 mode: mergepartial
                 outputColumnNames: _col0, _col1, _col2
-                Statistics: Num rows: 47 Data size: 6265 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 47 Data size: 4432 Basic stats: COMPLETE Column stats: NONE
                 Reduce Output Operator
                   key expressions: _col0 (type: int), _col1 (type: int)
                   sort order: ++
-                  Statistics: Num rows: 47 Data size: 6265 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 47 Data size: 4432 Basic stats: COMPLETE Column stats: NONE
                   value expressions: _col2 (type: bigint)
         Reducer 3 
             Reduce Operator Tree:
               Select Operator
                 expressions: KEY.reducesinkkey0 (type: int), KEY.reducesinkkey1 (type: int), VALUE._col0 (type: bigint)
                 outputColumnNames: _col0, _col1, _col2
-                Statistics: Num rows: 47 Data size: 6265 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 47 Data size: 4432 Basic stats: COMPLETE Column stats: NONE
                 File Output Operator
                   compressed: false
-                  Statistics: Num rows: 47 Data size: 6265 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 47 Data size: 4432 Basic stats: COMPLETE Column stats: NONE
                   table:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -747,64 +747,64 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 2)
-        Reducer 5 <- Map 4 (GROUP, 2)
-        Reducer 3 <- Reducer 2 (PARTITION-LEVEL SORT, 2), Reducer 5 (PARTITION-LEVEL SORT, 2)
+        Reducer 2 <- Map 1 (GROUP, 4)
+        Reducer 5 <- Map 4 (GROUP, 4)
+        Reducer 3 <- Reducer 2 (PARTITION-LEVEL SORT, 4), Reducer 5 (PARTITION-LEVEL SORT, 4)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
             Map Operator Tree:
                 TableScan
                   alias: lastyear:default__lineitem_ix_lineitem_ix_lshipdate_idx__
-                  Statistics: Num rows: 95 Data size: 12665 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 95 Data size: 8960 Basic stats: COMPLETE Column stats: NONE
                   Filter Operator
                     predicate: (year(l_shipdate) = 1997) (type: boolean)
-                    Statistics: Num rows: 47 Data size: 6265 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 47 Data size: 4432 Basic stats: COMPLETE Column stats: NONE
                     Select Operator
                       expressions: l_shipdate (type: string), _count_of_l_shipdate (type: bigint)
                       outputColumnNames: l_shipdate, _count_of_l_shipdate
-                      Statistics: Num rows: 47 Data size: 6265 Basic stats: COMPLETE Column stats: NONE
+                      Statistics: Num rows: 47 Data size: 4432 Basic stats: COMPLETE Column stats: NONE
                       Group By Operator
                         aggregations: sum(_count_of_l_shipdate)
                         keys: year(l_shipdate) (type: int), month(l_shipdate) (type: int)
                         mode: hash
                         outputColumnNames: _col0, _col1, _col2
-                        Statistics: Num rows: 47 Data size: 6265 Basic stats: COMPLETE Column stats: NONE
+                        Statistics: Num rows: 47 Data size: 4432 Basic stats: COMPLETE Column stats: NONE
                         Filter Operator
                           predicate: _col1 is not null (type: boolean)
-                          Statistics: Num rows: 24 Data size: 3199 Basic stats: COMPLETE Column stats: NONE
+                          Statistics: Num rows: 24 Data size: 2263 Basic stats: COMPLETE Column stats: NONE
                           Reduce Output Operator
                             key expressions: _col0 (type: int), _col1 (type: int)
                             sort order: ++
                             Map-reduce partition columns: _col0 (type: int), _col1 (type: int)
-                            Statistics: Num rows: 24 Data size: 3199 Basic stats: COMPLETE Column stats: NONE
+                            Statistics: Num rows: 24 Data size: 2263 Basic stats: COMPLETE Column stats: NONE
                             value expressions: _col2 (type: bigint)
         Map 4 
             Map Operator Tree:
                 TableScan
                   alias: thisyear:default__lineitem_ix_lineitem_ix_lshipdate_idx__
-                  Statistics: Num rows: 95 Data size: 12665 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 95 Data size: 8960 Basic stats: COMPLETE Column stats: NONE
                   Filter Operator
                     predicate: (year(l_shipdate) = 1998) (type: boolean)
-                    Statistics: Num rows: 47 Data size: 6265 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 47 Data size: 4432 Basic stats: COMPLETE Column stats: NONE
                     Select Operator
                       expressions: l_shipdate (type: string), _count_of_l_shipdate (type: bigint)
                       outputColumnNames: l_shipdate, _count_of_l_shipdate
-                      Statistics: Num rows: 47 Data size: 6265 Basic stats: COMPLETE Column stats: NONE
+                      Statistics: Num rows: 47 Data size: 4432 Basic stats: COMPLETE Column stats: NONE
                       Group By Operator
                         aggregations: sum(_count_of_l_shipdate)
                         keys: year(l_shipdate) (type: int), month(l_shipdate) (type: int)
                         mode: hash
                         outputColumnNames: _col0, _col1, _col2
-                        Statistics: Num rows: 47 Data size: 6265 Basic stats: COMPLETE Column stats: NONE
+                        Statistics: Num rows: 47 Data size: 4432 Basic stats: COMPLETE Column stats: NONE
                         Filter Operator
                           predicate: _col1 is not null (type: boolean)
-                          Statistics: Num rows: 24 Data size: 3199 Basic stats: COMPLETE Column stats: NONE
+                          Statistics: Num rows: 24 Data size: 2263 Basic stats: COMPLETE Column stats: NONE
                           Reduce Output Operator
                             key expressions: _col0 (type: int), _col1 (type: int)
                             sort order: ++
                             Map-reduce partition columns: _col0 (type: int), _col1 (type: int)
-                            Statistics: Num rows: 24 Data size: 3199 Basic stats: COMPLETE Column stats: NONE
+                            Statistics: Num rows: 24 Data size: 2263 Basic stats: COMPLETE Column stats: NONE
                             value expressions: _col2 (type: bigint)
         Reducer 2 
             Reduce Operator Tree:
@@ -813,16 +813,16 @@ STAGE PLANS:
                 keys: KEY._col0 (type: int), KEY._col1 (type: int)
                 mode: mergepartial
                 outputColumnNames: _col0, _col1, _col2
-                Statistics: Num rows: 12 Data size: 1599 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 12 Data size: 1131 Basic stats: COMPLETE Column stats: NONE
                 Select Operator
                   expressions: _col1 (type: int), _col2 (type: bigint)
                   outputColumnNames: _col1, _col2
-                  Statistics: Num rows: 12 Data size: 1599 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 12 Data size: 1131 Basic stats: COMPLETE Column stats: NONE
                   Reduce Output Operator
                     key expressions: _col1 (type: int)
                     sort order: +
                     Map-reduce partition columns: _col1 (type: int)
-                    Statistics: Num rows: 12 Data size: 1599 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 12 Data size: 1131 Basic stats: COMPLETE Column stats: NONE
                     value expressions: _col2 (type: bigint)
         Reducer 3 
             Reduce Operator Tree:
@@ -833,14 +833,14 @@ STAGE PLANS:
                   0 _col1 (type: int)
                   1 _col1 (type: int)
                 outputColumnNames: _col1, _col2, _col4, _col5
-                Statistics: Num rows: 13 Data size: 1758 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 13 Data size: 1244 Basic stats: COMPLETE Column stats: NONE
                 Select Operator
                   expressions: _col1 (type: int), _col4 (type: int), ((_col5 - _col2) / _col2) (type: double)
                   outputColumnNames: _col0, _col1, _col2
-                  Statistics: Num rows: 13 Data size: 1758 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 13 Data size: 1244 Basic stats: COMPLETE Column stats: NONE
                   File Output Operator
                     compressed: false
-                    Statistics: Num rows: 13 Data size: 1758 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 13 Data size: 1244 Basic stats: COMPLETE Column stats: NONE
                     table:
                         input format: org.apache.hadoop.mapred.TextInputFormat
                         output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -852,16 +852,16 @@ STAGE PLANS:
                 keys: KEY._col0 (type: int), KEY._col1 (type: int)
                 mode: mergepartial
                 outputColumnNames: _col0, _col1, _col2
-                Statistics: Num rows: 12 Data size: 1599 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 12 Data size: 1131 Basic stats: COMPLETE Column stats: NONE
                 Select Operator
                   expressions: _col1 (type: int), _col2 (type: bigint)
                   outputColumnNames: _col1, _col2
-                  Statistics: Num rows: 12 Data size: 1599 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 12 Data size: 1131 Basic stats: COMPLETE Column stats: NONE
                   Reduce Output Operator
                     key expressions: _col1 (type: int)
                     sort order: +
                     Map-reduce partition columns: _col1 (type: int)
-                    Statistics: Num rows: 12 Data size: 1599 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 12 Data size: 1131 Basic stats: COMPLETE Column stats: NONE
                     value expressions: _col2 (type: bigint)
 
   Stage: Stage-0
@@ -890,7 +890,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 3 <- Map 2 (GROUP, 2)
+        Reducer 3 <- Map 2 (GROUP, 4)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -904,7 +904,7 @@ STAGE PLANS:
                     Statistics: Num rows: 116 Data size: 12099 Basic stats: COMPLETE Column stats: NONE
                     File Output Operator
                       compressed: false
-                      Statistics: Num rows: 163 Data size: 18364 Basic stats: COMPLETE Column stats: NONE
+                      Statistics: Num rows: 163 Data size: 16531 Basic stats: COMPLETE Column stats: NONE
                       table:
                           input format: org.apache.hadoop.mapred.TextInputFormat
                           output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -913,22 +913,22 @@ STAGE PLANS:
             Map Operator Tree:
                 TableScan
                   alias: null-subquery1:$hdt$_0-subquery1:$hdt$_0:default__lineitem_ix_lineitem_ix_lshipdate_idx__
-                  Statistics: Num rows: 95 Data size: 12665 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 95 Data size: 8960 Basic stats: COMPLETE Column stats: NONE
                   Select Operator
                     expressions: l_shipdate (type: string), _count_of_l_shipdate (type: bigint)
                     outputColumnNames: _col0, _count_of_l_shipdate
-                    Statistics: Num rows: 95 Data size: 12665 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 95 Data size: 8960 Basic stats: COMPLETE Column stats: NONE
                     Group By Operator
                       aggregations: sum(_count_of_l_shipdate)
                       keys: _col0 (type: string)
                       mode: hash
                       outputColumnNames: _col0, _col1
-                      Statistics: Num rows: 95 Data size: 12665 Basic stats: COMPLETE Column stats: NONE
+                      Statistics: Num rows: 95 Data size: 8960 Basic stats: COMPLETE Column stats: NONE
                       Reduce Output Operator
                         key expressions: _col0 (type: string)
                         sort order: +
                         Map-reduce partition columns: _col0 (type: string)
-                        Statistics: Num rows: 95 Data size: 12665 Basic stats: COMPLETE Column stats: NONE
+                        Statistics: Num rows: 95 Data size: 8960 Basic stats: COMPLETE Column stats: NONE
                         value expressions: _col1 (type: bigint)
         Reducer 3 
             Reduce Operator Tree:
@@ -937,10 +937,10 @@ STAGE PLANS:
                 keys: KEY._col0 (type: string)
                 mode: mergepartial
                 outputColumnNames: _col0, _col1
-                Statistics: Num rows: 47 Data size: 6265 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 47 Data size: 4432 Basic stats: COMPLETE Column stats: NONE
                 File Output Operator
                   compressed: false
-                  Statistics: Num rows: 163 Data size: 18364 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 163 Data size: 16531 Basic stats: COMPLETE Column stats: NONE
                   table:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
@@ -991,7 +991,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 2)
+        Reducer 2 <- Map 1 (GROUP, 4)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -1052,7 +1052,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 2)
+        Reducer 2 <- Map 1 (GROUP, 4)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -1216,7 +1216,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 2)
+        Reducer 2 <- Map 1 (GROUP, 4)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -1271,7 +1271,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 2)
+        Reducer 2 <- Map 1 (GROUP, 4)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -1330,7 +1330,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 2)
+        Reducer 2 <- Map 1 (GROUP, 4)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -1388,7 +1388,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 2)
+        Reducer 2 <- Map 1 (GROUP, 4)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -1446,7 +1446,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 2)
+        Reducer 2 <- Map 1 (GROUP, 4)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -1505,7 +1505,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 2)
+        Reducer 2 <- Map 1 (GROUP, 4)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -1564,7 +1564,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 2)
+        Reducer 2 <- Map 1 (GROUP, 4)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -1622,7 +1622,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 2)
+        Reducer 2 <- Map 1 (GROUP, 4)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -1677,7 +1677,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 2)
+        Reducer 2 <- Map 1 (GROUP, 4)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -1732,7 +1732,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 2)
+        Reducer 2 <- Map 1 (GROUP, 4)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -1787,7 +1787,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 2)
+        Reducer 2 <- Map 1 (GROUP, 4)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -1842,7 +1842,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 2)
+        Reducer 2 <- Map 1 (GROUP, 4)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -1900,7 +1900,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 2)
+        Reducer 2 <- Map 1 (GROUP, 4)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -1958,7 +1958,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 2)
+        Reducer 2 <- Map 1 (GROUP, 4)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -2016,7 +2016,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 2)
+        Reducer 2 <- Map 1 (GROUP, 4)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -2074,7 +2074,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 2)
+        Reducer 2 <- Map 1 (GROUP, 4)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -2129,7 +2129,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 2)
+        Reducer 2 <- Map 1 (GROUP, 4)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -2272,7 +2272,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 2)
+        Reducer 2 <- Map 1 (GROUP, 4)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -2375,7 +2375,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 2)
+        Reducer 2 <- Map 1 (GROUP, 4)
 #### A masked pattern was here ####
       Vertices:
         Map 1 
@@ -2485,7 +2485,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 2)
+        Reducer 2 <- Map 1 (GROUP, 4)
         Reducer 3 <- Reducer 2 (SORT, 1)
 #### A masked pattern was here ####
       Vertices:
@@ -2569,7 +2569,7 @@ STAGE PLANS:
   Stage: Stage-1
     Spark
       Edges:
-        Reducer 2 <- Map 1 (GROUP, 2)
+        Reducer 2 <- Map 1 (GROUP, 4)
         Reducer 3 <- Reducer 2 (SORT, 1)
 #### A masked pattern was here ####
       Vertices:
@@ -2577,22 +2577,22 @@ STAGE PLANS:
             Map Operator Tree:
                 TableScan
                   alias: $hdt$_0:default__tbl_tbl_key_idx__
-                  Statistics: Num rows: 6 Data size: 664 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 6 Data size: 430 Basic stats: COMPLETE Column stats: NONE
                   Select Operator
                     expressions: key (type: int), _count_of_key (type: bigint)
                     outputColumnNames: _col0, _count_of_key
-                    Statistics: Num rows: 6 Data size: 664 Basic stats: COMPLETE Column stats: NONE
+                    Statistics: Num rows: 6 Data size: 430 Basic stats: COMPLETE Column stats: NONE
                     Group By Operator
                       aggregations: sum(_count_of_key)
                       keys: _col0 (type: int)
                       mode: hash
                       outputColumnNames: _col0, _col1
-                      Statistics: Num rows: 6 Data size: 664 Basic stats: COMPLETE Column stats: NONE
+                      Statistics: Num rows: 6 Data size: 430 Basic stats: COMPLETE Column stats: NONE
                       Reduce Output Operator
                         key expressions: _col0 (type: int)
                         sort order: +
                         Map-reduce partition columns: _col0 (type: int)
-                        Statistics: Num rows: 6 Data size: 664 Basic stats: COMPLETE Column stats: NONE
+                        Statistics: Num rows: 6 Data size: 430 Basic stats: COMPLETE Column stats: NONE
                         value expressions: _col1 (type: bigint)
         Reducer 2 
             Reduce Operator Tree:
@@ -2601,21 +2601,21 @@ STAGE PLANS:
                 keys: KEY._col0 (type: int)
                 mode: mergepartial
                 outputColumnNames: _col0, _col1
-                Statistics: Num rows: 3 Data size: 332 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 3 Data size: 215 Basic stats: COMPLETE Column stats: NONE
                 Reduce Output Operator
                   key expressions: _col0 (type: int)
                   sort order: +
-                  Statistics: Num rows: 3 Data size: 332 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 3 Data size: 215 Basic stats: COMPLETE Column stats: NONE
                   value expressions: _col1 (type: bigint)
         Reducer 3 
             Reduce Operator Tree:
               Select Operator
                 expressions: KEY.reducesinkkey0 (type: int), VALUE._col0 (type: bigint)
                 outputColumnNames: _col0, _col1
-                Statistics: Num rows: 3 Data size: 332 Basic stats: COMPLETE Column stats: NONE
+                Statistics: Num rows: 3 Data size: 215 Basic stats: COMPLETE Column stats: NONE
                 File Output Operator
                   compressed: false
-                  Statistics: Num rows: 3 Data size: 332 Basic stats: COMPLETE Column stats: NONE
+                  Statistics: Num rows: 3 Data size: 215 Basic stats: COMPLETE Column stats: NONE
                   table:
                       input format: org.apache.hadoop.mapred.TextInputFormat
                       output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
diff --git a/ql/src/test/results/clientpositive/tez/explainuser_2.q.out b/ql/src/test/results/clientpositive/tez/explainuser_2.q.out
index 95924aa94a..c0634215ae 100644
--- a/ql/src/test/results/clientpositive/tez/explainuser_2.q.out
+++ b/ql/src/test/results/clientpositive/tez/explainuser_2.q.out
@@ -5262,7 +5262,7 @@ Stage-5
                            |           Statistics:Num rows: 501 Data size: 136272 Basic stats: COMPLETE Column stats: PARTIAL
                            |           Select Operator [SEL_5]
                            |              outputColumnNames:["_col0","_col1"]
-                           |              Statistics:Num rows: 1 Data size: 272 Basic stats: COMPLETE Column stats: COMPLETE
+                           |              Statistics:Num rows: 1 Data size: 360 Basic stats: COMPLETE Column stats: COMPLETE
                            |              Group By Operator [GBY_4]
                            |              |  aggregations:["count(VALUE._col0)"]
                            |              |  outputColumnNames:["_col0"]
@@ -5429,10 +5429,10 @@ Stage-5
                            |        Statistics:Num rows: 250 Data size: 70000 Basic stats: COMPLETE Column stats: PARTIAL
                            |        Select Operator [SEL_9]
                            |           outputColumnNames:["_col0","_col1"]
-                           |           Statistics:Num rows: 501 Data size: 5584 Basic stats: COMPLETE Column stats: PARTIAL
+                           |           Statistics:Num rows: 501 Data size: 5672 Basic stats: COMPLETE Column stats: PARTIAL
                            |           Select Operator [SEL_5]
                            |              outputColumnNames:["_col0","_col1"]
-                           |              Statistics:Num rows: 1 Data size: 272 Basic stats: COMPLETE Column stats: COMPLETE
+                           |              Statistics:Num rows: 1 Data size: 360 Basic stats: COMPLETE Column stats: COMPLETE
                            |              Group By Operator [GBY_4]
                            |              |  aggregations:["count(VALUE._col0)"]
                            |              |  outputColumnNames:["_col0"]
@@ -5463,7 +5463,7 @@ Stage-5
                            |        Statistics:Num rows: 250 Data size: 116000 Basic stats: COMPLETE Column stats: PARTIAL
                            |        Select Operator [SEL_15]
                            |           outputColumnNames:["_col0","_col1"]
-                           |           Statistics:Num rows: 501 Data size: 5584 Basic stats: COMPLETE Column stats: PARTIAL
+                           |           Statistics:Num rows: 501 Data size: 5672 Basic stats: COMPLETE Column stats: PARTIAL
                            |            Please refer to the previous Select Operator [SEL_5]
                            |<-Map 6 [CONTAINS]
                               Reduce Output Operator [RS_11]
@@ -5478,7 +5478,7 @@ Stage-5
                                     Statistics:Num rows: 250 Data size: 70000 Basic stats: COMPLETE Column stats: PARTIAL
                                     Select Operator [SEL_9]
                                        outputColumnNames:["_col0","_col1"]
-                                       Statistics:Num rows: 501 Data size: 5584 Basic stats: COMPLETE Column stats: PARTIAL
+                                       Statistics:Num rows: 501 Data size: 5672 Basic stats: COMPLETE Column stats: PARTIAL
                                        Select Operator [SEL_7]
                                           outputColumnNames:["_col0","_col1"]
                                           Statistics:Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
@@ -5497,7 +5497,7 @@ Stage-5
                                     Statistics:Num rows: 250 Data size: 116000 Basic stats: COMPLETE Column stats: PARTIAL
                                     Select Operator [SEL_15]
                                        outputColumnNames:["_col0","_col1"]
-                                       Statistics:Num rows: 501 Data size: 5584 Basic stats: COMPLETE Column stats: PARTIAL
+                                       Statistics:Num rows: 501 Data size: 5672 Basic stats: COMPLETE Column stats: PARTIAL
                                         Please refer to the previous Select Operator [SEL_7]
                      Reducer 4
                      File Output Operator [FS_14]
diff --git a/ql/src/test/results/clientpositive/tez/tez_union_multiinsert.q.out b/ql/src/test/results/clientpositive/tez/tez_union_multiinsert.q.out
index 132f859c77..70c79aa906 100644
--- a/ql/src/test/results/clientpositive/tez/tez_union_multiinsert.q.out
+++ b/ql/src/test/results/clientpositive/tez/tez_union_multiinsert.q.out
@@ -155,7 +155,7 @@ STAGE PLANS:
                 Select Operator
                   expressions: 'tst1' (type: string), UDFToString(_col0) (type: string)
                   outputColumnNames: _col0, _col1
-                  Statistics: Num rows: 1 Data size: 272 Basic stats: COMPLETE Column stats: COMPLETE
+                  Statistics: Num rows: 1 Data size: 360 Basic stats: COMPLETE Column stats: COMPLETE
                   Select Operator
                     expressions: _col0 (type: string), _col1 (type: string)
                     outputColumnNames: _col0, _col1
@@ -1084,7 +1084,7 @@ STAGE PLANS:
                 Select Operator
                   expressions: 'tst1' (type: string), UDFToString(_col0) (type: string)
                   outputColumnNames: _col0, _col1
-                  Statistics: Num rows: 1 Data size: 272 Basic stats: COMPLETE Column stats: COMPLETE
+                  Statistics: Num rows: 1 Data size: 360 Basic stats: COMPLETE Column stats: COMPLETE
                   Select Operator
                     expressions: _col0 (type: string), _col1 (type: string)
                     outputColumnNames: _col0, _col1
