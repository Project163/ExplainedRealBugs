diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/DDLPlanUtils.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/DDLPlanUtils.java
index 10feb13045..9e226c24e9 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/DDLPlanUtils.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/DDLPlanUtils.java
@@ -52,6 +52,7 @@
 import org.apache.hadoop.hive.ql.metadata.ForeignKeyInfo;
 import org.apache.hadoop.hive.ql.metadata.Hive;
 import org.apache.hadoop.hive.ql.metadata.HiveException;
+import org.apache.hadoop.hive.ql.metadata.HiveUtils;
 import org.apache.hadoop.hive.ql.metadata.NotNullConstraint;
 import org.apache.hadoop.hive.ql.metadata.Partition;
 import org.apache.hadoop.hive.ql.metadata.PrimaryKeyInfo;
@@ -74,8 +75,10 @@
 import java.nio.ByteBuffer;
 import java.util.ArrayList;
 import java.util.Base64;
+import java.util.Collection;
 import java.util.HashMap;
 import java.util.HashSet;
+import java.util.LinkedHashSet;
 import java.util.List;
 import java.util.Map;
 import java.util.Map.Entry;
@@ -696,12 +699,7 @@ public String getAlterTableStmtPrimaryKeyConstraint(PrimaryKeyInfo pr) {
     command.add(TABLE_NAME, unparseIdentifier(pr.getTableName()));
     command.add(DATABASE_NAME, unparseIdentifier(pr.getDatabaseName()));
     command.add(CONSTRAINT_NAME, unparseIdentifier(pr.getConstraintName()));
-    command.add(
-        COL_NAMES,
-        pr.getColNames().values().stream()
-            .map(x -> unparseIdentifier(x))
-            .collect(Collectors.joining(","))
-    );
+    command.add(COL_NAMES, unparseListOfIdentifiersAndJoin(pr.getColNames().values(), ","));
     command.add(ENABLE, pr.getEnable());
     command.add(VALIDATE, pr.getValidate());
     command.add(RELY, pr.getRely());
@@ -714,23 +712,35 @@ public void getAlterTableStmtForeignKeyConstraint(ForeignKeyInfo fr, List<String
     }
     Map<String, List<ForeignKeyInfo.ForeignKeyCol>> all = fr.getForeignKeys();
     for (String key : all.keySet()) {
-      for (ForeignKeyInfo.ForeignKeyCol fkc : all.get(key)) {
-        ST command = new ST(ALTER_TABLE_ADD_FOREIGN_KEY);
-        command.add(CHILD_TABLE_NAME, unparseIdentifier(fr.getChildTableName()));
-        command.add(DATABASE_NAME, unparseIdentifier(fr.getChildDatabaseName()));
-        command.add(CONSTRAINT_NAME, unparseIdentifier(key));
-        command.add(CHILD_COL_NAME, unparseIdentifier(fkc.childColName));
-        command.add(DATABASE_NAME_FR, unparseIdentifier(fkc.parentDatabaseName));
-        command.add(PARENT_TABLE_NAME, unparseIdentifier(fkc.parentTableName));
-        command.add(PARENT_COL_NAME, unparseIdentifier(fkc.parentColName));
-        command.add(ENABLE, fkc.enable);
-        command.add(VALIDATE, fkc.validate);
-        command.add(RELY, fkc.rely);
-        constraints.add(command.render());
+      List<ForeignKeyInfo.ForeignKeyCol> fkCols = all.get(key);
+      Set<String> parentCols = new LinkedHashSet<>(fkCols.size());
+      Set<String> childCols = new LinkedHashSet<>(fkCols.size());
+
+      for (ForeignKeyInfo.ForeignKeyCol fkc: fkCols) {
+        parentCols.add(fkc.parentColName);
+        childCols.add(fkc.childColName);
       }
+      ST command = new ST(ALTER_TABLE_ADD_FOREIGN_KEY);
+      command.add(CHILD_TABLE_NAME, unparseIdentifier(fr.getChildTableName()));
+      command.add(DATABASE_NAME, unparseIdentifier(fr.getChildDatabaseName()));
+      command.add(CONSTRAINT_NAME, unparseIdentifier(key));
+      command.add(CHILD_COL_NAME, unparseListOfIdentifiersAndJoin(childCols, ", "));
+      command.add(DATABASE_NAME_FR, unparseIdentifier(fkCols.get(0).parentDatabaseName));
+      command.add(PARENT_TABLE_NAME, unparseIdentifier(fkCols.get(0).parentTableName));
+      command.add(PARENT_COL_NAME, unparseListOfIdentifiersAndJoin(parentCols, ", "));
+      command.add(ENABLE, fkCols.get(0).enable);
+      command.add(VALIDATE, fkCols.get(0).validate);
+      command.add(RELY, fkCols.get(0).rely);
+      constraints.add(command.render());
     }
   }
 
+  private String unparseListOfIdentifiersAndJoin(Collection<String> collection, String delimiter) {
+    return collection.stream()
+        .map(HiveUtils::unparseIdentifier)
+        .collect(Collectors.joining(delimiter));
+  }
+
   public void getAlterTableStmtUniqueConstraint(UniqueConstraint uq, List<String> constraints) {
     if (!UniqueConstraint.isNotEmpty(uq)) {
       return;
@@ -745,12 +755,7 @@ public void getAlterTableStmtUniqueConstraint(UniqueConstraint uq, List<String>
       for (UniqueConstraint.UniqueConstraintCol col : uniqueConstraints.get(key)) {
         colNames.add(col.colName);
       }
-      command.add(
-          COLUMN_NAME,
-          colNames.stream()
-              .map(x -> unparseIdentifier(x))
-              .collect(Collectors.joining(","))
-      );
+      command.add(COLUMN_NAME, unparseListOfIdentifiersAndJoin(colNames, ","));
       command.add(ENABLE, uniqueConstraints.get(key).get(0).enable);
       command.add(VALIDATE, uniqueConstraints.get(key).get(0).validate);
       command.add(RELY, uniqueConstraints.get(key).get(0).rely);
@@ -1026,11 +1031,7 @@ private String getBuckets(Table table) {
     if (bucketCols.isEmpty()) {
       return "";
     }
-    List<String> unparsedBucketCols = bucketCols.stream()
-        .map(x -> unparseIdentifier(x))
-        .collect(Collectors.toList());
-
-    String buckets = "CLUSTERED BY (\n  " + StringUtils.join(unparsedBucketCols, ",\n  ") + ")\n";
+    String buckets = "CLUSTERED BY (\n  " + unparseListOfIdentifiersAndJoin(bucketCols, ",\n  ") + ")\n";
 
     List<Order> sortColumns = table.getSortCols();
     if (!sortColumns.isEmpty()) {
@@ -1053,17 +1054,13 @@ private String getSkewed(Table table) {
       return "";
     }
 
-    List<String> unparsedSkewedColNames = skewedInfo.getSkewedColNames().stream()
-        .map(x -> unparseIdentifier(x))
-        .collect(Collectors.toList());
-
     List<String> columnValuesList = new ArrayList<>();
     for (List<String> columnValues : skewedInfo.getSkewedColValues()) {
       columnValuesList.add("('" + StringUtils.join(columnValues, "','") + "')");
     }
 
     String skewed =
-      "SKEWED BY (" + StringUtils.join(unparsedSkewedColNames, ",") + ")\n" +
+      "SKEWED BY (" + unparseListOfIdentifiersAndJoin(skewedInfo.getSkewedColNames(), ",") + ")\n" +
         "  ON (" + StringUtils.join(columnValuesList, ",") + ")";
     if (table.isStoredAsSubDirectories()) {
       skewed += "\n  STORED AS DIRECTORIES";
diff --git a/ql/src/test/results/clientpositive/llap/show_create_table.q.out b/ql/src/test/results/clientpositive/llap/show_create_table.q.out
index 3d92e50498..9762dc7d96 100644
--- a/ql/src/test/results/clientpositive/llap/show_create_table.q.out
+++ b/ql/src/test/results/clientpositive/llap/show_create_table.q.out
@@ -159,8 +159,7 @@ LOCATION
 TBLPROPERTIES (
   'bucketing_version'='2', 
 #### A masked pattern was here ####
-ALTER TABLE `default`.`test3` ADD CONSTRAINT `#### A masked pattern was here ####` FOREIGN KEY (`col1`) REFERENCES `default`.`test`(`col1`) DISABLE NOVALIDATE RELY;
-ALTER TABLE `default`.`test3` ADD CONSTRAINT `#### A masked pattern was here ####` FOREIGN KEY (`col2`) REFERENCES `default`.`test`(`col2`) DISABLE NOVALIDATE RELY;
+ALTER TABLE `default`.`test3` ADD CONSTRAINT `#### A masked pattern was here ####` FOREIGN KEY (`col1`, `col2`) REFERENCES `default`.`test`(`col1`, `col2`) DISABLE NOVALIDATE RELY;
 PREHOOK: query: CREATE TABLE TEST_RESERVED (
 `member_nr` varchar(8),
 `plan_nr` varchar(11),
