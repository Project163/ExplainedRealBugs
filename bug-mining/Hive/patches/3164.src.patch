diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/MapOperator.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/MapOperator.java
index 5c211c7bf0..6d66c7479e 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/MapOperator.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/MapOperator.java
@@ -392,8 +392,12 @@ private String getNominalPath(Path fpath) {
     boolean schemaless = fpath.toUri().getScheme() == null;
     for (String onefile : conf.getPathToAliases().keySet()) {
       Path onepath = normalizePath(onefile, schemaless);
+      Path curfpath = fpath;
+      if(!schemaless && onepath.toUri().getScheme() == null) {
+        curfpath = new Path(fpath.toUri().getPath());
+      }
       // check for the operators who will process rows coming to this Map Operator
-      if (onepath.toUri().relativize(fpath.toUri()).equals(fpath.toUri())) {
+      if (onepath.toUri().relativize(curfpath.toUri()).equals(curfpath.toUri())) {
         // not from this
         continue;
       }
