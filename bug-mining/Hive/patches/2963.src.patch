diff --git a/ql/src/java/org/apache/hadoop/hive/ql/txn/compactor/CompactorMR.java b/ql/src/java/org/apache/hadoop/hive/ql/txn/compactor/CompactorMR.java
index 1d3cf00296..3cdbc6cebb 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/txn/compactor/CompactorMR.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/txn/compactor/CompactorMR.java
@@ -37,6 +37,7 @@
 import org.apache.hadoop.hive.ql.io.RecordIdentifier;
 import org.apache.hadoop.hive.serde.serdeConstants;
 import org.apache.hadoop.hive.serde2.objectinspector.ObjectInspector;
+import org.apache.hadoop.hive.shims.ShimLoader;
 import org.apache.hadoop.io.NullWritable;
 import org.apache.hadoop.io.Writable;
 import org.apache.hadoop.io.WritableComparable;
@@ -697,9 +698,10 @@ public void abortTask(TaskAttemptContext taskAttemptContext) throws IOException
 
     @Override
     public void commitJob(JobContext context) throws IOException {
-      Path tmpLocation = new Path(context.getJobConf().get(TMP_LOCATION));
-      Path finalLocation = new Path(context.getJobConf().get(FINAL_LOCATION));
-      FileSystem fs = tmpLocation.getFileSystem(context.getJobConf());
+      JobConf conf = ShimLoader.getHadoopShims().getJobConf(context);
+      Path tmpLocation = new Path(conf.get(TMP_LOCATION));
+      Path finalLocation = new Path(conf.get(FINAL_LOCATION));
+      FileSystem fs = tmpLocation.getFileSystem(conf);
       LOG.debug("Moving contents of " + tmpLocation.toString() + " to " +
           finalLocation.toString());
 
@@ -713,8 +715,9 @@ public void commitJob(JobContext context) throws IOException {
 
     @Override
     public void abortJob(JobContext context, int status) throws IOException {
-      Path tmpLocation = new Path(context.getJobConf().get(TMP_LOCATION));
-      FileSystem fs = tmpLocation.getFileSystem(context.getJobConf());
+      JobConf conf = ShimLoader.getHadoopShims().getJobConf(context);
+      Path tmpLocation = new Path(conf.get(TMP_LOCATION));
+      FileSystem fs = tmpLocation.getFileSystem(conf);
       LOG.debug("Removing " + tmpLocation.toString());
       fs.delete(tmpLocation, true);
     }
diff --git a/shims/0.20/src/main/java/org/apache/hadoop/hive/shims/Hadoop20Shims.java b/shims/0.20/src/main/java/org/apache/hadoop/hive/shims/Hadoop20Shims.java
index 76df71c3eb..a5245738d3 100644
--- a/shims/0.20/src/main/java/org/apache/hadoop/hive/shims/Hadoop20Shims.java
+++ b/shims/0.20/src/main/java/org/apache/hadoop/hive/shims/Hadoop20Shims.java
@@ -888,6 +888,11 @@ public Configuration getConfiguration(org.apache.hadoop.mapreduce.JobContext con
     return context.getConfiguration();
   }
 
+  @Override
+  public JobConf getJobConf(JobContext context) {
+    return context.getJobConf();
+  }
+
   @Override
   public FileSystem getNonCachedFileSystem(URI uri, Configuration conf) throws IOException {
     boolean origDisableHDFSCache =
diff --git a/shims/0.20S/src/main/java/org/apache/hadoop/hive/shims/Hadoop20SShims.java b/shims/0.20S/src/main/java/org/apache/hadoop/hive/shims/Hadoop20SShims.java
index 127f6e6ed2..1592c32d5c 100644
--- a/shims/0.20S/src/main/java/org/apache/hadoop/hive/shims/Hadoop20SShims.java
+++ b/shims/0.20S/src/main/java/org/apache/hadoop/hive/shims/Hadoop20SShims.java
@@ -511,6 +511,11 @@ public Configuration getConfiguration(org.apache.hadoop.mapreduce.JobContext con
     return context.getConfiguration();
   }
 
+  @Override
+  public JobConf getJobConf(org.apache.hadoop.mapred.JobContext context) {
+    return context.getJobConf();
+  }
+
   @Override
   public FileSystem getNonCachedFileSystem(URI uri, Configuration conf) throws IOException {
     boolean origDisableHDFSCache =
diff --git a/shims/0.23/src/main/java/org/apache/hadoop/hive/shims/Hadoop23Shims.java b/shims/0.23/src/main/java/org/apache/hadoop/hive/shims/Hadoop23Shims.java
index 7629c2d906..dac05e61fc 100644
--- a/shims/0.23/src/main/java/org/apache/hadoop/hive/shims/Hadoop23Shims.java
+++ b/shims/0.23/src/main/java/org/apache/hadoop/hive/shims/Hadoop23Shims.java
@@ -773,6 +773,11 @@ public Configuration getConfiguration(org.apache.hadoop.mapreduce.JobContext con
     return context.getConfiguration();
   }
 
+  @Override
+  public JobConf getJobConf(org.apache.hadoop.mapred.JobContext context) {
+    return context.getJobConf();
+  }
+
   @Override
   public FileSystem getNonCachedFileSystem(URI uri, Configuration conf) throws IOException {
     return FileSystem.newInstance(uri, conf);
diff --git a/shims/common/src/main/java/org/apache/hadoop/hive/shims/HadoopShims.java b/shims/common/src/main/java/org/apache/hadoop/hive/shims/HadoopShims.java
index d72e0da014..d1cbd2ec83 100644
--- a/shims/common/src/main/java/org/apache/hadoop/hive/shims/HadoopShims.java
+++ b/shims/common/src/main/java/org/apache/hadoop/hive/shims/HadoopShims.java
@@ -708,6 +708,13 @@ public interface DirectDecompressorShim {
    */
   public Configuration getConfiguration(JobContext context);
 
+  /**
+   * Get job conf from the old style JobContext.
+   * @param context job context
+   * @return job conf
+   */
+  public JobConf getJobConf(org.apache.hadoop.mapred.JobContext context);
+
   public FileSystem getNonCachedFileSystem(URI uri, Configuration conf) throws IOException;
 
   public void getMergedCredentials(JobConf jobConf) throws IOException;
