diff --git a/CHANGES.txt b/CHANGES.txt
index f237309370..1dced1a4b9 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -351,6 +351,9 @@ Trunk -  Unreleased
     HIVE-1004 Change default memory for Hive client to 256M
     (Zheng Shao via namit)
 
+    HIVE-1006 getPartitionDescFromPath failing from CombineHiveInputFormat
+    (Dave Lerman via namit)
+
 Release 0.4.0 -  Unreleased
 
   INCOMPATIBLE CHANGES
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/io/CombineHiveInputFormat.java b/ql/src/java/org/apache/hadoop/hive/ql/io/CombineHiveInputFormat.java
index b48ef150cb..89cb73fa58 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/io/CombineHiveInputFormat.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/io/CombineHiveInputFormat.java
@@ -22,6 +22,8 @@
 import java.io.DataInput;
 import java.io.DataOutput;
 import java.io.IOException;
+import java.net.URI;
+import java.net.URISyntaxException;
 import java.util.ArrayList;
 import java.util.HashMap;
 import java.util.Map;
@@ -287,6 +289,22 @@ public RecordReader getRecordReader(InputSplit split, JobConf job, Reporter repo
         reporter, CombineHiveRecordReader.class);
   }
 
+  protected static partitionDesc getPartitionDescFromPath(
+      Map<String, partitionDesc> pathToPartitionInfo, Path dir) throws IOException {
+	// The format of the keys in pathToPartitionInfo sometimes contains a port
+	// and sometimes doesn't, so we just compare paths.
+    for (Map.Entry<String, partitionDesc> entry : pathToPartitionInfo.entrySet()) {
+      try {
+        if (new URI(entry.getKey()).getPath().equals(dir.toUri().getPath())) {			
+          return entry.getValue();
+        }
+      }
+      catch (URISyntaxException e2) {}
+    }
+    throw new IOException("cannot find dir = " + dir.toString()
+      + " in partToPartitionInfo!");
+  }
+
   static class CombineFilter implements PathFilter {
     private String pString;
 
