diff --git a/ql/src/java/org/apache/hadoop/hive/ql/ddl/misc/msck/MsckOperation.java b/ql/src/java/org/apache/hadoop/hive/ql/ddl/misc/msck/MsckOperation.java
index b04e1ba490..7e2ab312a9 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/ddl/misc/msck/MsckOperation.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/ddl/misc/msck/MsckOperation.java
@@ -69,7 +69,6 @@ public int execute() throws HiveException, IOException, TException {
               partitionExpirySeconds);
         }
       }
-
       MsckInfo msckInfo = new MsckInfo(SessionState.get().getCurrentCatalog(), tableName.getDb(), tableName.getTable(),
           desc.getFilterExp(), desc.getResFile(), desc.isRepairPartitions(),
           desc.isAddPartitions(), desc.isDropPartitions(), partitionExpirySeconds);
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/metadata/SessionHiveMetaStoreClient.java b/ql/src/java/org/apache/hadoop/hive/ql/metadata/SessionHiveMetaStoreClient.java
index 720178d158..f0aae4f84c 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/metadata/SessionHiveMetaStoreClient.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/metadata/SessionHiveMetaStoreClient.java
@@ -1589,7 +1589,7 @@ private String generateJDOFilter(org.apache.hadoop.hive.metastore.api.Table tabl
   private String generateJDOFilter(org.apache.hadoop.hive.metastore.api.Table table, byte[] expr,
       String defaultPartitionName) throws MetaException {
     ExpressionTree expressionTree = PartFilterExprUtil
-        .makeExpressionTree(PartFilterExprUtil.createExpressionProxy(conf), expr, defaultPartitionName);
+        .makeExpressionTree(PartFilterExprUtil.createExpressionProxy(conf), expr, defaultPartitionName, conf);
     return generateJDOFilter(table, expressionTree == null ? ExpressionTree.EMPTY_TREE : expressionTree);
   }
 
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/ppr/PartitionExpressionForMetastore.java b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/ppr/PartitionExpressionForMetastore.java
index 11c02f3cce..6973744e52 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/ppr/PartitionExpressionForMetastore.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/ppr/PartitionExpressionForMetastore.java
@@ -21,6 +21,7 @@
 import org.apache.hadoop.hive.metastore.api.FieldSchema;
 import org.apache.hadoop.hive.metastore.api.FileMetadataExprType;
 
+import java.nio.charset.StandardCharsets;
 import java.util.ArrayList;
 import java.util.List;
 
@@ -48,8 +49,21 @@ public class PartitionExpressionForMetastore implements PartitionExpressionProxy
   private static final Logger LOG = LoggerFactory.getLogger(PartitionExpressionForMetastore.class);
 
   @Override
-  public String convertExprToFilter(byte[] exprBytes, String defaultPartitionName) throws MetaException {
-    ExprNodeGenericFuncDesc expr = deserializeExpr(exprBytes);
+  public String convertExprToFilter(byte[] exprBytes, String defaultPartitionName, boolean decodeFilterExpToStr)
+      throws MetaException {
+    ExprNodeGenericFuncDesc expr;
+    try {
+      expr = deserializeExpr(exprBytes);
+    } catch (MetaException e) {
+      // When deserializeExpr fails try to deserialize th exprBytes to string based on the
+      // flag decodeFilterExpToStr. This usually happens when MSCK command is run with partition
+      // filters. When MSCK command tries to drop the partitions, The string partition filter is serialized
+      // to byte array and during deserialization we need to construct the filter string back.
+      if (decodeFilterExpToStr) {
+        return new String(exprBytes, StandardCharsets.UTF_8);
+      }
+      throw new MetaException(e.getMessage());
+    }
     if ((defaultPartitionName != null) && (!defaultPartitionName.isEmpty())) {
       try {
         ExprNodeDescUtils.replaceNullFiltersWithDefaultPartition(expr, defaultPartitionName);
diff --git a/ql/src/test/queries/clientpositive/msck_repair_filter.q b/ql/src/test/queries/clientpositive/msck_repair_filter.q
index fc4594d7fb..8b9ae7a85f 100644
--- a/ql/src/test/queries/clientpositive/msck_repair_filter.q
+++ b/ql/src/test/queries/clientpositive/msck_repair_filter.q
@@ -1,4 +1,5 @@
 SET metastore.expression.proxy=org.apache.hadoop.hive.ql.optimizer.ppr.PartitionExpressionForMetastore;
+SET metastore.decode.filter.expression.tostring=true;
 
 DROP TABLE IF EXISTS repairtable_filter;
 
@@ -138,4 +139,18 @@ dfs -touchz ${system:test.local.warehouse.dir}/repairtable_filter/p1=bbsc/p2=e/d
 MSCK REPAIR TABLE default.repairtable_filter SYNC PARTITIONS (p1!='bba', p2 like 'e%');
 show partitions repairtable_filter;
 
+-- Test DROP PARTITIONS
+
+dfs -rmr ${system:test.local.warehouse.dir}/repairtable_filter/p1=bbsc;
+MSCK REPAIR TABLE default.repairtable_filter SYNC PARTITIONS (p1='bbsc');
+show partitions repairtable_filter;
+
+dfs -rmr ${system:test.local.warehouse.dir}/repairtable_filter/p1=bbw;
+MSCK REPAIR TABLE default.repairtable_filter SYNC PARTITIONS (p1 like 'b%');
+show partitions repairtable_filter;
+
+dfs -rmr ${system:test.local.warehouse.dir}/repairtable_filter/p1=bba;
+MSCK REPAIR TABLE default.repairtable_filter SYNC PARTITIONS (p1 like 'bb%');
+show partitions repairtable_filter;
+
 DROP TABLE repairtable_filter;
\ No newline at end of file
diff --git a/ql/src/test/results/clientpositive/llap/msck_repair_filter.q.out b/ql/src/test/results/clientpositive/llap/msck_repair_filter.q.out
index a295b91515..4480eeb6a4 100644
--- a/ql/src/test/results/clientpositive/llap/msck_repair_filter.q.out
+++ b/ql/src/test/results/clientpositive/llap/msck_repair_filter.q.out
@@ -368,6 +368,111 @@ p1=cob/p2=es
 p1=cobf/p2=ess
 p1=cp/p2=eg
 p1=cpa/p2=eg
+#### A masked pattern was here ####
+PREHOOK: query: MSCK REPAIR TABLE default.repairtable_filter SYNC PARTITIONS (p1='bbsc')
+PREHOOK: type: MSCK
+PREHOOK: Output: default@repairtable_filter
+POSTHOOK: query: MSCK REPAIR TABLE default.repairtable_filter SYNC PARTITIONS (p1='bbsc')
+POSTHOOK: type: MSCK
+POSTHOOK: Output: default@repairtable_filter
+Partitions missing from filesystem:	repairtable_filter:p1=bbsc/p2=e
+Repair: Dropped partition from metastore hive.default.repairtable_filter:p1=bbsc/p2=e
+PREHOOK: query: show partitions repairtable_filter
+PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@repairtable_filter
+POSTHOOK: query: show partitions repairtable_filter
+POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@repairtable_filter
+p1=b/p2=a
+p1=b/p2=e
+p1=bb/p2=e
+p1=bb/p2=ep
+p1=bba/p2=e
+p1=bbc/p2=e
+p1=bbe/p2=ep
+p1=bbqa/p2=eq
+p1=bbw/p2=e
+p1=ber/p2=ehb
+p1=bter/p2=ehb
+p1=bwbc/p2=eq
+p1=c/p2=a
+p1=c/p2=e
+p1=ca/p2=e
+p1=cab/p2=eb
+p1=cb/p2=e
+p1=cob/p2=es
+p1=cobf/p2=ess
+p1=cp/p2=eg
+p1=cpa/p2=eg
+#### A masked pattern was here ####
+PREHOOK: query: MSCK REPAIR TABLE default.repairtable_filter SYNC PARTITIONS (p1 like 'b%')
+PREHOOK: type: MSCK
+PREHOOK: Output: default@repairtable_filter
+POSTHOOK: query: MSCK REPAIR TABLE default.repairtable_filter SYNC PARTITIONS (p1 like 'b%')
+POSTHOOK: type: MSCK
+POSTHOOK: Output: default@repairtable_filter
+Partitions missing from filesystem:	repairtable_filter:p1=bbw/p2=e
+Repair: Dropped partition from metastore hive.default.repairtable_filter:p1=bbw/p2=e
+PREHOOK: query: show partitions repairtable_filter
+PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@repairtable_filter
+POSTHOOK: query: show partitions repairtable_filter
+POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@repairtable_filter
+p1=b/p2=a
+p1=b/p2=e
+p1=bb/p2=e
+p1=bb/p2=ep
+p1=bba/p2=e
+p1=bbc/p2=e
+p1=bbe/p2=ep
+p1=bbqa/p2=eq
+p1=ber/p2=ehb
+p1=bter/p2=ehb
+p1=bwbc/p2=eq
+p1=c/p2=a
+p1=c/p2=e
+p1=ca/p2=e
+p1=cab/p2=eb
+p1=cb/p2=e
+p1=cob/p2=es
+p1=cobf/p2=ess
+p1=cp/p2=eg
+p1=cpa/p2=eg
+#### A masked pattern was here ####
+PREHOOK: query: MSCK REPAIR TABLE default.repairtable_filter SYNC PARTITIONS (p1 like 'bb%')
+PREHOOK: type: MSCK
+PREHOOK: Output: default@repairtable_filter
+POSTHOOK: query: MSCK REPAIR TABLE default.repairtable_filter SYNC PARTITIONS (p1 like 'bb%')
+POSTHOOK: type: MSCK
+POSTHOOK: Output: default@repairtable_filter
+Partitions missing from filesystem:	repairtable_filter:p1=bba/p2=e
+Repair: Dropped partition from metastore hive.default.repairtable_filter:p1=bba/p2=e
+PREHOOK: query: show partitions repairtable_filter
+PREHOOK: type: SHOWPARTITIONS
+PREHOOK: Input: default@repairtable_filter
+POSTHOOK: query: show partitions repairtable_filter
+POSTHOOK: type: SHOWPARTITIONS
+POSTHOOK: Input: default@repairtable_filter
+p1=b/p2=a
+p1=b/p2=e
+p1=bb/p2=e
+p1=bb/p2=ep
+p1=bbc/p2=e
+p1=bbe/p2=ep
+p1=bbqa/p2=eq
+p1=ber/p2=ehb
+p1=bter/p2=ehb
+p1=bwbc/p2=eq
+p1=c/p2=a
+p1=c/p2=e
+p1=ca/p2=e
+p1=cab/p2=eb
+p1=cb/p2=e
+p1=cob/p2=es
+p1=cobf/p2=ess
+p1=cp/p2=eg
+p1=cpa/p2=eg
 PREHOOK: query: DROP TABLE repairtable_filter
 PREHOOK: type: DROPTABLE
 PREHOOK: Input: default@repairtable_filter
diff --git a/standalone-metastore/metastore-common/src/main/java/org/apache/hadoop/hive/metastore/PartitionExpressionProxy.java b/standalone-metastore/metastore-common/src/main/java/org/apache/hadoop/hive/metastore/PartitionExpressionProxy.java
index badb1caa3c..bd01fe5cf8 100644
--- a/standalone-metastore/metastore-common/src/main/java/org/apache/hadoop/hive/metastore/PartitionExpressionProxy.java
+++ b/standalone-metastore/metastore-common/src/main/java/org/apache/hadoop/hive/metastore/PartitionExpressionProxy.java
@@ -40,7 +40,7 @@ public interface PartitionExpressionProxy {
    * @param defaultPartitionName Default partition name.
    * @return Filter string.
    */
-  String convertExprToFilter(byte[] exprBytes, String defaultPartitionName) throws MetaException;
+  String convertExprToFilter(byte[] exprBytes, String defaultPartitionName, boolean decodeFilterExpToStr) throws MetaException;
 
   /**
    * Filters the partition names via serialized Hive expression.
diff --git a/standalone-metastore/metastore-common/src/main/java/org/apache/hadoop/hive/metastore/conf/MetastoreConf.java b/standalone-metastore/metastore-common/src/main/java/org/apache/hadoop/hive/metastore/conf/MetastoreConf.java
index f515d0944a..fe7965988d 100644
--- a/standalone-metastore/metastore-common/src/main/java/org/apache/hadoop/hive/metastore/conf/MetastoreConf.java
+++ b/standalone-metastore/metastore-common/src/main/java/org/apache/hadoop/hive/metastore/conf/MetastoreConf.java
@@ -622,6 +622,11 @@ public enum ConfVars {
     EXPRESSION_PROXY_CLASS("metastore.expression.proxy", "hive.metastore.expression.proxy",
         "org.apache.hadoop.hive.ql.optimizer.ppr.PartitionExpressionForMetastore",
         "Class to use to process expressions in partition pruning."),
+    DECODE_FILTER_EXPRESSION_TO_STRING("metastore.decode.filter.expression.tostring",
+        "hive.metastore.decode.filter.expression.tostring", false,
+        "If set to true convertExprToFilter method of PartitionExpressionForMetastore will decode \n" +
+            "byte array into string rather than ExprNode. This is specially required for \n" +
+            "msck command when used with filter conditions"),
     FILE_METADATA_THREADS("metastore.file.metadata.threads",
         "hive.metastore.hbase.file.metadata.threads", 1,
         "Number of threads to use to read file metadata in background to cache it."),
diff --git a/standalone-metastore/metastore-server/src/main/java/org/apache/hadoop/hive/metastore/DefaultPartitionExpressionProxy.java b/standalone-metastore/metastore-server/src/main/java/org/apache/hadoop/hive/metastore/DefaultPartitionExpressionProxy.java
index 583381784d..829d6cd478 100644
--- a/standalone-metastore/metastore-server/src/main/java/org/apache/hadoop/hive/metastore/DefaultPartitionExpressionProxy.java
+++ b/standalone-metastore/metastore-server/src/main/java/org/apache/hadoop/hive/metastore/DefaultPartitionExpressionProxy.java
@@ -30,7 +30,7 @@
  */
 public class DefaultPartitionExpressionProxy implements PartitionExpressionProxy {
   @Override
-  public String convertExprToFilter(byte[] expr, String defaultPartitionName) throws MetaException {
+  public String convertExprToFilter(byte[] expr, String defaultPartitionName, boolean decodeFilterExpToStr) throws MetaException {
     throw new UnsupportedOperationException();
   }
 
diff --git a/standalone-metastore/metastore-server/src/main/java/org/apache/hadoop/hive/metastore/MsckPartitionExpressionProxy.java b/standalone-metastore/metastore-server/src/main/java/org/apache/hadoop/hive/metastore/MsckPartitionExpressionProxy.java
index f9f0c86bfa..fcc0d8a264 100644
--- a/standalone-metastore/metastore-server/src/main/java/org/apache/hadoop/hive/metastore/MsckPartitionExpressionProxy.java
+++ b/standalone-metastore/metastore-server/src/main/java/org/apache/hadoop/hive/metastore/MsckPartitionExpressionProxy.java
@@ -46,7 +46,8 @@ public class MsckPartitionExpressionProxy implements PartitionExpressionProxy {
   private static final Logger LOG = LoggerFactory.getLogger(MsckPartitionExpressionProxy.class);
 
   @Override
-  public String convertExprToFilter(final byte[] exprBytes, final String defaultPartitionName) throws MetaException {
+  public String convertExprToFilter(final byte[] exprBytes, final String defaultPartitionName,
+                                    boolean decodeFilterExpToStr) throws MetaException {
     return new String(exprBytes, StandardCharsets.UTF_8);
   }
 
diff --git a/standalone-metastore/metastore-server/src/main/java/org/apache/hadoop/hive/metastore/ObjectStore.java b/standalone-metastore/metastore-server/src/main/java/org/apache/hadoop/hive/metastore/ObjectStore.java
index 8320bf6381..1296bae169 100644
--- a/standalone-metastore/metastore-server/src/main/java/org/apache/hadoop/hive/metastore/ObjectStore.java
+++ b/standalone-metastore/metastore-server/src/main/java/org/apache/hadoop/hive/metastore/ObjectStore.java
@@ -2992,7 +2992,7 @@ public List<String> listPartitionNames(final String catName, final String dbName
     ExpressionTree tmp = null;
     if (!isEmptyFilter) {
       tmp = PartFilterExprUtil.makeExpressionTree(expressionProxy, exprBytes,
-          getDefaultPartitionName(defaultPartName));
+          getDefaultPartitionName(defaultPartName), conf);
     }
     final ExpressionTree exprTree = tmp;
     return new GetListHelper<String>(catName, dbName, tblName, true, true) {
@@ -3592,7 +3592,7 @@ protected boolean getPartitionsByExprInternal(String catName, String dbName, Str
     assert result != null;
 
     final ExpressionTree exprTree = PartFilterExprUtil.makeExpressionTree(expressionProxy, expr,
-                                                    getDefaultPartitionName(defaultPartitionName));
+                                                    getDefaultPartitionName(defaultPartitionName), conf);
     final AtomicBoolean hasUnknownPartitions = new AtomicBoolean(false);
 
     catName = normalizeIdentifier(catName);
@@ -4141,7 +4141,7 @@ protected Integer getJdoResult(
   @Override
   public int getNumPartitionsByExpr(String catName, String dbName, String tblName,
                                     byte[] expr) throws MetaException, NoSuchObjectException {
-    final ExpressionTree exprTree = PartFilterExprUtil.makeExpressionTree(expressionProxy, expr, null);
+    final ExpressionTree exprTree = PartFilterExprUtil.makeExpressionTree(expressionProxy, expr, null, conf);
     final byte[] tempExpr = expr; // Need to be final to pass it to an inner class
 
     catName = normalizeIdentifier(catName);
diff --git a/standalone-metastore/metastore-server/src/main/java/org/apache/hadoop/hive/metastore/PartFilterExprUtil.java b/standalone-metastore/metastore-server/src/main/java/org/apache/hadoop/hive/metastore/PartFilterExprUtil.java
index 809d310253..bbde733983 100644
--- a/standalone-metastore/metastore-server/src/main/java/org/apache/hadoop/hive/metastore/PartFilterExprUtil.java
+++ b/standalone-metastore/metastore-server/src/main/java/org/apache/hadoop/hive/metastore/PartFilterExprUtil.java
@@ -40,12 +40,13 @@ public class PartFilterExprUtil {
 
 
   public static ExpressionTree makeExpressionTree(PartitionExpressionProxy expressionProxy,
-      byte[] expr, String defaultPartitionName) throws MetaException {
+      byte[] expr, String defaultPartitionName, Configuration conf) throws MetaException {
     // We will try pushdown first, so make the filter. This will also validate the expression,
     // if serialization fails we will throw incompatible metastore error to the client.
     String filter = null;
     try {
-      filter = expressionProxy.convertExprToFilter(expr, defaultPartitionName);
+      filter = expressionProxy.convertExprToFilter(expr, defaultPartitionName,
+          conf.getBoolean(MetastoreConf.ConfVars.DECODE_FILTER_EXPRESSION_TO_STRING.getVarname(), false));
     } catch (MetaException ex) {
       // TODO MS-SPLIT - for now we have construct this by reflection because IMetaStoreClient
       // can't be
diff --git a/standalone-metastore/metastore-server/src/test/java/org/apache/hadoop/hive/metastore/MockPartitionExpressionForMetastore.java b/standalone-metastore/metastore-server/src/test/java/org/apache/hadoop/hive/metastore/MockPartitionExpressionForMetastore.java
index 6e8b42de26..6531ecf4ba 100644
--- a/standalone-metastore/metastore-server/src/test/java/org/apache/hadoop/hive/metastore/MockPartitionExpressionForMetastore.java
+++ b/standalone-metastore/metastore-server/src/test/java/org/apache/hadoop/hive/metastore/MockPartitionExpressionForMetastore.java
@@ -30,7 +30,7 @@
  */
 public class MockPartitionExpressionForMetastore implements PartitionExpressionProxy {
   @Override
-  public String convertExprToFilter(byte[] expr, String defaultPartitionName) throws MetaException {
+  public String convertExprToFilter(byte[] expr, String defaultPartitionName, boolean decodeFilterExpToStr) throws MetaException {
     return null;
   }
 
diff --git a/standalone-metastore/metastore-server/src/test/java/org/apache/hadoop/hive/metastore/TestOldSchema.java b/standalone-metastore/metastore-server/src/test/java/org/apache/hadoop/hive/metastore/TestOldSchema.java
index 8e35235925..928686a46e 100644
--- a/standalone-metastore/metastore-server/src/test/java/org/apache/hadoop/hive/metastore/TestOldSchema.java
+++ b/standalone-metastore/metastore-server/src/test/java/org/apache/hadoop/hive/metastore/TestOldSchema.java
@@ -68,7 +68,7 @@ public class TestOldSchema {
 
   public static class MockPartitionExpressionProxy implements PartitionExpressionProxy {
     @Override
-    public String convertExprToFilter(byte[] expr, String defaultPartitionName) throws MetaException {
+    public String convertExprToFilter(byte[] expr, String defaultPartitionName, boolean decodeFilterExpToStr) throws MetaException {
       return null;
     }
 
