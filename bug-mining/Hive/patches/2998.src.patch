diff --git a/itests/src/test/resources/testconfiguration.properties b/itests/src/test/resources/testconfiguration.properties
index 9a7ceabfca..115d2cc499 100644
--- a/itests/src/test/resources/testconfiguration.properties
+++ b/itests/src/test/resources/testconfiguration.properties
@@ -8,6 +8,7 @@ minimr.query.files=auto_sortmerge_join_16.q,\
   bucketizedhiveinputformat.q,\
   bucketmapjoin6.q,\
   bucketmapjoin7.q,\
+  constprog_partitioner.q,\
   disable_merge_for_bucketing.q,\
   empty_dir_in_table.q,\
   external_table_with_space_in_location_path.q,\
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/ConstantPropagateProcFactory.java b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/ConstantPropagateProcFactory.java
index d175e643af..671b9c4409 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/optimizer/ConstantPropagateProcFactory.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/optimizer/ConstantPropagateProcFactory.java
@@ -889,15 +889,22 @@ public Object process(Node nd, Stack<Node> stack, NodeProcessorCtx ctx, Object..
       rsDesc.setKeyCols(newKeyEpxrs);
 
       // partition columns
-      ArrayList<ExprNodeDesc> newPartExprs = new ArrayList<ExprNodeDesc>();
-      for (ExprNodeDesc desc : rsDesc.getPartitionCols()) {
-        ExprNodeDesc expr = foldExpr(desc, constants, cppCtx, op, 0, false);
-        if (expr instanceof ExprNodeConstantDesc || expr instanceof ExprNodeNullDesc) {
-          continue;
+      if (!rsDesc.getPartitionCols().isEmpty()) {
+        ArrayList<ExprNodeDesc> newPartExprs = new ArrayList<ExprNodeDesc>();
+        for (ExprNodeDesc desc : rsDesc.getPartitionCols()) {
+          ExprNodeDesc expr = foldExpr(desc, constants, cppCtx, op, 0, false);
+          if (expr instanceof ExprNodeConstantDesc || expr instanceof ExprNodeNullDesc) {
+            continue;
+          }
+          newPartExprs.add(expr);
+        }
+        if (newPartExprs.isEmpty()) {
+          // If all partition columns are removed because of constant, insert an extra column to avoid
+          // random partitioning.
+          newPartExprs.add(new ExprNodeConstantDesc(""));
         }
-        newPartExprs.add(expr);
+        rsDesc.setPartitionCols(newPartExprs);
       }
-      rsDesc.setPartitionCols(newPartExprs);
 
       // value columns
       ArrayList<ExprNodeDesc> newValExprs = new ArrayList<ExprNodeDesc>();
diff --git a/ql/src/test/queries/clientpositive/constprog_partitioner.q b/ql/src/test/queries/clientpositive/constprog_partitioner.q
new file mode 100644
index 0000000000..5b242c06e3
--- /dev/null
+++ b/ql/src/test/queries/clientpositive/constprog_partitioner.q
@@ -0,0 +1,11 @@
+set hive.fetch.task.conversion=more;
+set hive.optimize.constant.propagation=true;
+
+set mapred.reduce.tasks=4;
+
+EXPLAIN
+SELECT src1.key, src1.key + 1, src2.value
+       FROM src src1 join src src2 ON src1.key = src2.key AND src1.key = 100;
+
+SELECT src1.key, src1.key + 1, src2.value
+       FROM src src1 join src src2 ON src1.key = src2.key AND src1.key = 100;
diff --git a/ql/src/test/results/clientpositive/cluster.q.out b/ql/src/test/results/clientpositive/cluster.q.out
index 15316f84b6..d5eca8a9f4 100644
--- a/ql/src/test/results/clientpositive/cluster.q.out
+++ b/ql/src/test/results/clientpositive/cluster.q.out
@@ -25,6 +25,7 @@ STAGE PLANS:
                 Reduce Output Operator
                   key expressions: '10' (type: string)
                   sort order: +
+                  Map-reduce partition columns: '' (type: string)
                   Statistics: Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                   value expressions: _col1 (type: string)
       Reduce Operator Tree:
@@ -82,6 +83,7 @@ STAGE PLANS:
                 Reduce Output Operator
                   key expressions: '20' (type: string)
                   sort order: +
+                  Map-reduce partition columns: '' (type: string)
                   Statistics: Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                   value expressions: _col1 (type: string)
       Reduce Operator Tree:
@@ -139,6 +141,7 @@ STAGE PLANS:
                 Reduce Output Operator
                   key expressions: '20' (type: string)
                   sort order: +
+                  Map-reduce partition columns: '' (type: string)
                   Statistics: Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                   value expressions: _col1 (type: string)
       Reduce Operator Tree:
@@ -196,6 +199,7 @@ STAGE PLANS:
                 Reduce Output Operator
                   key expressions: '20' (type: string)
                   sort order: +
+                  Map-reduce partition columns: '' (type: string)
                   Statistics: Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                   value expressions: _col1 (type: string)
       Reduce Operator Tree:
@@ -253,6 +257,7 @@ STAGE PLANS:
                 Reduce Output Operator
                   key expressions: '20' (type: string)
                   sort order: +
+                  Map-reduce partition columns: '' (type: string)
                   Statistics: Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                   value expressions: _col1 (type: string)
       Reduce Operator Tree:
@@ -310,6 +315,7 @@ STAGE PLANS:
                 Reduce Output Operator
                   key expressions: '20' (type: string)
                   sort order: +
+                  Map-reduce partition columns: '' (type: string)
                   Statistics: Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                   value expressions: _col1 (type: string)
       Reduce Operator Tree:
@@ -424,6 +430,7 @@ STAGE PLANS:
                 Reduce Output Operator
                   key expressions: '20' (type: string)
                   sort order: +
+                  Map-reduce partition columns: '' (type: string)
                   Statistics: Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                   value expressions: _col1 (type: string)
       Reduce Operator Tree:
@@ -478,6 +485,7 @@ STAGE PLANS:
               Reduce Output Operator
                 key expressions: '20' (type: string)
                 sort order: +
+                Map-reduce partition columns: '' (type: string)
                 Statistics: Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                 value expressions: value (type: string)
           TableScan
@@ -489,6 +497,7 @@ STAGE PLANS:
               Reduce Output Operator
                 key expressions: '20' (type: string)
                 sort order: +
+                Map-reduce partition columns: '' (type: string)
                 Statistics: Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
       Reduce Operator Tree:
         Join Operator
@@ -567,6 +576,7 @@ STAGE PLANS:
               Reduce Output Operator
                 key expressions: '20' (type: string)
                 sort order: +
+                Map-reduce partition columns: '' (type: string)
                 Statistics: Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                 value expressions: value (type: string)
           TableScan
@@ -578,6 +588,7 @@ STAGE PLANS:
               Reduce Output Operator
                 key expressions: '20' (type: string)
                 sort order: +
+                Map-reduce partition columns: '' (type: string)
                 Statistics: Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                 value expressions: value (type: string)
       Reduce Operator Tree:
@@ -662,6 +673,7 @@ STAGE PLANS:
               Reduce Output Operator
                 key expressions: '20' (type: string)
                 sort order: +
+                Map-reduce partition columns: '' (type: string)
                 Statistics: Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                 value expressions: value (type: string)
           TableScan
@@ -673,6 +685,7 @@ STAGE PLANS:
               Reduce Output Operator
                 key expressions: '20' (type: string)
                 sort order: +
+                Map-reduce partition columns: '' (type: string)
                 Statistics: Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                 value expressions: value (type: string)
       Reduce Operator Tree:
@@ -702,6 +715,7 @@ STAGE PLANS:
             Reduce Output Operator
               key expressions: '20' (type: string)
               sort order: +
+              Map-reduce partition columns: '' (type: string)
               Statistics: Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
               value expressions: _col1 (type: string), _col3 (type: string)
       Reduce Operator Tree:
@@ -756,6 +770,7 @@ STAGE PLANS:
               Reduce Output Operator
                 key expressions: '20' (type: string)
                 sort order: +
+                Map-reduce partition columns: '' (type: string)
                 Statistics: Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                 value expressions: value (type: string)
           TableScan
@@ -767,6 +782,7 @@ STAGE PLANS:
               Reduce Output Operator
                 key expressions: '20' (type: string)
                 sort order: +
+                Map-reduce partition columns: '' (type: string)
                 Statistics: Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
       Reduce Operator Tree:
         Join Operator
@@ -795,6 +811,7 @@ STAGE PLANS:
             Reduce Output Operator
               key expressions: '20' (type: string)
               sort order: +
+              Map-reduce partition columns: '' (type: string)
               Statistics: Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
               value expressions: _col1 (type: string), _col2 (type: string)
       Reduce Operator Tree:
diff --git a/ql/src/test/results/clientpositive/constprog2.q.out b/ql/src/test/results/clientpositive/constprog2.q.out
index 4c8b7c8687..a52cda1837 100644
--- a/ql/src/test/results/clientpositive/constprog2.q.out
+++ b/ql/src/test/results/clientpositive/constprog2.q.out
@@ -23,6 +23,7 @@ STAGE PLANS:
               Reduce Output Operator
                 key expressions: '86' (type: string)
                 sort order: +
+                Map-reduce partition columns: '' (type: string)
                 Statistics: Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
           TableScan
             alias: src2
@@ -33,6 +34,7 @@ STAGE PLANS:
               Reduce Output Operator
                 key expressions: '86' (type: string)
                 sort order: +
+                Map-reduce partition columns: '' (type: string)
                 Statistics: Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                 value expressions: value (type: string)
       Reduce Operator Tree:
@@ -98,6 +100,7 @@ STAGE PLANS:
               Reduce Output Operator
                 key expressions: '86' (type: string)
                 sort order: +
+                Map-reduce partition columns: '' (type: string)
                 Statistics: Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
           TableScan
             alias: src2
@@ -108,6 +111,7 @@ STAGE PLANS:
               Reduce Output Operator
                 key expressions: '86' (type: string)
                 sort order: +
+                Map-reduce partition columns: '' (type: string)
                 Statistics: Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                 value expressions: value (type: string)
       Reduce Operator Tree:
diff --git a/ql/src/test/results/clientpositive/constprog_partitioner.q.out b/ql/src/test/results/clientpositive/constprog_partitioner.q.out
new file mode 100644
index 0000000000..813d87c63a
--- /dev/null
+++ b/ql/src/test/results/clientpositive/constprog_partitioner.q.out
@@ -0,0 +1,80 @@
+PREHOOK: query: EXPLAIN
+SELECT src1.key, src1.key + 1, src2.value
+       FROM src src1 join src src2 ON src1.key = src2.key AND src1.key = 100
+PREHOOK: type: QUERY
+POSTHOOK: query: EXPLAIN
+SELECT src1.key, src1.key + 1, src2.value
+       FROM src src1 join src src2 ON src1.key = src2.key AND src1.key = 100
+POSTHOOK: type: QUERY
+STAGE DEPENDENCIES:
+  Stage-1 is a root stage
+  Stage-0 depends on stages: Stage-1
+
+STAGE PLANS:
+  Stage: Stage-1
+    Map Reduce
+      Map Operator Tree:
+          TableScan
+            alias: src1
+            Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
+            Filter Operator
+              predicate: (key = 100) (type: boolean)
+              Statistics: Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
+              Reduce Output Operator
+                key expressions: '100' (type: string)
+                sort order: +
+                Map-reduce partition columns: '' (type: string)
+                Statistics: Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
+          TableScan
+            alias: src2
+            Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
+            Filter Operator
+              predicate: (key = 100) (type: boolean)
+              Statistics: Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
+              Reduce Output Operator
+                key expressions: '100' (type: string)
+                sort order: +
+                Map-reduce partition columns: '' (type: string)
+                Statistics: Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
+                value expressions: value (type: string)
+      Reduce Operator Tree:
+        Join Operator
+          condition map:
+               Inner Join 0 to 1
+          condition expressions:
+            0 
+            1 {VALUE._col0}
+          outputColumnNames: _col6
+          Statistics: Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
+          Select Operator
+            expressions: '100' (type: string), 101.0 (type: double), _col6 (type: string)
+            outputColumnNames: _col0, _col1, _col2
+            Statistics: Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
+            File Output Operator
+              compressed: false
+              Statistics: Num rows: 275 Data size: 2921 Basic stats: COMPLETE Column stats: NONE
+              table:
+                  input format: org.apache.hadoop.mapred.TextInputFormat
+                  output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat
+                  serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
+
+  Stage: Stage-0
+    Fetch Operator
+      limit: -1
+      Processor Tree:
+        ListSink
+
+PREHOOK: query: SELECT src1.key, src1.key + 1, src2.value
+       FROM src src1 join src src2 ON src1.key = src2.key AND src1.key = 100
+PREHOOK: type: QUERY
+PREHOOK: Input: default@src
+#### A masked pattern was here ####
+POSTHOOK: query: SELECT src1.key, src1.key + 1, src2.value
+       FROM src src1 join src src2 ON src1.key = src2.key AND src1.key = 100
+POSTHOOK: type: QUERY
+POSTHOOK: Input: default@src
+#### A masked pattern was here ####
+100	101.0	val_100
+100	101.0	val_100
+100	101.0	val_100
+100	101.0	val_100
diff --git a/ql/src/test/results/clientpositive/join_nullsafe.q.out b/ql/src/test/results/clientpositive/join_nullsafe.q.out
index 817614f974..cf33c8a4f5 100644
--- a/ql/src/test/results/clientpositive/join_nullsafe.q.out
+++ b/ql/src/test/results/clientpositive/join_nullsafe.q.out
@@ -1525,6 +1525,7 @@ STAGE PLANS:
               Reduce Output Operator
                 key expressions: null (type: void)
                 sort order: +
+                Map-reduce partition columns: '' (type: string)
                 Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                 value expressions: value (type: int)
           TableScan
@@ -1536,6 +1537,7 @@ STAGE PLANS:
               Reduce Output Operator
                 key expressions: null (type: void)
                 sort order: +
+                Map-reduce partition columns: '' (type: string)
                 Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                 value expressions: key (type: int)
       Reduce Operator Tree:
diff --git a/ql/src/test/results/clientpositive/ppd2.q.out b/ql/src/test/results/clientpositive/ppd2.q.out
index 5fa19559a6..5752b383df 100644
--- a/ql/src/test/results/clientpositive/ppd2.q.out
+++ b/ql/src/test/results/clientpositive/ppd2.q.out
@@ -351,6 +351,7 @@ STAGE PLANS:
               Reduce Output Operator
                 key expressions: '20' (type: string)
                 sort order: +
+                Map-reduce partition columns: '' (type: string)
                 Statistics: Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                 value expressions: value (type: string)
           TableScan
@@ -362,6 +363,7 @@ STAGE PLANS:
               Reduce Output Operator
                 key expressions: '20' (type: string)
                 sort order: +
+                Map-reduce partition columns: '' (type: string)
                 Statistics: Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
       Reduce Operator Tree:
         Join Operator
diff --git a/ql/src/test/results/clientpositive/ppd_clusterby.q.out b/ql/src/test/results/clientpositive/ppd_clusterby.q.out
index c727262808..9402fa2998 100644
--- a/ql/src/test/results/clientpositive/ppd_clusterby.q.out
+++ b/ql/src/test/results/clientpositive/ppd_clusterby.q.out
@@ -25,6 +25,7 @@ STAGE PLANS:
                 Reduce Output Operator
                   key expressions: '10' (type: string)
                   sort order: +
+                  Map-reduce partition columns: '' (type: string)
                   Statistics: Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                   value expressions: _col1 (type: string)
       Reduce Operator Tree:
@@ -79,6 +80,7 @@ STAGE PLANS:
               Reduce Output Operator
                 key expressions: '20' (type: string)
                 sort order: +
+                Map-reduce partition columns: '' (type: string)
                 Statistics: Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                 value expressions: value (type: string)
           TableScan
@@ -90,6 +92,7 @@ STAGE PLANS:
               Reduce Output Operator
                 key expressions: '20' (type: string)
                 sort order: +
+                Map-reduce partition columns: '' (type: string)
                 Statistics: Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
       Reduce Operator Tree:
         Join Operator
@@ -171,6 +174,7 @@ STAGE PLANS:
                 Reduce Output Operator
                   key expressions: '10' (type: string)
                   sort order: +
+                  Map-reduce partition columns: '' (type: string)
                   Statistics: Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                   value expressions: _col1 (type: string)
       Reduce Operator Tree:
@@ -225,6 +229,7 @@ STAGE PLANS:
               Reduce Output Operator
                 key expressions: '20' (type: string)
                 sort order: +
+                Map-reduce partition columns: '' (type: string)
                 Statistics: Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
                 value expressions: value (type: string)
           TableScan
@@ -236,6 +241,7 @@ STAGE PLANS:
               Reduce Output Operator
                 key expressions: '20' (type: string)
                 sort order: +
+                Map-reduce partition columns: '' (type: string)
                 Statistics: Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
       Reduce Operator Tree:
         Join Operator
diff --git a/ql/src/test/results/clientpositive/ppd_join4.q.out b/ql/src/test/results/clientpositive/ppd_join4.q.out
index def2460266..8038f7f6d5 100644
--- a/ql/src/test/results/clientpositive/ppd_join4.q.out
+++ b/ql/src/test/results/clientpositive/ppd_join4.q.out
@@ -69,6 +69,7 @@ STAGE PLANS:
         Reduce Output Operator
           key expressions: 'a' (type: string)
           sort order: +
+          Map-reduce partition columns: '' (type: string)
           Statistics: Num rows: 0 Data size: 0 Basic stats: NONE Column stats: NONE
 
   Stage: Stage-2
@@ -78,6 +79,7 @@ STAGE PLANS:
             Reduce Output Operator
               key expressions: 'a' (type: string)
               sort order: +
+              Map-reduce partition columns: '' (type: string)
               Statistics: Num rows: 0 Data size: 0 Basic stats: NONE Column stats: NONE
           TableScan
             alias: t3
@@ -88,6 +90,7 @@ STAGE PLANS:
               Reduce Output Operator
                 key expressions: 'a' (type: string)
                 sort order: +
+                Map-reduce partition columns: '' (type: string)
                 Statistics: Num rows: 0 Data size: 0 Basic stats: NONE Column stats: NONE
       Reduce Operator Tree:
         Join Operator
diff --git a/ql/src/test/results/clientpositive/ppd_outer_join5.q.out b/ql/src/test/results/clientpositive/ppd_outer_join5.q.out
index 9efaf4fa14..c43ae810f0 100644
--- a/ql/src/test/results/clientpositive/ppd_outer_join5.q.out
+++ b/ql/src/test/results/clientpositive/ppd_outer_join5.q.out
@@ -75,6 +75,7 @@ STAGE PLANS:
               Reduce Output Operator
                 key expressions: 20 (type: int)
                 sort order: +
+                Map-reduce partition columns: '' (type: string)
                 Statistics: Num rows: 0 Data size: 0 Basic stats: NONE Column stats: NONE
                 value expressions: key (type: string), value (type: string)
       Reduce Operator Tree:
@@ -127,6 +128,7 @@ STAGE PLANS:
               Reduce Output Operator
                 key expressions: 20 (type: int)
                 sort order: +
+                Map-reduce partition columns: '' (type: string)
                 Statistics: Num rows: 0 Data size: 0 Basic stats: NONE Column stats: NONE
                 value expressions: key (type: string), value (type: string)
           TableScan
@@ -138,6 +140,7 @@ STAGE PLANS:
               Reduce Output Operator
                 key expressions: 20 (type: int)
                 sort order: +
+                Map-reduce partition columns: '' (type: string)
                 Statistics: Num rows: 0 Data size: 0 Basic stats: NONE Column stats: NONE
                 value expressions: key (type: string), value (type: string)
           TableScan
@@ -202,6 +205,7 @@ STAGE PLANS:
               Reduce Output Operator
                 key expressions: 20 (type: int)
                 sort order: +
+                Map-reduce partition columns: '' (type: string)
                 Statistics: Num rows: 0 Data size: 0 Basic stats: NONE Column stats: NONE
                 value expressions: key (type: string), value (type: string)
           TableScan
@@ -213,6 +217,7 @@ STAGE PLANS:
               Reduce Output Operator
                 key expressions: 20 (type: int)
                 sort order: +
+                Map-reduce partition columns: '' (type: string)
                 Statistics: Num rows: 0 Data size: 0 Basic stats: NONE Column stats: NONE
                 value expressions: key (type: string), value (type: string)
           TableScan
diff --git a/ql/src/test/results/clientpositive/quotedid_basic.q.out b/ql/src/test/results/clientpositive/quotedid_basic.q.out
index 725a0fca8d..61edf3931a 100644
--- a/ql/src/test/results/clientpositive/quotedid_basic.q.out
+++ b/ql/src/test/results/clientpositive/quotedid_basic.q.out
@@ -193,6 +193,7 @@ STAGE PLANS:
             Reduce Output Operator
               key expressions: '1' (type: string), _col1 (type: string)
               sort order: ++
+              Map-reduce partition columns: '' (type: string)
               Statistics: Num rows: 0 Data size: 0 Basic stats: NONE Column stats: NONE
               value expressions: _col0 (type: string), _col1 (type: string), '1' (type: string)
       Reduce Operator Tree:
@@ -275,6 +276,7 @@ STAGE PLANS:
             Reduce Output Operator
               key expressions: '1' (type: string), _col1 (type: string)
               sort order: ++
+              Map-reduce partition columns: '' (type: string)
               Statistics: Num rows: 0 Data size: 0 Basic stats: NONE Column stats: NONE
               value expressions: _col0 (type: string), _col1 (type: string), '1' (type: string)
       Reduce Operator Tree:
diff --git a/ql/src/test/results/clientpositive/smb_mapjoin_25.q.out b/ql/src/test/results/clientpositive/smb_mapjoin_25.q.out
index cb7d65cbc8..c2016feced 100644
--- a/ql/src/test/results/clientpositive/smb_mapjoin_25.q.out
+++ b/ql/src/test/results/clientpositive/smb_mapjoin_25.q.out
@@ -71,6 +71,7 @@ STAGE PLANS:
               Reduce Output Operator
                 key expressions: 5 (type: int)
                 sort order: +
+                Map-reduce partition columns: '' (type: string)
                 Statistics: Num rows: 26 Data size: 104 Basic stats: COMPLETE Column stats: NONE
           TableScan
             alias: b
@@ -81,6 +82,7 @@ STAGE PLANS:
               Reduce Output Operator
                 key expressions: 5 (type: int)
                 sort order: +
+                Map-reduce partition columns: '' (type: string)
                 Statistics: Num rows: 25 Data size: 100 Basic stats: COMPLETE Column stats: NONE
       Reduce Operator Tree:
         Join Operator
@@ -152,6 +154,7 @@ STAGE PLANS:
               Reduce Output Operator
                 key expressions: 5 (type: int)
                 sort order: +
+                Map-reduce partition columns: '' (type: string)
                 Statistics: Num rows: 25 Data size: 100 Basic stats: COMPLETE Column stats: NONE
           TableScan
             alias: d
@@ -162,6 +165,7 @@ STAGE PLANS:
               Reduce Output Operator
                 key expressions: 5 (type: int)
                 sort order: +
+                Map-reduce partition columns: '' (type: string)
                 Statistics: Num rows: 27 Data size: 108 Basic stats: COMPLETE Column stats: NONE
       Reduce Operator Tree:
         Join Operator
diff --git a/ql/src/test/results/clientpositive/tez/dynamic_partition_pruning.q.out b/ql/src/test/results/clientpositive/tez/dynamic_partition_pruning.q.out
index 6dba0098f5..32fb214aac 100644
--- a/ql/src/test/results/clientpositive/tez/dynamic_partition_pruning.q.out
+++ b/ql/src/test/results/clientpositive/tez/dynamic_partition_pruning.q.out
@@ -2635,6 +2635,7 @@ STAGE PLANS:
                     Reduce Output Operator
                       key expressions: '11' (type: string)
                       sort order: +
+                      Map-reduce partition columns: '' (type: string)
                       Statistics: Num rows: 0 Data size: 0 Basic stats: NONE Column stats: NONE
                     Select Operator
                       expressions: '11' (type: string)
@@ -2666,6 +2667,7 @@ STAGE PLANS:
                 Reduce Output Operator
                   key expressions: '11' (type: string)
                   sort order: +
+                  Map-reduce partition columns: '' (type: string)
                   Statistics: Num rows: 1100 Data size: 11686 Basic stats: COMPLETE Column stats: NONE
         Reducer 3 
             Reduce Operator Tree:
@@ -2778,6 +2780,7 @@ STAGE PLANS:
                     Reduce Output Operator
                       key expressions: '13' (type: string)
                       sort order: +
+                      Map-reduce partition columns: '' (type: string)
                       Statistics: Num rows: 1 Data size: 5 Basic stats: COMPLETE Column stats: NONE
         Reducer 2 
             Reduce Operator Tree:
@@ -2794,6 +2797,7 @@ STAGE PLANS:
                 Reduce Output Operator
                   key expressions: '13' (type: string)
                   sort order: +
+                  Map-reduce partition columns: '' (type: string)
                   Statistics: Num rows: 0 Data size: 0 Basic stats: NONE Column stats: NONE
         Reducer 3 
             Reduce Operator Tree:
@@ -4789,6 +4793,7 @@ STAGE PLANS:
                     Reduce Output Operator
                       key expressions: '11' (type: string)
                       sort order: +
+                      Map-reduce partition columns: '' (type: string)
                       Statistics: Num rows: 0 Data size: 0 Basic stats: NONE Column stats: NONE
                     Select Operator
                       expressions: '11' (type: string)
diff --git a/ql/src/test/results/clientpositive/tez/dynamic_partition_pruning_2.q.out b/ql/src/test/results/clientpositive/tez/dynamic_partition_pruning_2.q.out
index aa5c9e34d8..a189761ce5 100644
--- a/ql/src/test/results/clientpositive/tez/dynamic_partition_pruning_2.q.out
+++ b/ql/src/test/results/clientpositive/tez/dynamic_partition_pruning_2.q.out
@@ -614,6 +614,7 @@ STAGE PLANS:
                     Reduce Output Operator
                       key expressions: 1 (type: int)
                       sort order: +
+                      Map-reduce partition columns: '' (type: string)
                       Statistics: Num rows: 1 Data size: 5 Basic stats: COMPLETE Column stats: NONE
 
   Stage: Stage-0
diff --git a/ql/src/test/results/clientpositive/tez/join_nullsafe.q.out b/ql/src/test/results/clientpositive/tez/join_nullsafe.q.out
index f86cde4ca6..f0fce6889d 100644
--- a/ql/src/test/results/clientpositive/tez/join_nullsafe.q.out
+++ b/ql/src/test/results/clientpositive/tez/join_nullsafe.q.out
@@ -1597,6 +1597,7 @@ STAGE PLANS:
                     Reduce Output Operator
                       key expressions: null (type: void)
                       sort order: +
+                      Map-reduce partition columns: '' (type: string)
                       Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                       value expressions: value (type: int)
         Map 3 
@@ -1610,6 +1611,7 @@ STAGE PLANS:
                     Reduce Output Operator
                       key expressions: null (type: void)
                       sort order: +
+                      Map-reduce partition columns: '' (type: string)
                       Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: NONE
                       value expressions: key (type: int)
         Reducer 2 
diff --git a/ql/src/test/results/clientpositive/tez/vector_decimal_mapjoin.q.out b/ql/src/test/results/clientpositive/tez/vector_decimal_mapjoin.q.out
index 3fb47f5722..92d30d3f2b 100644
--- a/ql/src/test/results/clientpositive/tez/vector_decimal_mapjoin.q.out
+++ b/ql/src/test/results/clientpositive/tez/vector_decimal_mapjoin.q.out
@@ -85,6 +85,7 @@ STAGE PLANS:
                     Reduce Output Operator
                       key expressions: 6981 (type: int)
                       sort order: +
+                      Map-reduce partition columns: '' (type: string)
                       Statistics: Num rows: 6144 Data size: 1082530 Basic stats: COMPLETE Column stats: NONE
                       value expressions: cdecimal2 (type: decimal(23,14))
             Execution mode: vectorized
diff --git a/ql/src/test/results/clientpositive/tez/vectorized_dynamic_partition_pruning.q.out b/ql/src/test/results/clientpositive/tez/vectorized_dynamic_partition_pruning.q.out
index 23322e8fba..ad243eda88 100644
--- a/ql/src/test/results/clientpositive/tez/vectorized_dynamic_partition_pruning.q.out
+++ b/ql/src/test/results/clientpositive/tez/vectorized_dynamic_partition_pruning.q.out
@@ -2666,6 +2666,7 @@ STAGE PLANS:
                     Reduce Output Operator
                       key expressions: '11' (type: string)
                       sort order: +
+                      Map-reduce partition columns: '' (type: string)
                       Statistics: Num rows: 0 Data size: 0 Basic stats: NONE Column stats: NONE
                     Select Operator
                       expressions: '11' (type: string)
@@ -2697,6 +2698,7 @@ STAGE PLANS:
                 Reduce Output Operator
                   key expressions: '11' (type: string)
                   sort order: +
+                  Map-reduce partition columns: '' (type: string)
                   Statistics: Num rows: 1100 Data size: 11686 Basic stats: COMPLETE Column stats: NONE
         Reducer 3 
             Reduce Operator Tree:
@@ -2811,6 +2813,7 @@ STAGE PLANS:
                     Reduce Output Operator
                       key expressions: '13' (type: string)
                       sort order: +
+                      Map-reduce partition columns: '' (type: string)
                       Statistics: Num rows: 1 Data size: 172 Basic stats: COMPLETE Column stats: NONE
         Reducer 2 
             Reduce Operator Tree:
@@ -2827,6 +2830,7 @@ STAGE PLANS:
                 Reduce Output Operator
                   key expressions: '13' (type: string)
                   sort order: +
+                  Map-reduce partition columns: '' (type: string)
                   Statistics: Num rows: 0 Data size: 0 Basic stats: NONE Column stats: NONE
         Reducer 3 
             Reduce Operator Tree:
@@ -4844,6 +4848,7 @@ STAGE PLANS:
                     Reduce Output Operator
                       key expressions: '11' (type: string)
                       sort order: +
+                      Map-reduce partition columns: '' (type: string)
                       Statistics: Num rows: 0 Data size: 0 Basic stats: NONE Column stats: NONE
                     Select Operator
                       expressions: '11' (type: string)
diff --git a/ql/src/test/results/clientpositive/union27.q.out b/ql/src/test/results/clientpositive/union27.q.out
index 036bf8a1cc..d7e82a60fd 100644
--- a/ql/src/test/results/clientpositive/union27.q.out
+++ b/ql/src/test/results/clientpositive/union27.q.out
@@ -51,6 +51,7 @@ STAGE PLANS:
               Reduce Output Operator
                 key expressions: '97' (type: string)
                 sort order: +
+                Map-reduce partition columns: '' (type: string)
                 Statistics: Num rows: 250 Data size: 2656 Basic stats: COMPLETE Column stats: NONE
           TableScan
             alias: jackson_sev_add
@@ -67,6 +68,7 @@ STAGE PLANS:
                   Reduce Output Operator
                     key expressions: '97' (type: string)
                     sort order: +
+                    Map-reduce partition columns: '' (type: string)
                     Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                     value expressions: _col1 (type: string)
           TableScan
@@ -84,6 +86,7 @@ STAGE PLANS:
                   Reduce Output Operator
                     key expressions: '97' (type: string)
                     sort order: +
+                    Map-reduce partition columns: '' (type: string)
                     Statistics: Num rows: 500 Data size: 5312 Basic stats: COMPLETE Column stats: NONE
                     value expressions: _col1 (type: string)
       Reduce Operator Tree:
