diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/tez/DagUtils.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/tez/DagUtils.java
index 445e772b29..e20d8bf386 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/tez/DagUtils.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/tez/DagUtils.java
@@ -599,6 +599,24 @@ public List<LocalResource> localizeTempFiles(Configuration conf) throws IOExcept
 
     // we need the directory on hdfs to which we shall put all these files
     // Use HIVE_JAR_DIRECTORY only if it's set explicitly; otherwise use default directory
+    String hdfsDirPathStr = getHiveJarDirectory(conf);
+
+    String allFiles = auxJars + "," + addedJars + "," + addedFiles + "," + addedArchives;
+    String[] allFilesArr = allFiles.split(",");
+    for (String file : allFilesArr) {
+      if (!StringUtils.isNotBlank(file)) {
+        continue;
+      }
+      String hdfsFilePathStr = hdfsDirPathStr + "/" + getResourceBaseName(file);
+      LocalResource localResource = localizeResource(new Path(file),
+          new Path(hdfsFilePathStr), conf);
+      tmpResources.add(localResource);
+    }
+
+    return tmpResources;
+  }
+
+  public String getHiveJarDirectory(Configuration conf) throws IOException, LoginException {
     FileStatus fstatus = null;
     String hdfsDirPathStr = HiveConf.getVar(conf, HiveConf.ConfVars.HIVE_JAR_DIRECTORY, null);
     if (hdfsDirPathStr != null) {
@@ -618,20 +636,7 @@ public List<LocalResource> localizeTempFiles(Configuration conf) throws IOExcept
       Path destDir = getDefaultDestDir(conf);
       hdfsDirPathStr = destDir.toString();
     }
-
-    String allFiles = auxJars + "," + addedJars + "," + addedFiles + "," + addedArchives;
-    String[] allFilesArr = allFiles.split(",");
-    for (String file : allFilesArr) {
-      if (!StringUtils.isNotBlank(file)) {
-        continue;
-      }
-      String hdfsFilePathStr = hdfsDirPathStr + "/" + getResourceBaseName(file);
-      LocalResource localResource = localizeResource(new Path(file),
-          new Path(hdfsFilePathStr), conf);
-      tmpResources.add(localResource);
-    }
-
-    return tmpResources;
+    return hdfsDirPathStr;
   }
 
   // the api that finds the jar being used by this class on disk
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/tez/TezSessionState.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/tez/TezSessionState.java
index 1399ffc444..3262ae3ef5 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/tez/TezSessionState.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/tez/TezSessionState.java
@@ -247,7 +247,7 @@ private Path createTezDir(String sessionId)
    */
   private LocalResource createHiveExecLocalResource()
     throws IOException, LoginException, URISyntaxException {
-    String hiveJarDir = conf.getVar(HiveConf.ConfVars.HIVE_JAR_DIRECTORY);
+    String hiveJarDir = utils.getHiveJarDirectory(conf);
     String currentVersionPathStr = utils.getExecJarPathLocal();
     String currentJarName = utils.getResourceBaseName(currentVersionPathStr);
     FileSystem fs = null;
