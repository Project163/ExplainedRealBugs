diff --git a/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFFromUnixTime.java b/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFFromUnixTime.java
index 4138b4e085..66418ac749 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFFromUnixTime.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFFromUnixTime.java
@@ -107,7 +107,8 @@ public ObjectInspector initialize(ObjectInspector[] arguments) throws UDFArgumen
     }
 
     if (timeZone == null) {
-      timeZone = SessionState.get().getConf().getLocalTimeZone();
+      timeZone = SessionState.get() == null ? new HiveConf().getLocalTimeZone() : SessionState.get().getConf()
+              .getLocalTimeZone();
       formatter.setTimeZone(TimeZone.getTimeZone(timeZone));
     }
 
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFToUnixTimeStamp.java b/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFToUnixTimeStamp.java
index 163ad38a9f..4a30654a83 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFToUnixTimeStamp.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/udf/generic/GenericUDFToUnixTimeStamp.java
@@ -123,7 +123,8 @@ protected void initializeInput(ObjectInspector[] arguments) throws UDFArgumentEx
     }
 
     if (timeZone == null) {
-      timeZone = SessionState.get().getConf().getLocalTimeZone();
+      timeZone = SessionState.get() == null ? new HiveConf().getLocalTimeZone() : SessionState.get().getConf()
+              .getLocalTimeZone();
       formatter.setTimeZone(TimeZone.getTimeZone(timeZone));
     }
   }
