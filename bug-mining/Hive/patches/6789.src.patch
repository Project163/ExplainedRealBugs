diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/ExplainTask.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/ExplainTask.java
index da20d2efd8..65ec4b27bd 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/ExplainTask.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/ExplainTask.java
@@ -402,6 +402,11 @@ public int execute(DriverContext driverContext) {
         if(work.isFormatted()) {
           out.print(jsonLocks);
         }
+      } else if (work.isAst()) {
+        // Print out the parse AST
+        if (work.getAstStringTree() != null) {
+          outputAST(work.getAstStringTree(), out, work.isFormatted(), 0);
+        }
       } else {
         if (work.isUserLevelExplain()) {
           // Because of the implementation of the JsonParserFactory, we are sure
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/hooks/ATSHook.java b/ql/src/java/org/apache/hadoop/hive/ql/hooks/ATSHook.java
index fa69f13965..92fcfec673 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/hooks/ATSHook.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/hooks/ATSHook.java
@@ -264,6 +264,7 @@ public void run() {
                   null,// pCtx
                   plan.getRootTasks(),// RootTasks
                   plan.getFetchTask(),// FetchTask
+                      null,
                   null,// analyzer
                   config, //explainConfig
                   null, // cboInfo
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/hooks/HiveProtoLoggingHook.java b/ql/src/java/org/apache/hadoop/hive/ql/hooks/HiveProtoLoggingHook.java
index 8f7c53f09e..673c858e36 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/hooks/HiveProtoLoggingHook.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/hooks/HiveProtoLoggingHook.java
@@ -480,7 +480,7 @@ private JSONObject getExplainPlan(QueryPlan plan, HiveConf conf, HookContext hoo
           null, // pCtx
           plan.getRootTasks(), // RootTasks
           plan.getFetchTask(), // FetchTask
-          null, // analyzer
+          null, null, // analyzer
           config, // explainConfig
           plan.getCboInfo(), // cboInfo,
           plan.getOptimizedQueryString()
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/ExplainConfiguration.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/ExplainConfiguration.java
index 5ca6b59e7e..2f12bda535 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/ExplainConfiguration.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/ExplainConfiguration.java
@@ -48,6 +48,7 @@ public enum VectorizationDetailLevel {
   private boolean vectorizationOnly = false;
   private VectorizationDetailLevel vectorizationDetailLevel = VectorizationDetailLevel.SUMMARY;
   private boolean locks = false;
+  private boolean ast = false;
 
   private Path explainRootPath;
   private Map<String, Long> opIdToRuntimeNumRows;
@@ -161,4 +162,12 @@ public boolean isLocks() {
   public void setLocks(boolean locks) {
     this.locks = locks;
   }
+
+  public boolean isAst() {
+    return ast;
+  }
+
+  public void setAst(boolean ast) {
+    this.ast = ast;
+  }
 }
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/ExplainSemanticAnalyzer.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/ExplainSemanticAnalyzer.java
index 3aefb61ff9..b17efffd86 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/ExplainSemanticAnalyzer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/ExplainSemanticAnalyzer.java
@@ -114,6 +114,8 @@ public void analyzeInternal(ASTNode ast) throws SemanticException {
         }
       } else if (explainOptions == HiveParser.KW_LOCKS) {
         config.setLocks(true);
+      } else if (explainOptions == HiveParser.KW_AST){
+        config.setAst(true);
       } else {
         // UNDONE: UNKNOWN OPTION?
       }
@@ -206,6 +208,7 @@ public void analyzeInternal(ASTNode ast) throws SemanticException {
         pCtx,
         tasks,
         fetchTask,
+        input,
         sem,
         config,
         ctx.getCboInfo(),
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/HiveLexer.g b/ql/src/java/org/apache/hadoop/hive/ql/parse/HiveLexer.g
index 6641e0da14..807f6f593e 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/HiveLexer.g
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/HiveLexer.g
@@ -377,6 +377,7 @@ KW_ACTIVE: 'ACTIVE';
 KW_UNMANAGED: 'UNMANAGED';
 KW_APPLICATION: 'APPLICATION';
 KW_SYNC: 'SYNC';
+KW_AST: 'AST';
 
 // Operators
 // NOTE: if you add a new function/operator, add it to sysFuncNames so that describe function _FUNC_ will work.
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/HiveParser.g b/ql/src/java/org/apache/hadoop/hive/ql/parse/HiveParser.g
index 15d4edfc86..98471a7520 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/HiveParser.g
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/HiveParser.g
@@ -616,6 +616,7 @@ import org.apache.hadoop.hive.conf.HiveConf;
     xlateMap.put("KW_ALLOC_FRACTION", "ALLOC_FRACTION");
     xlateMap.put("KW_SCHEDULING_POLICY", "SCHEDULING_POLICY");
     xlateMap.put("KW_PATH", "PATH");
+    xlateMap.put("KW_AST", "AST");
 
     // Operators
     xlateMap.put("DOT", ".");
@@ -801,6 +802,7 @@ explainOption
     | KW_ANALYZE
     | KW_REOPTIMIZATION
     | KW_LOCKS
+    | KW_AST
     | (KW_VECTORIZATION vectorizationOnly? vectorizatonDetail?)
     ;
 
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/IdentifiersParser.g b/ql/src/java/org/apache/hadoop/hive/ql/parse/IdentifiersParser.g
index 2566b3125c..f327a121d8 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/IdentifiersParser.g
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/IdentifiersParser.g
@@ -807,7 +807,7 @@ nonReserved
     | KW_PRINCIPALS | KW_PROTECTION | KW_PURGE | KW_QUERY | KW_QUARTER | KW_READ | KW_READONLY | KW_REBUILD | KW_RECORDREADER | KW_RECORDWRITER
     | KW_RELOAD | KW_RENAME | KW_REPAIR | KW_REPLACE | KW_REPLICATION | KW_RESTRICT | KW_REWRITE
     | KW_ROLE | KW_ROLES | KW_SCHEMA | KW_SCHEMAS | KW_SECOND | KW_SEMI | KW_SERDE | KW_SERDEPROPERTIES | KW_SERVER | KW_SETS | KW_SHARED
-    | KW_SHOW | KW_SHOW_DATABASE | KW_SKEWED | KW_SORT | KW_SORTED | KW_SSL | KW_STATISTICS | KW_STORED
+    | KW_SHOW | KW_SHOW_DATABASE | KW_SKEWED | KW_SORT | KW_SORTED | KW_SSL | KW_STATISTICS | KW_STORED | KW_AST
     | KW_STREAMTABLE | KW_STRING | KW_STRUCT | KW_TABLES | KW_TBLPROPERTIES | KW_TEMPORARY | KW_TERMINATED
     | KW_TINYINT | KW_TOUCH | KW_TRANSACTIONS | KW_UNARCHIVE | KW_UNDO | KW_UNIONTYPE | KW_UNLOCK | KW_UNSET
     | KW_UNSIGNED | KW_URI | KW_USE | KW_UTC | KW_UTCTIMESTAMP | KW_VALUE_TYPE | KW_VIEW | KW_WEEK | KW_WHILE | KW_YEAR
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/plan/ExplainWork.java b/ql/src/java/org/apache/hadoop/hive/ql/plan/ExplainWork.java
index 3e621422e2..0654f57e74 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/plan/ExplainWork.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/plan/ExplainWork.java
@@ -27,6 +27,7 @@
 import org.apache.hadoop.hive.ql.exec.Task;
 import org.apache.hadoop.hive.ql.hooks.ReadEntity;
 import org.apache.hadoop.hive.ql.hooks.WriteEntity;
+import org.apache.hadoop.hive.ql.parse.ASTNode;
 import org.apache.hadoop.hive.ql.parse.BaseSemanticAnalyzer;
 import org.apache.hadoop.hive.ql.parse.ExplainConfiguration;
 import org.apache.hadoop.hive.ql.parse.ExplainConfiguration.VectorizationDetailLevel;
@@ -42,6 +43,8 @@ public class ExplainWork implements Serializable {
   private Path resFile;
   private ArrayList<Task<?>> rootTasks;
   private Task<?> fetchTask;
+  private ASTNode astTree;
+  private String astStringTree;
   private HashSet<ReadEntity> inputs;
   private HashSet<WriteEntity> outputs;
   private ParseContext pCtx;
@@ -63,6 +66,7 @@ public ExplainWork(Path resFile,
       ParseContext pCtx,
       List<Task<?>> rootTasks,
       Task<?> fetchTask,
+      ASTNode astTree,
       BaseSemanticAnalyzer analyzer,
       ExplainConfiguration config,
       String cboInfo,
@@ -70,6 +74,9 @@ public ExplainWork(Path resFile,
     this.resFile = resFile;
     this.rootTasks = new ArrayList<Task<?>>(rootTasks);
     this.fetchTask = fetchTask;
+    if(astTree != null) {
+      this.astTree = astTree;
+    }
     this.analyzer = analyzer;
     if (analyzer != null) {
       this.inputs = analyzer.getInputs();
@@ -123,6 +130,17 @@ public void setOutputs(HashSet<WriteEntity> outputs) {
     this.outputs = outputs;
   }
 
+  public ASTNode getAstTree() {
+    return astTree;
+  }
+
+  public String getAstStringTree() {
+    if (astStringTree == null) {
+      astStringTree = astTree.dump();
+    }
+    return astStringTree;
+  }
+
   public boolean getExtended() {
     return config.isExtended();
   }
@@ -206,5 +224,7 @@ public void setConfig(ExplainConfiguration config) {
   public boolean isLocks() {
     return config.isLocks();
   }
-
+  public boolean isAst() {
+    return config.isAst();
+  }
 }
diff --git a/ql/src/test/org/apache/hadoop/hive/ql/parse/TestUpdateDeleteSemanticAnalyzer.java b/ql/src/test/org/apache/hadoop/hive/ql/parse/TestUpdateDeleteSemanticAnalyzer.java
index ec77b7376c..932f4e850b 100644
--- a/ql/src/test/org/apache/hadoop/hive/ql/parse/TestUpdateDeleteSemanticAnalyzer.java
+++ b/ql/src/test/org/apache/hadoop/hive/ql/parse/TestUpdateDeleteSemanticAnalyzer.java
@@ -300,7 +300,7 @@ private String explain(SemanticAnalyzer sem, QueryPlan plan) throws
     ExplainConfiguration config = new ExplainConfiguration();
     config.setExtended(true);
     ExplainWork work = new ExplainWork(tmp, sem.getParseContext(), sem.getRootTasks(),
-        sem.getFetchTask(), sem, config, null, plan.getOptimizedQueryString());
+        sem.getFetchTask(), null, sem, config, null, plan.getOptimizedQueryString());
     ExplainTask task = new ExplainTask();
     task.setWork(work);
     task.initialize(queryState, plan, null, null);
diff --git a/ql/src/test/queries/clientpositive/explain_ast.q b/ql/src/test/queries/clientpositive/explain_ast.q
new file mode 100644
index 0000000000..e2d9fd032e
--- /dev/null
+++ b/ql/src/test/queries/clientpositive/explain_ast.q
@@ -0,0 +1,16 @@
+--! qt:dataset:src1
+--! qt:dataset:src
+set hive.mapred.mode=nonstrict;
+set hive.optimize.ppd=true;
+set hive.ppd.remove.duplicatefilters=false;
+
+-- SORT_QUERY_RESULTS
+
+EXPLAIN FORMATTED AST
+SELECT src1.c1, src2.c4
+FROM
+(SELECT src.key as c1, src.value as c2 from src where src.key > '1' ) src1
+JOIN
+(SELECT src.key as c3, src.value as c4 from src where src.key > '2' ) src2
+ON src1.c1 = src2.c3 AND src1.c1 < '400'
+WHERE src1.c1 > '20' and (src1.c2 < 'val_50' or src1.c1 > '2') and (src2.c3 > '50' or src1.c1 < '50') and (src2.c3 <> '4');
\ No newline at end of file
diff --git a/ql/src/test/results/clientpositive/explain_ast.q.out b/ql/src/test/results/clientpositive/explain_ast.q.out
new file mode 100644
index 0000000000..75720eb92f
--- /dev/null
+++ b/ql/src/test/results/clientpositive/explain_ast.q.out
@@ -0,0 +1,159 @@
+PREHOOK: query: EXPLAIN FORMATTED AST
+SELECT src1.c1, src2.c4
+FROM
+(SELECT src.key as c1, src.value as c2 from src where src.key > '1' ) src1
+JOIN
+(SELECT src.key as c3, src.value as c4 from src where src.key > '2' ) src2
+ON src1.c1 = src2.c3 AND src1.c1 < '400'
+WHERE src1.c1 > '20' and (src1.c2 < 'val_50' or src1.c1 > '2') and (src2.c3 > '50' or src1.c1 < '50') and (src2.c3 <> '4')
+PREHOOK: type: QUERY
+POSTHOOK: query: EXPLAIN FORMATTED AST
+SELECT src1.c1, src2.c4
+FROM
+(SELECT src.key as c1, src.value as c2 from src where src.key > '1' ) src1
+JOIN
+(SELECT src.key as c3, src.value as c4 from src where src.key > '2' ) src2
+ON src1.c1 = src2.c3 AND src1.c1 < '400'
+WHERE src1.c1 > '20' and (src1.c2 < 'val_50' or src1.c1 > '2') and (src2.c3 > '50' or src1.c1 < '50') and (src2.c3 <> '4')
+POSTHOOK: type: QUERY
+ABSTRACT SYNTAX TREE:
+  
+TOK_QUERY
+   TOK_FROM
+      TOK_JOIN
+         TOK_SUBQUERY
+            TOK_QUERY
+               TOK_FROM
+                  TOK_TABREF
+                     TOK_TABNAME
+                        src
+               TOK_INSERT
+                  TOK_DESTINATION
+                     TOK_DIR
+                        TOK_TMP_FILE
+                  TOK_SELECT
+                     TOK_SELEXPR
+                        .
+                           TOK_TABLE_OR_COL
+                              src
+                           key
+                        c1
+                     TOK_SELEXPR
+                        .
+                           TOK_TABLE_OR_COL
+                              src
+                           value
+                        c2
+                  TOK_WHERE
+                     >
+                        .
+                           TOK_TABLE_OR_COL
+                              src
+                           key
+                        '1'
+            src1
+         TOK_SUBQUERY
+            TOK_QUERY
+               TOK_FROM
+                  TOK_TABREF
+                     TOK_TABNAME
+                        src
+               TOK_INSERT
+                  TOK_DESTINATION
+                     TOK_DIR
+                        TOK_TMP_FILE
+                  TOK_SELECT
+                     TOK_SELEXPR
+                        .
+                           TOK_TABLE_OR_COL
+                              src
+                           key
+                        c3
+                     TOK_SELEXPR
+                        .
+                           TOK_TABLE_OR_COL
+                              src
+                           value
+                        c4
+                  TOK_WHERE
+                     >
+                        .
+                           TOK_TABLE_OR_COL
+                              src
+                           key
+                        '2'
+            src2
+         AND
+            =
+               .
+                  TOK_TABLE_OR_COL
+                     src1
+                  c1
+               .
+                  TOK_TABLE_OR_COL
+                     src2
+                  c3
+            <
+               .
+                  TOK_TABLE_OR_COL
+                     src1
+                  c1
+               '400'
+   TOK_INSERT
+      TOK_DESTINATION
+         TOK_DIR
+            TOK_TMP_FILE
+      TOK_SELECT
+         TOK_SELEXPR
+            .
+               TOK_TABLE_OR_COL
+                  src1
+               c1
+         TOK_SELEXPR
+            .
+               TOK_TABLE_OR_COL
+                  src2
+               c4
+      TOK_WHERE
+         and
+            and
+               and
+                  >
+                     .
+                        TOK_TABLE_OR_COL
+                           src1
+                        c1
+                     '20'
+                  or
+                     <
+                        .
+                           TOK_TABLE_OR_COL
+                              src1
+                           c2
+                        'val_50'
+                     >
+                        .
+                           TOK_TABLE_OR_COL
+                              src1
+                           c1
+                        '2'
+               or
+                  >
+                     .
+                        TOK_TABLE_OR_COL
+                           src2
+                        c3
+                     '50'
+                  <
+                     .
+                        TOK_TABLE_OR_COL
+                           src1
+                        c1
+                     '50'
+            <>
+               .
+                  TOK_TABLE_OR_COL
+                     src2
+                  c3
+               '4'
+
