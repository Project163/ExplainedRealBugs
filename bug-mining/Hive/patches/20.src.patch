diff --git a/CHANGES.txt b/CHANGES.txt
index 52581cb90f..f728a32da5 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -33,6 +33,8 @@ Trunk (unreleased changes)
 
   BUG FIXES
 
+    HIVE-92. Fixed union all for non-embedded query. (Namit Jain through zshao)
+
     HIVE-93. Dynamic serde to handle _-prefixed column names in DDL.
     (Pete Wyckoff through zshao)
 
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/ErrorMsg.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/ErrorMsg.java
index a695ccae4e..0fb04cad9c 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/ErrorMsg.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/ErrorMsg.java
@@ -65,6 +65,7 @@ public enum ErrorMsg {
   TABLE_ALIAS_NOT_ALLOWED("Table Alias not Allowed in Sampling Clause"),
   CLUSTERBY_DISTRIBUTEBY_CONFLICT("Cannot have both Cluster By and Distribute By Clauses"),
   CLUSTERBY_SORTBY_CONFLICT("Cannot have both Cluster By and Sort By Clauses"),
+  UNION_NOTIN_SUBQ("Top level Union is not supported currently; use a subquery for the union"),
   NON_BUCKETED_TABLE("Sampling Expression Needed for Non-Bucketed Table");
 
   private String mesg;
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
index 2cf64f6cb1..4b0806168c 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
@@ -409,6 +409,13 @@ else if (isJoinToken(frm))
           qbp.setDestLimit(ctx_1.dest, new Integer(ast.getChild(0).getText()));
         }
         break;
+
+      case HiveParser.TOK_UNION:
+        // currently, we dont support subq1 union subq2 - the user has to explicitly say: 
+        // select * from (subq1 union subq2) subqalias
+        if (!qbp.getIsSubQ())
+          throw new SemanticException(ErrorMsg.UNION_NOTIN_SUBQ.getMsg());
+
       default:
         skipRecursion = false;
         break;
diff --git a/ql/src/test/queries/clientnegative/union.q b/ql/src/test/queries/clientnegative/union.q
new file mode 100644
index 0000000000..e3c5c83089
--- /dev/null
+++ b/ql/src/test/queries/clientnegative/union.q
@@ -0,0 +1,4 @@
+explain
+select s1.key as key, s1.value as value from src s1
+  UNION  ALL  
+select s2.key as key, s2.value as value from src s2;
diff --git a/ql/src/test/results/clientnegative/union.q.out b/ql/src/test/results/clientnegative/union.q.out
new file mode 100644
index 0000000000..2f670f9f92
--- /dev/null
+++ b/ql/src/test/results/clientnegative/union.q.out
@@ -0,0 +1 @@
+FAILED: Error in semantic analysis: Top level Union is not supported currently; use a subquery for the union
