diff --git a/ql/src/test/queries/clientpositive/union.q b/ql/src/test/queries/clientpositive/union.q
index 525eccbbfe..f1bf126ecc 100644
--- a/ql/src/test/queries/clientpositive/union.q
+++ b/ql/src/test/queries/clientpositive/union.q
@@ -1,3 +1,4 @@
+-- SORT_BEFORE_DIFF
 -- union case: both subqueries are map jobs on same input, followed by filesink
 
 EXPLAIN
diff --git a/ql/src/test/queries/clientpositive/union11.q b/ql/src/test/queries/clientpositive/union11.q
index 77dc2efec5..1f11ff658e 100644
--- a/ql/src/test/queries/clientpositive/union11.q
+++ b/ql/src/test/queries/clientpositive/union11.q
@@ -1,5 +1,5 @@
 set hive.map.aggr = true;
-
+-- SORT_BEFORE_DIFF
 -- union case: all subqueries are a map-reduce jobs, 3 way union, same input for all sub-queries, followed by reducesink
 
 explain 
diff --git a/ql/src/test/queries/clientpositive/union13.q b/ql/src/test/queries/clientpositive/union13.q
index 8bee1d7993..c9cee66580 100644
--- a/ql/src/test/queries/clientpositive/union13.q
+++ b/ql/src/test/queries/clientpositive/union13.q
@@ -1,3 +1,4 @@
+-- SORT_BEFORE_DIFF
 -- union case: both subqueries are a map-only jobs, same input, followed by filesink
 
 explain 
diff --git a/ql/src/test/queries/clientpositive/union14.q b/ql/src/test/queries/clientpositive/union14.q
index 4437ad8d01..ccd14449bf 100644
--- a/ql/src/test/queries/clientpositive/union14.q
+++ b/ql/src/test/queries/clientpositive/union14.q
@@ -1,5 +1,5 @@
 set hive.map.aggr = true;
-
+-- SORT_BEFORE_DIFF
 -- union case: 1 subquery is a map-reduce job, different inputs for sub-queries, followed by reducesink
 
 explain 
diff --git a/ql/src/test/queries/clientpositive/union15.q b/ql/src/test/queries/clientpositive/union15.q
index 3080b077e9..65eceeb4fc 100644
--- a/ql/src/test/queries/clientpositive/union15.q
+++ b/ql/src/test/queries/clientpositive/union15.q
@@ -1,5 +1,5 @@
 set hive.map.aggr = true;
-
+-- SORT_BEFORE_DIFF
 -- union case: 1 subquery is a map-reduce job, different inputs for sub-queries, followed by reducesink
 
 explain 
diff --git a/ql/src/test/queries/clientpositive/union16.q b/ql/src/test/queries/clientpositive/union16.q
index 1df68b037e..bf15fc9b5f 100644
--- a/ql/src/test/queries/clientpositive/union16.q
+++ b/ql/src/test/queries/clientpositive/union16.q
@@ -1,3 +1,4 @@
+-- SORT_BEFORE_DIFF
 EXPLAIN
 SELECT count(1) FROM (
   SELECT key, value FROM src UNION ALL
diff --git a/ql/src/test/queries/clientpositive/union17.q b/ql/src/test/queries/clientpositive/union17.q
index 34b0e8cc63..8cad9794a6 100644
--- a/ql/src/test/queries/clientpositive/union17.q
+++ b/ql/src/test/queries/clientpositive/union17.q
@@ -1,6 +1,7 @@
 CREATE TABLE DEST1(key STRING, value STRING) STORED AS TEXTFILE;
 CREATE TABLE DEST2(key STRING, val1 STRING, val2 STRING) STORED AS TEXTFILE;
 
+-- SORT_BEFORE_DIFF
 -- union case:map-reduce sub-queries followed by multi-table insert
 
 explain 
diff --git a/ql/src/test/queries/clientpositive/union2.q b/ql/src/test/queries/clientpositive/union2.q
index 581cbebd86..272fbce4d6 100644
--- a/ql/src/test/queries/clientpositive/union2.q
+++ b/ql/src/test/queries/clientpositive/union2.q
@@ -1,3 +1,4 @@
+-- SORT_BEFORE_DIFF
 -- union case: both subqueries are map-reduce jobs on same input, followed by reduce sink
 
 explain 
diff --git a/ql/src/test/queries/clientpositive/union20.q b/ql/src/test/queries/clientpositive/union20.q
index 267262e371..28269f4c7a 100644
--- a/ql/src/test/queries/clientpositive/union20.q
+++ b/ql/src/test/queries/clientpositive/union20.q
@@ -1,3 +1,4 @@
+-- SORT_BEFORE_DIFF
 -- union :map-reduce sub-queries followed by join
 
 explain 
diff --git a/ql/src/test/queries/clientpositive/union21.q b/ql/src/test/queries/clientpositive/union21.q
index 8185994655..ec12d3ed21 100644
--- a/ql/src/test/queries/clientpositive/union21.q
+++ b/ql/src/test/queries/clientpositive/union21.q
@@ -1,3 +1,4 @@
+-- SORT_BEFORE_DIFF
 -- union of constants, udf outputs, and columns from text table and thrift table
 
 explain
diff --git a/ql/src/test/queries/clientpositive/union27.q b/ql/src/test/queries/clientpositive/union27.q
index c039e9c49c..f96c987ddf 100644
--- a/ql/src/test/queries/clientpositive/union27.q
+++ b/ql/src/test/queries/clientpositive/union27.q
@@ -1,3 +1,4 @@
+-- SORT_BEFORE_DIFF
 create table jackson_sev_same as select * from src;
 create table dim_pho as select * from src;
 create table jackson_sev_add as select * from src;
diff --git a/ql/src/test/queries/clientpositive/union3.q b/ql/src/test/queries/clientpositive/union3.q
index b26a2e2799..d402cb0fd0 100644
--- a/ql/src/test/queries/clientpositive/union3.q
+++ b/ql/src/test/queries/clientpositive/union3.q
@@ -1,3 +1,4 @@
+-- SORT_BEFORE_DIFF
 
 explain
 SELECT *
diff --git a/ql/src/test/queries/clientpositive/union33.q b/ql/src/test/queries/clientpositive/union33.q
index 69e46f44d7..90a7a3d797 100644
--- a/ql/src/test/queries/clientpositive/union33.q
+++ b/ql/src/test/queries/clientpositive/union33.q
@@ -1,5 +1,5 @@
 set hive.groupby.skewindata=true;
-
+-- SORT_BEFORE_DIFF
 -- This tests that a union all with a map only subquery on one side and a 
 -- subquery involving two map reduce jobs on the other runs correctly.
 
diff --git a/ql/src/test/queries/clientpositive/union5.q b/ql/src/test/queries/clientpositive/union5.q
index 9844127e4a..ee2ef64e21 100644
--- a/ql/src/test/queries/clientpositive/union5.q
+++ b/ql/src/test/queries/clientpositive/union5.q
@@ -1,5 +1,5 @@
 set hive.map.aggr = true;
-
+-- SORT_BEFORE_DIFF
 -- union case: both subqueries are map-reduce jobs on same input, followed by reduce sink
 
 explain 
diff --git a/ql/src/test/queries/clientpositive/union7.q b/ql/src/test/queries/clientpositive/union7.q
index d66d5960bd..67767e7f14 100644
--- a/ql/src/test/queries/clientpositive/union7.q
+++ b/ql/src/test/queries/clientpositive/union7.q
@@ -1,5 +1,6 @@
 set hive.map.aggr = true;
 
+-- SORT_BEFORE_DIFF
 -- union case: 1 subquery is a map-reduce job, different inputs for sub-queries, followed by reducesink
 
 explain 
diff --git a/ql/src/test/queries/clientpositive/union8.q b/ql/src/test/queries/clientpositive/union8.q
index 6d5bf673e0..366de7378e 100644
--- a/ql/src/test/queries/clientpositive/union8.q
+++ b/ql/src/test/queries/clientpositive/union8.q
@@ -1,3 +1,4 @@
+-- SORT_BEFORE_DIFF
 -- union case: all subqueries are a map-only jobs, 3 way union, same input for all sub-queries, followed by filesink
 
 explain 
diff --git a/ql/src/test/queries/clientpositive/union9.q b/ql/src/test/queries/clientpositive/union9.q
index 7d4c11b252..4cc3a96107 100644
--- a/ql/src/test/queries/clientpositive/union9.q
+++ b/ql/src/test/queries/clientpositive/union9.q
@@ -1,3 +1,4 @@
+-- SORT_BEFORE_DIFF
 -- union case: all subqueries are a map-only jobs, 3 way union, same input for all sub-queries, followed by reducesink
 
 explain 
diff --git a/ql/src/test/queries/clientpositive/union_null.q b/ql/src/test/queries/clientpositive/union_null.q
index 4368b8a5b6..b184841e13 100644
--- a/ql/src/test/queries/clientpositive/union_null.q
+++ b/ql/src/test/queries/clientpositive/union_null.q
@@ -1,3 +1,5 @@
+-- SORT_BEFORE_DIFF
+
 -- HIVE-2901
 select x from (select value as x from src union all select NULL as x from src)a limit 10;
 
diff --git a/ql/src/test/results/clientpositive/union.q.out b/ql/src/test/results/clientpositive/union.q.out
index 6627ad708e..7377c9286b 100644
--- a/ql/src/test/results/clientpositive/union.q.out
+++ b/ql/src/test/results/clientpositive/union.q.out
@@ -1,4 +1,5 @@
-PREHOOK: query: -- union case: both subqueries are map jobs on same input, followed by filesink
+PREHOOK: query: -- SORT_BEFORE_DIFF
+-- union case: both subqueries are map jobs on same input, followed by filesink
 
 EXPLAIN
 FROM (
@@ -8,7 +9,8 @@ FROM (
 ) unioninput
 INSERT OVERWRITE DIRECTORY 'target/warehouse/union.out' SELECT unioninput.*
 PREHOOK: type: QUERY
-POSTHOOK: query: -- union case: both subqueries are map jobs on same input, followed by filesink
+POSTHOOK: query: -- SORT_BEFORE_DIFF
+-- union case: both subqueries are map jobs on same input, followed by filesink
 
 EXPLAIN
 FROM (
diff --git a/ql/src/test/results/clientpositive/union11.q.out b/ql/src/test/results/clientpositive/union11.q.out
index 738bd4e593..6be62c061e 100644
--- a/ql/src/test/results/clientpositive/union11.q.out
+++ b/ql/src/test/results/clientpositive/union11.q.out
@@ -1,4 +1,5 @@
-PREHOOK: query: -- union case: all subqueries are a map-reduce jobs, 3 way union, same input for all sub-queries, followed by reducesink
+PREHOOK: query: -- SORT_BEFORE_DIFF
+-- union case: all subqueries are a map-reduce jobs, 3 way union, same input for all sub-queries, followed by reducesink
 
 explain 
   select unionsrc.key, count(1) FROM (select 'tst1' as key, count(1) as value from src s1
@@ -7,7 +8,8 @@ explain
                                         UNION ALL
                                             select 'tst3' as key, count(1) as value from src s3) unionsrc group by unionsrc.key
 PREHOOK: type: QUERY
-POSTHOOK: query: -- union case: all subqueries are a map-reduce jobs, 3 way union, same input for all sub-queries, followed by reducesink
+POSTHOOK: query: -- SORT_BEFORE_DIFF
+-- union case: all subqueries are a map-reduce jobs, 3 way union, same input for all sub-queries, followed by reducesink
 
 explain 
   select unionsrc.key, count(1) FROM (select 'tst1' as key, count(1) as value from src s1
diff --git a/ql/src/test/results/clientpositive/union13.q.out b/ql/src/test/results/clientpositive/union13.q.out
index ae7b3aa4ae..01ad041d57 100644
--- a/ql/src/test/results/clientpositive/union13.q.out
+++ b/ql/src/test/results/clientpositive/union13.q.out
@@ -1,10 +1,12 @@
-PREHOOK: query: -- union case: both subqueries are a map-only jobs, same input, followed by filesink
+PREHOOK: query: -- SORT_BEFORE_DIFF
+-- union case: both subqueries are a map-only jobs, same input, followed by filesink
 
 explain 
   select unionsrc.key, unionsrc.value FROM (select s1.key as key, s1.value as value from src s1 UNION  ALL  
                                             select s2.key as key, s2.value as value from src s2) unionsrc
 PREHOOK: type: QUERY
-POSTHOOK: query: -- union case: both subqueries are a map-only jobs, same input, followed by filesink
+POSTHOOK: query: -- SORT_BEFORE_DIFF
+-- union case: both subqueries are a map-only jobs, same input, followed by filesink
 
 explain 
   select unionsrc.key, unionsrc.value FROM (select s1.key as key, s1.value as value from src s1 UNION  ALL  
diff --git a/ql/src/test/results/clientpositive/union14.q.out b/ql/src/test/results/clientpositive/union14.q.out
index f5c39482b4..6abcb32cd8 100644
--- a/ql/src/test/results/clientpositive/union14.q.out
+++ b/ql/src/test/results/clientpositive/union14.q.out
@@ -1,4 +1,5 @@
-PREHOOK: query: -- union case: 1 subquery is a map-reduce job, different inputs for sub-queries, followed by reducesink
+PREHOOK: query: -- SORT_BEFORE_DIFF
+-- union case: 1 subquery is a map-reduce job, different inputs for sub-queries, followed by reducesink
 
 explain 
   select unionsrc.key, count(1) FROM (select s2.key as key, s2.value as value from src1 s2
@@ -6,7 +7,8 @@ explain
                                       select 'tst1' as key, cast(count(1) as string) as value from src s1) 
   unionsrc group by unionsrc.key
 PREHOOK: type: QUERY
-POSTHOOK: query: -- union case: 1 subquery is a map-reduce job, different inputs for sub-queries, followed by reducesink
+POSTHOOK: query: -- SORT_BEFORE_DIFF
+-- union case: 1 subquery is a map-reduce job, different inputs for sub-queries, followed by reducesink
 
 explain 
   select unionsrc.key, count(1) FROM (select s2.key as key, s2.value as value from src1 s2
diff --git a/ql/src/test/results/clientpositive/union15.q.out b/ql/src/test/results/clientpositive/union15.q.out
index 0c2380bf55..6ba2693cfd 100644
--- a/ql/src/test/results/clientpositive/union15.q.out
+++ b/ql/src/test/results/clientpositive/union15.q.out
@@ -1,4 +1,5 @@
-PREHOOK: query: -- union case: 1 subquery is a map-reduce job, different inputs for sub-queries, followed by reducesink
+PREHOOK: query: -- SORT_BEFORE_DIFF
+-- union case: 1 subquery is a map-reduce job, different inputs for sub-queries, followed by reducesink
 
 explain 
   select unionsrc.key, count(1) FROM (select 'tst1' as key, cast(count(1) as string) as value from src s1
@@ -7,7 +8,8 @@ explain
                                         UNION  ALL  
                                             select s3.key as key, s3.value as value from src1 s3) unionsrc group by unionsrc.key
 PREHOOK: type: QUERY
-POSTHOOK: query: -- union case: 1 subquery is a map-reduce job, different inputs for sub-queries, followed by reducesink
+POSTHOOK: query: -- SORT_BEFORE_DIFF
+-- union case: 1 subquery is a map-reduce job, different inputs for sub-queries, followed by reducesink
 
 explain 
   select unionsrc.key, count(1) FROM (select 'tst1' as key, cast(count(1) as string) as value from src s1
diff --git a/ql/src/test/results/clientpositive/union16.q.out b/ql/src/test/results/clientpositive/union16.q.out
index b2f1139d39..6dbd249404 100644
--- a/ql/src/test/results/clientpositive/union16.q.out
+++ b/ql/src/test/results/clientpositive/union16.q.out
@@ -1,4 +1,5 @@
-PREHOOK: query: EXPLAIN
+PREHOOK: query: -- SORT_BEFORE_DIFF
+EXPLAIN
 SELECT count(1) FROM (
   SELECT key, value FROM src UNION ALL
   SELECT key, value FROM src UNION ALL
@@ -30,7 +31,8 @@ SELECT count(1) FROM (
   SELECT key, value FROM src UNION ALL
   SELECT key, value FROM src) src
 PREHOOK: type: QUERY
-POSTHOOK: query: EXPLAIN
+POSTHOOK: query: -- SORT_BEFORE_DIFF
+EXPLAIN
 SELECT count(1) FROM (
   SELECT key, value FROM src UNION ALL
   SELECT key, value FROM src UNION ALL
diff --git a/ql/src/test/results/clientpositive/union17.q.out b/ql/src/test/results/clientpositive/union17.q.out
index 0e83c3cf0e..19bfc8be59 100644
--- a/ql/src/test/results/clientpositive/union17.q.out
+++ b/ql/src/test/results/clientpositive/union17.q.out
@@ -14,7 +14,8 @@ POSTHOOK: query: CREATE TABLE DEST2(key STRING, val1 STRING, val2 STRING) STORED
 POSTHOOK: type: CREATETABLE
 POSTHOOK: Output: database:default
 POSTHOOK: Output: default@DEST2
-PREHOOK: query: -- union case:map-reduce sub-queries followed by multi-table insert
+PREHOOK: query: -- SORT_BEFORE_DIFF
+-- union case:map-reduce sub-queries followed by multi-table insert
 
 explain 
 FROM (select 'tst1' as key, cast(count(1) as string) as value from src s1
@@ -23,7 +24,8 @@ FROM (select 'tst1' as key, cast(count(1) as string) as value from src s1
 INSERT OVERWRITE TABLE DEST1 SELECT unionsrc.key, COUNT(DISTINCT SUBSTR(unionsrc.value,5)) GROUP BY unionsrc.key
 INSERT OVERWRITE TABLE DEST2 SELECT unionsrc.key, unionsrc.value, COUNT(DISTINCT SUBSTR(unionsrc.value,5)) GROUP BY unionsrc.key, unionsrc.value
 PREHOOK: type: QUERY
-POSTHOOK: query: -- union case:map-reduce sub-queries followed by multi-table insert
+POSTHOOK: query: -- SORT_BEFORE_DIFF
+-- union case:map-reduce sub-queries followed by multi-table insert
 
 explain 
 FROM (select 'tst1' as key, cast(count(1) as string) as value from src s1
diff --git a/ql/src/test/results/clientpositive/union2.q.out b/ql/src/test/results/clientpositive/union2.q.out
index 37c76bf623..999e9920ee 100644
--- a/ql/src/test/results/clientpositive/union2.q.out
+++ b/ql/src/test/results/clientpositive/union2.q.out
@@ -1,10 +1,12 @@
-PREHOOK: query: -- union case: both subqueries are map-reduce jobs on same input, followed by reduce sink
+PREHOOK: query: -- SORT_BEFORE_DIFF
+-- union case: both subqueries are map-reduce jobs on same input, followed by reduce sink
 
 explain 
   select count(1) FROM (select s1.key as key, s1.value as value from src s1 UNION  ALL  
                         select s2.key as key, s2.value as value from src s2) unionsrc
 PREHOOK: type: QUERY
-POSTHOOK: query: -- union case: both subqueries are map-reduce jobs on same input, followed by reduce sink
+POSTHOOK: query: -- SORT_BEFORE_DIFF
+-- union case: both subqueries are map-reduce jobs on same input, followed by reduce sink
 
 explain 
   select count(1) FROM (select s1.key as key, s1.value as value from src s1 UNION  ALL  
diff --git a/ql/src/test/results/clientpositive/union20.q.out b/ql/src/test/results/clientpositive/union20.q.out
index 8151859647..631d158e39 100644
--- a/ql/src/test/results/clientpositive/union20.q.out
+++ b/ql/src/test/results/clientpositive/union20.q.out
@@ -1,4 +1,5 @@
-PREHOOK: query: -- union :map-reduce sub-queries followed by join
+PREHOOK: query: -- SORT_BEFORE_DIFF
+-- union :map-reduce sub-queries followed by join
 
 explain 
 SELECT unionsrc1.key, unionsrc1.value, unionsrc2.key, unionsrc2.value
@@ -11,7 +12,8 @@ JOIN
       select s4.key as key, s4.value as value from src s4 where s4.key < 10) unionsrc2
 ON (unionsrc1.key = unionsrc2.key)
 PREHOOK: type: QUERY
-POSTHOOK: query: -- union :map-reduce sub-queries followed by join
+POSTHOOK: query: -- SORT_BEFORE_DIFF
+-- union :map-reduce sub-queries followed by join
 
 explain 
 SELECT unionsrc1.key, unionsrc1.value, unionsrc2.key, unionsrc2.value
diff --git a/ql/src/test/results/clientpositive/union21.q.out b/ql/src/test/results/clientpositive/union21.q.out
index 13201a3096..2679ccf457 100644
--- a/ql/src/test/results/clientpositive/union21.q.out
+++ b/ql/src/test/results/clientpositive/union21.q.out
@@ -1,4 +1,5 @@
-PREHOOK: query: -- union of constants, udf outputs, and columns from text table and thrift table
+PREHOOK: query: -- SORT_BEFORE_DIFF
+-- union of constants, udf outputs, and columns from text table and thrift table
 
 explain
 SELECT key, count(1)
@@ -15,7 +16,8 @@ FROM (
 ) union_output
 GROUP BY key
 PREHOOK: type: QUERY
-POSTHOOK: query: -- union of constants, udf outputs, and columns from text table and thrift table
+POSTHOOK: query: -- SORT_BEFORE_DIFF
+-- union of constants, udf outputs, and columns from text table and thrift table
 
 explain
 SELECT key, count(1)
diff --git a/ql/src/test/results/clientpositive/union27.q.out b/ql/src/test/results/clientpositive/union27.q.out
index 153955cb1d..99cfa6f91b 100644
--- a/ql/src/test/results/clientpositive/union27.q.out
+++ b/ql/src/test/results/clientpositive/union27.q.out
@@ -1,7 +1,9 @@
-PREHOOK: query: create table jackson_sev_same as select * from src
+PREHOOK: query: -- SORT_BEFORE_DIFF
+create table jackson_sev_same as select * from src
 PREHOOK: type: CREATETABLE_AS_SELECT
 PREHOOK: Input: default@src
-POSTHOOK: query: create table jackson_sev_same as select * from src
+POSTHOOK: query: -- SORT_BEFORE_DIFF
+create table jackson_sev_same as select * from src
 POSTHOOK: type: CREATETABLE_AS_SELECT
 POSTHOOK: Input: default@src
 POSTHOOK: Output: default@jackson_sev_same
diff --git a/ql/src/test/results/clientpositive/union3.q.out b/ql/src/test/results/clientpositive/union3.q.out
index 327fb07d6b..15bfb14917 100644
--- a/ql/src/test/results/clientpositive/union3.q.out
+++ b/ql/src/test/results/clientpositive/union3.q.out
@@ -1,4 +1,6 @@
-PREHOOK: query: explain
+PREHOOK: query: -- SORT_BEFORE_DIFF
+
+explain
 SELECT *
 FROM (
   SELECT 1 AS id
@@ -16,7 +18,9 @@ FROM (
   FROM (SELECT * FROM src LIMIT 1) s2
 ) a
 PREHOOK: type: QUERY
-POSTHOOK: query: explain
+POSTHOOK: query: -- SORT_BEFORE_DIFF
+
+explain
 SELECT *
 FROM (
   SELECT 1 AS id
diff --git a/ql/src/test/results/clientpositive/union33.q.out b/ql/src/test/results/clientpositive/union33.q.out
index 2075b791ee..7ffc72ac03 100644
--- a/ql/src/test/results/clientpositive/union33.q.out
+++ b/ql/src/test/results/clientpositive/union33.q.out
@@ -1,11 +1,13 @@
-PREHOOK: query: -- This tests that a union all with a map only subquery on one side and a 
+PREHOOK: query: -- SORT_BEFORE_DIFF
+-- This tests that a union all with a map only subquery on one side and a 
 -- subquery involving two map reduce jobs on the other runs correctly.
 
 CREATE TABLE test_src (key STRING, value STRING)
 PREHOOK: type: CREATETABLE
 PREHOOK: Output: database:default
 PREHOOK: Output: default@test_src
-POSTHOOK: query: -- This tests that a union all with a map only subquery on one side and a 
+POSTHOOK: query: -- SORT_BEFORE_DIFF
+-- This tests that a union all with a map only subquery on one side and a 
 -- subquery involving two map reduce jobs on the other runs correctly.
 
 CREATE TABLE test_src (key STRING, value STRING)
diff --git a/ql/src/test/results/clientpositive/union5.q.out b/ql/src/test/results/clientpositive/union5.q.out
index 5763c11d28..3029883e14 100644
--- a/ql/src/test/results/clientpositive/union5.q.out
+++ b/ql/src/test/results/clientpositive/union5.q.out
@@ -1,11 +1,13 @@
-PREHOOK: query: -- union case: both subqueries are map-reduce jobs on same input, followed by reduce sink
+PREHOOK: query: -- SORT_BEFORE_DIFF
+-- union case: both subqueries are map-reduce jobs on same input, followed by reduce sink
 
 explain 
   select unionsrc.key, count(1) FROM (select 'tst1' as key, count(1) as value from src s1
                                     UNION  ALL  
                                       select 'tst2' as key, count(1) as value from src s2) unionsrc group by unionsrc.key
 PREHOOK: type: QUERY
-POSTHOOK: query: -- union case: both subqueries are map-reduce jobs on same input, followed by reduce sink
+POSTHOOK: query: -- SORT_BEFORE_DIFF
+-- union case: both subqueries are map-reduce jobs on same input, followed by reduce sink
 
 explain 
   select unionsrc.key, count(1) FROM (select 'tst1' as key, count(1) as value from src s1
diff --git a/ql/src/test/results/clientpositive/union7.q.out b/ql/src/test/results/clientpositive/union7.q.out
index a5a42b4cf5..204da9247a 100644
--- a/ql/src/test/results/clientpositive/union7.q.out
+++ b/ql/src/test/results/clientpositive/union7.q.out
@@ -1,11 +1,13 @@
-PREHOOK: query: -- union case: 1 subquery is a map-reduce job, different inputs for sub-queries, followed by reducesink
+PREHOOK: query: -- SORT_BEFORE_DIFF
+-- union case: 1 subquery is a map-reduce job, different inputs for sub-queries, followed by reducesink
 
 explain 
   select unionsrc.key, count(1) FROM (select 'tst1' as key, cast(count(1) as string) as value from src s1
                                         UNION  ALL  
                                             select s2.key as key, s2.value as value from src1 s2) unionsrc group by unionsrc.key
 PREHOOK: type: QUERY
-POSTHOOK: query: -- union case: 1 subquery is a map-reduce job, different inputs for sub-queries, followed by reducesink
+POSTHOOK: query: -- SORT_BEFORE_DIFF
+-- union case: 1 subquery is a map-reduce job, different inputs for sub-queries, followed by reducesink
 
 explain 
   select unionsrc.key, count(1) FROM (select 'tst1' as key, cast(count(1) as string) as value from src s1
diff --git a/ql/src/test/results/clientpositive/union8.q.out b/ql/src/test/results/clientpositive/union8.q.out
index 7debe7ad20..2ab53e9a33 100644
--- a/ql/src/test/results/clientpositive/union8.q.out
+++ b/ql/src/test/results/clientpositive/union8.q.out
@@ -1,11 +1,13 @@
-PREHOOK: query: -- union case: all subqueries are a map-only jobs, 3 way union, same input for all sub-queries, followed by filesink
+PREHOOK: query: -- SORT_BEFORE_DIFF
+-- union case: all subqueries are a map-only jobs, 3 way union, same input for all sub-queries, followed by filesink
 
 explain 
   select unionsrc.key, unionsrc.value FROM (select s1.key as key, s1.value as value from src s1 UNION  ALL  
                                             select s2.key as key, s2.value as value from src s2 UNION  ALL  
                                             select s3.key as key, s3.value as value from src s3) unionsrc
 PREHOOK: type: QUERY
-POSTHOOK: query: -- union case: all subqueries are a map-only jobs, 3 way union, same input for all sub-queries, followed by filesink
+POSTHOOK: query: -- SORT_BEFORE_DIFF
+-- union case: all subqueries are a map-only jobs, 3 way union, same input for all sub-queries, followed by filesink
 
 explain 
   select unionsrc.key, unionsrc.value FROM (select s1.key as key, s1.value as value from src s1 UNION  ALL  
diff --git a/ql/src/test/results/clientpositive/union9.q.out b/ql/src/test/results/clientpositive/union9.q.out
index 51ec4e2b98..d1c670007b 100644
--- a/ql/src/test/results/clientpositive/union9.q.out
+++ b/ql/src/test/results/clientpositive/union9.q.out
@@ -1,11 +1,13 @@
-PREHOOK: query: -- union case: all subqueries are a map-only jobs, 3 way union, same input for all sub-queries, followed by reducesink
+PREHOOK: query: -- SORT_BEFORE_DIFF
+-- union case: all subqueries are a map-only jobs, 3 way union, same input for all sub-queries, followed by reducesink
 
 explain 
   select count(1) FROM (select s1.key as key, s1.value as value from src s1 UNION  ALL  
                         select s2.key as key, s2.value as value from src s2 UNION ALL
                         select s3.key as key, s3.value as value from src s3) unionsrc
 PREHOOK: type: QUERY
-POSTHOOK: query: -- union case: all subqueries are a map-only jobs, 3 way union, same input for all sub-queries, followed by reducesink
+POSTHOOK: query: -- SORT_BEFORE_DIFF
+-- union case: all subqueries are a map-only jobs, 3 way union, same input for all sub-queries, followed by reducesink
 
 explain 
   select count(1) FROM (select s1.key as key, s1.value as value from src s1 UNION  ALL  
diff --git a/ql/src/test/results/clientpositive/union_null.q.out b/ql/src/test/results/clientpositive/union_null.q.out
index dad45ba0e8..d803b7630e 100644
--- a/ql/src/test/results/clientpositive/union_null.q.out
+++ b/ql/src/test/results/clientpositive/union_null.q.out
@@ -1,9 +1,13 @@
-PREHOOK: query: -- HIVE-2901
+PREHOOK: query: -- SORT_BEFORE_DIFF
+
+-- HIVE-2901
 select x from (select value as x from src union all select NULL as x from src)a limit 10
 PREHOOK: type: QUERY
 PREHOOK: Input: default@src
 #### A masked pattern was here ####
-POSTHOOK: query: -- HIVE-2901
+POSTHOOK: query: -- SORT_BEFORE_DIFF
+
+-- HIVE-2901
 select x from (select value as x from src union all select NULL as x from src)a limit 10
 POSTHOOK: type: QUERY
 POSTHOOK: Input: default@src
