diff --git a/CHANGES.txt b/CHANGES.txt
index 57b5963eb5..53af2b55b7 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -406,6 +406,9 @@ Trunk -  Unreleased
 
     HIVE-458. Better error messages for fs.default.name. (Paul Yang via zshao)
 
+    HIVE-1030 Hive should use scratchDir instead of system temporary directory
+    for storing plans (Zheng Shao via namit)
+
 Release 0.4.0 -  Unreleased
 
   INCOMPATIBLE CHANGES
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/exec/MapRedTask.java b/ql/src/java/org/apache/hadoop/hive/ql/exec/MapRedTask.java
index a440c83866..492618cfcf 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/exec/MapRedTask.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/exec/MapRedTask.java
@@ -76,10 +76,11 @@ public int execute() {
 
       // Generate the hiveConfArgs after potentially adding the jars
       String hiveConfArgs = ExecDriver.generateCmdLine(conf);
+      File scratchDir = new File(conf.getVar(HiveConf.ConfVars.SCRATCHDIR));
       
       mapredWork plan = getWork();
 
-      File planFile = File.createTempFile("plan", ".xml");
+      File planFile = File.createTempFile("plan", ".xml", scratchDir);
       LOG.info("Generating plan file " + planFile.toString());
       FileOutputStream out = new FileOutputStream(planFile);
       Utilities.serializeMapRedWork(plan, out);
