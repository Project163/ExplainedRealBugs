diff --git a/llap-server/src/java/org/apache/hadoop/hive/llap/io/decode/OrcEncodedDataConsumer.java b/llap-server/src/java/org/apache/hadoop/hive/llap/io/decode/OrcEncodedDataConsumer.java
index 16f3fdba97..9d33656b35 100644
--- a/llap-server/src/java/org/apache/hadoop/hive/llap/io/decode/OrcEncodedDataConsumer.java
+++ b/llap-server/src/java/org/apache/hadoop/hive/llap/io/decode/OrcEncodedDataConsumer.java
@@ -233,6 +233,7 @@ private void positionInStreams(TreeReaderFactory.TreeReader[] columnReaders,
     PositionProvider[] pps = createPositionProviders(columnReaders, batchKey, stripeMetadata);
     if (pps == null) return;
     for (int i = 0; i < columnReaders.length; i++) {
+      if (columnReaders[i] == null) continue;
       // TODO: we could/should trace seek destinations; pps needs a "peek" method
       columnReaders[i].seek(pps);
     }
@@ -246,6 +247,7 @@ private void repositionInStreams(TreeReaderFactory.TreeReader[] columnReaders,
     if (pps == null) return;
     for (int i = 0; i < columnReaders.length; i++) {
       TreeReader reader = columnReaders[i];
+      if (reader == null) continue;
       // Note: we assume this never happens for SerDe reader - the batch would never have vectors.
       // That is always true now; but it wasn't some day, the below would throw in getColumnData.
       ((SettableTreeReader) reader).setBuffers(batch, sameStripe);
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/io/orc/encoded/EncodedTreeReaderFactory.java b/ql/src/java/org/apache/hadoop/hive/ql/io/orc/encoded/EncodedTreeReaderFactory.java
index a3a8f1a418..1e7708e9ae 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/io/orc/encoded/EncodedTreeReaderFactory.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/io/orc/encoded/EncodedTreeReaderFactory.java
@@ -2740,7 +2740,9 @@ public void setBuffers(EncodedColumnBatch<OrcBatchKey> batch, boolean sameStripe
       }
       if (fields != null) {
         for (TreeReader child : fields) {
-          ((SettableTreeReader) child).setBuffers(batch, sameStripe);
+          if (child != null) {
+            ((SettableTreeReader) child).setBuffers(batch, sameStripe);
+          }
         }
       }
     }
