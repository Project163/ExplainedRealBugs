diff --git a/CHANGES.txt b/CHANGES.txt
index 1168f82633..e2fa024233 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -70,6 +70,9 @@ Trunk (unreleased changes)
     HIVE-319. Add UDF for unix timestamp. 
     (Hao Liu via namit)
 
+    HIVE-363. Use 1 reducer in case of aggregations with no grouping keys. 
+    (namit)
+
 Release 0.2.0 - Unreleased
 
   INCOMPATIBLE CHANGES
diff --git a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
index 6b53acc773..0485fb7781 100644
--- a/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
+++ b/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java
@@ -1960,14 +1960,14 @@ private Operator genGroupByPlanMapAggr1MR(String dest, QB qb,
 
     int numReducers = -1;
 
-    // Optimize the scenario when there are no grouping keys and no distinct - only 1 reducer is needed
-    // For eg: select count(1) from T where t.ds = ....
-    if (optimizeMapAggrGroupBy(dest, qb)) 
+    // Optimize the scenario when there are no grouping keys - only 1 reducer is needed
+    List<ASTNode> grpByExprs = getGroupByForClause(parseInfo, dest);
+    if (grpByExprs.isEmpty())
       numReducers = 1;
     
     // ////// Generate ReduceSink Operator
     Operator reduceSinkOperatorInfo = 
-      genGroupByPlanReduceSinkOperator(qb, dest, groupByOperatorInfo, getGroupByForClause(parseInfo, dest).size(), numReducers, true);
+      genGroupByPlanReduceSinkOperator(qb, dest, groupByOperatorInfo, grpByExprs.size(), numReducers, true);
     
     // This is a 1-stage map-reduce processing of the groupby. Tha map-side aggregates was just used to
     // reduce output data. In case of distincts, partial results are not used, and so iterate is again
diff --git a/ql/src/test/results/compiler/plan/groupby3.q.xml b/ql/src/test/results/compiler/plan/groupby3.q.xml
index adccd9d949..e425cc9167 100644
--- a/ql/src/test/results/compiler/plan/groupby3.q.xml
+++ b/ql/src/test/results/compiler/plan/groupby3.q.xml
@@ -77,7 +77,7 @@
                        </object> 
                       </void> 
                       <void property="numReducers"> 
-                       <int>-1</int> 
+                       <int>1</int> 
                       </void> 
                       <void property="partitionCols"> 
                        <object class="java.util.ArrayList"/> 
@@ -894,12 +894,12 @@
      <object idref="tableDesc0"/> 
     </void> 
     <void property="numReduceTasks"> 
-     <int>-1</int> 
+     <int>1</int> 
     </void> 
     <void property="pathToAliases"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/zshao/sync/apache-trunk-HIVE-337-trunk/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive_commit2/trunk/build/ql/test/data/warehouse/src</string> 
        <object class="java.util.ArrayList"> 
         <void method="add"> 
          <string>src</string> 
@@ -911,7 +911,7 @@
     <void property="pathToPartitionInfo"> 
      <object class="java.util.LinkedHashMap"> 
       <void method="put"> 
-       <string>file:/data/users/zshao/sync/apache-trunk-HIVE-337-trunk/build/ql/test/data/warehouse/src</string> 
+       <string>file:/data/users/njain/hive_commit2/trunk/build/ql/test/data/warehouse/src</string> 
        <object class="org.apache.hadoop.hive.ql.plan.partitionDesc"> 
         <void property="partSpec"> 
          <object class="java.util.LinkedHashMap"/> 
@@ -967,7 +967,7 @@
             </void> 
             <void method="put"> 
              <string>location</string> 
-             <string>file:/data/users/zshao/sync/apache-trunk-HIVE-337-trunk/build/ql/test/data/warehouse/src</string> 
+             <string>file:/data/users/njain/hive_commit2/trunk/build/ql/test/data/warehouse/src</string> 
             </void> 
            </object> 
           </void> 
@@ -993,7 +993,7 @@
               <void property="conf"> 
                <object class="org.apache.hadoop.hive.ql.plan.fileSinkDesc"> 
                 <void property="dirName"> 
-                 <string>/data/users/zshao/sync/apache-trunk-HIVE-337-trunk/ql/../build/ql/tmp/474335337.10001.insclause-0</string> 
+                 <string>/data/users/njain/hive_commit2/trunk/ql/../build/ql/tmp/263073162.10001.insclause-0</string> 
                 </void> 
                 <void property="tableInfo"> 
                  <object class="org.apache.hadoop.hive.ql.plan.tableDesc"> 
